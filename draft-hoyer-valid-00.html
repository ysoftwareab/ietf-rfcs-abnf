<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>VALID</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="VALID">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">P. Hoyer</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">ActivIdentity</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">T. Moses</td></tr>
<tr><td class="header">Expires: January 7, 2010</td><td class="header">Entrust</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">M. Pei</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">VeriSign</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">S. Machani</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Diversinet</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">July 06, 2009</td></tr>
</table></td></tr></table>
<h1><br />VALID<br />draft-hoyer-valid-00</h1>

<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on January 7, 2010.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2009 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents in effect on the date of
publication of this document (http://trustee.ietf.org/license-info).
Please review these documents carefully, as they describe your
rights and restrictions with respect to this document.</p>

<h3>Abstract</h3>

<p>This document describes a Web-service interface standard for an authentication-data validation service that supports risk-based, multi-factor authentication.This standard enables enterprises to
				deploy best-of-breed solutions combining components from different vendors into the
				same infrastructure. 
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">1.1.</a>&nbsp;
Key Words<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">1.2.</a>&nbsp;
Notation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">1.3.</a>&nbsp;
Namespaces<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">1.4.</a>&nbsp;
Terminology<br />
<a href="#anchor6">2.</a>&nbsp;
Authentication-Data Validation Service Interface overview<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">2.1.</a>&nbsp;
Authentication data communication<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">2.2.</a>&nbsp;
Verified attributes<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">2.3.</a>&nbsp;
Challenge/response<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">2.4.</a>&nbsp;
Token collections<br />
<a href="#communicationPatterns">3.</a>&nbsp;
Communication patterns<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#InBandAuthentication">3.1.</a>&nbsp;
In-band authentication<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#OutOfBandChallenge">3.2.</a>&nbsp;
Out-of-band challenge<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#OutOfBandResponse">3.3.</a>&nbsp;
Out-of-band response<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">3.4.</a>&nbsp;
Client supplies challenge<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">3.5.</a>&nbsp;
End-user obtains assertions Out-of-band from server<br />
<a href="#anchor13">4.</a>&nbsp;
Asynchronous communication<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">4.1.</a>&nbsp;
Out-of-band challenge<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">4.2.</a>&nbsp;
Out-of-band response<br />
<a href="#anchor16">5.</a>&nbsp;
Authentication moving factor resync<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor17">5.1.</a>&nbsp;
Automatic re-sync based on authentication data<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">5.2.</a>&nbsp;
Manual re-sync based on presenting moving factor values<br />
<a href="#anchor19">6.</a>&nbsp;
Policy models<br />
<a href="#anchor20">7.</a>&nbsp;
Common message contents<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor21">7.1.</a>&nbsp;
Request Security Token<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor22">7.2.</a>&nbsp;
Request Security Token Response<br />
<a href="#anchor23">8.</a>&nbsp;
Mechanism-specific message contents<br />
<a href="#Extensibility">9.</a>&nbsp;
Extensibility<br />
<a href="#iana">10.</a>&nbsp;
IANA Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor24">10.1.</a>&nbsp;
XML namespace registration<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor25">10.2.</a>&nbsp;
VALID Version Registry<br />
<a href="#anchor26">11.</a>&nbsp;
Security Considerations<br />
<a href="#anchor27">12.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">13.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">13.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">13.2.</a>&nbsp;
Informative References<br />
<a href="#WSDL">Appendix&nbsp;A.</a>&nbsp;
WSDL<br />
<a href="#anchor30">Appendix&nbsp;B.</a>&nbsp;
Mechanism specific message contents<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor31">B.1.</a>&nbsp;
Username/password<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor32">B.2.</a>&nbsp;
In band one-time-password (OTP)<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor33">B.3.</a>&nbsp;
In band challenge/response<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor34">B.4.</a>&nbsp;
Out-of-band challenge<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor35">B.5.</a>&nbsp;
Out-of-band response<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor36">B.6.</a>&nbsp;
Client supplies challenge<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor37">B.7.</a>&nbsp;
Challenge/response with signature<br />
<a href="#anchor38">Appendix&nbsp;C.</a>&nbsp;
Use Cases<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor39">C.1.</a>&nbsp;
Validation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor40">C.1.1.</a>&nbsp;
OTP Validation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor41">C.1.2.</a>&nbsp;
Challenge/Response Validation – Server generated challenge<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor42">C.1.3.</a>&nbsp;
Challenge/Response Validation – User generated challenge<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor43">C.1.4.</a>&nbsp;
OTP Validation + Server managed PIN<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor44">C.1.5.</a>&nbsp;
MatrixCardValidation – Server generated challenge<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor45">C.2.</a>&nbsp;
Synchornisation Use Cases<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor46">C.2.1.</a>&nbsp;
OTP Token Auto-Resync (NextOTP)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor47">C.2.2.</a>&nbsp;
OTP Token Manual-resync<br />
<a href="#anchor48">Appendix&nbsp;D.</a>&nbsp;
Requirements<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>The Authentication-Data Validation Service Interface definition (VALID) describes a Web-service interface for a validation server.  The specification reuses data definitions from <a class='info' href='#SAML'>[SAML]<span> (</span><span class='info'>Cantor, S., Kemp, J., Philpott, R., and E. Maler, &ldquo;WS-Trust 1.4,&rdquo; March&nbsp;2005.</span><span>)</span></a>, <a class='info' href='#WS-Security'>[WS&#8209;Security]<span> (</span><span class='info'>Nadalin, A., Kaler, C., Monzillo, R., and P. Hallam-Baker, &ldquo;Web Services Security: SOAP Message Security 1.1,&rdquo; Feb&nbsp;2006.</span><span>)</span></a> and <a class='info' href='#WS-Trust'>[WS&#8209;Trust]<span> (</span><span class='info'>Nadalin, A., Goodner, M., Gudgin, M., Barbir, A., and H. Granqvist, &ldquo;WS-Trust 1.4,&rdquo; Feb&nbsp;2009.</span><span>)</span></a> and operates over version 1.2 of <a class='info' href='#SOAP'>[SOAP]<span> (</span><span class='info'>Gudgin, M., &ldquo;Simple Object Access Protocol 1.2,&rdquo; April&nbsp;2007.</span><span>)</span></a>.  Upon successful validation, the validation server returns a SAML assertion containing verified attributes of the authenticated end-user or a hardware or software device under the end-user's control.  Communications between the end-user and the application are not required to follow the Web-services programming model.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Key Words</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD
						NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as
						described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>, &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.2"></a><h3>1.2.&nbsp;
Notation</h3>

<p>This specification uses the following syntax to define outlines for messages:
</p>
<p>
					</p>
<blockquote class="text"><dl>
<dt></dt>
<dd>The syntax appears as an XML instance.
</dd>
<dt></dt>
<dd>Characters are appended to elements and attributes to indicate cardinality:
</dd>
<dt></dt>
<dd>"?" (0 or 1)
</dd>
<dt></dt>
<dd>"*" (0 or more)
</dd>
<dt></dt>
<dd>"+" (1 or more)
</dd>
<dt></dt>
<dd>The character "|" is used to indicate a choice between alternatives.
</dd>
<dt></dt>
<dd>The characters "(" and ")" are used to indicate that contained items are to be treated as a group with respect to cardinality or choice.
</dd>
<dt></dt>
<dd>The characters "[" and "]" are used to call out references and property names.
</dd>
<dt></dt>
<dd>Additional child elements and/or attributes MAY be added at the indicated extension points (see <a class='info' href='#Extensibility'>Section&nbsp;9<span> (</span><span class='info'>Extensibility</span><span>)</span></a>) but MUST NOT contradict the semantics of the parent and/or owner, respectively. By default, if a receiver does not recognize an extension, the receiver SHOULD ignore the extension; exceptions to this processing rule, if any, are clearly indicated below.
</dd>
<dt></dt>
<dd>XML namespace prefixes (see Table 1) are used to indicate the namespace of the element being defined.
</dd>
<dt></dt>
<dd>Elements and Attributes defined by this specification are referred to in the text of this document using XPath 1.0 expressions. Extensibility points are referred to using an extended version of this syntax:
</dd>
<dt></dt>
<dd>
					
<blockquote class="text"><dl>
<dt></dt>
<dd>An element extensibility point is referred to using {any} in place of the element name. This indicates that any element name can be used, from any namespace other than the namespace of this specification.
</dd>
<dt></dt>
<dd>An attribute extensibility point is referred to using @{any} in place of the attribute name. This indicates that any attribute name can be used, from any namespace other than the namespace of this specification
</dd>
</dl></blockquote>
						
</dd>
</dl></blockquote><p>
					
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.3"></a><h3>1.3.&nbsp;
Namespaces</h3>

<p>The following XML namespace prefixes are used in the specification.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
env:    http://www.w3.org/2003/05/soap-envelope
saml:   urn:oasis:names:tc:SAML:2.0:assertion
valid:  urn:ietf:params:xml:ns:valid
wsp:    http://www.w3.org/ns/ws-policy
wss:    http://docs.oasis-open.org/wss/2004/01/
         oasis-200401-wss-wssecurity-secext-1.0
wst:    http://docs.oasis-open.org/ws-sx/ws-trust/200512
wst14:  http://docs.oasis-open.org/ws-sx/ws-trust/200802
xsd:    http://www.w3.org/2001/XMLSchema
</pre></div>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.4"></a><h3>1.4.&nbsp;
Terminology</h3>

<p>The following terms are used in this document. </p>
<blockquote class="text"><dl>
<dt>Application:</dt>
<dd>The system component that controls access to sensitive resources by authenticated end-users.
</dd>
<dt>Authentication data:</dt>
<dd>Information exchanged between the end-user and the validation server as part of the authentication process. For example a password, an OTP, the response to a challenge, etc.
</dd>
<dt>Authentication policy:</dt>
<dd>The combination of authentication mechanisms required to complete successfully before access may be granted.
</dd>
<dt>Client :</dt>
<dd>See "Application".
</dd>
<dt>End-user:</dt>
<dd>The authentication subject.
</dd>
<dt>Moving factor:</dt>
<dd>The factor that makes a one time password computationally unique in combination with a fixed key. For example the increasing event counter value in <a class='info' href='#HOTP'>[HOTP]<span> (</span><span class='info'>MRaihi, D., Bellare, M., Hoornaert, F., Naccache, D., and O. Ranen, &ldquo;HOTP: An HMAC-Based One Time Password Algorithm,&rdquo; December&nbsp;2005.</span><span>)</span></a>.
</dd>
<dt>Server:</dt>
<dd>See "Validation server".
</dd>
<dt>Validation server:</dt>
<dd>The system component that validates authentication data.
</dd>
</dl></blockquote>

<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Authentication-Data Validation Service Interface overview</h3>

<p>The Authentication-Data Validation Service Interface allows communication of the following data elements in several different communication patterns as described in <a class='info' href='#communicationPatterns'>Section&nbsp;3<span> (</span><span class='info'>Communication patterns</span><span>)</span></a>. The interface is based mainly on <a class='info' href='#WS-Trust'>[WS&#8209;Trust]<span> (</span><span class='info'>Nadalin, A., Goodner, M., Gudgin, M., Barbir, A., and H. Granqvist, &ldquo;WS-Trust 1.4,&rdquo; Feb&nbsp;2009.</span><span>)</span></a>. The following sections apply terminologies and concepts defined in <a class='info' href='#WS-Trust'>[WS&#8209;Trust]<span> (</span><span class='info'>Nadalin, A., Goodner, M., Gudgin, M., Barbir, A., and H. Granqvist, &ldquo;WS-Trust 1.4,&rdquo; Feb&nbsp;2009.</span><span>)</span></a>.
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
Authentication data communication</h3>

<p>The specific requirements for authentication data communication depend upon the specific authentication mechanism.
</p>
<p>In-band authentication data SHALL be passed in the body of &lt;wst:RequestSecurityToken&gt; and &lt;wst:RequestSecurityTokenResponse&gt; elements.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
Verified attributes</h3>

<p>Upon successful validation of the authentication data, the validation server SHALL issue a SAML assertion containing verified end-user or token attributes, depending if the server is validating user identities (user centric authentication) or device/token (pseudonomous - token centric authentication) . The client MAY provide a &lt;wsp:Policy&gt; element indicating which attributes it requires.  Required attributes SHALL be referenced using the &lt;saml:Attribute&gt; element, with the &lt;saml:AttributeValue&gt; child element omitted.
		
</p>
<p> The validation server MAY include the sub-set of the requested attributes whose verified values are known to it.  Otherwise, the validation server SHALL include all verified attributes whose values are known to it.  These attributes MUST be included in the SAML assertion.  They MUST also be included in a separate &lt;wst:Claims&gt; element.  In this way, the application may treat the assertion as opaque data, extracting any attributes it requires from the &lt;wst:Claims&gt; element.
</p>
<p>Attributes SHALL be expressed as &lt;saml:Attribute&gt; elements in accordance with the SAML V2.0 X.500/LDAP Attribute Profile.
		
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3"></a><h3>2.3.&nbsp;
Challenge/response</h3>

<p>Multi-step authentication mechanisms are supported as shown here.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
Message     Direction            Cardinality

Request     Client  -&gt; Server    Exactly one
Response    Client &lt;-&gt; Server    (Zero or more request-response pairs)
Response    Client &lt;-  Server    Exactly one
</pre></div>
<p>The protocol terminates when the validation server either includes at least one security token according to <a class='info' href='#WS-Trust'>[WS&#8209;Trust]<span> (</span><span class='info'>Nadalin, A., Goodner, M., Gudgin, M., Barbir, A., and H. Granqvist, &ldquo;WS-Trust 1.4,&rdquo; Feb&nbsp;2009.</span><span>)</span></a> in the response or returns an &lt;env:Body/env:Fault&gt; element.
				
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.4"></a><h3>2.4.&nbsp;
Token collections</h3>

<p> A set of tokens MAY be requested and issued in a single set of exchanges with the validation server using the "token collection" features of WS-Trust.
			
</p>
<a name="communicationPatterns"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Communication patterns</h3>

<p>The folllowing communication patterns are supported:
</p>
<a name="InBandAuthentication"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
In-band authentication</h3>
<br /><hr class="insert" />
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
 __________                            _____________
|          |                          |             |
| End-user |-------------------------&gt;| Application |
|__________|  1. Access application   |_____________|
                                             |        \
                                             |         |
                        2. Obtain assertion  |          &gt; VALID
                                             |         |
                                       _____\|/____   /
                                      |            |
                                      | Validation |
                                      |   server   |
                                      |____________|


</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;In-band authentication&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>The end-user accesses the application (1).  The application supplies the authentication data to the validation server and receives an assertion in return (2).
</p>
<p>For in-band challenge/response authentication mechanisms, additional messages between the end-user and the validation server MUST be relayed by the application.
</p>
<a name="OutOfBandChallenge"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Out-of-band challenge</h3>
<br /><hr class="insert" />
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
     __________                        _____________
    |          |                      |             |
 --&gt;| End-user |---------------------&gt;| Application |
|   |__________|   1. Access          |_____________|
|                     application            |     \
|                                            |      |
|                  4. In-band                |      |
|                     Response               |      |
|                               2. Request   |      |
|                                  assertion |       &gt;VALID
| 3. Out-of-band                             |      |
|    challenge                  5. Obtain    |      |
|                                  assertion |      |
|                                            |      |
|                                      _____\|/____/
|                                     |            |
|                                     | Validation |
 -------------------------------------|   server   |
                                      |____________|


</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Out-of-band challenge&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>The "out-of-band challenge" pattern is shown in Figure 2.  The application invokes the validation server (2).  The validation server then contacts the end-user out-of-band with a challenge (3).  The end-user may or may not transform the challenge and then passes it back to the application (4), which then passes it to the validation server and obtains an assertion in response (5).
</p>
<a name="OutOfBandResponse"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
Out-of-band response</h3>
<br /><hr class="insert" />
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
     __________                        _____________
    |          |                      |             |
 ---| End-user |&lt;--------------------&gt;| Application |
|   |__________|   1. Access          |_____________|
|                     application           /|\     \
|                                            |       |
|                  4. In-band                |       |
|                     challenge 2. Request   |       |
|                                  assertion |       |
| 5. Out-of-band                             |       |
|    response                   3. Return    |        &gt;VALID
|                                  challenge |       |
|                                            |       |
|                               6. Send      |       |
|                                  assertion |       |
|                                            |       |
|                                      _____\|/____ /
|                                     |            |
|                                     | Validation |
 ------------------------------------&gt;|   server   |
                                      |____________|

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Out-of-band response&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>The "out-of-band response" pattern is shown in Figure 3.  The application invokes the validation server (2).  The validation server returns a challenge (3).  The application passes the challenge to the end-user (4).  The end-user may or may not transform the challenge and sends the result to the validation server out-of-band (5).  The validation server sends the assertion to the application (6).
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4"></a><h3>3.4.&nbsp;
Client supplies challenge</h3>
<br /><hr class="insert" />
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
     __________                       _____________
    |          |                     |             |
 --&gt;| End-user |--------------------&gt;| Application |
|   |__________|  2. Supply          |_____________|
|                    challenge              |      \
|                    and response           |       |
|                                           |       |
|                              3. Obtain    |       |
|                                 assertion |       |
|    1. Obtain                              |        &gt;VALID
|       challenge                           |       |
|                                           |       |
|                                           |       |
|                                           |       |
|                                     _____\|/____ /
|                                    |            |
|                                    | Validation |
 ------------------------------------|   server   |
                                     |____________|


</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Client supplies challenge&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>The "client supplies challenge" pattern is shown in Figure 4.  The end-user obtains a challenge out-of-band (1), calculates the response and send both challenge and response to the application (2).  The application then uses the challenge and response to obtain an assertion from the validation server (3).
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.5"></a><h3>3.5.&nbsp;
End-user obtains assertions Out-of-band from server</h3>
<br /><hr class="insert" />
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
 __________                            _____________
|          |                          |             |
| End-user |-------------------------&gt;| Application |
|__________|  2. Access application   |_____________|
   /    |        (passing assertion)
  |V    |
  |A    |
  |L    |
  |I    |                              ____________
  |D    |     1. Obtain assertion     |            |
  |      ----------------------------&gt;| Validation |
   \                                  |   server   |
                                      |____________|
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Out-of-band from server authentication&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>The End-user obtains the assertion directly or though a proxy from the validation server (1) then passes the assertion to the Application for authentication (2).
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Asynchronous communication</h3>

<p>The out-of-band communication patterns (<a class='info' href='#OutOfBandChallenge'>Section&nbsp;3.2<span> (</span><span class='info'>Out-of-band challenge</span><span>)</span></a> and <a class='info' href='#OutOfBandResponse'>Section&nbsp;3.3<span> (</span><span class='info'>Out-of-band response</span><span>)</span></a>) require asynchronous behavior, so that the application thread is not blocked while the challenge is being processed by the end-user.
	
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Out-of-band challenge</h3>

<p>In the case of the "out-of-band challenge" pattern (<a class='info' href='#OutOfBandChallenge'>Section&nbsp;3.2<span> (</span><span class='info'>Out-of-band challenge</span><span>)</span></a>), the validation server SHALL return an &lt;env:Body/env:Fault&gt; element with the value:
			
</p>
<p></p>
<blockquote class="text"><dl>
<dt></dt>
<dd>valid:Pending
</dd>
</dl></blockquote><p>
			
</p>
<p>The validation server, upon sending this value, and the application, upon receiving it, SHALL terminate the current session.
</p>
<p>Once the application receives the response from the end-user, it SHALL initiate a new session with the validation server.
			
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Out-of-band response</h3>

<p>In the case of the "out-of-band response" pattern (<a class='info' href='#OutOfBandResponse'>Section&nbsp;3.3<span> (</span><span class='info'>Out-of-band response</span><span>)</span></a>), the validation server SHALL return an &lt;env:Body/env:Fault&gt; element with the value:
			
</p>
<p></p>
<blockquote class="text"><dl>
<dt></dt>
<dd>valid:Pending
</dd>
</dl></blockquote><p>
			
</p>
<p>The validation server, upon sending this value, and the application, upon receiving it, SHALL terminate the current session.
</p>
<p>Both parties MUST maintain the &lt;wst:RequestSecurityToken/@Context&gt; attribute as metadata associated with the initial session.  In the subsequent session, they MUST use this &lt;wst:RequestSecurityToken/@Context&gt; attribute value to correlate the challenge and response. 
			
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Authentication moving factor resync</h3>

<p>Some authentication schemes gradually lose synchronization between client and server.  In order to compensate for this, the server must accept authentication data values within a range, or window of the moving factor (e.g. the event counter used in event based one time password algorithms, see <a class='info' href='#HOTP'>[HOTP]<span> (</span><span class='info'>MRaihi, D., Bellare, M., Hoornaert, F., Naccache, D., and O. Ranen, &ldquo;HOTP: An HMAC-Based One Time Password Algorithm,&rdquo; December&nbsp;2005.</span><span>)</span></a>).  When an authentication moving factor drifts to the edge of, or beyond, the server's window for a particular end-user, the server has to adjust its window.  This process is known as resyncing.
	
</p>
<p>Resyncing erodes assurance in the authentication event.  So, following a resync event, the validation server commonly requests a second authentication data value, which effectively restores the level of assurance provided by the authentication.
	
</p>
<p>The following two approaches to resyncing exist:
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Automatic re-sync based on authentication data</h3>

<p>In this approach, the resynchronisation is based only on the authentication data. In this apporach the server searches through an extended window of the moving factor(s) to see if it can match the presented authentication data. In this apporach two OTPs MUST be transmitted so that the server MUST try to match the first OTP with the extended window and also MUST match the second OTP with a normal window.
		
</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Manual re-sync based on presenting moving factor values</h3>

<p>In this approach to resynchronisation, the server is given the exact value of the moving factor (e.g. the event counter value in <a class='info' href='#HOTP'>[HOTP]<span> (</span><span class='info'>MRaihi, D., Bellare, M., Hoornaert, F., Naccache, D., and O. Ranen, &ldquo;HOTP: An HMAC-Based One Time Password Algorithm,&rdquo; December&nbsp;2005.</span><span>)</span></a>) together with the OTP. The server MUST only set the moving factor(s) to the received value if the OTP matches successfully (given the new moving factor values).
		
</p>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Policy models</h3>

<p>Authentication policy defines the requirements for accessing a resource in terms of mechanisms and their strengths, expressible in disjunctive normal form (that is a disjunction ("OR") of conjunctions ("AND"s)).  This approach supports risk-based multi-factor authentication.
</p>
<p>Two policy models are supported.  In the first model (see figuer below), the application is responsible for invoking the right combination of validation servers in order to satisfy the authentication policy.
		
</p><br /><hr class="insert" />
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
               _____________
              |             |
              | Application |
              |_____________|
                     |                      \
        _____________|______________         |
       |             |              |         &gt; VALID
       |             |              |        |
 ______|_____   _____|______   _____|______ /
|            | |            | |            |
| Validation | | Validation | | Validation |
|   server   | |   server   | |   server   |
|____________| |____________| |____________|

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Policy aware application&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>In the second model (see figure below), the authentication policy is managed through a choreography component, which appears to the application as a validation server and to the validation server as an application.
		
</p><br /><hr class="insert" />
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
               _____________
              |             |
              | Application |
              |_____________|
                     |                     \
                     |                      |
                     |                       &gt;VALID
                     |                      |
               ______|_______              /
              |              |
              | Choreography |
              |______________|
                     |                     \
       ______________|______________        |
      |              |              |        &gt;VALID
      |              |              |       |
 _____|______   _____|______   _____|______/
|            | |            | |            |
| Validation | | Validation | | Validation |
|   server   | |   server   | |   server   |
|____________| |____________| |____________|

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Policy aware application&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>In either model, the application MAY supply information about the resource to which access is requested in a &lt;wsp:AppliesTo&gt; element.  The validation server MAY restrict the resources to which the application SHALL limit access by including a &lt;wsp:AppliesTo&gt; element in its response.  This is not intended as an access-control solution; it is intended only to enforce an appropriate level of authentication assurance, based on the sensitivity of the resource, where the sensitivity is not uniform across all the resources accessible by the application.
		
</p>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Common message contents</h3>

<p>This section describes the mechanism-independent requirements for message contents.
	
</p>
<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.1"></a><h3>7.1.&nbsp;
Request Security Token</h3>

<p>The message-independent requirements for "request security token" messages are shown in this example:
		
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;wst:RequestSecurityToken Context=" ... "&gt;
    &lt;wst:TokenType&gt;
http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV2.0
    &lt;/wst:TokenType&gt;
    &lt;wst:RequestType&gt;
http://www.docs.oasis-open.org/ws-sx/ws-trust/200512/Issue
    &lt;/wst:RequestType&gt;
    &lt;wsp:AppliesTo&gt; ... &lt;/wsp:AppliesTo&gt; ?
    &lt;wsp:Policy&gt; ?
        &lt;saml:Attribute&gt; +
    &lt;/wsp:Policy&gt;
    &lt;wst:Lifetime&gt; ... &lt;/wst:Lifetime&gt; ?
&lt;/wst:RequestSecurityToken&gt;
</pre></div>
<p> </p>
<blockquote class="text"><dl>
<dt>&lt;wst:TokenType&gt; - MANDATORY</dt>
<dd>The client SHALL set the value 'http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV2.0'.  If the server detects a different value it MAY return a fault.
</dd>
<dt>&lt;wst:RequestType&gt; - MANDATORY</dt>
<dd>The client SHALL set the value 'http://www.docs.oasis-open.org/ws-sx/ws-trust/200512/Issue'  If the server detects a different value it SHALL return a fault.
			
</dd>
<dt>&lt;wsp:AppliesTo&gt; - OPTIONAL</dt>
<dd>If present, the client MUST set the value to a URI identifying the resource, or class of resource, to which access is requested.	If the validation server is policy-aware, it SHOULD use this value to select the applicable authentication policy.  Otherwise, it MUST ignore it.
			
</dd>
<dt>&lt;wsp:Policy/saml:Attribute&gt; - OPTIONAL</dt>
<dd>If present, this element MUST identify a verified end-user attribute requested from the validation server.  Even if the validation server cannot provide all the requested attributes, it SHOULD proceed with the validation process. 
			
</dd>
<dt>&lt;wst:Lifetime&gt; - OPTIONAL</dt>
<dd>The client MAY specify the lifetime of the requested assertion using this element.  The server MUST verify that the requested lifetime conforms with its own policy for assertion lifetimes.
			
</dd>
<dt>&lt;wst:RequestSecurityToken/@Context&gt; - MANDATORY</dt>
<dd>This attribute MUST be set by the client.  The server MUST use the value as the &lt;wst:RequestSecurityToken/@Context&gt; value in the response.
			
</dd>
</dl></blockquote><p>
		
</p>
<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.2"></a><h3>7.2.&nbsp;
Request Security Token Response</h3>

<p>The common requirements for the final "request security token response" message are shown in this example:
		
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;wst:RequestSecurityTokenResponse Context=" ... "&gt;
    &lt;wst:RequestedSecurityToken&gt;
          ...
    &lt;/wst:RequestedSecurityToken&gt;
    &lt;wst:Claims Dialect="..."&gt;
        &lt;saml:Attribute/&gt; +
    &lt;/wst:Claims&gt; ?
    &lt;wsp:AppliesTo&gt; ... &lt;/wsp:AppliesTo&gt; ?
    &lt;wsp:Policy&gt; ?
        &lt;wsp:RequiredElement&gt; +
    &lt;/wsp:Policy&gt;
&lt;/wst:RequestSecurityTokenResponse&gt;
</pre></div>
<p>If the authentication data failed to validate, then the server MUST include the &lt;env:Body/env:Fault&gt; element containing the value wst:FailedAuthentication.  In this case, it SHALL NOT include any other elements.
</p>
<p>If the authentication data failed to validate due to missing authentication data, then the server MUST include the &lt;env:Body/env:Fault&gt; element containing the value valid:MissingAuthenticationData.  In this case, it SHALL NOT include any other elements.
</p>
<p> </p>
<blockquote class="text"><dl>
<dt>&lt;wst:RequestedSecurityToken&gt; - OPTIONAL -  Zero or more</dt>
<dd>If validation is complete and successful, then the server SHALL include a SAML assertion containing verified end-user attributes. Otherwise this element SHALL be omitted. The server SHOULD set the assertion lifetime in accordance with the lifetime specified in the request, or its own policy, whichever is more restrictive.
</dd>
<dt>&lt;wst:RequestType&gt; - MANDATORY</dt>
<dd>The client SHALL set the value 'http://www.docs.oasis-open.org/ws-sx/ws-trust/200512/Issue'  If the server detects a different value it SHALL return a fault.
			
</dd>
<dt>&lt;wst:Claims&gt; - OPTIONAL</dt>
<dd>If present, the server SHALL populate this element with verified end-user attributes.
			
</dd>
<dt>&lt;wst:Claims/@Dialect&gt; - OPTIONAL</dt>
<dd>The server SHALL set the value "urn:oasis:names:tc:SAML:2.0".  The client MAY reject responses containing a different value.
			
</dd>
<dt>&lt;wpt:AppliesTo&gt; - OPTIONAL</dt>
<dd>If the authentication assurance level achieved is suitable only for a sub-set of resources, the validation server MUST set a value that identifies that sub-set.The client SHOULD restrict access to resources falling within the sub-set defined by this element.
</dd>
<dt>&lt;wst:RequestSecurityToken/@Context&gt; - MANDATORY</dt>
<dd>The server MUST include the @Context value from the request.  The client SHOULD load the context identified by the value.
			
</dd>
</dl></blockquote><p>
		
</p>
<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Mechanism-specific message contents</h3>

<p>The mechanism-specific requirements for message contents are described in the appendices.  These MAY be used in any combination.
</p>
<a name="Extensibility"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Extensibility</h3>

<p>This section lists a few common extension points provided by VALID: 
</p>
<p>
				</p>
<blockquote class="text"><dl>
<dt>New VALID Version:</dt>
<dd>Whenever it is necessary to define a new version
						of this document then a new version number has to be allocated to refer to
						the new specification version. The rules
						for extensibililty are defined in <a class='info' href='#iana'>Section&nbsp;10<span> (</span><span class='info'>IANA Considerations</span><span>)</span></a>.
</dd>
</dl></blockquote><p>
			
</p>
<a name="iana"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
IANA Considerations</h3>

<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.1"></a><h3>10.1.&nbsp;
XML namespace registration</h3>

<p> This section registers a new XML namespace,
					"urn:ietf:params:xml:ns:valid", per the guidelines in <a class='info' href='#RFC3688'>[RFC3688]<span> (</span><span class='info'>Mealling, M., &ldquo;The IETF XML Registry,&rdquo; January&nbsp;2004.</span><span>)</span></a>. 
</p>
<p>
					</p>
<blockquote class="text"><dl>
<dt>URI:</dt>
<dd>urn:ietf:params:xml:ns:valid
</dd>
<dt>Registrant Contact:</dt>
<dd>Philip Hoyer
							(phoyer@actividentity.com).
</dd>
<dt>XML:</dt>
<dd>
							<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
BEGIN
&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML Basic 1.0//EN"
  "http://www.w3.org/TR/xhtml-basic/xhtml-basic10.dtd"&gt;
&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;
&lt;head&gt;
  &lt;meta http-equiv="content-type"
        content="text/html;charset=iso-8859-1"/&gt;
  &lt;title&gt;VALID Namespace&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;h1&gt;Namespace for VALID&lt;/h1&gt;
  &lt;h2&gt;urn:ietf:params:xml:ns:valid&lt;/h2&gt;
&lt;p&gt;See &lt;a href="[URL of published RFC]"&gt;RFCXXXX
    [NOTE TO IANA/RFC-EDITOR:
     Please replace XXXX with the RFC number of this
    specification.]&lt;/a&gt;.&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;
END
</pre></div>
						
</dd>
</dl></blockquote><p>
				
</p>
<a name="anchor25"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.2"></a><h3>10.2.&nbsp;
VALID Version Registry</h3>

<p>IANA is requested to create a registry for VALID version numbers. The registry has
					the following structure: </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  VALID Version              | Specification
+---------------------------+----------------
| 1.0                       | [This document]
</pre></div><p>

				
</p>
<p> Standards action is required to define new versions of VALID. It is not
					envisioned to depreciate, delete, or modify existing VALID versions. 
</p>
<a name="anchor26"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
Security Considerations</h3>

<p>The validation server SHOULD authenticate the client and limit access to the validation service only to authorized clients.  This MAY be achieved by object level security (e.g xml signatures as defined in <a class='info' href='#XMLDSIG'>[XMLDSIG]<span> (</span><span class='info'>Eastlake, D., &ldquo;XML-Signature Syntax and Processing,&rdquo; February&nbsp;2002.</span><span>)</span></a> applied to the &lt;env:Header&gt; and &lt;env:Body&gt; elements), transport layer security (e.g. [TLS]) or network layer security (e.g. isolated network segment).
</p>
<p>The application MAY authenticate the validation server.  This MAY be achieved by object level security (e.g. xml signatures as defined in <a class='info' href='#XMLDSIG'>[XMLDSIG]<span> (</span><span class='info'>Eastlake, D., &ldquo;XML-Signature Syntax and Processing,&rdquo; February&nbsp;2002.</span><span>)</span></a> applied to the &lt;env:Header&gt; and &lt;env:Body&gt; elements or assertion), transport layer security (e.g. TLS) or network layer security (e.g. isolated network segment).
</p>
<p>The chosen authentication mechanism MUST ensure freshness of the exchanges in order to detect replay attacks.
</p>
<p>Privacy of the authentication data and end-user attributes MAY also require protection.
</p>
<a name="anchor27"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12"></a><h3>12.&nbsp;
Acknowledgements</h3>

<p> The authors of this draft would like to thank the following people for their
				feedback: Siddharth Bajaj, David M'Raihi, Mike Davis and Peter Tapling. 
</p>
<p>This work is based on earlier work by the members of OATH (Initiative for Open
				AuTHentication), see <a class='info' href='#OATH'>[OATH]<span> (</span><span class='info'>, &ldquo;Initiative for Open AuTHentication,&rdquo; .</span><span>)</span></a>, to specify a format that can be freely
				distributed to the technical community.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.13"></a><h3>13.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>13.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text">&ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3023">[RFC3023]</a></td>
<td class="author-text">Murata, M., St. Laurent, S., and D. Kohn, &ldquo;<a href="http://tools.ietf.org/html/rfc3023">XML Media Types</a>,&rdquo; RFC&nbsp;3023, January&nbsp;2001.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3688">[RFC3688]</a></td>
<td class="author-text">Mealling, M., &ldquo;<a href="http://tools.ietf.org/html/rfc3688">The IETF XML Registry</a>,&rdquo; BCP&nbsp;81, RFC&nbsp;3688, January&nbsp;2004.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4288">[RFC4288]</a></td>
<td class="author-text">Freed, N. and J. Klensin, &ldquo;<a href="http://tools.ietf.org/html/rfc4288">Media Type Specifications and Registration Procedures</a>,&rdquo; BCP&nbsp;13, RFC&nbsp;4288, December&nbsp;2005.</td></tr>
<tr><td class="author-text" valign="top"><a name="SAML">[SAML]</a></td>
<td class="author-text">Cantor, S., Kemp, J., Philpott, R., and E. Maler, &ldquo;WS-Trust 1.4,&rdquo; URL:&nbsp;http://docs.oasis-open.org/security/saml/v2.0/saml-core-2.0-os.pdf, OASIS&nbsp;Standard Specification, March&nbsp;2005.</td></tr>
<tr><td class="author-text" valign="top"><a name="SOAP">[SOAP]</a></td>
<td class="author-text">Gudgin, M., &ldquo;Simple Object Access Protocol 1.2,&rdquo; URL:&nbsp;http://www.w3.org/TR/soap12-part1/, W3C&nbsp;Recommendation, April&nbsp;2007.</td></tr>
<tr><td class="author-text" valign="top"><a name="WS-Security">[WS-Security]</a></td>
<td class="author-text">Nadalin, A., Kaler, C., Monzillo, R., and P. Hallam-Baker, &ldquo;Web Services Security: SOAP Message Security 1.1,&rdquo; URL:&nbsp;http://www.oasis-open.org/committees/download.php/16790/wss-v1.1-spec-os-SOAPMessageSecurity.pdf, OASIS&nbsp;Standard Specification, Feb&nbsp;2006.</td></tr>
<tr><td class="author-text" valign="top"><a name="WS-Trust">[WS-Trust]</a></td>
<td class="author-text">Nadalin, A., Goodner, M., Gudgin, M., Barbir, A., and H. Granqvist, &ldquo;WS-Trust 1.4,&rdquo; URL:&nbsp;http://docs.oasis-open.org/ws-sx/ws-trust/v1.4/ws-trust.html, OASIS&nbsp;Standard Specification, Feb&nbsp;2009.</td></tr>
<tr><td class="author-text" valign="top"><a name="WSS_UsernameTokenProfile">[WSS_UsernameTokenProfile]</a></td>
<td class="author-text">Nadalin, A., Kaler, C., Monzillo, R., and P. Hallam-Baker, &ldquo;Web Services Security UsernameToken Profile 1.1,&rdquo; URL:&nbsp;http://docs.oasis-open.org/wss/v1.1/wss-v1.1-spec-os-UsernameTokenProfile.pdf, OASIS&nbsp;Standard Specification, Feb&nbsp;2006.</td></tr>
<tr><td class="author-text" valign="top"><a name="XMLDSIG">[XMLDSIG]</a></td>
<td class="author-text">Eastlake, D., &ldquo;XML-Signature Syntax and Processing,&rdquo; URL:&nbsp;http://www.w3.org/TR/2002/REC-xmldsig-core-20020212/, W3C&nbsp;Recommendation, February&nbsp;2002.</td></tr>
<tr><td class="author-text" valign="top"><a name="XMLENC">[XMLENC]</a></td>
<td class="author-text">Eastlake, D., &ldquo;XML Encryption Syntax and Processing.,&rdquo; URL:&nbsp;http://www.w3.org/TR/xmlenc-core/, W3C&nbsp;Recommendation, December&nbsp;2002.</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>13.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="HOTP">[HOTP]</a></td>
<td class="author-text">MRaihi, D., Bellare, M., Hoornaert, F., Naccache, D., and O. Ranen, &ldquo;<a href="http://tools.ietf.org/html/rfc4226">HOTP: An HMAC-Based One Time Password Algorithm</a>,&rdquo; RFC&nbsp;4226, December&nbsp;2005.</td></tr>
<tr><td class="author-text" valign="top"><a name="OATH">[OATH]</a></td>
<td class="author-text">&ldquo;Initiative for Open AuTHentication,&rdquo; URL:&nbsp;http://www.openauthentication.org.</td></tr>
<tr><td class="author-text" valign="top"><a name="OCRA">[OCRA]</a></td>
<td class="author-text">MRaihi, D., Rydell, J., Naccache, D., Machani, S., and S. Bhajaj, &ldquo;OCRA: OATH Challenge-Response Algorithms,&rdquo; URL:&nbsp;http://docs.oasis-open.org/security/saml/v2.0/saml-core-2.0-os.pdf, IETF&nbsp;Standard draft, January&nbsp;2008.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2396">[RFC2396]</a></td>
<td class="author-text">Berners-Lee, T., Berners-Lee, T., Fielding, R., and L. Masinter, &ldquo;<a href="http://tools.ietf.org/html/rfc2396">Uniform Resource Identifiers (URI): Generic Syntax</a>,&rdquo; BCP&nbsp;26, RFC&nbsp;2396, August&nbsp;1998.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5226">[RFC5226]</a></td>
<td class="author-text">Narten, T. and H. Alvestrand, &ldquo;<a href="http://tools.ietf.org/html/rfc5226">Guidelines for Writing an IANA Considerations Section in RFCs</a>,&rdquo; BCP&nbsp;26, RFC&nbsp;5226, May&nbsp;2008.</td></tr>
<tr><td class="author-text" valign="top"><a name="XMLNS">[XMLNS]</a></td>
<td class="author-text">&ldquo;Namespaces in XML,&rdquo; W3C Recommendation&nbsp;, URL:&nbsp;http://www.w3.org/TR/1999/REC-xml-names-19990114, January&nbsp;1999.</td></tr>
</table>

<a name="WSDL"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
WSDL</h3>

<p>The validation server WSDL is shown here.
		
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;definitions targetNamespace="urn:ietf:params:xml:ns:valid"
xmlns:valid="urn:ietf:params:xml:ns:valid"
xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:SOAP-ENC="http://schemas.xmlsoap.org/soap/encoding/"
xmlns:SOAP="http://schemas.xmlsoap.org/wsdl/soap/"
xmlns:wss="http://docs.oasis-open.org/wss/2004/01/
oasis-200401-wss-wssecurity-secext-1.0"
xmlns:wst="http://docs.oasis-open.org/ws-sx/ws-trust/200512"
xmlns:wst14="http://docs.oasis-open.org/ws-sx/ws-trust/200802"
xmlns:wsp="http://www.w3.org/ns/ws-policy"
xmlns="http://schemas.xmlsoap.org/wsdl/"&gt;
 &lt;types&gt;
  &lt;xsd:schema xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xmlns:xsd="http://www.w3.org/2001/XMLSchema"
  xmlns:SOAP="http://schemas.xmlsoap.org/wsdl/soap/"
  xmlns:valid="urn:ietf:params:xml:ns:valid"
  xmlns:wss="http://docs.oasis-open.org/wss/2004/01/
  oasis-200401-wss-wssecurity-secext-1.0"
  xmlns:wst="http://docs.oasis-open.org/ws-sx/ws-trust/200512"
  xmlns:wst14="http://docs.oasis-open.org/ws-sx/ws-trust/200802"
  xmlns:wsp="http://www.w3.org/ns/ws-policy"
  xmlns:WSDL="http://schemas.xmlsoap.org/wsdl/"
  targetNamespace="urn:ietf:params:xml:ns:valid"
  elementFormDefault="unqualified"
  attributeFormDefault="unqualified"&gt;
   &lt;xsd:element name="RequestSecurityToken"
   ref="wst:RequestSecurityTokenType"/&gt;
   &lt;xsd:element name="RequestSecurityTokenResponse"
   ref="wst:RequestSecurityTokenResponseType"/&gt;
   &lt;xsd:element name="OTP" type="xsd:string"/&gt;
   &lt;xsd:element name="KeyId" type="xsd:string"/&gt;
  &lt;/xsd:schema&gt;
 &lt;/types&gt;
 &lt;message name="RequestSecurityToken"&gt;
  &lt;part name="request" type="valid:RequestSecurityTokenType"/&gt;
 &lt;/message&gt;
 &lt;message name="RequestSecurityTokenResponse"&gt;
  &lt;part name="response" type="valid:RequestSecurityTokenResponseType"/&gt;
 &lt;/message&gt;
 &lt;portType name="RequestSecurityToken"&gt;
  &lt;operation name="RequestSecurityTokenStart"&gt;
   &lt;input message="RequestSecurityToken"/&gt;
   &lt;output message="RequestSecurityTokenResponse"/&gt;
  &lt;/operation&gt;
  &lt;operation name="RequestSecurityTokenContinue"&gt;
   &lt;input message="RequestSecurityTokenResponse"/&gt;
   &lt;output message="RequestSecurityTokenResponse"/&gt;
  &lt;/operation&gt;
 &lt;/portType&gt;
 &lt;binding name="RequestSecurityTokenBinding"&gt;
  &lt;SOAP:binding style="rpc"
  transport="http://schemas.xmlsoap.org/soap/http"/&gt;
  &lt;operation name="RequestSecurityTokenStart"&gt;
   &lt;SOAP:operation style="rpc"/&gt;
   &lt;input&gt;
    &lt;SOAP:body use="literal" namespace="urn:ietf:params:xml:ns:valid"/&gt;
   &lt;/input&gt;
   &lt;output&gt;
    &lt;SOAP:body use="literal" namespace="urn:ietf:params:xml:ns:valid"/&gt;
   &lt;/output&gt;
  &lt;/operation&gt;
  &lt;operation name="RequestSecurityTokenContinue"&gt;
   &lt;SOAP:operation style="rpc"/&gt;
   &lt;input&gt;
    &lt;SOAP:body use="literal" namespace="urn:ietf:params:xml:ns:valid"/&gt;
   &lt;/input&gt;
   &lt;output&gt;
    &lt;SOAP:body use="literal" namespace="urn:ietf:params:xml:ns:valid"/&gt;
   &lt;/output&gt;
  &lt;/operation&gt;
 &lt;/binding&gt;
 &lt;service name="RequestSecurityToken"&gt;
  &lt;port name="RequestSecurityTokenStart"
  binding="RequestSecurityTokenBinding"&gt;
   &lt;SOAP:address
   location="http://localhost:8080/RequestSecurityTokenService"/&gt;
  &lt;/port&gt;
  &lt;port name="RequestSecurityTokenContinue"
  binding="RequestSecurityTokenBinding"&gt;
   &lt;SOAP:address
   location="http://localhost:8080/RequestSecurityTokenService"/&gt;
  &lt;/port&gt;
 &lt;/service&gt;
&lt;/definitions&gt;
</pre></div>
<a name="anchor30"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B"></a><h3>Appendix B.&nbsp;
Mechanism specific message contents</h3>

<p>The follwing subsections describe the mechanism specific message contents for each considered mechanism:
</p>
<a name="anchor31"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B.1"></a><h3>B.1.&nbsp;
Username/password</h3>

<p>This section describes the mechanism-specific message contents username/password transferred in-band.  There are no semantics implied by the order of the elements. The username and password transmission uses the web services security Username Token Profile <a class='info' href='#WSS_UsernameTokenProfile'>[WSS_UsernameTokenProfile]<span> (</span><span class='info'>Nadalin, A., Kaler, C., Monzillo, R., and P. Hallam-Baker, &ldquo;Web Services Security UsernameToken Profile 1.1,&rdquo; Feb&nbsp;2006.</span><span>)</span></a>. 
			
</p>
<p>There are two steps to the protocol.
</p>
<p>Step 1 - Client sends "request security token" message containing authentication data to the validation server.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
 &lt;wst:RequestSecurityToken Context="..."&gt;
    &lt;wst:TokenType&gt;
http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV2.0
    &lt;/wst:TokenType&gt;
    &lt;wst:RequestType&gt;
http://www.docs.oasis-open.org/ws-sx/ws-trust/200512/Issue
    &lt;/wst:RequestType&gt;
    &lt;wsp:AppliesTo&gt; ... &lt;/wsp:AppliesTo&gt; ?
    &lt;wsp:Policy&gt; ?
        &lt;saml:Attribute&gt; +
    &lt;/wsp:Policy&gt;
    &lt;wst:Lifetime&gt; ... &lt;/wst:Lifetime&gt; ?
    &lt;wss:UsernameToken&gt;
        &lt;wss:Username&gt; ... &lt;/wss:Username&gt; ?
	&lt;wss:Password Type="..."&gt;Password&lt;/wss:Password&gt;
    &lt;/wss:UsernameToken&gt;
&lt;/wst:RequestSecurityToken&gt;
</pre></div>
<p>
		</p>
<blockquote class="text"><dl>
<dt>&lt;wst:RequestSecuityToken/wss:UsernameToken/wss:Username&gt;</dt>
<dd>If present, the client MUST set the value to the claimed username.  The server MUST load the corresponding end-user record.  Either the &lt;wss:Username&gt; element or the &lt;valid:KeyId&gt; element or both MUST be present.
</dd>
<dt>&lt;wst:RequestSecuityToken/wss:UsernameToken/wss:Password&gt;</dt>
<dd>The client MUST set the value to password entered by the end user.  The server MUST validate the password.
</dd>
</dl></blockquote><p>
	
</p>
<p>The server MUST confirm that all the supplied authentication data are valid for a single end-user.
</p>
<p>Step 2 - Validation server sends "request security token response" message containing the authentication result to the client.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;wst:RequestSecurityTokenResponse Context="..."&gt;
    &lt;wst:RequestedSecurityToken&gt;
        &lt;saml:Assertion&gt; ... &lt;/saml:Assertion&gt;
    &lt;/wst:RequestedSecurityToken&gt;
    &lt;wst:Claims&gt; ... &lt;/wst:Claims&gt;
&lt;/wst:RequestSecurityTokenResponse&gt;
</pre></div>
<a name="anchor32"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B.2"></a><h3>B.2.&nbsp;
In band one-time-password (OTP)</h3>

<p>This section describes the mechanism-specific message contents for both time-based and event-based OTP protocols in which the OTP is transferred in-band.  There are no semantics implied by the order of the elements.
			
</p>
<p>There are two steps to the protocol.
</p>
<p>Step 1 - Client sends "request security token" message containing authentication data to the validation server.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
 &lt;wst:RequestSecurityToken Context="..."&gt;
    &lt;wst:TokenType&gt;
http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV2.0
    &lt;/wst:TokenType&gt;
    &lt;wst:RequestType&gt;
http://www.docs.oasis-open.org/ws-sx/ws-trust/200512/Issue
    &lt;/wst:RequestType&gt;
    &lt;wsp:AppliesTo&gt; ... &lt;/wsp:AppliesTo&gt; ?
    &lt;wsp:Policy&gt; ?
        &lt;saml:Attribute&gt; +
    &lt;/wsp:Policy&gt;
    &lt;wst:Lifetime&gt; ... &lt;/wst:Lifetime&gt; ?
    &lt;wss:UsernameToken&gt;
        &lt;wss:Username&gt; ... &lt;/wss:Username&gt; ?
        &lt;valid:KeyId&gt; ... &lt;/valid:KeyId&gt; ?
        &lt;valid:OTP&gt; ... &lt;/valid:OTP&gt;
    &lt;/wss:UsernameToken&gt;
&lt;/wst:RequestSecurityToken&gt;
</pre></div>
<p>
		</p>
<blockquote class="text"><dl>
<dt>&lt;wst:RequestSecuityToken/wss:UsernameToken/wss:Username&gt;</dt>
<dd>If present, the client MUST set the value to the claimed username.  The server MUST load the corresponding end-user record.  Either the &lt;wss:Username&gt; element or the &lt;valid:KeyId&gt; element or both MUST be present.
</dd>
<dt>&lt;wst:RequestSecuityToken/wss:UsernameToken/valid:KeyId&gt;</dt>
<dd>If present, the client MUST set the value to the OTP token identifier.  The server MUST load the corresponding token record..
</dd>
<dt>&lt;wst:RequestSecuityToken/wss:Security/valid:OTP&gt;</dt>
<dd>The client MUST set the value to the OTP value.  The server MUST validate the OTP.
</dd>
</dl></blockquote><p>
	
</p>
<p>The server MUST confirm that all the supplied authentication data are valid for a single end-user.
</p>
<p>Step 2 - Validation server sends "request security token response" message containing the authentication result to the client.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;wst:RequestSecurityTokenResponse Context="..."&gt;
    &lt;wst:RequestedSecurityToken&gt;
        &lt;saml:Assertion&gt; ... &lt;/saml:Assertion&gt;
    &lt;/wst:RequestedSecurityToken&gt;
    &lt;wst:Claims&gt; ... &lt;/wst:Claims&gt;
&lt;/wst:RequestSecurityTokenResponse&gt;
</pre></div>
<p>The following authentication data are defined by this specification.
</p>
<p></p>
<blockquote class="text">
<p>Name: valid:OTP
</p>
<p>Type: xsd:string
</p>
<p>Description: The output value of an end-user OTP token
</p>
</blockquote>

<p></p>
<blockquote class="text">
<p>Name: valid:KeyId
</p>
<p>Type: xsd:string
</p>
<p>Description: The globally-unique identifier for the OTP token
</p>
</blockquote>

<a name="anchor33"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B.3"></a><h3>B.3.&nbsp;
In band challenge/response</h3>

<p>This appendix describes the mechanism-specific message contents for challenge/response authentication mechanisms in which both the challenge and response are transferred in-band.  Mechanisms of this type include: knowledge-based schemes, matrix card schemes and cryptographic token schemes.  There are no semantics implied by the order of the elements.
</p>
<p>There are four steps to the protocol.
</p>
<p>Step 1 - Client sends "request security token" message containingthe claimed identity to the validation server.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
 &lt;wst:RequestSecurityToken Context="..."&gt;
    &lt;wst:TokenType&gt;
http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV2.0
    &lt;/wst:TokenType&gt;
    &lt;wst:RequestType&gt;
http://www.docs.oasis-open.org/ws-sx/ws-trust/200512/Issue
    &lt;/wst:RequestType&gt;
    &lt;wsp:AppliesTo&gt; ... &lt;/wsp:AppliesTo&gt; ?
    &lt;wsp:Policy&gt; ?
        &lt;saml:Attribute&gt; +
    &lt;/wsp:Policy&gt;
    &lt;wst:Lifetime&gt; ... &lt;/wst:Lifetime&gt; ?
    &lt;wss:UsernameToken&gt;
        &lt;wss:Username&gt; ... &lt;/wss:Username&gt; ?
        &lt;valid:KeyId&gt; ... &lt;/valid:KeyId&gt; ?
    &lt;/wss:UsernameToken&gt;
&lt;/wst:RequestSecurityToken&gt;
</pre></div>
<p>Step 2 - Validation server sends "request security token response" message containing the challenge to the client.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;wst:RequestSecurityTokenResponse Context="..."&gt;
    &lt;wst14:InteractiveChallenge&gt;
        ...
    &lt;/wst14:InteractiveChallenge&gt;
&lt;/wst:RequestSecurityTokenResponse&gt;
</pre></div>
<p>
		</p>
<blockquote class="text"><dl>
<dt>&lt;wst:RequestSecurityTokenResponse/wst14:InteractiveChallenge&gt;</dt>
<dd>The server MUST set the contents to the value of the challenge.
</dd>
</dl></blockquote><p>
	
</p>
<p>Step 3 - Client sends "request security token response" message containing the response to the server.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;wst:RequestSecurityTokenResponse Context="..."&gt;
    &lt;wst14:InteractiveChallengeResponse&gt;
        ...
    &lt;/wst14:InteractiveChallengeResponse&gt;
&lt;/wst:RequestSecurityTokenResponse&gt;
</pre></div>
<p>
		</p>
<blockquote class="text"><dl>
<dt>&lt;wst:RequestSecurityTokenReponse/wst14:InteractiveChallengeResponse&gt;</dt>
<dd>The client MUST set the value to the transformed challenge.  The server MUST validate the transformed challenge.
</dd>
</dl></blockquote><p>
	
</p>
<p>Step 4 - Server sends "request security token response" message containing the authentication result to the client.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;wst:RequestSecurityTokenResponse Context="..."&gt;
    &lt;wst:RequestedSecurityToken&gt;
        &lt;saml:Assertion&gt; ... &lt;/saml:Assertion&gt;
    &lt;/wst:RequestedSecurityToken&gt;
    &lt;wst:Claims&gt; ... &lt;/wst:Claims&gt;
&lt;/wst:RequestSecurityTokenResponse&gt;
</pre></div>
<a name="anchor34"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B.4"></a><h3>B.4.&nbsp;
Out-of-band challenge</h3>

<p>This appendix describes the mechanism-specific message contents for challenge/response mechanisms in which the challenge is passed to the end-user out-of-band.  Such mechanisms involve a separate communication channel, such as voice telephone, email or SMS.  There are no semantics implied by the order of the elements.
</p>
<p>There are four steps to the protocol.
</p>
<p>Step 1 - Client sends "request security token" message containing claimed identity to the server.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;wst:RequestSecurityToken Context="..."&gt;
    &lt;wst:TokenType&gt;
http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV2.0
    &lt;/wst:TokenType&gt;
    &lt;wst:RequestType&gt;
http://www.docs.oasis-open.org/ws-sx/ws-trust/200512/Issue
    &lt;/wst:RequestType&gt;
    &lt;wsp:AppliesTo&gt; ... &lt;/wsp:AppliesTo&gt; ?
    &lt;wsp:Policy&gt; ?
        &lt;saml:Attribute&gt; +
    &lt;/wsp:Policy&gt;
    &lt;wst:Lifetime&gt; ... &lt;/wst:Lifetime&gt; ?
    &lt;wss:UsernameToken&gt;
        &lt;wss:Username&gt; ... &lt;/wss:Username&gt;
        &lt;valid:KeyId&gt; ... &lt;/valid:KeyId&gt; ?
    &lt;/wss:UsernameToken&gt;
&lt;/wst:RequestSecurityToken&gt;
</pre></div>
<p>Step 2 - (Optional, in the asynchronous case) Server sends "pending" to the client.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;env:Body/env:Fault&gt;
	valid:Pending
&lt;/env:Body/env:Fault&gt;
</pre></div>
<p>Both the client and server close the session.
</p>
<p>Step 3 - Once the client receives the response, it sends the "request security token response" message to the server..
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;wst:RequestSecurityTokenResponse Context="..."&gt;
    &lt;wst14:InteractiveChallengeResponse&gt;
        ...
    &lt;/wst14:InteractiveChallengeResponse&gt;
&lt;/wst:RequestSecurityTokenResponse&gt;
</pre></div>
<p>Step 4 - Server sends "request security token response" message containing the authentication result to the client.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;wst:RequestSecurityTokenResponse Context="..."&gt;
    &lt;wst:RequestedSecurityToken&gt;
        &lt;saml:Assertion&gt; ... &lt;/saml:Assertion&gt;
    &lt;/wst:RequestedSecurityToken&gt;
    &lt;wst:Claims&gt; ... &lt;/wst:Claims&gt;
&lt;/wst:RequestSecurityTokenResponse&gt;
</pre></div>
<p>The &lt;wst:RequestSecurityTokenResponse/@Context&gt; attribute value MUST be the same as that used in steps 1, 2 and 3.
</p>
<a name="anchor35"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B.5"></a><h3>B.5.&nbsp;
Out-of-band response</h3>

<p>This appendix describes the mechanism-specific message contents for challenge/response mechanisms in which the response is returned to the validation server out-of-band.  Such mechanisms involve a separate communication channel, such as voice telephone, email or SMS.  There are no semantics implied by the order of the elements.
</p>
<p>There are four steps to the protocol.
</p>
<p>Step 1 - Client sends "request security token" message containing the claimed identity to the server.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;wst:RequestSecurityToken Context="..."&gt;
    &lt;wst:TokenType&gt;
http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV2.0
    &lt;/wst:TokenType&gt;
    &lt;wst:RequestType&gt;
http://www.docs.oasis-open.org/ws-sx/ws-trust/200512/Issue
    &lt;/wst:RequestType&gt;
    &lt;wsp:AppliesTo&gt; ... &lt;/wsp:AppliesTo&gt; ?
    &lt;wsp:Policy&gt; ?
        &lt;saml:Attribute&gt; +
    &lt;/wsp:Policy&gt;
    &lt;wst:Lifetime&gt; ... &lt;/wst:Lifetime&gt; ?
    &lt;wss:UsernameToken&gt;
        &lt;wss:Username&gt; ... &lt;/wss:Username&gt;
        &lt;valid:KeyId&gt; ... &lt;/valid:KeyId&gt; ?
    &lt;/wss:UsernameToken&gt;
&lt;/wst:RequestSecurityToken&gt;
</pre></div>
<p>Step 2 - Server sends "request security token response" message containing the challenge to the client.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;wst:RequestSecurityTokenResponse Context="..."&gt;
    &lt;wst14:InteractiveChallenge&gt;
        ...
    &lt;/wst14:InteractiveChallenge&gt;
&lt;/wst:RequestSecurityTokenResponse&gt;
</pre></div>
<p>Step 3 - (Optional - in the asynchronous case) Client sends "pending" to the server.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;env:Body/env:Fault&gt;
	valid:Pending
&lt;/env:Body/env:Fault&gt;
</pre></div>
<p>Both the client and server close the session.
</p>
<p>Step 4 - Server sends "request security token response" message containing the authentication result to the client at the registered call-back interface.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;wst:RequestSecurityTokenResponse Context="..."&gt;
    &lt;wst:RequestedSecurityToken&gt;
        &lt;saml:Assertion&gt; ... &lt;/saml:Assertion&gt;
    &lt;/wst:RequestedSecurityToken&gt;
    &lt;wst:Claims&gt; ... &lt;/wst:Claims&gt;
&lt;/wst:RequestSecurityTokenResponse&gt;
</pre></div>
<p>The &lt;wst:RequestSecurityTokenResponse/@Context&gt; attribute value MUST be the same as that used in steps 1, 2 and 3.
</p>
<a name="anchor36"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B.6"></a><h3>B.6.&nbsp;
Client supplies challenge</h3>

<p>This appendix describes the mechanism-specific message contents for challenge/response mechanisms in which the client supplies the challenge. There are no semantics implied by the order of the elements.
</p>
<p>There are two steps to the protocol.
</p>
<p>Step 1 - Client sends "request security token" message to the validation server, passing both the challenge and the response.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;wst:RequestSecurityToken Context="..."&gt;
    &lt;wst:TokenType&gt;
http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV2.0
    &lt;/wst:TokenType&gt;
    &lt;wst:RequestType&gt;
http://www.docs.oasis-open.org/ws-sx/ws-trust/200512/Issue
    &lt;/wst:RequestType&gt;
    &lt;wsp:AppliesTo&gt; ... &lt;/wsp:AppliesTo&gt; ?
    &lt;wsp:Policy&gt; ?
        &lt;saml:Attribute&gt; +
    &lt;/wsp:Policy&gt;
    &lt;wst:Lifetime&gt; ... &lt;/wst:Lifetime&gt; ?
    &lt;wst14:InteractiveChallenge&gt; ...
    &lt;/ wst14:InteractiveChallenge&gt;
    &lt;wst14:InteractiveChallengeResponse&gt; ...
    &lt;/ wst14:InteractiveChallengeResponse&gt;
&lt;/wst:RequestSecurityToken&gt;
</pre></div>
<p>
		</p>
<blockquote class="text"><dl>
<dt>&lt;wst14:InteractiveChallenge&gt;</dt>
<dd>The challenge.  This may have been obtained from the validation server by means of another interface; one not specified here.
</dd>
<dt>&lt;wst14:InteractiveChallengeResponse&gt;</dt>
<dd>The client MUST set the value to the transformed challenge.  The server MUST validate the transformed challenge.
</dd>
</dl></blockquote><p>
	
</p>
<p>Step 2 - Validation server returns "request security token response" message containing the assertion and claims to the client.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;wst:RequestSecurityTokenResponse Context="..."&gt;
    &lt;wst:RequestedSecurityToken&gt;
        &lt;saml:Assertion&gt; ... &lt;/saml:Assertion&gt;
    &lt;/wst:RequestedSecurityToken&gt;
    &lt;wst:Claims&gt; ... &lt;/wst:Claims&gt;
&lt;/wst:RequestSecurityTokenResponse&gt;
</pre></div>
<a name="anchor37"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B.7"></a><h3>B.7.&nbsp;
Challenge/response with signature</h3>

<p>This appendix describes the mechanism-specific message contents for challenge/response authentication mechanisms in which both the challenge and response are transferred in-band additionally to other parameters that are used in a signature (such as the simmetric signature in <a class='info' href='#OCRA'>[OCRA]<span> (</span><span class='info'>MRaihi, D., Rydell, J., Naccache, D., Machani, S., and S. Bhajaj, &ldquo;OCRA: OATH Challenge-Response Algorithms,&rdquo; January&nbsp;2008.</span><span>)</span></a>. There are no semantics implied by the order of the elements.
</p>
<p>There are four steps to the protocol.
</p>
<p>Step 1 - Client sends "request security token" message containingthe claimed identity to the validation server.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
 &lt;wst:RequestSecurityToken Context="..."&gt;
    &lt;wst:TokenType&gt;
http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV2.0
    &lt;/wst:TokenType&gt;
    &lt;wst:RequestType&gt;
http://www.docs.oasis-open.org/ws-sx/ws-trust/200512/Issue
    &lt;/wst:RequestType&gt;
    &lt;wsp:AppliesTo&gt; ... &lt;/wsp:AppliesTo&gt; ?
    &lt;wsp:Policy&gt; ?
        &lt;saml:Attribute&gt; +
    &lt;/wsp:Policy&gt;
    &lt;wst:Lifetime&gt; ... &lt;/wst:Lifetime&gt; ?
    &lt;wss:UsernameToken&gt;
        &lt;wss:Username&gt; ... &lt;/wss:Username&gt; ?
        &lt;valid:KeyId&gt; ... &lt;/valid:KeyId&gt; ?
    &lt;/wss:UsernameToken&gt;
&lt;/wst:RequestSecurityToken&gt;
</pre></div>
<p>Step 2 - Validation server sends "request security token response" message containing the set of challenges to the client.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;wst:RequestSecurityTokenResponse Context="..."&gt;
    &lt;wst14:InteractiveChallenge&gt; +
        ...
    &lt;/wst14:InteractiveChallenge&gt;
&lt;/wst:RequestSecurityTokenResponse&gt;
</pre></div>
<p>
		</p>
<blockquote class="text"><dl>
<dt>&lt;wst:RequestSecurityTokenResponse/wst14:InteractiveChallenge&gt;</dt>
<dd>The server MUST set the contents to the value of the challenge(s).
</dd>
</dl></blockquote><p>
	
</p>
<p>Step 3 - Client sends "request security token response" message containing the response(s) to the server.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;wst:RequestSecurityTokenResponse Context="..."&gt;
    &lt;wst14:InteractiveChallengeResponse&gt; +
        ...
    &lt;/wst14:InteractiveChallengeResponse&gt;
&lt;/wst:RequestSecurityTokenResponse&gt;
</pre></div>
<p>
		</p>
<blockquote class="text"><dl>
<dt>&lt;wst:RequestSecurityTokenReponse/wst14:InteractiveChallengeResponse&gt;</dt>
<dd>The client MUST set the value to the parameters of the signature (e.g. amount is set to '10000').  The server MUST validate the transformed challenge.
</dd>
</dl></blockquote><p>
	
</p>
<p>Step 4 - Server sends "request security token response" message containing the authentication result to the client.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;wst:RequestSecurityTokenResponse Context="..."&gt;
    &lt;wst:RequestedSecurityToken&gt;
        &lt;saml:Assertion&gt; ... &lt;/saml:Assertion&gt;
    &lt;/wst:RequestedSecurityToken&gt;
    &lt;wst:Claims&gt; ... &lt;/wst:Claims&gt;
&lt;/wst:RequestSecurityTokenResponse&gt;
</pre></div>
<a name="anchor38"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C"></a><h3>Appendix C.&nbsp;
Use Cases</h3>

<p>This section describes a comprehensive list of use cases that inspired the
				development of this specification. These requirements were used to derive the
				primary requirement that drove the design. These requirements are covered in the
				next section.
</p>
<p>These use cases also help in understanding the applicability of this specification to
				real world situations.
</p>
<a name="anchor39"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C.1"></a><h3>C.1.&nbsp;
Validation</h3>

<a name="anchor40"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C.1.1"></a><h3>C.1.1.&nbsp;
OTP Validation</h3>

<p>An application needs to validate an OTP obtained from an end-user, before providing the end-user with access to the requested resource(s).
The validation request may pass through several SOAP intermediaries. If this is the case, the application message needs to specify the ultimate validation server endpoint via SOAP addressing means, e.g., by using SOAP actors, to avoid the OTP being evaluated several times.
The response may include additional instructions to the token, for example that it needs to be resynchronized. This information must be defined inside a SOAP message.

</p>
<p>Valid credentials that can be passed in the valildation request:
</p>
<ul class="text">
<li>Username, PIN + OTP
</li>
<li>Username, OTP
</li>
<li>TokenId + OTP
</li>
<li>Array of TokenId + OTP
</li>
</ul><p>

</p>
<a name="anchor41"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C.1.2"></a><h3>C.1.2.&nbsp;
Challenge/Response Validation – Server generated challenge</h3>

<p>An application needs to be able to use a token implementing the OCRA challenge/response algorithm for identifying the end user. 

The application requests from the validation server the challenge to be presented to the token (with the end-user keying the challenge into the token by means of a PINPad) or the challenge presented to the API of the connected token 

The application then uses the protocol to verify the response from the token

</p>
<a name="anchor42"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C.1.3"></a><h3>C.1.3.&nbsp;
Challenge/Response Validation – User generated challenge</h3>

<p>An application needs to be able to use a token implementing the OCRA challenge/response algorithm for identifying the end user. 

The application generates the challenge to be presented to the token (with the end-user keying the challenge into the token by means of a PINPad) or the challenge presented to the API of the connected token 

The application then uses the protocol to verify the challenge and the response from the token.

</p>
<a name="anchor43"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C.1.4"></a><h3>C.1.4.&nbsp;
OTP Validation + Server managed PIN</h3>

<p>An application needs to be able to use a token implementing the TOTP algorithm as one factor and a server managed PIN as a second factor, for indetifying the end user.

The verification of both factors should occur within one message request/response pair of the protocol. 
 
</p>
<a name="anchor44"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C.1.5"></a><h3>C.1.5.&nbsp;
MatrixCardValidation – Server generated challenge</h3>

<p>An application needs to be able to use MatrixCard challenge/response algorithm for identifying the end user. 

The application will request from the validation server the challenge to be presented to the user via the user interface and the user response entered into a webform

The application will then use the protocol to verify the response from the token

</p>
<a name="anchor45"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C.2"></a><h3>C.2.&nbsp;
Synchornisation Use Cases</h3>

<p>This section describes the use cases relating to synchronisation of the token and the server.
</p>
<a name="anchor46"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C.2.1"></a><h3>C.2.1.&nbsp;
OTP Token Auto-Resync (NextOTP)</h3>

<p>An application needs to validate an OTP. The OTP could not be validated and the application decides that a re-sync is necessary.
It uses the next generated OTP from the token in the protocol to re-sync the token

</p>
<a name="anchor47"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C.2.2"></a><h3>C.2.2.&nbsp;
OTP Token Manual-resync</h3>

<p>An application needs to validate an OTP. The OTP could not be validated and the application decides that a re-sync is necessary.
It uses values that can be read by the user of the token (e.g. event counter value, time interval counter value) to re-sync the token together with the next generated OTP of the token..

</p>
<a name="anchor48"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.D"></a><h3>Appendix D.&nbsp;
Requirements</h3>

<p>This section outlines the most relevant requirements that are the basis of this work.
				Several of the requirements were derived from use cases described above. </p>
<blockquote class="text"><dl>
<dt>R1:</dt>
<dd>The protocol must support authentication of request originator.
</dd>
<dt>R2:</dt>
<dd>The protocol must support  management data flows (e.g., related to token synchronization)
</dd>
<dt>R3:</dt>
<dd>The protocol needs to support the following algorithms 
<ul class="text">
<li>HOTP
</li>
<li>OCRA
</li>
<li>TOTP
</li>
<li>Proprietary OTP
</li>
<li>Proprietary Challenge/Response
</li>
<li>Matrix cards
</li>
<li>SMS OTP
</li>
</ul>
					
</dd>
<dt>R4:</dt>
<dd>The protocol must be XML/Web Services based.
</dd>
<dt>R5:</dt>
<dd>The protocol must support SOAP intermediaries.
</dd>
</dl></blockquote><p>
			
</p>
<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Philip Hoyer</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">ActivIdentity, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">117 Waterloo Road</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">London, SE1  8UL</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">UK</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+44 (0) 20 7744 6455</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:phoyer@actividentity.com">phoyer@actividentity.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Tim Moses</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Entrust, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">1000 Innovation Drive</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Ottawa, Ontario  K2K 3E7</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Canada</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 (613) 270-3400</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:tim.mosesi@entrust.com">tim.mosesi@entrust.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Mingliang Pei</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">VeriSign, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">487 E. Middlefield Road</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Mountain View, CA  94043</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 650 426 5173</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:mpei@verisign.com">mpei@verisign.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Salah Machani</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Diversinet, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">2225 Sheppard Avenue East</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Suite 1801</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Toronto, Ontario  M2J 5C2</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Canada</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 416 756 2324 Ext. 321</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:smachani@diversinet.com">smachani@diversinet.com</a></td></tr>
</table>
</body></html>
