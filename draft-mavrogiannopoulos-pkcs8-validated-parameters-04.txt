



Network Working Group                               N. Mavrogiannopoulos
Internet-Draft                                                   Red Hat
Intended status: Informational                           August 21, 2018
Expires: February 22, 2019


                Storing validation parameters in PKCS#8
         draft-mavrogiannopoulos-pkcs8-validated-parameters-04

Abstract

   This memo describes a method of storing parameters needed for private
   key validation in the Private-Key Information Syntax Specification as
   defined in RFC5208 (PKCS#8) format.  It is equally applicable to the
   alternative implementation of the Private-Key Information Syntax
   Specification as defined in RFC 5958.

   The approach described in this document encodes the parameters under
   a private enterprise extension and does not form part of a formal
   standard.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at http://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on February 22, 2019.

Copyright Notice

   Copyright (c) 2018 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (http://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect



Mavrogiannopoulos       Expires February 22, 2019               [Page 1]

Internet-Draft   Storing validation parameters in PKCS#8     August 2018


   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

1.  Introduction

   RSA or DSA private keys generated using the Shawe-Taylor prime
   generation algorithm describled in [FIPS186-4] allow for parameter
   validation, i.e., verify whether the primes are actually prime, and
   were correctly generated.  That is done by generating the parameters
   from a known seed and a selected hash algorithm.

   Storing these parameters in a private key format such as the RSA
   Private Key Syntax from PKCS#1 [RFC8017], or common representations
   for DSA private keys, does not allow attaching information on the
   parameters needed for validation.  The purpose of the document is to
   describe such a method using the Private-Key Information Syntax
   Specification as defined in [RFC5208], as well as on the alternative
   specification on [RFC5958].

   The approach described in this document encodes the parameters under
   a private enterprise extension and does not form part of a formal
   standard.  The encoding can be used as is, or could be used as the
   basis for a standard at a later time.

2.  ValidationParams attribute

   The information related to the validation parameters is stored as an
   attribute in the PrivateKeyInfo structure.  The attribute is
   identified by the id-attr-validation-parameters object identifier and
   contains as AttributeValue a single ValidationParams structure.

     id-attr-validation-parameters OBJECT IDENTIFIER ::=
                                              {1 3 6 1 4 1 2312 18 8 1}

     ValidationParams ::= SEQUENCE {
         hashAlgo OBJECT IDENTIFIER,
         seed OCTET STRING
     }

   The algorithm identifier in the ValidationParams should be a hash
   algorithm identifier for the [FIPS186-4] methods.  The
   ValidationParams sequence must be DER encoded [CCITT.X690.2002].







Mavrogiannopoulos       Expires February 22, 2019               [Page 2]

Internet-Draft   Storing validation parameters in PKCS#8     August 2018


3.  Example Structure

   The following structure contains an RSA key generated using the
   [FIPS186-4] section B.3.3 algorithm with SHA2-384 hash.  The seed
   used is
   '8af4328c87bebcec31e303b8f5537effcb6a91d947084d99a369823b36f01462'
   (hex encoded).

   -----BEGIN PRIVATE KEY-----
   MIIE/gIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQCpPwXwfhDsWA3q
   jN2BWg1xfDjvZDVNfgTV/b95g304Aty3z13xPXAhHZ3ROW3pgPxTj9fiq7ZMy4Ua
   gMpPK81v3pHX1uokC2KcGXbgbAq2Q8ClxSXgEJllRwDENufjEdV10gArt8NlIP0N
   lota1kQUuI1DMsqc5DTIa35Nq4j1GW+KmLtP0kCrGq9fMGwjDbPEpSp9DTquEMHJ
   o7kyJIjB+93ikLvBUTgbxr+jcnTLXuhA8rC8r+KXre4NPPNPRyefRcALLt/URvfA
   rTvFOQfi3vIjNhBZL5FdC+FVAr5QnF3r2+cuDPbnczr4/rr81kzFGWrwyAgF5FWu
   pFtB5IYDAgMBAAECggEAHZ88vGNsNdmRkfhWupGW4cKCuo+Y7re8Q/H2Jd/4Nin2
   FKvUPuloaztiSGDbVm+vejama/Nu5FEIumNJRYMeoVJcx2DDuUxO1ZB1aIEwfMct
   /DWd0/JDzuCXB0Cu5GTWLhlz0zMGHXihIdQ0DtGKt++3Ncg5gy1D+cIqqJB515/z
   jYdZmb0Wqmz7H3DisuxvnhiCAOuNrjcDau80hpMA9TQlb+XKNGHIBgKpJe6lnB0P
   MsS/AjDiDoEpP9GG9mv9+96rAga4Nos6avYlwWwbC6d+hHIWvWEWsmrDfcJlm2gN
   tjvG8omj00t5dAt7qGhfOoNDGr5tvJVo/g96O/0I8QKBgQDdzytVRulo9aKVdAYW
   /Nj04thtnRaqsTyFH+7ibEVwNIUuld/Bp6NnuGrY+K1siX8+zA9f8mKxuXXV9KK4
   O89Ypw9js2BxM7VYO9Gmp6e1RY3Rrd8w7pG7/KqoPWXkuixTay9eybrJMWu3TT36
   q7NheNmBHqcFmSQQuUwEmvp3MQKBgQDDVaisMJkc/sIyQh3XrlfzmMLK+GlPDucD
   w5e50fHl8Q5PmTcP20zVLhTevffCqeItSyeAno94Xdzc9vZ/rt69410kJEHyBO9L
   CmhtYz94wvSdRhbqf4VzAl2WU184sIYiIZDGsnGScgIYvo6v6mITjRhc8AMdYoPR
   rL6xp6frcwKBgFi1+avCj6mFzD+fxqu89nyCmXLFiAI+nmjTy7PM/7yPlNB76qDG
   Dil2bW1Xj+y/1R9ld6S1CVnxRbqLe+TZLuVS82m5nRHJT3b5fbD8jquGJOE+e+xT
   DgA0XoCpBa6D8yRt0uVDIyxCUsVd5DL0JusN7VehzcUEaZMyuL+CyDeRAoGBAImB
   qH6mq3Kc6Komnwlw4ttJ436sxr1vuTKOIyYdZBNB0Zg5PGi+MWU0zl5LDroLi3vl
   FwbVGBxcvxkSBU63FHhKMQw7Ne0gii+iQQcYQdtKKpb4ezNS1+exd55WTIcExTgL
   tvYZMhgsh8tRgfLWpXor7kWmdBrgeflFiOxZIL1/AoGAeBP7sdE+gzsh8jqFnVRj
   7nOg+YllJAlWsf7cTH4pLIy2Eo9D+cNjhL9LK6RaAd7PSZ1adm8HfaROA2cfCm84
   RI4c7Ue0G+N6LZiFvC0Bfi5SaPVAExXOty8UqjOCoZavSaXBPuNcTXZuzswcgbxI
   G5/kaJNHoEcdlVsPsYWKRNKgPzA9BgorBgEEAZIIEggBMS8wLQYJYIZIAWUDBAIC
   BCCK9DKMh7687DHjA7j1U37/y2qR2UcITZmjaYI7NvAUYg==
   -----END PRIVATE KEY-----

4.  Compatibility notes

   For compatibility it is recommended that implementations following
   this document, support generation and validation using the SHA2-384
   hash algorithm.

   The extension defined in this document is applicable both to the
   Private-Key Information Syntax Specification defined in [RFC5958] and
   PKCS#8 [RFC5208].




Mavrogiannopoulos       Expires February 22, 2019               [Page 3]

Internet-Draft   Storing validation parameters in PKCS#8     August 2018


5.  Security Considerations

   All the considerations in [RFC5208] and [RFC5958] apply.

6.  IANA Considerations

   None.

7.  References

7.1.  Normative References

   [RFC5208]  Kaliski, B., "Public-Key Cryptography Standards (PKCS) #8:
              Private-Key Information Syntax Specification Version 1.2",
              RFC 5208, DOI 10.17487/RFC5208, May 2008,
              <https://www.rfc-editor.org/info/rfc5208>.

   [CCITT.X680.2002]
              International International Telephone and Telegraph
              Consultative Committee, "Abstract Syntax Notation One
              (ASN.1): Specification of basic notation",
              CCITT Recommendation X.680, July 2002.

   [CCITT.X690.2002]
              International International Telephone and Telegraph
              Consultative Committee, "ASN.1 encoding rules:
              Specification of basic encoding Rules (BER), Canonical
              encoding rules (CER) and Distinguished encoding rules
              (DER)", CCITT Recommendation X.690, July 2002.

   [FIPS186-4]
              Kerry, C. and P. Gallagher, "FIPS PUB 186-4: Digital
              Signature Standard (DSS)", FEDERAL INFORMATION PROCESSING
              STANDARDS PUBLICATION , July 2013.

   [RFC5958]  Turner, S., "Asymmetric Key Packages", RFC 5958,
              DOI 10.17487/RFC5958, August 2010, <https://www.rfc-
              editor.org/info/rfc5958>.

7.2.  Informative References

   [RFC8017]  Moriarty, K., Ed., Kaliski, B., Jonsson, J., and A. Rusch,
              "PKCS #1: RSA Cryptography Specifications Version 2.2",
              RFC 8017, DOI 10.17487/RFC8017, November 2016,
              <https://www.rfc-editor.org/info/rfc8017>.






Mavrogiannopoulos       Expires February 22, 2019               [Page 4]

Internet-Draft   Storing validation parameters in PKCS#8     August 2018


   [RFC5912]  Hoffman, P. and J. Schaad, "New ASN.1 Modules for the
              Public Key Infrastructure Using X.509 (PKIX)", RFC 5912,
              DOI 10.17487/RFC5912, June 2010, <https://www.rfc-
              editor.org/info/rfc5912>.

Appendix A.  Acknowledgements

   The author would like to thank Russ Housley for his comments and for
   the ASN.1 module appendix.

Appendix B.  ASN.1 module

   This appendix provides non-normative ASN.1 definitions for the
   structures described in this specification using ASN.1 as defined in
   [CCITT.X680.2002] and [RFC5912].




































Mavrogiannopoulos       Expires February 22, 2019               [Page 5]

Internet-Draft   Storing validation parameters in PKCS#8     August 2018


      PrivateKeyValidationAttrV1
        { iso(1) identified-organization(3) dod(6) internet(1)
          private(4) enterprise(1) 2312 18 1 1 }

      DEFINITIONS IMPLICIT TAGS ::=

      BEGIN

      -- EXPORTS ALL

      IMPORTS

      ATTRIBUTE
       FROM PKIX-CommonTypes-2009  --  [RFC5912]
         { iso(1) identified-organization(3) dod(6) internet(1)
           security(5) mechanisms(5) pkix(7) id-mod(0)
           id-mod-pkixCommon-02(57) } ;

      -- PrivateKeyInfo is defined in [RFC5208].
      -- This definition adds the validation parameters attribute
      -- to the set of allowed attributes.

      PrivateKeyInfo ATTRIBUTE ::= {
        at-validation-parameters, ... }

      at-validation-parameters ATTRIBUTE ::= {
        TYPE ValidationParams
        IDENTIFIED BY id-attr-validation-parameters }

      id-attr-validation-parameters OBJECT IDENTIFIER ::=
        { 1 3 6 1 4 1 2312 18 8 1 }

      ValidationParams ::= SEQUENCE {
        hashAlg OBJECT IDENTIFIER,
        seed OCTET STRING }

      END

Author's Address

   Nikos Mavrogiannopoulos
   Red Hat, Inc.
   Brno
   Czech Republic

   Email: nmav@redhat.com





Mavrogiannopoulos       Expires February 22, 2019               [Page 6]
