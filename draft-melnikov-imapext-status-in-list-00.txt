


IMAP Extensions Working Group/MORG                           A. Melnikov
BOF                                                        Isode Limited
Internet-Draft                                               T. Sirainen
Intended status: Standards Track                           June 10, 2008
Expires: December 12, 2008


   IMAP4 Extension for returning STATUS information in extended LIST
                draft-melnikov-imapext-status-in-list-00

Status of this Memo

   By submitting this Internet-Draft, each author represents that any
   applicable patent or other IPR claims of which he or she is aware
   have been or will be disclosed, and any of which he or she becomes
   aware will be disclosed, in accordance with Section 6 of BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups.  Note that
   other groups may also distribute working documents as Internet-
   Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt.

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html.

   This Internet-Draft will expire on December 12, 2008.

Abstract

   Many IMAP clients display information about total number of messages/
   total number of unseen messages in IMAP mailboxes.  In order to do
   that they are forced to issue a LIST or LSUB command, to list all
   available mailboxes, followed by a STATUS command for each mailbox
   found.  This document provides an extension to LIST command that
   allows the client to request STATUS information for mailboxes
   together with other information typically returned by the LIST
   command.






Melnikov & Sirainen     Expires December 12, 2008               [Page 1]

Internet-Draft             STATUS in IMAP LIST                 June 2008


Note

   A revised version of this draft document will be submitted to the RFC
   editor as a Proposed Standard for the Internet Community.  Discussion
   and suggestions for improvement are requested, and should be sent to
   morg@ietf.org.


Table of Contents

   1.  Conventions used in this document . . . . . . . . . . . . . . . 3

   2.  STATUS return option to LIST command  . . . . . . . . . . . . . 3

   3.  Examples  . . . . . . . . . . . . . . . . . . . . . . . . . . . 3

   4.  Formal Syntax . . . . . . . . . . . . . . . . . . . . . . . . . 4

   5.  Security Considerations . . . . . . . . . . . . . . . . . . . . 4

   6.  IANA Considerations . . . . . . . . . . . . . . . . . . . . . . 4

   7.  Acknowledgements  . . . . . . . . . . . . . . . . . . . . . . . 5

   8.  Normative References  . . . . . . . . . . . . . . . . . . . . . 5

       Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . 6
       Intellectual Property and Copyright Statements  . . . . . . . . 7























Melnikov & Sirainen     Expires December 12, 2008               [Page 2]

Internet-Draft             STATUS in IMAP LIST                 June 2008


1.  Conventions used in this document

   In examples, "C:" indicates lines sent by a client that is connected
   to a server.  "S:" indicates lines sent by the server to the client.

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in RFC 2119 [Kwds].


2.  STATUS return option to LIST command

   [RFC3501] explicitly disallows mailbox patterns in the STATUS
   command.  The main reason was to discourage frequent use of the
   STATUS command by clients, as it might be quite expensive for an IMAP
   server to perform.  However this prohibition had resulted in an
   opposite effect: a new generation of IMAP clients appeared, that
   issues STATUS command for each mailbox returned by the LIST command.
   This behaviour is suboptimal to say at least: it wastes extra
   bandwidth and, in the case of a client that doesn't support IMAP
   pipelining, also degrades performance by using too many round trips.
   This document tries to remedy the situation by specifying a single
   command that can be used by the client to request all the necessary
   information.  In order to achieve this goal this document is
   extending the LIST command command with a new return option: STATUS.
   This option takes STATUS data items as parameters.  For each
   selectable mailbox matching the list pattern and selection options,
   the server MUST return an untagged LIST response followed by an
   untagged STATUS response containing the information requested in the
   STATUS return option.

   If an attempted STATUS for a listed mailbox fails because the mailbox
   can't be selected (e.g. if the "l" ACL right [ACL] is granted to the
   mailbox and the "r" right is not granted, or due to a race condition
   between LIST and STATUS changing the mailbox to \NoSelect), the
   STATUS response MUST NOT be returned and the LIST response MUST
   include the \NoSelect attribute.  This means the server may have to
   buffer the LIST reply until it has successfully looked up the
   necessary STATUS information.


3.  Examples

   C: A01 LIST "" % RETURN (STATUS (MESSAGES UNSEEN))
   S: * LIST () "."  "INBOX"
   S: * STATUS "INBOX" (MESSAGES 17 UNSEEN 16)
   S: * LIST () "." "foo"
   S: * STATUS "foo" (MESSAGES 30 UNSEEN 29)



Melnikov & Sirainen     Expires December 12, 2008               [Page 3]

Internet-Draft             STATUS in IMAP LIST                 June 2008


   S: * LIST (\NoSelect) "." "bar"
   S: A01 OK List completed.

   "bar" mailbox isn't selectable, so it has no STATUS reply.

   C: A02 LIST (SUBSCRIBED RECURSIVEMATCH)"" % RETURN (STATUS
   (MESSAGES))
   S: * LIST (\Subscribed) "."  "INBOX"
   S: * STATUS "INBOX" (MESSAGES 17)
   S: * LIST () "." "foo" (CHILDINFO ("SUBSCRIBED"))
   S: A02 OK List completed.

   LIST reply for "foo" is returned because it has matching children,
   but no STATUS reply is returned because "foo" itself doesn't match
   the selection criteria.


4.  Formal Syntax

   The following syntax specification uses the augmented Backus-Naur
   Form (BNF) as described in [ABNF].  Terms not defined here are taken
   from [RFC3501], [LISTEXT].

       return-option =/ status-option

       status-option = "STATUS" SP "(" status-att *(SP status-att) ")"
                       ;; This ABNF production complies with
                       ;; <option-extension> syntax.


5.  Security Considerations

   [[anchor4: TBD]]


6.  IANA Considerations

   IMAP4 capabilities are registered by publishing a standards track or
   IESG approved experimental RFC.  The registry is currently located
   at:


      http://www.iana.org/assignments/imap4-capabilities


   This document defines the X-DRAFT-I00-LIST-STATUS [[anchor5: Note to
   RFC Editor: fix before publication]] IMAP capability.  IANA is
   requested to add it to the registry.



Melnikov & Sirainen     Expires December 12, 2008               [Page 4]

Internet-Draft             STATUS in IMAP LIST                 June 2008


   IANA is also requested to add the following new LIST-EXTENDED option
   to the IANA registry established by [LISTEXT]:

   To: iana@iana.org
   Subject: Registration of LIST-EXTENDED option STATUS

   LIST-EXTENDED option name: STATUS

   LIST-EXTENDED option type: RETURN

   LIST-EXTENDED option description: Causes the LIST command to return
   STATUS responses in addition to LIST responses.

   Published specification : XXXX.

   Security considerations: XXXX.

   Intended usage: COMMON

   Person and email address to contact for further information: Alexey
   Melnikov <Alexey.Melnikov@isode.com>

   Owner/Change controller: iesg@ietf.org




7.  Acknowledgements

   TBD.


8.  Normative References

   [ABNF]     Crocker, D., Ed. and P. Overell, "Augmented BNF for Syntax
              Specifications: ABNF", RFC 5234, January 2008.

   [ACL]      Melnikov, A., "IMAP4 Access Control List (ACL) Extension",
              RFC 4314.

   [Kwds]     Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", RFC 2119, March 1997.

   [LISTEXT]  Leiba, B. and A. Melnikov, "IMAP4 LIST Command
              Extensions", RFC 5258, 2008.

   [RFC3501]  Crispin, M., "INTERNET MESSAGE ACCESS PROTOCOL - VERSION
              4rev1", RFC 3501, March 2003.



Melnikov & Sirainen     Expires December 12, 2008               [Page 5]

Internet-Draft             STATUS in IMAP LIST                 June 2008


Authors' Addresses

   Alexey Melnikov
   Isode Limited
   5 Castle Business Village
   36 Station Road
   Hampton, Middlesex  TW12 2BX
   UK

   Email: Alexey.Melnikov@isode.com
   URI:   http://www.melnikov.ca/


   Timo Sirainen

   Email: tss@iki.fi



































Melnikov & Sirainen     Expires December 12, 2008               [Page 6]

Internet-Draft             STATUS in IMAP LIST                 June 2008


Full Copyright Statement

   Copyright (C) The IETF Trust (2008).

   This document is subject to the rights, licenses and restrictions
   contained in BCP 78, and except as set forth therein, the authors
   retain all their rights.

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST AND
   THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS
   OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF
   THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.


Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in BCP 78 and BCP 79.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   http://www.ietf.org/ipr.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.











Melnikov & Sirainen     Expires December 12, 2008               [Page 7]


