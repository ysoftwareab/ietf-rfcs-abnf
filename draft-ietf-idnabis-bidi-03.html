<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>An updated IDNA criterion for right-to-left
    scripts</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="An updated IDNA criterion for right-to-left
    scripts">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">H. Alvestrand, Ed.</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Google</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">C. Karp</td></tr>
<tr><td class="header">Expires: June 3, 2009</td><td class="header">Swedish Museum of Natural History</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">November 30, 2008</td></tr>
</table></td></tr></table>
<h1><br />An updated IDNA criterion for right-to-left
    scripts<br />draft-ietf-idnabis-bidi-03</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on June 3, 2009.</p>

<h3>Abstract</h3>

<p>The use of right-to-left scripts in internationalized domain names
      has presented several challenges. This memo discusses some problems with
      these scripts, and some shortcomings in the 2003 IDNA BIDI criterion.
      Based on this discussion, it proposes a new BIDI rule for IDNA
      labels.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">1.1.</a>&nbsp;
Purpose and applicability<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">1.2.</a>&nbsp;
Background and history<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">1.3.</a>&nbsp;
Layout of the rest of this document<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#terminology">1.4.</a>&nbsp;
Terminology<br />
<a href="#rule">2.</a>&nbsp;
A replacement for the RFC 3454 BIDI rule<br />
<a href="#requirement">3.</a>&nbsp;
A requirement set for the BIDI rule<br />
<a href="#issues">4.</a>&nbsp;
Examples of issues found<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">4.1.</a>&nbsp;
Dhivehi<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">4.2.</a>&nbsp;
Yiddish<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">4.3.</a>&nbsp;
Strings with numbers<br />
<a href="#trouble">5.</a>&nbsp;
Troublesome situations and guidelines<br />
<a href="#anchor8">6.</a>&nbsp;
Other issues in need of resolution<br />
<a href="#anchor9">7.</a>&nbsp;
Compatibility considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">7.1.</a>&nbsp;
Backwards compatibility considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">7.2.</a>&nbsp;
Forward compatibility considerations<br />
<a href="#IANA">8.</a>&nbsp;
IANA Considerations<br />
<a href="#Security">9.</a>&nbsp;
Security Considerations<br />
<a href="#Acknowledgements">10.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">11.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">11.1.</a>&nbsp;
Normative references<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">11.2.</a>&nbsp;
Informative references<br />
<a href="#anchor14">Appendix&nbsp;A.</a>&nbsp;
Change log<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">A.1.</a>&nbsp;
Changes from draft-alvestrand-00 to -01<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor16">A.2.</a>&nbsp;
Changes from alvestrand-01 to -02<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor17">A.3.</a>&nbsp;
Changes from alvestrand-02 to -03<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">A.4.</a>&nbsp;
Changes from alvestrand-03 to -04<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor19">A.5.</a>&nbsp;
Changes from draft-alvestrand-04 to draft-ietf -00<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor20">A.6.</a>&nbsp;
Changes from idnabis -00 to -01<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor21">A.7.</a>&nbsp;
Changes from idnabis -01 to -02<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor22">A.8.</a>&nbsp;
Changes from idnabis -02 to -03<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Purpose and applicability</h3>

<p>This document's purpose is to establish a rule that can be applied
        to Internationalized Domain Name (IDN) labels in Unicode form
        (U-labels) containing right-to-left characters.
</p>
<p>When labels satisfy the rule, and when certain other conditions are
        satisfied, they can be used with a minimal chance of these labels
        being displayed in a confusing way by a bidirectional display
        algorithm.
</p>
<p>This specification is not intended to place any requirements on
        domain names that do not contain right-to-left characters.
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.2"></a><h3>1.2.&nbsp;
Background and history</h3>

<p>The IDNA specification "Stringprep" <a class='info' href='#RFC3454'>[RFC3454]<span> (</span><span class='info'>Hoffman, P. and M. Blanchet, &ldquo;Preparation of Internationalized Strings (&quot;stringprep&quot;),&rdquo; December&nbsp;2002.</span><span>)</span></a>
        makes the following statement in its section 6 on the BIDI
        algorithm:</p>
<blockquote class="text">
<p>3) If a string contains any RandALCat character, a RandALCat
            character MUST be the first character of the string, and a
            RandALCat character MUST be the last character of the string.
</p>
</blockquote>

<p>(A RandALCat character is a character with unambiguously
        right-to-left directionality.)
</p>
<p>The reasoning behind this prohibition was to ensure that every
        component of a displayed domain name has an unambiguously preferred
        direction. However, this makes certain words in languages written with
        right-to-left scripts invalid as IDN labels, and in at least one case
        means that all the words of an entire language are forbidden as IDN
        labels.
</p>
<p>This is illustrated below with examples taken from the Dhivehi and
        Yiddish languages, as written with the Thaana and Hebrew scripts,
        respectively.
</p>
<p>In investigating this problem, it was realized that the RFC 3454
        specification did not explicitly state the requirement to be
        fulfilled, and therefore, it was impossible to tell whether a simple
        relaxation of the rule would continue to fulfil the requirement. A
        further investigation led to the conclusion that for one reasonable
        set of requirements, IDNA2003's BIDI restriction did not fulfil the
        requirements. This document therefore proposes replacing the RFC 3454
        BIDI requirement in its entirety.
</p>
<p>While the document proposes completely new text, most reasonable
        labels that were allowed under the old criterion will also be allowed
        under the new criterion, so the operational impact of the rule change
        is limited.
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.3"></a><h3>1.3.&nbsp;
Layout of the rest of this document</h3>

<p><a class='info' href='#rule'>Section&nbsp;2<span> (</span><span class='info'>A replacement for the RFC 3454 BIDI rule</span><span>)</span></a> defines a test, the "BIDI test", that
        can be used on a domain name label to check how safe it is to use in a
        domain name of possibly mixed directionality.- one user of that test
        is the IDNA2008 protocol<a class='info' href='#I-D.ietf-idnabis-protocol'>[I&#8209;D.ietf&#8209;idnabis&#8209;protocol]<span> (</span><span class='info'>Klensin, J., &ldquo;Internationalized Domain Names in Applications (IDNA): Protocol,&rdquo; November&nbsp;2008.</span><span>)</span></a>.
</p>
<p><a class='info' href='#requirement'>Section&nbsp;3<span> (</span><span class='info'>A requirement set for the BIDI rule</span><span>)</span></a> sets out the requirements for
        defining a BIDI rule.
</p>
<p><a class='info' href='#issues'>Section&nbsp;4<span> (</span><span class='info'>Examples of issues found</span><span>)</span></a> gives detailed examples that serve as
        justification for the change proposed here.
</p>
<p><a class='info' href='#trouble'>Section&nbsp;5<span> (</span><span class='info'>Troublesome situations and guidelines</span><span>)</span></a> to <a class='info' href='#Security'>Section&nbsp;9<span> (</span><span class='info'>Security Considerations</span><span>)</span></a>
        describe various situations that can occur when dealing with domain
        names with characters of different directionality.
</p>
<p>Only <a class='info' href='#terminology'>Section&nbsp;1.4<span> (</span><span class='info'>Terminology</span><span>)</span></a> and <a class='info' href='#rule'>Section&nbsp;2<span> (</span><span class='info'>A replacement for the RFC 3454 BIDI rule</span><span>)</span></a> are normative.
</p>
<a name="terminology"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.4"></a><h3>1.4.&nbsp;
Terminology</h3>

<p>In this memo, we use "network order" to describe the sequence of
        characters as transmitted on the wire or stored in a file; the terms
        "first", "next", "previous", "before" and "after" are used to refer to
        the relationship of characters and labels in network order.
</p>
<p>We use "display order" to talk about the sequence of characters as
        imaged on a display medium; the terms "left" and "right" are used to
        refer to the relationship of characters and labels in display
        order.
</p>
<p>Most of the time, the examples use the abbreviations for the
        Unicode BIDI classes to denote the directionality of the characters;
        in some examples, the convention that uppercase characters are of
        class R or AL, and lowercase characters are of class L is used - thus,
        the example string ABC.abc would consist of 3 right-to-left characters
        and 3 left-to-right characters.
</p>
<p>The directionality of such examples is determined by context - for
        instance, in the sentence "ABC.abc is displayed as CBA.abc", the first
        example string is in network order, the second example string is in
        display order.
</p>
<p>The term "paragraph" is used in the sense of the Unicode BIDI
        specification <a class='info' href='#UAX9'>[UAX9]<span> (</span><span class='info'>Davis, M., &ldquo;Unicode Standard Annex #9: The Bidirectional Algorithm,           revision 15,&rdquo; 03&nbsp;2005.</span><span>)</span></a> - it means "a block of text
        that has an overall direction, either left-to-right or right-to-left",
        approximately; see UAX 9 for the details.
</p>
<p>"LTR" and "RTL" are abbreviations for "right to left" and "left to
        right", respectively.
</p>
<p>The terminology used for the BIDI properties of Unicode characters
        is taken from the Unicode Standard<a class='info' href='#Unicode'>[Unicode]<span> (</span><span class='info'>Unicode, &ldquo;The Unicode Standard - version 5.1,&rdquo; 2008.</span><span>)</span></a>
</p>
<p>For reference, here are the values that the Unicode BIDI property
        can have: </p>
<ul class="text">
<li>L - Left-to-right - most letters in LTR scripts
</li>
<li>R - Right-to-left - most letters in non-Arabic RTL scripts
</li>
<li>AL - Arabic letters - most letters in the Arabic script
</li>
<li>EN - European Number (0-9, and Extended Arabic-Indic
            numbers)
</li>
<li>ES - European Number Separator (+ and -)
</li>
<li>ET - European Number Terminator (currency symbols, the hash
            sign, the percent sign and so on)
</li>
<li>AN - Arabic Number
</li>
<li>CS - Common Number Separator (. , / : et al)
</li>
<li>NSM - Non spacing Mark - most combining accents
</li>
<li>BN - Boundary Neutral - control characters
</li>
<li>B - Paragraph Separator
</li>
<li>S - Segment Separator
</li>
<li>WS - Whitespace, including the SPACE character
</li>
<li>ON - Other Neutrals, including @, &amp;, parentheses, MIDDLE
            DOT
</li>
<li>LRE, LRO, RLE, RLO, PDF - these are "directional control
            characters", and are not used in IDNA labels.
</li>
</ul><p>The other terminology used to describe IDNA concepts is
        defined in <a class='info' href='#I-D.ietf-idnabis-defs'>[I&#8209;D.ietf&#8209;idnabis&#8209;defs]<span> (</span><span class='info'>Klensin, J., &ldquo;Internationalized Domain Names for Applications (IDNA): Definitions and  Document Framework,&rdquo; November&nbsp;2008.</span><span>)</span></a>
</p>
<a name="rule"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
A replacement for the RFC 3454 BIDI rule</h3>

<p>The following test has been developed for BIDI domain name labels.
      The requirements that this test satisifes are described in <a class='info' href='#requirement'>Section&nbsp;3<span> (</span><span class='info'>A requirement set for the BIDI rule</span><span>)</span></a>.
</p>
<p>A label containing a character of type R, AL or AN MUST satisfy all 7
      of the rules below.
</p>
<p>The main bullets give the rule, subordinate bullets (if any) give
      justifications or examples of things that break if this rule is not
      present.
</p>
<p></p>
<ol class="text">
<li>Only characters with the BIDI properties L, R, AL, AN, EN, ES,
          BN, ON and NSM are allowed. 
<ul class="text">
<li>B, S and WS are excluded because they are separators or
              spaces.
</li>
<li>LRE, LRO, RLE, RLO, PDF are excluded because they are BIDI
              controls.
</li>
<li>ET is excluded because the string L ET does not satisfy the
              Character Grouping requirement.
</li>
<li>CS is excluded because the string L CS does not satisfy the
              Character Grouping requirement.
</li>
</ul>
</li>
<li>ES and ON are not allowed in the first position
<ul class="text">
<li>ES R and ON R do not satisfy the Character Grouping
              requirement.
</li>
</ul>
</li>
<li>ES and ON, followed by zero or more NSM, is not allowed in the
          last position
<ul class="text">
<li>L ON and L ES both fail the Character Grouping
              requirement.
</li>
</ul>
</li>
<li>If an R, AL or AN is present, no L may be present.
</li>
<li>If an EN is present, no AN may be present, and vice versa.
</li>
<li>The first character may not be an NSM
</li>
<li>The first character may not be an EN (European Number) or an AN
          (Arabic Number).
<ul class="text">
<li>If the character on both sides of a CS is an EN or an AN, the
              labels fail the Character Grouping requirement.
</li>
<li>Some domain names where some of the labels use leading EN and
              AN may be problem-free, but there's no way of verifying this
              while looking at a single label in isolation..
</li>
<li>We could achieve stability by barring numbers at the end of
              labels, but this may be more disruptive in practice.
</li>
</ul>
</li>
</ol><p>The following guarantees can be made based on the above:
</p>
<p></p>
<ul class="text">
<li>In a domain name consisting of only labels that pass the test,
          the requirements of <a class='info' href='#requirement'>Section&nbsp;3<span> (</span><span class='info'>A requirement set for the BIDI rule</span><span>)</span></a> are
          satisfied.
</li>
<li>In a domain name consisting of only LDH-labels and labels that
          pass the test, the requirements of <a class='info' href='#requirement'>Section&nbsp;3<span> (</span><span class='info'>A requirement set for the BIDI rule</span><span>)</span></a> are satisfied as long as a label that
          starts with an ASCII digit does not come after a right-to-left label
          that ends in a digit.
</li>
</ul><p>No guarantee is given for other combinations.
</p>
<a name="requirement"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
A requirement set for the BIDI rule</h3>

<p>One issue with RFC 3454 was that it did not give an explicit
      justification for the BIDI rule, thus it was hard to tell if a modified
      rule would continue to fulfil the purpose for which the RFC 3454 rule
      was written.
</p>
<p>This document proposes an explicit justification, by stating a set of
      requirements for which it is possible to test whether or not the
      modified rule fulfils the requirement.
</p>
<p>All the text in this document assumes that text containing the labels
      under consideration will be displayed using the Unicode bidirectional
      algorithm <a class='info' href='#UAX9'>[UAX9]<span> (</span><span class='info'>Davis, M., &ldquo;Unicode Standard Annex #9: The Bidirectional Algorithm,           revision 15,&rdquo; 03&nbsp;2005.</span><span>)</span></a>.
</p>
<p>The requirements proposed are these:</p>
<ul class="text">
<li>Label Uniqueness: No two labels, when presented in display order
          in the same paragraph, should have the same sequence of characters
          without also having the same sequence of characters in network
          order, both when the paragraph has LTR direction and when the
          paragraph has RTL direction. (This is the criterion that is explicit
          in RFC 3454). (Note that a label displayed in an RTL paragraph may
          display the same as a different label displayed in a LTR paragraph,
          and still satisfy this criterion.)
</li>
<li>Character Grouping: When displaying a string of labels, using the
          Unicode BIDI algorithm to reorder the characters for display, the
          characters of each label should remain grouped between the
          characters delimiting the labels, both when the string is embedded
          in a paragraph with LTR direction and when it's embedded in a
          paragraph with RTL direction.
</li>
</ul>

<p>Several stronger statements were considered and rejected, because
      they seem to be impossible to fulfil within the constraints of the
      Unicode bidirectional algorithm. These include:
</p>
<p></p>
<ul class="text">
<li>The appearance of a label should be unaffected by its embedding
          context. This proved impossible even for ASCII labels; the label
          "123-456" will have a different display order in an RTL context than
          in a LTR context.
</li>
<li>The sequence of labels should be consistent with network order.
          This proved impossible - a domain name consisting of the labels (in
          network order) L1.R1.R2.L2 will be displayed as L1.R2.R1.L2 in an
          LTR context. (In a RTL context, it will be displayed as
          L2.R2.R1.L1).
</li>
<li>The Label Uniqueness property should hold true between LTR
          paragraphs and RTL paragraphs. This was shown to be unsound.
</li>
<li>No two domain names should be displayed the same, even under
          differing directionality. This was shown to be unsound, since the
          domain name (network) ABC.abc will have display order CBA.abc in an
          LTR context and abc.CBA in an RTL context, while the domain name
          (network) abc.ABC will have display order abc.CBA in an LTR context
          and CBA.abc in an RTL context.
</li>
</ul>

<p>One specific requirement was thought to be problematic, but turned
      out to be satisfied by a string that obeys the proposed rules:
</p>
<p></p>
<ul class="text">
<li>The Character Grouping requirement should be satisfied when
          directional controls (LRE, RLE, RLO, LRO, PDF) are used in the same
          paragraph (outside of the labels). Because these controls affect
          presentation order in non-obvious ways, by affecting the "sor" and
          "eor" properties of the Unicode BIDI algorithm, the conditions above
          require extra testing in order to figure out whether or not they
          influence the display of the domain name. Testing found that for the
          strings allowed under the rule presented in this document,
          directional controls do not influence the display of the domain
          name.
</li>
</ul>

<p>In the following descriptions, first-level bullets are used to
      indicate rules or normative statements; second-level bullets are
      commentary.
</p>
<p>The Character Grouping requirement can be more formally stated
      as:</p>
<ul class="text">
<li>Let "Delimiterchars" be a set of characters with the Unicode BIDI
          properties CS, WS, ON. (These are commonly used to delimit labels -
          both the FULL STOP and the space are included.) 
<ul class="text">
<li>ET, though it commonly occurs next to domain names in
              practice, is problematic: the context R CS L EN ET (for instance
              A.a1%) makes the label L EN not satisfy the character grouping
              requirement.
</li>
<li>ES commonly occurs in labels as HYPHEN-MINUS, but could also
              be used as a delimiter (for instance, the plus sign). It is left
              out here.
</li>
</ul>
</li>
<li>Let "unproblematic label" be a label that either satisfies the
          requirements, or does not contain any character with the BIDI
          properties R, AL or AN, and does not begin with a character with the
          BIDI property EN. (Informally, "it does not start with a
          number".)
</li>
</ul>

<p>A label L satisfies the Character Grouping requirement when, for any
      Delimiter Character D1 and D2, and for any label S1 and S2 that is
      either a label satisfying the requirements or an unproblematic label,
      the following holds true:
</p>
<p>If the string formed by concatenating S1, D1, L, D2 and S2 is
      reordered according to the BIDI algorithm, then all the characters of L
      in the reordered string are between D1 and D2, and no other characters
      are between D1 and D2, both if the overall paragraph direction is LTR
      and if the overall paragraph direction is RTL.
</p>
<p>Note that the definition is self-referential, since S1 and S2 are
      constrained to be "legal" by this definition; this makes testing changes
      to proposed rules a little complex, but does not create problems for
      testing whether or not a given proposed rule satisfies the
      criterion.
</p>
<p>(The "zero-length" case represents the case where a domain name is
      next to something that isn't a domain name, separated by a delimiter
      character).
</p>
<p>The Label Uniqueness requirement can be formally stated as:
</p>
<p>If two labels L and L', embedded as for the test above, displayed in
      paragraphs with the same directionality, are reordered by the BIDI
      algorithm into the same sequence of codepoints, at most one of the
      labels L and L' is a legal label.
</p>
<a name="issues"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Examples of issues found</h3>

<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Dhivehi</h3>

<p>Dhivehi, the official language of the Maldives, is written with the
        Thaana script. This displays some of the characteristics of Arabic
        script, including its directional properties, and the indication of
        vowels by the diacritical marking of consonantal base characters. This
        marking is obligatory, and both double vowels and syllable-final
        consonants are indicated by the marking of special unvoiced
        characters. Every Dhivehi word therefore ends with a combining
        mark.
</p>
<p>The word for "computer", which is romanized as "konpeetaru", is
        written with the following sequence of Unicode code points:
</p>
<p></p>
<blockquote class="text">
<p>U+0786 THAANA LETTER KAAFU (AL)
</p>
<p>U+07AE THAANA OBOFILI (NSM)
</p>
<p>U+0782 THAANA LETTER NOONU (AL)
</p>
<p>U+07B0 THAANA SUKUN (NSM)
</p>
<p>U+0795 THAANA LETTER PAVIYANI (AL)
</p>
<p>U+07A9 THAANA LETTER EEBEEFILI (AL)
</p>
<p>U+0793 THAANA LETTER TAVIYANI (AL)
</p>
<p>U+07A6 THAANA ABAFILI (NSM)
</p>
<p>U+0783 THAANA LETTER RAA (AL)
</p>
<p>U+07AA THAANA UBIUFILI (NSM)
</p>
</blockquote>

<p>The directionality class of U+07AA in the Unicode database <a class='info' href='#Unicode'>[Unicode]<span> (</span><span class='info'>Unicode, &ldquo;The Unicode Standard - version 5.1,&rdquo; 2008.</span><span>)</span></a> is NSM (non-spacing mark), which is not R or
        AL; a conformant implementation of the IDNA2003 algorithm will say
        that "this is not in RandALCat", and refuse to encode the string.
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Yiddish</h3>

<p>Yiddish is one of several languages written with the Hebrew script
        (others include Hebrew and Ladino). This is basically a consonantal
        alphabet (also termed an "abjad") but Yiddish is written using an
        extended form that is fully vocalic. The vowels are indicated in
        several ways, of which one is by repurposing letters that are
        consonants in Hebrew. Other letters are used both as vowels and
        consonants, with combining marks, called "points", used to
        differentiate between them. Finally, some base characters can indicate
        several different vowels, which are also disambiguated by combining
        marks. Pointed characters can appear in word-final position and may
        therefore also be needed at the end of labels. This is not an
        invariable attribute of a Yiddish string and there is thus greater
        latitude here than there is with Dhivehi.
</p>
<p>The organization now known as the "YIVO Institute for Jewish
        Research" developed orthographic rules for modern Standard Yiddish
        during the 1930s on the basis of work conducted in several venues
        since earlier in that century. These are given in, "The Standardized
        Yiddish Orthography: Rules of Yiddish Spelling" <a class='info' href='#SYO'>[SYO]<span> (</span><span class='info'>, &ldquo;The Standardized Yiddish Orthography: Rules of Yiddish           Spelling, 6th ed., , New York, ISBN 0-914512-25-0&quot;,,&rdquo; 1999.</span><span>)</span></a>, and are taken as normatively descriptive of
        modern Standard Yiddish in any context where that notion is deemed
        relevant. They have been applied exclusively in all Yiddish
        dictionaries published since their establishment, and are similarly
        dominant in academic and bibliographic regards.
</p>
<p>It therefore appears appropriate for this repertoire also to be
        supported fully by IDNA. This presents no difficulty with characters
        in initial and medial positions, but pointed characters are regularly
        used in final position as well. All of the characters in the SYO
        repertoire appear in both marked and unmarked form with one exception:
        the HEBREW LETTER PE (U+05E4). The SYO only permits this with a HEBREW
        POINT DAGESH (U+05BC), providing the Yiddish equivalent to the Latin
        letter "p", or a HEBREW POINT RAFE (U+05BF), equivalent to the Latin
        letter "f". There is, however, a separate unpointed allograph, the
        HEBREW LETTER FINAL PE (U+05E3), for the latter character when it
        appears in final position. The constraint on the use of the SYO
        repertoire resulting from the proscription of combining marks at the
        end of RTL strings thus reduces to nothing more, or less, than the
        equivalent of saying that a string of Latin characters cannot end with
        the letter "p". It must also be noted that the HEBREW LETTER PE with
        HEBREW POINT DAGESH is characteristic of almost all traditional
        Yiddish orthographies that predate (or remain in use in parallel to)
        the SYO, being the first pointed character to appear in any of
        them.
</p>
<p>A more general instantiation of the basic problem can be seen in
        the representation of the YIVO acronym. This is written with the
        Hebrew letters YOD YOD HIRIQ VAV VAV ALEF QAMATS, where HIRIQ and
        QAMATS are combining points: </p>
<blockquote class="text">
<p>U+05D9 HEBREW LETTER YOD (R)
</p>
<p>U+05B4 HEBREW POINT HIRIQ (NSM)
</p>
<p>U+05D5 HEBREW LETTER VAV (R)
</p>
<p>U+05D0 HEBREW LETTER ALEF (R)
</p>
<p>U+05B8 HEBREW POINT QAMATS (NSM)
</p>
</blockquote><p> The directionality class of U+05B8 HEBREW POINT QAMATS in
        the Unicode database is NSM, which again causes the IDNA2003 algorithm
        to reject the string.
</p>
<p>It may also be noted that all of the combined characters mentioned
        above exist in precomposed form at separate positions in the Unicode
        chart. However, by invoking Stringprep, the IDNA2003 algorithm also
        rejects those codepoints, for reasons not discussed here.
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
Strings with numbers</h3>

<p>By requiring that the first or last character of a string be
        category R or AL, RFC 3454 prohibited a string containing
        right-to-left characters from ending with a number.
</p>
<p>Consider the strings ALEF 5 (HEBREW LETTER ALEF + DIGIT FIVE) and 5
        ALEF. Displayed in a LTR context, the first one will be displayed from
        left to right as 5 ALEF (with the 5 being considered right-to-left
        because of the leading ALEF), while 5 ALEF will be displayed in
        exactly the same order (5 taking the direction from context). Clearly,
        only one of those should be permitted as a registered label, but
        barring them both seems to require justification.
</p>
<a name="trouble"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Troublesome situations and guidelines</h3>

<p>There are situations in which labels that satisfy the rule above will
      be displayed in a surprising fashion; the most important of these is the
      case where a label ending in a character with BIDI property AL, AN or R
      occurs before a label beginning with a character of BIDI property EN. In
      that case, the number will appear to move into the label containing the
      right-to-left character, violating the Character Grouping
      requirement.
</p>
<p>If the label that occurs after the right-to-left label itself
      satisfies the BIDI criterion, the requirements will be satisfied in all
      cases (this is the reason why the criterion talks about strings
      containing L in some cases). However, the WG concluded that this could
      not be required for several reasons:
</p>
<p></p>
<ul class="text">
<li>There is a large current deployment of ASCII domain names
          starting with digits. These cannot possibly be invalidated.
</li>
<li>Domain names are often constructed piecemeal, for instance by
          combining a string with the content of a search list. This may occur
          after IDNA processing, and thus in part of the code that is not
          IDNA-aware, making detection of the undesirable combination
          impossible.
</li>
<li>Even if a label is registered under a "safe" label, there may be
          a DNAME <a class='info' href='#RFC2672'>[RFC2672]<span> (</span><span class='info'>Crawford, M., &ldquo;Non-Terminal DNS Name Redirection,&rdquo; August&nbsp;1999.</span><span>)</span></a>with an "unsafe" label that
          points to the "safe" label, thus creating seemingly-valid names that
          would not satisfy the criterion.
</li>
<li>Wildcards create the odd situation where a label is "valid" (can
          be looked up successfully) without the zone owner's knowing that
          this label exists. So an owner of a zone whose name starts with a
          digit and contains a wildcard has no way of controlling whether or
          not names with RTL labels in them are looked up in his zone.
</li>
</ul><p>So rather than trying to suggest rules that disallow all such
      undesirable situations, this document merely warns about the
      possibility.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Other issues in need of resolution</h3>

<p>This document concerns itself only with the rules that are needed
      when dealing with domain names with characters that have differing BIDI
      properties, and considers characters only in terms of their BIDI
      properties. All other issues with these scripts have to be considered in
      other contexts.
</p>
<p>One such issue is the need to keep numbers separate; several scripts,
      such as Arabic, have multiple sets of numbers. The algorithm in this
      document disallows occurrences of AN-class characters ("Arabic-Indic
      digits", U+0660 to U+0669) together with EN-class characters (which
      includes "European" digits, U+0030 to U+0039 and "extended Arabic-Indic
      digits", U+06F0 to U+06F9), but does not help in preventing the mixing
      of, for instance, Bengali digits (U+09E6 to U+09EF) and Gujarati digits
      (U+0AE6 to U+0AEF), both of which have BIDI class L. A registry or
      script community that wishes to create rules for the mixing of digits in
      a label will be able to specify these restrictions at the registry
      level; rules can also be specified at the protocol level, but while the
      example above involves right-to-left characters, this is not inherently
      a bidi problem.
</p>
<p>Another set of issues concerns the proper display of IDNs with a
      mixture of LTR and RTL labels, or only RTL labels.
</p>
<p>It is unrealistic to expect that applications will display domain
      names using embedded formatting codes between their labels (for one
      thing, no reliable algorithms for identifying domain names in running
      text exist); thus, the display order will be determined by the
      bidirectional algorithm. Thus, a sequence (in network order) of
      R1.R2.ltr will be displayed in the order 2R.1R.ltr in an LTR context,
      which might surprise someone expecting to see labels displayed in
      hierarchical order. Again, this memo does not attempt to suggest a
      solution to this problem.
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Compatibility considerations</h3>

<p>
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.1"></a><h3>7.1.&nbsp;
Backwards compatibility considerations</h3>

<p>As with any change to an existing standard, it is important to
        consider what happens with existing implementations when the change is
        introduced. The following troublesome cases have been noted:
</p>
<p></p>
<ul class="text">
<li>Old program used to input the newly-allowed string. If the old
            program checks the input against RFC 3454, the string will not be
            allowed, and that domain name will remain inaccessible.
</li>
<li>Old program is asked to display the newly-allowed string, and
            checks it against RFC 3454 before displaying. The program will
            perform some kind of fallback, most likely displaying the string
            in A-label form.
</li>
<li>Old program tries to display the newly-allowed string. If the
            old program has code for displaying the last character of a string
            that is different from the code used to display the characters in
            the middle of the string, display may be inconsistent and cause
            confusion.
</li>
</ul>

<p>One particular example of the last case is if a program chooses to
        examine the last character (in network order) of a string in order to
        determine its directionality, rather than its first; if it finds an
        NSM character and tries to display the string as if it was a
        left-to-right string, the resulting display may be interesting, but
        not useful.
</p>
<p>The editors believe that these cases will have less harmful impact
        in practice than continuing to deny the use of words from the
        languages for which these strings are necessary as IDN labels.
</p>
<p>This specification does not forbid using leading European numbers
        in ASCII-only labels, since this would in conflict with a large
        installed base of such labels, and would increase the scope of the
        specification from RTL labels to all labels. The harm resulting from
        this limitation of scope is described in <a class='info' href='#trouble'>Section&nbsp;5<span> (</span><span class='info'>Troublesome situations and guidelines</span><span>)</span></a>. Zone managers, both registries and private
        zone managers, can check for this particular condition before they
        allow registration of any string with right-to-left characters in it;
        generally it is best to not allow registration of any right-to-left
        strings in a zone where the label at the level above begins with a
        digit.
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.2"></a><h3>7.2.&nbsp;
Forward compatibility considerations</h3>

<p>This text is, intentionally, specified strictly in terms of the
        Unicode BIDI properties. The determination that the condition is
        sufficient to fulfil the criteria depends on the Unicode BIDI
        algorithm; it is unlikely that drastic changes will be made to this
        algorithm.
</p>
<p>However, the determination of validity for any string depends on
        the Unicode BIDI property values, which are not declared immutable by
        the Unicode Consortium. Furthermore, the behaviour of the algorithm
        for any given character is likely to be linguistically and culturally
        sensitive, so that it's not unlikely that later versions of the
        Unicode standard may change the BIDI properties assigned to certain
        Unicode characters.
</p>
<p>This memo does not propose a solution for this problem.
</p>
<a name="IANA"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
IANA Considerations</h3>

<p>This document makes no request of IANA.
</p>
<p>Note to RFC Editor: this section may be removed on publication as an
      RFC.
</p>
<a name="Security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Security Considerations</h3>

<p>This modification will allow some strings to be used in Stringprep
      contexts that are not allowed today. It is possible that differences in
      the interpretation of the specification between old and new
      implementations could pose a security risk, but it is difficult to
      envision any specific instantiation of this.
</p>
<p>Any rational attempt to compute, for instance, a hash over an
      identifier processed by Stringprep would use network order for its
      computation, and thus be unaffected by the changes proposed here.
</p>
<p>While it is not believed to pose a problem, if display routines had
      been written with specific knowledge of the RFC 3454 Stringprep
      prohibitions, it is possible that the potential problems noted under
      "backwards compatibility" could cause new kinds of confusion.
</p>
<a name="Acknowledgements"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
Acknowledgements</h3>

<p>While the listed editors held the pen, this document represents the
      joint work and conclusions of an ad hoc design team. In addition to the
      editors this consisted of, in alphabetic order, Tina Dam, Patrik
      Faltstrom, and John Klensin. Many further specific contributions and
      helpful comments were received from the people listed below, and others
      who have contributed to the development and use of the IDNA
      protocols.
</p>
<p>The team wishes in particular to thank Roozbeh Pournader for calling
      its attention to the issue with the Thaana script, Paul Hoffmann for
      pointing out the need to be explicit about backwards compatibility
      considerations, Ken Whistler for suggesting the basis of the formalized
      "character grouping" requirement, Mark Davis for commentary, Erik van
      der Poel for careful review, comments and verification of the rulesets,
      and Marcos Sanz, Andrew Sullivan and Pete Resnick for reviews.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>11.1.&nbsp;Normative references</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.ietf-idnabis-defs">[I-D.ietf-idnabis-defs]</a></td>
<td class="author-text">Klensin, J., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-idnabis-defs-01.txt">Internationalized Domain Names for Applications (IDNA): Definitions and  Document Framework</a>,&rdquo; draft-ietf-idnabis-defs-01 (work in progress), November&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-idnabis-defs-01.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="UAX9">[UAX9]</a></td>
<td class="author-text">Davis, M., &ldquo;Unicode Standard Annex #9: The Bidirectional Algorithm,
          revision 15,&rdquo; 03&nbsp;2005.</td></tr>
<tr><td class="author-text" valign="top"><a name="Unicode">[Unicode]</a></td>
<td class="author-text">Unicode, &ldquo;The Unicode Standard - version 5.1,&rdquo; 2008.</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>11.2.&nbsp;Informative references</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.ietf-idnabis-protocol">[I-D.ietf-idnabis-protocol]</a></td>
<td class="author-text">Klensin, J., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-idnabis-protocol-06.txt">Internationalized Domain Names in Applications (IDNA): Protocol</a>,&rdquo; draft-ietf-idnabis-protocol-06 (work in progress), November&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-idnabis-protocol-06.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2672">[RFC2672]</a></td>
<td class="author-text"><a href="mailto:crawdad@fnal.gov">Crawford, M.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2672">Non-Terminal DNS Name Redirection</a>,&rdquo; RFC&nbsp;2672, August&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2672.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3454">[RFC3454]</a></td>
<td class="author-text">Hoffman, P. and M. Blanchet, &ldquo;<a href="http://tools.ietf.org/html/rfc3454">Preparation of Internationalized Strings ("stringprep")</a>,&rdquo; RFC&nbsp;3454, December&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3454.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="SYO">[SYO]</a></td>
<td class="author-text">&ldquo;The Standardized Yiddish Orthography: Rules of Yiddish
          Spelling, 6th ed., , New York, ISBN 0-914512-25-0",,&rdquo; 1999.</td></tr>
</table>

<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Change log</h3>

<p>This appendix is intended to be removed by the RFC Editor when this
      document is published as an RFC.
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1"></a><h3>A.1.&nbsp;
Changes from draft-alvestrand-00 to -01</h3>

<p>Suggested a possible new algorithm.
</p>
<p>Multiple smaller changes.
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.2"></a><h3>A.2.&nbsp;
Changes from alvestrand-01 to -02</h3>

<p>Date of publication updated.
</p>
<p>Change log added.
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.3"></a><h3>A.3.&nbsp;
Changes from alvestrand-02 to -03</h3>

<p>Intro changed to reflect addressing the deeper issues with the BIDI
        algorithm.
</p>
<p>Gave formalized criteria for "valid strings", and documented the
        new set of requirements for strings that satisfy the criteria.
</p>
<p>Removed most of section 5, "Other problems", and noted that this
        memo focuses ONLY on issues that can be evaluated by looking at the
        BIDI properties of characters.
</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.4"></a><h3>A.4.&nbsp;
Changes from alvestrand-03 to -04</h3>

<p>Added back AN to the list of allowed characters; it had been left
        out by accident in -03.
</p>
<p>Removed some rules that were redundant.
</p>
<p>Added some considerations for backwards compatibility and
        interaction with ASCII labels that start with a number.
</p>
<p>Mentioned the issue with DNAME pointing to a zone containing RTL
        labels in the security considerations section.
</p>
<p>Wording updates in multiple places, including some spelling
        errors.
</p>
<p>Rewrote the introduction section.
</p>
<p>Split references into "normative" and "informative".
</p>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.5"></a><h3>A.5.&nbsp;
Changes from draft-alvestrand-04 to draft-ietf -00</h3>

<p>Changed name of draft.
</p>
<p>Added a couple of "note in draft" statements to remind the WG of
        open issues.
</p>
<p>Noted that BIDI controls in the paragraph are unproblematic with
        the given ruleset.
</p>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.6"></a><h3>A.6.&nbsp;
Changes from idnabis -00 to -01</h3>

<p>Added text to section 5 describing issues with mixture of numbers
        in labels
</p>
<p>Addressed some of the issues raised by Mark Davis in March 2008 in
        regard to document clarity.
</p>
<p>Changed the formulation of the label uniqueness requirement to be
        consistent with the text under "Labels with numbers".
</p>
<p>Spell-checked document.
</p>
<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.7"></a><h3>A.7.&nbsp;
Changes from idnabis -01 to -02</h3>

<p>Changed the domain of applicability to be only labels containing
        RTL characters, described the conditions under which harm may result
        from putting RTL labels next to other labels, and how to detect
        them.
</p>
<p>A number of clarification and formatting changes in response to
        reviews.
</p>
<p>
</p>
<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.8"></a><h3>A.8.&nbsp;
Changes from idnabis -02 to -03</h3>

<p>Rearranged section list so that the normative material is collected
        at the front.
</p>
<p>Moved list of BIDI properties into "terminology"
</p>
<p>Clarified that only terminology and the BIDI test is normative
</p>
<p>Changed reference to point to -defs for definitions instead of
        -rationale
</p>
<p>Minor fixes in response to comments, wording cleanups, removed all
        tentative language.
</p>
<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Harald Tveit Alvestrand (editor)</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Google</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Beddingen 10</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Trondheim,   7014</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Norway</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:harald@alvestrand.no">harald@alvestrand.no</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cary Karp</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Swedish Museum of Natural History</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Frescativ. 40</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Stockholm,   10405</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Sweden</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+46 8 5195 4055</td></tr>
<tr><td class="author" align="right">Fax:&nbsp;</td>
<td class="author-text"></td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:ck@nrm.museum">ck@nrm.museum</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href=""></a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2008).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
