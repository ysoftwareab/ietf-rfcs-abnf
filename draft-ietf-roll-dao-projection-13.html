<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Root initiated routing state in RPL</title>
<meta content="Pascal Thubert" name="author">
<meta content="Rahul Arvind Jadhav" name="author">
<meta content="Matthew Gillmore" name="author">
<meta content="
       
     This document updates RFC 6550 to enable a RPL Root to install and maintain Projected Routes within its DODAG, along a selected set of nodes that may or may not include self, for a chosen duration.
     This potentially enables routes
    that are more optimized or resilient than those obtained with the
    classical distributed operation of RPL, either in terms of the size of a
    source-route header or in terms of path length, which impacts both the
    latency and the packet delivery ratio.
       
    " name="description">
<meta content="xml2rfc 3.2.0" name="generator">
<meta content="draft-ietf-roll-dao-projection-13" name="ietf.draft">
<link href="/tmp/draft-ietf-roll-dao-projection-sbjvbhhm.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">DAO Projection</td>
<td class="right">September 2020</td>
</tr></thead>
<tfoot><tr>
<td class="left">Thubert, et al.</td>
<td class="center">Expires 2 April 2021</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">ROLL</dd>
<dt class="label-updates">Updates:</dt>
<dd class="updates">
<a href="https://www.rfc-editor.org/rfc/rfc6550" class="eref">6550</a> (if approved)</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2020-09-29" class="published">29 September 2020</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2021-04-02">2 April 2021</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">P. Thubert, <span class="editor">Ed.</span>
</div>
<div class="org">Cisco Systems</div>
</div>
<div class="author">
      <div class="author-name">R.A. Jadhav</div>
<div class="org">Huawei Tech</div>
</div>
<div class="author">
      <div class="author-name">M. Gillmore</div>
<div class="org">Itron</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Root initiated routing state in RPL</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">
     This document updates RFC 6550 to enable a RPL Root to install and maintain Projected Routes within its DODAG, along a selected set of nodes that may or may not include self, for a chosen duration.
     This potentially enables routes
    that are more optimized or resilient than those obtained with the
    classical distributed operation of RPL, either in terms of the size of a
    source-route header or in terms of path length, which impacts both the
    latency and the packet delivery ratio.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 2 April 2021.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2020 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a><a href="#section-toc.1-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-terminology" class="xref">Terminology</a><a href="#section-toc.1-1.2.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-requirements-language" class="xref">Requirements Language</a><a href="#section-toc.1-1.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1" class="keepWithNext"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-glossary" class="xref">Glossary</a><a href="#section-toc.1-1.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="xref">2.3</a>.  <a href="#name-other-terms" class="xref">Other Terms</a><a href="#section-toc.1-1.2.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a href="#section-2.4" class="xref">2.4</a>.  <a href="#name-references" class="xref">References</a><a href="#section-toc.1-1.2.2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-updating-rfc-6550" class="xref">Updating RFC 6550</a><a href="#section-toc.1-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-identifying-a-track" class="xref">Identifying a Track</a><a href="#section-toc.1-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-new-rpl-control-messages-an" class="xref">New RPL Control Messages and Options</a><a href="#section-toc.1-1.5.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-new-p-dao-request-control-m" class="xref">New P-DAO Request Control Message</a><a href="#section-toc.1-1.5.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-new-pdr-ack-control-message" class="xref">New PDR-ACK Control Message</a><a href="#section-toc.1-1.5.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="xref">5.3</a>.  <a href="#name-route-projection-options" class="xref">Route Projection Options</a><a href="#section-toc.1-1.5.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="xref">5.4</a>.  <a href="#name-sibling-information-option" class="xref">Sibling Information Option</a><a href="#section-toc.1-1.5.2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-projected-dao" class="xref">Projected DAO</a><a href="#section-toc.1-1.6.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-requesting-a-track" class="xref">Requesting a Track</a><a href="#section-toc.1-1.6.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-routing-over-a-track" class="xref">Routing over a Track</a><a href="#section-toc.1-1.6.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="xref">6.3</a>.  <a href="#name-non-storing-mode-projected-" class="xref">Non-Storing Mode Projected Route</a><a href="#section-toc.1-1.6.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="xref">6.4</a>.  <a href="#name-storing-mode-projected-rout" class="xref">Storing Mode Projected Route</a><a href="#section-toc.1-1.6.2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a><a href="#section-toc.1-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a><a href="#section-toc.1-1.8.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="xref">8.1</a>.  <a href="#name-new-rpl-control-codes" class="xref">New RPL Control Codes</a><a href="#section-toc.1-1.8.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="xref">8.2</a>.  <a href="#name-new-rpl-control-message-opt" class="xref">New RPL Control Message Options</a><a href="#section-toc.1-1.8.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="xref">8.3</a>.  <a href="#name-subregistry-for-the-project" class="xref">SubRegistry for the Projected DAO Request Flags</a><a href="#section-toc.1-1.8.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.8.2.4">
                <p id="section-toc.1-1.8.2.4.1"><a href="#section-8.4" class="xref">8.4</a>.  <a href="#name-subregistry-for-the-pdr-ack" class="xref">SubRegistry for the PDR-ACK Flags</a><a href="#section-toc.1-1.8.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.8.2.5">
                <p id="section-toc.1-1.8.2.5.1"><a href="#section-8.5" class="xref">8.5</a>.  <a href="#name-subregistry-for-the-pdr-ack-" class="xref">Subregistry for the PDR-ACK Acceptance Status Values</a><a href="#section-toc.1-1.8.2.5.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.8.2.6">
                <p id="section-toc.1-1.8.2.6.1"><a href="#section-8.6" class="xref">8.6</a>.  <a href="#name-subregistry-for-the-pdr-ack-r" class="xref">Subregistry for the PDR-ACK Rejection Status Values</a><a href="#section-toc.1-1.8.2.6.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.8.2.7">
                <p id="section-toc.1-1.8.2.7.1"><a href="#section-8.7" class="xref">8.7</a>.  <a href="#name-subregistry-for-the-route-p" class="xref">SubRegistry for the Route Projection Options Flags</a><a href="#section-toc.1-1.8.2.7.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.8.2.8">
                <p id="section-toc.1-1.8.2.8.1"><a href="#section-8.8" class="xref">8.8</a>.  <a href="#name-subregistry-for-the-sibling" class="xref">SubRegistry for the Sibling Information Option Flags</a><a href="#section-toc.1-1.8.2.8.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.8.2.9">
                <p id="section-toc.1-1.8.2.9.1"><a href="#section-8.9" class="xref">8.9</a>.  <a href="#name-error-in-projected-route-ic" class="xref">Error in Projected Route ICMPv6 Code</a><a href="#section-toc.1-1.8.2.9.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-acknowledgments" class="xref">Acknowledgments</a><a href="#section-toc.1-1.9.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-normative-references" class="xref">Normative References</a><a href="#section-toc.1-1.10.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>. <a href="#name-informative-references" class="xref">Informative References</a><a href="#section-toc.1-1.11.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-appendix.a" class="xref">Appendix A</a>.  <a href="#name-applications" class="xref">Applications</a><a href="#section-toc.1-1.12.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#section-a.1" class="xref">A.1</a>.  <a href="#name-loose-source-routing" class="xref">Loose Source Routing</a><a href="#section-toc.1-1.12.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#section-a.2" class="xref">A.2</a>.  <a href="#name-transversal-routes" class="xref">Transversal Routes</a><a href="#section-toc.1-1.12.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-appendix.b" class="xref">Appendix B</a>.  <a href="#name-examples" class="xref">Examples</a><a href="#section-toc.1-1.13.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a href="#section-b.1" class="xref">B.1</a>.  <a href="#name-using-storing-mode-p-dao-in" class="xref">Using Storing Mode P-DAO in Non-Storing Mode MOP</a><a href="#section-toc.1-1.13.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a href="#section-b.2" class="xref">B.2</a>.  <a href="#name-projecting-a-storing-mode-t" class="xref">Projecting a Storing Mode transversal route</a><a href="#section-toc.1-1.13.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-appendix.c" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a><a href="#section-toc.1-1.14.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1"> RPL, the <span><a href="#RFC6550" class="xref">"Routing Protocol for Low Power and Lossy Networks"</a> [<a href="#RFC6550" class="xref">RPL</a>]</span> (LLNs),
    is a generic Distance Vector protocol that is well suited
    for application in a variety of low energy Internet of Things (IoT)
    networks.
    RPL forms Destination Oriented Directed Acyclic Graphs (DODAGs) in which
    the Root often acts as the Border Router to connect the RPL domain to the
    Internet. The Root is responsible to select the RPL Instance that is used
    to forward a packet coming from the Internet into the RPL domain and set
    the related RPL information in the packets. 6TiSCH uses RPL for its routing operations.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">

    The <span><a href="#I-D.ietf-6tisch-architecture" class="xref">"6TiSCH Architecture"</a> [<a href="#I-D.ietf-6tisch-architecture" class="xref">6TiSCH-ARCHI</a>]</span> also leverages the <span><a href="#RFC8655" class="xref">"Deterministic Networking Architecture"</a> [<a href="#RFC8655" class="xref">RFC8655</a>]</span> centralized model
    whereby the device resources and capabilities are exposed to an external
    controller which installs routing states into the network based on some
    objective functions that reside in that external entity.  With DetNet and
    6TiSCH, the component of the controller that is responsible of computing
    routes is called a Path Computation Element (<span>[<a href="#PCE" class="xref">PCE</a>]</span>).<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">
    Based on heuristics of usage, path length, and knowledge of device capacity
    and available resources such as battery levels and reservable buffers, the
    PCE with a global visibility on the system can compute direct Peer to Peer
    (P2P) routes that are optimized for the needs expressed by an objective function.
    This document specifies protocol extensions to RPL <span>[<a href="#RFC6550" class="xref">RPL</a>]</span>
    that enable the Root of a main DODAG to install centrally-computed routes  inside the DODAG on behalf of a PCE.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">
    This specification expects that the main RPL Instance is operated in RPL
    Non-Storing Mode of Operation (MOP) to sustain the exchanges with the Root.
    In that Mode, the
    Root has enough information to build a basic DODAG topology based on
    parents and children, but lacks the knowledge of siblings. This document
    adds the capability for nodes to advertise sibling information in order to
    improve the topological awareness of the Root.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">
    As opposed to the classical RPL operations where routes are injected by the
    Target nodes, the protocol extensions enable the Root of a DODAG to project
    the routes that are needed onto the nodes where they should be installed.
    This specification uses the term Projected Route to refer to those routes.
    Projected Routes can be used to reduce the size of the source routing
    headers with loose source routing operations down the main RPL DODAG.
    Projected Routes can also be used to build transversal routes for route
    optimization and Traffic Engineering purposes, between nodes of the DODAG.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">
    A Projected Route may be installed in either Storing and Non-Storing Mode,
    potentially resulting in hybrid situations where the Mode of the Projected
    Route is different from that of the main RPL Instance.
    A Projected Route may be a stand-alone end-to-end path or a Segment in a more complex forwarding graph called a Track.<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7">
    The concept of a Track was introduced in the 6TiSCH architecture, as a
    potentially complex path with redundant forwarding solutions along the way.
    A node at the ingress of more than one Segment in a Track may use any
    combination of those Segments to forward a packet towards the Track Egress.<a href="#section-1-7" class="pilcrow">¶</a></p>
<p id="section-1-8">
    The <span><a href="#I-D.pthubert-raw-architecture" class="xref">"Reliable and
    Available Wireless (RAW) Architecture/Framework"</a> [<a href="#I-D.pthubert-raw-architecture" class="xref">RAW-ARCHI</a>]</span> defines the Path Selection Engine (PSE) that adapts the use of the path redundancy within a Track to defeat the diverse causes of packet loss.<a href="#section-1-8" class="pilcrow">¶</a></p>
<p id="section-1-9">
    The PSE is a dataplane extension of the PCE; it controls the forwarding
    operation of the packets within a Track, using Packet ARQ, Replication,
    Elimination, and Overhearing (PAREO) functions over the Track segments, to
    provide a dynamic balance between the reliability and availability
    requirements of the flows and the need to conserve energy and spectrum.<a href="#section-1-9" class="pilcrow">¶</a></p>
<p id="section-1-10">
    The time scale at which the PCE (re)computes the Track can be long,
    using long-term statistical metrics to perform global optimizations at the
    scale of the whole network. Conversely, the PSE makes forwarding decisions
    at the time scale of one or a small collection of packets, based on a
    knowledge that is limited in scope to the Track itself, so it can be
    refreshed at a fast pace.<a href="#section-1-10" class="pilcrow">¶</a></p>
<p id="section-1-11">
    Projected Routes must be used with the parsimony to limit the amount of
    state that is installed in each device to fit within the device resources,
    and to maintain the amount of rerouted traffic within the capabilities of
    the transmission links. The methods used to learn the node capabilities and
    the resources that are available in the devices and in the network are out
    of scope for this document.<a href="#section-1-11" class="pilcrow">¶</a></p>
<p id="section-1-12">
    This specification uses the RPL Root as a proxy to the PCE. The PCE may be
    collocated with the Root, or may reside in an external Controller.<a href="#section-1-12" class="pilcrow">¶</a></p>
<p id="section-1-13">
    In that case, the PCE exchanges control messages with the Root over a
    Southbound API that is out of scope for this specification.
    The algorithm to compute the paths and the protocol used by an external PCE
    to obtain the topology of the network from the Root are also out of scope.<a href="#section-1-13" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-2">
      <h2 id="name-terminology">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
      </h2>
<div id="bcp">
<section id="section-2.1">
        <h3 id="name-requirements-language">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-requirements-language" class="section-name selfRef">Requirements Language</a>
        </h3>
<p id="section-2.1-1">

    The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
    "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
    "OPTIONAL" in this document are to be interpreted as described in BCP 14
    <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span><span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they
    appear in all capitals, as shown here.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="gloss">
<section id="section-2.2">
        <h3 id="name-glossary">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-glossary" class="section-name selfRef">Glossary</a>
        </h3>
<p id="section-2.2-1"> This document often uses the following acronyms:<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel dlCompact" id="section-2.2-2">
          <dt id="section-2.2-2.1">CMO:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.2"> Control Message Option<a href="#section-2.2-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.3">DAO:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.4"> Destination Advertisement Object<a href="#section-2.2-2.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.5">DAG:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.6"> Directed Acyclic Graph<a href="#section-2.2-2.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.7">DODAG:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.8"> Destination-Oriented Directed Acyclic Graph; A DAG
       with only one vertex (i.e., node) that has no outgoing edge (i.e., link)<a href="#section-2.2-2.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.9">LLN:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.10"> Low-Power and Lossy Network<a href="#section-2.2-2.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.11">MOP:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.12"> RPL Mode of Operation<a href="#section-2.2-2.12" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.13">P-DAO:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.14"> Projected DAO<a href="#section-2.2-2.14" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.15">PDR:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.16"> P-DAO Request<a href="#section-2.2-2.16" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.17">RAN:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.18"> RPL-Aware Node (either a RPL Router or a RPL-Aware Leaf)<a href="#section-2.2-2.18" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.19">RAL:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.20"> RPL-Aware Leaf<a href="#section-2.2-2.20" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.21">RPI:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.22"> RPL Packet Information<a href="#section-2.2-2.22" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.23">RPL:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.24"> IPv6 Routing Protocol for LLNs <span>[<a href="#RFC6550" class="xref">RPL</a>]</span><a href="#section-2.2-2.24" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.25">RPO:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.26"> A Route Projection Option; it can be a VIO or an SRVIO.<a href="#section-2.2-2.26" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.27">RTO:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.28"> RPL Target Option<a href="#section-2.2-2.28" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.29">RUL:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.30"> RPL-Unaware Leaf<a href="#section-2.2-2.30" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.31">SIO:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.32"> RPL Sibling Information Option<a href="#section-2.2-2.32" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.33">SRVIO:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.34"> A Source-Routed Via Information Option, used in Non-Storing Mode P-DAO messages.<a href="#section-2.2-2.34" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.35">SubDAG:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.36"> A DODAG rooted at a node which is a child of that
       node and a subset of a larger DAG<a href="#section-2.2-2.36" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.37">TIO:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.38"> RPL Transit Information Option<a href="#section-2.2-2.38" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.39">VIO:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.40"> A Via Information Option, used in Storing Mode P-DAO messages.<a href="#section-2.2-2.40" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="new">
<section id="section-2.3">
        <h3 id="name-other-terms">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-other-terms" class="section-name selfRef">Other Terms</a>
        </h3>
<p id="section-2.3-1"></p>
<span class="break"></span><dl class="dlParallel dlCompact" id="section-2.3-2">
          <dt id="section-2.3-2.1">Projected Route:</dt>
          <dd style="margin-left: 1.5em" id="section-2.3-2.2">
 A Projected Route is a path segment that is computed remotely, and installed and maintained by a RPL Root.<a href="#section-2.3-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-2.3">Projected DAO:</dt>
          <dd style="margin-left: 1.5em" id="section-2.3-2.4"> A DAO message used to install a Projected Route.<a href="#section-2.3-2.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-2.5">Track:</dt>
          <dd style="margin-left: 1.5em" id="section-2.3-2.6">
    A complex path with redundant Segments to a destination.<a href="#section-2.3-2.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-2.7">TrackID:</dt>
          <dd style="margin-left: 1.5em" id="section-2.3-2.8">
    A RPL Local InstanceID with the 'D' bit set. The TrackID is associated with a IPv6 Address to the Track Egress Node.<a href="#section-2.3-2.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="lo">
<section id="section-2.4">
        <h3 id="name-references">
<a href="#section-2.4" class="section-number selfRef">2.4. </a><a href="#name-references" class="section-name selfRef">References</a>
        </h3>
<p id="section-2.4-1">
 In this document, readers will encounter terms and concepts
 that are discussed in the <span><a href="#RFC6550" class="xref">"Routing Protocol for Low Power and Lossy Networks"</a> [<a href="#RFC6550" class="xref">RPL</a>]</span> and
    <span><a href="#RFC7102" class="xref">"Terminology in Low power And Lossy Networks"</a> [<a href="#RFC7102" class="xref">RFC7102</a>]</span>.<a href="#section-2.4-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
<div id="ext6550">
<section id="section-3">
      <h2 id="name-updating-rfc-6550">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-updating-rfc-6550" class="section-name selfRef">Updating RFC 6550</a>
      </h2>
<p id="section-3-1">
   Section 6 of <span>[<a href="#RFC6550" class="xref">RPL</a>]</span> introduces the RPL Control Message
   Options (CMO), including the RPL Target Option (RTO) and Transit Information Option (TIO), which can be placed in RPL messages such as the Destination Advertisement Object (DAO).
   This specification extends the DAO message with the Projected DAO (P-DAO); a
   P-DAO message signals a Projected Route using new CMOs presented therein.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">
   A Projected Route can be an additional route of higher precedence within the main DODAG, in which case it is installed with the RPLInstanceID and DODAGID of the main DODAG.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">
   A Projected Route can also be a Segment within a Track. A stand-alone Segment can be used as a Serial (end-to-end) Track. Segments can also be combined to form a Complex Track. The Root uses a local RPL Instance rooted at the Track Egress to establish and maintain the Track. The local RPLInstanceID of the Track is called the TrackID, more in  <a href="#trkid" class="xref">Section 4</a>.<a href="#section-3-3" class="pilcrow">¶</a></p>
<span id="name-projected-dao-format-for-a-"></span><div id="p-dao-fmt">
<figure id="figure-1">
        <div class="artwork art-text alignCenter" id="section-3-4.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|    TrackID    |K|D|   Flags   |   Reserved    | DAOSequence   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+                                                               +
|                                                               |
+            IPv6 Address of the Track Egress                   +
|                                                               |
+                                                               +
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Option(s)...
+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-projected-dao-format-for-a-" class="selfRef">Projected DAO Format for a Track</a>
        </figcaption></figure>
</div>
<p id="section-3-5">
  A P-DAO message
   signals the IPv6 Address of the Track Egress in the DODAGID field of the DAO
   Base Object, and the TrackID in the RPLInstanceID field, as shown in
   <a href="#p-dao-fmt" class="xref">Figure 1</a>.<a href="#section-3-5" class="pilcrow">¶</a></p>
<p id="section-3-6">
   In RPL Non-Storing Mode, the TIO and RTO are combined in a DAO message to
   inform the DODAG Root of all the edges in the DODAG, which are formed by the
   directed parent-child relationships.
   Options may be factorized; multiple RTOs may be present to signal a collection of children that can be reached via the parent(s) indicated in the TIO(s) that follows the RTOs.<a href="#section-3-6" class="pilcrow">¶</a></p>
<p id="section-3-7">
   This specification generalizes the case of a parent that can be used to reach a child with that of a whole Track through which both children and siblings may be reached.<a href="#section-3-7" class="pilcrow">¶</a></p>
<p id="section-3-8">
   New CMOs called the Route Projection Options (RPO) are introduced for use in
   P-DAO messages as a multihop alternative to the TIO. One RPO is the Via Information Option (VIO); the VIO installs a state at each hop along a Storing Mode Projected Route. The other is the Source-Routed VIO (SRVIO); the SRVIO installs a source-routing state at the Segment ingress, which uses that state to encapsulate a packet with a  Source-Routing Header along a Non-Storing Mode Projected Route.<a href="#section-3-8" class="pilcrow">¶</a></p>
<p id="section-3-9">
   Like in a DAO message, the RTOs can be factorized in a P-DAO, but the CMOs cannot.
   A P-DAO contains one or more RTOs that indicate the destinations that can be
   reached via the Track, and either one SRVIO or one VIO signal the sequence of hops between the Track Ingress and the (penultimate) node before the Track Egress.
   In Non-Storing Mode, the Root sends the P-DAO to the Track Ingress where the source-routing state is stored. In Storing Mode, the P-DAO is sent to the Track Egress and forwarded along the Segment in the reverse direction, installing a Storing Mode state at each hop.<a href="#section-3-9" class="pilcrow">¶</a></p>
<p id="section-3-10">
   This specification adds another CMO called the Sibling Information Option (SIO) that is used by a RPL Aware Node (RAN) to advertise a selection of its candidate neighbors as siblings to the Root, more in <a href="#rplsib" class="xref">Section 5.4</a>. The sibling selection process is out of scope.<a href="#section-3-10" class="pilcrow">¶</a></p>
<p id="section-3-11">
   Two new RPL Control Messages are also introduced, to enable a RAN
   to request the establishment of a Track between self as the Track Ingress
   Node and a Track Egress.
   The RAN makes its request by sending a new P-DAO Request (PDR) Message to
   the Root. The Root confirms with a new PDR-ACK message back to the requester
   RAN, see <a href="#pdaoreq" class="xref">Section 5.1</a> for more. A positive PDR-ACK indicates that
   the Track was built and that the Roots commits to maintain the Track for a
   negotiated lifetime.<a href="#section-3-11" class="pilcrow">¶</a></p>
<p id="section-3-12">
   In the case of a complex Track, each Segment is maintained independently and
   asynchronously by the Root, with its own lifetime that may be shorter, the
   same, or longer than that of the Track. The Root may use an asynchronous
   PDR-ACK with an negative status to indicate that the Track was terminated before its time.<a href="#section-3-12" class="pilcrow">¶</a></p>
</section>
</div>
<div id="trkid">
<section id="section-4">
      <h2 id="name-identifying-a-track">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-identifying-a-track" class="section-name selfRef">Identifying a Track</a>
      </h2>
<p id="section-4-1">
     RPL defines the concept of an Instance to signal an individual
     routing topology but does not have a concept of an administrative
     distance, which exists in certain proprietary implementations to sort out
     conflicts between multiple sources of routing information within one
     routing topology.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">
     This draft conforms the RPL Instance model as follows:<a href="#section-4-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-3.1">
          <p id="section-4-3.1.1">
     The PCE MAY use P-DAO messages to add better routes in the main (Global)
     Instance in conformance with the routing objectives in that Instance.
     To achieve this, the PCE MAY install a Storing Mode Projected Route along a path down the main (Non-Storing Mode) DODAG. This enables a loose source routing and reduces the size of the Source Routing Header, see <a href="#loose" class="xref">Appendix A.1</a>.<a href="#section-4-3.1.1" class="pilcrow">¶</a></p>
<p id="section-4-3.1.2">
     When adding a Storing Mode Projected Route to the main RPL Instance, the Root MUST set the RPLInstanceID field of the DAO message (see section 6.4.1. of <span>[<a href="#RFC6550" class="xref">RPL</a>]</span>) to the RPLInstanceID of the main DODAG, and set the DODAGID field to the Segment Egress. The Projected Route provides a longer match to the Egress than the default route via the Root, so it is preferred. Once the Projected Route is installed, the intermediate nodes listed in the VIO between the first (excluded) and the last (included) can be elided in a Source-Route Header that signals that
     Segment.<a href="#section-4-3.1.2" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-3.2">
          <p id="section-4-3.2.1">
     The Root MAY also use P-DAO messages to install a specific (say, Traffic Engineered) path as a Serial of a Complex Track, to a particular endpoint that is the Track Egress. In that case, the Root MUST use a Local RPL Instance (see section 5 of <span>[<a href="#RFC6550" class="xref">RPL</a>]</span>) as TrackID.<a href="#section-4-3.2.1" class="pilcrow">¶</a></p>
<p id="section-4-3.2.2">
     The TrackID MUST be unique for the Global Unique IPv6 Address (GUA) or Unique-Local Address (ULA) of the Track Egress that serves as DODAGID for the Track. This way, a Track is uniquely identified by the tuple (Track Egress Address, TrackID) where the TrackID is always represented with the 'D' flag set.
     The Track Egress Address and the TrackID are signaled in the P-DAO message as shown in <a href="#p-dao-fmt" class="xref">Figure 1</a>.<a href="#section-4-3.2.2" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-3.3">
          <p id="section-4-3.3.1">

     In the data packets, the Track Egress Address and the TrackID are respectively signaled in IPv6 Address of the final destination and the RPLInstanceID field of the RPL Packet Information (RPI) (see <span>[<a href="#I-D.ietf-roll-useofrplinfo" class="xref">USEofRPLinfo</a>]</span>) in the outer chain of IPv6 Headers.<a href="#section-4-3.3.1" class="pilcrow">¶</a></p>
<p id="section-4-3.3.2">
     If the outer chain of IPv6 Headers contains a Source-Routing Header that is not fully consumed, then the final destination is the last entry in the
     Source-Routing Header; else it is the Destination Address in the IPv6
     Header. When using the <span>[<a href="#RFC8138" class="xref">RFC8138</a>]</span> compression, it is the last
     hop of the last SRH-6LoRH of the outer header in either case.<a href="#section-4-3.3.2" class="pilcrow">¶</a></p>
<p id="section-4-3.3.3">

     The 'D' flag in the RPLInstanceID MUST be set to indicate that the final destination address in the IPv6 header owns the local RPLInstanceID, more
     in <a href="#routing" class="xref">Section 6.2</a>.<a href="#section-4-3.3.3" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-3.4">
          <p id="section-4-3.4.1">
     A packet that is being routed over the RPL Instance associated to a first  Non-Storing Mode Track MAY be placed (encapsulated) in a second Track to cover one loose hop of the first Track.
     On the other hand, a Storing Mode Track must be strict and a packet that
     it placed in a Storing Mode Track MUST follow that Track till the Track Egress.<a href="#section-4-3.4.1" class="pilcrow">¶</a></p>
<p id="section-4-3.4.2">
      When a Track Egress extracts a packet from a Track (decapsulates the packet), the Destination of the inner packet MUST be either this node or a direct neighbor, otherwise the packet MUST be dropped. That Destination
      may be the next Hop in a Non-Storing Mode Track.<a href="#section-4-3.4.2" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-4-4">
     All properties of a Track operations are inherited form the main RPL Instance
     that is used to install the Track. For instance, the use of compression per
     <span>[<a href="#RFC8138" class="xref">RFC8138</a>]</span> is determined by whether it is used in the main
     instance, e.g., by setting the "T" flag
     <span>[<a href="#I-D.thubert-roll-turnon-rfc8138" class="xref">TURN-ON_RFC8138</a>]</span> in the RPL
     configuration option.<a href="#section-4-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="rplccmo">
<section id="section-5">
      <h2 id="name-new-rpl-control-messages-an">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-new-rpl-control-messages-an" class="section-name selfRef">New RPL Control Messages and Options</a>
      </h2>
<div id="pdaoreq">
<section id="section-5.1">
        <h3 id="name-new-p-dao-request-control-m">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-new-p-dao-request-control-m" class="section-name selfRef">New P-DAO Request Control Message</a>
        </h3>
<p id="section-5.1-1">
    The P-DAO Request (PDR) message is sent to the Root to request a new that
    the PCE establishes a new a projected route from self to the Track Egress
    indicated in the TIO as a full path of a collection
    of Segments in a Track. Exactly one TIO MUST be present, more in
    <a href="#req" class="xref">Section 6.1</a>.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">
    The RPL Control Code for the PDR is 0x09, to be confirmed by IANA.
    The format of PDR Base Object is as follows:<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<span id="name-new-p-dao-request-format"></span><div id="disupdfmt">
<figure id="figure-2">
          <div class="artwork art-text alignCenter" id="section-5.1-3.1">
<pre>
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |   TrackID     |K|R|   Flags   |  ReqLifetime  | PDRSequence   |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |   Option(s)...
 +-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-new-p-dao-request-format" class="selfRef">New P-DAO Request Format</a>
          </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-5.1-4">
          <dt id="section-5.1-4.1">TrackID:</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-4.2">8-bit field indicating the RPLInstanceID
              associated with the Track. It is set to zero upon the
              first request for a new Track and then to the TrackID once the
              Track was created, to either renew it of destroy it.<a href="#section-5.1-4.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-4.3">K:</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-4.4">The 'K' flag is set to indicate that the recipient
              is expected to send a PDR-ACK back.<a href="#section-5.1-4.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-4.5">R:</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-4.6">The 'R' flag is set to indicate that the Requested
              path should be redundant.<a href="#section-5.1-4.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-4.7">Flags:</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-4.8">Reserved. The Flags field MUST initialized to zero by the sender and MUST be ignored by the receiver<a href="#section-5.1-4.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-4.9">ReqLifetime:</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-4.10">
            <p id="section-5.1-4.10.1">8-bit unsigned integer.<a href="#section-5.1-4.10.1" class="pilcrow">¶</a></p>
<p id="section-5.1-4.10.2">
              The requested lifetime for the Track expressed in Lifetime Units
              (obtained from the DODAG Configuration option).<a href="#section-5.1-4.10.2" class="pilcrow">¶</a></p>
<p id="section-5.1-4.10.3">
              A PDR with a fresher
              PDRSequence refreshes the lifetime, and a PDRLifetime of 0
              indicates that the track should be destroyed.<a href="#section-5.1-4.10.3" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-4.11">PDRSequence:</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-4.12">
            <p id="section-5.1-4.12.1">8-bit wrapping sequence number,
              obeying the operation in section 7.2 of
              <span>[<a href="#RFC6550" class="xref">RPL</a>]</span>.<a href="#section-5.1-4.12.1" class="pilcrow">¶</a></p>
<p id="section-5.1-4.12.2">
              The PDRSequence is used to correlate a PDR-ACK message with the
              PDR message that triggered it. It is incremented at each PDR
              message and echoed in the PDR-ACK by the Root.<a href="#section-5.1-4.12.2" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="rpldisackl">
<section id="section-5.2">
        <h3 id="name-new-pdr-ack-control-message">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-new-pdr-ack-control-message" class="section-name selfRef">New PDR-ACK Control Message</a>
        </h3>
<p id="section-5.2-1">
    The new PDR-ACK is sent as a response to a PDR message with the 'K' flag
    set.
    The RPL Control Code for the PDR-ACK is 0x0A, to be confirmed by IANA.
    Its format is as follows:<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<span id="name-new-pdr-ack-control-message-"></span><div id="disackfmt">
<figure id="figure-3">
          <div class="artwork art-text alignCenter" id="section-5.2-2.1">
<pre>

 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|    TrackID    |     Flags     | Track Lifetime|  PDRSequence  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| PDR-ACK Status|                Reserved                       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Option(s)...
+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-new-pdr-ack-control-message-" class="selfRef">New PDR-ACK Control Message Format</a>
          </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-5.2-3">
          <dt id="section-5.2-3.1">TrackID:</dt>
          <dd style="margin-left: 1.5em" id="section-5.2-3.2">
             The RPLInstanceID of the Track that was created. The value of 0x00 is used to when no Track was created.<a href="#section-5.2-3.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.2-3.3">Flags:</dt>
          <dd style="margin-left: 1.5em" id="section-5.2-3.4">Reserved. The Flags field MUST initialized to zero by the sender and MUST be ignored by the receiver<a href="#section-5.2-3.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.2-3.5">Track Lifetime:</dt>
          <dd style="margin-left: 1.5em" id="section-5.2-3.6">
             Indicates that remaining Lifetime for the Track, expressed in
             Lifetime Units; a value of zero (0x00)
              indicates that the Track was destroyed or not created.<a href="#section-5.2-3.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.2-3.7">PDRSequence:</dt>
          <dd style="margin-left: 1.5em" id="section-5.2-3.8"> 8-bit wrapping sequence number.
              It is incremented at each PDR message and echoed in the PDR-ACK.<a href="#section-5.2-3.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.2-3.9">PDR-ACK Status:</dt>
          <dd style="margin-left: 1.5em" id="section-5.2-3.10">
            <p id="section-5.2-3.10.1">8-bit field indicating
            the completion.<a href="#section-5.2-3.10.1" class="pilcrow">¶</a></p>
<p id="section-5.2-3.10.2">
            The PDR-ACK Status is substructured as indicated in <a href="#rpst" class="xref">Figure 4</a>:<a href="#section-5.2-3.10.2" class="pilcrow">¶</a></p>
<span id="name-pdr-ack-status-format"></span><div id="rpst">
<figure id="figure-4">
              <div class="artwork art-text alignCenter" id="section-5.2-3.10.3.1">
<pre>
    0 1 2 3 4 5 6 7
   +-+-+-+-+-+-+-+-+
   |E|R|  Value    |
   +-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-pdr-ack-status-format" class="selfRef">PDR-ACK status Format</a>
              </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-5.2-3.10.4">
              <dt id="section-5.2-3.10.4.1">E:</dt>
              <dd style="margin-left: 1.5em" id="section-5.2-3.10.4.2"> 1-bit flag. Set to indicate a rejection. When not set, a value of 0
    indicates Success/Unqualified acceptance and other values indicate "not an
    outright rejection".<a href="#section-5.2-3.10.4.2" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-5.2-3.10.4.3">R:</dt>
              <dd style="margin-left: 1.5em" id="section-5.2-3.10.4.4"> 1-bit flag. Reserved, MUST be set to 0 by the sender and
    ignored by the receiver.<a href="#section-5.2-3.10.4.4" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-5.2-3.10.4.5">Status Value:</dt>
              <dd style="margin-left: 1.5em" id="section-5.2-3.10.4.6"> 6-bit unsigned integer. Values depending on the
    setting of the 'E' flag as indicated respectively in
    <a href="#iana-ack-status" class="xref">Table 4</a> and <a href="#iana-nack-status" class="xref">Table 5</a>.<a href="#section-5.2-3.10.4.6" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</dd>
          <dd class="break"></dd>
<dt id="section-5.2-3.11">Reserved:</dt>
          <dd style="margin-left: 1.5em" id="section-5.2-3.12">The Reserved field MUST initialized to zero by the
    sender and MUST be ignored by the receiver<a href="#section-5.2-3.12" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="rplrpo">
<section id="section-5.3">
        <h3 id="name-route-projection-options">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-route-projection-options" class="section-name selfRef">Route Projection Options</a>
        </h3>
<p id="section-5.3-1">The RPOs indicate a series of IPv6 addresses that can be compressed using
    the method defined in the <span><a href="#RFC8138" class="xref">"6LoWPAN Routing Header"</a> [<a href="#RFC8138" class="xref">RFC8138</a>]</span> specification using the address of the Root found in the DODAGID
    field of DIO messages as Compression Reference.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3-2">
    An RPO indicates a Projected Route that can be a Serial Track in full or
    a Segment of a more Complex Track. In Non-Storing Mode, multiple RPO
    may be placed after a TIO to reflect different Segments
    originated at this node. The Track is identified by a
    TrackID that is a Local RPLInstanceID to the Track Egress of the Track.<a href="#section-5.3-2" class="pilcrow">¶</a></p>
<p id="section-5.3-3">
    The format of RPOs is as follows:<a href="#section-5.3-3" class="pilcrow">¶</a></p>
<span id="name-route-projection-option-for"></span><div id="viao">
<figure id="figure-5">
          <div class="artwork art-text alignCenter" id="section-5.3-4.1">
<pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |   Type        | Option Length |     Flags     |   SegmentID   |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |Segm. Sequence | Seg. Lifetime |      SRH-6LoRH header         |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                                                               |
    +                                                               +
    .                                                               .
    .                     Via Address 1                             .
    .                                                               .
    +                                                               +
    |                                                               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                                                               |
    .                              ....                             .
    |                                                               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                                                               |
    +                                                               +
    .                                                               .
    .                     Via Address n                             .
    .                                                               .
    +                                                               +
    |                                                               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-route-projection-option-for" class="selfRef">Route Projection Option format (uncompressed form)</a>
          </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-5.3-5">
          <dt id="section-5.3-5.1">Option Type:</dt>
          <dd style="margin-left: 1.5em" id="section-5.3-5.2">0x0B for VIO, 0x0C for SRVIO
                                     (to be confirmed by IANA)<a href="#section-5.3-5.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.3-5.3">Option Length:</dt>
          <dd style="margin-left: 1.5em" id="section-5.3-5.4">In bytes; variable, depending on the number of Via Addresses and the compression.<a href="#section-5.3-5.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd><dt id="section-5.3-5.5">Flags:</dt>
          <dd style="margin-left: 1.5em" id="section-5.3-5.6">Reserved. The Flags field MUST initialized to zero by the sender and MUST be ignored by the receiver<a href="#section-5.3-5.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.3-5.7">SegmentID:</dt>
          <dd style="margin-left: 1.5em" id="section-5.3-5.8">8-bit field that identifies a Segment
               within a Track or the main DODAG as indicated by the TrackID field. A Value of 0 is used to signal a Serial Track, i.e., made of a single segment.<a href="#section-5.3-5.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.3-5.9">Segment Sequence:</dt>
          <dd style="margin-left: 1.5em" id="section-5.3-5.10">8-bit unsigned integer.
              The Segment Sequence obeys the operation in section 7.2 of
              <span>[<a href="#RFC6550" class="xref">RPL</a>]</span> and the lollipop starts at 255. When the
              Root of the DODAG needs to refresh or update a Segment in a Track,
              it increments the Segment Sequence individually for that Segment.
              The Segment information indicated in the RTO deprecates any state
              for the Segment indicated by the SegmentID within the indicated
              Track and sets up the new information. A RTO with a Segment
              Sequence that is not as fresh as the current one is ignored.
              a RTO for a given Track Egress with the same (TrackID,
              SegmentID, Segment Sequence) indicates a retry; it MUST NOT
              change the Segment and MUST be propagated or answered as the first
              copy.<a href="#section-5.3-5.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.3-5.11">Segment Lifetime:</dt>
          <dd style="margin-left: 1.5em" id="section-5.3-5.12">8-bit unsigned integer. The length
              of time in Lifetime Units (obtained from the Configuration
              option) that the Segment is usable. The
              period starts when a new Segment Sequence is seen. A value of 255
              (0xFF) represents infinity. A value of zero (0x00)
              indicates a loss of reachability. A DAO message that
              contains a Via Information option with a Segment Lifetime of
              zero for a Track Egress is referred as a No-Path (for that Track Egress) in
              this document.<a href="#section-5.3-5.12" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.3-5.13">SRH-6LoRH header:</dt>
          <dd style="margin-left: 1.5em" id="section-5.3-5.14">The first 2 bytes of the SRH-6LoRH as shown in Figure 6 of <span>[<a href="#RFC8138" class="xref">RFC8138</a>]</span>. A 6LoRH Type of
              4 means that the VIA Addresses are provided in full with no compression.<a href="#section-5.3-5.14" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.3-5.15">Via Address:</dt>
          <dd style="margin-left: 1.5em" id="section-5.3-5.16">
            <p id="section-5.3-5.16.1">A Luistof Via Addresses along
              one Segment, indicated in the order of the path from the ingress
              to the egress nodes.<a href="#section-5.3-5.16.1" class="pilcrow">¶</a></p>
<p id="section-5.3-5.16.2">
              In a VIO, the list is a strict path between direct neighbors, whereas for an SRVIO, the list may be loose, provided that each
              listed node has a path to the next listed node, e.g., via another
              Track.<a href="#section-5.3-5.16.2" class="pilcrow">¶</a></p>
<p id="section-5.3-5.16.3">
              In the case of a VIO, or if
              <span>[<a href="#RFC8138" class="xref">RFC8138</a>]</span> is turned off, then the Root MUST use
              only one SRH-6LoRH per RPO, and the compression is the same for
              all the addresses, as shown in <a href="#viao" class="xref">Figure 5</a>.<a href="#section-5.3-5.16.3" class="pilcrow">¶</a></p>
<p id="section-5.3-5.16.4">
              If <span>[<a href="#RFC8138" class="xref">RFC8138</a>]</span> is turned on, then the Root SHOULD
              optimize the size of the SRVIO; in that case, more than one
              SRH-6LoRH may be needed if the compression of the addresses
              changes inside the Segment and different SRH-6LoRH Types are used.<a href="#section-5.3-5.16.4" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-5.3-6">
    An RPO MUST contain at least one Via Address, and a Via Address MUST NOT be
    present more than once, otherwise the RPO MUST be ignored.<a href="#section-5.3-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="rplsib">
<section id="section-5.4">
        <h3 id="name-sibling-information-option">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-sibling-information-option" class="section-name selfRef">Sibling Information Option</a>
        </h3>
<p id="section-5.4-1">
    The Sibling Information Option (SIO) provides indication on siblings that
    could be used by the Root to form Projected Routes.
    The format of SIOs is as follows:<a href="#section-5.4-1" class="pilcrow">¶</a></p>
<span id="name-sibling-information-option-"></span><div id="siof">
<figure id="figure-6">
          <div class="artwork art-text alignCenter" id="section-5.4-2.1">
<pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |   Type        | Option Length |Comp.|B|D|Flags|    Opaque     |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |            Step of Rank       |          Reserved             |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                                                               |
    +                                                               +
    .                                                               .
    .         Sibling DODAGID (if 'D' flag not set)                 .
    .                                                               .
    +                                                               +
    |                                                               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                                                               |
    +                                                               +
    .                                                               .
    .                     Sibling Address                           .
    .                                                               .
    +                                                               +
    |                                                               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-sibling-information-option-" class="selfRef">Sibling Information Option Format</a>
          </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-5.4-3">
          <dt id="section-5.4-3.1">Option Type:</dt>
          <dd style="margin-left: 1.5em" id="section-5.4-3.2">0x0D (to be confirmed by IANA)<a href="#section-5.4-3.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.4-3.3">Option Length:</dt>
          <dd style="margin-left: 1.5em" id="section-5.4-3.4">In bytes; variable, depending on the number
              of Via Addresses.<a href="#section-5.4-3.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.4-3.5">Compression Type:</dt>
          <dd style="margin-left: 1.5em" id="section-5.4-3.6">3-bit unsigned integer. This is the
              SRH-6LoRH Type as defined in figure 7 in section 5.1 of
              <span>[<a href="#RFC8138" class="xref">RFC8138</a>]</span> that corresponds to the compression used
              for the Sibling Address.<a href="#section-5.4-3.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.4-3.7">Reserved for Flags:</dt>
          <dd style="margin-left: 1.5em" id="section-5.4-3.8">MUST be set to zero by the sender
              and MUST be ignored by the receiver.<a href="#section-5.4-3.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.4-3.9">B:</dt>
          <dd style="margin-left: 1.5em" id="section-5.4-3.10">
              1-bit flag that is set to indicate that the connectivity to the sibling
              is bidirectional and roughly symmetrical. In that case, only one of the siblings may
              report the SIO for the hop. If 'B' is not set then the SIO only indicates connectivity
              from the sibling to this node, and does not provide information on the hop from this node
              to the sibling.<a href="#section-5.4-3.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.4-3.11">D:</dt>
          <dd style="margin-left: 1.5em" id="section-5.4-3.12">
              1-bit flag that is set to indicate that sibling belongs to the
              same DODAG. When not set, the Sibling DODAGID is indicated.<a href="#section-5.4-3.12" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.4-3.13">Flags:</dt>
          <dd style="margin-left: 1.5em" id="section-5.4-3.14">Reserved. The Flags field MUST initialized to zero by the sender and MUST be ignored by the receiver<a href="#section-5.4-3.14" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.4-3.15">Opaque:</dt>
          <dd style="margin-left: 1.5em" id="section-5.4-3.16">MAY be used to carry information that the node
              and the Root understand, e.g., a particular representation of the
              Link properties such as a proprietary Link Quality Information
              for packets received from the sibling. An industraial Alliance
              that uses RPL for a particular use / environment MAY redefine the
              use of this field to fit its needs.<a href="#section-5.4-3.16" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.4-3.17">Step of Rank:</dt>
          <dd style="margin-left: 1.5em" id="section-5.4-3.18">16-bit unsigned integer. This is the
              Step of Rank <span>[<a href="#RFC6550" class="xref">RPL</a>]</span> as computed by the Objective
              Function between this node and the sibling.<a href="#section-5.4-3.18" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.4-3.19">Reserved:</dt>
          <dd style="margin-left: 1.5em" id="section-5.4-3.20">The Reserved field MUST initialized to zero by the sender and MUST be ignored by the receiver<a href="#section-5.4-3.20" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.4-3.21">Sibling DODAGID:</dt>
          <dd style="margin-left: 1.5em" id="section-5.4-3.22">2 to 16 bytes, the DODAGID of the
              sibling in a <span>[<a href="#RFC8138" class="xref">RFC8138</a>]</span> compressed form as indicated
              by the Compression Type field. This field is present when the
              'D' flag is not set.<a href="#section-5.4-3.22" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.4-3.23">Sibling Address:</dt>
          <dd style="margin-left: 1.5em" id="section-5.4-3.24">2 to 16 bytes, the IPv6 Address of the
              sibling in a <span>[<a href="#RFC8138" class="xref">RFC8138</a>]</span> compressed form as indicated
              by the Compression Type field.<a href="#section-5.4-3.24" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-5.4-4">
    An SIO MAY be immediately followed by a DAG Metric Container. In that case
    the DAG Metric Container provides additional metrics for the hop from the Sibling
    to this node.<a href="#section-5.4-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="pdao">
<section id="section-6">
      <h2 id="name-projected-dao">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-projected-dao" class="section-name selfRef">Projected DAO</a>
      </h2>
<p id="section-6-1">
    This draft adds a capability to RPL whereby the Root of a DODAG projects a
    Track by sending one or more extended DAO message called Projected-DAO
    (P-DAO) messages to chosen routers in the DODAG, indicating one or more sequence(s) of routers inside the DODAG via which the Target(s) indicated in the RPL Target Option(s) (RTO) can be reached.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">
    A P-DAO is sent from a global address of the Root to a global address of the
    recipient, and MUST be confirmed by a DAO-ACK, which is sent back to a
    global address of the Root.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">
    A P-DAO message MUST contain exactly one RTO and either one VIO or one or
    more SRVIOs following it. There can be at most one such sequence of RTOs and then RPOs.<a href="#section-6-3" class="pilcrow">¶</a></p>
<p id="section-6-4">
    Like a classical DAO message, a P-DAO causes a change of state only if it is
    "new" per section 9.2.2. "Generation of DAO Messages" of the <span><a href="#RFC6550" class="xref">RPL specification</a> [<a href="#RFC6550" class="xref">RPL</a>]</span>; this is determined using
    the Segment Sequence information from the RPO as opposed to the Path
    Sequence from a TIO. Also, a Segment Lifetime of 0 in an RPO indicates that the projected route associated to the Segment is to be removed.<a href="#section-6-4" class="pilcrow">¶</a></p>
<p id="section-6-5">
    There are two kinds of operation for the Projected Routes, the Storing Mode
    and the Non-Storing Mode.<a href="#section-6-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6-6.1">
    The Non-Storing Mode is discussed in <a href="#nspdao" class="xref">Section 6.3</a>.
    It uses an SRVIO that carries a list of Via Addresses to be used as a
    source-routed Segment to the Track Egress. The recipient of the P-DAO is the
    ingress router of the source-routed Segment. Upon a Non-Storing Mode P-DAO, the
    ingress router installs a source-routed state to the Track Egress and replies to
    the Root directly with a DAO-ACK message.<a href="#section-6-6.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-6.2">
    The Storing Mode is discussed in <a href="#spdao" class="xref">Section 6.4</a>. It uses a single
    VIO, within which are signaled one Via Address per consecutive hop,
    from the ingress to the egress of the path, including the list of all
    intermediate routers in the data path order.
    The Via Addresses indicate the routers in which the routing state to the
    Track Egress have to be installed via the next Via Address in the VIO.
    In normal operations, the P-DAO is propagated along the chain of Via Routers
    from the egress router of the path till the ingress one, which confirms the
    installation to the Root with a DAO-ACK message.
    Note that the Root may be the ingress and it may be the egress of the
    path, that it can also be neither but it cannot be both.<a href="#section-6-6.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-6-7"></p>
<p id="section-6-8">In case of a forwarding error along a Projected Route, an ICMP error is
    sent to the Root with a new Code "Error in Projected Route"
    (See <a href="#ICMPv6ErrPRoute" class="xref">Section 8.9</a>).
    The Root can then modify or remove the Projected Route.
    The "Error in Projected Route" message has the same format as the
    "Destination Unreachable Message", as specified in RFC 4443
    <span>[<a href="#RFC4443" class="xref">RFC4443</a>]</span>.
    The portion of the invoking packet that is sent back in the ICMP message
    SHOULD record at least up to the routing header if one is present, and the
    routing header SHOULD be consumed by this node so that the destination in
    the IPv6 header is the next hop that this node could not reach.
    if a 6LoWPAN Routing Header (6LoRH) <span>[<a href="#RFC8138" class="xref">RFC8138</a>]</span> is used to
    carry the IPv6 routing information in the outter header then that whole
    6LoRH information SHOULD be present in the ICMP message.
    The sender and exact operation depend on the Mode and is described in
    <a href="#nspdao" class="xref">Section 6.3</a> and <a href="#spdao" class="xref">Section 6.4</a> respectively.<a href="#section-6-8" class="pilcrow">¶</a></p>
<div id="req">
<section id="section-6.1">
        <h3 id="name-requesting-a-track">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-requesting-a-track" class="section-name selfRef">Requesting a Track</a>
        </h3>
<p id="section-6.1-1">
      A Node is free to ask the Root for a new Track with a PDR message, for a duration indicated in a Requested Lifetime field. Upon that Request, the
      Root install the necessary Segments and answers with a PDR-ACK indicated the granted Track Lifetime. When the Track Lifetime returned in the
      PDR-ACK is close to elapse, the resquesting Node needs to resend a PDR using the TrackID in the PDR-ACK to get the lifetime of the Track prolonged, else the Track will time out and the Root will tear down the
      whole structure.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">
      The Segment Lifetime in the P-DAO messages does not need to be aligned to
      the Requested Lifetime in the PDR, or between P-DAO messages for different Segments. The Root may use shorter lifetimes for the Segments
      and renew them faster than the Track is, or longer lifetimes in which case it will need to tear down the Segments if the Track is not renewed.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<p id="section-6.1-3">
      The Root is free to install which ever Segments it wants, and change them overtime, to serve the Track as needed, without notifying the
      resquesting Node. If the Track fails and cannot be reestablished, the
      Root notifies the resquesting Node asynchronously with a PDR-ACK
      with a Track Lifetime of 0, indicating that the Track has failed, and
      a PDR-ACK Status indicating the reason of the fault.<a href="#section-6.1-3" class="pilcrow">¶</a></p>
<p id="section-6.1-4">
      All the Segments MUST be of a same mode, either Storing or Non-Storing.
      All the Segments MUST be created with the same TrackID and Track Egress in
      the P-DAO.<a href="#section-6.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="routing">
<section id="section-6.2">
        <h3 id="name-routing-over-a-track">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-routing-over-a-track" class="section-name selfRef">Routing over a Track</a>
        </h3>
<p id="section-6.2-1">
      Sending a packet over a Track implies the addition of a RPI to indicate the Track, in association with the IPv6 destination. In case of a
      Non-Storing Mode Projected Route, a Source Routing Header is needed as
      well.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">
      The Destination IPv6 Address of a packet that is placed in a Track MUST be
      that of the Track Egress of Track. The outer header of the packet MUST contain an RPI that indicates the TrackID as RPL Instance ID.<a href="#section-6.2-2" class="pilcrow">¶</a></p>
<p id="section-6.2-3">
      If the Track Ingress is the originator of the packet and the Track Egress
      is the destination of the packet, there is no need for an encapsulation.
      Else, i.e., if the Track Ingress is forwarding
      a packet into the Track, or if the the final destination is reached via
      is not the Track Egress, but reached over the Track via the Track Egress, then
      an IP-in-IP encapsulation is needed.<a href="#section-6.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="nspdao">
<section id="section-6.3">
        <h3 id="name-non-storing-mode-projected-">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-non-storing-mode-projected-" class="section-name selfRef">Non-Storing Mode Projected Route</a>
        </h3>
<p id="section-6.3-1">
    As illustrated in <a href="#nsdf" class="xref">Figure 7</a>, a P-DAO that carries an SRVIO
    enables the Root to install a source-routed path towards a Track Egress in any
    particular router; with this path information the router can add a source
    routed header reflecting the Projected Route to any packet for which the current
    destination either is the said Track Egress or can be reached via the Track Egress.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<span id="name-projecting-a-non-storing-ro"></span><div id="nsdf">
<figure id="figure-7">
          <div class="artwork art-text alignLeft" id="section-6.3-2.1">
<pre>
           ------+---------
                 |          Internet
                 |
              +-----+
              |     | Border Router
              |     |  (RPL Root)
              +-----+                   |  P  ^            |
                 |                      | DAO | ACK        | Loose
           o    o   o    o     router   V     |            | Source
       o o   o  o   o  o  o      o  o            | P-DAO   . Route
      o  o o  o o    o   o   o  o  o             | Source  . Path
      o   o    o  o     o  o    o  o  o          | Route   . From
     o  o   o  o   o         o   o o             | Path    . Root
        o  o  o  o             o    Track Egress V         . To
       o       o               o    o                      | Desti-
     o          o             o     o                      | nation
                                   destination             V

                       LLN
</pre>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-projecting-a-non-storing-ro" class="selfRef">Projecting a Non-Storing Route</a>
          </figcaption></figure>
</div>
<p id="section-6.3-3">
    A route indicated by an SRVIO may be loose, meaning that the node that owns
    the next listed Via Address is not necessarily a neighbor. Without proper
    loop avoidance mechanisms, the interaction of loose source routing and other
    mechanisms may effectively cause loops. In order to avoid those loops, if
    the router that installs a Projected Route does not have a connected route
    (a direct adjacency) to the next soure routed hop and fails to locate it as
    a neighbor or a neighbor of a neighbor, then it MUST ensure that it has
    
    another Projected Route to the next loose hop under the control of the same
    route computation system, otherwise the P-DAO is rejected.<a href="#section-6.3-3" class="pilcrow">¶</a></p>
<p id="section-6.3-4">
      When forwarding a packet to a destination for which the router determines
      that routing happens via the Track Egress, the router inserts the source
      routing header in the packet with the destination set to the Track Egress.
      In order to add a source-routing header, the router encapsulates the
      packet with an IP-in-IP header and a Non-Storing Mode source routing
      header (SRH) <span>[<a href="#RFC6554" class="xref">RFC6554</a>]</span>.
      In the uncompressed form the source of the packet would be self, the
      destination would be the first Via Address in the SRVIO, and the SRH would
      contain the list of the remaining Via Addresses and then the Track Egress.<a href="#section-6.3-4" class="pilcrow">¶</a></p>
<p id="section-6.3-5">
      In the case of a loose source-routed path, there MUST be either a neighbor
      that is adjacent to the
      loose next hop, on which case the packet is forwarded to that neighbor, or
      a source-routed path to the loose next hop; in the latter case,
      another encapsulation takes place and the process possibly recurses;
      otherwise the packet is dropped.<a href="#section-6.3-5" class="pilcrow">¶</a></p>
<p id="section-6.3-6">
      In practice, the router will normally use the <span><a href="#RFC8025" class="xref">"IPv6 over Low-Power Wireless Personal Area Network (6LoWPAN) Paging
      Dispatch"</a> [<a href="#RFC8025" class="xref">RFC8025</a>]</span> to compress the RPL artifacts as indicated in
      <span>[<a href="#RFC8138" class="xref">RFC8138</a>]</span>. In that case, the router indicates self as
      encapsulator in an IP-in-IP 6LoRH Header, and places the list of Via
      Addresses in the order of the SRVIO and then the Track Egress in the SRH
      6LoRH Header.<a href="#section-6.3-6" class="pilcrow">¶</a></p>
<p id="section-6.3-7">In case of a forwarding error along a Source Route path, the node that
      fails to forward SHOULD send an ICMP error with a code "Error in Source
      Routing Header" back to the source of the packet, as described in section
      11.2.2.3. of <span>[<a href="#RFC6550" class="xref">RPL</a>]</span>. Upon this message, the
      encapsulating node SHOULD stop using the source route path for a period
      of time and it SHOULD send an ICMP message with a Code "Error in
      Projected Route" to the Root. Failure to follow these steps may result
      in packet loss and wasted resources along the source route path that
      is broken.<a href="#section-6.3-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="spdao">
<section id="section-6.4">
        <h3 id="name-storing-mode-projected-rout">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-storing-mode-projected-rout" class="section-name selfRef">Storing Mode Projected Route</a>
        </h3>
<p id="section-6.4-1">
      As illustrated in <a href="#sdf" class="xref">Figure 8</a>, the Storing Mode route projection
      is used by the Root to install a routing state in the
      routers along a Segment between an Ingress and an Egress router
      this enables the routers to forward along that Segment any packet for
      which the next loose hop is the Egress node, for instance a loose source
      routed packet for which the next loose hop is the Egress node, or a packet for which the router has a routing state to the final destination via the Egress node.<a href="#section-6.4-1" class="pilcrow">¶</a></p>
<span id="name-projecting-a-route"></span><div id="sdf">
<figure id="figure-8">
          <div class="artwork art-text alignLeft" id="section-6.4-2.1">
<pre>
        ------+---------
              |          Internet
              |
           +-----+
           |     | Border Router
           |     |  (RPL Root)
           +-----+                      |     ^                   |
              |                         | DAO | ACK               |
        o    o   o    o                 |     |                   |
    o o   o  o   o  o  o o   o          |  ^       | Projected    .
   o  o o  o o    o   o   o  o  o       |  | DAO   | Route        .
   o   o    o  o     o  o    o  o  o    | ^        |              .
  o  o   o  o   o         o   o o       v | DAO    v              .
  o          o   LLN   o   o     o                                |
      o o   o        o     o              Loose Source Route Path |
   o       o      o    o                 From Root To Destination v
</pre>
</div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a>:
<a href="#name-projecting-a-route" class="selfRef">Projecting a route</a>
          </figcaption></figure>
</div>
<p id="section-6.4-3">
     In order to install the relevant routing state along the Segment between an
     ingress and an egress routers,
     the Root sends a unicast P-DAO message to the egress router of the routing
     Segment that must be installed. The P-DAO message contains the ordered list
     of hops along the Segment as a direct sequence of Via Information options
     that are preceded by one or more RPL Target options to which they relate.
     Each Via Information option contains a Segment Lifetime for which the state is
     to be maintained.<a href="#section-6.4-3" class="pilcrow">¶</a></p>
<p id="section-6.4-4">
     The Root sends the P-DAO directly to the egress node of the Segment.
     In that P-DAO, the destination IP address matches the last Via Address in the VIO. This is how the egress recognizes its role. In a similar fashion,
     the ingress node recognizes its role as it matches first Via Address in the VIO.<a href="#section-6.4-4" class="pilcrow">¶</a></p>
<p id="section-6.4-5">

     The Egress node of the Segment is the only node in the path that does not
     install a route in response to the P-DAO; it is expected to be already able
     to route to the Target(s) on its own. It may either be the Target, or may
     have some existing information to reach the Target(s), such as a connected
     route or an already installed Projected Route.
    
     If one of the Targets cannot be located, the node MUST answer to the Root
     with a negative DAO-ACK listing the Target(s) that could not be located
     (suggested status 10 to be confirmed by IANA).<a href="#section-6.4-5" class="pilcrow">¶</a></p>
<p id="section-6.4-6">
     If the egress node can reach all the Targets, then it forwards the P-DAO
     with unchanged content to its loose predecessor in the Segment as indicated
     in the list of Via Information options, and recursively the message is propagated
     unchanged along the sequence of routers indicated in the P-DAO, but in the
     reverse order, from egress to ingress.<a href="#section-6.4-6" class="pilcrow">¶</a></p>
<p id="section-6.4-7">

     The address of the predecessor to be used as destination of the propagated
     DAO message is found in the Via Information option the precedes the one
     that contain the address of the propagating node, which is used as source
     of the packet.<a href="#section-6.4-7" class="pilcrow">¶</a></p>
<p id="section-6.4-8">
     Upon receiving a propagated DAO, an intermediate router as well as the
     ingress router install a route towards the DAO Target(s) via its
     successor in the P-DAO; the router locates its address in the VIO, and uses as next hop the address found in the previous Via Address field
     in the VIO. The router MAY install additional routes towards the
     VIA Addresses that are the VIO after the next one, if any, but
     in case of a conflict or a lack of resource, the route(s) to the Target(s) have precedence.<a href="#section-6.4-8" class="pilcrow">¶</a></p>
<p id="section-6.4-9">
     The process recurses till the P-DAO is propagated to ingress router of
     the Segment, which answers with a DAO-ACK to the Root.<a href="#section-6.4-9" class="pilcrow">¶</a></p>
<p id="section-6.4-10">Also, the path indicated in a P-DAO may be loose, in which case the
     reachability to the next hop has to be asserted. Each router along the
     path indicated in a P-DAO is expected to be able to reach its successor,
     either with a connected route (direct neighbor), or by routing, for Instance
     following a route installed previously by a DAO or a P-DAO message.
     If that route is not connected then a recursive lookup may take place at
     packet forwarding time to find the next hop to reach the Target(s).
     If it does not and cannot reach the next router in the P-DAO,
     the router MUST answer to the Root with a negative DAO-ACK
     indicating the successor that is unreachable
     (suggested status 11 to be confirmed by IANA).<a href="#section-6.4-10" class="pilcrow">¶</a></p>
<p id="section-6.4-11">
     A Segment Lifetime of 0 in a Via Information option is used to clean up the
     state. The P-DAO is forwarded as described above, but the DAO
     is interpreted as a No-Path DAO and results in cleaning up existing state
     as opposed to refreshing an existing one or installing a new one.<a href="#section-6.4-11" class="pilcrow">¶</a></p>
<p id="section-6.4-12">In case of a forwarding error along a Storing Mode Projected Route, the node
      that fails to forward SHOULD send an ICMP error with a code "Error in
      Projected Route" to the Root. Failure to do so may result in packet loss
      and wasted resources along the Projected Route that is broken.<a href="#section-6.4-12" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<section id="section-7">
      <h2 id="name-security-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-7-1">This draft uses messages that are already present in RPL
     <span>[<a href="#RFC6550" class="xref">RPL</a>]</span> with optional secured versions. The same secured
     versions may be used with this draft, and whatever security is deployed for
     a given network also applies to the flows in this draft.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2"> TODO: should probably consider how P-DAO messages could be abused by

    a) rogue nodes b) via replay of messages c) if use of P-DAO messages could in fact deal with any threats?<a href="#section-7-2" class="pilcrow">¶</a></p>
</section>
<div id="IANAcon">
<section id="section-8">
      <h2 id="name-iana-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<div id="RPLCtrlMsgReg">
<section id="section-8.1">
        <h3 id="name-new-rpl-control-codes">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-new-rpl-control-codes" class="section-name selfRef">New RPL Control Codes</a>
        </h3>
<p id="section-8.1-1">This document extends the IANA Subregistry created by RFC 6550 for RPL
    Control Codes as indicated in <a href="#ianaRPLCtrlMsgtbl" class="xref">Table 1</a>:<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<span id="name-new-rpl-control-codes-2"></span><div id="ianaRPLCtrlMsgtbl">
<table class="center" id="table-1">
          <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-new-rpl-control-codes-2" class="selfRef">New RPL Control Codes</a>
          </caption>
<thead>
            <tr>
              <th class="text-center" rowspan="1" colspan="1">Code</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">0x09</td>
              <td class="text-left" rowspan="1" colspan="1">Projected DAO Request (PDR)</td>
              <td class="text-left" rowspan="1" colspan="1">This document</td>
            </tr>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">0x0A</td>
              <td class="text-left" rowspan="1" colspan="1">PDR-ACK</td>
              <td class="text-left" rowspan="1" colspan="1">This document</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="RPLCtrlMsgOptionsReg">
<section id="section-8.2">
        <h3 id="name-new-rpl-control-message-opt">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-new-rpl-control-message-opt" class="section-name selfRef">New RPL Control Message Options</a>
        </h3>
<p id="section-8.2-1">This document extends the IANA Subregistry created by RFC 6550 for
    RPL Control Message Options as indicated in <a href="#ianaRPLCtrlMsgopttbl" class="xref">Table 2</a>:<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<span id="name-rpl-control-message-options"></span><div id="ianaRPLCtrlMsgopttbl">
<table class="center" id="table-2">
          <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-rpl-control-message-options" class="selfRef">RPL Control Message Options</a>
          </caption>
<thead>
            <tr>
              <th class="text-center" rowspan="1" colspan="1">Value</th>
              <th class="text-left" rowspan="1" colspan="1">Meaning</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">0x0B</td>
              <td class="text-left" rowspan="1" colspan="1">Via Information option</td>
              <td class="text-left" rowspan="1" colspan="1">This document</td>
            </tr>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">0x0C</td>
              <td class="text-left" rowspan="1" colspan="1">Source-Routed Via Information option</td>
              <td class="text-left" rowspan="1" colspan="1">This document</td>
            </tr>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">0x0D</td>
              <td class="text-left" rowspan="1" colspan="1">Sibling Information option</td>
              <td class="text-left" rowspan="1" colspan="1">This document</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="RPLPDRflagReg">
<section id="section-8.3">
        <h3 id="name-subregistry-for-the-project">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-subregistry-for-the-project" class="section-name selfRef">SubRegistry for the Projected DAO Request Flags</a>
        </h3>
<p id="section-8.3-1">
   IANA is required to create a registry for the 8-bit Projected DAO Request
   (PDR) Flags field. Each bit is tracked with the following qualities:<a href="#section-8.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.3-2.1">Bit number (counting from bit 0 as the most significant bit)<a href="#section-8.3-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.3-2.2">Capability description<a href="#section-8.3-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.3-2.3">Reference<a href="#section-8.3-2.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-8.3-3"> Registration procedure is "Standards Action" <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>. The initial allocation is as indicated in <a href="#RPLPDRflagRegtbl" class="xref">Table 3</a>:<a href="#section-8.3-3" class="pilcrow">¶</a></p>
<span id="name-initial-pdr-flags"></span><div id="RPLPDRflagRegtbl">
<table class="center" id="table-3">
          <caption>
<a href="#table-3" class="selfRef">Table 3</a>:
<a href="#name-initial-pdr-flags" class="selfRef">Initial PDR Flags</a>
          </caption>
<thead>
            <tr>
              <th class="text-center" rowspan="1" colspan="1">Bit number</th>
              <th class="text-left" rowspan="1" colspan="1">Capability description</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">0</td>
              <td class="text-left" rowspan="1" colspan="1">PDR-ACK request (K)</td>
              <td class="text-left" rowspan="1" colspan="1">This document</td>
            </tr>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">Requested path should be redundant (R)</td>
              <td class="text-left" rowspan="1" colspan="1">This document</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="RPLPDRackflagReg">
<section id="section-8.4">
        <h3 id="name-subregistry-for-the-pdr-ack">
<a href="#section-8.4" class="section-number selfRef">8.4. </a><a href="#name-subregistry-for-the-pdr-ack" class="section-name selfRef">SubRegistry for the PDR-ACK Flags</a>
        </h3>
<p id="section-8.4-1">
   IANA is required to create an subregistry for the 8-bit PDR-ACK Flags field.
   Each bit is tracked with the following qualities:<a href="#section-8.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.4-2.1">Bit number (counting from bit 0 as the most significant bit)<a href="#section-8.4-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.4-2.2">Capability description<a href="#section-8.4-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.4-2.3">Reference<a href="#section-8.4-2.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-8.4-3">Registration procedure is "Standards Action" <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>.
    No bit is currently defined for the PDR-ACK Flags.<a href="#section-8.4-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-stats-nonrej">
<section id="section-8.5">
        <h3 id="name-subregistry-for-the-pdr-ack-">
<a href="#section-8.5" class="section-number selfRef">8.5. </a><a href="#name-subregistry-for-the-pdr-ack-" class="section-name selfRef">Subregistry for the PDR-ACK Acceptance Status Values</a>
        </h3>
<p id="section-8.5-1">
 IANA is requested to create a Subregistry for the PDR-ACK Acceptance
    Status values.<a href="#section-8.5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.5-2.1"> Possible values are 6-bit unsigned integers (0..63).<a href="#section-8.5-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.5-2.2"> Registration procedure is "Standards Action" <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>.<a href="#section-8.5-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.5-2.3"> Initial allocation is as indicated in <a href="#iana-ack-status" class="xref">Table 4</a>:<a href="#section-8.5-2.3" class="pilcrow">¶</a>
</li>
        </ul>
<span id="name-acceptance-values-of-the-pd"></span><div id="iana-ack-status">
<table class="center" id="table-4">
          <caption>
<a href="#table-4" class="selfRef">Table 4</a>:
<a href="#name-acceptance-values-of-the-pd" class="selfRef">Acceptance values of the PDR-ACK Status</a>
          </caption>
<thead>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Value</td>
              <td class="text-left" rowspan="1" colspan="1">Meaning</td>
              <td class="text-left" rowspan="1" colspan="1">Reference</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0</td>
              <td class="text-left" rowspan="1" colspan="1">Unqualified acceptance</td>
              <td class="text-left" rowspan="1" colspan="1">This document</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="iana-stats-rej">
<section id="section-8.6">
        <h3 id="name-subregistry-for-the-pdr-ack-r">
<a href="#section-8.6" class="section-number selfRef">8.6. </a><a href="#name-subregistry-for-the-pdr-ack-r" class="section-name selfRef">Subregistry for the PDR-ACK Rejection Status Values</a>
        </h3>
<p id="section-8.6-1">
 IANA is requested to create a Subregistry for the PDR-ACK Rejection
    Status values.<a href="#section-8.6-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.6-2.1"> Possible values are 6-bit unsigned integers (0..63).<a href="#section-8.6-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.6-2.2"> Registration procedure is "Standards Action" <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>.<a href="#section-8.6-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.6-2.3"> Initial allocation is as indicated in <a href="#iana-nack-status" class="xref">Table 5</a>:<a href="#section-8.6-2.3" class="pilcrow">¶</a>
</li>
        </ul>
<span id="name-rejection-values-of-the-pdr"></span><div id="iana-nack-status">
<table class="center" id="table-5">
          <caption>
<a href="#table-5" class="selfRef">Table 5</a>:
<a href="#name-rejection-values-of-the-pdr" class="selfRef">Rejection values of the PDR-ACK Status</a>
          </caption>
<thead>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Value</td>
              <td class="text-left" rowspan="1" colspan="1">Meaning</td>
              <td class="text-left" rowspan="1" colspan="1">Reference</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0</td>
              <td class="text-left" rowspan="1" colspan="1">Unqualified rejection</td>
              <td class="text-left" rowspan="1" colspan="1">This document</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="RPLRPOflagReg">
<section id="section-8.7">
        <h3 id="name-subregistry-for-the-route-p">
<a href="#section-8.7" class="section-number selfRef">8.7. </a><a href="#name-subregistry-for-the-route-p" class="section-name selfRef">SubRegistry for the Route Projection Options Flags</a>
        </h3>
<p id="section-8.7-1">
   IANA is requested to create a Subregistry for the 5-bit Route Projection Options
   (RPO) Flags field. Each bit is tracked with the following qualities:<a href="#section-8.7-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.7-2.1">Bit number (counting from bit 0 as the most significant bit)<a href="#section-8.7-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.7-2.2">Capability description<a href="#section-8.7-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.7-2.3">Reference<a href="#section-8.7-2.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-8.7-3"> Registration procedure is "Standards Action" <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>.
   No bit is currently defined for the Route Projection Options (RPO) Flags.<a href="#section-8.7-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="RPLSIOflagReg">
<section id="section-8.8">
        <h3 id="name-subregistry-for-the-sibling">
<a href="#section-8.8" class="section-number selfRef">8.8. </a><a href="#name-subregistry-for-the-sibling" class="section-name selfRef">SubRegistry for the Sibling Information Option Flags</a>
        </h3>
<p id="section-8.8-1">
   IANA is required to create a registry for the 5-bit Sibling Information
   Option (SIO) Flags field. Each bit is tracked with the following qualities:<a href="#section-8.8-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.8-2.1">Bit number (counting from bit 0 as the most significant bit)<a href="#section-8.8-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.8-2.2">Capability description<a href="#section-8.8-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.8-2.3">Reference<a href="#section-8.8-2.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-8.8-3"> Registration procedure is "Standards Action" <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>. The initial allocation is as indicated in <a href="#RPLSIORegtbl" class="xref">Table 6</a>:<a href="#section-8.8-3" class="pilcrow">¶</a></p>
<span id="name-initial-sio-flags"></span><div id="RPLSIORegtbl">
<table class="center" id="table-6">
          <caption>
<a href="#table-6" class="selfRef">Table 6</a>:
<a href="#name-initial-sio-flags" class="selfRef">Initial SIO Flags</a>
          </caption>
<thead>
            <tr>
              <th class="text-center" rowspan="1" colspan="1">Bit number</th>
              <th class="text-left" rowspan="1" colspan="1">Capability description</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">0</td>
              <td class="text-left" rowspan="1" colspan="1">Connectivity is bidirectional (B)</td>
              <td class="text-left" rowspan="1" colspan="1">This document</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="ICMPv6ErrPRoute">
<section id="section-8.9">
        <h3 id="name-error-in-projected-route-ic">
<a href="#section-8.9" class="section-number selfRef">8.9. </a><a href="#name-error-in-projected-route-ic" class="section-name selfRef">Error in Projected Route ICMPv6 Code</a>
        </h3>
<p id="section-8.9-1">In some cases RPL will return an ICMPv6 error message when a
        message cannot be forwarded along a Projected Route.
        This ICMPv6 error message is "Error in Projected Route".<a href="#section-8.9-1" class="pilcrow">¶</a></p>
<p id="section-8.9-2">IANA has defined an ICMPv6 "Code" Fields Registry for ICMPv6
        Message Types. ICMPv6 Message Type 1 describes "Destination Unreachable"
        codes. This specification requires that a new code is allocated from the
        ICMPv6 Code Fields Registry for ICMPv6 Message Type 1, for "Error in
        Projected Route", with a suggested code value of 8, to be confirmed by
        IANA.<a href="#section-8.9-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<section id="section-9">
      <h2 id="name-acknowledgments">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="section-9-1">The authors wish to acknowledge JP Vasseur, Remy Liubing, James Pylakutty and
   Patrick Wetterwald for their contributions to the ideas developed here.<a href="#section-9-1" class="pilcrow">¶</a></p>
</section>
<section id="section-10">
      <h2 id="name-normative-references">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
      </h2>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
      <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4443">[RFC4443]</dt>
      <dd>
<span class="refAuthor">Conta, A.</span><span class="refAuthor">, Deering, S.</span><span class="refAuthor">, and M. Gupta, Ed.</span>, <span class="refTitle">"Internet Control Message Protocol (ICMPv6) for the Internet Protocol Version 6 (IPv6) Specification"</span>, <span class="seriesInfo">STD 89</span>, <span class="seriesInfo">RFC 4443</span>, <span class="seriesInfo">DOI 10.17487/RFC4443</span>, <time datetime="2006-03" class="refDate">March 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4443">https://www.rfc-editor.org/info/rfc4443</a>&gt;</span>. </dd>
<dd class="break"></dd><dt id="RFC6550">[RPL]</dt>
      <dd>
<span class="refAuthor">Winter, T., Ed.</span><span class="refAuthor">, Thubert, P., Ed.</span><span class="refAuthor">, Brandt, A.</span><span class="refAuthor">, Hui, J.</span><span class="refAuthor">, Kelsey, R.</span><span class="refAuthor">, Levis, P.</span><span class="refAuthor">, Pister, K.</span><span class="refAuthor">, Struik, R.</span><span class="refAuthor">, Vasseur, JP.</span><span class="refAuthor">, and R. Alexander</span>, <span class="refTitle">"RPL: IPv6 Routing Protocol for Low-Power and Lossy Networks"</span>, <span class="seriesInfo">RFC 6550</span>, <span class="seriesInfo">DOI 10.17487/RFC6550</span>, <time datetime="2012-03" class="refDate">March 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6550">https://www.rfc-editor.org/info/rfc6550</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6554">[RFC6554]</dt>
      <dd>
<span class="refAuthor">Hui, J.</span><span class="refAuthor">, Vasseur, JP.</span><span class="refAuthor">, Culler, D.</span><span class="refAuthor">, and V. Manral</span>, <span class="refTitle">"An IPv6 Routing Header for Source Routes with the Routing Protocol for Low-Power and Lossy Networks (RPL)"</span>, <span class="seriesInfo">RFC 6554</span>, <span class="seriesInfo">DOI 10.17487/RFC6554</span>, <time datetime="2012-03" class="refDate">March 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6554">https://www.rfc-editor.org/info/rfc6554</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
    <dd>
<span class="refAuthor">Cotton, M.</span><span class="refAuthor">, Leiba, B.</span><span class="refAuthor">, and T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-11">
      <h2 id="name-informative-references">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
      </h2>
<dl class="references">
<dt id="RFC7102">[RFC7102]</dt>
      <dd>
<span class="refAuthor">Vasseur, JP.</span>, <span class="refTitle">"Terms Used in Routing for Low-Power and Lossy Networks"</span>, <span class="seriesInfo">RFC 7102</span>, <span class="seriesInfo">DOI 10.17487/RFC7102</span>, <time datetime="2014-01" class="refDate">January 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7102">https://www.rfc-editor.org/info/rfc7102</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6997">[RFC6997]</dt>
      <dd>
<span class="refAuthor">Goyal, M., Ed.</span><span class="refAuthor">, Baccelli, E.</span><span class="refAuthor">, Philipp, M.</span><span class="refAuthor">, Brandt, A.</span><span class="refAuthor">, and J. Martocci</span>, <span class="refTitle">"Reactive Discovery of Point-to-Point Routes in Low-Power and Lossy Networks"</span>, <span class="seriesInfo">RFC 6997</span>, <span class="seriesInfo">DOI 10.17487/RFC6997</span>, <time datetime="2013-08" class="refDate">August 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6997">https://www.rfc-editor.org/info/rfc6997</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-6tisch-architecture">[6TiSCH-ARCHI]</dt>
      <dd>
<span class="refAuthor">Thubert, P.</span>, <span class="refTitle">"An Architecture for IPv6 over the TSCH mode of IEEE 802.15.4"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-6tisch-architecture-29</span>, <time datetime="2020-08-27" class="refDate">27 August 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-6tisch-architecture-29">https://tools.ietf.org/html/draft-ietf-6tisch-architecture-29</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.pthubert-raw-architecture">[RAW-ARCHI]</dt>
      <dd>
<span class="refAuthor">Thubert, P.</span><span class="refAuthor">, Papadopoulos, G.</span><span class="refAuthor">, and R. Buddenberg</span>, <span class="refTitle">"Reliable and Available Wireless Architecture/Framework"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-pthubert-raw-architecture-04</span>, <time datetime="2020-07-06" class="refDate">6 July 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-pthubert-raw-architecture-04">https://tools.ietf.org/html/draft-pthubert-raw-architecture-04</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.thubert-roll-turnon-rfc8138">[TURN-ON_RFC8138]</dt>
      <dd>
<span class="refAuthor">Thubert, P.</span><span class="refAuthor"> and L. Zhao</span>, <span class="refTitle">"Configuration option for RFC 8138"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-thubert-roll-turnon-rfc8138-03</span>, <time datetime="2019-07-08" class="refDate">8 July 2019</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-thubert-roll-turnon-rfc8138-03">https://tools.ietf.org/html/draft-thubert-roll-turnon-rfc8138-03</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8655">[RFC8655]</dt>
      <dd>
<span class="refAuthor">Finn, N.</span><span class="refAuthor">, Thubert, P.</span><span class="refAuthor">, Varga, B.</span><span class="refAuthor">, and J. Farkas</span>, <span class="refTitle">"Deterministic Networking Architecture"</span>, <span class="seriesInfo">RFC 8655</span>, <span class="seriesInfo">DOI 10.17487/RFC8655</span>, <time datetime="2019-10" class="refDate">October 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8655">https://www.rfc-editor.org/info/rfc8655</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8025">[RFC8025]</dt>
      <dd>
<span class="refAuthor">Thubert, P., Ed.</span><span class="refAuthor"> and R. Cragie</span>, <span class="refTitle">"IPv6 over Low-Power Wireless Personal Area Network (6LoWPAN) Paging Dispatch"</span>, <span class="seriesInfo">RFC 8025</span>, <span class="seriesInfo">DOI 10.17487/RFC8025</span>, <time datetime="2016-11" class="refDate">November 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8025">https://www.rfc-editor.org/info/rfc8025</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8138">[RFC8138]</dt>
      <dd>
<span class="refAuthor">Thubert, P., Ed.</span><span class="refAuthor">, Bormann, C.</span><span class="refAuthor">, Toutain, L.</span><span class="refAuthor">, and R. Cragie</span>, <span class="refTitle">"IPv6 over Low-Power Wireless Personal Area Network (6LoWPAN) Routing Header"</span>, <span class="seriesInfo">RFC 8138</span>, <span class="seriesInfo">DOI 10.17487/RFC8138</span>, <time datetime="2017-04" class="refDate">April 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8138">https://www.rfc-editor.org/info/rfc8138</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-roll-useofrplinfo">[USEofRPLinfo]</dt>
      <dd>
<span class="refAuthor">Robles, I.</span><span class="refAuthor">, Richardson, M.</span><span class="refAuthor">, and P. Thubert</span>, <span class="refTitle">"Using RPI Option Type, Routing Header for Source Routes and IPv6-in-IPv6 encapsulation in the RPL Data Plane"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-roll-useofrplinfo-40</span>, <time datetime="2020-06-25" class="refDate">25 June 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-roll-useofrplinfo-40">https://tools.ietf.org/html/draft-ietf-roll-useofrplinfo-40</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="PCE">[PCE]</dt>
    <dd>
<span class="refAuthor">IETF</span>, <span class="refTitle">"Path Computation Element"</span>, <span>&lt;<a href="https://datatracker.ietf.org/doc/charter-ietf-pce/">https://datatracker.ietf.org/doc/charter-ietf-pce/</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-appendix.a">
      <h2 id="name-applications">
<a href="#section-appendix.a" class="section-number selfRef">Appendix A. </a><a href="#name-applications" class="section-name selfRef">Applications</a>
      </h2>
<div id="loose">
<section id="section-a.1">
        <h2 id="name-loose-source-routing">
<a href="#section-a.1" class="section-number selfRef">A.1. </a><a href="#name-loose-source-routing" class="section-name selfRef">Loose Source Routing</a>
        </h2>
<p id="section-a.1-1">A RPL implementation operating in a very constrained LLN typically uses
      the Non-Storing Mode of Operation as represented in <a href="#nost" class="xref">Figure 9</a>.
      In that mode, a RPL node indicates a
      parent-child relationship to the Root, using a Destination Advertisement
      Object (DAO) that is unicast from the node directly to the Root,
      and the Root typically builds a source routed path to a destination down
      the DODAG by recursively concatenating this information.<a href="#section-a.1-1" class="pilcrow">¶</a></p>
<span id="name-rpl-non-storing-mode-of-ope"></span><div id="nost">
<figure id="figure-9">
          <div class="artwork art-text alignLeft" id="section-a.1-2.1">
<pre>
           ------+---------
                 |          Internet
                 |
              +-----+
              |     | Border Router
              |     |  (RPL Root)
              +-----+                      ^     |        |
                 |                         | DAO | ACK    |
           o    o   o    o                 |     |        | Strict
       o o   o  o   o  o  o o   o          |     |        | Source
      o  o o  o o    o   o   o  o  o       |     |        | Route
      o   o    o  o     o  o    o  o  o    |     |        |
     o  o   o  o   o         o   o o       |     v        v
     o          o             o     o
                       LLN
</pre>
</div>
<figcaption><a href="#figure-9" class="selfRef">Figure 9</a>:
<a href="#name-rpl-non-storing-mode-of-ope" class="selfRef">RPL Non-Storing Mode of operation</a>
          </figcaption></figure>
</div>
<p id="section-a.1-3">
      Based on the parent-children relationships expressed in the non-storing
      DAO messages,the Root possesses topological information about the whole
      network, though this information is limited to the structure of the DODAG
      for which it is the destination.
      A packet that is generated within the domain will always reach the Root,
      which can then apply a source routing information to reach the destination
      if the destination is also in the DODAG.
      Similarly, a packet coming from the outside of the domain for a destination
      that is expected to be in a RPL domain reaches the Root.<a href="#section-a.1-3" class="pilcrow">¶</a></p>
<p id="section-a.1-4">
     It results that the Root, or then some associated centralized computation
     engine such as a PCE, can determine the amount of packets that reach a
     destination in the
     RPL domain, and thus the amount of energy and bandwidth that is wasted for
     transmission, between itself and the destination, as well as the risk of
     fragmentation, any potential delays because of a paths longer than
     necessary (shorter paths exist that would not traverse the Root).<a href="#section-a.1-4" class="pilcrow">¶</a></p>
<p id="section-a.1-5">
     As a network gets deep, the size of the source routing header that the
      Root must add to all the downward packets becomes an issue for nodes that
      are many hops away. In some use cases, a RPL network forms long lines and
      a limited amount of well-Targeted routing state would allow to make the
      source routing operation loose as opposed to strict, and save packet size.
      Limiting the packet size is directly beneficial to the energy budget, but,
      mostly, it reduces the chances of frame loss and/or packet fragmentation,
      which is highly detrimental to the LLN operation. Because the capability
      to store a routing state in every node is limited, the decision of which
      route is installed where can only be optimized with a global knowledge of
      the system, a knowledge that the Root or an associated PCE may possess by
      means that are outside of the scope of this specification.<a href="#section-a.1-5" class="pilcrow">¶</a></p>
<p id="section-a.1-6">
      This specification enables to store source-routed or Storing Mode state in
      intermediate routers, which enables to limit the excursion of the source
      route headers in deep networks.
      Once a P-DAO exchange has taken place for a given Target, if the Root
      operates in non Storing Mode, then it may elide the sequence of routers
      that is installed in the network from its source route headers to
      destination that are reachable via that Target, and the source route
      headers effectively become loose.<a href="#section-a.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-a.2">
        <h2 id="name-transversal-routes">
<a href="#section-a.2" class="section-number selfRef">A.2. </a><a href="#name-transversal-routes" class="section-name selfRef">Transversal Routes</a>
        </h2>
<p id="section-a.2-1">
      RPL is optimized for Point-to-Multipoint (P2MP) and Multipoint-to-Point
      (MP2P), whereby routes are always installed along the RPL DODAG
      respectively from and towards the DODAG Root. Transversal
      Peer to Peer (P2P) routes in a RPL network will generally suffer from some
      elongated (stretched) path versus the best possible path, since routing
      between 2 nodes always happens via a common parent, as illustrated in
      <a href="#stretch" class="xref">Figure 10</a>:<a href="#section-a.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-a.2-2.1">In Storing Mode, unless the destination is a child of the source,
     the packets will follow the default route up the DODAG as well.
     If the destination is in the same DODAG, they will eventually reach a
     common parent that has a route to the destination; at worse, the common
     parent may also be the Root. From that common parent, the packet will
     follow a path down the DODAG that is optimized for the Objective Function
     that was used to build the DODAG.<a href="#section-a.2-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.2-2.2"> in Non-Storing Mode, all packets
     routed within the DODAG flow all the way up to the Root of the DODAG. If
     the destination is in the same DODAG, the Root must encapsulate the packet
     to place a Routing Header that has the strict source route information down
     the DODAG to the destination. This will be the case even if the destination
     is relatively close to the source and the Root is relatively far off.<a href="#section-a.2-2.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-a.2-3"></p>
<span id="name-routing-stretch-between-s-a"></span><div id="stretch">
<figure id="figure-10">
          <div class="artwork art-text alignLeft" id="section-a.2-4.1">
<pre>
                   ------+---------
                    |          Internet
                    |
                 +-----+
                 |     | Border Router
                 |     |  (RPL Root)
                 +-----+
                    X
              ^    v   o    o
          ^ o   o  v   o  o  o o   o
         ^  o o  o v    o   o   o  o  o
         ^   o    o  v     o  o    o  o  o
        S  o   o  o   D         o   o o
        o          o             o     o
                          LLN
</pre>
</div>
<figcaption><a href="#figure-10" class="selfRef">Figure 10</a>:
<a href="#name-routing-stretch-between-s-a" class="selfRef">Routing Stretch between S and D via common parent X</a>
          </figcaption></figure>
</div>
<p id="section-a.2-5">
     It results that it is often beneficial to enable transversal P2P routes,
     either if the RPL route presents a stretch from shortest path, or if the
     new route is engineered with a different objective, and that it is
     even more critical in Non-Storing Mode than it is in Storing Mode, because
     the routing stretch is wider.
     For that reason, earlier work at the IETF introduced the
     <span><a href="#RFC6997" class="xref">"Reactive Discovery of Point-to-Point Routes in
     Low Power and Lossy Networks"</a> [<a href="#RFC6997" class="xref">RFC6997</a>]</span>, which specifies a distributed method for
     establishing optimized P2P routes. This draft proposes an alternate based
     on a centralized route computation.<a href="#section-a.2-5" class="pilcrow">¶</a></p>
<span id="name-projected-transversal-route"></span><div id="opti2">
<figure id="figure-11">
          <div class="artwork art-text alignLeft" id="section-a.2-6.1">
<pre>
              ------+---------
                    |          Internet
                    |
                 +-----+
                 |     | Border Router
                 |     |  (RPL Root)
                 +-----+
                    |
              o    o   o    o
          o o   o  o   o  o  o o   o
         o  o o  o o    o   o   o  o  o
         o   o    o  o     o  o    o  o  o
        S&gt;&gt;A&gt;&gt;&gt;B&gt;&gt;C&gt;&gt;&gt;D         o   o o
        o          o             o     o
                          LLN
</pre>
</div>
<figcaption><a href="#figure-11" class="selfRef">Figure 11</a>:
<a href="#name-projected-transversal-route" class="selfRef">Projected Transversal Route</a>
          </figcaption></figure>
</div>
<p id="section-a.2-7">
      This specification enables to store source-routed or Storing Mode state in
      intermediate routers, which enables to limit the stretch of a P2P route
      and maintain the characteristics within a given SLA. An example of service
      using this mechanism oculd be a control loop that would be installed in a
      network that uses classical RPL for asynchronous data collection. In that
      case, the P2P path may be installed in a different RPL Instance, with a
      different objective function.<a href="#section-a.2-7" class="pilcrow">¶</a></p>
</section>
</section>
<section id="section-appendix.b">
      <h2 id="name-examples">
<a href="#section-appendix.b" class="section-number selfRef">Appendix B. </a><a href="#name-examples" class="section-name selfRef">Examples</a>
      </h2>
<section id="section-b.1">
        <h2 id="name-using-storing-mode-p-dao-in">
<a href="#section-b.1" class="section-number selfRef">B.1. </a><a href="#name-using-storing-mode-p-dao-in" class="section-name selfRef">Using Storing Mode P-DAO in Non-Storing Mode MOP</a>
        </h2>
<p id="section-b.1-1">
    In Non-Storing Mode, the DAG Root maintains the knowledge of the whole DODAG
    topology, so when both the source and the destination
    of a packet are in the DODAG, the Root can determine the common
    parent that would have been used in Storing Mode, and thus the list of nodes
    in the path between the common parent and the destination. For Instance in
    the diagram shown in <a href="#exmp" class="xref">Figure 12</a>, if the source is node 41
    and the destination is node 52, then the common parent is node 22.<a href="#section-b.1-1" class="pilcrow">¶</a></p>
<span id="name-example-dodag-forming-a-log"></span><div id="exmp">
<figure id="figure-12">
          <div class="artwork art-text alignLeft" id="section-b.1-2.1">
<pre>
           ------+---------
                 |          Internet
                 |
              +-----+
              |     | Border Router
              |     |  (RPL Root)
              +-----+
               | \  \____
              /   \       \
            o 11   o 12     o  13
           /       |       /  \
         o 22      o 23   o 24  o 25
        /  \       | \      \
      o 31   o 32  o   o     o 35
     /      /      |    \    |    \
    o 41   o 42    o     o   o 45   o 46
    |      |       |     |    \     |
    o 51   o 52    o 53  o     o 55 o 56

                       LLN
</pre>
</div>
<figcaption><a href="#figure-12" class="selfRef">Figure 12</a>:
<a href="#name-example-dodag-forming-a-log" class="selfRef">Example DODAG forming a logical tree topology</a>
          </figcaption></figure>
</div>
<p id="section-b.1-3">
     With this draft, the Root can install a Storing Mode routing states along a
     Segment that is either from itself to the destination, or from one or more
     common parents for a particular source/destination pair towards that
     destination (in this particular
     example, this would be the Segment made of nodes 22, 32, 42).<a href="#section-b.1-3" class="pilcrow">¶</a></p>
<p id="section-b.1-4"> In the example below, say that there is a lot of traffic to nodes 55 and
    56 and the Root decides to reduce the size of routing headers to those
    destinations. The Root can first send a DAO to node 45 indicating Target 55
    and a Via Segment (35, 45), as well as another DAO to node 46 indicating
    Target 56 and a Via Segment (35, 46). This will save one entry in the
    routing header on both sides. The Root may then send a DAO to node 35
    indicating Targets 55 and 56 a Via Segment (13, 24, 35) to fully optimize
    that path.<a href="#section-b.1-4" class="pilcrow">¶</a></p>
<p id="section-b.1-5">
    Alternatively, the Root may send a DAO to node 45 indicating Target 55
    and a Via Segment (13, 24, 35, 45) and then a DAO to node 46 indicating
    Target 56 and a Via Segment (13, 24, 35, 46), indicating the same DAO
    Sequence.<a href="#section-b.1-5" class="pilcrow">¶</a></p>
</section>
<section id="section-b.2">
        <h2 id="name-projecting-a-storing-mode-t">
<a href="#section-b.2" class="section-number selfRef">B.2. </a><a href="#name-projecting-a-storing-mode-t" class="section-name selfRef">Projecting a Storing Mode transversal route</a>
        </h2>
<p id="section-b.2-1">In this example, say that a PCE determines that a path must be installed
   between node I and node D via routers A, B and E, in order to serve the needs
   of a particular application.<a href="#section-b.2-1" class="pilcrow">¶</a></p>
<p id="section-b.2-2">
   The Root sends a P-DAO to node E, with an RTO indicating the destination D,
   a TIO optionally indicating the Track Egress in the Parent Address field,
   and a sequence of Via Information options indicating the hops, one for S, which is the ingress router of the Segment, one for A, and then one for B, which are respectively the intermediate and penultimate routers.<a href="#section-b.2-2" class="pilcrow">¶</a></p>
<span id="name-p-dao-from-root"></span><div id="pdao2">
<figure id="figure-13">
          <div class="artwork art-text alignLeft" id="section-b.2-3.1">
<pre>
              ------+---------
                    |          Internet
                    |
                 +-----+
                 |     | Border Router
                 |     |  (RPL Root)
                 +-----+
                    | P-DAO message to C
              o    |   o    o
          o o   o |    o  o  o o   o
         o  o o  | o    o   o   o  o  o
         o   o   V  o     o  o    o  o  o
        S  A  B  E   D         o   o o
        o          o             o     o
                          LLN
</pre>
</div>
<figcaption><a href="#figure-13" class="selfRef">Figure 13</a>:
<a href="#name-p-dao-from-root" class="selfRef">P-DAO from Root</a>
          </figcaption></figure>
</div>
<p id="section-b.2-4">Upon reception of the P-DAO, C validates that it can reach D, e.g. using
   IPv6 Neighbor Discovery, and if so, propagates the P-DAO unchanged to B.<a href="#section-b.2-4" class="pilcrow">¶</a></p>
<p id="section-b.2-5">
   B checks that it can reach C and of so, installs a route towards D via C.
   Then it propagates the P-DAO to A.<a href="#section-b.2-5" class="pilcrow">¶</a></p>
<p id="section-b.2-6">
   The process recurses till the P-DAO reaches S, the ingress of the Segment,
   which installs a route to D via A and sends a DAO-ACK to the Root.<a href="#section-b.2-6" class="pilcrow">¶</a></p>
<span id="name-p-dao-ack-to-root"></span><div id="pdao3">
<figure id="figure-14">
          <div class="artwork art-text alignLeft" id="section-b.2-7.1">
<pre>
              ------+---------
                    |          Internet
                    |
                 +-----+
                 |     | Border Router
                 |     |  (RPL Root)
                 +-----+
                  ^ P-DAO-ACK from S
              /    o   o    o
           /   o o    o  o  o o   o
         |  o o  o o    o   o   o  o  o
         |   o   o  o     o  o    o  o  o
        S  A  B  C   D         o   o o
        o          o             o     o
                          LLN
</pre>
</div>
<figcaption><a href="#figure-14" class="selfRef">Figure 14</a>:
<a href="#name-p-dao-ack-to-root" class="selfRef">P-DAO-ACK to Root</a>
          </figcaption></figure>
</div>
<p id="section-b.2-8">
   As a result, a transversal route is installed that does not need to follow
   the DODAG structure.<a href="#section-b.2-8" class="pilcrow">¶</a></p>
<span id="name-projected-transversal-route-2"></span><div id="opti">
<figure id="figure-15">
          <div class="artwork art-text alignLeft" id="section-b.2-9.1">
<pre>
              ------+---------
                    |          Internet
                    |
                 +-----+
                 |     | Border Router
                 |     |  (RPL Root)
                 +-----+
                    |
              o    o   o    o
          o o   o  o   o  o  o o   o
         o  o o  o o    o   o   o  o  o
         o   o    o  o     o  o    o  o  o
        S&gt;&gt;A&gt;&gt;&gt;B&gt;&gt;C&gt;&gt;&gt;D         o   o o
        o          o             o     o
                          LLN
</pre>
</div>
<figcaption><a href="#figure-15" class="selfRef">Figure 15</a>:
<a href="#name-projected-transversal-route-2" class="selfRef">Projected Transversal Route</a>
          </figcaption></figure>
</div>
</section>
</section>
<div id="authors-addresses">
<section id="section-appendix.c">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Pascal Thubert (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">Cisco Systems, Inc</span></div>
<div dir="auto" class="left"><span class="street-address">Building D<br>45 Allee des Ormes - BP1200</span></div>
<div dir="auto" class="left">
<span class="postal-code">06254</span> <span class="locality">Mougins - Sophia Antipolis</span>
</div>
<div dir="auto" class="left"><span class="country-name">France</span></div>
<div class="tel">
<span>Phone:</span>
<a href="tel:+33%20497%2023%2026%2034" class="tel">+33 497 23 26 34</a>
</div>
<div class="email">
<span>Email:</span>
<a href="mailto:pthubert@cisco.com" class="email">pthubert@cisco.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Rahul Arvind Jadhav</span></div>
<div dir="auto" class="left"><span class="org">Huawei Tech</span></div>
<div dir="auto" class="left"><span class="street-address">Kundalahalli Village, Whitefield,</span></div>
<div dir="auto" class="left">
<span class="locality">Bangalore</span> <span class="postal-code">560037</span>
</div>
<div dir="auto" class="left"><span class="region">Karnataka</span></div>
<div dir="auto" class="left"><span class="country-name">India</span></div>
<div class="tel">
<span>Phone:</span>
<a href="tel:+91-080-49160700" class="tel">+91-080-49160700</a>
</div>
<div class="email">
<span>Email:</span>
<a href="mailto:rahul.ietf@gmail.com" class="email">rahul.ietf@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Matthew Gillmore</span></div>
<div dir="auto" class="left"><span class="org">Itron, Inc</span></div>
<div dir="auto" class="left"><span class="street-address">Building D<br>2111 N Molter Road</span></div>
<div dir="auto" class="left">
<span class="locality">Liberty Lake</span>,  <span class="postal-code">99019</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States</span></div>
<div class="tel">
<span>Phone:</span>
<a href="tel:+1.800.635.5461" class="tel">+1.800.635.5461</a>
</div>
<div class="email">
<span>Email:</span>
<a href="mailto:matthew.gillmore@itron.com" class="email">matthew.gillmore@itron.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
