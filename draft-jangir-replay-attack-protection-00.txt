

  INTERNET DRAFT                                       
  draft-jangir-replay-attack-protection-00.txt
                                                            Mohanlal Jangir
                                          Samsung India Software Operations                      
  Expires 23 Dec 2004                                          23 June 2004
 

       IPSec Replay Attack Protection in Multisender Environment


  Status of this Memo

  This document is an Internet-Draft and is in full conformance
  with all provisions of Section 10 of RFC2026.

  Internet-Drafts are working documents of the Internet Engineering
  Task Force (IETF), its areas, and its working groups.  Note that
  other groups may also distribute working documents as
  Internet-Drafts.

  Internet-Drafts are draft documents valid for a maximum of six
  months and may be updated, replaced, or obsoleted by other
  documents at any time.  It is inappropriate to use Internet-
  Drafts as reference material or to cite them other than as
  "work in progress."


  The list of current Internet-Drafts can be accessed at
  http://www.ietf.org/ietf/1id-abstracts.txt

  The list of Internet-Draft Shadow Directories can be accessed at
  http://www.ietf.org/shadow.html.


  Abstract

  The IPsec Architecture [RFC2401] and IPsec transform RFCs [RFC2402, RFC2406] 
  define certain mechanisms for protecting IP traffic. One of the mechanisms 
  defined is replay attack protection. But this mechanism is not addressed in 
  multisender environment where multiple senders are sending packets for same 
  destination SA (This includes sharing of SA as well as multicast).  This 
  document reviews the issues in multisender environment and addresses solution 
  for this by identifying the sending SA and having replay attack protection 
  against each sending SA. The documents also summarizes the changes needed in 
  AH, ESP, Key management protocols, which would enable IPSec to protect against 
  replay attack protection in multisender environment for same destination SA.


  Table of Contents

  1. Introduction ............................................ 2
  2. Change in Key Management Protocol ....................... 2
  3. Label Management ........................................ 2
  3.1. Label Management in Multicasting ...................... 2
  3.2. Label Management in SA sharing ........................ 3
  4. Change in Authentication Header ......................... 3
  
  Mohanlal Jangir               Expires Dec 23, 2004             [Page 1]
  
  
  Internet-Draft             IPSec Replay Attach Check in             June 2004 
                                Multisender Environment     
  
  5. Inbound Authentication Header processing ................ 3
  6. Replay Attack Protection with ESP ....................... 3
  7. Intellectual Property Statement ......................... 4
  8. Full Copyright Statement ................................ 4
  9. Author's Address .........................................4




  1. Introduction

    Replay protection in multisender environment has been an open issue since 
    the RFC 2401. This draft addresses this issue by assigning a unique two byte 
    identity label to each outbound SA. This could be done by distributing a 
    unique label during SA establishment. The requirements of this distribution 
    protocol are as follows:

    a. The label should have local significance
    b. The label should be issued by inbound SA owner

  2. Change in Key Management Protocol

    This draft defines following new payload type for SA labeling as follows:
    
      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     ! Next Payload  !   RESERVED    !         Payload Length        !
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     !          RESERVED2            !    SA Identification Label    !
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

    Next Payload for SA Identification Label exchange can be defined as 14 for
    test purpose.

  3. Label Management

    Label management for two different scenarios e.g. multicasting and SA 
    sharing is described in following sections.

  3.1. Label Management in Multicasting

    Label management in multicasting SHOULD be performed by GC (Group 
    Controller). Each outbound SA in that multicast group MUST be assigned 
    a group local SA label. SPI for all the SAs in that group will be same, 
    so that all members in that group can use same SA for traffic protection. 
    Each host joining the group will be getting SA parameters and unique SA 
    label. This draft does not address, label management in case of multiples 
    GCs.


  
  Mohanlal Jangir               Expires Dec 23, 2004             [Page 2]
  
  
  Internet-Draft             IPSec Replay Attach Check in             June 2004 
                                Multisender Environment     
 
  3.2. Label Management in SA sharing

    * Each outbound SA at every host must be assigned a unique identity label 
      by the host, SAs are targeted for. 
    * Each host, while establishing an inbound SA, must assign a local unique 
      label to negotiating hosts outbound SA.
    * In this case SA parameters (keys, SPI) will be controlled by the host
      which owns inbound SA.
    * This label assignment should be done using the payload defined above.
    * The label generation is governed by local policy. The label could be a 
      monotonically increasing number or a random number depending on 
      implementation. Labels should be marked as free (can be assigned to other 
      SA), when corresponding peer outbound SA is deleted.


  4. Change in Authentication Header

      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Next Header   |  Payload Len  |Sending SA Identification Label|
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                 Security Parameters Index (SPI)               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                    Sequence Number Field                      |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                                                               |
     +                Authentication Data (variable)                 |
     |                                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  
    Sender Identification Label û The RESERVED bytes in current Authentication 
    Header should be replaced by sender identification label negotiated/assigned 
    during key management negotiation. A host not supporting replay attack for 
    multisender environment MUST send this field as zero.

  5. Inbound Authentication Header processing

    Each receiver should maintain separate replay attack window for each sender. 
    The replay attack check MUST be performed only after authenticating the 
    packet. A host not supporting replay attack check against multiple senders 
    SHOULD ignore the SA identification label.

  6. Replay Attack Protection with ESP

    Presently this draft does not address this issue. Hosts wishing to have 
    protection in this case SHOULD use AH + ESP.


  

  Mohanlal Jangir               Expires Dec 23, 2004             [Page 3]
  
  
  Internet-Draft             IPSec Replay Attach Check in             June 2004 
                                Multisender Environment     
 
  7. Intellectual Property Statement

  The IETF takes no position regarding the validity or scope of any
  intellectual property or other rights that might be claimed to
  pertain to the implementation or use of the technology described in
  this document or the extent to which any license under such rights
  might or might not be available; neither does it represent that it
  has made any effort to identify any such rights.  Information on the
  IETF's procedures with respect to rights in standards-track and
  standards-related documentation can be found in BCP-11.  Copies of
  claims of rights made available for publication and any assurances of
  licenses to be made available, or the result of an attempt made to
  obtain a general license or permission for the use of such
  proprietary rights by implementers or users of this specification can
  be obtained from the IETF Secretariat.

  The IETF invites any interested party to bring to its attention any
  copyrights, patents or patent applications, or other proprietary
  rights which may cover technology that may be required to practice
  this standard.  Please address the information to the IETF Executive
  Director.

  8. Full Copyright Statement

  Copyright (C) The Internet Society (2002).  All Rights Reserved.

  This document and translations of it may be copied and furnished to
  others, and derivative works that comment on or otherwise explain it
  or assist in its implementation may be prepared, copied, published and
  distributed, in whole or in part, without restriction of any kind,
  provided that the above copyright notice and this paragraph are
  included on all such copies and derivative works.  However, this
  document itself may not be modified in any way, such as by removing
  the copyright notice or references to the Internet Society or other
  Internet organizations, except as needed for the purpose of developing
  Internet standards in which case the procedures for copyrights defined
  in the Internet Standards process must be followed, or as required to
  translate it into languages other than English.

  The limited permissions granted above are perpetual and will not be
  revoked by the Internet Society or its successors or assigns.
  This document and the information contained herein is provided on an
 
 "AS IS" basis and THE INTERNET SOCIETY AND THE INTERNET ENGINEERING
  TASK FORCE DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING BUT
  NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE INFORMATION HEREIN
  WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED WARRANTIES OF
  MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

  Funding for the RFC editor function is currently provided by the
  Internet Society.

  9. Author's Address

  Mohanlal Jangir
  Samsung India Software Operations
  Bangalore, INDIA
  Ph: +919845043943
  E mail: mohanlal@samsung.com
  
  Mohanlal Jangir               Expires Dec 23, 2004             [Page 4]

