<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Digital Signature Methods for Location Dependability</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Digital Signature Methods for Location Dependability">
<meta name="keywords" content="Internet-Draft, Location, Dependability, PIDF-LO, HELD, LIS">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">GEOPRIV</td><td class="header">M. Thomson</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">J. Winterbottom</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">Andrew</td></tr>
<tr><td class="header">Expires: January 9, 2010</td><td class="header">July 08, 2009</td></tr>
</table></td></tr></table>
<h1><br />Digital Signature Methods for Location Dependability<br />draft-thomson-geopriv-location-dependability-04</h1>

<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on January 9, 2010.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2009 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents in effect on the date of
publication of this document (http://trustee.ietf.org/license-info).
Please review these documents carefully, as they describe your
rights and restrictions with respect to this document.</p>

<h3>Abstract</h3>

<p>The dependability of location information is closely related to the degree of trust placed in the source of that information.  This document describes techniques that can be used to mitigate the impact of falsifying location information.  The application of digital signatures is described, relating these methods to the attacks that they address.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#intro">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#terminology">1.1.</a>&nbsp;
Terminology<br />
<a href="#anchor1">2.</a>&nbsp;
Goals<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">2.1.</a>&nbsp;
Non-Goals<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">2.2.</a>&nbsp;
Basic Countermeasures<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">2.3.</a>&nbsp;
Signing Location Information<br />
<a href="#anchor5">3.</a>&nbsp;
PIDF-LO Signature<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">3.1.</a>&nbsp;
Signature Design<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#elements">3.2.</a>&nbsp;
Signed Elements and Semantics<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">3.3.</a>&nbsp;
Signature Algorithms<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">3.4.</a>&nbsp;
LIS/Signer Identification<br />
<a href="#validity">4.</a>&nbsp;
Limited Validity<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">4.1.</a>&nbsp;
Validity Elements<br />
<a href="#identity">5.</a>&nbsp;
Signing for a User<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#presentity">5.1.</a>&nbsp;
The 'entity' Attribute<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#target-identity">5.2.</a>&nbsp;
Target Identity<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anon-identity">5.3.</a>&nbsp;
Protecting User Anonymity<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#auth-identity">5.4.</a>&nbsp;
Authenticated Identity<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#plethora-identity">5.5.</a>&nbsp;
Multiple Identity Attack<br />
<a href="#identity-element">6.</a>&nbsp;
Target Identity Element<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">6.1.</a>&nbsp;
Identity Types<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">6.2.</a>&nbsp;
Identity Hashing<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">6.3.</a>&nbsp;
Authentication Indicator<br />
<a href="#anchor13">7.</a>&nbsp;
Requesting Dependable Location Information using HELD<br />
<a href="#anchor14">8.</a>&nbsp;
Signature Validation<br />
<a href="#anchor15">9.</a>&nbsp;
Code and Examples<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#schema">9.1.</a>&nbsp;
Dependability Data Schema<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#heldschema">9.2.</a>&nbsp;
HELD Dependability Request Schema<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#transforms">9.3.</a>&nbsp;
PIDF-LO Transforms<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#transform-tuple">9.3.1.</a>&nbsp;
PIDF-LO Tuple-only Transform<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#transform-selective">9.3.2.</a>&nbsp;
PIDF-LO Selective Transform<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#example">9.4.</a>&nbsp;
Example<br />
<a href="#anchor16">10.</a>&nbsp;
Location Reference Attribution<br />
<a href="#security">11.</a>&nbsp;
Security Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rules">11.1.</a>&nbsp;
Signature Rules<br />
<a href="#iana">12.</a>&nbsp;
IANA Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor17">12.1.</a>&nbsp;
URN Sub-Namespace Registration for urn:ietf:params:xml:ns:pidf:geopriv10:dsig<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">12.2.</a>&nbsp;
XML Schema Registration<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor19">12.3.</a>&nbsp;
URN Sub-Namespace Registration for urn:ietf:params:xml:ns:pidf:geopriv10:dsig:identity<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor20">12.4.</a>&nbsp;
URN Sub-Namespace Registration for urn:ietf:params:xml:ns:geopriv:held:dep<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor21">12.5.</a>&nbsp;
XML Schema Registration<br />
<a href="#ack">13.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">14.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">14.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">14.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="intro"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>Location information about a particular person or device is critical to a number of applications.  The integrity of this information - whether or not it can be relied upon for correctness - is also important to the user of the data.  This is especially important if the recipient of location information expends resources based on the information.
      
</p>
<p>The quitessential example of an application where the veracity of location information is critical is emergency calling.  Location information is used both by routing functions to determine the correct Public Safety Answering Point (PSAP) and by the selected PSAP to determine where to send personnel.  If location information were faked, the call could be directed to the wrong PSAP, or personnel could be directed to an incorrect location.  In either case, an attacker wastes PSAP resources and risks delaying their life-critical interventions for other legitimate emergency callers.
      
</p>
<p>This document details several cryptographic methods that limit the scope of attacks on location recipients based on faked or stolen location information.  Methods for applying digital signatures are described so that a location recipient can identify the source of the location information, either Location Information Server (LIS) or Target.  Identifying the source allows the location recipient to make a judgement on whether or not to trust the content of the location information.
      
</p>
<p>Ultimately, these methods are limited in practicality by the transient nature of the relationships between LIS (the access network) and the Target.  Because these relationships can be arbitrary and temporary, schemes like authentication are not always feasible.  The basic goal of this draft is to both limit the scope of attacks and to provide as much information to the location recipient as possible so that they can make a decision on whether or not to act on the location information they are provided.
      
</p>
<a name="terminology"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Terminology</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
        
</p>
<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Goals</h3>

<p>This document describes several measures that can be applied to limit attacks that rely on using faked or stolen location information.  These attacks leave a user of location information vulnerable to exploitation by an attacker.
      
</p>
<p>The measures outlined in this document are designed to limit exposure to the following attacks:
      </p>
<blockquote class="text"><dl>
<dt>Place Shifting:</dt>
<dd>In place shifting, an attacker selects any location (presumably somewhere other than where they are currently located) and constructs a PIDF-LO based on that information.
        
</dd>
<dt>Time Shifting:</dt>
<dd>In a time shifting, or replay, attack the attacker uses location information that was valid in the past, but is no longer valid because the attacker has moved since the location was generated.
        
</dd>
<dt>Location Theft:</dt>
<dd>An attacker that is able to observe the Target's location information can replay this information and thereby appear to be at the same location.
        
</dd>
<dt>Location Swapping:</dt>
<dd>Two colluding attackers can conspire to fake location by exchanging location information.  One attacker can pretend to be at the other's location.
        
</dd>
</dl></blockquote><p>
      These attacks are a subset of those described in <a class='info' href='#I-D.ietf-geopriv-l7-lcp-ps'>[I&#8209;D.ietf&#8209;geopriv&#8209;l7&#8209;lcp&#8209;ps]<span> (</span><span class='info'>Tschofenig, H. and H. Schulzrinne, &ldquo;GEOPRIV Layer 7 Location Configuration Protocol; Problem Statement and Requirements,&rdquo; July&nbsp;2009.</span><span>)</span></a>.
      
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
Non-Goals</h3>

<p>The measures outlined in this document cannot hope to address all possible cases of fraud.  This section outlines general areas where this document does not provide guidance; more specific limitations are included in the relevant sections.
        
</p>
<p>Attacks where the authenticated identity of the Target can be reliably mimicked are not included.  This includes active collusion, as well as any attacks, network-based or otherwise, on the Target host that result in complete access to the Target's credentials.  In addition, this includes attacks that require cooperation between the attacker and Target.  If the attacker is able to gain access to the Target's private key, then to all cryptographic means the attacker can pretend to be the Target.
        
</p>
<p>Methods for determining trust in either LIS or Target are out of scope for this document.  This document only describes the means by which an identity can be verified; the decision over whether or not to trust the entity is left to the location recipient.  Means for establishing trust will be the topic of a separate work.
        
</p>
<p>Note that where certificate chains are used for authentication, a domain name-based certificate does not necessarily indicate trustworthiness in the provision of location information.  Therefore, verification of LIS identity through a certificate alone is not enough to ensure that the location recipient can trust the LIS, the recipient needs to use additional criteria to decide on whether to trust the LIS.
        
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
Basic Countermeasures</h3>

<p>A good minimum requirement for the exchange of location information is that location information is protected from interception and modification by third parties in all protocol exchanges.  Confidentiality from unauthorized third parties and integrity protection are required for all location using-protocols <a class='info' href='#RFC3693'>[RFC3693]<span> (</span><span class='info'>Cuellar, J., Morris, J., Mulligan, D., Peterson, J., and J. Polk, &ldquo;Geopriv Requirements,&rdquo; February&nbsp;2004.</span><span>)</span></a>.
        
</p>
<p>Location protocols that use <a class='info' href='#RFC5246'>TLS<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a> [RFC5246] are able to meet this requirement providing mutual authentication is adequate.  <a class='info' href='#I-D.ietf-geopriv-http-location-delivery'>HELD<span> (</span><span class='info'>Barnes, M., Winterbottom, J., Thomson, M., and B. Stark, &ldquo;HTTP Enabled Location Delivery (HELD),&rdquo; August&nbsp;2009.</span><span>)</span></a> [I&#8209;D.ietf&#8209;geopriv&#8209;http&#8209;location&#8209;delivery] relies on TLS and the authentication system defined in <a class='info' href='#I-D.ietf-geopriv-lis-discovery'>LIS discovery<span> (</span><span class='info'>Thomson, M. and J. Winterbottom, &ldquo;Discovering the Local Location Information Server (LIS),&rdquo; March&nbsp;2010.</span><span>)</span></a> [I&#8209;D.ietf&#8209;geopriv&#8209;lis&#8209;discovery].
        
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3"></a><h3>2.3.&nbsp;
Signing Location Information</h3>

<p>A digital signature provides data integrity and attribution for the signed information.  This document describes how <a class='info' href='#RFC3275'>XML-Signature<span> (</span><span class='info'>Eastlake, D., Reagle, J., and D. Solo, &ldquo;(Extensible Markup Language) XML-Signature Syntax and Processing,&rdquo; March&nbsp;2002.</span><span>)</span></a> [RFC3275] can be applied to a <a class='info' href='#RFC4119'>Presence Information Data Format - Location Object (PIDF-LO)<span> (</span><span class='info'>Peterson, J., &ldquo;A Presence-based GEOPRIV Location Object Format,&rdquo; December&nbsp;2005.</span><span>)</span></a> [RFC4119].  It also describes the benefits of signing and how signing can be practically applied.
        
</p>
<p>PIDF-LO contains a number of different units of data: location information, time, and identity being most important in this context <a class='info' href='#I-D.barnes-geopriv-lo-sec'>[I&#8209;D.barnes&#8209;geopriv&#8209;lo&#8209;sec]<span> (</span><span class='info'>Barnes, R., Lepinski, M., Cooper, A., Morris, J., Tschofenig, H., and H. Schulzrinne, &ldquo;An Architecture for Location and Location Privacy in Internet Applications,&rdquo; March&nbsp;2009.</span><span>)</span></a>.  How these are bound in a signature determine what meaning is conveyed.  This document describes how certain bindings can be signed.
        
</p>
<p>In signing a PIDF-LO, the signer makes an assertion about these bindings.  It is the signer's responsibility to verify that the bindings it signs are correct and verified.  Failure to do so has an impact on how trust in the signer is maintained.  Without trust in a signer, the signatures they provide are ineffectual.
        
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
PIDF-LO Signature</h3>

<p>A location recipient can use the signature on a location object to authenticate the identity of the signer, usually the source of the information.   The identity of the source is indicated in the certificate that is attached to the signature.  The signature also ensures that the contents have not been modified since the location object was signed.
      
</p>
<p>In <a class='info' href='#I-D.barnes-geopriv-lo-sec'>GEOPRIV<span> (</span><span class='info'>Barnes, R., Lepinski, M., Cooper, A., Morris, J., Tschofenig, H., and H. Schulzrinne, &ldquo;An Architecture for Location and Location Privacy in Internet Applications,&rdquo; March&nbsp;2009.</span><span>)</span></a> [I&#8209;D.barnes&#8209;geopriv&#8209;lo&#8209;sec] this entity is likely to be a location information server (LIS).  Other providers of location information, or location servers (LS), might also provide signatures.  For instance a device might provide location information and include a signature.
      
</p>
<p>It is important to specify the semantics of a certificate of this nature.  In essence, information that is signed SHOULD be verifiable by the LIS.  However, in some cases it is expedient to include some unverifiable information (as is shown in later sections).  Therefore, this document assigns a strict semantic to each signed element in the location object.
      
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Signature Design</h3>

<p>[[Editors Note:  It is recognized that XML-Signature has a major failure in its reliance on XML canonicalization.  Due to this reliance, very few interoperable implementations of XML-Signature exist.  On the other hand, it does offer a great deal of flexibility, such as the ability to select the elements that are signed.  The alternative is for the signer to just remove the unsigned portions.  Then any alternative signature method could be used, such as the equally widely implemented S/MIME.]]
        
</p>
<p>This document uses the <a class='info' href='#RFC3275'>XML-Signature<span> (</span><span class='info'>Eastlake, D., Reagle, J., and D. Solo, &ldquo;(Extensible Markup Language) XML-Signature Syntax and Processing,&rdquo; March&nbsp;2002.</span><span>)</span></a> [RFC3275] enveloped signature type; that is, signature elements are included within the normal structure of the PIDF-LO document.  This ensures that the location object does not appear to be any different from a regular PIDF-LO document.  This permits use of the document in any protocol that carries PIDF-LO without requiring any changes to the protocol.  Applications that rely on PIDF-LO can simply ignore the signature elements if they are not supported.
        
</p>
<p>A signature is applied to a single tuple within the PIDF document.  This means that signed location information can be included in a composite presence document without destroying the signature.
        
</p>
<p>It is also a goal of the signature design to ensure that if unsigned elements are removed from the PIDF-LO, the document remains a valid PIDF-LO.  This keeps the PIDF-LO usable if the signature and any unsigned data are stripped out.  This is particularly important when the <a class='info' href='#rules'>signature rules<span> (</span><span class='info'>Signature Rules</span><span>)</span></a> are applied.
        
</p>
<a name="elements"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Signed Elements and Semantics</h3>

<p>When location information is signed by a LIS, each unit of data in the signed document is given certain significance.  A location recipient needs to know what significance the LIS has given to each field before it can base any decision on the contents of that field.
        
</p>
<p>The following list describes each of the elements that are included in a signed LO, justifies their inclusion and outlines the intended semantics of each being signed:
        </p>
<blockquote class="text"><dl>
<dt>presence (urn:ietf:params:xml:ns:pidf):</dt>
<dd>
            The root element of a <a class='info' href='#RFC3863'>presence document<span> (</span><span class='info'>Sugano, H., Fujimoto, S., Klyne, G., Bateman, A., Carr, W., and J. Peterson, &ldquo;Presence Information Data Format (PIDF),&rdquo; August&nbsp;2004.</span><span>)</span></a> [RFC3863], the <tt>presence</tt> element, is signed.  The <tt>entity</tt> attribute is also signed.  In most cases, the <tt>entity</tt> attribute contains an identifier generated by the LIS, see <a class='info' href='#identity'>Section&nbsp;5<span> (</span><span class='info'>Signing for a User</span><span>)</span></a> and <a class='info' href='#anon-identity'>Section&nbsp;5.3<span> (</span><span class='info'>Protecting User Anonymity</span><span>)</span></a>.
          
</dd>
<dt>tuple (urn:ietf:params:xml:ns:pidf):</dt>
<dd>
            Only the tuple that contains location information is signed.  The <tt>id</tt> attribute is signed to ensure a valid PIDF-LO is produced.  Likewise, the <tt>device</tt> and <tt>person</tt> elements (in the <tt>urn:ietf:params:xml:ns:pidf:data-model</tt> namespace, <a class='info' href='#RFC4479'>[RFC4479]<span> (</span><span class='info'>Rosenberg, J., &ldquo;A Data Model for Presence,&rdquo; July&nbsp;2006.</span><span>)</span></a>) that contain location information need to be included by the signature.
          
</dd>
<dt>geopriv (urn:ietf:params:xml:ns:pidf:geopriv10):</dt>
<dd>
            The <tt>geopriv</tt> element is signed, along with select elements within it.
          
</dd>
<dt>location-info (urn:ietf:params:xml:ns:pidf:geopriv10):</dt>
<dd>
            The most important element of the PIDF-LO, <tt>location-info</tt> contains location data.  This element and all its contents are signed.
          
</dd>
<dt>usage-rules (urn:ietf:params:xml:ns:pidf:geopriv10):</dt>
<dd>
            Usage rules are included to ensure the validity of the PIDF-LO.  An empty <tt>usage-rules</tt> element is valid.  The contents of these are not signed to allow a user to enter their preferences upon receipt of the signed LO.  A LIS does not typically set policy, so SHOULD NOT sign these elements unless a Rule Maker (see <a class='info' href='#RFC3693'>[RFC3693]<span> (</span><span class='info'>Cuellar, J., Morris, J., Mulligan, D., Peterson, J., and J. Polk, &ldquo;Geopriv Requirements,&rdquo; February&nbsp;2004.</span><span>)</span></a>) has provided values.  No decisions can be made on the unsigned content of usage rules.
          
</dd>
<dt>method (urn:ietf:params:xml:ns:pidf:geopriv10):</dt>
<dd>
            The method parameter is included, and consequently signed, only if known.  The LIS SHOULD verify the accuracy of this field, but MAY opt to include the element without validation.  An unvalidated method is allowed because of the informational nature of the data it contains.  Method is a metadata element and therefore is not a suitable basis for decision making, especially where a similar decision can be based on location information.  A recipient SHOULD NOT use the value of this field as the basis for any decision.
          
</dd>
<dt>timestamp (...:pidf or ...:pidf:data-model):</dt>
<dd>
            The time that location is generated (or signed) is extremely important in determining whether location information is valid.  This element, defined in <a class='info' href='#RFC3863'>[RFC3863]<span> (</span><span class='info'>Sugano, H., Fujimoto, S., Klyne, G., Bateman, A., Carr, W., and J. Peterson, &ldquo;Presence Information Data Format (PIDF),&rdquo; August&nbsp;2004.</span><span>)</span></a> or <a class='info' href='#RFC4479'>[RFC4479]<span> (</span><span class='info'>Rosenberg, J., &ldquo;A Data Model for Presence,&rdquo; July&nbsp;2006.</span><span>)</span></a> is always signed.
          
</dd>
<dt>All elements defined in this document:</dt>
<dd>
            This document defines a number of elements that are designed for inclusion in the tuple.  These elements limit the effectiveness of certain attacks.  Validity intervals and Target identity are defined in <a class='info' href='#validity'>Section&nbsp;4<span> (</span><span class='info'>Limited Validity</span><span>)</span></a>, <a class='info' href='#identity'>Section&nbsp;5<span> (</span><span class='info'>Signing for a User</span><span>)</span></a>.
          
</dd>
</dl></blockquote>

<p>This document defines two transforms that can be applied to a PIDF-LO in order to limit what is signed <a class='info' href='#transforms'>Section&nbsp;9.3<span> (</span><span class='info'>PIDF-LO Transforms</span><span>)</span></a>.  The first is a selective transform that only selects the elements listed above.  The second simply selects the enveloping <tt>tuple</tt>, <tt>device</tt> or <tt>person</tt>element.  The signing entity MAY choose not to use either transform, but in doing so, all unverified elements MUST be removed from the signed document.
        
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
Signature Algorithms</h3>

<p>As specified in <a class='info' href='#RFC3275'>RFC 3275<span> (</span><span class='info'>Eastlake, D., Reagle, J., and D. Solo, &ldquo;(Extensible Markup Language) XML-Signature Syntax and Processing,&rdquo; March&nbsp;2002.</span><span>)</span></a> [RFC3275], implementations of this specification MUST provide the following algorithms:
        </p>
<blockquote class="text"><dl>
<dt>digest algorithm:</dt>
<dd>The SHA1 digest, as identified by the URN <tt>http://www.w3.org/2000/09/xmldsig#sha1</tt>.
          
</dd>
<dt>signature algorithm:</dt>
<dd>DSA with SHA1, as identified by the URN <tt>http://www.w3.org/2000/09/xmldsig#dsa-sha1</tt>.
          
</dd>
<dt>canonicalization method:</dt>
<dd>Canonical XML <a class='info' href='#RFC3076'>[RFC3076]<span> (</span><span class='info'>Boyer, J., &ldquo;Canonical XML Version 1.0,&rdquo; March&nbsp;2001.</span><span>)</span></a>, as identified by the URN <tt>http://www.w3.org/TR/2001/REC-xml-c14n-20010315</tt>.
          
</dd>
<dt>transforms:</dt>
<dd>The enveloped signature transform, as identified by the URN <tt>http://www.w3.org/2000/09/xmldsig#enveloped-signature</tt>; and the transforms defined in this document: the <a class='info' href='#transform-tuple'>tuple-only transform<span> (</span><span class='info'>PIDF-LO Tuple-only Transform</span><span>)</span></a>, as identified by the URN <tt>urn:ietf:params:xml:ns:pidf:geopriv10:dsig#tuple</tt> and the <a class='info' href='#transform-selective'>selective transform<span> (</span><span class='info'>PIDF-LO Selective Transform</span><span>)</span></a>, as identified by the URN <tt>urn:ietf:params:xml:ns:pidf:geopriv10:dsig#selective</tt>.
          
</dd>
</dl></blockquote><p>
        
</p>
<p>It is also RECOMMENDED that the PKCS1 (RSA-SHA1) signature algorithm, as idenfied by <tt>http://www.w3.org/2000/09/xmldsig#rsa-sha1</tt> is also supported.
        
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4"></a><h3>3.4.&nbsp;
LIS/Signer Identification</h3>

<p><a class='info' href='#RFC3275'>RFC 3275<span> (</span><span class='info'>Eastlake, D., Reagle, J., and D. Solo, &ldquo;(Extensible Markup Language) XML-Signature Syntax and Processing,&rdquo; March&nbsp;2002.</span><span>)</span></a> [RFC3275] describes a number of methods for describing the key used to sign the document.  For the purpose of signing a location object, the <tt>KeyInfo</tt> element MUST be provided in the <tt>Signature</tt> element.
        
</p>
<p>The signer MUST include an X.509v3 certificate in the signature.  This can be either by including an <tt>X509Certificate</tt> element, or by referencing another certificate.
        
</p>
<p>A reference to a certificate within the same document may be made using a fragment identifier URI.  Internal references could be applicable where multiple signatures are applied to different parts of the document.
        
</p>
<p>The signer SHOULD NOT reference an external source unless there is a reasonable expectation that the location recipient can successfully retrieve the certificate.  A reference to an external certificate MUST be described by URI in the <tt>RetrievalMethod</tt> element.  The scheme for the the RetrievalMethod URI MUST be <tt>https:</tt>.
        
</p>
<a name="validity"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Limited Validity</h3>

<p>The simplest attack to address is the Time Shifting attack.  The <tt>timestamp</tt> element provides a basic indication of when location information was created.
      
</p>
<p>However, the basic timestamp doesn't provide any indication of how long that information is likely to be valid for.  The LIS can specify a limited time period where the location information can be considered valid.
      
</p>
<p>A known limitation of this method is that the information could become invalid at any time after the LIS signs the document.  Once location is generated, the Target can move at any time, thereby invalidating the location object.  Therefore, there is a trade-off in selecting a value that minimizes errors, while increasing the chance that the information is useful.  The LIS can base any chosen period on any knowledge it has about the mobility or current speed of the Target.
      
</p>
<p>The time constraints can be considered guidelines provided by a LIS.  Recipients can choose instead to base decisions purely on the <tt>timestamp</tt> element.  Location recipients MAY choose to implement a minimum age policy for locations.  It is RECOMMENDED that the <tt>from</tt> element is used in this case, since the LIS is expected to validate location before it signs location information.
      
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Validity Elements</h3>

<p>A <tt>validity</tt> element is defined with two sub-elements, <tt>from</tt> and <tt>until</tt>.
        
</p>
<p>The <tt>from</tt> element contains the time that the LIS signs the location information.  Note that this could differ from the time that the location was generated, which is included in the PIDF <tt>timestamp</tt> element.
        
</p>
<p>The <tt>until</tt> element contains the last time that the signature can be considered valid.  Choice of an appropriate validity interval is left to LIS implementations; however, it is RECOMMENDED that this period not exceed one day.  The period chosen SHOULD also consider the type of network access in use - location becomes invalid faster in more mobile networks.
        
</p>
<p>The signature MUST NOT be considered valid if the current time is outside of the interval specified in these elements.
        
</p>
<a name="identity"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Signing for a User</h3>

<p>Signing location information alone, even with a limited validity period does not ensure that it is not reused.  Signing some sort of user identifier with the location object provides an additional degree of protection.  Most importantly, the location recipient is able to detect duplicate location objects for the same Target.  In addition, if some extra data is included from the Target, the location recipient is also able to link the location object with a user identity.
      
</p>
<a name="presentity"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
The 'entity' Attribute</h3>

<p>The <tt>entity</tt> attribute of a presence document is intended to convey the identity of the Target.  The LIS does not necessarily know this identity.  Nor does the LIS necessarily have the means to authenticate the Target.
        
</p>
<p>It is RECOMMENDED that this field be generated by the LIS.  The LIS SHOULD construct an "unlinked pseudonym" that does not contain any information that could be used to identity the Target.  The simplest way to meet this requirement is to generate a <tt>pres:</tt> URI randomly, using a random sequence of characters and the host name of the LIS (e.g., <tt>pres:f6pc98w1pd49s0p@lis.example.com</tt>).
        
</p>
<p>An unlinked pseudonym provides a limited means of ensuring that location information is not reused or replayed.  The presentity identifier used acts as a serial number for each location object, allowing each to be uniquely identified.  A location recipient is able to use this identifier to detect multiple uses of the same piece of location information.  This limits the effectiveness of replay attacks.
        
</p>
<p>However, an unlinked pseudonym does not provide any useful identification information.  Users of this information are forced to rely on external information to bind the identity of the Target of the document to a specific entity.
        
</p>
<p>Some continuity can be provided by reusing unlinked pseudonyms for the same Target.  If the LIS is able to verify that the Target is the same, the same identifier can be used in multiple PIDF-LO documents, linking these documents.  This depends on the means by which location is acquired from the LIS; if session data that links subsequent requests exists, the LIS MAY reuse the presentity identifier.  Note that some means is required to break this continuity to allow for a Target that does not wish for this linkage to occur.
        
</p>
<p>This does not prevent the use of a "real" presentity in this field.  If the LIS is able to authenticate the Target, and the Target grants permission to the LIS to use this field, the LIS can include this information in the <tt>entity</tt> field.  These conditions are hard to meet, which leads to two alternative means of including Target identity, described in the following sections.
        
</p>
<a name="target-identity"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Target Identity</h3>

<p>The unlinked pseudonym used by the LIS acts as an anonymous identifier to a location recipient.  The only information that this provides is that two location objects were generated for the same anonymous Target.  The location recipient might also wish to link the location object to the identity of a particular user.  For example, a PSAP might want to link the location object to the authenticated identity of a emergency caller.
        
</p>
<p>To achieve this linkage between location object and the Target's identity, the Target sends its identity to the LIS.  The LIS includes this identifier in the signed location object, effectively linking the identity to the location information.
        
</p>
<p>A location recipient verifies that location information was signed for a particular Target by authenticating the Target and comparing the authenticated identity against the one in the signed location object.
        
</p>
<p>The LIS is not expected to authenticate this identity information, although it MAY do so.  This means that an attacker within the network could request a signed location object with any identity they choose.  However, the location object could only be used by an entity that can prove that they have the chosen identity, which limits the number of potential attackers.
        
</p>
<a name="anon-identity"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3"></a><h3>5.3.&nbsp;
Protecting User Anonymity</h3>

<p>The problem with sending the Target's identity to the LIS is that the Target might not wish to provide this information to the access network operator.
        
</p>
<p>This can be addressed by using a cryptographic hash of the user identity in place of the actual identifier.  Since the LIS does not necessarily authenticate the identity, this information provides the same attributes as the real identity.  Since the hash is not reversible, the LIS is unable to identify the Target, but the hash cannot be generated from any identifier other than the one used by the Target.
        
</p>
<p>The location recipient authenticates the Target's identity, then compares a hash of the identity to the hash that is included in the location object to verify that the identity matches.
        
</p>
<a name="auth-identity"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.4"></a><h3>5.4.&nbsp;
Authenticated Identity</h3>

<p>With the above solution, one easy collusion attack exists.  One attacker at the actual location requests a location object with another attacker's identity.  The second, potentially remote, attacker is able to use this object.  If the first attacker is authenticated by the LIS, this attack is limited, because it requires that both attackers have access to the same authentication credentials.
        
</p>
<p>The effectiveness of this approach is limited by the ability of the LIS to authenticate arbitrary users in the access network.  Location recipients cannot rely on the LIS performing authentication.
        
</p>
<p>Authenticating the Target is complicated by the fact that the identity used in the application domain where location is consumed might be significantly different to the one that a LIS operates in.   Identity that might be used by a location recipient might have no meaning (or a completely different meaning) to a LIS.  It's possible that a LIS could rely upon federated identity, such as <a class='info' href='#I-D.ietf-oauth-authentication'>OAuth<span> (</span><span class='info'>Hammer-Lahav, E., &ldquo;The OAuth Protocol: Authentication,&rdquo; July&nbsp;2009.</span><span>)</span></a> [I&#8209;D.ietf&#8209;oauth&#8209;authentication] to resolve this problem.
        
</p>
<a name="plethora-identity"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.5"></a><h3>5.5.&nbsp;
Multiple Identity Attack</h3>

<p>The schemes described in this section rely on the Target providing an identity.  A potential attack uses a single attacker in the access network that requests location information using a number of different identities.  The attacker requests multiple location objects, using a different identity each time.  These objects are passed to any number of other attackers, who are each able to authenticate with the identity that is included in the location object.  This potentially allows a large number of distributed attackers to use the same location information to perform a denial of service attack.
        
</p>
<p>In some scenarios, multiple identities can be valid.  Examples in Section 3 of <a class='info' href='#I-D.ietf-geopriv-l7-lcp-ps'>[I&#8209;D.ietf&#8209;geopriv&#8209;l7&#8209;lcp&#8209;ps]<span> (</span><span class='info'>Tschofenig, H. and H. Schulzrinne, &ldquo;GEOPRIV Layer 7 Location Configuration Protocol; Problem Statement and Requirements,&rdquo; July&nbsp;2009.</span><span>)</span></a> show that multiple hosts can appear from the same network demarcation point.  Ideally, the LIS would still serve these hosts individually because they each have a valid reason to acquire location information under different identities.
        
</p>
<p>However, to prevent an attack where a user requests large numbers of location objects with different identity information, a LIS SHOULD limit the number of identities that can be served from any particular network point.  Authenticating the Targets in this scenario could provide some additional surety that each is legitimate.  If multiple Targets legitimately exist at the same location, then these Targets can authenticate with the LIS.  The LIS MAY use a higher limit for authenticated Targets.
        
</p>
<a name="identity-element"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Target Identity Element</h3>

<p>This document defines an XML <tt>identity</tt> element that can be used to include identity information in a PIDF-LO.  This element is used in addition to a randomized <tt>entity</tt> attribute for several reasons: a randomized <tt>entity</tt> attribute can be used to detect replays; the identity is not necessarily authenticated; and the content can be other than a presentity identifier.
      
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
Identity Types</h3>

<p>The content of this element is dependent on the type associated with the identifier.  The <tt>type</tt> attribute is used to define the nature of the identity that is included.  Two values are provided by default:

        </p>
<blockquote class="text"><dl>
<dt>URI:</dt>
<dd>A value of <tt>urn:ietf:params:xml:ns:pidf:geopriv10:dsig:identity#uri</tt> for the type attribute indicates that the contents are a URI.  This URI can include a presentity URI, or other URI that identifies the target; for example a SIP URI.  This type MUST be supported.
          
</dd>
<dt>An X.509 certificate:</dt>
<dd>A value of <tt>urn:ietf:params:xml:ns:pidf:geopriv10:dsig:identity#x509</tt> indicates that the contents are an <a class='info' href='#X509v3'>X.509v3 certificate<span> (</span><span class='info'>ITU-T Recommendation, &ldquo;Information Technology - Open Systems Interconnection - The Directory Authentication Framework,&rdquo; 1997.</span><span>)</span></a> [X509v3], in the format described in <a class='info' href='#RFC3275'>[RFC3275]<span> (</span><span class='info'>Eastlake, D., Reagle, J., and D. Solo, &ldquo;(Extensible Markup Language) XML-Signature Syntax and Processing,&rdquo; March&nbsp;2002.</span><span>)</span></a> for <tt>X509Certificate</tt>.
          
</dd>
</dl></blockquote><p>
        
</p>
<p>New identity types are identified by URNs, which means that registration is not required to add new types.  A location recipient that does not support a particular identity type MUST treat the location object as if no identity information were included.
        
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
Identity Hashing</h3>

<p>To allow for anonymity, the content of the <tt>identity</tt> element MAY be hashed and the hash value included in this element instead.  The <tt>hash</tt> attribute indicates whether the value has been hashed.  A reserved value of <tt>##none</tt> indicates that the actual value is included.  Otherwise, the attribute includes a hash algorithm identifier, as defined in <a class='info' href='#RFC3275'>[RFC3275]<span> (</span><span class='info'>Eastlake, D., Reagle, J., and D. Solo, &ldquo;(Extensible Markup Language) XML-Signature Syntax and Processing,&rdquo; March&nbsp;2002.</span><span>)</span></a>.  The SHA1 algorithm MUST be supported; this is identified by the URN <tt>http://www.w3.org/2000/09/xmldsig#sha1</tt>.
        
</p>
<p>Each different identity type requires a procedure for obtaining the bytes that are hashed.
        </p>
<blockquote class="text"><dl>
<dt>URI:</dt>
<dd>For the URI type, the input to the hash algorithm is the UTF-8 bytes of the URI.
          
</dd>
<dt>X.509:</dt>
<dd>For the X.509 type, the input to the hash algorithm is the distinguished encoding rules (DER) encoded value of the certificate.
          
</dd>
</dl></blockquote>

<p>If the <tt>hash</tt> attribute is present and set to a value other than <tt>##none</tt>, the contents of the <tt>identity</tt> element are always the <a class='info' href='#RFC3548'>base64 encoded<span> (</span><span class='info'>Josefsson, S., &ldquo;The Base16, Base32, and Base64 Data Encodings,&rdquo; July&nbsp;2003.</span><span>)</span></a> [RFC3548] result from the hash function.
        
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.3"></a><h3>6.3.&nbsp;
Authentication Indicator</h3>

<p>If the LIS is able to authenticate the Target, the LIS can indicate this in the <tt>authenticated</tt> attribute.
        
</p>
<p>This indicator can be used irrespective of the value of the <tt>hash</tt> attribute.  This indicates to the location recipient that user identity included in the <tt>identity</tt> element was authenticated by the LIS.
        
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Requesting Dependable Location Information using HELD</h3>

<p><a class='info' href='#I-D.ietf-geopriv-http-location-delivery'>HELD<span> (</span><span class='info'>Barnes, M., Winterbottom, J., Thomson, M., and B. Stark, &ldquo;HTTP Enabled Location Delivery (HELD),&rdquo; August&nbsp;2009.</span><span>)</span></a> [I&#8209;D.ietf&#8209;geopriv&#8209;http&#8209;location&#8209;delivery] is used by Devices to request location information.  This section outlines parameters that can be included in HELD requests to ensure that location.  These parameters MAY also be included by the Device in <a class='info' href='#I-D.winterbottom-geopriv-held-context'>HELD context<span> (</span><span class='info'>Winterbottom, J., Tschofenig, H., and M. Thomson, &ldquo;Location URI Contexts in HTTP-Enabled Location Delivery (HELD),&rdquo; October&nbsp;2009.</span><span>)</span></a> [I&#8209;D.winterbottom&#8209;geopriv&#8209;held&#8209;context] messages.  Requesting dependable location information from a context provides less direct benefit to a Location Recipient that is requesting location information directly from a LIS.
      
</p>
<p>Inclusion of a <tt>dependability</tt> element in a HELD location request indicates that the Device wants signed location information.  In a context creation or update requests, the Device can include this information for the LIS to store in the context for use when serving requests to the associated location URI.
      
</p>
<p>Since this is an extension to the HELD protocol, the LIS might not provide a signature if it does not support this specification or it chooses not to for administrative reasons.  The Device is responsible for ensuring that a signature was applied.
      
</p>
<p>The Device SHOULD include an <tt>identity</tt> element, which indicates what value is to be included in the <tt>identity</tt> element of the signed PIDF-LO.  Location Recipients MUST NOT include this parameter when requesting location information from a location URI.  The <tt>identity</tt> element is identical to that included in the PIDF-LO (see <a class='info' href='#identity-element'>Section&nbsp;6<span> (</span><span class='info'>Target Identity Element</span><span>)</span></a>) except that it does not include the <tt>authenticated</tt> attribute.
      
</p>
<p>The following sample HELD location request includes a dependency element with identity information.
        
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;locationRequest xmlns="urn:ietf:params:xml:ns:geopriv:held"
                 responseTime="2000"&gt;
  &lt;locationType exact="true"&gt;geodetic&lt;/locationType&gt;
  &lt;dependency
      xmlns="urn:ietf:params:xml:ns:geopriv:held:dep"&gt;
    &lt;identity
      form="urn:ietf:params:xml:ns:pidf:geopriv10:dsig:identity#uri"
      hash="http://www.w3.org/2000/09/xmldsig#sha1"&gt;
      60NvZvtdTB+7UnlLp/H24p7h4bs=
    &lt;/identity&gt;
  &lt;/dependency&gt;
&lt;/locationRequest&gt;
</pre></div>
<p>Identity information is provided to the LIS under the understanding that the Device identity is included in the PIDF-LO.  This information could be used to link identity with location information by the LIS or by Location Recipients.  Including hashed information ensures that identity information is not revealed to the LIS.
      
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Signature Validation</h3>

<p>A location recipient performs the following steps to validate a signed location object:
      </p>
<ol class="text">
<li>Authenticate the entity that provided the location information (the sender).
        
</li>
<li>Check the integrity of the digital certificate.
        
</li>
<li>Extract the identity of the LIS from the digital certificate.
        
</li>
<li>Remove all unsigned components from the location object.
        
</li>
<li>Ensure the validity interval from the location object covers the present time.
        
</li>
<li>Check that the authenticated identity of the sender matches the identity in the location object, or that a hash of this identity matches the hashed identity in the location object.
        
</li>
</ol><p>
      
</p>
<p>Once this process is complete, the location recipient has the following information upon which to base any policy decision:
      </p>
<ul class="text">
<li>Whether the location object was signed.
        
</li>
<li>Whether the signature on the location object was valid.
        
</li>
<li>The identity of the sender.
        
</li>
<li>The identity of the LIS.
        
</li>
<li>Whether the LIS authenticated the sender in generating the location object.
        
</li>
<li>The presentity identifier generated by the LIS that distinguishes this location object.
        
</li>
</ul><p>
      
</p>
<p>Policies are set by individual location recipients and are dictated by a range of factors.  Even a failure in signature validation does not necessarily require that the location recipient reject the location information.
      
</p>
<p>For instance, a PSAP might not reject an emergency call with no signature.  The PSAP could instead place a lower priority on such a call so that in a busy period the call is queued behind calls that contained valid signatures.  Similarly, un-authenticated calls could be given similar treatment.
      
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Code and Examples</h3>

<a name="schema"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.1"></a><h3>9.1.&nbsp;
Dependability Data Schema</h3>

<p>The following <a class='info' href='#W3C.REC-xmlschema-1-20041028'>XML Schema<span> (</span><span class='info'>Maloney, M., Thompson, H., Mendelsohn, N., and D. Beech, &ldquo;XML Schema Part 1: Structures Second Edition,&rdquo; October&nbsp;2004.</span><span>)</span></a> [W3C.REC&#8209;xmlschema&#8209;1&#8209;20041028] defines the <tt>dependability</tt> element.  This element is intended for use in a PIDF-LO within a <tt>tuple</tt>.
          
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;?xml version="1.0"?&gt;
&lt;xs:schema
  targetNamespace="urn:ietf:params:xml:ns:pidf:geopriv10:dsig"
  xmlns:xs="http://www.w3.org/2001/XMLSchema"
  xmlns:dsig="urn:ietf:params:xml:ns:pidf:geopriv10:dsig"
  xmlns:xmldsig="http://www.w3.org/2000/09/xmldsig#"
  elementFormDefault="qualified" attributeFormDefault="unqualified"&gt;

  &lt;xs:import namespace="http://www.w3.org/2000/09/xmldsig#"/&gt;

  &lt;xs:element name="dependability" type="dsig:dependabilityType"/&gt;
  &lt;xs:complexType name="dependabilityType"&gt;
    &lt;xs:sequence&gt;
      &lt;xs:element ref="dsig:validity"/&gt;
      &lt;xs:element ref="dsig:identity" minOccurs="0"/&gt;
      &lt;xs:element ref="xmldsig:Signature" minOccurs="0"/&gt;
    &lt;/xs:sequence&gt;
  &lt;/xs:complexType&gt;

  &lt;xs:element name="validity" type="dsig:validityType"/&gt;
  &lt;xs:complexType name="validityType"&gt;
    &lt;xs:sequence&gt;
      &lt;xs:element name="from" type="xs:dateTime" minOccurs="0"/&gt;
      &lt;xs:element name="until" type="xs:dateTime"/&gt;
    &lt;/xs:sequence&gt;
  &lt;/xs:complexType&gt;

  &lt;xs:element name="identity" type="dsig:identityType"/&gt;
  &lt;xs:complexType name="identityType"&gt;
    &lt;xs:simpleContent&gt;
      &lt;xs:extension base="xs:anySimpleType"&gt;

        &lt;xs:attribute name="type" use="required" type="xs:anyURI"/&gt;

        &lt;xs:attribute name="hash" default="##none"&gt;
          &lt;xs:simpleType&gt;
            &lt;xs:union memberTypes="xs:anyURI"&gt;
              &lt;xs:simpleType&gt;
                &lt;xs:restriction base="xs:token"&gt;
                  &lt;xs:enumeration value="##none"/&gt;
                &lt;/xs:restriction&gt;
              &lt;/xs:simpleType&gt;
            &lt;/xs:union&gt;
          &lt;/xs:simpleType&gt;
        &lt;/xs:attribute&gt;

        &lt;xs:attribute name="authenticated" type="xs:boolean"
                      default="false"/&gt;

      &lt;/xs:extension&gt;
    &lt;/xs:simpleContent&gt;
  &lt;/xs:complexType&gt;

&lt;/xs:schema&gt;
</pre></div>
<a name="heldschema"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.2"></a><h3>9.2.&nbsp;
HELD Dependability Request Schema</h3>

<p>The following <a class='info' href='#W3C.REC-xmlschema-1-20041028'>XML Schema<span> (</span><span class='info'>Maloney, M., Thompson, H., Mendelsohn, N., and D. Beech, &ldquo;XML Schema Part 1: Structures Second Edition,&rdquo; October&nbsp;2004.</span><span>)</span></a> [W3C.REC&#8209;xmlschema&#8209;1&#8209;20041028] defines the <tt>dependability</tt> element for inclusion in HELD requests.
          
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;?xml version="1.0"?&gt;
&lt;xs:schema
  targetNamespace="urn:ietf:params:xml:ns:geopriv:held:dep"
  xmlns:xs="http://www.w3.org/2001/XMLSchema"
  xmlns:hd="urn:ietf:params:xml:ns:geopriv:held:dep"
  elementFormDefault="qualified" attributeFormDefault="unqualified"&gt;

  &lt;xs:annotation&gt;
    &lt;xs:appinfo
        source="urn:ietf:params:xml:schema:geopriv:held:dep"&gt;
      HELD Dependability Request Elements
    &lt;/xs:appinfo&gt;
    &lt;xs:documentation source="http://www.ietf.org/rfc/rfcXXXX.txt"&gt;
&lt;!-- [[NOTE TO RFC-EDITOR: Please replace above URL with URL of
                       published RFC and remove this note.]] --&gt;
      This document defines dependability elements for HELD.
    &lt;/xs:documentation&gt;
  &lt;/xs:annotation&gt;

  &lt;xs:element name="dependability" type="hd:dependabilityType"/&gt;
  &lt;xs:complexType name="dependabilityType"&gt;
    &lt;xs:complexContent&gt;
      &lt;xs:restriction base="xs:anyType"&gt;
        &lt;xs:sequence&gt;
          &lt;xs:element ref="hd:identity" minOccurs="0"/&gt;
          &lt;xs:any namespace="##other" processContents="lax"
                  minOccurs="0" maxOccurs="unbounded"/&gt;
        &lt;/xs:sequence&gt;
      &lt;/xs:restriction&gt;
    &lt;/xs:complexContent&gt;
  &lt;/xs:complexType&gt;

  &lt;xs:element name="identity" type="hd:identityType"/&gt;
  &lt;xs:complexType name="identityType"&gt;
    &lt;xs:simpleContent&gt;
      &lt;xs:extension base="xs:anySimpleType"&gt;
        &lt;xs:attribute name="type" type="xs:anyURI" use="required"/&gt;
        &lt;xs:attribute name="hash" default="##none"&gt;
          &lt;xs:simpleType&gt;
            &lt;xs:union memberTypes="xs:anyURI"&gt;
              &lt;xs:simpleType&gt;
                &lt;xs:restriction base="xs:token"&gt;
                  &lt;xs:enumeration value="##none"/&gt;
                &lt;/xs:restriction&gt;
              &lt;/xs:simpleType&gt;
            &lt;/xs:union&gt;
          &lt;/xs:simpleType&gt;
        &lt;/xs:attribute&gt;
      &lt;/xs:extension&gt;
    &lt;/xs:simpleContent&gt;
  &lt;/xs:complexType&gt;

&lt;/xs:schema&gt;
</pre></div>
<a name="transforms"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.3"></a><h3>9.3.&nbsp;
PIDF-LO Transforms</h3>

<p>The transforms defined in this section select certain parts of a PIDF-LO document for signing.  These transforms ensure that only one tuple is signed, with varying amounts of content.  This allows location information to be composed with other tuples and for independent signatures on multiple tuples.
        
</p>
<p>The LIS MUST use one of these transforms to avoid the implication that only the tuple is signed (where in fact the entire document would be signed).  The enveloped signature transform MUST also be used.
        
</p>
<p>These transforms can be implemented by substituting instances of transforms (identified by URNs) with the XPath transforms below.  However, equivalent implementations using other means might provide better performance.
        
</p>
<a name="transform-tuple"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.3.1"></a><h3>9.3.1.&nbsp;
PIDF-LO Tuple-only Transform</h3>

<p>The following <a class='info' href='#RFC3275'>XPath filter<span> (</span><span class='info'>Eastlake, D., Reagle, J., and D. Solo, &ldquo;(Extensible Markup Language) XML-Signature Syntax and Processing,&rdquo; March&nbsp;2002.</span><span>)</span></a> [RFC3275] selects the first <tt>tuple</tt>, <tt>device</tt> or <tt>person</tt> descendant of the signature element and all its contents.  The <tt>presence</tt> element that is the immediate parent of the tuple is also selected.  This transform is identified by the URN <tt>urn:ietf:params:xml:ns:pidf:geopriv10:dsig#tuple</tt>.
            
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;dsig:Transform id="tuple"
   Algorithm="http://www.w3.org/TR/1999/REC-xpath-19991116"
   xmlns:dsig="http://www.w3.org/2000/09/xmldsig#"&gt;
  &lt;dsig:XPath
   xmlns:pidf="urn:ietf:params:xml:ns:pidf"
   xmlns:dm="urn:ietf:params:xml:ns:pidf:data-model"&gt;

&lt;!-- The 'tuple' element and all decendants --&gt;
(count(ancestor-or-self::pidf:tuple[1]
       | here()/ancestor::pidf:tuple[1]) == 1)

&lt;!-- The 'device' element and all decendants --&gt;
or (count(ancestor-or-self::dm:device[1]
       | here()/ancestor::dm:device[1]) == 1)

&lt;!-- The 'person' element and all decendants --&gt;
or (count(ancestor-or-self::dm:person[1]
       | here()/ancestor::dm:person[1]) == 1)

&lt;!-- The 'presence' element --&gt;
or (count(self::pidf:presence
          | here()/ancestor::pidf:presence[1]) = 1)

&lt;!-- All attributes and namespace declarations
         on the presence element --&gt;
or ((count(parent::pidf:presence
           | here()/ancestor::pidf:presence[1]) = 1)
    and (count(self::node() | parent::*/attribute::*
               | parent::*/namespace::*) + 1
         == (count(self::node()) + count(parent::*/attribute::*)
                   + count(parent::*/namespace::*))))
  &lt;/dsig:XPath&gt;
&lt;/dsig:Transform&gt;
</pre></div>
<a name="transform-selective"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.3.2"></a><h3>9.3.2.&nbsp;
PIDF-LO Selective Transform</h3>

<p>Similar to the tuple-only transform, this transform selects a single <tt>tuple</tt> element and its parent <tt>presence</tt> element.  In contrast, this transform only selects those elements listed in <a class='info' href='#elements'>Section&nbsp;3.2<span> (</span><span class='info'>Signed Elements and Semantics</span><span>)</span></a>.  This transform allows a Target to make adjustments to non-critical elements in the PIDF-LO after the signed PIDF-LO is received from the LIS.  In particular, this allows the Target to set the content of the <tt>usage-rules</tt> element and other PIDF data, like contact information.  This transform is identified by the URN <tt>urn:ietf:params:xml:ns:pidf:geopriv10:dsig#selective</tt>.
            
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;dsig:Transform id="selective"
   Algorithm="http://www.w3.org/TR/1999/REC-xpath-19991116"
   xmlns:dsig="http://www.w3.org/2000/09/xmldsig#"&gt;
  &lt;dsig:XPath
   xmlns:pidf="urn:ietf:params:xml:ns:pidf"
   xmlns:gp="urn:ietf:params:xml:ns:pidf:geopriv10"
   xmlns:dep="urn:ietf:params:xml:ns:pidf:geopriv10:dsig"
   xmlns:dm="urn:ietf:params:xml:ns:pidf:data-model"&gt;

&lt;!-- The 'presence' element --&gt;
(count(self::pidf:presence
          | here()/ancestor::pidf:presence[1]) = 1)

&lt;!-- The 'tuple' element and all selected descendants --&gt;
or (((count(ancestor-or-self::pidf:tuple[1]
           | here()/ancestor::pidf:tuple[1]) == 1)
     or (count(ancestor-or-self::dm:device[1]
              | here()/ancestor::dm:device[1]) == 1)
     or (count(ancestor-or-self::dm:person[1]
              | here()/ancestor::dm:person[1]) == 1))
    and (self::pidf:tuple or self::dm:device
         or self::dm:person or self::pidf:status
         or ancestor-or-self::pidf:timestamp
         or ancestor-or-self::dm:timestamp
         or ancestor-or-self::dm:deviceID
         or self::gp:geopriv or self::gp:usage-rules
         or ancestor-or-self::gp:method
         or ancestor-or-self::gp:location-info
         or ancestor-or-self::dep:dependability))

&lt;!-- All attributes (including namespace declarations) --&gt;
&lt;!-- Needed for elements without ancestor-or-self rules above --&gt;
or ((count(self::node() | parent::*/attribute::*
           | parent::*/namespace::*) + 1
         == (count(self::node()) + count(parent::*/attribute::*)
                   + count(parent::*/namespace::*)))
    and parent::*[
          (count(self::pidf:presence
                 | here()/ancestor::pidf:presence[1]) = 1)

          or (((count(ancestor-or-self::pidf:tuple[1]
                     | here()/ancestor::pidf:tuple[1]) == 1)
               or (count(ancestor-or-self::dm:device[1]
                        | here()/ancestor::dm:device[1]) == 1)
               or (count(ancestor-or-self::dm:person[1]
                        | here()/ancestor::dm:person[1]) == 1))

              and (self::pidf:tuple or self::dm:device
                   or self::dm:person or self::pidf:status
                   or self::gp:geopriv or self::gp:usage-rules))
        ])
  &lt;/dsig:XPath&gt;
&lt;/dsig:Transform&gt;
</pre></div>
<a name="example"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.4"></a><h3>9.4.&nbsp;
Example</h3>

<p>The following PIDF-LO document has been signed using the selective transform. [[NOTE:  A proper example, with a verifiable signature, will be created in a later version of this draft.]]
          
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;?xml version="1.0"?&gt;
&lt;presence entity="pres:a6d5bs14vy9pu@lis.example.com"
          xmlns="urn:ietf:params:xml:ns:pidf"
          xmlns:gml="http://opengis.net/gml"
          xmlns:gp="urn:ietf:params:xml:ns:pidf:geopriv10"&gt;
  &lt;tuple id="pidflo1a786c3"&gt;
    &lt;status&gt;
      &lt;gp:geopriv&gt;
        &lt;gp:location-info&gt;
          &lt;gml:position&gt;
            &lt;gml:Point srsName="urn:ogc:def:crs:EPSG::4979"&gt;
              &lt;gml:pos&gt;-34.407 150.88001 34&lt;/gml:pos&gt;
            &lt;/gml:Point&gt;
          &lt;/gml:position&gt;
        &lt;/gp:location-info&gt;
        &lt;gp:usage-rules&gt;
          &lt;gp:retransmission-allowed&gt;no&lt;/gp:retransmission-allowed&gt;
          &lt;gp:retention-expiry&gt;
            2004-12-01T21:28:43+10:00
          &lt;/gp:retention-expiry&gt;
        &lt;/gp:usage-rules&gt;
      &lt;/gp:geopriv&gt;
    &lt;/status&gt;
    &lt;dependability
        xmlns="urn:ietf:params:xml:ns:pidf:geopriv10:dsig"&gt;
      &lt;validity&gt;
        &lt;from&gt;2007-02-16T16:25:24+11:00&lt;/from&gt;
        &lt;until&gt;2007-02-17T16:25:24+11:00&lt;/until&gt;
      &lt;/validity&gt;
      &lt;identity
  type="urn:ietf:params:xml:ns:pidf:geopriv10:dsig:identity#uri"&gt;
      pres:user@example.com&lt;/identity&gt;
      &lt;dsig:Signature
          xmlns:dsig="http://www.w3.org/2000/09/xmldsig#"&gt;
        &lt;dsig:SignedInfo&gt;
          &lt;dsig:CanonicalizationMethod
  Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"/&gt;
          &lt;dsig:SignatureMethod
  Algorithm="http://www.w3.org/2000/09/xmldsig#dsa-sha1"/&gt;
          &lt;dsig:Reference URI=""&gt;
            &lt;dsig:Transforms&gt;
              &lt;dsig:Transform
  Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/&gt;
              &lt;dsig:Transform
  Algorithm="urn:ietf:params:xml:ns:pidf:geopriv10:dsig#selective"/&gt;
            &lt;/dsig:Transforms&gt;
            &lt;dsig:DigestMethod
  Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"/&gt;
            &lt;dsig:DigestValue&gt;
              60NvZvtdTB+7UnlLp/H24p7h4bs=
            &lt;/dsig:DigestValue&gt;
          &lt;/dsig:Reference&gt;
        &lt;/dsig:SignedInfo&gt;
        &lt;dsig:SignatureValue&gt;
          juS5RhJ884qoFR8flVXd/rbrSDVGn40CapgB7qeQiT+rr0NekEQ6BHhUA
          8dT3+BCTBUQI0dBjlml9lwzENXvS83zRECjzXbMRTUtVZiPZG2pqKPnL2
          YU3A9645UCjTXU+jgFumv7k78hieAGDzNci+PQ9KRmm//icT7JaYztgt4=
        &lt;/dsig:SignatureValue&gt;
        &lt;dsig:KeyInfo&gt;
          &lt;dsig:X509Data&gt;
            &lt;dsig:X509Certificate&gt;
              MIICeDCCAeGgAwIBAgIEOd3+iDANBgkqhkiG9w0BAQQFADBbMQsw
              CQYDVQQGEwJJRTEPMA0GA1UECBMGRHVibGluMSUwIwYDVQQKExxC
              YWx0aW1vcmUgVGVjaG5vbG9naWVzLCBMdGQuMRQwEgYDVQQDEwtU
              ZXN0IFJTQSBDQTAeFw0wMDEwMDYxNjMyMDdaFw0wMTEwMDYxNjMy
              MDRaMF0xCzAJBgNVBAYTAklFMQ8wDQYDVQQIEwZEdWJsaW4xJTAj
              BgNVBAoTHEJhbHRpbW9yZSBUZWNobm9sb2dpZXMsIEx0ZC4xFjAU
              BgNVBAMTDU1lcmxpbiBIdWdoZXMwgZ8wDQYJKoZIhvcNAQEBBQAD
              gY0AMIGJAoGBALgorpKYDmjpq6tXz1Ex9wgF8bhZj47JkuI50ysa
              79MNSSnF7SdjN2pGldXf5Gq7yZZnmqNtIzcva/v7ysIm4zO+xft2
              yJHjBBpgCFJxXIiZEfooTu2+HE7mJxIvMR7buIjJ+hjgwaBM6hUG
              HXfKeL62QbL7OOJ060vKssoW2uuPAgMBAAGjRzBFMB4GA1UdEQQX
              MBWBE21lcmxpbkBiYWx0aW1vcmUuaWUwDgYDVR0PAQH/BAQDAgeA
              MBMGA1UdIwQMMAqACEngrZIVgu03MA0GCSqGSIb3DQEBBAUAA4GB
              AHJu4JVq/WnXK2oqqfLWqes5vHOtfX/ZhCjFyDMhzslI8am62gZe
              dwZ9IIZIwlNRMvEDQB2zds/eEBnIAQPl/yRLCLOfZnbA8PXrbFP5
              igs3qQWScBUjZVjik748HU2sUVZOa90c0mJl2vJs/RwyLW7/uCAf
              C/I/k9xGr7fneoIW
          &lt;/dsig:X509Certificate&gt;&lt;/dsig:X509Data&gt;
        &lt;/dsig:KeyInfo&gt;
      &lt;/dsig:Signature&gt;
    &lt;/dependability&gt;
    &lt;note&gt;
      This note may be changed without affecting the signature.
    &lt;/note&gt;
    &lt;timestamp&gt;2005-05-18T15:03:39.362+10:00&lt;/timestamp&gt;
  &lt;/tuple&gt;
&lt;/presence&gt;
</pre></div>
<p>Once the signature has been checked, the following document is extracted.  Only these elements have been included in the signature.  Whitespace has been added to this example to improve readability.
          
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;presence xmlns="urn:ietf:params:xml:ns:pidf"
          xmlns:gml="http://opengis.net/gml"
          xmlns:gp="urn:ietf:params:xml:ns:pidf:geopriv10"
          entity="pres:a6d5bs14vy9pu@lis.example.com"&gt;
  &lt;tuple id="pidflo1a786c3"&gt;
    &lt;status&gt;
      &lt;gp:geopriv&gt;
        &lt;gp:location-info&gt;
          &lt;gml:position&gt;
            &lt;gml:Point srsName="urn:ogc:def:crs:EPSG::4979"&gt;
              &lt;gml:pos&gt;-34.407 150.88001 34&lt;/gml:pos&gt;
            &lt;/gml:Point&gt;
          &lt;/gml:position&gt;
        &lt;/gp:location-info&gt;
        &lt;gp:usage-rules&gt;&lt;/gp:usage-rules&gt;
      &lt;/gp:geopriv&gt;
    &lt;/status&gt;
    &lt;dependability
        xmlns="urn:ietf:params:xml:ns:pidf:geopriv10:dsig"&gt;
      &lt;validity&gt;
        &lt;from&gt;2007-02-16T16:25:24+11:00&lt;/from&gt;
        &lt;until&gt;2007-02-17T16:25:24+11:00&lt;/until&gt;
      &lt;/validity&gt;
      &lt;identity
  type="urn:ietf:params:xml:ns:pidf:geopriv10:dsig:identity#uri"&gt;
      pres:user@example.com&lt;/identity&gt;
    &lt;/dependability&gt;
    &lt;timestamp&gt;2005-05-18T15:03:39.362+10:00&lt;/timestamp&gt;
  &lt;/tuple&gt;
&lt;/presence&gt;
</pre></div>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
Location Reference Attribution</h3>

<p>Digital signatures are less useful when location is provided by reference.  In this case, the location recipient acquires location information directly from the LIS.
      
</p>
<p>The location recipient is able to authenticate the LIS when it establishes a session to retrieve location information (and indeed, this authentication is necessary to protect against other forms of attack).  This authentication process reveals to the location recipient the same information that would be included in a digital signature.  Therefore, signing the result of a location deference is not necessary, unless the dereferencing entity intends to then pass the location object to another entity (note that this MUST also be permitted by the usage rules in the PIDF-LO).
      
</p>
<p>For use with location by reference, the <tt>dependability</tt> element can be provided without a signature.  Allowing a LIS to provide location information where the attribution is based on the secure dereference channel, but the same information is available.
      
</p>
<p>Similar constraints apply to a location object that is retrieved by reference as those that apply to a signed location object.  The location object that is retrieved by reference needs to include the same identity information that would be included in a signed location object.
      
</p>
<p>Validity elements are less critical, since it can be assumed that the LIS does not provide location information unless it is current.  The PIDF <tt>timestamp</tt> element is sufficient to indicate when location information was generated.
      
</p>
<a name="security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
Security Considerations</h3>

<p>This entire document is about the security properties of location objects.
      
</p>
<a name="rules"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11.1"></a><h3>11.1.&nbsp;
Signature Rules</h3>

<p>Three rules that relate to the treatment of signed information are described in <a class='info' href='#RFC3275'>[RFC3275]<span> (</span><span class='info'>Eastlake, D., Reagle, J., and D. Solo, &ldquo;(Extensible Markup Language) XML-Signature Syntax and Processing,&rdquo; March&nbsp;2002.</span><span>)</span></a>.  These rules are <em>Only What is Signed is Secure</em>, <em>Only What is "Seen" Should be Signed</em>, and <em>"See" What is Signed</em>.  These should apply when a location recipient evaluates and uses a location object.  These especially apply when displaying location information to a user, unsigned nodes SHOULD NOT be displayed and MUST be clearly marked as unsigned if they are shown.
        
</p>
<a name="iana"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12"></a><h3>12.&nbsp;
IANA Considerations</h3>

<p>This section registers the dependability elements schema and related namespace URNs with IANA.
      
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12.1"></a><h3>12.1.&nbsp;
URN Sub-Namespace Registration for urn:ietf:params:xml:ns:pidf:geopriv10:dsig</h3>

<p>This section registers a new XML namespace, <tt>urn:ietf:params:xml:ns:pidf:geopriv10:dsig</tt>, as per the guidelines in <a class='info' href='#RFC3688'>[RFC3688]<span> (</span><span class='info'>Mealling, M., &ldquo;The IETF XML Registry,&rdquo; January&nbsp;2004.</span><span>)</span></a>.
        </p>
<blockquote class="text"><dl>
<dt>URI:</dt>
<dd>urn:ietf:params:xml:ns:pidf:geopriv10:dsig
</dd>
<dt>Registrant Contact:</dt>
<dd>IETF, GEOPRIV working group, (geopriv@ietf.org), Martin Thomson (martin.thomson@andrew.com).
</dd>
<dt>XML:</dt>
<dd>
          <div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      BEGIN
        &lt;?xml version="1.0"?&gt;
        &lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
          "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"&gt;
        &lt;html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"&gt;
          &lt;head&gt;
            &lt;title&gt;GEOPRIV Dependability Elements&lt;/title&gt;
          &lt;/head&gt;
          &lt;body&gt;
            &lt;h1&gt;Namespace for GEOPRIV Dependability Elements&lt;/h1&gt;
            &lt;h2&gt;urn:ietf:params:xml:ns:pidf:geopriv10:dsig&lt;/h2&gt;
[[NOTE TO IANA/RFC-EDITOR: Please update RFC URL and replace XXXX
    with the RFC number for this specification.]]
            &lt;p&gt;See &lt;a href="[[RFC URL]]"&gt;RFCXXXX&lt;/a&gt;.&lt;/p&gt;
          &lt;/body&gt;
        &lt;/html&gt;
      END
</pre></div>
          
</dd>
<dt>Note:</dt>
<dd>Two fragment identifiers (<tt>#tuple</tt> and <tt>#selective</tt>) are added to this URN to identify the two transforms defined in RFCXXXX.
          
</dd>
</dl></blockquote><p>
        
</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12.2"></a><h3>12.2.&nbsp;
XML Schema Registration</h3>

<p>This section registers an XML schema as per the guidelines in <a class='info' href='#RFC3688'>[RFC3688]<span> (</span><span class='info'>Mealling, M., &ldquo;The IETF XML Registry,&rdquo; January&nbsp;2004.</span><span>)</span></a>.
        </p>
<blockquote class="text"><dl>
<dt>URI:</dt>
<dd>urn:ietf:params:xml:schema:pidf:geopriv10:dsig
</dd>
<dt>Registrant Contact:</dt>
<dd>IETF, GEOPRIV working group, (geopriv@ietf.org), Martin Thomson (martin.thomson@andrew.com).
</dd>
<dt>Schema:</dt>
<dd>The XML for this schema can be found in <a class='info' href='#schema'>Section&nbsp;9.1<span> (</span><span class='info'>Dependability Data Schema</span><span>)</span></a> of this document, between <tt>&lt;?xml version="1.0"?&gt;</tt> and <tt>&lt;/xs:schema&gt;</tt> (inclusive).
          
</dd>
</dl></blockquote><p>
        
</p>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12.3"></a><h3>12.3.&nbsp;
URN Sub-Namespace Registration for urn:ietf:params:xml:ns:pidf:geopriv10:dsig:identity</h3>

<p>This section registers a new XML namespace, <tt>urn:ietf:params:xml:ns:pidf:geopriv10:dsig:identity</tt>, as per the guidelines in <a class='info' href='#RFC3688'>[RFC3688]<span> (</span><span class='info'>Mealling, M., &ldquo;The IETF XML Registry,&rdquo; January&nbsp;2004.</span><span>)</span></a>.
        </p>
<blockquote class="text"><dl>
<dt>URI:</dt>
<dd>urn:ietf:params:xml:ns:pidf:geopriv10:dsig:identity
</dd>
<dt>Registrant Contact:</dt>
<dd>IETF, GEOPRIV working group, (geopriv@ietf.org), Martin Thomson (martin.thomson@andrew.com).
</dd>
<dt>XML:</dt>
<dd>
          <div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      BEGIN
        &lt;?xml version="1.0"?&gt;
        &lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
          "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"&gt;
        &lt;html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"&gt;
          &lt;head&gt;
            &lt;title&gt;GEOPRIV Dependability Elements&lt;/title&gt;
          &lt;/head&gt;
          &lt;body&gt;
            &lt;h1&gt;Namespace for GEOPRIV Dependability Elements:
                Identity Identifiers&lt;/h1&gt;
      &lt;h2&gt;urn:ietf:params:xml:ns:pidf:geopriv10:dsig:identity&lt;/h2&gt;
[[NOTE TO IANA/RFC-EDITOR: Please update RFC URL and replace XXXX
    with the RFC number for this specification.]]
           &lt;p&gt;See &lt;a href="[[RFC URL]]"&gt;RFCXXXX&lt;/a&gt;.&lt;/p&gt;
          &lt;/body&gt;
        &lt;/html&gt;
      END
</pre></div>
          
</dd>
<dt>Note:</dt>
<dd>Two fragment identifiers (<tt>#uri</tt> and <tt>#x509</tt>) are added to this URN to identify the two types of identity defined in RFCXXXX.
          
</dd>
</dl></blockquote><p>
        
</p>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12.4"></a><h3>12.4.&nbsp;
URN Sub-Namespace Registration for urn:ietf:params:xml:ns:geopriv:held:dep</h3>

<p>This section registers a new XML namespace, <tt>urn:ietf:params:xml:ns:geopriv:held:dep</tt>, as per the guidelines in <a class='info' href='#RFC3688'>[RFC3688]<span> (</span><span class='info'>Mealling, M., &ldquo;The IETF XML Registry,&rdquo; January&nbsp;2004.</span><span>)</span></a>.
        </p>
<blockquote class="text"><dl>
<dt>URI:</dt>
<dd>urn:ietf:params:xml:ns:geopriv:held:dep
</dd>
<dt>Registrant Contact:</dt>
<dd>IETF, GEOPRIV working group, (geopriv@ietf.org), Martin Thomson (martin.thomson@andrew.com).
</dd>
<dt>XML:</dt>
<dd>
          <div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      BEGIN
        &lt;?xml version="1.0"?&gt;
        &lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
          "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"&gt;
        &lt;html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"&gt;
          &lt;head&gt;
            &lt;title&gt;HELD Dependability Request Elements&lt;/title&gt;
          &lt;/head&gt;
          &lt;body&gt;
            &lt;h1&gt;Namespace for HELD Dependability Request&lt;/h1&gt;
            &lt;h2&gt;urn:ietf:params:xml:ns:geopriv:held:dep&lt;/h2&gt;
[[NOTE TO IANA/RFC-EDITOR: Please update RFC URL and replace XXXX
    with the RFC number for this specification.]]
            &lt;p&gt;See &lt;a href="[[RFC URL]]"&gt;RFCXXXX&lt;/a&gt;.&lt;/p&gt;
          &lt;/body&gt;
        &lt;/html&gt;
      END
</pre></div>
          
</dd>
</dl></blockquote><p>
        
</p>
<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12.5"></a><h3>12.5.&nbsp;
XML Schema Registration</h3>

<p>This section registers an XML schema as per the guidelines in <a class='info' href='#RFC3688'>[RFC3688]<span> (</span><span class='info'>Mealling, M., &ldquo;The IETF XML Registry,&rdquo; January&nbsp;2004.</span><span>)</span></a>.
        </p>
<blockquote class="text"><dl>
<dt>URI:</dt>
<dd>urn:ietf:params:xml:schema:geopriv:held:dep
</dd>
<dt>Registrant Contact:</dt>
<dd>IETF, GEOPRIV working group, (geopriv@ietf.org), Martin Thomson (martin.thomson@andrew.com).
</dd>
<dt>Schema:</dt>
<dd>The XML for this schema can be found in <a class='info' href='#heldschema'>Section&nbsp;9.2<span> (</span><span class='info'>HELD Dependability Request Schema</span><span>)</span></a> of this document, between <tt>&lt;?xml version="1.0"?&gt;</tt> and <tt>&lt;/xs:schema&gt;</tt> (inclusive).
          
</dd>
</dl></blockquote><p>
        
</p>
<a name="ack"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.13"></a><h3>13.&nbsp;
Acknowledgements</h3>

<p>The authors would like to acknowledge the contribution of the GEOPRIV WG; the L7 design team; Hannes Tschofenig and Henning Schulzrinne.
      
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.14"></a><h3>14.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>14.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC3076">[RFC3076]</a></td>
<td class="author-text">Boyer, J., &ldquo;<a href="http://tools.ietf.org/html/rfc3076">Canonical XML Version 1.0</a>,&rdquo; RFC&nbsp;3076, March&nbsp;2001 (<a href="http://www.rfc-editor.org/rfc/rfc3076.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3275">[RFC3275]</a></td>
<td class="author-text">Eastlake, D., Reagle, J., and D. Solo, &ldquo;<a href="http://tools.ietf.org/html/rfc3275">(Extensible Markup Language) XML-Signature Syntax and Processing</a>,&rdquo; RFC&nbsp;3275, March&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3275.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4119">[RFC4119]</a></td>
<td class="author-text">Peterson, J., &ldquo;<a href="http://tools.ietf.org/html/rfc4119">A Presence-based GEOPRIV Location Object Format</a>,&rdquo; RFC&nbsp;4119, December&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4119.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-geopriv-l7-lcp-ps">[I-D.ietf-geopriv-l7-lcp-ps]</a></td>
<td class="author-text">Tschofenig, H. and H. Schulzrinne, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-geopriv-l7-lcp-ps-10.txt">GEOPRIV Layer 7 Location Configuration Protocol; Problem Statement and Requirements</a>,&rdquo; draft-ietf-geopriv-l7-lcp-ps-10 (work in progress), July&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-geopriv-l7-lcp-ps-10.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3548">[RFC3548]</a></td>
<td class="author-text">Josefsson, S., &ldquo;<a href="http://tools.ietf.org/html/rfc3548">The Base16, Base32, and Base64 Data Encodings</a>,&rdquo; RFC&nbsp;3548, July&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3548.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3863">[RFC3863]</a></td>
<td class="author-text">Sugano, H., Fujimoto, S., Klyne, G., Bateman, A., Carr, W., and J. Peterson, &ldquo;<a href="http://tools.ietf.org/html/rfc3863">Presence Information Data Format (PIDF)</a>,&rdquo; RFC&nbsp;3863, August&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3863.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4479">[RFC4479]</a></td>
<td class="author-text">Rosenberg, J., &ldquo;<a href="http://tools.ietf.org/html/rfc4479">A Data Model for Presence</a>,&rdquo; RFC&nbsp;4479, July&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4479.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="X509v3">[X509v3]</a></td>
<td class="author-text">ITU-T Recommendation, &ldquo;Information Technology - Open Systems Interconnection - The Directory Authentication Framework,&rdquo; ISO/IEC&nbsp;9594-8:1997, 1997.</td></tr>
<tr><td class="author-text" valign="top"><a name="W3C.REC-xmlschema-1-20041028">[W3C.REC-xmlschema-1-20041028]</a></td>
<td class="author-text">Maloney, M., Thompson, H., Mendelsohn, N., and D. Beech, &ldquo;<a href="http://www.w3.org/TR/2004/REC-xmlschema-1-20041028">XML Schema Part 1: Structures Second Edition</a>,&rdquo; World Wide Web Consortium Recommendation&nbsp;REC-xmlschema-1-20041028, October&nbsp;2004 (<a href="http://www.w3.org/TR/2004/REC-xmlschema-1-20041028">HTML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-geopriv-http-location-delivery">[I-D.ietf-geopriv-http-location-delivery]</a></td>
<td class="author-text">Barnes, M., Winterbottom, J., Thomson, M., and B. Stark, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-geopriv-http-location-delivery-16.txt">HTTP Enabled Location Delivery (HELD)</a>,&rdquo; draft-ietf-geopriv-http-location-delivery-16 (work in progress), August&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-geopriv-http-location-delivery-16.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.winterbottom-geopriv-held-context">[I-D.winterbottom-geopriv-held-context]</a></td>
<td class="author-text">Winterbottom, J., Tschofenig, H., and M. Thomson, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-winterbottom-geopriv-held-context-05.txt">Location URI Contexts in HTTP-Enabled Location Delivery (HELD)</a>,&rdquo; draft-winterbottom-geopriv-held-context-05 (work in progress), October&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-winterbottom-geopriv-held-context-05.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>14.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC3688">[RFC3688]</a></td>
<td class="author-text">Mealling, M., &ldquo;<a href="http://tools.ietf.org/html/rfc3688">The IETF XML Registry</a>,&rdquo; BCP&nbsp;81, RFC&nbsp;3688, January&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3688.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3693">[RFC3693]</a></td>
<td class="author-text">Cuellar, J., Morris, J., Mulligan, D., Peterson, J., and J. Polk, &ldquo;<a href="http://tools.ietf.org/html/rfc3693">Geopriv Requirements</a>,&rdquo; RFC&nbsp;3693, February&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3693.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5246">[RFC5246]</a></td>
<td class="author-text">Dierks, T. and E. Rescorla, &ldquo;<a href="http://tools.ietf.org/html/rfc5246">The Transport Layer Security (TLS) Protocol Version 1.2</a>,&rdquo; RFC&nbsp;5246, August&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5246.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-geopriv-lis-discovery">[I-D.ietf-geopriv-lis-discovery]</a></td>
<td class="author-text">Thomson, M. and J. Winterbottom, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-geopriv-lis-discovery-15.txt">Discovering the Local Location Information Server (LIS)</a>,&rdquo; draft-ietf-geopriv-lis-discovery-15 (work in progress), March&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-geopriv-lis-discovery-15.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.barnes-geopriv-lo-sec">[I-D.barnes-geopriv-lo-sec]</a></td>
<td class="author-text">Barnes, R., Lepinski, M., Cooper, A., Morris, J., Tschofenig, H., and H. Schulzrinne, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-barnes-geopriv-lo-sec-05.txt">An Architecture for Location and Location Privacy in Internet Applications</a>,&rdquo; draft-barnes-geopriv-lo-sec-05 (work in progress), March&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-barnes-geopriv-lo-sec-05.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-oauth-authentication">[I-D.ietf-oauth-authentication]</a></td>
<td class="author-text">Hammer-Lahav, E., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-oauth-authentication-01.txt">The OAuth Protocol: Authentication</a>,&rdquo; draft-ietf-oauth-authentication-01 (work in progress), July&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-oauth-authentication-01.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Martin Thomson</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Andrew</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">PO Box U40</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Wollongong University Campus, NSW  2500</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">AU</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+61 2 4221 2915</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:martin.thomson@andrew.com">martin.thomson@andrew.com</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.andrew.com/">http://www.andrew.com/</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">James Winterbottom</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Andrew</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">PO Box U40</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Wollongong University Campus, NSW  2500</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">AU</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+61 2 4221 2938</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:james.winterbottom@andrew.com">james.winterbottom@andrew.com</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.andrew.com/">http://www.andrew.com/</a></td></tr>
</table>
</body></html>
