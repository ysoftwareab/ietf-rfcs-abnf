



Interdomain Routing Working Group                                  C. Li
Internet-Draft                                                   M. Chen
Intended status: Standards Track                                 J. Dong
Expires: October 5, 2018                                           Z. Li
                                                     Huawei Technologies
                                                           April 3, 2018


   Segment Routing Policies for Path Segment and Bi-directional Path
          draft-li-idr-sr-policy-path-segment-distribution-00

Abstract

   An SR policy is a set of candidate SR paths consisting of one or more
   segment lists with necessary path attributes.  For each SR path, it
   may also have its own path attributes, and Path Segment is one of
   them.  A Path Segment is defined to identify an SR path, which can be
   used for performance measurement, path correlation, and end-2-end
   path protection.  Path Segment can be also used to correlate two
   unidirctional SR paths into a bi-directional SR path which is
   required in some scenarios, for example, mobile backhaul transport
   network.

   This document defines extensions to BGP to distribute SR policies
   carriying Path segment and bi-directional path information.

Requirements Language

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in RFC 2119 [RFC2119].

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on October 5, 2018.



Li, et al.               Expires October 5, 2018                [Page 1]

Internet-Draft              Abbreviated-Title                 April 2018


Copyright Notice

   Copyright (c) 2018 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (https://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
   2.  Terminology . . . . . . . . . . . . . . . . . . . . . . . . .   3
   3.  SR Policy for Path Identifier . . . . . . . . . . . . . . . .   3
     3.1.  SR Path ID Sub-TLV  . . . . . . . . . . . . . . . . . . .   4
   4.  SR Policy for Bi-directional Path . . . . . . . . . . . . . .   5
     4.1.  SR Bi-directional Path Sub-TLV  . . . . . . . . . . . . .   6
     4.2.  SR Reverse Path Segment List Sub-TLV  . . . . . . . . . .   7
   5.  Operations  . . . . . . . . . . . . . . . . . . . . . . . . .   8
   6.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .   8
   7.  Security Considerations . . . . . . . . . . . . . . . . . . .   8
   8.  Acknowledgements  . . . . . . . . . . . . . . . . . . . . . .   8
   9.  References  . . . . . . . . . . . . . . . . . . . . . . . . .   8
     9.1.  Normative References  . . . . . . . . . . . . . . . . . .   8
     9.2.  Informative References  . . . . . . . . . . . . . . . . .   9
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .   9

1.  Introduction

   Segment routing (SR) [I-D.ietf-spring-segment-routing] is a source
   routing paradigm that explicitly indicates the forwarding path for
   packets at the ingress node.  The ingress node steers packets into a
   specific path according to the Segment Routing Policy ( SR Policy) as
   defined in [I-D.filsfils-spring-segment-routing-policy].  For
   distributing SR policies to the headend,
   [I-D.ietf-idr-segment-routing-te-policy] specifies a mechanism by
   using BGP, and new sub-TLVs are defined for SR Policies in BGP UPDATE
   message.

   In many use cases such as performance measurement, the path to which
   the packets belong is required to be identified.  Futhermore, in some
   scenarios, for example, mobile backhaul transport network, there are



Li, et al.               Expires October 5, 2018                [Page 2]

Internet-Draft              Abbreviated-Title                 April 2018


   requirements to support bi-directional path.  However, there is no
   path ID for each Segment List in the SR Policies defined in
   [I-D.filsfils-spring-segment-routing-policy].  Also, the SR Policies
   defined in [I-D.filsfils-spring-segment-routing-policy] only supports
   uni-directional SR paths.

   Therefore, this document defines the extension to SR policies that
   carry path ID information in the Segment List and support bi-
   directional path.  The path ID can be a path segment in SR-MPLS
   [I-D.cheng-spring-mpls-path-segment] , or a path ID in SRv6
   [I-D.li-spring-passive-pm-for-srv6-np], or other IDs that can
   identify a path.  Also, this document defines extensions to BGP to
   distribute SR policies carriying Path segment and bi-directional path
   information.

2.  Terminology

   This memo makes use of the terms defined in
   [I-D.ietf-spring-segment-routing] and
   [I-D.ietf-idr-segment-routing-te-policy].  It also introduces the
   following terminologies.

3.  SR Policy for Path Identifier

   As defined in [I-D.ietf-idr-segment-routing-te-policy] , the SR
   Policy Encoding structure is as follows:

       SR Policy SAFI NLRI: <Distinguisher, Policy-Color, Endpoint>
           Attributes: Tunnel Encaps Attribute (23)
           Tunnel Type: SR Policy
               Binding SID
               Preference
               Segment List
                   Weight
                   Segment
                   Segment
                   ...

   An SR path can be specified by an Segment List sub-TLV that contains
   a set of segment sub-TLVs and other sub-TLVs as shown above.

   As introduced in Section 1, each SR path may have a dedicated path
   identifier, an SR policy carrying a SR path identifier is expressed
   as below:







Li, et al.               Expires October 5, 2018                [Page 3]

Internet-Draft              Abbreviated-Title                 April 2018


       SR Policy SAFI NLRI: <Distinguisher, Policy-Color, Endpoint>
           Attributes: Tunnel Encaps Attribute (23)
           Tunnel Type: SR Policy
               Binding SID
               Preference
               Segment List
                   Weight
                   Path ID
                   Segment
                   Segment
                   ...

3.1.  SR Path ID Sub-TLV

   This section defines an SR Path ID sub-TLV to specify an SR path, and
   it is included in the segment list sub-TLV.

   An SR Path ID sub-TLV is associated with an SR path specified by a
   segment list sub-TLV, and it MUST appear only once within a Segment
   List sub-TLV.  It has the following format:

     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |      Type     |    Length     |    Flag       |      PIT      |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                       Path ID (Variable)                      |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                         Figure 1. Path ID sub-TLV

   Where:

   Type: to be assigned by IANA (suggested value 10).

   Length: the total length of the value field not including Type and
   Length fields.

   Flag: 8 bits of flags.  Following flags are defined:

     0  1  2  3  4  5  6  7
   +--+--+--+--+--+--+--+--+
   |    Reserved     |G |E |
   +--+--+--+--+--+--+--+--+

   G-Flag: Global flag.  Set when the Path segment/ID is global within
   an SR domain.





Li, et al.               Expires October 5, 2018                [Page 4]

Internet-Draft              Abbreviated-Title                 April 2018


   E-Flag: Egress flag for local sgement/ID.  The E-flag should be set
   when a path segment/ID is a local segment/ID allocated by the egress
   node.  Else, the path segment/ID is a local segment/ID allocated by
   the ingress node.  When the Path segment/ID is global within an SR
   domain(G-flag is set), this flag should be ignored.

   Reserved: 5 bits reserved and MUST be set to 0 on transmission and
   MUST be ignored on receipt.

   PIT: Path ID type, specifies the type of the Path ID, and it has
   following types:

   o  0: SR-MPLS Path Label

   o  1: 4-octets integer Path ID

   o  2: SRv6 SID

   o  3-255:Reserved

   Path ID: The Path ID of an SR path.  The Path ID type is indicated by
   the Path ID Type(PIT) field.  It can be a path segment
   [I-D.cheng-spring-mpls-path-segment], or it can be a 4 octets integer
   ID as defined in [I-D.li-spring-passive-pm-for-srv6-np], or other IDs
   that can identify a path.

   When the type of Path ID is 0, and the E-flag and the G-flag are
   unset, meaning the Path ID is a local path label allocated by the
   ingress node in SR-MPLS, a path can be identified by a combination of
   this path ID and a non-routable Source label, as defined at section
   2.2 in [I-D.cheng-spring-mpls-path-segment].  The non-routable Source
   Label, as known as a non-routable source node ID, can be configured
   by many ways like CLI, and it is out of scope of this document and
   will be discussed in other documents.

4.  SR Policy for Bi-directional Path

   In some scenarios, for example, mobile backhaul transport network,
   there are requirements to support bi-directional path.  In SR, a bi-
   directional path can be represented as a binding of two uni-
   directional SR paths.  This document also defines new sub-TLVs to
   describe an SR bi-directional path.  An SR policy carrying SR bi-
   directional path information is expressed as below:








Li, et al.               Expires October 5, 2018                [Page 5]

Internet-Draft              Abbreviated-Title                 April 2018


       SR Policy SAFI NLRI: <Distinguisher, Policy-Color, Endpoint>
           Attributes: Tunnel Encaps Attribute (23)
           Tunnel Type: SR Policy
               Binding SID
               Preference
               Bi-directioanl Path
                   Segment List
                       Weight
                       Path ID
                       Segment
                       Segment
                       ...
                   Reverse Segment List
                       Weight
                       Path ID
                       Segment
                       Segment
                       ...


4.1.  SR Bi-directional Path Sub-TLV

   This section defines an SR bi-directional path sub-TLV to specify a
   bi-directional path, which contains a Segment List sub-TLV
   [I-D.ietf-idr-segment-routing-te-policy] and an associated Reverse
   Path Segment List as defined at section 4.2.  The SR bi-directional
   path sub-TLV has the following format:

     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |    Type       |             Length            |   RESERVED    |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                        Sub-TLVs (Variable)                    |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                  Figure 2. SR Bi-directional path sub-TLV

   Where:

   Type: TBA, and the suggest value is 14.

   Length: the total length of the sub-TLVs encoded within the SR Bi-
   directional Path Sub-TLV not including Type and Length fields.

   RESERVED: 1 octet of reserved bits.  SHOULD be unset on transmission
   and MUST be ignored on receipt.

   Sub-TLVs:



Li, et al.               Expires October 5, 2018                [Page 6]

Internet-Draft              Abbreviated-Title                 April 2018


   o  An Segment List sub-TLV

   o  An associated Reverse Path Segment List sub-TLV

4.2.  SR Reverse Path Segment List Sub-TLV

   An SR Reverse Path Segment List sub-TLV is defined to specify an SR
   reverse path associated with the path specified by the Segment List
   in the same SR Bi-directional Path Sub-TLV, and it has the following
   format:

     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |    Type       |             Length            |   RESERVED    |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                        Sub-TLVs (Variable)                    |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
               Figure 2. SR Reverse Path Segment List Sub-TLV

   where:

   Type: TBA, and suggest value is 127.

   Length: the total length of the sub-TLVs encoded within the SR
   Reverse Path Segment List Sub-TLV not including the Type and Length
   fields.

   RESERVED: 1 octet of reserved bits.  SHOULD be unset on transmission
   and MUST be ignored on receipt.

   sub-TLVs:

   o  An optional single Weight sub-TLV.

   o  An mandatory SR Path ID sub-TLV that contains the path ID of the
      reverse SR path.

   o  Zero or more Segment sub-TLVs to specify the reverse SR path.

   The Segment sub-TLVs in the Reverse Path Segment List sub-TLV
   provides the information of the reverse SR path, which can be used
   for directing egress BFD peer to use specific path for the reverse
   direction of the BFD session [I-D.ietf-mpls-bfd-directed] or other
   applications.






Li, et al.               Expires October 5, 2018                [Page 7]

Internet-Draft              Abbreviated-Title                 April 2018


5.  Operations

   The document does not bring new operation beyong the description of
   operations defined in [I-D.ietf-idr-segment-routing-te-policy].  The
   existing operations defined in
   [I-D.ietf-idr-segment-routing-te-policy] can apply to this document
   directly.

   Typically but not limit to, the uni-directional or bi-directional SR
   policies carrying path identification infomation are configured by a
   controller.

   After configuration, the uni-directional or bi-directional SR
   policies carrying path identification infomation will be advertised
   by BGP update messages.  The operation of advertisement is the same
   as defined in [I-D.ietf-idr-segment-routing-te-policy], as well as
   the receiption.

   The consumer of the uni-directional or bi-directional SR policies is
   not the BGP process, it can be any applications, such as performance
   measurement.  The operation of sending information to consumers is
   out of scope of this document.

6.  IANA Considerations

   TBA

7.  Security Considerations

   TBA

8.  Acknowledgements

   TBA

9.  References

9.1.  Normative References

   [I-D.cheng-spring-mpls-path-segment]
              Cheng, W., Wang, L., Li, H., Chen, M., Zigler, R., and S.
              Zhan, "Path Segment in MPLS Based Sement Routing Network",
              draft-cheng-spring-mpls-path-segment-01 (work in
              progress), March 2018.







Li, et al.               Expires October 5, 2018                [Page 8]

Internet-Draft              Abbreviated-Title                 April 2018


   [I-D.filsfils-spring-segment-routing-policy]
              Filsfils, C., Sivabalan, S., Raza, K., Liste, J., Clad,
              F., Talaulikar, K., Ali, Z., Hegde, S.,
              daniel.voyer@bell.ca, d., Lin, S., bogdanov@google.com,
              b., Krol, P., Horneffer, M., Steinberg, D., Decraene, B.,
              Litkowski, S., and P. Mattes, "Segment Routing Policy for
              Traffic Engineering", draft-filsfils-spring-segment-
              routing-policy-05 (work in progress), February 2018.

   [I-D.ietf-idr-segment-routing-te-policy]
              Previdi, S., Filsfils, C., Jain, D., Mattes, P., Rosen,
              E., and S. Lin, "Advertising Segment Routing Policies in
              BGP", draft-ietf-idr-segment-routing-te-policy-02 (work in
              progress), March 2018.

   [I-D.ietf-spring-segment-routing]
              Filsfils, C., Previdi, S., Ginsberg, L., Decraene, B.,
              Litkowski, S., and R. Shakir, "Segment Routing
              Architecture", draft-ietf-spring-segment-routing-15 (work
              in progress), January 2018.

   [I-D.li-spring-passive-pm-for-srv6-np]
              Li, C. and M. Chen, "Passive Performance Measurement for
              SRv6 Network Programming", draft-li-spring-passive-pm-for-
              srv6-np-00 (work in progress), March 2018.

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <https://www.rfc-editor.org/info/rfc2119>.

9.2.  Informative References

   [I-D.ietf-mpls-bfd-directed]
              Mirsky, G., Tantsura, J., Varlashkin, I., and M. Chen,
              "Bidirectional Forwarding Detection (BFD) Directed Return
              Path", draft-ietf-mpls-bfd-directed-08 (work in progress),
              December 2017.

Authors' Addresses

   Cheng Li
   Huawei Technologies
   Huawei Campus, No. 156 Beiqing Rd.
   Beijing  100095
   China

   Email: chengli13@huawei.com



Li, et al.               Expires October 5, 2018                [Page 9]

Internet-Draft              Abbreviated-Title                 April 2018


   Mach(Guoyi) Chen
   Huawei Technologies
   Huawei Campus, No. 156 Beiqing Rd.
   Beijing  100095
   China

   Email: Mach.chen@huawei.com


   Jie Dong
   Huawei Technologies
   Huawei Campus, No. 156 Beiqing Rd.
   Beijing  100095
   China

   Email: jie.dong@huawei.com


   Zhenbin Li
   Huawei Technologies
   Huawei Campus, No. 156 Beiqing Rd.
   Beijing  100095
   China

   Email: lizhenbin@huawei.com


























Li, et al.               Expires October 5, 2018               [Page 10]
