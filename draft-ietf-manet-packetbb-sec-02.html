<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>MANET Cryptographical Signature TLV Definition</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="MANET Cryptographical Signature TLV Definition">
<meta name="keywords" content="MANET">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 60em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 60em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Mobile Ad hoc Networking (MANET)</td><td class="header">U. Herberg</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">T. Clausen</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">LIX, Ecole Polytechnique</td></tr>
<tr><td class="header">Expires: May 15, 2011</td><td class="header">November 11, 2010</td></tr>
</table></td></tr></table>
<h1><br />MANET Cryptographical Signature TLV Definition<br />draft-ietf-manet-packetbb-sec-02</h1>

<h3>Abstract</h3>

<p>
      	This document describes general and flexible TLVs (type-length-value structure) for representing cryptographic signatures as well as timestamps, using the generalized MANET packet/message format <a class='info' href='#RFC5444'>[RFC5444]<span> (</span><span class='info'>Clausen, T., Dearlove, C., Dean, J., and C. Adjih, &ldquo;Generalized MANET Packet/Message Format,&rdquo; February&nbsp;2009.</span><span>)</span></a>. It defines two Packet TLVs, two Message TLVs, and two Address Block TLVs, for affixing cryptographic signatures and timestamps to a packet, message and address, respectively.
      
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted  in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF).  Note that other groups may also distribute
working documents as Internet-Drafts.  The list of current
Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
This Internet-Draft will expire on May 15, 2011.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the Simplified BSD License.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#terminology">2.</a>&nbsp;
Terminology<br />
<a href="#applStatement">3.</a>&nbsp;
Applicability Statement<br />
<a href="#anchor2">4.</a>&nbsp;
Security Architecture<br />
<a href="#overview">5.</a>&nbsp;
Protocol Overview and Functioning<br />
<a href="#anchor3">6.</a>&nbsp;
Imported TLV Fields<br />
<a href="#signatureTLVformat">7.</a>&nbsp;
General Signature TLV Structure<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rationale">7.1.</a>&nbsp;
Rationale<br />
<a href="#timestampTLVformat">8.</a>&nbsp;
General Timestamp TLV Structure<br />
<a href="#packetSignatures">9.</a>&nbsp;
Packet TLVs<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#packetsignatureTLV">9.1.</a>&nbsp;
Packet SIGNATURE TLV<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#packettimestampTLV">9.2.</a>&nbsp;
Packet TIMESTAMP TLV<br />
<a href="#messageSignatures">10.</a>&nbsp;
Message TLVs<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#signatureTLV">10.1.</a>&nbsp;
Message SIGNATURE TLV<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#timestampTLV">10.2.</a>&nbsp;
Message TIMESTAMP TLV<br />
<a href="#addressblockSignatures">11.</a>&nbsp;
Address Block TLVs<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#addressblocksignatureTLV">11.1.</a>&nbsp;
Address Block SIGNATURE TLV<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#addressblocktimestampTLV">11.2.</a>&nbsp;
Address Block TIMESTAMP TLV<br />
<a href="#IANA">12.</a>&nbsp;
IANA Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">12.1.</a>&nbsp;
TLV Registrations<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">12.1.1.</a>&nbsp;
Expert Review: Evaluation Guidelines<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">12.1.2.</a>&nbsp;
Packet TLV Type Registrations<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">12.1.3.</a>&nbsp;
Message TLV Type Registrations<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">12.1.4.</a>&nbsp;
Address Block TLV Type Registrations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">12.2.</a>&nbsp;
New IANA Registries<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">12.2.1.</a>&nbsp;
Expert Review: Evaluation Guidelines<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">12.2.2.</a>&nbsp;
Hash Function<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">12.2.3.</a>&nbsp;
Cryptographic Algorithm<br />
<a href="#Security">13.</a>&nbsp;
Security Considerations<br />
<a href="#Acknowledgements">14.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">15.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">15.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">15.2.</a>&nbsp;
Informative References<br />
<a href="#anchor15">Appendix&nbsp;A.</a>&nbsp;
Examples<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor16">A.1.</a>&nbsp;
Example of a Signed Message<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>
        This document specifies:
        
        </p>
<ul class="text">
<li>
        		two TLVs for carrying cryptographic signatures and timestamps in packets, messages and address blocks as defined by <a class='info' href='#RFC5444'>[RFC5444]<span> (</span><span class='info'>Clausen, T., Dearlove, C., Dean, J., and C. Adjih, &ldquo;Generalized MANET Packet/Message Format,&rdquo; February&nbsp;2009.</span><span>)</span></a>,
        	
</li>
<li>
        		how cryptographic signatures are calculated, taking (for Message TLVs) into account the mutable message header fields (&lt;msg-hop-limit&gt; and &lt;msg-hop-count&gt;)  where these fields are present in messages.
        	
</li>
</ul><p>
        
        This document requests from IANA:
        </p>
<ul class="text">
<li>
        		allocations for these Packet, Message, and Address Block TLVs from the 0-223 Packet TLV range, the 0-127 Message TLV range and the 0-127 Address Block TLV range from <a class='info' href='#RFC5444'>[RFC5444]<span> (</span><span class='info'>Clausen, T., Dearlove, C., Dean, J., and C. Adjih, &ldquo;Generalized MANET Packet/Message Format,&rdquo; February&nbsp;2009.</span><span>)</span></a>,
        	
</li>
<li>
        		creation of two IANA registries for recording code points for hash function and signature calculation, respectively.
        	
</li>
</ul><p>
        
        
      
</p>
<a name="terminology"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Terminology</h3>

<p>
      	The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
        "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
        "OPTIONAL" in this document are to be interpreted as described in 
        <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
      
</p>
<p>This document uses the terminology and notation defined in  <a class='info' href='#RFC5444'>[RFC5444]<span> (</span><span class='info'>Clausen, T., Dearlove, C., Dean, J., and C. Adjih, &ldquo;Generalized MANET Packet/Message Format,&rdquo; February&nbsp;2009.</span><span>)</span></a>.

      
</p>
<a name="applStatement"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Applicability Statement</h3>

<p>
      		MANET routing protocols using the format defined in <a class='info' href='#RFC5444'>[RFC5444]<span> (</span><span class='info'>Clausen, T., Dearlove, C., Dean, J., and C. Adjih, &ldquo;Generalized MANET Packet/Message Format,&rdquo; February&nbsp;2009.</span><span>)</span></a> are accorded the ability to carry additional information in control messages and packets, through inclusion of TLVs. Information so included MAY be used by a routing protocol, or by an extension of a routing protocol, according to its specification.
		
</p>
<p>
			This document specifies how to include a cryptographic signature for a packet, message or address by way of such TLVs.  This document also specifies how to treat "mutable" fields (&lt;msg-hop-count&gt; and &lt;msg-hop-limit&gt;), if present, in the message header when calculating signatures, such that the resulting signature can be correctly verified by any recipient, and how to include this signature.
			
		
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Security Architecture</h3>

<p>
			Basic MANET routing protocol specifications are often "oblivious to security", however have a clause allowing a control message to be rejected as "badly formed" prior to it being processed or forwarded. Protocols such as <a class='info' href='#NHDP'>[NHDP]<span> (</span><span class='info'>Clausen, T., Dean, J., and C. Dearlove, &ldquo;MANET Neighborhood Discovery Protocol (NHDP),&rdquo; July&nbsp;2010.</span><span>)</span></a> and <a class='info' href='#OLSRv2'>[OLSRv2]<span> (</span><span class='info'>Clausen, T., Dearlove, C., and P. Jacquet, &ldquo;The Optimized Link State Routing Protocol version 2,&rdquo; April&nbsp;2010.</span><span>)</span></a> recognize external reasons (such as failure to verify a signature)  for rejecting a message as "badly formed", and therefore "invalid for processing". This architecture is a result of the observation that with respect to security in MANETs, "one size rarely fits all" and that MANET routing protocol deployment domains have varying security requirements ranging from "unbreakable" to "virtually none". The virtue of this approach is that MANET routing protocol specifications (and implementations) can remain "generic", with extensions providing proper deployment-domain specific security mechanisms.
		
</p>
<p>
			The MANET routing protocol "security architecture", in which this specification situates itself, can therefore be summarized as follows:
			
			</p>
<ul class="text">
<li> 
					Security-oblivious MANET routing protocol specifications, with a clause allowing an extension to reject a message (prior to processing/forwarding) as "badly formed".
				
</li>
<li>
					MANET routing protocol security extensions, rejecting messages as "badly formed", as appropriate for a given deployment-domain specific security requirement.
				
</li>
<li>
					Code-points and an exchange format for information, necessary for specification of such MANET routing protocol security extensions.
				
</li>
</ul><p>
		
</p>
<p>
			This document addresses the last of these issues, by specifying a common exchange format for cryptographic signatures, making reservations from within the Packet TLV, Message TLV and Address Block TLV registries of <a class='info' href='#RFC5444'>[RFC5444]<span> (</span><span class='info'>Clausen, T., Dearlove, C., Dean, J., and C. Adjih, &ldquo;Generalized MANET Packet/Message Format,&rdquo; February&nbsp;2009.</span><span>)</span></a>, to be used (and shared) among MANET routing protocol security extensions, establishing two IANA registries for code-points for hash functions and cryptographic functions adhering to <a class='info' href='#RFC5444'>[RFC5444]<span> (</span><span class='info'>Clausen, T., Dearlove, C., Dean, J., and C. Adjih, &ldquo;Generalized MANET Packet/Message Format,&rdquo; February&nbsp;2009.</span><span>)</span></a>.
		
</p>
<p>With respect to <a class='info' href='#RFC5444'>[RFC5444]<span> (</span><span class='info'>Clausen, T., Dearlove, C., Dean, J., and C. Adjih, &ldquo;Generalized MANET Packet/Message Format,&rdquo; February&nbsp;2009.</span><span>)</span></a>, this document:
			</p>
<ul class="text">
<li>is intended to be used in the non-normative, but intended,  mode of use of <a class='info' href='#RFC5444'>[RFC5444]<span> (</span><span class='info'>Clausen, T., Dearlove, C., Dean, J., and C. Adjih, &ldquo;Generalized MANET Packet/Message Format,&rdquo; February&nbsp;2009.</span><span>)</span></a> as described in its Appendix B.
</li>
<li>is a specific example of the Security Considerations section of <a class='info' href='#RFC5444'>[RFC5444]<span> (</span><span class='info'>Clausen, T., Dearlove, C., Dean, J., and C. Adjih, &ldquo;Generalized MANET Packet/Message Format,&rdquo; February&nbsp;2009.</span><span>)</span></a> (the authentication part).
</li>
</ul><p>
		
</p>
<a name="overview"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Protocol Overview and Functioning</h3>

<p>
      	This specification does not describe a protocol, nor does it mandate specific router or protocol behavior. It represents a purely syntactical representation of security related information for use with <a class='info' href='#RFC5444'>[RFC5444]<span> (</span><span class='info'>Clausen, T., Dearlove, C., Dean, J., and C. Adjih, &ldquo;Generalized MANET Packet/Message Format,&rdquo; February&nbsp;2009.</span><span>)</span></a> addresses, messages and packets, as well as establishes IANA registrations and registries.
      
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Imported TLV Fields</h3>

<p>In this specification, the following TLV fields from <a class='info' href='#RFC5444'>[RFC5444]<span> (</span><span class='info'>Clausen, T., Dearlove, C., Dean, J., and C. Adjih, &ldquo;Generalized MANET Packet/Message Format,&rdquo; February&nbsp;2009.</span><span>)</span></a> are used:
		
		</p>
<blockquote class="text"><dl>
<dt>&lt;msg-hop-limit&gt;</dt>
<dd> -  hop limit of a message, as specified in Section 5.2 of <a class='info' href='#RFC5444'>[RFC5444]<span> (</span><span class='info'>Clausen, T., Dearlove, C., Dean, J., and C. Adjih, &ldquo;Generalized MANET Packet/Message Format,&rdquo; February&nbsp;2009.</span><span>)</span></a>.
</dd>
<dt>&lt;msg-hop-count&gt;</dt>
<dd> -  hop count of a message, as specified in Section 5.2 of <a class='info' href='#RFC5444'>[RFC5444]<span> (</span><span class='info'>Clausen, T., Dearlove, C., Dean, J., and C. Adjih, &ldquo;Generalized MANET Packet/Message Format,&rdquo; February&nbsp;2009.</span><span>)</span></a>.
</dd>
<dt>&lt;length&gt;</dt>
<dd> -  length of a TLV in octets, as specified in Section 5.4.1 of <a class='info' href='#RFC5444'>[RFC5444]<span> (</span><span class='info'>Clausen, T., Dearlove, C., Dean, J., and C. Adjih, &ldquo;Generalized MANET Packet/Message Format,&rdquo; February&nbsp;2009.</span><span>)</span></a>.
</dd>
</dl></blockquote><p>
		
</p>
<a name="signatureTLVformat"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
General Signature TLV Structure</h3>

<p>
		   The following data structure allows representation of a cryptographic signature, including specification of the appropriate hash function and cryptographic function used for calculating the signature. This &lt;signature&gt; data structure is specified, using the regular expression syntax of <a class='info' href='#RFC5444'>[RFC5444]<span> (</span><span class='info'>Clausen, T., Dearlove, C., Dean, J., and C. Adjih, &ldquo;Generalized MANET Packet/Message Format,&rdquo; February&nbsp;2009.</span><span>)</span></a>, as:
		
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
          &lt;signature&gt; := &lt;hash-function&gt;
                         &lt;cryptographic-function&gt;
                         &lt;key-index&gt;
                         &lt;signature-value&gt;
</pre></div>
<p>
   where:
	</p>
<blockquote class="text"><dl>
<dt>&lt;hash-function&gt;</dt>
<dd> is an 8-bit unsigned integer field specifying the hash function. 
		
</dd>
<dt>&lt;cryptographic-function&gt;</dt>
<dd> is an 8-bit unsigned integer field specifying the cryptographic function. 
		
</dd>
<dt>&lt;key-index&gt;</dt>
<dd> is an 8-bit unsigned integer field specifying the key index of the key which was used to sign the message, which allows unique identification of different keys with the same               originator.  It is the responsibility of each key              originator to make sure that actively used keys that it               issues have distinct key indices and that all key indices               have a value unequal to 0x00.  Value 0x00 is reserved for               a pre-installed, shared key.
		
</dd>
<dt>&lt;signature-value&gt;</dt>
<dd> is an unsigned integer field, whose length is &lt;length&gt; - 3, and which contains the cryptographic signature.
		
</dd>
</dl></blockquote><p>
	
	The basic version of this TLV assumes that calculating the signature can be decomposed into:
		</p>
<blockquote class="text"><dl>
<dt></dt>
<dd>signature-value = cryptographic-function(hash-function(content))
</dd>
</dl></blockquote><p>
		
	The hash function and the cryptographic function correspond to the entries in two IANA registries, set up by this specification in <a class='info' href='#IANA'>Section&nbsp;12<span> (</span><span class='info'>IANA Considerations</span><span>)</span></a>. 
		
	
	
	
	
</p>
<a name="rationale"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.1"></a><h3>7.1.&nbsp;
Rationale</h3>

<p>
	The rationale for separating the hash function and the cryptographic function into two octets instead of having all combinations in a single octet - possibly as TLV type extension - is twofold: 
	First, if further hash functions or cryptographic functions are added in the future, the number space might not remain continuous.  More importantly, the number space of possible combinations would be rapidly exhausted. As new or improved cryptographic mechanism are continuously being developed and introduced, this format should be able to accommodate such for the foreseeable future.
	
</p>
<p>
	The rationale for not including a field that lists parameters of the cryptographic signature in the TLV is, that before being able to validate a cryptographic signature, routers have to exchange or acquire keys (e.g. public keys). Any additional parameters can be provided together with the keys in that bootstrap process. It is therefore not necessary, and would even entail an extra overhead, to transmit the parameters within every message.
	
	One inherently included parameter is the length of the signature, which is &lt;length&gt; - 3 and which depends on the choice of the cryptographic function.
	
</p>
<a name="timestampTLVformat"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
General Timestamp TLV Structure</h3>

<p>
		   The following data structure allows the representation of a timestamp. This &lt;timestamp&gt; data structure is specified as:
		
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
       &lt;timestamp&gt; := &lt;time-value&gt;
</pre></div>
<p>
   where:
	</p>
<blockquote class="text"><dl>
<dt>&lt;time-value&gt;</dt>
<dd> is an unsigned integer field, whose length is &lt;length&gt;, and which contains the timestamp. The value of this variable is to be interpreted by the routing protocol as specified by the type extension of the Timestamp TLV, see <a class='info' href='#IANA'>Section&nbsp;12<span> (</span><span class='info'>IANA Considerations</span><span>)</span></a>.
		
</dd>
</dl></blockquote><p>
	
	 A timestamp is essentially "freshness information".  As such, its setting and interpretation is to be determined by the routing protocol (or the extension to a routing protocol) that uses it, and may e.g. correspond to a UNIX-timestamp, GPS timestamp or a simple sequence number.
	
</p>
<a name="packetSignatures"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Packet TLVs</h3>

<p>
      	Two Packet TLVs are defined, for including the cryptographic signature of a packet, and for including the timestamp indicating the time at which the cryptographic signature was calculated.
      
</p>
<a name="packetsignatureTLV"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.1"></a><h3>9.1.&nbsp;
Packet SIGNATURE TLV</h3>

<p>
			A Packet SIGNATURE TLV is an example of a Signature TLV as described in <a class='info' href='#signatureTLVformat'>Section&nbsp;7<span> (</span><span class='info'>General Signature TLV Structure</span><span>)</span></a>. When calculating the &lt;signature-value&gt; for a Packet, the signature is calculated over the three fields &lt;hash-function&gt;, &lt;cryptographic-function&gt; and &lt;key-index&gt; (in that order), concatenated with the entire Packet, including the packet header, all Packet TLVs (other than Packet SIGNATURE TLVs) and all included Messages and their message headers.
</p>
<p>The following considerations apply:
			</p>
<ul class="text">
<li>
					As packets defined in <a class='info' href='#RFC5444'>[RFC5444]<span> (</span><span class='info'>Clausen, T., Dearlove, C., Dean, J., and C. Adjih, &ldquo;Generalized MANET Packet/Message Format,&rdquo; February&nbsp;2009.</span><span>)</span></a> are never forwarded by routers, it is unnecessary to consider mutable fields (e.g. &lt;msg-hop-count&gt; and &lt;msg-hop-limit&gt;), if present, when calculating the signature.
				
</li>
<li>
					any Packet SIGNATURE TLVs already present in the Packet TLV block MUST be removed before calculating the signature, and the Packet TLV block size MUST be recalculated accordingly. The TLVs can be restored after having calculated the signature value.
				
</li>
</ul>

<p>The rationale for removing any Packet SIGNATURE TLV already present prior to calculating the signature, is that several signatures may be added to the same packet, e.g., using different signature functions.
</p>
<a name="packettimestampTLV"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.2"></a><h3>9.2.&nbsp;
Packet TIMESTAMP TLV</h3>

<p>
			A Packet TIMESTAMP TLV is an example of a Timestamp TLV as described in <a class='info' href='#timestampTLVformat'>Section&nbsp;8<span> (</span><span class='info'>General Timestamp TLV Structure</span><span>)</span></a>. If a packet contains a TIMESTAMP TLV and a SIGNATURE TLV, the TIMESTAMP TLV SHOULD be added to the packet before any SIGNATURE TLV, in order that it be included in the calculation of the signature.
		
</p>
<a name="messageSignatures"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
Message TLVs</h3>

<p>
      	Two Message TLVs are defined, for including the cryptographic signature of a message, and for including the timestamp indicating the time at which the cryptographic signature was calculated.
      
</p>
<a name="signatureTLV"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.1"></a><h3>10.1.&nbsp;
Message SIGNATURE TLV</h3>

<p>
			A Message SIGNATURE TLV is an example of a Signature TLV as described in <a class='info' href='#signatureTLVformat'>Section&nbsp;7<span> (</span><span class='info'>General Signature TLV Structure</span><span>)</span></a>. When determining the &lt;signature-value&gt; for a message, the signature is calculated over the three fields &lt;hash-function&gt;, &lt;cryptographic-function&gt;, and &lt;key-index&gt; (in that order), concatenated with the entire message with the following considerations:
			</p>
<ul class="text">
<li>
					the fields &lt;msg-hop-limit&gt; and &lt;msg-hop-count&gt;, if present, MUST both be assumed to have the value 0 (zero) when calculating the signature.
				
</li>
<li>
					any Message SIGNATURE TLVs already present in the Message TLV block MUST be removed before calculating the signature, and the message size as well as the Message TLV block size MUST be recalculated accordingly. The TLVs can be restored after having calculated the signature value.
				
</li>
</ul><p>
		
</p>
<p>The rationale for removing any Message SIGNATURE TLV already present prior to calculating the signature, is that several signatures may be added to the same message, e.g., using different signature functions.
</p>
<a name="timestampTLV"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.2"></a><h3>10.2.&nbsp;
Message TIMESTAMP TLV</h3>

<p>
			A Message TIMESTAMP TLV is an example of a Timestamp TLV as described in <a class='info' href='#timestampTLVformat'>Section&nbsp;8<span> (</span><span class='info'>General Timestamp TLV Structure</span><span>)</span></a>. If a message contains a TIMESTAMP TLV and a SIGNATURE TLV, the TIMESTAMP TLV SHOULD be added to the message before the SIGNATURE TLV, in order that it be included in the calculation of the signature.
		
</p>
<a name="addressblockSignatures"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
Address Block TLVs</h3>

<p>
      	Two Address Block TLVs are defined, for associating a cryptographic signature to an address, and for including the timestamp indicating the time at which the cryptographic signature was calculated.
      
</p>
<a name="addressblocksignatureTLV"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11.1"></a><h3>11.1.&nbsp;
Address Block SIGNATURE TLV</h3>

<p>
			An Address Block SIGNATURE TLV is an example of a Signature TLV as described in <a class='info' href='#signatureTLVformat'>Section&nbsp;7<span> (</span><span class='info'>General Signature TLV Structure</span><span>)</span></a>. The signature is  calculated over the three fields &lt;hash-function&gt;, &lt;cryptographic-function&gt;, and &lt;key-index&gt; (in that order), concatenated with the address, concatenated with any other values, for example, any other TLV value that is associated with that address. A routing protocol or routing protocol extension using Address Block SIGNATURE TLVs MUST specify how to include any such concatenated attribute of the address in the verification process of the signature.
		
</p>
<a name="addressblocktimestampTLV"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11.2"></a><h3>11.2.&nbsp;
Address Block TIMESTAMP TLV</h3>

<p>
			An Address Block TIMESTAMP TLV is an example of a Timestamp TLV as described in <a class='info' href='#timestampTLVformat'>Section&nbsp;8<span> (</span><span class='info'>General Timestamp TLV Structure</span><span>)</span></a>. If both a TIMESTAMP TLV and a SIGNATURE TLV are associated with an address, the timestamp value should be considered when calculating the value of the signature.
		
</p>
<a name="IANA"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12"></a><h3>12.&nbsp;
IANA Considerations</h3>

<p>This section specifies requests to IANA.
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12.1"></a><h3>12.1.&nbsp;
TLV Registrations</h3>

<p>
      	This specification defines:
      	</p>
<ul class="text">
<li>two Packet TLV types which must be allocated from the 0-223 range of the "Assigned Packet TLV Types" repository of <a class='info' href='#RFC5444'>[RFC5444]<span> (</span><span class='info'>Clausen, T., Dearlove, C., Dean, J., and C. Adjih, &ldquo;Generalized MANET Packet/Message Format,&rdquo; February&nbsp;2009.</span><span>)</span></a> as specified in <a class='info' href='#table_IANA_packet_TLV_types'>Table&nbsp;1<span> (</span><span class='info'>Packet TLV types</span><span>)</span></a>,
</li>
<li>two Message TLV types which must be allocated from the 0-127 range of the "Assigned Message TLV Types" repository of <a class='info' href='#RFC5444'>[RFC5444]<span> (</span><span class='info'>Clausen, T., Dearlove, C., Dean, J., and C. Adjih, &ldquo;Generalized MANET Packet/Message Format,&rdquo; February&nbsp;2009.</span><span>)</span></a> as specified in <a class='info' href='#table_IANA_message_TLV_types'>Table&nbsp;2<span> (</span><span class='info'>Message TLV types</span><span>)</span></a>,
</li>
<li>and two Address Block TLV types which must be allocated from the 0-127 range of the "Assigned Address Block TLV Types" repository of <a class='info' href='#RFC5444'>[RFC5444]<span> (</span><span class='info'>Clausen, T., Dearlove, C., Dean, J., and C. Adjih, &ldquo;Generalized MANET Packet/Message Format,&rdquo; February&nbsp;2009.</span><span>)</span></a> as specified in <a class='info' href='#table_IANA_addressblock_TLV_types'>Table&nbsp;3<span> (</span><span class='info'>Address Block TLV types</span><span>)</span></a>.
</li>
</ul><p>
		
		This specification requests:
      	</p>
<ul class="text">
<li>set up of type extension registries for these TLV types.
</li>
</ul><p>
		
		
</p>
<p>
         IANA is requested to assign the same numerical value to the Packet
         TLV, Message TLV and Address Block TLV types with the same name.
        
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12.1.1"></a><h3>12.1.1.&nbsp;
Expert Review: Evaluation Guidelines</h3>

<p>
        	For the registries for TLV type extensions where an Expert Review is required, the designated expert SHOULD take the same general recommendations into consideration as are specified by 
           <a class='info' href='#RFC5444'>[RFC5444]<span> (</span><span class='info'>Clausen, T., Dearlove, C., Dean, J., and C. Adjih, &ldquo;Generalized MANET Packet/Message Format,&rdquo; February&nbsp;2009.</span><span>)</span></a>.
</p>
<p>For the Timestamp TLV, the same type extensions for all Packet, Message and Address TLVs should be numbered identically.
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12.1.2"></a><h3>12.1.2.&nbsp;
Packet TLV Type Registrations</h3>

<p>
      	The Packet TLVs as specified in <a class='info' href='#table_IANA_packet_TLV_types'>Table&nbsp;1<span> (</span><span class='info'>Packet TLV types</span><span>)</span></a> must be allocated from the "Packet TLV Types" namespace of <a class='info' href='#RFC5444'>[RFC5444]<span> (</span><span class='info'>Clausen, T., Dearlove, C., Dean, J., and C. Adjih, &ldquo;Generalized MANET Packet/Message Format,&rdquo; February&nbsp;2009.</span><span>)</span></a>.
</p><br /><hr class="insert" />
<a name="table_IANA_packet_TLV_types"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="center"><col align="center"><col align="center"><col align="center">
<tr><th align="center">Name</th><th align="center">Type</th><th align="center">Type Extension</th><th align="center">Description</th></tr>
<tr>
<td align="center">SIGNATURE</td>
<td align="center">TBD3</td>
<td align="center">0</td>
<td align="center">Signature of a packet</td>
</tr>
<tr>
<td align="center">&nbsp;</td>
<td align="center">&nbsp;</td>
<td align="center">1-223</td>
<td align="center">Expert Review</td>
</tr>
<tr>
<td align="center">&nbsp;</td>
<td align="center">&nbsp;</td>
<td align="center">224-255</td>
<td align="center">Experimental Use</td>
</tr>
<tr>
<td align="center">TIMESTAMP</td>
<td align="center">TBD4</td>
<td align="center">0</td>
<td align="center">Unsigned timestamp of arbitrary length, given by the TLV length field.  The MANET routing protocol has to define how to interpret this timestamp</td>
</tr>
<tr>
<td align="center">&nbsp;</td>
<td align="center">&nbsp;</td>
<td align="center">1-223</td>
<td align="center">Expert Review</td>
</tr>
<tr>
<td align="center">&nbsp;</td>
<td align="center">&nbsp;</td>
<td align="center">224-255</td>
<td align="center">Experimental Use</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 1: Packet TLV types&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12.1.3"></a><h3>12.1.3.&nbsp;
Message TLV Type Registrations</h3>

<p>
      	The Message TLVs as specified in <a class='info' href='#table_IANA_message_TLV_types'>Table&nbsp;2<span> (</span><span class='info'>Message TLV types</span><span>)</span></a> must be allocated from the "Message TLV Types" namespace of <a class='info' href='#RFC5444'>[RFC5444]<span> (</span><span class='info'>Clausen, T., Dearlove, C., Dean, J., and C. Adjih, &ldquo;Generalized MANET Packet/Message Format,&rdquo; February&nbsp;2009.</span><span>)</span></a>.
</p><br /><hr class="insert" />
<a name="table_IANA_message_TLV_types"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="center"><col align="center"><col align="center"><col align="center">
<tr><th align="center">Name</th><th align="center">Type</th><th align="center">Type Extension</th><th align="center">Description</th></tr>
<tr>
<td align="center">SIGNATURE</td>
<td align="center">TBD1</td>
<td align="center">0</td>
<td align="center">Signature of a message</td>
</tr>
<tr>
<td align="center">&nbsp;</td>
<td align="center">&nbsp;</td>
<td align="center">1-223</td>
<td align="center">Expert Review</td>
</tr>
<tr>
<td align="center">&nbsp;</td>
<td align="center">&nbsp;</td>
<td align="center">224-255</td>
<td align="center">Experimental Use</td>
</tr>
<tr>
<td align="center">TIMESTAMP</td>
<td align="center">TBD2</td>
<td align="center">0</td>
<td align="center">Unsigned timestamp of arbitrary length, given by the TLV length field.</td>
</tr>
<tr>
<td align="center">&nbsp;</td>
<td align="center">&nbsp;</td>
<td align="center">1-223</td>
<td align="center">Expert Review</td>
</tr>
<tr>
<td align="center">&nbsp;</td>
<td align="center">&nbsp;</td>
<td align="center">224-255</td>
<td align="center">Experimental Use</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 2: Message TLV types&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12.1.4"></a><h3>12.1.4.&nbsp;
Address Block TLV Type Registrations</h3>

<p>
      	The Address Block TLVs as specified in <a class='info' href='#table_IANA_addressblock_TLV_types'>Table&nbsp;3<span> (</span><span class='info'>Address Block TLV types</span><span>)</span></a> must be allocated from the "Address Block TLV Types" namespace of <a class='info' href='#RFC5444'>[RFC5444]<span> (</span><span class='info'>Clausen, T., Dearlove, C., Dean, J., and C. Adjih, &ldquo;Generalized MANET Packet/Message Format,&rdquo; February&nbsp;2009.</span><span>)</span></a>.
</p><br /><hr class="insert" />
<a name="table_IANA_addressblock_TLV_types"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="center"><col align="center"><col align="center"><col align="center">
<tr><th align="center">Name</th><th align="center">Type</th><th align="center">Type Extension</th><th align="center">Description</th></tr>
<tr>
<td align="center">SIGNATURE</td>
<td align="center">TBD1</td>
<td align="center">0</td>
<td align="center">Signature of an object (e.g. an address)</td>
</tr>
<tr>
<td align="center">&nbsp;</td>
<td align="center">&nbsp;</td>
<td align="center">1-223</td>
<td align="center">Expert Review</td>
</tr>
<tr>
<td align="center">&nbsp;</td>
<td align="center">&nbsp;</td>
<td align="center">224-255</td>
<td align="center">Experimental Use</td>
</tr>
<tr>
<td align="center">TIMESTAMP</td>
<td align="center">TBD2</td>
<td align="center">0</td>
<td align="center">Unsigned timestamp of arbitrary length, given by the TLV length field. </td>
</tr>
<tr>
<td align="center">&nbsp;</td>
<td align="center">&nbsp;</td>
<td align="center">1-223</td>
<td align="center">Expert Review</td>
</tr>
<tr>
<td align="center">&nbsp;</td>
<td align="center">&nbsp;</td>
<td align="center">224-255</td>
<td align="center">Experimental Use</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 3: Address Block TLV types&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12.2"></a><h3>12.2.&nbsp;
New IANA Registries</h3>

<p>
			This document introduces three namespaces that have been registered: Packet TLV Types, Message TLV Types, and Address Block TLV Types.  This section specifies IANA registries for these namespaces and provides guidance to the Internet Assigned Numbers Authority regarding registrations in these namespaces.
		
</p>
<p>
			The following terms are used with the meanings defined in <a class='info' href='#BCP26'>[BCP26]<span> (</span><span class='info'>Narten, T. and H. Alvestrand, &ldquo;Guidelines for Writing an IANA Considerations Section in RFCs,&rdquo; May&nbsp;2008.</span><span>)</span></a>: "Namespace", "Assigned Value", "Registration", "Unassigned", "Reserved", "Hierarchical Allocation", and "Designated Expert".
		
</p>
<p>
			The following policies are used with the meanings defined in <a class='info' href='#BCP26'>[BCP26]<span> (</span><span class='info'>Narten, T. and H. Alvestrand, &ldquo;Guidelines for Writing an IANA Considerations Section in RFCs,&rdquo; May&nbsp;2008.</span><span>)</span></a>: "Private Use", "Expert Review", and "Standards Action".
		
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12.2.1"></a><h3>12.2.1.&nbsp;
Expert Review: Evaluation Guidelines</h3>

<p>
        		For the registries for the following tables where an Expert Review is required, the designated expert SHOULD take the same general recommendations into consideration as are specified by  <a class='info' href='#RFC5444'>[RFC5444]<span> (</span><span class='info'>Clausen, T., Dearlove, C., Dean, J., and C. Adjih, &ldquo;Generalized MANET Packet/Message Format,&rdquo; February&nbsp;2009.</span><span>)</span></a>.
           
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12.2.2"></a><h3>12.2.2.&nbsp;
Hash Function</h3>

<p>
		IANA is requested to create a new registry for the hash functions that can be used when creating a signature. The initial assignments and allocation policies are specified in <a class='info' href='#table_hash_registry'>Table&nbsp;4<span> (</span><span class='info'>Hash-Function registry</span><span>)</span></a>.
		
	
</p><br /><hr class="insert" />
<a name="table_hash_registry"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="center"><col align="center"><col align="center">
<tr><th align="center">Hash function value</th><th align="center">Algorithm</th><th align="center">Description</th></tr>
<tr>
<td align="center">0</td>
<td align="center">none</td>
<td align="center">The "identity function": the hash value of an object is the object itself</td>
</tr>
<tr>
<td align="center">1-223</td>
<td align="center">&nbsp;</td>
<td align="center">Expert Review</td>
</tr>
<tr>
<td align="center">224-255</td>
<td align="center">&nbsp;</td>
<td align="center">Experimental Use</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 4: Hash-Function registry&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12.2.3"></a><h3>12.2.3.&nbsp;
Cryptographic Algorithm</h3>

<p>
		IANA is requested to create a new registry for the cryptographic function. Initial assignments and allocation policies are specified in <a class='info' href='#table_cryptographic_registry'>Table&nbsp;5<span> (</span><span class='info'>Cryptographic function registry</span><span>)</span></a>.
		
	
</p><br /><hr class="insert" />
<a name="table_cryptographic_registry"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="center"><col align="center"><col align="center">
<tr><th align="center">Cryptographic function value</th><th align="center">Algorithm</th><th align="center">Description</th></tr>
<tr>
<td align="center">0</td>
<td align="center">none</td>
<td align="center">The "identity function": the value of an encrypted hash is the hash itself</td>
</tr>
<tr>
<td align="center">1-223</td>
<td align="center">&nbsp;</td>
<td align="center">Expert Review</td>
</tr>
<tr>
<td align="center">224-255</td>
<td align="center">&nbsp;</td>
<td align="center">Experimental Use</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 5: Cryptographic function registry&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="Security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.13"></a><h3>13.&nbsp;
Security Considerations</h3>

<p>
      	This document does not specify a protocol itself. However, it provides a syntactical component for cryptographic signatures of messages and packets as defined in <a class='info' href='#RFC5444'>[RFC5444]<span> (</span><span class='info'>Clausen, T., Dearlove, C., Dean, J., and C. Adjih, &ldquo;Generalized MANET Packet/Message Format,&rdquo; February&nbsp;2009.</span><span>)</span></a>. It can be used to address security issues of a protocol or extension that uses the component specified in this document. As such, it has the same security considerations as <a class='info' href='#RFC5444'>[RFC5444]<span> (</span><span class='info'>Clausen, T., Dearlove, C., Dean, J., and C. Adjih, &ldquo;Generalized MANET Packet/Message Format,&rdquo; February&nbsp;2009.</span><span>)</span></a>.
</p>
<p>In addition, a protocol that includes this component MUST specify the usage as well as the security that is attained by the cryptographic signatures of a message or a packet.
</p>
<p>As an example, a routing protocol that uses this component to reject "badly formed" messages if a control message does not contain a valid signature, should indicate the security assumption that if the signature is valid, the message is considered valid. It also should indicate the security issues that are counteracted by this measure (e.g. link or identity spoofing) as well as the issues that are not counteracted (e.g. compromised keys). 
      	
      
</p>
<a name="Acknowledgements"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.14"></a><h3>14.&nbsp;
Acknowledgements</h3>

<p>The authors would like to thank Jerome Milan (Ecole Polytechnique) for his advice as cryptographer. In addition, many thanks to Bo Berry (Cisco), Alan Cullen (BAE), Justin Dean (NRL), Christopher Dearlove (BAE), Paul Lambert (Marvell), and Henning Rogge (FGAN) for their constructive comments on the document.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.15"></a><h3>15.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>15.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="BCP26">[BCP26]</a></td>
<td class="author-text">Narten, T. and H. Alvestrand, &ldquo;<a href="http://tools.ietf.org/html/rfc5226">Guidelines for Writing an IANA Considerations Section in RFCs</a>,&rdquo; RFC&nbsp;5226, BCP&nbsp;26, May&nbsp;2008.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text">Bradner, S., &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; RFC&nbsp;2119, BCP&nbsp;14, March&nbsp;1997.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5444">[RFC5444]</a></td>
<td class="author-text">Clausen, T., Dearlove, C., Dean, J., and C. Adjih, &ldquo;<a href="http://tools.ietf.org/html/rfc5444">Generalized MANET Packet/Message Format</a>,&rdquo; RFC&nbsp;5444, February&nbsp;2009.</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>15.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="NHDP">[NHDP]</a></td>
<td class="author-text">Clausen, T., Dean, J., and C. Dearlove, &ldquo;MANET Neighborhood Discovery Protocol (NHDP),&rdquo; work in progress&nbsp;draft-ietf-manet-nhdp-14.txt, July&nbsp;2010.</td></tr>
<tr><td class="author-text" valign="top"><a name="OLSRv2">[OLSRv2]</a></td>
<td class="author-text">Clausen, T., Dearlove, C., and P. Jacquet, &ldquo;The Optimized Link State Routing Protocol version 2,&rdquo; work in progress&nbsp;draft-ietf-manet-olsrv2-11.txt, April&nbsp;2010.</td></tr>
</table>

<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Examples</h3>

<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1"></a><h3>A.1.&nbsp;
Example of a Signed Message</h3>

<p>
        	The sample message depicted in <a class='info' href='#exampleMessage'>Figure&nbsp;1<span> (</span><span class='info'>Example message with signature</span><span>)</span></a> is  derived from the appendix of <a class='info' href='#RFC5444'>[RFC5444]<span> (</span><span class='info'>Clausen, T., Dearlove, C., Dean, J., and C. Adjih, &ldquo;Generalized MANET Packet/Message Format,&rdquo; February&nbsp;2009.</span><span>)</span></a>. A SIGNATURE Message TLV has been added, with the value representing a 15 octet long signature of the whole message.
        
</p><br /><hr class="insert" />
<a name="exampleMessage"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |0 0 0 0 1 0 0 0|    Packet Sequence Number     | Message Type  |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |1 1 1 1 0 0 1 1|0 0 0 0 0 0 0 0 0 1 0 0 1 1 0 0|   Orig Addr   |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |           Originator Address (cont)           |   Hop Limit   |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |   Hop Count   |    Message Sequence Number    |0 0 0 0 0 0 0 0|
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |0 0 0 1 1 1 1 0|   SIGNATURE   |0 0 0 1 0 0 0 0|0 0 0 1 0 0 1 0|
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |   Hash Func   |  Crypto Func  |    Key Index  |  Sign. Value  |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                    Signature Value (cont)                     |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                    Signature Value (cont)                     |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                    Signature Value (cont)                     |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |    Signature Value (cont)     |   TLV Type    |0 0 0 1 0 0 0 0|
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |0 0 0 0 0 1 1 0|                     Value                     |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                 Value (cont)                  |0 0 0 0 0 0 1 0|
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |0 0 1 1 0 0 0 0|0 0 0 0 0 0 1 0|              Mid              |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |              Mid              | Prefix Length |0 0 0 0 0 0 0 0|
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |0 0 0 0 0 0 0 0|0 0 0 0 0 0 1 1|1 0 0 0 0 0 0 0|0 0 0 0 0 0 1 0|
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |             Head              |              Mid              |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |              Mid              |              Mid              |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1|   TLV Type    |0 0 0 1 0 0 0 0|
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |0 0 0 0 0 0 1 0|             Value             |   TLV Type    |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |0 0 1 0 0 0 0 0|  Index Start  |  Index Stop   |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: Example message with signature&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Ulrich Herberg</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">LIX, Ecole Polytechnique</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">91128 Palaiseau Cedex, </td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">France</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+33 1 6933 4126</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:ulrich@herberg.name">ulrich@herberg.name</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.herberg.name/">http://www.herberg.name/</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Thomas Heide Clausen</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">LIX, Ecole Polytechnique</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">91128 Palaiseau Cedex, </td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">France</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+33 6 6058 9349</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:T.Clausen@computer.org">T.Clausen@computer.org</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.thomasclausen.org/">http://www.thomasclausen.org/</a></td></tr>
</table>
</body></html>
