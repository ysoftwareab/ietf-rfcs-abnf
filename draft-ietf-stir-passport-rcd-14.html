<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>PASSporT Extension for Rich Call Data</title>
<meta content="Chris Wendt" name="author">
<meta content="Jon Peterson" name="author">
<meta content='
       This document extends PASSporT, a token for conveying cryptographically-signed call information about personal communications, to include rich meta-data about a call and caller that can be signed and integrity protected, transmitted, and subsequently rendered to the called party. This framework is intended to include and extend caller and call specific information beyond human-readable display name comparable to the "Caller ID" function common on the telephone network. The JSON element defined for this purpose, Rich Call Data (RCD), is an extensible object defined to either be used as part of STIR or with SIP Call-Info to include related information about calls that helps people decide whether to answer an incoming set of communications from another party. This signing of the RCD information is also enhanced with a integrity mechanism that is designed to protect the authoring and transport of this information between authoritative and non-authoritative parties generating and signing the Rich Call Data for support of different usage and content policies. 
    ' name="description">
<meta content="xml2rfc 3.10.0" name="generator">
<meta content="Identity" name="keyword">
<meta content="draft-ietf-stir-passport-rcd-14" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.10.0
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.6.3
    pycountry 20.7.3
    pyflakes 2.4.0
    PyYAML 5.4.1
    requests 2.26.0
    setuptools 58.2.0
    six 1.16.0
-->
<link href="/tmp/draft-ietf-stir-passport-rcd-14-lrpl4fok.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">RCD</td>
<td class="right">October 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Wendt &amp; Peterson</td>
<td class="center">Expires 28 April 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-stir-passport-rcd-14</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2021-10-25" class="published">25 October 2021</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-04-28">28 April 2022</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">C. Wendt</div>
<div class="org">Comcast</div>
</div>
<div class="author">
      <div class="author-name">J. Peterson</div>
<div class="org">Neustar Inc.</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">PASSporT Extension for Rich Call Data</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document extends PASSporT, a token for conveying cryptographically-signed call information about personal communications, to include rich meta-data about a call and caller that can be signed and integrity protected, transmitted, and subsequently rendered to the called party. This framework is intended to include and extend caller and call specific information beyond human-readable display name comparable to the "Caller ID" function common on the telephone network. The JSON element defined for this purpose, Rich Call Data (RCD), is an extensible object defined to either be used as part of STIR or with SIP Call-Info to include related information about calls that helps people decide whether to answer an incoming set of communications from another party. This signing of the RCD information is also enhanced with a integrity mechanism that is designed to protect the authoring and transport of this information between authoritative and non-authoritative parties generating and signing the Rich Call Data for support of different usage and content policies.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo-3">
<a href="#name-status-of-this-memo-3" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 28 April 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice-3">
<a href="#name-copyright-notice-3" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents-3">
<a href="#name-table-of-contents-3" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction-3" class="xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="xref">2</a>.  <a href="#name-terminology-2" class="xref">Terminology</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1" class="keepWithNext"><a href="#section-3" class="xref">3</a>.  <a href="#name-overview-of-the-use-of-the-" class="xref">Overview of the use of the Rich Call Data PASSporT extension</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-overview-of-rich-call-data-" class="xref">Overview of Rich Call Data Integrity</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-passport-claim-rcd-defintio" class="xref">PASSporT Claim "rcd" Defintion and Usage</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-passport-rcd-claim" class="xref">PASSporT "rcd" Claim</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.1">
                    <p id="section-toc.1-1.5.2.1.2.1.1"><a href="#section-5.1.1" class="xref">5.1.1</a>.  <a href="#name-nam-key" class="xref">"nam" key</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.2">
                    <p id="section-toc.1-1.5.2.1.2.2.1"><a href="#section-5.1.2" class="xref">5.1.2</a>.  <a href="#name-apn-key" class="xref">"apn" key</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.3">
                    <p id="section-toc.1-1.5.2.1.2.3.1"><a href="#section-5.1.3" class="xref">5.1.3</a>.  <a href="#name-jcd-key" class="xref">"jcd" key</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.4">
                    <p id="section-toc.1-1.5.2.1.2.4.1"><a href="#section-5.1.4" class="xref">5.1.4</a>.  <a href="#name-jcl-key" class="xref">"jcl" key</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-rcdi-rcd-integrity-claim-de" class="xref">"rcdi" RCD Integrity Claim Definition and Usage</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-creation-of-the-rcd-element" class="xref">Creation of the "rcd" element digests</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-jwt-claim-constraints-for-r" class="xref">JWT Claim Constraints for "rcd" claims only</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-jwt-claim-constraints-usage" class="xref">JWT Claim Constraints usage for "rcd" and "rcdi" claims</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-passport-crn-claim-call-rea" class="xref">PASSporT "crn" claim - Call Reason Defintion and Usage</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="xref">8.1</a>.  <a href="#name-jwt-constraint-for-crn-clai" class="xref">JWT Constraint for "crn" claim</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-rich-call-data-claims-usage" class="xref">Rich Call Data Claims Usage Rules</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="xref">9.1</a>.  <a href="#name-verification-rules" class="xref">Verification rules</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="xref">9.2</a>.  <a href="#name-example-rcd-passports" class="xref">Example "rcd" PASSporTs</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-compact-form-of-rcd-passpor" class="xref">Compact form of "rcd" PASSporT</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="xref">10.1</a>.  <a href="#name-compact-form-of-the-rcd-pas" class="xref">Compact form of the "rcd" PASSporT claim</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="xref">10.2</a>.  <a href="#name-compact-form-of-the-rcdi-pa" class="xref">Compact form of the "rcdi" PASSporT claim</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.3">
                <p id="section-toc.1-1.10.2.3.1"><a href="#section-10.3" class="xref">10.3</a>.  <a href="#name-compact-form-of-the-crn-pas" class="xref">Compact form of the "crn" PASSporT claim</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>. <a href="#name-further-information-associa" class="xref">Further Information Associated with Callers</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="xref">12</a>. <a href="#name-third-party-uses" class="xref">Third-Party Uses</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#section-12.1" class="xref">12.1</a>.  <a href="#name-signing-as-a-third-party" class="xref">Signing as a Third Party</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="xref">13</a>. <a href="#name-levels-of-assurance" class="xref">Levels of Assurance</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-14" class="xref">14</a>. <a href="#name-using-rcd-in-sip" class="xref">Using "rcd" in SIP</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.1">
                <p id="section-toc.1-1.14.2.1.1"><a href="#section-14.1" class="xref">14.1</a>.  <a href="#name-authentication-service-beha" class="xref">Authentication Service Behavior</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.2">
                <p id="section-toc.1-1.14.2.2.1"><a href="#section-14.2" class="xref">14.2</a>.  <a href="#name-verification-service-behavi" class="xref">Verification Service Behavior</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#section-15" class="xref">15</a>. <a href="#name-using-rcd-as-additional-cla" class="xref">Using "rcd" as additional claims to other PASSporT extensions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.1">
                <p id="section-toc.1-1.15.2.1.1"><a href="#section-15.1" class="xref">15.1</a>.  <a href="#name-procedures-for-applying-rcd" class="xref">Procedures for applying "rcd" as claims only</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.2">
                <p id="section-toc.1-1.15.2.2.1"><a href="#section-15.2" class="xref">15.2</a>.  <a href="#name-example-for-applying-rcd-as" class="xref">Example for applying "rcd" as claims only</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#section-16" class="xref">16</a>. <a href="#name-acknowledgements-3" class="xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a href="#section-17" class="xref">17</a>. <a href="#name-iana-considerations-3" class="xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.1">
                <p id="section-toc.1-1.17.2.1.1"><a href="#section-17.1" class="xref">17.1</a>.  <a href="#name-json-web-token-claim" class="xref">JSON Web Token Claim</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.2">
                <p id="section-toc.1-1.17.2.2.1"><a href="#section-17.2" class="xref">17.2</a>.  <a href="#name-passport-types" class="xref">PASSporT Types</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.3">
                <p id="section-toc.1-1.17.2.3.1"><a href="#section-17.3" class="xref">17.3</a>.  <a href="#name-passport-rcd-types" class="xref">PASSporT RCD Types</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18">
            <p id="section-toc.1-1.18.1"><a href="#section-18" class="xref">18</a>. <a href="#name-security-considerations-3" class="xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.1">
                <p id="section-toc.1-1.18.2.1.1"><a href="#section-18.1" class="xref">18.1</a>.  <a href="#name-the-use-of-jwt-claim-constr" class="xref">The use of JWT Claim Constraints in delegate certificates to exclude unauthorized claims</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19">
            <p id="section-toc.1-1.19.1"><a href="#section-19" class="xref">19</a>. <a href="#name-references-3" class="xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19.2.1">
                <p id="section-toc.1-1.19.2.1.1"><a href="#section-19.1" class="xref">19.1</a>.  <a href="#name-normative-references-3" class="xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19.2.2">
                <p id="section-toc.1-1.19.2.2.1"><a href="#section-19.2" class="xref">19.2</a>.  <a href="#name-informative-references-3" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20">
            <p id="section-toc.1-1.20.1"><a href="#appendix-A" class="xref"></a><a href="#name-authors-addresses-3" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction-3">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction-3" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">PASSporT <span>[<a href="#RFC8225" class="xref">RFC8225</a>]</span> is a token format based on JWT <span>[<a href="#RFC7519" class="xref">RFC7519</a>]</span> for conveying cryptographically-signed information about the parties involved in personal communications; it is used to convey a signed assertion of the identity of the participants in real-time communications established via a protocol like SIP <span>[<a href="#RFC8224" class="xref">RFC8224</a>]</span>. The STIR problem statement <span>[<a href="#RFC7340" class="xref">RFC7340</a>]</span> declared securing the display name of callers outside of STIR's initial scope, so baseline STIR provides no features for caller name. This specification documents an optional mechanism for PASSporT and the associated STIR procedures which extend PASSporT objects to protect additional elements conveying richer information: information that is intended to be rendered to assist a called party in determining whether to accept or trust incoming communications. This includes the name of the person or entity on one side of a communications session, the traditional "Caller ID" of the telephone network, along with related display information that would be rendered to the called party during alerting, or potentially used by an automaton to determine whether and how to alert a called party.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">Traditional telephone network signaling protocols have long supported delivering a 'calling name' from the originating side, though in practice, the terminating side is often left to derive a name from the calling party number by consulting a local address book or an external database. SIP similarly can carry this information in a 'display-name' in the From header field value from the originating to terminating side, or alternatively in the Call-Info header field. However, both are unsecured fields that really cannot be trusted in most interconnected SIP deployments, and therefore is a good starting point for a framework that utilizes STIR techniques and procedures for protecting call related information including but not limited to calling name.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">As such, the baseline use-case for this document extends PASSporT to provide cryptographic protection for the "display-name" field of SIP requests as well as further "rich call data" (RCD) about the caller, which includes the contents of the Call-Info header field or other data structures that can be added to the PASSporT. This document furthermore specifies a third-party profile that would allow external authorities to convey rich information associated with a calling number via a new type of PASSporT. Finally, this document describes how to preserve the integrity of the RCD in scenarios where there may be non-authoritative users initiating and signing RCD and therefore a constraint on the RCD data that a PASSporT can attest via certificate-level controls.<a href="#section-1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="terminology">
<section id="section-2">
      <h2 id="name-terminology-2">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-terminology-2" class="section-name selfRef">Terminology</a>
      </h2>
<p id="section-2-1">The keywords "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="overview-of-the-use-of-the-rich-call-data-passport-extension">
<section id="section-3">
      <h2 id="name-overview-of-the-use-of-the-">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-overview-of-the-use-of-the-" class="section-name selfRef">Overview of the use of the Rich Call Data PASSporT extension</a>
      </h2>
<p id="section-3-1">The main intended use of the signing of Rich Call Data (RCD) using STIR within SIP <span>[<a href="#RFC8224" class="xref">RFC8224</a>]</span> or more generally as a PASSporT extension <span>[<a href="#RFC8225" class="xref">RFC8225</a>]</span> is for the entity that originates a call, either directly the caller themselves, if they are authoritative, or a service provider or third-party service that may be authoritative over the rich call data on behalf of the caller.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">The RCD associated with the identity of the calling party described in this document is of two main categories. The first data is a more traditional set of info about a caller associated with "display-name" in SIP <span>[<a href="#RFC3261" class="xref">RFC3261</a>]</span>, typically a textual description of the caller, or alternate presentation numbers often used in From Header field <span>[<a href="#RFC3261" class="xref">RFC3261</a>]</span> or P-Asserted-ID <span>[<a href="#RFC3325" class="xref">RFC3325</a>]</span>. The second category is a set of RCD that is defined as part of the jCard definitions or extensions to that data. <span>[<a href="#I-D.ietf-sipcore-callinfo-rcd" class="xref">I-D.ietf-sipcore-callinfo-rcd</a>]</span> describes the optional use of jCard in Call-Info header field as RCD with the "jcard" Call-Info purpose token. Either or both of these two types of data can be incorporated into a "rcd" claim defined in this document.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">Additionally, in relation to the description of the specific communications event itself (versus the identity description in previous paragraph), <span>[<a href="#I-D.ietf-sipcore-callinfo-rcd" class="xref">I-D.ietf-sipcore-callinfo-rcd</a>]</span> also describes a "call-reason" parameter intended for description of the intent or reason for a particular call. A new PASSporT claim "crn", or call reason, can contain the string or object that describes the intent of the call. This claim is intentionally kept separate from the "rcd" claim because it is envisioned that call reason is not the same as information associated with the caller and may change on a more frequent, per call, type of basis.<a href="#section-3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="overview-of-rich-call-data-integrity">
<section id="section-4">
      <h2 id="name-overview-of-rich-call-data-">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-overview-of-rich-call-data-" class="section-name selfRef">Overview of Rich Call Data Integrity</a>
      </h2>
<p id="section-4-1">When incorporating call data that represents a user, even in traditional calling name services today, often there is policy and restrictions around what data is allowed to be used. Whether preventing offensive language or icons or enforcing uniqueness, potential trademark or copyright violations or other policy enforcement, there might be the desire to pre-certify or "vet" the specific use of rich call data. This document defines a mechanism that allows for a direct or indirect party that controls the policy to approve or certify the content, create a cryptographic digest that can be used to validate that data and applies a constraint in the certificate to allow the recipient and verifier to validate that the specific content of the RCD is as intended at its creation and approval or certification.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">There are two mechanisms that are defined to accomplish that for two distinct categories of purposes. The first of the mechanisms include the definition of an integrity claim. The RCD integrity mechanism is a process of generating a sufficiently strong cryptographic digest for both the "rcd" claim contents (e.g. "nam", "jcd", "jcl") defined below and the resources defined by one or more globally unique HTTPS URLs referenced by the contents (e.g. an image file referenced by "jcd" or a jCard referenced by "jcl"). This mechanism is inspired by and based on the W3C Subresource Integrity specification (http://www.w3.org/TR/SRI/). The second of the mechanisms uses the capability called JWT Claim Constraints, defined in <span>[<a href="#RFC8226" class="xref">RFC8226</a>]</span> and extended in <span>[<a href="#I-D.ietf-stir-enhance-rfc8226" class="xref">I-D.ietf-stir-enhance-rfc8226</a>]</span>. The JWT Claim Constraints specifically guide the verifier within the certificate used to sign the PASSporT for the inclusion (or exclusion) of specific claims and their values, so that the content intended by the signer can be verified to be accurate.<a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3">Both of these mechanisms, integrity digests and JWT Claims Constraints, can be used together or separately depending on the intended purpose. The first category of purpose is whether the rich call data conveyed by the RCD passport is pass-by-value or passed-by-reference; i.e., is the information contained in the passport claims and therefore integrity protected by the passport signature, or is the information contained in an external resource referenced by a URI in the RCD PASSporT. The second category of purpose is whether the signer is authoritative or has responsibility for the accuracy of the RCD based on the policies of the eco-system the RCD PASSporTs are being used.<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4">The following table provides an overview of the framework for how integrity should be used with RCD. (Auth represents authoritative in this table)<a href="#section-4-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4-5">
<pre>
+----------+---------------------+--------------------------------+
|   Modes  |  No external URIs   |      Includes URI refs         |
+----------+---------------------+--------------------------------+
|   Auth   | 1: No integrity req | 2: RDC Integrity               |
+----------+---------------------+--------------------------------+
| Non-Auth | 3: JWT Claim Const. | 4: RCD Integ./JWT Claim Const. |
+----------+---------------------+--------------------------------+
</pre><a href="#section-4-5" class="pilcrow">¶</a>
</div>
<p id="section-4-6">The first and simplest mode is exclusively for when all RCD content is directly included as part of the claims (i.e. no external reference URIs are included in the content) and when the signer is authoritative over the content. In this mode, integrity protection is not required and the set of claims is simply protected by the signature of the standard PASSporT <span>[<a href="#RFC8225" class="xref">RFC8225</a>]</span> and SIP identity header <span>[<a href="#RFC8224" class="xref">RFC8224</a>]</span> procedures. The second mode is an extension of the first where the signer is authoritative and a "rcd" claim contents include a URI identifying external resources. In this mode, an RCD Integrity or "rcdi" claim MUST be included. This integrity claim is defined later in this document and provides a digest of the "rcd" claim content so that, particularly for the case where there are URI references in the RCD, the content of that RCD can be comprehensively validated that it was received as intended by the signer of the PASSporT.<a href="#section-4-6" class="pilcrow">¶</a></p>
<p id="section-4-7">The third and fourth mode cover cases where there is a different authoritative entity responsible for the content of the RCD, separate from the signer of the PASSporT itself, allowing the ability to have forward control at the time of the creation of the certificate of the allowed or vetted content included in or referenced by the RCD claim contents. The primary framework for allowing the separation of authority and the signing of PASSporTs by non-authorized entities is detailed in <span>[<a href="#I-D.ietf-stir-cert-delegation" class="xref">I-D.ietf-stir-cert-delegation</a>]</span> although other cases may apply. As with the first and second modes, the third and fourth modes differ with the absence or inclusion of externally referenced content using URIs.<a href="#section-4-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="passport-claim-rcd-defintion-and-usage">
<section id="section-5">
      <h2 id="name-passport-claim-rcd-defintio">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-passport-claim-rcd-defintio" class="section-name selfRef">PASSporT Claim "rcd" Defintion and Usage</a>
      </h2>
<div id="syntax">
<section id="section-5.1">
        <h3 id="name-passport-rcd-claim">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-passport-rcd-claim" class="section-name selfRef">PASSporT "rcd" Claim</a>
        </h3>
<p id="section-5.1-1">This specification defines a new JSON Web Token claim for "rcd", Rich Call Data, the value of which is a JSON object that can contain one or more key value pairs. This document defines a default set of key values.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<div id="nam-key">
<section id="section-5.1.1">
          <h4 id="name-nam-key">
<a href="#section-5.1.1" class="section-number selfRef">5.1.1. </a><a href="#name-nam-key" class="section-name selfRef">"nam" key</a>
          </h4>
<p id="section-5.1.1-1">The "nam" key value is a display name, associated with the originator of personal communications, which may for example derive from the display-name component of the From header field value of a SIP request or alternatively from the P-Asserted-Identity header field value, or a similar field in other PASSporT using protocols. This key MUST be included once as part of the "rcd" claim value JSON object. If there is no string associated with a display name, the claim value MUST then be an empty string.<a href="#section-5.1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="apn-key">
<section id="section-5.1.2">
          <h4 id="name-apn-key">
<a href="#section-5.1.2" class="section-number selfRef">5.1.2. </a><a href="#name-apn-key" class="section-name selfRef">"apn" key</a>
          </h4>
<p id="section-5.1.2-1">The "apn" key value is an optional alternate presentation number associated with the originator of personal communications, which may for example derive from the user component of the From header field value of a SIP request (in cases where a network number is carried in the P-Asserted-Identity <span>[<a href="#RFC3325" class="xref">RFC3325</a>]</span>), or alternatively from the Additional-Identity header field value [3GPP TS 24.229 v16.7.0], or a similar field in other PASSporT using protocols. Its intended semantics are to convey a number that the originating user is authorized to show to called parties in lieu of their default number, such as cases where a remote call agent uses the main number of a call center instead of their personal telephone number. The "apn" key value is a canonicalized telephone number per <span>[<a href="#RFC8224" class="xref">RFC8224</a>]</span> Section 8.3. If present, this key MUST be included once as part of the "rcd" claim value JSON object.<a href="#section-5.1.2-1" class="pilcrow">¶</a></p>
<p id="section-5.1.2-2">The use of the optional "apn" key is intended for cases where the signer of an rcd PASSporT authorizes the use of an alternate presentation number by the user. How the signer determines that a user is authorized to present the number in question is a policy decision outside the scope of this document, however, the vetting of the alternate presentation number should follow the same level of vetting as telephone identities or any other information contained in an RCD PASSporT. This usage is intended as an alternative to conveying the presentation number in the "tel" key value of a jCard, in situations where no other rich jCard data needs to be conveyed with the call. Only one "apn" key may be present. "apn" MUST be used when it is the intent of the caller or signer to display the alternate presentation number even if "jcd" or "jcl" keys are present in a PASSporT with a "tel" key value.<a href="#section-5.1.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="jcd-key">
<section id="section-5.1.3">
          <h4 id="name-jcd-key">
<a href="#section-5.1.3" class="section-number selfRef">5.1.3. </a><a href="#name-jcd-key" class="section-name selfRef">"jcd" key</a>
          </h4>
<p id="section-5.1.3-1">The "jcd" key value is defined to contain a jCard <span>[<a href="#RFC7095" class="xref">RFC7095</a>]</span> JSON object. This jCard object is intended to represent and derives from the Call-Info header field value defined in <span>[<a href="#I-D.ietf-sipcore-callinfo-rcd" class="xref">I-D.ietf-sipcore-callinfo-rcd</a>]</span> with a type of "jcard". As also defined in <span>[<a href="#I-D.ietf-sipcore-callinfo-rcd" class="xref">I-D.ietf-sipcore-callinfo-rcd</a>]</span>, format of the jCard and properties used should follow the normative usage and formatting rules and procedures. It is an extensible object where the calling party can provide both the standard types of information defined in jCard or can use the built-in extensibility of the jCard specification to add additional information. The "jcd" key is optional. If included, this key MUST only be included once in the "rcd" JSON object and MUST NOT be included if there is a "jcl" key included. The use of "jcd" and "jcl" keys are mutually exclusive.<a href="#section-5.1.3-1" class="pilcrow">¶</a></p>
<p id="section-5.1.3-2">The jCard object value for "jcd" MUST only have referenced content for URI values that do not further reference URIs. Future specifications may extend this capability, but as stated in <span>[<a href="#I-D.ietf-sipcore-callinfo-rcd" class="xref">I-D.ietf-sipcore-callinfo-rcd</a>]</span> it constrains the security properties of RCD information and the integrity of the content referenced by URIs.<a href="#section-5.1.3-2" class="pilcrow">¶</a></p>
<p id="section-5.1.3-3">Note: even though we refer to <span>[<a href="#I-D.ietf-sipcore-callinfo-rcd" class="xref">I-D.ietf-sipcore-callinfo-rcd</a>]</span> as the definition of the jcard properties for usage in a "rcd" PASSporT, other protocols can be adapted for use of "jcd" (or similarly "jcl" below) key beyond SIP and Call-Info.<a href="#section-5.1.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="jcl-key">
<section id="section-5.1.4">
          <h4 id="name-jcl-key">
<a href="#section-5.1.4" class="section-number selfRef">5.1.4. </a><a href="#name-jcl-key" class="section-name selfRef">"jcl" key</a>
          </h4>
<p id="section-5.1.4-1">The "jcl" key value is defined to contain a HTTPS URL that refers the recipient to a jCard <span>[<a href="#RFC7095" class="xref">RFC7095</a>]</span> JSON object hosted on a HTTPS enabled web server. The web server MUST use the MIME media type for JSON text as application/json with a default encoding of UTF-8 <span>[<a href="#RFC4627" class="xref">RFC4627</a>]</span>. This link may derive from the Call-Info header field value defined in <span>[<a href="#I-D.ietf-sipcore-callinfo-rcd" class="xref">I-D.ietf-sipcore-callinfo-rcd</a>]</span> with a type of "jcard". As also defined in <span>[<a href="#I-D.ietf-sipcore-callinfo-rcd" class="xref">I-D.ietf-sipcore-callinfo-rcd</a>]</span>, format of the jCard and properties used should follow the normative usage and formatting rules and procedures. The "jcl" key is optional. If included, this key MUST only be included once in the "rcd" JSON object and MUST NOT be included if there is a "jcd" key included. The use of "jcd" and "jcl" keys are mutually exclusive.<a href="#section-5.1.4-1" class="pilcrow">¶</a></p>
<p id="section-5.1.4-2">The jCard object referenced by the URI value for "jcl" MUST only have referenced content for URI values that do not further reference URIs. Future specifications may extend this capability, but as stated in <span>[<a href="#I-D.ietf-sipcore-callinfo-rcd" class="xref">I-D.ietf-sipcore-callinfo-rcd</a>]</span> it constrains the security properties of RCD information and the integrity of the content referenced by URIs.<a href="#section-5.1.4-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="rcdi-rcd-integrity-claim-definition-and-usage">
<section id="section-6">
      <h2 id="name-rcdi-rcd-integrity-claim-de">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-rcdi-rcd-integrity-claim-de" class="section-name selfRef">"rcdi" RCD Integrity Claim Definition and Usage</a>
      </h2>
<p id="section-6-1">The "rcdi" claim is included for the second and fourth modes described in integrity overview section of this document. If this claim is present it MUST be only included once with the corresponding single "rcd" claim. The value of the "rcdi" claim is a JSON object that is defined as follows.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">The claim value of "rcdi" claim key is a JSON object with a set of JSON key/value pairs. These objects correspond to each of the elements of the "rcd" claim object that require integrity protection with an associated digest over the content referenced by the key string. The individual digest of different elements of the "rcd" claim data and external URI referenced content is kept specifically separate to allow the ability to verify the integrity of only the elements that are ultimately retrieved or downloaded or rendered to the end-user.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">The key value references a specific object within the "rcd" claim value using a JSON pointer defined in <span>[<a href="#RFC6901" class="xref">RFC6901</a>]</span> with a minor additional rule to support external URI references that include JSON objects themselves, for the specific case of the use of "jcl". JSON pointer syntax is the key value that specifies exactly the part of JSON that is used to generate the digest which produce the resulting string that makes up the value for the corresponding key. Detailed procedures are provided below, but an example "rcdi" is provided here:<a href="#section-6-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6-4">
<pre>
"rcdi" : {
  "/jcd": "sha256-7kdCBZqH0nqMSPsmABvsKlHPhZEStgjojhdSJGRr3rk",
  "/jcd/1/2/3": "sha256-jL4f47fF82LuwcrOrSyckA4SWrlElfARHkW6kYo1JdI"
}
</pre><a href="#section-6-4" class="pilcrow">¶</a>
</div>
<p id="section-6-5">The values of each key pair are a digest combined with a string that defines the crypto algorithm used to generate the digest. RCD implementations MUST support the following hash algorithms, "SHA256", "SHA384", and "SHA512". The SHA-256, SHA-384, and SHA-512 are part of the SHA-2 set of cryptographic hash functions defined by the National Institute of Standards and Technologies (NIST). Implementations MAY support additional algorithms, but MUST NOT support known weak algorithms such as MD5 or SHA-1. In the future, the list of algorithms may be re-evaluated based on security best practices. The algorithms are represented in the text by "sha256", "sha384", or "sha512". The character following the algorithm string MUST be a minus character, "-". The subsequent characters are the base64 encoded <span>[<a href="#RFC4648" class="xref">RFC4648</a>]</span> digest of a canonicalized and concatenated string or binary data based on the JSON pointer referenced elements of "rcd" claim or the URI referenced content contained in the claim. The details of the determination of the input string used to determine the digest are defined in the next section.<a href="#section-6-5" class="pilcrow">¶</a></p>
<div id="creation-of-the-rcd-element-digests">
<section id="section-6.1">
        <h3 id="name-creation-of-the-rcd-element">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-creation-of-the-rcd-element" class="section-name selfRef">Creation of the "rcd" element digests</a>
        </h3>
<p id="section-6.1-1">"rcd" claim objects can contain "nam", "apn", "jcd", or "jcl" keys as part of the "rcd" JSON object claim value. This specification defines the use of JSON pointer <span>[<a href="#RFC6901" class="xref">RFC6901</a>]</span> as a mechanism to reference specific "rcd" claim elements.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">In the case of "nam", the only allowed value is a "string". In order to reference the "nam" string value for a digest, the JSON pointer string would be "/nam" and the digest string would be created using only the string pointed to by that "/nam" following the rules of JSON pointer.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<p id="section-6.1-3">In the case of "apn", the only allowed value is a "string".  In order to reference the "apn" string value for a digest, the JSON pointer string would be "/apn" and the digest string would be created using only the string pointed to by that "/apn" following the rules of JSON pointer.<a href="#section-6.1-3" class="pilcrow">¶</a></p>
<p id="section-6.1-4">In the case of "jcd", the value associated is a jCard JSON object, which happens to be a JSON array with sub-arrays. JSON pointer notation uses numeric indexes into elements of arrays, including when those elements are arrays themselves.<a href="#section-6.1-4" class="pilcrow">¶</a></p>
<p id="section-6.1-5">As example, for the following "rcd" claim:<a href="#section-6.1-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.1-6">
<pre>
"rcd": {
  "nam": "Q Branch Spy Gadgets",
  "jcd": ["vcard",
    [ ["version",{},"text","4.0"],
      [“fn",{},"text","Q Branch"],
      [“org",{},"text","MI6;Q Branch Spy Gadgets"],
      ["photo",{},"uri",
        "https://example.com/photos/quartermaster-256x256.png"],
      ["logo",{},"uri",
        "https://example.com/logos/mi6-256x256.jpg"],
      ["logo",{},"uri",
        "https://example.com/logos/mi6-64x64.jpg"]
    ]
  ]
}
</pre><a href="#section-6.1-6" class="pilcrow">¶</a>
</div>
<p id="section-6.1-7">In order to use JSON pointer to refer to the URIs, the following example "rcdi" claim includes a digest for the entire "jcd" array string as well as three additional digests for the URIs, where, as defined in <span>[<a href="#RFC6901" class="xref">RFC6901</a>]</span> zero-based array indexes are used to reference the URI strings.<a href="#section-6.1-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.1-8">
<pre>
"rcdi": {
  "/jcd": "sha256-7kdCBZqH0nqMSPsmABvsKlHPhZEStgjojhdSJGRr3rk",
  "/jcd/1/3/3": "sha256-RojgWwU6xUtI4q82+kHPyHm1JKbm7+663bMvzymhkl4",
  "/jcd/1/4/3": "sha256-jL4f47fF82LuwcrOrSyckA4SWrlElfARHkW6kYo1JdI",
  "/jcd/1/5/3": "sha256-GKNxxqlLRarbyBNh7hc/4lbZAdK6B0kMRf1AMRWPkSo"
  }
}
</pre><a href="#section-6.1-8" class="pilcrow">¶</a>
</div>
<p id="section-6.1-9">For the use of JSON pointer in "jcd" and because array indexes are dependent on the order of the elements in the jCard, the digest for the "/jcd" corresponding to the entire jCard array string MUST be included to avoid any possibility of substitution or insertion attacks that may be possible to avoid integrity detection. Each URI referenced in the jCard array string MUST have a corresponding JSON pointer string key and digest value.<a href="#section-6.1-9" class="pilcrow">¶</a></p>
<p id="section-6.1-10">In the case of the use of a "jcl" URI reference to an external jCard, the procedures are similar to "jcd" with the exception and the minor modification to JSON pointer, where "/jcl" is used to refer to the external jCard array string and any following numeric array indexes added to the "jcl" (e.g. "/jcl/1/2/3") are treated as if the externally referenced jCard was directly part of the overall "rcd" claim JSON object. The following example illustrates a "jcl" version of the above "jcd" example.<a href="#section-6.1-10" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.1-11">
<pre>
"rcd": {
  "nam": "Q Branch Spy Gadgets",
  "jcl": "https://example.com/qbranch.json"
},
"rcdi": {
  "/jcl": "sha256-Gb0lOkj7Z9+plqbOkN32H+YX0Yav3fbioSk7DxQdGZU",
  "/jcl/1/3/3": "sha256-RojgWwU6xUtI4q82+kHPyHm1JKbm7+663bMvzymhkl4",
  "/jcl/1/4/3": "sha256-jL4f47fF82LuwcrOrSyckA4SWrlElfARHkW6kYo1JdI",
  "/jcl/1/5/3": "sha256-GKNxxqlLRarbyBNh7hc/4lbZAdK6B0kMRf1AMRWPkSo"
}
</pre><a href="#section-6.1-11" class="pilcrow">¶</a>
</div>
<div class="alignLeft art-text artwork" id="section-6.1-12">
<pre>
https://example.com/qbranch.json:
["vcard",
  [ ["version",{},"text","4.0"],
    [“fn",{},"text","Q Branch"],
    [“org",{},"text","MI6;Q Branch Spy Gadgets"]
    ["photo",{},"uri",
      "https://example.com/photos/quartermaster-256x256.png"]
    ["logo",{},"uri",
      "https://example.com/logos/mi6-256x256.jpg"]
    ["logo",{},"uri",
      "https://example.com/logos/mi6-64x64.jpg"]
  ]
]
</pre><a href="#section-6.1-12" class="pilcrow">¶</a>
</div>
<p id="section-6.1-13">In order to facilitate proper verification of the digests and whether the "rcd" elements or content referenced by URIs were modified, the input to the digest must be completely deterministic at three points in the process. First, at the certification point where the content is evaluated to conform to the application policy and the JWT Claim Constraints is applied to the certificate containing the digest. Second, when the call is signed at the Authentication Service, there may be a local policy to verify that the provided "rcd" claim corresponds to each digest. Third, when the "rcd" data is verified at the Verification Service, the verification is performed for each digest by constructing the input digest string for the element being verified and referenced by the JSON pointer string.<a href="#section-6.1-13" class="pilcrow">¶</a></p>
<p id="section-6.1-14">The procedure for the creation of each "rcd" element digest string corresponding to a JSON pointer string key is as follows.<a href="#section-6.1-14" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.1-15">
<li id="section-6.1-15.1">The JSON pointer either refers to an element that is a part or whole of a JSON object string or to a string that is a URI referencing an external resource.<a href="#section-6.1-15.1" class="pilcrow">¶</a>
</li>
          <li id="section-6.1-15.2">For a JSON formatted string, serialize the element JSON to remove all white space and line breaks. The procedures of this deterministic JSON serialization are defined in <span>[<a href="#RFC8225" class="xref">RFC8225</a>]</span>, Section 9.  The resulting string MUST be a Base64 encoded <span>[<a href="#RFC4648" class="xref">RFC4648</a>]</span> digest string (for sha256 this should result in approximately 44 characters).<a href="#section-6.1-15.2" class="pilcrow">¶</a>
</li>
          <li id="section-6.1-15.3">For any URI referenced content, the content can either be a string as in jCard JSON objects or binary content. For example, image and audio files contain binary content. If the URI referenced content is JSON formatted, follow the procedures defined in list item 2 above. Either the binary data or string content of the file is used to create a resulting string which MUST be a Base64 encoded <span>[<a href="#RFC4648" class="xref">RFC4648</a>]</span> digest string (for sha256 this should result in approximately 44 characters).<a href="#section-6.1-15.3" class="pilcrow">¶</a>
</li>
        </ol>
</section>
</div>
<div id="jwt-claim-constraints-for-rcd-claims-only">
<section id="section-6.2">
        <h3 id="name-jwt-claim-constraints-for-r">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-jwt-claim-constraints-for-r" class="section-name selfRef">JWT Claim Constraints for "rcd" claims only</a>
        </h3>
<p id="section-6.2-1">For the third mode described in the integrity overview section of this document, where only JWT Claim Constraints for "rcd" claims without an "rcdi" claim is required, the procedure when creating the certificate with the intent to always include an "rcd" claim, to include a JWT Claim Constraints on inclusion of an "rcd" claim with the intended values required to be constrained by the certificate used to sign the PASSporT.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">The "permittedValues" for the "rcd" claim may optionally contain multiple entries, to support the case where the certificate holder is authorized to use different sets of rich call data.<a href="#section-6.2-2" class="pilcrow">¶</a></p>
<p id="section-6.2-3">Only including "permittedValues" for "rcd" (with no "mustInclude") provides the ability to either have no "rcd" claim or only the set of constrained "permittedValues" values for an included "rcd" claim.<a href="#section-6.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="jwt-claim-constraints-usage-for-rcd-and-rcdi-claims">
<section id="section-7">
      <h2 id="name-jwt-claim-constraints-usage">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-jwt-claim-constraints-usage" class="section-name selfRef">JWT Claim Constraints usage for "rcd" and "rcdi" claims</a>
      </h2>
<p id="section-7-1">The integrity overview section of this document describes a fourth mode where both "rcdi" and JWT Claim Constraints is used. The use of this mode implies the signing of an "rcdi" claim is required to be protected by the authoritative certificate creator using JWT Claims Constraints in the certificate. The intension of the use of both of these mechanisms is to constrain the signer to construct the "rcd" and "rcdi" claims with the "rcd" jCard object including reference external content via URI. Once both the contents of the "rcd" claim and any linked content is certified by the party that is authoritative for the certificate being created and the construction of the "rcdi" claim is complete, the "rcdi" claim is linked to the STIR certificate associated with the signature in the PASSporT via JWT Claim Constraints as defined in <span>[<a href="#RFC8226" class="xref">RFC8226</a>]</span> Section 8. It should be recognized that the "rcdi" set of digests is intended to be unique for only a specific combination of "rcd" content and URI referenced external content, and therefore provides a robust integrity mechanism for an authentication service being performed by a non-authoritative party. This would often be associated with the use of delegate certificates <span>[<a href="#I-D.ietf-stir-cert-delegation" class="xref">I-D.ietf-stir-cert-delegation</a>]</span> for the signing of calls by the calling party directly as an example, even though the "authorized party" is not necessarily the subject of a STIR certificate.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">For the case that there should always be both "rcd" and "rcdi" values included in the "rcd" PASSporT, the certificate JWT Claims Constraint MUST include both of the following:<a href="#section-7-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-3.1">a "mustInclude" for the "rcd" claim, which simply constrains the fact that an "rcd" must be included if there is a "rcdi"<a href="#section-7-3.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-7-3.2">a "mustInclude" for the "rcdi" claim and a "permittedValues" equal to the created "rcdi" claim value string.<a href="#section-7-3.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-7-4">Note that optionally the "rcd" claims may be included in the "permittedValues" however it is recognized that this may be redundant with the "rcdi" permittedValues because the "rcdi" digest will imply the content of the "rcd" claims themselves.<a href="#section-7-4" class="pilcrow">¶</a></p>
<p id="section-7-5">The "permittedValues" for the "rcdi" claims may contain multiple entries, to support the case where the certificate holder is authorized to use different sets of rich call data.<a href="#section-7-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="passport-crn-claim-call-reason-defintion-and-usage">
<section id="section-8">
      <h2 id="name-passport-crn-claim-call-rea">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-passport-crn-claim-call-rea" class="section-name selfRef">PASSporT "crn" claim - Call Reason Defintion and Usage</a>
      </h2>
<p id="section-8-1">This specification defines a new JSON Web Token claim for "crn", Call Reason, the value of which is a single string or object that can contains information as defined in <span>[<a href="#I-D.ietf-sipcore-callinfo-rcd" class="xref">I-D.ietf-sipcore-callinfo-rcd</a>]</span> corresponding to the "reason" parameter for the Call-Info header. This claim is optional.<a href="#section-8-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8-2">
<pre>
Example "crn" claim with "rcd":
"rcd": { "nam": "James Bond",
         "jcl": "https://example.org/james_bond.json"},
"crn" : "For your ears only"
</pre><a href="#section-8-2" class="pilcrow">¶</a>
</div>
<div id="jwt-constraint-for-crn-claim">
<section id="section-8.1">
        <h3 id="name-jwt-constraint-for-crn-clai">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-jwt-constraint-for-crn-clai" class="section-name selfRef">JWT Constraint for "crn" claim</a>
        </h3>
<p id="section-8.1-1">The integrity of the "crn" claim can optionally be protected by the authoritative certificate creator using JWT Constraints in the certificate. If the intent of the issuer of the certificate is to always including a call reason, a "mustInclude" for the "crn" claim indicates that a "crn" claim must be present. If the issuer of the certificate wants to constrain the contents of "crn", then it may set "permittedValues" for "crn" in the certificate.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="rich-call-data-claims-usage-rules">
<section id="section-9">
      <h2 id="name-rich-call-data-claims-usage">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-rich-call-data-claims-usage" class="section-name selfRef">Rich Call Data Claims Usage Rules</a>
      </h2>
<p id="section-9-1">Either or both the "rcd" or "crn" claims may appear in any PASSporT claims object as optional elements. The creator of a PASSporT MAY also add a "ppt" value of "rcd" to the header of a PASSporT as well, in which case the PASSporT claims MUST contain either a "rcd" or "crn" claim, and any entities verifying the PASSporT object are required to understand the "ppt" extension in order to process the PASSporT in question. An example PASSporT header with the "ppt" included is shown as follows:<a href="#section-9-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-9-2">
<pre>
{ "typ":"passport",
  "ppt":"rcd",
  "alg":"ES256",
  "x5u":"https://www.example.com/cert.cer" }
</pre><a href="#section-9-2" class="pilcrow">¶</a>
</div>
<p id="section-9-3">The PASSporT claims object contains the "rcd" key with its corresponding value. The value of "rcd" is an array of JSON objects, of which one, the "nam" object, is mandatory. The key syntax of "nam" follows the display-name ABNF given in <span>[<a href="#RFC3261" class="xref">RFC3261</a>]</span>.<a href="#section-9-3" class="pilcrow">¶</a></p>
<p id="section-9-4">After the header and claims PASSporT objects have been constructed, their signature is generated normally per the guidance in <span>[<a href="#RFC8225" class="xref">RFC8225</a>]</span>.<a href="#section-9-4" class="pilcrow">¶</a></p>
<div id="verification-rules">
<section id="section-9.1">
        <h3 id="name-verification-rules">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-verification-rules" class="section-name selfRef">Verification rules</a>
        </h3>
<p id="section-9.1-1">A PASSporT that uses claims defined in this specification, in order to have a successful verification outcome, MUST conform to the following:<a href="#section-9.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.1-2.1">abide by all rules set forth in the proper construction of the claims<a href="#section-9.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-9.1-2.2">abide by JWT Claims Constraint rules defined in <span>[<a href="#RFC8226" class="xref">RFC8226</a>]</span> Section 8 or extended in <span>[<a href="#I-D.ietf-stir-enhance-rfc8226" class="xref">I-D.ietf-stir-enhance-rfc8226</a>]</span> if present in the certificate used to sign the PASSporT<a href="#section-9.1-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-9.1-2.3">pass integrity verification using "rcdi" if present.<a href="#section-9.1-2.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-9.1-3">Consistent with the verification rules of PASSporTs more generally <span>[<a href="#RFC8225" class="xref">RFC8225</a>]</span>, if any of the above criteria is not met, the PASSporT verification should be considered a failed verification for all claims in the PASSporT.<a href="#section-9.1-3" class="pilcrow">¶</a></p>
<p id="section-9.1-4">In some middle box scenarios, a relying party may not have the need to validate content that is referenced by URIs (e.g. only wanting to validate base PASSporT info like "orig" and "dest" or other "rcd" info like "nam" or "apn"). In these scenarios, this proceedure while not considered a full verification, can be performed without verifying the full integrity checks of URI referenced content.<a href="#section-9.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="example-rcd-passports">
<section id="section-9.2">
        <h3 id="name-example-rcd-passports">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-example-rcd-passports" class="section-name selfRef">Example "rcd" PASSporTs</a>
        </h3>
<p id="section-9.2-1">An example of a "nam" only PASSporT claims object is shown next (with line breaks for readability only).<a href="#section-9.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-9.2-2">
<pre>
{  "orig":{"tn":"12025551000"},
   "dest":{"tn":["12025551001"]},
   "iat":1443208345,
   "rcd":{"nam":"James Bond"} }
</pre><a href="#section-9.2-2" class="pilcrow">¶</a>
</div>
<p id="section-9.2-3">An example of a "nam" and "apn" only PASSporT claims object is shown next (with line breaks for readability only).<a href="#section-9.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-9.2-4">
<pre>
{  "orig":{"tn":"12025551000"},
   "dest":{"tn":["12155551001"]},
   "iat":1443208345,
   "rcd":{
     "apn":"12025559990",
     "nam":"Her Majesty's Secret Service" } }
</pre><a href="#section-9.2-4" class="pilcrow">¶</a>
</div>
<p id="section-9.2-5">An example of a "nam" only PASSporT claims object with an "rcdi" claim is shown next (with line breaks for readability only).<a href="#section-9.2-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-9.2-6">
<pre>
{  "orig":{"tn":"12025551000"},
   "dest":{"tn":["12025551001"]},
   "iat":1443208345,
   "rcd":{"nam":"James Bond"},
   "rcdi":{"/nam": "sha256-uDtvpG1xNw+MK0XEOh+2UNQ94MQJ5d2ftgmHxsjKeMw"}
}
</pre><a href="#section-9.2-6" class="pilcrow">¶</a>
</div>
<p id="section-9.2-7">An example of a "rcd" claims object that includes the "jcd" and also contains a URI which requires the inclusion of an "rcdi" claim.<a href="#section-9.2-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-9.2-8">
<pre>
{
  "orig": { "tn": "12025551000"},
  "dest": { "tn": ["12155551001"]},
  "iat": 1443208345,
  "rcd": {
    "nam": "Q Branch Spy Gadgets",
    "jcd": ["vcard",
    [ ["version",{},"text","4.0"],
      ["fn",{},"text","Q Branch"],
      ["org",{},"text","MI6;Q Branch Spy Gadgets"],
      ["photo",{},"uri","https://example.com/photos/q-256x256.png"],
      ["logo",{},"uri","https://example.com/logos/mi6-256x256.jpg"],
      ["logo",{},"uri","https://example.com/logos/mi6-64x64.jpg"]
    ] ]
  },
  "crn": "Rendezvous for Little Nellie",
  "rcdi": {
    "/nam": "sha256-sM275lTgzCte+LHOKHtU4SxG8shlOo6OS4ot8IJQImY",
    "/jcd": "sha256-7kdCBZqH0nqMSPsmABvsKlHPhZEStgjojhdSJGRr3rk",
    "/jcd/1/3/3": "sha256-RojgWwU6xUtI4q82+kHPyHm1JKbm7+663bMvzymhkl4",
    "/jcd/1/4/3": "sha256-jL4f47fF82LuwcrOrSyckA4SWrlElfARHkW6kYo1JdI",
    "/jcd/1/5/3": "sha256-GKNxxqlLRarbyBNh7hc/4lbZAdK6B0kMRf1AMRWPkSo"
  }
}
</pre><a href="#section-9.2-8" class="pilcrow">¶</a>
</div>
<p id="section-9.2-9">In an example PASSporT, where a jCard is linked via HTTPS URL using "jcl", a jCard file served at a particular URL.<a href="#section-9.2-9" class="pilcrow">¶</a></p>
<p id="section-9.2-10">An example jCard JSON file is shown as follows:<a href="#section-9.2-10" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-9.2-11">
<pre>
https://example.com/qbranch.json:
["vcard",
  [ ["version",{},"text","4.0"],
    ["fn",{},"text","Q Branch"],
    ["org",{},"text","MI6;Q Branch Spy Gadgets"],
    ["photo",{},"uri","https://example.com/photos/q-256x256.png"],
    ["logo",{},"uri","https://example.com/logos/mi6-256x256.jpg"],
    ["logo",{},"uri","https://example.com/logos/mi6-64x64.jpg"]
  ]
]
</pre><a href="#section-9.2-11" class="pilcrow">¶</a>
</div>
<p id="section-9.2-12">If that jCard is hosted at the example address of "https://example.com/qbranch.json", the corresponding PASSporT claims object would be as follows:<a href="#section-9.2-12" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-9.2-13">
<pre>
{
  "orig": {"tn": "12025551000"},
  "dest": {"tn": ["12155551001"]},
  "iat": 1443208345,
  "rcd": {
    "nam": "Q Branch Spy Gadgets",
    "jcl": "https://example.com/qbranch.json"
  },
  "crn": "Rendezvous for Little Nellie",
  "rcdi": {
    "/nam": "sha256-Gb0lOkj7Z9+plqbOkN32H+YX0Yav3fbioSk7DxQdGZU",
    "/jcl": "sha256-Gb0lOkj7Z9+plqbOkN32H+YX0Yav3fbioSk7DxQdGZU",
    "/jcl/1/3/3": "sha256-RojgWwU6xUtI4q82+kHPyHm1JKbm7+663bMvzymhkl4",
    "/jcl/1/4/3": "sha256-jL4f47fF82LuwcrOrSyckA4SWrlElfARHkW6kYo1JdI",
    "/jcl/1/5/3": "sha256-GKNxxqlLRarbyBNh7hc/4lbZAdK6B0kMRf1AMRWPkSo"
  }
}
</pre><a href="#section-9.2-13" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="compact-form-of-rcd-passport">
<section id="section-10">
      <h2 id="name-compact-form-of-rcd-passpor">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-compact-form-of-rcd-passpor" class="section-name selfRef">Compact form of "rcd" PASSporT</a>
      </h2>
<div id="compact-form-of-the-rcd-passport-claim">
<section id="section-10.1">
        <h3 id="name-compact-form-of-the-rcd-pas">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-compact-form-of-the-rcd-pas" class="section-name selfRef">Compact form of the "rcd" PASSporT claim</a>
        </h3>
<p id="section-10.1-1">Compact form of an "rcd" PASSporT claim has some restrictions but mainly follows standard PASSporT compact form procedures. For re-construction of the "nam" claim the string for the display-name in the From header field. For re-construction of the "jcl", the Call-Info header as with purpose "jcard" defined in <span>[<a href="#I-D.ietf-sipcore-callinfo-rcd" class="xref">I-D.ietf-sipcore-callinfo-rcd</a>]</span> MUST be used. "jcd" claim MAY NOT be used as part of compact form.<a href="#section-10.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="compact-form-of-the-rcdi-passport-claim">
<section id="section-10.2">
        <h3 id="name-compact-form-of-the-rcdi-pa">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-compact-form-of-the-rcdi-pa" class="section-name selfRef">Compact form of the "rcdi" PASSporT claim</a>
        </h3>
<p id="section-10.2-1">Compact form of an "rcdi" PASSporT claim is not supported, so if "rcdi" is required compact form MUST NOT be used.<a href="#section-10.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="compact-form-of-the-crn-passport-claim">
<section id="section-10.3">
        <h3 id="name-compact-form-of-the-crn-pas">
<a href="#section-10.3" class="section-number selfRef">10.3. </a><a href="#name-compact-form-of-the-crn-pas" class="section-name selfRef">Compact form of the "crn" PASSporT claim</a>
        </h3>
<p id="section-10.3-1">Compact form of a "crn" PASSporT claim shall be re-constructed using the "call-reason" parameter of a Call-Info header as defined by <span>[<a href="#I-D.ietf-sipcore-callinfo-rcd" class="xref">I-D.ietf-sipcore-callinfo-rcd</a>]</span>.<a href="#section-10.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="extend">
<section id="section-11">
      <h2 id="name-further-information-associa">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-further-information-associa" class="section-name selfRef">Further Information Associated with Callers</a>
      </h2>
<p id="section-11-1">Beyond naming information and the information that can be contained in a jCard <span>[<a href="#RFC7095" class="xref">RFC7095</a>]</span> object, there may be additional human-readable information about the calling party that should be rendered to the end user in order to help the called party decide whether or not to pick up the phone. This is not limited to information about the caller, but includes information about the call itself, which may derive from analytics that determine based on call patterns or similar data if the call is likely to be one the called party wants to receive. Such data could include:<a href="#section-11-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11-2.1">information related to the location of the caller, or<a href="#section-11-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-11-2.2">any organizations or institutions that the caller is associated with, or even categories of institutions (is this a government agency, or a bank, or what have you), or<a href="#section-11-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-11-2.3">hyperlinks to images, such as logos or pictures of faces, or to similar external profile information, or<a href="#section-11-2.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-11-2.4">information processed by an application before rendering it to a user, like social networking data that shows that an unknown caller is a friend-of-a-friend, or reputation scores derived from crowdsourcing, or confidence scores based on broader analytics about the caller and callee.<a href="#section-11-2.4" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-11-3">All of these data elements would benefit from the secure attestations provided by the STIR and PASSporT frameworks. A new IANA registry has been defined to hold potential values of the "rcd" array; see <a href="#rcdtypes" class="xref">Section 17.3</a>. Specific extensions to the "rcd" PASSporT claim are left for future specification.<a href="#section-11-3" class="pilcrow">¶</a></p>
<p id="section-11-4">There is a few ways RCD can be extended in the future, jCard is an extensible object and the key/values in the RCD claim object can also be extended. General guidance for future extensibility that were followed by the authors is that jCard generally should refer to data that references the caller as an individual or entity, where other claims, such as "crn" refer to data regarding the specific call. There may be other considerations discovered in the future, but this logical grouping of data to the extent possible should be followed for future extensibility.<a href="#section-11-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="parties">
<section id="section-12">
      <h2 id="name-third-party-uses">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-third-party-uses" class="section-name selfRef">Third-Party Uses</a>
      </h2>
<p id="section-12-1">While rich data about the call can be provided by an originating authentication service, an intermediary in the call path could also acquire rich call data by querying a third-party service. Such a service effectively acts as a STIR Authentication Service, generating its own PASSporT, and that PASSporT could be attached to a SIP call by either the originating or terminating side. This third-party PASSporT attests information about the calling number, rather than the call or caller itself, and as such its RCD MUST NOT be used when a call lacks a first-party PASSporT that assures verification services that the calling party number is not spoofed. It is intended to be used in cases when the originating side does not supply a display-name for the caller, so instead some entity in the call path invokes a third-party service to provide rich caller data for a call.<a href="#section-12-1" class="pilcrow">¶</a></p>
<p id="section-12-2">In telephone operations today, a third-party information service is commonly queried with the calling party's number in order to learn the name of the calling party, and potentially other helpful information could also be passed over that interface. The value of using a PASSporT to convey this information from third parties lies largely in the preservation of the third party's signature over the data, and the potential for the PASSporT to be conveyed from intermediaries to endpoint devices. Effectively, these use cases form a sub-case of out-of-band <span>[<a href="#I-D.ietf-stir-oob" class="xref">I-D.ietf-stir-oob</a>]</span> use cases. The manner in which third-party services are discovered is outside the scope of this document.<a href="#section-12-2" class="pilcrow">¶</a></p>
<p id="section-12-3">An intermediary use case might look as follows: a SIP INVITE carries a display name in its From header field value and an initial PASSporT object without the "rcd" claim. When a terminating verification service implemented at a SIP proxy server receives this request, and determines that the signature is valid, it might query a third-party service that maps telephone numbers to calling party names. Upon receiving the PASSport in a response from that third-party service, the terminating side could add a new Identity header field to the request for the "rcd" PASSporT object provided by the third-party service. It would then forward the INVITE to the terminating user agent. If the display name in the "rcd" PASSporT object matches the display name in the INVITE, then the name would presumably be rendered to the end user by the terminating user agent.<a href="#section-12-3" class="pilcrow">¶</a></p>
<p id="section-12-4">A very similar flow could be followed by an intermediary closer to the origination of the call. Presumably such a service could be implemented at an originating network in order to decouple the systems that sign for calling party numbers from the systems that provide rich data about calls.<a href="#section-12-4" class="pilcrow">¶</a></p>
<p id="section-12-5">In an alternative use case, the terminating user agent might query a third-party service. In this case, no new Identity header field would be generated, though the terminating user agent might receive a PASSporT object in return from the third-party service, and use the "rcd" field in the object as a calling name to render to users while alerting.<a href="#section-12-5" class="pilcrow">¶</a></p>
<p id="section-12-6">While in the traditional telephone network, the business relationship between calling customers and their telephone service providers is the ultimate root of information about a calling party's name, some other forms of data like crowdsourced reputation scores might derive from third parties. When those elements are present, they MUST be in a third-party "rcd" PASSporT using "iss" claim described in the next section.<a href="#section-12-6" class="pilcrow">¶</a></p>
<div id="thirdsign">
<section id="section-12.1">
        <h3 id="name-signing-as-a-third-party">
<a href="#section-12.1" class="section-number selfRef">12.1. </a><a href="#name-signing-as-a-third-party" class="section-name selfRef">Signing as a Third Party</a>
        </h3>
<p id="section-12.1-1">A third-party PASSporT contains an "iss" element to distinguish its PASSporTs from first-party PASSporTs. Third-party "rcd" PASSporTs are signed with credentials that do not have authority over the identity that appears in the "orig" element of the PASSporT claims. The presence of "iss" signifies that a different category of credential is being used to sign a PASSporT than the <span>[<a href="#RFC8226" class="xref">RFC8226</a>]</span> certificates used to sign STIR calls; it is instead a certificate that identifies the source of the "rcd" data. How those credentials are issued and managed is outside the scope of this specification; the value of "iss" however MUST reflect the Subject of the certificate used to sign a third-party PASSporT. The explicit mechanism for reflecting the subject field of the certificate is out of scope of this document and left to the certificate governance policies that define how to map the "iss" value in the PASSporT to the subject field in the certificate. Relying parties in STIR have always been left to make their own authorization decisions about whether to trust the signers of PASSporTs, and in the third-party case, where an entity has explicitly queried a service to acquire the PASSporT object, it may be some external trust or business relationship that induces the relying party to trust a PASSporT.<a href="#section-12.1-1" class="pilcrow">¶</a></p>
<p id="section-12.1-2">An example of a Third Party issued PASSporT claims object is as follows.<a href="#section-12.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-12.1-3">
<pre>
{  "orig":{"tn":"12025551000"},
   "dest":{"tn":["12025551001"]},
   "iat":1443208345,
   "iss":"Zorin Industries",
   "rcd":{"nam":"James St. John Smythe"} }
</pre><a href="#section-12.1-3" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="loa">
<section id="section-13">
      <h2 id="name-levels-of-assurance">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-levels-of-assurance" class="section-name selfRef">Levels of Assurance</a>
      </h2>
<p id="section-13-1">As "rcd" can be provided by either first or third parties, relying parties could benefit from an additional claim that indicates the relationship of the attesting party to the caller. Even in first party cases, this admits of some complexity: the Communications Service Provider (CSP) to which a number was assigned might in turn delegate the number to a reseller, who would then sell the number to an enterprise, in which case the CSP might have little insight into the caller's name. In third party cases, a caller's name could derive from any number of data sources, on a spectrum between public data scraped from web searches to a direct business relationship to the caller. As multiple PASSporTs can be associated with the same call, potentially a verification service could receive attestations of the caller name from multiple sources, which have different levels of granularity or accuracy. Therefore, third-party PASSporTs that carry "rcd" data MUST also carry an indication of the relationship of the generator of the PASSporT to the caller in the form of the "iss" claim. As stated in the previous section, the use of "iss" MUST reflect the subject field of the certificate used to sign a third-party PASSporT to represent that relationship.<a href="#section-13-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="use">
<section id="section-14">
      <h2 id="name-using-rcd-in-sip">
<a href="#section-14" class="section-number selfRef">14. </a><a href="#name-using-rcd-in-sip" class="section-name selfRef">Using "rcd" in SIP</a>
      </h2>
<p id="section-14-1">This section specifies SIP-specific usage for the "rcd" claim in PASSporT, and in the SIP Identity header field value. Other using protocols of PASSporT may define their own usages for the "rcd" claim.<a href="#section-14-1" class="pilcrow">¶</a></p>
<div id="authentication-service-behavior">
<section id="section-14.1">
        <h3 id="name-authentication-service-beha">
<a href="#section-14.1" class="section-number selfRef">14.1. </a><a href="#name-authentication-service-beha" class="section-name selfRef">Authentication Service Behavior</a>
        </h3>
<p id="section-14.1-1">An authentication service creating a PASSporT containing a "rcd" claim MAY include a "ppt" for "rcd" or not. Third-party authentication services following the behavior in <a href="#thirdsign" class="xref">Section 12.1</a> MUST include a "ppt" of "rcd". If "ppt" does contain a "rcd", then any SIP authentication services MUST add a "ppt" parameter to the Identity header containing that PASSporT with a value of "rcd". The resulting Identity header might look as follows:<a href="#section-14.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-14.1-2">
<pre>
Identity: sv5CTo05KqpSmtHt3dcEiO/1CWTSZtnG3iV+1nmurLXV/HmtyNS7Ltrg9
       dlxkWzoeU7d7OV8HweTTDobV3itTmgPwCFjaEmMyEI3d7SyN21yNDo2ER/Ovgt
       w0Lu5csIppPqOg1uXndzHbG7mR6Rl9BnUhHufVRbp51Mn3w0gfUs=;
       info=&lt;https://biloxi.example.org/biloxi.cer&gt;;alg=ES256;
       ppt="rcd"
</pre><a href="#section-14.1-2" class="pilcrow">¶</a>
</div>
<p id="section-14.1-3">This specification assumes that by default, a SIP authentication service derives the value of "rcd", specifically only for the "nam" key value, from the display-name component of the From header field value of the request, alternatively for some calls this may come from the P-Asserted-ID header. It is however a matter of authentication service policy to decide how it populates the value of "nam" key, which MAY also derive from other fields in the request, from customer profile data, or from access to external services. If the authentication service generates a "rcd" claim containing "nam" with a value that is not equivalent to the From header field display-name value, it MUST use the full form of the PASSporT object in SIP.<a href="#section-14.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="verification-service-behavior">
<section id="section-14.2">
        <h3 id="name-verification-service-behavi">
<a href="#section-14.2" class="section-number selfRef">14.2. </a><a href="#name-verification-service-behavi" class="section-name selfRef">Verification Service Behavior</a>
        </h3>
<p id="section-14.2-1"><span>[<a href="#RFC8224" class="xref">RFC8224</a>]</span> Section 6.2 Step 5 requires that specifications defining "ppt" values describe any additional verifier behavior. The behavior specified for the "ppt" values of "rcd" is as follows. If the PASSporT is in compact form, then the verification service SHOULD extract the display-name from the From header field value, if any, and use that as the value for the "nam" key when it recomputes the header and claims of the PASSporT object. Additionally, if there exists a Call-Info header field as defined in <span>[<a href="#I-D.ietf-sipcore-callinfo-rcd" class="xref">I-D.ietf-sipcore-callinfo-rcd</a>]</span>, the "jcard" value can be derived to determine the "jcd" key when it recomputes the header and claims of the PASSporT object. If the signature validates over the recomputed object, then the verification should be considered successful.<a href="#section-14.2-1" class="pilcrow">¶</a></p>
<p id="section-14.2-2">However, if the PASSport is in full form with a "ppt" value of "rcd", then the verification service MUST extract the value associated with the "rcd" "nam" key in the object. If the signature validates, then the verification service can use the value of the "rcd" "nam" key as the display name of calling party, which would in turn be rendered to alerted users or otherwise leveraged in accordance with local policy. This allows SIP networks that convey the display name through a field other than the From header field to interoperate with this specification. Similarly, the "jcd" or linked "jcl" jcard information and "crn" can be optionally, based on local policy for devices that support it, used to populate a Call-Info header field following the format of <span>[<a href="#I-D.ietf-sipcore-callinfo-rcd" class="xref">I-D.ietf-sipcore-callinfo-rcd</a>]</span>.<a href="#section-14.2-2" class="pilcrow">¶</a></p>
<p id="section-14.2-3">The third-party "rcd" PASSporT cases presents some new challenges, as an attacker could attempt to cut-and-paste such a third-party PASSporT into a SIP request in an effort to get the terminating user agent to render the display name or confidence values it contains to a call that should have no such assurance. A third-party "rcd" PASSporT provides no assurance that the calling party number has not been spoofed: if it is carried in a SIP request, for example, then some other PASSporT in another Identity header field value would have to carry a PASSporT attesting that. A verification service MUST determine that the calling party number shown in the "orig" of the "rcd" PASSporT corresponds to the calling party number of the call it has received, and that the "iat" field of the "rcd" PASSporT is within the date interval that the verification service would ordinarily accept for a PASSporT.<a href="#section-14.2-3" class="pilcrow">¶</a></p>
<p id="section-14.2-4">Verification services may alter their authorization policies for the credentials accepted to sign PASSporTs when third parties generate PASSporT objects, per <a href="#thirdsign" class="xref">Section 12.1</a>. This may include accepting a valid signature over a PASSporT even if it is signed with a credential that does not attest authority over the identity in the "orig" claim of the PASSporT, provided that the verification service has some other reason to trust the signer. No further guidance on verification service authorization policy is given here.<a href="#section-14.2-4" class="pilcrow">¶</a></p>
<p id="section-14.2-5">The behavior of a SIP UAS upon receiving an INVITE containing a PASSporT object with a "rcd" claim largely remains a matter of implementation policy. In most cases, implementations would render this calling party name information to the user while alerting. Any user interface additions to express confidence in the veracity of this information are outside the scope of this specification.<a href="#section-14.2-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="using-rcd-as-additional-claims-to-other-passport-extensions">
<section id="section-15">
      <h2 id="name-using-rcd-as-additional-cla">
<a href="#section-15" class="section-number selfRef">15. </a><a href="#name-using-rcd-as-additional-cla" class="section-name selfRef">Using "rcd" as additional claims to other PASSporT extensions</a>
      </h2>
<p id="section-15-1">Rich Call Data, including calling name information, for example, is often data that is additive data to the personal communications information defined in the core PASSporT data required to support the security properties defined in <span>[<a href="#RFC8225" class="xref">RFC8225</a>]</span>. For cases where the entity that is originating the personal communications and additionally is supporting the authentication service and also is the authority of the Rich Call Data, rather than creating multiple identity headers with multiple PASSporT extensions or defining multiple combinations and permutations of PASSporT extension definitions, the authentication service can alternatively directly add the "rcd" claims to the PASSporT it is creating, whether it is constructed with a PASSporT extension or not.<a href="#section-15-1" class="pilcrow">¶</a></p>
<p id="section-15-2">Note: There is one very important caveat to this capability, because generally if there is URI referenced content in an "rcd" PASSporT there is often the requirement to use "rcdi" and JWT Claims Constraints.  So, it is important for the user of this specification to recognize that the certificates used must include the necessary JWT Claims Constraints for proper integrity and security of the values in the "rcd" claim incorporated into PASSporTs that are not "rcd".<a href="#section-15-2" class="pilcrow">¶</a></p>
<div id="procedures-for-applying-rcd-as-claims-only">
<section id="section-15.1">
        <h3 id="name-procedures-for-applying-rcd">
<a href="#section-15.1" class="section-number selfRef">15.1. </a><a href="#name-procedures-for-applying-rcd" class="section-name selfRef">Procedures for applying "rcd" as claims only</a>
        </h3>
<p id="section-15.1-1">For a given PASSporT using some other extension than "rcd", the Authentication Service MAY additionally include the "rcd" claim as defined in this document. This would result in a set of claims that correspond to the original intended extension with the addition of the "rcd" claim.<a href="#section-15.1-1" class="pilcrow">¶</a></p>
<p id="section-15.1-2">The Verification service that receives the PASSporT, if it supports this specification and chooses to, should interpret the "rcd" claim as simply just an additional claim intended to deliver and/or validate delivered Rich Call Data.<a href="#section-15.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="example-for-applying-rcd-as-claims-only">
<section id="section-15.2">
        <h3 id="name-example-for-applying-rcd-as">
<a href="#section-15.2" class="section-number selfRef">15.2. </a><a href="#name-example-for-applying-rcd-as" class="section-name selfRef">Example for applying "rcd" as claims only</a>
        </h3>
<p id="section-15.2-1">In the case of <span>[<a href="#RFC8588" class="xref">RFC8588</a>]</span> which is the PASSporT extension supporting the SHAKEN specification <span>[<a href="#ATIS-1000074" class="xref">ATIS-1000074</a>]</span>, a common case for an Authentication service to co-exist in a CSP network along with the authority over the calling name used for the call. Rather than require two identity headers, the CSP Authentication Service can apply both the SHAKEN PASSporT claims and extension and simply add the "rcd" required claims defined in this document.<a href="#section-15.2-1" class="pilcrow">¶</a></p>
<p id="section-15.2-2">For example, the PASSporT claims for the "shaken" PASSporT with "rcd" claims would be as follows:<a href="#section-15.2-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-15.2-3">
<pre>
Protected Header
{
   "alg":"ES256",
   "typ":"passport",
   “ppt”:”shaken”,
   "x5u":"https://cert.example.org/passport.cer"
}
Payload
{
   “attest”:”A”,
   "dest":{“tn”:["12025551001"]},
   "iat":1443208345,
   "orig":{“tn”:"12025551000"},
   “origid”:”123e4567-e89b-12d3-a456-426655440000”,
   "rcd":{"nam":"James Bond"}
}
</pre><a href="#section-15.2-3" class="pilcrow">¶</a>
</div>
<p id="section-15.2-4">A Verification Service that supports "rcd" and "shaken" PASSporT extensions is able to receive the above PASSporT and interpret both the "shaken" claims as well as the "rcd" defined claim.<a href="#section-15.2-4" class="pilcrow">¶</a></p>
<p id="section-15.2-5">If the Verification Service only understands the "shaken" extension claims but doesn't support "rcd", the "rcd" is ignored and disregarded.<a href="#section-15.2-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="acknowledgements">
<section id="section-16">
      <h2 id="name-acknowledgements-3">
<a href="#section-16" class="section-number selfRef">16. </a><a href="#name-acknowledgements-3" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="section-16-1">We would like to thank David Hancock, Robert Sparks, Russ Housley, Eric Burger, Alec Fenichel, Ben Campbell, Jack Rickard for helpful suggestions, review, and comments.<a href="#section-16-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="IANA">
<section id="section-17">
      <h2 id="name-iana-considerations-3">
<a href="#section-17" class="section-number selfRef">17. </a><a href="#name-iana-considerations-3" class="section-name selfRef">IANA Considerations</a>
      </h2>
<div id="json-web-token-claim">
<section id="section-17.1">
        <h3 id="name-json-web-token-claim">
<a href="#section-17.1" class="section-number selfRef">17.1. </a><a href="#name-json-web-token-claim" class="section-name selfRef">JSON Web Token Claim</a>
        </h3>
<p id="section-17.1-1">This specification requests that the IANA add three new claims to the JSON Web Token Claims registry as defined in <span>[<a href="#RFC7519" class="xref">RFC7519</a>]</span>.<a href="#section-17.1-1" class="pilcrow">¶</a></p>
<p id="section-17.1-2">Claim Name: "rcd"<a href="#section-17.1-2" class="pilcrow">¶</a></p>
<p id="section-17.1-3">Claim Description: Rich Call Data Information<a href="#section-17.1-3" class="pilcrow">¶</a></p>
<p id="section-17.1-4">Change Controller: IESG<a href="#section-17.1-4" class="pilcrow">¶</a></p>
<p id="section-17.1-5">Specification Document(s): [RFCThis]<a href="#section-17.1-5" class="pilcrow">¶</a></p>
<p id="section-17.1-6">Claim Name: "rcdi"<a href="#section-17.1-6" class="pilcrow">¶</a></p>
<p id="section-17.1-7">Claim Description: Rich Call Data Integrity Information<a href="#section-17.1-7" class="pilcrow">¶</a></p>
<p id="section-17.1-8">Change Controller: IESG<a href="#section-17.1-8" class="pilcrow">¶</a></p>
<p id="section-17.1-9">Specification Document(s): [RFCThis]<a href="#section-17.1-9" class="pilcrow">¶</a></p>
<p id="section-17.1-10">Claim Name: "crn"<a href="#section-17.1-10" class="pilcrow">¶</a></p>
<p id="section-17.1-11">Claim Description: Call Reason<a href="#section-17.1-11" class="pilcrow">¶</a></p>
<p id="section-17.1-12">Change Controller: IESG<a href="#section-17.1-12" class="pilcrow">¶</a></p>
<p id="section-17.1-13">Specification Document(s): [RFCThis]<a href="#section-17.1-13" class="pilcrow">¶</a></p>
</section>
</div>
<div id="passport-types">
<section id="section-17.2">
        <h3 id="name-passport-types">
<a href="#section-17.2" class="section-number selfRef">17.2. </a><a href="#name-passport-types" class="section-name selfRef">PASSporT Types</a>
        </h3>
<p id="section-17.2-1">This specification requests that the IANA add a new entry to the PASSporT Types registry for the type "rcd" which is specified in [RFCThis].<a href="#section-17.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="rcdtypes">
<section id="section-17.3">
        <h3 id="name-passport-rcd-types">
<a href="#section-17.3" class="section-number selfRef">17.3. </a><a href="#name-passport-rcd-types" class="section-name selfRef">PASSporT RCD Types</a>
        </h3>
<p id="section-17.3-1">This document requests that the IANA create a new registry for PASSporT RCD types. Registration of new PASSporT RCD types shall be under the Specification Required policy.<a href="#section-17.3-1" class="pilcrow">¶</a></p>
<p id="section-17.3-2">This registry is to be initially populated with four values, "nam", "apn", "jcd", and "jcl", which are specified in [RFCThis].<a href="#section-17.3-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="Security">
<section id="section-18">
      <h2 id="name-security-considerations-3">
<a href="#section-18" class="section-number selfRef">18. </a><a href="#name-security-considerations-3" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-18-1">Whether its identities, alternate identities, images, logos, physical addresses, all of the information contained in a RCD PASSporT must follow some form of vetting in which the authoritative entity or user of the information being signed MUST follow an applicable policy of the eco-system using RCD. This can be of many forms, depending on the setup and constraints of the eco-system so is therefore out-of-scope of this document. However, the general chain of trust that signers of RCD PASSporT are either directly authoritative or have been delegated authority through certificates using JWT Claim Constraints and integrity mechanisms defined in this and related documents is critical to maintain the integrity of the eco-system utilizing this and other STIR related specifications.<a href="#section-18-1" class="pilcrow">¶</a></p>
<p id="section-18-2">Revealing information such as the name, location, and affiliation of a person necessarily entails certain privacy risks. Baseline PASSporT has no particular confidentiality requirement, as the information it signs over in a using protocol like SIP is all information that SIP carries in the clear anyway. Transport-level security can hide those SIP fields from eavesdroppers, and the same confidentiality mechanisms would protect any PASSporT(s) carried in SIP.<a href="#section-18-2" class="pilcrow">¶</a></p>
<p id="section-18-3">Since computation of "rcdi" digests for URIs requires the loading of referenced content, it would be best practice to validate that content at the creation of the "rcdi" or corresponding JWT claim constraint value by checking for content that may cause issues for verification services or that doesn't follow the behavior defined in this document, e.g. unreasonably sized data, the inclusion of recursive URI references, etc. Along the same lines, the verification service should also use precautionary best practices to avoid attacks when accessing URI linked content.<a href="#section-18-3" class="pilcrow">¶</a></p>
<div id="the-use-of-jwt-claim-constraints-in-delegate-certificates-to-exclude-unauthorized-claims">
<section id="section-18.1">
        <h3 id="name-the-use-of-jwt-claim-constr">
<a href="#section-18.1" class="section-number selfRef">18.1. </a><a href="#name-the-use-of-jwt-claim-constr" class="section-name selfRef">The use of JWT Claim Constraints in delegate certificates to exclude unauthorized claims</a>
        </h3>
<p id="section-18.1-1">While this can apply to any PASSporT that is signed with a STIR Delegate Certificates <span>[<a href="#I-D.ietf-stir-cert-delegation" class="xref">I-D.ietf-stir-cert-delegation</a>]</span>, it is important to note that when constraining PASSporTs to include specific claims or contents of claims, it is also important to consider potential attacks by non-authorized signers that may include other potential PASSporT claims that weren't originally vetted by the authorized entity providing the delegate certificate. The use of JWT claims constraints as defined in <span>[<a href="#I-D.ietf-stir-enhance-rfc8226" class="xref">I-D.ietf-stir-enhance-rfc8226</a>]</span> for preventing the ability to include claims beyond the claims defined in this document may need to be considered.<a href="#section-18.1-1" class="pilcrow">¶</a></p>
<p id="section-18.1-2">Certificate issuers SHOULD NOT include an entry in mustExclude for the "rcdi" claim for a certificate that will be used with the PASSporT Extension for Rich Call Data defined in this document. Excluding this claim would prevent the integrity protection mechanism from working properly.<a href="#section-18.1-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<section id="section-19">
      <h2 id="name-references-3">
<a href="#section-19" class="section-number selfRef">19. </a><a href="#name-references-3" class="section-name selfRef">References</a>
      </h2>
<section id="section-19.1">
        <h3 id="name-normative-references-3">
<a href="#section-19.1" class="section-number selfRef">19.1. </a><a href="#name-normative-references-3" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-sipcore-callinfo-rcd">[I-D.ietf-sipcore-callinfo-rcd]</dt>
        <dd>
<span class="refAuthor">Wendt, C.</span> and <span class="refAuthor">J. Peterson</span>, <span class="refTitle">"SIP Call-Info Parameters for Rich Call Data"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-sipcore-callinfo-rcd-02</span>, <time datetime="2021-02-22" class="refDate">22 February 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-sipcore-callinfo-rcd-02.txt">https://www.ietf.org/archive/id/draft-ietf-sipcore-callinfo-rcd-02.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-stir-cert-delegation">[I-D.ietf-stir-cert-delegation]</dt>
        <dd>
<span class="refAuthor">Peterson, J.</span>, <span class="refTitle">"Secure Telephone Identity Revisited (STIR) Certificate Delegation"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-stir-cert-delegation-04</span>, <time datetime="2021-02-22" class="refDate">22 February 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-stir-cert-delegation-04.txt">https://www.ietf.org/archive/id/draft-ietf-stir-cert-delegation-04.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-stir-enhance-rfc8226">[I-D.ietf-stir-enhance-rfc8226]</dt>
        <dd>
<span class="refAuthor">Housley, R.</span>, <span class="refTitle">"Enhanced JSON Web Token (JWT) Claim Constraints for Secure Telephone Identity Revisited (STIR) Certificates"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-stir-enhance-rfc8226-05</span>, <time datetime="2021-07-26" class="refDate">26 July 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-stir-enhance-rfc8226-05.txt">https://www.ietf.org/archive/id/draft-ietf-stir-enhance-rfc8226-05.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3261">[RFC3261]</dt>
        <dd>
<span class="refAuthor">Rosenberg, J.</span>, <span class="refAuthor">Schulzrinne, H.</span>, <span class="refAuthor">Camarillo, G.</span>, <span class="refAuthor">Johnston, A.</span>, <span class="refAuthor">Peterson, J.</span>, <span class="refAuthor">Sparks, R.</span>, <span class="refAuthor">Handley, M.</span>, and <span class="refAuthor">E. Schooler</span>, <span class="refTitle">"SIP: Session Initiation Protocol"</span>, <span class="seriesInfo">RFC 3261</span>, <span class="seriesInfo">DOI 10.17487/RFC3261</span>, <time datetime="2002-06" class="refDate">June 2002</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3261">https://www.rfc-editor.org/info/rfc3261</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3325">[RFC3325]</dt>
        <dd>
<span class="refAuthor">Jennings, C.</span>, <span class="refAuthor">Peterson, J.</span>, and <span class="refAuthor">M. Watson</span>, <span class="refTitle">"Private Extensions to the Session Initiation Protocol (SIP) for Asserted Identity within Trusted Networks"</span>, <span class="seriesInfo">RFC 3325</span>, <span class="seriesInfo">DOI 10.17487/RFC3325</span>, <time datetime="2002-11" class="refDate">November 2002</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3325">https://www.rfc-editor.org/info/rfc3325</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4627">[RFC4627]</dt>
        <dd>
<span class="refAuthor">Crockford, D.</span>, <span class="refTitle">"The application/json Media Type for JavaScript Object Notation (JSON)"</span>, <span class="seriesInfo">RFC 4627</span>, <span class="seriesInfo">DOI 10.17487/RFC4627</span>, <time datetime="2006-07" class="refDate">July 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4627">https://www.rfc-editor.org/info/rfc4627</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4648">[RFC4648]</dt>
        <dd>
<span class="refAuthor">Josefsson, S.</span>, <span class="refTitle">"The Base16, Base32, and Base64 Data Encodings"</span>, <span class="seriesInfo">RFC 4648</span>, <span class="seriesInfo">DOI 10.17487/RFC4648</span>, <time datetime="2006-10" class="refDate">October 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4648">https://www.rfc-editor.org/info/rfc4648</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6901">[RFC6901]</dt>
        <dd>
<span class="refAuthor">Bryan, P., Ed.</span>, <span class="refAuthor">Zyp, K.</span>, and <span class="refAuthor">M. Nottingham, Ed.</span>, <span class="refTitle">"JavaScript Object Notation (JSON) Pointer"</span>, <span class="seriesInfo">RFC 6901</span>, <span class="seriesInfo">DOI 10.17487/RFC6901</span>, <time datetime="2013-04" class="refDate">April 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6901">https://www.rfc-editor.org/info/rfc6901</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7095">[RFC7095]</dt>
        <dd>
<span class="refAuthor">Kewisch, P.</span>, <span class="refTitle">"jCard: The JSON Format for vCard"</span>, <span class="seriesInfo">RFC 7095</span>, <span class="seriesInfo">DOI 10.17487/RFC7095</span>, <time datetime="2014-01" class="refDate">January 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7095">https://www.rfc-editor.org/info/rfc7095</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7340">[RFC7340]</dt>
        <dd>
<span class="refAuthor">Peterson, J.</span>, <span class="refAuthor">Schulzrinne, H.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Secure Telephone Identity Problem Statement and Requirements"</span>, <span class="seriesInfo">RFC 7340</span>, <span class="seriesInfo">DOI 10.17487/RFC7340</span>, <time datetime="2014-09" class="refDate">September 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7340">https://www.rfc-editor.org/info/rfc7340</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7519">[RFC7519]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">N. Sakimura</span>, <span class="refTitle">"JSON Web Token (JWT)"</span>, <span class="seriesInfo">RFC 7519</span>, <span class="seriesInfo">DOI 10.17487/RFC7519</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7519">https://www.rfc-editor.org/info/rfc7519</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8224">[RFC8224]</dt>
        <dd>
<span class="refAuthor">Peterson, J.</span>, <span class="refAuthor">Jennings, C.</span>, <span class="refAuthor">Rescorla, E.</span>, and <span class="refAuthor">C. Wendt</span>, <span class="refTitle">"Authenticated Identity Management in the Session Initiation Protocol (SIP)"</span>, <span class="seriesInfo">RFC 8224</span>, <span class="seriesInfo">DOI 10.17487/RFC8224</span>, <time datetime="2018-02" class="refDate">February 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8224">https://www.rfc-editor.org/info/rfc8224</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8225">[RFC8225]</dt>
        <dd>
<span class="refAuthor">Wendt, C.</span> and <span class="refAuthor">J. Peterson</span>, <span class="refTitle">"PASSporT: Personal Assertion Token"</span>, <span class="seriesInfo">RFC 8225</span>, <span class="seriesInfo">DOI 10.17487/RFC8225</span>, <time datetime="2018-02" class="refDate">February 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8225">https://www.rfc-editor.org/info/rfc8225</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8226">[RFC8226]</dt>
        <dd>
<span class="refAuthor">Peterson, J.</span> and <span class="refAuthor">S. Turner</span>, <span class="refTitle">"Secure Telephone Identity Credentials: Certificates"</span>, <span class="seriesInfo">RFC 8226</span>, <span class="seriesInfo">DOI 10.17487/RFC8226</span>, <time datetime="2018-02" class="refDate">February 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8226">https://www.rfc-editor.org/info/rfc8226</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8588">[RFC8588]</dt>
      <dd>
<span class="refAuthor">Wendt, C.</span> and <span class="refAuthor">M. Barnes</span>, <span class="refTitle">"Personal Assertion Token (PaSSporT) Extension for Signature-based Handling of Asserted information using toKENs (SHAKEN)"</span>, <span class="seriesInfo">RFC 8588</span>, <span class="seriesInfo">DOI 10.17487/RFC8588</span>, <time datetime="2019-05" class="refDate">May 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8588">https://www.rfc-editor.org/info/rfc8588</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-19.2">
        <h3 id="name-informative-references-3">
<a href="#section-19.2" class="section-number selfRef">19.2. </a><a href="#name-informative-references-3" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="ATIS-1000074">[ATIS-1000074]</dt>
        <dd>
<span class="refAuthor">ATIS/SIP Forum NNI Task Group</span>, <span class="refTitle">"Signature-based Handling of Asserted information using toKENs (SHAKEN) &lt;https://access.atis.org/apps/group_public/download.php/32237/ATIS-1000074.pdf&gt;"</span>, <time datetime="2017-01" class="refDate">January 2017</time>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-stir-oob">[I-D.ietf-stir-oob]</dt>
      <dd>
<span class="refAuthor">Rescorla, E.</span> and <span class="refAuthor">J. Peterson</span>, <span class="refTitle">"Secure Telephone Identity Revisited (STIR) Out-of-Band Architecture and Use Cases"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-stir-oob-07</span>, <time datetime="2020-03-09" class="refDate">9 March 2020</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-stir-oob-07.txt">https://www.ietf.org/archive/id/draft-ietf-stir-oob-07.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="authors-addresses">
<section id="appendix-A">
      <h2 id="name-authors-addresses-3">
<a href="#name-authors-addresses-3" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Chris Wendt</span></div>
<div dir="auto" class="left"><span class="org">Comcast</span></div>
<div dir="auto" class="left"><span class="street-address">Comcast Technology Center</span></div>
<div dir="auto" class="left">
<span class="locality">Philadelphia, PA  19103</span>,  </div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:chris-ietf@chriswendt.net" class="email">chris-ietf@chriswendt.net</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Jon Peterson</span></div>
<div dir="auto" class="left"><span class="org">Neustar Inc.</span></div>
<div dir="auto" class="left"><span class="street-address">1800 Sutter St Suite 570</span></div>
<div dir="auto" class="left">
<span class="locality">Concord, CA  94520</span>,  </div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:jon.peterson@neustar.biz" class="email">jon.peterson@neustar.biz</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
