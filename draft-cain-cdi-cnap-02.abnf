CNAP-URI		   = URI-PARAMETERS
PROTOCOL-VERSION	   = 1*8DIGIT ; 0 TO 255
CNAS			   = 1*16DIGIT ;
HOLDTIME		   = 1*8DIGIT ; 0 TO 255
RRS-TYPE		   = ("DNS-CNAME")
IP-VERSION		   = ("4" | "6")
IPV4-ADDRESS		   = 1*8DIGIT "." 1*8DIGIT "." 1*8DIGIT "."1*8DIGIT
IPV4-MASK		   = 1*5DIGIT ; 0 TO 32
IPV6-PARAMETER		   = TBD
OTHER-PARAM		   = (token | (token "=" (token | QUOTED- STRING)))
ADVERT-TYPE		   = ("AREA" | "CONTENT")
AREA-LIST		   = *((IPV4-ADDRESS "&" IPV4-MASK)[","])
ERROR-DATA		   = *(ALPHANUM)
STATUS-TYPE		   = ("READY" | "WITHDRAW")


REGION-ID-LIST		   = *(REGION-ID [","])
REGION-ID		   = 1*32DIGIT
RDIR-VALUE		   = *(ALPHANUM)

generic-message     =    method-line
                            message-header
                            CRLF

method-line	=	Method CRLF

Method = "OPEN" | "NOTIFY" | "ADVERTISE" | "KEEPALIVE"


message-header		=	( open-header
					| notification-header
					| advertisement-header )


Message-header = field-name ":" [field-value] CRLF
Field-name = token
Field-value = *(field-content |LWS)
Field-content = <the OCTETs making up the field-value and
                    consisting of either TEXT-UTF8 or combinations
                    of token, separators and quoted string>

open-header	= PROTOCOL-VERSION
PROTOCOL-VERSION = "Protocol-Version" ":" Protocol-Version

NODE-ID = " NODE-ID" ":" IPV4-ADDRESS, or
NODE-ID = " NODE-ID" ":" IPV6-ADDRESS

Content-AS = "Content-AS" ":" CNAS

HOLDTIME = "HOLDTIME" ":" HOLDTIME

RRS-TYPES = "RRS-TYPES" ":" *(RRS-TYPE)

CAPABILITIES = *(CAPABILITIES)


notify-header =   ERROR-CODE
     | ERROR-SUBCODE
     | ERROR-DATA


Error-Code = "Error-Code" ":" 3DIGIT


Error-Subcode = "Error-Subcode" ":" 3DIGIT

Error-Data = "Error-Data" ":" *(alphanum)

advertisement-header	=   ADVERTISE-TYPE
				  | (AREA-HEADER | CONTENT-HEADER)

ADVERTISE-TYPE = "ADVERTISE-TYPE" ":" ADVERT-TYPE

content-header	=  CONTENT-SET
			  | STATUS
			  | REGION-LIST
			  | TTL
			  | REDIRECTION-INFO

CONTENT-SET = "CONTENT-SET" ":" *( (CNAP-URI) [","] )

Status = "Status" ":" status-type

Region-List = "Region-List" ":" region-id-list

TTL = "TTL" ":" 32DIGITS

REDIRECTION-INFO =   REDIRECTION-TYPE
			    | REDIRECTION-VALUE

REDIRECTION-TYPE = "REDIRECTION-TYPE" ":" RRS-TYPE
		
    - Redirection-Value

      Value of redirection parameter set (terminated by CRLF like
      other headers). See Section 4 for the structure of the
      Redirection value for cname based request routing systems.

REDIRECTION-VALUE = "REDIRECTION-VALUE" ":" RDIR-VALUE

REDIRECTION-INFO = WITHDRAW-EFFECTIVE

    where,

     - WITHDRAW-EFFECTIVE
       When the withdraw will be effective (might be 0).
       A withdraw MAY withdraw content before the TTL in a
       previous ready message is reached. If the TTL
       in the ready message is reached the  content is considered
       withdrawn. This field specifies the time when
       the withdraw will take effect in minutes relative to
       the time the message is received.

WITHDRAW-EFFECTIVE = "WITHDRAW-EFFECTIVE" ":" 32DIGITS


area-header	=   AREA-SET
			  | STATUS
			  | REGION-LIST
			  | TTL
			  | METRIC-LIST


AREA-SET = "AREA-SET" ":" AREA-LIST


STATUS = "STATUS" ":" STATUS-TYPE

REGION-LIST = "REGION-LIST" ":" REGION-ID-LIST

TTL = "TTL" ":" 32DIGITS

METRIC-LIST = *(METRIC)

METRIC = METRIC-TYPE| METRIC-VALUE

METRIC-TYPE = "METRIC-TYPE" ":" 16DIGIT

METRIC-VALUE = "METRIC-VALUE" ":" *(ALPHANUM)

REDIRECTION-TYPE = "REDIRECTION-TYPE" ":" "DNS-CNAME"

REDIRECTION-VALUE = "REDIRECTION-VALUE" ":"
                                *(ALPHANUM)

