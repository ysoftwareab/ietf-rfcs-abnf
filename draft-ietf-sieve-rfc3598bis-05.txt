


Sieve Working Group                                         K. Murchison
Internet-Draft                                Carnegie Mellon University
Obsoletes: 3598 (if approved)                              June 15, 2006
Expires: December 17, 2006


             Sieve Email Filtering -- Subaddress Extension
                     draft-ietf-sieve-rfc3598bis-05

Status of this Memo

   By submitting this Internet-Draft, each author represents that any
   applicable patent or other IPR claims of which he or she is aware
   have been or will be disclosed, and any of which he or she becomes
   aware will be disclosed, in accordance with Section 6 of BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups.  Note that
   other groups may also distribute working documents as Internet-
   Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt.

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html.

   This Internet-Draft will expire on December 17, 2006.

Copyright Notice

   Copyright (C) The Internet Society (2006).

Abstract

   On email systems that allow for 'subaddressing' or 'detailed
   addressing' (e.g., "ken+sieve@example.org"), it is sometimes
   desirable to make comparisons against these sub-parts of addresses.
   This document defines an extension to the Sieve mail filtering
   language that allows users to compare against the user and detail
   sub-parts of an address.





Murchison               Expires December 17, 2006               [Page 1]

Internet-Draft        Sieve -- Subaddress Extension            June 2006


Table of Contents

   1.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . .  3
   2.  Conventions used in this document  . . . . . . . . . . . . . .  4
   3.  Capability Identifier  . . . . . . . . . . . . . . . . . . . .  5
   4.  Subaddress Comparisons . . . . . . . . . . . . . . . . . . . .  6
   5.  IANA Considerations  . . . . . . . . . . . . . . . . . . . . .  8
   6.  Security Considerations  . . . . . . . . . . . . . . . . . . .  9
   7.  Normative References . . . . . . . . . . . . . . . . . . . . .  9
   Appendix A.  Acknowledgments . . . . . . . . . . . . . . . . . . . 10
   Appendix B.  Changes since RFC3598 . . . . . . . . . . . . . . . . 11
   Author's Address . . . . . . . . . . . . . . . . . . . . . . . . . 12
   Intellectual Property and Copyright Statements . . . . . . . . . . 13






































Murchison               Expires December 17, 2006               [Page 2]

Internet-Draft        Sieve -- Subaddress Extension            June 2006


1.  Introduction

   Subaddressing is the practice of augmenting the local-part of an
   [RFC2822] address with some 'detail' information in order to give
   some extra meaning to that address.  One common way of encoding
   'detail' information into the local-part is to add a 'separator
   character sequence', such as "+", to form a boundary between the
   'user' (original local-part) and 'detail' sub-parts of the address,
   much like the "@" character forms the boundary between the local-part
   and domain.

   Typical uses of subaddressing might be:

   o  A message addressed to "ken+sieve@example.org" is delivered into a
      mailbox called "sieve" belonging to the user "ken".

   o  A message addressed to "5551212#123@example.com" is delivered to
      the voice mailbox number "123" at phone number "5551212".

   This document describes an extension to the Sieve language defined by
   [I-D.ietf-sieve-3028bis] for comparing against the 'user' and
   'detail' sub-parts of an address.





























Murchison               Expires December 17, 2006               [Page 3]

Internet-Draft        Sieve -- Subaddress Extension            June 2006


2.  Conventions used in this document

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [RFC2119].














































Murchison               Expires December 17, 2006               [Page 4]

Internet-Draft        Sieve -- Subaddress Extension            June 2006


3.  Capability Identifier

   The capability string associated with the extension defined in this
   document is "subaddress".















































Murchison               Expires December 17, 2006               [Page 5]

Internet-Draft        Sieve -- Subaddress Extension            June 2006


4.  Subaddress Comparisons

   Test commands that act exclusively on addresses may take the optional
   tagged arguments ":user" and ":detail" to specify what sub-part of
   the local-part of the address will be acted upon.

      NOTE: In most cases, the envelope "to" address is the preferred
      address to examine for subaddress information when the desire is
      to sort messages based on how they were addressed so as to get to
      a specific recipient.  The envelope address is, after all, the
      reason a given message is being processed by a given sieve script
      for a given user.  This is particularly true when mailing lists,
      aliases, and 'virtual domains' are involved since the envelope may
      be the only source of detail information for the specific
      recipient.

      NOTE: Because the encoding of detailed addresses are site and/or
      implementation specific, using the subaddress extension on foreign
      addresses (such as the envelope "from" address or originator
      header fields) may lead to inconsistent or incorrect results.

   The ":user" argument specifies the user sub-part of the local-part of
   an address.  If the address is not encoded to contain a detail sub-
   part, then ":user" specifies the entire left-side of the address
   (equivalent to ":localpart").

   The ":detail" argument specifies the detail sub-part of the local-
   part of an address.  If the address is not encoded to contain a
   detail sub-part, then the test evaluates to false.  If a zero-length
   string is encoded as the detail sub-part, then ":detail" resolves to
   the empty value ("").

      NOTE: If the encoding method used for detailed addresses utilizes
      a separator character sequence, and the separator character
      sequence occurs more than once in the local-part, then the logic
      used to split the address is implementation defined, and is
      usually dependent on the format used by the encompassing mail
      system.

   Implementations MUST make sure that the encoding method used for
   detailed addresses matches that which is used and/or allowed by the
   encompassing mail system, otherwise unexpected results might occur.
   Note that the mechanisms used to define and/or query the encoding
   method used by the mail system are outside the scope of this
   document.

   The ":user" and ":detail" address parts are subject to the same rules
   and restrictions as the standard address parts defined in [I-D.ietf-



Murchison               Expires December 17, 2006               [Page 6]

Internet-Draft        Sieve -- Subaddress Extension            June 2006


   sieve-3028bis] Section 2.7.4.

   For convenience, the "ADDRESS-PART" syntax element defined in
   [I-D.ietf-sieve-3028bis] Section 2.7.4 is augmented here as follows:

         ADDRESS-PART  =/  ":user" / ":detail"

   A diagram showing the ADDRESS-PARTs of a email address where the
   detail information follows a separator character sequence of "+" is
   shown below:

          :user "+" :detail  "@" :domain
         \-----------------/
             :local-part

   A diagram showing the ADDRESS-PARTs of a email address where the
   detail information precedes a separator character sequence of "--" is
   shown below:

          :detail "--" :user  "@" :domain
         \------------------/
             :local-part

   Example (where the detail information follows "+"):

      require ["subaddress", "fileinto"];

      # In this example the same user account receives mail for both
      # "ken@example.com" and "postmaster@example.com"

      # File all messages to postmaster into a single mailbox,
      # ignoring the :detail part.
      if envelope :user "to" "postmaster" {
          fileinto "inbox.postmaster";
          stop;
      }

      # File mailing list messages (subscribed as "ken+mta-filters").
      if envelope :detail "to" "mta-filters" {
          fileinto "inbox.ietf-mta-filters";
      }

      # Redirect all mail sent to "ken+foo".
      if envelope :detail "to" "foo" {
          redirect "ken@example.net";
      }





Murchison               Expires December 17, 2006               [Page 7]

Internet-Draft        Sieve -- Subaddress Extension            June 2006


5.  IANA Considerations

   This document requests that the IANA update the entry for the
   "subaddress" Sieve extension to point at this document and to update
   the contact information with the author's address.














































Murchison               Expires December 17, 2006               [Page 8]

Internet-Draft        Sieve -- Subaddress Extension            June 2006


6.  Security Considerations

   Security considerations are discussed in [I-D.ietf-sieve-3028bis].
   It is believed that this extension does not introduce any additional
   security concerns.

7.  Normative References

   [I-D.ietf-sieve-3028bis]
              Showalter, T. and P. Guenther, "Sieve: An Email Filtering
              Language", draft-ietf-sieve-3028bis-06 (work in progress),
              March 2006.

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119, March 1997.

   [RFC2822]  Resnick, P., "Internet Message Format", RFC 2822,
              April 2001.

































Murchison               Expires December 17, 2006               [Page 9]

Internet-Draft        Sieve -- Subaddress Extension            June 2006


Appendix A.  Acknowledgments

   Thanks to Tim Showalter, Alexey Melnikov, Michael Salmon, Randall
   Gellens, Philip Guenther, Jutta Degener, Michael Haardt, Ned Freed,
   Mark Mallett, and Barry Leiba for their help with this document.














































Murchison               Expires December 17, 2006              [Page 10]

Internet-Draft        Sieve -- Subaddress Extension            June 2006


Appendix B.  Changes since RFC3598

   o  Discussion of how the user and detail information is encoded now
      uses generic language.

   o  Added note detailing that this extension is most useful when used
      on the envelope "to" address.

   o  Added note detailing that this extension isn't very useful on
      foreign addresses (envelope "from" or originator header fields).

   o  Fixed envelope test example to only use "to" address.

   o  Replaced ":user" example with one that doesn't produce unexpected
      behavior.

   o  Refer to the zero-length string ("") as "empty" instead of "null"
      (per draft-ietf-sieve-3028bis)

   o  Use only RFC 2606 domains in examples.

   o  Miscellaneous editorial changes.





























Murchison               Expires December 17, 2006              [Page 11]

Internet-Draft        Sieve -- Subaddress Extension            June 2006


Author's Address

   Kenneth Murchison
   Carnegie Mellon University
   5000 Forbes Avenue
   Cyert Hall 285
   Pittsburgh, PA  15213
   US

   Phone: +1 412 268 2638
   Email: murch@andrew.cmu.edu








































Murchison               Expires December 17, 2006              [Page 12]

Internet-Draft        Sieve -- Subaddress Extension            June 2006


Intellectual Property Statement

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in BCP 78 and BCP 79.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   http://www.ietf.org/ipr.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.


Disclaimer of Validity

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY AND THE INTERNET
   ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS OR IMPLIED,
   INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE
   INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.


Copyright Statement

   Copyright (C) The Internet Society (2006).  This document is subject
   to the rights, licenses and restrictions contained in BCP 78, and
   except as set forth therein, the authors retain all their rights.


Acknowledgment

   Funding for the RFC Editor function is currently provided by the
   Internet Society.




Murchison               Expires December 17, 2006              [Page 13]
