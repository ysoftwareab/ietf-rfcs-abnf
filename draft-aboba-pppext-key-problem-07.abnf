master_secret = TLS-PRF-48(pre_master_secret, "master secret",
                client.random || server.random)
TEK           = TLS-PRF-X(master_secret, "key expansion",
                server.random || client.random)
TLS-PRF-X =     TLS pseudo-random function defined in [RFC2246],
                computed to X octets.
master_secret = TLS term for the MK.

       |                       |                           |
       |                       | pre_master_secret         |
 server|                       |                           | client
 Random|                       V                           | Random
       |     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+       |
       |     |                                     |       |
       |     |                                     |       |
       +---->|             master_secret           |<------+
       |     |               (MK)                  |       |
       |     |                                     |       |
       |     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+       |
       |                       |                           |
       |                       |                           |
       |                       |                           |
       V                       V                           V
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                                                               |
 |                                                               |
 |                         Key Block                             |
 |                          (TEKs)                               |
 |                                                               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |           |           |           |           |           |
   | client    | server    | client    | server    | client    | server
   | MAC       | MAC       | write     | write     | IV        | IV
   |           |           |           |           |           |
   V           V           V           V           V           V

MSK           = TLS-PRF-64(MK, "client EAP encryption",
                   client.random || server.random)
EMSK          = second 64 octets of:
                TLS-PRF-128(MK, "client EAP encryption",
                   client.random || server.random)
IV            = TLS-PRF-64("", "client EAP encryption",
                   client.random || server.random)

MK            = TLS master_secret
TLS-PRF-X     = TLS PRF function defined in [RFC2246] computed to X octets
PTK = EAPOL-PRF-X(PMK, "Pairwise key expansion", Min(AA,SA) ||
      Max(AA, SA) || Min(ANonce,SNonce) || Max(ANonce,SNonce))

PMK             = AAA-Key(0,31)
SA              = Station MAC address (Calling-Station-Id)
AA              = Access Point MAC address (Called-Station-Id)
ANonce          = Access Point Nonce
SNonce          = Station Nonce
EAPOL-PRF-X     = Pseudo-Random Function based on HMAC-SHA1, generating
                  a PTK of size X octets.

AAA-Key-A = MSK(0,63)
AAA-Key-B = PRF(EMSK(0,63),AAA-Key-A,B-Called-Station-Id,Calling-Station-Id)
AAA-Key-E = PRF(EMSK(0,63),AAA-Key-A,E-Called-Station-Id,Calling-Station-Id)

Calling-Station-Id  = STA MAC address
B-Called-Station-Id = AP B MAC address
E-Called-Station-Id = AP E MAC address

