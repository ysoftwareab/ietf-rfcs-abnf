uuuuuuuuuuuuuu = upstream datagram mode messages
dddddddddddddd = downstream datagram mode messages
xxxxxxxxxxxxxx = connection mode messages
RAO = Router Alert Option


GIMPS-message = D-message / C-message


D-message = D-upstream-message / D-downstream-message


C-message = C-upstream-message / C-downstream-message


D-downstream-message = Common-Header
                              Message-Routing-Information
                              Node-Addressing
                              Session-Identification
                              [ Stack-Proposal ]
                              [ Query-Cookie / Responder-Cookie ]
                              [ Routing-State-Lifetime ]
                              [ NSLP-Data ]
D-upstream-message   = Common-Header
                              Message-Routing-Information
                              Node-Addressing
                              Session-Identification
                              [ Stack-Proposal ]
                              [ Query-Cookie [ Responder-Cookie ] ]
                              [ Routing-State-Lifetime ]
                              [ NSLP-Data ]


C-downstream-message = Common-Header
                              Message-Routing-Information
                              Session-Identification
                              [ Responder-Cookie ]
                              [ Routing-State-Lifetime ]
                              [ NSLP-Data ]


C-upstream-message   = Common-Header
                              Message-Routing-Information
                              Session-Identification
                              [ Stack-Proposal ]
                              [ Query-Cookie [ Responder-Cookie ] ]
                              [ Routing-State-Lifetime ]
                              [ NSLP-Data ]



Message-Routing-Information = message-routing-method
                                     method-specific-information


Flow-Identifier = network-layer-version
                         source-address prefix-length
                         destination-address prefix-length
                         IP-protocol
                         traffic-class
                         [ flow-label ]
                         [ ipsec-SPI / L4-ports]


