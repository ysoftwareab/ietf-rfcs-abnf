<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Routing for RPL Leaves</title>
<meta content="Pascal Thubert" name="author">
<meta content="Michael C. Richardson" name="author">
<meta content="
       
  This specification updates RFC6550, RFC6775, and RFC8505,
   
  to provide routing services to IPv6 Nodes
  that implement RFC6775, RFC8505, and their extensions therein,
  but do not support RFC6550.
   
 
    " name="description">
<meta content="xml2rfc 3.4.0" name="generator">
<meta content="draft-ietf-roll-unaware-leaves-25" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.4.0
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.2.3
    google-i18n-address 2.4.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.2
    kitchen 1.2.6
    lxml 4.6.1
    pycountry 20.7.3
    pyflakes 2.2.0
    PyYAML 5.3.1
    requests 2.25.0
    setuptools 40.6.2
    six 1.15.0
-->
<link href="/tmp/unaware-leaves-8sw7mdeo.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">RPL Unaware Leaves</td>
<td class="right">December 2020</td>
</tr></thead>
<tfoot><tr>
<td class="left">Thubert &amp; Richardson</td>
<td class="center">Expires 18 June 2021</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">ROLL</dd>
<dt class="label-updates">Updates:</dt>
<dd class="updates">
<a href="https://www.rfc-editor.org/rfc/rfc6550" class="eref">6550</a>, <a href="https://www.rfc-editor.org/rfc/rfc6775" class="eref">6775</a>, <a href="https://www.rfc-editor.org/rfc/rfc8505" class="eref">8505</a> (if approved)</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2020-12-15" class="published">15 December 2020</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2021-06-18">18 June 2021</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">P. Thubert, <span class="editor">Ed.</span>
</div>
<div class="org">Cisco Systems</div>
</div>
<div class="author">
      <div class="author-name">M. Richardson</div>
<div class="org">Sandelman</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Routing for RPL Leaves</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">
  This specification updates RFC6550, RFC6775, and RFC8505,
  
  to provide routing services to IPv6 Nodes
  that implement RFC6775, RFC8505, and their extensions therein,
  but do not support RFC6550.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 18 June 2021.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2020 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact ulEmpty toc">
<li class="compact ulEmpty toc" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a><a href="#section-toc.1-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-terminology" class="xref">Terminology</a><a href="#section-toc.1-1.2.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-requirements-language" class="xref">Requirements Language</a><a href="#section-toc.1-1.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1" class="keepWithNext"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-glossary" class="xref">Glossary</a><a href="#section-toc.1-1.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="xref">2.3</a>.  <a href="#name-references" class="xref">References</a><a href="#section-toc.1-1.2.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-rpl-external-routes-and-dat" class="xref">RPL External Routes and Dataplane Artifacts</a><a href="#section-toc.1-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-6lowpan-neighbor-discovery" class="xref">6LoWPAN Neighbor Discovery</a><a href="#section-toc.1-1.4.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-rfc-6775-address-registrati" class="xref">RFC 6775 Address Registration</a><a href="#section-toc.1-1.4.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-rfc-8505-extended-address-r" class="xref">RFC 8505 Extended Address Registration</a><a href="#section-toc.1-1.4.2.2.1" class="pilcrow">¶</a></p>
<ul class="compact ulEmpty toc">
<li class="compact ulEmpty toc" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a href="#section-4.2.1" class="xref">4.2.1</a>.  <a href="#name-r-flag" class="xref">R Flag</a><a href="#section-toc.1-1.4.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.4.2.2.2.2">
                    <p id="section-toc.1-1.4.2.2.2.2.1"><a href="#section-4.2.2" class="xref">4.2.2</a>.  <a href="#name-tid-i-field-and-opaque-fiel" class="xref">TID, "I" Field and Opaque Fields</a><a href="#section-toc.1-1.4.2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.4.2.2.2.3">
                    <p id="section-toc.1-1.4.2.2.2.3.1"><a href="#section-4.2.3" class="xref">4.2.3</a>.  <a href="#name-route-ownership-verifier" class="xref">Route Ownership Verifier</a><a href="#section-toc.1-1.4.2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.  <a href="#name-rfc-8505-extended-dar-dac" class="xref">RFC 8505 Extended DAR/DAC</a><a href="#section-toc.1-1.4.2.3.1" class="pilcrow">¶</a></p>
<ul class="compact ulEmpty toc">
<li class="compact ulEmpty toc" id="section-toc.1-1.4.2.3.2.1">
                    <p id="section-toc.1-1.4.2.3.2.1.1"><a href="#section-4.3.1" class="xref">4.3.1</a>.  <a href="#name-rfc-7400-capability-indicat" class="xref">RFC 7400 Capability Indication Option</a><a href="#section-toc.1-1.4.2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-requirements-on-the-rpl-unw" class="xref">Requirements on the RPL-Unware leaf</a><a href="#section-toc.1-1.5.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-support-of-6lowpan-nd" class="xref">Support of 6LoWPAN ND</a><a href="#section-toc.1-1.5.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-support-of-ipv6-encapsulati" class="xref">Support of IPv6 Encapsulation</a><a href="#section-toc.1-1.5.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="xref">5.3</a>.  <a href="#name-support-of-the-hop-by-hop-h" class="xref">Support of the Hop-by-Hop Header</a><a href="#section-toc.1-1.5.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="xref">5.4</a>.  <a href="#name-support-of-the-routing-head" class="xref">Support of the Routing Header</a><a href="#section-toc.1-1.5.2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-enhancements-to-rfc-6550" class="xref">Enhancements to RFC 6550</a><a href="#section-toc.1-1.6.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-updated-rpl-target-option" class="xref">Updated RPL Target Option</a><a href="#section-toc.1-1.6.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-additional-flag-in-the-rpl-" class="xref">Additional Flag in the RPL DODAG Configuration Option</a><a href="#section-toc.1-1.6.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="xref">6.3</a>.  <a href="#name-updated-rpl-status" class="xref">Updated RPL Status</a><a href="#section-toc.1-1.6.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-enhancements-to-draft-ietf-" class="xref">Enhancements to draft-ietf-roll-efficient-npdao</a><a href="#section-toc.1-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-enhancements-to-rfc-6775-an" class="xref">Enhancements to RFC 6775 and RFC8505</a><a href="#section-toc.1-1.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-protocol-operations-for-uni" class="xref">Protocol Operations for Unicast Addresses</a><a href="#section-toc.1-1.9.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="xref">9.1</a>.  <a href="#name-general-flow" class="xref">General Flow</a><a href="#section-toc.1-1.9.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="xref">9.2</a>.  <a href="#name-detailed-operation" class="xref">Detailed Operation</a><a href="#section-toc.1-1.9.2.2.1" class="pilcrow">¶</a></p>
<ul class="compact ulEmpty toc">
<li class="compact ulEmpty toc" id="section-toc.1-1.9.2.2.2.1">
                    <p id="section-toc.1-1.9.2.2.2.1.1"><a href="#section-9.2.1" class="xref">9.2.1</a>.  <a href="#name-perspective-of-the-6ln-acti" class="xref">Perspective of the 6LN Acting as RUL</a><a href="#section-toc.1-1.9.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.9.2.2.2.2">
                    <p id="section-toc.1-1.9.2.2.2.2.1"><a href="#section-9.2.2" class="xref">9.2.2</a>.  <a href="#name-perspective-of-the-6lr-acti" class="xref">Perspective of the 6LR Acting as Border router</a><a href="#section-toc.1-1.9.2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.9.2.2.2.3">
                    <p id="section-toc.1-1.9.2.2.2.3.1"><a href="#section-9.2.3" class="xref">9.2.3</a>.  <a href="#name-perspective-of-the-rpl-root" class="xref">Perspective of the RPL Root</a><a href="#section-toc.1-1.9.2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.9.2.2.2.4">
                    <p id="section-toc.1-1.9.2.2.2.4.1"><a href="#section-9.2.4" class="xref">9.2.4</a>.  <a href="#name-perspective-of-the-6lbr" class="xref">Perspective of the 6LBR</a><a href="#section-toc.1-1.9.2.2.2.4.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-protocol-operations-for-mul" class="xref">Protocol Operations for Multicast Addresses</a><a href="#section-toc.1-1.10.1" class="pilcrow">¶</a></p>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>. <a href="#name-security-considerations" class="xref">Security Considerations</a><a href="#section-toc.1-1.11.1" class="pilcrow">¶</a></p>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="xref">12</a>. <a href="#name-iana-considerations" class="xref">IANA Considerations</a><a href="#section-toc.1-1.12.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#section-12.1" class="xref">12.1</a>.  <a href="#name-fixing-the-address-registra" class="xref">Fixing the Address Registration Option Flags</a><a href="#section-toc.1-1.12.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#section-12.2" class="xref">12.2</a>.  <a href="#name-resizing-the-aro-status-val" class="xref">Resizing the ARO Status values</a><a href="#section-toc.1-1.12.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.12.2.3">
                <p id="section-toc.1-1.12.2.3.1"><a href="#section-12.3" class="xref">12.3</a>.  <a href="#name-new-rpl-dodag-configuration" class="xref">New RPL DODAG Configuration Option Flag</a><a href="#section-toc.1-1.12.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.12.2.4">
                <p id="section-toc.1-1.12.2.4.1"><a href="#section-12.4" class="xref">12.4</a>.  <a href="#name-rpl-target-option-registry" class="xref">RPL Target Option Registry</a><a href="#section-toc.1-1.12.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.12.2.5">
                <p id="section-toc.1-1.12.2.5.1"><a href="#section-12.5" class="xref">12.5</a>.  <a href="#name-new-subregistry-for-rpl-non" class="xref">New Subregistry for RPL Non-Rejection Status values</a><a href="#section-toc.1-1.12.2.5.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.12.2.6">
                <p id="section-toc.1-1.12.2.6.1"><a href="#section-12.6" class="xref">12.6</a>.  <a href="#name-new-subregistry-for-rpl-rej" class="xref">New Subregistry for RPL Rejection Status values</a><a href="#section-toc.1-1.12.2.6.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="xref">13</a>. <a href="#name-acknowledgments" class="xref">Acknowledgments</a><a href="#section-toc.1-1.13.1" class="pilcrow">¶</a></p>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-14" class="xref">14</a>. <a href="#name-normative-references" class="xref">Normative References</a><a href="#section-toc.1-1.14.1" class="pilcrow">¶</a></p>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#section-15" class="xref">15</a>. <a href="#name-informative-references" class="xref">Informative References</a><a href="#section-toc.1-1.15.1" class="pilcrow">¶</a></p>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#section-appendix.a" class="xref">Appendix A</a>.  <a href="#name-example-compression" class="xref">Example Compression</a><a href="#section-toc.1-1.16.1" class="pilcrow">¶</a></p>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a href="#section-appendix.b" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a><a href="#section-toc.1-1.17.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">The design of Low Power and Lossy Networks (LLNs) is generally focused on
   saving energy, which is the most constrained resource of all. Other design
   constraints, such as a limited memory capacity, duty cycling of the LLN
   devices and low-power lossy transmissions, derive from that primary concern.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">The IETF produced the <span><a href="#RFC6550" class="xref">"Routing Protocol for Low Power
   and Lossy Networks"</a> [<a href="#RFC6550" class="xref">RFC6550</a>]</span> (RPL) to provide IPv6 <span>[<a href="#RFC8200" class="xref">RFC8200</a>]</span>
   routing services within such constraints. RPL belongs to the class of
   Distance-Vector protocols, which, compared to link-state protocols,
   limit the amount of topological knowledge that needs to be installed and
   maintained in each node, and does not require convergence to avoid
   micro-loops.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">
   To save signaling and routing state in constrained networks,
   RPL allows a path stretch (see <span>[<a href="#RFC6687" class="xref">RFC6687</a>]</span>), whereby routing
   is only performed along a Destination-Oriented Directed Acyclic Graph (DODAG) that is optimized to reach a Root node, as opposed to along the shortest path
   between 2 peers, whatever that would mean in a given LLN.
   This trades the quality of peer-to-peer (P2P) paths for a vastly reduced
   amount of control traffic and routing state that would be required to
   operate an any-to-any shortest path protocol. Additionally,
   broken routes may be fixed lazily and on-demand, based on dataplane
   inconsistency discovery, which avoids wasting energy in the proactive repair
   of unused paths.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">
   For many of the nodes, though not all, the DODAG provides multiple
   forwarding solutions towards the Root of the topology via so-called parents.
   RPL is designed to adapt to fuzzy connectivity, whereby the physical topology
   cannot be expected to reach a stable state, with a lazy control that creates
   the routes proactively, but may only fix them reactively, upon actual traffic.
   The result is that RPL provides reachability for most of the LLN nodes, most
   of the time, but may not converge in the classical sense.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">
   RPL can be deployed in conjunction with IPv6 Neighbor Discovery (ND)
   <span>[<a href="#RFC4861" class="xref">RFC4861</a>]</span> <span>[<a href="#RFC4862" class="xref">RFC4862</a>]</span> and 6LoWPAN ND
   <span>[<a href="#RFC6775" class="xref">RFC6775</a>]</span> <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span> to maintain reachability
   within a Non-Broadcast Multiple-Access     (NBMA) Multi-Link subnet.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">
   In that mode, IPv6 addresses are advertised individually as host routes.
   Some nodes may act as routers and participate in the forwarding operations
   whereas  others will only receive/originate packets, acting as hosts in the
   data-plane.
   In <span>[<a href="#RFC6550" class="xref">RFC6550</a>]</span> terms, an IPv6 host <span>[<a href="#RFC8504" class="xref">RFC8504</a>]</span>
   that is reachable over the RPL network is called a leaf.<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7">
   Section 2 of <span>[<a href="#I-D.ietf-roll-useofrplinfo" class="xref">USEofRPLinfo</a>]</span> defines the terms
   RPL leaf, RPL-Aware-leaf (RAL) and RPL-Unaware Leaf (RUL).
   A RPL leaf is a host attached to one or more RPL router(s); as such, it
   relies on the RPL router(s) to forward its traffic across the RPL domain but
   does not forward traffic from another node. As opposed to the RAL, the
   RUL does not participate to RPL, and relies on its RPL router(s) also to
   inject the routes to its IPv6 addresses in the RPL domain.<a href="#section-1-7" class="pilcrow">¶</a></p>
<p id="section-1-8">
   A RUL may be unable to participate because it is very energy-constrained,
   code-space constrained, or because it would be unsafe to let it inject
   routes in RPL. Using 6LoWPAN ND as opposed to RPL as the host-to-router
   interface limits the surface of the possible attacks by the RUL against the
   RPL domain, and can protect RUL for its address ownership.<a href="#section-1-8" class="pilcrow">¶</a></p>
<p id="section-1-9">
   This document specifies how the router injects the host routes in the RPL
   domain on behalf of the RUL. <a href="#prereq" class="xref">Section 5</a> details how the RUL
   can leverage 6LoWPAN ND to obtain the routing services from the router.
   In that model, the RUL is also a 6LoWPAN Node (6LN) and the RPL-Aware router
   is also a 6LoWPAN router (6LR). Using the 6LoWPAN ND Address Registration
   mechanism, the RUL signals that the router must inject a host route for the
   Registered Address.<a href="#section-1-9" class="pilcrow">¶</a></p>
<span id="name-injecting-routes-on-behalf-"></span><div id="injectfig">
<figure id="figure-1">
        <div class="artwork art-text alignLeft" id="section-1-10.1">
<pre>
         ------+---------
               |          Internet
               |
            +-----+
            |     | &lt;------------- 6LBR / RPL Root
            +-----+                     ^
               |                        |
         o    o   o  o                  | RPL
     o o   o  o   o  o     o    o       |
    o  o o  o o    o   o  o   o  o      |  +
    o   o      o     o   o   o    o     |
   o  o   o  o   o  o    o    o  o      | 6LoWPAN ND
      o  o  o  o        o   o           |
     o       o            o    o        v
   o      o     o &lt;------------- 6LR / RPL Border router
                                        ^
                                        | 6LoWPAN ND only
                                        v
                u &lt;------------- 6LN / RPL-Unaware Leaf

</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-injecting-routes-on-behalf-" class="selfRef">Injecting Routes on behalf of RULs</a>
        </figcaption></figure>
</div>
<p id="section-1-11">
   The RPL Non-Storing Mode mechanism is used to extend the routing state with
   connectivity to the RULs even when the DODAG is operated in Storing Mode.
   The unicast packet forwarding operation by the 6LR serving a RUL is described
   in section 4.1 of <span>[<a href="#I-D.ietf-roll-useofrplinfo" class="xref">USEofRPLinfo</a>]</span>.<a href="#section-1-11" class="pilcrow">¶</a></p>
<p id="section-1-12">
   Examples of possible RULs include severely energy constrained sensors such as
   window smash sensor (alarm system), and kinetically powered light switches.
   Other applications of this specification may include a smart grid network that
   controls appliances - such as washing machines or the heating system - in the
   home. Appliances may not participate to the RPL protocol operated in the
   Smartgrid network but can still interact with the Smartgrid for control and/or
   metering.<a href="#section-1-12" class="pilcrow">¶</a></p>
<p id="section-1-13">
   This document is organized as follows:<a href="#section-1-13" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-14.1">
          <a href="#prereqv6" class="xref">Section 3</a> and <a href="#lpnd" class="xref">Section 4</a> present in a
    non-normative fashion the salient aspects of RPL and 6LoWPAN ND,
    respectively, that are leveraged in this specification to provide
    connectivity to a 6LN acting as a RUL across a RPL network.<a href="#section-1-14.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-14.2">
          <a href="#prereq" class="xref">Section 5</a> lists the expectations that a RUL needs to match
    in order to be served by a RPL router that complies with this specification.<a href="#section-1-14.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-14.3">
          <a href="#upd" class="xref">Section 6</a> presents the changes made to <span>[<a href="#RFC6550" class="xref">RFC6550</a>]</span>;
    a new behavior is introduced whereby the 6LR advertises the 6LN's addresses in a RPL DAO message based on the ND registration by the 6LN, and the RPL
    root performs the EDAR/EDAC exchange with the 6LBR on behalf of the 6LR;
    modifications are introduced to some RPL options and to the RPL Status to
    facilitate the integration of the protocols.<a href="#section-1-14.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-14.4">
          <a href="#updnpdao" class="xref">Section 7</a> presents the changes made to
    <span>[<a href="#I-D.ietf-roll-efficient-npdao" class="xref">EFFICIENT-NPDAO</a>]</span>; the use of the DCO message is extended to the Non-Storing MOP to report asynchronous issues from the Root to the 6LR.<a href="#section-1-14.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-14.5">
          <a href="#upd2" class="xref">Section 8</a> presents the changes made to <span>[<a href="#RFC6775" class="xref">RFC6775</a>]</span>
    and <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span>; The range of the ND status codes is reduced
    down to 64 values, and the remaining bits in the original status field are
    now reserved.<a href="#section-1-14.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-14.6">
          <a href="#op" class="xref">Section 9</a> and <a href="#multiop" class="xref">Section 10</a> present the operation of
    this specification for unicast and multicast flows, respectively, and
    <a href="#security-considerations" class="xref">Section 11</a> presents associated security
    considerations.<a href="#section-1-14.6" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<section id="section-2">
      <h2 id="name-terminology">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
      </h2>
<div id="bcp">
<section id="section-2.1">
        <h3 id="name-requirements-language">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-requirements-language" class="section-name selfRef">Requirements Language</a>
        </h3>
<p id="section-2.1-1">

    The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
    "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
    "OPTIONAL" in this document are to be interpreted as described in BCP 14
 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they
    appear in all capitals, as shown here.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="gloss">
<section id="section-2.2">
        <h3 id="name-glossary">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-glossary" class="section-name selfRef">Glossary</a>
        </h3>
<p id="section-2.2-1"> This document uses the following acronyms:<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel dlCompact" id="section-2.2-2">
          <dt id="section-2.2-2.1">AR:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.2">  Address Resolution (aka Address Lookup)<a href="#section-2.2-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.3">ARQ:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.4">  Automatic Repeat reQuest<a href="#section-2.2-2.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.5">6CIO:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.6"> 6LoWPAN Capability Indication Option<a href="#section-2.2-2.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.7">6LN:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.8"> 6LoWPAN Node (a Low Power host or router)<a href="#section-2.2-2.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.9">6LR:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.10"> 6LoWPAN router<a href="#section-2.2-2.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.11">6LBR:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.12"> 6LoWPAN Border router<a href="#section-2.2-2.12" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.13">(E)ARO:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.14"> (Extended) Address Registration Option<a href="#section-2.2-2.14" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.15">(E)DAR:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.16"> (Extended) Duplicate Address Request<a href="#section-2.2-2.16" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.17">(E)DAC:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.18"> (Extended) Duplicate Address Confirmation<a href="#section-2.2-2.18" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.19">DAD:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.20"> Duplicate Address Detection<a href="#section-2.2-2.20" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.21">DAO:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.22"> Destination Advertisement Object (a RPL message)<a href="#section-2.2-2.22" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.23">DCO:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.24"> Destination Cleanup Object (a RPL message)<a href="#section-2.2-2.24" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.25">DIS:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.26"> DODAG Information solicitation (a RPL message)<a href="#section-2.2-2.26" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.27">DIO:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.28"> DODAG Information Object (a RPL message)<a href="#section-2.2-2.28" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.29">DODAG:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.30"> Destination-Oriented Directed Acyclic Graph<a href="#section-2.2-2.30" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.31">LLN:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.32"> Low-Power and Lossy Network<a href="#section-2.2-2.32" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.33">MOP:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.34"> RPL Mode of Operation<a href="#section-2.2-2.34" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.35">NA:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.36">  Neighbor Advertisement<a href="#section-2.2-2.36" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.37">NCE:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.38">  Neighbor Cache Entry<a href="#section-2.2-2.38" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.39">ND:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.40">  Neighbor Discovery<a href="#section-2.2-2.40" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.41">NS:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.42">  Neighbor solicitation<a href="#section-2.2-2.42" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.43">RA:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.44">  router Advertisement<a href="#section-2.2-2.44" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.45">ROVR:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.46"> Registration Ownership Verifier<a href="#section-2.2-2.46" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.47">RPI:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.48"> RPL Packet Information<a href="#section-2.2-2.48" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.49">RAL:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.50"> RPL-aware Leaf<a href="#section-2.2-2.50" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.51">RAN:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.52"> RPL-Aware Node (either a RPL router or a RPL-aware Leaf)<a href="#section-2.2-2.52" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.53">RUL:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.54"> RPL-Unaware Leaf<a href="#section-2.2-2.54" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.55">SRH:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.56"> Source-Routing Header<a href="#section-2.2-2.56" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.57">TID:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.58"> Transaction ID (a sequence counter in the EARO)<a href="#section-2.2-2.58" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-2.2-3"></p>
</section>
</div>
<div id="lo">
<section id="section-2.3">
        <h3 id="name-references">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-references" class="section-name selfRef">References</a>
        </h3>
<p id="section-2.3-1">
   The Terminology used in this document is consistent with and incorporates
   that described in <span><a href="#RFC7102" class="xref">"Terms Used in Routing for Low-Power
   and Lossy Networks (LLNs)"</a> [<a href="#RFC7102" class="xref">RFC7102</a>]</span>.
   A glossary of classical 6LoWPAN acronyms is given in <a href="#gloss" class="xref">Section 2.2</a>.
   Other terms in use in LLNs are found in <span><a href="#RFC7228" class="xref">"Terminology for Constrained-Node Networks"</a> [<a href="#RFC7228" class="xref">RFC7228</a>]</span>.
   This specification uses the terms 6LN and 6LR to refer specifically to nodes
   that implement the 6LN and 6LR roles in 6LoWPAN ND and does not expect other
   functionality such as 6LoWPAN Header Compression <span>[<a href="#RFC6282" class="xref">RFC6282</a>]</span>
   from those nodes.<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<p id="section-2.3-2">"RPL", the "RPL Packet Information" (RPI), "RPL Instance" (indexed by a
   RPLInstanceID), "up", "down" are defined in
   <span><a href="#RFC6550" class="xref">"RPL: IPv6 Routing
   Protocol for Low-Power and Lossy Networks"</a> [<a href="#RFC6550" class="xref">RFC6550</a>]</span>. The RPI is the abstract
   information that RPL defines to be placed in data packets, e.g., as the RPL
   Option <span>[<a href="#RFC6553" class="xref">RFC6553</a>]</span> within the IPv6 Hop-By-Hop Header.
   By extension, the term "RPI" is often used to refer to the RPL Option itself.
   The DODAG Information solicitation (DIS), Destination Advertisement Object
   (DAO) and DODAG Information Object (DIO) messages are also specified in
   <span>[<a href="#RFC6550" class="xref">RFC6550</a>]</span>. The Destination Cleanup Object (DCO) message
   is defined in <span>[<a href="#I-D.ietf-roll-efficient-npdao" class="xref">EFFICIENT-NPDAO</a>]</span>.<a href="#section-2.3-2" class="pilcrow">¶</a></p>
<p id="section-2.3-3">

   This document uses the terms RPL-Unaware Leaf (RUL), RPL-Aware Node (RAN) and
   RPL aware Leaf (RAL) consistently with <span>[<a href="#I-D.ietf-roll-useofrplinfo" class="xref">USEofRPLinfo</a>]</span>.
   A RAN is either an RAL or a RPL router. As opposed to a RUL, a RAN manages
   the reachability of its addresses and prefixes by injecting them in RPL by
   itself.<a href="#section-2.3-3" class="pilcrow">¶</a></p>
<p id="section-2.3-4">


 In this document, readers will encounter terms and concepts
 that are discussed in the following documents:<a href="#section-2.3-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2.3-5">
          <dt id="section-2.3-5.1">Classical IPv6 ND:</dt>
          <dd style="margin-left: 1.5em" id="section-2.3-5.2">
            <span><a href="#RFC4861" class="xref">"Neighbor Discovery for IP version 6"</a> [<a href="#RFC4861" class="xref">RFC4861</a>]</span> and
     <span><a href="#RFC4862" class="xref">"IPv6 Stateless Address Autoconfiguration"</a> [<a href="#RFC4862" class="xref">RFC4862</a>]</span>,<a href="#section-2.3-5.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-5.3">6LoWPAN:</dt>
          <dd style="margin-left: 1.5em" id="section-2.3-5.4">
            <span><a href="#RFC6606" class="xref">"Problem Statement and Requirements for
 IPv6 over Low-Power Wireless Personal Area Network (6LoWPAN)
 Routing"</a> [<a href="#RFC6606" class="xref">RFC6606</a>]</span> and <span><a href="#RFC4919" class="xref">"IPv6 over Low-Power
     Wireless Personal Area Networks (6LoWPANs): Overview, Assumptions,
     Problem Statement, and Goals"</a> [<a href="#RFC4919" class="xref">RFC4919</a>]</span>, and<a href="#section-2.3-5.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-5.5">6LoWPAN ND:</dt>
          <dd style="margin-left: 1.5em" id="section-2.3-5.6">
            <span><a href="#RFC6775" class="xref">Neighbor Discovery Optimization for Low-Power
 and Lossy Networks</a> [<a href="#RFC6775" class="xref">RFC6775</a>]</span>,
     <span><a href="#RFC8505" class="xref">"Registration Extensions for 6LoWPAN Neighbor Discovery"</a> [<a href="#RFC8505" class="xref">RFC8505</a>]</span>,
        and <span><a href="#RFC8928" class="xref">"Address Protected Neighbor Discovery for Low-power and Lossy Networks"</a> [<a href="#RFC8928" class="xref">RFC8928</a>]</span>.<a href="#section-2.3-5.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
</section>
<div id="prereqv6">
<section id="section-3">
      <h2 id="name-rpl-external-routes-and-dat">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-rpl-external-routes-and-dat" class="section-name selfRef">RPL External Routes and Dataplane Artifacts</a>
      </h2>
<p id="section-3-1">
   Section 4.1 of <span>[<a href="#I-D.ietf-roll-useofrplinfo" class="xref">USEofRPLinfo</a>]</span> provides a set of
   rules summarized below that must be followed for routing packets from and to
   a RUL.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">
   A 6LR that acts as a border router for external routes advertises them using
   Non-Storing Mode DAO messages that are unicast directly to the Root, even if
   the DODAG is operated in Storing Mode.
   Non-Storing Mode routes are not visible inside the RPL domain and all packets
   are routed via the Root. The RPL Root tunnels the packets directly to the
   6LR that advertised the external route, which decapsulates and forwards the
   original (inner) packet.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">
   The RPL Non-Storing MOP signaling and the associated IPv6-in-IPv6 encapsulated
   packets appear as normal traffic to the intermediate routers. The support
   of external routes only impacts the Root and the 6LR. It can be operated with
   legacy intermediate routers and does not add to the amount of state that must
   be maintained in those routers.
   A RUL is an example of a destination that is reachable via an external route
   that happens to be also a host route.<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">
   The RPL data packets typically carry a Hop-by-Hop Header with a RPL Option
   <span>[<a href="#RFC6553" class="xref">RFC6553</a>]</span> that contains the Packet Information (RPI) defined
   in section 11.2 of <span>[<a href="#RFC6550" class="xref">RFC6550</a>]</span>.
   Unless the RUL already placed a RPL Option in outer header chain, the packets
   from and to the RUL are encapsulated using an IPv6-in-IPv6 tunnel between the
   Root and the 6LR that serves the RUL
   (see sections 7 and 8 of <span>[<a href="#I-D.ietf-roll-useofrplinfo" class="xref">USEofRPLinfo</a>]</span> for details).
   If the packet from the RUL has an RPI, the 6LR as a RPL border router
   SHOULD rewrite the RPI to indicate the selected Instance and set the flags,
   but it does not need to encapsulate the packet.<a href="#section-3-4" class="pilcrow">¶</a></p>
<p id="section-3-5">
   In Non-Storing Mode, packets going down carry a Source Routing Header (SRH).
   The IPv6-in-IPv6 encapsulation, the RPI and the SRH are collectively called the
   "RPL artifacts" and can be compressed using <span>[<a href="#RFC8138" class="xref">RFC8138</a>]</span>.
   <a href="#u8138" class="xref">Appendix A</a> presents an example compressed format for a packet
   forwarded by the Root to a RUL in a Storing Mode DODAG.<a href="#section-3-5" class="pilcrow">¶</a></p>
<p id="section-3-6">
   The inner packet that is forwarded to the RUL may carry some RPL artifacts,
   e.g., an RPI if the original packet was generated with it, and an SRH in a
   Non-Storing Mode DODAG.
   <span>[<a href="#I-D.ietf-roll-useofrplinfo" class="xref">USEofRPLinfo</a>]</span> expects the RUL to support the
   basic <span><a href="#RFC8504" class="xref">"IPv6 Node Requirements"</a> [<a href="#RFC8504" class="xref">RFC8504</a>]</span>.
   In particular the RUL is expected to ignore the RPL artifacts that are
   either consumed or not applicable to a host.<a href="#section-3-6" class="pilcrow">¶</a></p>
<p id="section-3-7">
   A RUL is not expected to support the compression method defined in
   <span>[<a href="#RFC8138" class="xref">RFC8138</a>]</span>. For that reason, the border router uncompresses
   the packet before forwarding it over an external route to a RUL
   <span>[<a href="#I-D.ietf-roll-useofrplinfo" class="xref">USEofRPLinfo</a>]</span>.<a href="#section-3-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="lpnd">
<section id="section-4">
      <h2 id="name-6lowpan-neighbor-discovery">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-6lowpan-neighbor-discovery" class="section-name selfRef">6LoWPAN Neighbor Discovery</a>
      </h2>
<p id="section-4-1">
This section goes through the 6LoWPAN ND mechanisms that this specification leverages, as a non-normative reference to the reader.
The full normative text is to be found in <span>[<a href="#RFC6775" class="xref">RFC6775</a>]</span>, <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span>, and <span>[<a href="#RFC8928" class="xref">RFC8928</a>]</span>.<a href="#section-4-1" class="pilcrow">¶</a></p>
<div id="R6775">
<section id="section-4.1">
        <h3 id="name-rfc-6775-address-registrati">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-rfc-6775-address-registrati" class="section-name selfRef">RFC 6775 Address Registration</a>
        </h3>
<p id="section-4.1-1">
   The classical "IPv6 Neighbor Discovery (IPv6 ND) Protocol"
   <span>[<a href="#RFC4861" class="xref">RFC4861</a>]</span> <span>[<a href="#RFC4862" class="xref">RFC4862</a>]</span> was defined for serial
   links and transit media such as Ethernet. It is a reactive protocol that
   relies heavily on multicast operations for Address Discovery (aka Lookup) and
   Duplicate Address Detection (DAD).<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">
   <span><a href="#RFC6775" class="xref">"Neighbor Discovery Optimizations for 6LoWPAN networks"</a> [<a href="#RFC6775" class="xref">RFC6775</a>]</span>
   adapts IPv6 ND for operations over energy-constrained LLNs.
   The main functions of <span>[<a href="#RFC6775" class="xref">RFC6775</a>]</span> are to proactively establish
   the Neighbor Cache Entry (NCE) in the 6LR and to prevent address duplication.
   To that effect, <span>[<a href="#RFC6775" class="xref">RFC6775</a>]</span> introduces a new unicast Address
   Registration  mechanism that contributes to reducing the use of multicast
   messages compared to the classical IPv6 ND protocol.<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1-3"><span>[<a href="#RFC6775" class="xref">RFC6775</a>]</span> defines a new Address
   Registration Option (ARO) that is carried in the unicast
   Neighbor solicitation (NS) and Neighbor Advertisement (NA) messages between
   the 6LoWPAN Node (6LN) and the 6LoWPAN router (6LR).

   It also defines the Duplicate Address Request (DAR) and Duplicate
   Address Confirmation (DAC) messages between the 6LR and the 6LoWPAN Border
   router (6LBR).
   In an LLN, the 6LBR is the central repository of all the Registered Addresses
   in its domain and the source of truth for uniqueness and ownership.<a href="#section-4.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="R8505E">
<section id="section-4.2">
        <h3 id="name-rfc-8505-extended-address-r">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-rfc-8505-extended-address-r" class="section-name selfRef">RFC 8505 Extended Address Registration</a>
        </h3>
<p id="section-4.2-1">
   <span><a href="#RFC8505" class="xref">"Registration Extensions for 6LoWPAN Neighbor Discovery"</a> [<a href="#RFC8505" class="xref">RFC8505</a>]</span>
   updates the behavior of RFC 6775 to enable a generic
   Address Registration to services such as routing and ND proxy, and defines the
   Extended Address Registration Option (EARO) as shown
   in <a href="#EARO" class="xref">Figure 2</a>:<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<span id="name-earo-option-format"></span><div id="EARO">
<figure id="figure-2">
          <div class="artwork art-text alignCenter" id="section-4.2-2.1">
<pre>
   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |     Type      |     Length    |    Status     |    Opaque     |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |  Rsvd | I |R|T|     TID       |     Registration Lifetime     |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                                                               |
 ...             Registration Ownership Verifier                 ...
  |                                                               |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-earo-option-format" class="selfRef">EARO Option Format</a>
          </figcaption></figure>
</div>
<div id="R8505ER">
<section id="section-4.2.1">
          <h4 id="name-r-flag">
<a href="#section-4.2.1" class="section-number selfRef">4.2.1. </a><a href="#name-r-flag" class="section-name selfRef">R Flag</a>
          </h4>
<p id="section-4.2.1-1">
<span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span> introduces the R Flag in the EARO.
   The Registering Node sets the R Flag to indicate whether the 6LR should
   ensure reachability for the Registered Address.
   If the R Flag is set to 0, then the Registering Node handles the reachability
   of the Registered Address by other means. In a RPL network, this means that
   either it is a RAN that injects the route by itself or that it uses another
   RPL router for reachability services.<a href="#section-4.2.1-1" class="pilcrow">¶</a></p>
<p id="section-4.2.1-2">
   This document specifies how the R Flag is used in the context of RPL.
   A RPL leaf that implements the 6LN functionality in <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span>
   requires reachability services for an IPv6 address if and only if it sets
   the R Flag in the NS(EARO) used to register the address to a 6LR acting as
   a RPL border router. Upon receiving the NS(EARO), the RPL router
   generates a DAO message for the Registered Address if and only if the R
   flag is set to 1.<a href="#section-4.2.1-2" class="pilcrow">¶</a></p>
<p id="section-4.2.1-3">
   <a href="#oper" class="xref">Section 9.2</a> specifies additional operations when R flag is set to 1 in an EARO that is placed either in an NS or an NA message.<a href="#section-4.2.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="R8505ETID">
<section id="section-4.2.2">
          <h4 id="name-tid-i-field-and-opaque-fiel">
<a href="#section-4.2.2" class="section-number selfRef">4.2.2. </a><a href="#name-tid-i-field-and-opaque-fiel" class="section-name selfRef">TID, "I" Field and Opaque Fields</a>
          </h4>
<p id="section-4.2.2-1">
   When the T Flag is set to 1, the EARO includes a sequence counter called
   Transaction ID (TID), that is needed to fill the Path Sequence Field in the
   RPL Transit Option.
   This is the reason why the support of <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span>
   by the RUL, as opposed to only <span>[<a href="#RFC6775" class="xref">RFC6775</a>]</span> is a prerequisite for
   this specification)/; this requirement is fully explained in
   <a href="#prereq6lp" class="xref">Section 5.1</a>. The EARO also
   transports an Opaque field and an associated "I" field that describes what
   the Opaque field transports and how to use it.<a href="#section-4.2.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2.2-2">
   <a href="#ln" class="xref">Section 9.2.1</a> specifies the use of the "I" field and the Opaque
   field by a RUL.<a href="#section-4.2.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="R8505EROVR">
<section id="section-4.2.3">
          <h4 id="name-route-ownership-verifier">
<a href="#section-4.2.3" class="section-number selfRef">4.2.3. </a><a href="#name-route-ownership-verifier" class="section-name selfRef">Route Ownership Verifier</a>
          </h4>
<p id="section-4.2.3-1">
   Section 5.3 of <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span> introduces the Registration
   Ownership Verifier (ROVR) field of variable length from 64 to 256 bits.
   The ROVR is a replacement of the EUI-64 in the ARO
   <span>[<a href="#RFC6775" class="xref">RFC6775</a>]</span> that was used to identify uniquely an Address
   Registration with the Link-Layer address of the owner but provided no
   protection against spoofing.<a href="#section-4.2.3-1" class="pilcrow">¶</a></p>
<p id="section-4.2.3-2">

   <span><a href="#RFC8928" class="xref">"Address Protected Neighbor Discovery for
   Low-power and Lossy Networks"</a> [<a href="#RFC8928" class="xref">RFC8928</a>]</span> leverages the ROVR field as a
   cryptographic proof of ownership to prevent a rogue third party from
   registering an address that is already owned.
   The use of ROVR field enables the 6LR to block traffic that is not
   sourced at an owned address.<a href="#section-4.2.3-2" class="pilcrow">¶</a></p>
<p id="section-4.2.3-3">

   This specification does not address how the protection by
   <span>[<a href="#RFC8928" class="xref">RFC8928</a>]</span> could be extended for use in RPL.
   On the other hand, it adds the ROVR to the DAO to build the proxied EDAR at the Root (see <a href="#tgt" class="xref">Section 6.1</a>), which means that nodes that are aware of the host route are also aware of the ROVR associated to the Target Address.<a href="#section-4.2.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="R8505D">
<section id="section-4.3">
        <h3 id="name-rfc-8505-extended-dar-dac">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-rfc-8505-extended-dar-dac" class="section-name selfRef">RFC 8505 Extended DAR/DAC</a>
        </h3>
<p id="section-4.3-1">
   <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span> updates the DAR/DAC messages into the Extended
   DAR/DAC to carry the ROVR field.
   The EDAR/EDAC exchange takes place
   between the 6LR and the 6LBR. It is triggered by an NS(EARO) message from a 6LN to create, refresh, and delete the corresponding state in the 6LBR.
   The exchange is protected by the retry mechanism (ARQ) specified in Section
   8.2.6 of <span>[<a href="#RFC6775" class="xref">RFC6775</a>]</span>, though in an LLN, a duration longer than
   the default value of the RetransTimer (RETRANS_TIMER)
 <span>[<a href="#RFC4861" class="xref">RFC4861</a>]</span> of 1 second may be necessary to
   cover the round trip delay between the 6LR and the 6LBR.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">
   RPL <span>[<a href="#RFC6550" class="xref">RFC6550</a>]</span> specifies a periodic DAO from the 6LN all the way to
   the Root that maintains the routing state in the RPL network for the lifetime
   indicated by the source of the DAO.
   This means that for each address, there are two keep-alive messages
   that traverse the whole network, one to the Root and one to the 6LBR.<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<p id="section-4.3-3">

   This specification avoids the periodic EDAR/EDAC exchange across the LLN.
   The 6LR turns
   the periodic NS(EARO) from the RUL into a DAO message to the
   Root on every refresh, but it only generates the EDAR upon the first
   registration, for the purpose of DAD, which must be verified before the
   address is injected in RPL.
   Upon the DAO message, the Root proxies the EDAR exchange to refresh the state at the 6LBR on behalf of the 6LR, as illustrated in <a href="#fReg2" class="xref">Figure 8</a> in <a href="#flow" class="xref">Section 9.1</a>.<a href="#section-4.3-3" class="pilcrow">¶</a></p>
<div id="R7400">
<section id="section-4.3.1">
          <h4 id="name-rfc-7400-capability-indicat">
<a href="#section-4.3.1" class="section-number selfRef">4.3.1. </a><a href="#name-rfc-7400-capability-indicat" class="section-name selfRef">RFC 7400 Capability Indication Option</a>
          </h4>
<p id="section-4.3.1-1">
   <span><a href="#RFC7400" class="xref">"6LoWPAN-GHC: Generic Header Compression for IPv6
   over Low-Power Wireless Personal Area Networks (6LoWPANs)"</a> [<a href="#RFC7400" class="xref">RFC7400</a>]</span> defines the
   6LoWPAN Capability Indication Option (6CIO) that enables a node to expose its
   capabilities in router Advertisement (RA) messages.<a href="#section-4.3.1-1" class="pilcrow">¶</a></p>
<p id="section-4.3.1-2">
   <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span> defines a number of bits in the 6CIO, in particular:<a href="#section-4.3.1-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel dlCompact" id="section-4.3.1-3">
            <dt id="section-4.3.1-3.1">L:</dt>
            <dd style="margin-left: 1.5em" id="section-4.3.1-3.2"> Node is a 6LR.<a href="#section-4.3.1-3.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.1-3.3">E:</dt>
            <dd style="margin-left: 1.5em" id="section-4.3.1-3.4"> Node is an IPv6 ND Registrar -- i.e., it supports
   registrations based on EARO.<a href="#section-4.3.1-3.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.1-3.5">P:</dt>
            <dd style="margin-left: 1.5em" id="section-4.3.1-3.6"> Node is a Routing Registrar, -- i.e., an IPv6 ND Registrar
         that also provides reachability services for the Registered Address.<a href="#section-4.3.1-3.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<span id="name-6cio-flags"></span><div id="CIO">
<figure id="figure-3">
            <div class="artwork art-text alignCenter" id="section-4.3.1-4.1">
<pre>
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Type      |   Length = 1  |     Reserved      |D|L|B|P|E|G|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                           Reserved                            |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-6cio-flags" class="selfRef">6CIO flags</a>
            </figcaption></figure>
</div>
<p id="section-4.3.1-5">

    A 6LR that provides reachability services for a RUL in a RPL network
    as specified in this document includes a 6CIO in its RA messages and
    set the L, P and E flags to 1 as prescribed by <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span>;
    this is fully explained in <a href="#oper" class="xref">Section 9.2</a>.<a href="#section-4.3.1-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="prereq">
<section id="section-5">
      <h2 id="name-requirements-on-the-rpl-unw">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-requirements-on-the-rpl-unw" class="section-name selfRef">Requirements on the RPL-Unware leaf</a>
      </h2>
<p id="section-5-1">
   This document describes how RPL routing can be extended to reach a RUL.
   This section specifies the minimal RPL-independent functionality that the RUL
   needs to implement to obtain routing services for its addresses.<a href="#section-5-1" class="pilcrow">¶</a></p>
<div id="prereq6lp">
<section id="section-5.1">
        <h3 id="name-support-of-6lowpan-nd">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-support-of-6lowpan-nd" class="section-name selfRef">Support of 6LoWPAN ND</a>
        </h3>
<p id="section-5.1-1">
   To obtain routing services from a router that implements this specification,
   a RUL needs to implement <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span> and sets the "R" and "T"
   flags in the EARO to 1 as discussed in <a href="#R8505ER" class="xref">Section 4.2.1</a> and
   <a href="#R8505EROVR" class="xref">Section 4.2.3</a>, respectively. <a href="#ln" class="xref">Section 9.2.1</a> specifies new behaviors for the RUL, e.g., when the R Flag set to 1 in a NS(EARO) is not echoed in the NA(EARO), which indicates that the route injection failed.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">
   The RUL is expected to request routing services from a router only if that router originates RA messages with a CIO that has the L, P, and E flags all set to 1
   as discussed in <a href="#R7400" class="xref">Section 4.3.1</a>, unless configured to do so.
   It is suggested that the RUL also implements
   <span>[<a href="#RFC8928" class="xref">RFC8928</a>]</span> to protect the ownership of its addresses.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1-3">
   A RUL that may attach to multiple 6LRs is expected to prefer those that provide routing services.
   The RUL needs to register to all the 6LRs from which it desires routing services.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
<p id="section-5.1-4">
   Parallel Address Registrations to several 6LRs should be performed in a rapid sequence, using the same EARO for the same Address. Gaps between
   the Address Registrations will invalidate some of the routes till the Address
   Registration finally shows on those routes.<a href="#section-5.1-4" class="pilcrow">¶</a></p>
<p id="section-5.1-5"><span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span> introduces error Status values in the NA(EARO)
   which can be received synchronously upon an NS(EARO) or asynchronously. The
   RUL needs to support both cases and refrain from using the address
   when the Status value indicates a rejection (see <a href="#stat" class="xref">Section 6.3</a>).<a href="#section-5.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="prereqv6ip">
<section id="section-5.2">
        <h3 id="name-support-of-ipv6-encapsulati">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-support-of-ipv6-encapsulati" class="section-name selfRef">Support of IPv6 Encapsulation</a>
        </h3>
<p id="section-5.2-1">
   Section 2.1 of <span>[<a href="#I-D.ietf-roll-useofrplinfo" class="xref">USEofRPLinfo</a>]</span> defines the rules
   for tunneling either to the final destination (e.g., a RUL) or to its
   attachment router (designated as 6LR). In order to terminate the IPv6-in-IPv6
   tunnel, the RUL, as an IPv6 host, would have to be capable of decapsulating
   the tunneled packet and either drop the encapsulated packet if it is not the
   final destination, or pass it to the upper layer for further processing.
   As indicated in section 4.1 of <span>[<a href="#I-D.ietf-roll-useofrplinfo" class="xref">USEofRPLinfo</a>]</span>,
   this is not mandated by <span>[<a href="#RFC8504" class="xref">RFC8504</a>]</span>, so the Root typically
   terminates the IPv6-in-IPv6 tunnel at the parent 6LR. It is thus not necessary
   for a RUL to support IPv6-in-IPv6 decapsulation.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="prereqv6hh">
<section id="section-5.3">
        <h3 id="name-support-of-the-hop-by-hop-h">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-support-of-the-hop-by-hop-h" class="section-name selfRef">Support of the Hop-by-Hop Header</a>
        </h3>
<p id="section-5.3-1">
   A RUL is expected to process an Option Type in a Hop-by-Hop Header as
   prescribed by section 4.2 of <span>[<a href="#RFC8200" class="xref">RFC8200</a>]</span>.
   An RPI with an Option Type of 0x23 <span>[<a href="#I-D.ietf-roll-useofrplinfo" class="xref">USEofRPLinfo</a>]</span> is thus skipped when not recognized.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="prereqv6rh">
<section id="section-5.4">
        <h3 id="name-support-of-the-routing-head">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-support-of-the-routing-head" class="section-name selfRef">Support of the Routing Header</a>
        </h3>
<p id="section-5.4-1">
   A RUL is expected to process an unknown Routing Header Type as
   prescribed by section 4.4 of <span>[<a href="#RFC8200" class="xref">RFC8200</a>]</span>.
   This implies that the Source Routing Header with a Routing Type of 3
   <span>[<a href="#RFC6554" class="xref">RFC6554</a>]</span> is ignored when the Segments Left is zero.<a href="#section-5.4-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="upd">
<section id="section-6">
      <h2 id="name-enhancements-to-rfc-6550">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-enhancements-to-rfc-6550" class="section-name selfRef">Enhancements to RFC 6550</a>
      </h2>
<p id="section-6-1">
   This document specifies a new behavior whereby a 6LR injects DAO messages
   for unicast addresses (see <a href="#op" class="xref">Section 9</a>) and multicast addresses
   (see <a href="#multiop" class="xref">Section 10</a>) on behalf of leaves that are not aware of RPL.
   The RUL addresses are exposed as external targets <span>[<a href="#RFC6550" class="xref">RFC6550</a>]</span>.
   Conforming to
   <span>[<a href="#I-D.ietf-roll-useofrplinfo" class="xref">USEofRPLinfo</a>]</span>, an IPv6-in-IPv6 encapsulation between the 6LR and the RPL Root is used to carry the RPL artifacts and remove them when forwarding outside the RPL domain, e.g., to a RUL.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">
   This document also synchronizes the liveness monitoring at the Root and the
   6LBR. The same value of lifetime is used for both, and a single keep-alive
   message, the RPL DAO, traverses the RPL network. A new behavior is introduced
   whereby the RPL Root proxies the EDAR message to the 6LBR on behalf of the
   6LR (see <a href="#upd2" class="xref">Section 8</a>), for any leaf node that implements the
   6LN functionality in <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span>.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">
   Section 6.7.7 of <span>[<a href="#RFC6550" class="xref">RFC6550</a>]</span> introduces the RPL Target Option,
   which can be used in RPL Control messages such as the DAO message to signal a
   destination prefix. This document adds the capabilities to
   transport the ROVR field (see <a href="#R8505EROVR" class="xref">Section 4.2.3</a>) and the
   IPv6 Address of the prefix advertiser when the Target is a shorter prefix.
   Their use is signaled respectively by a new ROVR Size field being non-zero
   and a new "Advertiser address in Full" 'F' flag set to 1, see <a href="#tgt" class="xref">Section 6.1</a>.<a href="#section-6-3" class="pilcrow">¶</a></p>
<p id="section-6-4">
   This specification defines a new flag, "Root Proxies EDAR/EDAC" (P), in the
   RPL DODAG Configuration option, see <a href="#pflag" class="xref">Section 6.2</a>.<a href="#section-6-4" class="pilcrow">¶</a></p>
<p id="section-6-5">
   The RPL Status defined in section 6.5.1 of <span>[<a href="#RFC6550" class="xref">RFC6550</a>]</span>
   for use in the DAO-ACK message is extended to be placed in DCO messages
   <span>[<a href="#I-D.ietf-roll-efficient-npdao" class="xref">EFFICIENT-NPDAO</a>]</span> as well. Furthermore, this
   specification enables to carry the EARO Status defined for 6LoWPAN ND
   in RPL DAO and DCO messages, embedded in a RPL Status, see
   <a href="#stat" class="xref">Section 6.3</a>.<a href="#section-6-5" class="pilcrow">¶</a></p>
<p id="section-6-6">
    Section 12 of <span>[<a href="#RFC6550" class="xref">RFC6550</a>]</span> details the RPL support for
    multicast flows when the RPLInstance is operated in the MOP of 3
    ("Storing Mode of Operation with multicast support").
    This specification extends the RPL Root operation to proxy-relay the MLDv2 <span>[<a href="#RFC3810" class="xref">RFC3810</a>]</span> operation between the RUL and the 6LR, see <a href="#multiop" class="xref">Section 10</a>.<a href="#section-6-6" class="pilcrow">¶</a></p>
<div id="tgt">
<section id="section-6.1">
        <h3 id="name-updated-rpl-target-option">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-updated-rpl-target-option" class="section-name selfRef">Updated RPL Target Option</a>
        </h3>
<p id="section-6.1-1"> This specification updates the RPL Target Option to transport the ROVR
    that was also defined for 6LoWPAN ND messages.
    This enables the RPL Root to generate the proxied EDAR message to the 6LBR.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">
   The Target Prefix of the RPL Target Option is left (high bit) justified and
   contains the advertised prefix; its size may be smaller than 128 when
   it indicates a Prefix route. The Prefix Length field signals the number
   of bits that correspond to the advertised Prefix; it is 128 for a
   host route or less in the case of a Prefix route. This remains unchanged.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<p id="section-6.1-3">
   This specification defines the new 'F' flag. When it is set to 1, the size of
   the Target Prefix field MUST be 128 bits and it MUST contain an IPv6 address
   of the advertising node taken from the advertised Prefix. In that case, the
   Target Prefix field carries two distinct pieces of information: a route that
   can be a host route or a Prefix route depending on the Prefix Length, and an
   IPv6 address that can be used to reach the advertising node and validate the
   route.<a href="#section-6.1-3" class="pilcrow">¶</a></p>
<p id="section-6.1-4">
   If the 'F' flag is set to 0, the Target Prefix field can be shorter than
   128 bits and it MUST be aligned to the next byte boundary after the end of
   the prefix.
   Any additional bits in the rightmost octet are filled with padding bits.
   Padding bits are reserved and set to 0 as specified in section 6.7.7 of
   <span>[<a href="#RFC6550" class="xref">RFC6550</a>]</span>.<a href="#section-6.1-4" class="pilcrow">¶</a></p>
<p id="section-6.1-5">
    With this specification the ROVR is the remainder of the RPL Target Option.
    The size of the ROVR is indicated in a new ROVR Size field that is encoded
    to map one-to-one with the Code Suffix in the EDAR message
    (see table 4 of <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span>). The ROVR Size field is taken
    from the flags field, which is an update to the RPL Target Option Flags IANA registry.<a href="#section-6.1-5" class="pilcrow">¶</a></p>
<p id="section-6.1-6">
    The updated format is illustrated in <a href="#frpltgt" class="xref">Figure 4</a>.
    It is backward compatible with the Target Option in
    <span>[<a href="#RFC6550" class="xref">RFC6550</a>]</span>.
    It is recommended that the updated format be used as a replacement in new
    implementations in all MOPs in preparation for upcoming Route Ownership Validation mechanisms based on the ROVR, unless the device or the network is
    so constrained that this is not feasible.<a href="#section-6.1-6" class="pilcrow">¶</a></p>
<span id="name-updated-target-option"></span><div id="frpltgt">
<figure id="figure-4">
          <div class="artwork art-text alignLeft" id="section-6.1-7.1">
<pre>
   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |   Type = 0x05 | Option Length |ROVRsz |F|Flags| Prefix Length |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                                                               |
  |                Target Prefix (Variable Length)                |
  .                                                               .
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                                                               |
 ...            Registration Ownership Verifier (ROVR)           ...
  |                                                               |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-updated-target-option" class="selfRef">Updated Target Option</a>
          </figcaption></figure>
</div>
<p id="section-6.1-8"> New fields:<a href="#section-6.1-8" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-6.1-9">
          <dt id="section-6.1-9.1">ROVRsz (ROVR Size):</dt>
          <dd style="margin-left: 1.5em" id="section-6.1-9.2">
            <p id="section-6.1-9.2.1"> Indicates the Size of the ROVR.
                        It SHOULD be 1, 2, 3, or 4, indicating a ROVR size of
                        64, 128, 192, or 256 bits, respectively.
                        If a legacy Target Option is used, then the value must
                        remain 0, as specified in <span>[<a href="#RFC6550" class="xref">RFC6550</a>]</span>.
                        In case of a value above 4, the size of the ROVR is
                        undetermined and this node cannot validate the ROVR;
                        an implementation SHOULD propagate the whole Target
                        Option upwards as received to enable the verification
                        by an ancestor that would support the upgraded ROVR.<a href="#section-6.1-9.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-9.3">F:</dt>
          <dd style="margin-left: 1.5em" id="section-6.1-9.4"> 1-bit flag. Set to 1 to indicate that Target Prefix field
    contains the complete (128 bit) IPv6 address of the advertising node.<a href="#section-6.1-9.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-9.5">Flags:</dt>
          <dd style="margin-left: 1.5em" id="section-6.1-9.6">  The 3 bits remaining unused in the Flags field are reserved for flags.  The field MUST be initialized to zero by the sender
         and MUST be ignored by the receiver.<a href="#section-6.1-9.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-9.7">Registration Ownership Verifier (ROVR):</dt>
          <dd style="margin-left: 1.5em" id="section-6.1-9.8">
                  This is the same field as in the EARO,
                  see <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span><a href="#section-6.1-9.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="pflag">
<section id="section-6.2">
        <h3 id="name-additional-flag-in-the-rpl-">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-additional-flag-in-the-rpl-" class="section-name selfRef">Additional Flag in the RPL DODAG Configuration Option</a>
        </h3>
<p id="section-6.2-1">
   The DODAG Configuration Option is defined in Section 6.7.6 of <span>[<a href="#RFC6550" class="xref">RFC6550</a>]</span>. Its purpose is extended to distribute configuration
   information affecting the construction and maintenance of the DODAG, as
   well as operational parameters for RPL on the DODAG, through the DODAG.

   This Option was originally designed with 4 bit positions reserved for future use as Flags.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<span id="name-dodag-configuration-option-"></span><div id="RPLDCO">
<figure id="figure-5">
          <div class="artwork art-text alignCenter" id="section-6.2-2.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Type = 0x04 |Opt Length = 14| |P| | |A|       ...           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                     +
                                |4 bits |
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-dodag-configuration-option-" class="selfRef">DODAG Configuration Option (Partial View)</a>
          </figcaption></figure>
</div>
<p id="section-6.2-3">
   This specification defines a new flag "Root Proxies EDAR/EDAC" (P).
   The 'P' flag is encoded
   in bit position 1 of the reserved Flags in the DODAG Configuration Option (counting from bit 0 as the most significant bit) and it is set to 0 in
   legacy implementations as specified respectively in Sections 20.14 and 6.7.6
   of <span>[<a href="#RFC6550" class="xref">RFC6550</a>]</span>.<a href="#section-6.2-3" class="pilcrow">¶</a></p>
<p id="section-6.2-4">
   The 'P' flag is set to 1 to indicate that the Root performs the proxy operation,
   which implies that it supports this specification and the updated RPL Target Option (see <a href="#tgt" class="xref">Section 6.1</a>).<a href="#section-6.2-4" class="pilcrow">¶</a></p>
<p id="section-6.2-5">
   Section 4.3 of <span>[<a href="#I-D.ietf-roll-useofrplinfo" class="xref">USEofRPLinfo</a>]</span> updates
   <span>[<a href="#RFC6550" class="xref">RFC6550</a>]</span> to indicate that the definition of the Flags applies to Mode of Operation (MOP) values zero (0) to six (6) only.
   For a MOP value of 7, the implementation MUST consider that the Root
   performs the proxy operation.<a href="#section-6.2-5" class="pilcrow">¶</a></p>
<p id="section-6.2-6">
   The RPL DODAG Configuration Option is typically placed in
   a DODAG Information Object (DIO) message. The DIO message propagates down the
   DODAG to form and then maintain its structure. The DODAG Configuration Option
   is copied unmodified from parents to children.
   <span>[<a href="#RFC6550" class="xref">RFC6550</a>]</span> states that "Nodes other than the DODAG Root MUST
   NOT modify this information when propagating the DODAG Configuration option".
   Therefore, a legacy parent propagates the 'P' Flag as set by the Root, and
   when the 'P' Flag is set to 1, it is transparently flooded to all the nodes
   in the DODAG.<a href="#section-6.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="stat">
<section id="section-6.3">
        <h3 id="name-updated-rpl-status">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-updated-rpl-status" class="section-name selfRef">Updated RPL Status</a>
        </h3>
<p id="section-6.3-1">The RPL Status is defined in section 6.5.1 of <span>[<a href="#RFC6550" class="xref">RFC6550</a>]</span>
    for use in the DAO-ACK message and values are assigned as follows:<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<span id="name-rpl-status-per-rfc-6550"></span><div id="irplStatusbl">
<table class="center" id="table-1">
          <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-rpl-status-per-rfc-6550" class="selfRef">RPL Status per RFC 6550</a>
          </caption>
<thead>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Range</td>
              <td class="text-left" rowspan="1" colspan="1">Meaning</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0</td>
              <td class="text-left" rowspan="1" colspan="1">Success/Unqualified acceptance</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1-127</td>
              <td class="text-left" rowspan="1" colspan="1">Not an outright rejection</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">128-255</td>
              <td class="text-left" rowspan="1" colspan="1">Rejection</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-6.3-3">

    The 6LoWPAN ND Status was defined for use in the EARO, see section 4.1 of
    <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span>.
    This specification adds a capability to allow the carriage of 6LoWPAN ND
    Status values in RPL DAO and DCO messages, embedded in the RPL Status field.<a href="#section-6.3-3" class="pilcrow">¶</a></p>
<p id="section-6.3-4">
    To achieve this, the range of the ARO/EARO Status values is reduced to 0-63, which updates the IANA registry created for <span>[<a href="#RFC6775" class="xref">RFC6775</a>]</span>.
    This reduction ensures that the values fit within a RPL Status as shown in
    <a href="#rpst" class="xref">Figure 6</a>. See <a href="#iana-aro" class="xref">Section 12.2</a>,
    <a href="#iana-stats-nonrej" class="xref">Section 12.5</a>, and <a href="#iana-stats-rej" class="xref">Section 12.6</a>
    for the respective IANA declarations.<a href="#section-6.3-4" class="pilcrow">¶</a></p>
<span id="name-rpl-status-format"></span><div id="rpst">
<figure id="figure-6">
          <div class="artwork art-text alignCenter" id="section-6.3-5.1">
<pre>
    0 1 2 3 4 5 6 7
   +-+-+-+-+-+-+-+-+
   |E|A|StatusValue|
   +-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-rpl-status-format" class="selfRef">RPL Status Format</a>
          </figcaption></figure>
</div>
<p id="section-6.3-6"> This specification updates the RPL Status with subfields as indicated below:<a href="#section-6.3-6" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-6.3-7">
          <dt id="section-6.3-7.1">E:</dt>
          <dd style="margin-left: 1.5em" id="section-6.3-7.2"> 1-bit flag. set to 1 to indicate a rejection. When set to 0, a Status value of 0
    indicates Success/Unqualified acceptance and other values indicate "not an
    outright rejection" as per RFC 6550.<a href="#section-6.3-7.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.3-7.3">A:</dt>
          <dd style="margin-left: 1.5em" id="section-6.3-7.4"> 1-bit flag. Indicates the type of the RPL Status value.<a href="#section-6.3-7.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.3-7.5">Status Value:</dt>
          <dd style="margin-left: 1.5em" id="section-6.3-7.6"> 6-bit unsigned integer. If the 'A' flag is set to 1 this
    field transports a Status value defined for IPv6 ND EARO. When the 'A' flag
    is set to 0, the Status value is defined for RPL.<a href="#section-6.3-7.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-6.3-8">
   When building a DCO or a DAO-ACK message upon an IPv6 ND NA or a EDAC message,
   the RPL Root MUST copy the 6LoWPAN ND status code unchanged in the RPL Status value and set the 'A' flag to 1.
   The RPL Root MUST set the 'E' flag to 1 for all rejection and unknown status codes.  The status codes in the 1-10 range <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span> are all considered rejections.<a href="#section-6.3-8" class="pilcrow">¶</a></p>
<p id="section-6.3-9">
   Reciprocally, upon a DCO or a DAO-ACK message from the RPL Root with a RPL
   Status that has the 'A' flag set, the 6LR MUST copy the RPL Status value
   unchanged in the Status field of the EARO when generating an NA to the RUL.<a href="#section-6.3-9" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="updnpdao">
<section id="section-7">
      <h2 id="name-enhancements-to-draft-ietf-">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-enhancements-to-draft-ietf-" class="section-name selfRef">Enhancements to draft-ietf-roll-efficient-npdao</a>
      </h2>
<p id="section-7-1">
<span>[<a href="#I-D.ietf-roll-efficient-npdao" class="xref">EFFICIENT-NPDAO</a>]</span> defines the DCO message for RPL Storing Mode only, with a link-local scope. All nodes in the RPL network are expected to support the specification since the message is processed hop by hop along the path that is being cleaned up.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">
This specification extends the use of the DCO message to the Non-Storing MOP, whereby the DCO is sent end-to-end by the Root directly to the RAN that injected the DAO message for the considered target.
In that case, intermediate nodes do not need to support <span>[<a href="#I-D.ietf-roll-efficient-npdao" class="xref">EFFICIENT-NPDAO</a>]</span>; they forward the DCO message as a plain IPv6 packet between the Root and the RAN.<a href="#section-7-2" class="pilcrow">¶</a></p>
<p id="section-7-3">
In the case of a RUL, the 6LR that serves the RUL acts as the RAN that receives
the Non-Storing DCO.
This specification leverages the Non-Storing DCO between the Root and the 6LR that serves as attachment router for a RUL. A 6LR and a Root that support this specification MUST implement the Non-Storing DCO.<a href="#section-7-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="upd2">
<section id="section-8">
      <h2 id="name-enhancements-to-rfc-6775-an">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-enhancements-to-rfc-6775-an" class="section-name selfRef">Enhancements to RFC 6775 and RFC8505</a>
      </h2>
<p id="section-8-1">
   This document updates <span>[<a href="#RFC6775" class="xref">RFC6775</a>]</span> and <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span>
   to reduce the range of the ND status codes down to 64 values. The two most significant (leftmost) bits if the original ND status field are now reserved, they MUST be set to zero by the sender and ignored by the receiver.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">
   This document also changes the behavior of a 6LR acting as RPL router and of a 6LN acting as RUL in the 6LoWPAN ND Address Registration  as follows:<a href="#section-8-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8-3.1">
   If the RPL Root advertises the capability to proxy the EDAR/EDAC
   exchange to the 6LBR, the 6LR refrains from sending the keep-alive EDAR
   message. If it is separated from the 6LBR, the Root regenerates the
   EDAR message to the 6LBR periodically, upon a DAO message that signals the liveliness of the address.<a href="#section-8-3.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-8-3.2">
   The use of the R Flag is extended to the NA(EARO) to confirm whether the route was installed.<a href="#section-8-3.2" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="op">
<section id="section-9">
      <h2 id="name-protocol-operations-for-uni">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-protocol-operations-for-uni" class="section-name selfRef">Protocol Operations for Unicast Addresses</a>
      </h2>
<p id="section-9-1">

  The description below assumes that the Root sets the 'P' flag in the
  DODAG Configuration Option and performs the EDAR proxy operation presented in
  <a href="#R8505D" class="xref">Section 4.3</a> .<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">
  If the 'P' flag is set to 0, the 6LR MUST generate the periodic EDAR messages and
  process the returned status as specified in <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span>.
  If the EDAC indicates success, the rest of the flow takes place as presented
  but without the proxied EDAR/EDAC exchange.<a href="#section-9-2" class="pilcrow">¶</a></p>
<p id="section-9-3">
  <a href="#flow" class="xref">Section 9.1</a> provides an overview of the route injection in RPL, whereas <a href="#oper" class="xref">Section 9.2</a> offers more details from the perspective of the
  different nodes involved in the flow.<a href="#section-9-3" class="pilcrow">¶</a></p>
<div id="flow">
<section id="section-9.1">
        <h3 id="name-general-flow">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-general-flow" class="section-name selfRef">General Flow</a>
        </h3>
<p id="section-9.1-1">
   This specification eliminates the need to exchange keep-alive Extended
   Duplicate Address messages, EDAR and EDAC, all the way from a 6LN to the 6LBR
   across a RPL mesh. Instead, the EDAR/EDAC exchange with the 6LBR is proxied
   by the RPL Root upon the DAO message that refreshes the RPL routing state.
   The first EDAR upon a new Registration cannot be proxied, though, as it
   serves for the purpose of DAD, which must be verified before the address is
   injected in RPL.<a href="#section-9.1-1" class="pilcrow">¶</a></p>
<p id="section-9.1-2">
   In a RPL
   network where the function is enabled, refreshing the state in the 6LBR is
   the responsibility of the Root. Consequently, only addresses that are
   injected in RPL will be kept alive at the 6LBR by the RPL Root.
   Since RULs are advertised using Non-Storing Mode, the DAO message flow
   and the keep alive EDAR/EDAC can be nested within the Address
   (re)Registration flow.
   <a href="#fReg1" class="xref">Figure 7</a> illustrates that, for the first Registration,
   both the DAD and the keep-alive EDAR/EDAC exchanges happen in the same
   sequence.<a href="#section-9.1-2" class="pilcrow">¶</a></p>
<span id="name-first-rul-registration-flow"></span><div id="fReg1">
<figure id="figure-7">
          <div class="artwork art-text alignCenter" id="section-9.1-3.1">
<pre>


   6LN/RUL            6LR   &lt;6LR*&gt;   Root               6LBR
      |                |              |                   |
      |&lt;------ND------&gt;|&lt;----RPL-----&gt;|&lt;-------ND--------&gt;|
      |                |&lt;----------------ND--------------&gt;|
      |                |              |                   |
      |   NS(EARO)     |              |                   |
      |---------------&gt;|                                  |
      |                |            EDAR                  |
      |                |---------------------------------&gt;|
      |                |                                  |
      |                |             EDAC                 |
      |                |&lt;---------------------------------|
      |                |      DAO     |                   |
      |                |-------------&gt;|                   |
      |                |              |       EDAR        |
      |                |              |------------------&gt;|
      |                |              |       EDAC        |
      |                |              |&lt;------------------|
      |                |    DAO-ACK   |                   |
      |                |&lt;-------------|                   |
      |   NA(EARO)     |              |                   |
      |&lt;---------------|              |                   |
      |                |              |                   |
</pre>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-first-rul-registration-flow" class="selfRef">First RUL Registration Flow</a>
          </figcaption></figure>
</div>
<p id="section-9.1-4">
   This flow requires that the lifetimes and sequence counters in 6LoWPAN ND and RPL are aligned.<a href="#section-9.1-4" class="pilcrow">¶</a></p>
<p id="section-9.1-5">
   To achieve this, the Path
   Sequence and the Path Lifetime in the DAO message are taken from the
   Transaction ID and the Address Registration lifetime in the NS(EARO) message
   from the 6LN.<a href="#section-9.1-5" class="pilcrow">¶</a></p>
<p id="section-9.1-6">
   On the first Address Registration, illustrated in <a href="#fReg1" class="xref">Figure 7</a>
   for RPL Non-Storing Mode, the Extended Duplicate Address exchange takes place
   as prescribed by <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span>. If the exchange fails, the 6LR returns an NA message with a non-zero status to the 6LN, the NCE is not created, and the address is not injected in RPL.

   Otherwise, the 6LR creates an NCE and injects the Registered
   Address in the RPL routing using a DAO/DAO-ACK exchange with the RPL DODAG
   Root.<a href="#section-9.1-6" class="pilcrow">¶</a></p>
<p id="section-9.1-7">
    An Address Registration refresh is performed by the 6LN to maintain the NCE
    in the 6LR alive before the lifetime expires. Upon the refresh of a
    registration, the 6LR reinjects the corresponding route in RPL before it expires, as illustrated in <a href="#fReg2" class="xref">Figure 8</a>.<a href="#section-9.1-7" class="pilcrow">¶</a></p>
<span id="name-next-rul-registration-flow"></span><div id="fReg2">
<figure id="figure-8">
          <div class="artwork art-text alignCenter" id="section-9.1-8.1">
<pre>
   6LN/RUL   &lt;-ND-&gt;   6LR   &lt;-RPL-&gt;  Root   &lt;-ND-&gt;      6LBR
      |                |              |                   |
      |   NS(EARO)     |              |                   |
      |---------------&gt;|              |                   |
      |                |      DAO     |                   |
      |                |-------------&gt;|                   |
      |                |              |       EDAR        |
      |                |              |------------------&gt;|
      |                |              |       EDAC        |
      |                |              |&lt;------------------|
      |                |    DAO-ACK   |                   |
      |                |&lt;-------------|                   |
      |   NA(EARO)     |              |                   |
      |&lt;---------------|              |                   |
</pre>
</div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a>:
<a href="#name-next-rul-registration-flow" class="selfRef">Next RUL Registration Flow</a>
          </figcaption></figure>
</div>
<p id="section-9.1-9">
    This is what causes the RPL Root to refresh the state in the 6LBR, using an
    EDAC message.
    In case of an error in the proxied EDAR flow, the error is
    returned in the DAO-ACK using a RPL Status with the 'A' flag set to 1 that imbeds
    a 6LoWPAN Status value as discussed in <a href="#stat" class="xref">Section 6.3</a>.<a href="#section-9.1-9" class="pilcrow">¶</a></p>
<p id="section-9.1-10">

    The 6LR may receive a requested DAO-ACK after it received an asynchronous
    Non-Storing DCO, but the non-zero status in the DCO supersedes a positive
    Status in the DAO-ACK regardless of the order in which they are received.
    Upon the DAO-ACK - or the DCO if one arrives first - the 6LR responds to the
    RUL with an NA(EARO).<a href="#section-9.1-10" class="pilcrow">¶</a></p>
<p id="section-9.1-11">
   An issue may be detected later, e.g., the address moves to a different
   DODAG with the 6LBR attached to a different 6LoWPAN Backbone router (6BBR),
   see Figure 5 in section 3.3 of <span>[<a href="#RFC8929" class="xref">RFC8929</a>]</span>.
   The 6BBR may send a negative ND status, e.g., in an asynchronous NA(EARO)
   to the 6LBR.<a href="#section-9.1-11" class="pilcrow">¶</a></p>
<p id="section-9.1-12">
   <span>[<a href="#RFC8929" class="xref">RFC8929</a>]</span> expects that the 6LBR is collocated with the RPL Root,  but if not, the 6LBR MUST forward the status code to the originator of the EDAR, either the 6LR or the RPL Root that proxies for it.
   The ND status code is mapped in a RPL Status value by the RPL Root, and then back by the 6LR.<a href="#section-9.1-12" class="pilcrow">¶</a></p>
<p id="section-9.1-13">

   <a href="#fReg1.5" class="xref">Figure 9</a> illustrates this in the case where the 6LBR and the Root are not collocated, and the Root proxies the EDAR messages.<a href="#section-9.1-13" class="pilcrow">¶</a></p>
<span id="name-asynchronous-issue"></span><div id="fReg1.5">
<figure id="figure-9">
          <div class="artwork art-text alignCenter" id="section-9.1-14.1">
<pre>
6LN/RUL  &lt;-ND-&gt;  6LR  &lt;-RPL-&gt;  Root  &lt;-ND-&gt;  6LBR  &lt;-ND-&gt;  6BBR
   |              |             |              |             |
   |              |             |              |   NA(EARO)  |
   |              |             |              |&lt;------------|
   |              |             |     EDAC     |             |
   |              |             |&lt;-------------|             |
   |              |     DCO     |              |             |
   |              |&lt;------------|              |             |
   |   NA(EARO)   |             |              |             |
   |&lt;-------------|             |              |             |
   |              |             |              |             |
</pre>
</div>
<figcaption><a href="#figure-9" class="selfRef">Figure 9</a>:
<a href="#name-asynchronous-issue" class="selfRef">Asynchronous Issue</a>
          </figcaption></figure>
</div>
<p id="section-9.1-15">

   If the Root does not proxy, then the EDAC with a non-zero status reaches the
   6LR directly. In that case, the 6LR MUST clean up the route using a DAO with
   a Lifetime of zero, and it MUST propagate the status back to the RUL in a NA(EARO) with the R Flag set to 0.<a href="#section-9.1-15" class="pilcrow">¶</a></p>
<p id="section-9.1-16">
    The RUL may terminate the registration at any time by using a Registration
    Lifetime of 0.
    This specification requires that the RPL Target Option transports the ROVR.
    This way, the same flow as the heartbeat flow is sufficient to inform the
    6LBR using the Root as proxy, as illustrated in <a href="#fReg2" class="xref">Figure 8</a>.<a href="#section-9.1-16" class="pilcrow">¶</a></p>
<p id="section-9.1-17">
    Any combination of the logical functions of 6LR, Root, and 6LBR might be
   collapsed in a single node.<a href="#section-9.1-17" class="pilcrow">¶</a></p>
</section>
</div>
<div id="oper">
<section id="section-9.2">
        <h3 id="name-detailed-operation">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-detailed-operation" class="section-name selfRef">Detailed Operation</a>
        </h3>
<p id="section-9.2-1">
   The following section specify respectively the behaviour of the 6LN Acting
   as RUL, the 6LR Acting as Border router ad serving the 6LN, the RPL Root and
   the 6LBR in the control flows that enable RPL routing back to the RUL.<a href="#section-9.2-1" class="pilcrow">¶</a></p>
<div id="ln">
<section id="section-9.2.1">
          <h4 id="name-perspective-of-the-6ln-acti">
<a href="#section-9.2.1" class="section-number selfRef">9.2.1. </a><a href="#name-perspective-of-the-6ln-acti" class="section-name selfRef">Perspective of the 6LN Acting as RUL</a>
          </h4>
<p id="section-9.2.1-1">
  This specification does not alter the operation of a 6LoWPAN ND-compliant
  6LN/RUL, which is expected to operate as follows:<a href="#section-9.2.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-9.2.1-2">
<li id="section-9.2.1-2.1">
    The 6LN selects a 6LR that provides reachability services for a RUL. This
    is signaled a 6CIO in the RA messages with the L, P and E flags set to 1
    as prescribed by <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span>.<a href="#section-9.2.1-2.1" class="pilcrow">¶</a>
</li>
            <li id="section-9.2.1-2.2">
   The 6LN obtains an IPv6 global address, either using Stateless Address Autoconfiguration (SLAAC) <span>[<a href="#RFC4862" class="xref">RFC4862</a>]</span> based on a Prefix
   Information Option (PIO) <span>[<a href="#RFC4861" class="xref">RFC4861</a>]</span> found in an RA message, or
   some other means, such as DHCPv6 <span>[<a href="#RFC8415" class="xref">RFC8415</a>]</span>.<a href="#section-9.2.1-2.2" class="pilcrow">¶</a>
</li>
            <li id="section-9.2.1-2.3">
   Once it has formed an address, the 6LN registers its address and refreshes its registration periodically, early enough
   within the Lifetime of the previous Address Registration, as prescribed by
   <span>[<a href="#RFC6775" class="xref">RFC6775</a>]</span>, to refresh the NCE before the lifetime indicated
   in the EARO expires. It sets the T Flag to 1 as prescribed in <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span>.
   The TID is incremented each time and wraps in a lollipop fashion (see
   section 5.2.1 of <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span>, which is fully compatible with
   section 7.2 of <span>[<a href="#RFC6550" class="xref">RFC6550</a>]</span>).<a href="#section-9.2.1-2.3" class="pilcrow">¶</a>
</li>
            <li id="section-9.2.1-2.4">
   As stated in section 5.2 of <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span>, the 6LN can register
   to more than one 6LR at the same time. In that case, it
   uses the same EARO for all of the parallel Address Registrations, with the exception of the Registration Lifetime field and the setting of the R flag that may differ.

   The 6LN may cancel a subset of its registrations, or transfer a
   registration from one or more old 6LR(s) to one or more new 6LR(s). To do
   so, the 6LN sends a series of NS(EARO) messages, all with the same TID,
   with a zero Registration Lifetime to the old 6LR(s) and
   with a non-zero Registration Lifetime to the new 6LR(s). In that process,
   the 6LN SHOULD send the NS(EARO) with a non-zero Registration Lifetime and
   ensure that at least one succeeds before it sends an NS(EARO) that
   terminates another registration. This avoids the churn related to transient
   route invalidation in the RPL network above the common parent of the
   involved 6LRs.<a href="#section-9.2.1-2.4" class="pilcrow">¶</a>
</li>
            <li id="section-9.2.1-2.5">
              

  Following section 5.1 of <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span>,
  a 6LN acting as a RUL sets the R Flag in the EARO of its registration(s)
  for which it requires routing services. If the R Flag is not echoed in the
  NA, the RUL SHOULD attempt to use another 6LR.  The RUL SHOULD ensure that one registration succeeds before setting the R Flag to 0.  In case of a
  conflict
  with the preceding rule on lifetime, the rule on lifetime has precedence.<a href="#section-9.2.1-2.5" class="pilcrow">¶</a>
</li>
            <li id="section-9.2.1-2.6">
   The 6LN may use any of the 6LRs to which it registered as the default
   gateway.
   Using a 6LR to which the 6LN is not registered may result in packets dropped
   at the 6LR by a Source Address Validation function (SAVI) <span>[<a href="#RFC7039" class="xref">RFC7039</a>]</span> so it is not recommended.<a href="#section-9.2.1-2.6" class="pilcrow">¶</a>
</li>
          </ol>
<p id="section-9.2.1-3">
   Even without support for RPL, the RUL may be configured with an opaque value
   to be provided to the routing protocol. If the RUL has knowledge of the RPL
   Instance the packet should be injected into, then it SHOULD set the Opaque
   field in the EARO to the RPLInstanceID, otherwise it MUST leave the Opaque
   field as zero.<a href="#section-9.2.1-3" class="pilcrow">¶</a></p>
<p id="section-9.2.1-4">
   Regardless of the setting of the Opaque field, the 6LN MUST set the "I"
   field to zero to signal "topological information to be passed to a routing
   process", as specified in section 5.1 of <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span>.<a href="#section-9.2.1-4" class="pilcrow">¶</a></p>
<p id="section-9.2.1-5">
   A RUL is not expected to produce RPL artifacts in the data packets, but it
   may do so. For instance, if the RUL has minimal awareness of the RPL
   Instance then it can build an RPI. A RUL that places an RPI in a data packet
   SHOULD indicate the RPLInstanceID of the RPL Instance where the
   packet should be forwarded. It is up to the 6LR (e.g., by policy) to use the
   RPLInstanceID information provided by the RUL or rewrite it to the selected
   RPLInstanceID for forwarding inside the RPL domain.
   All the flags and the Rank field are set
   to 0 as specified by section 11.2 of <span>[<a href="#RFC6550" class="xref">RFC6550</a>]</span>.<a href="#section-9.2.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="lr">
<section id="section-9.2.2">
          <h4 id="name-perspective-of-the-6lr-acti">
<a href="#section-9.2.2" class="section-number selfRef">9.2.2. </a><a href="#name-perspective-of-the-6lr-acti" class="section-name selfRef">Perspective of the 6LR Acting as Border router</a>
          </h4>
<p id="section-9.2.2-1">
    A 6LR that provides reachability services for a RUL in a RPL network
    as specified in this document MUST include a 6CIO in its RA messages and
    set the L, P and E flags to 1 as prescribed by <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span>.<a href="#section-9.2.2-1" class="pilcrow">¶</a></p>
<p id="section-9.2.2-2">
   As prescribed by <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span>,
   the 6LR generates an EDAR message upon reception of a valid NS(EARO)
   message for the registration of a new IPv6 address by a 6LN.
   If the initial EDAR/EDAC exchange succeeds, then the 6LR installs an NCE
   for the Registration Lifetime. For the registration refreshes, if the RPL Root has indicated that it proxies the keep-alive EDAR/EDAC exchange with the 6LBR (see <a href="#upd" class="xref">Section 6</a>), the 6LR MUST refrain from sending the keep-alive EDAR.<a href="#section-9.2.2-2" class="pilcrow">¶</a></p>
<p id="section-9.2.2-3">
   If the R Flag is set to 1 in the NS(EARO), the 6LR SHOULD inject the
   host route in RPL, unless this is barred for other reasons, such as the saturation of the RPL parents. The 6LR MUST use a RPL Non-Storing Mode
   signaling and the updated Target Option (see <a href="#tgt" class="xref">Section 6.1</a>). The 6LR MUST request a DAO-ACK by setting the 'K' flag in the DAO message. Success
   injecting the route to the RUL's address is indicated by the 'E' flag
   set to 0 in the RPL status of the DAO-ACK message.<a href="#section-9.2.2-3" class="pilcrow">¶</a></p>
<p id="section-9.2.2-4">
   The Opaque field in the EARO provides a means to signal which RPL Instance is to be used for the DAO advertisements and the forwarding of packets sourced at the Registered Address when there is no RPI in the packet.<a href="#section-9.2.2-4" class="pilcrow">¶</a></p>
<p id="section-9.2.2-5">
   As described in <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span>, if the "I" field is zero, then the Opaque field is expected to carry the RPLInstanceID suggested by the 6LN; otherwise, there is no suggested Instance.
   If the 6LR participates in the suggested RPL Instance, then the
   6LR MUST use that RPL Instance for the Registered Address.<a href="#section-9.2.2-5" class="pilcrow">¶</a></p>
<p id="section-9.2.2-6">
   If there is no suggested RPL Instance or else if the 6LR does not participate to the suggested Instance, it is expected that the packets coming from the 6LN "can unambiguously be associated to at least one RPL Instance" <span>[<a href="#RFC6550" class="xref">RFC6550</a>]</span> by the 6LR, e.g., using a policy that
   maps the 6-tuple into an Instance.<a href="#section-9.2.2-6" class="pilcrow">¶</a></p>
<p id="section-9.2.2-7">
  The DAO message advertising the Registered Address MUST be constructed as
  follows:<a href="#section-9.2.2-7" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-9.2.2-8">
  <li id="section-9.2.2-8.1">The Registered Address is signaled as the Target Prefix in the updated Target Option in the DAO message; the Prefix Length is set to 128 but the 'F' flag is set to 0 since the advertiser is not the RUL. The ROVR field is copied unchanged from the EARO (see <a href="#tgt" class="xref">Section 6.1</a>).<a href="#section-9.2.2-8.1" class="pilcrow">¶</a>
</li>
            <li id="section-9.2.2-8.2">
  The 6LR indicates one of its global or unique-local IPv6 unicast addresses as the Parent Address in the RPL Transit Information Option (TIO) associated with the Target Option<a href="#section-9.2.2-8.2" class="pilcrow">¶</a>
</li>
            <li id="section-9.2.2-8.3">
  The 6LR sets the External 'E' flag in the TIO to indicate that it is redistributing
  an external target into the RPL network<a href="#section-9.2.2-8.3" class="pilcrow">¶</a>
</li>
            <li id="section-9.2.2-8.4">
              <p id="section-9.2.2-8.4.1">
  the Path Lifetime in the TIO is computed from the Registration Lifetime in the EARO. This operation converts seconds to the Lifetime Units used in the RPL operation. This creates the deployment constraint that the Lifetime Unit is reasonably compatible with the expression of the Registration Lifetime. e.g., a Lifetime Unit of 0x4000 maps the most significant byte of the Registration Lifetime to the Path Lifetime.<a href="#section-9.2.2-8.4.1" class="pilcrow">¶</a></p>
<p id="section-9.2.2-8.4.2">
  In that operation, the Path Lifetime must be rounded, if needed, to the upper value to ensure that the path has a longer lifetime than the registration.<a href="#section-9.2.2-8.4.2" class="pilcrow">¶</a></p>
<p id="section-9.2.2-8.4.3">
  Note that if the Registration Lifetime is 0, then the Path Lifetime is also 0 and the DAO message becomes a No-Path DAO, which cleans up the routes down to the RUL's address; this also causes the Root as a proxy to send an EDAR message to the 6LBR with a Lifetime of 0.<a href="#section-9.2.2-8.4.3" class="pilcrow">¶</a></p>
</li>
            <li id="section-9.2.2-8.5">
  the Path Sequence in the TIO is set to the TID value found in the EARO option.<a href="#section-9.2.2-8.5" class="pilcrow">¶</a>
</li>
          </ol>
<p id="section-9.2.2-9">

   Upon receiving or timing out the DAO-ACK after an implementation-specific number of retries, the 6LR MUST send the corresponding NA(EARO) to the RUL. Upon receiving an asynchronous DCO message, if a DAO-ACK is pending then the 6LR MUST wait for the DAO-ACK to send the NA(EARO) and deliver the status found in the DCO, else it MUST send an asynchronous NA(EARO) to the RUL immediately.<a href="#section-9.2.2-9" class="pilcrow">¶</a></p>
<p id="section-9.2.2-10">
   The 6LR MUST set the R Flag to 1 in the NA(EARO) back if and only if the 'E' flag is set to 0, indicating that the 6LR injected the Registered Address in the RPL routing successfully and that the EDAR proxy operation succeeded.<a href="#section-9.2.2-10" class="pilcrow">¶</a></p>
<p id="section-9.2.2-11">

   If the 'A' flag in the RPL Status is set to 1, the embedded Status value is passed
   back to the RUL in the EARO Status.
   If the 'E' flag is also set to 1, the registration failed for
   6LoWPAN ND related reasons, and the NCE is removed.<a href="#section-9.2.2-11" class="pilcrow">¶</a></p>
<p id="section-9.2.2-12">

   An error injecting the route causes the 'E' flag to be set to 1. If the error is not related to ND, the 'A' flag is set to 0. In that case, the registration succeeds, but the RPL route is not installed. So the NA(EARO) is returned
   with a status indicating success but the R Flag set to 0, which means that
   the 6LN obtained a binding but no route.<a href="#section-9.2.2-12" class="pilcrow">¶</a></p>
<p id="section-9.2.2-13">
   If the 'A' flag is set to 0 in the RPL Status of the DAO-ACK, then the 6LoWPAN
   ND operation succeeded, and an EARO Status of 0 (Success) MUST be returned to
   the 6LN. The EARO Status of 0 MUST also be used if the 6LR did not attempt to inject the route but could create the binding after a successful EDAR/EDAC exchange or refresh it.<a href="#section-9.2.2-13" class="pilcrow">¶</a></p>
<p id="section-9.2.2-14">
   If the 'E' flag is set to 1 in the RPL Status of the DAO-ACK, then the route was not installed and the R flag MUST be set to 0 in the NA(EARO). The R flag MUST be set to 0 if the 6LR did not attempt to inject the route.<a href="#section-9.2.2-14" class="pilcrow">¶</a></p>
<p id="section-9.2.2-15">
   In a network where Address Protected Neighbor Discovery (AP-ND) is enabled,
   in case of a DAO-ACK or a DCO indicating transporting an EARO
   Status value of 5 (Validation Requested), the 6LR MUST
   challenge the 6LN for ownership of the address, as described in section
   6.1 of <span>[<a href="#RFC8928" class="xref">RFC8928</a>]</span>, before the Registration is
   complete. This flow, illustrated in <a href="#Dynamic-fig" class="xref">Figure 10</a>, ensures that the address is validated before it is injected in the RPL routing.<a href="#section-9.2.2-15" class="pilcrow">¶</a></p>
<p id="section-9.2.2-16">
   If the challenge succeeds, then the operations continue as normal.
   In particular, a DAO message is generated
   upon the NS(EARO) that proves the ownership of the address. If the challenge
   failed, the 6LR rejects the registration as prescribed by AP-ND and may take
   actions to protect itself against DoS attacks by a rogue 6LN, see
   <a href="#security-considerations" class="xref">Section 11</a>.<a href="#section-9.2.2-16" class="pilcrow">¶</a></p>
<span id="name-address-protection"></span><div id="Dynamic-fig">
<figure id="figure-10">
            <div class="artwork art-text alignLeft" id="section-9.2.2-17.1">
<pre>
6LN                                       6LR        Root        6LBR
 |                                         |           |           |
 |&lt;--------------- RA ---------------------|           |           |
 |                                         |           |           |
 |------ NS EARO (ROVR=Crypto-ID) --------&gt;|           |           |
 |                                         |           |           |
 |&lt;- NA EARO(status=Validation Requested) -|           |           |
 |                                         |           |           |
 |----- NS EARO and Proof-of-ownership  --&gt;|                       |
 |                                         |--------- EDAR -------&gt;|
 |                                         |                       |
 |                                         |&lt;-------- EDAC --------|
 |                                         |                       |
 |                                         |           |           |
 |                                         |-- DAO ---&gt;|           |
 |                                         |           |-- EDAR --&gt;|
 |                                         |           |           |
 |                                         |           |&lt;-- EDAC --|
 |                                         |&lt;- DAO-ACK-|           |
 |                                         |           |           |
 |&lt;----------- NA EARO (status=0)----------|           |           |
 |                                         |           |           |
                                     ...
 |                                         |           |           |
 |------ NS EARO (ROVR=Crypto-ID) --------&gt;|           |           |
 |                                         |-- DAO ---&gt;|           |
 |                                         |           |-- EDAR --&gt;|
 |                                         |           |           |
 |                                         |           |&lt;-- EDAC --|
 |                                         |&lt;- DAO-ACK-|           |
 |&lt;----------- NA EARO (status=0)----------|           |           |
 |                                         |           |           |
                                     ...
</pre>
</div>
<figcaption><a href="#figure-10" class="selfRef">Figure 10</a>:
<a href="#name-address-protection" class="selfRef">Address Protection</a>
            </figcaption></figure>
</div>
<p id="section-9.2.2-18">
   The 6LR may at any time send a unicast asynchronous NA(EARO) with the R Flag set to 0 to signal that it stops providing routing services, and/or with the EARO Status 2 "Neighbor Cache full" to signal that it removes the NCE. It may also send a final RA, unicast or multicast, with a router Lifetime field of zero, to signal that it is ceasing to serve as router, as specified in section 6.2.5 of <span>[<a href="#RFC4861" class="xref">RFC4861</a>]</span>. This may happen upon a
   DCO or a DAO-ACK message indicating the path is already removed; else the
   6LR MUST remove the host route to the 6LN using a DAO message with a Path
   Lifetime of zero.<a href="#section-9.2.2-18" class="pilcrow">¶</a></p>
<p id="section-9.2.2-19">

   A valid NS(EARO) message with the R Flag set to 0 and a Registration Lifetime that is not zero signals that the 6LN wishes to maintain the binding but does not require the routing services from the 6LR (any more).

   Upon this message, if, due to previous NS(EARO) with the R Flag set to 1, the
   6LR was injecting the host route to the Registered Address in RPL using DAO
   messages, then the 6LR MUST invalidate the host route in RPL using a DAO
   with a Path Lifetime of zero.

   It is up to the Registering 6LN to maintain the corresponding route from then
   on, either keeping it active via a different 6LR or by acting as a RAN and
   managing its own reachability.<a href="#section-9.2.2-19" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Root">
<section id="section-9.2.3">
          <h4 id="name-perspective-of-the-rpl-root">
<a href="#section-9.2.3" class="section-number selfRef">9.2.3. </a><a href="#name-perspective-of-the-rpl-root" class="section-name selfRef">Perspective of the RPL Root</a>
          </h4>
<p id="section-9.2.3-1">
   A RPL Root MUST set the 'P' flag to 1 in the RPL DODAG Configuration Option of
   the DIO messages that it generates (see <a href="#upd" class="xref">Section 6</a>) to signal
   that it proxies the EDAR/EDAC exchange and supports the Updated RPL Target
   option.<a href="#section-9.2.3-1" class="pilcrow">¶</a></p>
<p id="section-9.2.3-2">
   Upon reception of a DAO message, for each updated RPL Target Option
   (see <a href="#tgt" class="xref">Section 6.1</a>) that creates or updates an existing RPL state, the Root MUST notify the 6LBR by using a proxied EDAR/EDAC exchange. If
   if the RPL Root and the 6LBR are integrated, an internal API can be used.<a href="#section-9.2.3-2" class="pilcrow">¶</a></p>
<p id="section-9.2.3-3">
  The EDAR message MUST be constructed as follows:<a href="#section-9.2.3-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-9.2.3-4">
  <li id="section-9.2.3-4.1">
  The Target IPv6 address from the RPL Target Option is placed in the
  Registered Address field of the EDAR message;<a href="#section-9.2.3-4.1" class="pilcrow">¶</a>
</li>
            <li id="section-9.2.3-4.2">
  the Registration Lifetime is adapted from the Path Lifetime in the TIO by
  converting the Lifetime Units used in RPL into units of 60 seconds used in the
  6LoWPAN ND messages;<a href="#section-9.2.3-4.2" class="pilcrow">¶</a>
</li>
            <li id="section-9.2.3-4.3">
              
  the TID value is set to the Path Sequence in the TIO and indicated with an ICMP
  code of 1 in the EDAR message;<a href="#section-9.2.3-4.3" class="pilcrow">¶</a>
</li>
            <li id="section-9.2.3-4.4">
  The ROVR in the RPL Target Option is copied as is in the
  EDAR and the ICMP Code Suffix is set to the appropriate value as shown in
  Table 4 of <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span> depending on the size of the ROVR field.<a href="#section-9.2.3-4.4" class="pilcrow">¶</a>
</li>
          </ol>
<p id="section-9.2.3-5">
   Upon receiving an EDAC message from the 6LBR, if a DAO is pending, then the
   Root MUST send a DAO-ACK back to the 6LR. Otherwise, if the Status in the EDAC message is not "Success", then it MUST send an asynchronous DCO to the 6LR.<a href="#section-9.2.3-5" class="pilcrow">¶</a></p>
<p id="section-9.2.3-6">
   In either case, the EDAC Status is embedded in the RPL Status with the 'A'
   flag set to 1.<a href="#section-9.2.3-6" class="pilcrow">¶</a></p>
<p id="section-9.2.3-7">
   The proxied EDAR/EDAC exchange MUST be protected with a timer of an appropriate duration and a number of retries, that are implementation-dependent, and SHOULD be configurable since the Root and the 6LBR are typically nodes with a higher capacity and manageability than 6LRs.
   Upon timing out, the Root MUST send an error back to the 6LR as above, either using a DAO-ACK or a DCO, as appropriate, with the 'A' and 'E' flags set to 1 in the RPL status, and a RPL Status value of of "6LBR Registry Saturated" <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span>.<a href="#section-9.2.3-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="lbr">
<section id="section-9.2.4">
          <h4 id="name-perspective-of-the-6lbr">
<a href="#section-9.2.4" class="section-number selfRef">9.2.4. </a><a href="#name-perspective-of-the-6lbr" class="section-name selfRef">Perspective of the 6LBR</a>
          </h4>
<p id="section-9.2.4-1">
  The 6LBR is unaware that the RPL Root is not the new attachment 6LR of the RUL,
  so it is not impacted by this specification.<a href="#section-9.2.4-1" class="pilcrow">¶</a></p>
<p id="section-9.2.4-2">
   Upon reception of an EDAR message,
   the 6LBR acts as prescribed by <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span> and returns an EDAC message to the sender.<a href="#section-9.2.4-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="multiop">
<section id="section-10">
      <h2 id="name-protocol-operations-for-mul">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-protocol-operations-for-mul" class="section-name selfRef">Protocol Operations for Multicast Addresses</a>
      </h2>
<p id="section-10-1"> Section 12 of <span>[<a href="#RFC6550" class="xref">RFC6550</a>]</span> details the RPL support for
    multicast flows. This support is activated by the MOP of 3 ("Storing Mode of Operation with multicast support") in the DIO messages that form the DODAG. This section also applies if and only if the MOP of the RPLInstance is 3.<a href="#section-10-1" class="pilcrow">¶</a></p>
<p id="section-10-2">
    The RPL support of multicast is not source-specific and only operates as
    an extension to the Storing Mode of Operation for unicast packets.
    Note that
    it is the RPL model that the multicast packet is passed as a Layer-2 unicast
    to each of the interested children.
    This remains true when forwarding between the 6LR and the listener 6LN.<a href="#section-10-2" class="pilcrow">¶</a></p>
<p id="section-10-3">
    <span><a href="#RFC3810" class="xref">"Multicast Listener Discovery Version 2 (MLDv2) for IPv6"</a> [<a href="#RFC3810" class="xref">RFC3810</a>]</span> provides an
    interface for a listener to register to multicast flows.
    In the MLD model, the router is a "querier", and the host is a multicast
    listener that registers to the querier to obtain copies of the particular
    flows it is interested in.<a href="#section-10-3" class="pilcrow">¶</a></p>
<p id="section-10-4">
     The equivalent of the first Address Registration happens as illustrated in <a href="#fReg3" class="xref">Figure 11</a>. The 6LN, as an MLD listener, sends an unsolicited Report to the 6LR. This enables it to start receiving the flow immediately, and causes the 6LR to inject the multicast route in RPL.<a href="#section-10-4" class="pilcrow">¶</a></p>
<p id="section-10-5"> This specification does not change MLD but will operate more efficiently
     if the asynchronous messages for unsolicited Report and Done are sent by
     the 6LN as Layer-2 unicast to the 6LR, in particular on wireless.<a href="#section-10-5" class="pilcrow">¶</a></p>
<p id="section-10-6">
     The 6LR acts as a generic MLD querier and generates a DAO with the Multicast Address as the Target Prefix as described in section 12 of <span>[<a href="#RFC6550" class="xref">RFC6550</a>]</span>. As for the Unicast host routes, the Path Lifetime associated to the Target is mapped from the Query Interval, and set to be larger to account for variable propagation delays to the Root.
     The Root proxies the MLD exchange as a listener with the 6LBR acting as the
     querier, so as to get packets from a source external to the RPL domain.<a href="#section-10-6" class="pilcrow">¶</a></p>
<p id="section-10-7">
     Upon a DAO with a Target option for a multicast address, the RPL Root checks if it is already registered as a listener for that address, and if not, it performs its own unsolicited Report for the multicast address as described in section 5.1 of <span>[<a href="#RFC3810" class="xref">RFC3810</a>]</span>.
     The report is source independent, so there is no Source Address listed.<a href="#section-10-7" class="pilcrow">¶</a></p>
<span id="name-first-multicast-registratio"></span><div id="fReg3">
<figure id="figure-11">
        <div class="artwork art-text alignLeft" id="section-10-8.1">
<pre>
   6LN/RUL                6LR             Root                   6LBR
      |                    |               |                       |
      | unsolicited Report |               |                       |
      |-------------------&gt;|               |                       |
      |                    | DAO           |                       |
      |                    |--------------&gt;|                       |
      |                    |    DAO-ACK    |                       |
      |                    |&lt;--------------|                       |
      |                    |               | &lt;if not done already&gt; |
      |                    |               |  unsolicited Report   |
      |                    |               |----------------------&gt;|
      |                    |               |                       |
</pre>
</div>
<figcaption><a href="#figure-11" class="selfRef">Figure 11</a>:
<a href="#name-first-multicast-registratio" class="selfRef">First Multicast Registration Flow</a>
        </figcaption></figure>
</div>
<p id="section-10-9">
    The equivalent of the registration refresh is pulled periodically by the 6LR acting as querier.

    Upon the timing out of the Query Interval, the 6LR sends a Multicast Address Specific Query to each of its listeners, for each Multicast Address, and gets a Report back that is mapped into a DAO one by one.
    Optionally, the 6LR MAY send a General Query, where the Multicast Address field is set to zero. In that case, the multicast packet is passed as a Layer-2 unicast to each of the interested children.
.<a href="#section-10-9" class="pilcrow">¶</a></p>
<p id="section-10-10">
    Upon a Report, the 6LR generates a DAO with as many Target Options as there are Multicast Address Records in the Report message, copying the
    Multicast Address field in the Target Prefix of the RPL Target Option.
    The DAO message is a Storing Mode DAO, passed to a selection of the 6LR's
    parents.<a href="#section-10-10" class="pilcrow">¶</a></p>
<p id="section-10-11">
    Asynchronously to this, a similar procedure happens between the Root and a router such as the 6LBR that serves multicast flows on the Link where the Root is located. Again the Query and Report messages are source independent. The Root lists exactly once each Multicast Address for which it has at least one active multicast DAO state, copying the multicast address in the DAO state in the Multicast Address field of the
    Multicast Address Records in the Report message.<a href="#section-10-11" class="pilcrow">¶</a></p>
<p id="section-10-12">

    This is illustrated in <a href="#fReg4" class="xref">Figure 12</a>:<a href="#section-10-12" class="pilcrow">¶</a></p>
<span id="name-next-registration-flow"></span><div id="fReg4">
<figure id="figure-12">
        <div class="artwork art-text alignLeft" id="section-10-13.1">
<pre>
   6LN/RUL                6LR             Root                6LBR
      |                    |               |                    |
      |       Query        |               |                    |
      |&lt;-------------------|               |                    |
      |       Report       |               |                    |
      |-------------------&gt;|               |                    |
      |                    | DAO           |                    |
      |                    |--------------&gt;|                    |
      |                    |    DAO-ACK    |                    |
      |                    |&lt;--------------|                    |
      |                    |               |       Query        |
      |                    |               |&lt;-------------------|
      |                    |               |       Report       |
      |                    |               |-------------------&gt;|
      |                    |               |                    |
</pre>
</div>
<figcaption><a href="#figure-12" class="selfRef">Figure 12</a>:
<a href="#name-next-registration-flow" class="selfRef">Next Registration Flow</a>
        </figcaption></figure>
</div>
<p id="section-10-14">Note that any of the functions 6LR, Root and 6LBR might be collapsed in a
    single node, in which case the flow above happens internally, and possibly
    through internal API calls as opposed to messaging.<a href="#section-10-14" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-considerations">
<section id="section-11">
      <h2 id="name-security-considerations">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-11-1">
   It is worth noting that with <span>[<a href="#RFC6550" class="xref">RFC6550</a>]</span>, every
   node in the LLN is RPL-aware and can inject any RPL-based attack in the
   network. This specification isolates edge nodes that can only interact with
   the RPL routers using 6LoWPAN ND, meaning that they cannot perform RPL
   insider attacks.<a href="#section-11-1" class="pilcrow">¶</a></p>
<p id="section-11-2">
 The LLN nodes depend on the 6LBR and the RPL participants for their
    operation.
 A trust model must be put in place to ensure that the right devices are
 acting in these roles, so as to avoid threats such as black-holing,
        (see <span>[<a href="#RFC7416" class="xref">RFC7416</a>]</span> section 7),
    Denial-Of-Service attacks whereby a rogue 6LR creates a high churn in the RPL network by advertising and removing many forged addresses,
 or bombing attack whereby an impersonated 6LBR would destroy state in
 the network by using the status code of 4 ("Removed").<a href="#section-11-2" class="pilcrow">¶</a></p>
<p id="section-11-3">
    This trust model could be
    at a minimum based on a Layer-2 Secure joining and the Link-Layer security.
    This is a generic 6LoWPAN requirement, see Req5.1 in Appendix B.5 of <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span>.<a href="#section-11-3" class="pilcrow">¶</a></p>
<p id="section-11-4">
    In a general manner, the Security Considerations in
    <span>[<a href="#RFC7416" class="xref">RFC7416</a>]</span> <span>[<a href="#RFC6775" class="xref">RFC6775</a>]</span>, and <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span> apply to this specification as well.<a href="#section-11-4" class="pilcrow">¶</a></p>
<p id="section-11-5">
    The Link-Layer security is needed in particular to prevent
    Denial-Of-Service attacks whereby a rogue 6LN creates a high churn in the
    RPL network by constantly registering and deregistering addresses with the
    R Flag set to 1 in the EARO.<a href="#section-11-5" class="pilcrow">¶</a></p>
<p id="section-11-6">
   <span>[<a href="#RFC8928" class="xref">RFC8928</a>]</span> updated 6LoWPAN ND with the called Address-Protected Neighbor Discovery (AP-ND). AP-ND protects the owner of an address against address theft and impersonation attacks in a Low-Power and Lossy Network (LLN). Nodes supporting th extension compute a cryptographic identifier (Crypto-ID), and use it with one or more of their Registered Addresses. The Crypto-ID identifies the owner of the Registered Address and can be used to provide proof of ownership of the Registered Addresses. Once an address is registered with the Crypto-ID and a proof of ownership is provided, only the owner of that address can modify the registration information, thereby enforcing Source Address Validation.
   <span>[<a href="#RFC8928" class="xref">RFC8928</a>]</span>
   reduces even more the attack perimeter that is available to the edge nodes
   and its use is suggested in this specification.<a href="#section-11-6" class="pilcrow">¶</a></p>
<p id="section-11-7">
    Additionally, the trust model could include a role validation
    to ensure that the node that claims to be a 6LBR or a RPL Root is entitled
    to do so.<a href="#section-11-7" class="pilcrow">¶</a></p>
<p id="section-11-8">
    The Opaque field in the EARO enables the RUL to suggest a RPLInstanceID
    where its traffic is placed. It is also possible for an attacker RUL to
    include an RPI in the packet. This opens to attacks where a RPL instance
    would be reserved for critical traffic, e.g., with a specific bandwidth
    reservation, that the additional traffic generated by a rogue may disrupt.
    The attack may be alleviated by traditional access control and traffic
    shaping mechanisms where the 6LR controls the incoming traffic from the
    6LN. More importantly, the 6LR is the node that injects the traffic in the
    RPL domain, so it has the final word on which RPLInstance is to be used
    for the traffic coming from the RUL, per its own policy.<a href="#section-11-8" class="pilcrow">¶</a></p>
<p id="section-11-9">
    At the time of this writing, RPL does not have a Route Ownership Validation
    model whereby it is possible to validate the origin of an address that is
    injected in a DAO.
    This specification makes a first step in that direction by
    allowing the Root to challenge the RUL via the 6LR that serves it.<a href="#section-11-9" class="pilcrow">¶</a></p>
<p id="section-11-10">
   <a href="#tgt" class="xref">Section 6.1</a> indicates that when the length of the ROVR field is unknown, the RPL Target Option must be passed on as received in RPL storing Mode. This creates a possible opening for using DAO messages as a
   covert channel. Note that DAO messages are rare and the overusing that channel could be detected. An implementation SHOULD notify the network
   management when a RPL Target Option is receives with an unknown ROVR field size, to ensure that the situation is known to the network administrator.<a href="#section-11-10" class="pilcrow">¶</a></p>
<p id="section-11-11">
     <span>[<a href="#I-D.ietf-roll-efficient-npdao" class="xref">EFFICIENT-NPDAO</a>]</span> introduces the ability for
     a rogue common ancestor node to invalidate a route on behalf of the target
     node. In this case, the RPL Status in the DCO has the 'A' flag set to 0, and a NA(EARO) is returned to the 6LN with the R flag set to 0. This encourages the 6LN to try another 6LR. If a 6LR exists that does not use
     the rogue common ancestor, then the 6LN will eventually succeed gaining
     reachability over the RPL network in spite of the rogue node.<a href="#section-11-11" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-12">
      <h2 id="name-iana-considerations">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<div id="iana-arof">
<section id="section-12.1">
        <h3 id="name-fixing-the-address-registra">
<a href="#section-12.1" class="section-number selfRef">12.1. </a><a href="#name-fixing-the-address-registra" class="section-name selfRef">Fixing the Address Registration Option Flags</a>
        </h3>
<p id="section-12.1-1">Section 9.1 of <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span> creates a Registry for the 8-bit
    Address Registration Option Flags field.
    IANA is requested to rename the first column of the table from "ARO Status" to "Bit number".<a href="#section-12.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-aro">
<section id="section-12.2">
        <h3 id="name-resizing-the-aro-status-val">
<a href="#section-12.2" class="section-number selfRef">12.2. </a><a href="#name-resizing-the-aro-status-val" class="section-name selfRef">Resizing the ARO Status values</a>
        </h3>
<p id="section-12.2-1"> Section 12 of <span>[<a href="#RFC6775" class="xref">RFC6775</a>]</span> creates the
    Address Registration Option Status values Registry with a range 0-255.<a href="#section-12.2-1" class="pilcrow">¶</a></p>
<p id="section-12.2-2">
    This specification reduces that range to 0-63, see <a href="#stat" class="xref">Section 6.3</a>.<a href="#section-12.2-2" class="pilcrow">¶</a></p>
<p id="section-12.2-3">
    IANA is requested to modify the Address Registration Option Status values
    Registry so that the upper bound of the unassigned values is 63.  This
    document should be added as a reference.  The registration procedure does
    not change.<a href="#section-12.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-conf">
<section id="section-12.3">
        <h3 id="name-new-rpl-dodag-configuration">
<a href="#section-12.3" class="section-number selfRef">12.3. </a><a href="#name-new-rpl-dodag-configuration" class="section-name selfRef">New RPL DODAG Configuration Option Flag</a>
        </h3>
<p id="section-12.3-1">
    IANA is requested to assign a flag from the "DODAG Configuration Option
    Flags for MOP 0..6" <span>[<a href="#I-D.ietf-roll-useofrplinfo" class="xref">USEofRPLinfo</a>]</span> registry as follows:<a href="#section-12.3-1" class="pilcrow">¶</a></p>
<span id="name-new-dodag-configuration-opt"></span><div id="nexndopt">
<table class="center" id="table-2">
          <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-new-dodag-configuration-opt" class="selfRef">New DODAG Configuration Option Flag</a>
          </caption>
<thead>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Bit Number</td>
              <td class="text-left" rowspan="1" colspan="1">Capability Description</td>
              <td class="text-left" rowspan="1" colspan="1">Reference</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1 (suggested)</td>
              <td class="text-left" rowspan="1" colspan="1">Root Proxies EDAR/EDAC (P)</td>
              <td class="text-left" rowspan="1" colspan="1">THIS RFC</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="iana-full">
<section id="section-12.4">
        <h3 id="name-rpl-target-option-registry">
<a href="#section-12.4" class="section-number selfRef">12.4. </a><a href="#name-rpl-target-option-registry" class="section-name selfRef">RPL Target Option Registry</a>
        </h3>
<p id="section-12.4-1">
   This document modifies the "RPL Target Option Flags" registry initially
   created in Section 20.15 of <span>[<a href="#RFC6550" class="xref">RFC6550</a>]</span> . The registry now
   includes only 4 bits (<a href="#tgt" class="xref">Section 6.1</a>) and should point to this
   document as an additional reference. The registration procedure doesn't
   change.<a href="#section-12.4-1" class="pilcrow">¶</a></p>
<p id="section-12.4-2">
  <a href="#tgt" class="xref">Section 6.1</a> also defines a new entry in the Registry as follows:<a href="#section-12.4-2" class="pilcrow">¶</a></p>
<span id="name-rpl-target-option-registry-2"></span><div id="ianatarget">
<table class="center" id="table-3">
          <caption>
<a href="#table-3" class="selfRef">Table 3</a>:
<a href="#name-rpl-target-option-registry-2" class="selfRef">RPL Target Option Registry</a>
          </caption>
<thead>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Bit Number</td>
              <td class="text-left" rowspan="1" colspan="1">Capability Description</td>
              <td class="text-left" rowspan="1" colspan="1">Reference</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0 (suggested)</td>
              <td class="text-left" rowspan="1" colspan="1">Advertiser address in Full (F)</td>
              <td class="text-left" rowspan="1" colspan="1">THIS RFC</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="iana-stats-nonrej">
<section id="section-12.5">
        <h3 id="name-new-subregistry-for-rpl-non">
<a href="#section-12.5" class="section-number selfRef">12.5. </a><a href="#name-new-subregistry-for-rpl-non" class="section-name selfRef">New Subregistry for RPL Non-Rejection Status values</a>
        </h3>
<p id="section-12.5-1">
 This specification creates a new Subregistry for the RPL Non-Rejection Status values for use in the RPL DAO-ACK, DCO, and DCO-ACK messages with the 'A' flag set to 0, under the RPL registry.<a href="#section-12.5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12.5-2.1"> Possible values are 6-bit unsigned integers (0..63).<a href="#section-12.5-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-12.5-2.2"> Registration procedure is "IETF Review" <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>.<a href="#section-12.5-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-12.5-2.3"> Initial allocation is as indicated in <a href="#iana-ACK-Status" class="xref">Table 4</a>:<a href="#section-12.5-2.3" class="pilcrow">¶</a>
</li>
        </ul>
<span id="name-acceptance-values-of-the-rp"></span><div id="iana-ACK-Status">
<table class="center" id="table-4">
          <caption>
<a href="#table-4" class="selfRef">Table 4</a>:
<a href="#name-acceptance-values-of-the-rp" class="selfRef">Acceptance values of the RPL Status</a>
          </caption>
<thead>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Value</td>
              <td class="text-left" rowspan="1" colspan="1">Meaning</td>
              <td class="text-left" rowspan="1" colspan="1">Reference</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0</td>
              <td class="text-left" rowspan="1" colspan="1">Unqualified acceptance</td>
              <td class="text-left" rowspan="1" colspan="1">THIS RFC / RFC 6550 </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1..63</td>
              <td class="text-left" rowspan="1" colspan="1">Unassigned</td>
              <td class="text-left" rowspan="1" colspan="1"></td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="iana-stats-rej">
<section id="section-12.6">
        <h3 id="name-new-subregistry-for-rpl-rej">
<a href="#section-12.6" class="section-number selfRef">12.6. </a><a href="#name-new-subregistry-for-rpl-rej" class="section-name selfRef">New Subregistry for RPL Rejection Status values</a>
        </h3>
<p id="section-12.6-1">
 This specification creates a new Subregistry for the RPL Rejection Status values for use in the RPL DAO-ACK and DCO messages with the 'A' flag set to 0, under the RPL registry.<a href="#section-12.6-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12.6-2.1"> Possible values are 6-bit unsigned integers (0..63).<a href="#section-12.6-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-12.6-2.2"> Registration procedure is "IETF Review" <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>.<a href="#section-12.6-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-12.6-2.3"> Initial allocation is as indicated in <a href="#iana-nack-Status" class="xref">Table 5</a>:<a href="#section-12.6-2.3" class="pilcrow">¶</a>
</li>
        </ul>
<span id="name-rejection-values-of-the-rpl"></span><div id="iana-nack-Status">
<table class="center" id="table-5">
          <caption>
<a href="#table-5" class="selfRef">Table 5</a>:
<a href="#name-rejection-values-of-the-rpl" class="selfRef">Rejection values of the RPL Status</a>
          </caption>
<thead>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Value</td>
              <td class="text-left" rowspan="1" colspan="1">Meaning</td>
              <td class="text-left" rowspan="1" colspan="1">Reference</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0</td>
              <td class="text-left" rowspan="1" colspan="1">Unqualified rejection</td>
              <td class="text-left" rowspan="1" colspan="1">THIS RFC</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1..63</td>
              <td class="text-left" rowspan="1" colspan="1">Unassigned</td>
              <td class="text-left" rowspan="1" colspan="1"></td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
</section>
</div>
<div id="Acks">
<section id="section-13">
      <h2 id="name-acknowledgments">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="section-13-1">
   The authors wish to thank Ines Robles, Georgios Papadopoulos and
   especially Rahul Jadhav and Alvaro Retana
   for their reviews and contributions to this document.
   Also many thanks to Elwyn Davies, Eric Vyncke,
   Peter Van der Stok and Carl Wallace for their reviews and useful comments
   during the IETF Last Call and the IESG review sessions.<a href="#section-13-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-14">
      <h2 id="name-normative-references">
<a href="#section-14" class="section-number selfRef">14. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
      </h2>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
      <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3810">[RFC3810]</dt>
      <dd>
<span class="refAuthor">Vida, R., Ed.</span><span class="refAuthor"> and L. Costa, Ed.</span>, <span class="refTitle">"Multicast Listener Discovery Version 2 (MLDv2) for IPv6"</span>, <span class="seriesInfo">RFC 3810</span>, <span class="seriesInfo">DOI 10.17487/RFC3810</span>, <time datetime="2004-06" class="refDate">June 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3810">https://www.rfc-editor.org/info/rfc3810</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4861">[RFC4861]</dt>
      <dd>
<span class="refAuthor">Narten, T.</span><span class="refAuthor">, Nordmark, E.</span><span class="refAuthor">, Simpson, W.</span><span class="refAuthor">, and H. Soliman</span>, <span class="refTitle">"Neighbor Discovery for IP version 6 (IPv6)"</span>, <span class="seriesInfo">RFC 4861</span>, <span class="seriesInfo">DOI 10.17487/RFC4861</span>, <time datetime="2007-09" class="refDate">September 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4861">https://www.rfc-editor.org/info/rfc4861</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6550">[RFC6550]</dt>
      <dd>
<span class="refAuthor">Winter, T., Ed.</span><span class="refAuthor">, Thubert, P., Ed.</span><span class="refAuthor">, Brandt, A.</span><span class="refAuthor">, Hui, J.</span><span class="refAuthor">, Kelsey, R.</span><span class="refAuthor">, Levis, P.</span><span class="refAuthor">, Pister, K.</span><span class="refAuthor">, Struik, R.</span><span class="refAuthor">, Vasseur, JP.</span><span class="refAuthor">, and R. Alexander</span>, <span class="refTitle">"RPL: IPv6 Routing Protocol for Low-Power and Lossy Networks"</span>, <span class="seriesInfo">RFC 6550</span>, <span class="seriesInfo">DOI 10.17487/RFC6550</span>, <time datetime="2012-03" class="refDate">March 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6550">https://www.rfc-editor.org/info/rfc6550</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6775">[RFC6775]</dt>
      <dd>
<span class="refAuthor">Shelby, Z., Ed.</span><span class="refAuthor">, Chakrabarti, S.</span><span class="refAuthor">, Nordmark, E.</span><span class="refAuthor">, and C. Bormann</span>, <span class="refTitle">"Neighbor Discovery Optimization for IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs)"</span>, <span class="seriesInfo">RFC 6775</span>, <span class="seriesInfo">DOI 10.17487/RFC6775</span>, <time datetime="2012-11" class="refDate">November 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6775">https://www.rfc-editor.org/info/rfc6775</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7102">[RFC7102]</dt>
      <dd>
<span class="refAuthor">Vasseur, JP.</span>, <span class="refTitle">"Terms Used in Routing for Low-Power and Lossy Networks"</span>, <span class="seriesInfo">RFC 7102</span>, <span class="seriesInfo">DOI 10.17487/RFC7102</span>, <time datetime="2014-01" class="refDate">January 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7102">https://www.rfc-editor.org/info/rfc7102</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7400">[RFC7400]</dt>
      <dd>
<span class="refAuthor">Bormann, C.</span>, <span class="refTitle">"6LoWPAN-GHC: Generic Header Compression for IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs)"</span>, <span class="seriesInfo">RFC 7400</span>, <span class="seriesInfo">DOI 10.17487/RFC7400</span>, <time datetime="2014-11" class="refDate">November 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7400">https://www.rfc-editor.org/info/rfc7400</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
      <dd>
<span class="refAuthor">Cotton, M.</span><span class="refAuthor">, Leiba, B.</span><span class="refAuthor">, and T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8200">[RFC8200]</dt>
      <dd>
<span class="refAuthor">Deering, S.</span><span class="refAuthor"> and R. Hinden</span>, <span class="refTitle">"Internet Protocol, Version 6 (IPv6) Specification"</span>, <span class="seriesInfo">STD 86</span>, <span class="seriesInfo">RFC 8200</span>, <span class="seriesInfo">DOI 10.17487/RFC8200</span>, <time datetime="2017-07" class="refDate">July 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8200">https://www.rfc-editor.org/info/rfc8200</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8504">[RFC8504]</dt>
      <dd>
<span class="refAuthor">Chown, T.</span><span class="refAuthor">, Loughney, J.</span><span class="refAuthor">, and T. Winters</span>, <span class="refTitle">"IPv6 Node Requirements"</span>, <span class="seriesInfo">BCP 220</span>, <span class="seriesInfo">RFC 8504</span>, <span class="seriesInfo">DOI 10.17487/RFC8504</span>, <time datetime="2019-01" class="refDate">January 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8504">https://www.rfc-editor.org/info/rfc8504</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8505">[RFC8505]</dt>
      <dd>
<span class="refAuthor">Thubert, P., Ed.</span><span class="refAuthor">, Nordmark, E.</span><span class="refAuthor">, Chakrabarti, S.</span><span class="refAuthor">, and C. Perkins</span>, <span class="refTitle">"Registration Extensions for IPv6 over Low-Power Wireless Personal Area Network (6LoWPAN) Neighbor Discovery"</span>, <span class="seriesInfo">RFC 8505</span>, <span class="seriesInfo">DOI 10.17487/RFC8505</span>, <time datetime="2018-11" class="refDate">November 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8505">https://www.rfc-editor.org/info/rfc8505</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8928">[RFC8928]</dt>
      <dd>
<span class="refAuthor">Thubert, P., Ed.</span><span class="refAuthor">, Sarikaya, B.</span><span class="refAuthor">, Sethi, M.</span><span class="refAuthor">, and R. Struik</span>, <span class="refTitle">"Address-Protected Neighbor Discovery for Low-Power and Lossy Networks"</span>, <span class="seriesInfo">RFC 8928</span>, <span class="seriesInfo">DOI 10.17487/RFC8928</span>, <time datetime="2020-11" class="refDate">November 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8928">https://www.rfc-editor.org/info/rfc8928</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-roll-useofrplinfo">[USEofRPLinfo]</dt>
      <dd>
<span class="refAuthor">Robles, I.</span><span class="refAuthor">, Richardson, M.</span><span class="refAuthor">, and P. Thubert</span>, <span class="refTitle">"Using RPI Option Type, Routing Header for Source Routes and IPv6-in-IPv6 encapsulation in the RPL Data Plane"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-roll-useofrplinfo-42</span>, <time datetime="2020-11-12" class="refDate">12 November 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-roll-useofrplinfo-42">https://tools.ietf.org/html/draft-ietf-roll-useofrplinfo-42</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-roll-efficient-npdao">[EFFICIENT-NPDAO]</dt>
    <dd>
<span class="refAuthor">Jadhav, R.</span><span class="refAuthor">, Thubert, P.</span><span class="refAuthor">, Sahoo, R.</span><span class="refAuthor">, and Z. Cao</span>, <span class="refTitle">"Efficient Route Invalidation"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-roll-efficient-npdao-18</span>, <time datetime="2020-04-15" class="refDate">15 April 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-roll-efficient-npdao-18">https://tools.ietf.org/html/draft-ietf-roll-efficient-npdao-18</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-15">
      <h2 id="name-informative-references">
<a href="#section-15" class="section-number selfRef">15. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
      </h2>
<dl class="references">
<dt id="RFC4919">[RFC4919]</dt>
      <dd>
<span class="refAuthor">Kushalnagar, N.</span><span class="refAuthor">, Montenegro, G.</span><span class="refAuthor">, and C. Schumacher</span>, <span class="refTitle">"IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs): Overview, Assumptions, Problem Statement, and Goals"</span>, <span class="seriesInfo">RFC 4919</span>, <span class="seriesInfo">DOI 10.17487/RFC4919</span>, <time datetime="2007-08" class="refDate">August 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4919">https://www.rfc-editor.org/info/rfc4919</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4862">[RFC4862]</dt>
      <dd>
<span class="refAuthor">Thomson, S.</span><span class="refAuthor">, Narten, T.</span><span class="refAuthor">, and T. Jinmei</span>, <span class="refTitle">"IPv6 Stateless Address Autoconfiguration"</span>, <span class="seriesInfo">RFC 4862</span>, <span class="seriesInfo">DOI 10.17487/RFC4862</span>, <time datetime="2007-09" class="refDate">September 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4862">https://www.rfc-editor.org/info/rfc4862</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6553">[RFC6553]</dt>
      <dd>
<span class="refAuthor">Hui, J.</span><span class="refAuthor"> and JP. Vasseur</span>, <span class="refTitle">"The Routing Protocol for Low-Power and Lossy Networks (RPL) Option for Carrying RPL Information in Data-Plane Datagrams"</span>, <span class="seriesInfo">RFC 6553</span>, <span class="seriesInfo">DOI 10.17487/RFC6553</span>, <time datetime="2012-03" class="refDate">March 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6553">https://www.rfc-editor.org/info/rfc6553</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6554">[RFC6554]</dt>
      <dd>
<span class="refAuthor">Hui, J.</span><span class="refAuthor">, Vasseur, JP.</span><span class="refAuthor">, Culler, D.</span><span class="refAuthor">, and V. Manral</span>, <span class="refTitle">"An IPv6 Routing Header for Source Routes with the Routing Protocol for Low-Power and Lossy Networks (RPL)"</span>, <span class="seriesInfo">RFC 6554</span>, <span class="seriesInfo">DOI 10.17487/RFC6554</span>, <time datetime="2012-03" class="refDate">March 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6554">https://www.rfc-editor.org/info/rfc6554</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6606">[RFC6606]</dt>
      <dd>
<span class="refAuthor">Kim, E.</span><span class="refAuthor">, Kaspar, D.</span><span class="refAuthor">, Gomez, C.</span><span class="refAuthor">, and C. Bormann</span>, <span class="refTitle">"Problem Statement and Requirements for IPv6 over Low-Power Wireless Personal Area Network (6LoWPAN) Routing"</span>, <span class="seriesInfo">RFC 6606</span>, <span class="seriesInfo">DOI 10.17487/RFC6606</span>, <time datetime="2012-05" class="refDate">May 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6606">https://www.rfc-editor.org/info/rfc6606</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7039">[RFC7039]</dt>
      <dd>
<span class="refAuthor">Wu, J.</span><span class="refAuthor">, Bi, J.</span><span class="refAuthor">, Bagnulo, M.</span><span class="refAuthor">, Baker, F.</span><span class="refAuthor">, and C. Vogt, Ed.</span>, <span class="refTitle">"Source Address Validation Improvement (SAVI) Framework"</span>, <span class="seriesInfo">RFC 7039</span>, <span class="seriesInfo">DOI 10.17487/RFC7039</span>, <time datetime="2013-10" class="refDate">October 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7039">https://www.rfc-editor.org/info/rfc7039</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7228">[RFC7228]</dt>
      <dd>
<span class="refAuthor">Bormann, C.</span><span class="refAuthor">, Ersue, M.</span><span class="refAuthor">, and A. Keranen</span>, <span class="refTitle">"Terminology for Constrained-Node Networks"</span>, <span class="seriesInfo">RFC 7228</span>, <span class="seriesInfo">DOI 10.17487/RFC7228</span>, <time datetime="2014-05" class="refDate">May 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7228">https://www.rfc-editor.org/info/rfc7228</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8138">[RFC8138]</dt>
      <dd>
<span class="refAuthor">Thubert, P., Ed.</span><span class="refAuthor">, Bormann, C.</span><span class="refAuthor">, Toutain, L.</span><span class="refAuthor">, and R. Cragie</span>, <span class="refTitle">"IPv6 over Low-Power Wireless Personal Area Network (6LoWPAN) Routing Header"</span>, <span class="seriesInfo">RFC 8138</span>, <span class="seriesInfo">DOI 10.17487/RFC8138</span>, <time datetime="2017-04" class="refDate">April 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8138">https://www.rfc-editor.org/info/rfc8138</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8415">[RFC8415]</dt>
      <dd>
<span class="refAuthor">Mrugalski, T.</span><span class="refAuthor">, Siodelski, M.</span><span class="refAuthor">, Volz, B.</span><span class="refAuthor">, Yourtchenko, A.</span><span class="refAuthor">, Richardson, M.</span><span class="refAuthor">, Jiang, S.</span><span class="refAuthor">, Lemon, T.</span><span class="refAuthor">, and T. Winters</span>, <span class="refTitle">"Dynamic Host Configuration Protocol for IPv6 (DHCPv6)"</span>, <span class="seriesInfo">RFC 8415</span>, <span class="seriesInfo">DOI 10.17487/RFC8415</span>, <time datetime="2018-11" class="refDate">November 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8415">https://www.rfc-editor.org/info/rfc8415</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6282">[RFC6282]</dt>
      <dd>
<span class="refAuthor">Hui, J., Ed.</span><span class="refAuthor"> and P. Thubert</span>, <span class="refTitle">"Compression Format for IPv6 Datagrams over IEEE 802.15.4-Based Networks"</span>, <span class="seriesInfo">RFC 6282</span>, <span class="seriesInfo">DOI 10.17487/RFC6282</span>, <time datetime="2011-09" class="refDate">September 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6282">https://www.rfc-editor.org/info/rfc6282</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6687">[RFC6687]</dt>
      <dd>
<span class="refAuthor">Tripathi, J., Ed.</span><span class="refAuthor">, de Oliveira, J., Ed.</span><span class="refAuthor">, and JP. Vasseur, Ed.</span>, <span class="refTitle">"Performance Evaluation of the Routing Protocol for Low-Power and Lossy Networks (RPL)"</span>, <span class="seriesInfo">RFC 6687</span>, <span class="seriesInfo">DOI 10.17487/RFC6687</span>, <time datetime="2012-10" class="refDate">October 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6687">https://www.rfc-editor.org/info/rfc6687</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7416">[RFC7416]</dt>
      <dd>
<span class="refAuthor">Tsao, T.</span><span class="refAuthor">, Alexander, R.</span><span class="refAuthor">, Dohler, M.</span><span class="refAuthor">, Daza, V.</span><span class="refAuthor">, Lozano, A.</span><span class="refAuthor">, and M. Richardson, Ed.</span>, <span class="refTitle">"A Security Threat Analysis for the Routing Protocol for Low-Power and Lossy Networks (RPLs)"</span>, <span class="seriesInfo">RFC 7416</span>, <span class="seriesInfo">DOI 10.17487/RFC7416</span>, <time datetime="2015-01" class="refDate">January 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7416">https://www.rfc-editor.org/info/rfc7416</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8025">[RFC8025]</dt>
      <dd>
<span class="refAuthor">Thubert, P., Ed.</span><span class="refAuthor"> and R. Cragie</span>, <span class="refTitle">"IPv6 over Low-Power Wireless Personal Area Network (6LoWPAN) Paging Dispatch"</span>, <span class="seriesInfo">RFC 8025</span>, <span class="seriesInfo">DOI 10.17487/RFC8025</span>, <time datetime="2016-11" class="refDate">November 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8025">https://www.rfc-editor.org/info/rfc8025</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8929">[RFC8929]</dt>
    <dd>
<span class="refAuthor">Thubert, P., Ed.</span><span class="refAuthor">, Perkins, C.E.</span><span class="refAuthor">, and E. Levy-Abegnoli</span>, <span class="refTitle">"IPv6 Backbone Router"</span>, <span class="seriesInfo">RFC 8929</span>, <span class="seriesInfo">DOI 10.17487/RFC8929</span>, <time datetime="2020-11" class="refDate">November 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8929">https://www.rfc-editor.org/info/rfc8929</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<div id="u8138">
<section id="section-appendix.a">
      <h2 id="name-example-compression">
<a href="#section-appendix.a" class="section-number selfRef">Appendix A. </a><a href="#name-example-compression" class="section-name selfRef">Example Compression</a>
      </h2>
<p id="section-appendix.a-1">

 <a href="#rtghc" class="xref">Figure 13</a> illustrates the case in Storing Mode where the packet
    is received from the Internet, then the Root encapsulates the packet to
    insert the RPI and deliver to the 6LR that is the parent and last hop to the
    final destination, which is not known to support <span>[<a href="#RFC8138" class="xref">RFC8138</a>]</span>.<a href="#section-appendix.a-1" class="pilcrow">¶</a></p>
<span id="name-encapsulation-to-parent-6lr"></span><div id="rtghc">
<figure id="figure-13">
        <div class="artwork art-text alignLeft" id="section-appendix.a-2.1">
<pre>

+-+ ... -+-+ ... +-+- ... -+-+ ... -+-+-+ ... +-+-+ ... -+ ... +-...
|11110001|SRH-6LoRH| RPI-  |IPv6-in-IPv6| NH=1      |11110CPP| UDP | UDP
|Page 1  |Type1 S=0| 6LoRH | 6LoRH  |LOWPAN_IPHC| UDP    | hdr |Payld
+-+ ... -+-+ ... +-+- ... -+-+ ... -+-+-+ ... +-+-+ ... -+ ... +-...
         &lt;-4 bytes-&gt;                &lt;-        RFC 6282        -&gt;
                                    &lt;-     No RPL artifact ...
</pre>
</div>
<figcaption><a href="#figure-13" class="selfRef">Figure 13</a>:
<a href="#name-encapsulation-to-parent-6lr" class="selfRef">Encapsulation to Parent 6LR in Storing Mode</a>
        </figcaption></figure>
</div>
<p id="section-appendix.a-3">
    The difference with the example presented in Figure 19 of
    <span>[<a href="#RFC8138" class="xref">RFC8138</a>]</span> is the addition of a SRH-6LoRH before the RPI-6LoRH
    to transport the compressed address of the 6LR as the destination address of
    the outer IPv6 header. In the <span>[<a href="#RFC8138" class="xref">RFC8138</a>]</span> example the destination IP of the
    outer header was elided and was implicitly the same address as the
    destination of the inner header.

    Type 1 was arbitrarily chosen, and the size of 0 denotes a single address in
    the SRH.<a href="#section-appendix.a-3" class="pilcrow">¶</a></p>
<p id="section-appendix.a-4">
     In <a href="#rtghc" class="xref">Figure 13</a>, the source of the IPv6-in-IPv6 encapsulation is
          the Root, so it is elided in the IPv6-in-IPv6 6LoRH. The destination is
          the parent 6LR of the destination of the encapsulated packet so it
          cannot be elided. If the DODAG is operated in Storing Mode, it is the
          single entry in the SRH-6LoRH and the SRH-6LoRH Size is encoded as 0.
          The SRH-6LoRH is the first 6LoRH in the chain.
          In this particular example, the 6LR address can
          be compressed to 2 bytes so a Type of 1 is used.
          It results that the total length of the SRH-6LoRH is 4 bytes.<a href="#section-appendix.a-4" class="pilcrow">¶</a></p>
<p id="section-appendix.a-5">
          In Non-Storing Mode, the encapsulation from the Root would be similar
          to that represented in <a href="#rtghc" class="xref">Figure 13</a> with possibly more hops
          in the SRH-6LoRH and possibly multiple SRH-6LoRHs if the various
          addresses in the routing header are not compressed to the same format.
          Note that on the last hop to the parent 6LR, the RH3 is consumed and
          removed from the compressed form, so the use of Non-Storing Mode vs.
          Storing Mode is indistinguishable from the packet format.<a href="#section-appendix.a-5" class="pilcrow">¶</a></p>
<p id="section-appendix.a-6">
          The SRH-6LoRHs are followed by RPI-6LoRH and then the IPv6-in-IPv6 6LoRH.
          When the IPv6-in-IPv6 6LoRH is removed, all the 6LoRH Headers that
          precede it are also removed.
          The Paging Dispatch <span>[<a href="#RFC8025" class="xref">RFC8025</a>]</span> may also be removed if
          there was no previous Page change to a Page other than 0 or 1, since
          the LOWPAN_IPHC is encoded in the same fashion in the default Page 0
          and in Page 1. The resulting packet to the destination is the
          encapsulated packet compressed with <span>[<a href="#RFC6282" class="xref">RFC6282</a>]</span>.<a href="#section-appendix.a-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="section-appendix.b">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Pascal Thubert (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">Cisco Systems, Inc</span></div>
<div dir="auto" class="left"><span class="street-address">Building D<br>45 Allee des Ormes - BP1200</span></div>
<div dir="auto" class="left">
<span class="postal-code">06254</span> <span class="locality">Mougins - Sophia Antipolis</span>
</div>
<div dir="auto" class="left"><span class="country-name">France</span></div>
<div class="tel">
<span>Phone:</span>
<a href="tel:+33%20497%2023%2026%2034" class="tel">+33 497 23 26 34</a>
</div>
<div class="email">
<span>Email:</span>
<a href="mailto:pthubert@cisco.com" class="email">pthubert@cisco.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Michael C. Richardson</span></div>
<div dir="auto" class="left"><span class="org">Sandelman Software Works</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:mcr+ietf@sandelman.ca" class="email">mcr+ietf@sandelman.ca</a>
</div>
<div class="url">
<span>URI:</span>
<a href="http://www.sandelman.ca/" class="url">http://www.sandelman.ca/</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
