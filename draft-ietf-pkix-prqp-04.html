<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>PKI Resource Query Protocol (PRQP)</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="PKI Resource Query Protocol (PRQP)">
<meta name="keywords" content="PKI, Resource Discovery, Protocol">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">PKIX Working Group</td><td class="header">M. Pala</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Dartmouth College</td></tr>
<tr><td class="header">Intended status: Experimental</td><td class="header">November 16, 2009</td></tr>
<tr><td class="header">Expires: May 20, 2010</td><td class="header">&nbsp;</td></tr>
</table></td></tr></table>
<h1><br />PKI Resource Query Protocol (PRQP)<br />draft-ietf-pkix-prqp-04</h1>

<h3>Abstract</h3>

<p>One of the most strategic problems still open in PKIX is locating
   public data and services associated with a Certification Authority (CA).
   This issue impacts interoperability and usability in PKIX.
   <br />
<br />

   This draft describes the PKI Resource Query Protocol (PRQP), its design,
   definition, and its impact in already deployed PKIX protocols.
   <br />
<br />

   
   
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on May 20, 2010.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2009 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the BSD License.</p>
<p>
This document may contain material from IETF Documents or IETF
Contributions published or made publicly available before November
10, 2008.  The person(s) controlling the copyright in some of this
material may not have granted the IETF Trust the right to allow
modifications of such material outside the IETF Standards Process.
Without obtaining an adequate license from the person(s) controlling
the copyright in such materials, this document may not be modified
outside the IETF Standards Process, and derivative works of it may
not be created outside the IETF Standards Process, except to format
it for publication as an RFC or to translate it into languages other
than English.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Requirements notation<br />
<a href="#intro">2.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#overview">2.1.</a>&nbsp;
Overview of existing solutions<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#exts">2.1.1.</a>&nbsp;
Certificate Extensions<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#dnssrv">2.1.2.</a>&nbsp;
DNS SRV records<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#lan">2.1.3.</a>&nbsp;
Local Network Oriented Solutions<br />
<a href="#proto">3.</a>&nbsp;
Protocol Details<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rqa">3.1.</a>&nbsp;
The Resource Query Authority (RQA)<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#prqpover">3.2.</a>&nbsp;
PRQP Overview<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#req">3.2.1.</a>&nbsp;
PRQP Request<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#reqsyn">3.2.1.1.</a>&nbsp;
Request Syntax<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#prqpresp">3.2.2.</a>&nbsp;
PRQP Response<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#respsyn">3.2.2.1.</a>&nbsp;
Response Syntax<br />
<a href="#oids">4.</a>&nbsp;
Object Identifiers for PKI resources<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#oid_prpq_prqp">4.1.</a>&nbsp;
The RQA Service identifier<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#oid_ocsp">4.2.</a>&nbsp;
The OCSP identifier<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#oid_subjectCert">4.3.</a>&nbsp;
The Subject's Certificate identifier<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#oid_issuerCert">4.4.</a>&nbsp;
The Issuer's Certificate identifier<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#oid_timestamping">4.5.</a>&nbsp;
The Timestamping Service identifier<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#oid_scvp">4.6.</a>&nbsp;
The SCVP Server identifier<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#oid_crlDistribution">4.7.</a>&nbsp;
The CRL Distribution Point identifier<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#oid_certRepository">4.8.</a>&nbsp;
The Certificates Repository identifier<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#oid_crlRepository">4.9.</a>&nbsp;
The CRL Repository identifier<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#oid_XcertRepository">4.10.</a>&nbsp;
The Cross Certificates Repository identifier<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#oid_cmcGateway">4.11.</a>&nbsp;
The CMC Gateway identifier<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#oid_cmpGateway">4.12.</a>&nbsp;
The CMP Gateway identifier<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#oid_scepGateway">4.13.</a>&nbsp;
The SCEP Gateway identifier<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#oid_htmlGateway">4.14.</a>&nbsp;
The HTML Gateway identifier<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#oid_xkmsGateway">4.15.</a>&nbsp;
The XKMS Gateway identifier<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#oid_certPolicy">4.16.</a>&nbsp;
The Certificate Policy (CP) identifier<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#oid_certPracticeStatement">4.17.</a>&nbsp;
The Certification Practice Statement (CPS) identifier<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#oid_endorsedTA">4.18.</a>&nbsp;
The Endorsed Trust Anchors identifier<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#oid_loaPolicy">4.19.</a>&nbsp;
The LOA Policy (LP) identifier<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#oid_loaModifier">4.20.</a>&nbsp;
The Certificate LOA Modifier identifier<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#oid_htmlRequest">4.21.</a>&nbsp;
The HTML Certificate Request Service identifier<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#oid_htmlRevoke">4.22.</a>&nbsp;
The HTML Certificate Revoke Service identifier<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#oid_htmlRenew">4.23.</a>&nbsp;
The HTML Certificate Renew Service identifier<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#oid_htmlSuspend">4.24.</a>&nbsp;
The HTML Certificate Suspend Service identifier<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#oid_htmlRecovery">4.25.</a>&nbsp;
The HTML Certificate Recovery Service Identifier<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#oid_gridBody">4.26.</a>&nbsp;
The Grid Accreditation Body identifier<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#oid_gridPolicy">4.27.</a>&nbsp;
The Grid Policy identifier<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#oid_gridDistPolicy">4.28.</a>&nbsp;
The Grid Distribution Update identifier<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#oid_gridAccreditedCACerts">4.29.</a>&nbsp;
The Grid Accredited CA Certificates identifier<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#oid_apexTampUpdate">4.30.</a>&nbsp;
The Apex Trust Anchor Update identifier<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#oid_tampUpdate">4.31.</a>&nbsp;
The Trust Anchor Update identifier<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#oid_caIncidentReport">4.32.</a>&nbsp;
The CA Incident Report identifier<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#oid_private">4.33.</a>&nbsp;
The Private Resources identifier<br />
<a href="#iana">5.</a>&nbsp;
IANA Considerations<br />
<a href="#rationale">6.</a>&nbsp;
PRQP Design Rationale<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#complexity">6.1.</a>&nbsp;
Response Complexity<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#uri">6.2.</a>&nbsp;
RQA's URL distribution<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#security">6.3.</a>&nbsp;
Security Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#time">6.4.</a>&nbsp;
Time Validity<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#format">6.5.</a>&nbsp;
Message Format<br />
<a href="#acknowledgments">7.</a>&nbsp;
Acknowledgments<br />
<a href="#rfc.references1">8.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">8.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">8.2.</a>&nbsp;
Non-Normative References<br />
<a href="#app_A">Appendix&nbsp;A.</a>&nbsp;
Transport Protocol Specifications for PRQP Messages<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#http">A.1.</a>&nbsp;
PRQP over HTTP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#httpreq">A.1.1.</a>&nbsp;
Request<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#httpresp">A.1.2.</a>&nbsp;
Response<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#caching">A.1.3.</a>&nbsp;
Message Caching<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#p2p">A.2.</a>&nbsp;
PRQP over Peer-to-Peer Network<br />
<a href="#app_B">Appendix&nbsp;B.</a>&nbsp;
RQA address Retrieval<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#dhcp_rqa">B.1.</a>&nbsp;
DHCP Specifications<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#dhcp_pki_resource_query_authority_ipv4">B.1.1.</a>&nbsp;
PRQP Servers IPv4 Option for DHCPv4<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#dhcp_pki_resource_query_authority_ipv6">B.1.2.</a>&nbsp;
PRQP Servers IPv6 Option for DHCPv6<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#dhcp_prqa_clients">B.1.3.</a>&nbsp;
DHCP Configuration<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#dhcp_client_processing">B.1.4.</a>&nbsp;
DHCP Client Processing<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#dns_rqa">B.2.</a>&nbsp;
DNS SRV Records<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#dns_rqa_config">B.2.1.</a>&nbsp;
SRV Record Format for PRQP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#dns_rqa_zone">B.2.2.</a>&nbsp;
Example: PRQP enabled zone file<br />
<a href="#ans1">Appendix&nbsp;C.</a>&nbsp;
PRQP ASN1.1 Specification<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Author's Address<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Requirements notation</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL",
"SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY",
and "OPTIONAL" in this document are to be interpreted as
described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<a name="intro"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Introduction</h3>

<p>
   An increasing number of services and protocols are being defined to
   address different needs of users and administrators of PKIs. With
   the deployment of new applications and services, the need to access
   information and services provided by Certificate Service Providers
   (CSPs) is critical. Currently Certification Authorities (CAs) barely
   publish access details on their official web sites, this includes
   URL of provided services and repositories.
   <br />
<br />

   Using the PRQP, resources provided by a CA can be automatically
   and securely discovered by an application.
   
</p>
<a name="overview"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
Overview of existing solutions</h3>

<p>
   Currently there are three options to find URLs providing
   access to PKI data:
   </p>
<ul class="text">
<li>by including such data in certificate extensions
</li>
<li>by searching easily accessible repositories (e.g. DNS, local
     database, etc.)
</li>
<li>by adapting existing protocols (e.g. SLP)
</li>
</ul><p>
   
</p>
<a name="exts"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1.1"></a><h3>2.1.1.&nbsp;
Certificate Extensions</h3>

<p>
   To provide pointers to published data it is possible to use
   the Authority Information Access (AIA) Subject Information Access
   (SIA) extensions defined by PKIX <a class='info' href='#RFC3280'>[RFC3280]<span> (</span><span class='info'>Housley, R., Polk, W., Ford, W., and D. Solo, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; April&nbsp;2002.</span><span>)</span></a>.
   <br />
<br />

   The former can provide information about services associated with
   the issuer of the certificate,
   while the latter carries information (inside a CA certificate) about
   offered CA services.
   <br />
<br />

   AIA and SIA extensions are static, i.e. not modifiable unless the
   certificate is re-issued. 
   If a CA inserts the AIA extension into every certificate it issues,
   e.g., to identify the location of an OCSP
   responder, then changing that location would require re-issuance of
   all these certificates, a substantial barrier to such a change. If a CA
   certificate is self-signed and used as a trust anchor, then re-issuing 
   the certificate to change the content of the SIA extension, e.g., to reflect
   a change in the location of a time stamping server would be very disruptive.
   In closed PKIs, e.g., enterprises,
   use of these extensions may be replaced by manual configuration 
   and management of this data via ad hoc means.
   Because of the centrally controlled nature of such environments,
   the static nature of SIA and AIA extensions is not a concern.
   <br />
<br />

   However in order to promote interoperability between PKIs, PRQP enables
   dynamic management of pointers to such services (e.g., adding/removing
   or moving) without requiring changes in the certificate contents or
   third parties to manually configure services in their applications.
   Even in closed environments, PRQP could help manage PKI services 
   analogous the way DHCP facilitates network management.
   
</p>
<a name="dnssrv"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1.2"></a><h3>2.1.2.&nbsp;
DNS SRV records</h3>

<p>
   The SRV record technique provides pointers to servers via the 
   DNS <a class='info' href='#RFC1035'>[RFC1035]<span> (</span><span class='info'>Mockapetris, P., &ldquo;Domain names - implementation and specification,&rdquo; November&nbsp;1987.</span><span>)</span></a>.
   <br />
<br />

   As defined in <a class='info' href='#RFC2782'>[RFC2782]<span> (</span><span class='info'>Gulbrandsen, A., Vixie, P., and L. Esibov, &ldquo;A DNS RR for specifying the location of services (DNS SRV),&rdquo; February&nbsp;2000.</span><span>)</span></a>, the introduction of this 
   type of record allows
   administrators to perform operations similar to what we require
   in order to solve the problem we are addressing in this draft,
   i.e., to provide URLs to services.
   <br />
<br />

   The problem in the adoption of this mechanism is that, in contrast to 
   the DNS environment, usually in PKIX there is no fixed mapping
   between certificates and the DNS name space. 
   The only exception is when the
   Domain Component (DC) attributes are used in the certificate's Subject.
   <br />
<br />

   Currently this approach is not widely adopted. Moreover, it is not
   always easy to identify the right DNS to query to, when trying to find
   a particular service provided by a CA, because of the lack of such
   information in certificates.
   
</p>
<a name="lan"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1.3"></a><h3>2.1.3.&nbsp;
Local Network Oriented Solutions</h3>

<p>
   Another approach to provide reliable information is to use existing
   protocols for service location such as Jini, Universal Plug and Play
   protocol (UPnP) or Service Location Protocol (SLP) <a class='info' href='#RFC2608'>[RFC2608]<span> (</span><span class='info'>Guttman, E., Perkins, C., Veizades, J., and M. Day, &ldquo;Service Location Protocol, Version 2,&rdquo; June&nbsp;1999.</span><span>)</span></a>
   <a class='info' href='#RFC2609'>[RFC2609]<span> (</span><span class='info'>Guttman, E., Perkins, C., and J. Kempf, &ldquo;Service Templates and Service: Schemes,&rdquo; June&nbsp;1999.</span><span>)</span></a>.
   <br />
<br />

   The IETF defined the SLP to provide a service location mechanism
   that is language and technology independent.
   Some issues, however, make it not the right choice to solve our
   problem, e.g., the protocol is quite complex to implement when
   considering the scope of the problem we are addressing.
   <br />
<br />

   The definition of a specific and simple protocol for PKI service and
   resource location is needed to ease PKI integration into existing and
   future
   applications, especially for mobile devices which have limited
   computational power and communication bandwidth.
   
</p>
<a name="proto"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Protocol Details</h3>

<p>
   The PRQP protocol is a request-response protocol, formed by the 
   exchanging of two messages, i.e., a request and a response between a
   client and a server, called the Resource Query Authority (RQA).
   <br />
<br />

   The requesting entity (the client) may be any entity that needs
   to access information about repositories and services related
   to a certificate.
   <br />
<br />

   The RQA is the authority entitled to answer for a particular CA or to
   act as a PRQP Trusted Authority (PTA) for a set of users, e.g., users
   in an enterprise environment.
   <br />
<br />

   In the first case the RQA is directly designated by a CA to act
   as an RQA, by having the CA issue a certificate to the RQA with a
   specific value set in the extendedKeyUsage extension.
   In this case the RQA provides authoritative
   responses for requests regarding the CA that issued the RQA's
   certificate.
   <br />
<br />

   When operating as a PTA, the RQA may provide responses about multiple CAs,
   without the need to have been directly certified by them. To operate as
   such, a specific extension (prqpTrustedAuthority) should be present in
   RQA's certificate and its value should be set to TRUE.
   
</p>
<a name="rqa"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
The Resource Query Authority (RQA)</h3>

<p>
   The Resource Query Authority is the designated authority to act as PRQP
   responder. The RQA's signing key needs not to be the same as that of the
   CA that designated it.
   <br />
<br />

   The CA may designate an RQA by issuing a certificate containing a unique
   value for the extendedKeyUsage in RQA's certificate. The RQA may also act
   as a trusted responder. PRQP signing delegation SHALL be designated by
   the inclusion of id-kp-PRQPSigning in the extendedKeyUsage extension
   within the PRQP response signer's certificate.
   </p>
<blockquote class="text"><dl>
<dt></dt>
<dd>id-kp-PRQPSigning OBJECT IDENTIFIER ::= {iso(1) identified-organization(2) 
dod(6) internet(1) security(5) mechanisms(5) pkix(7) kp(3) 11}
</dd>
</dl></blockquote><p>
   When operating as a PTA, the RQA may provide responses about multiple CAs,
   without the need to have been directly certified by them. To operate as
   a PTA a specific extension (prqpTrustedAuthority) should be present in
   RQA's certificate and its value should be set to TRUE.
   </p>
<blockquote class="text"><dl>
<dt></dt>
<dd>prqpTrustedAuthority ::= BOOLEAN DEFAULT TRUE
</dd>
</dl></blockquote><p>
   We also define two new OIDs to identify the PRQP protocol and the PTA
   extension as follows:
   </p>
<blockquote class="text"><dl>
<dt></dt>
<dd>id-prqp                 OBJECT IDENTIFIER ::= { id-pkix 23 }
</dd>
<dt></dt>
<dd>id-prqp-pta             OBJECT IDENTIFIER ::= { id-prqp 1 }
</dd>
</dl></blockquote><p>
   
</p>
<a name="prqpover"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
PRQP Overview</h3>

<p>
   The protocol encompasses the exchange of a single round of messages
   between a client and an RQA:
   </p>
<ol class="text">
<li>the client requests a resource token by sending a request to the
         RQA
</li>
<li>the RQA replies by sending a response to the client
</li>
</ol><p>
   Upon receiving the response the client MUST verify the status error
   returned in the response. If no error is present, the client MUST
   verify the
   various fields contained in the ResourceResponseToken and the validity
   of the associated digital signature (if present).
   A nonce MAY be used to guarantee that the response is associated with a
   specific request in order to avoid reply attacks.
   <br />
<br />

   The client also SHOULD check the validity period of the response. It
   SHOULD NOT, in order to minimize the load on an RQA, request again the
   location of the same resource within this interval to the same RQA.
   <br />
<br />

   If the response is signed, the client SHOULD check the RQA's certificate
   validity.
   
</p>
<a name="req"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.1"></a><h3>3.2.1.&nbsp;
PRQP Request</h3>

<p>
   A PRQP request contains the following data:
   </p>
<ul class="text">
<li>protocol version
</li>
<li>nonce
</li>
<li>MaxResponse
</li>
<li>ResourceRequestToken
</li>
<li>Extensions
</li>
</ul><p>
   The ASN.1 syntax imports terms defined in <a class='info' href='#RFC4210'>[RFC4210]<span> (</span><span class='info'>Adams, C., Farrell, S., Kause, T., and T. Mononen, &ldquo;Internet X.509 Public Key Infrastructure Certificate Management Protocol (CMP),&rdquo; September&nbsp;2005.</span><span>)</span></a>.
   For signature calculation,
   the data to be signed is encoded by using the DER format. ASN.1 EXPLICIT
   tagging is used as a default unless specified otherwise. The terms
   imported from <a class='info' href='#RFC3280'>[RFC3280]<span> (</span><span class='info'>Housley, R., Polk, W., Ford, W., and D. Solo, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; April&nbsp;2002.</span><span>)</span></a> are: Extensions, Certificate, 
   CertificateSerialNumber, SubjectPublicKeyInfo, Name, AlgorithmIdentifier.
   
</p>
<a name="reqsyn"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.1.1"></a><h3>3.2.1.1.&nbsp;
Request Syntax</h3>

<p>
   The PRQP request syntax is as follows:
   
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    PRQPRequest ::= SEQUENCE {
        requestData            TBSReqData,
        signature              [0] EXPLICIT Signature OPTIONAL }

    TBSReqData ::= SEQUENCE {
        version                INTEGER { v(1) },
        nonce              [0] INTEGER              OPTIONAL,
              -- very large number
        producedAt             GeneralizedTime,
              -- time when the request has been generated
        serviceToken           ResourceRequestToken,
              -- token identifying the requested service
        extensions         [1] IMPLICIT Extensions  OPTIONAL }
</pre></div>
<p>
   The version field (currently v1) describes the version of the PRQP
   request. The nonce field, if present, is an integer between 80 bits
   and 256 bit in length.
   The producedAt define the time-frame when the request has been
   generated.

   
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      ResourceRequestToken ::= SEQUENCE {
        ca                      CertIdentifier,
        servicesList        [0] SET OF ResourceIdentifier OPTIONAL }
</pre></div>
<p>
   The ca field is of type CertIdentifier. This is used to identify
   the certificate of the CA whose services are requested.
   <br />
<br />

   The CertIdentifier syntax is as follows:
   
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      BasicCertIdentifier ::= SEQUENCE {
        issuerNameHash              OCTET STRING,
        serialNumber                CertificateSerialNumber  }

      ExtendedCertInfo ::= SEQUENCE {
        certificateHash             OCTET STRING,
        subjectKeyHash              OCTET STRING,
        subjectKeyIdentifier    [0] KeyIdentifier          OPTIONAL,
        issuerKeyIdentifier     [1] KeyIdentifier          OPTIONAL  }

      CertIdentifier ::= SEQUENCE {
        hashAlgorithm               AlgorithmIdentifier,
        basicCertIdentifier         BasicCertIdentifier,
        extInfo                     [0] ExtendedCertInfo    OPTIONAL,
        caCertificate               [1] Certificate         OPTIONAL,
        issuedCertificate           [2] Certificate         OPTIONAL }
</pre></div>
<p>
    The resourceList specifies the resources or services being requested.
    
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      ResourceIdentifier ::= SEQUENCE {
        resourceId             OBJECT IDENTIFIER,
        version            [0] INTEGER             OPTIONAL
           --- version of the protocol or data format (if applicable)
        oid                [1] OBJECT IDENTIFIER   OPTIONAL,
            --- object identifier associated with the URL
            --- (if applicable)                                     }
</pre></div>
<p>
   The ResourceIdentifier is formed by an OID that identifies the service
   or the data being requested (e.g. OCSP, LDAP, CRL, etc... ) and an optional
   version number that may be used to better identify the requested resource.
   All fields SHOULD be used whenever applicable.
   <br />
<br />

   If one or more ResourceIdentifier are provided in the request, the RQA
   should report back the location for each of the requested services. If
   no ResourceIdentifier is present in the request, the response should
   carry all the available service locations for the specified CA (with
   respect to the MaxResponse and optional parameters constrain).
   <br />
<br />

   The signature field is of type Signature and it is defined in
   <a class='info' href='#RFC2560'>[RFC2560]<span> (</span><span class='info'>Myers, M., Ankney, R., Malpani, A., Galperin, S., and C. Adams, &ldquo;X.509 Internet Public Key Infrastructure Online Certificate Status Protocol - OCSP,&rdquo; June&nbsp;1999.</span><span>)</span></a>:
   
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      Signature ::= SEQUENCE {
        signatureAlgorithm     AlgorithmIdentifier,
        signature              BIT STRING,
        certs              [0] EXPLICIT SEQUENCE OF Certificate
                                                          OPTIONAL }
</pre></div>
<p>
   Extensions can be used for future protocol enhancement.
   
</p>
<a name="prqpresp"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.2"></a><h3>3.2.2.&nbsp;
PRQP Response</h3>

<p>
   The PRQP response contains the following data:
   </p>
<ul class="text">
<li>protocol version
</li>
<li>nonce
</li>
<li>status
</li>
<li>CA identifier
</li>
<li>ResourceResponseToken
</li>
<li>Extensions
</li>
</ul><p>
   
</p>
<a name="respsyn"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.2.1"></a><h3>3.2.2.1.&nbsp;
Response Syntax</h3>

<p>
   The response syntax is as follows:
   
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      PRQPResponse ::= SEQUENCE {
        respData               TBSRespData,
        signature          [0] EXPLICIT Signature OPTIONAL }

      TBSRespData ::= SEQUENCE {
        version                INTEGER { v(1)},
        nonce              [0] INTEGER              OPTIONAL,
              -- as duplicated from the request
        producedAt             GeneralizedTime,
              -- time when the response has been generated
        nextUpdate         [1] GeneralizedTime      OPTIONAL,
              -- time till when the response should be considered valid
        pkiStatus              PKIStatusInfo,
              -- status of the response
        caCertId               CertIdentifier,
              -- identifier of the CA certificate that issued the
              -- targeted certificate
        responseToken      [2] SEQUENCE OF ResourceResponseToken
                                                              OPTIONAL,
              -- token carrying information about
              -- requested services
        extensions         [3] EXPLICIT Extensions  OPTIONAL }
</pre></div>
<p>
   The version field (currently v1) describes the version of the used PRQP
   response. The nonce, if present, binds the response to a specific request.
   The usage of the nonce is meaningful only in signed responses
   and its value must be copied directly from the corresponding request.
   If not present in the request, the nonce MUST be omitted.
   <br />
<br />

   The pkiStatus field is used to return useful information to the client on
   the status of the query.
   
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      PKIStatusInfo ::= SEQUENCE {
        status        PKIStatus,
        statusString  [0] UTF8String      OPTIONAL,
        failInfo      [1] PKIFailureInfo  OPTIONAL,
        referrals     [2] EXPLICIT SEQUENCE OF IA5String
                                                     OPTIONAL  }
</pre></div>
<p>
   If status has value zero, a responseToken MUST be present in the response.
   When the status value is non zero, the responseToken MUST be omitted 
   and the reason code MUST be one of the values in PKIStatus. When the PKIStatus
   value is set to caNotPresent (2) or sytemFailure (3), a list referral URLs MAY
   be included in the response to facilitate the client in finding the required
   resource from other known servers.
   
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      PKIStatus ::= INTEGER {
        ok                     (0),
           -- when the PKIStatus contains the value zero one or
              more responseToken is present
        badRequest             (1),
           -- the request is badly formatted
        caNotPresent           (2),
           -- the requested CA is not present
        systemFailure          (3)
           -- a system failure has occurred }
</pre></div>
<p>
   The signature field is of type Signature and it is defined in 
   <a class='info' href='#RFC2560'>[RFC2560]<span> (</span><span class='info'>Myers, M., Ankney, R., Malpani, A., Galperin, S., and C. Adams, &ldquo;X.509 Internet Public Key Infrastructure Online Certificate Status Protocol - OCSP,&rdquo; June&nbsp;1999.</span><span>)</span></a>:
   
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      Signature ::= SEQUENCE {
        signatureAlgorithm     AlgorithmIdentifier,
        signature              BIT STRING,
        certs              [0] EXPLICIT SEQUENCE OF Certificate
                                                          OPTIONAL }
</pre></div>
<p>
   The responseToken carries information about the services requested by
   the client. For each of the requested service, the RQA should include
   a ResourceResponseToken which bears the OID of the service and the
   corresponding URI.
   <br />
<br />

   The ResourceResponseToken syntax is described below:
   
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      ResourceResponseToken ::= SEQUENCE {
        resourceId              OBJECT IDENTIFIER,
            --- resource identifier
        resourceLocatorList [0] EXPLICIT SEQUENCE OF IA5String,
            --- sequence of resource locators (URI)
        version             [1] INTEGER             OPTIONAL,
            --- version of the protocol or data format (if applicable)
        oid                 [2] OBJECT IDENTIFIER   OPTIONAL,
            --- object identifier associated with the URL
            --- (if applicable)
        resourceInfo        [3] UTF8Sting           OPTIONAL,
            --- additional service Info (eg. technical contacts) }
</pre></div>
<p>
   The resourceId field value is copied from the corresponding request
   and it bears the OID of the service about which the client inquired.
   In section <a class='info' href='#oids'>Section&nbsp;4<span> (</span><span class='info'>Object Identifiers for PKI resources</span><span>)</span></a> we define a list of default PKI
   resources.
   
</p>
<p>
   <br />
<br />

   The producedAt and nextUpdate define the time-frame when the response
   data is to be considered valid. Within the defined period, the client
   SHOULD NOT request for the same service. Use of wider time-frames values
   can help the RQA avoid duplication of requests from the same client
   thus potentially lowering the load of the responder. However, providing
   this data to a client does not ensure a lower query rate, as a server
   cannot rely on clients to obey the advice provided in the response.
   <br />
<br />

   The resourceLocator bears access information for the service identified
   by the serviceId. The name MUST be an absolute URL, and it MUST follow
   the URL syntax and encoding rules specified in <a class='info' href='#RFC4248'>[RFC4248]<span> (</span><span class='info'>Hoffman, P., &ldquo;The telnet URI Scheme,&rdquo; October&nbsp;2005.</span><span>)</span></a>
   and <a class='info' href='#RFC4266'>[RFC4266]<span> (</span><span class='info'>Hoffman, P., &ldquo;The gopher URI Scheme,&rdquo; November&nbsp;2005.</span><span>)</span></a>.
   The resourceLocator
   includes both a scheme (e.g., HTTP or FTP) and a scheme specific part.
   The scheme specific part is supposed to carry information on how to
   reach the requested service, this is, for example, a fully qualified
   domain name or IP address as the host. If the requested service is not
   available or it is unknown by the server, the resourceLocator value
   should be empty.
   <br />
<br />

   Optional Extensions may be added if requested.
   
</p>
<a name="oids"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Object Identifiers for PKI resources</h3>

<p>
   The PRQP defines a set of standard OIDs that are used to identify
   resources related to a Certification Authority. In this section we
   provide a description for each of the defined OIDs.
  
</p>
<p>
   The services are all defined under the id-ad-prqp OID which is defined
   as follows:
     </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  id-ad-prqp                OBJECT IDENTIFIER ::= {id-ad 12}
</pre></div><p>

  
</p>
<a name="oid_prpq_prqp"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
The RQA Service identifier</h3>

<p>
     When id-ad-prqp-rqa is used in a PRQP message, the associated value
     in the response is the location of the PRQP server (i.e., an RQA) using
     the conventions in this document or subsequent updates.
     </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  id-ad-prqp-rqa            OBJECT IDENTIFIER ::= {id-ad-prqp 0}
</pre></div><p>

     The version field, if used, indicates the supported PRQP protocol version.
    
</p>
<a name="oid_ocsp"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
The OCSP identifier</h3>

<p>
     When id-ad-prqp-ocsp appears in a PRQP request or response, the associated
     value in the response is the location of the OCSP responder, using the conventions defined in
     <a class='info' href='#RFC2560'>[RFC2560]<span> (</span><span class='info'>Myers, M., Ankney, R., Malpani, A., Galperin, S., and C. Adams, &ldquo;X.509 Internet Public Key Infrastructure Online Certificate Status Protocol - OCSP,&rdquo; June&nbsp;1999.</span><span>)</span></a>. The version field, if used, indicates the supported
     protocol version.
     </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  id-ad-prqp-ocsp           OBJECT IDENTIFIER ::= {id-ad-prqp 1 }
</pre></div><p>

    
</p>
<a name="oid_subjectCert"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
The Subject's Certificate identifier</h3>

<p>
     When id-ad-subjectCert is used in a PRQP message, the associated value in the response 
     is the location of the DER formatted certificate of the identified CA.
     The version field MAY be used to specify the version
     of the certificate pointed by the URL in a PRQP Response message.
     In order to enhance interoperability between applications and reduce development
     efforts, the URI should point directly to the certificate and not to a redirection
     service.
     </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  id-ad-prqp-subjectCert     OBJECT IDENTIFIER ::= {id-ad-prqp 2 }
</pre></div><p>

     HTTP server implementations accessed via the URI SHOULD specify the media type
     "application/x-x509-ca-cert" in the content-type header field of the response.
    
</p>
<p>
     
     This field allows applications to check for renewal of CA certificates. When the
     application wants to check if a new version of the identified certificate exists,
     it can use this service and download the certificate from the URL. If the downloaded
     certificate differs from the one already possesed by the client, two different cases
     are possible: 
     </p>
<ol class="text">
<li>
          The current certificate is not self-signed: in this case, the checks on the
          new certificate follow the rules specified in <a class='info' href='#RFC5280'>[RFC5280]<span> (</span><span class='info'>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; May&nbsp;2008.</span><span>)</span></a>. The
          new certificate can be safely added to the application's store (but not added
          to the list of Trusted Certificates or Trust Anchors) if it has been
          issued by the same issuer of the identified CA certificate.
       
</li>
<li>
          The current certificate is self-signed: in this case, to avoid trust issues,
          the application should trust the pointed certificate only if the certificate
          has the same public key as the old one AND it is self signed (this provides
          proof of possession of the same private key).
       
</li>
</ol><p>
    For more complex trust anchor operations, please refer to <a class='info' href='#oid_endorsedTA'>Section&nbsp;4.18<span> (</span><span class='info'>The Endorsed Trust Anchors identifier</span><span>)</span></a>,
    <a class='info' href='#oid_apexTampUpdate'>Section&nbsp;4.30<span> (</span><span class='info'>The Apex Trust Anchor Update identifier</span><span>)</span></a> or <a class='info' href='#oid_tampUpdate'>Section&nbsp;4.31<span> (</span><span class='info'>The Trust Anchor Update identifier</span><span>)</span></a>.
    
</p>
<a name="oid_issuerCert"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4"></a><h3>4.4.&nbsp;
The Issuer's Certificate identifier</h3>

<p>
     When id-ad-issuerCert is used in a PRQP message, the associated value is in the response 
     the location of the DER formatted certificate of the issuer of the identified
     CA. The version field MAY be used to specify the version
     of the certificate pointed by the URL in a PRQP Response message.
     In order to enhance interoperability between applications and reduce development
     efforts, the URI should point directly to the certificate and not to a redirection
     service.
     </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  id-ad-prqp-issuerCert     OBJECT IDENTIFIER ::= {id-ad-prqp 3 }
</pre></div><p>

     HTTP server implementations accessed via the URI SHOULD specify the media type
     "application/x-x509-ca-cert" in the content-type header field of the response.
    
</p>
<p>
     The content of this service is the same as the content of caIssuers when the
     provided URI refers to the CA Issuer's certificate <a class='info' href='#RFC5280'>[RFC5280]<span> (</span><span class='info'>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; May&nbsp;2008.</span><span>)</span></a>.
     This field allows applications to dynamically download and build validation
     paths and may be extremely useful when cross certificates are used (eg., in
     bridge CAs).
    
</p>
<a name="oid_timestamping"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5"></a><h3>4.5.&nbsp;
The Timestamping Service identifier</h3>

<p>
     When id-ad-timestamping is used in a PRQP message, the associated value in the response is
     the location of the Timestamping responder, using the conventions defined in
     <a class='info' href='#RFC3161'>[RFC3161]<span> (</span><span class='info'>Adams, C., Cain, P., Pinkas, D., and R. Zuccherato, &ldquo;Internet X.509 Public Key Infrastructure Time-Stamp Protocol (TSP),&rdquo; August&nbsp;2001.</span><span>)</span></a>. The version field, if used, indicates the supported
     protocol version.
     </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  id-ad-prqp-timestamping   OBJECT IDENTIFIER ::= {id-ad-prqp 4 }
</pre></div><p>

    
</p>
<a name="oid_scvp"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.6"></a><h3>4.6.&nbsp;
The SCVP Server identifier</h3>

<p>
     When id-ad-prqp-scvp appears in a PRQP request or response, the associated
     value in the response is the location of the SCVP responder, using the conventions defined in
     <a class='info' href='#RFC5055'>[RFC5055]<span> (</span><span class='info'>Freeman, T., Housley, R., Malpani, A., Cooper, D., and W. Polk, &ldquo;Server-Based Certificate Validation Protocol (SCVP),&rdquo; December&nbsp;2007.</span><span>)</span></a>. The version field, if used, indicates the supported
     protocol version.
     </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  id-ad-prqp-scvp           OBJECT IDENTIFIER ::= {id-ad-prqp 5 }
</pre></div><p>

    
</p>
<a name="oid_crlDistribution"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.7"></a><h3>4.7.&nbsp;
The CRL Distribution Point identifier</h3>

<p>
     When id-ad-prqp-crlDistribution appears in a PRQP message, the associated
     value in the response is a pointer to the current CRL. The URI MUST point to a single DER
     encoded CRL as specified in <a class='info' href='#RFC2585'>[RFC2585]<span> (</span><span class='info'>Housley, R. and P. Hoffman, &ldquo;Internet X.509 Public Key Infrastructure Operational Protocols: FTP and HTTP,&rdquo; May&nbsp;1999.</span><span>)</span></a>. The version field,
     if used, indicates the version of the pointed CRL.
     In order to enhance interoperability between applications and reduce development
     efforts, the URI should point directly to the CRL and not to a redirection
     service.
     </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  id-ad-prqp-crlDistribution   OBJECT IDENTIFIER ::= {id-ad-prqp 6 }
</pre></div><p>

     HTTP server implementations accessed via the URI SHOULD specify the media type
     "application/pkix-crl" in the content-type header field of the response.
    
</p>
<a name="oid_certRepository"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.8"></a><h3>4.8.&nbsp;
The Certificates Repository identifier</h3>

<p>
     When id-ad-prqp-certRepository appears in a PRQP message, the associated
     value in the response is a pointer to a set of certificates. The URI MUST point
     to a  collection of certificates in a DER encoded "certs-only" CMS message as
     specified in <a class='info' href='#RFC5272'>[RFC5272]<span> (</span><span class='info'>Schaad, J. and M. Myers, &ldquo;Certificate Management over CMS (CMC),&rdquo; June&nbsp;2008.</span><span>)</span></a>.
     </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  id-ad-prqp-certRepository OBJECT IDENTIFIER ::= {id-ad-prqp 7 }
</pre></div><p>

     HTTP server implementations accessed via the URI SHOULD specify the media type
     "application/pkcs7-mime" <a class='info' href='#RFC5272'>[RFC5272]<span> (</span><span class='info'>Schaad, J. and M. Myers, &ldquo;Certificate Management over CMS (CMC),&rdquo; June&nbsp;2008.</span><span>)</span></a> in the content-type header field
     of the response. The name of the returned file SHOULD have a suffix of ".p7c"
     <a class='info' href='#RFC5272'>[RFC5272]<span> (</span><span class='info'>Schaad, J. and M. Myers, &ldquo;Certificate Management over CMS (CMC),&rdquo; June&nbsp;2008.</span><span>)</span></a>.
    
</p>
<a name="oid_crlRepository"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.9"></a><h3>4.9.&nbsp;
The CRL Repository identifier</h3>

<p>
     When id-ad-prqp-crlRepository appears in a PRQP message, the associated
     value is a pointer to a set of CRL. The URI MUST point to a collection of CRLs
     in a DER encoded CMS message. The type of message should be a Simple PKI
     Response where the CRLs are placed in the CRL bag.

     </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  id-ad-prqp-crlRepository  OBJECT IDENTIFIER ::= {id-ad-prqp 8 }
</pre></div><p>

     HTTP server implementations accessed via the URI SHOULD specify the media type
     "application/pkcs7-mime" <a class='info' href='#RFC5272'>[RFC5272]<span> (</span><span class='info'>Schaad, J. and M. Myers, &ldquo;Certificate Management over CMS (CMC),&rdquo; June&nbsp;2008.</span><span>)</span></a> in the content-type header field
     of the response. The name of the returned file SHOULD have a suffix of ".p7c"
    
</p>
<a name="oid_XcertRepository"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.10"></a><h3>4.10.&nbsp;
The Cross Certificates Repository identifier</h3>

<p>
     When id-ad-prqp-crossCertRepository appears in a PRQP message, the associated
     value in the response is a pointer to a set of Cross Certificates. The URI MUST point
     to a collection of certificates in DER encoded CertificatePair object defined as:
     </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  CertificatePair ::= SEQUENCE {
     forward [0] Certificate OPTIONAL,
     reverse [1] Certificate OPTIONAL,
     -- at least one of the pair shall be present -- }
</pre></div><p>

     The id-ad-prqp-crossCertRepository is defined as follows:
     </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  id-ad-prqp-crossCertRepository
                            OBJECT IDENTIFIER ::= {id-ad-prqp 9 }
</pre></div><p>

     As defined in <a class='info' href='#RFC4523'>[RFC4523]<span> (</span><span class='info'>Zeilenga, K., &ldquo;Lightweight Directory Access Protocol (LDAP) Schema Definitions for X.509 Certificates,&rdquo; June&nbsp;2006.</span><span>)</span></a>, LDAP implementation store the CertificatePair in
     the crossCertificatePair attribute.
    
</p>
<a name="oid_cmcGateway"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.11"></a><h3>4.11.&nbsp;
The CMC Gateway identifier</h3>

<p>
     When id-ad-prqp-cmcGateway appears in a PRQP message, the associated
     value in the response is the location of the CMM over CMS service, using the conventions
     defined in <a class='info' href='#RFC5272'>[RFC5272]<span> (</span><span class='info'>Schaad, J. and M. Myers, &ldquo;Certificate Management over CMS (CMC),&rdquo; June&nbsp;2008.</span><span>)</span></a>. As the <a class='info' href='#RFC5272'>[RFC5272]<span> (</span><span class='info'>Schaad, J. and M. Myers, &ldquo;Certificate Management over CMS (CMC),&rdquo; June&nbsp;2008.</span><span>)</span></a> does not define a version
     for the protocol, if the version field is used to identify the service, applications
     SHOULD ignore it.
     </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  id-ad-prqp-cmcGateway     OBJECT IDENTIFIER ::= {id-ad-prqp 10 }
</pre></div><p>

    
</p>
<a name="oid_cmpGateway"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.12"></a><h3>4.12.&nbsp;
The CMP Gateway identifier</h3>

<p>
     When id-ad-prqp-cmpGateway appears in a PRQP message, the associated
     value in the response is the location of the CMP over CMS service, using the conventions
     defined in <a class='info' href='#RFC4210'>[RFC4210]<span> (</span><span class='info'>Adams, C., Farrell, S., Kause, T., and T. Mononen, &ldquo;Internet X.509 Public Key Infrastructure Certificate Management Protocol (CMP),&rdquo; September&nbsp;2005.</span><span>)</span></a>. As the <a class='info' href='#RFC4210'>[RFC4210]<span> (</span><span class='info'>Adams, C., Farrell, S., Kause, T., and T. Mononen, &ldquo;Internet X.509 Public Key Infrastructure Certificate Management Protocol (CMP),&rdquo; September&nbsp;2005.</span><span>)</span></a> defines the
     protocol version in the pvno field of PKIHeader, the version field MAY be used to
     to identify the required/supported service version.
     </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  id-ad-prqp-cmpGateway     OBJECT IDENTIFIER ::= {id-ad-prqp 11 }
</pre></div><p>

    
</p>
<a name="oid_scepGateway"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.13"></a><h3>4.13.&nbsp;
The SCEP Gateway identifier</h3>

<p>
     When id-ad-prqp-scepGateway appears in a PRQP message, the associated
     value in the response is the location of the CMS service gateway, using the conventions
     defined in <a class='info' href='#I-D.nourse-scep'>[I&#8209;D.nourse&#8209;scep]<span> (</span><span class='info'>Liu, X., &ldquo;Cisco Systems' Simple Certificate Enrollment Protocol,&rdquo; June&nbsp;2008.</span><span>)</span></a>. The version field used to identify the
     service, if present, SHOULD be set to 0.
     </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  id-ad-prqp-scepGateway    OBJECT IDENTIFIER ::= {id-ad-prqp 12 }
</pre></div><p>

    
</p>
<a name="oid_htmlGateway"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.14"></a><h3>4.14.&nbsp;
The HTML Gateway identifier</h3>

<p>
     When id-ad-prqp-htmlGateway appears in a PRQP message, the associated
     value in the response is the location of a HTML CA service.
     </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  id-ad-prqp-htmlGateway    OBJECT IDENTIFIER ::= {id-ad-prqp 13 }
</pre></div><p>

    
</p>
<p>
     The version field, if present, identifies the version of the HTML data as follows:
    
</p><br /><hr class="insert" />
<a name="html_version"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="center"><col align="center">
<tr><th align="center">Version Value</th><th align="center">Data Type</th></tr>
<tr>
<td align="center">0</td>
<td align="center">HTML</td>
</tr>
<tr>
<td align="center">1</td>
<td align="center">XML</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 1&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="oid_xkmsGateway"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.15"></a><h3>4.15.&nbsp;
The XKMS Gateway identifier</h3>

<p>
     When id-ad-prqp-xkmsGateway appears in a PRQP message, the associated
     value in the response is the location of an XKMS server, using the conventions
     defined in <a class='info' href='#W3C.xkms'>[W3C.xkms]<span> (</span><span class='info'>Ford, W., Hallam-Baker, P., Fox, B., Dillaway, B., LaMacchia, B., Epstein, J., and J. Lapp, &ldquo;XML Key Management Specification (XKMS),&rdquo; March&nbsp;2001.</span><span>)</span></a> and <a class='info' href='#W3C.REC-xkms2-20050628'>[W3C.REC&#8209;xkms2&#8209;20050628]<span> (</span><span class='info'>Mysore, S. and P. Hallam-Baker, &ldquo;XML Key Management Specification (XKMS 2.0),&rdquo; June&nbsp;2005.</span><span>)</span></a>. The version field used to
     identify the service, if present, SHOULD be set to 1 for services compliant to
     <a class='info' href='#W3C.xkms'>[W3C.xkms]<span> (</span><span class='info'>Ford, W., Hallam-Baker, P., Fox, B., Dillaway, B., LaMacchia, B., Epstein, J., and J. Lapp, &ldquo;XML Key Management Specification (XKMS),&rdquo; March&nbsp;2001.</span><span>)</span></a> and to 2 for services compliant to <a class='info' href='#W3C.REC-xkms2-20050628'>[W3C.REC&#8209;xkms2&#8209;20050628]<span> (</span><span class='info'>Mysore, S. and P. Hallam-Baker, &ldquo;XML Key Management Specification (XKMS 2.0),&rdquo; June&nbsp;2005.</span><span>)</span></a>.
     </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  id-ad-prqp-xkmsGateway    OBJECT IDENTIFIER ::= {id-ad-prqp 14 }
</pre></div><p>

    
</p>
<a name="oid_certPolicy"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.16"></a><h3>4.16.&nbsp;
The Certificate Policy (CP) identifier</h3>

<p>
     When id-ad-prqp-certPolicy appears in a PRQP message, the associated
     value in the response is the location of a certificate Policy (CP).
     A CP may be used by a relying party to help in deciding whether a certificate,
     and the binding therein, are sufficiently trustworthy and otherwise appropriate
     for a particular application.
     </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  id-ad-prqp-certPolicy     OBJECT IDENTIFIER ::= {id-ad-prqp 20 }
</pre></div><p>

    More information can be found in <a class='info' href='#RFC2527'>[RFC2527]<span> (</span><span class='info'>Chokhani, S. and W. Ford, &ldquo;Internet X.509 Public Key Infrastructure Certificate Policy and Certification Practices Framework,&rdquo; March&nbsp;1999.</span><span>)</span></a>.
    
</p>
<p>
    In order to gather the correct policy under which a certificate is issued, the
    optional OID field in the PRQPRequest SHOULD be copied from the certificate Policy
    extension of the EE certificate (i.e., the certificate issued by the CA the client
    is querying for).
    
</p>
<a name="oid_certPracticeStatement"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.17"></a><h3>4.17.&nbsp;
The Certification Practice Statement (CPS) identifier</h3>

<p>
     When id-ad-prqp-certPolicycertPracticeStatement appears in a PRQP message, the associated
     value in the response is the location of a Certification Practice Statement (CPS)
     published by the CA.
     A CPS is a document that details the practices and procedures established by a CA
     that will cover the life-cycle of certificates issued by the CA.  That is it
     covers how the certificate will be generated, suspended and revoked.
     An internally focused document covering the internal environment of the CA.
     </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  id-ad-prqp-certPracticeStatement
                            OBJECT IDENTIFIER ::= {id-ad-prqp 21 }
</pre></div><p>

     More information can be found in <a class='info' href='#RFC2527'>[RFC2527]<span> (</span><span class='info'>Chokhani, S. and W. Ford, &ldquo;Internet X.509 Public Key Infrastructure Certificate Policy and Certification Practices Framework,&rdquo; March&nbsp;1999.</span><span>)</span></a>.
    
</p>
<a name="oid_endorsedTA"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.18"></a><h3>4.18.&nbsp;
The Endorsed Trust Anchors identifier</h3>

<p>
     When id-ad-prqp-endorsedTA appears in a PRQP message, the associated
     value in the response is a pointer to a set of Trust Anchors (TA) in the form
     of certificates. The URI MUST point to a collection of certificates in a DER
     encoded CMS signedData message as specified in <a class='info' href='#RFC5272'>[RFC5272]<span> (</span><span class='info'>Schaad, J. and M. Myers, &ldquo;Certificate Management over CMS (CMC),&rdquo; June&nbsp;2008.</span><span>)</span></a>.
     </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  id-ad-prqp-endorsedTA     OBJECT IDENTIFIER ::= {id-ad-prqp 22 }
</pre></div><p>

     HTTP server implementations accessed via the URI SHOULD specify the media type
     "application/pkcs7-mime" <a class='info' href='#RFC5272'>[RFC5272]<span> (</span><span class='info'>Schaad, J. and M. Myers, &ldquo;Certificate Management over CMS (CMC),&rdquo; June&nbsp;2008.</span><span>)</span></a> in the content-type header field
     of the response. The name of the returned file SHOULD have a suffix of ".p7"
     <a class='info' href='#RFC5272'>[RFC5272]<span> (</span><span class='info'>Schaad, J. and M. Myers, &ldquo;Certificate Management over CMS (CMC),&rdquo; June&nbsp;2008.</span><span>)</span></a>. The returned data object SHOULD be signed directly by the
     CA or by an authorized Identity whose certificate has been issued by the CA (i.e., an EE
     certificate).
     The application SHOULD verify the signature on the CMS message before proceeding
     in accepting the set of TAs.
     Moreover the application MAY import the set of certificates in its own certificate store
     as trusted depending on previous trust settings or input from the user.
    
</p>
<a name="oid_loaPolicy"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.19"></a><h3>4.19.&nbsp;
The LOA Policy (LP) identifier</h3>

<p>
     When id-ad-prqp-loaPolicy appears in a PRQP message, the associated
     value in the response is the location of a Level of Assurance Policy (LP)
     published by the CA.
     An LP is a document that details the practices and procedures established by a CA
     that will cover the requirements for each Level of Assurance. The OID field
     in the request/response MAY be used to identify a specific LOA Policy document.
     </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  id-ad-prqp-loaPolicy      OBJECT IDENTIFIER ::= {id-ad-prqp 25 }
</pre></div><p>

     More information can be found in <a class='info' href='#RFC2527'>[RFC2527]<span> (</span><span class='info'>Chokhani, S. and W. Ford, &ldquo;Internet X.509 Public Key Infrastructure Certificate Policy and Certification Practices Framework,&rdquo; March&nbsp;1999.</span><span>)</span></a>.
    
</p>
<a name="oid_loaModifier"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.20"></a><h3>4.20.&nbsp;
The Certificate LOA Modifier identifier</h3>

<p>
     When id-ad-prqp-certLOAModifier appears in a PRQP message, the associated
     value in the response is the location of a LOA Level Modifier.
     The LOA modifier service is used to identify the current LOA Level
     of the certificate (not the LOA under which the certificate has been issued).
     </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  id-ad-prqp-certLOAModifier OBJECT IDENTIFIER ::= {id-ad-prqp 26 }
</pre></div><p>

    
</p>
<a name="oid_htmlRequest"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.21"></a><h3>4.21.&nbsp;
The HTML Certificate Request Service identifier</h3>

<p>
     When id-ad-prqp-htmlRequestCertificate appears in a PRQP message, the associated
     value in the response is the location of a HTML certificate request service.
     The version field, when present, identifies the version of the supported HTML
     format. See Table <a class='info' href='#html_version'>Table&nbsp;1</a> for more details.
     As not standard exists that describes how to interact with a CA via HTML, this
     locator should be mainly used for browser-based certification requests.
     </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  id-ad-prqp-htmlRequestCertificate
                            OBJECT IDENTIFIER ::= {id-ad-prqp 30}
</pre></div><p>

    
</p>
<a name="oid_htmlRevoke"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.22"></a><h3>4.22.&nbsp;
The HTML Certificate Revoke Service identifier</h3>

<p>
     When id-ad-prqp-htmlRevokeCertificate appears in a PRQP message, the associated
     value in the response is the location of a HTML certificate revoking service.
     The version field, when present, identifies the version of the supported HTML
     format. See Table <a class='info' href='#html_version'>Table&nbsp;1</a> for more details.
     As not standard exists that describes how to interact with a CA via HTML, this
     locator should be mainly used for browser-based certification requests.
     </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  id-ad-prqp-htmlRevokeCertificate
                            OBJECT IDENTIFIER ::= {id-ad-prqp 31}
</pre></div><p>

    
</p>
<a name="oid_htmlRenew"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.23"></a><h3>4.23.&nbsp;
The HTML Certificate Renew Service identifier</h3>

<p>
     When id-ad-prqp-htmlRenewCertificate appears in a PRQP message, the associated
     value in the response is the location of a HTML certificate renewal service.
     The version field, when present, identifies the version of the supported HTML
     format. <a class='info' href='#html_version'>Table&nbsp;1</a>
     As not standard exists that describes how to interact with a CA via HTML, this
     locator should be mainly used for browser-based certificate renewal requests.
     </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  id-ad-prqp-htmlRenewCertificate
                            OBJECT IDENTIFIER ::= {id-ad-prqp 32}
</pre></div><p>

    
</p>
<a name="oid_htmlSuspend"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.24"></a><h3>4.24.&nbsp;
The HTML Certificate Suspend Service identifier</h3>

<p>
     When id-ad-prqp-htmlSuspendCertificate appears in a PRQP message, the associated
     value in the response is the location of a HTML certificate suspension service.
     The version field, when present, identifies the version of the supported HTML
     format. See Table <a class='info' href='#html_version'>Table&nbsp;1</a> for more details.
     As not standard exists that describes how to interact with a CA via HTML, this
     locator should be mainly used for browser-based certificate suspension requests.
     </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  id-ad-prqp-htmlSuspendCertificate
                            OBJECT IDENTIFIER ::= {id-ad-prqp 33}
</pre></div><p>

    
</p>
<a name="oid_htmlRecovery"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.25"></a><h3>4.25.&nbsp;
The HTML Certificate Recovery Service Identifier</h3>

<p>
     When id-ad-prqp-htmlRecoveryCertificate appears in a PRQP message, the associated
     value in the response is the location of a HTML certificate recovery service.
     The version field, when present, identifies the version of the supported HTML
     format. See Table <a class='info' href='#html_version'>Table&nbsp;1</a> for more details.
     The recovery service is used when a user's local copy of their keys and key history is
     destroyed. The recovery service returns the user to a complete state (e.g. so they can
     decrypt messages that were encrypted with older keys).
     As not standard exists that describes how to interact with a CA via HTML, this
     locator should be mainly used for browser-based certificate recovery requests.
     </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  id-ad-prqp-htmlRecoveryCertificate
                            OBJECT IDENTIFIER ::= {id-ad-prqp 34}
</pre></div><p>

    
</p>
<a name="oid_gridBody"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.26"></a><h3>4.26.&nbsp;
The Grid Accreditation Body identifier</h3>

<p>
     When id-ad-prqp-grid-accreditationBody appears in a PRQP message, the associated
     value in the response is the location of the main information point of the
     Grid Policy Management Authority (GPMA) that accredited the CA.
     The pointer SHOULD NOT be present if the CA has not been accredited by the GPMA.
     </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  id-ad-prqp-grid-accreditationBody
                                OBJECT IDENTIFIER ::= {id-ad-prqp 50}
</pre></div><p>

    
</p>
<a name="oid_gridPolicy"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.27"></a><h3>4.27.&nbsp;
The Grid Policy identifier</h3>

<p>
     When id-ad-prqp-grid-accreditationPolicy appears in a PRQP message, the associated
     value in the response is the location of an Accreditation Policy published by a
     Grid Policy Management Authority (GPMA).
     The OID field SHOULD be used to uniquely identify the accreditation policy under
     which the CA has been accredited.
     The pointer SHOULD NOT be present if the CA has not been accredited by the GPMA.
     A Grid Policy (GP) is a document that details the practices and procedures required
     from a CA in order to be accredited by the GPMA.
     </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  id-ad-prqp-grid-accreditationPolicy
                                OBJECT IDENTIFIER ::= {id-ad-prqp 51}
</pre></div><p>

    
</p>
<a name="oid_gridDistPolicy"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.28"></a><h3>4.28.&nbsp;
The Grid Distribution Update identifier</h3>

<p>
     When id-ad-prqp-grid-commonDistributionUpdate appears in a PRQP message, the associated
     value in the response is the location of the Grid Distribution Package associated with
     the Grid Policy Management Authority (GPMA) that accredited the CA.
     The OID field SHOULD be used to uniquely identify the accreditation policy under
     which the Grid Distribution Package has been released.
     The pointer SHOULD NOT be present if the CA has not been accredited by the GPMA.
     </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  id-ad-prqp-grid-commonDistributionUpdate
                                OBJECT_IDENTIFIER ::= {id-ad-prqp 53}
</pre></div><p>

    
</p>
<a name="oid_gridAccreditedCACerts"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.29"></a><h3>4.29.&nbsp;
The Grid Accredited CA Certificates identifier</h3>

<p>
     When id-ad-prqp-gridAccreditedCACerts appears in a PRQP message, the associated
     value in the response is a pointer to a set of Trust Anchors (TA) in the form
     of certificates accredited by the Grid body/bodies that the CA is participating to.
     The URI MUST point to a collection of certificates in a DER
     encoded CMS signedData message as specified in <a class='info' href='#RFC5272'>[RFC5272]<span> (</span><span class='info'>Schaad, J. and M. Myers, &ldquo;Certificate Management over CMS (CMC),&rdquo; June&nbsp;2008.</span><span>)</span></a>.
     The OID field SHOULD be used to uniquely identify the accreditation policy under
     which the set of CAs pointed by the URI have been accredited.
     </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  id-ad-prqp-grid-gridAccreditedCACerts
                                OBJECT_IDENTIFIER ::= {id-ad-prqp 54}
</pre></div><p>

     HTTP server implementations accessed via the URI SHOULD specify the media type
     "application/pkcs7-mime" <a class='info' href='#RFC5272'>[RFC5272]<span> (</span><span class='info'>Schaad, J. and M. Myers, &ldquo;Certificate Management over CMS (CMC),&rdquo; June&nbsp;2008.</span><span>)</span></a> in the content-type header field
     of the response. The name of the returned file SHOULD have a suffix of ".p7"
     <a class='info' href='#RFC5272'>[RFC5272]<span> (</span><span class='info'>Schaad, J. and M. Myers, &ldquo;Certificate Management over CMS (CMC),&rdquo; June&nbsp;2008.</span><span>)</span></a>. The returned data object SHOULD be signed by the CA
     the endorsedTA service has been requested for.
     The application SHOULD verify the signature on the CMS message before proceeding
     in accepting the set of TAs.
     Moreover the application MAY import the set of certificates in its own certificate store
     as trusted depending on previous trust settings or input from the user.
    
</p>
<a name="oid_apexTampUpdate"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.30"></a><h3>4.30.&nbsp;
The Apex Trust Anchor Update identifier</h3>

<p>
     When id-ad-prqp-apexTampUpdate appears in a PRQP message, the associated
     value in the response is the location of a Apex Trust Anchor Update (apexTrustAnchorUpdate)
     message as defined by using the conventions defined in <a class='info' href='#I-D.pkix-tamp'>[I&#8209;D.pkix&#8209;tamp]<span> (</span><span class='info'>Housley, R., Ashmore, S., and C. Wallace, &ldquo;Trust Anchor Management Protocol (TAMP),&rdquo; October&nbsp;2008.</span><span>)</span></a>.
     The version field used to
     identify the service, if present, SHOULD reflect the supported TAMP version.
     </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  id-ad-prqp-apexTampUpdate     OBJECT IDENTIFIER ::= {id-ad-prqp 70}
</pre></div><p>

    
</p>
<a name="oid_tampUpdate"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.31"></a><h3>4.31.&nbsp;
The Trust Anchor Update identifier</h3>

<p>
     When id-ad-prqp-tampUpdate appears in a PRQP message, the associated
     value in the response is the location of a Trust Anchor Update (trustAnchorUpdate) 
     message as defined by using the conventions defined in <a class='info' href='#I-D.pkix-tamp'>[I&#8209;D.pkix&#8209;tamp]<span> (</span><span class='info'>Housley, R., Ashmore, S., and C. Wallace, &ldquo;Trust Anchor Management Protocol (TAMP),&rdquo; October&nbsp;2008.</span><span>)</span></a>.
     The version field used to
     identify the service, if present, SHOULD reflect the supported TAMP version.
     </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  id-ad-prqp-tampUpdate     OBJECT IDENTIFIER ::= {id-ad-prqp 71 }
</pre></div><p>

    
</p>
<a name="oid_caIncidentReport"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.32"></a><h3>4.32.&nbsp;
The CA Incident Report identifier</h3>

<p>
     When id-ad-prqp-caIncidentReport appears in a PRQP message, the associated
     value in the response is the location of a Incident Report submission service.
     No standard mechanisms are currently defined for this type of service, therefore
     the  The resourceInfo field in the response SHOULD be used to provide information
     on the provided Incident Report service.
     For example while the URI could point to a web-page carrying contacts information
     or a ticketing system for reporting CA-related incidents, the resourceInfo field
     could provide text carrying information that may be displayed to the user (e.g.,
     a support phone number). This would allow support for a wide range of different
     devices and applications as long as they have the ability to display or read the
     content of the resourceInfo field to the user.
     </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  id-ad-prqp-caIncidentReport
                            OBJECT IDENTIFIER ::= {id-ad-prqp 90}
</pre></div><p>

    
</p>
<a name="oid_private"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.33"></a><h3>4.33.&nbsp;
The Private Resources identifier</h3>

<p>
     When an application wants to identify private resources, i.e. services that are not
     standardized in the PRQP standard definition, id-ad-prqp-private should be used as
     the base OID:
     </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  id-ad-prqp-private        OBJECT IDENTIFIER ::= {id-ad-prqp 100}
</pre></div><p>

     The OIDs for a private resource can be identified as follows:
     </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  myPrivateResource     OBJECT IDENTIFIER ::= {id-ad-prqp-private N}
</pre></div><p>

    
</p>
<a name="iana"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
IANA Considerations</h3>

<p>
    IANA has assigned a value of TBD1 for the DHCP option code described in
    Section <a class='info' href='#dhcp_pki_resource_query_authority_ipv4'>Appendix&nbsp;B.1.1<span> (</span><span class='info'>PRQP Servers IPv4 Option for DHCPv4</span><span>)</span></a> of this document.
 
</p>
<p>
    IANA has assigned a value of TBD2 for the DHCPv6 option code described in
    Section <a class='info' href='#dhcp_pki_resource_query_authority_ipv6'>Appendix&nbsp;B.1.2<span> (</span><span class='info'>PRQP Servers IPv6 Option for DHCPv6</span><span>)</span></a> of this document.
 
</p>
<a name="rationale"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
PRQP Design Rationale</h3>

<p>

   In this section we provide some considerations about the protocol design
   and its details.
   
</p>
<a name="complexity"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
Response Complexity</h3>

<p>
   An important design consideration is the complexity of messages. Some type
   of services, e.g. delta CRLs, can be directly detected upon data
   downloading. On the contrary if a client is looking for a specific
   version of a protocol or data type, the definition of a fine-grained
   query system would allow for data downloading only when it is actually
   supported by the requesting client, thus reducing the server's load.
   <br />
<br />

   At present we think that keeping the protocol simple will encourage
   its adoption in current environments because the flexibility introduced
   by PRQP is a big enhancement over the current options.
   <br />
<br />

   Moreover, without requiring changes to the protocol, extensions could
   be defined to provide more fine grained options.
   <br />
<br />

   Future versions of the protocol may implement extended request
   and response types if required by applications.
   
</p>
<a name="uri"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
RQA's URL distribution</h3>

<p>
   The AIA and SIA extensions in certificates can be used to carry the
   pointer to the RQA. If no RQA address is present in the certificate,
   a client application could use a default configured URL.
   <br />
<br />

   Although this approach seems to contradict the criticism of Certificate
   extensions use in <a class='info' href='#exts'>Section&nbsp;2.1.1<span> (</span><span class='info'>Certificate Extensions</span><span>)</span></a>, using only one extension
   to locate the RQA would provide an easy way to distribute the RQA's URL.
   <br />
<br />

   The usage of PRQP will provide a gateway for all the other services
   and data URLs.
   
</p>
<a name="security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.3"></a><h3>6.3.&nbsp;
Security Considerations</h3>

<p>
   The PRQP provides URLs for PKI resources. This means that it provides
   locators to data and services, not the data per se. It still remains
   the client's job to access the provided URLs to gather the needed data.
   <br />
<br />

   Both NONCEs and signatures are optional in order to provide flexibility
   in how requests and responses are generated.
   <br />
<br />

   It is possible to provide pre-computed responses in case the NONCE is
   not provided by the client. This allows the RQA to generate off-line
   signatures for responses, an optimization used in OCSP.
   <br />
<br />

   Moreover if an authenticated secure channel is used at the transport level
   between the client and the RQA (e.g. HTTPS or SFTP) signatures in requests
   and responses can be safely omitted.
   
</p>
<a name="time"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.4"></a><h3>6.4.&nbsp;
Time Validity</h3>

<p>
   The time validity should reflect the frequency of updates in configured
   URLs. An interesting aspect to be considered is how often would users
   execute the protocol for a given set of data.
   <br />
<br />

   If the clients query the server often it could be a serious burden
   on the server but, if executed rarely, clients would not be able to
   discover changes in provided resources.
   <br />
<br />

   As described in more detail in <a class='info' href='#app_A'>Appendix&nbsp;A<span> (</span><span class='info'>Transport Protocol Specifications for PRQP Messages</span><span>)</span></a>,
   the adoption of a validity
   time frame for responses can be used as a mean to balance the trade off
   between this two aspects, but this is merely advisory
   data for clients and thus not a guarantee against DoS attacks by clients.
   
</p>
<a name="format"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.5"></a><h3>6.5.&nbsp;
Message Format</h3>

<p>
   Two different candidates have been considered. The first one is the
   Extensible Markup Language (XML), while the second one is the
   Distinguished Encoding Rules (DER).
   <br />
<br />

   The adoption of the Abstract Syntax Notation (ASN.1) to describe the
   data structures allows a software developer to provide either DER or XML
   based implementations of the protocol.
   <br />
<br />

   However we think that a DER based implementation of PRQP is the best
   choice because of compatibility considerations with existing applications
   and APIs. Moreover DER encoded messages are smaller in size then XML
   encoded ones and almost all PKI aware applications already support it.
   
</p>
<a name="acknowledgments"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Acknowledgments</h3>

<p>
  The authors would like to thank Stephen Kent for his insightful comments 
  about PRQP and his help in writing this document.
  
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>8.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.ietf-dhc-option-guidelines">[I-D.ietf-dhc-option-guidelines]</a></td>
<td class="author-text">Hankins, D., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-dhc-option-guidelines-03.txt">Guidelines for Creating New DHCP Options</a>,&rdquo; draft-ietf-dhc-option-guidelines-03 (work in progress), October&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-dhc-option-guidelines-03.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.pkix-tamp">[I-D.pkix-tamp]</a></td>
<td class="author-text">Housley, R., Ashmore, S., and C. Wallace, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-pkix-tamp.txt">Trust Anchor Management Protocol (TAMP)</a>,&rdquo; draft-ietf-pkix-tamp (work in progress), October&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-pkix-tamp-00.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1035">[RFC1035]</a></td>
<td class="author-text">Mockapetris, P., &ldquo;<a href="http://tools.ietf.org/html/rfc1035">Domain names - implementation and specification</a>,&rdquo; STD&nbsp;13, RFC&nbsp;1035, November&nbsp;1987 (<a href="ftp://ftp.isi.edu/in-notes/rfc1035.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="ftp://ftp.isi.edu/in-notes/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2527">[RFC2527]</a></td>
<td class="author-text"><a href="mailto:chokhani@cygnacom.com">Chokhani, S.</a> and <a href="mailto:wford@verisign.com">W. Ford</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2527">Internet X.509 Public Key Infrastructure Certificate Policy and Certification Practices Framework</a>,&rdquo; RFC&nbsp;2527, March&nbsp;1999 (<a href="ftp://ftp.isi.edu/in-notes/rfc2527.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2560">[RFC2560]</a></td>
<td class="author-text"><a href="mailto:mmyers@verisign.com">Myers, M.</a>, <a href="mailto:rankney@erols.com">Ankney, R.</a>, <a href="mailto:ambarish@valicert.com">Malpani, A.</a>, <a href="mailto:galperin@mycfo.com">Galperin, S.</a>, and <a href="mailto:cadams@entrust.com">C. Adams</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2560">X.509 Internet Public Key Infrastructure Online Certificate Status Protocol - OCSP</a>,&rdquo; RFC&nbsp;2560, June&nbsp;1999 (<a href="ftp://ftp.isi.edu/in-notes/rfc2560.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2585">[RFC2585]</a></td>
<td class="author-text"><a href="mailto:housley@spyrus.com">Housley, R.</a> and <a href="mailto:phoffman@imc.org">P. Hoffman</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2585">Internet X.509 Public Key Infrastructure Operational Protocols: FTP and HTTP</a>,&rdquo; RFC&nbsp;2585, May&nbsp;1999 (<a href="ftp://ftp.isi.edu/in-notes/rfc2585.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2608">[RFC2608]</a></td>
<td class="author-text"><a href="mailto:Erik.Guttman@sun.com">Guttman, E.</a>, <a href="mailto:cperkins@sun.com">Perkins, C.</a>, <a href="mailto:veizades@home.net">Veizades, J.</a>, and <a href="mailto:mday@vinca.com">M. Day</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2608">Service Location Protocol, Version 2</a>,&rdquo; RFC&nbsp;2608, June&nbsp;1999 (<a href="ftp://ftp.isi.edu/in-notes/rfc2608.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2609">[RFC2609]</a></td>
<td class="author-text"><a href="mailto:erik.guttman@sun.com">Guttman, E.</a>, <a href="mailto:cperkins@sun.com">Perkins, C.</a>, and <a href="mailto:james.kempf@sun.com">J. Kempf</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2609">Service Templates and Service: Schemes</a>,&rdquo; RFC&nbsp;2609, June&nbsp;1999 (<a href="ftp://ftp.isi.edu/in-notes/rfc2609.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2782">[RFC2782]</a></td>
<td class="author-text"><a href="mailto:arnt@troll.no">Gulbrandsen, A.</a>, Vixie, P., and <a href="mailto:levone@microsoft.com">L. Esibov</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2782">A DNS RR for specifying the location of services (DNS SRV)</a>,&rdquo; RFC&nbsp;2782, February&nbsp;2000 (<a href="ftp://ftp.isi.edu/in-notes/rfc2782.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2797">[RFC2797]</a></td>
<td class="author-text"><a href="mailto:mmyers@verisign.com">Myers, M.</a>, <a href="mailto:xliu@cisco.com">Liu, X.</a>, <a href="mailto:jimsch@nwlink.com">Schaad, J.</a>, and <a href="mailto:jsw@meer.net">J. Weinstein</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2797">Certificate Management Messages over CMS</a>,&rdquo; RFC&nbsp;2797, April&nbsp;2000 (<a href="ftp://ftp.isi.edu/in-notes/rfc2797.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3161">[RFC3161]</a></td>
<td class="author-text">Adams, C., Cain, P., Pinkas, D., and R. Zuccherato, &ldquo;<a href="http://tools.ietf.org/html/rfc3161">Internet X.509 Public Key Infrastructure Time-Stamp Protocol (TSP)</a>,&rdquo; RFC&nbsp;3161, August&nbsp;2001 (<a href="ftp://ftp.isi.edu/in-notes/rfc3161.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3280">[RFC3280]</a></td>
<td class="author-text">Housley, R., Polk, W., Ford, W., and D. Solo, &ldquo;<a href="http://tools.ietf.org/html/rfc3280">Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>,&rdquo; RFC&nbsp;3280, April&nbsp;2002 (<a href="ftp://ftp.isi.edu/in-notes/rfc3280.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3315">[RFC3315]</a></td>
<td class="author-text">Droms, R., Bound, J., Volz, B., Lemon, T., Perkins, C., and M. Carney, &ldquo;<a href="http://tools.ietf.org/html/rfc3315">Dynamic Host Configuration Protocol for IPv6 (DHCPv6)</a>,&rdquo; RFC&nbsp;3315, July&nbsp;2003 (<a href="ftp://ftp.isi.edu/in-notes/rfc3315.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4210">[RFC4210]</a></td>
<td class="author-text">Adams, C., Farrell, S., Kause, T., and T. Mononen, &ldquo;<a href="http://tools.ietf.org/html/rfc4210">Internet X.509 Public Key Infrastructure Certificate Management Protocol (CMP)</a>,&rdquo; RFC&nbsp;4210, September&nbsp;2005 (<a href="ftp://ftp.isi.edu/in-notes/rfc4210.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4248">[RFC4248]</a></td>
<td class="author-text">Hoffman, P., &ldquo;<a href="http://tools.ietf.org/html/rfc4248">The telnet URI Scheme</a>,&rdquo; RFC&nbsp;4248, October&nbsp;2005 (<a href="ftp://ftp.isi.edu/in-notes/rfc4248.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4266">[RFC4266]</a></td>
<td class="author-text">Hoffman, P., &ldquo;<a href="http://tools.ietf.org/html/rfc4266">The gopher URI Scheme</a>,&rdquo; RFC&nbsp;4266, November&nbsp;2005 (<a href="ftp://ftp.isi.edu/in-notes/rfc4266.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5055">[RFC5055]</a></td>
<td class="author-text">Freeman, T., Housley, R., Malpani, A., Cooper, D., and W. Polk, &ldquo;<a href="http://tools.ietf.org/html/rfc5055">Server-Based Certificate Validation Protocol (SCVP)</a>,&rdquo; RFC&nbsp;5055, December&nbsp;2007 (<a href="ftp://ftp.isi.edu/in-notes/rfc5055.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5272">[RFC5272]</a></td>
<td class="author-text">Schaad, J. and M. Myers, &ldquo;<a href="http://tools.ietf.org/html/rfc5272">Certificate Management over CMS (CMC)</a>,&rdquo; RFC&nbsp;5272, June&nbsp;2008 (<a href="ftp://ftp.isi.edu/in-notes/rfc5272.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>8.2.&nbsp;Non-Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.nourse-scep">[I-D.nourse-scep]</a></td>
<td class="author-text">Liu, X., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-nourse-scep-17.txt">Cisco Systems' Simple Certificate Enrollment Protocol</a>,&rdquo; draft-nourse-scep-17 (work in progress), June&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-nourse-scep-17.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="PEACH">[PEACH]</a></td>
<td class="author-text">Pala, M. and S. Smith, &ldquo;<a href="http://www.springerlink.com/content/2056p1g137723187/">Peaches and Peers</a>,&rdquo; LNCS&nbsp;5057, June&nbsp;2008.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4523">[RFC4523]</a></td>
<td class="author-text">Zeilenga, K., &ldquo;<a href="http://tools.ietf.org/html/rfc4523">Lightweight Directory Access Protocol (LDAP) Schema Definitions for X.509 Certificates</a>,&rdquo; RFC&nbsp;4523, June&nbsp;2006 (<a href="ftp://ftp.isi.edu/in-notes/rfc4523.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5280">[RFC5280]</a></td>
<td class="author-text">Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;<a href="http://tools.ietf.org/html/rfc5280">Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>,&rdquo; RFC&nbsp;5280, May&nbsp;2008 (<a href="ftp://ftp.isi.edu/in-notes/rfc5280.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="W3C.REC-xkms2-20050628">[W3C.REC-xkms2-20050628]</a></td>
<td class="author-text">Mysore, S. and P. Hallam-Baker, &ldquo;<a href="http://www.w3.org/TR/2005/REC-xkms2-20050628">XML Key Management Specification (XKMS 2.0)</a>,&rdquo; World Wide Web Consortium Recommendation&nbsp;REC-xkms2-20050628, June&nbsp;2005 (<a href="http://www.w3.org/TR/2005/REC-xkms2-20050628">HTML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="W3C.xkms">[W3C.xkms]</a></td>
<td class="author-text"><a href="mailto:wford@verisign.com">Ford, W.</a>, <a href="mailto:pbaker@verisign.com">Hallam-Baker, P.</a>, <a href="mailto:bfox@EXCHANGE.MICROSOFT.com">Fox, B.</a>, <a href="mailto:blaird@microsoft.com">Dillaway, B.</a>, <a href="mailto:bal@microsoft.com">LaMacchia, B.</a>, <a href="mailto:jepstein@webmethods.com">Epstein, J.</a>, and <a href="mailto:jlapp@webmethods.com">J. Lapp</a>, &ldquo;<a href="http://www.w3.org/TR/xkms/">XML Key Management Specification (XKMS)</a>,&rdquo; W3C Note&nbsp;xkms, March&nbsp;2001.</td></tr>
</table>

<a name="app_A"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Transport Protocol Specifications for PRQP Messages</h3>

<a name="http"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1"></a><h3>A.1.&nbsp;
PRQP over HTTP</h3>

<p>
   This section describes the formatting needed in order to route PRQP
   request and response over HTTP.
   
</p>
<a name="httpreq"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1.1"></a><h3>A.1.1.&nbsp;
Request</h3>

<p>
   HTTP based PRQP requests SHOULD use the POST method to submit their
   requests. Where privacy is a requirement, PRQP transactions
   exchanged using HTTP MAY be protected using either TLS/SSL or some
   other lower layer protocol.
   <br />
<br />

   The required HTTP headers for the request are:
   </p>
<ul class="text">
<li>Content-Type
</li>
<li>Content-Transfer-Encoding
</li>
<li>Content-Length
</li>
</ul><p>
   The Content-Type header SHOULD be set to "application/prqp-request".
   The Content-Transfer-Encoding SHOULD be set to "Binary", while the
   Content-Length SHOULD be set to the length (in bytes) of the body
   of the request. The body of the HTTP message MUST carry the binary
   value of the DER encoding of the PRQPRequest.
   
</p>
<a name="httpresp"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1.2"></a><h3>A.1.2.&nbsp;
Response</h3>

<p>
   An HTTP-based PRQP response is composed of the appropriate HTTP
   headers, followed by the binary value of the DER encoding of the
   PRQPPResponse.
   <br />
<br />

   The required HTTP headers for the response are:
   </p>
<ul class="text">
<li>Content-Type
</li>
<li>Content-Transfer-Encoding
</li>
<li>Content-Length
</li>
</ul><p>
   The Content-Type header SHOULD be set to "application/prqp-response".
   The Content-Transfer-Encoding SHOULD be set to "Binary", while the
   Content-Length SHOULD be set to the length (in bytes) of the body
   of the request. The body of the HTTP message MUST carry the binary
   value of the DER encoding of the PRQPResponse.
   
</p>
<a name="caching"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1.3"></a><h3>A.1.3.&nbsp;
Message Caching</h3>

<p>
   To minimize bandwidth usage, clients MUST locally cache authoritative
   PRQP responses for the validity period of the request. To enable
   proxy servers to be able to cache responses as well, additional HTTP
   headers MAY be used in the response.
   <br />
<br />

   The PRQP responder MAY ease caching by setting the following headers:
   </p>
<ul class="text">
<li>date
</li>
<li>last-modified
</li>
<li>expires
</li>
</ul><p>
   In particular, the date field SHOULD carry the date at which the HTTP
   response has been generated. The last-modified, instead, SHOULD bear the
   date at which the response has been modified. This field SHOULD carry
   the same date as the producedAt field of the PRQPResponse.
   The expires field SHOULD carry the date till when the response is to be
   considered valid. This field SHOULD carry the same date as in the
   nextUpdate field of the PRQPResponse.
   <br />
<br />

   An example HTTP response would look like:
   
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      HTTP/1.0 200 OK
      Content-Type: application/prqp-response
      Content-Transfer-Encoding: Binary
      Content-Length: 860
      Date: Thu, 03 May 2007 04:43:43 GMT
      Last-Modified: Thu, 03 May 2007 04:43:42 GMT
      Expires: Thu, 04 May 2007 04:43:42 GMT

      &lt;...response data...&gt;
</pre></div>
<p>
   PRQP clients SHOULD NOT included a no-cache header in PRQP request 
   messages, unless the client encounters an expired response which may 
   be a result of an intermediate proxy caching stale data.
   
</p>
<a name="p2p"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.2"></a><h3>A.2.&nbsp;
PRQP over Peer-to-Peer Network</h3>

<p>
   PRQP offers a starting point for the development of a PKI Resource
   Discovery Architecture where different RQAs cooperate to access data
   not locally available.
   <br />
<br />

   One technology that already provides good results in data sharing is
   Peer-to-Peer (P2P) networking.
   <br />
<br />

   Signed PRQP requests and responses can be routed also on existing P2P
   networks or a PRQP-specific network can be setup to provide a World
   Wide PKI Resources Discovery Architecture (PRDA), the definition of
   which is out of the scope of this document.
   An example of such an architecture is PEACH <a class='info' href='#PEACH'>[PEACH]<span> (</span><span class='info'>Pala, M. and S. Smith, &ldquo;Peaches and Peers,&rdquo; June&nbsp;2008.</span><span>)</span></a>
   
</p>
<a name="app_B"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B"></a><h3>Appendix B.&nbsp;
RQA address Retrieval</h3>

<a name="dhcp_rqa"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B.1"></a><h3>B.1.&nbsp;
DHCP Specifications</h3>

<p>
   This section describes the needed steps to distribute RQAs addresses
   by using DHCP extensions. In particular we define the DHCP option needed
   to identify an RQA server and we suggest options parsing for DHCP server
   and clients.
   
</p>
<a name="dhcp_pki_resource_query_authority_ipv4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B.1.1"></a><h3>B.1.1.&nbsp;
PRQP Servers IPv4 Option for DHCPv4</h3>

<p>We define a prqp-servers option for DHCPv4 that specifies a list
   of Resource Query Authorities (PRQP servers) available to the client.
   The RQA address MUST be expressed as IPv4 addresses.
   Servers SHOULD be listed in order of preference and clients MUST treat
   the list of PRQP servers as an ordered list.
   
</p>
<p>
   The format for the prqp-servers option is as shown below:
   
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
       Code   Len  Address 1               Address 2
     +------+-----+-----+-----+-----+-----+-----+--
     | TBD1 |  n  | a1  | a2  | a3  | a4  | a1  |  ...
     +------+-----+-----+-----+-----+-----+-----+--
</pre></div>
<p>
   The code for the pki resource query authority list option is TBD1. The
   minimum length for this option is 1 octets.
   
</p>
<a name="dhcp_pki_resource_query_authority_ipv6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B.1.2"></a><h3>B.1.2.&nbsp;
PRQP Servers IPv6 Option for DHCPv6</h3>

<p>We define a prqp-servers option for DHCPv6 that specifies a list
   of Resource Query Authorities (PRQP servers) available to the client.
   The RQA address MUST be expressed as IPv6 addresses (128-bit).
   Servers SHOULD be listed in order of preference and clients MUST treat
   the list of PRQP servers as an ordered list.
   
</p>
<p>
   The format for the prqp-servers option is as follows:
   
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |        OPTION_RQA_LIST        |         option-len            |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                                                               |
    |                    PRQP server (IPv6 address)                 |
    |                                                               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                                                               |
    |                    PRQP server (IPv6 address)                 |
    |                                                               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                              ...                              |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

    option-code:  OPTION_PRQP_SERVERS (TBD2)

    option-len:   Length of the 'PRQP servers' field in octets; it must
                  be a multiple of 16

    PRQP server:  IPv6 address of Resource Query Authority (PRQP) Server
</pre></div>
<p>
   The RQA address(es) specified in the 'PRQP server' MUST be encoded as
   IPv6 addresses.
   The code for the prqp-servers option for IPv6 is TBD2. The
   minimum length for this option is 1 octets.
   
</p>
<a name="dhcp_prqa_clients"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B.1.3"></a><h3>B.1.3.&nbsp;
DHCP Configuration</h3>

<p>
   As reported in <a class='info' href='#I-D.ietf-dhc-option-guidelines'>[I&#8209;D.ietf&#8209;dhc&#8209;option&#8209;guidelines]<span> (</span><span class='info'>Hankins, D., &ldquo;Guidelines for Creating New DHCP Options,&rdquo; October&nbsp;2008.</span><span>)</span></a>,
   one of the most deployed DHCP package is the ISC DHCP, mostly written by Ted Lemon in
   cooperation with Nominum, Inc. and now maintained by Internet Systems Consortium, Inc. ("ISC").
   In order to provide developers and system administrators with deployment guidelines,
   we provide example configurations for both the server and the client.
   
</p>
<p>
   Below is a sample configuration for the pki resource query authorities option that can
   be added both the dhclient.conf (on clients) and dhcpd.conf (on servers) for IPv4:
   
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
     option prqp-servers code TBD1 = array of ip-address;
</pre></div>
<p>
   If your environment supports IPv6, you should provide the option as a list of IPv6
   addresses as follows:
   
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
     option prqp-servers code TBD2 = array of ipv6-address;
</pre></div>
<p>
   In addition to this, in order for the server to pass on the configuration to the
   clients, the following example configuration options could be used in the server's
   configuration file (typically /etc/dhcpd.conf):
   
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
     ...
     subnet XXX.XXX.XXX.XXX netmask YYY.YYY.YYY.YYY {
          ...
          option prqp-servers   rqa.openca.org,
                                rqa3.dartmouth.edu,
                                rqa5.mydomain.org;
     }
     ...
</pre></div>
<a name="dhcp_client_processing"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B.1.4"></a><h3>B.1.4.&nbsp;
DHCP Client Processing</h3>

<p>
   In order to provide applications deriving their configuration parameters from values
   provided by this DHCP option, the dhcp client needs to format the on-the-wire
   bits in a more digestible one.
   In particular for the "prqp-servers" option, a configuration file should be
   created as:
   </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
       /etc/pki.conf
</pre></div><p>

   where the list of addresses can be stored. An example
   of such a file is reported below:
   
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
       queryauthority rqa.openca.org
       queryauthority rqa3.dartmouth.edu
       queryauthority 127.0.0.1
</pre></div>
<p>
   where each line has the format:
   
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
       queryauthority &lt;ADDRESS&gt;
</pre></div>
<a name="dns_rqa"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B.2"></a><h3>B.2.&nbsp;
DNS SRV Records</h3>

<p>
   This section describes the needed steps to distribute RQAs addresses
   by using DNS SRV records. In particular we define the format to use
   for the SRV records. As an example we also provide a sample zone file.
   
</p>
<a name="dns_rqa_config"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B.2.1"></a><h3>B.2.1.&nbsp;
SRV Record Format for PRQP</h3>

<p>
   The format for DNS SRV records MUST be compliant with 
   <a class='info' href='#RFC2782'>[RFC2782]<span> (</span><span class='info'>Gulbrandsen, A., Vixie, P., and L. Esibov, &ldquo;A DNS RR for specifying the location of services (DNS SRV),&rdquo; February&nbsp;2000.</span><span>)</span></a>. In particular, in order to support PRQP, a
   DNS server MUST use the following:
   
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   _Service._Proto.Name TTL Class SRV Priority Weight Port Target
</pre></div>
<p>
   Where:
   </p>
<ul class="text">
<li>
    Service is the symbolic name of the desired service. This field
    MUST be set to "rqa"
    
</li>
<li>
    Proto is the symbolic name of the protocol to be used. This field 
    MUST be set to "_tcp"
    
</li>
<li>
    Name is the domain this RR refers to, i.e. the hostname of the RQA
    server
    
</li>
<li>
    TTL has the standard DNS meaning, refer to <a class='info' href='#RFC1035'>[RFC1035]<span> (</span><span class='info'>Mockapetris, P., &ldquo;Domain names - implementation and specification,&rdquo; November&nbsp;1987.</span><span>)</span></a>
    for more information.
    
</li>
<li>
    Class has Standard DNS meaning <a class='info' href='#RFC1035'>[RFC1035]<span> (</span><span class='info'>Mockapetris, P., &ldquo;Domain names - implementation and specification,&rdquo; November&nbsp;1987.</span><span>)</span></a>. This field
    MUST be set to "IN"
    
</li>
<li>
    Priority is the priority of this target host. The allowed range of
    values is 0-65535 (16 bit unsigned integer in network byte order).
    
</li>
<li>
     Weight is used for server selection mechanism. The weight field
     specifies a relative weight for entries with the same priority. The
     allowed range of values is 0-65535 (16 bit unsigned integer in
     network byte order). A more detailed description of the Weight usage
     can be found in <a class='info' href='#RFC2782'>[RFC2782]<span> (</span><span class='info'>Gulbrandsen, A., Vixie, P., and L. Esibov, &ldquo;A DNS RR for specifying the location of services (DNS SRV),&rdquo; February&nbsp;2000.</span><span>)</span></a>.
    
</li>
</ul><p>
    
</p>
<a name="dns_rqa_zone"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B.2.2"></a><h3>B.2.2.&nbsp;
Example: PRQP enabled zone file</h3>

<p>
   In this section we provide a sample zone file for the domain .openca.org.
   In this example we configure service records for three different RQAs.
   
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      $ORIGIN openca.org.
      @               SOA server.openca.org. root.openca.org. (
                          1995032001 3600 3600 604800 86400 )
                   NS  server.openca.org.
                   NS  ns1.ip-provider.net.
                   NS  ns2.ip-provider.net.
      ; first two rqa server lines, they have the same priority,
      ; but different weight
      _rqa._tcp    SRV 0  1 830 rqa.openca.org.
                   SRV 0  3 830 rqa2.openca.org.
      ; last chance - lower priority because it is a very slow box
                   SRV 10 0 830 rqa-slow.openca.org.
      rqa          A   129.170.214.89
      rqa2         A   129.170.212.31
      rqa-slow     A   64.233.167.99
      ; NO other services are supported
      *._tcp       SRV  0 0 0 .
      *._udp       SRV  0 0 0 .
</pre></div>
<a name="ans1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C"></a><h3>Appendix C.&nbsp;
PRQP ASN1.1 Specification</h3>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
PRQP DEFINITIONS EXPLICIT TAGS ::=

BEGIN

-- EXPORTS ALL --

IMPORTS

      -- Directory Authentication Framework (X.509)
            Certificate, AlgorithmIdentifier
            FROM AuthenticationFramework { joint-iso-itu-t ds(5)
                     module(1) authenticationFramework(7) 3 }


      --  PKIX Certificate Extensions
            AuthorityKeyIdentifier, SubjectKeyIdentifier, KeyIdentifier,
          FROM PKIX1Implicit88 {iso(1) identified-organization(3)
                  dod(6) internet(1) security(5) mechanisms(5) pkix(7)
                  id-mod(0) id-pkix1-implicit-88(2)}


             CertificateSerialNumber, Extensions, id-kp, id-ad-prqp
          FROM PKIX1Explicit88 {iso(1) identified-organization(3)
                  dod(6) internet(1) security(5) mechanisms(5) pkix(7)
                  id-mod(0) id-pkix1-explicit-88(1)};


    PRQPRequest ::= SEQUENCE {
        requestData            TBSReqData,
        signature              [0] EXPLICIT Signature OPTIONAL }

    TBSReqData ::= SEQUENCE {
        version                INTEGER { v(1) },
        nonce              [0] INTEGER              OPTIONAL,
              -- very large number
        producedAt             GeneralizedTime,
              -- time when the request has been generated
        serviceToken           ResourceRequestToken,
              -- token identifying the requested service
        extensions         [1] IMPLICIT Extensions  OPTIONAL }

    ResourceRequestToken ::= SEQUENCE {
        ca                      CertIdentifier,
        servicesList        [0] SET OF ResourceIdentifier OPTIONAL }

      BasicCertIdentifier ::= SEQUENCE {
        issuerNameHash              OCTET STRING,
        serialNumber                CertificateSerialNumber  }

      ExtenderCertInfo ::= SEQUENCE {
        certificateHash             OCTET STRING,
        subjectKeyHash              OCTET STRING,
        subjectKeyIdentifier    [0] KeyIdentifier          OPTIONAL,
        issuerKeyIdentifier     [1] KeyIdentifier          OPTIONAL  }

      CertIdentifier ::= SEQUENCE {
        hashAlgorithm               AlgorithmIdentifier,
        basicCertIdentifier         BasicCertIdentifier,
        extInfo                     [0] ExtendedCertInfo    OPTIONAL,
        caCertificate               [1] Certificate         OPTIONAL,
        issuedCertificate           [2] Certificate         OPTIONAL }


      ResourceIdentifier ::= SEQUENCE {
        resourceId             OBJECT IDENTIFIER,
        version            [0] INTEGER             OPTIONAL
          --- version of the protocol or data format (if applicable)
        oid                [1] OBJECT IDENTIFIER   OPTIONAL,
            --- object identifier associated with the URL
            --- (if applicable)                                      }


    PRQPResponse ::= SEQUENCE {
        respData               TBSRespData,
        signature          [0] EXPLICIT Signature OPTIONAL           }


    TBSRespData ::= SEQUENCE {
        version                INTEGER { v(1)},
        nonce                  INTEGER              OPTIONAL,
              -- as duplicated from the request
        producedAt             GeneralizedTime,
              -- time when the response has been generated
        nextUpdate         [0] GeneralizedTime      OPTIONAL,
              -- time till when the response should be considered
              -- valid
        pkiStatus              PKIStatusInfo,
              -- status of the response
        caCertId               CertIdentifier,
              -- identifier of the CA the targeted certificate is
              -- issued from
        responseToken          SEQUENCE OF ResourceResponseToken
                                                             OPTIONAL,
              -- token carrying information about
              -- requested services
        extensions         [0] EXPLICIT Extensions  OPTIONAL }


    PKIStatusInfo ::= SEQUENCE {
        status        PKIStatus,
        statusString  [0] UTF8String     OPTIONAL,
        failInfo      [1] PKIFailureInfo  OPTIONAL,
        referrals     [2] EXPLICIT SEQUENCE OF IA5String
                                          OPTIONAL  }


    PKIStatus ::= INTEGER {
        ok                     (0),
           -- when the PKIStatus contains the value zero one or
              more responseToken is present
        badRequest             (1),
           -- the request is badly formatted
        caNotPresent           (2),
           -- the requested CA is not present
        systemFailure          (3)
           -- a system failure has occourred }


    Signature ::= SEQUENCE {
        signatureAlgorithm     AlgorithmIdentifier,
        signature              BIT STRING,
        certs              [0] EXPLICIT SEQUENCE OF Certificate
                                                          OPTIONAL }

    ResourceResponseToken ::= SEQUENCE {
        resourceId              OBJECT IDENTIFIER,
           --- resource identifier
        resourceLocatorList [0] EXPLICIT SEQUENCE OF IA5String,
            --- sequence of resource locators (URI)
        version             [1] INTEGER             OPTIONAL,
            --- version of the protocol or data format (if applicable)
        oid                 [2] OBJECT IDENTIFIER   OPTIONAL,
            --- object identifier associated with the URL
            --- (if applicable)
        resourceInfo        [3] UTF8Sting           OPTIONAL,
            --- additional service Info (eg. technical contacts) }


-- Object Identifiers

id-kp-PRQPSigning       OBJECT IDENTIFIER ::= { id-kp 11 }
id-prqp                 OBJECT IDENTIFIER ::= { id-pkix 23 }
id-prqp-pta             OBJECT IDENTIFIER ::= { id-prqp 1 }


id-ad-prqp                    OBJECT IDENTIFIER ::= {id-ad 12 }
id-ad-prqp-rqa                OBJECT IDENTIFIER ::= {id-ad-prqp 0}
id-ad-prqp-ocsp               OBJECT IDENTIFIER ::= {id-ad-prqp 1}
id-ad-prqp-subjectCert        OBJECT IDENTIFIER ::= {id-ad-prqp 2}
id-ad-prqp-issuerCert         OBJECT IDENTIFIER ::= {id-ad-prqp 3}
id-ad-prqp-timestamping       OBJECT IDENTIFIER ::= {id-ad-prqp 4}
id-ad-prqp-scvp               OBJECT IDENTIFIER ::= {id-ad-prqp 5}
id-ad-prqp-crlDistribution    OBJECT IDENTIFIER ::= {id-ad-prqp 6}
id-ad-prqp-certRepository     OBJECT IDENTIFIER ::= {id-ad-prqp 7}
id-ad-prqp-crlRepository      OBJECT IDENTIFIER ::= {id-ad-prqp 8}
id-ad-prqp-crossCertRepository OBJECT IDENTIFIER ::= {id-ad-prqp 9}
id-ad-prqp-cmcGateway         OBJECT IDENTIFIER ::= {id-ad-prqp 10}
id-ad-prqp-cmpGateway         OBJECT IDENTIFIER ::= {id-ad-prqp 11}
id-ad-prqp-scepGateway        OBJECT IDENTIFIER ::= {id-ad-prqp 12}
id-ad-prqp-htmlGateway        OBJECT IDENTIFIER ::= {id-ad-prqp 13}
id-ad-prqp-xkmsGateway        OBJECT IDENTIFIER ::= {id-ad-prqp 14}
id-ad-prqp-certPolicy         OBJECT IDENTIFIER ::= {id-ad-prqp 20}
id-ad-prqp-certPracticesStatement OBJECT IDENTIFIER ::= {id-ad-prqp 21}
id-ad-prqp-endorsedTA         OBJECT IDENTIFIER ::= {id-ad-prqp 22}
id-ad-prqp-loaPolicy          OBJECT IDENTIFIER ::= {id-ad-prqp 25}
id-ad-prqp-certLOALevel       OBJECT IDENTIFIER ::= {id-ad-prqp 26}
id-ad-prqp-htmlRequestCertificate OBJECT IDENTIFIER ::= {id-ad-prqp 30}
id-ad-prqp-htmlRevokeCertificate OBJECT IDENTIFIER ::= {id-ad-prqp 31}
id-ad-prqp-htmlRenewCertificate OBJECT IDENTIFIER ::= {id-ad-prqp 32}
id-ad-prqp-htmlSuspendCertificate OBJECT IDENTIFIER ::= {id-ad-prqp 33}
id-ad-prqp-htmlRecoveryCertificate OBJECT IDENTIFIER ::= {id-ad-prqp 34}
id-ad-prqp-gridAccreditationBody OBJECT IDENTIFIER ::= {id-ad-prqp 50}
id-ad-prqp-gridAccreditationPolicy OBJECT IDENTIFIER ::= {id-ad-prqp 51}
id-ad-prqp-gridAccreditationStatus OBJECT IDENTIFIER ::= {id-ad-prqp 52}
id-ad-prqp-gridDistributionUpdate OBJECT IDENTIFIER ::= {id-ad-prqp 53}
id-ad-prqp-gridAccreditedCACerts OBJECT IDENTIFIER ::= {id-ad-prqp 54}
id-ad-prqp-apexTampUpdate     OBJECT IDENTIFIER ::= {id-ad-prqp 70}
id-ad-prqp-tampUpdate         OBJECT IDENTIFIER ::= {id-ad-prqp 71}
id-ad-prqp-caIncidentReport   OBJECT IDENTIFIER ::= {id-ad-prqp 90}
id-ad-prqp-private            OBJECT IDENTIFIER ::= {id-ad-prqp 100}

</pre></div>
<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Author's Address</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Massimiliano Pala</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Dartmouth College</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">6211 Sudikoff PKI/Trust Lab</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Hanover, NH  03755</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:pala@cs.dartmouth.edu">pala@cs.dartmouth.edu</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.openca.org">http://www.openca.org</a></td></tr>
</table>
</body></html>
