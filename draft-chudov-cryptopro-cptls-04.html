<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>GOST 28147-89 Cipher Suites for
    Transport Layer Security (TLS)</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="GOST 28147-89 Cipher Suites for
    Transport Layer Security (TLS)">
<meta name="keywords" content="GOST 28147-89, GOST R 34.10-94, GOST R 34.11-94, GOST R 34.10-2001, GOST 34.310-95, GOST 34.311-95, GOST 34.310-2004">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">-</td><td class="header">G. Chudov, Ed.</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">S. Leontiev, Ed.</td></tr>
<tr><td class="header">Intended status: Informational</td><td class="header">CRYPTO-PRO</td></tr>
<tr><td class="header">Expires: June 11, 2009</td><td class="header">December 08, 2008</td></tr>
</table></td></tr></table>
<h1><br />GOST 28147-89 Cipher Suites for
    Transport Layer Security (TLS)<br />draft-chudov-cryptopro-cptls-04</h1>

<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on June 11, 2009.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2008 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents in effect on the date of
publication of this document (http://trustee.ietf.org/license-info).
Please review these documents carefully, as they describe your
rights and restrictions with respect to this document.</p>

<h3>Abstract</h3>

<p>This document is intended to register new cipher suites for the
      Transport Layer Security (TLS) protocol, according to the procedure
      specified in TLS Protocol standards. These cipher suites are based on
      Russian national cryptographic standards - GOST R 34.10-94 and
      GOST R 34.10-2001 public keys, GOST 28147-89 encryption algorithm and
      GOST R 34.11-94 digest algorithm.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#anchor2">2.</a>&nbsp;
CipherSuite Definitions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">2.1.</a>&nbsp;
Key Exchange<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">2.2.</a>&nbsp;
PRF, Signature and Hash<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">2.3.</a>&nbsp;
Cipher and MAC<br />
<a href="#anchor6">3.</a>&nbsp;
Data Structures and Computations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#algs">3.1.</a>&nbsp;
Algorithms<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">3.2.</a>&nbsp;
Keys Calculation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">3.3.</a>&nbsp;
Server Certificate<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">3.4.</a>&nbsp;
Server Key Exchange<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">3.5.</a>&nbsp;
Certificate Request<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">3.6.</a>&nbsp;
Client Key Exchange Message<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">3.7.</a>&nbsp;
Certificate Verify<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">3.8.</a>&nbsp;
Finished<br />
<a href="#anchor14">4.</a>&nbsp;
Compatibility<br />
<a href="#anchor15">5.</a>&nbsp;
Security Considerations<br />
<a href="#anchor16">6.</a>&nbsp;
IANA Considerations<br />
<a href="#rfc.references1">7.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">7.1.</a>&nbsp;
Normative references<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">7.2.</a>&nbsp;
Informative references<br />
<a href="#anchor19">Appendix&nbsp;A.</a>&nbsp;
ASN.1 Modules<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor20">A.1.</a>&nbsp;
Gost-CryptoPro-TLS<br />
<a href="#anchor21">Appendix&nbsp;B.</a>&nbsp;
Acknowledgments<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>This document proposes the addition of new cipher suites to the
      Transport Layer Security (TLS) protocol to support GOST R 34.11-94
      digest, GOST 28147-89 encryption and VKO GOST R 34.10-94/2001 key
      exchange algorithms. The cipher suites defined here were proposed by
      CRYPTO-PRO Company for the "Russian Cryptographic Software Compatibility
      Agreement" community.
</p>
<p>Algorithms GOST R 34.10-94, GOST R 34.10-2001, GOST 28147-89 and
      GOST R 34.11-94 have been developed by Russian Federal Agency of
      Governmental Communication and Information (FAGCI) and "All-Russian
      Scientific and Research Institute of Standardization". They are
      described in <a class='info' href='#GOSTR341094'>[GOSTR341094]<span> (</span><span class='info'>Government Committee of the Russia for             Standards, &ldquo;Information technology. Cryptographic Data Security. Produce           and check procedures of Electronic Digital Signatures based on           Asymmetric Cryptographic Algorithm, Gosudarstvennyi Standard of           Russian Federation (In Russian),&rdquo; 1994.</span><span>)</span></a>, <a class='info' href='#GOSTR341001'>[GOSTR341001]<span> (</span><span class='info'>Government Committee of the Russia for             Standards, &ldquo;Information technology. Cryptographic Data Security.Signature           and verification processes of [electronic] digital signature,           Gosudarstvennyi Standard of Russian Federation (In Russian),&rdquo; 2001.</span><span>)</span></a>, <a class='info' href='#GOSTR341194'>[GOSTR341194]<span> (</span><span class='info'>Government Committee of the Russia for             Standards, &ldquo;Information technology. Cryptographic Data Security. Hashing           function, Gosudarstvennyi Standard of Russian Federation (In           Russian),&rdquo; 1994.</span><span>)</span></a> and <a class='info' href='#GOST28147'>[GOST28147]<span> (</span><span class='info'>Government Committee of the USSR for             Standards, &ldquo;Cryptographic Protection for Data Processing System,           Gosudarstvennyi Standard of USSR (In Russian),&rdquo; 1989.</span><span>)</span></a> (<a class='info' href='#GOST3431095'>[GOST3431095]<span> (</span><span class='info'>Council for Standardization, Metrology and             Certification of the Commonwealth of Independence States (EASC),             Minsk, &ldquo;Information technology. Cryptographic Data Security. Produce           and check procedures of Electronic Digital Signature based on           Asymmetric Cryptographic Algorithm (In Russian),&rdquo; 1995.</span><span>)</span></a>, <a class='info' href='#GOST3431004'>[GOST3431004]<span> (</span><span class='info'>Council for Standardization, Metrology and             Certification of the Commonwealth of Independence States (EASC),             Minsk, &ldquo;Information technology. Cryptographic Data Security.           Formation and verification processes of (electronic) digital           signature based on Asymmetric Cryptographic Algorithm (In           Russian),&rdquo; 2004.</span><span>)</span></a>, <a class='info' href='#GOST3431195'>[GOST3431195]<span> (</span><span class='info'>Council for Standardization, Metrology and             Certification of the Commonwealth of Independence States (EASC),             Minsk, &ldquo;Information technology. Cryptographic Data Security. Cashing           function (In Russian),&rdquo; 1995.</span><span>)</span></a>). Algorithms VKO GOST R 34.10-94/2001 and
      PRF_GOSTR3411 are described in <a class='info' href='#CPALGS'>[CPALGS]<span> (</span><span class='info'>Popov, V., Kurepkin, I., and S. Leontiev, &ldquo;Additional Cryptographic Algorithms for Use with GOST           28147-89, GOST R 34.10-94, GOST R 34.10-2001, and GOST R 34.11-94           Algorithms,&rdquo; January&nbsp;2006.</span><span>)</span></a>.
</p>
<p>This document defines two configurations: </p>
<blockquote class="text">
<p>anonymous client - authenticated server (only server provides a
          certificate);
</p>
<p>authenticated client - authenticated server (client and server
          exchange certificates).
</p>
</blockquote>

<p>The presentation language used here is the same as in <a class='info' href='#TLS1.2'>[TLS1.2]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The TLS Protocol,&rdquo; June&nbsp;2006.</span><span>)</span></a>. Since this
      specification extends <a class='info' href='#TLS1.2'>[TLS1.2]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The TLS Protocol,&rdquo; June&nbsp;2006.</span><span>)</span></a>, these descriptions should be merged with those
      in the TLS specification and any others that extend TLS. This means,
      that enum types may not specify all possible values and structures with
      multiple formats chosen with a select() clause may not indicate all
      possible cases.
</p>
<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
      NOT","SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in
      this document are to be interpreted as described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate           Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
CipherSuite Definitions</h3>

<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
Key Exchange</h3>

<p>The cipher suites defined here use the following key exchange
        algorithms:
</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left">
<tr><th align="left">CipherSuite</th><th align="left">Key Exchange Algorithm</th></tr>
<tr>
<td align="left">TLS_GOSTR341094_WITH_28147_CNT_IMIT</td>
<td align="left">VKO GOST R 34.10-94</td>
</tr>
<tr>
<td align="left">TLS_GOSTR341001_WITH_28147_CNT_IMIT</td>
<td align="left">VKO GOST R 34.10-2001</td>
</tr>
<tr>
<td align="left">TLS_GOSTR341094_WITH_NULL_GOSTR3411</td>
<td align="left">VKO GOST R 34.10-94</td>
</tr>
<tr>
<td align="left">TLS_GOSTR341001_WITH_NULL_GOSTR3411</td>
<td align="left">VKO GOST R 34.10-2001</td>
</tr>
</table>
<br clear="all" />

<p>Key derivation algorithms based on GOST R 34.10-94 and
        GOST R 34.10-2001 public keys (VKO GOST R 34.10-94, VKO
        GOST R 34.10-2001) are described in <a class='info' href='#CPALGS'>[CPALGS]<span> (</span><span class='info'>Popov, V., Kurepkin, I., and S. Leontiev, &ldquo;Additional Cryptographic Algorithms for Use with GOST           28147-89, GOST R 34.10-94, GOST R 34.10-2001, and GOST R 34.11-94           Algorithms,&rdquo; January&nbsp;2006.</span><span>)</span></a>.
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
PRF, Signature and Hash</h3>

<p>The cipher suites described here use HMAC and TLS PRF, as described
        in section 5 of <a class='info' href='#TLS1.2'>[TLS1.2]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The TLS Protocol,&rdquo; June&nbsp;2006.</span><span>)</span></a>, based on GOST R 34.11-94 hash function
        (HMAC_GOSTR3411 and PRF_GOSTR3411), with parameter set identified by
        id-GostR3411-94-CryptoProParamSet (refer to <a class='info' href='#CPALGS'>[CPALGS]<span> (</span><span class='info'>Popov, V., Kurepkin, I., and S. Leontiev, &ldquo;Additional Cryptographic Algorithms for Use with GOST           28147-89, GOST R 34.10-94, GOST R 34.10-2001, and GOST R 34.11-94           Algorithms,&rdquo; January&nbsp;2006.</span><span>)</span></a>). The same PRF MUST be used for
        all dependent protocols, such as <a class='info' href='#EAP-TLS'>[EAP&#8209;TLS]<span> (</span><span class='info'>Aboba, B. and D. Simon, &ldquo;PPP EAP TLS Authentication Protocol,&rdquo; October&nbsp;1999.</span><span>)</span></a>.
</p>
<p>GOST R 34.10-94/2001 signature is used for CertificateVerify
        message.
</p>
<p>GOST R 34.11 digest algorithm (<a class='info' href='#GOSTR341194'>[GOSTR341194]<span> (</span><span class='info'>Government Committee of the Russia for             Standards, &ldquo;Information technology. Cryptographic Data Security. Hashing           function, Gosudarstvennyi Standard of Russian Federation (In           Russian),&rdquo; 1994.</span><span>)</span></a>) is used for
        CertificateVerify.signature.gostR3411_hash and Finished.verify_data
        (see sections 7.4.10 and 7.4.11 of <a class='info' href='#TLS1.2'>[TLS1.2]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The TLS Protocol,&rdquo; June&nbsp;2006.</span><span>)</span></a>)
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3"></a><h3>2.3.&nbsp;
Cipher and MAC</h3>

<p>The following cipher algorithm and MAC functions are used (for
        details refer to <a class='info' href='#algs'>Section&nbsp;3.1<span> (</span><span class='info'>Algorithms</span><span>)</span></a>):
</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left"><col align="left">
<tr><th align="left">CipherSuite</th><th align="left">Cipher</th><th align="left">MAC</th></tr>
<tr>
<td align="left">TLS_GOSTR341094_WITH_28147_CNT_IMIT</td>
<td align="left">GOST28147</td>
<td align="left">IMIT_GOST28147</td>
</tr>
<tr>
<td align="left">TLS_GOSTR341001_WITH_28147_CNT_IMIT</td>
<td align="left">GOST28147</td>
<td align="left">IMIT_GOST28147</td>
</tr>
<tr>
<td align="left">TLS_GOSTR341094_WITH_NULL_GOSTR3411</td>
<td align="left">-</td>
<td align="left">HMAC_GOSTR3411</td>
</tr>
<tr>
<td align="left">TLS_GOSTR341001_WITH_NULL_GOSTR3411</td>
<td align="left">-</td>
<td align="left">HMAC_GOSTR3411</td>
</tr>
</table>
<br clear="all" />

<p>For all four cipher suites, the use of MAC is slighttly different
        from the one, described in section 6.2.3.1 of <a class='info' href='#TLS1.2'>[TLS1.2]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The TLS Protocol,&rdquo; June&nbsp;2006.</span><span>)</span></a> for standard stream ciphers,
        where MAC is calculated from the following data:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  MACed_data[seq_num] = seq_num +
                        TLSCompressed.type +
                        TLSCompressed.version +
                        TLSCompressed.length +
                        TLSCompressed.fragment;
</pre></div>
<p>Cipher suites defined in this document use the same input for first
        record, but for each consequent record the input from all previous
        records is concatenated:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  MACed_data[0] + ... + MACed_data[n]
</pre></div>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Data Structures and Computations</h3>

<a name="algs"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Algorithms</h3>

<p>GOST 28147-89 <a class='info' href='#GOST28147'>[GOST28147]<span> (</span><span class='info'>Government Committee of the USSR for             Standards, &ldquo;Cryptographic Protection for Data Processing System,           Gosudarstvennyi Standard of USSR (In Russian),&rdquo; 1989.</span><span>)</span></a> uses 256-bit key size and 8-byte IV. Cipher
        suites, defined here, use GOST 28147-89 as a stream cipher in counter
        mode with S-box parameter from id-Gost28147-89-CryptoPro-A-ParamSet
        (see <a class='info' href='#CPALGS'>[CPALGS]<span> (</span><span class='info'>Popov, V., Kurepkin, I., and S. Leontiev, &ldquo;Additional Cryptographic Algorithms for Use with GOST           28147-89, GOST R 34.10-94, GOST R 34.10-2001, and GOST R 34.11-94           Algorithms,&rdquo; January&nbsp;2006.</span><span>)</span></a>)
        and CryptoPro key meshing algorithm.
</p>
<p>IMIT_GOST28147 is GOST 28147-89 <a class='info' href='#GOST28147'>[GOST28147]<span> (</span><span class='info'>Government Committee of the USSR for             Standards, &ldquo;Cryptographic Protection for Data Processing System,           Gosudarstvennyi Standard of USSR (In Russian),&rdquo; 1989.</span><span>)</span></a> in "IMITOVSTAVKA" mode (4
        bytes)
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Keys Calculation</h3>

<p>Key calculation is done according to section 6.3 of <a class='info' href='#TLS1.2'>[TLS1.2]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The TLS Protocol,&rdquo; June&nbsp;2006.</span><span>)</span></a>, using
        PRF_GOSTR3411. The parameters are as follows:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
SecurityParameters.enc_key_length = 32
SecurityParameters.mac_key_length = 32
SecurityParameters.fixed_iv_length = 8
</pre></div>
<p>Length of necessary key material is 144 bytes.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
Server Certificate</h3>

<p>For these cipher suites this message is required and it MUST
        contain a certificate, with a public key algorithm matching
        ServerHello.cipher_suite.
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4"></a><h3>3.4.&nbsp;
Server Key Exchange</h3>

<p>This message MUST NOT be used in these cipher suites, because all
        the parameters necessary are present in server certificate (see <a class='info' href='#CPPK'>[CPPK]<span> (</span><span class='info'>Leontiev, S. and D. Shefanovski, &ldquo;Using the GOST R 34.10-94, GOST R 34.10-2001, and GOST R           34.11-94 Algorithms with the Internet X.509 Public Key           Infrastructure Certificate and CRL Profile,&rdquo; May&nbsp;2006.</span><span>)</span></a>).
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.5"></a><h3>3.5.&nbsp;
Certificate Request</h3>

<p>This message is used as described in section 7.4.4 of <a class='info' href='#TLS1.2'>[TLS1.2]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The TLS Protocol,&rdquo; June&nbsp;2006.</span><span>)</span></a>, and extended
        as follows:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
 enum {
     gostr341094(21), gostr34102001(22),(255)
 } ClientCertificateType;
</pre></div>
<p>gostr341094 and gostr34102001 certificate types identify that the
        server accepts GOST R 34.10-94 and GOST R 34.10-2001 public key
        certificates.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
 enum{
   gostr3411(XX)
 } HashAlgorithm;

 enum{
   gostr341094(XX), gostr34102001(XX)
 } SignatureAlgorithm;
</pre></div>
<p>gostr3411 hash type identifes that the server accepts
        GOST R 34.11-94 hash function. It is RECOMMENDED to populate
        CertificateRequest.certificate_hash only with gostr3411 value, when
        one of the cipher suites described in this document is chosen.
</p>
<p>The server SHOULD populate supported_signature_algorithm field with
        SignatureAndHashAlgorithm pairs, where HashAlgorithm equals gostr3411 and
        SignatureAlgorithm matches corresponding ClientCertificateType.
        
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.6"></a><h3>3.6.&nbsp;
Client Key Exchange Message</h3>

<p>This message is used as described in section 7.4.7 of <a class='info' href='#TLS1.2'>[TLS1.2]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The TLS Protocol,&rdquo; June&nbsp;2006.</span><span>)</span></a>, it is
        required for these suites, and contains DER-encoded
        TLSGostKeyTransportBlob structure <a class='info' href='#X.660'>[X.660]<span> (</span><span class='info'>ISO/IEC, &ldquo;ITU-T Recommendation X.660 Information Technology - ASN.1           encoding rules: Specification of Basic Encoding Rules (BER),           Canonical Encoding Rules (CER) and Distinguished Encoding Rules           (DER),&rdquo; 1997.</span><span>)</span></a>.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
 enum { vko_gost } KeyExchangeAlgorithm;

 struct {
     select (KeyExchangeAlgorithm) {
         case vko_gost: TLSGostKeyTransportBlob;
     } exchange_keys;
 } ClientKeyExchange;
</pre></div>
<p>ASN1-syntax for this structure is:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
 TLSGostKeyTransportBlob ::= SEQUENCE {
     keyBlob GostR3410-KeyTransport,
     proxyKeyBlobs SEQUENCE OF TLSProxyKeyTransportBlob OPTIONAL
 }

 TLSProxyKeyTransportBlob ::= SEQUENCE {
     keyBlob GostR3410-KeyTransport,
     cert    OCTET STRING
 }
</pre></div>
<p>GostR3410-KeyTransport is defined in <a class='info' href='#CPCMS'>[CPCMS]<span> (</span><span class='info'>Leontiev, S. and G. Chudov, &ldquo;Using the GOST 28147-89, GOST R 34.11-94, GOST R 34.10-94,           and GOST R 34.10-2001 Algorithms with Cryptographic Message Syntax           (CMS),&rdquo; May&nbsp;2006.</span><span>)</span></a>.
</p>
<p>keyBlob.transportParameters MUST be present.
</p>
<p>keyBlob.transportParameters.ephemeralPublicKey MUST be present if
        the server didn't request client certificate or client's public key
        algorithm and parameters do not match those of the recipient. Else it
        SHOULD be omited.
</p>
<p>proxyKeyBlobs - (optional) contains key exchange for secondary
        recipients (for example, for the firewall, which audits
        connections).
</p>
<p>cert - contains secondary recipient's certificate.
</p>
<p>Actions of client:
</p>
<p>First, the client generates a random 32-byte premaster_secret.
</p>
<p>Then shared_ukm is calculated as first 8 bytes of digest of
        concatenated client random and server random:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
shared_ukm = GOSTR3411(client_random|server_random)[0..7]
</pre></div>
<p>Then client chooses a sender key. If
        keyBlob.transportParameters.ephemeralPublicKey is present, the
        corresponding secret key MUST be used as a sender key. If it is
        missing, the secret key, corresponding to the client certificate MUST
        be used.
</p>
<p>Using the sender key and recipient's public key, algorithm VKO
        GOST R 34.10-94 or VKO GOST R 34.10-2001 (described in <a class='info' href='#CPALGS'>[CPALGS]<span> (</span><span class='info'>Popov, V., Kurepkin, I., and S. Leontiev, &ldquo;Additional Cryptographic Algorithms for Use with GOST           28147-89, GOST R 34.10-94, GOST R 34.10-2001, and GOST R 34.11-94           Algorithms,&rdquo; January&nbsp;2006.</span><span>)</span></a>) is applied to
        produce KEK. VKO GOST R 34.10-2001 is used with shared_ukm as UKM.
</p>
<p>Then CryptoPro Key Wrap algorithm is applied to encrypt
        premaster_secret and produce CEK_ENC and CEK_MAC. Again, shared_ukm is
        used as UKM. keyBlob.transportParameters.encryptionParamSet is used
        for all encryption operations.
</p>
<p>The resulting encrypted key (CEK_ENC) is placed in
        keyBlob.sessionEncryptedKey.encryptedKey field, it's mac (CEK_MAC) is
        placed in keyBlob.sessionEncryptedKey.macKey field, and shared_ukm
        (UKM) is placed in keyBlob.transportParameters.ukm field.
</p>
<p>Actions of server:
</p>
<p>Server MUST verify, that keyBlob.transportParameters.ukm is equal
        to GOSTR3411(client_random|server_random)[0..7], before decrypting the
        premaster_secret.
</p>
<p>Server applies VKO GOST R 34.10-94 or VKO GOST R 34.10-2001,
        (depending on the client public key type), and CryptoPro Key Unwrap
        algorithm in the simillar manner to decrypt the premaster_secret.
</p>
<p>Server MUST verify keyBlob.sessionEncryptedKey.macKey after
        decrypting the premaster_secret.
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.7"></a><h3>3.7.&nbsp;
Certificate Verify</h3>

<p>This message is used as described in section 7.4.8 of <a class='info' href='#TLS1.2'>[TLS1.2]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The TLS Protocol,&rdquo; June&nbsp;2006.</span><span>)</span></a>. If the client
        have sent both a client certificate and an ephemeral public key, it
        MUST send a certificate verify message, as a proof of possession of
        the private key for provided certificate.
</p>
<p>The TLS structures are extended as follows:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
 enum { gostr341094, gostr34102001 }
     SignatureAlgorithm;

 select (SignatureAlgorithm) {
     case gostr341094:
         digitally-signed struct {
             opaque gostr341194_hash[32];
         };
     case gostr34102001:
         digitally-signed struct {
             opaque gostr341194_hash[32];
         };
 } Signature;

 CertificateVerify.signature.gostR3411_hash =
     GOSTR3411(handshake_messages)
</pre></div>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.8"></a><h3>3.8.&nbsp;
Finished</h3>

<p>This message is used as described in section 7.4.9 of <a class='info' href='#TLS1.2'>[TLS1.2]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The TLS Protocol,&rdquo; June&nbsp;2006.</span><span>)</span></a>.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
Finished.verify_data = PRF_GOSTR3411(master_secret, finished_label,
                           GOSTR3411(handshake_messages)) [0..11]
</pre></div>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Compatibility</h3>

<p>For historical reasons, some applications use the cipher suites specified
      herein with <a class='info' href='#TLS1.0'>[TLS1.0]<span> (</span><span class='info'>Dierks, T. and C. Allen, &ldquo;The TLS Protocol Version 1.0,&rdquo; January&nbsp;1999.</span><span>)</span></a>,
      using some features of <a class='info' href='#TLS1.2'>[TLS1.2]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The TLS Protocol,&rdquo; June&nbsp;2006.</span><span>)</span></a>,
      including cipher-suite dependent PRF, Finished and Certificate Verify
      computations.
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Security Considerations</h3>

<p>It is RECOMMENDED that software applications verify signature values,
      subject public keys and algorithm parameters to conform to <a class='info' href='#GOSTR341001'>[GOSTR341001]<span> (</span><span class='info'>Government Committee of the Russia for             Standards, &ldquo;Information technology. Cryptographic Data Security.Signature           and verification processes of [electronic] digital signature,           Gosudarstvennyi Standard of Russian Federation (In Russian),&rdquo; 2001.</span><span>)</span></a>, <a class='info' href='#GOSTR341094'>[GOSTR341094]<span> (</span><span class='info'>Government Committee of the Russia for             Standards, &ldquo;Information technology. Cryptographic Data Security. Produce           and check procedures of Electronic Digital Signatures based on           Asymmetric Cryptographic Algorithm, Gosudarstvennyi Standard of           Russian Federation (In Russian),&rdquo; 1994.</span><span>)</span></a> standards
      prior to their use.
</p>
<p>Use of the same key for signature and key derivation is NOT
      RECOMMENDED.
</p>
<p>It is RECOMMENDED for both client and server to verify the private
      key usage period, if this extension is present in the certificate.
</p>
<p>The cipher suites TLS_GOSTR341094_WITH_28147_CNT_IMIT and
      TLS_GOSTR341001_WITH_28147_CNT_IMIT proposed hereby, have been analyzed
      by special certification laboratory of Scientific and Technical Centre
      "ATLAS" in appropriate levels of target_of_evaluation (TOE).
</p>
<p>It is RECOMMENDED to subject the implementations of these cipher
      suites to examination by an authorized agency with approved methods of
      cryptographic analysis.
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
IANA Considerations</h3>

<p>This document defines the following new cipher suites, whose values
     presented here are used by several implementations of the same cipher
     suites for TLS 1.0, and were described in previous drafts.
     They are currently listed in the registry as reserved.
     IANA is requested to update the TLS Cipher Suite registry defined in
     [RFC5246] with these values.
      
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
CipherSuite TLS_GOSTR341094_WITH_28147_CNT_IMIT = {0x00,0x80}
CipherSuite TLS_GOSTR341001_WITH_28147_CNT_IMIT = {0x00,0x81}
CipherSuite TLS_GOSTR341094_WITH_NULL_GOSTR3411 = {0x00,0x82}
CipherSuite TLS_GOSTR341001_WITH_NULL_GOSTR3411 = {0x00,0x83}
</pre></div>
<p>This document defines the following new client certificate types,
     whose values presented here are used by several implementations of the
     same suites for TLS 1.0, and were described in previous drafts.
     They are currently listed in the registry as reserved.
     IANA is requested to update the TLS ClientCertificateType Identifiers Registry
     defined in [RFC5246] with these values.
      
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
 enum {
     gostr341094(21), gostr34102001(22)
 } ClientCertificateType;
</pre></div>
<p>This document defines the following new signature algorithm types, whose
       values are to be assigned from the TLS SignatureAlgorithm Registry defined
       in [RFC5246].
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
 enum{
   gostr341094(XX), gostr34102001(XX)
 } SignatureAlgorithm;
</pre></div>
<p>This document defines the following new hash algorithm types, whose
       values are to be assigned from the TLS HashAlgorithm Registry defined
       in [RFC5246].
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
 enum {
   gostr3411(XX)
 } HashAlgorithm;
</pre></div>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>7.1.&nbsp;Normative references</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="CPALGS">[CPALGS]</a></td>
<td class="author-text">Popov, V., Kurepkin, I., and S. Leontiev, &ldquo;<a href="http://tools.ietf.org/html/rfc4357">Additional Cryptographic Algorithms for Use with GOST
          28147-89, GOST R 34.10-94, GOST R 34.10-2001, and GOST R 34.11-94
          Algorithms</a>,&rdquo; RFC&nbsp;4357, January&nbsp;2006 (<a href="ftp://ftp.isi.edu/in-notes/rfc4357.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="CPCMS">[CPCMS]</a></td>
<td class="author-text">Leontiev, S. and G. Chudov, &ldquo;<a href="http://tools.ietf.org/html/rfc4490">Using the GOST 28147-89, GOST R 34.11-94, GOST R 34.10-94,
          and GOST R 34.10-2001 Algorithms with Cryptographic Message Syntax
          (CMS)</a>,&rdquo; RFC&nbsp;4490, May&nbsp;2006 (<a href="ftp://ftp.isi.edu/in-notes/rfc4490.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="CPPK">[CPPK]</a></td>
<td class="author-text">Leontiev, S. and D. Shefanovski, &ldquo;<a href="http://tools.ietf.org/html/rfc4491">Using the GOST R 34.10-94, GOST R 34.10-2001, and GOST R
          34.11-94 Algorithms with the Internet X.509 Public Key
          Infrastructure Certificate and CRL Profile</a>,&rdquo; RFC&nbsp;4491, May&nbsp;2006 (<a href="ftp://ftp.isi.edu/in-notes/rfc4491.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="GOST28147">[GOST28147]</a></td>
<td class="author-text">Government Committee of the USSR for
            Standards, &ldquo;Cryptographic Protection for Data Processing System,
          Gosudarstvennyi Standard of USSR (In Russian),&rdquo; GOST&nbsp;28147-89, 1989.</td></tr>
<tr><td class="author-text" valign="top"><a name="GOST3431004">[GOST3431004]</a></td>
<td class="author-text">Council for Standardization, Metrology and
            Certification of the Commonwealth of Independence States (EASC),
            Minsk, &ldquo;Information technology. Cryptographic Data Security.
          Formation and verification processes of (electronic) digital
          signature based on Asymmetric Cryptographic Algorithm (In
          Russian),&rdquo; GOST&nbsp;34.310-2004, 2004.</td></tr>
<tr><td class="author-text" valign="top"><a name="GOST3431095">[GOST3431095]</a></td>
<td class="author-text">Council for Standardization, Metrology and
            Certification of the Commonwealth of Independence States (EASC),
            Minsk, &ldquo;Information technology. Cryptographic Data Security. Produce
          and check procedures of Electronic Digital Signature based on
          Asymmetric Cryptographic Algorithm (In Russian),&rdquo; GOST&nbsp;34.310-95, 1995.</td></tr>
<tr><td class="author-text" valign="top"><a name="GOST3431195">[GOST3431195]</a></td>
<td class="author-text">Council for Standardization, Metrology and
            Certification of the Commonwealth of Independence States (EASC),
            Minsk, &ldquo;Information technology. Cryptographic Data Security. Cashing
          function (In Russian),&rdquo; GOST&nbsp;34.311-95, 1995.</td></tr>
<tr><td class="author-text" valign="top"><a name="GOSTR341001">[GOSTR341001]</a></td>
<td class="author-text">Government Committee of the Russia for
            Standards, &ldquo;Information technology. Cryptographic Data Security.Signature
          and verification processes of [electronic] digital signature,
          Gosudarstvennyi Standard of Russian Federation (In Russian),&rdquo; GOST R&nbsp;34.10-2001, 2001.</td></tr>
<tr><td class="author-text" valign="top"><a name="GOSTR341094">[GOSTR341094]</a></td>
<td class="author-text">Government Committee of the Russia for
            Standards, &ldquo;Information technology. Cryptographic Data Security. Produce
          and check procedures of Electronic Digital Signatures based on
          Asymmetric Cryptographic Algorithm, Gosudarstvennyi Standard of
          Russian Federation (In Russian),&rdquo; GOST R&nbsp;34.10-94, 1994.</td></tr>
<tr><td class="author-text" valign="top"><a name="GOSTR341194">[GOSTR341194]</a></td>
<td class="author-text">Government Committee of the Russia for
            Standards, &ldquo;Information technology. Cryptographic Data Security. Hashing
          function, Gosudarstvennyi Standard of Russian Federation (In
          Russian),&rdquo; GOST R&nbsp;34.11-94, 1994.</td></tr>
<tr><td class="author-text" valign="top"><a name="TLS1.2">[TLS1.2]</a></td>
<td class="author-text">Dierks, T. and E. Rescorla, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-tls-rfc4346-bis-01.txt">The TLS Protocol</a>,&rdquo; draft-ietf-tls-rfc4346-bis-01 (work in progress), June&nbsp;2006 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-tls-rfc4346-bis-01.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>7.2.&nbsp;Informative references</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="EAP-TLS">[EAP-TLS]</a></td>
<td class="author-text"><a href="mailto:bernarda@microsoft.com">Aboba, B.</a> and <a href="mailto:dansimon@microsoft.com">D. Simon</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2716">PPP EAP TLS Authentication Protocol</a>,&rdquo; RFC&nbsp;2716, October&nbsp;1999 (<a href="ftp://ftp.isi.edu/in-notes/rfc2716.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate
          Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="ftp://ftp.isi.edu/in-notes/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="TLS1.0">[TLS1.0]</a></td>
<td class="author-text"><a href="mailto:tdierks@certicom.com">Dierks, T.</a> and <a href="mailto:callen@certicom.com">C. Allen</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2246">The TLS Protocol Version 1.0</a>,&rdquo; RFC&nbsp;2246, January&nbsp;1999 (<a href="ftp://ftp.isi.edu/in-notes/rfc2246.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="X.660">[X.660]</a></td>
<td class="author-text">ISO/IEC, &ldquo;ITU-T Recommendation X.660 Information Technology - ASN.1
          encoding rules: Specification of Basic Encoding Rules (BER),
          Canonical Encoding Rules (CER) and Distinguished Encoding Rules
          (DER),&rdquo; ITU-T&nbsp;X.660, 1997.</td></tr>
</table>

<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
ASN.1 Modules</h3>

<p>Additional ASN.1 modules, referenced here, can be found in <a class='info' href='#CPALGS'>[CPALGS]<span> (</span><span class='info'>Popov, V., Kurepkin, I., and S. Leontiev, &ldquo;Additional Cryptographic Algorithms for Use with GOST           28147-89, GOST R 34.10-94, GOST R 34.10-2001, and GOST R 34.11-94           Algorithms,&rdquo; January&nbsp;2006.</span><span>)</span></a> and <a class='info' href='#CPCMS'>[CPCMS]<span> (</span><span class='info'>Leontiev, S. and G. Chudov, &ldquo;Using the GOST 28147-89, GOST R 34.11-94, GOST R 34.10-94,           and GOST R 34.10-2001 Algorithms with Cryptographic Message Syntax           (CMS),&rdquo; May&nbsp;2006.</span><span>)</span></a>.
</p>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1"></a><h3>A.1.&nbsp;
Gost-CryptoPro-TLS</h3>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
Gost-CryptoPro-TLS
    { iso(1) member-body(2) ru(643) rans(2)
      cryptopro(2) other(1) modules(1) gost-CryptoPro-TLS(16) 1 }
DEFINITIONS ::=
BEGIN
-- EXPORTS All --
-- The types and values defined in this module are exported for
-- use in the other ASN.1 modules contained within the Russian
-- Cryptography "GOST" &amp; "GOST R" Specifications, and for the use
-- of other applications which will use them to access Russian
-- Cryptography services. Other applications may use them for
-- their own purposes, but this will not constrain extensions and
-- modifications needed to maintain or improve the Russian
-- Cryptography service.
    IMPORTS
        Certificate,
        AlgorithmIdentifier
        FROM PKIX1Explicit88 {iso(1) identified-organization(3)
        dod(6) internet(1) security(5) mechanisms(5) pkix(7)
        id-mod(0) id-pkix1-explicit-88(1)}
        id-CryptoPro-algorithms, gostR3410-EncryptionSyntax
        FROM Cryptographic-Gost-Useful-Definitions
            { iso(1) member-body(2) ru(643) rans(2)
              cryptopro(2) other(1) modules(1)
              cryptographic-Gost-Useful-Definitions(0) 1 }
        GostR3410-KeyTransport
        FROM GostR3410-EncryptionSyntax
             gostR3410-EncryptionSyntax
    ;
    id-PRF-GostR3411-94 OBJECT IDENTIFIER ::=
        { id-CryptoPro-algorithms prf-gostr3411-94(23) }
    TLSProxyKeyTransportBlob ::=
        SEQUENCE {
            keyBlob GostR3410-KeyTransport,
            cert    OCTET STRING
        }
    TLSGostKeyTransportBlob ::=
        SEQUENCE {
            keyBlob GostR3410-KeyTransport,
            proxyKeyBlobs SEQUENCE OF
                TLSProxyKeyTransportBlob OPTIONAL
        }
    TLSGostSrvKeyExchange ::=
        SEQUENCE OF
            OCTET STRING (CONSTRAINED BY {Certificate})
    TLSGostExtensionHashHMACSelect ::=
        SEQUENCE {
            hashAlgorithm AlgorithmIdentifier,
            hmacAlgorithm AlgorithmIdentifier,
            prfAlgorithm AlgorithmIdentifier
        }
    TLSGostExtensionHashHMACSelectClient ::=
        SEQUENCE OF
            TLSGostExtensionHashHMACSelect
    TLSGostExtensionHashHMACSelectServer ::=
        TLSGostExtensionHashHMACSelect

END -- Gost-CryptoPro-TLS
</pre></div>
<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B"></a><h3>Appendix B.&nbsp;
Acknowledgments</h3>

<p>This document was created in accordance with "Russian Cryptographic
      Software Compatibility Agreement", signed by FGUE STC "Atlas",
      CRYPTO-PRO, Factor-TS, MD PREI, Infotecs GmbH, SPRCIS (SPbRCZI),
      Cryptocom, R-Alpha. The aim of this agreement is to achieve mutual
      compatibility of the products and solutions.
</p>
<p>The authors wish to thank:
</p>
<p></p>
<blockquote class="text">
<p>Microsoft Corporation Russia for provided information about
          company products and solutions, and also for technical consulting in
          PKI.
</p>
<p>RSA Security Russia and Demos Co Ltd for active colaboration and
          critical help in creation of this document.
</p>
<p>NIP Informzachita for compatibility testing of the proposed data
          formats while incorporating them into company products.
</p>
<p>Citrix Inc for help in compatibility testing Citrix products for
          Microsoft Windows.
</p>
<p>Russ Hously (Vigil Security, LLC, housley@vigilsec.com) and
          Vasilij Sakharov (DEMOS Co Ltd, svp@dol.ru) for initiative, creating
          this document.
</p>
</blockquote>

<p style='text-align: left'>Author's Addresses
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
Alexandr Afanasiev
Factor-TS
office 711, 14, Presnenskij val,
Moscow, 123557, Russian Federation
EMail: afa1@factor-ts.ru

Nikolaj Nikishin
Infotecs GmbH
p/b 35, 80-5, Leningradskij prospekt,
Moscow, 125315, Russian Federation
EMail: nikishin@infotecs.ru

Boleslav Izotov
FGUE STC "Atlas"
38, Obraztsova,
Moscow, 127018, Russian Federation
EMail: izotov@nii.voskhod.ru

Elena Minaeva
MD PREI
build 3, 6A, Vtoroj Troitskij per.,
Moscow, Russian Federation
EMail: evminaeva@mail.ru

Serguei Murugov
R-Alpha
4/1, Raspletina,
Moscow, 123060, Russian Federation
EMail: msm@top-cross.ru

Igor Ustinov
Cryptocom
office 239, 51, Leninskij prospekt,
Moscow, 119991, Russian Federation
EMail: igus@cryptocom.ru

Anatolij Erkin
SPRCIS (SPbRCZI)
1, Obrucheva,
St.Petersburg, 195220, Russian Federation
EMail: erkin@nevsky.net
</pre></div>
<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Grigorij S. Chudov (editor)</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">CRYPTO-PRO, Ltd.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">16/5, Suschevskij val</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Moscow  127018</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Russia</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+7 (495) 780 48 20</td></tr>
<tr><td class="author" align="right">Fax:&nbsp;</td>
<td class="author-text">+7 (495) 660 2330</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:chudov@CryptoPro.ru">chudov@CryptoPro.ru</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.CryptoPro.ru">http://www.CryptoPro.ru</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Serguei E. Leontiev (editor)</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">CRYPTO-PRO, Ltd.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">16/5, Suschevskij val</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Moscow  127018</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Russia</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+7 (495) 933 11 68</td></tr>
<tr><td class="author" align="right">Fax:&nbsp;</td>
<td class="author-text">+7 (495) 933 11 68</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:lse@CryptoPro.ru">lse@CryptoPro.ru</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.CryptoPro.ru">http://www.CryptoPro.ru</a></td></tr>
</table>
</body></html>
