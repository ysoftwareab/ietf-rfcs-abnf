<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Key Provisioning for Group Communication using ACE</title>
<meta content="Francesca Palombini" name="author">
<meta content="Marco Tiloca" name="author">
<meta content="
       This document defines message formats and procedures for requesting and distributing group keying material using the ACE framework, to protect communications between group members. 
    " name="description">
<meta content="xml2rfc 2.44.0" name="generator">
<meta content="draft-ietf-ace-key-groupcomm-06" name="ietf.draft">
<link href="/tmp/draft-ietf-ace-key-groupcomm-06-6og5mhmv.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Avoid wrapping of URLs in references */
@media screen {
  .references a {
    white-space: nowrap;
  }
}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Key Provisioning for Group Communication</td>
<td class="right">May 2020</td>
</tr></thead>
<tfoot><tr>
<td class="left">Palombini &amp; Tiloca</td>
<td class="center">Expires 12 November 2020</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">ACE Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-ace-key-groupcomm-06</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2020-05-11" class="published">11 May 2020</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2020-11-12">12 November 2020</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">F. Palombini</div>
<div class="org">Ericsson AB</div>
</div>
<div class="author">
      <div class="author-name">M. Tiloca</div>
<div class="org">RISE AB</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Key Provisioning for Group Communication using ACE</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document defines message formats and procedures for requesting and distributing group keying material using the ACE framework, to protect communications between group members.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 12 November 2020.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2020 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a><a href="#section-toc.1-1.1.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-terminology" class="xref">Terminology</a><a href="#section-toc.1-1.1.2.1.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="xref">2</a>.  <a href="#name-overview" class="xref">Overview</a><a href="#section-toc.1-1.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-authorization-to-join-a-gro" class="xref">Authorization to Join a Group</a><a href="#section-toc.1-1.3.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-authorization-request" class="xref">Authorization Request</a><a href="#section-toc.1-1.3.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-authorization-response" class="xref">Authorization Response</a><a href="#section-toc.1-1.3.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-token-post" class="xref">Token Post</a><a href="#section-toc.1-1.3.2.3.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-keying-material-provisionin" class="xref">Keying Material Provisioning and Group Membership Management</a><a href="#section-toc.1-1.4.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-interface-at-the-kdc" class="xref">Interface at the KDC</a><a href="#section-toc.1-1.4.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-joining-exchange" class="xref">Joining Exchange</a><a href="#section-toc.1-1.4.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.  <a href="#name-retrieval-of-updated-keying" class="xref">Retrieval of Updated Keying Material</a><a href="#section-toc.1-1.4.2.3.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="xref">4.4</a>.  <a href="#name-retrieval-of-new-keying-mat" class="xref">Retrieval of New Keying Material</a><a href="#section-toc.1-1.4.2.4.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="xref">4.5</a>.  <a href="#name-retrieval-of-public-keys-an" class="xref">Retrieval of Public Keys and Roles for Group Members</a><a href="#section-toc.1-1.4.2.5.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4.2.6">
                <p id="section-toc.1-1.4.2.6.1"><a href="#section-4.6" class="xref">4.6</a>.  <a href="#name-update-of-public-key" class="xref">Update of Public Key</a><a href="#section-toc.1-1.4.2.6.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4.2.7">
                <p id="section-toc.1-1.4.2.7.1"><a href="#section-4.7" class="xref">4.7</a>.  <a href="#name-retrieval-of-group-policies" class="xref">Retrieval of Group Policies</a><a href="#section-toc.1-1.4.2.7.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4.2.8">
                <p id="section-toc.1-1.4.2.8.1"><a href="#section-4.8" class="xref">4.8</a>.  <a href="#name-retrieval-of-keying-materia" class="xref">Retrieval of Keying Material Version</a><a href="#section-toc.1-1.4.2.8.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4.2.9">
                <p id="section-toc.1-1.4.2.9.1"><a href="#section-4.9" class="xref">4.9</a>.  <a href="#name-group-leaving-request" class="xref">Group Leaving Request</a><a href="#section-toc.1-1.4.2.9.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-removal-of-a-node-from-the-" class="xref">Removal of a Node from the Group</a><a href="#section-toc.1-1.5.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-ace-groupcomm-parameters" class="xref">ACE Groupcomm Parameters</a><a href="#section-toc.1-1.6.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a><a href="#section-toc.1-1.7.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.  <a href="#name-update-of-keying-material" class="xref">Update of Keying Material</a><a href="#section-toc.1-1.7.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="xref">7.2</a>.  <a href="#name-block-wise-considerations" class="xref">Block-Wise Considerations</a><a href="#section-toc.1-1.7.2.2.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a><a href="#section-toc.1-1.8.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="xref">8.1</a>.  <a href="#name-media-type-registrations" class="xref">Media Type Registrations</a><a href="#section-toc.1-1.8.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="xref">8.2</a>.  <a href="#name-coap-content-formats-regist" class="xref">CoAP Content-Formats Registry</a><a href="#section-toc.1-1.8.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="xref">8.3</a>.  <a href="#name-ace-authorization-server-re" class="xref">ACE Authorization Server Request Creation Hints Registry</a><a href="#section-toc.1-1.8.2.3.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.8.2.4">
                <p id="section-toc.1-1.8.2.4.1"><a href="#section-8.4" class="xref">8.4</a>.  <a href="#name-ace-groupcomm-parameters-re" class="xref">ACE Groupcomm Parameters Registry</a><a href="#section-toc.1-1.8.2.4.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.8.2.5">
                <p id="section-toc.1-1.8.2.5.1"><a href="#section-8.5" class="xref">8.5</a>.  <a href="#name-ace-groupcomm-key-registry" class="xref">ACE Groupcomm Key Registry</a><a href="#section-toc.1-1.8.2.5.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.8.2.6">
                <p id="section-toc.1-1.8.2.6.1"><a href="#section-8.6" class="xref">8.6</a>.  <a href="#name-ace-groupcomm-profile-regis" class="xref">ACE Groupcomm Profile Registry</a><a href="#section-toc.1-1.8.2.6.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.8.2.7">
                <p id="section-toc.1-1.8.2.7.1"><a href="#section-8.7" class="xref">8.7</a>.  <a href="#name-ace-groupcomm-policy-regist" class="xref">ACE Groupcomm Policy Registry</a><a href="#section-toc.1-1.8.2.7.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.8.2.8">
                <p id="section-toc.1-1.8.2.8.1"><a href="#section-8.8" class="xref">8.8</a>.  <a href="#name-sequence-number-synchroniza" class="xref">Sequence Number Synchronization Method Registry</a><a href="#section-toc.1-1.8.2.8.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.8.2.9">
                <p id="section-toc.1-1.8.2.9.1"><a href="#section-8.9" class="xref">8.9</a>.  <a href="#name-interface-description-if-li" class="xref">Interface Description (if=) Link Target Attribute Values Registry</a><a href="#section-toc.1-1.8.2.9.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.8.2.10">
                <p id="section-toc.1-1.8.2.10.1"><a href="#section-8.10" class="xref">8.10</a>. <a href="#name-expert-review-instructions" class="xref">Expert Review Instructions</a><a href="#section-toc.1-1.8.2.10.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-references" class="xref">References</a><a href="#section-toc.1-1.9.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="xref">9.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a><a href="#section-toc.1-1.9.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="xref">9.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a><a href="#section-toc.1-1.9.2.2.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-appendix.a" class="xref">Appendix A</a>.  <a href="#name-requirements-on-application" class="xref">Requirements on Application Profiles</a><a href="#section-toc.1-1.10.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-appendix.b" class="xref">Appendix B</a>.  <a href="#name-document-updates" class="xref">Document Updates</a><a href="#section-toc.1-1.11.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-b.1" class="xref">B.1</a>.  <a href="#name-version-04-to-05" class="xref">Version -04 to -05</a><a href="#section-toc.1-1.11.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-b.2" class="xref">B.2</a>.  <a href="#name-version-03-to-04" class="xref">Version -03 to -04</a><a href="#section-toc.1-1.11.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.11.2.3">
                <p id="section-toc.1-1.11.2.3.1"><a href="#section-b.3" class="xref">B.3</a>.  <a href="#name-version-02-to-03" class="xref">Version -02 to -03</a><a href="#section-toc.1-1.11.2.3.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.11.2.4">
                <p id="section-toc.1-1.11.2.4.1"><a href="#section-b.4" class="xref">B.4</a>.  <a href="#name-version-01-to-02" class="xref">Version -01 to -02</a><a href="#section-toc.1-1.11.2.4.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.11.2.5">
                <p id="section-toc.1-1.11.2.5.1"><a href="#section-b.5" class="xref">B.5</a>.  <a href="#name-version-00-to-01" class="xref">Version -00 to -01</a><a href="#section-toc.1-1.11.2.5.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-appendix.c" class="xref"></a><a href="#name-acknowledgments" class="xref">Acknowledgments</a><a href="#section-toc.1-1.12.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-appendix.d" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a><a href="#section-toc.1-1.13.1" class="pilcrow">¶</a></p>
</li>
</ul>
</nav>
</section>
</div>
<div id="intro">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">This document expands the ACE framework <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span> to define the message exchanges used to request, distribute and renew the keying material in a group communication scenario, e.g. based on multicast <span>[<a href="#I-D.dijk-core-groupcomm-bis" class="xref">I-D.dijk-core-groupcomm-bis</a>]</span> or on publishing-subscribing <span>[<a href="#I-D.ietf-core-coap-pubsub" class="xref">I-D.ietf-core-coap-pubsub</a>]</span>.
The ACE framework is based on CBOR <span>[<a href="#RFC7049" class="xref">RFC7049</a>]</span>, so CBOR is the format used in this specification. However, using JSON <span>[<a href="#RFC8259" class="xref">RFC8259</a>]</span> instead of CBOR is possible, using the conversion method specified in Sections 4.1 and 4.2 of <span>[<a href="#RFC7049" class="xref">RFC7049</a>]</span>.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">Profiles that use group communication can build on this document, by defining a number of details such as the exact group communication protocol and security protocols used. The specific list of details a profile needs to define is shown in <a href="#req" class="xref">Appendix A</a>.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">If the application requires backward and forward security, new keying material is generated and distributed to the group upon membership changes. A key management scheme performs the actual distribution of the new keying material to the group. In particular, the key management scheme rekeys the current group members when a new node joins the group, and the remaining group members when a node leaves the group. Rekeying mechanisms can be based on <span>[<a href="#RFC2093" class="xref">RFC2093</a>]</span>, <span>[<a href="#RFC2094" class="xref">RFC2094</a>]</span> and <span>[<a href="#RFC2627" class="xref">RFC2627</a>]</span>.<a href="#section-1-3" class="pilcrow">¶</a></p>
<div id="terminology">
<section id="section-1.1">
        <h3 id="name-terminology">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.1-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they appear in all capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">Readers are expected to be familiar with the terms and concepts described in  <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span> and <span>[<a href="#RFC8152" class="xref">RFC8152</a>]</span>, such as Authorization Server (AS) and Resource Server (RS).<a href="#section-1.1-2" class="pilcrow">¶</a></p>
<p id="section-1.1-3">This document additionally uses the following terminology:<a href="#section-1.1-3" class="pilcrow">¶</a></p>
<ul>
<li id="section-1.1-4.1">Transport profile, to indicate a profile of ACE as per Section 5.6.4.3 of <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>. A transport profile specifies the communication protocol and communication security protocol between an ACE Client and Resource Server, as well as proof-of-possession methods, if it supports proof-of-possession access tokens, etc. Tranport profiles of ACE include, for instance, <span>[<a href="#I-D.ietf-ace-oscore-profile" class="xref">I-D.ietf-ace-oscore-profile</a>]</span>, <span>[<a href="#I-D.ietf-ace-dtls-authorize" class="xref">I-D.ietf-ace-dtls-authorize</a>]</span> and <span>[<a href="#I-D.ietf-ace-mqtt-tls-profile" class="xref">I-D.ietf-ace-mqtt-tls-profile</a>]</span>.<a href="#section-1.1-4.1" class="pilcrow">¶</a>
</li>
<li id="section-1.1-4.2">Application profile, that defines how applications enforce and use supporting security services they require. These services may include, for instance, provisioning, revocation and (re-)distribution of keying material. An application profile may define specific procedures and message formats.<a href="#section-1.1-4.2" class="pilcrow">¶</a>
</li>
</ul>
</section>
</div>
</section>
</div>
<div id="overview">
<section id="section-2">
      <h2 id="name-overview">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-overview" class="section-name selfRef">Overview</a>
      </h2>
<span id="name-key-distribution-participan"></span><div id="fig-roles">
<figure id="figure-1">
        <div class="artwork art-text alignCenter" id="section-2-1.1">
<pre>
+------------+                  +-----------+
|     AS     |                  |    KDC    |
|            |        .--------&gt;|           |
+------------+       /          +-----------+
      ^             /
      |            /
      v           /                           +-----------+
+------------+   /      +------------+        |+-----------+
|   Client   |&lt;-'       | Dispatcher |        ||+-----------+
|            |&lt;--------&gt;|    (RS)    |&lt;-------&gt;||   Group   |
+------------+          +------------+         +|  members  |
                                                +-----------+
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-key-distribution-participan" class="selfRef">Key Distribution Participants</a>
        </figcaption></figure>
</div>
<p id="section-2-2">The following participants (see <a href="#fig-roles" class="xref">Figure 1</a>) take part in the authorization and key distribution.<a href="#section-2-2" class="pilcrow">¶</a></p>
<ul>
<li id="section-2-3.1">Client (C): node that wants to join the group communication. It can request write and/or read rights.<a href="#section-2-3.1" class="pilcrow">¶</a>
</li>
<li id="section-2-3.2">Authorization Server (AS): same as AS in the ACE Framework; it enforces access policies, and knows if a node is allowed to join a given group with write and/or read rights.<a href="#section-2-3.2" class="pilcrow">¶</a>
</li>
<li id="section-2-3.3">Key Distribution Center (KDC): maintains the keying material to protect group communications, and provides it to Clients authorized to join a given group. During the first part of the exchange (<a href="#sec-auth" class="xref">Section 3</a>), it takes the role of the RS in the ACE Framework. During the second part (<a href="#key-distr" class="xref">Section 4</a>), which is not based on the ACE Framework, it distributes the keying material. In addition, it provides the latest keying material to group members when requested or, if required by the application, when membership changes.<a href="#section-2-3.3" class="pilcrow">¶</a>
</li>
</ul>
<ul>
<li id="section-2-4.1">Dispatcher: entity through which the Clients communicate with the group and which distributes messages to the group members. Examples of dispatchers are: the Broker node in a pub-sub setting; a relayer node for group communication that delivers group messages as multiple unicast messages to all group members; an implicit entity as in a multicast communication setting, where messages are transmitted to a multicast IP address and delivered on the transport channel.<a href="#section-2-4.1" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-2-5">This document specifies a mechanism for:<a href="#section-2-5" class="pilcrow">¶</a></p>
<ul>
<li id="section-2-6.1">Authorizing a new node to join the group (<a href="#sec-auth" class="xref">Section 3</a>), and providing it with the group keying material to communicate with the other group members (<a href="#key-distr" class="xref">Section 4</a>).<a href="#section-2-6.1" class="pilcrow">¶</a>
</li>
<li id="section-2-6.2">A node to leave the group of for the KDC to remove a current member of the group (<a href="#sec-node-removal" class="xref">Section 5</a>).<a href="#section-2-6.2" class="pilcrow">¶</a>
</li>
<li id="section-2-6.3">Retrieving keying material as a current group member (<a href="#update-keys" class="xref">Section 4.3</a> and <a href="#new-keys" class="xref">Section 4.4</a>).<a href="#section-2-6.3" class="pilcrow">¶</a>
</li>
<li id="section-2-6.4">Renewing and re-distributing the group keying material (rekeying) upon a membership change in the group (<a href="#ssec-group-leaving" class="xref">Section 4.9</a> and <a href="#sec-node-removal" class="xref">Section 5</a>).<a href="#section-2-6.4" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-2-7"><a href="#fig-flow" class="xref">Figure 2</a> provides a high level overview of the message flow for a node joining a group communication setting, which can be expanded as follows.<a href="#section-2-7" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2-8">
        <li id="section-2-8.1">The joining node requests an Access Token from the AS, in order to access a specific group-membership resource on the KDC and hence join the associated group. The joining node will start or continue using a secure communication association with the KDC, according to the response from the AS.<a href="#section-2-8.1" class="pilcrow">¶</a>
</li>
<li id="section-2-8.2">The joining node transfers authentication and authorization information to the KDC, by posting the obtained Access Token to the /authz-info endpoint at the KDC. After that, a joining node MUST have a secure communication association established with the KDC, before starting to join a group under that KDC. Possible ways to provide a secure communication association are DTLS <span>[<a href="#RFC6347" class="xref">RFC6347</a>]</span> and OSCORE <span>[<a href="#RFC8613" class="xref">RFC8613</a>]</span>.<a href="#section-2-8.2" class="pilcrow">¶</a>
</li>
<li id="section-2-8.3">The joining node starts the joining process to become a member of the group, by accessing the related group-membership resource at the KDC.
At the end of the joining process, the joining node has received from the KDC the parameters and keying material to securely communicate with the other members of the group, and the KDC has stored the association between the authorization information from the access token and the secure session with the client.<a href="#section-2-8.3" class="pilcrow">¶</a>
</li>
<li id="section-2-8.4">The joining node and the KDC maintain the secure association, to support possible future communications. These especially include key management operations, such as retrieval of updated keying material or participation to a group rekeying process.<a href="#section-2-8.4" class="pilcrow">¶</a>
</li>
</ol>
<span id="name-message-flow-upon-new-nodes"></span><div id="fig-flow">
<figure id="figure-2">
        <div class="artwork art-text alignCenter" id="section-2-9.1">
<pre>
            C                           AS  KDC                Group
            |                           |    |                 Member
          / |                           |    |                     |
          | |   Authorization Request   |    |                     |
 Defined  | |--------------------------&gt;|    |                     |
 in the   | |                           |    |                     |
   ACE    | |   Authorization Response  |    |                     |
framework | |&lt;--------------------------|    |                     |
          | |                                |                     |
          \ |---------- Token Post ---------&gt;|                     |
            |                                |                     |
            |------- Joining Request -------&gt;|                     |
            |                                |                     |
            |&lt;------ Joining Response -------|-- Group Rekeying --&gt;|
            |                                |                     |
            |                                     Dispatcher       |
            |                                         |            |
            |&lt;===== Secure group communication =======|===========&gt;|
            |                                         |            |
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-message-flow-upon-new-nodes" class="selfRef">Message Flow Upon New Node's Joining</a>
        </figcaption></figure>
</div>
<p id="section-2-10">The exchange of Authorization Request and Authorization Response between Client and AS MUST be secured, as specified by the transport profile of ACE used between Client and KDC.<a href="#section-2-10" class="pilcrow">¶</a></p>
<p id="section-2-11">The exchange of Joining Request and Joining Response between Client and KDC MUST be secured, as a result of the transport profile of ACE used between Client and KDC.<a href="#section-2-11" class="pilcrow">¶</a></p>
<p id="section-2-12">All further communications between the Client and the KDC MUST be secured, for instance with the same security mechanism used for the Key Distribution exchange.<a href="#section-2-12" class="pilcrow">¶</a></p>
<p id="section-2-13">All communications between a Client and the other group members MUST be secured using the keying material provided in <a href="#key-distr" class="xref">Section 4</a>.<a href="#section-2-13" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-auth">
<section id="section-3">
      <h2 id="name-authorization-to-join-a-gro">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-authorization-to-join-a-gro" class="section-name selfRef">Authorization to Join a Group</a>
      </h2>
<p id="section-3-1">This section describes in detail the format of messages exchanged by the participants when a node requests access to a group. This exchange is based on ACE <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">As defined in <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>, the Client requests from the AS an authorization to join the group through the KDC (see <a href="#ssec-authorization-request" class="xref">Section 3.1</a>). If the request is approved and authorization is granted, the AS provides the Client with a proof-of-possession access token and parameters to securely communicate with the KDC (see <a href="#ssec-authorization-response" class="xref">Section 3.2</a>).<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">Communications between the Client and the AS MUST be secured, as defined by the transport profile of ACE used. The Content-Format used in the messages is the one specified by the used transport profile of ACE (e.g. application/ace+cbor for the first two messages and application/cwt for the third message, depending on the format of the access token). The transport profile of ACE also defines a number of details such as the communication and security protocols used with the KDC (see Appendix C of <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>).<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4"><a href="#fig-group-member-registration" class="xref">Figure 3</a> gives an overview of the exchange described above.<a href="#section-3-4" class="pilcrow">¶</a></p>
<span id="name-message-flow-of-join-author"></span><div id="fig-group-member-registration">
<figure id="figure-3">
        <div class="artwork art-text alignCenter" id="section-3-5.1">
<pre>
Client                                            AS  KDC
   |                                               |   |
   |---- Authorization Request: POST /token ------&gt;|   |
   |                                               |   |
   |&lt;--- Authorization Response: 2.01 (Created) ---|   |
   |                                               |   |
   |----- POST Token: POST /authz-info ---------------&gt;|
   |                                                   |
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-message-flow-of-join-author" class="selfRef">Message Flow of Join Authorization</a>
        </figcaption></figure>
</div>
<div id="ssec-authorization-request">
<section id="section-3.1">
        <h3 id="name-authorization-request">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-authorization-request" class="section-name selfRef">Authorization Request</a>
        </h3>
<p id="section-3.1-1">The Authorization Request sent from the Client to the AS is as defined in Section 5.6.1 of <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span> and MAY contain the following parameters, which, if included, MUST have the corresponding values:<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.1-2.1">
            <p id="section-3.1-2.1.1">'scope', containing the identifier of the specific group(s), or topic(s) in the case of pub-sub, that the Client wishes to access, and optionally the role(s) that the Client wishes to take.<a href="#section-3.1-2.1.1" class="pilcrow">¶</a></p>
<p id="section-3.1-2.1.2">
This value is a CBOR byte string, encoding a CBOR array of one or more  entries.<a href="#section-3.1-2.1.2" class="pilcrow">¶</a></p>
<p id="section-3.1-2.1.3">
An entry has as value a CBOR array, which contains:<a href="#section-3.1-2.1.3" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.1-2.1.4.1">As first element, the identifier of the specific group or topic.<a href="#section-3.1-2.1.4.1" class="pilcrow">¶</a>
</li>
<li id="section-3.1-2.1.4.2">Optionally, as second element, the role (or CBOR array of roles) that the Client wishes to take in the group. This element is optional since roles may have been pre-assigned to the Client, as associated to its verifiable identity credentials. Alternatively, the application may have defined a single, well-known role for the target resource(s) and audience(s).<a href="#section-3.1-2.1.4.2" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-3.1-2.1.5">
In each entry, the encoding of the group or topic identifier (REQ1) and of the role identifiers (REQ2) is application specific, and part of the requirements for the application profile.<a href="#section-3.1-2.1.5" class="pilcrow">¶</a></p>
<p id="section-3.1-2.1.6">
In particular, the application profile may specify CBOR values to use for abbreviating role identifiers (OPT7).<a href="#section-3.1-2.1.6" class="pilcrow">¶</a></p>
<p id="section-3.1-2.1.7">
The CDDL definition of scope, using as example group identifier encoded as byte string and role identifier as text string, is given in <a href="#cddl-ex" class="xref">Figure 4</a>.<a href="#section-3.1-2.1.7" class="pilcrow">¶</a></p>
</li>
<li id="section-3.1-2.2">'audience', with an identifier of a KDC.<a href="#section-3.1-2.2" class="pilcrow">¶</a>
</li>
<li id="section-3.1-2.3">'req_cnf', as defined in Section 3.1 of <span>[<a href="#I-D.ietf-ace-oauth-params" class="xref">I-D.ietf-ace-oauth-params</a>]</span>, optionally containing the public key or a reference to the public key of the Client, if it wishes to communicate that to the AS.<a href="#section-3.1-2.3" class="pilcrow">¶</a>
</li>
</ul>
<ul>
<li id="section-3.1-3.1">Other additional parameters as defined in <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>, if necessary.<a href="#section-3.1-3.1" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-3.1-4">As in <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>, these parameters are included in the payload, which is formatted as a CBOR map. The Content-Format "application/ace+cbor" defined in Section 8.14 of <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span> is used.<a href="#section-3.1-4" class="pilcrow">¶</a></p>
<span id="name-cdll-definition-of-scope-us"></span><div id="cddl-ex">
<figure id="figure-4">
          <div class="artwork art-text alignCenter art-CDDL" id="section-3.1-5.1">
<pre>
gid = bstr

role = tstr

scope_entry = [ gid , ? ( role / [ 2*role ] ) ]

scope = &lt;&lt; [ + scope_entry ] &gt;&gt;
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-cdll-definition-of-scope-us" class="selfRef">CDLL definition of scope, using as example group identifier encoded as bstr and role as tstr</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="ssec-authorization-response">
<section id="section-3.2">
        <h3 id="name-authorization-response">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-authorization-response" class="section-name selfRef">Authorization Response</a>
        </h3>
<p id="section-3.2-1">The Authorization Response sent from the AS to the Client is as defined in Section 5.6.2 of <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span> and MUST contain the following parameters:<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.2-2.1">'access_token', containing the proof-of-possession access token.<a href="#section-3.2-2.1" class="pilcrow">¶</a>
</li>
<li id="section-3.2-2.2">'cnf' if symmetric keys are used, not present if asymmetric keys are used. This parameter is defined in Section 3.2 of <span>[<a href="#I-D.ietf-ace-oauth-params" class="xref">I-D.ietf-ace-oauth-params</a>]</span> and contains the symmetric proof-of-possession key that the Client is supposed to use with the KDC.<a href="#section-3.2-2.2" class="pilcrow">¶</a>
</li>
<li id="section-3.2-2.3">'rs_cnf' if asymmetric keys are used, not present if symmetric keys are used. This parameter is as defined in Section 3.2 of <span>[<a href="#I-D.ietf-ace-oauth-params" class="xref">I-D.ietf-ace-oauth-params</a>]</span> and contains information about the public key of the KDC.<a href="#section-3.2-2.3" class="pilcrow">¶</a>
</li>
<li id="section-3.2-2.4">'expires_in', contains the lifetime in seconds of the access token. This parameter MAY be omitted if the application defines how the expiration time is communicated to the Client via other means, or if it establishes a default value.<a href="#section-3.2-2.4" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-3.2-3">Additionally, the Authorization Response MAY contain the following parameters, which, if included, MUST have the corresponding values:<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.2-4.1">'scope' containing the granted scope, if different from the scope requested by the client. This parameter has the same format and encoding of 'scope' in the Authorization Request, defined in <a href="#ssec-authorization-request" class="xref">Section 3.1</a>.<a href="#section-3.2-4.1" class="pilcrow">¶</a>
</li>
<li id="section-3.2-4.2">Other additional parameters as defined in <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>, if necessary.<a href="#section-3.2-4.2" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-3.2-5">The proof-of-possession access token (in 'access_token' above) MUST contain the following parameters:<a href="#section-3.2-5" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.2-6.1">a confirmation claim (see for example 'cnf' defined in Section 3.1 of <span>[<a href="#RFC8747" class="xref">RFC8747</a>]</span> for CWT);<a href="#section-3.2-6.1" class="pilcrow">¶</a>
</li>
<li id="section-3.2-6.2">an expiration time claim (see for example 'exp' defined in Section 3.1.4 of <span>[<a href="#RFC8392" class="xref">RFC8392</a>]</span> for CWT);<a href="#section-3.2-6.2" class="pilcrow">¶</a>
</li>
<li id="section-3.2-6.3">a scope claim (see for example 'scope' registered in Section 8.13 of <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span> for CWT). This claim has the same encoding as 'scope' parameter above. Additionally, this claim has the same value of the 'scope' parameter if the parameter is present in the message, or it takes the value of 'scope' in the Authorization Request otherwise.<a href="#section-3.2-6.3" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-3.2-7">The access token MAY additionally contain other claims that the transport profile of ACE requires, or other optional parameters.<a href="#section-3.2-7" class="pilcrow">¶</a></p>
<p id="section-3.2-8">As in <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>, these parameters are included in the payload, which is formatted as a CBOR map. The Content-Format "application/ace+cbor" is used.<a href="#section-3.2-8" class="pilcrow">¶</a></p>
<p id="section-3.2-9">When receiving an Authorization Request from a Client that was previously authorized, and for which the AS still owns a valid non expired access token, the AS MAY reply with that token. Note that it is up to application profiles of ACE to make sure that re-posting the same token does not cause re-use of keying material between nodes (for example, that is done with the use of random nonces in <span>[<a href="#I-D.ietf-ace-oscore-profile" class="xref">I-D.ietf-ace-oscore-profile</a>]</span>).<a href="#section-3.2-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="token-post">
<section id="section-3.3">
        <h3 id="name-token-post">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-token-post" class="section-name selfRef">Token Post</a>
        </h3>
<p id="section-3.3-1">The Client sends a CoAP POST request including the access token to the KDC, as specified in Section 5.8.1 of <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>. If the specific transport profile of ACE defines it, the Client MAY use a different endpoint than /authz-info at the KDC to post the access token to.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2">Optionally, the Client might want to request necessary information concerning the public keys in the group, as well as concerning the algorithm and related parameters for computing signatures in the group. In such a case, the joining node MAY ask for that information to the KDC in this same request. To this end, it sends the CoAP POST request to the /authz-info endpoint using the Content-Format "application/ace+cbor". The payload of the message MUST be formatted as a CBOR map, including the access token and the following parameters:<a href="#section-3.3-2" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.3-3.1">'sign_info' defined in <a href="#sign-info" class="xref">Section 3.3.1</a>.<a href="#section-3.3-3.1" class="pilcrow">¶</a>
</li>
<li id="section-3.3-3.2">'pub_key_enc' defined in <a href="#pub-key-enc" class="xref">Section 3.3.2</a>, encoding the CBOR simple value Null, to require information on the exact encoding of public keys used in the group.<a href="#section-3.3-3.2" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-3.3-4">Alternatively, the joining node may retrieve this information by other means.<a href="#section-3.3-4" class="pilcrow">¶</a></p>
<p id="section-3.3-5">After successful verification, the Client is authorized to receive the group keying material from the KDC and join the group. In particular, the KDC replies to the Client with a 2.01 (Created) response, using Content-Format "application/ace+cbor" defined in Section 8.14 of <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>.<a href="#section-3.3-5" class="pilcrow">¶</a></p>
<p id="section-3.3-6">The payload of the 2.01 response is a CBOR map. If the access token contains a role that requires the Client to send its own public key to the KDC when joining the group, the CBOR map MUST include the parameter 'kdcchallenge' defined in Section <a href="#kdcchallenge" class="xref">Section 3.3.3</a>, specifying a dedicated challenge N_S generated by the KDC. The Client uses this challenge to prove possession of its own private key (see the 'client_cred_verify' parameter in <a href="#key-distr" class="xref">Section 4</a>). Note that the payload format of the response deviates from the default as defined in the ACE framework (see Section 5.8.1 of <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>).<a href="#section-3.3-6" class="pilcrow">¶</a></p>
<p id="section-3.3-7">The KDC MUST store the 'kdcchallenge' value associated to the Client at least until it receives a join request from it (see <a href="#ssec-key-distribution-exchange" class="xref">Section 4.2</a>), to be able to verify the proof of possession. The same challenge MAY be reused several times by the Client, to generate new proof of possessions, e.g. in case of update of the public key, or to join a different group with a different key, so it is RECOMMENDED that the KDC keeps storing the 'kdcchallenge' after the first join is processed as well. If the KDC has already discarded the 'kdcchallenge', that will trigger an error response with a newly generated 'kdcchallenge' that the client can use to restart the join process, as specified in <a href="#ssec-key-distribution-exchange" class="xref">Section 4.2</a>.<a href="#section-3.3-7" class="pilcrow">¶</a></p>
<p id="section-3.3-8">If either of 'sign_info' or 'pub_key_enc' were included in the request, the KDC MAY include the 'sign_info' parameter defined in <a href="#sign-info" class="xref">Section 3.3.1</a>, optionally including the 'pub_key_enc' parameter <a href="#pub-key-enc" class="xref">Section 3.3.2</a>.<a href="#section-3.3-8" class="pilcrow">¶</a></p>
<p id="section-3.3-9">The 'sign_info' parameter MUST be present if the POST request included the 'sign_info' parameter and/or the pub_key_enc with value Null.
The encoding of the 'sign_info' parameter in the response is defined in <a href="#pub-key-enc" class="xref">Section 3.3.2</a>. Note that the field 'id' takes the value of the group identifier for which the 'sign_info' applies to, in this specification.<a href="#section-3.3-9" class="pilcrow">¶</a></p>
<p id="section-3.3-10">Note that the CBOR map specified as payload of the 2.01 (Created) response may include further parameters, e.g. according to the signalled transport profile of ACE.<a href="#section-3.3-10" class="pilcrow">¶</a></p>
<p id="section-3.3-11">Applications of this specification MAY define alternative specific negotiations of parameter values for signature algorithm and signature keys, if 'sign_info' and 'pub_key_enc' are not used (OPT2).<a href="#section-3.3-11" class="pilcrow">¶</a></p>
<div id="sign-info">
<section id="section-3.3.1">
          <h4 id="name-sign_info-parameter">
<a href="#section-3.3.1" class="section-number selfRef">3.3.1. </a><a href="#name-sign_info-parameter" class="section-name selfRef">'sign_info' Parameter</a>
          </h4>
<p id="section-3.3.1-1">The 'sign_info' parameter is an OPTIONAL parameter of the AS Request Creation Hints message defined in Section 5.1.2. of <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>. This parameter contains information and parameters about the signature algorithm and the public keys to be used between the Client and the RS. Its exact content is application specific.<a href="#section-3.3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.3.1-2">In this specification and in application profiles building on it, this parameter is used to ask and retrieve from the KDC information about the signature algorithm and related parameters used in the group.<a href="#section-3.3.1-2" class="pilcrow">¶</a></p>
<p id="section-3.3.1-3">When used in the request, the 'sign_info' encodes the CBOR simple value Null, to require information and parameters on the signature algorithm and on the public keys used.<a href="#section-3.3.1-3" class="pilcrow">¶</a></p>
<p id="section-3.3.1-4">The CDDL notation of the 'sign_info' parameter formatted as in the request is given below.<a href="#section-3.3.1-4" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft art-CDDL" id="section-3.3.1-5">
<pre>
   sign_info_req = nil
</pre><a href="#section-3.3.1-5" class="pilcrow">¶</a>
</div>
<p id="section-3.3.1-6">The 'sign_info' parameter of the 2.01 (Created) response is a CBOR array of one ore more elements. The number of elements is lower or at most equal to the number of groups the client has been authorized to join. Each element contains information about signing parameters and keys for one or more group or topic and is formatted as follows.<a href="#section-3.3.1-6" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.3.1-7.1">The first element 'id' is an identifier of the group or an array of identifiers for the groups for which this information applies.<a href="#section-3.3.1-7.1" class="pilcrow">¶</a>
</li>
<li id="section-3.3.1-7.2">The second element 'sign_alg' is an integer or a text string if the POST request included the 'sing_info' parameter with value Null, and indicates the signature algorithm used in the group identified by 'gid'. It is REQUIRED of the application profiles to define specific values that this parameter can take (REQ3), selected from the set of signing algorithms of the COSE Algorithms registry defined in <span>[<a href="#RFC8152" class="xref">RFC8152</a>]</span>. If the POST request did not include the 'sing_info' parameter, this element is encoded as the CBOR simple value Null.<a href="#section-3.3.1-7.2" class="pilcrow">¶</a>
</li>
<li id="section-3.3.1-7.3">The third element 'sign_parameters' indicates the parameters of the signature algorithm. Its structure depends on the value of 'sign_alg'. It is REQUIRED of the application profiles to define specific values for this parameter (REQ4). If no parameters of the signature algorithm are specified, 'sign_parameters' MUST be encoded as the CBOR simple value Null. If the POST request did not include the 'sing_info' parameter, this element is encoded as the CBOR simple value Null.<a href="#section-3.3.1-7.3" class="pilcrow">¶</a>
</li>
<li id="section-3.3.1-7.4">The fourth element 'sign_key_parameters' indicates the parameters of the key used with the signature algorithm. Its structure depends on the value of 'sign_alg'. It is REQUIRED of the application profiles to define specific values for this parameter (REQ5). If no parameters of the key used with the signature algorithm are specified, 'sign_key_parameters' MUST be encoded as the CBOR simple value Null. If the POST request did not include the 'sing_info' parameter, this element is encoded as the CBOR simple value Null.<a href="#section-3.3.1-7.4" class="pilcrow">¶</a>
</li>
<li id="section-3.3.1-7.5">The fifth element 'pub_key_enc' parameter is optional and MUST only be present if the POST request included the 'pub_key_enc' parameter with value Null. If present, it is either a CBOR integer indicating the encoding of public keys used in the group identified by 'gid', or has value Null indicating that the KDC does not act as repository of public keys for group members. Its acceptable values are taken from the "CWT Confirmation Method" Registry defined in <span>[<a href="#I-D.ietf-ace-cwt-proof-of-possession" class="xref">I-D.ietf-ace-cwt-proof-of-possession</a>]</span>. It is REQUIRED of the application profiles to define specific values to use for this parameter (REQ6).<a href="#section-3.3.1-7.5" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-3.3.1-8">The CDDL notation of the 'sign_info' parameter formatted as in the response is given below, with gid formatted as a bstr (note that gid can be encoded differently, see REQ1).<a href="#section-3.3.1-8" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft art-CDDL" id="section-3.3.1-9">
<pre>
   sign_info_res = [ + sign_info_entry ]

   sign_info_entry =
   [
     id : gid / [ + gid ],
     sign_alg : int / tstr / nil,
     sign_parameters : any / nil,
     sign_key_parameters : any / nil,
     ? pub_key_enc_res = int / nil
   ]

   gid = bstr
</pre><a href="#section-3.3.1-9" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="pub-key-enc">
<section id="section-3.3.2">
          <h4 id="name-pub_key_enc-parameter">
<a href="#section-3.3.2" class="section-number selfRef">3.3.2. </a><a href="#name-pub_key_enc-parameter" class="section-name selfRef">'pub_key_enc' Parameter</a>
          </h4>
<p id="section-3.3.2-1">The 'pub_key_enc' parameter is an OPTIONAL parameter of the AS Request Creation Hints message defined in Section 5.1.2. of <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>. This parameter contains information about the exact encoding of public keys to be used between the Client and the RS. Its exact content is application specific.<a href="#section-3.3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.3.2-2">In this specification and in application profiles building on it, this parameter is used to ask the KDC information about the encoding of public keys used in the group.<a href="#section-3.3.2-2" class="pilcrow">¶</a></p>
<p id="section-3.3.2-3">The CDDL notation of the 'pub_key_enc' parameter formatted as in the request is given below.<a href="#section-3.3.2-3" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft art-CDDL" id="section-3.3.2-4">
<pre>
   pub_key_enc_req = nil
</pre><a href="#section-3.3.2-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="kdcchallenge">
<section id="section-3.3.3">
          <h4 id="name-kdcchallenge-parameter">
<a href="#section-3.3.3" class="section-number selfRef">3.3.3. </a><a href="#name-kdcchallenge-parameter" class="section-name selfRef">'kdcchallenge' Parameter</a>
          </h4>
<p id="section-3.3.3-1">The 'kdcchallenge' parameter is an OPTIONAL parameter of the AS Request Creation Hints message defined in Section 5.1.2. of <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>. This parameter contains a challenge generated by the KDC and provided to the Client. The Client may use this challenge to prove possession of its own private key in the Joining Request ((see the 'client_cred_verify' parameter in <a href="#key-distr" class="xref">Section 4</a>).<a href="#section-3.3.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="key-distr">
<section id="section-4">
      <h2 id="name-keying-material-provisionin">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-keying-material-provisionin" class="section-name selfRef">Keying Material Provisioning and Group Membership Management</a>
      </h2>
<p id="section-4-1">This section defines the interface available at the KDC. Moreover, this section specifies how the clients can use this interface to join a group, leave a group, retrieve new keying material or policies.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">During the first exchange with the KDC ("Joining"), the Client sends a request to the KDC, specifying the group it wishes to join (see <a href="#ssec-key-distribution-exchange" class="xref">Section 4.2</a>). Then, the KDC verifies the access token and that the Client is authorized to join that group. If so, it provides the Client with the keying material to securely communicate with the other members of the group. Whenever used, the Content-Format in messages containing a payload is set to application/ace-groupcomm+cbor, as defined in <a href="#content-type" class="xref">Section 8.2</a>.<a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3">When the Client is already a group member, the Client can use the interface at the KDC to perform the following actions:<a href="#section-4-3" class="pilcrow">¶</a></p>
<ul>
<li id="section-4-4.1">The Client can (re-)get the current keying material, for cases such as expiration, loss or suspected mismatch, due to e.g. reboot or missed group rekeying. This is described in <a href="#update-keys" class="xref">Section 4.3</a>.<a href="#section-4-4.1" class="pilcrow">¶</a>
</li>
<li id="section-4-4.2">The Client can retrieve a new individual key, or new input material to derive it. This is described in <a href="#new-keys" class="xref">Section 4.4</a>.<a href="#section-4-4.2" class="pilcrow">¶</a>
</li>
<li id="section-4-4.3">The Client can (re-)get the public keys of other group members, e.g. if it is aware of new nodes joining the group after itself. This is described in <a href="#sec-key-retrieval" class="xref">Section 4.5</a>.<a href="#section-4-4.3" class="pilcrow">¶</a>
</li>
<li id="section-4-4.4">The Client can (re-)get the policies currently enforced in the group. This is described in <a href="#policies" class="xref">Section 4.7</a>.<a href="#section-4-4.4" class="pilcrow">¶</a>
</li>
<li id="section-4-4.5">The Client can (re-)get the version number of the keying material currently used in the group. This is described in <a href="#key-version" class="xref">Section 4.8</a>.<a href="#section-4-4.5" class="pilcrow">¶</a>
</li>
<li id="section-4-4.6">The Client can request to leave the group. This is further discussed in <a href="#ssec-group-leaving" class="xref">Section 4.9</a>.<a href="#section-4-4.6" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-4-5">Upon receiving a request from a Client, the KDC MUST check that it is storing a valid access token from that Client for the group identifier assiciated to the endpoint. If that is not the case, i.e. the KDC does not store a valid access token or this is not valid for that Client for the group identifier at hand, the KDC MUST respond to the Client with a 4.01 (Unauthorized) error message.<a href="#section-4-5" class="pilcrow">¶</a></p>
<div id="interface-at-the-kdc">
<section id="section-4.1">
        <h3 id="name-interface-at-the-kdc">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-interface-at-the-kdc" class="section-name selfRef">Interface at the KDC</a>
        </h3>
<p id="section-4.1-1">The KDC is configured with the following resources. Note that the root url-path "ace-group" given here are default names: implementations are not required to use these names, and can define their own instead. The Interface Description (if=) Link Target Attribute value ace-group is registered (<a href="#if-ace-group" class="xref">Section 8.9</a>) and can be used to describe this inferface.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-4.1-2.1">/ace-group : this resource is fixed and indicates that this specification is used. Other applications that run on a KDC implementing this specification MUST NOT use this same resource.<a href="#section-4.1-2.1" class="pilcrow">¶</a>
</li>
<li id="section-4.1-2.2">/ace-group/GROUPNAME : one sub-resource to /ace-group is implemented for each group the KDC manages. These resources are identified by the group identifiers of the groups the KDC manages (in this example, the group identifier has value "GROUPNAME"). These resources support GET and POST method.<a href="#section-4.1-2.2" class="pilcrow">¶</a>
</li>
<li id="section-4.1-2.3">/ace-group/GROUPNAME/pub-key : this sub-resource is fixed and supports GET and FETCH methods.<a href="#section-4.1-2.3" class="pilcrow">¶</a>
</li>
<li id="section-4.1-2.4">/ace-group/GROUPNAME/policies: this sub-resource is fixed and supports the GET method.<a href="#section-4.1-2.4" class="pilcrow">¶</a>
</li>
<li id="section-4.1-2.5">/ace-group/GROUPNAME/ctx-num: this sub-resource is fixed and supports the GET method.<a href="#section-4.1-2.5" class="pilcrow">¶</a>
</li>
<li id="section-4.1-2.6">/ace-group/GROUPNAME/nodes/NODENAME: one sub-resource to /ace-group/GROUPNAME is implemented for each node in the group the KDC manages. These resources are identified by the node name (in this example, the node name has value "NODENAME"). These resources support GET, PUT and DELETE methods.<a href="#section-4.1-2.6" class="pilcrow">¶</a>
</li>
<li id="section-4.1-2.7">/ace-group/GROUPNAME/nodes/NODENAME/pub-key: one sub-resource to /ace-group/GROUPNAME/nodes/NODENAME is implemented for each node in the group the KDC manages. These resources are identified by the node name (in this example, the node name has value "NODENAME"). These resources support the POST method.<a href="#section-4.1-2.7" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-4.1-3">The details for the handlers of each resource are given in the following sections. These endpoints are used to perform the operations introduced in <a href="#key-distr" class="xref">Section 4</a>.<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<div id="ace-group">
<section id="section-4.1.1">
          <h4 id="name-ace-group">
<a href="#section-4.1.1" class="section-number selfRef">4.1.1. </a><a href="#name-ace-group" class="section-name selfRef">ace-group</a>
          </h4>
<p id="section-4.1.1-1">No handlers are implemented for this resource.<a href="#section-4.1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ace-groupgroupname">
<section id="section-4.1.2">
          <h4 id="name-ace-group-groupname">
<a href="#section-4.1.2" class="section-number selfRef">4.1.2. </a><a href="#name-ace-group-groupname" class="section-name selfRef">ace-group/GROUPNAME</a>
          </h4>
<p id="section-4.1.2-1">This resource implements GET and POST handlers.<a href="#section-4.1.2-1" class="pilcrow">¶</a></p>
<div id="gid-post">
<section id="section-4.1.2.1">
            <h5 id="name-post-handler">
<a href="#section-4.1.2.1" class="section-number selfRef">4.1.2.1. </a><a href="#name-post-handler" class="section-name selfRef">POST Handler</a>
            </h5>
<p id="section-4.1.2.1-1">The POST handler adds the public key of the client to the list of the group members' public keys and returns the symmetric group keying material for the group identified by "GROUPNAME".<a href="#section-4.1.2.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1.2.1-2">The handler expects a request with payload formatted as a CBOR map which MAY contain the following fields, which, if included, MUST have the corresponding values:<a href="#section-4.1.2.1-2" class="pilcrow">¶</a></p>
<ul>
<li id="section-4.1.2.1-3.1">'scope', with value the specific resource that the Client is authorized to access, i.e. group or topic identifier, and role(s). This value is a CBOR byte string encoding one scope entry, as defined in <a href="#ssec-authorization-request" class="xref">Section 3.1</a>.<a href="#section-4.1.2.1-3.1" class="pilcrow">¶</a>
</li>
<li id="section-4.1.2.1-3.2">'get_pub_keys', if the Client wishes to receive the public keys of the other nodes in the group from the KDC. The value is an empty CBOR array. This parameter may be present if the KDC stores the public keys of the nodes in the group and distributes them to the Client; it is useless to have here if the set of public keys of the members of the group is known in another way, e.g. it was provided by the AS.<a href="#section-4.1.2.1-3.2" class="pilcrow">¶</a>
</li>
<li id="section-4.1.2.1-3.3">'client_cred', with value the public key or certificate of the Client, encoded as a CBOR byte string. This field contains the public key of the Client. This field is used if the KDC is managing (collecting from/distributing to the Client) the public keys of the group members, and if the Client's role in the group will require for it to send messages to the group. The default encoding for public keys is COSE Keys. Alternative specific encodings of this parameter MAY be defined in applications of this specification (OPT1).<a href="#section-4.1.2.1-3.3" class="pilcrow">¶</a>
</li>
<li id="section-4.1.2.1-3.4">'cnonce', with the same encoding as defined for the "cnonce" parameter of Ace, in Section 5.1.2 of <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>, and including a dedicated nonce N_C generated by the Client. This parameter MUST be present if the 'client_cred' parameter is present.<a href="#section-4.1.2.1-3.4" class="pilcrow">¶</a>
</li>
<li id="section-4.1.2.1-3.5">
                <p id="section-4.1.2.1-3.5.1">'client_cred_verify', encoded as a CBOR byte string. This parameter MUST be present if the 'client_cred' parameter is present and no public key associated to the client's token can be retrieved for that group. This parameter contains a signature computed by the Client over the scope concatenated with N_S concatenated with N_C, where:<a href="#section-4.1.2.1-3.5.1" class="pilcrow">¶</a></p>
<ul>
<li id="section-4.1.2.1-3.5.2.1">scope is the byte string specified in the 'scope parameter above'.<a href="#section-4.1.2.1-3.5.2.1" class="pilcrow">¶</a>
</li>
<li id="section-4.1.2.1-3.5.2.2">N_S is the challenge received from the KDC in the 'kdcchallenge' parameter of the 2.01 (Created) response to the token POST request (see <a href="#token-post" class="xref">Section 3.3</a>).<a href="#section-4.1.2.1-3.5.2.2" class="pilcrow">¶</a>
</li>
<li id="section-4.1.2.1-3.5.2.3">N_C is the nonce generated by the Client and specified in the 'cnonce' parameter above.<a href="#section-4.1.2.1-3.5.2.3" class="pilcrow">¶</a>
</li>
</ul>
</li>
</ul>
<p id="section-4.1.2.1-4">If the token is not being posted (e.g. if it is used directly to validate TLS instead), it is REQUIRED of the specific profile to define how the challenge N_S is generated (REQ17). The Client computes the signature by using its own private key, whose corresponding public key is either directly specified in the 'client_cred' parameter or included in the certificate specified in the 'client_cred' parameter.<a href="#section-4.1.2.1-4" class="pilcrow">¶</a></p>
<ul>
<li id="section-4.1.2.1-5.1">'pub_keys_repos', can be present if a certificate is present in the 'client_cred' field, with value the URI of the certificate of the Client. This parameter is encoded as a CBOR text string. Alternative specific encodings of this parameter MAY be defined in applications of this specification (OPT3).<a href="#section-4.1.2.1-5.1" class="pilcrow">¶</a>
</li>
<li id="section-4.1.2.1-5.2">'control_path', with value a full URI, encoded as a CBOR text string. If 'control_path' is supported by the Client, the Client acts as a CoAP server and hosts a resource at this specific URI. The KDC MAY use this URI to send CoAP requests to the Client (acting as CoAP server in this exchange), for example for individual provisioning of new keying material when performing a group rekeying (see <a href="#update-keys" class="xref">Section 4.3</a>), or to inform the Client of its removal from the group <a href="#sec-node-removal" class="xref">Section 5</a>. If the KDC does not implement mechanisms using this resource, it can just ignore this parameter. Other additional functionalities of this resource MAY be defined in application profiles of this specifications (OPT9). In particular, this resource is intended for communications concerning exclusively the group or topic specified in the 'scope' parameter.<a href="#section-4.1.2.1-5.2" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-4.1.2.1-6">The handler verifies that the group identifier of the /ace-group/GROUPNAME path is a subset of the 'scope' stored in the access token associated to this client. If verification fails, the KDC MUST respond with a 4.01 (Unauthorized) error message. The KDC MAY set the payload with the 'sign_info' and 'pub_key_enc' parameter, formatted as 'sign_info_res' and 'pub_key_enc_res' in the payload of the 2.01 (Created) response to the Token Post as defined in <a href="#token-post" class="xref">Section 3.3</a>. Note that in this case, the content format MUST be set to application/ace+cbor.<a href="#section-4.1.2.1-6" class="pilcrow">¶</a></p>
<p id="section-4.1.2.1-7">If the request is not formatted correctly (e.g. unknown, not-expected fields present, or expected fields with incorrect format), the handler MUST respond with a 4.00 (Bad Request) error message. The response MAY contain a CBOR map in the payload with ace+cbor format, e.g. it could send back "pub_key_enc" set to Null if the Client sent its own public key and the KDC is not set to store public keys of the group members. Application profiles MAY define optional or mandatory payload formats for specific error cases (OPT6).<a href="#section-4.1.2.1-7" class="pilcrow">¶</a></p>
<p id="section-4.1.2.1-8">If the KDC stores the group members' public keys, the handler checks if one public key is already associated to the access token received (see <a href="#ssec-key-distribution-exchange" class="xref">Section 4.2</a> for an example) and to the group identified by "GROUPNAME". If that is not the case, it retrieves it from the 'client_cred' field and associates it to the access token received, after verifications succed. In particular, the KDC verifies:<a href="#section-4.1.2.1-8" class="pilcrow">¶</a></p>
<ul>
<li id="section-4.1.2.1-9.1">that such public key has an acceptable format for the group identified by "GROUPNAME", i.e. it is encoded as expected and is compatible with the signature algorithm and possible associated parameters. If that cannot be verified, it is RECOMMENDED that the handler stops the process and responds with a 4.00 (Bad Request) error message. Applications profiles MAY define alternatives (OPT5).<a href="#section-4.1.2.1-9.1" class="pilcrow">¶</a>
</li>
<li id="section-4.1.2.1-9.2">that the signature contained in "client_cred_verify" passes verification. If that cannot be verified, the handler MUST respond with a 4.00 (Bad Request) error message, and if the token was posted (see REQ17) including the 'kdcchallenge' associated to this Client (see <a href="#token-post" class="xref">Section 3.3</a>) if it can be retrieved, or otherwise newly generated, in a CBOR map in the payload. This error response MUST also have Content-Format "application/ace+cbor".<a href="#section-4.1.2.1-9.2" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-4.1.2.1-10">If one public key is already associated to the access token and to that group, but the 'client_cred' is populated with a different public key, the handler MUST delete the previous one and replace it with this one, after verifying the points above.<a href="#section-4.1.2.1-10" class="pilcrow">¶</a></p>
<p id="section-4.1.2.1-11">If the token was posted but the KDC cannot retrieve the 'kdcchallenge' associated to this Client (see <a href="#token-post" class="xref">Section 3.3</a>), the KDC MUST respond with a 4.00 Bad Request error response, including a newly generated 'kdcchallenge' in a CBOR map in the payload. This error response MUST also have Content-Format "application/ace+cbor".<a href="#section-4.1.2.1-11" class="pilcrow">¶</a></p>
<p id="section-4.1.2.1-12">If all verifications succeed, the handler:<a href="#section-4.1.2.1-12" class="pilcrow">¶</a></p>
<ul>
<li id="section-4.1.2.1-13.1">Adds the node to the list of current members of the group.<a href="#section-4.1.2.1-13.1" class="pilcrow">¶</a>
</li>
<li id="section-4.1.2.1-13.2">Assigns a name NODENAME to the node, and creates a sub-resource to /ace-group/GROUPNAME/ at the KDC (e.g. "/ace-group/GROUPNAME/nodes/NODENAME").<a href="#section-4.1.2.1-13.2" class="pilcrow">¶</a>
</li>
<li id="section-4.1.2.1-13.3">Associates the identifier "NODENAME" with the access token and the secure session for that node.<a href="#section-4.1.2.1-13.3" class="pilcrow">¶</a>
</li>
<li id="section-4.1.2.1-13.4">
                <p id="section-4.1.2.1-13.4.1">If the KDC manages public keys for group members:<a href="#section-4.1.2.1-13.4.1" class="pilcrow">¶</a></p>
<ul>
<li id="section-4.1.2.1-13.4.2.1">Adds the retrieved public key of the node to the list of public keys stored for the group identified by "GROUPNAME"<a href="#section-4.1.2.1-13.4.2.1" class="pilcrow">¶</a>
</li>
<li id="section-4.1.2.1-13.4.2.2">Associates the node's public key with its access token and the group identified by "GROUPNAME", if such association did not already exist.<a href="#section-4.1.2.1-13.4.2.2" class="pilcrow">¶</a>
</li>
</ul>
</li>
<li id="section-4.1.2.1-13.5">Returns a 2.01 (Created) message containing the symmetric group keying material, the group policies and all the public keys of the current members of the group, if the KDC manages those and the Client requested them.<a href="#section-4.1.2.1-13.5" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-4.1.2.1-14">The response message also contains the URI path to the sub-resource created for that node in a Location-Path CoAP option. The payload of the response is formatted as a CBOR map which MUST contain the following fields and values:<a href="#section-4.1.2.1-14" class="pilcrow">¶</a></p>
<ul>
<li id="section-4.1.2.1-15.1">'gkty', identifying the key type of the 'key' parameter. The set of values can be found in the "Key Type" column of the "ACE Groupcomm Key" Registry. Implementations MUST verify that the key type matches the application profile being used, if present, as registered in the "ACE Groupcomm Key" registry.<a href="#section-4.1.2.1-15.1" class="pilcrow">¶</a>
</li>
<li id="section-4.1.2.1-15.2">'key', containing the keying material for the group communication, or information required to derive it.<a href="#section-4.1.2.1-15.2" class="pilcrow">¶</a>
</li>
<li id="section-4.1.2.1-15.3">'num', containing the version number of the keying material for the group communication, formatted as an integer. The initial version MUST be set to 0 at the KDC. This is a strictly monotonic increasing field.<a href="#section-4.1.2.1-15.3" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-4.1.2.1-16">The exact format of the 'key' value MUST be defined in applications of this specification (REQ7), as well as accepted values of 'gkty' by the application (REQ8). Additionally, documents specifying the key format MUST register it in the "ACE Groupcomm Key" registry defined in <a href="#iana-key" class="xref">Section 8.5</a>, including its name, type and application profile to be used with.<a href="#section-4.1.2.1-16" class="pilcrow">¶</a></p>
<span id="name-key-type-values"></span><div id="gkty">
<figure id="figure-5">
              <div class="artwork art-text alignCenter" id="section-4.1.2.1-17.1">
<pre>
+----------+----------------+---------+-------------------------+
| Name     | Key Type Value | Profile | Description             |
+----------+----------------+---------+-------------------------+
| Reserved | 0              |         | This value is reserved  |
+----------+----------------+---------+-------------------------+
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-key-type-values" class="selfRef">Key Type Values</a>
              </figcaption></figure>
</div>
<p id="section-4.1.2.1-18">Optionally, the response MAY contain the following parameters, which, if included, MUST have the corresponding values:<a href="#section-4.1.2.1-18" class="pilcrow">¶</a></p>
<ul>
<li id="section-4.1.2.1-19.1">'ace-groupcomm-profile', with value a CBOR integer that MUST be used to uniquely identify the application profile for group communication. Applications of this specification MUST register an application profile identifier and the related value for this parameter in the "ACE Groupcomm Profile" Registry (REQ12).<a href="#section-4.1.2.1-19.1" class="pilcrow">¶</a>
</li>
<li id="section-4.1.2.1-19.2">'exp', with value the expiration time of the keying material for the group communication, encoded as a CBOR unsigned integer. This field contains a numeric value representing the number of seconds from 1970-01-01T00:00:00Z UTC until the specified UTC date/time, ignoring leap seconds, analogous to what specified for NumericDate in Section 2 of <span>[<a href="#RFC7519" class="xref">RFC7519</a>]</span>. Group members MUST stop using the keying material to protect outgoing messages and retrieve new keying material at the time indicated in this field.<a href="#section-4.1.2.1-19.2" class="pilcrow">¶</a>
</li>
<li id="section-4.1.2.1-19.3">'exp_delta', with value the time interval (starting at 'exp') during which the keying material for the group communication can still be used for verifying incoming messages, encoded as a CBOR unsigned integer. This field contains a numeric value representing the number of seconds from 'exp' until the specified UTC date/time after which group members MUST stop using the keying material to verify incoming messages.<a href="#section-4.1.2.1-19.3" class="pilcrow">¶</a>
</li>
<li id="section-4.1.2.1-19.4">'pub_keys', may only be present if 'get_pub_keys' was present in the request. This parameter is a CBOR byte string, which encodes the public keys of all the group members paired with the respective member identifiers. The default encoding for public keys is COSE Keys, so the default encoding for 'pub_keys' is a CBOR byte string wrapping a COSE_KeySet (see <span>[<a href="#RFC8152" class="xref">RFC8152</a>]</span>), which contains the public keys of all the members of the group. In particular, each COSE Key in the COSE_KeySet includes the identifier of the corresponding group member as value of its 'kid' key parameter. Alternative specific encodings of this parameter MAY be defined in applications of this specification (OPT1). The specific format of the identifiers of group members MUST be specified in the application profile (REQ9).<a href="#section-4.1.2.1-19.4" class="pilcrow">¶</a>
</li>
<li id="section-4.1.2.1-19.5">'peer_roles', MUST be present if 'pub_keys' is present. This parameter is a CBOR array of n elements, with n the number of members in the group (and number of public keys included in the 'pub_keys' parameter). The i-th element of the array specifies the role (or CBOR array of roles) that the group member associated to the i-th public key in 'pub_keys' has in the group. In particular, each array element is encoded as the role element of a scope entry, as defined in <a href="#ssec-authorization-request" class="xref">Section 3.1</a>.<a href="#section-4.1.2.1-19.5" class="pilcrow">¶</a>
</li>
<li id="section-4.1.2.1-19.6">'group_policies', with value a CBOR map, whose entries specify how the group handles specific management aspects. These include, for instance, approaches to achieve synchronization of sequence numbers among group members. The elements of this field are registered in the "ACE Groupcomm Policy" Registry. This specification defines the two elements "Sequence Number Synchronization Method" and "Key Update Check Interval", which are summarized in <a href="#fig-ACE-Groupcomm-Policies" class="xref">Figure 6</a>. Application profiles that build on this document MUST specify the exact content format of included map entries (REQ14).<a href="#section-4.1.2.1-19.6" class="pilcrow">¶</a>
</li>
</ul>
<span id="name-ace-groupcomm-policies"></span><div id="fig-ACE-Groupcomm-Policies">
<figure id="figure-6">
              <div class="artwork art-text alignCenter" id="section-4.1.2.1-20.1">
<pre>
+--------------+-------+----------|--------------------|------------+
|      Name    | CBOR  |   CBOR   |    Description     | Reference  |
|              | label |   type   |                    |            |
|--------------+-------+----------|--------------------|------------|
| Sequence     | TBD1  | tstr/int | Method for a re-   | [[this     |
| Number       |       |          | cipient node to    | document]] |
| Synchroniza- |       |          | synchronize with   |            |
| tion Method  |       |          | sequence numbers   |            |
|              |       |          | of a sender node.  |            |
|              |       |          | Its value is taken |            |
|              |       |          | from the 'Value'   |            |
|              |       |          | column of the      |            |
|              |       |          | Sequence Number    |            |
|              |       |          | Synchronization    |            |
|              |       |          | Method registry    |            |
|              |       |          |                    |            |
| Key Update   | TBD2  |   int    | Polling interval   | [[this     |
| Check        |       |          | in seconds, to     | document]] |
| Interval     |       |          | check for new      |            |
|              |       |          | keying material at |            |
|              |       |          | the KDC            |            |
+--------------+-------+----------|--------------------|------------+
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-ace-groupcomm-policies" class="selfRef">ACE Groupcomm Policies</a>
              </figcaption></figure>
</div>
<ul>
<li id="section-4.1.2.1-21.1">'mgt_key_material', encoded as a CBOR byte string and containing the administrative keying material to participate in the group rekeying performed by the KDC. The application profile MUST define if this field is used, and if used then MUST specify the exact format and content which depend on the specific rekeying scheme used in the group. If the usage of 'mgt_key_material' is indicated and its format defined for a specific key management scheme, that format must explicitly indicate the key management scheme itself. If a new rekeying scheme is defined to be used for an existing 'mgt_key_material' in an existing profile, then that profile will have to be updated accordingly, especially with respect to the usage of 'mgt_key_material' related format and content (REQ18).<a href="#section-4.1.2.1-21.1" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-4.1.2.1-22">Specific application profiles that build on this document MUST specify the communication protocol that members of the group use to communicate with each other (REQ10) and how exactly the keying material is used to protect the group communication (REQ11).<a href="#section-4.1.2.1-22" class="pilcrow">¶</a></p>
<p id="section-4.1.2.1-23">CBOR labels for these fields are defined in <a href="#params" class="xref">Section 6</a>.<a href="#section-4.1.2.1-23" class="pilcrow">¶</a></p>
</section>
</div>
<div id="gid-get">
<section id="section-4.1.2.2">
            <h5 id="name-get-handler">
<a href="#section-4.1.2.2" class="section-number selfRef">4.1.2.2. </a><a href="#name-get-handler" class="section-name selfRef">GET Handler</a>
            </h5>
<p id="section-4.1.2.2-1">The GET handler returns the symmetric group keying material for the group identified by "GROUPNAME".<a href="#section-4.1.2.2-1" class="pilcrow">¶</a></p>
<p id="section-4.1.2.2-2">The handler expects a GET request.<a href="#section-4.1.2.2-2" class="pilcrow">¶</a></p>
<p id="section-4.1.2.2-3">The handler verifies that the group identifier of the /ace-group/GROUPNAME path is a subset of the 'scope' stored in the access token associated to this client. If verification fails, the KDC MUST respond with a 4.01 (Unauthorized) error message. The KDC MAY set the payload with the 'sign_info' and 'pub_key_enc' parameter, formatted as 'sign_info_res' and 'pub_key_enc_res' in the payload of the 2.01 (Created) response to the Token Post as defined in <a href="#token-post" class="xref">Section 3.3</a>. Note that in this case, the content format MUST be set to application/ace+cbor.<a href="#section-4.1.2.2-3" class="pilcrow">¶</a></p>
<p id="section-4.1.2.2-4">Additionally, the handler verifies that the node is a current member of the group. If verification fails, the KDC MUST respond with a 4.00 (Bad Request) error message.<a href="#section-4.1.2.2-4" class="pilcrow">¶</a></p>
<p id="section-4.1.2.2-5">If verification succeeds, the handler returns a 2.05 (Content) message containing the symmetric group keying material. The payload of the response is formatted as a CBOR map which MUST contain the parameters 'gkty','key' and 'num' specified in <a href="#gid-post" class="xref">Section 4.1.2.1</a>.<a href="#section-4.1.2.2-5" class="pilcrow">¶</a></p>
<p id="section-4.1.2.2-6">The payload MAY also include the parameters 'ace-groupcomm-profile', 'exp', 'exp_delta' and 'mgt_key_material' parameters specified in <a href="#gid-post" class="xref">Section 4.1.2.1</a>.<a href="#section-4.1.2.2-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="ace-groupgroupnamepub-key">
<section id="section-4.1.3">
          <h4 id="name-ace-group-groupname-pub-key">
<a href="#section-4.1.3" class="section-number selfRef">4.1.3. </a><a href="#name-ace-group-groupname-pub-key" class="section-name selfRef">ace-group/GROUPNAME/pub-key</a>
          </h4>
<p id="section-4.1.3-1">This resource implements GET and FETCH handlers.<a href="#section-4.1.3-1" class="pilcrow">¶</a></p>
<div id="pubkey-fetch">
<section id="section-4.1.3.1">
            <h5 id="name-fetch-handler">
<a href="#section-4.1.3.1" class="section-number selfRef">4.1.3.1. </a><a href="#name-fetch-handler" class="section-name selfRef">FETCH Handler</a>
            </h5>
<p id="section-4.1.3.1-1">The FETCH handler receives identifiers of group members for the group identified by "GROUPNAME" and returns the public keys of such group members.<a href="#section-4.1.3.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1.3.1-2">The handler expects a request with payload formatted as a CBOR map. The payload of this request is a CBOR Map that MUST contain the following fields:<a href="#section-4.1.3.1-2" class="pilcrow">¶</a></p>
<ul>
<li id="section-4.1.3.1-3.1">
                <p id="section-4.1.3.1-3.1.1">'get_pub_keys', whose value is a non-empty CBOR array containing two CBOR arrays:<a href="#section-4.1.3.1-3.1.1" class="pilcrow">¶</a></p>
<ul>
<li id="section-4.1.3.1-3.1.2.1">The first array contains zero or more roles (or combination of roles) of group members for the group identified by "GROUPNAME".<a href="#section-4.1.3.1-3.1.2.1" class="pilcrow">¶</a>
</li>
<li id="section-4.1.3.1-3.1.2.2">The second array contains zero or more identifiers of group members for the group identified by "GROUPNAME".<a href="#section-4.1.3.1-3.1.2.2" class="pilcrow">¶</a>
</li>
</ul>
</li>
</ul>
<p id="section-4.1.3.1-4">The CDDL definition of 'get_pub_keys' is given in <a href="#cddl-ex-getpubkeys" class="xref">Figure 7</a> using as example encoding: node identifier encoded as byte string, role identifier as text string, and combination of roles encoded as a CBOR array of roles. Note that the empty array is not valid for this handler, but is valid for the value of "get_pub_keys" received by the handler of POST to ace-group/GROUPNAME (see <a href="#gid-post" class="xref">Section 4.1.2.1</a>).<a href="#section-4.1.3.1-4" class="pilcrow">¶</a></p>
<span id="name-cdll-definition-of-get_pub_"></span><div id="cddl-ex-getpubkeys">
<figure id="figure-7">
              <div class="artwork art-text alignCenter art-CDDL" id="section-4.1.3.1-5.1">
<pre>
id = bstr

role = tstr

comb_role = [ 2*role ]

get_pub_keys = [ [ *(role / comb_role) ], [ *id ] ] / [ ]
</pre>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-cdll-definition-of-get_pub_" class="selfRef">CDLL definition of get_pub_keys, using as example node identifier encoded as bstr and role as tstr</a>
              </figcaption></figure>
</div>
<p id="section-4.1.3.1-6">The specific format of public keys as well as identifiers, roles and combination of roles of group members MUST be specified by the application profile (OPT1, REQ2, REQ9).<a href="#section-4.1.3.1-6" class="pilcrow">¶</a></p>
<p id="section-4.1.3.1-7">The handler verifies that the group identifier of the /ace-group/GROUPNAME path is a subset of the 'scope' stored in the access token associated to this client. If verification fails, the KDC MUST respond with a 4.01 (Unauthorized) error message.<a href="#section-4.1.3.1-7" class="pilcrow">¶</a></p>
<p id="section-4.1.3.1-8">If verification succeeds, the handler identifies the public keys of the current group members for which either:
  - the role identifier matches with one of those indicated in the request (including the exact combination of roles requested), or
  - the identifier matches with one of those indicated in the request.<a href="#section-4.1.3.1-8" class="pilcrow">¶</a></p>
<p id="section-4.1.3.1-9">Then, the handler returns a 2.05 (Content) message response with payload formatted as a CBOR map, containing only the 'pub_keys' and 'peer_roles' parameters from <a href="#gid-post" class="xref">Section 4.1.2.1</a>. In particular, 'pub_keys' encodes the list of public keys of those group members including the respective member identifiers, while 'peer_roles' encodes their respective role (or CBOR array of roles) in the group.<a href="#section-4.1.3.1-9" class="pilcrow">¶</a></p>
<p id="section-4.1.3.1-10">If the KDC does not store any public key associated with the specified member identifiers, the handler returns a response with payload formatted as a CBOR byte string of zero length. The specific format of public keys as well as of identifiers of group members is specified by the application profile (OPT1, REQ9).<a href="#section-4.1.3.1-10" class="pilcrow">¶</a></p>
<p id="section-4.1.3.1-11">The handler MAY enforce one of the following policies, in order to handle possible identifiers that are included in the 'get_pub_keys' parameter of the request but are not associated to any current group member. Such a policy MUST be specified by the application profile (REQ13)<a href="#section-4.1.3.1-11" class="pilcrow">¶</a></p>
<ul>
<li id="section-4.1.3.1-12.1">The KDC silently ignores those identifiers.<a href="#section-4.1.3.1-12.1" class="pilcrow">¶</a>
</li>
<li id="section-4.1.3.1-12.2">The KDC retains public keys of group members for a given amount of time after their leaving, before discarding them. As long as such public keys are retained, the KDC provides them to a requesting Client.<a href="#section-4.1.3.1-12.2" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-4.1.3.1-13">Note that this resource handlers only verify that the node is authorized by the AS to access this resource. Nodes that are not members of the group but are authorized to do signature verifications on the group messages may be allowed to access this resource, if the application needs it.<a href="#section-4.1.3.1-13" class="pilcrow">¶</a></p>
</section>
</div>
<div id="pubkey-get">
<section id="section-4.1.3.2">
            <h5 id="name-get-handler-2">
<a href="#section-4.1.3.2" class="section-number selfRef">4.1.3.2. </a><a href="#name-get-handler-2" class="section-name selfRef">GET Handler</a>
            </h5>
<p id="section-4.1.3.2-1">The handler expects a GET request.<a href="#section-4.1.3.2-1" class="pilcrow">¶</a></p>
<p id="section-4.1.3.2-2">The handler verifies that the group identifier of the /ace-group/GROUPNAME path is a subset of the 'scope' stored in the access token associated to this client. If verification fails, the KDC MUST respond with a 4.01 (Unauthorized) error message.<a href="#section-4.1.3.2-2" class="pilcrow">¶</a></p>
<p id="section-4.1.3.2-3">If verification succeeds, the handler returns a 2.05 (Content) message containing the public keys of all the current group members, for the group identified by "GROUPNAME". The payload of the response is formatted as a CBOR map, containing only the 'pub_keys' and 'peer_roles' parameters from <a href="#gid-post" class="xref">Section 4.1.2.1</a>. In particular, 'pub_keys' encodes the list of public keys of those group members including the respective member identifiers, while 'peer_roles' encodes their respective role (or CBOR array of roles) in the group.<a href="#section-4.1.3.2-3" class="pilcrow">¶</a></p>
<p id="section-4.1.3.2-4">If the KDC does not store any public key for the group, the handler returns a response with payload formatted as a CBOR byte string of zero length. The specific format of public keys as well as of identifiers of group members is specified by the application profile (OPT1, REQ9).<a href="#section-4.1.3.2-4" class="pilcrow">¶</a></p>
<p id="section-4.1.3.2-5">Note that this resource handlers only verify that the node is authorized by the AS to access this resource. Nodes that are not members of the group but are authorized to do signature verifications on the group messages may be allowed to access this resource, if the application needs it.<a href="#section-4.1.3.2-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="ace-groupgroupnamepolicies">
<section id="section-4.1.4">
          <h4 id="name-ace-group-groupname-policie">
<a href="#section-4.1.4" class="section-number selfRef">4.1.4. </a><a href="#name-ace-group-groupname-policie" class="section-name selfRef">ace-group/GROUPNAME/policies</a>
          </h4>
<p id="section-4.1.4-1">This resource implements a GET handler.<a href="#section-4.1.4-1" class="pilcrow">¶</a></p>
<div id="policies-get">
<section id="section-4.1.4.1">
            <h5 id="name-get-handler-3">
<a href="#section-4.1.4.1" class="section-number selfRef">4.1.4.1. </a><a href="#name-get-handler-3" class="section-name selfRef">GET Handler</a>
            </h5>
<p id="section-4.1.4.1-1">The handler expects a GET request.<a href="#section-4.1.4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1.4.1-2">The handler verifies that the group identifier of the /ace-group/GROUPNAME path is a subset of the 'scope' stored in the access token associated to this client. If verification fails, the KDC MUST respond with a 4.01 (Unauthorized) error message.<a href="#section-4.1.4.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1.4.1-3">Additionally, the handler verifies that the node is a current member of the group. If verification fails, the KDC MUST respond with a 4.00 (Bad Request) error message.<a href="#section-4.1.4.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1.4.1-4">If verification succeeds, the handler returns a 2.05 (Content) message containing the list of policies for the group identified by "GROUPNAME". The payload of the response is formatted as a CBOR map including only the parameter 'group_policies' defined in <a href="#gid-post" class="xref">Section 4.1.2.1</a> and specifying the current policies in the group. If the KDC does not store any policy, the payload is formatted as a zero-length CBOR byte string.<a href="#section-4.1.4.1-4" class="pilcrow">¶</a></p>
<p id="section-4.1.4.1-5">The specific format and meaning of group policies MUST be specified in the application profile (REQ14).<a href="#section-4.1.4.1-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="ace-groupgroupnamectx-num">
<section id="section-4.1.5">
          <h4 id="name-ace-group-groupname-ctx-num">
<a href="#section-4.1.5" class="section-number selfRef">4.1.5. </a><a href="#name-ace-group-groupname-ctx-num" class="section-name selfRef">ace-group/GROUPNAME/ctx-num</a>
          </h4>
<p id="section-4.1.5-1">This resource implements a GET handler.<a href="#section-4.1.5-1" class="pilcrow">¶</a></p>
<div id="num-get">
<section id="section-4.1.5.1">
            <h5 id="name-get-handler-4">
<a href="#section-4.1.5.1" class="section-number selfRef">4.1.5.1. </a><a href="#name-get-handler-4" class="section-name selfRef">GET Handler</a>
            </h5>
<p id="section-4.1.5.1-1">The handler expects a GET request.<a href="#section-4.1.5.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1.5.1-2">The handler verifies that the group identifier of the /ace-group/GROUPNAME path is a subset of the 'scope' stored in the access token associated to this client. If verification fails, the KDC MUST respond with a 4.01 (Unauthorized) error message.<a href="#section-4.1.5.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1.5.1-3">Additionally, the handler verifies that the node is a current member of the group. If verification fails, the KDC MUST respond with a 4.00 (Bad Request) error message.<a href="#section-4.1.5.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1.5.1-4">If verification succeeds, the handler returns a 2.05 (Content) message containing an integer that represents the version number of the symmetric group keying material. This number is incremented on the KDC every time the KDC updates the symmetric group keying material. The payload of the response is formatted as a CBOR integer.<a href="#section-4.1.5.1-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="ace-groupgroupnamenodesnodename">
<section id="section-4.1.6">
          <h4 id="name-ace-group-groupname-nodes-n">
<a href="#section-4.1.6" class="section-number selfRef">4.1.6. </a><a href="#name-ace-group-groupname-nodes-n" class="section-name selfRef">ace-group/GROUPNAME/nodes/NODENAME</a>
          </h4>
<p id="section-4.1.6-1">This resource implements GET, PUT and DELETE handlers.<a href="#section-4.1.6-1" class="pilcrow">¶</a></p>
<div id="node-put">
<section id="section-4.1.6.1">
            <h5 id="name-put-handler">
<a href="#section-4.1.6.1" class="section-number selfRef">4.1.6.1. </a><a href="#name-put-handler" class="section-name selfRef">PUT Handler</a>
            </h5>
<p id="section-4.1.6.1-1">The PUT handler is used to get the KDC to produce and return individual keying material to protect outgoing messages for the node (identified by "NODENAME") for the group identified by "GROUPNAME".<a href="#section-4.1.6.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1.6.1-2">The handler expects a request with empty payload.<a href="#section-4.1.6.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1.6.1-3">The handler verifies that the group identifier of the /ace-group/GROUPNAME path is a subset of the 'scope' stored in the access token associated to this client, identified by "NODENAME". If verification fails, the KDC MUST respond with a 4.01 (Unauthorized) error message.<a href="#section-4.1.6.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1.6.1-4">Additionally, the handler verifies that the node is a current member of the group. If verification fails, the KDC MUST respond with a 4.00 (Bad Request) error message.<a href="#section-4.1.6.1-4" class="pilcrow">¶</a></p>
<p id="section-4.1.6.1-5">If verification succeeds, the handler returns a 2.05 (Content) message containing newly-generated individual keying material for the Client, or information enabling the Client to derive it. The payload of the response is formatted as a CBOR map. The specific format of newly-generated individual keying material for group members, or of the information to derive it, and corresponding CBOR label, MUST be specified in the application profile (REQ15) and registered in <a href="#iana-reg" class="xref">Section 8.4</a>.<a href="#section-4.1.6.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="node-get">
<section id="section-4.1.6.2">
            <h5 id="name-get-handler-5">
<a href="#section-4.1.6.2" class="section-number selfRef">4.1.6.2. </a><a href="#name-get-handler-5" class="section-name selfRef">GET Handler</a>
            </h5>
<p id="section-4.1.6.2-1">The handler expects a GET request.<a href="#section-4.1.6.2-1" class="pilcrow">¶</a></p>
<p id="section-4.1.6.2-2">The handler verifies that the group identifier of the /ace-group/GROUPNAME path is a subset of the 'scope' stored in the access token associated to this client, identified by "NODENAME". If verification fails, the KDC MUST respond with a 4.01 (Unauthorized) error message.<a href="#section-4.1.6.2-2" class="pilcrow">¶</a></p>
<p id="section-4.1.6.2-3">The handler also verifies that the node sending the request and the node name used in the Uri-Path match. If that is not the case, the handler responds with a 4.01 (Unauthorized) error response.<a href="#section-4.1.6.2-3" class="pilcrow">¶</a></p>
<p id="section-4.1.6.2-4">Additionally, the handler verifies that the node is a current member of the group. If verification fails, the KDC MUST respond with a 4.00 (Bad Request) error message.<a href="#section-4.1.6.2-4" class="pilcrow">¶</a></p>
<p id="section-4.1.6.2-5">If verification succeeds, the handler returns a 2.05 (Content) message containing both the group keying material and the individual keying material for the Client, or information enabling the Client to derive it. The payload of the response is formatted as a CBOR map. The format for the group keying material is the same as defined in the response of <a href="#gid-get" class="xref">Section 4.1.2.2</a>. The specific format of individual keying material for group members, or of the information to derive it, and corresponding CBOR label, MUST be specified in the application profile (REQ15) and registered in <a href="#iana-reg" class="xref">Section 8.4</a>.<a href="#section-4.1.6.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="node-delete">
<section id="section-4.1.6.3">
            <h5 id="name-delete-handler">
<a href="#section-4.1.6.3" class="section-number selfRef">4.1.6.3. </a><a href="#name-delete-handler" class="section-name selfRef">DELETE Handler</a>
            </h5>
<p id="section-4.1.6.3-1">The DELETE handler removes the node identified by "NODENAME" from the group identified by "GROUPNAME".<a href="#section-4.1.6.3-1" class="pilcrow">¶</a></p>
<p id="section-4.1.6.3-2">The handler expects a request with method DELETE (and empty payload).<a href="#section-4.1.6.3-2" class="pilcrow">¶</a></p>
<p id="section-4.1.6.3-3">The handler only accept a request from the node that matches the "NODENAME" used in Uri-Path, and that is part of the "GROUPNAME" group: the handler verifies that the group identifier "GROUPNAME" is a subset of the 'scope' stored in the access token associated to this client, and that this client is identified by "NODENAME". If verification fails, the KDC MUST respond with a 4.01 (Unauthorized) error message.<a href="#section-4.1.6.3-3" class="pilcrow">¶</a></p>
<p id="section-4.1.6.3-4">The handler also verifies that the node sending the request and the node name used in the Uri-Path match. If that is not the case, the handler responds with a 4.01 (Unauthorized) error response.<a href="#section-4.1.6.3-4" class="pilcrow">¶</a></p>
<p id="section-4.1.6.3-5">Additionally, the handler verifies that the node is a current member of the group. If verification fails, the KDC MUST respond with a 4.00 (Bad Request) error message.<a href="#section-4.1.6.3-5" class="pilcrow">¶</a></p>
<p id="section-4.1.6.3-6">If verification succeeds, the handler removes the client from the group identified by "GROUPNAME", for specific roles if roles were specified in the 'scope' field, or for all roles. That includes removing the public key of the client if the KDC keep tracks of that. Then, the handler delete the sub-resource nodes/NODENAME and returns a 2.02 (Deleted) message with empty payload.<a href="#section-4.1.6.3-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="ace-groupgroupnamenodesnodenamepub-key">
<section id="section-4.1.7">
          <h4 id="name-ace-group-groupname-nodes-no">
<a href="#section-4.1.7" class="section-number selfRef">4.1.7. </a><a href="#name-ace-group-groupname-nodes-no" class="section-name selfRef">ace-group/GROUPNAME/nodes/NODENAME/pub-key</a>
          </h4>
<p id="section-4.1.7-1">This resource implements a POST handler, if the KDC stores the public key of group members. If the KDC does not store the public keys of group members, the handler does not implement any method, and every request returns a 4.05 Method Not Allowed error.<a href="#section-4.1.7-1" class="pilcrow">¶</a></p>
<div id="node-pub-key-post">
<section id="section-4.1.7.1">
            <h5 id="name-post-handler-2">
<a href="#section-4.1.7.1" class="section-number selfRef">4.1.7.1. </a><a href="#name-post-handler-2" class="section-name selfRef">POST Handler</a>
            </h5>
<p id="section-4.1.7.1-1">The POST handler is used to replace the stored public key of this client (identified by "NODENAME") with the one specified in the request at the KDC, for the group identified by "GROUPNAME".<a href="#section-4.1.7.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1.7.1-2">The handler expects a POST request with payload as specified in <a href="#gid-post" class="xref">Section 4.1.2.1</a>, with the difference that it includes only the parameters 'client_cred', 'cnonce' and 'client_cred_verify'. In particular, the signature included in 'client_cred_verify' is expected to be computed as defined in <a href="#gid-post" class="xref">Section 4.1.2.1</a>, with a newly generated N_C nonce and the previously received N_S. The specific format of public keys is specified by the application profile (OPT1).<a href="#section-4.1.7.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1.7.1-3">The handler verifies that the group identifier GROUPNAME is a subset of the 'scope' stored in the access token associated to this client. If verification fails, the KDC MUST respond with a 4.01 (Unauthorized) error message.<a href="#section-4.1.7.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1.7.1-4">If the request is not formatted correctly (e.g. unknown, not-expected fields present, or expected fields with incorrect format), the handler MUST respond with a 4.00 (Bad Request) error message. Application profiles MAY define optional or mandatory payload formats for specific error cases (OPT6).<a href="#section-4.1.7.1-4" class="pilcrow">¶</a></p>
<p id="section-4.1.7.1-5">Otherwise, the handler checks that the public key specified in the 'client_cred' field has a valid format for the group identified by "GROUPNAME", i.e. it is encoded as expected and is compatible with the signature algorithm and possible associated parameters. If that cannot be verified, the handler MUST respond with a 4.00 (Bad Request) error message. Applications profiles MAY define alternatives (OPT5).<a href="#section-4.1.7.1-5" class="pilcrow">¶</a></p>
<p id="section-4.1.7.1-6">Otherwise, the handler verifies the signature contained in the 'client_cred_verify' field of the request, using the public key specified in the 'client_cred' field. If the signature does not pass verification, the handler MUST respond with a 4.00 (Bad Request) error message. If the KDC cannot retrieve the 'kdcchallenge' associated to this Client (see <a href="#token-post" class="xref">Section 3.3</a>), the KDC MUST respond with a 4.00 Bad Request error respons, including a newly generated 'kdcchallenge' in a CBOR map in the payload the payload. This error response MUST also have Content-Format "application/ace+cbor".<a href="#section-4.1.7.1-6" class="pilcrow">¶</a></p>
<p id="section-4.1.7.1-7">If verification succeeds, the handler replaces the old public key of the node NODENAME with the one specified in the 'client_cred' field of the request, and stores it as the new current public key of the node NODENAME, in the list of group members' public keys for the group identified by GROUPNAME. Then, the handler replies with a 2.04 (Changed) response, which does not include a payload.<a href="#section-4.1.7.1-7" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="ssec-key-distribution-exchange">
<section id="section-4.2">
        <h3 id="name-joining-exchange">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-joining-exchange" class="section-name selfRef">Joining Exchange</a>
        </h3>
<p id="section-4.2-1"><a href="#fig-key-distr-join" class="xref">Figure 8</a> gives an overview of the Joining exchange between Client and KDC, when the Client first joins a group.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<span id="name-message-flow-of-first-excha"></span><div id="fig-key-distr-join">
<figure id="figure-8">
          <div class="artwork art-text alignCenter" id="section-4.2-2.1">
<pre>
Client                                                     KDC
   |                                                        |
   |----- Joining Request: POST /ace-group/GROUPNAME ------&gt;|
   |                                                        |
   |&lt;--------- Joining Response: 2.01 (Created) ----------- |
   | Location-Path = "/ace-group/GROUPNAME/nodes/NODENAME"  |
</pre>
</div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a>:
<a href="#name-message-flow-of-first-excha" class="selfRef">Message Flow of First Exchange for Group Joining</a>
          </figcaption></figure>
</div>
<p id="section-4.2-3">If not previously established, the Client and the KDC MUST first establish a pairwise secure communication channel (REQ16). This can be achieved, for instance, by using a transport profile of ACE. The Joining exchange MUST occur over that secure channel. The Client and the KDC MAY use that same secure channel to protect further pairwise communications that must be secured.<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<p id="section-4.2-4">The secure communication protocol is REQUIRED to establish the secure channel by using the proof-of-possession key bound to the access token. As a result, the proof-of-possession to bind the access token to the Client is performed by using the proof-of-possession key bound to the access token for establishing secure communication between the Client and the KDC.<a href="#section-4.2-4" class="pilcrow">¶</a></p>
<p id="section-4.2-5">To join the group, the Client sends a CoAP POST request to the /ace-group/GROUPNAME endpoint at the KDC, where GROUPNAME is the group identifier of the group to join, formatted as specified in <a href="#gid-post" class="xref">Section 4.1.2.1</a>. This group identifier is the same as the scope entry corresponding to that group, specified in the 'scope' parameter of the Authorization Request/Response, or it can be retrieved from it. Note that, in case of successful joining, the Client will receive the URI to retrieve individual or group keying material and to leave the group in the Location-Path option of the response.<a href="#section-4.2-5" class="pilcrow">¶</a></p>
<p id="section-4.2-6">If the node is joining a group for the first time, and the KDC maintains the public keys of the group members, the Client is REQUIRED to send its own public key and proof of possession ("client_cred" and "client_cred_verify" in <a href="#gid-post" class="xref">Section 4.1.2.1</a>). The request is only accepted if both public key and proof of possession are provided. If a node re-joins a group with the same access token and the same public key, it can omit to send the public key and the proof of possession, or just omit the proof of possession, and the KDC will be able to retrieve its public key associated to its token for that group (if the key has been discarded, the KDC will reply with 4.00 Bad Request, as specified in <a href="#gid-post" class="xref">Section 4.1.2.1</a>). If a node re-joins a group but wants to update its own public key, it needs to send both public key and proof of possession.<a href="#section-4.2-6" class="pilcrow">¶</a></p>
<p id="section-4.2-7">If the application requires backward security, the KDC MUST generate new group keying material and securely distribute it to all the current group members, upon a new node's joining the group. To this end, the KDC uses the message format of the response defined in <a href="#gid-get" class="xref">Section 4.1.2.2</a>. Application profiles may define alternative ways of retrieving the keying material, such as sending separate requests to different resources at the KDC (<a href="#gid-get" class="xref">Section 4.1.2.2</a>, <a href="#pubkey-get" class="xref">Section 4.1.3.2</a>, <a href="#policies-get" class="xref">Section 4.1.4.1</a>). After distributing the new group keying material, the KDC MUST increment the version number of the keying material.<a href="#section-4.2-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="update-keys">
<section id="section-4.3">
        <h3 id="name-retrieval-of-updated-keying">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-retrieval-of-updated-keying" class="section-name selfRef">Retrieval of Updated Keying Material</a>
        </h3>
<p id="section-4.3-1">When any of the following happens, a node MUST stop using the owned group keying material to protect outgoing messages, and SHOULD stop using it to decrypt and verify incoming messages.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-4.3-2.1">Upon expiration of the keying material, according to what indicated by the KDC with the 'exp' (and possibly the 'exp_delta') parameter in a Joining Response, or to a pre-configured value.<a href="#section-4.3-2.1" class="pilcrow">¶</a>
</li>
<li id="section-4.3-2.2">Upon receiving a notification of revoked/renewed keying material from the KDC, possibly as part of an update of the keying material (rekeying) triggered by the KDC.<a href="#section-4.3-2.2" class="pilcrow">¶</a>
</li>
<li id="section-4.3-2.3">Upon receiving messages from other group members without being able to retrieve the keying material to correctly decrypt them. This may be due to rekeying messages previously sent by the KDC, that the Client was not able to receive or decrypt.<a href="#section-4.3-2.3" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-4.3-3">In either case, if it wants to continue participating in the group communication, the node has to request the latest keying material from the KDC. To this end, the Client sends a CoAP GET request to the /ace-group/GROUPNAME/nodes/NODENAME endpoint at the KDC, formatted as specified in <a href="#node-get" class="xref">Section 4.1.6.2</a>.<a href="#section-4.3-3" class="pilcrow">¶</a></p>
<p id="section-4.3-4">Note that policies can be set up, so that the Client sends a Key Re-Distribution request to the KDC only after a given number of received messages could not be decrypted (because of failed decryption processing or inability to retrieve the necessary keying material).<a href="#section-4.3-4" class="pilcrow">¶</a></p>
<p id="section-4.3-5">It is application dependent and pertaining to the particular message exchange (e.g. <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>) to set up these policies, to instruct clients to retain incoming messages and for how long (OPT4). This allows clients to possibly decrypt such messages after getting updated keying material, rather than just consider them non valid messages to discard right away.<a href="#section-4.3-5" class="pilcrow">¶</a></p>
<p id="section-4.3-6">The same Key Distribution Request could also be sent by the Client without being triggered by a failed decryption of a message, if the Client wants to be sure that it has the latest group keying material. If that is the case, the Client will receive from the KDC the same group keying material it already has in memory.<a href="#section-4.3-6" class="pilcrow">¶</a></p>
<p id="section-4.3-7"><a href="#fig-key-redistr-req-resp" class="xref">Figure 9</a> gives an overview of the exchange described above.<a href="#section-4.3-7" class="pilcrow">¶</a></p>
<span id="name-message-flow-of-key-distrib"></span><div id="fig-key-redistr-req-resp">
<figure id="figure-9">
          <div class="artwork art-text alignCenter" id="section-4.3-8.1">
<pre>
Client                                                          KDC
   |                                                             |
   |------------------ Key Distribution Request: ---------------&gt;|
   |           GET ace-group/GROUPNAME/nodes/NODENAME            |
   |                                                             |
   |&lt;-------- Key Distribution Response: 2.05 (Content) ---------|
   |                                                             |
</pre>
</div>
<figcaption><a href="#figure-9" class="selfRef">Figure 9</a>:
<a href="#name-message-flow-of-key-distrib" class="selfRef">Message Flow of Key Distribution Request-Response</a>
          </figcaption></figure>
</div>
<p id="section-4.3-9">Alternatively, the re-distribution of keying material can be initiated by the KDC, which e.g.:<a href="#section-4.3-9" class="pilcrow">¶</a></p>
<ul>
<li id="section-4.3-10.1">Can make the ace-group/GROUPNAME/nodes/NODENAME resource Observable, and send notifications to Clients when the keying material is updated.<a href="#section-4.3-10.1" class="pilcrow">¶</a>
</li>
<li id="section-4.3-10.2">Can send the payload of the Key Distribution Response in one or multiple multicast POST requests to the members of the group, using secure rekeying schemes such as <span>[<a href="#RFC2093" class="xref">RFC2093</a>]</span><span>[<a href="#RFC2094" class="xref">RFC2094</a>]</span><span>[<a href="#RFC2627" class="xref">RFC2627</a>]</span>.<a href="#section-4.3-10.2" class="pilcrow">¶</a>
</li>
<li id="section-4.3-10.3">Can send unicast POST requests to each Client over a secure channel, with the same payload as the Key Distribution Response. When sending such requests, the KDC can target the URI path possibly provided by the intended recipient upon joining the group, as specified in the 'control_path' parameter of the Joining Request (see <a href="#gid-post" class="xref">Section 4.1.2.1</a>).<a href="#section-4.3-10.3" class="pilcrow">¶</a>
</li>
<li id="section-4.3-10.4">Can act as a publisher in a pub-sub scenario, and update the keying material by publishing on a specific topic on a broker, which all the members of the group are subscribed to.<a href="#section-4.3-10.4" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-4.3-11">Note that these methods of KDC-initiated key distribution have different security properties and require different security associations.<a href="#section-4.3-11" class="pilcrow">¶</a></p>
</section>
</div>
<div id="new-keys">
<section id="section-4.4">
        <h3 id="name-retrieval-of-new-keying-mat">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-retrieval-of-new-keying-mat" class="section-name selfRef">Retrieval of New Keying Material</a>
        </h3>
<p id="section-4.4-1">Beside possible expiration and depending on what part of the keying material is no longer eligible to be used, the client may need to communicate to the KDC its need for that part to be renewed. For example, if the Client uses an individual key to protect outgoing traffic and has to renew it, the node may request a new one, or new input material to derive it, without renewing the whole group keying material.<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<p id="section-4.4-2">To this end, the client performs a Key Renewal Request/Response exchange with the KDC, i.e. it sends a CoAP PUT request to the /ace-group/GROUPNAME/nodes/NODENAME endpoint at the KDC, where GROUPNAME is the group identifier and NODENAME is the node's name, and formatted as defined in <a href="#node-get" class="xref">Section 4.1.6.2</a>.<a href="#section-4.4-2" class="pilcrow">¶</a></p>
<p id="section-4.4-3"><a href="#fig-renewal-req-resp" class="xref">Figure 10</a> gives an overview of the exchange described above.<a href="#section-4.4-3" class="pilcrow">¶</a></p>
<span id="name-message-flow-of-key-renewal"></span><div id="fig-renewal-req-resp">
<figure id="figure-10">
          <div class="artwork art-text alignCenter" id="section-4.4-4.1">
<pre>
Client                                                    KDC
   |                                                       |
   |------------------ Key Renewal Request: --------------&gt;|
   |           PUT ace-group/GROUPNAME/nodes/NODENAME      |
   |                                                       |
   |&lt;-------- Key Renewal Response: 2.05 (Content) --------|
   |                                                       |
</pre>
</div>
<figcaption><a href="#figure-10" class="selfRef">Figure 10</a>:
<a href="#name-message-flow-of-key-renewal" class="selfRef">Message Flow of Key Renewal Request-Response</a>
          </figcaption></figure>
</div>
<p id="section-4.4-5">Note the difference between the Key Distribution Request and the Key Renewal Request: while the first one only triggers distribution (the renewal might have happened independently, e.g. because of expiration), the second one triggers the KDC to produce new individual keying material for the requesting node.<a href="#section-4.4-5" class="pilcrow">¶</a></p>
<p id="section-4.4-6">Furthermore, policies can be set up so that, upon receiving a Key Renewal Request, the KDC replies to the client with an error response, and then performs a complete group rekeying (OPT8).<a href="#section-4.4-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-key-retrieval">
<section id="section-4.5">
        <h3 id="name-retrieval-of-public-keys-an">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-retrieval-of-public-keys-an" class="section-name selfRef">Retrieval of Public Keys and Roles for Group Members</a>
        </h3>
<p id="section-4.5-1">In case the KDC maintains the public keys of group members, a node in the group can contact the KDC to request public keys and roles of either all group members or a specified subset, by sending a CoAP GET or FETCH request to the /ace-group/GROUPNAME/pub-key endpoint at the KDC, where GROUPNAME is the group identifier, and formatted as defined in <a href="#pubkey-get" class="xref">Section 4.1.3.2</a> and <a href="#pubkey-fetch" class="xref">Section 4.1.3.1</a>.<a href="#section-4.5-1" class="pilcrow">¶</a></p>
<p id="section-4.5-2">When receiving a Public Key Response, the requesting group member stores (or updates) the public keys (in the 'pub_keys' parameter) and roles (in the 'peer_roles' parameter) of the group members.<a href="#section-4.5-2" class="pilcrow">¶</a></p>
<p id="section-4.5-3"><a href="#fig-public-key-1" class="xref">Figure 11</a> and <a href="#fig-public-key-2" class="xref">Figure 12</a> give an overview of the exchanges described above.<a href="#section-4.5-3" class="pilcrow">¶</a></p>
<span id="name-message-flow-of-public-key-"></span><div id="fig-public-key-1">
<figure id="figure-11">
          <div class="artwork art-text alignCenter" id="section-4.5-4.1">
<pre>
Client                                                     KDC
   |                                                        |
   |--Public Key Request: GET /ace-group/GROUPNAME/pub-key-&gt;|
   |                                                        |
   |&lt;--------- Public Key Response: 2.05 (Content) ---------|
   |                                                        |
</pre>
</div>
<figcaption><a href="#figure-11" class="selfRef">Figure 11</a>:
<a href="#name-message-flow-of-public-key-" class="selfRef">Message Flow of Public Key Exchange to Request All Members Public Keys</a>
          </figcaption></figure>
</div>
<span id="name-message-flow-of-public-key-e"></span><div id="fig-public-key-2">
<figure id="figure-12">
          <div class="artwork art-text alignCenter" id="section-4.5-5.1">
<pre>
Client                                                      KDC
   |                                                         |
   |-Public Key Request: FETCH /ace-group/GROUPNAME/pub-key-&gt;|
   |                                                         |
   |&lt;--------- Public Key Response: 2.05 (Created) ----------|
   |                                                         |
</pre>
</div>
<figcaption><a href="#figure-12" class="selfRef">Figure 12</a>:
<a href="#name-message-flow-of-public-key-e" class="selfRef">Message Flow of Public Key Exchange to Request Specific Members Public Keys</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="update-pub-key">
<section id="section-4.6">
        <h3 id="name-update-of-public-key">
<a href="#section-4.6" class="section-number selfRef">4.6. </a><a href="#name-update-of-public-key" class="section-name selfRef">Update of Public Key</a>
        </h3>
<p id="section-4.6-1">In case the KDC maintains the public keys of group members, a node in the group can contact the KDC to upload a new public key to use in the group, and replace the currently stored one.<a href="#section-4.6-1" class="pilcrow">¶</a></p>
<p id="section-4.6-2">To this end, the Client performs a Public Key Update Request/Response exchange with the KDC, i.e. it sends a CoAP POST request to the /ace-group/GROUPNAME/nodes/NODENAME/pub-key endpoint at the KDC, where GROUPNAME is the group identifier and NODENAME is the node's name.<a href="#section-4.6-2" class="pilcrow">¶</a></p>
<p id="section-4.6-3">The request is formatted as specified in <a href="#node-pub-key-post" class="xref">Section 4.1.7.1</a>.<a href="#section-4.6-3" class="pilcrow">¶</a></p>
<p id="section-4.6-4">Figure <a href="#fig-pub-key-update-req-resp" class="xref">Figure 13</a> gives an overview of the exchange described above.<a href="#section-4.6-4" class="pilcrow">¶</a></p>
<span id="name-message-flow-of-public-key-u"></span><div id="fig-pub-key-update-req-resp">
<figure id="figure-13">
          <div class="artwork art-text alignCenter" id="section-4.6-5.1">
<pre>
Client                                                           KDC
|                                                                 |
|-------------- Public Key Update Request: ----------------------&gt;|
|      POST ace-group/GROUPNAME/nodes/NODENAME/pub-key            |
|                                                                 |
|&lt;------- Public Key Update Response: 2.04 (Changed) -------------|
|                                                                 |
</pre>
</div>
<figcaption><a href="#figure-13" class="selfRef">Figure 13</a>:
<a href="#name-message-flow-of-public-key-u" class="selfRef">Message Flow of Public Key Update Request-Response</a>
          </figcaption></figure>
</div>
<p id="section-4.6-6">If the application requires backward security, the KDC MUST generate new group keying material and securely distribute it to all the current group members, upon a group member updating its own public key. To this end, the KDC uses the message format of the response defined in <a href="#gid-get" class="xref">Section 4.1.2.2</a>. Application profiles may define alternative ways of retrieving the keying material, such as sending separate requests to different resources at the KDC (<a href="#gid-get" class="xref">Section 4.1.2.2</a>, <a href="#pubkey-get" class="xref">Section 4.1.3.2</a>, <a href="#policies-get" class="xref">Section 4.1.4.1</a>). After distributing the new group keying material, the KDC MUST increment the version number of the keying material.<a href="#section-4.6-6" class="pilcrow">¶</a></p>
<p id="section-4.6-7">Additionally, after updating its own public key, a group member MAY send a number of the later requests including an identifier of the updated public key, to signal nodes that they need to retrieve it. How that is done depends on the group communication protocol used, and therefore is application profile specific (OPT10).<a href="#section-4.6-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="policies">
<section id="section-4.7">
        <h3 id="name-retrieval-of-group-policies">
<a href="#section-4.7" class="section-number selfRef">4.7. </a><a href="#name-retrieval-of-group-policies" class="section-name selfRef">Retrieval of Group Policies</a>
        </h3>
<p id="section-4.7-1">A node in the group can contact the KDC to retrieve the current group policies, by sending a CoAP GET request to the /ace-group/GROUPNAME/policies endpoint at the KDC, where GROUPNAME is the group identifier, and formatted as defined in <a href="#policies-get" class="xref">Section 4.1.4.1</a><a href="#section-4.7-1" class="pilcrow">¶</a></p>
<p id="section-4.7-2"><a href="#fig-policies" class="xref">Figure 14</a> gives an overview of the exchange described above.<a href="#section-4.7-2" class="pilcrow">¶</a></p>
<span id="name-message-flow-of-policies-re"></span><div id="fig-policies">
<figure id="figure-14">
          <div class="artwork art-text alignCenter" id="section-4.7-3.1">
<pre>
Client                                                   KDC
   |                                                      |
   |-Policies Request: GET ace-group/GROUPNAME/policies -&gt;|
   |                                                      |
   |&lt;--------- Policies Response: 2.05 (Content) ---------|
   |                                                      |
</pre>
</div>
<figcaption><a href="#figure-14" class="selfRef">Figure 14</a>:
<a href="#name-message-flow-of-policies-re" class="selfRef">Message Flow of Policies Request-Response</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="key-version">
<section id="section-4.8">
        <h3 id="name-retrieval-of-keying-materia">
<a href="#section-4.8" class="section-number selfRef">4.8. </a><a href="#name-retrieval-of-keying-materia" class="section-name selfRef">Retrieval of Keying Material Version</a>
        </h3>
<p id="section-4.8-1">A node in the group can contact the KDC to request information about the version number of the symmetric group keying material, by sending a CoAP GET request to the /ace-group/GROUPNAME/ctx-num endpoint at the KDC, where GROUPNAME is the group identifier, formatted as defined in <a href="#num-get" class="xref">Section 4.1.5.1</a>. In particular, the version is incremented by the KDC every time the group keying material is renewed.<a href="#section-4.8-1" class="pilcrow">¶</a></p>
<p id="section-4.8-2"><a href="#fig-version" class="xref">Figure 15</a> gives an overview of the exchange described above.<a href="#section-4.8-2" class="pilcrow">¶</a></p>
<span id="name-message-flow-of-version-req"></span><div id="fig-version">
<figure id="figure-15">
          <div class="artwork art-text alignCenter" id="section-4.8-3.1">
<pre>
Client                                                    KDC
   |                                                       |
   |-- Version Request: GET ace-group/GROUPNAME/ctx-num --&gt;|
   |                                                       |
   |&lt;--------- Version Response: 2.05 (Content) -----------|
   |                                                       |
</pre>
</div>
<figcaption><a href="#figure-15" class="selfRef">Figure 15</a>:
<a href="#name-message-flow-of-version-req" class="selfRef">Message Flow of Version Request-Response</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="ssec-group-leaving">
<section id="section-4.9">
        <h3 id="name-group-leaving-request">
<a href="#section-4.9" class="section-number selfRef">4.9. </a><a href="#name-group-leaving-request" class="section-name selfRef">Group Leaving Request</a>
        </h3>
<p id="section-4.9-1">A node can actively request to leave the group. In this case, the Client sends a CoAP DELETE request to the endpoint /ace-group/GROUPNAME/nodes/NODENAME at the KDC, where GROUPNAME is the group identifier and NODENAME is the node's name, formatted as defined in <a href="#node-delete" class="xref">Section 4.1.6.3</a><a href="#section-4.9-1" class="pilcrow">¶</a></p>
<p id="section-4.9-2">Alternatively, a node may be removed by the KDC, without having explicitly asked for it. This is further discussed in <a href="#sec-node-removal" class="xref">Section 5</a>.<a href="#section-4.9-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-node-removal">
<section id="section-5">
      <h2 id="name-removal-of-a-node-from-the-">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-removal-of-a-node-from-the-" class="section-name selfRef">Removal of a Node from the Group</a>
      </h2>
<p id="section-5-1">This section describes the different scenarios according to which a node ends up being removed from the group.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">If the application requires forward security, the KDC MUST generate new group keying material and securely distribute it to all the current group members but the leaving node, using the message format of the Key Distribution Response (see <a href="#update-keys" class="xref">Section 4.3</a>). Application profiles may define alternative message formats. Once distributed the new group keying material, the KDC MUST increment the version number of the keying material.<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">Note that, after having left the group, a node may wish to join it again. Then, as long as the node is still authorized to join the group, i.e. it still has a valid access token, it can re-request to join the group directly to the KDC without needing to retrieve a new access token from the AS. This means that the KDC might decide to keep track of nodes with valid access tokens, before deleting all information about the leaving node.<a href="#section-5-3" class="pilcrow">¶</a></p>
<p id="section-5-4">A node may be evicted from the group in the following cases.<a href="#section-5-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5-5">
        <li id="section-5-5.1">The node explicitly asks to leave the group, as defined in <a href="#ssec-group-leaving" class="xref">Section 4.9</a>.<a href="#section-5-5.1" class="pilcrow">¶</a>
</li>
<li id="section-5-5.2">The node has been found compromised or is suspected so.<a href="#section-5-5.2" class="pilcrow">¶</a>
</li>
<li id="section-5-5.3">The node's authorization to be a group member is not valid anymore, either because the access token has expired, or it has been revoked. If the AS provides Token introspection (see Section 5.7 of <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>), the KDC can optionally use it and check whether the node is still authorized for that group in that role.<a href="#section-5-5.3" class="pilcrow">¶</a>
</li>
</ol>
<p id="section-5-6">In either case, once aware that a node is not authorized anymore, the KDC has to remove the unauthorized node from the list of group members, if the KDC keeps track of that.<a href="#section-5-6" class="pilcrow">¶</a></p>
<p id="section-5-7">In case of forced eviction, the KDC MAY explicitly inform the leaving node, if the Client implements the 'control_path' resource specified in <a href="#gid-post" class="xref">Section 4.1.2.1</a>. To this end, the KDC MAY send a DEL request, targeting the URI specified in the 'control_path' parameter of the Joining Request.<a href="#section-5-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="params">
<section id="section-6">
      <h2 id="name-ace-groupcomm-parameters">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-ace-groupcomm-parameters" class="section-name selfRef">ACE Groupcomm Parameters</a>
      </h2>
<p id="section-6-1">This specification defines a number of fields used during the second part of the message exchange, after the ACE Token POST exchange. The table below summarizes them, and specifies the CBOR key to use instead of the full descriptive name. Note that the media type ace-groupcomm+cbor MUST be used when these fields are transported.<a href="#section-6-1" class="pilcrow">¶</a></p>
<table class="center" id="table-1">
        <caption><a href="#table-1" class="selfRef">Table 1</a></caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Name</th>
            <th class="text-left" rowspan="1" colspan="1">CBOR Key</th>
            <th class="text-left" rowspan="1" colspan="1">CBOR Type</th>
            <th class="text-left" rowspan="1" colspan="1">Reference</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">scope</td>
            <td class="text-left" rowspan="1" colspan="1">TBD</td>
            <td class="text-left" rowspan="1" colspan="1">byte string</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#gid-post" class="xref">Section 4.1.2.1</a>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">get_pub_keys</td>
            <td class="text-left" rowspan="1" colspan="1">TBD</td>
            <td class="text-left" rowspan="1" colspan="1">array</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#gid-post" class="xref">Section 4.1.2.1</a>, <a href="#pubkey-fetch" class="xref">Section 4.1.3.1</a>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">client_cred</td>
            <td class="text-left" rowspan="1" colspan="1">TBD</td>
            <td class="text-left" rowspan="1" colspan="1">byte string</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#gid-post" class="xref">Section 4.1.2.1</a>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">cnonce</td>
            <td class="text-left" rowspan="1" colspan="1">TBD</td>
            <td class="text-left" rowspan="1" colspan="1">byte string</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#gid-post" class="xref">Section 4.1.2.1</a>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">client_cred_verify</td>
            <td class="text-left" rowspan="1" colspan="1">TBD</td>
            <td class="text-left" rowspan="1" colspan="1">byte string</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#gid-post" class="xref">Section 4.1.2.1</a>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">pub_keys_repos</td>
            <td class="text-left" rowspan="1" colspan="1">TBD</td>
            <td class="text-left" rowspan="1" colspan="1">text string</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#gid-post" class="xref">Section 4.1.2.1</a>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">control_path</td>
            <td class="text-left" rowspan="1" colspan="1">TBD</td>
            <td class="text-left" rowspan="1" colspan="1">text string</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#gid-post" class="xref">Section 4.1.2.1</a>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">gkty</td>
            <td class="text-left" rowspan="1" colspan="1">TBD</td>
            <td class="text-left" rowspan="1" colspan="1">int / text string</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#gid-post" class="xref">Section 4.1.2.1</a>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">key</td>
            <td class="text-left" rowspan="1" colspan="1">TBD</td>
            <td class="text-left" rowspan="1" colspan="1">see "ACE Groupcomm Key" Registry</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#gid-post" class="xref">Section 4.1.2.1</a>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">num</td>
            <td class="text-left" rowspan="1" colspan="1">TBD</td>
            <td class="text-left" rowspan="1" colspan="1">int</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#gid-post" class="xref">Section 4.1.2.1</a>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">ace-groupcomm-profile</td>
            <td class="text-left" rowspan="1" colspan="1">TBD</td>
            <td class="text-left" rowspan="1" colspan="1">int</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#gid-post" class="xref">Section 4.1.2.1</a>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">exp</td>
            <td class="text-left" rowspan="1" colspan="1">TBD</td>
            <td class="text-left" rowspan="1" colspan="1">int</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#gid-post" class="xref">Section 4.1.2.1</a>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">exp_delta</td>
            <td class="text-left" rowspan="1" colspan="1">TBD</td>
            <td class="text-left" rowspan="1" colspan="1">int</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#gid-post" class="xref">Section 4.1.2.1</a>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">pub_keys</td>
            <td class="text-left" rowspan="1" colspan="1">TBD</td>
            <td class="text-left" rowspan="1" colspan="1">byte string</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#gid-post" class="xref">Section 4.1.2.1</a>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">peer_roles</td>
            <td class="text-left" rowspan="1" colspan="1">TBD</td>
            <td class="text-left" rowspan="1" colspan="1">array</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#gid-post" class="xref">Section 4.1.2.1</a>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">group_policies</td>
            <td class="text-left" rowspan="1" colspan="1">TBD</td>
            <td class="text-left" rowspan="1" colspan="1">map</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#gid-post" class="xref">Section 4.1.2.1</a>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">mgt_key_material</td>
            <td class="text-left" rowspan="1" colspan="1">TBD</td>
            <td class="text-left" rowspan="1" colspan="1">byte string</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#gid-post" class="xref">Section 4.1.2.1</a>
</td>
          </tr>
        </tbody>
      </table>
</section>
</div>
<div id="sec-cons">
<section id="section-7">
      <h2 id="name-security-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-7-1">When a Client receives a message from a sender for the first time, it needs to have a mechanism in place to avoid replay, e.g. Appendix B.2 of <span>[<a href="#RFC8613" class="xref">RFC8613</a>]</span>. In case the Client rebooted and lost the security state used to protect previous communication with that sender, such a mechanism is useful for the recipient to be on the safe side.
If the group has renewed its group keying material, the time window between the end of the rekeying process and the next loss of security state is safe for recipients, as replayed older messages protected with previous keying material will not be accepted.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">The KDC must renew the group keying material upon its expiration.<a href="#section-7-2" class="pilcrow">¶</a></p>
<p id="section-7-3">The KDC should renew the keying material upon group membership change, and should provide it to the current group members through the rekeying scheme used in the group.<a href="#section-7-3" class="pilcrow">¶</a></p>
<p id="section-7-4">The KDC may enforce a rekeying policy that takes into account the overall time required to rekey the group, as well as the expected rate of changes in the group membership.<a href="#section-7-4" class="pilcrow">¶</a></p>
<p id="section-7-5">That is, the KDC may not rekey the group at every membership change, for instance if members' joining and leaving occur frequently and performing a group rekeying takes too long. Instead, the KDC may rekey the group after a minimum number of group members have joined or left within a given time interval, or during predictable network inactivity periods.<a href="#section-7-5" class="pilcrow">¶</a></p>
<p id="section-7-6">However, this would result in the KDC not constantly preserving backward and forward security. In fact, newly joining group members could be able to access the keying material used before their joining, and thus could access past group communications. Also, until the KDC performs a group rekeying, the newly leaving nodes would still be able to access upcoming group communications that are protected with the keying material that has not yet been updated.<a href="#section-7-6" class="pilcrow">¶</a></p>
<p id="section-7-7">The KDC needs to have a mechanism in place to detect DoS attacks from nodes constantly initiating rekeys (for example by updating their public key), such as removing these nodes from the group.<a href="#section-7-7" class="pilcrow">¶</a></p>
<div id="update-of-keying-material">
<section id="section-7.1">
        <h3 id="name-update-of-keying-material">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-update-of-keying-material" class="section-name selfRef">Update of Keying Material</a>
        </h3>
<p id="section-7.1-1">A group member can receive a message shortly after the group has been rekeyed, and new keying material has been distributed by the KDC. In the following two cases, this may result in misaligned keying material between the group members.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">In the first case, the sender protects a message using the old keying material. However, the recipient receives the message after having received the new keying material, hence not being able to correctly process it. A possible way to ameliorate this issue is to preserve the old, recent, keying material for a maximum amount of time defined by the application. By doing so, the recipient can still try to process the received message using the old retained keying material as second attempt. Note that a former (compromised) group member can take advantage of this by sending messages protected with the old retained keying material. Therefore, a conservative application policy should not admit the storage of old keying material.<a href="#section-7.1-2" class="pilcrow">¶</a></p>
<p id="section-7.1-3">In the second case, the sender protects a message using the new keying material, but the recipient receives that request before having received the new keying material. Therefore, the recipient would not be able to correctly process the request and hence discards it. If the recipient receives the new keying material shortly after that and the application at the sender endpoint performs retransmissions, the former will still be able to receive and correctly process the message. In any case, the recipient should actively ask the KDC for an updated keying material according to an application-defined policy, for instance after a given number of unsuccessfully decrypted incoming messages.<a href="#section-7.1-3" class="pilcrow">¶</a></p>
<p id="section-7.1-4">A node that has left the group should not expect any of its outgoing messages to be successfully processed, if received after its leaving, due to a possible group rekeying occurred before the message reception.<a href="#section-7.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="block-wise-considerations">
<section id="section-7.2">
        <h3 id="name-block-wise-considerations">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-block-wise-considerations" class="section-name selfRef">Block-Wise Considerations</a>
        </h3>
<p id="section-7.2-1">If the block-wise options <span>[<a href="#RFC7959" class="xref">RFC7959</a>]</span> are used, and the keying material is updated in the middle of a block-wise transfer, the sender of the blocks just changes the keying material to the updated one and continues the transfer. As long as both sides get the new keying material, updating the keying material in the middle of a transfer will not cause any issue. Otherwise, the sender will have to transmit the message again, when receiving an error message from the recipient.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<p id="section-7.2-2">Compared to a scenario where the transfer does not use block-wise, depending on how fast the keying material is changed, the nodes might consume a larger amount of the network bandwidth resending the blocks again and again, which might be problematic.<a href="#section-7.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-8">
      <h2 id="name-iana-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-8-1">This document has the following actions for IANA.<a href="#section-8-1" class="pilcrow">¶</a></p>
<div id="media-type">
<section id="section-8.1">
        <h3 id="name-media-type-registrations">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-media-type-registrations" class="section-name selfRef">Media Type Registrations</a>
        </h3>
<p id="section-8.1-1">This specification registers the 'application/ace-groupcomm+cbor' media type for messages of the protocols defined in this document following the ACE exchange and carrying parameters encoded in CBOR. This registration follows the procedures specified in <span>[<a href="#RFC6838" class="xref">RFC6838</a>]</span>.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<p id="section-8.1-2">Type name: application<a href="#section-8.1-2" class="pilcrow">¶</a></p>
<p id="section-8.1-3">Subtype name: ace-groupcomm+cbor<a href="#section-8.1-3" class="pilcrow">¶</a></p>
<p id="section-8.1-4">Required parameters: none<a href="#section-8.1-4" class="pilcrow">¶</a></p>
<p id="section-8.1-5">Optional parameters: none<a href="#section-8.1-5" class="pilcrow">¶</a></p>
<p id="section-8.1-6">Encoding considerations: Must be encoded as CBOR map containing the protocol parameters defined in [this document].<a href="#section-8.1-6" class="pilcrow">¶</a></p>
<p id="section-8.1-7">Security considerations: See <a href="#sec-cons" class="xref">Section 7</a> of this document.<a href="#section-8.1-7" class="pilcrow">¶</a></p>
<p id="section-8.1-8">Interoperability considerations: n/a<a href="#section-8.1-8" class="pilcrow">¶</a></p>
<p id="section-8.1-9">Published specification: [this document]<a href="#section-8.1-9" class="pilcrow">¶</a></p>
<p id="section-8.1-10">Applications that use this media type: The type is used by authorization servers, clients and resource servers that support the ACE groupcomm framework as specified in [this document].<a href="#section-8.1-10" class="pilcrow">¶</a></p>
<p id="section-8.1-11">Additional information:<a href="#section-8.1-11" class="pilcrow">¶</a></p>
<p id="section-8.1-12">Magic number(s): n/a<a href="#section-8.1-12" class="pilcrow">¶</a></p>
<p id="section-8.1-13">File extension(s): .ace-groupcomm<a href="#section-8.1-13" class="pilcrow">¶</a></p>
<p id="section-8.1-14">Macintosh file type code(s): n/a<a href="#section-8.1-14" class="pilcrow">¶</a></p>
<p id="section-8.1-15">Person &amp; email address to contact for further information:
   <a href="mailto:iesg@ietf.org">iesg@ietf.org</a><a href="#section-8.1-15" class="pilcrow">¶</a></p>
<p id="section-8.1-16">Intended usage: COMMON<a href="#section-8.1-16" class="pilcrow">¶</a></p>
<p id="section-8.1-17">Restrictions on usage: None<a href="#section-8.1-17" class="pilcrow">¶</a></p>
<p id="section-8.1-18">Author: Francesca Palombini <a href="mailto:francesca.palombini@ericsson.com">francesca.palombini@ericsson.com</a><a href="#section-8.1-18" class="pilcrow">¶</a></p>
<p id="section-8.1-19">Change controller: IESG<a href="#section-8.1-19" class="pilcrow">¶</a></p>
</section>
</div>
<div id="content-type">
<section id="section-8.2">
        <h3 id="name-coap-content-formats-regist">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-coap-content-formats-regist" class="section-name selfRef">CoAP Content-Formats Registry</a>
        </h3>
<p id="section-8.2-1">This specification registers the following entry to the "CoAP Content-Formats" registry, within the "CoRE Parameters" registry:<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<p id="section-8.2-2">Media Type: application/ace-groupcomm+cbor<a href="#section-8.2-2" class="pilcrow">¶</a></p>
<p id="section-8.2-3">Encoding: -<a href="#section-8.2-3" class="pilcrow">¶</a></p>
<p id="section-8.2-4">ID: TBD<a href="#section-8.2-4" class="pilcrow">¶</a></p>
<p id="section-8.2-5">Reference: [this document]<a href="#section-8.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-kinfo">
<section id="section-8.3">
        <h3 id="name-ace-authorization-server-re">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-ace-authorization-server-re" class="section-name selfRef">ACE Authorization Server Request Creation Hints Registry</a>
        </h3>
<p id="section-8.3-1">IANA is asked to register the following entries in the "ACE Authorization Server Request Creation Hints" Registry defined in Section 8.1 of <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>.<a href="#section-8.3-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-8.3-2.1">Name: sign_info<a href="#section-8.3-2.1" class="pilcrow">¶</a>
</li>
<li id="section-8.3-2.2">CBOR Key: TBD (range -256 to 255)<a href="#section-8.3-2.2" class="pilcrow">¶</a>
</li>
<li id="section-8.3-2.3">Value Type: any<a href="#section-8.3-2.3" class="pilcrow">¶</a>
</li>
<li id="section-8.3-2.4">Reference: [[This specification]]<a href="#section-8.3-2.4" class="pilcrow">¶</a>
</li>
<li id="section-8.3-2.5">Name: pub_key_enc<a href="#section-8.3-2.5" class="pilcrow">¶</a>
</li>
<li id="section-8.3-2.6">CBOR Key: TBD (range -256 to 255)<a href="#section-8.3-2.6" class="pilcrow">¶</a>
</li>
<li id="section-8.3-2.7">Value Type: integer<a href="#section-8.3-2.7" class="pilcrow">¶</a>
</li>
<li id="section-8.3-2.8">Reference: [[This specification]]<a href="#section-8.3-2.8" class="pilcrow">¶</a>
</li>
<li id="section-8.3-2.9">Name: kdcchallenge<a href="#section-8.3-2.9" class="pilcrow">¶</a>
</li>
<li id="section-8.3-2.10">CBOR Key: TBD (range -256 to 255)<a href="#section-8.3-2.10" class="pilcrow">¶</a>
</li>
<li id="section-8.3-2.11">Value Type: byte string<a href="#section-8.3-2.11" class="pilcrow">¶</a>
</li>
<li id="section-8.3-2.12">Reference: [[This specification]]<a href="#section-8.3-2.12" class="pilcrow">¶</a>
</li>
</ul>
</section>
</div>
<div id="iana-reg">
<section id="section-8.4">
        <h3 id="name-ace-groupcomm-parameters-re">
<a href="#section-8.4" class="section-number selfRef">8.4. </a><a href="#name-ace-groupcomm-parameters-re" class="section-name selfRef">ACE Groupcomm Parameters Registry</a>
        </h3>
<p id="section-8.4-1">This specification establishes the "ACE Groupcomm Parameters" IANA Registry. The
Registry has been created to use the "Expert Review Required" registration procedure <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>. Expert review guidelines are provided in <a href="#review" class="xref">Section 8.10</a>.<a href="#section-8.4-1" class="pilcrow">¶</a></p>
<p id="section-8.4-2">The columns of this Registry are:<a href="#section-8.4-2" class="pilcrow">¶</a></p>
<ul>
<li id="section-8.4-3.1">Name: This is a descriptive name that enables easier reference to
the item. The name MUST be unique. It is not used in the encoding.<a href="#section-8.4-3.1" class="pilcrow">¶</a>
</li>
<li id="section-8.4-3.2">CBOR Key: This is the value used as CBOR key of the item. These values MUST be unique. The value can be a positive integer, a negative integer, or a string.<a href="#section-8.4-3.2" class="pilcrow">¶</a>
</li>
<li id="section-8.4-3.3">CBOR Type: This contains the CBOR type of the item, or a pointer to the registry that defines its type, when that depends on another item.<a href="#section-8.4-3.3" class="pilcrow">¶</a>
</li>
<li id="section-8.4-3.4">Reference: This contains a pointer to the public specification for the item.<a href="#section-8.4-3.4" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-8.4-4">This Registry has been initially populated by the values in <a href="#params" class="xref">Section 6</a>. The Reference column for all of these entries refers to sections of this document.<a href="#section-8.4-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-key">
<section id="section-8.5">
        <h3 id="name-ace-groupcomm-key-registry">
<a href="#section-8.5" class="section-number selfRef">8.5. </a><a href="#name-ace-groupcomm-key-registry" class="section-name selfRef">ACE Groupcomm Key Registry</a>
        </h3>
<p id="section-8.5-1">This specification establishes the "ACE Groupcomm Key" IANA Registry. The
Registry has been created to use the "Expert Review Required" registration procedure <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>. Expert review guidelines are provided in <a href="#review" class="xref">Section 8.10</a>.<a href="#section-8.5-1" class="pilcrow">¶</a></p>
<p id="section-8.5-2">The columns of this Registry are:<a href="#section-8.5-2" class="pilcrow">¶</a></p>
<ul>
<li id="section-8.5-3.1">Name: This is a descriptive name that enables easier reference to
the item. The name MUST be unique. It is not used in the encoding.<a href="#section-8.5-3.1" class="pilcrow">¶</a>
</li>
<li id="section-8.5-3.2">Key Type Value: This is the value used to identify the keying material. These values MUST be unique.  The value can be a positive integer, a negative integer, or a text string.<a href="#section-8.5-3.2" class="pilcrow">¶</a>
</li>
<li id="section-8.5-3.3">Profile: This field may contain one or more descriptive strings of application profiles to be used with this item. The values should be taken from the Name column of the "ACE Groupcomm Profile" Registry.<a href="#section-8.5-3.3" class="pilcrow">¶</a>
</li>
<li id="section-8.5-3.4">Description: This field contains a brief description of the keying material.<a href="#section-8.5-3.4" class="pilcrow">¶</a>
</li>
<li id="section-8.5-3.5">References: This contains a pointer to the public specification for the format of the keying material, if one exists.<a href="#section-8.5-3.5" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-8.5-4">This Registry has been initially populated by the values in <a href="#gkty" class="xref">Figure 5</a>. The specification column for all of these entries will be this document.<a href="#section-8.5-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ace-groupcomm-profile-registry">
<section id="section-8.6">
        <h3 id="name-ace-groupcomm-profile-regis">
<a href="#section-8.6" class="section-number selfRef">8.6. </a><a href="#name-ace-groupcomm-profile-regis" class="section-name selfRef">ACE Groupcomm Profile Registry</a>
        </h3>
<p id="section-8.6-1">This specification establishes the "ACE Groupcomm Profile" IANA Registry. The Registry has been created to use the "Expert Review Required" registration procedure <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>. Expert review guidelines are provided in <a href="#review" class="xref">Section 8.10</a>. It should be noted that, in addition to the expert review, some portions of the Registry require a specification, potentially a Standards Track RFC, be supplied as well.<a href="#section-8.6-1" class="pilcrow">¶</a></p>
<p id="section-8.6-2">The columns of this Registry are:<a href="#section-8.6-2" class="pilcrow">¶</a></p>
<ul>
<li id="section-8.6-3.1">Name: The name of the application profile, to be used as value of the profile attribute.<a href="#section-8.6-3.1" class="pilcrow">¶</a>
</li>
<li id="section-8.6-3.2">Description: Text giving an overview of the application profile and the context it is developed for.<a href="#section-8.6-3.2" class="pilcrow">¶</a>
</li>
<li id="section-8.6-3.3">CBOR Value: CBOR abbreviation for the name of this application profile. Different ranges of values use different registration policies <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>. Integer values from -256 to 255 are designated as Standards Action. Integer values from -65536 to -257 and from 256 to 65535 are designated as Specification Required. Integer values greater than 65535 are designated as Expert Review. Integer values less than -65536 are marked as Private Use.<a href="#section-8.6-3.3" class="pilcrow">¶</a>
</li>
<li id="section-8.6-3.4">Reference: This contains a pointer to the public specification of the abbreviation for this application profile, if one exists.<a href="#section-8.6-3.4" class="pilcrow">¶</a>
</li>
</ul>
</section>
</div>
<div id="ace-groupcomm-policy-registry">
<section id="section-8.7">
        <h3 id="name-ace-groupcomm-policy-regist">
<a href="#section-8.7" class="section-number selfRef">8.7. </a><a href="#name-ace-groupcomm-policy-regist" class="section-name selfRef">ACE Groupcomm Policy Registry</a>
        </h3>
<p id="section-8.7-1">This specification establishes the "ACE Groupcomm Policy" IANA Registry. The Registry has been created to use the "Expert Review Required" registration procedure <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>. Expert review guidelines are provided in <a href="#review" class="xref">Section 8.10</a>. It should be noted that, in addition to the expert review, some portions of the Registry require a specification, potentially a Standards Track RFC, be supplied as well.<a href="#section-8.7-1" class="pilcrow">¶</a></p>
<p id="section-8.7-2">The columns of this Registry are:<a href="#section-8.7-2" class="pilcrow">¶</a></p>
<ul>
<li id="section-8.7-3.1">Name: The name of the group communication policy.<a href="#section-8.7-3.1" class="pilcrow">¶</a>
</li>
<li id="section-8.7-3.2">CBOR label: The value to be used to identify this group communication policy.  Key map labels MUST be unique. The label can be a positive integer, a negative integer or a string.  Integer values between 0 and 255 and strings of length 1 are designated as Standards Track Document required. Integer values from 256 to 65535 and strings of length 2 are designated as Specification Required.  Integer values of greater than 65535 and strings of length greater than 2 are designated as expert review.  Integer values less than -65536 are marked as private use.<a href="#section-8.7-3.2" class="pilcrow">¶</a>
</li>
<li id="section-8.7-3.3">CBOR type: the CBOR type used to encode the value of this group communication policy.<a href="#section-8.7-3.3" class="pilcrow">¶</a>
</li>
<li id="section-8.7-3.4">Description: This field contains a brief description for this group communication policy.<a href="#section-8.7-3.4" class="pilcrow">¶</a>
</li>
<li id="section-8.7-3.5">Reference: This field contains a pointer to the public specification providing the format of the group communication policy, if one exists.<a href="#section-8.7-3.5" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-8.7-4">This registry will be initially populated by the values in <a href="#fig-ACE-Groupcomm-Policies" class="xref">Figure 6</a>.<a href="#section-8.7-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sequence-number-synchronization-method-registry">
<section id="section-8.8">
        <h3 id="name-sequence-number-synchroniza">
<a href="#section-8.8" class="section-number selfRef">8.8. </a><a href="#name-sequence-number-synchroniza" class="section-name selfRef">Sequence Number Synchronization Method Registry</a>
        </h3>
<p id="section-8.8-1">This specification establishes the "Sequence Number Synchronization Method" IANA Registry. The Registry has been created to use the "Expert Review Required" registration procedure <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>. Expert review guidelines are provided in <a href="#review" class="xref">Section 8.10</a>. It should be noted that, in addition to the expert review, some portions of the Registry require a specification, potentially a Standards Track RFC, be supplied as well.<a href="#section-8.8-1" class="pilcrow">¶</a></p>
<p id="section-8.8-2">The columns of this Registry are:<a href="#section-8.8-2" class="pilcrow">¶</a></p>
<ul>
<li id="section-8.8-3.1">Name: The name of the sequence number synchronization method.<a href="#section-8.8-3.1" class="pilcrow">¶</a>
</li>
<li id="section-8.8-3.2">Value: The value to be used to identify this sequence number synchronization method.<a href="#section-8.8-3.2" class="pilcrow">¶</a>
</li>
<li id="section-8.8-3.3">Description: This field contains a brief description for this sequence number synchronization method.<a href="#section-8.8-3.3" class="pilcrow">¶</a>
</li>
<li id="section-8.8-3.4">Reference: This field contains a pointer to the public specification describing the sequence number synchronization method.<a href="#section-8.8-3.4" class="pilcrow">¶</a>
</li>
</ul>
</section>
</div>
<div id="if-ace-group">
<section id="section-8.9">
        <h3 id="name-interface-description-if-li">
<a href="#section-8.9" class="section-number selfRef">8.9. </a><a href="#name-interface-description-if-li" class="section-name selfRef">Interface Description (if=) Link Target Attribute Values Registry</a>
        </h3>
<p id="section-8.9-1">This specification registers the following entry to the "Interface Description (if=) Link Target Attribute Values Registry" registry, within the "CoRE Parameters" registry:<a href="#section-8.9-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-8.9-2.1">Attribute Value: ace-group<a href="#section-8.9-2.1" class="pilcrow">¶</a>
</li>
<li id="section-8.9-2.2">Description: The 'ace group' interface is used to provision keying material and related informations and policies to members of a group using the Ace framework.<a href="#section-8.9-2.2" class="pilcrow">¶</a>
</li>
<li id="section-8.9-2.3">Reference: [This Document]<a href="#section-8.9-2.3" class="pilcrow">¶</a>
</li>
</ul>
</section>
</div>
<div id="review">
<section id="section-8.10">
        <h3 id="name-expert-review-instructions">
<a href="#section-8.10" class="section-number selfRef">8.10. </a><a href="#name-expert-review-instructions" class="section-name selfRef">Expert Review Instructions</a>
        </h3>
<p id="section-8.10-1">The IANA Registries established in this document are defined as expert review.
This section gives some general guidelines for what the experts should be looking for, but they are being designated as experts for a reason so they should be given substantial latitude.<a href="#section-8.10-1" class="pilcrow">¶</a></p>
<p id="section-8.10-2">Expert reviewers should take into consideration the following points:<a href="#section-8.10-2" class="pilcrow">¶</a></p>
<ul>
<li id="section-8.10-3.1">Point squatting should be discouraged.
 Reviewers are encouraged to get sufficient information for registration requests to ensure that the usage is not going to duplicate one that is already registered and that the point is likely to be used in deployments.
 The zones tagged as private use are intended for testing purposes and closed environments, code points in other ranges should not be assigned for testing.<a href="#section-8.10-3.1" class="pilcrow">¶</a>
</li>
<li id="section-8.10-3.2">Specifications are required for the standards track range of point assignment.
 Specifications should exist for specification required ranges, but early assignment before a specification is available is considered to be permissible.
 Specifications are needed for the first-come, first-serve range if they are expected to be used outside of closed environments in an interoperable way.
 When specifications are not provided, the description provided needs to have sufficient information to identify what the point is being used for.<a href="#section-8.10-3.2" class="pilcrow">¶</a>
</li>
<li id="section-8.10-3.3">Experts should take into account the expected usage of fields when approving point assignment.
 The fact that there is a range for standards track documents does not mean that a standards track document cannot have points assigned outside of that range.
 The length of the encoded value should be weighed against how many code points of that length are left, the size of device it will be used on, and the number of code points left that encode to that size.<a href="#section-8.10-3.3" class="pilcrow">¶</a>
</li>
</ul>
</section>
</div>
</section>
</div>
<section id="section-9">
      <h2 id="name-references">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-9.1">
        <h3 id="name-normative-references">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-ace-cwt-proof-of-possession">[I-D.ietf-ace-cwt-proof-of-possession]</dt>
<dd>
<span class="refAuthor">Jones, M.</span><span class="refAuthor">, Seitz, L.</span><span class="refAuthor">, Selander, G.</span><span class="refAuthor">, Erdtman, S.</span><span class="refAuthor">, and H. Tschofenig</span>, <span class="refTitle">"Proof-of-Possession Key Semantics for CBOR Web Tokens (CWTs)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-ace-cwt-proof-of-possession-11</span>, <time datetime="2019-10-31">31 October 2019</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-ietf-ace-cwt-proof-of-possession-11.txt">http://www.ietf.org/internet-drafts/draft-ietf-ace-cwt-proof-of-possession-11.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-ace-oauth-authz">[I-D.ietf-ace-oauth-authz]</dt>
<dd>
<span class="refAuthor">Seitz, L.</span><span class="refAuthor">, Selander, G.</span><span class="refAuthor">, Wahlstroem, E.</span><span class="refAuthor">, Erdtman, S.</span><span class="refAuthor">, and H. Tschofenig</span>, <span class="refTitle">"Authentication and Authorization for Constrained Environments (ACE) using the OAuth 2.0 Framework (ACE-OAuth)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-ace-oauth-authz-33</span>, <time datetime="2020-02-06">6 February 2020</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-ietf-ace-oauth-authz-33.txt">http://www.ietf.org/internet-drafts/draft-ietf-ace-oauth-authz-33.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-ace-oauth-params">[I-D.ietf-ace-oauth-params]</dt>
<dd>
<span class="refAuthor">Seitz, L.</span>, <span class="refTitle">"Additional OAuth Parameters for Authorization in Constrained Environments (ACE)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-ace-oauth-params-13</span>, <time datetime="2020-04-28">28 April 2020</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-ietf-ace-oauth-params-13.txt">http://www.ietf.org/internet-drafts/draft-ietf-ace-oauth-params-13.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-core-oscore-groupcomm">[I-D.ietf-core-oscore-groupcomm]</dt>
<dd>
<span class="refAuthor">Tiloca, M.</span><span class="refAuthor">, Selander, G.</span><span class="refAuthor">, Palombini, F.</span><span class="refAuthor">, and J. Park</span>, <span class="refTitle">"Group OSCORE - Secure Group Communication for CoAP"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-core-oscore-groupcomm-08</span>, <time datetime="2020-04-06">6 April 2020</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-ietf-core-oscore-groupcomm-08.txt">http://www.ietf.org/internet-drafts/draft-ietf-core-oscore-groupcomm-08.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
<dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6838">[RFC6838]</dt>
<dd>
<span class="refAuthor">Freed, N.</span><span class="refAuthor">, Klensin, J.</span><span class="refAuthor">, and T. Hansen</span>, <span class="refTitle">"Media Type Specifications and Registration Procedures"</span>, <span class="seriesInfo">BCP 13</span>, <span class="seriesInfo">RFC 6838</span>, <span class="seriesInfo">DOI 10.17487/RFC6838</span>, <time datetime="2013-01">January 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6838">https://www.rfc-editor.org/info/rfc6838</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7049">[RFC7049]</dt>
<dd>
<span class="refAuthor">Bormann, C.</span><span class="refAuthor"> and P. Hoffman</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR)"</span>, <span class="seriesInfo">RFC 7049</span>, <span class="seriesInfo">DOI 10.17487/RFC7049</span>, <time datetime="2013-10">October 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7049">https://www.rfc-editor.org/info/rfc7049</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
<dd>
<span class="refAuthor">Cotton, M.</span><span class="refAuthor">, Leiba, B.</span><span class="refAuthor">, and T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time datetime="2017-06">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8152">[RFC8152]</dt>
<dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE)"</span>, <span class="seriesInfo">RFC 8152</span>, <span class="seriesInfo">DOI 10.17487/RFC8152</span>, <time datetime="2017-07">July 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8152">https://www.rfc-editor.org/info/rfc8152</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
<dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-9.2">
        <h3 id="name-informative-references">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.dijk-core-groupcomm-bis">[I-D.dijk-core-groupcomm-bis]</dt>
<dd>
<span class="refAuthor">Dijk, E.</span><span class="refAuthor">, Wang, C.</span><span class="refAuthor">, and M. Tiloca</span>, <span class="refTitle">"Group Communication for the Constrained Application Protocol (CoAP)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-dijk-core-groupcomm-bis-03</span>, <time datetime="2020-03-09">9 March 2020</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-dijk-core-groupcomm-bis-03.txt">http://www.ietf.org/internet-drafts/draft-dijk-core-groupcomm-bis-03.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-ace-dtls-authorize">[I-D.ietf-ace-dtls-authorize]</dt>
<dd>
<span class="refAuthor">Gerdes, S.</span><span class="refAuthor">, Bergmann, O.</span><span class="refAuthor">, Bormann, C.</span><span class="refAuthor">, Selander, G.</span><span class="refAuthor">, and L. Seitz</span>, <span class="refTitle">"Datagram Transport Layer Security (DTLS) Profile for Authentication and Authorization for Constrained Environments (ACE)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-ace-dtls-authorize-09</span>, <time datetime="2019-12-18">18 December 2019</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-ietf-ace-dtls-authorize-09.txt">http://www.ietf.org/internet-drafts/draft-ietf-ace-dtls-authorize-09.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-ace-mqtt-tls-profile">[I-D.ietf-ace-mqtt-tls-profile]</dt>
<dd>
<span class="refAuthor">Sengul, C.</span><span class="refAuthor">, Kirby, A.</span><span class="refAuthor">, and P. Fremantle</span>, <span class="refTitle">"MQTT-TLS profile of ACE"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-ace-mqtt-tls-profile-04</span>, <time datetime="2020-03-09">9 March 2020</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-ietf-ace-mqtt-tls-profile-04.txt">http://www.ietf.org/internet-drafts/draft-ietf-ace-mqtt-tls-profile-04.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-ace-oscore-profile">[I-D.ietf-ace-oscore-profile]</dt>
<dd>
<span class="refAuthor">Palombini, F.</span><span class="refAuthor">, Seitz, L.</span><span class="refAuthor">, Selander, G.</span><span class="refAuthor">, and M. Gunnarsson</span>, <span class="refTitle">"OSCORE profile of the Authentication and Authorization for Constrained Environments Framework"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-ace-oscore-profile-10</span>, <time datetime="2020-03-09">9 March 2020</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-ietf-ace-oscore-profile-10.txt">http://www.ietf.org/internet-drafts/draft-ietf-ace-oscore-profile-10.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-core-coap-pubsub">[I-D.ietf-core-coap-pubsub]</dt>
<dd>
<span class="refAuthor">Koster, M.</span><span class="refAuthor">, Keranen, A.</span><span class="refAuthor">, and J. Jimenez</span>, <span class="refTitle">"Publish-Subscribe Broker for the Constrained Application Protocol (CoAP)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-core-coap-pubsub-09</span>, <time datetime="2019-09-30">30 September 2019</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-ietf-core-coap-pubsub-09.txt">http://www.ietf.org/internet-drafts/draft-ietf-core-coap-pubsub-09.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2093">[RFC2093]</dt>
<dd>
<span class="refAuthor">Harney, H.</span><span class="refAuthor"> and C. Muckenhirn</span>, <span class="refTitle">"Group Key Management Protocol (GKMP) Specification"</span>, <span class="seriesInfo">RFC 2093</span>, <span class="seriesInfo">DOI 10.17487/RFC2093</span>, <time datetime="1997-07">July 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2093">https://www.rfc-editor.org/info/rfc2093</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2094">[RFC2094]</dt>
<dd>
<span class="refAuthor">Harney, H.</span><span class="refAuthor"> and C. Muckenhirn</span>, <span class="refTitle">"Group Key Management Protocol (GKMP) Architecture"</span>, <span class="seriesInfo">RFC 2094</span>, <span class="seriesInfo">DOI 10.17487/RFC2094</span>, <time datetime="1997-07">July 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2094">https://www.rfc-editor.org/info/rfc2094</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2627">[RFC2627]</dt>
<dd>
<span class="refAuthor">Wallner, D.</span><span class="refAuthor">, Harder, E.</span><span class="refAuthor">, and R. Agee</span>, <span class="refTitle">"Key Management for Multicast: Issues and Architectures"</span>, <span class="seriesInfo">RFC 2627</span>, <span class="seriesInfo">DOI 10.17487/RFC2627</span>, <time datetime="1999-06">June 1999</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2627">https://www.rfc-editor.org/info/rfc2627</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6347">[RFC6347]</dt>
<dd>
<span class="refAuthor">Rescorla, E.</span><span class="refAuthor"> and N. Modadugu</span>, <span class="refTitle">"Datagram Transport Layer Security Version 1.2"</span>, <span class="seriesInfo">RFC 6347</span>, <span class="seriesInfo">DOI 10.17487/RFC6347</span>, <time datetime="2012-01">January 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6347">https://www.rfc-editor.org/info/rfc6347</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7519">[RFC7519]</dt>
<dd>
<span class="refAuthor">Jones, M.</span><span class="refAuthor">, Bradley, J.</span><span class="refAuthor">, and N. Sakimura</span>, <span class="refTitle">"JSON Web Token (JWT)"</span>, <span class="seriesInfo">RFC 7519</span>, <span class="seriesInfo">DOI 10.17487/RFC7519</span>, <time datetime="2015-05">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7519">https://www.rfc-editor.org/info/rfc7519</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7959">[RFC7959]</dt>
<dd>
<span class="refAuthor">Bormann, C.</span><span class="refAuthor"> and Z. Shelby, Ed.</span>, <span class="refTitle">"Block-Wise Transfers in the Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 7959</span>, <span class="seriesInfo">DOI 10.17487/RFC7959</span>, <time datetime="2016-08">August 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7959">https://www.rfc-editor.org/info/rfc7959</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8259">[RFC8259]</dt>
<dd>
<span class="refAuthor">Bray, T., Ed.</span>, <span class="refTitle">"The JavaScript Object Notation (JSON) Data Interchange Format"</span>, <span class="seriesInfo">STD 90</span>, <span class="seriesInfo">RFC 8259</span>, <span class="seriesInfo">DOI 10.17487/RFC8259</span>, <time datetime="2017-12">December 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8259">https://www.rfc-editor.org/info/rfc8259</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8392">[RFC8392]</dt>
<dd>
<span class="refAuthor">Jones, M.</span><span class="refAuthor">, Wahlstroem, E.</span><span class="refAuthor">, Erdtman, S.</span><span class="refAuthor">, and H. Tschofenig</span>, <span class="refTitle">"CBOR Web Token (CWT)"</span>, <span class="seriesInfo">RFC 8392</span>, <span class="seriesInfo">DOI 10.17487/RFC8392</span>, <time datetime="2018-05">May 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8392">https://www.rfc-editor.org/info/rfc8392</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8613">[RFC8613]</dt>
<dd>
<span class="refAuthor">Selander, G.</span><span class="refAuthor">, Mattsson, J.</span><span class="refAuthor">, Palombini, F.</span><span class="refAuthor">, and L. Seitz</span>, <span class="refTitle">"Object Security for Constrained RESTful Environments (OSCORE)"</span>, <span class="seriesInfo">RFC 8613</span>, <span class="seriesInfo">DOI 10.17487/RFC8613</span>, <time datetime="2019-07">July 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8613">https://www.rfc-editor.org/info/rfc8613</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8747">[RFC8747]</dt>
<dd>
<span class="refAuthor">Jones, M.</span><span class="refAuthor">, Seitz, L.</span><span class="refAuthor">, Selander, G.</span><span class="refAuthor">, Erdtman, S.</span><span class="refAuthor">, and H. Tschofenig</span>, <span class="refTitle">"Proof-of-Possession Key Semantics for CBOR Web Tokens (CWTs)"</span>, <span class="seriesInfo">RFC 8747</span>, <span class="seriesInfo">DOI 10.17487/RFC8747</span>, <time datetime="2020-03">March 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8747">https://www.rfc-editor.org/info/rfc8747</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="req">
<section id="section-appendix.a">
      <h2 id="name-requirements-on-application">
<a href="#section-appendix.a" class="section-number selfRef">Appendix A. </a><a href="#name-requirements-on-application" class="section-name selfRef">Requirements on Application Profiles</a>
      </h2>
<p id="section-appendix.a-1">This section lists the requirements on application profiles of this specification,for the convenience of application profile designers.<a href="#section-appendix.a-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-appendix.a-2.1">REQ1: Specify the encoding and value of the identifier of group or topic, for scope entries of 'scope' (see <a href="#ssec-authorization-request" class="xref">Section 3.1</a>).<a href="#section-appendix.a-2.1" class="pilcrow">¶</a>
</li>
<li id="section-appendix.a-2.2">REQ2: Specify the encoding and value of roles, for scope entries of 'scope' (see <a href="#ssec-authorization-request" class="xref">Section 3.1</a>).<a href="#section-appendix.a-2.2" class="pilcrow">¶</a>
</li>
<li id="section-appendix.a-2.3">REQ3: If used, specify the acceptable values for 'sign_alg' (see <a href="#token-post" class="xref">Section 3.3</a>).<a href="#section-appendix.a-2.3" class="pilcrow">¶</a>
</li>
<li id="section-appendix.a-2.4">REQ4: If used, specify the acceptable values for 'sign_parameters' (see <a href="#token-post" class="xref">Section 3.3</a>).<a href="#section-appendix.a-2.4" class="pilcrow">¶</a>
</li>
<li id="section-appendix.a-2.5">REQ5: If used, specify the acceptable values for 'sign_key_parameters' (see <a href="#token-post" class="xref">Section 3.3</a>).<a href="#section-appendix.a-2.5" class="pilcrow">¶</a>
</li>
<li id="section-appendix.a-2.6">REQ6: If used, specify the acceptable values for 'pub_key_enc' (see <a href="#token-post" class="xref">Section 3.3</a>).<a href="#section-appendix.a-2.6" class="pilcrow">¶</a>
</li>
<li id="section-appendix.a-2.7">REQ7: Specify the exact format of the 'key' value (see <a href="#gid-post" class="xref">Section 4.1.2.1</a>).<a href="#section-appendix.a-2.7" class="pilcrow">¶</a>
</li>
<li id="section-appendix.a-2.8">REQ8: Specify the acceptable values of 'gkty' (see <a href="#gid-post" class="xref">Section 4.1.2.1</a>).<a href="#section-appendix.a-2.8" class="pilcrow">¶</a>
</li>
<li id="section-appendix.a-2.9">REQ9: Specify the format of the identifiers of group members (see <a href="#gid-post" class="xref">Section 4.1.2.1</a>).<a href="#section-appendix.a-2.9" class="pilcrow">¶</a>
</li>
<li id="section-appendix.a-2.10">REQ10: Specify the communication protocol the members of the group must use (e.g., multicast CoAP).<a href="#section-appendix.a-2.10" class="pilcrow">¶</a>
</li>
<li id="section-appendix.a-2.11">REQ11: Specify the security protocol the group members must use to protect their communication (e.g., group OSCORE). This must provide encryption, integrity and replay protection.<a href="#section-appendix.a-2.11" class="pilcrow">¶</a>
</li>
<li id="section-appendix.a-2.12">REQ12: Specify and register the application profile identifier (see <a href="#gid-post" class="xref">Section 4.1.2.1</a>).<a href="#section-appendix.a-2.12" class="pilcrow">¶</a>
</li>
<li id="section-appendix.a-2.13">REQ13: Specify policies at the KDC to handle ids that are not included in get_pub_keys (see <a href="#pubkey-fetch" class="xref">Section 4.1.3.1</a>).<a href="#section-appendix.a-2.13" class="pilcrow">¶</a>
</li>
<li id="section-appendix.a-2.14">REQ14: If used, specify the format and content of 'group_policies' and its entries (see <a href="#gid-post" class="xref">Section 4.1.2.1</a>).<a href="#section-appendix.a-2.14" class="pilcrow">¶</a>
</li>
<li id="section-appendix.a-2.15">REQ15: Specify the format of newly-generated individual keying material for group members, or of the information to derive it, and corresponding CBOR label (see <a href="#node-get" class="xref">Section 4.1.6.2</a>).<a href="#section-appendix.a-2.15" class="pilcrow">¶</a>
</li>
<li id="section-appendix.a-2.16">REQ16: Specify how the communication is secured between Client and KDC. Optionally, specify tranport profile of ACE <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span> to use between Client and KDC (see <a href="#ssec-key-distribution-exchange" class="xref">Section 4.2</a>.<a href="#section-appendix.a-2.16" class="pilcrow">¶</a>
</li>
<li id="section-appendix.a-2.17">REQ17: Specify how the nonce N_S is generated, if the token is not being posted (e.g. if it is used directly to validate TLS instead).<a href="#section-appendix.a-2.17" class="pilcrow">¶</a>
</li>
<li id="section-appendix.a-2.18">REQ18: Specify if 'mgt_key_material' used, and if yes specify its format and content (see <a href="#gid-post" class="xref">Section 4.1.2.1</a>). If the usage of 'mgt_key_material' is indicated and its format defined for a specific key management scheme, that format must explicitly indicate the key management scheme itself. If a new rekeying scheme is defined to be used for an existing 'mgt_key_material' in an existing profile, then that profile will have to be updated accordingly, especially with respect to the usage of 'mgt_key_material' related format and content.<a href="#section-appendix.a-2.18" class="pilcrow">¶</a>
</li>
<li id="section-appendix.a-2.19">OPT1: Optionally, specify the encoding of public keys, of 'client_cred', and of 'pub_keys' if COSE_Keys are not used (see <a href="#gid-post" class="xref">Section 4.1.2.1</a>).<a href="#section-appendix.a-2.19" class="pilcrow">¶</a>
</li>
<li id="section-appendix.a-2.20">OPT2: Optionally, specify the negotiation of parameter values for signature algorithm and signature keys, if 'sign_info' and 'pub_key_enc' are not used (see <a href="#token-post" class="xref">Section 3.3</a>).<a href="#section-appendix.a-2.20" class="pilcrow">¶</a>
</li>
<li id="section-appendix.a-2.21">OPT3: Optionally, specify the encoding of 'pub_keys_repos' if the default is not used (see <a href="#gid-post" class="xref">Section 4.1.2.1</a>).<a href="#section-appendix.a-2.21" class="pilcrow">¶</a>
</li>
<li id="section-appendix.a-2.22">OPT4: Optionally, specify policies that instruct clients to retain messages and for how long, if they are unsuccessfully decrypted (see <a href="#update-keys" class="xref">Section 4.3</a>). This makes it possible to decrypt such messages after getting updated keying material.<a href="#section-appendix.a-2.22" class="pilcrow">¶</a>
</li>
<li id="section-appendix.a-2.23">OPT5: Optionally, specify the behavior of the handler in case of failure to retrieve a public key for the specific node (see <a href="#gid-post" class="xref">Section 4.1.2.1</a>).<a href="#section-appendix.a-2.23" class="pilcrow">¶</a>
</li>
<li id="section-appendix.a-2.24">OPT6: Optionally, specify possible or required payload formats for specific error cases.<a href="#section-appendix.a-2.24" class="pilcrow">¶</a>
</li>
<li id="section-appendix.a-2.25">OPT7: Optionally, specify CBOR values to use for abbreviating identifiers of roles in the group or topic (see <a href="#ssec-authorization-request" class="xref">Section 3.1</a>).<a href="#section-appendix.a-2.25" class="pilcrow">¶</a>
</li>
<li id="section-appendix.a-2.26">OPT8: Optionally, specify policies for the KDC to perform group rekeying after receiving a Key Renewal Request (see <a href="#new-keys" class="xref">Section 4.4</a>).<a href="#section-appendix.a-2.26" class="pilcrow">¶</a>
</li>
<li id="section-appendix.a-2.27">OPT9: Optionally, specify the functionalities implemented at the 'control_path' resource hosted at the Client, including message exchange encoding and other details (see <a href="#gid-post" class="xref">Section 4.1.2.1</a>).<a href="#section-appendix.a-2.27" class="pilcrow">¶</a>
</li>
<li id="section-appendix.a-2.28">OPT10: Optionally, specify how the identifier of the sender's public key is included in the group request (see <a href="#update-pub-key" class="xref">Section 4.6</a>).<a href="#section-appendix.a-2.28" class="pilcrow">¶</a>
</li>
</ul>
</section>
</div>
<div id="sec-document-updates">
<section id="section-appendix.b">
      <h2 id="name-document-updates">
<a href="#section-appendix.b" class="section-number selfRef">Appendix B. </a><a href="#name-document-updates" class="section-name selfRef">Document Updates</a>
      </h2>
<p id="section-appendix.b-1">RFC EDITOR: PLEASE REMOVE THIS SECTION.<a href="#section-appendix.b-1" class="pilcrow">¶</a></p>
<div id="sec-04-05">
<section id="section-b.1">
        <h2 id="name-version-04-to-05">
<a href="#section-b.1" class="section-number selfRef">B.1. </a><a href="#name-version-04-to-05" class="section-name selfRef">Version -04 to -05</a>
        </h2>
<ul>
<li id="section-b.1-1.1">Updated uppercase/lowercase URI segments for KDC resources.<a href="#section-b.1-1.1" class="pilcrow">¶</a>
</li>
<li id="section-b.1-1.2">Supporting single Access Token for multiple groups/topics.<a href="#section-b.1-1.2" class="pilcrow">¶</a>
</li>
<li id="section-b.1-1.3">Added 'control_path' parameter in the Joining Request.<a href="#section-b.1-1.3" class="pilcrow">¶</a>
</li>
<li id="section-b.1-1.4">Added 'peer_roles' parameter to support legal requesters/responders.<a href="#section-b.1-1.4" class="pilcrow">¶</a>
</li>
<li id="section-b.1-1.5">Clarification on stopping using owned keying material.<a href="#section-b.1-1.5" class="pilcrow">¶</a>
</li>
<li id="section-b.1-1.6">Clarification on different reasons for processing failures, related policies, and requirement OPT4.<a href="#section-b.1-1.6" class="pilcrow">¶</a>
</li>
<li id="section-b.1-1.7">Added a KDC sub-resource for group members to upload a new public key.<a href="#section-b.1-1.7" class="pilcrow">¶</a>
</li>
<li id="section-b.1-1.8">Possible group rekeying following an individual Key Renewal Request.<a href="#section-b.1-1.8" class="pilcrow">¶</a>
</li>
<li id="section-b.1-1.9">Clarified meaning of requirement REQ3; added requirement OPT8.<a href="#section-b.1-1.9" class="pilcrow">¶</a>
</li>
<li id="section-b.1-1.10">Editorial improvements.<a href="#section-b.1-1.10" class="pilcrow">¶</a>
</li>
</ul>
</section>
</div>
<div id="sec-03-04">
<section id="section-b.2">
        <h2 id="name-version-03-to-04">
<a href="#section-b.2" class="section-number selfRef">B.2. </a><a href="#name-version-03-to-04" class="section-name selfRef">Version -03 to -04</a>
        </h2>
<ul>
<li id="section-b.2-1.1">Revised RESTful interface, as to methods and parameters.<a href="#section-b.2-1.1" class="pilcrow">¶</a>
</li>
<li id="section-b.2-1.2">Extended processing of joining request, as to check/retrieval of public keys.<a href="#section-b.2-1.2" class="pilcrow">¶</a>
</li>
<li id="section-b.2-1.3">Revised and extended profile requirements.<a href="#section-b.2-1.3" class="pilcrow">¶</a>
</li>
<li id="section-b.2-1.4">Clarified specific usage of parameters related to signature algorithms/keys.<a href="#section-b.2-1.4" class="pilcrow">¶</a>
</li>
<li id="section-b.2-1.5">Included general content previously in draft-ietf-ace-key-groupcomm-oscore<a href="#section-b.2-1.5" class="pilcrow">¶</a>
</li>
<li id="section-b.2-1.6">Registration of media type and content format application/ace-group+cbor<a href="#section-b.2-1.6" class="pilcrow">¶</a>
</li>
<li id="section-b.2-1.7">Editorial improvements.<a href="#section-b.2-1.7" class="pilcrow">¶</a>
</li>
</ul>
</section>
</div>
<div id="sec-02-03">
<section id="section-b.3">
        <h2 id="name-version-02-to-03">
<a href="#section-b.3" class="section-number selfRef">B.3. </a><a href="#name-version-02-to-03" class="section-name selfRef">Version -02 to -03</a>
        </h2>
<ul>
<li id="section-b.3-1.1">Exchange of information on the countersignature algorithm and related parameters, during the Token POST (Section 3.3).<a href="#section-b.3-1.1" class="pilcrow">¶</a>
</li>
<li id="section-b.3-1.2">Restructured KDC interface, with new possible operations (Section 4).<a href="#section-b.3-1.2" class="pilcrow">¶</a>
</li>
<li id="section-b.3-1.3">Client PoP signature for the Joining Request upon joining (Section 4.1.2.1).<a href="#section-b.3-1.3" class="pilcrow">¶</a>
</li>
<li id="section-b.3-1.4">Revised text on group member removal (Section 5).<a href="#section-b.3-1.4" class="pilcrow">¶</a>
</li>
<li id="section-b.3-1.5">Added more profile requirements (Appendix A).<a href="#section-b.3-1.5" class="pilcrow">¶</a>
</li>
</ul>
</section>
</div>
<div id="sec-01-02">
<section id="section-b.4">
        <h2 id="name-version-01-to-02">
<a href="#section-b.4" class="section-number selfRef">B.4. </a><a href="#name-version-01-to-02" class="section-name selfRef">Version -01 to -02</a>
        </h2>
<ul>
<li id="section-b.4-1.1">Editorial fixes.<a href="#section-b.4-1.1" class="pilcrow">¶</a>
</li>
<li id="section-b.4-1.2">Distinction between transport profile and application profile (Section 1.1).<a href="#section-b.4-1.2" class="pilcrow">¶</a>
</li>
<li id="section-b.4-1.3">New parameters 'sign_info' and 'pub_key_enc' to negotiate parameter values for signature algorithm and signature keys (Section 3.3).<a href="#section-b.4-1.3" class="pilcrow">¶</a>
</li>
<li id="section-b.4-1.4">New parameter 'type' to distinguish different Key Distribution Request messages (Section 4.1).<a href="#section-b.4-1.4" class="pilcrow">¶</a>
</li>
<li id="section-b.4-1.5">New parameter 'client_cred_verify' in the Key Distribution Request to convey a Client signature (Section 4.1).<a href="#section-b.4-1.5" class="pilcrow">¶</a>
</li>
<li id="section-b.4-1.6">Encoding of 'pub_keys_repos' (Section 4.1).<a href="#section-b.4-1.6" class="pilcrow">¶</a>
</li>
<li id="section-b.4-1.7">Encoding of 'mgt_key_material' (Section 4.1).<a href="#section-b.4-1.7" class="pilcrow">¶</a>
</li>
<li id="section-b.4-1.8">Improved description on retrieval of new or updated keying material (Section 6).<a href="#section-b.4-1.8" class="pilcrow">¶</a>
</li>
<li id="section-b.4-1.9">Encoding of 'get_pub_keys' in Public Key Request (Section 7.1).<a href="#section-b.4-1.9" class="pilcrow">¶</a>
</li>
<li id="section-b.4-1.10">Extended security considerations (Sections 10.1 and 10.2).<a href="#section-b.4-1.10" class="pilcrow">¶</a>
</li>
<li id="section-b.4-1.11">New "ACE Public Key Encoding" IANA Registry (Section 11.2).<a href="#section-b.4-1.11" class="pilcrow">¶</a>
</li>
<li id="section-b.4-1.12">New "ACE Groupcomm Parameters" IANA Registry (Section 11.3), populated with the entries in Section 8.<a href="#section-b.4-1.12" class="pilcrow">¶</a>
</li>
<li id="section-b.4-1.13">New "Ace Groupcomm Request Type" IANA Registry (Section 11.4), populated with the values in Section 9.<a href="#section-b.4-1.13" class="pilcrow">¶</a>
</li>
<li id="section-b.4-1.14">New "ACE Groupcomm Policy" IANA Registry (Section 11.7) populated with two entries "Sequence Number Synchronization Method" and "Key Update Check Interval" (Section 4.2).<a href="#section-b.4-1.14" class="pilcrow">¶</a>
</li>
<li id="section-b.4-1.15">Improved list of requirements for application profiles (Appendix A).<a href="#section-b.4-1.15" class="pilcrow">¶</a>
</li>
</ul>
</section>
</div>
<div id="sec-00-01">
<section id="section-b.5">
        <h2 id="name-version-00-to-01">
<a href="#section-b.5" class="section-number selfRef">B.5. </a><a href="#name-version-00-to-01" class="section-name selfRef">Version -00 to -01</a>
        </h2>
<ul>
<li id="section-b.5-1.1">Changed name of 'req_aud' to 'audience' in the Authorization Request (Section 3.1).<a href="#section-b.5-1.1" class="pilcrow">¶</a>
</li>
<li id="section-b.5-1.2">Defined error handling on the KDC (Sections 4.2 and 6.2).<a href="#section-b.5-1.2" class="pilcrow">¶</a>
</li>
<li id="section-b.5-1.3">Updated format of the Key Distribution Response as a whole (Section 4.2).<a href="#section-b.5-1.3" class="pilcrow">¶</a>
</li>
<li id="section-b.5-1.4">Generalized format of 'pub_keys' in the Key Distribution Response (Section 4.2).<a href="#section-b.5-1.4" class="pilcrow">¶</a>
</li>
<li id="section-b.5-1.5">Defined format for the message to request leaving the group (Section 5.2).<a href="#section-b.5-1.5" class="pilcrow">¶</a>
</li>
<li id="section-b.5-1.6">Renewal of individual keying material and methods for group rekeying initiated by the KDC (Section 6).<a href="#section-b.5-1.6" class="pilcrow">¶</a>
</li>
<li id="section-b.5-1.7">CBOR type for node identifiers in 'get_pub_keys' (Section 7.1).<a href="#section-b.5-1.7" class="pilcrow">¶</a>
</li>
<li id="section-b.5-1.8">Added section on parameter identifiers and their CBOR keys (Section 8).<a href="#section-b.5-1.8" class="pilcrow">¶</a>
</li>
<li id="section-b.5-1.9">Added request types for requests to a Join Response (Section 9).<a href="#section-b.5-1.9" class="pilcrow">¶</a>
</li>
<li id="section-b.5-1.10">Extended security considerations (Section 10).<a href="#section-b.5-1.10" class="pilcrow">¶</a>
</li>
<li id="section-b.5-1.11">New IANA registries "ACE Groupcomm Key Registry", "ACE Groupcomm Profile Registry", "ACE Groupcomm Policy Registry" and "Sequence Number Synchronization Method Registry" (Section 11).<a href="#section-b.5-1.11" class="pilcrow">¶</a>
</li>
<li id="section-b.5-1.12">Added appendix about requirements for application profiles of ACE on group communication (Appendix A).<a href="#section-b.5-1.12" class="pilcrow">¶</a>
</li>
</ul>
</section>
</div>
</section>
</div>
<div id="acknowledgments">
<section id="section-appendix.c">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="section-appendix.c-1">The following individuals were helpful in shaping this document: Carsten Bormann, Rikard Hoeglund, Ben Kaduk, John Mattsson, Daniel Migault, Jim Schaad, Ludwig Seitz, Goeran Selander and Peter van der Stok.<a href="#section-appendix.c-1" class="pilcrow">¶</a></p>
<p id="section-appendix.c-2">The work on this document has been partly supported by VINNOVA and the Celtic-Next project CRITISEC; and by the EIT-Digital High Impact Initiative ACTIVE.<a href="#section-appendix.c-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="section-appendix.d">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Francesca Palombini</span></div>
<div dir="auto" class="left"><span class="org">Ericsson AB</span></div>
<div dir="auto" class="left"><span class="street-address">Torshamnsgatan 23</span></div>
<div dir="auto" class="left">SE-<span class="postal-code">16440 Stockholm</span> <span class="locality">Kista</span>
</div>
<div dir="auto" class="left"><span class="country-name">Sweden</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:francesca.palombini@ericsson.com" class="email">francesca.palombini@ericsson.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Marco Tiloca</span></div>
<div dir="auto" class="left"><span class="org">RISE AB</span></div>
<div dir="auto" class="left"><span class="street-address">Isafjordsgatan 22</span></div>
<div dir="auto" class="left">SE-<span class="postal-code">16440 Stockholm</span> <span class="locality">Kista</span>
</div>
<div dir="auto" class="left"><span class="country-name">Sweden</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:marco.tiloca@ri.se" class="email">marco.tiloca@ri.se</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
