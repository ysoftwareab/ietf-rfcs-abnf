CATEGORIES=...
PARAM="\"foo\",\"bar\"" becomes <param>"foo","bar"</param>.

href="http://www.example.com">My web page!</a>
href="http://www.example.com">My web page!</a>
value-text = element text { text }
value-text-list = value-text+
value-uri = element uri { xsd:anyURI }
value-date = element date {
    xsd:string { pattern = "\d{8}|\d{4}-\d\d|--\d\d(\d\d)?|---\d\d" }
  }
value-time = element time {
    xsd:string { pattern = "(\d\d(\d\d(\d\d)?)?|-\d\d(\d\d?)|--\d\d)"
                         ~ "(Z|[+\-]\d\d(\d\d)?)?" }
  }
value-date-time = element date-time {
    xsd:string { pattern = "(\d{8}|--\d{4}|---\d\d)T\d\d(\d\d(\d\d)?)?"
                         ~ "(Z|[+\-]\d\d(\d\d)?)?" }
  }
value-date-and-or-time = value-date | value-date-time | value-time
value-timestamp = element timestamp {
    xsd:string { pattern = "\d{8}T\d{6}(Z|[+\-]\d\d(\d\d)?)?" }
  }
value-boolean = element boolean { xsd:boolean }
value-integer = element integer { xsd:integer }
value-float = element float { xsd:float }
value-binary = element binary { xsd:base64Binary }
value-language-tag = element language-tag {
    xsd:string { pattern = "([a-z]{2,3}((-[a-z]{3}){0,3})?|[a-z]{4,8})"
                         ~ "(-[a-z]{4})?(-([a-z]{2}|\d{3}))?"
                         ~ "(-([0-9a-z]{5,8}|\d[0-9a-z]{3}))*"
                         ~ "(-[0-9a-wyz](-[0-9a-z]{2,8})+)*"
                         ~ "(-x(-[0-9a-z]{1,8})+)?|x(-[0-9a-z]{1,8})+|"
                         ~ "[a-z]{1,3}(-[0-9a-z]{2,8}){1,2}" }
  }

param-language = element language { value-language-tag }?
param-pref = element pref {
    xsd:integer { minInclusive = "1" maxInclusive = "100" }
  }?
param-pid = element pid {
    xsd:string { pattern = "\d+(\.\d+)?" }
  }?
param-type = element type { "work" | "home" }*
param-calscale = element calscale { "gregorian" }?
param-sort-as = element sort-as { value-text+ }?
param-version = element version { value-text }?
param-geo = element geo { value-uri }?
param-tz = element tz { value-text | value-uri }?
param-fmttype = element fmttype {
    xsd:string { pattern = "[a-zA-Z0-9!#$&.+\-^_]{1,127}/"
                         ~ "[a-zA-Z0-9!#$&.+\-^_]{1,127}" }
  }?

property-source = element source {
    element parameters { param-pid, param-pref },
    value-uri
  }
property-name = element name { value-text }
property-kind = element kind {
    element text { "individual" | "group" | "org" |
                   "location" | "thing" }*
  }
property-fn = element fn {
    element parameters { param-language, param-pid,
                         param-pref, param-type }?,
    value-text
  }
property-n = element n {
    element parameters { param-language, param-sort-as }?,
    element surname { value-text-list? },
    element given { value-text-list? },
    element prefix { value-text-list? },
    element suffix { value-text-list? }
  }
property-nickname = element nickname {
    element parameters { param-language, param-pid,
                         param-pref, param-type }?,
    value-text-list
  }
property-photo = element photo {
    element parameters {
      param-pid,
      param-pref,
      param-type,
      param-fmttype
    }?,
    (value-binary | value-uri)
  }
property-bday = element bday {
    element parameters { param-calscale }?,
    (value-date-and-or-time | value-text)
  }
property-dday = element dday {
    element parameters { param-calscale }?,
    (value-date-and-or-time | value-text)
  }
property-birth = element birth {
    element parameters { param-language }?,
    (value-text | value-uri)
  }
property-death = element death {
    element parameters { param-language }?,
    (value-text | value-uri)
  }
property-anniversary = element anniversary {
    element parameters { param-calscale }?,
    (value-date-and-or-time | value-text)
  }
property-sex = element sex {
    element integer { "0" | "1" | "2" | "9" }
  }
property-adr = element adr {
    element parameters {
      param-language,
      param-pid,
      param-pref,
      param-type,
      param-geo,
      param-tz
    }?,
    element pobox { value-text-list? },
    element ext { value-text-list? },
    element street { value-text-list? },
    element locality { value-text-list? },
    element region { value-text-list? },
    element code { value-text-list? },
    element country { value-text-list? }
  }
property-label = element label {
    element parameters { param-language, param-pid,
                         param-pref, param-type }?,
    value-text
  }
property-tel = element tel {
    element parameters {
      param-pid,
      param-pref,
      element type { "work" | "home" | "text" | "voice"
                   | "fax" | "cell" | "video" | "pager"
                   | "textphone" }*
    },
    value-uri
  }
property-email = element email {
    element parameters { param-pid, param-pref, param-type }?,
    value-text
  }
property-impp = element impp {
    element parameters { param-pid, param-pref, param-type }?,
    value-uri
  }
property-lang = element lang {
    element parameters { param-pid, param-pref, param-type }?,
    value-language-tag
  }
property-tz = element tz {
    element parameters { param-pid, param-pref, param-type }?,
    (value-text | value-uri)
  }
property-geo = element geo {
    element parameters { param-pid, param-pref, param-type }?,
    value-uri
  }
property-title = element title {
    element parameters { param-language, param-pid,
                         param-pref, param-type }?,
    value-text
  }
property-role = element role {
    element parameters { param-language, param-pid,
                         param-pref, param-type }?,
    value-text
  }
property-logo = element logo {
    element parameters {
      param-language,
      param-pid,
      param-pref,
      param-type,
      param-fmttype
    }?,
    (value-binary | value-uri)
  }
property-org = element org {
    element parameters { param-language, param-pid,
                         param-pref, param-type, param-sort-as }?,
    value-text-list
  }
property-member = element member { param-pid, param-pref, value-uri }
property-related = element related {
    element parameters {
      param-pid,
      param-pref,
      element type { "work" | "home" | "parent" | "child"
        | "sibling" | "spouse" | "family" | "friend"
        | "supervisor" | "supervisee" | "assistant"
        | "colleague" | "agent" | "emergency" }*
    }?,
    (value-uri | value-text)
  }
property-categories = element categories {
    element parameters { param-pid, param-pref, param-type }?,
    value-text
  }
property-note = element note {
    element parameters { param-language, param-pid,
                         param-pref, param-type }?,
    value-text
  }
property-prodid = element prodid { value-text }
property-rev = element rev { value-timestamp }
property-sound = element sound {
    element parameters {
      param-language,
      param-pid,
      param-pref,
      param-type,
      param-fmttype
    }?,
    (value-binary | value-uri)
  }
property-uid = element uid { value-uri }
property-clientpidmap = element clientpidmap {
    element sourceid { xsd:positiveInteger },
    value-uri
  }
property-url = element url {
    element parameters { param-pid, param-pref, param-type }?,
    value-uri
  }
property-class = element class {
    element text { "PUBLIC" | "PRIVATE" | "CONFIDENTIAL" }
  }
property-key = element key {
    element parameters {
      param-pid,
      param-pref,
      param-type,
      param-fmttype
    }?,
    (value-binary | value-uri | value-text)
  }
property-fburl = element fburl {
    element parameters { param-pid, param-pref, param-type }?,
    value-uri
  }
property-caladruri = element caladruri {
    element parameters { param-pid, param-pref, param-type }?,
    value-uri
  }
property-caluri = element caluri {
    element parameters { param-pid, param-pref, param-type }?,
    value-uri
  }

property = property-adr | property-anniversary | property-bday
         | property-birth | property-caladruri | property-caluri
         | property-categories | property-class | property-clientpidmap
         | property-dday | property-death | property-email
         | property-fburl | property-fn | property-geo | property-impp
         | property-key | property-kind | property-label | property-lang
         | property-logo | property-member | property-n | property-name
         | property-nickname | property-note | property-org
         | property-photo | property-prodid | property-related
         | property-rev | property-role | property-sex
         | property-sound | property-source | property-tel
         | property-title | property-tz | property-uid | property-url
start = element vcards {
    element vcard {
      (property
       | element group {
           attribute name { text },
           property*
         })+
    }+
  }
