



Internet Engineering Task Force                               M. Baushke
Internet-Draft                                    Juniper Networks, Inc.
Updates: 4250, 4253 (if approved)                            May 8, 2017
Intended status: Standards Track
Expires: November 9, 2017


 More Modular Exponential (MODP) Diffie-Hellman (DH) Key Exchange (KEX)
                     Groups for Secure Shell (SSH)
                 draft-ietf-curdle-ssh-modp-dh-sha2-05

Abstract

   This document defines added Modular Exponential (MODP) Groups for the
   Secure Shell (SSH) protocol using SHA-2 hashes.  This document
   updates RFC 4250.  This document updates RFC 4253.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at http://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on November 9, 2017.

Copyright Notice

   Copyright (c) 2017 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (http://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.



Baushke                 Expires November 9, 2017                [Page 1]

Internet-Draft       More MODP DH KEX Groups for SSH            May 2017


   This document may contain material from IETF Documents or IETF
   Contributions published or made publicly available before November
   10, 2008.  The person(s) controlling the copyright in some of this
   material may not have granted the IETF Trust the right to allow
   modifications of such material outside the IETF Standards Process.
   Without obtaining an adequate license from the person(s) controlling
   the copyright in such materials, this document may not be modified
   outside the IETF Standards Process, and derivative works of it may
   not be created outside the IETF Standards Process, except to format
   it for publication as an RFC or to translate it into languages other
   than English.

1.  Overview and Rationale

   Secure Shell (SSH) is a common protocol for secure communication on
   the Internet.  Due to recent security concerns with SHA-1 [RFC6194]
   and with MODP groups with less than 2048 bits [NIST-SP-800-131Ar1]
   implementer and users request support for larger Diffie Hellman (DH)
   MODP group sizes with data integrity verification using the SHA-2
   family of secure hash algorithms as well as MODP groups providing
   more security.

   The United States Information Assurance Directorate at the National
   Security Agency has published a FAQ [MFQ-U-OO-815099-15] suggesting
   both: a) DH groups using less than 3072-bits, and b) the use of SHA-2
   based hashes less than SHA2-384, are no longer sufficient for
   transport of Top Secret information.  For this reason, the new MODP
   groups are being introduced starting with the MODP 3072-bit group 15
   are all using SHA2-512 as the hash algorithm.

   The DH 2048-bit MODP group 14 is already present in most SSH
   implementations and most implementations already have a SHA2-256
   implementation, so diffie-hellman-group14-sha256 is provided as an
   easy to implement and faster to use key exchange for small embedded
   applications.

   It is intended that these new MODP groups with SHA-2 based hashes
   update the [RFC4253] section 6.4 and [RFC4250] section 4.10
   standards.

   [TO BE REMOVED: Please send comments on this draft to
   curdle@ietf.org.]

2.  Requirements Language

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in RFC 2119 [RFC2119].



Baushke                 Expires November 9, 2017                [Page 2]

Internet-Draft       More MODP DH KEX Groups for SSH            May 2017


3.  Key Exchange Algorithms

   This memo adopts the style and conventions of [RFC4253] in specifying
   how the use of new data key exchange is indicated in SSH.

   The following new key exchange algorithms are defined:

   Key Exchange Method Name
   diffie-hellman-group14-sha256
   diffie-hellman-group15-sha512
   diffie-hellman-group16-sha512
   diffie-hellman-group17-sha512
   diffie-hellman-group18-sha512

                                 Figure 1

   The SHA-2 family of secure hash algorithms are defined in [RFC6234].

   The method of key exchange used for the name "diffie-hellman-
   group14-sha256" is the same as that for "diffie-hellman-group14-sha1"
   except that the SHA2-256 hash algorithm is used.  It is recommended
   that diffie-hellman-group14-sha256 SHOULD be supported to smooth the
   transition to newer group sizes.

   The group15 through group18 names are the same as those specified in
   [RFC3526] 3072-bit MODP Group 15, 4096-bit MODP Group 16, 6144-bit
   MODP Group 17, and 8192-bit MODP Group 18.

   The SHA2-512 algorithm is to be used when "sha512" is specified as a
   part of the key exchange method name.

4.  IANA Considerations

   This document augments the Key Exchange Method Names in [RFC4253] and
   [RFC4250].

   IANA is requested to add to the Key Exchange Method Names algorithm
   registry [IANA-KEX] with the following entries:

                 Key Exchange Method Name      Reference
                 ----------------------------- ----------
                 diffie-hellman-group14-sha256 This Draft
                 diffie-hellman-group15-sha512 This Draft
                 diffie-hellman-group16-sha512 This Draft
                 diffie-hellman-group17-sha512 This Draft
                 diffie-hellman-group18-sha512 This Draft





Baushke                 Expires November 9, 2017                [Page 3]

Internet-Draft       More MODP DH KEX Groups for SSH            May 2017


   [TO BE REMOVED: This registration should take place at the following
   location: <http://www.iana.org/assignments/ssh-parameters/ssh-
   parameters.xhtml#ssh-parameters-16>]

5.  Security Considerations

   The security considerations of [RFC4253] apply to this document.

   The security considerations of [RFC3526] suggest that these MODP
   groups have security strengths given in this table.  They are based
   on [RFC3766] Determining Strengths For Public Keys Used For
   Exchanging Symmetric Keys.

   Group modulus security strength estimates (RFC3526)

   +--------+----------+---------------------+---------------------+
   | Group  | Modulus  | Strength Estimate 1 | Strength Estimate 2 |
   |        |          +----------+----------+----------+----------+
   |        |          |          | exponent |          | exponent |
   |        |          | in bits  | size     | in bits  | size     |
   +--------+----------+----------+----------+----------+----------+
   |  14    | 2048-bit |      110 |     220- |      160 |     320- |
   |  15    | 3072-bit |      130 |     260- |      210 |     420- |
   |  16    | 4096-bit |      150 |     300- |      240 |     480- |
   |  17    | 6144-bit |      170 |     340- |      270 |     540- |
   |  18    | 8192-bit |      190 |     380- |      310 |     620- |
   +--------+----------+---------------------+---------------------+

                                 Figure 2

   Using a fixed set of Diffie-Hellman parameters makes them a high
   value target for precomputation.  Generating additional sets of
   primes to be used, or moving to larger values is a mitigation against
   this issue.  Care should be taken to avoid backdoored primes ([SNFS])
   by using "nothing up my sleve" parameters.

6.  References

6.1.  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <http://www.rfc-editor.org/info/rfc2119>.







Baushke                 Expires November 9, 2017                [Page 4]

Internet-Draft       More MODP DH KEX Groups for SSH            May 2017


   [RFC3526]  Kivinen, T. and M. Kojo, "More Modular Exponential (MODP)
              Diffie-Hellman groups for Internet Key Exchange (IKE)",
              RFC 3526, DOI 10.17487/RFC3526, May 2003,
              <http://www.rfc-editor.org/info/rfc3526>.

   [RFC4250]  Lehtinen, S. and C. Lonvick, Ed., "The Secure Shell (SSH)
              Protocol Assigned Numbers", RFC 4250,
              DOI 10.17487/RFC4250, January 2006,
              <http://www.rfc-editor.org/info/rfc4250>.

   [RFC4253]  Ylonen, T. and C. Lonvick, Ed., "The Secure Shell (SSH)
              Transport Layer Protocol", RFC 4253, DOI 10.17487/RFC4253,
              January 2006, <http://www.rfc-editor.org/info/rfc4253>.

6.2.  Informative References

   [IANA-KEX]
              Internet Assigned Numbers Authority (IANA), "Secure Shell
              (SSH) Protocol Parameters: Key Exchange Method Names",
              March 2017, <http://www.iana.org/assignments/ssh-
              parameters/ssh-parameters.xhtml#ssh-parameters-16>.

   [MFQ-U-OO-815099-15]
              "National Security Agency/Central Security Service", "CNSA
              Suite and Quantum Computing FAQ", January 2016,
              <https://www.iad.gov/iad/library/ia-guidance/ia-solutions-
              for-classified/algorithm-guidance/cnsa-suite-and-quantum-
              computing-faq.cfm>.

   [NIST-SP-800-131Ar1]
              Barker, and Roginsky, "Transitions: Recommendation for the
              Transitioning of the Use of Cryptographic Algorithms and
              Key Lengths", NIST Special Publication 800-131A Revision
              1, November 2015,
              <http://nvlpubs.nist.gov/nistpubs/SpecialPublications/
              NIST.SP.800-131Ar1.pdf>.

   [RFC3766]  Orman, H. and P. Hoffman, "Determining Strengths For
              Public Keys Used For Exchanging Symmetric Keys", BCP 86,
              RFC 3766, DOI 10.17487/RFC3766, April 2004,
              <http://www.rfc-editor.org/info/rfc3766>.

   [RFC6194]  Polk, T., Chen, L., Turner, S., and P. Hoffman, "Security
              Considerations for the SHA-0 and SHA-1 Message-Digest
              Algorithms", RFC 6194, DOI 10.17487/RFC6194, March 2011,
              <http://www.rfc-editor.org/info/rfc6194>.





Baushke                 Expires November 9, 2017                [Page 5]

Internet-Draft       More MODP DH KEX Groups for SSH            May 2017


   [RFC6234]  Eastlake 3rd, D. and T. Hansen, "US Secure Hash Algorithms
              (SHA and SHA-based HMAC and HKDF)", RFC 6234,
              DOI 10.17487/RFC6234, May 2011,
              <http://www.rfc-editor.org/info/rfc6234>.

   [SNFS]     Fried, , Gaudry, , Heninger, , and Thome, "A kilobit
              hidden SNFS discrete logarithm computation", 2016,
              <http://eprint.iacr.org/2016/961.pdf>.

Author's Address

   Mark D.     Baushke
   Juniper Networks, Inc.
   1133 Innovation Way
   Sunnyvale, CA  94089-1228
   US

   Phone: +1 408 745 2952
   Email: mdb@juniper.net
   URI:   http://www.juniper.net/































Baushke                 Expires November 9, 2017                [Page 6]
