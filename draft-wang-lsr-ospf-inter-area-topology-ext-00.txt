



LSR Working Group                                                A. Wang
Internet-Draft                                             China Telecom
Intended status: Standards Track                           June 28, 2018
Expires: December 30, 2018


             OSPF Extend for Inter-Area Topology Retrieval
             draft-wang-lsr-ospf-inter-area-topology-ext-00

Abstract

   This document describes method to transfer the source router id of
   inter-area prefixes for OSPFv2 [RFC2328] and OSPFv3 [RFC5340], which
   is needed in topology retrieval processing for inter-area scenario.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on December 30, 2018.

Copyright Notice

   Copyright (c) 2018 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (https://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.





Wang                    Expires December 30, 2018               [Page 1]

Internet-Draft             OSPF-Inter-Area-Ext                 June 2018


Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
   2.  Conventions used in this document . . . . . . . . . . . . . .   2
   3.  Inter-Area Topology Retrieval Scenario  . . . . . . . . . . .   3
     3.1.  OSPFv2 Extend Solution (IPv4 Source Router ID)  . . . . .   4
     3.2.  OSPFv3 Extend Solution (IPv6 Source Router ID)  . . . . .   5
     3.3.  Prefix Source Router ID sub TLV . . . . . . . . . . . . .   7
     3.4.  Extend LSA generate process . . . . . . . . . . . . . . .   8
     3.5.  Inter-Area Topology Retrieval Process . . . . . . . . . .   8
   4.  Security Considerations . . . . . . . . . . . . . . . . . . .   8
   5.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .   9
   6.  References  . . . . . . . . . . . . . . . . . . . . . . . . .   9
     6.1.  Normative References  . . . . . . . . . . . . . . . . . .   9
     6.2.  Informative References  . . . . . . . . . . . . . . . . .  10
   Author's Address  . . . . . . . . . . . . . . . . . . . . . . . .  10

1.  Introduction

   BGP-LS [RFC7752] describes the methodology that using BGP protocol to
   transfer the Link-State information.  Such method can enable SDN
   controller to collect the underlay network topology automatically.

   But if the underlay network is divided into multi area and running
   OSPF protocol, it is not easy for the SDN controller to rebuild the
   multi-area topology, because normally the ABR that locates on the
   boundary of different area will hide the detail topology information
   in non-backbone area, and the router in backbone area that runs BGP-
   LS protocol can only get and report the summary network information
   in non-backbone area.

   [RFC7794] introduces "IPv4/IPv6 Source Router IDs" TLV to label the
   source of the prefixes redistributed from different Level, this TLV
   can be used to reconstruct the detail overall topology within level 1
   and level 2.  Such solution can also be applied into network that run
   OSPF protocol, but the related LSP message must be redefined.

   This draft gives such solution for the OSPF v2 and OSPF v3 protocol.

2.  Conventions used in this document

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [RFC2119] .







Wang                    Expires December 30, 2018               [Page 2]

Internet-Draft             OSPF-Inter-Area-Ext                 June 2018


3.  Inter-Area Topology Retrieval Scenario

   Fig.1 illustrates the topology retrieval scenario when OSPF is
   running in multi-area.  R0-R4 are routers in backbone area,
   S1-S4,T1-T4 are interal router in area 1 and area 2 respectively.  R1
   and R3 are border routers between area 0 and area 1; R2 and R4 are
   border routers between area 0 and area 2.  N1 is the network between
   router S1 and S2, N2 is the network between router T1 and T2.

   Normally, ABR router R1 or R3 will send the summary LSA(for OSPFv2)
   or Inter-Area-Prefix-LSAs(for OSPFv3) for network N1.  When R0
   receives such LSA, it can only know network N1 locates behind R1, and
   does not know where it is originated.  When R0 reports the summary
   LSA information via BGP-LS protocol, the IP SDN controller can't
   certainly deduce the detail network topology within area 1.  The
   situation is same as that in Area 2.

                            +-----------------+
                            |IP SDN Controller|
                            +--------+--------+
                                     |
                                     |BGP-LS
                                     |
        +---------------------+------+--------+-----+--------------+
        | +--+        +--+   ++-+   ++-+    +-++   + -+        +--+|
        | |S1+--------+S2+---+R1+---|R0+----+R2+---+T1+--------+T2||
        | +-++   N1   +-++   ++-+   +--+    +-++   ++++   N2   +-++|
        |   |           |     |               |     ||           | |
        |   |           |     |               |     ||           | |
        | +-++        +-++   ++-+           +-++   ++++        +-++|
        | |S4+--------+S3+---+R3+-----------+R4+---+T3+--------+T4||
        | +--+        +--+   ++-+           +-++   ++-+        +--+|
        |                     |               |                    |
        |                     |               |                    |
        |         Area 1      |     Area 0    |      Area 2        |
        +---------------------+---------------+--------------------+

              Fig.1 OSPF Inter-Area Topology Retrieval Scenario

   If R0 has some methods to know the originator of network N1 and
   reports such information to IP SDN controller, then it is easy for
   the controller to retrieval the detail topology in non-backbone area.

   Because traditional OSPFv2/v3 packet is not in the TLV format, we
   need to find some solutions to reuse or redefine the existing fields
   in summary LSA (OSPFv2) and Inter-Area-Prefix-LSAs(for OSPFv3)to
   transfer the additional information.  The extend methods should not
   conflict with the usage of existing semantics.



Wang                    Expires December 30, 2018               [Page 3]

Internet-Draft             OSPF-Inter-Area-Ext                 June 2018


   Section 3.1 and section 3.2 give the proposed solutions for OSPFv2
   and OSPFv3 respectively.

3.1.  OSPFv2 Extend Solution (IPv4 Source Router ID)

   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |            LS age             |     Options   |    3 or 4     |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                        Link State ID                          |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                     Advertising Router                        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                     LS sequence number                        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |         LS checksum           |             length            |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                         Network Mask                          |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      0        |                  metric                       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     TOS       |                TOS  metric                    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                              ...                              |

                          Fig.2  Summary LSA Format

   Fig.2 illustrates the format of summary LSA.  There is one byte that
   originately defined for the number of TOS types but in actually this
   feature does not applied in real network or implemented in the main
   stream router.

   To transfer the additional information, this draft proposes to reuse/
   redefine this field.  In order to prevent possible conflict, even it
   is in very rare event, we can start the usage of this field from the
   upper limit, for example, 0xFE.  Then the proposed extend summary LSA
   format is the followings:













Wang                    Expires December 30, 2018               [Page 4]

Internet-Draft             OSPF-Inter-Area-Ext                 June 2018


   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |            LS age             |     Options   |    3 or 4     |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                        Link State ID                          |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                     Advertising Router                        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                     LS sequence number                        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |         LS checksum           |             length            |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                         Network Mask                          |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     0xFE      |                  metric                       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                IPv4 Source Router ID                          |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                          Area ID                              |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                       Fig.3  Extended Summary LSA Format

   That is to say, if the field of "Numbers of TOS" equal "0xFE", then
   the "IPv4 Source Router ID"(4 bytes) of the inter-area network
   reported in summary LSA and its associated area id(4 bytes) are
   included in the field that follows the "metric" field.

3.2.  OSPFv3 Extend Solution (IPv6 Source Router ID)





















Wang                    Expires December 30, 2018               [Page 5]

Internet-Draft             OSPF-Inter-Area-Ext                 June 2018


   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |           LS Age              |0|0|1|          3              |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                       Link State ID                           |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                    Advertising Router                         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                    LS Sequence Number                         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |        LS Checksum            |            Length             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      0        |                  Metric                       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   | PrefixLength  | PrefixOptions |              0                |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                        Address Prefix                         |
   |                             ...                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                   Fig.4 Inter-Area-Prefix-LSA Format

   For OSPFv3, this draft proposes the similar method, because the
   semantic of the Inter-Area-Prefix-LSA format is almost same as the
   summary LSA format.

























Wang                    Expires December 30, 2018               [Page 6]

Internet-Draft             OSPF-Inter-Area-Ext                 June 2018


   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |           LS Age              |0|0|1|          3              |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                       Link State ID                           |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                    Advertising Router                         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                    LS Sequence Number                         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |        LS Checksum            |            Length             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      0xFE     |                  Metric                       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                Prefix Source Router ID                        |
   |                             ...                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                         Area ID                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   | PrefixLength  | PrefixOptions |              0                |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                        Address Prefix                         |
   |                             ...                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
           Fig.5 Extended Inter-Area-Prefix-LSA Format

   If the value of "Numbers of TOS" equal "0xFE", then the "IPv6 source
   router ID" (16 bytes) and its corresponding area ID (4 bytes)
   information are inserted in the "Inter-Area-Prefix-LSA" after the
   field "Metric".  After this, the normal Prefix information is
   followed as shown in Fig.5

3.3.  Prefix Source Router ID sub TLV

   [RFC7684] and [RFC8362] define the TLV format extension for OSPFv2
   and OSPFv3 respectively.  These documents give the flexibility to add
   new attributes for the prefixes and links.  Based on these formats,
   we can define new sub TLV to transfer the "Prefix Source Router ID",
   as that defined in [RFC7794].

   The proposed "Prefix Source Router ID" format is the following:

   For IPv4 network, it is the following:

   o  Pv4 Source Router ID Type: TBD

   o  Length: 4



Wang                    Expires December 30, 2018               [Page 7]

Internet-Draft             OSPF-Inter-Area-Ext                 June 2018


   o  Value: IPv4 Router ID of the source of the advertisement

   This sub TLV should be included in the "OSPFv2 Extended Prefix Opaque
   LSA" that defined in [RFC7684]

   For IPv6 network, it is the following:

   o  IPv6 Source Router ID Type: TBD

   o  Length: 16

   o  Value: IPv6 Router ID of the source of the advertisement

   This sub TLV should be included in "E-Inter-Area-Prefix-LSA" that
   defined in [RFC8362]

3.4.  Extend LSA generate process

   When ABR(for example R1 in Fig.1)receives the "Router LSA"
   announcement in area 1, it should generate the corresponding extend
   "Summary LSA" or "Inter-Area-Prefix-LSA" that includes the "Source
   Router ID" of the network prefixes, which labels the corresponding
   link and the "area ID" that the source router belongs to.

   When R0 receives such extend LSA, it then strips this additional
   information, put it into the corresponding part that in BGP-LS
   protocol as described in[I-D.wang-idr-bgpls-inter-as-topology-ext]
   and reports them to the IP SDN Controller.

3.5.  Inter-Area Topology Retrieval Process

   When IP SDN Controller receives this information, it should compare
   the prefix NLRI that included in the BGP-LS packet.  When it
   encounters the same prefix but with different source router ID, it
   should extract the corresponding area ID, rebuild the link between
   these two different source router in non-backbone area.

   Iterating the above process continuously, the IP SDN controller can
   then retrieve the detail topology that span multi-area.

4.  Security Considerations

   TBD.








Wang                    Expires December 30, 2018               [Page 8]

Internet-Draft             OSPF-Inter-Area-Ext                 June 2018


5.  IANA Considerations

   TBD.

6.  References

6.1.  Normative References

   [I-D.ietf-pce-pcep-extension-native-ip]
              Wang, A., Khasanov, B., Cheruathur, S., and C. Zhu, "PCEP
              Extension for Native IP Network", draft-ietf-pce-pcep-
              extension-native-ip-00 (work in progress), June 2018.

   [I-D.ietf-teas-native-ip-scenarios]
              Wang, A., Huang, X., Qou, C., Huang, L., and K. Mi, "CCDR
              Scenario, Simulation and Suggestion", draft-ietf-teas-
              native-ip-scenarios-00 (work in progress), February 2018.

   [I-D.ietf-teas-pcecc-use-cases]
              Zhao, Q., Li, Z., Khasanov, B., Ke, Z., Fang, L., Zhou,
              C., Communications, T., and A. Rachitskiy, "The Use Cases
              for Using PCE as the Central Controller(PCECC) of LSPs",
              draft-ietf-teas-pcecc-use-cases-01 (work in progress), May
              2017.

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <https://www.rfc-editor.org/info/rfc2119>.

   [RFC2328]  Moy, J., "OSPF Version 2", STD 54, RFC 2328,
              DOI 10.17487/RFC2328, April 1998,
              <https://www.rfc-editor.org/info/rfc2328>.

   [RFC5340]  Coltun, R., Ferguson, D., Moy, J., and A. Lindem, "OSPF
              for IPv6", RFC 5340, DOI 10.17487/RFC5340, July 2008,
              <https://www.rfc-editor.org/info/rfc5340>.

   [RFC7684]  Psenak, P., Gredler, H., Shakir, R., Henderickx, W.,
              Tantsura, J., and A. Lindem, "OSPFv2 Prefix/Link Attribute
              Advertisement", RFC 7684, DOI 10.17487/RFC7684, November
              2015, <https://www.rfc-editor.org/info/rfc7684>.

   [RFC7752]  Gredler, H., Ed., Medved, J., Previdi, S., Farrel, A., and
              S. Ray, "North-Bound Distribution of Link-State and
              Traffic Engineering (TE) Information Using BGP", RFC 7752,
              DOI 10.17487/RFC7752, March 2016,
              <https://www.rfc-editor.org/info/rfc7752>.



Wang                    Expires December 30, 2018               [Page 9]

Internet-Draft             OSPF-Inter-Area-Ext                 June 2018


   [RFC7794]  Ginsberg, L., Ed., Decraene, B., Previdi, S., Xu, X., and
              U. Chunduri, "IS-IS Prefix Attributes for Extended IPv4
              and IPv6 Reachability", RFC 7794, DOI 10.17487/RFC7794,
              March 2016, <https://www.rfc-editor.org/info/rfc7794>.

   [RFC8362]  Lindem, A., Roy, A., Goethals, D., Reddy Vallem, V., and
              F. Baker, "OSPFv3 Link State Advertisement (LSA)
              Extensibility", RFC 8362, DOI 10.17487/RFC8362, April
              2018, <https://www.rfc-editor.org/info/rfc8362>.

6.2.  Informative References

   [I-D.wang-idr-bgpls-inter-as-topology-ext]
              Wang, A., "BGP-LS extend for inter-AS topology retrieval",
              draft-wang-idr-bgpls-inter-as-topology-ext-00 (work in
              progress), March 2018.

Author's Address

   Aijun Wang
   China Telecom
   Beiqijia Town, Changping District
   Beijing, Beijing  102209
   China

   Email: wangaj.bri@chinatelecom.cn

























Wang                    Expires December 30, 2018              [Page 10]
