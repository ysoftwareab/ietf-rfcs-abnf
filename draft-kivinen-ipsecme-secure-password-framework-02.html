<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Secure Password Framework for IKEv2</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.2" rel="Chapter" title="2 Method Negotiation">
<link href="#rfc.section.3" rel="Chapter" title="3 Generic Secure Password Method Payload">
<link href="#rfc.section.4" rel="Chapter" title="4 IKE_AUTH Exchange">
<link href="#rfc.section.5" rel="Chapter" title="5 Security Considerations">
<link href="#rfc.section.6" rel="Chapter" title="6 IANA Considerations">
<link href="#rfc.references" rel="Chapter" title="7 References">
<link href="#rfc.references.1" rel="Chapter" title="7.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="7.2 Informative References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="This document creates a generic way for Internet Key Exchange (IKEv2) to use any of the symmetric secure password authentication methods. There are multiple methods already specified in other documents and this document does not add new one. This document specifies a way to agree on which method is to be used in current connection. This document also provides a common way to transmit secure password authentication method specific payloads between peers." />
  <meta name="description" content="This document creates a generic way for Internet Key Exchange (IKEv2) to use any of the symmetric secure password authentication methods. There are multiple methods already specified in other documents and this document does not add new one. This document specifies a way to agree on which method is to be used in current connection. This document also provides a common way to transmit secure password authentication method specific payloads between peers." />
  <meta name="keywords" content="" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Network Working Group</td>
<td class="right">T. Kivinen</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">AuthenTec</td>
</tr>
<tr>
<td class="left">Intended status: Informational</td>
<td class="right">August 24, 2011</td>
</tr>
<tr>
<td class="left">Expires: February 25, 2012</td>
<td class="right"></td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Secure Password Framework for IKEv2<br />
  <span class="filename">draft-kivinen-ipsecme-secure-password-framework-02.txt</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>This document creates a generic way for Internet Key Exchange (IKEv2) to use any of the symmetric secure password authentication methods. There are multiple methods already specified in other documents and this document does not add new one. This document specifies a way to agree on which method is to be used in current connection. This document also provides a common way to transmit secure password authentication method specific payloads between peers.</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on February 25, 2012.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>2.   <a href="#rfc.section.2">Method Negotiation</a>
</li>
<li>3.   <a href="#rfc.section.3">Generic Secure Password Method Payload</a>
</li>
<li>4.   <a href="#rfc.section.4">IKE_AUTH Exchange</a>
</li>
<li>5.   <a href="#rfc.section.5">Security Considerations</a>
</li>
<li>6.   <a href="#rfc.section.6">IANA Considerations</a>
</li>
<li>7.   <a href="#rfc.references">References</a>
</li>
<li>7.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>7.2.   <a href="#rfc.references.2">Informative References</a>
</li>
<li><a href="#rfc.authors">Author's Address</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> Introduction</h1>
<p id="rfc.section.1.p.1">The IPsecME working group was chartered to provide IKEv2 (<a href="#RFC5996">[RFC5996]</a>) a symmetric secure password authentication protocol that supports using of low-entropy shared secrets, but which is protected against off-line dictionary attacks without requiring the use of certificates or Extensible Authentication Protocol (EAP). There are multiple of such methods and working group was supposed to pick one. Unfortunately the working group failed to get pick one protocol and there are multiple candidates going forward as separate documents. As each of those documents used a different technique to negotiate the use of the method and also used different payload formats it is very hard to try to make implementation where multiple of those systems could co-exists.</p>
<p id="rfc.section.1.p.2">This document describes a payload formats for IKEv2 which can be used for multiple secure password methods to do negotiation and transmit data so each different method can easily co-exists in the same implementation.</p>
<p id="rfc.section.1.p.3">This document consists of two major parts: </p>

<ul>
<li>How to negotiate which secure password method negotiation is used.</li>
<li>How to transmit secure password method specific data between peers.</li>
</ul>
<p id="rfc.section.1.p.4">The secure password methods are not usually meant to be used in the normal end user (remote access VPN) cases. In such cases the EAP based authentication works fine and the asymmetric nature of the EAP does not matter. In such scenarios the authentication is usually backed up with the back-end AAA-servers and other infrastructure. I.e., in such scenarios neither IKEv2 peers really knows the secret, in one end it is typed in by the user when it is needed, and on the other end it is authenticated by the back-end AAA-server.</p>
<p id="rfc.section.1.p.5">The new secure password methods are meant to be used in cases where such back-end AAA-infrastructure does not exists. An example of such case could be authentication between two servers or routers. These scenarios are usually symmetric: both peers know the shared secret, no back-end authentication servers are involved, and either end can initiate an IKEv2 connection.</p>
<p id="rfc.section.1.p.6">In many cases each implementation will only use only one of the proposed secure password authentication methods, but in many cases the implementations can include support for multiple methods even when only one of them will be used. For example general purpose operating system running IPsec and IKEv2 and supporting secure password authentication methods to protect services provided by the system, might need to implement support for several of the different methods, and it is going to be up to the administrator which one of them are going to be used. As the server might need to connect to multiple other servers, each implementing different set of methods, there might not be possible to pick one method that would be used in all cases.</p>
<p id="rfc.section.1.p.7">The secure password methods mostly keeps the existing IKEv2 IKE_SA_INIT exchange and modify the IKE_AUTH authentication step.  As those methods do not want to add new round trips that means the negotiation of which of the secure password methods to use needs to happen during the IKE_SA_INIT. As the identity of the other end is only provided inside the IKE_AUTH that means that the responder end needs to select the list of supported methods only based on the IP-address of the initiator. This could lead in to the problems if only certain methods would be acceptable for certain identified peers. Fortunately as the authentication is done based on the secret shared between both peers, that shared-secret should be usable in all of the methods, thus remote peer usually does not need to restrict selection of the method based on the initiators identity only based on the supported methods and administrative policy.</p>
<p id="rfc.section.1.p.8">Also as the initiator already knows to which peer it is connecting to it can limit which methods it proposes for the other peer. And as secure password methods are meant to be used in the symmetric cases, both end should have similar configuration, i.e., they have same shared-secret, and most likely both also have list of acceptable (or exactly one acceptable) authentication methods to be used. This could also be interpreted that there is no need to support method negotiation as both ends can already see this from configuration. On the other hand in most cases either end does not really care which of the method is used, they are willing to use any secure method other end supports. In such cases the automatic negotiation provides a way to make the configuration easy, i.e., no need to pick one method to be used between the peers.</p>
<p id="rfc.section.1.p.9">The reason for the common IKEv2 payload to be used to transmit secure password method specific data between peers is that the payload type field in the IKEv2 is only 8-bit field, and 62.5% of the range is already reserved (50% to the private use numbers, and 12.5% to the IKEv1 payload numbers). This leaves 95 usable numbers, where 16 is already in use. The current secure password authentication methods already propose to consume five payload type numbers. This 6% of the unallocated number space is not that big on itself, but nothing says there will be only the current three protocols (<a href="#I-D.harkins-ipsecme-spsk-auth">[I-D.harkins-ipsecme-spsk-auth]</a>, <a href="#I-D.kuegler-ipsecme-pace-ikev2">[I-D.kuegler-ipsecme-pace-ikev2]</a>, and <a href="#I-D.shin-augmented-pake">[I-D.shin-augmented-pake]</a>), and those five new payload types would already be 31% increase to the number of currently allocated payload types.</p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> Method Negotiation</h1>
<p id="rfc.section.2.p.1">Because all of the methods modify the IKE_AUTH exchange, the negotiation of which secure password method is used needs to happen during the IKE_SA_INIT exchange. The secure password negotiation exchange would be:</p>
<div id="#rfc.figure.1"></div>
<pre>
Initiator                         Responder
-------------------------------------------------------------------
HDR(SPIi=xxx, SPIr=0, IKE_SA_INIT,
    Flags: Initiator, Message ID=0),
    SAi1, KEi, Ni, [N(SECURE_PASSWORD_METHODS)]  --&gt;

                   &lt;--  HDR(SPIi=xxx, SPIr=yyy, IKE_SA_INIT,
                            Flags: Response, Message ID=0),
                            SAr1, KEr, Nr, [CERTREQ],
                            [N(SECURE_PASSWORD_METHODS)]
</pre>
<p id="rfc.section.2.p.2">If the N(SECURE_PASSWORD_METHODS) Notify Payload is missing then normal IKEv2 authentication methods are used. If the Notify Payloads are included then the negotiation of the secure password methods happens inside those payloads. </p>
<p id="rfc.section.2.p.3">As it might be possible that future secure password method will modify the IKE_AUTH payload in more substantial way, it is better that as a end result of the negotiation we have exactly one secure password method which will be used. The initiator will know which methods are usable for him when talking to that responder, so initiator will send list of acceptable methods in its IKE_SA_INIT request. The responder will pick exactly one method and put that to its response.</p>
<p id="rfc.section.2.p.4">The secure password methods are identified by the 16-bit IANA allocated numbers stored in to the Notify Payload notification data field. If method supports multiple different password preprocessing methods each of those may be allocated a separate number from this space, or the method might do its own negotiation of the preprocessing method later. As initiator has already selected the shared secret it will be using it will also know which kind of preprocessing might be needed for it, so it should propose only those preprocessing methods suitable for the selected shared secret. This means that allocating multiple IANA numbers for one secure password method one for each preprocessing method is recommended.</p>
<p id="rfc.section.2.p.5">The actual Notify Payload will look like this:</p>
<div id="#rfc.figure.2"></div>
<pre>
                     1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Next Payload  |C|  RESERVED   |         Payload Length        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Protocol ID  |   SPI Size    |      Notify Message Type      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
~                Security Parameter Index (SPI)                 ~
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
~                       Notification Data                       ~
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
<p id="rfc.section.2.p.6">The Protocol ID will be zero, and the SPI Size will also be zero, meaning that the SPI field will be empty. The Notify Message Type will be TBD.</p>
<p id="rfc.section.2.p.7">The Notification Data contains the list of the 16-bit secure password method numbers:</p>
<div id="#rfc.figure.3"></div>
<pre>
                     1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Secure Password Method #1     | Secure Password Method #2     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Secure Password Method #3     | ...                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
<p id="rfc.section.2.p.8">The response Notify Payload contains exactly one 16-bit secure password method number inside the Notification Data field.</p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> Generic Secure Password Method Payload</h1>
<p id="rfc.section.3.p.1">This payload will contain the secure password payload specific data. The IKE_AUTH exchanges might have multiple of these inside, depending what is required and specified by the secure password method selected. As the secure password method is already selected during the IKE_SA_INIT, there is no need to repeat the information of the selected secure password method anymore, thus this payload only contains the method specific data. As some secure password methods do require multiple different payloads they are assumed to include their method specific payload type inside the payload, for example inside the first octet of the data, but this is method specific, and method is free to format the payload data as it feels like.</p>
<p id="rfc.section.3.p.2">The generic secure password method payload will look like this:</p>
<div id="#rfc.figure.4"></div>
<pre>
                     1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Next Payload  |C|  RESERVED   |         Payload Length        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
~          Secure Password Method Specific Data                 ~
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
<p id="rfc.section.3.p.3">The Payload Type for this payload is TBD, and the name used later in this document is GSPM Payload.</p>
<p id="rfc.section.3.p.4">If the method uses secure password method specific payload sub-types inside the generic secure password method payload the format will be something like this:</p>
<div id="#rfc.figure.5"></div>
<pre>
                     1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Next Payload  |C|  RESERVED   |         Payload Length        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| SPMS Subtype  |                                               |
+-+-+-+-+-+-+-+-+                                               +
|                                                               |
~          Secure Password Method Specific Data                 ~
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
<p id="rfc.section.3.p.5">But this picture is here only for illustrative purposes, the secure password method will be defining the exact format of the payload contents.</p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> IKE_AUTH Exchange</h1>
<p id="rfc.section.4.p.1">As the negotiation happens during the IKE_SA_INIT the secure password methods may modify the IKE_AUTH exchange if needed. To make implementing multiple methods easy it would be recommended that the IKE_AUTH exchange is not to be modified unnecessarily.  Adding zero, one or multiple Generic Secure Password Method Payloads to each exchange is needed, as is the modification how the AUTH payload is calculated, but all other changes should be kept minimal. </p>
<p id="rfc.section.4.p.2">The IKE_AUTH exchange should look bit like when EAP is used, meaning that the first request includes IDi, SAi2, TSi, TSr, and some number of GSPM payloads. The response to that should include IDr and again some number of GSPM payloads. There may be multiple exchanges each consisting of some number of GSPM payloads, and finally when authentication is done there should be one final exchange where the request includes the AUTH payload (along with some number of GSPM payloads) and the response contains AUTH, SAr2, TSi, TSr and some number of GSPM payloads. The number of GSPM payloads is up to the secure password method, but usually will less than 3, but it might be more depending on the method.</p>
<p id="rfc.section.4.p.3">The AUTH payload calculation should include all the same data that is normally included in addition to the extra data needed by the secure password method. The secure password method needs to define how the AUTH payload is calculated.</p>
<p id="rfc.section.4.p.4">As the AUTH payload calculation is changed the secure payload method should not use any of the existing authentication methods numbers in the AUTH Payload Auth Method field, but instead use the number allocated in this document. This number is meant to be used by all secure password authentication methods.</p>
<div id="#rfc.figure.6"></div>
<pre>
Initiator                         Responder
-------------------------------------------------------------------
HDR(SPIi=xxx, SPIr=yyy, IKE_AUTH,
    Flags: Initiator, Message ID=1),
    SK {IDi, [CERTREQ,]
        GSPM, [GSPM, ...,]
        [IDr,] SAi2,
        TSi, TSr}  --&gt;

                  &lt;--  HDR(SPIi=xxx, SPIr=yyy, IKE_AUTH, Flags:
                              Response, Message ID=1),
                              SK {IDr, [CERT,]
                                  GSPM, [GSPM, ...]}

HDR(SPIi=xxx, SPIr=yyy, IKE_AUTH,
    Flags: Initiator, Message ID=2),
    SK {GSPM, [GSPM, ...,]}  --&gt;

                  &lt;--  HDR(SPIi=xxx, SPIr=yyy, IKE_AUTH, Flags:
                              Response, Message ID=2),
                              SK {GSPM, [GSPM, ...]}
...

HDR(SPIi=xxx, SPIr=yyy, IKE_AUTH,
    Flags: Initiator, Message ID=x),
    SK {[GSPM, ...,], AUTH}  --&gt;

                  &lt;--  HDR(SPIi=xxx, SPIr=yyy, IKE_AUTH, Flags:
                              Response, Message ID=x),
                              SK {[GSPM, ...,] AUTH, SAr2,
                                  TSi, TSr}
</pre>
<p id="rfc.section.4.p.5">Note that the number of the GSPM payloads and other payloads in each packet will be defined only by the secure password method documentation, and pictures in this document are only for illustrative purposes.</p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> Security Considerations</h1>
<p id="rfc.section.5.p.1">As this document does not describe exact protocol the security considerations are not really relevant. The secure password method document using payload types described here needs to describe the security properties of the protocol it describes.  </p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> IANA Considerations</h1>
<p id="rfc.section.6.p.1">This allocates one new IKEv2 "Notify Messages Types - Status Types":</p>
<div id="#rfc.figure.7"></div>
<pre>
TBD   SECURE_PASSWORD_METHODS
</pre>
<p id="rfc.section.6.p.2">This allocates one new "IKEv2 Authentication Method" number:</p>
<div id="#rfc.figure.8"></div>
<pre>
TBD   Generic Secure Password Authentication Method
</pre>
<p id="rfc.section.6.p.3">This document also adds one new "IKEv2 Payload Types":</p>
<div id="#rfc.figure.9"></div>
<pre>
TBD   Generic Secure Password Method      GSPM
</pre>
<p id="rfc.section.6.p.4">This document creates new IANA registry "IKEv2 Secure Password Methods":</p>
<div id="#rfc.figure.10"></div>
<pre>
0            RESERVED
</pre>
<p id="rfc.section.6.p.5">Values 1-1024 are reserved to IANA. Values 1024-65535 are for private use among mutually consenting parties. Changes and additions to this registry is by expert review.</p>
<h1 id="rfc.references">
<a href="#rfc.references">7.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">7.1.</a> Normative References</h1>
<table><tbody><tr>
<td class="reference"><b id="RFC5996">[RFC5996]</b></td>
<td class="top">
<a>Kaufman, C.</a>, <a>Hoffman, P.</a>, <a>Nir, Y.</a> and <a>P. Eronen</a>, "<a href="http://tools.ietf.org/html/rfc5996">Internet Key Exchange Protocol Version 2 (IKEv2)</a>", RFC 5996, September 2010.</td>
</tr></tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">7.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="I-D.harkins-ipsecme-spsk-auth">[I-D.harkins-ipsecme-spsk-auth]</b></td>
<td class="top">
<a>Harkins, D</a>, "<a href="http://tools.ietf.org/html/draft-harkins-ipsecme-spsk-auth-04">Secure PSK Authentication for IKE</a>", Internet-Draft draft-harkins-ipsecme-spsk-auth-04, April 2011.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.kuegler-ipsecme-pace-ikev2">[I-D.kuegler-ipsecme-pace-ikev2]</b></td>
<td class="top">
<a>Kuegler, D</a> and <a>Y Sheffer</a>, "<a href="http://tools.ietf.org/html/draft-kuegler-ipsecme-pace-ikev2-06">Password Authenticated Connection Establishment with IKEv2</a>", Internet-Draft draft-kuegler-ipsecme-pace-ikev2-06, March 2011.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.shin-augmented-pake">[I-D.shin-augmented-pake]</b></td>
<td class="top">
<a>Shin, S</a> and <a>K Kobara</a>, "<a href="http://tools.ietf.org/html/draft-shin-augmented-pake-08">Most Efficient Augmented Password-Only Authentication and Key Exchange for IKEv2</a>", Internet-Draft draft-shin-augmented-pake-08, July 2011.</td>
</tr>
</tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Author's Address</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Tero Kivinen</span> 
	  <span class="n hidden">
		<span class="family-name">Kivinen</span>
	  </span>
	</span>
	<span class="org vcardline">AuthenTec</span>
	<span class="adr">
	  <span>Eerikinkatu 28</span>

	  <span class="vcardline">
		<span class="locality">HELSINKI</span>,  
		<span class="region"></span>
		<span class="code">FI-00180</span>
	  </span>
	  <span class="country-name vcardline">Finland</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:kivinen@iki.fi">kivinen@iki.fi</a></span>

  </address>
</div>

</body>
</html>