<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>BGP MultiNexthop attribute</title>
<meta content="Kaliraj Vairavakkalai" name="author">
<meta content="Minto Jeyananth" name="author">
<meta content="Gyan Mishra" name="author">
<meta content='
       Today, a BGP speaker can advertise one nexthop for a set of NLRIs in
      an Update. This nexthop can be encoded in either the BGP-Nexthop
      attribute (code 3), or inside the MP_REACH attribute (code 14). 
       For cases where multiple nexthops need to be advertised, BGP-Addpath
      is used. Though Addpath allows basic ability to advertise
      multiple-nexthops, it does not allow the sender to specify desired
      relationship between the multiple nexthops being advertised e.g.,
      relative-preference, type of load-balancing. These are local decisions
      at the receiving speaker based on local configuration and path-selection
      between the various additional-paths, which may tie-break on some
      arbitrary step like Router-Id or BGP nexthop address. 
       Some scenarios with a BGP-free core may benefit from having a
      mechanism, where egress-node can signal multiple-nexthops along with
      their relationship, in one BGP route, to ingress nodes. This document
      defines a new BGP attribute "MultiNexthop (MNH)" that can be used for
      this purpose. 
       This attribute can be used for both labeled and unlabled BGP
      families. The MNH can be used to advertise MPLS label along with nexthop
      for unlabeled families (e.g. Inet Unicast, Inet6 Unicast). Such that,
      mechanisms at the transport layer can work uniformly on labeled and
      unlabled BGP families. Service route scale can be confined closer to the
      service edge nodes, making the transport layer nodes light and nimble.
      They dont have any service route state, only have service end-point
      state. 
       The MNH plays different role in "downstream allocation" scenario than
      "upstream allocation" scenario. E.g. for RFC8277 families that advertise
      downstream allocated labels, the MNH can play the "Label Descriptor"
      role, describing the forwarding semantics of the label being advertised.
      This can be useful in network visualization and controller based traffic
      engineering (e.g. EPE). 
    ' name="description">
<meta content="xml2rfc 3.12.0" name="generator">
<meta content="draft-kaliraj-idr-multinexthop-attribute-02" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.12.0
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.6.4
    pycountry 20.7.3
    pyflakes 2.4.0
    PyYAML 6.0
    requests 2.26.0
    setuptools 59.5.0
    six 1.16.0
    WeasyPrint 52.5
-->
<link href="/tmp/draft-kaliraj-idr-multinexthop-attribute-b47nf2b1.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">BGP MultiNexthop attribute</td>
<td class="right">December 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Vairavakkalai, et al.</td>
<td class="center">Expires 1 July 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-kaliraj-idr-multinexthop-attribute-02</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2021-12-28" class="published">28 December 2021</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-07-01">1 July 2022</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">K. Vairavakkalai</div>
<div class="org">Juniper Networks, Inc.</div>
</div>
<div class="author">
      <div class="author-name">M. Jeyananth</div>
<div class="org">Juniper Networks, Inc.</div>
</div>
<div class="author">
      <div class="author-name">G. Mishra</div>
<div class="org">Verizon Communications Inc.</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">BGP MultiNexthop attribute</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">Today, a BGP speaker can advertise one nexthop for a set of NLRIs in
      an Update. This nexthop can be encoded in either the BGP-Nexthop
      attribute (code 3), or inside the MP_REACH attribute (code 14).<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">For cases where multiple nexthops need to be advertised, BGP-Addpath
      is used. Though Addpath allows basic ability to advertise
      multiple-nexthops, it does not allow the sender to specify desired
      relationship between the multiple nexthops being advertised e.g.,
      relative-preference, type of load-balancing. These are local decisions
      at the receiving speaker based on local configuration and path-selection
      between the various additional-paths, which may tie-break on some
      arbitrary step like Router-Id or BGP nexthop address.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
<p id="section-abstract-3">Some scenarios with a BGP-free core may benefit from having a
      mechanism, where egress-node can signal multiple-nexthops along with
      their relationship, in one BGP route, to ingress nodes. This document
      defines a new BGP attribute "MultiNexthop (MNH)" that can be used for
      this purpose.<a href="#section-abstract-3" class="pilcrow">¶</a></p>
<p id="section-abstract-4">This attribute can be used for both labeled and unlabled BGP
      families. The MNH can be used to advertise MPLS label along with nexthop
      for unlabeled families (e.g. Inet Unicast, Inet6 Unicast). Such that,
      mechanisms at the transport layer can work uniformly on labeled and
      unlabled BGP families. Service route scale can be confined closer to the
      service edge nodes, making the transport layer nodes light and nimble.
      They dont have any service route state, only have service end-point
      state.<a href="#section-abstract-4" class="pilcrow">¶</a></p>
<p id="section-abstract-5">The MNH plays different role in "downstream allocation" scenario than
      "upstream allocation" scenario. E.g. for RFC8277 families that advertise
      downstream allocated labels, the MNH can play the "Label Descriptor"
      role, describing the forwarding semantics of the label being advertised.
      This can be useful in network visualization and controller based traffic
      engineering (e.g. EPE).<a href="#section-abstract-5" class="pilcrow">¶</a></p>
</section>
<section class="note" id="section-note.1">
      <h2 id="name-requirements-language">
<a href="#name-requirements-language" class="section-name selfRef">Requirements Language</a>
      </h2>
<p id="section-note.1-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
      "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
      document are to be interpreted as described in <span><a href="#RFC2119" class="xref">RFC 2119</a> [<a href="#RFC2119" class="xref">RFC2119</a>]</span>.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 1 July 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-use-cases-examples" class="xref">Use-cases examples</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-optimal-forwarding-exit-poi" class="xref">Optimal forwarding exit-points signaling to ingress-node</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1" class="keepWithNext"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-choosing-a-received-label-b" class="xref">Choosing a received label based on it's forwarding-semantic at advertising node</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="xref">2.3</a>.  <a href="#name-signaling-desired-forwardin" class="xref">Signaling desired forwarding behavior when installing MPLS Upstream labels at receiving node</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a href="#section-2.4" class="xref">2.4</a>.  <a href="#name-load-balancing-over-ebgp-pa" class="xref">Load-balancing over EBGP parallel links</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.5">
                <p id="section-toc.1-1.2.2.5.1"><a href="#section-2.5" class="xref">2.5</a>.  <a href="#name-flowspec-routes-with-multip" class="xref">Flowspec routes with multiple Redirect-IP nexthops</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.6">
                <p id="section-toc.1-1.2.2.6.1"><a href="#section-2.6" class="xref">2.6</a>.  <a href="#name-color-only-resolution-nexth" class="xref">Color-Only resolution nexthop</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-the-multinexthop-mnh-bgp-at" class="xref">The "MultiNexthop (MNH)" BGP attribute encoding</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-operations" class="xref">Operations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.1">
                    <p id="section-toc.1-1.3.2.1.2.1.1"><a href="#section-3.1.1" class="xref">3.1.1</a>.  <a href="#name-bgp-capability-for-mnh-attr" class="xref">BGP Capability for MNH attribute</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.2">
                    <p id="section-toc.1-1.3.2.1.2.2.1"><a href="#section-3.1.2" class="xref">3.1.2</a>.  <a href="#name-scope-of-use-and-propagatio" class="xref">Scope of use, and propagation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.3">
                    <p id="section-toc.1-1.3.2.1.2.3.1"><a href="#section-3.1.3" class="xref">3.1.3</a>.  <a href="#name-interaction-of-mnh-with-nex" class="xref">Interaction of MNH with Nexthop (in attr-code 3, 14)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.4">
                    <p id="section-toc.1-1.3.2.1.2.4.1"><a href="#section-3.1.4" class="xref">3.1.4</a>.  <a href="#name-interaction-with-addpath" class="xref">Interaction with Addpath</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.5">
                    <p id="section-toc.1-1.3.2.1.2.5.1"><a href="#section-3.1.5" class="xref">3.1.5</a>.  <a href="#name-path-selection-consideratio" class="xref">Path-selection considerations</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.6">
                    <p id="section-toc.1-1.3.2.1.2.6.1"><a href="#section-3.1.6" class="xref">3.1.6</a>.  <a href="#name-nh-flags-u-bit-denoting-ups" class="xref">NH-Flags U bit, denoting upstream/downstream semantics</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-nexthop-forwarding-semantic" class="xref">Nexthop Forwarding Semantics TLV</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-nexthop-leg-descriptor-tlv" class="xref">Nexthop-Leg Descriptor TLV</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="xref">3.4</a>.  <a href="#name-nexthop-attributes-sub-tlv" class="xref">Nexthop Attributes Sub-TLV</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.1">
                    <p id="section-toc.1-1.3.2.4.2.1.1"><a href="#section-3.4.1" class="xref">3.4.1</a>.  <a href="#name-ip-address" class="xref">IP Address</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.2">
                    <p id="section-toc.1-1.3.2.4.2.2.1"><a href="#section-3.4.2" class="xref">3.4.2</a>.  <a href="#name-labeled-ip-nexthop" class="xref">Labeled IP nexthop</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.3">
                    <p id="section-toc.1-1.3.2.4.2.3.1"><a href="#section-3.4.3" class="xref">3.4.3</a>.  <a href="#name-transport-class-id-color" class="xref">Transport Class ID (Color)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.4">
                    <p id="section-toc.1-1.3.2.4.2.4.1"><a href="#section-3.4.4" class="xref">3.4.4</a>.  <a href="#name-available-bandwidth" class="xref">Available Bandwidth</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.5">
                    <p id="section-toc.1-1.3.2.4.2.5.1"><a href="#section-3.4.5" class="xref">3.4.5</a>.  <a href="#name-load-balance-factor" class="xref">Load balance factor</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.6">
                    <p id="section-toc.1-1.3.2.4.2.6.1"><a href="#section-3.4.6" class="xref">3.4.6</a>.  <a href="#name-forwarding-context-name" class="xref">Forwarding-context name</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.7">
                    <p id="section-toc.1-1.3.2.4.2.7.1"><a href="#section-3.4.7" class="xref">3.4.7</a>.  <a href="#name-forwarding-context-route-ta" class="xref">Forwarding-context Route-Target</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-error-handling-procedures" class="xref">Error handling procedures</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-scaling-considerations" class="xref">Scaling considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-acknowledgements" class="xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-references" class="xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="xref">9.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="xref">9.2</a>.  <a href="#name-references-2" class="xref">References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-A" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Today, a BGP speaker can advertise one nexthop for a set of NLRIs in
      an Update. This nexthop can be encoded in either the top-level
      BGP-Nexthop attribute (code 3), or inside the MP_REACH attribute (code
      14).<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">For cases where multiple nexthops need to be advertised, BGP-Addpath
      is used. Though Addpath allows basic ability to advertise
      multiple-nexthops, it does not allow the sender to specify desired
      relationship between the multiple nexthops being advertised e.g.,
      relative-ordering, type of load-balancing, fast-reroute. These are local
      decision at the receiving node based on local configuration and
      path-selection between the various additional-paths, which may tie-break
      on some arbitrary step like Router-Id or BGP nexthop address.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">Some scenarios with a BGP-free core may benefit from having a
      mechanism, where egress-node can signal multiple-nexthops along with
      their relationship to ingress nodes. This document defines a new BGP
      attribute "MultiNexthop (MNH)" that can be used for this purpose.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">This attribute can be used for both labeled and unlabled BGP
      families. The MNH can be used to advertise MPLS label along with nexthop
      for unlabeled families (e.g. Inet Unicast, Inet6 Unicast). Such that,
      mechanisms at the transport layer can work uniformly on labeled and
      unlabled BGP families. Service route scale can be confined closer to the
      service edge nodes, making the transport layer nodes light and nimble.
      They dont have any service route state, only have service end-point
      state.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">The MNH plays different role in "downstream allocation" scenario than
      "upstream allocation" scenario. E.g. for RFC8277 families that advertise
      downstream allocated labels, the MNH can play the "Label Descriptor"
      role, describing the forwarding semantics of the label being advertised.
      This can be useful in network visualization and controller based traffic
      engineering (e.g. EPE).<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">A new BGP capability (<span>[<a href="#RFC3392" class="xref">RFC3392</a>]</span>) called "MultiNexthop
      (MNH" is defined with type code: IANA TBD. This capability is used to
      express the ability to send and receive MNH attribute.<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7"></p>
</section>
<section id="section-2">
      <h2 id="name-use-cases-examples">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-use-cases-examples" class="section-name selfRef">Use-cases examples</a>
      </h2>
<p id="section-2-1"></p>
<section id="section-2.1">
        <h3 id="name-optimal-forwarding-exit-poi">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-optimal-forwarding-exit-poi" class="section-name selfRef">Optimal forwarding exit-points signaling to ingress-node</a>
        </h3>
<p id="section-2.1-1">In a BGP free core, one can dynamically signal to the ingress-node,
        how traffic should be load-balanced towards a set of exit-nodes, in
        one BGP-route containing this attribute.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1-2">Example, for prefix1, perform equal cost load-balancing towards
        exit-nodes A, B; where-as for prefix2, perform unequal-cost
        load-balancing (40%, 30%, 30%) towards exit-nodes A, B, C.<a href="#section-2.1-2" class="pilcrow">¶</a></p>
<p id="section-2.1-3">Example, for prefix1, use PE1 as primary-nexthop and use PE2 as a
        backup-nexthop.<a href="#section-2.1-3" class="pilcrow">¶</a></p>
</section>
<section id="section-2.2">
        <h3 id="name-choosing-a-received-label-b">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-choosing-a-received-label-b" class="section-name selfRef">Choosing a received label based on it's forwarding-semantic at advertising node</a>
        </h3>
<p id="section-2.2-1">In Downstream label allocation case, the MNH plays role of "Label
        descriptor" and describes the forwarding treatment given to the label
        at the advertising speaker. The receiving speaker can benefit from
        this information as in the following examples:<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<p id="section-2.2-2">- For a Prefix, a label with FRR enabled nexthop-set can be
        preferred to another label with a nexthop-set that doesn't provide
        FRR.<a href="#section-2.2-2" class="pilcrow">¶</a></p>
<p id="section-2.2-3">- For a Prefix, a label pointing to 10g nexthop can be preferred to
        another label pointing to a 1g nexthop<a href="#section-2.2-3" class="pilcrow">¶</a></p>
<p id="section-2.2-4">- Set of labels advertised can be aggregated, if they have same
        forwarding semantics (e.g. VPN per-prefix-label case)<a href="#section-2.2-4" class="pilcrow">¶</a></p>
</section>
<section id="section-2.3">
        <h3 id="name-signaling-desired-forwardin">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-signaling-desired-forwardin" class="section-name selfRef">Signaling desired forwarding behavior when installing MPLS Upstream labels at receiving node</a>
        </h3>
<p id="section-2.3-1">In Upstream label allocation case, the receiving speaker's
        forwarding-state can be controlled by the advertising speaker, thus
        enabling a standardized API to program desired MPLS forwarding-state
        at the receiving node. This is described in the <span>[<a href="#MPLS-NAMESPACES" class="xref">MPLS-NAMESPACES</a>]</span><a href="#section-2.3-1" class="pilcrow">¶</a></p>
</section>
<section id="section-2.4">
        <h3 id="name-load-balancing-over-ebgp-pa">
<a href="#section-2.4" class="section-number selfRef">2.4. </a><a href="#name-load-balancing-over-ebgp-pa" class="section-name selfRef">Load-balancing over EBGP parallel links</a>
        </h3>
<p id="section-2.4-1">Consider N parallel links between two EBGP speakers. There are
        different models possible to do load balancing over these links:<a href="#section-2.4-1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2.4-2.1">N single-hop EBGP sessions over the N links. Interface
            addresses are used as next-hops. N copies of the RIB are exchanged
            to form N-way ECMP paths. The routes advertised on the N sessions
            can be attached with Link bandwidth comunity to perform weighted
            ECMP.<a href="#section-2.4-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-2.4-2.2">1 multi-hop EBGP session between loopback addresses, reachable
            via static route over the N links. Loopback addresses are used as
            next-hops. 1 copy of the RIB is exchanged with loopback address as
            nexthop. And a static route can be configured to the loopback
            address to perform desired N-way ECMP path. M loopbacks are
            configured in this model, to achieve M different load balancing
            schemes: ECMP, weighted ECMP, Fast-reroute enabled paths etc.<a href="#section-2.4-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-2.4-2.3">1 multi-hop EBGP session between loopback addresses, reachable
            via static route over the N links. Interface addresses are used as
            next-hops, without using additional loopbacks. 1 copy of the RIB
            is exchanged with MNH attribute to form N-way ECMP paths, weighted
            ECMP, Fast-reroute backup paths etc. BFD may be used to these
            directly connected BGP nexthops to detect liveness.<a href="#section-2.4-2.3" class="pilcrow">¶</a>
</li>
        </ul>
</section>
<section id="section-2.5">
        <h3 id="name-flowspec-routes-with-multip">
<a href="#section-2.5" class="section-number selfRef">2.5. </a><a href="#name-flowspec-routes-with-multip" class="section-name selfRef">Flowspec routes with multiple Redirect-IP nexthops</a>
        </h3>
<p id="section-2.5-1">There are existing protocol machinery which can benefit from the
        ability of MNH to clearly specify fallback behavior when multiple
        nexthops are involved. One example is the scenario described in <span>[<a href="#FLWSPC-REDIR-IP" class="xref">FLWSPC-REDIR-IP</a>]</span> where multiple Redirect-to-IP nexthop
        addresses exist for a Flowspec prefix. In such a scenario, the
        receiving speakers may redirect the traffic to different nexthops,
        based on variables like IGP-cost. If instead, the MNH was used to
        specify the redirect-to-IP nexthop, then the order of preference
        between the different nexthops can be clearly specified using one
        flowspec route carrying a MNH containing those different
        nexthop-addresses specifying the desired preference-order. Such that,
        irrespective of IGP-cost, the receiving speakers will redirect the
        flow towards the same traffic collector device.<a href="#section-2.5-1" class="pilcrow">¶</a></p>
</section>
<section id="section-2.6">
        <h3 id="name-color-only-resolution-nexth">
<a href="#section-2.6" class="section-number selfRef">2.6. </a><a href="#name-color-only-resolution-nexth" class="section-name selfRef">Color-Only resolution nexthop</a>
        </h3>
<p id="section-2.6-1">Another existing protocol machinery that manufactures nexthop
        addresses from overloaded extended color community is specified in
        <span>[<a href="#SRTE-COLOR-ONLY" class="xref">SRTE-COLOR-ONLY</a>]</span>. In a way, the color field is
        overloaded to carry one anycast BGP next-hop with pre-specified
        fallback options. This approach gives us only two next-hops to play
        with. The 'BGP nexthop address' and the 'Color-only nexthop'<a href="#section-2.6-1" class="pilcrow">¶</a></p>
<p id="section-2.6-2">Instead, the MNH could be used to achieve the same result with more
        flexibility. Multiple BGP nexthops can be carried, each resolving over
        a desired Transport class (Color), and with customizable fallback
        order. And the solution will work for non-SRTE networks as-well.<a href="#section-2.6-2" class="pilcrow">¶</a></p>
</section>
</section>
<section id="section-3">
      <h2 id="name-the-multinexthop-mnh-bgp-at">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-the-multinexthop-mnh-bgp-at" class="section-name selfRef">The "MultiNexthop (MNH)" BGP attribute encoding</a>
      </h2>
<p id="section-3-1">"MultiNexthop (MNH)" is a new BGP optional non-transitive attribute
      (code TBD), that can be used to convey multiple-nexthops to a
      BGP-speaker. This attribute describes forwarding semantics using one or
      more Nexthop-Forwarding-Semantics TLV.<a href="#section-3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3-2">
<pre>     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |1 0 0 1(Flags) |Attr. Type Code|          Length               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |     MNH-Flags                 |   PNH-Len     |  ..Advertising|
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    | PNH Address /32 or /128..     |       Num-Nexthops            |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |     ...one or more "Nexthop-Forwarding-Semantics TLV"...      |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-3-2" class="pilcrow">¶</a>
</div>
<p id="section-3-3" class="keepWithPrevious">Fig 1: MultiNexthop - BGP Attribute<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4"></p>
<div class="alignLeft art-text artwork" id="section-3-5">
<pre>- Flags
        BGP Path-attribute flags. 1001 to indicate Optional
        Non-Transitive, Extended-length field.

- Attr. Type Code
        IANA TBD.

- Length
       Two bytes field stating length of attribute value in bytes.

- MNH-Flags
       16 bit flag (UR..R)
       Only one bit MSB is defined currently, others are reserved.
           R: Reserved
           U: 1 means the Upstream-allocation, attribute describes
              forwarding state desired at receiving speaker.
              0 means the Downstream-allocation, attribute describes
              forwarding state present at advertising-speaker.
- PNH-Len
       Protocol-NH Length in bits (= 32 or 128) Advertising PNH IPv4 or IPv6

- PNH-address
       BGP Protocol Nexthop address (Len = 32 or 128) advertised in NEXT_HOP or
       MP_REACH_NLRI attr. Used to sanity-check this attribute.

- Num-Nexthops
       Number of nexthop addresses carried in the MNH.
       &gt;1 if ECMP or Alternate-paths.</pre><a href="#section-3-5" class="pilcrow">¶</a>
</div>
<p id="section-3-6"></p>
<p id="section-3-7">Sec 3.2 describes the Nexthop-Forwarding-Semantics TLV.<a href="#section-3-7" class="pilcrow">¶</a></p>
<section id="section-3.1">
        <h3 id="name-operations">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-operations" class="section-name selfRef">Operations</a>
        </h3>
<section id="section-3.1.1">
          <h4 id="name-bgp-capability-for-mnh-attr">
<a href="#section-3.1.1" class="section-number selfRef">3.1.1. </a><a href="#name-bgp-capability-for-mnh-attr" class="section-name selfRef">BGP Capability for MNH attribute</a>
          </h4>
<p id="section-3.1.1-1">A new BGP capability <span>[<a href="#RFC3392" class="xref">RFC3392</a>]</span> called
          "MultiNexthop (MNH)" is defined with type code: IANA TBD. The MNH
          attribute MUST NOT be sent to a BGP speaker that has not advertise
          the MNH capability. A BGP speaker MUST ignore the MNH attribute
          received from a peer which has not advertised the MNH attribute.<a href="#section-3.1.1-1" class="pilcrow">¶</a></p>
</section>
<section id="section-3.1.2">
          <h4 id="name-scope-of-use-and-propagatio">
<a href="#section-3.1.2" class="section-number selfRef">3.1.2. </a><a href="#name-scope-of-use-and-propagatio" class="section-name selfRef">Scope of use, and propagation</a>
          </h4>
<p id="section-3.1.2-1">The MNH attribute is intended to be used in a BGP free core,
          between egress and ingress BGP speakers that understand this
          attribute.<a href="#section-3.1.2-1" class="pilcrow">¶</a></p>
<p id="section-3.1.2-2">Also, it is required to avoid un-intentionally leaking it to
          other AS on an EBGP session, via a BGP speaker that does not
          understand MNH attribute.<a href="#section-3.1.2-2" class="pilcrow">¶</a></p>
<p id="section-3.1.2-3">To achieve this, the attribute is defined as "optional
          non-transitive", and uses a new BGP capability. If a MNH-attribute
          is received by a PE BGP-speaker that does not understand it, the
          optional non-transitive nature avoids unintentionally propagating it
          towards EBGP-peers.<a href="#section-3.1.2-3" class="pilcrow">¶</a></p>
<p id="section-3.1.2-4">This also means that a RR needs to be upgraded to support this
          attribute before any PEs in the network can make use of it. When a
          RR receives the MNH-attribute from a client that supports the
          attribute, it propagates the attribute as-is when reflecting the
          route with nexthop unchanged.<a href="#section-3.1.2-4" class="pilcrow">¶</a></p>
<p id="section-3.1.2-5">When a BGP speaker receives the MNH-attribute from another
          speaker that did not advertise support of the attribute, the
          attribute is ignored.<a href="#section-3.1.2-5" class="pilcrow">¶</a></p>
<p id="section-3.1.2-6">The MNH attribute capability provides additonaly protection
          against receiving this attribute from EBGP peers, when not
          intended.<a href="#section-3.1.2-6" class="pilcrow">¶</a></p>
</section>
<section id="section-3.1.3">
          <h4 id="name-interaction-of-mnh-with-nex">
<a href="#section-3.1.3" class="section-number selfRef">3.1.3. </a><a href="#name-interaction-of-mnh-with-nex" class="section-name selfRef">Interaction of MNH with Nexthop (in attr-code 3, 14)</a>
          </h4>
<p id="section-3.1.3-1">When adding a MultiNexthop attribute to an advertised BGP route,
          the speaker MUST put the same next-hop address in the Advertising
          PNH field as it put in the Nexthop field inside NEXT_HOP attribute
          or MP_REACH_NLRI attribute. Any speaker that recognizes this
          attribute and changes the PNH while re-advertising the route MUST
          remove the MultiNexthop-Attribute in the re-advertisement. The
          speaker MAY however add a new MultiNexthop-Attribute to the
          re-advertisement; while doing so the speaker MUST record in the
          "Advertising-PNH" field the same next-hop address as used in
          NEXT_HOP field or MP_REACH_NLRI attribute.<a href="#section-3.1.3-1" class="pilcrow">¶</a></p>
<p id="section-3.1.3-2">A speaker receiving a MNH attribute SHOULD ignore it if the
          next-hop address contained in Advertising-PNH field is not the same
          as the next-hop address contained in NEXT_HOP field or MP_REACH_NLRI
          field.<a href="#section-3.1.3-2" class="pilcrow">¶</a></p>
</section>
<section id="section-3.1.4">
          <h4 id="name-interaction-with-addpath">
<a href="#section-3.1.4" class="section-number selfRef">3.1.4. </a><a href="#name-interaction-with-addpath" class="section-name selfRef">Interaction with Addpath</a>
          </h4>
<p id="section-3.1.4-1"><span>[<a href="#ADDPATH-GUIDELINES" class="xref">ADDPATH-GUIDELINES</a>]</span> suggests the following:<a href="#section-3.1.4-1" class="pilcrow">¶</a></p>
<p id="section-3.1.4-2">"Diverse path: A BGP path associated with a different BGP
          next-hop and BGP router than some other set of paths. The BGP router
          associated with a path is inferred from the ORIGINATOR_ID attribute
          or, if there is none, the BGP Identifier of the peer that advertised
          the path."<a href="#section-3.1.4-2" class="pilcrow">¶</a></p>
<p id="section-3.1.4-3">When selecting "diverse paths" for ADD_PATH as specified above,
          the MNH attribute should also be compared if it exists, to determine
          if two routes have "different BGP next-hop".<a href="#section-3.1.4-3" class="pilcrow">¶</a></p>
</section>
<section id="section-3.1.5">
          <h4 id="name-path-selection-consideratio">
<a href="#section-3.1.5" class="section-number selfRef">3.1.5. </a><a href="#name-path-selection-consideratio" class="section-name selfRef">Path-selection considerations</a>
          </h4>
<p id="section-3.1.5-1">While tie breaking in the path-selection as described in
          RFC-4271, 9.1.2.2. step (e) viz. the "IGP cost to nexthop", consider
          the highest cost among the nexthop-legs present in this
          attribute.<a href="#section-3.1.5-1" class="pilcrow">¶</a></p>
</section>
<section id="section-3.1.6">
          <h4 id="name-nh-flags-u-bit-denoting-ups">
<a href="#section-3.1.6" class="section-number selfRef">3.1.6. </a><a href="#name-nh-flags-u-bit-denoting-ups" class="section-name selfRef">NH-Flags U bit, denoting upstream/downstream semantics</a>
          </h4>
<p id="section-3.1.6-1">U-bit being Set indicates that this attribute describes what the
          forwarding semantics of an Upstream-allocated label at the
          receiving-speaker should be. All other bits in NH-Flags are
          currently reserved, MUST be set to 0 by sender and MUST be ignored
          by receiver.<a href="#section-3.1.6-1" class="pilcrow">¶</a></p>
<p id="section-3.1.6-2">This attribute can be used for both labeled and unlabled BGP
          families.<a href="#section-3.1.6-2" class="pilcrow">¶</a></p>
<p id="section-3.1.6-3">A MultiNexthop attribute with U=0 is called "Label Descriptor"
          role. A BGP speaker advertising a downstream-allocated label-route
          MAY add this attribute to the BGP route Update, to "describe" to the
          receiving speaker what the label's forwarding semantics at the
          sending speaker is.<a href="#section-3.1.6-3" class="pilcrow">¶</a></p>
<p id="section-3.1.6-4">Today semantics of a downstream-allocated label is known only to
          the egress-node advertising the label. The speaker receiving the
          label-binding doesn't know what the label's forwarding semantic at
          the advertiser is. In some environments, it may be useful to convey
          this information to the receiving speaker. This may help in better
          debugging and manageability, or enable the receiving speaker, which
          could also be some centralized controller, make better decisions
          about which label to use, based on the label's
          forwarding-semantic.<a href="#section-3.1.6-4" class="pilcrow">¶</a></p>
<p id="section-3.1.6-5">While doing upstream-label allocation, this attribute (U-bit Set)
          can be used to convey the forwarding-semantics at the receiving node
          should be. Details of the BGP protocol extensions required for
          signaling upstream-label allocation are out of scope of this
          document, and are described in <span>[<a href="#MPLS-NAMESPACES" class="xref">MPLS-NAMESPACES</a>]</span>.<a href="#section-3.1.6-5" class="pilcrow">¶</a></p>
<p id="section-3.1.6-6">In rest of this document, the use of term "Label" will mean
          downstream allocated label, unless specified otherwise as
          upstream-allocated label.<a href="#section-3.1.6-6" class="pilcrow">¶</a></p>
<p id="section-3.1.6-7">When using the MultiNexthop attribute for IP-routes, U-bit is
          Set. Since IP prefixes are by nature upstream allocated.<a href="#section-3.1.6-7" class="pilcrow">¶</a></p>
</section>
</section>
<section id="section-3.2">
        <h3 id="name-nexthop-forwarding-semantic">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-nexthop-forwarding-semantic" class="section-name selfRef">Nexthop Forwarding Semantics TLV</a>
        </h3>
<p id="section-3.2-1">Each Forwarding-Semantics TLV expresses a nexthop leg's forwarding
        action. i.e. a "FwdAction" with an associated Nexthop. The type of
        actions defined by this TLV are given below. The "Nexthop-Leg" field
        takes appropriate values based on the FwdAction.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2" class="keepWithNext"></p>
<div class="alignLeft art-text artwork" id="section-3.2-3">
<pre>  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |             FwdAction         |            Len                |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |             ...Nexthop-Leg Descriptor-TLV...                  |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-3.2-3" class="pilcrow">¶</a>
</div>
<p id="section-3.2-4" class="keepWithPrevious">Fig 2: Nexthop Forwarding Semantics TLV<a href="#section-3.2-4" class="pilcrow">¶</a></p>
<p id="section-3.2-5"></p>
<div class="alignLeft art-text artwork" id="section-3.2-6">
<pre> FwdAction         Meaning
 ---------      -------------
       1        Forward
       2        Pop-And-Forward
       3        Swap
       4        Push
       5        Pop-And-Lookup
       6        Replicate

 - Len
    Length of Nexthop Forwarding Semantics TLV including all
    Nexthop-Leg Descriptor TLVs.
</pre><a href="#section-3.2-6" class="pilcrow">¶</a>
</div>
<p id="section-3.2-7"></p>
<p id="section-3.2-8">Meaning of most of the above FwdAction semantics is well
        understood. FwdAction 1 is applicable for both IP and MPLS routes.
        FwdActions 2-5 are applicable for MPLS routes only. FwdActions 1 and 6
        are applicable for Flowspec routes for Redirect and Mirror
        actions.<a href="#section-3.2-8" class="pilcrow">¶</a></p>
<p id="section-3.2-9">The "Forward" action means forward the IP/MPLS packet with the
        destination prefix (IP-dest-addr/MPLS-label) value unchanged. For IP
        routes, this is the forwarding-action given for next-hop addresses
        contained in BGP path-attributes: Nexthop (code 3) or MP_REACH_NLRI
        (code 14). For MPLS routes, usage of this action is equivalent to SWAP
        with same label-value; one such usage is explained in <span>[<a href="#MPLS-NAMESPACES" class="xref">MPLS-NAMESPACES</a>]</span> when Upstream-label-allocation is in
        use.<a href="#section-3.2-9" class="pilcrow">¶</a></p>
<p id="section-3.2-10">The "Pop-And-Forward" action means Pop the MPLS-label and forward
        the payload towards the Nexthop IP-address specified in the sub-TLV,
        using appropriate encapsulation to reach the Nexthop.<a href="#section-3.2-10" class="pilcrow">¶</a></p>
<p id="section-3.2-11">The "Pop-And-Lookup" action may result in a MPLS-lookup or an
        upper-layer header (like IPv4, IPv6) lookup, depending on whether the
        label that was popped was the bottom of stack label.<a href="#section-3.2-11" class="pilcrow">¶</a></p>
<p id="section-3.2-12">If an incompatible FwdAction is received for a prefix-type, or an
        unsupported FwdAction is received, it is considered a semantic-error
        and MUST be dealt with as explained in section 5.<a href="#section-3.2-12" class="pilcrow">¶</a></p>
</section>
<section id="section-3.3">
        <h3 id="name-nexthop-leg-descriptor-tlv">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-nexthop-leg-descriptor-tlv" class="section-name selfRef">Nexthop-Leg Descriptor TLV</a>
        </h3>
<p id="section-3.3-1">The Nexthop-Leg Descriptor TLV describes various attributes of the
        Nexthop-legs that the FwdAction is associated with.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2"></p>
<p id="section-3.3-3" class="keepWithNext"></p>
<div class="alignLeft art-text artwork" id="section-3.3-4">
<pre>  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |           NhopDescrType       |            Len                |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |         Flags                 |      Relative-Preference      |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                 ..Nexthop Attributes SubTLV..                 |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                 ..Nexthop Attributes SubTLV..                 |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-3.3-4" class="pilcrow">¶</a>
</div>
<p id="section-3.3-5" class="keepWithPrevious">Fig 3: Nexthop-Leg Descriptor TLV<a href="#section-3.3-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.3-6">
<pre>  NhopDescrType  Meaning
  -------------  ---------
     1           IPv4-nexthop
     2           IPv6-nexthop
     3           Labeled-IP-Nexthop
     4           Forwarding-Context-Nexthop


- Len (2 octets)
    Length in bytes of Nexthop-Leg Descriptor TLV, including Flags, Relative-Preference and all
    Nexthop Attributes SubTLVs.

- Flags
     2 octets. Must send zero. Must ignore on receive.

- Relative-Preference
     Unsigned 2 octet integer specifying relative order or
     preference, to use in FIB. Use in FIB all usable legs with lowest
     relative-weight. If multiple legs exist with that weight, form ECMP.
</pre><a href="#section-3.3-6" class="pilcrow">¶</a>
</div>
</section>
<section id="section-3.4">
        <h3 id="name-nexthop-attributes-sub-tlv">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-nexthop-attributes-sub-tlv" class="section-name selfRef">Nexthop Attributes Sub-TLV</a>
        </h3>
<p id="section-3.4-1"></p>
<div class="alignLeft art-text artwork" id="section-3.4-2">
<pre> SubTLV type       Meaning
 -----------      ----------
      1            IP-Address
      2            Labeled-IP-Nexthop
      3            Transport Class ID (Color)
      4            Bandwidth
      5            Load-Balance-Factor
      6            Forwarding-context Name
      7            Forwarding-context Route-Target
</pre><a href="#section-3.4-2" class="pilcrow">¶</a>
</div>
<p id="section-3.4-3"></p>
<section id="section-3.4.1">
          <h4 id="name-ip-address">
<a href="#section-3.4.1" class="section-number selfRef">3.4.1. </a><a href="#name-ip-address" class="section-name selfRef">IP Address</a>
          </h4>
<p id="section-3.4.1-1"></p>
<p id="section-3.4.1-2" class="keepWithNext"></p>
<div class="alignLeft art-text artwork" id="section-3.4.1-3">
<pre>  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |      Attr SubTLV Type = 1     |      Len (2 bytes)            |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |        Flags (2 bytes)        |    PfxLen    |      ..IPv4 or |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |  IPv6 Address ..              |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

- Len (2 octets)
    Length in bytes of remaining portion of SubTLV.

- Flags
     2 octets. Must send zero. Must ignore on receive.

- PfxLen (1 octet)
    Length in bits of Nexthop IP-address (32 or 128)

- IPv4 or IPv6 Address
    Remaining bytes in sub-TLV are the 32 bit or 128 bit Nexthop address.
</pre><a href="#section-3.4.1-3" class="pilcrow">¶</a>
</div>
<p id="section-3.4.1-4" class="keepWithPrevious">Fig 4: IP-Address attribute sub-TLV<a href="#section-3.4.1-4" class="pilcrow">¶</a></p>
<p id="section-3.4.1-5"></p>
<p id="section-3.4.1-6">This sub-TLV would be valid with Nexthop-Forwarding-Semantics TLV
          with FwdAction of Pop-And-Forward or Forward.<a href="#section-3.4.1-6" class="pilcrow">¶</a></p>
</section>
<section id="section-3.4.2">
          <h4 id="name-labeled-ip-nexthop">
<a href="#section-3.4.2" class="section-number selfRef">3.4.2. </a><a href="#name-labeled-ip-nexthop" class="section-name selfRef">Labeled IP nexthop</a>
          </h4>
<p id="section-3.4.2-1"></p>
<p id="section-3.4.2-2" class="keepWithNext"></p>
<div class="alignLeft art-text artwork" id="section-3.4.2-3">
<pre>
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |      Attr SubTLV Type = 2     |      Len (2 bytes)            |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |        Flags (2 bytes)        |        Label (20 bits)        |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |       |Rsrv |S|    PfxLen     |     ..IPv4 or IPv6 Address .. |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


- Len (2 octets)
    Length in bytes of remaining portion of SubTLV.

- Flags (2 octets):
     ELC (MSB bit): indicates if this egress NH is Entropy Label Capable.
     Remaining bits are Reserved. Must send zero. Must ignore on receive.

- Label:
     The Label field is a 20-bit field containing an MPLS label value
     (see [RFC3032]).

- Rsrv:
      This 3-bit field SHOULD be set to zero on transmission and
      MUST be ignored on reception.

- S:
      This 1-bit field MUST be set to one on last label being pushed.

- PfxLen (1 octet)
    Length in bits of Nexthop IP-address (32 or 128)

- IPv4 or IPv6 Address
    Remaining bytes in sub-TLV are the 32 bit or 128 bit Nexthop address.
</pre><a href="#section-3.4.2-3" class="pilcrow">¶</a>
</div>
<p id="section-3.4.2-4" class="keepWithPrevious">Fig 5: "Labeled nexthop" attribute sub-TLV<a href="#section-3.4.2-4" class="pilcrow">¶</a></p>
<p id="section-3.4.2-5"></p>
<p id="section-3.4.2-6">This sub-TLV would be valid with Nexthop-Leg Forwarding-Semantics
          TLV with FwdAction of Swap or Push.<a href="#section-3.4.2-6" class="pilcrow">¶</a></p>
</section>
<section id="section-3.4.3">
          <h4 id="name-transport-class-id-color">
<a href="#section-3.4.3" class="section-number selfRef">3.4.3. </a><a href="#name-transport-class-id-color" class="section-name selfRef">Transport Class ID (Color)</a>
          </h4>
<p id="section-3.4.3-1">The Nexthop can be associated with a Transport Class, so as to
          resolve a path that satisfies required Transport tunnel
          characteristics. Transport Class is defined in <span>[<a href="#BGP-CT" class="xref">BGP-CT</a>]</span><a href="#section-3.4.3-1" class="pilcrow">¶</a></p>
<p id="section-3.4.3-2">Transport Class is a per-nexthop scoped attribute. Without MNH,
          the Transport class is applied to the nexthop IP-address encoded in
          the BGP-Nexthop attribute (code 3), or inside the MP_REACH attribute
          (code 14). With MNH, the Transport Class can be specified per
          Nexthop-Leg TLV. It is applied to the IP-address encoded in the
          Nexthop Attribute Sub-TLVs of type "IP Address", "Labeled IP
          nexthop".<a href="#section-3.4.3-2" class="pilcrow">¶</a></p>
<p id="section-3.4.3-3">The format of the Transport Class ID Sub-TLV is as follows:<a href="#section-3.4.3-3" class="pilcrow">¶</a></p>
<p id="section-3.4.3-4" class="keepWithNext"></p>
<div class="alignLeft art-text artwork" id="section-3.4.3-5">
<pre>  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |      Attr SubTLV Type = 3     |      Len (2 bytes)            |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                    Transport Class ID (4 bytes)               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

- Len (2 octets)
    Length in bytes of remaining portion of SubTLV.

- Transport Class ID (Color):
    This is a 32 bit identifier, associated with the Nexthop address.
    The Nexthop specified in "IP-address or Labeled Nexthop" TLVs
    are resolved over tunnels of this color.
  Defined in [BGP-CT] [draft-kaliraj-idr-bgp-classful-transport-planes]
</pre><a href="#section-3.4.3-5" class="pilcrow">¶</a>
</div>
<p id="section-3.4.3-6" class="keepWithPrevious">Fig 6: "Transport Class ID (Color)" attribute
            sub-TLV<a href="#section-3.4.3-6" class="pilcrow">¶</a></p>
<p id="section-3.4.3-7"></p>
<p id="section-3.4.3-8">This sub-TLV would be valid with Nexthop-Forwarding-Semantics TLV
          with FwdAction of Forward, Swap or Push.<a href="#section-3.4.3-8" class="pilcrow">¶</a></p>
</section>
<section id="section-3.4.4">
          <h4 id="name-available-bandwidth">
<a href="#section-3.4.4" class="section-number selfRef">3.4.4. </a><a href="#name-available-bandwidth" class="section-name selfRef">Available Bandwidth</a>
          </h4>
<p id="section-3.4.4-1"></p>
<p id="section-3.4.4-2" class="keepWithNext"></p>
<div class="alignLeft art-text artwork" id="section-3.4.4-3">
<pre>  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |      Attr SubTLV Type = 4     |      Len (2 bytes)            |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                   Bandwidth (8 octets)                        |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                   Bandwidth (contd.)                          |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

- Len (2 octets)
    Length in bytes of remaining portion of SubTLV.

- Bandwidth
    The bandwidth of the link expressed as 8 octets,
    units being bits per second.
</pre><a href="#section-3.4.4-3" class="pilcrow">¶</a>
</div>
<p id="section-3.4.4-4" class="keepWithPrevious">Fig 6: "Bandwidth" attribute sub-TLV<a href="#section-3.4.4-4" class="pilcrow">¶</a></p>
<p id="section-3.4.4-5"></p>
<p id="section-3.4.4-6">This sub-TLV would be valid with Nexthop-Forwarding-Semantics TLV
          with FwdAction of Forward, Swap or Push.<a href="#section-3.4.4-6" class="pilcrow">¶</a></p>
<p id="section-3.4.4-7">This sub-TLV would also be valid in a Label-Descriptor-attribute
          whose U-bit is reset.<a href="#section-3.4.4-7" class="pilcrow">¶</a></p>
</section>
<section id="section-3.4.5">
          <h4 id="name-load-balance-factor">
<a href="#section-3.4.5" class="section-number selfRef">3.4.5. </a><a href="#name-load-balance-factor" class="section-name selfRef">Load balance factor</a>
          </h4>
<p id="section-3.4.5-1"></p>
<p id="section-3.4.5-2" class="keepWithNext"></p>
<div class="alignLeft art-text artwork" id="section-3.4.5-3">
<pre>  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |      Attr SubTLV Type = 5     |      Len (2 bytes)            |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |      Balance Percentage       |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

- Len (2 octets)
    Length in bytes of remaining portion of SubTLV.

- Balance Percentage:
    This is the explicit "balance percentage" requested by the sender,
    for unequal load-balancing over these Nexthop-Descriptor-TLV legs.
    This balance percentage would override the implicit
    balance-percentage calculated using "Bandwidth" attribute
    sub-TLV.
</pre><a href="#section-3.4.5-3" class="pilcrow">¶</a>
</div>
<p id="section-3.4.5-4" class="keepWithPrevious">Fig 7: "Load-Balance-Factor" attribute
            sub-TLV<a href="#section-3.4.5-4" class="pilcrow">¶</a></p>
<p id="section-3.4.5-5"></p>
<p id="section-3.4.5-6">This sub-TLV would be valid with Nexthop-Forwarding-Semantics TLV
          with FwdAction of Forward, Swap or Push.<a href="#section-3.4.5-6" class="pilcrow">¶</a></p>
<p id="section-3.4.5-7">This is the explicit "balance percentage" requested by the
          sender, for unequal load-balancing over these Nexthop-Descriptor-TLV
          legs. This balance percentage would override the implicit
          balance-percentage calculated using "Bandwidth" attribute
          sub-TLV<a href="#section-3.4.5-7" class="pilcrow">¶</a></p>
</section>
<section id="section-3.4.6">
          <h4 id="name-forwarding-context-name">
<a href="#section-3.4.6" class="section-number selfRef">3.4.6. </a><a href="#name-forwarding-context-name" class="section-name selfRef">Forwarding-context name</a>
          </h4>
<p id="section-3.4.6-1"></p>
<p id="section-3.4.6-2" class="keepWithNext"></p>
<div class="alignLeft art-text artwork" id="section-3.4.6-3">
<pre>  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |      Attr SubTLV Type = 6     |      Len (2 bytes)            |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |    NameLen (2 octets)         | ..Fwd-Context-name...(unicode)|
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

 - Len (2 octets)
    Length in bytes of remaining portion of SubTLV.

 - NameLen (2 octets)
    Length in bytes of Fwd-Context-Name

 - Forwarding Context Name:
    Name of forwarding context (e.g. VRF-name) where lookup should happen.
</pre><a href="#section-3.4.6-3" class="pilcrow">¶</a>
</div>
<p id="section-3.4.6-4" class="keepWithPrevious">Fig 8: Forwarding-Context name attribute
            sub-TLV<a href="#section-3.4.6-4" class="pilcrow">¶</a></p>
<p id="section-3.4.6-5"></p>
<p id="section-3.4.6-6">This sub-TLV would be valid with Nexthop-Forwarding-Semantics TLV
          with FwdAction of Pop-And-Lookup. Ref: usecase 2.3. The
          Fowarding-context-name identfies the forwarding-context (for e.g.
          the VRF-name) where the lookup should happen after pop label.<a href="#section-3.4.6-6" class="pilcrow">¶</a></p>
</section>
<section id="section-3.4.7">
          <h4 id="name-forwarding-context-route-ta">
<a href="#section-3.4.7" class="section-number selfRef">3.4.7. </a><a href="#name-forwarding-context-route-ta" class="section-name selfRef">Forwarding-context Route-Target</a>
          </h4>
<p id="section-3.4.7-1"></p>
<p id="section-3.4.7-2" class="keepWithNext"></p>
<div class="alignLeft art-text artwork" id="section-3.4.7-3">
<pre>  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |      Attr SubTLV Type = 7     |      Len (2 bytes)            |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |      Type (2 octets)          |  ...Route Target... (8 octets)|
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |               ..Route Target... (continued)                   |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |...Route Target... (8 octets)  |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


 - Len (2 octets)
    Length in bytes of remaining portion of SubTLV.

 - Type:
      value of 1 indicates Route Target follows.

 - Route Target:
       Import Route Target of the forwarding context
       (e.g. VRF-name) where lookup should happen.

</pre><a href="#section-3.4.7-3" class="pilcrow">¶</a>
</div>
<p id="section-3.4.7-4" class="keepWithPrevious">Fig 9: "Route-Target identifying the
            Forwarding-Context" attribute sub-TLV<a href="#section-3.4.7-4" class="pilcrow">¶</a></p>
<p id="section-3.4.7-5"></p>
<p id="section-3.4.7-6">This sub-TLV would be valid with Nexthop-Forwarding-Semantics TLV
          with FwdAction of Pop-And-Lookup. Ref: usecase 2.3. The Route Target
          identfies the forwarding-context (for e.g. VRF) where the lookup
          should happen after pop label.<a href="#section-3.4.7-6" class="pilcrow">¶</a></p>
<p id="section-3.4.7-7"></p>
<p id="section-3.4.7-8">If any of these sub-TLVs or FwdAction combinations are
          unrecognized or unsupported by a receiving speaker, it is considered
          a semantic error for that speaker, and in such case error-handling
          procedures described in section 4 should be followed.<a href="#section-3.4.7-8" class="pilcrow">¶</a></p>
</section>
</section>
</section>
<section id="section-4">
      <h2 id="name-error-handling-procedures">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-error-handling-procedures" class="section-name selfRef">Error handling procedures</a>
      </h2>
<p id="section-4-1"></p>
<p id="section-4-2">When U-bit is Reset, this attribute is used to describe the label
      advertised by the BGP-peer. If the value in the attribute is
      syntactically parse-able, but not semantically valid, the receiving
      speaker should deal with the error gracefully and MUST NOT tear down the
      BGP session. In such cases the rest of the BGP-update can be consumed if
      possibe.<a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3">When U-bit is Set, this attribute is used to specify the forwarding
      action at the receiving BGP-peer. If the value in the attribute is
      syntactically parse-able, but not semantically valid, the receiving
      speaker SHOULD deal with the error gracefully by ignoring the MNH
      attribute, and continue processing the route. It MUST NOT tear down the
      BGP session.<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4">If a MNH with U-bit Reset is received for an IP-route (SAFI Unicast),
      the MNH attribute SHOULD be ignored. Because IP route prefixes are
      upstream allocated by nature.<a href="#section-4-4" class="pilcrow">¶</a></p>
<p id="section-4-5">If a MNH with U-bit Reset is received for an <span>[<a href="#MPLS-NAMESPACES" class="xref">MPLS-NAMESPACES</a>]</span> route, the MNH attribute SHOULD be ignored.
      Because the label prefix in MPLS-NAMESPACE family routes is upstream
      allocated.<a href="#section-4-5" class="pilcrow">¶</a></p>
<p id="section-4-6">The receiving BGP speaker MAY consider the "Num-Nexthop" value in a
      MNH attribute (U-bit Set) not acceptable, based on it's forwarding
      capabilities. In such cases, the MNH attribute SHOULD be considered
      Unusable, and not be used, ignored on receipt. The condition SHOULD be
      dealt gracefully and MUST NOT tear down the BGP session.<a href="#section-4-6" class="pilcrow">¶</a></p>
</section>
<section id="section-5">
      <h2 id="name-scaling-considerations">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-scaling-considerations" class="section-name selfRef">Scaling considerations</a>
      </h2>
<p id="section-5-1">The MNH attribute allows receiving multiple nexthops on the same BGP
      session. This flexibility also opens up the possibility that a peer can
      send large number of multipath (ECMP/UCMP/FRR) nexthops that may
      overwhelm the local system's forwarding plane. Prefix-limit based checks
      will not avoid this situation.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">To keep the scaling limits under check, a BGP speaker MAY keep
      account of number of unique multipath nexthops that are received from a
      BGP peer, and impose a configurable max-limit on that. This is
      especially useful for EBGP peers.<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">A good scaling property of conveying multipath nexthops using the MNH
      attribute with N nexthop legs on one BGP session, as against BGP routes
      on N BGP sessions is that, it limits the amount of transitionary
      multipath combinatorial state in the latter model. Because the final
      multipath state is conveyed by one route update in deterministic manner,
      there is no transitionary multipath combinatorial explosion created
      during establishment of N sessions.<a href="#section-5-3" class="pilcrow">¶</a></p>
</section>
<div id="IANA">
<section id="section-6">
      <h2 id="name-iana-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-6-1">This document makes request to IANA to allocate the following codes
      in BGP attributes registry.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">1. MultiNexthop (MNH) BGP-attribute: A new BGP attribute code
      TBD.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">This document makes request to IANA to allocate the following sub
      registries for MNH attribute:.<a href="#section-6-3" class="pilcrow">¶</a></p>
<p id="section-6-4">1. "FwdAction" type as defined in 3.1.<a href="#section-6-4" class="pilcrow">¶</a></p>
<p id="section-6-5">2. Nexthop-Leg Descriptor TLV:"NhopDescrType" as defined in 3.2.<a href="#section-6-5" class="pilcrow">¶</a></p>
<p id="section-6-6">3. "Nexthop Attributes Sub-TLV type" as defined in 3.3.<a href="#section-6-6" class="pilcrow">¶</a></p>
<p id="section-6-7">This document makes request to IANA to allocate a BGP capability code
      TBD for MNH attribute:.<a href="#section-6-7" class="pilcrow">¶</a></p>
<p id="section-6-8">Note to RFC Editor: this section may be removed on publication as an
      RFC.<a href="#section-6-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Security">
<section id="section-7">
      <h2 id="name-security-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-7-1">The attribute is defined as optional non-transitive BGP attribute,
      such that it does not accidentally get propagated or leaked via BGP
      speakers that dont support this feature, especially does not
      unintentionally leak across EBGP boundaries.<a href="#section-7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Acknowledgements">
<section id="section-8">
      <h2 id="name-acknowledgements">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="section-8-1">Thanks to Robert Raszuk, Gyan Mishra, Ron Bonica for the review,
      discussions and input to the draft.<a href="#section-8-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-9">
      <h2 id="name-references">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-9.1">
        <h3 id="name-normative-references">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3392">[RFC3392]</dt>
      <dd>
<span class="refAuthor">Chandra, R.</span> and <span class="refAuthor">J. Scudder</span>, <span class="refTitle">"Capabilities Advertisement with BGP-4"</span>, <span class="seriesInfo">RFC 3392</span>, <span class="seriesInfo">DOI 10.17487/RFC3392</span>, <time datetime="2002-11" class="refDate">November 2002</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3392">https://www.rfc-editor.org/info/rfc3392</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-9.2">
        <h3 id="name-references-2">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-references-2" class="section-name selfRef">References</a>
        </h3>
<dl class="references">
<dt id="ADDPATH-GUIDELINES">[ADDPATH-GUIDELINES]</dt>
        <dd>
<span class="refAuthor">Uttaro, Ed.</span>, <span class="refTitle">"BGP Flow-Spec Redirect to IP Action"</span>, <time datetime="2016-04-25" class="refDate">25 April 2016</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-idr-add-paths-guidelines-08#section-2">https://datatracker.ietf.org/doc/html/draft-ietf-idr-add-paths-guidelines-08#section-2</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="BGP-CT">[BGP-CT]</dt>
        <dd>
<span class="refAuthor">Vairavakkalai, Ed.</span>, <span class="refTitle">"BGP Classful Transport Planes"</span>, <time datetime="2021-08-25" class="refDate">25 August 2021</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/draft-kaliraj-idr-bgp-classful-transport-planes/12/">https://datatracker.ietf.org/doc/draft-kaliraj-idr-bgp-classful-transport-planes/12/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="FLWSPC-REDIR-IP">[FLWSPC-REDIR-IP]</dt>
        <dd>
<span class="refAuthor">Simpson, Ed.</span>, <span class="refTitle">"BGP Flow-Spec Redirect to IP Action"</span>, <time datetime="2015-02-02" class="refDate">2 February 2015</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-idr-flowspec-redirect-ip#section-3">https://datatracker.ietf.org/doc/html/draft-ietf-idr-flowspec-redirect-ip#section-3</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="MPLS-NAMESPACES">[MPLS-NAMESPACES]</dt>
        <dd>
<span class="refAuthor">Vairavakkalai, Ed.</span>, <span class="refTitle">"BGP signalled MPLS-namespaces"</span>, <time datetime="2021-12-28" class="refDate">28 December 2021</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-kaliraj-bess-bgp-sig-private-mpls-labels-04">https://datatracker.ietf.org/doc/html/draft-kaliraj-bess-bgp-sig-private-mpls-labels-04</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SRTE-COLOR-ONLY">[SRTE-COLOR-ONLY]</dt>
      <dd>
<span class="refAuthor">Filsfils, Ed.</span>, <span class="refTitle">"BGP Flow-Spec Redirect to IP Action"</span>, <time datetime="2018-02-21" class="refDate">21 February 2018</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-filsfils-spring-segment-routing-policy-06#section-8.8.1">https://tools.ietf.org/html/draft-filsfils-spring-segment-routing-policy-06#section-8.8.1</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="authors-addresses">
<section id="appendix-A">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Kaliraj Vairavakkalai</span></div>
<div dir="auto" class="left"><span class="org">Juniper Networks, Inc.</span></div>
<div dir="auto" class="left"><span class="street-address">1194 N. Mathilda Ave.</span></div>
<div dir="auto" class="left">
<span class="locality">Sunnyvale</span>, <span class="region">CA</span> <span class="postal-code">94089</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:kaliraj@juniper.net" class="email">kaliraj@juniper.net</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Minto Jeyananth</span></div>
<div dir="auto" class="left"><span class="org">Juniper Networks, Inc.</span></div>
<div dir="auto" class="left"><span class="street-address">1194 N. Mathilda Ave.</span></div>
<div dir="auto" class="left">
<span class="locality">Sunnyvale</span>, <span class="region">CA</span> <span class="postal-code">94089</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:minto@juniper.net" class="email">minto@juniper.net</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Gyan Mishra</span></div>
<div dir="auto" class="left"><span class="org">Verizon Communications Inc.</span></div>
<div dir="auto" class="left"><span class="street-address">13101 Columbia Pike</span></div>
<div dir="auto" class="left">
<span class="locality">Silver Spring</span>, <span class="region">MD</span> <span class="postal-code">20904</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:gyan.s.mishra@verizon.com" class="email">gyan.s.mishra@verizon.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
