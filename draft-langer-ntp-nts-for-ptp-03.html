<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>NTS4PTP - Key Management System for the Precision Time Protocol Based on the Network Time Security Protocol</title>
<meta content="Martin Langer" name="author">
<meta content="Rainer Bermbach" name="author">
<meta content="
       This document defines a key management service for automatic key management 
for the integrated security mechanism (prong A) of IEEE Std 1588[TM]-2019 (PTPv2.1) described there 
in Annex P. It implements a key management for the immediate security processing approach and 
offers a security solution for all relevant PTP modes. The key management service for PTP is 
based on and extends the NTS Key Establishment protocol defined in IETF RFC 8915 for securing NTP, 
but works completely independent from NTP. 
    " name="description">
<meta content="xml2rfc 3.12.2" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-langer-ntp-nts-for-ptp-03" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.12.2
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.7.1
    pycountry 22.1.10
    pyflakes 2.4.0
    PyYAML 6.0
    requests 2.27.1
    setuptools 59.6.0
    six 1.16.0
    WeasyPrint 52.5
-->
<link href="/tmp/draft-langer-ntp-nts-for-ptp-03-z26pgumk.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">NTS4PTP</td>
<td class="right">February 2022</td>
</tr></thead>
<tfoot><tr>
<td class="left">Langer &amp; Bermbach</td>
<td class="center">Expires 24 August 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Time Protocol</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-langer-ntp-nts-for-ptp-03</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2022-02-20" class="published">20 February 2022</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-08-24">24 August 2022</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">M. Langer</div>
<div class="org">Ostfalia University</div>
</div>
<div class="author">
      <div class="author-name">R. Bermbach</div>
<div class="org">Ostfalia University</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">NTS4PTP - Key Management System for the Precision Time Protocol Based on the Network Time Security Protocol</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document defines a key management service for automatic key management 
for the integrated security mechanism (prong A) of IEEE Std 1588[TM]-2019 (PTPv2.1) described there 
in Annex P. It implements a key management for the immediate security processing approach and 
offers a security solution for all relevant PTP modes. The key management service for PTP is 
based on and extends the NTS Key Establishment protocol defined in IETF RFC 8915 for securing NTP, 
but works completely independent from NTP.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 24 August 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2022 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-notational-conventions" class="xref">Notational Conventions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-key-management-using-networ" class="xref">Key Management Using Network Time Security</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-principle-key-distribution-" class="xref">Principle Key Distribution Mechanism</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.1">
                    <p id="section-toc.1-1.2.2.1.2.1.1" class="keepWithNext"><a href="#section-2.1.1" class="xref">2.1.1</a>.  <a href="#name-nts-message-exchange-for-gr" class="xref">NTS Message Exchange for Group-based Approach</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.2">
                    <p id="section-toc.1-1.2.2.1.2.2.1" class="keepWithNext"><a href="#section-2.1.2" class="xref">2.1.2</a>.  <a href="#name-nts-message-exchange-for-th" class="xref">NTS Message Exchange for the Ticket-based Approach</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-general-topics" class="xref">General Topics</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.1">
                    <p id="section-toc.1-1.2.2.2.2.1.1"><a href="#section-2.2.1" class="xref">2.2.1</a>.  <a href="#name-key-update-process" class="xref">Key Update Process</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.2">
                    <p id="section-toc.1-1.2.2.2.2.2.1"><a href="#section-2.2.2" class="xref">2.2.2</a>.  <a href="#name-key-generation" class="xref">Key Generation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.3">
                    <p id="section-toc.1-1.2.2.2.2.3.1"><a href="#section-2.2.3" class="xref">2.2.3</a>.  <a href="#name-time-information-of-the-nts" class="xref">Time Information of the NTS-KE server</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.4">
                    <p id="section-toc.1-1.2.2.2.2.4.1"><a href="#section-2.2.4" class="xref">2.2.4</a>.  <a href="#name-certificates" class="xref">Certificates</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.5">
                    <p id="section-toc.1-1.2.2.2.2.5.1"><a href="#section-2.2.5" class="xref">2.2.5</a>.  <a href="#name-upfront-configuration" class="xref">Upfront Configuration</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.5.2.1">
                        <p id="section-toc.1-1.2.2.2.2.5.2.1.1"><a href="#section-2.2.5.1" class="xref">2.2.5.1</a>.  <a href="#name-security-parameters" class="xref">Security Parameters</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.5.2.2">
                        <p id="section-toc.1-1.2.2.2.2.5.2.2.1"><a href="#section-2.2.5.2" class="xref">2.2.5.2</a>.  <a href="#name-key-lifetimes" class="xref">Key Lifetimes</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.5.2.3">
                        <p id="section-toc.1-1.2.2.2.2.5.2.3.1"><a href="#section-2.2.5.3" class="xref">2.2.5.3</a>.  <a href="#name-certificates-2" class="xref">Certificates</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.5.2.4">
                        <p id="section-toc.1-1.2.2.2.2.5.2.4.1"><a href="#section-2.2.5.4" class="xref">2.2.5.4</a>.  <a href="#name-authorization" class="xref">Authorization</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.5.2.5">
                        <p id="section-toc.1-1.2.2.2.2.5.2.5.1"><a href="#section-2.2.5.5" class="xref">2.2.5.5</a>.  <a href="#name-transparent-clocks" class="xref">Transparent Clocks</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.5.2.6">
                        <p id="section-toc.1-1.2.2.2.2.5.2.6.1"><a href="#section-2.2.5.6" class="xref">2.2.5.6</a>.  <a href="#name-start-up-considerations" class="xref">Start-up considerations</a></p>
</li>
                    </ul>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="xref">2.3</a>.  <a href="#name-overview-of-nts-messages-an" class="xref">Overview of NTS Messages and their Structure for Use with PTP</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3.2.1">
                    <p id="section-toc.1-1.2.2.3.2.1.1"><a href="#section-2.3.1" class="xref">2.3.1</a>.  <a href="#name-ptp-key-request-message" class="xref">PTP Key Request Message</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3.2.2">
                    <p id="section-toc.1-1.2.2.3.2.2.1"><a href="#section-2.3.2" class="xref">2.3.2</a>.  <a href="#name-ptp-key-response-message" class="xref">PTP Key Response Message</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3.2.3">
                    <p id="section-toc.1-1.2.2.3.2.3.1"><a href="#section-2.3.3" class="xref">2.3.3</a>.  <a href="#name-ptp-registration-request-me" class="xref">PTP Registration Request Message</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3.2.4">
                    <p id="section-toc.1-1.2.2.3.2.4.1"><a href="#section-2.3.4" class="xref">2.3.4</a>.  <a href="#name-ptp-registration-response-m" class="xref">PTP Registration Response Message</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3.2.5">
                    <p id="section-toc.1-1.2.2.3.2.5.1"><a href="#section-2.3.5" class="xref">2.3.5</a>.  <a href="#name-ptp-registration-revoke-mes" class="xref">PTP Registration Revoke Message</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3.2.6">
                    <p id="section-toc.1-1.2.2.3.2.6.1"><a href="#section-2.3.6" class="xref">2.3.6</a>.  <a href="#name-heartbeat-message" class="xref">Heartbeat Message</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-nts-messages-for-ptp" class="xref">NTS Messages for PTP</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-nts-message-types" class="xref">NTS Message Types</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-nts-records" class="xref">NTS Records</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.1">
                    <p id="section-toc.1-1.3.2.2.2.1.1"><a href="#section-3.2.1" class="xref">3.2.1</a>.  <a href="#name-aead-algorithm-negotiation" class="xref">AEAD Algorithm Negotiation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.2">
                    <p id="section-toc.1-1.3.2.2.2.2.1"><a href="#section-3.2.2" class="xref">3.2.2</a>.  <a href="#name-association-mode" class="xref">Association Mode</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.3">
                    <p id="section-toc.1-1.3.2.2.2.3.1"><a href="#section-3.2.3" class="xref">3.2.3</a>.  <a href="#name-current-parameters" class="xref">Current Parameters</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.4">
                    <p id="section-toc.1-1.3.2.2.2.4.1"><a href="#section-3.2.4" class="xref">3.2.4</a>.  <a href="#name-end-of-message" class="xref">End of Message</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.5">
                    <p id="section-toc.1-1.3.2.2.2.5.1"><a href="#section-3.2.5" class="xref">3.2.5</a>.  <a href="#name-error" class="xref">Error</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.6">
                    <p id="section-toc.1-1.3.2.2.2.6.1"><a href="#section-3.2.6" class="xref">3.2.6</a>.  <a href="#name-heartbeat-timeout" class="xref">Heartbeat Timeout</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.7">
                    <p id="section-toc.1-1.3.2.2.2.7.1"><a href="#section-3.2.7" class="xref">3.2.7</a>.  <a href="#name-next-parameters" class="xref">Next Parameters</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.8">
                    <p id="section-toc.1-1.3.2.2.2.8.1"><a href="#section-3.2.8" class="xref">3.2.8</a>.  <a href="#name-nts-next-protocol-negotiati" class="xref">NTS Next Protocol Negotiation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.9">
                    <p id="section-toc.1-1.3.2.2.2.9.1"><a href="#section-3.2.9" class="xref">3.2.9</a>.  <a href="#name-nts-message-type" class="xref">NTS Message Type</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.10">
                    <p id="section-toc.1-1.3.2.2.2.10.1"><a href="#section-3.2.10" class="xref">3.2.10</a>. <a href="#name-ptp-time-server" class="xref">PTP Time Server</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.11">
                    <p id="section-toc.1-1.3.2.2.2.11.1"><a href="#section-3.2.11" class="xref">3.2.11</a>. <a href="#name-security-association" class="xref">Security Association</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.12">
                    <p id="section-toc.1-1.3.2.2.2.12.1"><a href="#section-3.2.12" class="xref">3.2.12</a>. <a href="#name-source-portidentity" class="xref">Source PortIdentity</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.13">
                    <p id="section-toc.1-1.3.2.2.2.13.1"><a href="#section-3.2.13" class="xref">3.2.13</a>. <a href="#name-status" class="xref">Status</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.14">
                    <p id="section-toc.1-1.3.2.2.2.14.1"><a href="#section-3.2.14" class="xref">3.2.14</a>. <a href="#name-supported-mac-algorithms" class="xref">Supported MAC Algorithms</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.15">
                    <p id="section-toc.1-1.3.2.2.2.15.1"><a href="#section-3.2.15" class="xref">3.2.15</a>. <a href="#name-ticket" class="xref">Ticket</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.16">
                    <p id="section-toc.1-1.3.2.2.2.16.1"><a href="#section-3.2.16" class="xref">3.2.16</a>. <a href="#name-ticket-key" class="xref">Ticket Key</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.17">
                    <p id="section-toc.1-1.3.2.2.2.17.1"><a href="#section-3.2.17" class="xref">3.2.17</a>. <a href="#name-ticket-key-id" class="xref">Ticket Key ID</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.18">
                    <p id="section-toc.1-1.3.2.2.2.18.1"><a href="#section-3.2.18" class="xref">3.2.18</a>. <a href="#name-validity-period" class="xref">Validity Period</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-additional-mechanisms" class="xref">Additional Mechanisms</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-aead-operation" class="xref">AEAD Operation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-sa-sp-management" class="xref">SA/SP Management</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-new-ticket-tlv-for-ptp-mess" class="xref">New TICKET TLV for PTP Messages</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-authentication-tlv-paramete" class="xref">AUTHENTICATION TLV Parameters</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-acknowledgements" class="xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-references" class="xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="xref">10.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="xref">10.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-A" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="notational-conventions">
<section id="section-1">
      <h2 id="name-notational-conventions">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-notational-conventions" class="section-name selfRef">Notational Conventions</a>
      </h2>
<p id="section-1-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD",
"SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this
document are to be interpreted as described in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span>
when, and only when, they appear in all capitals, as shown here.<a href="#section-1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="introduction">
<section id="section-2">
      <h2 id="name-key-management-using-networ">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-key-management-using-networ" class="section-name selfRef">Key Management Using Network Time Security</a>
      </h2>
<p id="section-2-1">In its annex P the IEEE Std 1588-2019 (<span>[<a href="#IEEE1588-2019" class="xref">IEEE1588-2019</a>]</span>, Precision 
Time Protocol version 2.1, PTPv2.1) defines a comprehensive PTP security concept based 
on four prongs (A to D). Prong A incorporates an immediate security processing approach 
and specifies in section 16.14 an extension to secure PTP messages by means of an 
AUTHENTICATION TLV (AuthTLV) containing an Integrity Check Value (ICV). For PTP 
instances to use the securing mechanism, a respective key needs to be securely distributed 
among them. Annex P gives requirements for such a key management system and mentions 
potential candidates without further specification, but allows other solutions as long 
as they fulfill those requirements.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">This document defines such a key management service for automatic key management for 
the immediate security processing in prong A. The solution <span>[<a href="#Langer_et_al._2020" class="xref">Langer_et_al._2020</a>]</span>
is based on and expands the NTS Key Establishment protocol defined in IETF RFC 8915 
<span>[<a href="#RFC8915" class="xref">RFC8915</a>]</span> for securing NTP, but works completely independent from NTP.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">Many networks include both, PTP and NTP at the same time. Furthermore, many time server 
appliances that are capable of acting as the Grandmaster of a PTP network are also capable 
of acting as an NTP server. For these reasons, it is likely to be easier both, for the time 
server manufacturer and the network operator, if PTP and NTP use a key management system 
based on the same technology. The Network Time Security (NTS) protocol was specified by the 
Internet Engineering Task Force (IETF) to protect the integrity of NTP messages 
<span>[<a href="#RFC8915" class="xref">RFC8915</a>]</span>. Its NTS Key Establishment sub-protocol is secured by the Transport 
Layer Security (TLS 1.3, IETF RFC 8446 <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span>) mechanism. TLS is used 
to protect numerous popular network protocols, so it is present in many networks. For example, 
HTTPS, the predominant secure web protocol uses TLS for security. Since many PTP capable 
network appliances have management interfaces based on HTTPS, the manufacturers are already 
implementing TLS.<a href="#section-2-3" class="pilcrow">¶</a></p>
<p id="section-2-4">Though the key management for PTP is based on the NTS Key Establishment (NTS-KE) protocol 
for NTP, it works completely independent of NTP. The key management system uses the procedures 
described in IETF RFC 8915 for the NTS-KE and expands it with new NTS messages for PTP. It 
may be applied in a Key Establishment server (NTS-KE server) that already manages NTP but 
can also be operated only handling KE for PTP. Even when the PTP network is isolated from 
the Internet, a Key Establishment server can be installed in that network providing the PTP 
instances with necessary key and security parameters.<a href="#section-2-4" class="pilcrow">¶</a></p>
<p id="section-2-5">The NTS-KE server may often be implemented as a separate unit. It also may be collocated 
with a PTP instance, e.g., the Grandmaster. In the latter case communication between the NTS-KE 
server program and the PTP instance program needs to be implemented in a secure way if TLS 
communication (e.g., via local host) is not or cannot be used.<a href="#section-2-5" class="pilcrow">¶</a></p>
<p id="section-2-6">Using the expanded NTS Key Establishment protocol for the NTS key management for PTP, 
NTS4PTP provides two principle approaches specified in this document.<a href="#section-2-6" class="pilcrow">¶</a></p>
<p id="section-2-7">1. Group-based approach (GrBA, multicast)<a href="#section-2-7" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-2-8.1">definition of one or more security groups in the PTP network,<a href="#section-2-8.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-2-8.2">very suitable for PTP multicast mode and mixed multicast/unicast mode,<a href="#section-2-8.2" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-2-8.3">suitable for unicast mode in small subgroups of very few participants 
   (Group-of-2, Go2) but poor scaling and more administration work,<a href="#section-2-8.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-2-9">2. Ticket-based approach (TiBA, unicast)<a href="#section-2-9" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-2-10.1">secured (end-to-end) PTP unicast communication between a PTP requester and grantor,<a href="#section-2-10.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-2-10.2">no group binding necessary,<a href="#section-2-10.2" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-2-10.3">very suitable for native PTP unicast mode, because of good scaling,<a href="#section-2-10.3" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-2-10.4">a bit more complex NTS message handling.<a href="#section-2-10.4" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-2-11">For these modes, the NTS key management for PTP defines six new NTS messages which will 
   be introduced in the sections to come:<a href="#section-2-11" class="pilcrow">¶</a></p>
<p id="section-2-12"></p>
<ul class="compact">
<li class="compact" id="section-2-13.1">PTP Key Request message (see <a href="#key-request" class="xref">Section 2.3.1</a>)<a href="#section-2-13.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-2-13.2">PTP Key Response message (see <a href="#key-response" class="xref">Section 2.3.2</a>)<a href="#section-2-13.2" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-2-13.3">PTP Registration Request message (see <a href="#registration-request" class="xref">Section 2.3.3</a>)<a href="#section-2-13.3" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-2-13.4">PTP Registration Response message (see <a href="#registration-response" class="xref">Section 2.3.4</a>)<a href="#section-2-13.4" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-2-13.5">PTP Registration Revoke message (see <a href="#registration-revoke" class="xref">Section 2.3.5</a>)<a href="#section-2-13.5" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-2-13.6">Heartbeat message (see <a href="#heartbeat" class="xref">Section 2.3.6</a>)<a href="#section-2-13.6" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-2-14">This document describes the structure and usage of the two approaches GrBA and TiBA in their application 
as a key management system for the integrated security mechanism (prong A) of IEEE Std 1588-2019. 
<a href="#key-distribution" class="xref">Section 2.1</a> starts with a description of the principle key distribution 
mechanism, continues with details of the various group-based options (<a href="#exchange-group-based" class="xref">Section 2.1.1</a>) 
and the ticket-based unicast mode (<a href="#exchange-ticket-based" class="xref">Section 2.1.2</a>) before it ends with 
more general topics in <a href="#general-topics" class="xref">Section 2.2</a> for example the key update process and 
finally an overview of the newly defined NTS messages in <a href="#overview-nts-messages" class="xref">Section 2.3</a>. 
<a href="#nts-messages-4-ptp" class="xref">Section 3</a> gives all the details necessary to construct all records forming 
the particular NTS messages. <a href="#new-ticket-tlv" class="xref">Section 5</a> depicts details of a TICKET TLV needed 
to transport encrypted security information in PTP unicast requests. The following 
<a href="#auth-tlv-parameters" class="xref">Section 6</a> mentions specific parameters used in the PTP AUTHENTICATION TLV 
when working with the NTS4PTP key management system. <a href="#iana-considerations" class="xref">Section 7</a> and 
<a href="#security-considerations" class="xref">Section 8</a> discuss IANA 
respectively security considerations.<a href="#section-2-14" class="pilcrow">¶</a></p>
<div id="key-distribution">
<section id="section-2.1">
        <h3 id="name-principle-key-distribution-">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-principle-key-distribution-" class="section-name selfRef">Principle Key Distribution Mechanism</a>
        </h3>
<p id="section-2.1-1">A PTP instance requests a key from the server referred to as the Key Establishment server, 
or NTS-KE server using the NTS-KE protocol defined in <span>[<a href="#RFC8915" class="xref">RFC8915</a>]</span>, see Section 1.3. 
<a href="#fig-key-distribution-sequence" class="xref">Figure 1</a> describes the principle 
sequence which can be used for PTP multicast as well as PTP unicast operation.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<span id="name-nts-key-distribution-sequen"></span><div id="fig-key-distribution-sequence">
<figure id="figure-1">
          <div class="alignLeft art-text artwork" id="section-2.1-2.1">
<pre>
PTP Instance                      NTS-KE Server

 |                                    |
 |&lt;======== Open TLS Channel ========&gt;|
 |                                    |
 |                                    |
 |========= PTP Key Request =========&gt;| ) NTS messages
 |                                    | ) for PTP
 |&lt;======== PTP Key Response =========| ) key exchange
 |                                    |
 |                                    |
 |&lt;======== Close TLS Channel =======&gt;|
 |                                    |
 |                                    o
 |
 |                              PTP Instance 2/
 |                              PTP Network
 |
 |                                    |
 |&lt;---- Secured PTP Communication ---&gt;|
 |           using shared key         |
 |                                    |
 V                                    V

</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-nts-key-distribution-sequen" class="selfRef">NTS key distribution sequence</a>
          </figcaption></figure>
</div>
<p id="section-2.1-3">The PTP instance client connects to the NTS-KE server on the NTS TCP port (port number 4460). Then both parties 
perform a TLS handshake to establish a TLS 1.3 communication channel. No earlier TLS versions 
are allowed. The details of the TLS handshake are specified in IETF RFC 8446 <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span>.<a href="#section-2.1-3" class="pilcrow">¶</a></p>
<p id="section-2.1-4">Implementations must conform to the rules stated in Section 3 "TLS Profile for Network Time 
Security" of IETF RFC 8915 <span>[<a href="#RFC8915" class="xref">RFC8915</a>]</span>:<a href="#section-2.1-4" class="pilcrow">¶</a></p>
<ul class="compact ulEmpty">
<li class="compact ulEmpty" id="section-2.1-5.1">
            <p id="section-2.1-5.1.1"><em>"Network Time Security makes use of TLS for NTS key 
      establishment.</em><a href="#section-2.1-5.1.1" class="pilcrow">¶</a></p>
<p id="section-2.1-5.1.2"></p>
</li>
          <li class="compact ulEmpty" id="section-2.1-5.2">
            <p id="section-2.1-5.2.1"><em>Since the NTS protocol is new as of this publication, no 
      backward-compatibility concerns exist to justify using obsolete, insecure, or 
  otherwise broken TLS features or versions.</em><a href="#section-2.1-5.2.1" class="pilcrow">¶</a></p>
<p id="section-2.1-5.2.2"></p>
</li>
          <li class="compact ulEmpty" id="section-2.1-5.3">
            <p id="section-2.1-5.3.1"><em>Implementations MUST conform with RFC 7525 </em>
              <span>[<a href="#RFC7525" class="xref">RFC7525</a>]</span><em> or with a later revision of BCP 195.
              </em><a href="#section-2.1-5.3.1" class="pilcrow">¶</a></p>
<p id="section-2.1-5.3.2"></p>
</li>
          <li class="compact ulEmpty" id="section-2.1-5.4">
            <p id="section-2.1-5.4.1"><em>Implementations MUST NOT negotiate TLS versions earlier than 
      1.3 </em><span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span><em> and MAY refuse to negotiate 
  any TLS version that has been superseded by a later supported version.</em><a href="#section-2.1-5.4.1" class="pilcrow">¶</a></p>
<p id="section-2.1-5.4.2"></p>
</li>
          <li class="compact ulEmpty" id="section-2.1-5.5">
            <em>Use of the Application-Layer Protocol Negotiation Extension 
            </em><span>[<a href="#RFC7301" class="xref">RFC7301</a>]</span><em> is integral to NTS, and support 
  for it is REQUIRED for interoperability ... "</em><a href="#section-2.1-5.5" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-2.1-6">The client starts the TLS handshake with a 'Client Hello' message that must contain two 
TLS extensions. The first extension is the Application Layer Protocol Negotiation <span>[<a href="#RFC7301" class="xref">RFC7301</a>]</span> 
(ALPN with "ntske/1", which refers to the NTS Key Establishment as the subsequent protocol.) 
The second extension is the Post-Handshake Client Authentication, which the client uses to signal the 
TLS server that the client certificate can be requested after the TLS handshake.  Afterwards, 
the client authenticates the NTS-KE server using the root CA certificate or by means of the 
Online Certificate Status Protocol (OCSP). Both, client and server agree on the cipher suite 
and then establish a secured channel that ensures authenticity, integrity and confidentiality 
for subsequent messages. In the process, the NTS-KE server acknowledges the ALPN and expects 
a message from the NTS-KE protocol.<a href="#section-2.1-6" class="pilcrow">¶</a></p>
<p id="section-2.1-7">Thus, the TLS handshake accomplishes the following:<a href="#section-2.1-7" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-2.1-8.1">Negotiation of TLS version (only TLS 1.3 allowed), and<a href="#section-2.1-8.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-2.1-8.2">negotiation of the cipher suite for the TLS session, and<a href="#section-2.1-8.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-2.1-8.3">authentication of the TLS server (equivalent to the NTS-KE server) using a digital 
      X.509 certificate,<a href="#section-2.1-8.3" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-2.1-8.4">and the encryption of the subsequent information exchange between the TLS communication 
      partners.<a href="#section-2.1-8.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-2.1-9">TLS is a layer five protocol that runs on TCP over IP. Therefore, PTP implementations that 
support NTS-based key management need to support TCP and IP (at least on a separate management port).<a href="#section-2.1-9" class="pilcrow">¶</a></p>
<p id="section-2.1-10">Once the TLS session is established, the PTP instance will ask for a PTP key as well as the 
associated security parameters using the new NTS message PTP Key Request (see <a href="#key-request" class="xref">Section 2.3.1</a>). 
Then the server requests the client's X.509 certificate (via TLS Certificate Request) and verifies it upon receipt.
In NTS for NTP this was unnecessary, in NTS4PTP the clients MUST be authenticated, too.
The NTS application of the NTS-KE server will respond with a PTP Key 
Response message (see <a href="#key-response" class="xref">Section 2.3.2</a>). If no delivery of security data is possible 
for whatever reason, the PTP Key Response message contains a respective error code. All messages 
are constructed from specific records as described in <a href="#nts-records" class="xref">Section 3.2</a>.<a href="#section-2.1-10" class="pilcrow">¶</a></p>
<p id="section-2.1-11">When the PTP Key Request message was responded with a PTP Key Response, the TLS 
session will be closed with a 'close notify' TLS alert from both parties, the PTP instance 
and the key server.<a href="#section-2.1-11" class="pilcrow">¶</a></p>
<p id="section-2.1-12">With the key and other information received, the PTP instance can take part in the secured 
PTP communication in the different modes of operation.<a href="#section-2.1-12" class="pilcrow">¶</a></p>
<p id="section-2.1-13">After the reception of the first set of security parameters the PTP instance may resume the 
TLS session according to IETF RFC 8446 <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span>, 
Section 4.6.1, allowing the PTP instance to skip the TLS version and algorithm negotiations. 
If TLS Session Resumption (<span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span>, Section 2.2) is used and supported by the 
NTS-KE server, a suitable lifetime (max. 24 hrs) for the TLS session key must be defined to 
not open the TLS connection for security threats. If the NTS-KE server does not support TLS 
resumption, a full TLS handshake must be performed.<a href="#section-2.1-13" class="pilcrow">¶</a></p>
<p id="section-2.1-14">As the TLS session provides authentication, but not authorization additional means have 
to be used for the latter (see <a href="#upfront-authorization" class="xref">Section 2.2.5.4</a>).<a href="#section-2.1-14" class="pilcrow">¶</a></p>
<p id="section-2.1-15">As mentioned above, the NTS key management for PTP supports two principle methods, the 
group-based approach (GrBA) and the ticket-based approach (TiBA) which are described in the following 
sections below.<a href="#section-2.1-15" class="pilcrow">¶</a></p>
<div id="exchange-group-based">
<section id="section-2.1.1">
          <h4 id="name-nts-message-exchange-for-gr">
<a href="#section-2.1.1" class="section-number selfRef">2.1.1. </a><a href="#name-nts-message-exchange-for-gr" class="section-name selfRef">NTS Message Exchange for Group-based Approach</a>
          </h4>
<p id="section-2.1.1-1">As described in <a href="#key-distribution" class="xref">Section 2.1</a>, a PTP instance wanting to join a secured 
PTP communication in the group-based modes contacts the NTS-KE server starting the establishment 
of a secured TLS connection using the NTS-KE protocol (ALPN: ntske/1). Then, the client continues 
with a PTP Key Request message, asking for a specific group (see <a href="#key-request" class="xref">Section 2.3.1</a>) as shown in 
<a href="#fig-group-based" class="xref">Figure 2</a>. After receiving the message, the NTS-KE server requests the 
client's certificate and performs an authorization check. The NTS-KE server then replies with a 
PTP Key Response message (see <a href="#key-response" class="xref">Section 2.3.2</a>) with all the necessary data to 
join the group communication. Else, it contains a respective error code if the PTP instance 
is not allowed to join the group. This procedure is necessary for all parties, which are or 
will be members of that PTP group including the Grandmaster and other special participants, 
e.g., Transparent Clocks. As mentioned above, this not only applies to multicast mode but also 
to mixed multicast/unicast mode (former hybrid mode) where the explicit unicast communication 
uses the multicast group key received from the NTS-KE server. The group number for both modes 
is primarily generated by a concatenation  of the PTP domain number and the PTP profile identifier 
(sdoId), as described in <a href="#association-mode" class="xref">Section 3.2.2</a>.<a href="#section-2.1.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1.1-2">Additionally, besides multicast and mixed multicast/unicast mode, a group of two (or few 
more) PTP instances can be configured, practically implementing a special group-based unicast 
communication mode, the group-of-2 (Go2) mode.<a href="#section-2.1.1-2" class="pilcrow">¶</a></p>
<span id="name-message-exchange-for-the-gr"></span><div id="fig-group-based">
<figure id="figure-2">
            <div class="alignLeft art-text artwork" id="section-2.1.1-3.1">
<pre>
Secured
PTP Network       PTP Instance          NTS-KE Server

 |                      |         TLS:        |
 |                  TLS |== PTP Key Request =&gt;| Response contains:
 |              secured |                     | GroupID, security
 |        communication |         TLS:        | parameters, group
 |                      |&lt;= PTP Key Response =| key, validity
 |                      |                     | period etc.
 |    Secured PTP:      |                     |
 |--- Announce --------&gt;|  )                  |
 |                      |  )                  |
 |    Secured PTP:      |  )                  |
 |-- Sync &amp; Follow_Up -&gt;|  )                  |
 |                      |  ) Secured          |
 |                      |  ) PTP messages     |
 |    Secured PTP:      |  ) using            |
 |&lt;-- Delay_Req --------|  ) group key        |
 |                      |  )                  |
 |    Secured PTP:      |  )                  |
 |--- Delay_Resp ------&gt;|  )                  |
 |                      |  )                  |
 V                      V                     V

Legend:        TLS:       Authenticated &amp; encrypted
          =============&gt;  TLS communication

           Secured PTP:   Group key-authenticated
          -------------&gt;  PTP communication



</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-message-exchange-for-the-gr" class="selfRef">Message exchange for the group-based approach</a>
            </figcaption></figure>
</div>
<p id="section-2.1.1-4">This Go2 mode requires additional administration in advance defining groups-of-2 and supplying 
them with an additional attribute in addition to the group number mentioned for the other 
group-based modes - the subGroup attribute in the Association Mode record (see <a href="#association-mode" class="xref">Section 3.2.2</a>) of 
the PTP Key Request message. So, addressing for Go2 is achieved by use of the group number 
derived from domain number, sdoId and the additional attribute subGroup. Communication in 
that mode is performed using multicast addresses. If the latter is undesirable, unicast 
addresses can be used but the particular IP or MAC addresses of the communication partners 
need to be configured upfront, too.<a href="#section-2.1.1-4" class="pilcrow">¶</a></p>
<p id="section-2.1.1-5">In spite of its specific name, Go2 allows more than two participants, for example additional 
Transparent Clocks. All participants in that subgroup need to be configured respectively. 
(To enable the NTS-KE server to supply the subgroup members with the particular security data 
the respective certificates may reflect permission to take part in the subgroup. Else another 
authorization method is to be used.)<a href="#section-2.1.1-5" class="pilcrow">¶</a></p>
<p id="section-2.1.1-6">Having predefined the Go2s the key management for this mode of operation follows the same 
procedure (see <a href="#fig-group-based" class="xref">Figure 2</a>) and uses the same NTS messages as the other 
group-based modes. Both participants, the Group-of-2 requester and the respective grantor need 
to have received their security parameters including key etc. before secure PTP communication 
can take place.<a href="#section-2.1.1-6" class="pilcrow">¶</a></p>
<p id="section-2.1.1-7">After the NTS key establishment messages for these group-based modes have been exchanged, 
the secured PTP communication can take place using the security association(s) communicated.
The participants of the PTP network are now able to use the group key to verify secured PTP 
messages of the corresponding group or to generate secured PTP messages itself. In order to 
do this, the PTP node applies the group key together with the MAC algorithm to the PTP packet 
to generate the ICV transported in the AUTHENTICATION TLV of the PTP message.<a href="#section-2.1.1-7" class="pilcrow">¶</a></p>
<p id="section-2.1.1-8">The key management for these modes works relatively simple and needs only the above mentioned 
two NTS messages: PTP Key Request and PTP Key Response.<a href="#section-2.1.1-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="exchange-ticket-based">
<section id="section-2.1.2">
          <h4 id="name-nts-message-exchange-for-th">
<a href="#section-2.1.2" class="section-number selfRef">2.1.2. </a><a href="#name-nts-message-exchange-for-th" class="section-name selfRef">NTS Message Exchange for the Ticket-based Approach</a>
          </h4>
<p id="section-2.1.2-1">The scaling problems of the group-based approach are solved by the ticket-based approach (TiBA) 
for unicast connections. TiBA ensures end-to-end security between the two PTP communication partners, 
requester and grantor, and is therefore only suitable for PTP unicast where no group binding exists. 
Therefore, this model scales excellently with the number of connections. TiBA also allows free MAC 
algorithm and server negotiation, eliminating the need for the administrator to manually prepare the 
table of acceptable unicast masters at each individual PTP node. In addition, this allows optional 
load control by the NTS-KE server.<a href="#section-2.1.2-1" class="pilcrow">¶</a></p>
<p id="section-2.1.2-2">In (native) PTP unicast mode using unicast message negotiation (<span>[<a href="#IEEE1588-2019" class="xref">IEEE1588-2019</a>]</span>, 
Section 16.1) any potential instance (the grantor) which can be contacted by other PTP instances 
(the requesters) needs to register upfront with the NTS-KE server as depicted in <a href="#fig-ticket-based" class="xref">Figure 3</a>.<a href="#section-2.1.2-2" class="pilcrow">¶</a></p>
<span id="name-message-exchange-for-ticket"></span><div id="fig-ticket-based">
<figure id="figure-3">
            <div class="alignLeft art-text artwork" id="section-2.1.2-3.1">
<pre>
     PTP Requester         NTS-KE Server            PTP Grantor

             |                 |         TLS:        |Grantor
             |    KE generates |&lt;= PTP Registration =|registers
             |      ticket key |       Request       |upfront
             |                 |                     |
             |                 |        TLS:         |gets
             |        KE sends |== PTP Registration &gt;|ticket
             |      ticket key |       Response      |key to
             |                 |                     |decrypt
             |                 |                     |tickets
             :                 :                     :
 PTP instance|     TLS:        |                     |
wants unicast|== PTP Key =====&gt;| KE generates        |
communication|   Request       | and sends           |
             |                 | unicast key         |
             |     TLS:        | &amp; encrypted         |
             |&lt;= PTP Key ======| ticket              |
             |   Response      |                     |
             |                 |                     |decrypts
      Unicast|                 |                     |ticket,
      request|   Secured PTP:  |                     |extracts
     contains|-- Unicast  --------------------------&gt;|containing
       ticket|   Request       |                     |unicast key
             |                 |                     |
             |   Secured PTP:  |                     |Grantor uses
             |&lt;- Grant ------------------------------|unicast key
             |                 |                     |
             V                 V                     V

Legend:        TLS:       Authenticated &amp; encrypted
          =============&gt;  TLS communication

           Secured PTP:   Unicast key-authenticated
          -------------&gt;  PTP communication


</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-message-exchange-for-ticket" class="selfRef">Message exchange for ticket-based unicast mode</a>
            </figcaption></figure>
</div>
<p id="section-2.1.2-4">(Note: As any PTP instance may request unicast messages from any other instance the terms 
requester and grantor as used in the standard suit better than talking about slave respectively 
master. In unicast PTP, the grantor is typically a PTP Port in the MASTER state, and the requester 
is typically a PTP Port in the SLAVE state. However all PTP Ports are allowed to grant and request 
unicast PTP message contracts regardless of which state they are in. A PTP port in MASTER state 
may be requester, a port in SLAVE state may be a grantor.)<a href="#section-2.1.2-4" class="pilcrow">¶</a></p>
<p id="section-2.1.2-5">Since the registration of unicast grantors is not provided for in the NTS-KE protocol, a new 
sub-protocol is needed, the NTS Time Server Registration (NTS-TSR) protocol. NTS-TSR does not 
conflict with NTS for NTP, and the original procedure for NTS-secured NTP remains unchanged. 
All NTS requests still arrive at the NTS-KE server on port 4460/TCP, whether a simple client 
or a time server connects. The authentication of the NTS-KE server by the querying partner 
already takes place when the TLS connection is established. In doing so, it chooses the NTS 
protocol to be used by selecting the ALPN  <span>[<a href="#RFC7301" class="xref">RFC7301</a>]</span>. If the ALPN contains the string "ntske/1", 
the NTS Key Establishment protocol is executed after the TLS handshake (see group-based approach). 
If it contains "ntstsr/1" instead, the NTS Time Server Registration protocol is executed.
(Unlike the NTS-KE protocol, requesting grantors are already authenticated during the TLS handshake.)<a href="#section-2.1.2-5" class="pilcrow">¶</a></p>
<p id="section-2.1.2-6"> The registration of a PTP grantor is performed via a PTP Registration Request message 
(see <a href="#registration-request" class="xref">Section 2.3.3</a>). The NTS-KE server answers with a PTP Registration 
Response message (see <a href="#registration-response" class="xref">Section 2.3.4</a>).  If no delivery of security data 
is possible for whatever reason, the PTP Registration Response message contains a respective 
error code.<a href="#section-2.1.2-6" class="pilcrow">¶</a></p>
<p id="section-2.1.2-7">With the reception of the PTP Registration Response message, the grantor holds a ticket key known 
only to the NTS-KE server and the registered grantor. With this ticket key it can decrypt  
cryptographic information contained in a so-called ticket which enables secure unicast 
communication.<a href="#section-2.1.2-7" class="pilcrow">¶</a></p>
<p id="section-2.1.2-8">After the end of the registration process (phase 1), phase 2 begins with the key request 
of the client (now called requester). Similar to the group-based approach, a PTP instance 
(the requester) wanting to start a secured PTP unicast communication with a specific grantor 
contacts the NTS-KE server sending a PTP Key Request message (see <a href="#key-request" class="xref">Section 2.3.1</a>) 
as shown in <a href="#fig-key-request" class="xref">Figure 7</a>, again using the TLS-secured NTS Key Establishment 
protocol. The NTS-KE server performs the authentication check of the client and then answers 
with a PTP Key Response message (see <a href="#key-response" class="xref">Section 2.3.2</a>) with all the necessary 
data to begin the unicast communication with the desired partner or with a respective error 
code if unicast communication with that instance is unavailable. Though the message types 
are the same as in GrBA the content differs.<a href="#section-2.1.2-8" class="pilcrow">¶</a></p>
<p id="section-2.1.2-9">The PTP Key Response message includes a unicast key to secure the PTP message exchange with 
the desired grantor. In addition, it contains the above mentioned (partially) encrypted ticket which the 
requester later (phase 3) transmits in a special Ticket TLV (see <a href="#new-ticket-tlv" class="xref">Section 5</a>) 
with the secured PTP message to the grantor.<a href="#section-2.1.2-9" class="pilcrow">¶</a></p>
<p id="section-2.1.2-10">After the NTS key establishment messages for the PTP unicast mode have been exchanged, finally, 
the secured PTP communication (phase 3) can take place using the security association(s) 
communicated. A requester may send a (unicast key) secured PTP signaling message containing 
the received encrypted ticket, asking for a grant of a so-called unicast contract which contains 
a request for a specific PTP message type, as well as the desired frame rate.<a href="#section-2.1.2-10" class="pilcrow">¶</a></p>
<p id="section-2.1.2-11">The grantor receiving the PTP message decrypts the received ticket with its 
ticket key and extracts the containing security parameters, for example the unicast key used 
by the requester to secure the PTP message and the requester's identity. In that way the 
grantor can check the received message, identify the requester and can use the unicast key 
for further secure PTP communication with the requester until the unicast key expires.<a href="#section-2.1.2-11" class="pilcrow">¶</a></p>
<p id="section-2.1.2-12">A grantor that supports unicast and provides sufficient capacity will acknowledge the request 
for a unicast contract with a PTP unicast grant.<a href="#section-2.1.2-12" class="pilcrow">¶</a></p>
<p id="section-2.1.2-13">If a grantor is no longer at disposal for unicast mode during the lifetime of registration 
and ticket key, it sends a TLS-secured PTP Registration Revoke message (see <a href="#registration-revoke" class="xref">Section 2.3.5</a>, 
not shown in <a href="#fig-ticket-based" class="xref">Figure 3</a>) to the NTS-KE server, so requesters no longer 
receive PTP Key Response messages for this grantor.<a href="#section-2.1.2-13" class="pilcrow">¶</a></p>
<p id="section-2.1.2-14">The Heartbeat message (see <a href="#heartbeat" class="xref">Section 2.3.6</a>, not shown in <a href="#fig-ticket-based" class="xref">Figure 3</a>) 
allows grantors to send messages to the NTS-KE server at regular intervals during the validity 
of the current security data and signal their own functionality. Optionally, these messages 
can contain status reports, for example, to enable load balancing between the registered 
time servers or to provide additional monitoring.<a href="#section-2.1.2-14" class="pilcrow">¶</a></p>
<p id="section-2.1.2-15">With its use of two protocols, the NTS-KE and the NTS-TSR protocol, this unicast mode is a 
bit more complex than the Group-of-2 approach and eventually uses all six new NTS messages. 
However, no subgroups have to be defined upfront. Addressing a grantor, the requesting instance 
simply may use the grantor's IP, MAC address or PortIdentity attribute.<a href="#section-2.1.2-15" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="general-topics">
<section id="section-2.2">
        <h3 id="name-general-topics">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-general-topics" class="section-name selfRef">General Topics</a>
        </h3>
<p id="section-2.2-1">This section describes more general topics like key update and key generation as well as discussion 
of the time information on the NTS-KE server, the use of certificates and topics concerning upfront 
configuration.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<div id="key-update">
<section id="section-2.2.1">
          <h4 id="name-key-update-process">
<a href="#section-2.2.1" class="section-number selfRef">2.2.1. </a><a href="#name-key-update-process" class="section-name selfRef">Key Update Process</a>
          </h4>
<p id="section-2.2.1-1">The security parameters update process is an important part of NTS4PTP. It keeps the keys up to date, 
allows for both, runtime security policy changes and easy group control. The rotation operation allows 
uninterrupted PTP operation in multicast as well as unicast mode.<a href="#section-2.2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.2.1-2">The update mechanism is based on the Validity Period record in the NTS response messages, which 
includes the three values lifetime, update period (UP) and grace period (GP), see 
<a href="#fig-update-group-based" class="xref">Figure 4</a>. The lifetime 
parameter specifies the validity period of the security parameters (e.g., security association (SA) and 
ticket) in seconds, which is counted down. This value can range from a few minutes to a few days. 
(Due to the design of the replay protection, a maximum lifetime of up to 388 days is possible, but 
should not be exploited). After the validity period has expired, the security parameters may no longer 
be used to secure PTP messages and must be deleted soon after.<a href="#section-2.2.1-2" class="pilcrow">¶</a></p>
<p id="section-2.2.1-3">New security parameters are available on the NTS-KE server during the update period, a time span 
before the expiry of the lifetime. The length of the update period is therefore always shorter 
than the full lifetime and is typically in the range of a few minutes. To ensure uninterrupted 
rotation for unicast connections, it is also necessary to ensure that the update period is 
greater than the minimum unicast contract time.<a href="#section-2.2.1-3" class="pilcrow">¶</a></p>
<p id="section-2.2.1-4">The grace period also helps to ensure uninterrupted key rotation. This value defines a period 
of time after the lifetime expiry during which the expired security parameters continue to be 
accepted. The grace period covers a few seconds at most and is only intended to compensate for 
runtime delays in the network during the update process. The respective values of the three 
parameters are defined by the administrator and can also be specified by a corresponding PTP 
profile.<a href="#section-2.2.1-4" class="pilcrow">¶</a></p>
<span id="name-example-of-the-parameter-ro"></span><div id="fig-update-group-based">
<figure id="figure-4">
            <div class="alignLeft art-text artwork" id="section-2.2.1-5.1">
<pre>
|12,389s (@time of key request)  0s|14,400s                   0s|
+----------------------------------+------------------...-------+
| Lifetime (current parameters)    |  Lifetime (next parameters)|
+-------------------------+--------+------------------...-------+
                          |  300s  |  10s |
                          |&lt;------&gt;|&lt;----&gt;|
                          | update |grace |
                          | period |period|
                          |________|______|
                               |       |
                               V       V
 Request and receive new parameters   Still accepting
          at a random point in time   old parameters

Example:
--------
lifetime (full): 14,400s = 4h
update period:   300s = 5 min
grace period     10s


</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-example-of-the-parameter-ro" class="selfRef">Example of the parameter rotation using lifetime, update period and                                                       grace period in group-based mode</a>
            </figcaption></figure>
</div>
<p id="section-2.2.1-6">As the value for lifetime is specified in seconds which denote the remaining time and is decremented down 
to zero, hard adjustments of the clock used have to be avoided. Therefore, the use of a monotonic 
clock is recommended. Requests during the currently running validity period will receive respectively 
adapted count values.<a href="#section-2.2.1-6" class="pilcrow">¶</a></p>
<p id="section-2.2.1-7">The Validity Period record (see <a href="#validity-period" class="xref">Section 3.2.18</a>) with its parameters lifetime, update time and grace period is contained 
in a so-called Current Parameters container record. Together 
with other security parameters this container record is always present in a PTP Key respectively Registration 
Response message. During the update period the response message additionally comprises the Next Parameters 
container record, which holds the new lifetime etc. starting at the end of the current lifetime as well 
as the other security parameters of the upcoming lifetime cycle.<a href="#section-2.2.1-7" class="pilcrow">¶</a></p>
<p id="section-2.2.1-8">Any PTP client sending a PTP Key Request to the NTS-KE server, be it in GrBA to receive the group 
SA or be it in TiBA asking for the unicast SA (unicast key etc. and encrypted ticket), will receive 
the Current Parameters container record where lifetime includes the remaining time to run rather 
than the full. Requesting during the update period the response includes also the new lifetime value 
in the Next Parameters container record. The new lifetime is the full value of the validity starting 
at the end of the current lifetime and update period. After the old lifetime has expired, only the 
new parameters (including lifetime, update period and grace period) have to be used. Merely during the 
grace period, the old SA will be accepted to cope with smaller delays in the PTP communication.<a href="#section-2.2.1-8" class="pilcrow">¶</a></p>
<p id="section-2.2.1-9">All PTP clients are obliged to connect to the NTS-KE server during the update period to allow for 
uninterrupted secured PTP operation. To avoid peak load on the NTS-KE server all clients SHOULD choose 
a random starting time during the update period.<a href="#section-2.2.1-9" class="pilcrow">¶</a></p>
<p id="section-2.2.1-10">In TiBA the unicast grantors execute the NTS-TSR protocol to register with the NTS-KE server. The 
rotation sequence (see <a href="#fig-update-ticket-based" class="xref">Figure 5</a>) and the behavior of the PTP 
Registration Response message is almost identical to the NTS-KE protocol. The main difference here 
is that the update period has to start earlier so that a grantor has re-registered before requesters 
ask for new security parameters at the NTS-KE server.<a href="#section-2.2.1-10" class="pilcrow">¶</a></p>
<p id="section-2.2.1-11">As the difference between the start of the requester's update period and the beginning of the 
update period of the grantor is not communicated, the grantor should contact the NTS-KE server directly 
after the start of its update period. However, since the rotation periods occur at different times 
for multiple grantors, no load peaks occur here either.<a href="#section-2.2.1-11" class="pilcrow">¶</a></p>
<p id="section-2.2.1-12">If a grantor does not re-register in time, requesters asking for a key etc. may not receive a 
Next Parameters container record, as no new SA is available at that point. So, requesters need to 
try again later in their update period.<a href="#section-2.2.1-12" class="pilcrow">¶</a></p>
<p id="section-2.2.1-13">As unicast contracts in TiBA run independently of the update cycle, a special situation may occur. 
If the remaining lifetime is short, it may be necessary to select a shorter time for the unicast 
contract validity period because the unicast contract cannot run longer than the lifetime. If a 
unicast contract is to be extended within the update period and the requester already owns the new 
ticket, it can already apply the upcoming security parameters here. This corresponds to some kind 
of negative grace period (pre-validity use of upcoming security parameters) and allows the requester 
to negotiate the full time for the unicast contract with the grantor.<a href="#section-2.2.1-13" class="pilcrow">¶</a></p>
<p id="section-2.2.1-14">If a grantor has revoked his registration with a PTP Registration Revoke message, requesters 
will receive a PTP Key Response message with an error code when trying to update for a new unicast 
key. No immediate key revoke mechanism exists. The grantor SHOULD not grant respective unicast 
requests during the remaining lifetime of the revoked key.<a href="#section-2.2.1-14" class="pilcrow">¶</a></p>
<span id="name-example-of-the-parameter-rot"></span><div id="fig-update-ticket-based">
<figure id="figure-5">
            <div class="alignLeft art-text artwork" id="section-2.2.1-15.1">
<pre>
Update process grantor:
-----------------------

(@time of registration response)
  |
|14,400s                          0s |14,400s                 0s|
+---------------------------------------------------...---------+
|Lifetime (current ticket key)       |Lifetime (next ticket key)|
+----------------------+------+------+--------------...---------+
                       | 180s |      :
                       |&lt;----&gt;|      :
                       |update|      :
                       |period|      :
                       |______|      :
                           |  :      :
                           V  :      :
              Re-registration :      :
                              :      :
                              :      :
Update process requester:     :      :
-------------------------     :      :
                              :      :
    |12,389s (@time of key request)0s|14,400s                 0s|
    +--------------------------------+----------------...-------+
    | Lifetime (current parameters)  |Lifetime (next parameters)|
    +-------------------------+------+------+---------...-------+
                              | 300s |  10s |
                              |&lt;----&gt;|&lt;----&gt;|
                              |update|grace |
                              |period|period|
                              |______|______|
                                 |       |
                                 V       V
 Request and receive new parameters    Still accepting
          at a random point in time    old parameters

Example:
--------
lifetime (full):        14,400s = 4h
update period grantor:     180s = 3 min
update period requester:   300s = 5 min
grace period:               10s


</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-example-of-the-parameter-rot" class="selfRef">Example of the parameter rotation using lifetime and                                                       update period in ticket-based mode</a>
            </figcaption></figure>
</div>
</section>
</div>
<div id="key-generation">
<section id="section-2.2.2">
          <h4 id="name-key-generation">
<a href="#section-2.2.2" class="section-number selfRef">2.2.2. </a><a href="#name-key-generation" class="section-name selfRef">Key Generation</a>
          </h4>
<p id="section-2.2.2-1">In all cases keys obtained by a secure random number generator SHALL be used. The length of 
the keys depends on the MAC algorithm (see also last subsection in <a href="#sa-sp-management" class="xref">Section 4.2</a>) 
respectively the AEAD algorithm utilized.<a href="#section-2.2.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="time-ke-server">
<section id="section-2.2.3">
          <h4 id="name-time-information-of-the-nts">
<a href="#section-2.2.3" class="section-number selfRef">2.2.3. </a><a href="#name-time-information-of-the-nts" class="section-name selfRef">Time Information of the NTS-KE server</a>
          </h4>
<p id="section-2.2.3-1">As the NTS-KE server embeds time duration information in the respective messages, its local time 
should be accurate to within a few seconds compared to the controlled PTP network(s). To 
avoid any dependencies, it should synchronize to a secure external time source, for example an 
NTS-secured NTP server. The time information is also necessary to check the lifetime of certificates used.<a href="#section-2.2.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="certificates">
<section id="section-2.2.4">
          <h4 id="name-certificates">
<a href="#section-2.2.4" class="section-number selfRef">2.2.4. </a><a href="#name-certificates" class="section-name selfRef">Certificates</a>
          </h4>
<p id="section-2.2.4-1">The authentication of the TLS communication parties is based on certificates issued by a trusted 
Certificate Authority (CA) that are utilized during the TLS handshake. In classical TLS applications 
only servers are required to have them. For the key management system described here,  the PTP nodes 
also need certificates to allow only authorized and trusted devices to get the group key and join 
a secure PTP network. (As TLS only authenticates the communication partners, authorization has to 
be managed by external means, see the topic "Authorization" in <a href="#upfront-authorization" class="xref">Section 2.2.5.4</a>.) 
The verification of a certificate always requires a loose time synchronicity, 
because they have a validity period. This, however, reveals the well-known start-up problem, since 
secure time transfer itself requires valid certificates. (See the discussion and proposals on this 
topic in IETF RFC 8915 <span>[<a href="#RFC8915" class="xref">RFC8915</a>]</span>, Section 8.5 "Initial Verification of Server certificates" 
which applies to client and server certificates in the PTP key management system, too.)<a href="#section-2.2.4-1" class="pilcrow">¶</a></p>
<p id="section-2.2.4-2">Furthermore, some kind of Public Key Infrastructure (PKI) is necessary, which may be conceivable via 
the Online Certificate Status Protocol (OCSP) as well as offline via root CA certificates.<a href="#section-2.2.4-2" class="pilcrow">¶</a></p>
<p id="section-2.2.4-3">The TLS communication parties must be equipped with a private key and a certificate in advance. The 
certificate contains a digital signature of the CA as well as the public key of the sender. The key 
pair is required to establish an authenticated and encrypted channel for the initial TLS phase. 
Distribution and update of the certificates can be done manually or automatically. However, it is 
important that they are issued by a trusted CA instance, which can be either local (private CA) or 
external (public CA).<a href="#section-2.2.4-3" class="pilcrow">¶</a></p>
<p id="section-2.2.4-4">For the certificates the standard for X.509 <span>[<a href="#ITU-T_X.509" class="xref">ITU-T_X.509</a>]</span> certificates MUST be used. 
Additional data in the certificates like domain, sdoId and/or subgroup attributes may help in authorizing. 
In that case it should be noted that using the PTP device in another network then implies to have a new 
certificate, too. Working with certificates without authorization information would not have that 
disadvantage, but more configuring at the NTS-KE server would be necessary: which domain, sdoId and/or 
subgroup attributes belong to which certificate.<a href="#section-2.2.4-4" class="pilcrow">¶</a></p>
<p id="section-2.2.4-5">As TLS is used to secure both sub protocols, the NTS KE and the NTS-TSR protocol, a comment on the security of TLS 
seems reasonable. A TLS 1.3 connection is considered secure today. However, note that a DoS (Denial 
of Service) attack on the key server can prevent new connections or parameter updates for secure 
PTP communication. A hijacked key management system is also critical, because it can completely 
disable the protection mechanism. A redundant implementation of the key server is therefore essential 
for a robust system. A further mitigation can be the limitation of the number of TLS requests of 
single PTP nodes to prevent flooding. But such measures are out of the scope of this document.<a href="#section-2.2.4-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="upfront-configuration">
<section id="section-2.2.5">
          <h4 id="name-upfront-configuration">
<a href="#section-2.2.5" class="section-number selfRef">2.2.5. </a><a href="#name-upfront-configuration" class="section-name selfRef">Upfront Configuration</a>
          </h4>
<p id="section-2.2.5-1">All PTP instances as well as the NTS-KE server need to be configured by the network administrator. 
This applies to several fields of parameters.<a href="#section-2.2.5-1" class="pilcrow">¶</a></p>
<div id="upfront-security-parameters">
<section id="section-2.2.5.1">
            <h5 id="name-security-parameters">
<a href="#section-2.2.5.1" class="section-number selfRef">2.2.5.1. </a><a href="#name-security-parameters" class="section-name selfRef">Security Parameters</a>
            </h5>
<p id="section-2.2.5.1-1">The cryptographic algorithm and associated parameters (the so-called security association(s) - SA) 
used for PTP keys are configured by network operators at the NTS-KE server. PTP instances that do not support the configured 
algorithms cannot operate with the security. Since most PTP networks are managed by a single organization, 
configuring the cryptographic algorithm (MAC) for ICV calculation is practical. This prevents the 
need for the NTS-KE server and PTP instances to implement an NTS algorithm negotiation protocol.<a href="#section-2.2.5.1-1" class="pilcrow">¶</a></p>
<p id="section-2.2.5.1-2">For the ticket-based approach the AEAD algorithms need to be specified which the PTP grantors and 
the NTS-KE server support and negotiate during the registration process. Optionally, the MAC algorithm may 
be negotiated during a unicast PTP Key Request to allow faster or stronger algorithms, but a standard 
protocol supported by every instance should be defined. Eventually, suitable algorithms may be defined 
in a respective PTP profile.<a href="#section-2.2.5.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="upfront-key-lifetimes">
<section id="section-2.2.5.2">
            <h5 id="name-key-lifetimes">
<a href="#section-2.2.5.2" class="section-number selfRef">2.2.5.2. </a><a href="#name-key-lifetimes" class="section-name selfRef">Key Lifetimes</a>
            </h5>
<p id="section-2.2.5.2-1">Supplementary to the above mentioned SAs the desired key rotation periods, i.e., the lifetimes of 
keys respectively all security parameters need to be configured at the NTS-KE server. This applies to the 
lifetime of a group key in the group-based approach as well as the lifetime of ticket key and unicast 
key in the ticket-based unicast approach (typically for every unicast pair in general or eventually 
specific for each requestor-grantor pair). In addition, the corresponding update periods and grace 
periods need to be defined. Any particular lifetime, update period and grace period is configured as 
time spans specified in seconds.<a href="#section-2.2.5.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="upfront-certificates">
<section id="section-2.2.5.3">
            <h5 id="name-certificates-2">
<a href="#section-2.2.5.3" class="section-number selfRef">2.2.5.3. </a><a href="#name-certificates-2" class="section-name selfRef">Certificates</a>
            </h5>
<p id="section-2.2.5.3-1">The network administrator has to supply each PTP instance and the NTS-KE server with their X.509 
certificates. The TLS communication parties must be equipped with a private key and a certificate 
containing the public key in advance (see <a href="#certificates" class="xref">Section 2.2.4</a>).<a href="#section-2.2.5.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="upfront-authorization">
<section id="section-2.2.5.4">
            <h5 id="name-authorization">
<a href="#section-2.2.5.4" class="section-number selfRef">2.2.5.4. </a><a href="#name-authorization" class="section-name selfRef">Authorization</a>
            </h5>
<p id="section-2.2.5.4-1">The certificates provide authentication of the communication partners. Normally, they do not 
contain authorization information. Authorization decides, which PTP instances are allowed to join 
a group (in any of the group-based modes) or may enter a unicast communication in the ticket-based 
approach and request the respective SA(s) and key.<a href="#section-2.2.5.4-1" class="pilcrow">¶</a></p>
<p id="section-2.2.5.4-2">As mentioned, members of a group (multicast mode, mixed multicast/unicast mode) are identified 
by their domain and their sdoId. PTP domain and sdoId may be attributes in the certificates of 
the potential group members supplying additional authorization. If not contained in the 
certificates extra authorization means are necessary. (See also the discussion on advantages 
and disadvantages on certificates containing additional authorization data in <a href="#certificates" class="xref">Section 2.2.4</a>.)<a href="#section-2.2.5.4-2" class="pilcrow">¶</a></p>
<p id="section-2.2.5.4-3">If the special Group-of-2 mode is used, the optional subGroup parameter (i.e., the subgroup 
number) needs to be specified at all members of respective Go2s, upfront. To enable the NTS-KE 
server to supply the subgroup members with the particular security data their respective 
certificates may reflect permission to take part in the subgroup. Else another authorization 
method is to be used.<a href="#section-2.2.5.4-3" class="pilcrow">¶</a></p>
<p id="section-2.2.5.4-4">In native unicast mode, any authenticated grantor that is member of the group used for multicast 
may request a registration for unicast communication at the NTS-KE server. If it is intended for 
unicast, this must be configured locally. If no group authorization is available (e.g., pure 
unicast operation) another authentication scheme is necessary.<a href="#section-2.2.5.4-4" class="pilcrow">¶</a></p>
<p id="section-2.2.5.4-5">In the same way, any requester (if configured for it locally) may request security data for a 
unicast connection with a specific grantor. Only authentication at the NTS-KE server using its 
certificate and membership in the group used for multicast is needed. If a unicast communication 
is not desired by the grantor, it should not grant a specific unicast request. Again, if no 
group authorization is available (e.g., pure unicast operation) another authentication scheme 
is necessary.<a href="#section-2.2.5.4-5" class="pilcrow">¶</a></p>
<p id="section-2.2.5.4-6">Authorization can be executed at least in some manual configuration. Probably the application 
of a standard access control system like Diameter, RADIUS or similar would be more appropriate. 
Also role-based access control (RBAC), attribute-based access control (ABAC) or more flexible 
tools like Open Policy Agent (OPA) could help administering larger systems. But details of the 
authorization of PTP instances lies out of scope of this document.<a href="#section-2.2.5.4-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="upfront-tcs">
<section id="section-2.2.5.5">
            <h5 id="name-transparent-clocks">
<a href="#section-2.2.5.5" class="section-number selfRef">2.2.5.5. </a><a href="#name-transparent-clocks" class="section-name selfRef">Transparent Clocks</a>
            </h5>
<p id="section-2.2.5.5-1">Transparent Clocks (TC) need to be supplied with respective certificates, too. For group-based 
modes they must be configured for the particular PTP domain and sdoId and eventually for the 
specific subgroup(s) when using Group-of-2. They need to request for the relevant group key(s) 
at the NTS-KE server to allow secure use of the correctionfield in a PTP message and generation of 
a corrected ICV. If TCs are used in ticket-based unicast mode, they need to be authorized for 
the particular unicast path.<a href="#section-2.2.5.5-1" class="pilcrow">¶</a></p>
<p id="section-2.2.5.5-2">Authorization of TCs for the respective groups, subgroups and unicast connections is paramount. 
Otherwise the security can easily be broken with attackers pretending to be TCs in the path. 
Authorization of TCs is necessary too in unicast communication, even if the normal unicast 
partners need not be especially authorized.<a href="#section-2.2.5.5-2" class="pilcrow">¶</a></p>
<p id="section-2.2.5.5-3">Transparent clocks may notice that the communication runs secured. In the group-based 
approaches multicast mode and mixed multicast/unicast mode they construct the GroupID from domain 
and sdoId and request a group key from the NTS-KE server. Similarly, they can use the additional 
subgroup attribute in Go2 mode for a (group) key request. Afterwards they can check the ICV 
of incoming messages, fill in the correction field and generate a new ICV for outgoing messages. 
In ticket-based unicast mode a TC may notice a secured unicast request from a requester to the 
grantor and can request the unicast key from the NTS-KE server to make use of the correction field 
afterwards. As mentioned above upfront authentication and authorization of the particular TCs 
is paramount not to open the secured communication to attackers.<a href="#section-2.2.5.5-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="upfront-start-up">
<section id="section-2.2.5.6">
            <h5 id="name-start-up-considerations">
<a href="#section-2.2.5.6" class="section-number selfRef">2.2.5.6. </a><a href="#name-start-up-considerations" class="section-name selfRef">Start-up considerations</a>
            </h5>
<p id="section-2.2.5.6-1">At start-up of a single PTP instance or the complete PTP network some issues have to be considered.<a href="#section-2.2.5.6-1" class="pilcrow">¶</a></p>
<p id="section-2.2.5.6-2">At least loose time synchronization is necessary to allow for authentication using the certificates. 
See the discussion and proposals on this topic in IETF RFC 8915 <span>[<a href="#RFC8915" class="xref">RFC8915</a>]</span>, Section 8.5 "Initial Verification 
of Server certificates" which applies to client certificates in the PTP key management system, too.<a href="#section-2.2.5.6-2" class="pilcrow">¶</a></p>
<p id="section-2.2.5.6-3">Similarly, to a key re-request during an update period, key requests SHOULD be started at a random 
point in time after start-up to avoid peak load on the NTS-KE server. Every grantor must register 
with the NTS-KE server before requesters can request a unicast key (and ticket).<a href="#section-2.2.5.6-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="overview-nts-messages">
<section id="section-2.3">
        <h3 id="name-overview-of-nts-messages-an">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-overview-of-nts-messages-an" class="section-name selfRef">Overview of NTS Messages and their Structure for Use with PTP</a>
        </h3>
<p id="section-2.3-1"><a href="#key-distribution" class="xref">Section 2.1</a> described the principle communication sequences for PTP Key Request, 
PTP Registration Request and corresponding response messages. All messages follow the "NTS Key Establishment 
Process" stated in the first part (until the description of Figure 3 starts) of Section 4 of IETF RFC 8915 
<span>[<a href="#RFC8915" class="xref">RFC8915</a>]</span>:<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<ul class="compact ulEmpty">
<li class="compact ulEmpty" id="section-2.3-2.1">
            <p id="section-2.3-2.1.1"><em>"The NTS key establishment protocol is conducted via TCP port 4460.
        The two endpoints carry out a TLS handshake in conformance with
        Section 3, with the client offering (via an ALPN extension </em><span>[<a href="#RFC7301" class="xref">RFC7301</a>]</span>)<em>, 
 and the server accepting,
        an application-layer protocol of "ntske/1". Immediately
        following a successful handshake, the client SHALL send a single request
        as Application Data encapsulated in the TLS-protected channel. Then, the
        server SHALL send a single response. After sending their respective
        request and response, the client and server SHALL send TLS
        "close_notify" alerts in accordance with Section 6.1 of RFC 8446 </em><span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span>.<a href="#section-2.3-2.1.1" class="pilcrow">¶</a></p>
<p id="section-2.3-2.1.2"></p>
</li>
          <li class="compact ulEmpty" id="section-2.3-2.2">
            <p id="section-2.3-2.2.1"><em>The client's request and the server's response each SHALL consist of a
        sequence of records formatted according to</em>
              <a href="#fig-ntske-record" class="xref">Figure 6</a><em>. The request and a non-error response each
        SHALL include exactly one NTS Next Protocol Negotiation record. The
        sequence SHALL be terminated by a "End of Message" record. The
        requirement that all NTS-KE messages be terminated by an End of Message
        record makes them self-delimiting.</em><a href="#section-2.3-2.2.1" class="pilcrow">¶</a></p>
<p id="section-2.3-2.2.2"></p>
</li>
          <li class="compact ulEmpty" id="section-2.3-2.3">
            <p id="section-2.3-2.3.1"><em>Clients and servers MAY enforce length limits on requests and responses,
        however, servers MUST accept requests of at least 1024 octets and
        clients SHOULD accept responses of at least 65536 octets.</em><a href="#section-2.3-2.3.1" class="pilcrow">¶</a></p>
<p id="section-2.3-2.3.2"></p>
</li>
          <li class="compact ulEmpty" id="section-2.3-2.4">
            <p id="section-2.3-2.4.1"><em>The fields of an NTS-KE record are defined as follows:</em><a href="#section-2.3-2.4.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-2.3-2.4.2.1">
                <p id="section-2.3-2.4.2.1.1"><em>C (Critical Bit): Determines the disposition of unrecognized Record
            Types. Implementations which receive a record with an unrecognized
            Record Type MUST ignore the record if the Critical Bit is 0 and MUST
            treat it as an error if the Critical Bit is 1 (see Section 4.1.3).</em><a href="#section-2.3-2.4.2.1.1" class="pilcrow">¶</a></p>
<p id="section-2.3-2.4.2.1.2"></p>
</li>
              <li class="compact" id="section-2.3-2.4.2.2">
                <p id="section-2.3-2.4.2.2.1"><em>Record Type Number: A 15-bit integer in network byte order. The
            semantics of record types 0-7 are specified in this memo.
            Additional type numbers SHALL be tracked through the IANA Network
            Time Security Key Establishment Record Types registry.</em><a href="#section-2.3-2.4.2.2.1" class="pilcrow">¶</a></p>
<p id="section-2.3-2.4.2.2.2"></p>
</li>
              <li class="compact" id="section-2.3-2.4.2.3">
                <p id="section-2.3-2.4.2.3.1"><em>Body Length: The length of the Record Body field, in octets, as a
            16-bit integer in network byte order. Record bodies MAY have any
            representable length and need not be aligned to a word boundary.</em><a href="#section-2.3-2.4.2.3.1" class="pilcrow">¶</a></p>
<p id="section-2.3-2.4.2.3.2"></p>
</li>
              <li class="compact" id="section-2.3-2.4.2.4">
                <p id="section-2.3-2.4.2.4.1"><em>Record Body: The syntax and semantics of this field SHALL be
            determined by the Record Type.</em><a href="#section-2.3-2.4.2.4.1" class="pilcrow">¶</a></p>
<p id="section-2.3-2.4.2.4.2"></p>
</li>
            </ul>
</li>
          <li class="compact ulEmpty" id="section-2.3-2.5">
            <em>For clarity regarding bit-endianness: the Critical Bit is the
        most-significant bit of the first octet. In the C programming language,
        given a network buffer
        `unsigned char b[]` containing an NTS-KE record, the critical bit is
        `b[0] &gt;&gt; 7` while the record type is
        `((b[0] &amp; 0x7f) &lt;&lt; 8) + b[1]`."</em><a href="#section-2.3-2.5" class="pilcrow">¶</a>
</li>
        </ul>
<span id="name-nts-ke-record-format"></span><div id="fig-ntske-record">
<figure id="figure-6">
          <div class="alignLeft art-text artwork" id="section-2.3-3.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|C|         Record Type         |          Body Length          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
:                                                               :
:                           Record Body                         :
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-nts-ke-record-format" class="selfRef">NTS-KE record format</a>
          </figcaption></figure>
</div>
<p id="section-2.3-4">Thus, all NTS messages consist of a sequence of records, each containing a Critical Bit C, 
the Record Type, the Body Length and the Record Body, see <a href="#fig-ntske-record" class="xref">Figure 6</a>. 
More details on record structure as well as the specific records used here are given in 
<a href="#nts-messages-4-ptp" class="xref">Section 3</a> and respective subsections there. So-called container 
records (short: container) themselves comprise a set of records in the record body that 
serve a specific purpose, e.g., the Current Parameters container record.<a href="#section-2.3-4" class="pilcrow">¶</a></p>
<p id="section-2.3-5">The records contained in a message may follow in arbitrary sequence (though nothing 
speaks against using the sequence given in the record descriptions), only the End of 
Message record has to be the last one in the sequence indicating the end of the current 
message. Container records do not include an End of Message record.<a href="#section-2.3-5" class="pilcrow">¶</a></p>
<p id="section-2.3-6">The NTS key management for PTP is based on six new NTS messages:<a href="#section-2.3-6" class="pilcrow">¶</a></p>
<p id="section-2.3-7"></p>
<ul class="compact">
<li class="compact" id="section-2.3-8.1">PTP Key Request message (see <a href="#key-request" class="xref">Section 2.3.1</a>)<a href="#section-2.3-8.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-2.3-8.2">PTP Key Response message (see <a href="#key-response" class="xref">Section 2.3.2</a>)<a href="#section-2.3-8.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-2.3-8.3">PTP Registration Request message (see <a href="#registration-request" class="xref">Section 2.3.3</a>)<a href="#section-2.3-8.3" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-2.3-8.4">PTP Registration Response message (see <a href="#registration-response" class="xref">Section 2.3.4</a>)<a href="#section-2.3-8.4" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-2.3-8.5">PTP Registration Revoke message (see <a href="#registration-revoke" class="xref">Section 2.3.5</a>)<a href="#section-2.3-8.5" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-2.3-8.6">Heartbeat message (see <a href="#heartbeat" class="xref">Section 2.3.6</a>)<a href="#section-2.3-8.6" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-2.3-9">The following sections describe the principle structure of those new NTS messages for the PTP key 
management. More details especially on the records the messages are built of and their types, sizes, 
requirements and restrictions are given in <a href="#nts-records" class="xref">Section 3.2</a>.<a href="#section-2.3-9" class="pilcrow">¶</a></p>
<div id="key-request">
<section id="section-2.3.1">
          <h4 id="name-ptp-key-request-message">
<a href="#section-2.3.1" class="section-number selfRef">2.3.1. </a><a href="#name-ptp-key-request-message" class="section-name selfRef">PTP Key Request Message</a>
          </h4>
<span id="name-structure-of-a-ptp-key-requ"></span><div id="fig-key-request">
<figure id="figure-7">
            <div class="alignLeft art-text artwork" id="section-2.3.1-1.1">
<pre>
PTP Key Request (NTS-KE protocol)
+===================================+==========================+
| Record                            | Exemplary body contents  |
+===================================+==========================+
| NTS Next Protocol Negotiation     | PTPv2.1                  |
+-----------------------------------+--------------------------+
| Association Mode                  | {Assoc.Type||Assoc.Val.} |
+-----------------------------------+--------------------------+
| Supported MAC Algorithms (opt.)   | CMAC                     |
+-----------------------------------+--------------------------+
| Source PortIdentity (unicast only)| {binary data}            |
+-----------------------------------+--------------------------+
| End of Message                    |                          |
+===================================+==========================+

</pre>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-structure-of-a-ptp-key-requ" class="selfRef">Structure of a PTP Key Request message</a>
            </figcaption></figure>
</div>
<p id="section-2.3.1-2"><a href="#fig-key-request" class="xref">Figure 7</a> shows the record structure of a PTP Key Request message. 
In the right column typical values are shown as examples. Detailed information on types, sizes 
etc. is given in <a href="#nts-records" class="xref">Section 3.2</a>. The message starts with the NTS Next Protocol 
Negotiation record which in this application always holds PTPv2.1. The following Association 
Mode record describes the mode how the PTP instance wants to communicate: In the group-based 
approach the desired group number (plus eventually the subgroup attribute) is given. For 
ticket-based unicast communication the Association Mode contains the identification of the 
desired grantor, for example IPv4 and its IP address.<a href="#section-2.3.1-2" class="pilcrow">¶</a></p>
<p id="section-2.3.1-3">Only in TiBA, an optional record may follow. It offers the possibility to choose from 
additional MAC algorithms and presents the supported algorithms from which the NTS-KE server 
may choose. Again, only in ticket-based unicast mode, the Source PortIdentity record gives 
the data of the identification of the applying requester, for example IPv4 and its IP address. 
The messages always end with an End of Message record.<a href="#section-2.3.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="key-response">
<section id="section-2.3.2">
          <h4 id="name-ptp-key-response-message">
<a href="#section-2.3.2" class="section-number selfRef">2.3.2. </a><a href="#name-ptp-key-response-message" class="section-name selfRef">PTP Key Response Message</a>
          </h4>
<p id="section-2.3.2-1"><a href="#fig-key-response" class="xref">Figure 8</a> shows the record structure of a PTP Key Response message 
from the NTS-KE server (NTS-KE protocol). In the right column typical values are shown as examples. 
Detailed information on types, sizes etc. is given in <a href="#nts-records" class="xref">Section 3.2</a>. 
The message starts with the NTS Next Protocol Negotiation record which in this application always 
holds PTPv2.1.<a href="#section-2.3.2-1" class="pilcrow">¶</a></p>
<span id="name-structure-of-a-ptp-key-resp"></span><div id="fig-key-response">
<figure id="figure-8">
            <div class="alignLeft art-text artwork" id="section-2.3.2-2.1">
<pre>
PTP Key Response (NTS-KE protocol)
+==================================+===========================+
| Record                           | Exemplary body contents   |
+==================================+===========================+
| NTS Next Protocol Negotiation    | PTPv2.1                   |
+----------------------------------+---------------------------+
| Current Parameters               | set of Records {...}      |
+----------------------------------+---------------------------+
| Next Parameters                  | set of Records {...}      |
+----------------------------------+---------------------------+
| End of Message                   |                           |
+==================================+===========================+


PTP Key Response (NTS-KE protocol) - in case of an error
+==================================+===========================+
| Record                           | Exemplary body contents   |
+==================================+===========================+
| NTS Next Protocol Negotiation    | PTPv2.1                   |
+----------------------------------+---------------------------+
| Error                            | Not authorized            |
+----------------------------------+---------------------------+
| End of Message                   |                           |
+==================================+===========================+

</pre>
</div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a>:
<a href="#name-structure-of-a-ptp-key-resp" class="selfRef">Structure of a PTP Key Response message.</a>
            </figcaption></figure>
</div>
<p id="section-2.3.2-3">The following Current Parameters record is a container record containing in separate records 
all the security data needed to join and communicate in the secured PTP communication during the 
current validity period. <a href="#fig-current-container-key" class="xref">Figure 9</a> gives an example of data 
contained in that record. For more details on the records contained in the Current Parameters 
container record see <a href="#current-parameters-container" class="xref">Section 3.2.3</a>.<a href="#section-2.3.2-3" class="pilcrow">¶</a></p>
<span id="name-exemplary-contents-of-a-cur"></span><div id="fig-current-container-key">
<figure id="figure-9">
            <div class="alignLeft art-text artwork" id="section-2.3.2-4.1">
<pre>
Current Parameters container record (PTP Key Response)
+================================+==============================+
| Record                         | Exemplary body contents      |
+================================+========+=====================+
| Security Association           | data set {...}               |
+--------------------------------+------------------------------+
| Validity Period                | {1560s || 300s || 10s}       |
+--------------------------------+------------------------------+
| PTP Time Server (unicast only) | data set {...}               |
+--------------------------------+------------------------------+
| Ticket (unicast only)          | data set {...}               |
+================================+==============================+

</pre>
</div>
<figcaption><a href="#figure-9" class="selfRef">Figure 9</a>:
<a href="#name-exemplary-contents-of-a-cur" class="selfRef">Exemplary contents of a Current Parameters                                                         container record of a PTP Key Response message</a>
            </figcaption></figure>
</div>
<p id="section-2.3.2-5">If the request lies inside the update period, a Next Parameters container record is additionally
appended in the PTP Key Response message giving all the security data needed in the upcoming 
validity period. Its structure follows the same composition as the Current Parameters container
record. In case of an error, both parameters container records are removed and a single error record 
is inserted (see the lower part of <a href="#fig-key-response" class="xref">Figure 8</a>). The messages always end with an End of Message record.<a href="#section-2.3.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="registration-request">
<section id="section-2.3.3">
          <h4 id="name-ptp-registration-request-me">
<a href="#section-2.3.3" class="section-number selfRef">2.3.3. </a><a href="#name-ptp-registration-request-me" class="section-name selfRef">PTP Registration Request Message</a>
          </h4>
<span id="name-structure-of-a-ptp-registra"></span><div id="fig-registration-request">
<figure id="figure-10">
            <div class="alignLeft art-text artwork" id="section-2.3.3-1.1">
<pre>
PTP Registration Request  (NTS-TSR protocol)
+============================+=================================+
| Record                     | Exemplary body contents         |
+============================+=================================+
| NTS Message Type           | PTP Registration Request || v1.0|
+----------------------------+---------------------------------+
| PTP Time Server            | data set {...}                  |
+----------------------------+---------------------------------+
| AEAD Algorithm Negotiation | {AEAD_512 || AEAD_256}          |
+----------------------------+---------------------------------+
| Supported MAC Algorithms   | {CMAC || HMAC}                  |
+----------------------------+---------------------------------+
| End of Message             |                                 |
+============================+=================================+

</pre>
</div>
<figcaption><a href="#figure-10" class="selfRef">Figure 10</a>:
<a href="#name-structure-of-a-ptp-registra" class="selfRef">Structure of a PTP Registration Request message</a>
            </figcaption></figure>
</div>
<p id="section-2.3.3-2">The PTP Registration Request message (NTS-TSR protocol) starts with the NTS Message Type record 
containing the message type as well as the message version number, here always 1.0, see 
<a href="#fig-registration-request" class="xref">Figure 10</a>. (As the message belongs to the NTS-TSR protocol, no 
NTS Next Protocol Negotiation record is necessary.)<a href="#section-2.3.3-2" class="pilcrow">¶</a></p>
<p id="section-2.3.3-3">The PTP Time Server record presents all known network addresses of this grantor that are 
supported for a unicast connection. The following AEAD Algorithm Negotiation record indicates 
which algorithms for encryption of the ticket the grantor supports.<a href="#section-2.3.3-3" class="pilcrow">¶</a></p>
<p id="section-2.3.3-4">Then the next record (not optional as in PTP Key Request) follows, presenting all the grantor's 
supported MAC algorithms. The Supported MAC Algorithms record contains a list and comprises the MAC 
algorithms supported by the grantor that are feasible for calculating the ICV when securing the 
PTP messages in TiBA. The message always ends with an End of Message record.<a href="#section-2.3.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="registration-response">
<section id="section-2.3.4">
          <h4 id="name-ptp-registration-response-m">
<a href="#section-2.3.4" class="section-number selfRef">2.3.4. </a><a href="#name-ptp-registration-response-m" class="section-name selfRef">PTP Registration Response Message</a>
          </h4>
<span id="name-structure-of-a-ptp-registrat"></span><div id="fig-registration-response">
<figure id="figure-11">
            <div class="alignLeft art-text artwork" id="section-2.3.4-1.1">
<pre>
PTP Registration Response (NTS-TSR protocol)
+=========================+====================================+
| Record                  | Exemplary body contents            |
+=========================+====================================+
| NTS Message Type        | PTP Registration Response || v1.0  |
+-------------------------+------------------------------------+
| Current Parameters      | set of Records {...}               |
+-------------------------+------------------------------------+
| Next Parameters         | set of Records {...}               |
+-------------------------+------------------------------------+
| Heartbeat Timeout (opt.)| 900s                               |
+-------------------------+------------------------------------+
| End of Message          |                                    |
+=========================+====================================+


PTP Registration Response (NTS-TSR protocol)- in case of an error
+=========================+====================================+
| Record                  | Exemplary body contents            |
+=========================+====================================+
| NTS Message Type        | PTP Registration Response || v1.0  |
+-------------------------+------------------------------------+
| Error                   | Not authorized                     |
+-------------------------+------------------------------------+
| End of Message          |                                    |
+=========================+====================================+


</pre>
</div>
<figcaption><a href="#figure-11" class="selfRef">Figure 11</a>:
<a href="#name-structure-of-a-ptp-registrat" class="selfRef">Structure of a PTP Registration Response message</a>
            </figcaption></figure>
</div>
<p id="section-2.3.4-2">The PTP Registration Response message (NTS-TSR protocol) from the NTS-KE server starts 
with the NTS Message Type record containing the message type as well as the message version 
number, here always 1.0, see <a href="#fig-registration-response" class="xref">Figure 11</a>. (As the message 
belongs to the NTS-TSR protocol, no NTS Next Protocol Negotiation record is necessary.)<a href="#section-2.3.4-2" class="pilcrow">¶</a></p>
<p id="section-2.3.4-3">As in the NTS-KE protocol, the following Current Parameters record is a container record 
containing in separate records all the necessary parameters for the current validity period. 
<a href="#fig-current-container-registration" class="xref">Figure 12</a> gives an example of data contained in 
that record. For more details on the records contained in the Current Parameters container  
record see <a href="#current-parameters-container" class="xref">Section 3.2.3</a>.<a href="#section-2.3.4-3" class="pilcrow">¶</a></p>
<span id="name-exemplary-contents-of-a-curr"></span><div id="fig-current-container-registration">
<figure id="figure-12">
            <div class="alignLeft art-text artwork" id="section-2.3.4-4.1">
<pre>
Current Parameters container record (PTP Registration Response)
+===============================+==============================+
| Record                        | Exemplary body contents      |
+===============================+==============================+
| AEAD Algorithm Negotiation    | AEAD_AES_SIV_CMAC_512        |
+-------------------------------+------------------------------+
| Validity Period               | {2460s || 400s || 10s}       |
+-------------------------------+------------------------------+
| Ticket Key ID                 | 278                          |
+-------------------------------+------------------------------+
| Ticket Key                    | {binary data}                |
+===============================+==============================+

</pre>
</div>
<figcaption><a href="#figure-12" class="selfRef">Figure 12</a>:
<a href="#name-exemplary-contents-of-a-curr" class="selfRef">Exemplary contents of a Current                                                           Parameters container record of a                 PTP Registration Response message                in the NTS-TSR protocol</a>
            </figcaption></figure>
</div>
<p id="section-2.3.4-5">If the registration request lies inside the update period a Next Parameters container 
record is additionally appended giving all the security data needed in the upcoming validity period. Its 
structure follows the same composition as the Current Parameters container record. The 
messages always end with an End of Message record.<a href="#section-2.3.4-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="registration-revoke">
<section id="section-2.3.5">
          <h4 id="name-ptp-registration-revoke-mes">
<a href="#section-2.3.5" class="section-number selfRef">2.3.5. </a><a href="#name-ptp-registration-revoke-mes" class="section-name selfRef">PTP Registration Revoke Message</a>
          </h4>
<span id="name-structure-of-a-ptp-registrati"></span><div id="fig-registration-revoke">
<figure id="figure-13">
            <div class="alignLeft art-text artwork" id="section-2.3.5-1.1">
<pre>
PTP Registration Revoke (NTS-TSR protocol)
+================================+=============================+
| Record                         | Exemplary body contents     |
+================================+=============================+
| NTS Message Type               | PTP Registr. Revoke || v1.0 |
+--------------------------------+-----------------------------+
| Source PortIdentity            | {binary data}               |
+--------------------------------+-----------------------------+
| End of Message                 |                             |
+================================+=============================+

</pre>
</div>
<figcaption><a href="#figure-13" class="selfRef">Figure 13</a>:
<a href="#name-structure-of-a-ptp-registrati" class="selfRef">Structure of a PTP Registration Revoke message</a>
            </figcaption></figure>
</div>
<p id="section-2.3.5-2">The PTP Registration Revoke message (NTS-TSR protocol) from the grantor starts with 
the NTS Message Type record containing the message type as well as the message version 
number, here always 1.0, see <a href="#fig-registration-revoke" class="xref">Figure 13</a>. (As the message 
belongs to the NTS-TSR protocol, no NTS Next Protocol Negotiation record is necessary.)<a href="#section-2.3.5-2" class="pilcrow">¶</a></p>
<p id="section-2.3.5-3">The second record contains the Source PortIdentity which identifies the grantor 
   wanting to stop its unicast support. This allows the NTS-KE server to uniquely identify 
   the grantor if the PTP device communicates with the NTS-KE server via a management port 
   running multiple grantors. The message always ends with an End of Message record.<a href="#section-2.3.5-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="heartbeat">
<section id="section-2.3.6">
          <h4 id="name-heartbeat-message">
<a href="#section-2.3.6" class="section-number selfRef">2.3.6. </a><a href="#name-heartbeat-message" class="section-name selfRef">Heartbeat Message</a>
          </h4>
<span id="name-structure-of-a-heartbeat-me"></span><div id="fig-heartbeat">
<figure id="figure-14">
            <div class="alignLeft art-text artwork" id="section-2.3.6-1.1">
<pre>
Heartbeat (NTS-TSR protocol)
+================================+=============================+
| Record                         | Exemplary body contents     |
+================================+=============================+
| NTS Message Type               | Heartbeat || v1.0           |
+--------------------------------+-----------------------------+
| Status (optional)              | server load: low            |
+--------------------------------+-----------------------------+
| End of Message                 |                             |
+================================+=============================+

</pre>
</div>
<figcaption><a href="#figure-14" class="selfRef">Figure 14</a>:
<a href="#name-structure-of-a-heartbeat-me" class="selfRef">Structure of a Heartbeat message in the NTS-TSR protocol</a>
            </figcaption></figure>
</div>
<p id="section-2.3.6-2">The Heartbeat message (NTS-TSR protocol) from the grantor to the NTS-KE server starts 
with the NTS Message Type record containing the message type as well as the message version 
number, here always 1.0, see <a href="#fig-heartbeat" class="xref">Figure 14</a>. (As the message belongs to the 
NTS-TSR protocol, no NTS Next Protocol Negotiation record is necessary.)<a href="#section-2.3.6-2" class="pilcrow">¶</a></p>
<p id="section-2.3.6-3">The second record contains the optional Status record which allows the grantor to present 
various status updates to the NTS-KE server. The message always ends with an End of Message record.<a href="#section-2.3.6-3" class="pilcrow">¶</a></p>
<p id="section-2.3.6-4">Heartbeat messages provide grantors with the ability to send messages to the NTS-KE server 
at regular intervals to signal their own functionality. These messages can optionally also 
contain one or multiple status records (see <a href="#fig-heartbeat" class="xref">Figure 14</a>), for example to 
improve load balancing between the registered time servers or to provide additional monitoring. 
The NTS-KE server MUST accept Heartbeat messages from a grantor if they have been previously 
requested by the NTS-KE server in the Registration Response message. However, the NTS-KE server 
MAY discard heartbeat messages if they arrive more frequently than specified by the heartbeat 
timeout (see <a href="#heartbeat" class="xref">Section 2.3.6</a>). If the NTS-KE server receives heartbeat messages from a 
grantor even though it is not requested, the NTS-KE server SHOULD discard these messages 
and not process them further. Processing of the status information is optional and the status 
records MAY be ignored by the NTS-KE server. If the Grantor sends heartbeat messages to the 
NTS-KE server, the frames SHOULD NOT exceed the maximum transmission unit (MTU, 1500 octets 
for Ethernet).<a href="#section-2.3.6-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="nts-messages-4-ptp">
<section id="section-3">
      <h2 id="name-nts-messages-for-ptp">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-nts-messages-for-ptp" class="section-name selfRef">NTS Messages for PTP</a>
      </h2>
<p id="section-3-1">This section covers the structure of the NTS messages and the details of the respective 
payload. The individual parameters are transmitted by NTS records, which are described in 
more detail in <a href="#nts-records" class="xref">Section 3.2</a>. In addition to the NTS records defined for 
NTP in IETF RFC8915, further records are required, which are listed in 
<a href="#tbl_nts_ke_record_registry" class="xref">Table 1</a> below and begin with Record Type 1024 (compare IETF RFC 8915 
<span>[<a href="#RFC8915" class="xref">RFC8915</a>]</span>, Section 7.6.  Network Time Security Key Establishment Record Types Registry).<a href="#section-3-1" class="pilcrow">¶</a></p>
<span id="name-nts-key-establishment-and-t"></span><div id="tbl_nts_ke_record_registry">
<table class="center" id="table-1">
        <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-nts-key-establishment-and-t" class="selfRef">NTS Key Establishment and Time Server Registration record types registry</a>
        </caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">NTS Record Types</th>
            <th class="text-left" rowspan="1" colspan="1">Description</th>
            <th class="text-left" rowspan="1" colspan="1">Record Used in Protocol</th>
            <th class="text-left" rowspan="1" colspan="1">Reference</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">0</td>
            <td class="text-left" rowspan="1" colspan="1">End of Message</td>
            <td class="text-left" rowspan="1" colspan="1">NTS-KE/NTS-TSR</td>
            <td class="text-left" rowspan="1" colspan="1">
              <span>[<a href="#RFC8915" class="xref">RFC8915</a>]</span>, Section 4.1.1; this document, <a href="#end-of-message" class="xref">Section 3.2.4</a> </td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">1</td>
            <td class="text-left" rowspan="1" colspan="1">NTS Next Protocol Negotiation</td>
            <td class="text-left" rowspan="1" colspan="1">NTS-KE</td>
            <td class="text-left" rowspan="1" colspan="1">
              <span>[<a href="#RFC8915" class="xref">RFC8915</a>]</span>, Section 4.1.2; this document, <a href="#nts-next-protocol-nego" class="xref">Section 3.2.8</a> </td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">2</td>
            <td class="text-left" rowspan="1" colspan="1">Error</td>
            <td class="text-left" rowspan="1" colspan="1">NTS-KE/NTS-TSR</td>
            <td class="text-left" rowspan="1" colspan="1">
              <span>[<a href="#RFC8915" class="xref">RFC8915</a>]</span>, Section 4.1.3; this document, <a href="#error" class="xref">Section 3.2.5</a> </td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">3</td>
            <td class="text-left" rowspan="1" colspan="1">Warning</td>
            <td class="text-left" rowspan="1" colspan="1">NTS-KE</td>
            <td class="text-left" rowspan="1" colspan="1">
              <span>[<a href="#RFC8915" class="xref">RFC8915</a>]</span>, Section 4.1.4; not used for PTP</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">4</td>
            <td class="text-left" rowspan="1" colspan="1">AEAD Algorithm Negotiation</td>
            <td class="text-left" rowspan="1" colspan="1">NTS-TSR</td>
            <td class="text-left" rowspan="1" colspan="1">
              <span>[<a href="#RFC8915" class="xref">RFC8915</a>]</span>, Section 4.1.5; this document, <a href="#aead-negotiation" class="xref">Section 3.2.1</a> </td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">5</td>
            <td class="text-left" rowspan="1" colspan="1">New Cookie for NTPv4</td>
            <td class="text-left" rowspan="1" colspan="1">NTS-KE</td>
            <td class="text-left" rowspan="1" colspan="1">
              <span>[<a href="#RFC8915" class="xref">RFC8915</a>]</span>, Section 4.1.6; not used for PTP</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">6</td>
            <td class="text-left" rowspan="1" colspan="1">NTPv4 Server Negotiation</td>
            <td class="text-left" rowspan="1" colspan="1">NTS-KE</td>
            <td class="text-left" rowspan="1" colspan="1">
              <span>[<a href="#RFC8915" class="xref">RFC8915</a>]</span>, Section 4.1.7; not used for PTP</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">7</td>
            <td class="text-left" rowspan="1" colspan="1">NTPv4 Port Negotiation</td>
            <td class="text-left" rowspan="1" colspan="1">NTS-KE</td>
            <td class="text-left" rowspan="1" colspan="1">
              <span>[<a href="#RFC8915" class="xref">RFC8915</a>]</span>, Section 4.1.8; not used for PTP</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">8 - 1023</td>
            <td class="text-left" rowspan="1" colspan="1">Reserved for NTP</td>
            <td class="text-left" rowspan="1" colspan="1"></td>
            <td class="text-left" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1"></td>
            <td class="text-left" rowspan="1" colspan="1"></td>
            <td class="text-left" rowspan="1" colspan="1"></td>
            <td class="text-left" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">1024</td>
            <td class="text-left" rowspan="1" colspan="1">Association Mode</td>
            <td class="text-left" rowspan="1" colspan="1">NTS-KE</td>
            <td class="text-left" rowspan="1" colspan="1">This document, <a href="#association-mode" class="xref">Section 3.2.2</a> </td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">1025</td>
            <td class="text-left" rowspan="1" colspan="1">Current Parameters</td>
            <td class="text-left" rowspan="1" colspan="1">NTS-KE/NTS-TSR</td>
            <td class="text-left" rowspan="1" colspan="1">This document, <a href="#current-parameters-container" class="xref">Section 3.2.3</a> </td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">1026</td>
            <td class="text-left" rowspan="1" colspan="1">Heartbeat Timeout</td>
            <td class="text-left" rowspan="1" colspan="1">NTS-TSR</td>
            <td class="text-left" rowspan="1" colspan="1">This document, <a href="#heartbeat-timeout" class="xref">Section 3.2.6</a> </td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">1027</td>
            <td class="text-left" rowspan="1" colspan="1">Next Parameters Container</td>
            <td class="text-left" rowspan="1" colspan="1">NTS-KE/NTS-TSR</td>
            <td class="text-left" rowspan="1" colspan="1">This document, <a href="#next-parameters-container" class="xref">Section 3.2.7</a> </td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">1028</td>
            <td class="text-left" rowspan="1" colspan="1">NTS Message Type</td>
            <td class="text-left" rowspan="1" colspan="1">NTS-TSR</td>
            <td class="text-left" rowspan="1" colspan="1">This document, <a href="#nts-message-type" class="xref">Section 3.2.9</a> </td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">1029</td>
            <td class="text-left" rowspan="1" colspan="1">PTP Time Server</td>
            <td class="text-left" rowspan="1" colspan="1">NTS-KE/NTS-TSR</td>
            <td class="text-left" rowspan="1" colspan="1">This document, <a href="#ptp-time-server" class="xref">Section 3.2.10</a> </td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">1030</td>
            <td class="text-left" rowspan="1" colspan="1">Security Association</td>
            <td class="text-left" rowspan="1" colspan="1">NTS-KE</td>
            <td class="text-left" rowspan="1" colspan="1">This document, <a href="#security-association" class="xref">Section 3.2.11</a> </td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">1031</td>
            <td class="text-left" rowspan="1" colspan="1">Source PortIdentity</td>
            <td class="text-left" rowspan="1" colspan="1">NTS-KE/NTS-TSR</td>
            <td class="text-left" rowspan="1" colspan="1">This document, <a href="#source-portidentity" class="xref">Section 3.2.12</a>   </td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">1032</td>
            <td class="text-left" rowspan="1" colspan="1">Status</td>
            <td class="text-left" rowspan="1" colspan="1">NTS-TSR</td>
            <td class="text-left" rowspan="1" colspan="1">This document, <a href="#status" class="xref">Section 3.2.13</a> </td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">1033</td>
            <td class="text-left" rowspan="1" colspan="1">Supported MAC Algorithms</td>
            <td class="text-left" rowspan="1" colspan="1">NTS-KE/NTS-TSR</td>
            <td class="text-left" rowspan="1" colspan="1">This document, <a href="#supported-mac-algos" class="xref">Section 3.2.14</a> </td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">1034</td>
            <td class="text-left" rowspan="1" colspan="1">Ticket</td>
            <td class="text-left" rowspan="1" colspan="1">NTS-TSR</td>
            <td class="text-left" rowspan="1" colspan="1">This document, <a href="#ticket" class="xref">Section 3.2.15</a> </td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">1035</td>
            <td class="text-left" rowspan="1" colspan="1">Ticket Key</td>
            <td class="text-left" rowspan="1" colspan="1">NTS-TSR</td>
            <td class="text-left" rowspan="1" colspan="1">This document, <a href="#ticket-key" class="xref">Section 3.2.16</a> </td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">1036</td>
            <td class="text-left" rowspan="1" colspan="1">Ticket Key ID</td>
            <td class="text-left" rowspan="1" colspan="1">NTS-TSR</td>
            <td class="text-left" rowspan="1" colspan="1">This document, <a href="#ticket-key-id" class="xref">Section 3.2.17</a> </td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">1037</td>
            <td class="text-left" rowspan="1" colspan="1">Validity Period</td>
            <td class="text-left" rowspan="1" colspan="1">NTS-KE/NTS-TSR</td>
            <td class="text-left" rowspan="1" colspan="1">This document, <a href="#validity-period" class="xref">Section 3.2.18</a> </td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">1038 - 16383</td>
            <td class="text-left" rowspan="1" colspan="1">Unassigned</td>
            <td class="text-left" rowspan="1" colspan="1"></td>
            <td class="text-left" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1"></td>
            <td class="text-left" rowspan="1" colspan="1"></td>
            <td class="text-left" rowspan="1" colspan="1"></td>
            <td class="text-left" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">16384 - 32767</td>
            <td class="text-left" rowspan="1" colspan="1">Reserved for Private or Experimental Use</td>
            <td class="text-left" rowspan="1" colspan="1"></td>
            <td class="text-left" rowspan="1" colspan="1">
              <span>[<a href="#RFC8915" class="xref">RFC8915</a>]</span> </td>
          </tr>
        </tbody>
      </table>
</div>
<div id="nts-message-types">
<section id="section-3.1">
        <h3 id="name-nts-message-types">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-nts-message-types" class="section-name selfRef">NTS Message Types</a>
        </h3>
<p id="section-3.1-1">This section repeats the composition of the specific NTS messages for the PTP key 
management in overview form. The specification of the respective records from which the 
messages are constructed follows in <a href="#nts-records" class="xref">Section 3.2</a>. The reference column 
in the tables refer to the specific subsections.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">The NTS messages MUST contain the records given for the particular message though not 
necessarily in the same sequence indicated. Only the End of Message record MUST be 
the final record.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<p id="section-3.1-3" class="keepWithNext"><strong>PTP Key Request  (NTS-KE protocol)</strong><a href="#section-3.1-3" class="pilcrow">¶</a></p>
<span id="name-record-structure-of-the-ptp"></span><div id="tbl_ptp_key_request">
<table class="center" id="table-2">
          <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-record-structure-of-the-ptp" class="selfRef">Record structure of the PTP Key Request message</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">NTS Record Name</th>
              <th class="text-left" rowspan="1" colspan="1">Mode*</th>
              <th class="text-center" rowspan="1" colspan="1">Use</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">NTS Next Protocol Negotiation</td>
              <td class="text-left" rowspan="1" colspan="1">GrBA / TiBA</td>
              <td class="text-center" rowspan="1" colspan="1">mandatory</td>
              <td class="text-left" rowspan="1" colspan="1">This document, <a href="#nts-next-protocol-nego" class="xref">Section 3.2.8</a> </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Association Mode</td>
              <td class="text-left" rowspan="1" colspan="1">GrBA / TiBA</td>
              <td class="text-center" rowspan="1" colspan="1">mandatory</td>
              <td class="text-left" rowspan="1" colspan="1">This document, <a href="#association-mode" class="xref">Section 3.2.2</a> </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Supported MAC Algorithms</td>
              <td class="text-left" rowspan="1" colspan="1">TiBA</td>
              <td class="text-center" rowspan="1" colspan="1">optional</td>
              <td class="text-left" rowspan="1" colspan="1">This document, <a href="#supported-mac-algos" class="xref">Section 3.2.14</a> </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Source PortIdentity</td>
              <td class="text-left" rowspan="1" colspan="1">TiBA</td>
              <td class="text-center" rowspan="1" colspan="1">mandatory</td>
              <td class="text-left" rowspan="1" colspan="1">This document, <a href="#source-portidentity" class="xref">Section 3.2.12</a> </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">End of Message</td>
              <td class="text-left" rowspan="1" colspan="1">GrBA / TiBA</td>
              <td class="text-center" rowspan="1" colspan="1">mandatory</td>
              <td class="text-left" rowspan="1" colspan="1">This document, <a href="#end-of-message" class="xref">Section 3.2.4</a> </td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-3.1-5" class="keepWithPrevious">* The Mode column refers to the intended use of the particular record for the respective PTP communication mode.<a href="#section-3.1-5" class="pilcrow">¶</a></p>
<p id="section-3.1-6" class="keepWithNext"><strong>PTP Key Response (NTS-KE protocol)</strong><a href="#section-3.1-6" class="pilcrow">¶</a></p>
<span id="name-record-structure-of-the-ptp-"></span><div id="tbl_ptp_key_response">
<table class="center" id="table-3">
          <caption>
<a href="#table-3" class="selfRef">Table 3</a>:
<a href="#name-record-structure-of-the-ptp-" class="selfRef">Record structure of the PTP Key Response message.                                                  In case of an error, both parameters container records              are removed and a single error record is inserted.</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">NTS Record Name</th>
              <th class="text-left" rowspan="1" colspan="1">Mode</th>
              <th class="text-center" rowspan="1" colspan="1">Use</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">NTS Next Protocol Negotiation</td>
              <td class="text-left" rowspan="1" colspan="1">GrBA / TiBA</td>
              <td class="text-center" rowspan="1" colspan="1">mandatory</td>
              <td class="text-left" rowspan="1" colspan="1">This document, <a href="#nts-next-protocol-nego" class="xref">Section 3.2.8</a> </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Current Parameters</td>
              <td class="text-left" rowspan="1" colspan="1">GrBA / TiBA</td>
              <td class="text-center" rowspan="1" colspan="1">mandatory</td>
              <td class="text-left" rowspan="1" colspan="1">This document, <a href="#current-parameters-container" class="xref">Section 3.2.3</a> </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Next Parameters Container</td>
              <td class="text-left" rowspan="1" colspan="1">GrBA / TiBA</td>
              <td class="text-center" rowspan="1" colspan="1">mandatory (only during update period)</td>
              <td class="text-left" rowspan="1" colspan="1">This document, <a href="#next-parameters-container" class="xref">Section 3.2.7</a> </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">End of Message</td>
              <td class="text-left" rowspan="1" colspan="1">GrBA / TiBA</td>
              <td class="text-center" rowspan="1" colspan="1">mandatory</td>
              <td class="text-left" rowspan="1" colspan="1">This document, <a href="#end-of-message" class="xref">Section 3.2.4</a> </td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-3.1-8">The structure of the respective container records (Current Parameters and Next 
   Parameters) used in the PTP Key Response message is given below:<a href="#section-3.1-8" class="pilcrow">¶</a></p>
<p id="section-3.1-9" class="keepWithNext"><strong>Current/Next Parameters container - PTP Key Response (NTS-KE protocol)</strong><a href="#section-3.1-9" class="pilcrow">¶</a></p>
<span id="name-record-structure-of-the-con"></span><div id="tbl_container">
<table class="center" id="table-4">
          <caption>
<a href="#table-4" class="selfRef">Table 4</a>:
<a href="#name-record-structure-of-the-con" class="selfRef">Record structure of the container records</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">NTS Record Name</th>
              <th class="text-left" rowspan="1" colspan="1">Mode</th>
              <th class="text-center" rowspan="1" colspan="1">Use</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Security Association</td>
              <td class="text-left" rowspan="1" colspan="1">GrBA / TiBA</td>
              <td class="text-center" rowspan="1" colspan="1">mandatory</td>
              <td class="text-left" rowspan="1" colspan="1">This document, <a href="#security-association" class="xref">Section 3.2.11</a> </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Validity Period</td>
              <td class="text-left" rowspan="1" colspan="1">GrBA / TiBA</td>
              <td class="text-center" rowspan="1" colspan="1">mandatory</td>
              <td class="text-left" rowspan="1" colspan="1">This document, <a href="#validity-period" class="xref">Section 3.2.18</a> </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">PTP Time Server</td>
              <td class="text-left" rowspan="1" colspan="1">TiBA</td>
              <td class="text-center" rowspan="1" colspan="1">mandatory</td>
              <td class="text-left" rowspan="1" colspan="1">This document, <a href="#ptp-time-server" class="xref">Section 3.2.10</a> </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Ticket</td>
              <td class="text-left" rowspan="1" colspan="1">TiBA</td>
              <td class="text-center" rowspan="1" colspan="1">mandatory</td>
              <td class="text-left" rowspan="1" colspan="1">This document, <a href="#ticket" class="xref">Section 3.2.15</a> </td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-3.1-11" class="keepWithNext"><strong>PTP Registration Request (NTS-TSR protocol)</strong><a href="#section-3.1-11" class="pilcrow">¶</a></p>
<span id="name-record-structure-of-the-ptp-r"></span><div id="tbl_ptp_registration_request">
<table class="center" id="table-5">
          <caption>
<a href="#table-5" class="selfRef">Table 5</a>:
<a href="#name-record-structure-of-the-ptp-r" class="selfRef">Record structure of the PTP Registration Request message</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">NTS Record Name</th>
              <th class="text-left" rowspan="1" colspan="1">Mode</th>
              <th class="text-center" rowspan="1" colspan="1">Use</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">NTS Message Type</td>
              <td class="text-left" rowspan="1" colspan="1">TiBA</td>
              <td class="text-center" rowspan="1" colspan="1">mandatory</td>
              <td class="text-left" rowspan="1" colspan="1">This document, <a href="#nts-message-type" class="xref">Section 3.2.9</a> </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">PTP Time Server</td>
              <td class="text-left" rowspan="1" colspan="1">TiBA</td>
              <td class="text-center" rowspan="1" colspan="1">mandatory</td>
              <td class="text-left" rowspan="1" colspan="1">This document, <a href="#ptp-time-server" class="xref">Section 3.2.10</a> </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">AEAD Algorithm Negotiation</td>
              <td class="text-left" rowspan="1" colspan="1">TiBA</td>
              <td class="text-center" rowspan="1" colspan="1">mandatory</td>
              <td class="text-left" rowspan="1" colspan="1">This document, <a href="#aead-negotiation" class="xref">Section 3.2.1</a> </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Supported MAC Algorithms</td>
              <td class="text-left" rowspan="1" colspan="1">TiBA</td>
              <td class="text-center" rowspan="1" colspan="1">mandatory</td>
              <td class="text-left" rowspan="1" colspan="1">This document, <a href="#supported-mac-algos" class="xref">Section 3.2.14</a> </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">End of Message</td>
              <td class="text-left" rowspan="1" colspan="1">TiBA</td>
              <td class="text-center" rowspan="1" colspan="1">mandatory</td>
              <td class="text-left" rowspan="1" colspan="1">This document, <a href="#end-of-message" class="xref">Section 3.2.4</a> </td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-3.1-13" class="keepWithNext"><strong>PTP Registration Response (NTS-TSR protocol)</strong><a href="#section-3.1-13" class="pilcrow">¶</a></p>
<span id="name-record-structure-of-the-ptp-re"></span><div id="tbl_ptp_registration_response">
<table class="center" id="table-6">
          <caption>
<a href="#table-6" class="selfRef">Table 6</a>:
<a href="#name-record-structure-of-the-ptp-re" class="selfRef">Record structure of the PTP Registration Response message.                                                           In case of an error, both parameters container records                       are removed and a single error record is inserted.</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">NTS Record Name</th>
              <th class="text-left" rowspan="1" colspan="1">Mode</th>
              <th class="text-center" rowspan="1" colspan="1">Use</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">NTS Message Type</td>
              <td class="text-left" rowspan="1" colspan="1">TiBA</td>
              <td class="text-center" rowspan="1" colspan="1">mandatory</td>
              <td class="text-left" rowspan="1" colspan="1">This document, <a href="#nts-message-type" class="xref">Section 3.2.9</a> </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Current Parameters</td>
              <td class="text-left" rowspan="1" colspan="1">TiBA</td>
              <td class="text-center" rowspan="1" colspan="1">mandatory</td>
              <td class="text-left" rowspan="1" colspan="1">This document, <a href="#current-parameters-container" class="xref">Section 3.2.3</a> </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Next Parameters</td>
              <td class="text-left" rowspan="1" colspan="1">TiBA</td>
              <td class="text-center" rowspan="1" colspan="1">mandatory (only during update period)</td>
              <td class="text-left" rowspan="1" colspan="1">This document, <a href="#next-parameters-container" class="xref">Section 3.2.7</a> </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Heartbeat Timeout</td>
              <td class="text-left" rowspan="1" colspan="1">TiBA</td>
              <td class="text-center" rowspan="1" colspan="1">optional</td>
              <td class="text-left" rowspan="1" colspan="1">This document, <a href="#heartbeat-timeout" class="xref">Section 3.2.6</a> </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">End of Message</td>
              <td class="text-left" rowspan="1" colspan="1">TiBA</td>
              <td class="text-center" rowspan="1" colspan="1">mandatory</td>
              <td class="text-left" rowspan="1" colspan="1">This document, <a href="#end-of-message" class="xref">Section 3.2.4</a> </td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-3.1-15">The structure of the respective container records (Current Parameters and Next Parameters 
   ) used in the PTP Registration Response message is given below:<a href="#section-3.1-15" class="pilcrow">¶</a></p>
<p id="section-3.1-16" class="keepWithNext"><strong>Current/Next Parameters container - PTP Registration Response (NTS-TSR protocol)</strong><a href="#section-3.1-16" class="pilcrow">¶</a></p>
<span id="name-record-structure-of-the-cont"></span><div id="tbl_container_in_response">
<table class="center" id="table-7">
          <caption>
<a href="#table-7" class="selfRef">Table 7</a>:
<a href="#name-record-structure-of-the-cont" class="selfRef">Record structure of the container records in the PTP Registration Response message</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">NTS Record Name</th>
              <th class="text-left" rowspan="1" colspan="1">Mode</th>
              <th class="text-center" rowspan="1" colspan="1">Use</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">AEAD Algorithm Negotiation</td>
              <td class="text-left" rowspan="1" colspan="1">TiBA</td>
              <td class="text-center" rowspan="1" colspan="1">mandatory</td>
              <td class="text-left" rowspan="1" colspan="1">This document, <a href="#aead-negotiation" class="xref">Section 3.2.1</a> </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Validity Period</td>
              <td class="text-left" rowspan="1" colspan="1">TiBA</td>
              <td class="text-center" rowspan="1" colspan="1">mandatory</td>
              <td class="text-left" rowspan="1" colspan="1">This document, <a href="#validity-period" class="xref">Section 3.2.18</a> </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Ticket Key ID</td>
              <td class="text-left" rowspan="1" colspan="1">TiBA</td>
              <td class="text-center" rowspan="1" colspan="1">mandatory</td>
              <td class="text-left" rowspan="1" colspan="1">This document, <a href="#ticket-key-id" class="xref">Section 3.2.17</a> </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Ticket Key</td>
              <td class="text-left" rowspan="1" colspan="1">TiBA</td>
              <td class="text-center" rowspan="1" colspan="1">mandatory</td>
              <td class="text-left" rowspan="1" colspan="1">This document, <a href="#ticket-key" class="xref">Section 3.2.16</a> </td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-3.1-18" class="keepWithNext"><strong>PTP Registration Revoke (NTS-TSR protocol)</strong><a href="#section-3.1-18" class="pilcrow">¶</a></p>
<span id="name-record-structure-of-the-ptp-reg"></span><div id="tbl_ptp_registration_revoke">
<table class="center" id="table-8">
          <caption>
<a href="#table-8" class="selfRef">Table 8</a>:
<a href="#name-record-structure-of-the-ptp-reg" class="selfRef">Record structure of the PTP Registration Revoke message</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">NTS Record Name</th>
              <th class="text-left" rowspan="1" colspan="1">Mode</th>
              <th class="text-center" rowspan="1" colspan="1">Use</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">NTS Message Type</td>
              <td class="text-left" rowspan="1" colspan="1">TiBA</td>
              <td class="text-center" rowspan="1" colspan="1">mandatory</td>
              <td class="text-left" rowspan="1" colspan="1">This document, <a href="#nts-message-type" class="xref">Section 3.2.9</a> </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Source PortIdentity</td>
              <td class="text-left" rowspan="1" colspan="1">TiBA</td>
              <td class="text-center" rowspan="1" colspan="1">mandatory</td>
              <td class="text-left" rowspan="1" colspan="1">This document, <a href="#source-portidentity" class="xref">Section 3.2.12</a> </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">End of Message</td>
              <td class="text-left" rowspan="1" colspan="1">TiBA</td>
              <td class="text-center" rowspan="1" colspan="1">mandatory</td>
              <td class="text-left" rowspan="1" colspan="1">This document, <a href="#end-of-message" class="xref">Section 3.2.4</a> </td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-3.1-20" class="keepWithNext"><strong>Heartbeat Message (NTS-TSR protocol)</strong><a href="#section-3.1-20" class="pilcrow">¶</a></p>
<span id="name-record-structure-of-the-hea"></span><div id="tbl_heartbeat">
<table class="center" id="table-9">
          <caption>
<a href="#table-9" class="selfRef">Table 9</a>:
<a href="#name-record-structure-of-the-hea" class="selfRef">Record structure of the Heartbeat message in the NTS-TSR protocol</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">NTS Record Name</th>
              <th class="text-left" rowspan="1" colspan="1">Mode</th>
              <th class="text-center" rowspan="1" colspan="1">Use</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">NTS Message Type</td>
              <td class="text-left" rowspan="1" colspan="1">TiBA</td>
              <td class="text-center" rowspan="1" colspan="1">mandatory</td>
              <td class="text-left" rowspan="1" colspan="1">This document, <a href="#nts-message-type" class="xref">Section 3.2.9</a> </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Status</td>
              <td class="text-left" rowspan="1" colspan="1">TiBA</td>
              <td class="text-center" rowspan="1" colspan="1">optional</td>
              <td class="text-left" rowspan="1" colspan="1">This document, <a href="#status" class="xref">Section 3.2.13</a> </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">End of Message</td>
              <td class="text-left" rowspan="1" colspan="1">TiBA</td>
              <td class="text-center" rowspan="1" colspan="1">mandatory</td>
              <td class="text-left" rowspan="1" colspan="1">This document, <a href="#end-of-message" class="xref">Section 3.2.4</a> </td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="nts-records">
<section id="section-3.2">
        <h3 id="name-nts-records">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-nts-records" class="section-name selfRef">NTS Records</a>
        </h3>
<p id="section-3.2-1">The following subsections describe the specific NTS records used to construct the NTS 
messages for the PTP key management system in detail. They appear in alphabetic sequence 
of their individual names. See <a href="#nts-message-types" class="xref">Section 3.1</a> for the application of 
the records in the respective messages.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">Note: For easier editing of the content, most of the descriptions in the following 
subsections are written as bullet points.<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<div id="aead-negotiation">
<section id="section-3.2.1">
          <h4 id="name-aead-algorithm-negotiation">
<a href="#section-3.2.1" class="section-number selfRef">3.2.1. </a><a href="#name-aead-algorithm-negotiation" class="section-name selfRef">AEAD Algorithm Negotiation</a>
          </h4>
<p id="section-3.2.1-1">Used in NTS-TSR protocol<a href="#section-3.2.1-1" class="pilcrow">¶</a></p>
<p id="section-3.2.1-2">This record is required in unicast mode and enables the negotiation of the AEAD 
 algorithm needed to encrypt and decrypt the ticket. The negotiation takes place between 
 the PTP grantor and the NTS-KE server by using the NTS registration messages. The 
 structure and properties follow the record defined in IETF RFC 8915 <span>[<a href="#RFC8915" class="xref">RFC8915</a>]</span>, Section 4.1.5.<a href="#section-3.2.1-2" class="pilcrow">¶</a></p>
<p id="section-3.2.1-3">Content and conditions:<a href="#section-3.2.1-3" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.2.1-4.1">The record has a Record Type number of 4 and the Critical Bit MAY be set.<a href="#section-3.2.1-4.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.1-4.2">
              <p id="section-3.2.1-4.2.1">The Record Body contains a sequence of 16-bit unsigned integers in network byte order:<a href="#section-3.2.1-4.2.1" class="pilcrow">¶</a></p>
<p id="section-3.2.1-4.2.2"><strong>Supported AEAD Algorithms = {AEAD 1 || AEAD 2 || ...}</strong><a href="#section-3.2.1-4.2.2" class="pilcrow">¶</a></p>
</li>
          </ul>
<ul class="compact">
<li class="compact" id="section-3.2.1-5.1">Each integer represents a numeric identifier of an AEAD algorithm registered by the IANA.
    (https://www.iana.org/assignments/aead-parameters/aead-parameters.xhtml)<a href="#section-3.2.1-5.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.1-5.2">Duplicate identifiers SHOULD NOT be included.<a href="#section-3.2.1-5.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.1-5.3">Grantor and NTS-KE server MUST support at least the AEAD_AES_SIV_CMAC_256 algorithm.<a href="#section-3.2.1-5.3" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.1-5.4">A list of recommended AEAD algorithms is shown in the following <a href="#tbl_aead" class="xref">Table 10</a>.<a href="#section-3.2.1-5.4" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.1-5.5">Other AEAD algorithms MAY also be used.<a href="#section-3.2.1-5.5" class="pilcrow">¶</a>
</li>
          </ul>
<span id="name-aead-algorithms"></span><div id="tbl_aead">
<table class="center" id="table-10">
            <caption>
<a href="#table-10" class="selfRef">Table 10</a>:
<a href="#name-aead-algorithms" class="selfRef">AEAD algorithms</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Numeric ID</th>
                <th class="text-left" rowspan="1" colspan="1">AEAD Algorithm</th>
                <th class="text-left" rowspan="1" colspan="1">Use</th>
                <th class="text-center" rowspan="1" colspan="1">Key Length (Octets)</th>
                <th class="text-left" rowspan="1" colspan="1">Reference</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">15</td>
                <td class="text-left" rowspan="1" colspan="1">AEAD_AES_SIV_CMAC_256</td>
                <td class="text-left" rowspan="1" colspan="1">mand.</td>
                <td class="text-center" rowspan="1" colspan="1">16</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <span>[<a href="#RFC5297" class="xref">RFC5297</a>]</span>
</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">16</td>
                <td class="text-left" rowspan="1" colspan="1">AEAD_AES_SIV_CMAC_384</td>
                <td class="text-left" rowspan="1" colspan="1">opt.</td>
                <td class="text-center" rowspan="1" colspan="1">24</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <span>[<a href="#RFC5297" class="xref">RFC5297</a>]</span>
</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">17</td>
                <td class="text-left" rowspan="1" colspan="1">AEAD_AES_SIV_CMAC_512</td>
                <td class="text-left" rowspan="1" colspan="1">opt.</td>
                <td class="text-center" rowspan="1" colspan="1">32</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <span>[<a href="#RFC5297" class="xref">RFC5297</a>]</span>
</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">32 - 32767</td>
                <td class="text-left" rowspan="1" colspan="1">Unassigned</td>
                <td class="text-left" rowspan="1" colspan="1"></td>
                <td class="text-center" rowspan="1" colspan="1"></td>
                <td class="text-left" rowspan="1" colspan="1"></td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">32768 - 65535</td>
                <td class="text-left" rowspan="1" colspan="1">Reserved for Private or Experimental Use</td>
                <td class="text-left" rowspan="1" colspan="1"></td>
                <td class="text-center" rowspan="1" colspan="1"></td>
                <td class="text-left" rowspan="1" colspan="1">
                  <span>[<a href="#RFC5116" class="xref">RFC5116</a>]</span>
</td>
              </tr>
            </tbody>
          </table>
</div>
<ul class="compact">
<li class="compact" id="section-3.2.1-7.1">In a PTP Registration Request message, this record MUST be contained exactly once.<a href="#section-3.2.1-7.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.1-7.2">In that message at least the AEAD_AES_SIV_CMAC_256 algorithm MUST be included.<a href="#section-3.2.1-7.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.1-7.3">If multiple AEAD algorithms are supported, the grantor SHOULD put the algorithm identifiers in descending priority in the Record Body.<a href="#section-3.2.1-7.3" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.1-7.4">
              <p id="section-3.2.1-7.4.1">Strong algorithms with higher bit lengths SHOULD have higher priority.<a href="#section-3.2.1-7.4.1" class="pilcrow">¶</a></p>
<p id="section-3.2.1-7.4.2"></p>
</li>
            <li class="compact" id="section-3.2.1-7.5">In a PTP Registration Response message, this record MUST be contained exactly once in the Current Parameters 
    container record and exactly once in the Next Parameters container record.<a href="#section-3.2.1-7.5" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.1-7.6">The Next Parameters container record MUST be present only during the update period.<a href="#section-3.2.1-7.6" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.1-7.7">The NTS-KE server SHOULD choose the highest priority AEAD algorithm from the request message that grantor and NTS-KE server support.<a href="#section-3.2.1-7.7" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.1-7.8">The NTS-KE server MAY ignore the priority and choose a different algorithm that grantor and NTS-KE server support.<a href="#section-3.2.1-7.8" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.1-7.9">In a PTP Registration Response message, this record MUST contain exactly one AEAD algorithm.<a href="#section-3.2.1-7.9" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.1-7.10">The selected algorithm MAY differ in the corresponding Current Parameters container record and Next Parameters container record.<a href="#section-3.2.1-7.10" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="association-mode">
<section id="section-3.2.2">
          <h4 id="name-association-mode">
<a href="#section-3.2.2" class="section-number selfRef">3.2.2. </a><a href="#name-association-mode" class="section-name selfRef">Association Mode</a>
          </h4>
<p id="section-3.2.2-1">Used in NTS-KE protocol<a href="#section-3.2.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2.2-2">This record enables the NTS-KE server to distinguish between a group based request 
 (multicast, mixed multicast/unicast, Group-of-2) or a unicast request. A multicast 
 request carries a group number, while a unicast request contains an identification 
 attribute of the grantor (e.g., IP address or PortIdentity).<a href="#section-3.2.2-2" class="pilcrow">¶</a></p>
<p id="section-3.2.2-3">Content and conditions:<a href="#section-3.2.2-3" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.2.2-4.1">In a PTP Key Request message, this record MUST be contained exactly once.<a href="#section-3.2.2-4.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.2-4.2">The record has a Record Type number of 1024 and the Critical Bit MAY be set.<a href="#section-3.2.2-4.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.2-4.3">The Record Body SHALL consist of two data fields:<a href="#section-3.2.2-4.3" class="pilcrow">¶</a>
</li>
          </ul>
<span id="name-association"></span><div id="tbl_assoc">
<table class="center" id="table-11">
            <caption>
<a href="#table-11" class="selfRef">Table 11</a>:
<a href="#name-association" class="selfRef">Association</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">field</th>
                <th class="text-center" rowspan="1" colspan="1">Octets</th>
                <th class="text-center" rowspan="1" colspan="1">Offset</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Association Type</td>
                <td class="text-center" rowspan="1" colspan="1">2</td>
                <td class="text-center" rowspan="1" colspan="1">0</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Association Value</td>
                <td class="text-center" rowspan="1" colspan="1">A</td>
                <td class="text-center" rowspan="1" colspan="1">2</td>
              </tr>
            </tbody>
          </table>
</div>
<ul class="compact">
<li class="compact" id="section-3.2.2-6.1">The Association Type is a 16-bit unsigned integer.<a href="#section-3.2.2-6.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.2-6.2">The length of Association Value depends on the value of Association Type.<a href="#section-3.2.2-6.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.2-6.3">All data in the fields are stored in network byte order.<a href="#section-3.2.2-6.3" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.2-6.4">The type numbers of Association Type as well as the length and content of Association 
       Value are shown in the following table and more details are given below.<a href="#section-3.2.2-6.4" class="pilcrow">¶</a>
</li>
          </ul>
<span id="name-association-types"></span><div id="tbl_assoc_types">
<table class="center" id="table-12">
            <caption>
<a href="#table-12" class="selfRef">Table 12</a>:
<a href="#name-association-types" class="selfRef">Association Types</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Description</th>
                <th class="text-center" rowspan="1" colspan="1">Assoc. Type Number</th>
                <th class="text-left" rowspan="1" colspan="1">Association Mode</th>
                <th class="text-left" rowspan="1" colspan="1">Association Value Content</th>
                <th class="text-center" rowspan="1" colspan="1">Assoc. Value Octets</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Group</td>
                <td class="text-center" rowspan="1" colspan="1">0</td>
                <td class="text-left" rowspan="1" colspan="1">Multicast / Unicast*</td>
                <td class="text-left" rowspan="1" colspan="1">Group Number</td>
                <td class="text-center" rowspan="1" colspan="1">5</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">IPv4</td>
                <td class="text-center" rowspan="1" colspan="1">1</td>
                <td class="text-left" rowspan="1" colspan="1">Unicast</td>
                <td class="text-left" rowspan="1" colspan="1">IPv4 address of the target port</td>
                <td class="text-center" rowspan="1" colspan="1">4</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">IPv6</td>
                <td class="text-center" rowspan="1" colspan="1">2</td>
                <td class="text-left" rowspan="1" colspan="1">Unicast</td>
                <td class="text-left" rowspan="1" colspan="1">IPv6 address of the target port</td>
                <td class="text-center" rowspan="1" colspan="1">16</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">802.3</td>
                <td class="text-center" rowspan="1" colspan="1">3</td>
                <td class="text-left" rowspan="1" colspan="1">Unicast</td>
                <td class="text-left" rowspan="1" colspan="1">MAC address of the target port</td>
                <td class="text-center" rowspan="1" colspan="1">6</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">PortIdentity</td>
                <td class="text-center" rowspan="1" colspan="1">4</td>
                <td class="text-left" rowspan="1" colspan="1">Unicast</td>
                <td class="text-left" rowspan="1" colspan="1">PortIdentity of the target PTP entity</td>
                <td class="text-center" rowspan="1" colspan="1">10</td>
              </tr>
            </tbody>
          </table>
</div>
<p id="section-3.2.2-8" class="keepWithPrevious">Unicast*: predefined groups of two (Group-of-2, Go2, see Group entry below)<a href="#section-3.2.2-8" class="pilcrow">¶</a></p>
<p id="section-3.2.2-9">Group:<a href="#section-3.2.2-9" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.2.2-10.1">This association type allows a PTP instance to join a PTP multicast group.<a href="#section-3.2.2-10.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.2-10.2">A group is identified by the PTP domain, the PTP profile (sdoId) and a sub-group attribute (see table below).<a href="#section-3.2.2-10.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.2-10.3">The PTP domainNumber is an 8-bit unsigned integer in the closed range 0 to 255.<a href="#section-3.2.2-10.3" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.2-10.4">
              <p id="section-3.2.2-10.4.1">The sdoId of a PTP domain is a 12-bit unsigned integer in the closed range 0 to 4095:<a href="#section-3.2.2-10.4.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.2.2-10.4.2.1">The most significant 4 bits are named the majorSdoId.<a href="#section-3.2.2-10.4.2.1" class="pilcrow">¶</a>
</li>
                <li class="compact" id="section-3.2.2-10.4.2.2">The least significant 8 bits are named the minorSdoId.<a href="#section-3.2.2-10.4.2.2" class="pilcrow">¶</a>
</li>
                <li class="compact" id="section-3.2.2-10.4.2.3">
                  <p id="section-3.2.2-10.4.2.3.1">Reference: IEEE Std 1588-2019, Section 7.1.1<a href="#section-3.2.2-10.4.2.3.1" class="pilcrow">¶</a></p>
<p id="section-3.2.2-10.4.2.3.2"></p>
</li>
              </ul>
<p id="section-3.2.2-10.4.3"><strong>sdoId = {majorSdoId || minorSdoId}</strong><a href="#section-3.2.2-10.4.3" class="pilcrow">¶</a></p>
</li>
          </ul>
<ul class="compact">
<li class="compact" id="section-3.2.2-11.1">The subGroup is 16-bit unsigned integer, which allows the division of a PTP multicast network into separate groups, each with individual security parameters.<a href="#section-3.2.2-11.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.2-11.2">This also allows manually configured unicast connections (Group-of-2), which can include transparent clocks as well.<a href="#section-3.2.2-11.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.2-11.3">The subGroup number is defined manually by the administrator.<a href="#section-3.2.2-11.3" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.2-11.4">Access to the groups is controlled by authorization procedures of the PTP devices (see <a href="#upfront-authorization" class="xref">Section 2.2.5.4</a>).<a href="#section-3.2.2-11.4" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.2-11.5">
              <p id="section-3.2.2-11.5.1">If no subgroups are required (= multicast mode), this attribute MUST contain the value zero.<a href="#section-3.2.2-11.5.1" class="pilcrow">¶</a></p>
<p id="section-3.2.2-11.5.2"></p>
</li>
            <li class="compact" id="section-3.2.2-11.6">
              <p id="section-3.2.2-11.6.1">The group number is eventually formed by concatenation of the following values:<a href="#section-3.2.2-11.6.1" class="pilcrow">¶</a></p>
<p id="section-3.2.2-11.6.2"><strong>group number = {domainNumber || 4 bit zero padding || sdoId || subGroup}</strong><a href="#section-3.2.2-11.6.2" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-3.2.2-12" class="keepWithNext">This is equvalent to:<a href="#section-3.2.2-12" class="pilcrow">¶</a></p>
<span id="name-group-association"></span><div id="tbl_group">
<table class="center" id="table-13">
            <caption>
<a href="#table-13" class="selfRef">Table 13</a>:
<a href="#name-group-association" class="selfRef">Group Association</a>
            </caption>
<thead>
              <tr>
                <th class="text-center" rowspan="1" colspan="1">Bits 7 - 4</th>
                <th class="text-center" rowspan="1" colspan="1">Bits 3 - 0</th>
                <th class="text-center" rowspan="1" colspan="1">Octets</th>
                <th class="text-center" rowspan="1" colspan="1">Offset</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-center" rowspan="1" colspan="1">domainNumber (high)</td>
                <td class="text-center" rowspan="1" colspan="1">domainNumber (low)</td>
                <td class="text-center" rowspan="1" colspan="1">1</td>
                <td class="text-center" rowspan="1" colspan="1">0</td>
              </tr>
              <tr>
                <td class="text-center" rowspan="1" colspan="1">zero padding</td>
                <td class="text-center" rowspan="1" colspan="1">majorSdoId</td>
                <td class="text-center" rowspan="1" colspan="1">1</td>
                <td class="text-center" rowspan="1" colspan="1">1</td>
              </tr>
              <tr>
                <td class="text-center" rowspan="1" colspan="1">minorSdoId (high)</td>
                <td class="text-center" rowspan="1" colspan="1">minorSdoId (low)</td>
                <td class="text-center" rowspan="1" colspan="1">1</td>
                <td class="text-center" rowspan="1" colspan="1">2</td>
              </tr>
              <tr>
                <td class="text-center" rowspan="1" colspan="1">subgroup (high)</td>
                <td class="text-center" rowspan="1" colspan="1">subGroup (low)</td>
                <td class="text-center" rowspan="1" colspan="1">2</td>
                <td class="text-center" rowspan="1" colspan="1">4</td>
              </tr>
            </tbody>
          </table>
</div>
<p id="section-3.2.2-14">IPv4:<a href="#section-3.2.2-14" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.2.2-15.1">This Association Type allows a requester to establish a PTP unicast connection to the desired grantor.<a href="#section-3.2.2-15.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.2-15.2">The Association Value contains the IPv4 address of the target PTP entity.<a href="#section-3.2.2-15.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.2-15.3">The total length is 4 octets.<a href="#section-3.2.2-15.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-3.2.2-16">IPv6:<a href="#section-3.2.2-16" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.2.2-17.1">This Association Type allows a requester to establish a PTP unicast connection to the desired grantor.<a href="#section-3.2.2-17.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.2-17.2">The Association Value contains the IPv6 address of the target PTP entity.<a href="#section-3.2.2-17.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.2-17.3">The total length is 16 octets.<a href="#section-3.2.2-17.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-3.2.2-18">802.3:<a href="#section-3.2.2-18" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.2.2-19.1">This Association Type allows a requester to establish a PTP unicast connection to the desired grantor.<a href="#section-3.2.2-19.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.2-19.2">The Association Value contains the MAC address of the Ethernet port of the target PTP entity.<a href="#section-3.2.2-19.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.2-19.3">The total length is 6 octets.<a href="#section-3.2.2-19.3" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.2-19.4">This method supports the 802.3 mode in PTP, where no UDP/IP stack is used.<a href="#section-3.2.2-19.4" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-3.2.2-20">PortIdentity:<a href="#section-3.2.2-20" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.2.2-21.1">This Association Type allows a requester to establish a PTP unicast connection to the desired grantor.<a href="#section-3.2.2-21.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.2-21.2">The Association Value contains the PortIdentity of the target PTP entity.<a href="#section-3.2.2-21.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.2-21.3">
              <p id="section-3.2.2-21.3.1">The total length is 10 octets.<a href="#section-3.2.2-21.3.1" class="pilcrow">¶</a></p>
<p id="section-3.2.2-21.3.2"></p>
</li>
            <li class="compact" id="section-3.2.2-21.4">
              <p id="section-3.2.2-21.4.1">The PortIdentity consists of the attributes clockIdentity and portNumber:<a href="#section-3.2.2-21.4.1" class="pilcrow">¶</a></p>
<p id="section-3.2.2-21.4.2"><strong>PortIdentity = {clockIdentity || portNumber}</strong><a href="#section-3.2.2-21.4.2" class="pilcrow">¶</a></p>
</li>
          </ul>
<ul class="compact">
<li class="compact" id="section-3.2.2-22.1">The clockIdentity is an 8 octet array and the portNumber is a 16-bit unsigned integer.<a href="#section-3.2.2-22.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.2-22.2">Source: IEEE Std 1588-2019, Sections 5.3.5 and 7.5<a href="#section-3.2.2-22.2" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="current-parameters-container">
<section id="section-3.2.3">
          <h4 id="name-current-parameters">
<a href="#section-3.2.3" class="section-number selfRef">3.2.3. </a><a href="#name-current-parameters" class="section-name selfRef">Current Parameters</a>
          </h4>
<p id="section-3.2.3-1">Used in NTS-KE and NTS-TSR protocol<a href="#section-3.2.3-1" class="pilcrow">¶</a></p>
<p id="section-3.2.3-2">This record is a simple container that can carry an arbitrary number of NTS 
 records. It holds all security parameters relevant for the current validity period. 
 The content as well as further conditions are defined by the respective NTS messages. 
 The order of the included records is arbitrary and the parsing rules are so far 
 identical with the NTS message. One exception: An End of Message record SHOULD NOT 
 be present and MUST be ignored. When the parser reaches the end of the Record Body 
 quantified by the Body Length, all embedded records have been processed.<a href="#section-3.2.3-2" class="pilcrow">¶</a></p>
<p id="section-3.2.3-3">Content and conditions:<a href="#section-3.2.3-3" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.2.3-4.1">The record has a Record Type number of 1025 and the Critical Bit MAY be set.<a href="#section-3.2.3-4.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.3-4.2">In a PTP Key Response message, this record MUST be contained exactly once.<a href="#section-3.2.3-4.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.3-4.3">The Record Body is defined as a set of records and MAY contain the following records:<a href="#section-3.2.3-4.3" class="pilcrow">¶</a>
</li>
          </ul>
<span id="name-current-parameters-containe"></span><div id="tbl_curr_param_key">
<table class="center" id="table-14">
            <caption>
<a href="#table-14" class="selfRef">Table 14</a>:
<a href="#name-current-parameters-containe" class="selfRef">Current Parameters container for PTP Key Response message</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">NTS Record Name</th>
                <th class="text-left" rowspan="1" colspan="1">Comunication Type</th>
                <th class="text-left" rowspan="1" colspan="1">Use</th>
                <th class="text-left" rowspan="1" colspan="1">Reference</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Security Associations (one or more)</td>
                <td class="text-left" rowspan="1" colspan="1">Multicast / Unicast</td>
                <td class="text-left" rowspan="1" colspan="1">mandatory</td>
                <td class="text-left" rowspan="1" colspan="1">This document, <a href="#security-association" class="xref">Section 3.2.11</a>
</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Validity Period</td>
                <td class="text-left" rowspan="1" colspan="1">Multicast / Unicast</td>
                <td class="text-left" rowspan="1" colspan="1">mandatory</td>
                <td class="text-left" rowspan="1" colspan="1">This document, <a href="#validity-period" class="xref">Section 3.2.18</a>
</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">PTP Time Server</td>
                <td class="text-left" rowspan="1" colspan="1">Unicast</td>
                <td class="text-left" rowspan="1" colspan="1">mandatory</td>
                <td class="text-left" rowspan="1" colspan="1">This document, <a href="#ptp-time-server" class="xref">Section 3.2.10</a>
</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Ticket</td>
                <td class="text-left" rowspan="1" colspan="1">Unicast</td>
                <td class="text-left" rowspan="1" colspan="1">mandatory</td>
                <td class="text-left" rowspan="1" colspan="1">This document, <a href="#ticket" class="xref">Section 3.2.15</a>
</td>
              </tr>
            </tbody>
          </table>
</div>
<ul class="compact">
<li class="compact" id="section-3.2.3-6.1">The records Security Association and Validity Period MUST be contained exactly once.<a href="#section-3.2.3-6.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.3-6.2">Additionally, the records PTP Time Server and Ticket MUST be included exactly once if 
       the client wants a unicast connection and MUST NOT be included if the client wants to 
   join a multicast group.<a href="#section-3.2.3-6.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.3-6.3">In a PTP Registration Response message, the Current Parameters container record MUST be contained exactly once.<a href="#section-3.2.3-6.3" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.3-6.4">The Record Body MUST contain the following records exactly:<a href="#section-3.2.3-6.4" class="pilcrow">¶</a>
</li>
          </ul>
<ul class="compact">
<li class="compact" id="section-3.2.3-7.1">In a PTP Registration Response message, the Current Parameters Container record MUST be contained exactly once.<a href="#section-3.2.3-7.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.3-7.2">The record body MAY contain the following records:<a href="#section-3.2.3-7.2" class="pilcrow">¶</a>
</li>
          </ul>
<span id="name-current-parameters-container"></span><div id="tbl_curr_param_registration">
<table class="center" id="table-15">
            <caption>
<a href="#table-15" class="selfRef">Table 15</a>:
<a href="#name-current-parameters-container" class="selfRef">Current Parameters container for PTP Registration Response Message</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">NTS Record Name</th>
                <th class="text-left" rowspan="1" colspan="1">Use</th>
                <th class="text-left" rowspan="1" colspan="1">Reference</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">AEAD Algorithm Negotiation</td>
                <td class="text-left" rowspan="1" colspan="1">mandatory</td>
                <td class="text-left" rowspan="1" colspan="1">This document, <a href="#aead-negotiation" class="xref">Section 3.2.1</a>
</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Validity Period</td>
                <td class="text-left" rowspan="1" colspan="1">mandatory</td>
                <td class="text-left" rowspan="1" colspan="1">This document, <a href="#validity-period" class="xref">Section 3.2.18</a>
</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Ticket Key ID</td>
                <td class="text-left" rowspan="1" colspan="1">mandatory</td>
                <td class="text-left" rowspan="1" colspan="1">This document, <a href="#ticket-key-id" class="xref">Section 3.2.17</a>
</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Ticket Key</td>
                <td class="text-left" rowspan="1" colspan="1">mandatory</td>
                <td class="text-left" rowspan="1" colspan="1">This document, <a href="#ticket-key" class="xref">Section 3.2.16</a>
</td>
              </tr>
            </tbody>
          </table>
</div>
</section>
</div>
<div id="end-of-message">
<section id="section-3.2.4">
          <h4 id="name-end-of-message">
<a href="#section-3.2.4" class="section-number selfRef">3.2.4. </a><a href="#name-end-of-message" class="section-name selfRef">End of Message</a>
          </h4>
<p id="section-3.2.4-1">Used in NTS-KE and NTS-TSR protocol<a href="#section-3.2.4-1" class="pilcrow">¶</a></p>
<p id="section-3.2.4-2">The End of Message record is defined in IETF RFC8915 <span>[<a href="#RFC8915" class="xref">RFC8915</a>]</span>, Section 4:<a href="#section-3.2.4-2" class="pilcrow">¶</a></p>
<ul class="compact ulEmpty">
<li class="compact ulEmpty" id="section-3.2.4-3.1">
              <em>"The record sequence in an NTS message SHALL be terminated by an "End of 
          Message" record. The requirement that all NTS-KE messages be terminated by an End 
          of Message record makes them self-delimiting."</em><a href="#section-3.2.4-3.1" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-3.2.4-4">Content and conditions:<a href="#section-3.2.4-4" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.2.4-5.1">The record has a Record Type number of 0 and a zero-length body.<a href="#section-3.2.4-5.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.4-5.2">The Critical Bit MUST be set.<a href="#section-3.2.4-5.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.4-5.3">This record MUST occur exactly once as the final record of every NTS request and response message.<a href="#section-3.2.4-5.3" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.4-5.4">This record SHOULD NOT be included in the container records and MUST be ignored if present.<a href="#section-3.2.4-5.4" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.4-5.5">See also: IETF RFC8915, Section 4.1.1<a href="#section-3.2.4-5.5" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="error">
<section id="section-3.2.5">
          <h4 id="name-error">
<a href="#section-3.2.5" class="section-number selfRef">3.2.5. </a><a href="#name-error" class="section-name selfRef">Error</a>
          </h4>
<p id="section-3.2.5-1">Used in NTS-KE and NTS-TSR protocol<a href="#section-3.2.5-1" class="pilcrow">¶</a></p>
<p id="section-3.2.5-2">The Error record is defined in IETF RFC8915 <span>[<a href="#RFC8915" class="xref">RFC8915</a>]</span>, Section 4.1.3. In addition to the 
Error codes 0 to 2 specified there the following Error codes 3 to 4 are defined:<a href="#section-3.2.5-2" class="pilcrow">¶</a></p>
<span id="name-error-codes"></span><div id="tbl_error">
<table class="center" id="table-16">
            <caption>
<a href="#table-16" class="selfRef">Table 16</a>:
<a href="#name-error-codes" class="selfRef">Error Codes</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Error Code</th>
                <th class="text-left" rowspan="1" colspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">0</td>
                <td class="text-left" rowspan="1" colspan="1">Unrecognized Critical Record</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">1</td>
                <td class="text-left" rowspan="1" colspan="1">Bad Request</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">2</td>
                <td class="text-left" rowspan="1" colspan="1">Internal Server Error</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">3</td>
                <td class="text-left" rowspan="1" colspan="1">Not Authorized</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">4</td>
                <td class="text-left" rowspan="1" colspan="1">Grantor not Registered</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">5 - 32767</td>
                <td class="text-left" rowspan="1" colspan="1">Unassigned</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">32768 - 65535</td>
                <td class="text-left" rowspan="1" colspan="1">Reserved for Private or Experimental Use</td>
              </tr>
            </tbody>
          </table>
</div>
<p id="section-3.2.5-4">Content and conditions:<a href="#section-3.2.5-4" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.2.5-5.1">The record has a Record Type number of 2 and body length of two octets consisting 
       of an unsigned 16-bit integer in network byte order, denoting an error code.<a href="#section-3.2.5-5.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.5-5.2">
              <p id="section-3.2.5-5.2.1">The Critical Bit MUST be set.<a href="#section-3.2.5-5.2.1" class="pilcrow">¶</a></p>
<p id="section-3.2.5-5.2.2"></p>
</li>
            <li class="compact" id="section-3.2.5-5.3">The Error code 3 "Not Authorized" is sent by the NTS-KE server if the requester 
       is not authorized to join the desired multicast group or if a grantor is prohibited 
   to register with the NTS-KE server.<a href="#section-3.2.5-5.3" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.5-5.4">
              <p id="section-3.2.5-5.4.1">The Error record MUST NOT be included in a PTP Registration Request message.<a href="#section-3.2.5-5.4.1" class="pilcrow">¶</a></p>
<p id="section-3.2.5-5.4.2"></p>
</li>
            <li class="compact" id="section-3.2.5-5.5">The Error code 4 "Grantor not Registered" is sent by the NTS-KE server when the requester 
       wants to establish a unicast connection to a grantor that is not registered with the NTS-KE server.<a href="#section-3.2.5-5.5" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.5-5.6">The Error record MUST NOT be included in a PTP Key Request message.<a href="#section-3.2.5-5.6" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="heartbeat-timeout">
<section id="section-3.2.6">
          <h4 id="name-heartbeat-timeout">
<a href="#section-3.2.6" class="section-number selfRef">3.2.6. </a><a href="#name-heartbeat-timeout" class="section-name selfRef">Heartbeat Timeout</a>
          </h4>
<p id="section-3.2.6-1">Used in NTS-TSR protocol<a href="#section-3.2.6-1" class="pilcrow">¶</a></p>
<p id="section-3.2.6-2">This record provides the NTS-KE server the capability to monitor the availability of the 
registered grantors. If this optional record is used, the registered grantors SHOULD send 
an NTS Heartbeat message to the NTS-KE server before the timeout expires.<a href="#section-3.2.6-2" class="pilcrow">¶</a></p>
<p id="section-3.2.6-3">Content and conditions:<a href="#section-3.2.6-3" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.2.6-4.1">The record has a Record Type number of 1026 and the Critical Bit SHOULD NOT be set.<a href="#section-3.2.6-4.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.6-4.2">The Record Body consists of a 16-bit unsigned integer in network byte order and denotes the heartbeat timeout in seconds..<a href="#section-3.2.6-4.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.6-4.3">The timeout set by the NTS-KE server MUST NOT be less than 1s and MUST be less than the lifetime set in the Validity Period record.<a href="#section-3.2.6-4.3" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.6-4.4">The timeout starts at the NTS-KE server with the generation of the Registration Response message.<a href="#section-3.2.6-4.4" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.6-4.5">Grantors that receive an invalid value as a heartbeat timeout MUST ignore this record and MUST NOT send heartbeat messages.<a href="#section-3.2.6-4.5" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.6-4.6">Grantors that receive a valid value SHOULD send a heartbeat message to the NTS-KE server before the timeout has elapsed.<a href="#section-3.2.6-4.6" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.6-4.7">The grantors SHOULD keep the heartbeat intervals and MAY also send heartbeat messages more frequently.<a href="#section-3.2.6-4.7" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.6-4.8">After transmitting a heartbeat from the grantor to the NTS-KE server, both sides reset the timeout to the start value and let the time count down again.<a href="#section-3.2.6-4.8" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.6-4.9">If this timeout is exceeded without receiving a heartbeat message or several heartbeats are missing in a row, 
       the NTS-KE server MAY delete the grantor from its registration list, so that a new registration of the grantor is necessary.<a href="#section-3.2.6-4.9" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.6-4.10">Grantors that are not (or no longer) registered with a NTS-KE server MUST NOT send heartbeat messages and NTS-KE 
       servers MUST discard heartbeat messages from non-registered grantors.<a href="#section-3.2.6-4.10" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.6-4.11">NTS-KE servers MAY respond in such cases with a Registration Response message containing error code 4 "Grantor not Registered".<a href="#section-3.2.6-4.11" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="next-parameters-container">
<section id="section-3.2.7">
          <h4 id="name-next-parameters">
<a href="#section-3.2.7" class="section-number selfRef">3.2.7. </a><a href="#name-next-parameters" class="section-name selfRef">Next Parameters</a>
          </h4>
<p id="section-3.2.7-1">Used in NTS-KE and NTS-TSR protocol<a href="#section-3.2.7-1" class="pilcrow">¶</a></p>
<p id="section-3.2.7-2">This record is a simple container that can carry an arbitrary number of 
NTS records. It holds all security parameters relevant for the upcoming 
validity period. The content as well as further conditions are defined by 
the respective NTS messages. The order of the included records is arbitrary 
and the parsing rules are so far identical with the NTS message. One 
exception: An End of Message record SHOULD NOT be present and MUST be 
ignored. When the parser reaches the end of the Record Body quantified 
by the Body Length, all embedded records have been processed.<a href="#section-3.2.7-2" class="pilcrow">¶</a></p>
<p id="section-3.2.7-3">Content and conditions:<a href="#section-3.2.7-3" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.2.7-4.1">The record has a Record Type number of 1027 and the Critical Bit MAY be set.<a href="#section-3.2.7-4.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.7-4.2">The Record Body is defined as a set of records.<a href="#section-3.2.7-4.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.7-4.3">
              <p id="section-3.2.7-4.3.1">The structure of the record body and all conditions MUST be identical to the rules 
       described in <a href="#current-parameters-container" class="xref">Section 3.2.3</a> of this document.<a href="#section-3.2.7-4.3.1" class="pilcrow">¶</a></p>
<p id="section-3.2.7-4.3.2"></p>
</li>
            <li class="compact" id="section-3.2.7-4.4">In both the PTP Key Response and PTP Registration Response message, this record MUST 
       be contained exactly once during the update period.<a href="#section-3.2.7-4.4" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.7-4.5">Outside the update period, this record MUST NOT be included.<a href="#section-3.2.7-4.5" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.7-4.6">In GrBA mode, this record MAY also be missing if the requesting client is to be 
       explicitly excluded from a multicast group after the security parameter rotation 
   process by the NTS-KE server.<a href="#section-3.2.7-4.6" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.7-4.7">More details are described in <a href="#key-update" class="xref">Section 2.2.1</a>.<a href="#section-3.2.7-4.7" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="nts-next-protocol-nego">
<section id="section-3.2.8">
          <h4 id="name-nts-next-protocol-negotiati">
<a href="#section-3.2.8" class="section-number selfRef">3.2.8. </a><a href="#name-nts-next-protocol-negotiati" class="section-name selfRef">NTS Next Protocol Negotiation</a>
          </h4>
<p id="section-3.2.8-1">Used in NTS-KE protocol<a href="#section-3.2.8-1" class="pilcrow">¶</a></p>
<p id="section-3.2.8-2">The Next Protocol Negotiation record is defined in IETF RFC8915 <span>[<a href="#RFC8915" class="xref">RFC8915</a>]</span>, Section 4.1.2:<a href="#section-3.2.8-2" class="pilcrow">¶</a></p>
<ul class="compact ulEmpty">
<li class="compact ulEmpty" id="section-3.2.8-3.1">
              <em>"The Protocol IDs listed in the client's NTS Next Protocol Negotiation record denote 
 those protocols that the client wishes to speak using the key material established 
 through this NTS-KE server session. Protocol IDs listed in the NTS-KE server's response 
 MUST comprise a subset of those listed in the request and denote those protocols that 
 the NTP server is willing and able to speak using the key material established through 
 this NTS-KE server session. The client MAY proceed with one or more of them. The request 
 MUST list at least one protocol, but the response MAY be empty."</em><a href="#section-3.2.8-3.1" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-3.2.8-4">Content and conditions:<a href="#section-3.2.8-4" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.2.8-5.1">The record has a Record Type number of 1 and the Critical Bit MUST be set.<a href="#section-3.2.8-5.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.8-5.2">
              <p id="section-3.2.8-5.2.1">The Record Body consists of a sequence of 16-bit unsigned integers in network byte order.<a href="#section-3.2.8-5.2.1" class="pilcrow">¶</a></p>
<p id="section-3.2.8-5.2.2"><strong>Record body = {Protocol ID 1 || Protocol ID 2 || ...}</strong><a href="#section-3.2.8-5.2.2" class="pilcrow">¶</a></p>
<p id="section-3.2.8-5.2.3"></p>
</li>
            <li class="compact" id="section-3.2.8-5.3">Each integer represents a Protocol ID from the IANA "Network Time Security Next Protocols" registry as shown in the table below.<a href="#section-3.2.8-5.3" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.8-5.4">For NTS request messages for PTPv2.1 (NTS-KE protocol merely), only the Protocol ID for PTPv2.1 SHOULD be included.<a href="#section-3.2.8-5.4" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.8-5.5">This prevents the mixing of records for different time protocols.<a href="#section-3.2.8-5.5" class="pilcrow">¶</a>
</li>
          </ul>
<span id="name-nts-next-protocol-ids"></span><div id="tbl_next_protocol_ids">
<table class="center" id="table-17">
            <caption>
<a href="#table-17" class="selfRef">Table 17</a>:
<a href="#name-nts-next-protocol-ids" class="selfRef">NTS next protocol IDs</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Protocol ID</th>
                <th class="text-left" rowspan="1" colspan="1">Protocol Name</th>
                <th class="text-left" rowspan="1" colspan="1">Reference</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">0</td>
                <td class="text-left" rowspan="1" colspan="1">Network Time Protocol version 4 (NTPv4)</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <span>[<a href="#RFC8915" class="xref">RFC8915</a>]</span>, Section 7.7</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">1</td>
                <td class="text-left" rowspan="1" colspan="1">Precision Time Protocol version 2.1 (PTPv2.1)</td>
                <td class="text-left" rowspan="1" colspan="1">This document</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">2 - 32767</td>
                <td class="text-left" rowspan="1" colspan="1">Unassigned</td>
                <td class="text-left" rowspan="1" colspan="1"></td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">32768 - 65535</td>
                <td class="text-left" rowspan="1" colspan="1">Reserved for Private or Experimental Use</td>
                <td class="text-left" rowspan="1" colspan="1"></td>
              </tr>
            </tbody>
          </table>
</div>
<p id="section-3.2.8-7">Possible NTP/PTP conflict:<a href="#section-3.2.8-7" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.2.8-8.1">The support of multiple protocols in this record may lead to the problem 
       that records in NTS messages can no longer be assigned to a specific time protocol.<a href="#section-3.2.8-8.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.8-8.2">For example, an NTS request could include records for both NTP and PTP.<a href="#section-3.2.8-8.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.8-8.3">However, NTS for NTP does not use NTS message types and the End of Message record is also 
    not defined for the case of multiple NTS requests in one TLS message.<a href="#section-3.2.8-8.3" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.8-8.4">
              <p id="section-3.2.8-8.4.1">This leads to the mixing of the records in the NTS messages.<a href="#section-3.2.8-8.4.1" class="pilcrow">¶</a></p>
<p id="section-3.2.8-8.4.2"></p>
</li>
            <li class="compact" id="section-3.2.8-8.5">A countermeasure is the use of only a single time protocol in the NTS Next Protocol 
    Negotiation record that explicitly assigns the NTS message to a specific time protocol.<a href="#section-3.2.8-8.5" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.8-8.6">When using NTS-secured NTP and NTS-secured PTP, two separate NTS requests i.e., two 
    separate TLS sessions MUST be made.<a href="#section-3.2.8-8.6" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="nts-message-type">
<section id="section-3.2.9">
          <h4 id="name-nts-message-type">
<a href="#section-3.2.9" class="section-number selfRef">3.2.9. </a><a href="#name-nts-message-type" class="section-name selfRef">NTS Message Type</a>
          </h4>
<p id="section-3.2.9-1">Used in NTS-TSR protocol<a href="#section-3.2.9-1" class="pilcrow">¶</a></p>
<p id="section-3.2.9-2">This record enables the distinction between different NTS message types and message versions for
   the NTS-TSR protocol. It MUST be included exactly once in each NTS message in the NTS-TSR protocol.<a href="#section-3.2.9-2" class="pilcrow">¶</a></p>
<p id="section-3.2.9-3">Content and conditions:<a href="#section-3.2.9-3" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.2.9-4.1">The record has a Record Type number of 1028 and the Critical Bit MUST be set.<a href="#section-3.2.9-4.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.9-4.2">The Record Body MUST consist of three data fields:<a href="#section-3.2.9-4.2" class="pilcrow">¶</a>
</li>
          </ul>
<span id="name-content-of-the-nts-message-"></span><div id="tbl_content_message_type">
<table class="center" id="table-18">
            <caption>
<a href="#table-18" class="selfRef">Table 18</a>:
<a href="#name-content-of-the-nts-message-" class="selfRef">Content of the NTS Message Type record</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Field</th>
                <th class="text-left" rowspan="1" colspan="1"> </th>
                <th class="text-left" rowspan="1" colspan="1">Octets</th>
                <th class="text-left" rowspan="1" colspan="1">Offset</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Message Type</td>
                <td class="text-left" rowspan="1" colspan="1"></td>
                <td class="text-left" rowspan="1" colspan="1">2</td>
                <td class="text-left" rowspan="1" colspan="1">0</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Message Version</td>
                <td class="text-left" rowspan="1" colspan="1">Major version</td>
                <td class="text-left" rowspan="1" colspan="1">1</td>
                <td class="text-left" rowspan="1" colspan="1">2</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Message Version (cont.)</td>
                <td class="text-left" rowspan="1" colspan="1">Minor version</td>
                <td class="text-left" rowspan="1" colspan="1">1</td>
                <td class="text-left" rowspan="1" colspan="1">3</td>
              </tr>
            </tbody>
          </table>
</div>
<ul class="compact">
<li class="compact" id="section-3.2.9-6.1">The Message Type field is a 16-bit unsigned integer in network byte order, denoting the 
       type of the current NTS message.<a href="#section-3.2.9-6.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.9-6.2">The following values are defined for the Message Type:<a href="#section-3.2.9-6.2" class="pilcrow">¶</a>
</li>
          </ul>
<span id="name-nts-message-types-for-the-n"></span><div id="tbl_message_type">
<table class="center" id="table-19">
            <caption>
<a href="#table-19" class="selfRef">Table 19</a>:
<a href="#name-nts-message-types-for-the-n" class="selfRef">NTS Message Types for the NTS-TSR protocol</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Message Type (value)</th>
                <th class="text-left" rowspan="1" colspan="1">NTS Message (NTS-TSR protocol)</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">0</td>
                <td class="text-left" rowspan="1" colspan="1">PTP Registration Request</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">1</td>
                <td class="text-left" rowspan="1" colspan="1">PTP Registration Response</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">2</td>
                <td class="text-left" rowspan="1" colspan="1">PTP Registration Revoke</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">3</td>
                <td class="text-left" rowspan="1" colspan="1">Heartbeat</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">4 - 32767</td>
                <td class="text-left" rowspan="1" colspan="1">Unassigned</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">32768 - 65535</td>
                <td class="text-left" rowspan="1" colspan="1">Reserved for Private or Experimental Use</td>
              </tr>
            </tbody>
          </table>
</div>
<ul class="compact">
<li class="compact" id="section-3.2.9-8.1">
              <p id="section-3.2.9-8.1.1">The Message Version consists of a tuple of two 8-bit unsigned integers in network byte order:<a href="#section-3.2.9-8.1.1" class="pilcrow">¶</a></p>
<p id="section-3.2.9-8.1.2"><strong>NTS Message Version = {major version || minor version}</strong><a href="#section-3.2.9-8.1.2" class="pilcrow">¶</a></p>
<p id="section-3.2.9-8.1.3"></p>
</li>
            <li class="compact" id="section-3.2.9-8.2">The representable version is therefore in the range 0.0 to 255.255 (e.g., v1.4 = 0104h).<a href="#section-3.2.9-8.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.9-8.3">All NTS messages for PTPv2.1 described in this document are in version number 1.0.<a href="#section-3.2.9-8.3" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.9-8.4">Thus the Message Version MUST match 0100h.<a href="#section-3.2.9-8.4" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="ptp-time-server">
<section id="section-3.2.10">
          <h4 id="name-ptp-time-server">
<a href="#section-3.2.10" class="section-number selfRef">3.2.10. </a><a href="#name-ptp-time-server" class="section-name selfRef">PTP Time Server</a>
          </h4>
<p id="section-3.2.10-1">Used in NTS-KE and NTS-TSR protocol<a href="#section-3.2.10-1" class="pilcrow">¶</a></p>
<p id="section-3.2.10-2">The PTP Time Server record is used exclusively in TiBA mode (PTP unicast connection) and signals 
   to the client (PTP requester) for which grantor the security parameters are valid. This record 
   is used both, in the NTS-KE protocol in the PTP Key Response, and in NTS-TSR protocol in the PTP 
   Registration Request message.<a href="#section-3.2.10-2" class="pilcrow">¶</a></p>
<p id="section-3.2.10-3">Content and conditions:<a href="#section-3.2.10-3" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.2.10-4.1">The record has a Record Type number of 1029 and the Critical Bit MAY be set.<a href="#section-3.2.10-4.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.10-4.2">The record body consists of a tuple of two 8-bit unsigned integers in network byte order.<a href="#section-3.2.10-4.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.10-4.3">
              <p id="section-3.2.10-4.3.1">The structure of the record body and all conditions MUST be identical to the rules 
       described in <a href="#association-mode" class="xref">Section 3.2.2</a> (Association Mode) of this document, 
   with the following exceptions:<a href="#section-3.2.10-4.3.1" class="pilcrow">¶</a></p>
<p id="section-3.2.10-4.3.2"></p>
</li>
            <li class="compact" id="section-3.2.10-4.4">In a PTP Key Response message, this record MUST be contained exactly once within 
       a container record (e.g., Current Parameters container record).<a href="#section-3.2.10-4.4" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.10-4.5">The PTP Time Server record contains a list of all available addresses of the grantor 
       assigned by the NTS-KE server.<a href="#section-3.2.10-4.5" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.10-4.6">This can be an IPv4, IPv6, MAC address, as well as the PortIdentity of the grantor.<a href="#section-3.2.10-4.6" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.10-4.7">This allows the client to change the PTP transport mode (e.g., from IPv4 to 802.3) 
       without performing a new NTS request.<a href="#section-3.2.10-4.7" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.10-4.8">The list in the PTP Time Server record MUST NOT contain the Association Type number 0 
       (multicast group) and MUST contain at least one entry.<a href="#section-3.2.10-4.8" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.10-4.9">
              <p id="section-3.2.10-4.9.1">The NTS-KE server SHOULD provide the grantor addresses requested by the client in 
       the PTP Key Request message, but MAY also assign a different grantor to the client.<a href="#section-3.2.10-4.9.1" class="pilcrow">¶</a></p>
<p id="section-3.2.10-4.9.2"></p>
</li>
          </ul>
<ul class="compact">
<li class="compact" id="section-3.2.10-5.1">In a PTP Registration Request message, this record MUST be included exactly once.<a href="#section-3.2.10-5.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.10-5.2">The grantor MUST enter all network addresses that are supported for a unicast connection.<a href="#section-3.2.10-5.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.10-5.3">This can be an IPv4, IPv6, MAC address, as well as the PortIdentity.<a href="#section-3.2.10-5.3" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.10-5.4">The list in the PTP Time Server record MUST NOT contain the Association Type number 0 
       (multicast group) and MUST contain at least the PortIdentity.<a href="#section-3.2.10-5.4" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.10-5.5">The PortIdentity is especially needed by the NTS-KE server to identify the correct PTP 
       instance (the grantor) in case of a PTP Registration Revoke message.<a href="#section-3.2.10-5.5" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="security-association">
<section id="section-3.2.11">
          <h4 id="name-security-association">
<a href="#section-3.2.11" class="section-number selfRef">3.2.11. </a><a href="#name-security-association" class="section-name selfRef">Security Association</a>
          </h4>
<p id="section-3.2.11-1">Used in NTS-KEprotocol<a href="#section-3.2.11-1" class="pilcrow">¶</a></p>
<p id="section-3.2.11-2">This record contains the information "how" specific PTP message types must be secured. 
It comprises all dynamic (negotiable) values necessary to construct the AUTHENTICATION 
TLV (IEEE Std 1588-2019, Section 16.14.3). Static values and flags, such as the secParamIndicator, 
are described in more detail in <a href="#auth-tlv-parameters" class="xref">Section 6</a>.<a href="#section-3.2.11-2" class="pilcrow">¶</a></p>
<p id="section-3.2.11-3">Content and conditions:<a href="#section-3.2.11-3" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.2.11-4.1">The record has a Record Type number of 1030 and the Critical Bit MAY be set.<a href="#section-3.2.11-4.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.11-4.2">The Record Body is a sequence of various parameters in network byte order and MUST be 
       formatted according to the following table:<a href="#section-3.2.11-4.2" class="pilcrow">¶</a>
</li>
          </ul>
<span id="name-security-association-record"></span><div id="tbl_security_assoc">
<table class="center" id="table-20">
            <caption>
<a href="#table-20" class="selfRef">Table 20</a>:
<a href="#name-security-association-record" class="selfRef">Security Association record</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Field</th>
                <th class="text-center" rowspan="1" colspan="1">Octets</th>
                <th class="text-center" rowspan="1" colspan="1">Offset</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Security Parameter Pointer</td>
                <td class="text-center" rowspan="1" colspan="1">1</td>
                <td class="text-center" rowspan="1" colspan="1">0</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Integrity Algorithm Type</td>
                <td class="text-center" rowspan="1" colspan="1">2</td>
                <td class="text-center" rowspan="1" colspan="1">1</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Key ID</td>
                <td class="text-center" rowspan="1" colspan="1">4</td>
                <td class="text-center" rowspan="1" colspan="1">3</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Key Length</td>
                <td class="text-center" rowspan="1" colspan="1">2</td>
                <td class="text-center" rowspan="1" colspan="1">7</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Key</td>
                <td class="text-center" rowspan="1" colspan="1">K</td>
                <td class="text-center" rowspan="1" colspan="1">9</td>
              </tr>
            </tbody>
          </table>
</div>
<ul class="compact">
<li class="compact" id="section-3.2.11-6.1">In a PTP Key Response message, the Security Association record MUST be included exactly once in the 
       Current Parameters container record and the Next Parameters container record.<a href="#section-3.2.11-6.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.11-6.2">The Next Parameters container record MUST be present only during the update period.<a href="#section-3.2.11-6.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.11-6.3">In TiBA mode, the Security Association record MUST be included exactly once in the 
       encrypted Ticket as well.<a href="#section-3.2.11-6.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-3.2.11-7">Security Parameter Pointer<a href="#section-3.2.11-7" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.2.11-8.1">The Security Parameter Pointer (SPP) is an 8-bit unsigned integer in the closed range 0 to 255.<a href="#section-3.2.11-8.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.11-8.2">This value enables the mutual assignment of SA, SP and AUTHENTICATION TLVs.<a href="#section-3.2.11-8.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.11-8.3">The generation and management of the SPP is controlled by the NTS-KE server (see <a href="#sa-sp-management" class="xref">Section 4.2</a>).<a href="#section-3.2.11-8.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-3.2.11-9">Integrity Algorithm Type<a href="#section-3.2.11-9" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.2.11-10.1">This value is a 16-bit unsigned integer in network byte order.<a href="#section-3.2.11-10.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.11-10.2">The possible values are equivalent to the MAC algorithm types from the table in <a href="#supported-mac-algos" class="xref">Section 3.2.14</a>.<a href="#section-3.2.11-10.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.11-10.3">The value used depends on the negotiated or predefined MAC algorithm.<a href="#section-3.2.11-10.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-3.2.11-11">Key ID<a href="#section-3.2.11-11" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.2.11-12.1">The Key ID is a 32-bit unsigned integer in network byte order.<a href="#section-3.2.11-12.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.11-12.2">The field length is oriented towards the structure of the AUTHENTICATION TLV.<a href="#section-3.2.11-12.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.11-12.3">The generation and management of the Key ID is controlled by the NTS-KE server.<a href="#section-3.2.11-12.3" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.11-12.4">
              <p id="section-3.2.11-12.4.1">The NTS-KE server MUST ensure that every Key ID is unique.<a href="#section-3.2.11-12.4.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.2.11-12.4.2.1">The value can be either a random number or an enumeration.<a href="#section-3.2.11-12.4.2.1" class="pilcrow">¶</a>
</li>
                <li class="compact" id="section-3.2.11-12.4.2.2">Previous Key IDs SHOULD NOT be reused for a certain number of rotation periods or a defined period of 
              time (see <a href="#sa-sp-management" class="xref">Section 4.2</a>).<a href="#section-3.2.11-12.4.2.2" class="pilcrow">¶</a>
</li>
              </ul>
</li>
          </ul>
<p id="section-3.2.11-13">Key Length<a href="#section-3.2.11-13" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.2.11-14.1">This value is a 16-bit unsigned integer in network byte order, denoting the length of the key.<a href="#section-3.2.11-14.1" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-3.2.11-15">Key<a href="#section-3.2.11-15" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.2.11-16.1">The value is a sequence of octets with a length of Key Length.<a href="#section-3.2.11-16.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.11-16.2">This symmetric key is needed together with the MAC algorithm to calculate the ICV.<a href="#section-3.2.11-16.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.11-16.3">It can be both a group key (GrBA mode) or a unicast key (TiBA mode).<a href="#section-3.2.11-16.3" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="source-portidentity">
<section id="section-3.2.12">
          <h4 id="name-source-portidentity">
<a href="#section-3.2.12" class="section-number selfRef">3.2.12. </a><a href="#name-source-portidentity" class="section-name selfRef">Source PortIdentity</a>
          </h4>
<p id="section-3.2.12-1">Used in NTS-KE and NTS-TSR protocol<a href="#section-3.2.12-1" class="pilcrow">¶</a></p>
<p id="section-3.2.12-2">This record contains a PTP PortIdentity and serves as an identifier. In a PTP Key Request message, 
   it enables the unique assignment of the NTS request to the PTP instance of the sender, since the 
   request may have been sent to the NTS-KE server via a management port.<a href="#section-3.2.12-2" class="pilcrow">¶</a></p>
<p id="section-3.2.12-3">The PortIdentity is embedded in the PTP Key Response message within the ticket to bind it to the 
   PTP requester. Grantors can verify that the ticket comes from the correct sender when it is received 
   and before it is decrypted, to prevent possible crypto-performance attacks. In a PTP registration 
   Revoke message this record enables the assignment of the grantor at the NTS-KE server to revoke an 
   existing registration. This is necessary because requesting PTP devices may have multiple independent 
   PTP ports and possibly multiple registrations with the KE.<a href="#section-3.2.12-3" class="pilcrow">¶</a></p>
<p id="section-3.2.12-4">Content and conditions:<a href="#section-3.2.12-4" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.2.12-5.1">The record has a Record Type number of 1031 and the Critical Bit MAY be set.<a href="#section-3.2.12-5.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.12-5.2">The record contains the PTP PortIdentity of the sender in network byte order, with a total length of 10 octets.<a href="#section-3.2.12-5.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.12-5.3">In a PTP Key Request message, this record MUST be included exactly once if the client intends a unicast request 
       in TiBA mode and MUST NOT be included if the client intends to join a multicast group/Go2 (= GrBA mode).<a href="#section-3.2.12-5.3" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.12-5.4">In a PTP Registration Revoke message, this record MUST be included exactly once.<a href="#section-3.2.12-5.4" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.12-5.5">
              <p id="section-3.2.12-5.5.1">The PortIdentity consists of the attributes clockIdentity and portNumber:<a href="#section-3.2.12-5.5.1" class="pilcrow">¶</a></p>
<p id="section-3.2.12-5.5.2"><strong>PortIdentity = {clockIdentity || portNumber}</strong><a href="#section-3.2.12-5.5.2" class="pilcrow">¶</a></p>
<p id="section-3.2.12-5.5.3"></p>
</li>
            <li class="compact" id="section-3.2.12-5.6">The clockIdentity is an 8-octet array and the portNumber is a 16-bit unsigned integer (source: 
       <span>[<a href="#IEEE1588-2019" class="xref">IEEE1588-2019</a>]</span>, Sections 5.3.5 and 7.5)<a href="#section-3.2.12-5.6" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="status">
<section id="section-3.2.13">
          <h4 id="name-status">
<a href="#section-3.2.13" class="section-number selfRef">3.2.13. </a><a href="#name-status" class="section-name selfRef">Status</a>
          </h4>
<p id="section-3.2.13-1">Used in NTS-TSR protocol<a href="#section-3.2.13-1" class="pilcrow">¶</a></p>
<p id="section-3.2.13-2">The Status record is an optional record that represents the current load of the sender. It 
   allows the NTS-KE server to improve load balancing when assigning grantors to the requesting 
   PTP clients in TiBA mode. The content of the record is designed in such a way that it can also 
   transmit other information (e.g., manufacturer-related information).<a href="#section-3.2.13-2" class="pilcrow">¶</a></p>
<p id="section-3.2.13-3">Content and conditions:<a href="#section-3.2.13-3" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.2.13-4.1">The record has a Record Type number of 1032 and the Critical Bit SHOULD NOT be set.<a href="#section-3.2.13-4.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.13-4.2">The Record Body MUST consist of two data fields:<a href="#section-3.2.13-4.2" class="pilcrow">¶</a>
</li>
          </ul>
<span id="name-structure-of-the-status-rec"></span><div id="tbl_status">
<table class="center" id="table-21">
            <caption>
<a href="#table-21" class="selfRef">Table 21</a>:
<a href="#name-structure-of-the-status-rec" class="selfRef">Structure of the Status record</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Field</th>
                <th class="text-center" rowspan="1" colspan="1">Octets</th>
                <th class="text-center" rowspan="1" colspan="1">Offset</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Status Type</td>
                <td class="text-center" rowspan="1" colspan="1">2</td>
                <td class="text-center" rowspan="1" colspan="1">0</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Status Data</td>
                <td class="text-center" rowspan="1" colspan="1">D</td>
                <td class="text-center" rowspan="1" colspan="1">2</td>
              </tr>
            </tbody>
          </table>
</div>
<ul class="compact">
<li class="compact" id="section-3.2.13-6.1">The Status Type is a 16-bit unsigned integer, denoting the content of the Status Data field.<a href="#section-3.2.13-6.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.13-6.2">The Status Data field is a sequence of octets in network byte order whose length, content 
       and structure is determined by the Status Type field.<a href="#section-3.2.13-6.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.13-6.3">The following values are currently set:<a href="#section-3.2.13-6.3" class="pilcrow">¶</a>
</li>
          </ul>
<span id="name-values-for-status-data"></span><div id="tbl_status_data">
<table class="center" id="table-22">
            <caption>
<a href="#table-22" class="selfRef">Table 22</a>:
<a href="#name-values-for-status-data" class="selfRef">Values for Status Data</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Status Type</th>
                <th class="text-center" rowspan="1" colspan="1">Status Data length</th>
                <th class="text-center" rowspan="1" colspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">0</td>
                <td class="text-center" rowspan="1" colspan="1">1 octet (unsigned int)</td>
                <td class="text-center" rowspan="1" colspan="1">grantor load</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">1 - 32767</td>
                <td class="text-center" rowspan="1" colspan="1">Unassigned</td>
                <td class="text-center" rowspan="1" colspan="1"></td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">32767 - 65535</td>
                <td class="text-center" rowspan="1" colspan="1">Reserved for Private or Experimental Use</td>
                <td class="text-center" rowspan="1" colspan="1"></td>
              </tr>
            </tbody>
          </table>
</div>
<ul class="compact">
<li class="compact" id="section-3.2.13-8.1">The following values apply to Status Type 0:<a href="#section-3.2.13-8.1" class="pilcrow">¶</a>
</li>
          </ul>
<span id="name-values-for-status-type-0"></span><div id="tbl_status_type_0">
<table class="center" id="table-23">
            <caption>
<a href="#table-23" class="selfRef">Table 23</a>:
<a href="#name-values-for-status-type-0" class="selfRef">Values for Status Type 0</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Status Type</th>
                <th class="text-center" rowspan="1" colspan="1">Status Data value</th>
                <th class="text-left" rowspan="1" colspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">0</td>
                <td class="text-center" rowspan="1" colspan="1">0x01</td>
                <td class="text-left" rowspan="1" colspan="1">grantor load: 0% to 24%</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">0</td>
                <td class="text-center" rowspan="1" colspan="1">0x02</td>
                <td class="text-left" rowspan="1" colspan="1">grantor load: 25% to 49%</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">0</td>
                <td class="text-center" rowspan="1" colspan="1">0x03</td>
                <td class="text-left" rowspan="1" colspan="1">grantor load: 50% to 74%</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">0</td>
                <td class="text-center" rowspan="1" colspan="1">0x04</td>
                <td class="text-left" rowspan="1" colspan="1">grantor load: 75% to 84%</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">0</td>
                <td class="text-center" rowspan="1" colspan="1">0x05</td>
                <td class="text-left" rowspan="1" colspan="1">grantor load: 85% to 94%</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">0</td>
                <td class="text-center" rowspan="1" colspan="1">0x06</td>
                <td class="text-left" rowspan="1" colspan="1">grantor load: 95% to 100%</td>
              </tr>
            </tbody>
          </table>
</div>
<ul class="compact">
<li class="compact" id="section-3.2.13-10.1">In a Heartbeat message this record MAY be contained once or several times.<a href="#section-3.2.13-10.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.13-10.2">If multiple status records are included, the status type MUST NOT occur twice.<a href="#section-3.2.13-10.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.13-10.3">The NTS-KE server MAY use the status record for optimizations and MAY also ignore them.<a href="#section-3.2.13-10.3" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="supported-mac-algos">
<section id="section-3.2.14">
          <h4 id="name-supported-mac-algorithms">
<a href="#section-3.2.14" class="section-number selfRef">3.2.14. </a><a href="#name-supported-mac-algorithms" class="section-name selfRef">Supported MAC Algorithms</a>
          </h4>
<p id="section-3.2.14-1">Used in NTS-KE and NTS-TSR protocol<a href="#section-3.2.14-1" class="pilcrow">¶</a></p>
<p id="section-3.2.14-2">This record allows free negotiation of the MAC algorithm needed to generate the ICV. Since 
   multicast groups are restricted to a shared algorithm, this record is used mandatorily in 
   a PTP Registration Request message and MAY be used (optionally) in a PTP Key Request message.<a href="#section-3.2.14-2" class="pilcrow">¶</a></p>
<p id="section-3.2.14-3">Content and conditions:<a href="#section-3.2.14-3" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.2.14-4.1">The record has a Record Type number of 1033 and the Critical Bit MAY be set.<a href="#section-3.2.14-4.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.14-4.2">
              <p id="section-3.2.14-4.2.1">The Record Body contains a sequence of 16-bit unsigned integers in network byte order.<a href="#section-3.2.14-4.2.1" class="pilcrow">¶</a></p>
<p id="section-3.2.14-4.2.2"><strong>Supported MAC Algorithms = {MAC 1 || MAC 2 || ...}</strong><a href="#section-3.2.14-4.2.2" class="pilcrow">¶</a></p>
<p id="section-3.2.14-4.2.3"></p>
</li>
            <li class="compact" id="section-3.2.14-4.3">Each integer represents a MAC Algorithm Type defined in the table below.<a href="#section-3.2.14-4.3" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.14-4.4">Duplicate identifiers SHOULD NOT be included.<a href="#section-3.2.14-4.4" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.14-4.5">Each PTP node MUST support at least the HMAC-SHA256-128 algorithm.<a href="#section-3.2.14-4.5" class="pilcrow">¶</a>
</li>
          </ul>
<span id="name-mac-algorithms"></span><div id="tbl_mac_algo">
<table class="center" id="table-24">
            <caption>
<a href="#table-24" class="selfRef">Table 24</a>:
<a href="#name-mac-algorithms" class="selfRef">MAC Algorithms</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">MAC Algorithm Types</th>
                <th class="text-left" rowspan="1" colspan="1">MAC Algorithm</th>
                <th class="text-center" rowspan="1" colspan="1">ICV Length (octets)</th>
                <th class="text-left" rowspan="1" colspan="1">Reference</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">0</td>
                <td class="text-left" rowspan="1" colspan="1">HMAC-SHA256-128</td>
                <td class="text-center" rowspan="1" colspan="1">16</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <span>[<a href="#fiPS-PUB-198-1" class="xref">fiPS-PUB-198-1</a>]</span>, <span>[<a href="#IEEE1588-2019" class="xref">IEEE1588-2019</a>]</span>
</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">1</td>
                <td class="text-left" rowspan="1" colspan="1">HMAC-SHA256</td>
                <td class="text-center" rowspan="1" colspan="1">32</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <span>[<a href="#fiPS-PUB-198-1" class="xref">fiPS-PUB-198-1</a>]</span>
</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">2</td>
                <td class="text-left" rowspan="1" colspan="1">AES-CMAC</td>
                <td class="text-center" rowspan="1" colspan="1">16</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <span>[<a href="#RFC4493" class="xref">RFC4493</a>]</span>
</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">3</td>
                <td class="text-left" rowspan="1" colspan="1">AES-GMAC-128</td>
                <td class="text-center" rowspan="1" colspan="1">16</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <span>[<a href="#RFC4543" class="xref">RFC4543</a>]</span>
</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">4</td>
                <td class="text-left" rowspan="1" colspan="1">AES-GMAC-192</td>
                <td class="text-center" rowspan="1" colspan="1">24</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <span>[<a href="#RFC4543" class="xref">RFC4543</a>]</span>
</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">5</td>
                <td class="text-left" rowspan="1" colspan="1">AES-GMAC-256</td>
                <td class="text-center" rowspan="1" colspan="1">32</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <span>[<a href="#RFC4543" class="xref">RFC4543</a>]</span>
</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">6 - 32767</td>
                <td class="text-left" rowspan="1" colspan="1">Unassigned </td>
                <td class="text-center" rowspan="1" colspan="1"></td>
                <td class="text-left" rowspan="1" colspan="1"></td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">32768 - 65535</td>
                <td class="text-left" rowspan="1" colspan="1">Reserved for Private or Experimental Use</td>
                <td class="text-center" rowspan="1" colspan="1"></td>
                <td class="text-left" rowspan="1" colspan="1"></td>
              </tr>
            </tbody>
          </table>
</div>
<p id="section-3.2.14-6">In GrBA mode:<a href="#section-3.2.14-6" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.2.14-7.1">This record is not necessary, since all PTP nodes in a multicast group MUST support the same MAC algorithm.<a href="#section-3.2.14-7.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.14-7.2">Therefore, this record SHOULD NOT be included in a PTP Key Request massage and the NTS-KE server MUST ignore 
       this record if the Association Type in the Association Mode record is 0 (= multicast group).<a href="#section-3.2.14-7.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.14-7.3">Unless this is specified otherwise by a PTP profile, the HMAC-SHA256-128 algorithm SHALL be used by default.<a href="#section-3.2.14-7.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-3.2.14-8">In TiBA mode:<a href="#section-3.2.14-8" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.2.14-9.1">In a PTP Key Request message, this record MAY be contained if the requester wants a unicast 
       connection (TiBA mode, not Go2) to a specific grantor.<a href="#section-3.2.14-9.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.14-9.2">The requester MUST NOT send more than one record of this type.<a href="#section-3.2.14-9.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.14-9.3">If this record is present, at least the HMAC-SHA256-128 MAC algorithm MUST be included.<a href="#section-3.2.14-9.3" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.14-9.4">If multiple MAC algorithms are supported, the requester SHOULD put the desired algorithm 
       identifiers in descending priority in the record body.<a href="#section-3.2.14-9.4" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.14-9.5">Strong algorithms with higher bit lengths SHOULD have higher priority.<a href="#section-3.2.14-9.5" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.14-9.6">
              <p id="section-3.2.14-9.6.1">The default MAC algorithm (HMAC-SHA256-128) MAY be omitted in the record.<a href="#section-3.2.14-9.6.1" class="pilcrow">¶</a></p>
<p id="section-3.2.14-9.6.2"></p>
</li>
            <li class="compact" id="section-3.2.14-9.7">In a PTP Registration Request message, this record MUST be present and the grantor MUST include all supported MAC algorithms in any order.<a href="#section-3.2.14-9.7" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.14-9.8">The NTS-KE server selects the algorithm after receiving a PTP Key Request message in unicast mode.<a href="#section-3.2.14-9.8" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.14-9.9">The NTS-KE server SHOULD choose the highest priority MAC algorithm from the request message that grantor and requester support.<a href="#section-3.2.14-9.9" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.14-9.10">The NTS-KE server MAY ignore the priority and choose a different algorithm that grantor and requester support.<a href="#section-3.2.14-9.10" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.14-9.11">If the MAC Algorithm Negotiation record is not within the PTP Key Request message, the NTS-KE server MUST choose the default algorithm HMAC-SHA256-128.<a href="#section-3.2.14-9.11" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-3.2.14-10">Initialization Vector (IV)<a href="#section-3.2.14-10" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.2.14-11.1">If GMAC is to be supported as a MAC algorithm, then an Initialization Vector (IV) must be constructed according to IETF RFC 4543 <span>[<a href="#RFC4543" class="xref">RFC4543</a>]</span>, Section 3.1.<a href="#section-3.2.14-11.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.14-11.2">Therefore, the IV MUST be eight octets long and MUST NOT be repeated for a specific key.<a href="#section-3.2.14-11.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.14-11.3">This can be achieved, for example, by using a counter.<a href="#section-3.2.14-11.3" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="ticket">
<section id="section-3.2.15">
          <h4 id="name-ticket">
<a href="#section-3.2.15" class="section-number selfRef">3.2.15. </a><a href="#name-ticket" class="section-name selfRef">Ticket</a>
          </h4>
<p id="section-3.2.15-1">Used in NTS-KE protocol<a href="#section-3.2.15-1" class="pilcrow">¶</a></p>
<p id="section-3.2.15-2">This record contains the parameters of the selected AEAD algorithm, as well as an 
encrypted security association. The record contains all the necessary 
security parameters that the grantor needs for a secured PTP unicast connection to 
the requester. The ticket is encrypted by the NTS-KE server with the 
symmetric ticket key which is also known to the grantor. The requester is not able 
to decrypt the encrypted security association within the ticket.<a href="#section-3.2.15-2" class="pilcrow">¶</a></p>
<p id="section-3.2.15-3">Content and conditions:<a href="#section-3.2.15-3" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.2.15-4.1">The record has a Record Type number of 1034 and the Critical Bit MAY be set.<a href="#section-3.2.15-4.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.15-4.2">The Record Body consists of several data fields and MUST be formatted as follows.<a href="#section-3.2.15-4.2" class="pilcrow">¶</a>
</li>
          </ul>
<span id="name-structure-of-a-ticket-recor"></span><div id="tbl_ticket">
<table class="center" id="table-25">
            <caption>
<a href="#table-25" class="selfRef">Table 25</a>:
<a href="#name-structure-of-a-ticket-recor" class="selfRef">Structure of a Ticket record</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Field</th>
                <th class="text-center" rowspan="1" colspan="1">Octets</th>
                <th class="text-center" rowspan="1" colspan="1">Offset</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Ticket Key ID</td>
                <td class="text-center" rowspan="1" colspan="1">4</td>
                <td class="text-center" rowspan="1" colspan="1">0</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Source PortIdentity</td>
                <td class="text-center" rowspan="1" colspan="1">10</td>
                <td class="text-center" rowspan="1" colspan="1">4</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Nonce Length</td>
                <td class="text-center" rowspan="1" colspan="1">2</td>
                <td class="text-center" rowspan="1" colspan="1">14</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Nonce</td>
                <td class="text-center" rowspan="1" colspan="1">N</td>
                <td class="text-center" rowspan="1" colspan="1">16</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Encrypted SA Length</td>
                <td class="text-center" rowspan="1" colspan="1">2</td>
                <td class="text-center" rowspan="1" colspan="1">N+16</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Encrypted Security Association</td>
                <td class="text-center" rowspan="1" colspan="1">E</td>
                <td class="text-center" rowspan="1" colspan="1">N+18</td>
              </tr>
            </tbody>
          </table>
</div>
<ul class="compact">
<li class="compact" id="section-3.2.15-6.1">In a PTP Key Response message, this record MUST be included exactly once each in the 
       Current Parameters container record and the Next Parameters container record if the 
   requesting client wants a unicast communication to a specific grantor in TiBA mode.<a href="#section-3.2.15-6.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.15-6.2">The Next Parameters container record MUST be present only during the update period.<a href="#section-3.2.15-6.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-3.2.15-7">Ticket Key ID<a href="#section-3.2.15-7" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.2.15-8.1">This is a 32-bit unsigned integer in network byte order, denoting the Key ID of the ticket key.<a href="#section-3.2.15-8.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.15-8.2">The value is set by the and is valid for the respective validity period.<a href="#section-3.2.15-8.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.15-8.3">See also <a href="#ticket-key-id" class="xref">Section 3.2.17</a> for more details.<a href="#section-3.2.15-8.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-3.2.15-9">Source PortIdentity<a href="#section-3.2.15-9" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.2.15-10.1">This 10-octet long field contains the identical Source PortIdentity of the PTP client 
       from the PTP Key Request message.<a href="#section-3.2.15-10.1" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-3.2.15-11">Nonce Length<a href="#section-3.2.15-11" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.2.15-12.1">This is a 16-bit unsigned integer in network byte order, denoting the length of 
       the Nonce field.<a href="#section-3.2.15-12.1" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-3.2.15-13">Nonce<a href="#section-3.2.15-13" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.2.15-14.1">This field contains the Nonce needed for the AEAD operation.<a href="#section-3.2.15-14.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.15-14.2">The length and conditions attached to the Nonce depend on the AEAD algorithm used.<a href="#section-3.2.15-14.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.15-14.3">More details and conditions are described in <a href="#aead-operation" class="xref">Section 4.1</a>.<a href="#section-3.2.15-14.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-3.2.15-15">Encrypted SA Length<a href="#section-3.2.15-15" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.2.15-16.1">This is a 16-bit unsigned integer in network byte order, denoting the length of 
       the Encrypted Security Association field.<a href="#section-3.2.15-16.1" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-3.2.15-17">Encrypted Security Association<a href="#section-3.2.15-17" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.2.15-18.1">This field contains the output of the AEAD operation ("Ciphertext") after the encryption 
       process of the respective Record Body of the respective Security Association record.<a href="#section-3.2.15-18.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.15-18.2">The plaintext of this field is described in <a href="#security-association" class="xref">Section 3.2.11</a>.<a href="#section-3.2.15-18.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.15-18.3">More details about the AEAD process and the required input data are described in 
       <a href="#aead-operation" class="xref">Section 4.1</a>.<a href="#section-3.2.15-18.3" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="ticket-key">
<section id="section-3.2.16">
          <h4 id="name-ticket-key">
<a href="#section-3.2.16" class="section-number selfRef">3.2.16. </a><a href="#name-ticket-key" class="section-name selfRef">Ticket Key</a>
          </h4>
<p id="section-3.2.16-1">Used in NTS-TSR protocol<a href="#section-3.2.16-1" class="pilcrow">¶</a></p>
<p id="section-3.2.16-2">This record contains the ticket key, which together with an AEAD algorithm is 
used to encrypt and decrypt the ticket payload (content of the Encrypted Security 
Association field in the Ticket record).<a href="#section-3.2.16-2" class="pilcrow">¶</a></p>
<p id="section-3.2.16-3">Content and conditions:<a href="#section-3.2.16-3" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.2.16-4.1">The record has a Record Type number of 1035 and the Critical Bit MAY be set.<a href="#section-3.2.16-4.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.16-4.2">The Record Body consists of a sequence of octets holding the symmetric key for the AEAD function.<a href="#section-3.2.16-4.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.16-4.3">
              <p id="section-3.2.16-4.3.1">The generation and length of the key MUST meet the requirement of the associated AEAD 
       algorithm.<a href="#section-3.2.16-4.3.1" class="pilcrow">¶</a></p>
<p id="section-3.2.16-4.3.2"></p>
</li>
            <li class="compact" id="section-3.2.16-4.4">In a PTP Registration Response message, this record MUST be included exactly once each in 
       the Current Parameters container record and the Next Parameters container record.<a href="#section-3.2.16-4.4" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.16-4.5">The Next Parameters container record MUST be present only during the update period.<a href="#section-3.2.16-4.5" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="ticket-key-id">
<section id="section-3.2.17">
          <h4 id="name-ticket-key-id">
<a href="#section-3.2.17" class="section-number selfRef">3.2.17. </a><a href="#name-ticket-key-id" class="section-name selfRef">Ticket Key ID</a>
          </h4>
<p id="section-3.2.17-1">Used in NTS-TSR protocol<a href="#section-3.2.17-1" class="pilcrow">¶</a></p>
<p id="section-3.2.17-2">The Ticket Key ID record is a unique identifier that allows a grantor to identify the associated 
   ticket key. The NTS-KE server is responsible for generating this Key ID, which is also unique to 
   the PTP network and incremented at each rotation period. The associated key is known only to the 
   NTS-KE server and grantor, and is generated and exchanged during the registration phase of the 
   grantor. All tickets generated by the NTS-KE server for the corresponding grantor in this validity 
   period using the same ticket key ID.<a href="#section-3.2.17-2" class="pilcrow">¶</a></p>
<p id="section-3.2.17-3">Content and conditions:<a href="#section-3.2.17-3" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.2.17-4.1">The record has a Record Type number of 1036 and the Critical Bit MAY be set.<a href="#section-3.2.17-4.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.17-4.2">The Record Body consists of a 32-bit unsigned integer in network byte order.<a href="#section-3.2.17-4.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.17-4.3">The generation and management of the ticket key ID is controlled by the NTS-KE server.<a href="#section-3.2.17-4.3" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.17-4.4">
              <p id="section-3.2.17-4.4.1">The NTS-KE server must ensure that every ticket key has a unique number.<a href="#section-3.2.17-4.4.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.2.17-4.4.2.1">The value is implementation dependent and MAY be either a random number, a hash value or an 
      enumeration.<a href="#section-3.2.17-4.4.2.1" class="pilcrow">¶</a>
</li>
                <li class="compact" id="section-3.2.17-4.4.2.2">Previous IDs SHOULD NOT be reused for a certain number of rotation periods or a defined 
      period of time.<a href="#section-3.2.17-4.4.2.2" class="pilcrow">¶</a>
</li>
              </ul>
<p id="section-3.2.17-4.4.3"></p>
</li>
            <li class="compact" id="section-3.2.17-4.5">In a PTP Key Response message, this record MUST be included exactly once each in the Current 
       Parameters container record and the Next Parameters container record if a unicast connection 
   in TiBA mode is to be established.<a href="#section-3.2.17-4.5" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.17-4.6">If the requester wishes to join a multicast group, the Ticket Key ID record MUST NOT be 
       included in the container records.<a href="#section-3.2.17-4.6" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.17-4.7">
              <p id="section-3.2.17-4.7.1">In a PTP Registration Response message, this record MUST be included exactly once in the Current 
       Parameters container record and once in the Next Parameters container record.<a href="#section-3.2.17-4.7.1" class="pilcrow">¶</a></p>
<p id="section-3.2.17-4.7.2"></p>
</li>
            <li class="compact" id="section-3.2.17-4.8">The Next Parameters container record MUST be present only during the update period.<a href="#section-3.2.17-4.8" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.17-4.9">The Ticket record MUST be present in TiBA mode and MUST NOT be present in GrBA mode.<a href="#section-3.2.17-4.9" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="validity-period">
<section id="section-3.2.18">
          <h4 id="name-validity-period">
<a href="#section-3.2.18" class="section-number selfRef">3.2.18. </a><a href="#name-validity-period" class="section-name selfRef">Validity Period</a>
          </h4>
<p id="section-3.2.18-1">Used in NTS-KE and NTS-TSR protocol<a href="#section-3.2.18-1" class="pilcrow">¶</a></p>
<p id="section-3.2.18-2">This record contains the validity information of the respective security parameters see also <a href="#key-update" class="xref">Section 2.2.1</a>).<a href="#section-3.2.18-2" class="pilcrow">¶</a></p>
<p id="section-3.2.18-3">Content and conditions:<a href="#section-3.2.18-3" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.2.18-4.1">In a PTP Key Response as well as the PTP Registration Response message, this record 
       MUST be included exactly once each in the Current Parameters container record and 
   the Next Parameters container record.<a href="#section-3.2.18-4.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.18-4.2">The record has a Record Type number of 1037 and the Critical Bit MAY be set.<a href="#section-3.2.18-4.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.18-4.3">The Record Body MUST consist of three data fields:<a href="#section-3.2.18-4.3" class="pilcrow">¶</a>
</li>
          </ul>
<span id="name-structure-of-a-validity-per"></span><div id="tbl_validity_period">
<table class="center" id="table-26">
            <caption>
<a href="#table-26" class="selfRef">Table 26</a>:
<a href="#name-structure-of-a-validity-per" class="selfRef">Structure of a Validity Period record</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Field</th>
                <th class="text-center" rowspan="1" colspan="1">Octets</th>
                <th class="text-center" rowspan="1" colspan="1">Offset</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Lifetime</td>
                <td class="text-center" rowspan="1" colspan="1">4</td>
                <td class="text-center" rowspan="1" colspan="1">0</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Update Period</td>
                <td class="text-center" rowspan="1" colspan="1">4</td>
                <td class="text-center" rowspan="1" colspan="1">4</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Grace Period</td>
                <td class="text-center" rowspan="1" colspan="1">4</td>
                <td class="text-center" rowspan="1" colspan="1">8</td>
              </tr>
            </tbody>
          </table>
</div>
<p id="section-3.2.18-6">Lifetime<a href="#section-3.2.18-6" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.2.18-7.1">The Lifetime is a 32-bit unsigned integer in network byte order.<a href="#section-3.2.18-7.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.18-7.2">If this record is within a Current Parameters container record, it shows the remaining 
       lifetime of the security parameters for the current validity period in seconds.<a href="#section-3.2.18-7.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.18-7.3">If this record is within a Next Parameters container record, it shows the total lifetime 
       of the security parameters for the next validity period in secondt<a href="#section-3.2.18-7.3" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.18-7.4">The counting down of the Next Parameters lifetime starts as soon as the remaining 
       lifetime of the Current Parameters reaches 0s.<a href="#section-3.2.18-7.4" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.18-7.5">The maximum value is set by the NTS-KE administrator or the PTP profile.<a href="#section-3.2.18-7.5" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.18-7.6">In conjunction with a PTP unicast establishment in TiBA mode, the lifetime of the unicast 
       key (within the Security Association record), the ticket key and registration lifetime of 
   a grantor with the NTS-KE server MUST be identical.<a href="#section-3.2.18-7.6" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-3.2.18-8">Update Period<a href="#section-3.2.18-8" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.2.18-9.1">The Update Period is a 32-bit unsigned integer in network byte order.<a href="#section-3.2.18-9.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.18-9.2">It specifies how many seconds before the lifetime expires the update period starts.<a href="#section-3.2.18-9.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.18-9.3">Unlike the lifetime, this is a fixed value that is not counted down.<a href="#section-3.2.18-9.3" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.18-9.4">The Update Period value MUST NOT be greater than the full Lifetime.<a href="#section-3.2.18-9.4" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.18-9.5">Recommended is an Update Period of 120s-300s if the full Lifetime is 900s or longer.<a href="#section-3.2.18-9.5" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.18-9.6">If the value of the Update Period in the Current Parameters container record is greater 
       than the Lifetime, then the key update process has started.<a href="#section-3.2.18-9.6" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.18-9.7">The presence or absence of the Next Parameters container record is specified in 
       <a href="#next-parameters-container" class="xref">Section 3.2.7</a>.<a href="#section-3.2.18-9.7" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-3.2.18-10">Grace Period<a href="#section-3.2.18-10" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.2.18-11.1">The Grace Period is a 32-bit unsigned integer in network byte order.<a href="#section-3.2.18-11.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.18-11.2">It defines how many seconds expired security parameters MUST still be accepted.<a href="#section-3.2.18-11.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.18-11.3">This allows the verification of incoming PTP messages that were still on the network and 
       secured with the old parameters.<a href="#section-3.2.18-11.3" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.18-11.4">The Grace Period value MUST NOT be greater than the Update Period.<a href="#section-3.2.18-11.4" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.18-11.5">Recommended is a Grace Period of 5 to 10 seconds.<a href="#section-3.2.18-11.5" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-3.2.18-12">Notes:<a href="#section-3.2.18-12" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.2.18-13.1">Requests during the currently running lifetime will receive respectively adapted count values.<a href="#section-3.2.18-13.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.18-13.2">The lifetime is a counter that is decremented and marks the expiration of defined parameters 
       when the value reaches zero.<a href="#section-3.2.18-13.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.18-13.3">The realization is implementation-dependent and can be done for example by a secondly decrementing.<a href="#section-3.2.18-13.3" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.18-13.4">It MUST be ensured that jumps (e.g., by adjustment of the local clock) are avoided.<a href="#section-3.2.18-13.4" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.18-13.5">The use of a monotonic clock is suitable for this.<a href="#section-3.2.18-13.5" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.18-13.6">Furthermore, it is to be considered which consequences the drifting of the local clock can cause.<a href="#section-3.2.18-13.6" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.2.18-13.7">With sufficiently small values of the lifetime (&lt;12 hours), this factor should be negligible.<a href="#section-3.2.18-13.7" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="additional-mechanisms">
<section id="section-4">
      <h2 id="name-additional-mechanisms">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-additional-mechanisms" class="section-name selfRef">Additional Mechanisms</a>
      </h2>
<p id="section-4-1">This section provides information about the use of the negotiated AEAD algorithm 
as well as the generation of the security policy pointers.<a href="#section-4-1" class="pilcrow">¶</a></p>
<div id="aead-operation">
<section id="section-4.1">
        <h3 id="name-aead-operation">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-aead-operation" class="section-name selfRef">AEAD Operation</a>
        </h3>
<p id="section-4.1-1">General information about AEAD:<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-4.1-2.1">The AEAD operation enables the integrity protection and the optional encryption 
       of the given data, depending on the input parameters.<a href="#section-4.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-4.1-2.2">While the structure of the AEAD output after the securing operation is determined 
       by the negotiated AEAD algorithm, it usually contains an authentication tag in 
   addition to the actual ciphertext.<a href="#section-4.1-2.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-4.1-2.3">The authentication tag provides the integrity protection, whereas the ciphertext 
       represents the encrypted data.<a href="#section-4.1-2.3" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-4.1-2.4">The AEAD algorithms supported in this document (see <a href="#aead-negotiation" class="xref">Section 3.2.1</a>) 
       always return an authentication tag with a fixed length of 16 octets.<a href="#section-4.1-2.4" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-4.1-2.5">The size of the following ciphertext is equal to the length of the plaintext.<a href="#section-4.1-2.5" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-4.1-2.6">
            <p id="section-4.1-2.6.1">The concatenation of authentication tag and ciphertext always form the unit 
       "Ciphertext":<a href="#section-4.1-2.6.1" class="pilcrow">¶</a></p>
<p id="section-4.1-2.6.2"><strong>Ciphertext = {authentication 
   tag || ciphertext}</strong><a href="#section-4.1-2.6.2" class="pilcrow">¶</a></p>
<p id="section-4.1-2.6.3"></p>
</li>
          <li class="compact" id="section-4.1-2.7">Hint: The term "Ciphertext" is distinguished between upper and lower case letters.<a href="#section-4.1-2.7" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-4.1-2.8">The following text always describes "Ciphertext".<a href="#section-4.1-2.8" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-4.1-2.9">
            <p id="section-4.1-2.9.1">Separation of the information concatenated in Ciphertext is not necessary at any time.<a href="#section-4.1-2.9.1" class="pilcrow">¶</a></p>
<p id="section-4.1-2.9.2"></p>
</li>
          <li class="compact" id="section-4.1-2.10">
            <p id="section-4.1-2.10.1">Six parameters are relevant for the execution of an AEAD operation:<a href="#section-4.1-2.10.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-4.1-2.10.2.1">AEAD (...):  is the AEAD algorithm itself<a href="#section-4.1-2.10.2.1" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-4.1-2.10.2.2">A:  Associated Data<a href="#section-4.1-2.10.2.2" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-4.1-2.10.2.3">N:  Nonce<a href="#section-4.1-2.10.2.3" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-4.1-2.10.2.4">K:  Key<a href="#section-4.1-2.10.2.4" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-4.1-2.10.2.5">P:  Plaintext<a href="#section-4.1-2.10.2.5" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-4.1-2.10.2.6">C:  Ciphertext<a href="#section-4.1-2.10.2.6" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="compact" id="section-4.1-2.11">The protection and encryption of the data is done as follows:  C = AEAD (A, N, K, P)<a href="#section-4.1-2.11" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-4.1-2.12">
            <p id="section-4.1-2.12.1">Therefore, the output of the AEAD function is the Ciphertext.<a href="#section-4.1-2.12.1" class="pilcrow">¶</a></p>
<p id="section-4.1-2.12.2"></p>
</li>
          <li class="compact" id="section-4.1-2.13">The verification and decryption of the data is done this way:  P = AEAD (A, N, K, C)<a href="#section-4.1-2.13" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-4.1-2.14">The output of the AEAD function is the Plaintext if the integrity verification is successful.<a href="#section-4.1-2.14" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.1-3">AEAD algorithm and input/output values for the Ticket record:<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-4.1-4.1">
            <p id="section-4.1-4.1.1">AEAD (...):<a href="#section-4.1-4.1.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-4.1-4.1.2.1">The AEAD algorithm that is negotiated between grantor and NTS-KE server during 
      the registration phase.<a href="#section-4.1-4.1.2.1" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-4.1-4.1.2.2">
                <p id="section-4.1-4.1.2.2.1">A list of the AEAD algorithms considered in this document can be found in 
      <a href="#aead-negotiation" class="xref">Section 3.2.1</a>.<a href="#section-4.1-4.1.2.2.1" class="pilcrow">¶</a></p>
<p id="section-4.1-4.1.2.2.2"></p>
</li>
            </ul>
</li>
          <li class="compact" id="section-4.1-4.2">
            <p id="section-4.1-4.2.1">Associated Data:<a href="#section-4.1-4.2.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-4.1-4.2.2.1">The Associated Data is an optional AEAD parameter and can be of any length and 
      content, as long as the AEAD algorithm does not give any further restrictions.<a href="#section-4.1-4.2.2.1" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-4.1-4.2.2.2">In addition to the Plaintext, this associated data is also included in the 
      integrity protection.<a href="#section-4.1-4.2.2.2" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-4.1-4.2.2.3">
                <p id="section-4.1-4.2.2.3.1">When encrypting or decrypting the Security Association record, this parameter 
      MUST remain empty.<a href="#section-4.1-4.2.2.3.1" class="pilcrow">¶</a></p>
<p id="section-4.1-4.2.2.3.2"></p>
</li>
            </ul>
</li>
          <li class="compact" id="section-4.1-4.3">
            <p id="section-4.1-4.3.1">Nonce:<a href="#section-4.1-4.3.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-4.1-4.3.2.1">Corresponds to the value from the Nonce field in the Ticket (<a href="#ticket" class="xref">Section 3.2.15</a>).<a href="#section-4.1-4.3.2.1" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-4.1-4.3.2.2">The requirements and conditions depend on the selected AEAD algorithm.<a href="#section-4.1-4.3.2.2" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-4.1-4.3.2.3">For the AEAD algorithms defined in <a href="#aead-negotiation" class="xref">Section 3.2.1</a> (with 
      numeric identifiers 15, 16, 17), a cryptographically secure random number MUST be used.<a href="#section-4.1-4.3.2.3" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-4.1-4.3.2.4">
                <p id="section-4.1-4.3.2.4.1">Due to the block length of the internal AES algorithm, the Nonce SHOULD have a length 
      of 16 octets.<a href="#section-4.1-4.3.2.4.1" class="pilcrow">¶</a></p>
<p id="section-4.1-4.3.2.4.2"></p>
</li>
            </ul>
</li>
          <li class="compact" id="section-4.1-4.4">
            <p id="section-4.1-4.4.1">Key:<a href="#section-4.1-4.4.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-4.1-4.4.2.1">This is the symmetric key required by the AEAD algorithm.<a href="#section-4.1-4.4.2.1" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-4.1-4.4.2.2">The key length depends on the selected algorithm.<a href="#section-4.1-4.4.2.2" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-4.1-4.4.2.3">
                <p id="section-4.1-4.4.2.3.1">When encrypting or decrypting the Security Association record, the ticket key MUST be used.<a href="#section-4.1-4.4.2.3.1" class="pilcrow">¶</a></p>
<p id="section-4.1-4.4.2.3.2"></p>
</li>
            </ul>
</li>
          <li class="compact" id="section-4.1-4.5">
            <p id="section-4.1-4.5.1">Plaintext:<a href="#section-4.1-4.5.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-4.1-4.5.2.1">This parameter contains the data to be encrypted and secured.<a href="#section-4.1-4.5.2.1" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-4.1-4.5.2.2">For AEAD encryption, this corresponds to the Record Body of the Security Association record with all parameters inside.<a href="#section-4.1-4.5.2.2" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-4.1-4.5.2.3">
                <p id="section-4.1-4.5.2.3.1">This is also the output of the AEAD operation after the decryption process.<a href="#section-4.1-4.5.2.3.1" class="pilcrow">¶</a></p>
<p id="section-4.1-4.5.2.3.2"></p>
</li>
            </ul>
</li>
          <li class="compact" id="section-4.1-4.6">
            <p id="section-4.1-4.6.1">Ciphertext:<a href="#section-4.1-4.6.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-4.1-4.6.2.1">Corresponds to the value from the Encrypted Security Association field in the Ticket 
      (<a href="#ticket" class="xref">Section 3.2.15</a>).<a href="#section-4.1-4.6.2.1" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-4.1-4.6.2.2">The Ciphertext is the output of the AEAD operation after the encryption process.<a href="#section-4.1-4.6.2.2" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-4.1-4.6.2.3">This is also the input parameter for the AEAD decryption operation.<a href="#section-4.1-4.6.2.3" class="pilcrow">¶</a>
</li>
            </ul>
</li>
        </ul>
</section>
</div>
<div id="sa-sp-management">
<section id="section-4.2">
        <h3 id="name-sa-sp-management">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-sa-sp-management" class="section-name selfRef">SA/SP Management</a>
        </h3>
<p id="section-4.2-1">This section describes the requirements and recommendations attached to SA/SP management, 
as well as details about the generation of identifiers.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">Requirements for the Security Association Database management:<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-4.2-3.1">The structure and management of the Security Association Database (SAD) are 
       implementation-dependent both on the NTS-KE server and on the PTP devices.<a href="#section-4.2-3.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-4.2-3.2">An example of this, as well as other recommendations, are described in Annex B.<a href="#section-4.2-3.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-4.2-3.3">A PTP device MUST contain exactly one SAD and Security Policy Database (SPD).<a href="#section-4.2-3.3" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-4.2-3.4">For multicast and Group-of-2 connections, SPPs MUST NOT occur more than once 
       in the SAD of a PTP device.<a href="#section-4.2-3.4" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-4.2-3.5">For unicast connections, SPPs MAY occur more than once in the SAD of a PTP device.<a href="#section-4.2-3.5" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-4.2-3.6">The NTS-KE server MUST ensure that SPPs can be uniquely assigned to a multicast 
       group or unicast connection.<a href="#section-4.2-3.6" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-4.2-3.7">This concerns both the NTS-KE server and all PTP devices assigned to the NTS-KE server.<a href="#section-4.2-3.7" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.2-4">SPP generation:<a href="#section-4.2-4" class="pilcrow">¶</a></p>
<ul class="compact ulEmpty">
<li class="compact ulEmpty" id="section-4.2-5.1">The generation of the SPP always takes place on the NTS-KE server and enables 
       the identification of a corresponding SA. The value of the SPP can be either a 
   random number or an enumeration. An SPP used in any multicast group MUST NOT 
   occur in any other multicast group or unicast connection. If a multicast group 
   or unicast connection is removed by the NTS-KE server, the released SPPs MAY be 
   reused for new groups or unicast connections. Before reusing an SPP, the NTS-KE 
   server MUST ensure that the SPP is no longer in use in the PTP network (e.g., 
   within Next Parameters). In different PTP devices, an SPP used in a unicast 
   connection MAY also occur in another unicast connection, as long as they are 
   not used in multicast groups.<a href="#section-4.2-5.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.2-6">Key/Key ID generation:<a href="#section-4.2-6" class="pilcrow">¶</a></p>
<ul class="compact ulEmpty">
<li class="compact ulEmpty" id="section-4.2-7.1">The generation of the keys MUST be performed by using a Cryptographically 
       Secure Pseudo Random Number Generator (CSPRNG) on the NTS-KE server (see also 
   <a href="#key-generation" class="xref">Section 2.2.2</a>). The length of the keys depends on the MAC algorithm used. The 
   generation and management of the Key ID is also controlled by the NTS-KE server. 
   The NTS-KE server MUST ensure that every Key ID is unique at least within an 
   SA with multiple parameter sets. The value of the Key ID is 
   implementation dependent and MAY be either a random number, a hash value or 
   an enumeration. Key IDs of expired keys MAY be reused but SHOULD NOT be reused 
   for a certain number of rotation periods or a defined period of time. Before 
   reusing a Key ID, the NTS-KE server MUST be ensured that the Key ID is no 
   longer in use in the PTP network (e.g., within Next Parameters).<a href="#section-4.2-7.1" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="new-ticket-tlv">
<section id="section-5">
      <h2 id="name-new-ticket-tlv-for-ptp-mess">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-new-ticket-tlv-for-ptp-mess" class="section-name selfRef">New TICKET TLV for PTP Messages</a>
      </h2>
<p id="section-5-1">Once a PTP port is registered as a grantor for association in unicast mode another PTP 
port (requester) can associate with it by first requesting a key from the NTS-KE server with
 Association Type in the Association Mode record set to one of the values 1 to 4 (IPv4, 
 IPv6, 802.3 or PortIdentity), and Association Values to the related address of the 
 desired grantor. After the reception of a PTP Key Response message during the NTS-KE protocol the requester obtains the unicast 
 key and the Ticket record containing the Record Body of the Security Association record (see <a href="#exchange-ticket-based" class="xref">Section 2.1.2</a> 
 and <a href="#ticket" class="xref">Section 3.2.15</a>). The ticket
 includes the identification of the requester, the Encrypted SA along with the unicast key as well 
 as the lifetime in the Validity record.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">To provide the grantor with the security data, the requester sends a secured unicast 
request to the grantor, e.g., an Announce request (= Signaling message with a 
REQUEST_UNICAST_TRANSMISSION TLV with Announce as messageType in the TLV), which is 
secured with the unicast key.<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">To accomplish that, the requester sends a newly defined TICKET TLV with the Ticket 
embedded and the AUTHENTICATION TLV with the PTP unicast negotiation message. 
The TICKET TLV must be positioned before the AUTHENTICATION TLV to include the TICKET TLV 
in the securing by the ICV. The receiving grantor decrypts the Ticket (actually the encrypted security association) from the 
TICKET TLV getting access to the information therein. With the contained unicast key, the 
grantor checks the requester identity and the authenticity of the request message.<a href="#section-5-3" class="pilcrow">¶</a></p>
<p id="section-5-4">Thereafter, all secured unicast messages between grantor and requester will use the 
unicast key for generating the ICV in the AUTHENTICATION TLV for authentication of the 
message until the unicast key expires.<a href="#section-5-4" class="pilcrow">¶</a></p>
<p id="section-5-5">If the requester's identity does not match with the Source PortIdentity field  
in the Ticket or the ICV in the AUTHENTICATION TLV is not identical to 
the generated ICV by the grantor, then the unicast request message MUST be denied.<a href="#section-5-5" class="pilcrow">¶</a></p>
<p id="section-5-6">The TICKET TLV structure is given in <a href="#tbl_ticket_tlv" class="xref">Table 27</a> below.<a href="#section-5-6" class="pilcrow">¶</a></p>
<span id="name-structure-of-the-ticket-tlv"></span><div id="tbl_ticket_tlv">
<table class="center" id="table-27">
        <caption>
<a href="#table-27" class="selfRef">Table 27</a>:
<a href="#name-structure-of-the-ticket-tlv" class="selfRef">Structure of the TICKET TLV</a>
        </caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">field</th>
            <th class="text-center" rowspan="1" colspan="1">Octets</th>
            <th class="text-center" rowspan="1" colspan="1">Offset</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">tlvType</td>
            <td class="text-center" rowspan="1" colspan="1">2</td>
            <td class="text-center" rowspan="1" colspan="1">0</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">lengthfield</td>
            <td class="text-center" rowspan="1" colspan="1">2</td>
            <td class="text-center" rowspan="1" colspan="1">2</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">Ticket record</td>
            <td class="text-center" rowspan="1" colspan="1">T</td>
            <td class="text-center" rowspan="1" colspan="1">4</td>
          </tr>
        </tbody>
      </table>
</div>
<p id="section-5-8">To comply with the TLV structure of IEEE Std 1588-2019 (<span>[<a href="#IEEE1588-2019" class="xref">IEEE1588-2019</a>]</span>, Section 14.1)
   the TICKET TLV is structured as presented in <a href="#tbl_ticket_tlv" class="xref">Table 27</a> with a newly defined tlvType, a 
   respective length field and the Ticket record (see <a href="#ticket" class="xref">Section 3.2.15</a>) containing 
   the encrypted security association. Eventually the Ticket TLV may be defined externally to IEEE 1588 SA, 
   e.g., by the IETF.  Then the structure should follow IEEE Std 1588-2019 
   (<span>[<a href="#IEEE1588-2019" class="xref">IEEE1588-2019</a>]</span>, Section 14.3) to define a new standard organization extension 
   TLV as presented in <a href="#tbl_ticket_tlv_ext" class="xref">Table 28</a> below.<a href="#section-5-8" class="pilcrow">¶</a></p>
<span id="name-structure-of-an-organizatio"></span><div id="tbl_ticket_tlv_ext">
<table class="center" id="table-28">
        <caption>
<a href="#table-28" class="selfRef">Table 28</a>:
<a href="#name-structure-of-an-organizatio" class="selfRef">Structure of an organization extension TLV form for the TICKET TLV</a>
        </caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">field</th>
            <th class="text-center" rowspan="1" colspan="1">Octets</th>
            <th class="text-center" rowspan="1" colspan="1">Offset</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">tlvType</td>
            <td class="text-center" rowspan="1" colspan="1">2</td>
            <td class="text-center" rowspan="1" colspan="1">0</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">lengthfield</td>
            <td class="text-center" rowspan="1" colspan="1">2</td>
            <td class="text-center" rowspan="1" colspan="1">2</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">organizationId</td>
            <td class="text-center" rowspan="1" colspan="1">3</td>
            <td class="text-center" rowspan="1" colspan="1">4</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">organizationSubType</td>
            <td class="text-center" rowspan="1" colspan="1">3</td>
            <td class="text-center" rowspan="1" colspan="1">7</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">Ticket record</td>
            <td class="text-center" rowspan="1" colspan="1">T</td>
            <td class="text-center" rowspan="1" colspan="1">10</td>
          </tr>
        </tbody>
      </table>
</div>
<p id="section-5-10">The TICKET TLV will be added to the PTP message preceding the AUTHENTICATION TLV as 
       shown in figure 48 of IEEE Std 1588-2019 (<span>[<a href="#IEEE1588-2019" class="xref">IEEE1588-2019</a>]</span>, Section 16.14.1.1).<a href="#section-5-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="auth-tlv-parameters">
<section id="section-6">
      <h2 id="name-authentication-tlv-paramete">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-authentication-tlv-paramete" class="section-name selfRef">AUTHENTICATION TLV Parameters</a>
      </h2>
<p id="section-6-1">The AUTHENTICATION TLV is the heart of the integrated security mechanism (prong A) for PTP. 
It provides all necessary data for the processing of the security means. The structure is shown 
in <a href="#tbl_auth_tlv" class="xref">Table 29</a> below (compare to figure 49 of <span>[<a href="#IEEE1588-2019" class="xref">IEEE1588-2019</a>]</span>).<a href="#section-6-1" class="pilcrow">¶</a></p>
<span id="name-structure-of-the-authentica"></span><div id="tbl_auth_tlv">
<table class="center" id="table-29">
        <caption>
<a href="#table-29" class="selfRef">Table 29</a>:
<a href="#name-structure-of-the-authentica" class="selfRef">Structure of the AUTHENTICATION TLV</a>
        </caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">field</th>
            <th class="text-left" rowspan="1" colspan="1">Use</th>
            <th class="text-left" rowspan="1" colspan="1">Description</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">tlvType</td>
            <td class="text-left" rowspan="1" colspan="1">mandatory</td>
            <td class="text-left" rowspan="1" colspan="1">TLV Type</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">lengthfield</td>
            <td class="text-left" rowspan="1" colspan="1">mandatory</td>
            <td class="text-left" rowspan="1" colspan="1">TLV Length Information</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">SPP</td>
            <td class="text-left" rowspan="1" colspan="1">mandatory</td>
            <td class="text-left" rowspan="1" colspan="1">Security Parameter Pointer</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">secParamIndicator</td>
            <td class="text-left" rowspan="1" colspan="1">mandatory</td>
            <td class="text-left" rowspan="1" colspan="1">Security Parameter Indicator</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">keyID</td>
            <td class="text-left" rowspan="1" colspan="1">mandatory</td>
            <td class="text-left" rowspan="1" colspan="1">Key Identifier or Current Key Disclosure Interval, depending on verification scheme</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">disclosedKey</td>
            <td class="text-left" rowspan="1" colspan="1">optional</td>
            <td class="text-left" rowspan="1" colspan="1">Disclosed key from previous interval</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">sequenceNo</td>
            <td class="text-left" rowspan="1" colspan="1">optional</td>
            <td class="text-left" rowspan="1" colspan="1">Sequence number</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">RES</td>
            <td class="text-left" rowspan="1" colspan="1">optional</td>
            <td class="text-left" rowspan="1" colspan="1">Reserved</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">ICV</td>
            <td class="text-left" rowspan="1" colspan="1">mandatory</td>
            <td class="text-left" rowspan="1" colspan="1">ICV based on algorithm OID</td>
          </tr>
        </tbody>
      </table>
</div>
<p id="section-6-3">The tlvType is AUTHENTICATION and lengthfield gives the length of the TLV. When using the 
AUTHENTICATION TLV with NTS key management, the SPP and keyID will be provided by the NTS-KE server 
in the PTP Key Response message<a href="#section-6-3" class="pilcrow">¶</a></p>
<p id="section-6-4">The optional disclosedKey, sequenceNo, and RES fields are 
omitted. So all of the flags in the SecParamIndicator MUST be FALSE.<a href="#section-6-4" class="pilcrow">¶</a></p>
<p id="section-6-5">ICV field contains the integrity check value of the particular PTP message calculated 
using the integrity algorithm defined by the key management.<a href="#section-6-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-7">
      <h2 id="name-iana-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-7-1">Considerations should be made ...<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">...<a href="#section-7-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-considerations">
<section id="section-8">
      <h2 id="name-security-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-8-1">...<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2"></p>
<p id="section-8-3"></p>
<p id="section-8-4"></p>
</section>
</div>
<div id="acknowledgements">
<section id="section-9">
      <h2 id="name-acknowledgements">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="section-9-1">The authors would like to thank ...<a href="#section-9-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-10">
      <h2 id="name-references">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-10.1">
        <h3 id="name-normative-references">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="fiPS-PUB-198-1">[fiPS-PUB-198-1]</dt>
        <dd>
<span class="refAuthor">National Institute of Standards and Technology (NIST)</span>, <span class="refTitle">"The Keyed-Hash Message Authentication Code (HMAC)"</span>, <span class="seriesInfo">NIST fiPS PUB 198-1</span>, <time datetime="2008" class="refDate">2008</time>. </dd>
<dd class="break"></dd>
<dt id="IEEE1588-2019">[IEEE1588-2019]</dt>
        <dd>
<span class="refAuthor">Institute of Electrical and Electronics Engineers - IEEE Standards Association</span>, <span class="refTitle">"IEEE Standard for a Precision Clock Synchronization Protocol for Networked Measurement and Control Systems"</span>, <span class="seriesInfo">IEEE Standard 1588-2019</span>, <time datetime="2019" class="refDate">2019</time>. </dd>
<dd class="break"></dd>
<dt id="ITU-T_X.509">[ITU-T_X.509]</dt>
        <dd>
<span class="refAuthor">International Telecommunication Union (ITU)</span>, <span class="refTitle">"Information technology – Open systems interconnection – The Directory: Public-key and attribute certificate frameworks"</span>, <span class="seriesInfo">ITU-T Recommendation X.509 (2008)</span>, <time datetime="2008-11" class="refDate">November 2008</time>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4493">[RFC4493]</dt>
        <dd>
<span class="refAuthor">Song, JH.</span>, <span class="refAuthor">Poovendran, R.</span>, <span class="refAuthor">Lee, J.</span>, and <span class="refAuthor">T. Iwata</span>, <span class="refTitle">"The AES-CMAC Algorithm"</span>, <span class="seriesInfo">RFC 4493</span>, <span class="seriesInfo">DOI 10.17487/RFC4493</span>, <time datetime="2006-06" class="refDate">June 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4493">https://www.rfc-editor.org/info/rfc4493</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4543">[RFC4543]</dt>
        <dd>
<span class="refAuthor">McGrew, D.</span> and <span class="refAuthor">J. Viega</span>, <span class="refTitle">"The Use of Galois Message Authentication Code (GMAC) in IPsec ESP and AH"</span>, <span class="seriesInfo">RFC 4543</span>, <span class="seriesInfo">DOI 10.17487/RFC4543</span>, <time datetime="2006-05" class="refDate">May 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4543">https://www.rfc-editor.org/info/rfc4543</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5116">[RFC5116]</dt>
        <dd>
<span class="refAuthor">McGrew, D.</span>, <span class="refTitle">"An Interface and Algorithms for Authenticated Encryption"</span>, <span class="seriesInfo">RFC 5116</span>, <span class="seriesInfo">DOI 10.17487/RFC5116</span>, <time datetime="2008-01" class="refDate">January 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5116">https://www.rfc-editor.org/info/rfc5116</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5297">[RFC5297]</dt>
        <dd>
<span class="refAuthor">Harkins, D.</span>, <span class="refTitle">"Synthetic Initialization Vector (SIV) Authenticated Encryption Using the Advanced Encryption Standard (AES)"</span>, <span class="seriesInfo">RFC 5297</span>, <span class="seriesInfo">DOI 10.17487/RFC5297</span>, <time datetime="2008-10" class="refDate">October 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5297">https://www.rfc-editor.org/info/rfc5297</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7301">[RFC7301]</dt>
        <dd>
<span class="refAuthor">Friedl, S.</span>, <span class="refAuthor">Popov, A.</span>, <span class="refAuthor">Langley, A.</span>, and <span class="refAuthor">E. Stephan</span>, <span class="refTitle">"Transport Layer Security (TLS) Application-Layer Protocol Negotiation Extension"</span>, <span class="seriesInfo">RFC 7301</span>, <span class="seriesInfo">DOI 10.17487/RFC7301</span>, <time datetime="2014-07" class="refDate">July 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7301">https://www.rfc-editor.org/info/rfc7301</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7525">[RFC7525]</dt>
        <dd>
<span class="refAuthor">Sheffer, Y.</span>, <span class="refAuthor">Holz, R.</span>, and <span class="refAuthor">P. Saint-Andre</span>, <span class="refTitle">"Recommendations for Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)"</span>, <span class="seriesInfo">BCP 195</span>, <span class="seriesInfo">RFC 7525</span>, <span class="seriesInfo">DOI 10.17487/RFC7525</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7525">https://www.rfc-editor.org/info/rfc7525</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8915">[RFC8915]</dt>
      <dd>
<span class="refAuthor">Franke, D.</span>, <span class="refAuthor">Sibold, D.</span>, <span class="refAuthor">Teichel, K.</span>, <span class="refAuthor">Dansarie, M.</span>, and <span class="refAuthor">R. Sundblad</span>, <span class="refTitle">"Network Time Security for the Network Time Protocol"</span>, <span class="seriesInfo">RFC 8915</span>, <span class="seriesInfo">DOI 10.17487/RFC8915</span>, <time datetime="2020-09" class="refDate">September 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8915">https://www.rfc-editor.org/info/rfc8915</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-10.2">
        <h3 id="name-informative-references">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="Langer_et_al._2020">[Langer_et_al._2020]</dt>
      <dd>
<span class="refAuthor">Langer, M.</span>, <span class="refAuthor">Heine, K.</span>, <span class="refAuthor">Sibold, D.</span>, and <span class="refAuthor">R. Bermbach</span>, <span class="refTitle">"A Network Time Security Based Automatic Key Management for PTPv2.1"</span>, <span class="seriesInfo">2020 IEEE 45th Conference on Local Computer Networks (LCN), Sydney, Australia</span>, <span class="seriesInfo">DOI 10.1109/LCN48667.2020.9314809</span>, <time datetime="2020-11" class="refDate">November 2020</time>, <span>&lt;<a href="https://ieeexplore.ieee.org/document/9314809">https://ieeexplore.ieee.org/document/9314809</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="authors-addresses">
<section id="appendix-A">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Martin Langer</span></div>
<div dir="auto" class="left"><span class="org">Ostfalia University of Applied Sciences</span></div>
<div dir="auto" class="left"><span class="street-address">Salzdahlumer Straße 46/48</span></div>
<div dir="auto" class="left">
<span class="postal-code">38302</span> <span class="locality">Wolfenbüttel</span>
</div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:mart.langer@ostfalia.de" class="email">mart.langer@ostfalia.de</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Rainer Bermbach</span></div>
<div dir="auto" class="left"><span class="org">Ostfalia University of Applied Sciences</span></div>
<div dir="auto" class="left"><span class="street-address">Salzdahlumer Straße 46/48</span></div>
<div dir="auto" class="left">
<span class="postal-code">38302</span> <span class="locality">Wolfenbüttel</span>
</div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:r.bermbach@ostfalia.de" class="email">r.bermbach@ostfalia.de</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
