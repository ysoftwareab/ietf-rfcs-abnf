cmsgptr = CMSG_NXTHDR(&msg, cmsgptr)) {
ptr = CMSG_DATA(cmsgptr);
total = CMSG_SPACE(sizeof (struct sctp_sndrcvinfo)) +
           CMSG_SPACE(sizeof (struct in6_pktinfo));

buf = malloc(total);

snp = buf;

sac = &snp->sn_assoc_change;
ssf = &snp->sn_send_failed;
spc = &snp->sn_paddr_change;
sin = (struct sockaddr_in *)&spc->spc_aaddr;
ap = inet_ntop(AF_INET, &sin->sin_addr,
                              addrbuf, INET6_ADDRSTRLEN);
sin6 = (struct sockaddr_in6 *)&spc->spc_aaddr;
ap = inet_ntop(AF_INET6, &sin6->sin6_addr,
                              addrbuf, INET6_ADDRSTRLEN);
sre = &snp->sn_remote_error;
nnr = recvmsg(fd, msg, 0);
buf = realloc(buf, *buflen * 2);
buflen = BUFLEN;
cmsg = (struct cmsghdr *)cbuf;
sri = (struct sctp_sndrcvinfo *)(cmsg + 1);

