<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Automatic IP Multicast Without Explicit Tunnels
    (AMT)</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Automatic IP Multicast Without Explicit Tunnels
    (AMT)">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">D. Thaler</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">M. Talwar</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">A. Aggarwal</td></tr>
<tr><td class="header">Expires: September 9, 2010</td><td class="header">Microsoft Corporation</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">L. Vicisano</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Qualcomm Inc.</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">T. Pusateri</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">!j</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">March 08, 2010</td></tr>
</table></td></tr></table>
<h1><br />Automatic IP Multicast Without Explicit Tunnels
    (AMT)<br />draft-ietf-mboned-auto-multicast-10</h1>

<h3>Abstract</h3>

<p>Automatic Multicast Tunneling (AMT) allows multicast communication
      amongst isolated multicast-enabled sites or hosts, attached to a network
      which has no native multicast support. It also enables them to exchange
      multicast traffic with the native multicast infrastructure and does not
      require any manual configuration. AMT uses an encapsulation interface so
      that no changes to a host stack or applications are required, all
      protocols (not just UDP) are handled, and there is no additional
      overhead in core routers.
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on September 9, 2010.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the BSD License.</p>
<p>
This document may contain material from IETF Documents or IETF
Contributions published or made publicly available before November
10, 2008.  The person(s) controlling the copyright in some of this
material may not have granted the IETF Trust the right to allow
modifications of such material outside the IETF Standards Process.
Without obtaining an adequate license from the person(s) controlling
the copyright in such materials, this document may not be modified
outside the IETF Standards Process, and derivative works of it may
not be created outside the IETF Standards Process, except to format
it for publication as an RFC or to translate it into languages other
than English.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#anchor2">2.</a>&nbsp;
Applicability<br />
<a href="#anchor3">3.</a>&nbsp;
Requirements notation<br />
<a href="#anchor4">4.</a>&nbsp;
Definitions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">4.1.</a>&nbsp;
AMT Pseudo-Interface<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">4.2.</a>&nbsp;
AMT Gateway<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">4.3.</a>&nbsp;
AMT Site<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">4.4.</a>&nbsp;
AMT Relay Router<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">4.5.</a>&nbsp;
AMT Relay Anycast Prefix<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">4.6.</a>&nbsp;
AMT Relay Anycast Address<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">4.7.</a>&nbsp;
AMT Subnet Anycast Prefix<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">4.8.</a>&nbsp;
AMT Gateway Anycast Address<br />
<a href="#anchor13">5.</a>&nbsp;
Overview<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">5.1.</a>&nbsp;
Receiving Multicast in an AMT Site<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">5.1.1.</a>&nbsp;
Scalability Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#spoofing">5.1.2.</a>&nbsp;
Spoofing Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor16">5.1.3.</a>&nbsp;
Protocol Sequence for a Gateway Joining SSM Receivers to a Relay<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor17">5.2.</a>&nbsp;
Sourcing Multicast from an AMT site<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">5.2.1.</a>&nbsp;
Supporting Site-MBone Multicast<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor19">5.2.2.</a>&nbsp;
Supporting Site-Site Multicast<br />
<a href="#anchor20">6.</a>&nbsp;
Message Formats<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor21">6.1.</a>&nbsp;
AMT Relay Discovery<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor22">6.1.1.</a>&nbsp;
Type<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor23">6.1.2.</a>&nbsp;
Reserved<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor24">6.1.3.</a>&nbsp;
Discovery Nonce<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor25">6.2.</a>&nbsp;
AMT Relay Advertisement<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor26">6.2.1.</a>&nbsp;
Type<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor27">6.2.2.</a>&nbsp;
Reserved<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor28">6.2.3.</a>&nbsp;
Discovery Nonce<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor29">6.2.4.</a>&nbsp;
Relay Address<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor30">6.3.</a>&nbsp;
AMT Request<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor31">6.3.1.</a>&nbsp;
Type<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor32">6.3.2.</a>&nbsp;
Reserved<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor33">6.3.3.</a>&nbsp;
Request Nonce<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor34">6.4.</a>&nbsp;
AMT Membership Query<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor35">6.4.1.</a>&nbsp;
Type<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor36">6.4.2.</a>&nbsp;
Reserved<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor37">6.4.3.</a>&nbsp;
Response MAC<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor38">6.4.4.</a>&nbsp;
Request Nonce<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor39">6.4.5.</a>&nbsp;
IGMP/MLD Query (including IP Header)<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor40">6.5.</a>&nbsp;
AMT Membership Update<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor41">6.5.1.</a>&nbsp;
Type<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor42">6.5.2.</a>&nbsp;
Reserved<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor43">6.5.3.</a>&nbsp;
Response MAC<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor44">6.5.4.</a>&nbsp;
Request Nonce<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor45">6.5.5.</a>&nbsp;
IGMP/MLD Message (including IP Header)<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor46">6.6.</a>&nbsp;
AMT IP Multicast Data<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor47">6.6.1.</a>&nbsp;
Type<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor48">6.6.2.</a>&nbsp;
Reserved<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor49">6.6.3.</a>&nbsp;
IP Multicast Data<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor50">6.7.</a>&nbsp;
AMT Membership Teardown<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor51">6.7.1.</a>&nbsp;
Type<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor52">6.7.2.</a>&nbsp;
Reserved<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor53">6.7.3.</a>&nbsp;
Original Response MAC<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor54">6.7.4.</a>&nbsp;
Original Request Nonce<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor55">6.7.5.</a>&nbsp;
Original Source Port<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor56">6.7.6.</a>&nbsp;
Source AFI<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor57">6.7.7.</a>&nbsp;
Original Source Address<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor58">6.7.8.</a>&nbsp;
IGMP/MLD Message (including IP Header)<br />
<a href="#amtgw">7.</a>&nbsp;
AMT Gateway Details<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor59">7.1.</a>&nbsp;
At Startup Time<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#gwsg">7.2.</a>&nbsp;
Gateway Group and Source Addresses<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ipv4prefix">7.2.1.</a>&nbsp;
IPv4<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ipv6prefix">7.2.2.</a>&nbsp;
IPv6<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor60">7.3.</a>&nbsp;
Joining Groups with MBone Sources<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor61">7.4.</a>&nbsp;
Responding to Relay Changes<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor62">7.5.</a>&nbsp;
Joining SSM Groups with AMT Gateway Sources<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor63">7.6.</a>&nbsp;
Receiving AMT Membership Updates by the Gateway<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor64">7.7.</a>&nbsp;
Sending data to SSM groups<br />
<a href="#anchor65">8.</a>&nbsp;
Relay Router Details<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor66">8.1.</a>&nbsp;
At Startup time<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor67">8.2.</a>&nbsp;
Receiving Relay Discovery messages sent to the Anycast Address<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor68">8.3.</a>&nbsp;
Receiving Membership Updates from AMT Gateways<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor69">8.4.</a>&nbsp;
Receiving (S,G) Joins from the Native Side, for AMT Sources<br />
<a href="#anchor70">9.</a>&nbsp;
IANA Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor71">9.1.</a>&nbsp;
IPv4 and IPv6 Anycast Prefix Allocation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor72">9.1.1.</a>&nbsp;
IPv4<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor73">9.1.2.</a>&nbsp;
IPv6<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor74">9.2.</a>&nbsp;
IPv4 and IPv6 AMT Subnet Prefix Allocation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor75">9.2.1.</a>&nbsp;
IPv4<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor76">9.2.2.</a>&nbsp;
IPv6<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor77">9.3.</a>&nbsp;
UDP Port number<br />
<a href="#anchor78">10.</a>&nbsp;
Security Considerations<br />
<a href="#anchor79">11.</a>&nbsp;
Contributors<br />
<a href="#anchor80">12.</a>&nbsp;
Acknowledgments<br />
<a href="#rfc.references1">13.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">13.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">13.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>The primary goal of this document is to foster the deployment of
native IP multicast by enabling a potentially large number of nodes
to connect to the already present multicast infrastructure.
Therefore, the techniques discussed here should be viewed as an
interim solution to help in the various stages of the transition to
a native multicast network.
</p>
<p>To allow fast deployment, the solution presented here only requires
small and concentrated changes to the network infrastructure, and no
changes at all to user applications or to the socket API of end-
nodes' operating systems.  The protocol introduced in this
specification can be deployed in a few strategically-placed network
nodes and in user-installable software modules (pseudo device
drivers and/or user-mode daemons) that reside underneath the socket
API of end-nodes' operating systems.  This mechanism is very similar
to that used by "6to4" <a class='info' href='#RFC3056'>[RFC3056]<span> (</span><span class='info'>Carpenter, B. and K. Moore, &ldquo;Connection of IPv6 Domains via IPv4 Clouds,&rdquo; February&nbsp;2001.</span><span>)</span></a>, <a class='info' href='#RFC3068'>[RFC3068]<span> (</span><span class='info'>Huitema, C., &ldquo;An Anycast Prefix for 6to4 Relay Routers,&rdquo; June&nbsp;2001.</span><span>)</span></a>
to get automatic IPv6 connectivity.
</p>
<p>Effectively, AMT treats the unicast-only inter-network as a large
non-broadcast multi-access (NBMA) link layer, over which we require
the ability to multicast.  To do this, multicast packets being sent
to or from a site must be encapsulated in unicast packets.  If the
group has members in multiple sites, AMT encapsulation of the same
multicast packet will take place multiple times by necessity.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Applicability</h3>

<p>AMT is not a substitute for native multicast or a statically configured
	multicast tunnel for high traffic flow. Unicast replication is required
	to reach multiple receivers that are not part of the native multicast
	infrastructure. Unicast replication is also required by non-native sources
	to different parts of the native multicast infrastructure. However, this
	is no worse than regular unicast distribution of streams and in most cases
	much better.
</p>
<p>The following problems are addressed:
</p>
<p>
</p>
<ol class="text">
<li>Allowing isolated sites/hosts to receive the SSM flavor of multicast (<a class='info' href='#RFC4607'>[RFC4607]<span> (</span><span class='info'>Holbrook, H. and B. Cain, &ldquo;Source-Specific Multicast for IP,&rdquo; August&nbsp;2006.</span><span>)</span></a>).
</li>
<li>Allowing isolated non-NAT sites/hosts to transmit the SSM flavor of multicast.
</li>
<li>Allowing isolated sites/hosts to receive general multicast (ASM
        <a class='info' href='#RFC1112'>[RFC1112]<span> (</span><span class='info'>Deering, S., &ldquo;Host extensions for IP multicasting,&rdquo; August&nbsp;1989.</span><span>)</span></a>).
</li>
</ol><p>

</p>
<p>This document does not address allowing isolated sites/hosts to
transmit general multicast.  We expect that other solutions (e.g.,
Tunnel Brokers, a la <a class='info' href='#RFC3053'>[RFC3053]<span> (</span><span class='info'>Durand, A., Fasano, P., Guardini, I., and D. Lento, &ldquo;IPv6 Tunnel Broker,&rdquo; January&nbsp;2001.</span><span>)</span></a>) will be used for sites that desire
this capability.
</p>
<p>Implementers should be aware that site administrators may have
configured administratively scoped multicast boundaries and a remote
gateway may provide a means to circumvent administrative boundaries.
Therefore, implementations should allow for the configuration of
such boundaries on relays and gateways and perform filtering as needed.
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Requirements notation</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
  "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
  document are to be interpreted as described in 
  <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Definitions</h3>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
 +---------------+        Internet            +---------------+
 | AMT Site      |                            | Native MCast  |
 |               |                            |               |
 |        +------+----+         AMT      +----+----+ AMT      |
 |        |AMT Gateway|         Anycast  |AMT Relay| Subnet   |
 |        |     +-----+-+       Prefix +-+-----+   | Prefix   |
 |        |     |AMT IF | &lt;------------|AMT IF |   |--------&gt; |
 |        |     +-----+-+              +-+-----+   |          |
 |        +------+----+                  +----+----+          |
 |               |                            |               |
 +---------------+                            +---------------+
</pre></div>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
AMT Pseudo-Interface</h3>

<p>AMT encapsulation of multicast packets inside unicast packets
occurs at a point that is logically equivalent to an interface,
with the link layer being the unicast-only network.  This point
is referred to as a pseudo-interface. Some implementations may 
treat it exactly like any other interface and others may treat
it like a tunnel end-point.
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
AMT Gateway</h3>

<p>A host, or a site gateway router, supporting an AMT Pseudo-
Interface.  It does not have native multicast connectivity to
the native multicast backbone infrastructure.  It is simply
referred to in this document as a "gateway".
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
AMT Site</h3>

<p>A multicast-enabled network not connected to the multicast
backbone served by an AMT Gateway.  It could also be a stand-
alone AMT Gateway.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4"></a><h3>4.4.&nbsp;
AMT Relay Router</h3>

<p>A multicast router configured to support transit routing
between AMT Sites and the native multicast backbone
infrastructure.  The relay router has one or more interfaces
connected to the native multicast infrastructure, zero or more
interfaces connected to the non-multicast capable inter-network,
and an AMT pseudo-interface.  It is simply referred to in this
document as a "relay".
</p>
<p>As with <a class='info' href='#RFC3056'>[RFC3056]<span> (</span><span class='info'>Carpenter, B. and K. Moore, &ldquo;Connection of IPv6 Domains via IPv4 Clouds,&rdquo; February&nbsp;2001.</span><span>)</span></a>, we assume that normal multicast routers do not
want to be tunnel endpoints (especially if this results in high
fan out), and similarly that service providers do not want
encapsulation to arbitrary routers.  Instead, we assume that
special-purpose routers will be deployed that are suitable for
serving as relays.
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5"></a><h3>4.5.&nbsp;
AMT Relay Anycast Prefix</h3>

<p>A well-known address prefix used to advertise (into the unicast
routing infrastructure) a route to an available AMT Relay
Router. This could also be private (i.e., not well-known) for a
private relay.
</p>
<p>Prefixes for both IPv4 and IPv6 will be assigned in a future
version of this draft.
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.6"></a><h3>4.6.&nbsp;
AMT Relay Anycast Address</h3>

<p>An anycast address which is used to reach the nearest AMT Relay
            Router.
</p>
<p>This address corresponds to the setting the low-order octet of
the AMT Relay Anycast Prefix to 1 (for both IPv4 and IPv6).
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.7"></a><h3>4.7.&nbsp;
AMT Subnet Anycast Prefix</h3>

<p>A well-known address prefix used to advertise (into the M-RIB
of the native multicast-enabled infrastructure) a route to AMT
Sites.  This prefix will be used to enable sourcing SSM traffic
from an AMT Gateway.
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.8"></a><h3>4.8.&nbsp;
AMT Gateway Anycast Address</h3>

<p>An anycast address in the AMT Subnet Anycast Prefix range, which is
            used by an AMT Gateway to enable sourcing SSM traffic from
            local applications.
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Overview</h3>

<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Receiving Multicast in an AMT Site</h3>
<br /><hr class="insert" />
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
                            Internet
 +---------------+                            +---------------+
 | AMT Site      |     2. 3-way Membership    | MBone         |
 |               |          Handshake         |               |
 |   1. Join +---+---+ =================&gt; +---+---+           |
 |     +----&gt;|Gateway|                    | Relay |           |
 |     |     +---+---+ &lt;================= +---+---+           |
 |   R-+         |       3. Receive Data      |               |
 +---------------+                            +---------------+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Receiving Multicast in an AMT Site&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>AMT relays and gateways cooperate to transmit multicast traffic
sourced within the native multicast infrastructure to AMT sites:
relays receive the traffic natively and unicast-encapsulate it to
gateways; gateways decapsulate the traffic and possibly forward it
into the AMT site.
</p>
<p>Each gateway has an AMT pseudo-interface that serves as a default
multicast route.  Requests to join a multicast session are sent to
this interface and encapsulated to a particular relay reachable
across the unicast-only infrastructure.
</p>
<p>Each relay has an AMT pseudo-interface too.  Multicast traffic sent
on this interface is encapsulated to zero or more gateways that have
joined to the relay.  The AMT recipient-list is determined for each
multicast session.  This requires the relay to keep state for each
gateway which has joined a particular group or (source, group)
pair.  Multicast packets from the native infrastructure behind the
relay will be sent to each gateway which has requested them.
</p>
<p>All multicast packets (data and control) are encapsulated in unicast
    packets. UDP encapsulation is used for all AMT control and data packets
    using the IANA reserved UDP port number for AMT.
</p>
<p>Each relay, plus the set of all gateways using the relay, together
    are thought of as being on a separate logical NBMA link.  This
    implies that the AMT recipient-list is a list of "link layer"
    addresses which are (IP address, UDP port) pairs.
</p>
<p>Since the number of gateways using a relay can be quite large, and
we expect that most sites will not want to receive most groups, an
explicit-joining protocol is required for gateways to communicate
group membership information to a relay.  The two most likely
candidates are the IGMP/MLD protocol <a class='info' href='#RFC3376'>[RFC3376]<span> (</span><span class='info'>Cain, B., Deering, S., Kouvelas, I., Fenner, B., and A. Thyagarajan, &ldquo;Internet Group Management Protocol, Version 3,&rdquo; October&nbsp;2002.</span><span>)</span></a>, <a class='info' href='#RFC3810'>[RFC3810]<span> (</span><span class='info'>Vida, R. and L. Costa, &ldquo;Multicast Listener Discovery Version 2 (MLDv2) for IPv6,&rdquo; June&nbsp;2004.</span><span>)</span></a>, and the PIM-Sparse Mode protocol
<a class='info' href='#RFC4601'>[RFC4601]<span> (</span><span class='info'>Fenner, B., Handley, M., Holbrook, H., and I. Kouvelas, &ldquo;Protocol Independent Multicast - Sparse Mode (PIM-SM): Protocol Specification (Revised),&rdquo; August&nbsp;2006.</span><span>)</span></a>. Since an AMT gateway may be a host,
and hosts typically do not implement routing protocols, gateways will use
IGMP/MLD as described in <a class='info' href='#amtgw'>Section&nbsp;7<span> (</span><span class='info'>AMT Gateway Details</span><span>)</span></a> below.  This allows a
host kernel (or a pseudo device driver) to easily implement AMT gateway
behavior, and obviates the relay from the need to know whether a given
gateway is a host or a router.  From the relay's perspective, all gateways
are indistinguishable from hosts on an NBMA leaf network.
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.1"></a><h3>5.1.1.&nbsp;
Scalability Considerations</h3>

<p>It is possible that millions of hosts will enable AMT gateway
functionality and so an important design goal is not to create
gateway state in each relay until the gateway joins a multicast
group.  But even the requirement that a relay keep group state per
gateway that has joined a group introduces potential scalability
concerns.
</p>
<p>Scalability of AMT can be achieved by adding more relays,
and using an appropriate relay discovery mechanism for gateways to
discover relays.  The solution we adopt is to assign addresses
in anycast fashion to relays <a class='info' href='#RFC1546'>[RFC1546]<span> (</span><span class='info'>Partridge, C., Mendez, T., and W. Milliken, &ldquo;Host Anycasting Service,&rdquo; November&nbsp;1993.</span><span>)</span></a>,
<a class='info' href='#RFC4291'>[RFC4291]<span> (</span><span class='info'>Hinden, R. and S. Deering, &ldquo;IP Version 6 Addressing Architecture,&rdquo; February&nbsp;2006.</span><span>)</span></a>.  However, simply sending periodic membership
reports to an anycast address can cause duplicates.  Specifically,
if routing changes such that a different relay receives a periodic
membership report, both the new and old relays will encapsulate
data to the AMT site until the old relay's state times out.  This
is obviously undesirable.  Instead, we use the anycast address
merely to find the unicast address of a relay to which membership
reports are sent.
</p>
<p>Since adding another relay has the result of adding another
independent NBMA link, this allows the gateways to be spread out
among more relays so as to keep the number of gateways per relay at
a reasonable level.
</p>
<a name="spoofing"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.2"></a><h3>5.1.2.&nbsp;
Spoofing Considerations</h3>

<p>An attacker could affect the group state in the relay or gateway
by spoofing the source address in the join or leave reports. This
can be used to launch reflection or denial of service attacks on
the target. Such attacks can be mitigated by using a three way
handshake between the gateway and the relay for each multicast
membership report or leave.
</p>
<p>When a gateway or relay wants to send a membership report, it first
sends an AMT Request with a request nonce in it. The receiving side
(the respondent) can calculate a message authentication code (MAC)
based on (for example) the source IP address of the Request, the
source UDP port, the request nonce, and a secret key known only to
the respondent.  The algorithm and the input used to calculate the
MAC does not have to be standardized since the respondent generates
and verifies the MAC and the originator simply echoes it.
</p>
<p>An AMT Membership Query is sent back including the request nonce
and the MAC to the originator of the Request. The originator then
sends the IGMP/MLD Membership/Listener Report or Leave/Done (including
the IP Header) along
with the request nonce and the received MAC back to the respondent
finalizing the 3-way handshake.
</p>
<p>Upon reception, the respondent can recalculate the MAC based on the
source IP address, the source UDP port, the request nonce, and the
local secret. The IGMP/MLD message is only accepted if the received
MAC matches the calculated MAC.
</p>
<p>The local secret never has to be shared with the other side.  It
is only used to verify return routability of the originator.
</p>
<p>Since the same Request Nonce and source IP address can be re-used,
  the receiver SHOULD change its secret key at least once per hour.
  However, AMT Membership updates received with the previous secret MUST
  be accepted for up to the IGMP/MLD Query Interval.
</p>
<p>The condition might occur where the gateway or relay that initially sent the AMT Request dynamically changes its IP address. This might occur due to a change in wireless networks, a DHCP assignment, or another network failure. When this occurs, it is no longer possible to verify the MAC using the source address and source port. Though, in order to reduce state, it is desirable to tear down the state that was created with the old source address. A Teardown message with special considerations for calculating the MAC is described below to perform this function.
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.3"></a><h3>5.1.3.&nbsp;
Protocol Sequence for a Gateway Joining SSM Receivers to a Relay</h3>

<p>This description assumes the Gateway can be a host joining as a receiver
or a network device acting as a Gateway when a directly connected host
joins as a receiver.
</p>
<p>
</p>
<ul class="text">
<li>Receiver at AMT site sends IGMPv3/MLDv2 report joining (S1,G1).
</li>
<li>Gateway receives report. If it has no tunnel state with a Relay, it originates
    an AMT Relay Discovery message addressed to the Anycast Relay IP
    address. The AMT Relay Discovery message can be sent on demand if no relay
    is known at this time or at startup and be periodically refreshed.
</li>
<li>The closest Relay topologically receives the AMT Relay Discovery message
    and returns the nonce from the Discovery in an AMT Relay Advertisement
    message so the Gateway can learn of the Relay's unique IP address.
</li>
<li>When the Gateway receives the AMT Relay Advertisement message, it now has
    an address to use for all subsequent (S,G) entries it will join on behalf
    of attached receivers (or itself).
</li>
<li>If the gateway has a valid Response MAC from a previous AMT Query message,
    it can send an AMT Membership Update message as described below. Otherwise,
    the Gateway sends an AMT Request message to the Relay's unique IP
    address to begin the process of joining the (S,G). The gateway also SHOULD
    initialize a timer used to send periodic Requests to a random value from the 
    interval [0, [Query Interval]] before sending the first periodic report, in
    order to prevent startup synchronization.
</li>
<li>The Relay responds to the AMT Request message by returning the nonce from
    the Request in a AMT Query message. The Query message contains an IGMP/MLD
    QUERY indicating how often the Gateway should repeat AMT Request messages
    so the (S,G) state can stay refreshed in the Relay. The Query message also
    includes an opaque security code which is generated locally (with no
    external coordination).
</li>
<li>When the Gateway receives the AMT Query message it responds by copying
    the security code from the AMT Query message into a AMT Membership Update
    message. The Update message contains (S1,G1) in an IGMPv3/MLDv2
    formatted packet with an IP header. The nonce from the AMT Request is also
    included in the AMT Membership Update message.
</li>
<li>When the Relay receives the AMT Membership Update, it will add the tunnel
    to the Gateway in it's outgoing interface list for it's (S1,G1) entry
    stored in the multicast routing table. If the (S1,G1) entry was created
    do to this interaction, the multicast routing protocol running on the
    Relay will trigger a Join message towards source S1 to build a native
    multicast tree in the native multicast infrastructure.
</li>
<li>As packets are sent from the host S1, they will travel natively down the
    multicast tree associated with (S1,G1) in the native multicast
    infrastructure to the Relay. The Relay will replicate to all interfaces
    in it's outgoing interface list as well as the tunnel outgoing interface,
    which is encapsulated in a unicast AMT Multicast Data message.
</li>
<li>When the Gateway receives the AMT Multicast Data message, it will accept
    the packet since it was received over the pseudo-interface associated
    with the tunnel to the Relay it had attached to, and forward the packet
    to the outgoing interfaces joined by any attached receiver hosts (or
    deliver the packet to the application when the Gateway is the receiver).
</li>
<li>If later (S2,G2) is joined by a receiver, a 3-way handshake of Request/
    Query/Update occurs for this entry. The Discovery/Advertisement exchange
    is not required.
</li>
<li>To keep the state for (S1,G1) and (S2,G2) alive in the Relay, the Gateway
    will send periodic AMT Membership Updates. The Membership Update can be sent
    directly if the sender has a valid nonce from a previous Request. If not,
    an AMT Request messages should be sent to solicit a Query Message. When sending
    a periodic state refresh, all joined state in the Gateway is packed in
    the fewest number of AMT Membership Update messages.
</li>
<li>When the Gateway leaves all (S,G) entries, the Relay can free resources
    associated with the tunnel. It is assumed that when the Gateway would
    want to join an (S,G) again, it would start the Discovery/Advertisement
    tunnel establishment process over again.
</li>
</ul><p>

</p>
<p>This same procedure would be used for receivers who operate in Any-Source Multicast (ASM) mode.
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Sourcing Multicast from an AMT site</h3>

<p>Two cases are discussed below: multicast traffic sourced in an AMT
site and received in the MBone, and multicast traffic sourced in an
AMT site and received in another AMT site.
</p>
<p>In both cases only SSM sources are supported.  Furthermore this
specification only deals with the source residing directly in the
gateway.  To enable a generic node in an AMT site to source
multicast, additional coordination between the gateway and the
source-node is required.
</p>
<p>The gateway SHOULD allow for filtering link-local and site-local traffic.
</p>
<p>The general mechanism used to join towards AMT sources is based on
    the following:
</p>
<p>
        </p>
<ol class="text">
<li>Applications residing in the gateway use addresses in the AMT
Subnet Anycast Prefix to send multicast, as a result of sourcing traffic on
the AMT pseudo-interface.
</li>
<li>The AMT Subnet Anycast Prefix is advertised for RPF
                reachability in the M-RIB by relays and gateways.
</li>
<li>Relays or gateways that receive a join for a source/group pair
use information encoded in the address pair to rebuild the address
of the gateway (source) to which to encapsulate the join (see
<a class='info' href='#gwsg'>Section&nbsp;7.2<span> (</span><span class='info'>Gateway Group and Source Addresses</span><span>)</span></a> for more details). The membership reports use the same
three way handshake as outlined in <a class='info' href='#spoofing'>Section&nbsp;5.1.2<span> (</span><span class='info'>Spoofing Considerations</span><span>)</span></a>
</li>
</ol><p>
    
</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2.1"></a><h3>5.2.1.&nbsp;
Supporting Site-MBone Multicast</h3>
<br /><hr class="insert" />
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
                             Internet
 +---------------+                            +---------------+
 | AMT Site      |     2. 3-way Membership    | MBone         |
 |               |           Handshake        |               |
 |           +---+---+ &lt;================= +---+---+ 1. Join   |
 |           |Gateway|                    | Relay |&lt;-----+    |
 |           +---+---+ =================&gt; +---+---+      |    |
 |               |      3. Receive Data       |          +-R  |
 +---------------+                            +---------------+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Site-MBone Multicast&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>If a relay receives an explicit join from the native infrastructure,
for a given (source, group) pair where the source address belongs to
the AMT Subnet Anycast Prefix, then the relay will periodically (using the
rules specified in <a class='info' href='#spoofing'>Section&nbsp;5.1.2<span> (</span><span class='info'>Spoofing Considerations</span><span>)</span></a>) encapsulate membership
updates for the
group to the gateway.  The gateway must keep state per relay from
which membership reports have been sent, and forward multicast traffic
from the site to all relays from which membership reports have been
received.  The choice of whether this state and replication is done
at the link-layer (i.e., by the tunnel interface) or at the
network-layer is implementation dependent.
</p>
<p>If there are multiple relays present, this ensures that data from
the AMT site is received via the closest relay to the receiver. This
is necessary when the routers in the native multicast infrastructure
employ Reverse-Path Forwarding (RPF) checks against the source
address, such as occurs when PIM Sparse-Mode
<a class='info' href='#RFC4601'>[RFC4601]<span> (</span><span class='info'>Fenner, B., Handley, M., Holbrook, H., and I. Kouvelas, &ldquo;Protocol Independent Multicast - Sparse Mode (PIM-SM): Protocol Specification (Revised),&rdquo; August&nbsp;2006.</span><span>)</span></a> is used by the multicast
infrastructure.
</p>
<p>The solution above will scale to an arbitrary number of relays, as
long at the number of relays requiring multicast traffic from a
given AMT site remains reasonable enough to not overly burden the
site's gateway.
</p>
<p>A source at or behind an AMT gateway requires the gateway to do the
replication to one or more relays and receiving gateways. If this places
too much of a burden on the sourcing gateway, the source should join the
native multicast infrastructure through a permanent tunnel so that
replication occurs within the native multicast infrastructure.
</p>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2.2"></a><h3>5.2.2.&nbsp;
Supporting Site-Site Multicast</h3>
<br /><hr class="insert" />
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
                            Internet
 +---------------+                            +---------------+
 | AMT Site      |     2. 3-way Membership    | AMT Site      |
 |               |          Handshake         |               |
 |           +---+---+ &lt;================= +---+---+ 1. Join   |
 |           |Gateway|                    |Gateway|&lt;-----+    |
 |           +---+---+ =================&gt; +---+---+      |    |
 |               |      3. Receive Data       |          +-R  |
 +---------------+                            +---------------+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Site-Site Multicast&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>Since we require gateways to accept membership reports, as described
above, it is also possible to support multicast among AMT sites,
without requiring assistance from any relays.
</p>
<p>When a gateway wants to join a given (source, group) pair, where the
source address belongs to the AMT Subnet Anycast Prefix, then the gateway
will periodically unicast encapsulate an IGMPv3/MLDv2 Report
<a class='info' href='#RFC3376'>[RFC3376]<span> (</span><span class='info'>Cain, B., Deering, S., Kouvelas, I., Fenner, B., and A. Thyagarajan, &ldquo;Internet Group Management Protocol, Version 3,&rdquo; October&nbsp;2002.</span><span>)</span></a>, <a class='info' href='#RFC3810'>[RFC3810]<span> (</span><span class='info'>Vida, R. and L. Costa, &ldquo;Multicast Listener Discovery Version 2 (MLDv2) for IPv6,&rdquo; June&nbsp;2004.</span><span>)</span></a>
(including IP Header) directly to the site gateway for the source.
</p>
<p>We note that this can result in a significant amount of state at a
site gateway sourcing multicast to a large number of other AMT
sites.  However, it is expected that this is not unreasonable for
two reasons.  First, the gateway does not have native multicast
connectivity, and as a result is likely doing unicast replication at
present.  The amount of state is thus the same as what such a site
already deals with. Secondly, any site expecting to source traffic
to a large number of sites could get a point-to-point tunnel to the
native multicast infrastructure, and use that instead of AMT.
</p>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Message Formats</h3>

<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
AMT Relay Discovery</h3>

<p>The AMT Relay Discovery message is a UDP packet sent from the AMT
gateway unicast address to the AMT relay anycast address to discover
the unicast address of an AMT relay.
</p>
<p>The UDP source port is uniquely selected by the local host
operating system. The UDP destination port is the IANA reserved
AMT port number. The UDP checksum MUST be valid in AMT control messages.
</p><br /><hr class="insert" />

<p>The payload of the UDP packet contains the following
                fields.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     Type=0x1  |     Reserved                                  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|            Discovery Nonce                                    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;AMT Relay Discovery&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1.1"></a><h3>6.1.1.&nbsp;
Type</h3>

<p>The type of the message.
</p>
<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1.2"></a><h3>6.1.2.&nbsp;
Reserved</h3>

<p>A 24-bit reserved field. Sent as 0, ignored on receipt.
</p>
<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1.3"></a><h3>6.1.3.&nbsp;
Discovery Nonce</h3>

<p>A 32-bit random value generated by the gateway and
                replayed by the relay.
</p>
<a name="anchor25"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
AMT Relay Advertisement</h3>

<p>The AMT Relay Advertisement message is a UDP packet sent from the
            AMT relay anycast address to the source of the discovery message.
</p>
<p>The UDP source port is the IANA reserved AMT port number and
    the UDP destination port is the source port received in the Discovery
    message. The UDP CHECKSUM MUST be valid in AMT control messages.
</p><br /><hr class="insert" />

<p>The payload of the UDP packet contains the following
                fields.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     Type=0x2  |     Reserved                                  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|            Discovery Nonce                                    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|            Relay Address                                      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;AMT Relay Advertisement&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor26"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2.1"></a><h3>6.2.1.&nbsp;
Type</h3>

<p>The type of the message.
</p>
<a name="anchor27"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2.2"></a><h3>6.2.2.&nbsp;
Reserved</h3>

<p>A 24-bit reserved field. Sent as 0, ignored on receipt.
</p>
<a name="anchor28"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2.3"></a><h3>6.2.3.&nbsp;
Discovery Nonce</h3>

<p>A 32-bit random value generated by the gateway and
                replayed by the relay.
</p>
<a name="anchor29"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2.4"></a><h3>6.2.4.&nbsp;
Relay Address</h3>

<p>The unicast IPv4 or IPv6 address of the AMT relay. The
                family can be determined by the length of the Advertisement.
</p>
<a name="anchor30"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.3"></a><h3>6.3.&nbsp;
AMT Request</h3>

<p>A Request packet is sent to begin a 3-way handshake for sending
an IGMP/MLD Membership/Listener Report or Leave/Done. It can be sent
from a gateway to a relay, from a gateway to another gateway,
or from a relay to a gateway.
</p>
<p>It is sent from the originator's unique unicast address to the
            respondents' unique unicast address.
</p>
<p>The UDP source port is uniquely selected by the local host
operating system. It can be different for each Request and different
from the source port used in Discovery messages but does not have to be.
The UDP destination port is the IANA reserved AMT port number.
The UDP checksum MUST be valid in AMT control messages.
</p><br /><hr class="insert" />
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     Type=0x3  |     Reserved                                  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|            Request Nonce                                      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;AMT Relay Advertisement&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor31"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.3.1"></a><h3>6.3.1.&nbsp;
Type</h3>

<p>The type of the message.
</p>
<a name="anchor32"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.3.2"></a><h3>6.3.2.&nbsp;
Reserved</h3>

<p>A 24-bit reserved field. Sent as 0, ignored on receipt.
</p>
<a name="anchor33"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.3.3"></a><h3>6.3.3.&nbsp;
Request Nonce</h3>

<p>A 32-bit identifier used to distinguish this request.
</p>
<a name="anchor34"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.4"></a><h3>6.4.&nbsp;
AMT Membership Query</h3>

<p>An AMT Membership Query packet is sent from the respondent back to the
            originator to solicit an AMT Membership Update while confirming the
            source of the original request. It contains a relay Message
            Authentication Code (MAC) that is a cryptographic hash of a
            private secret, the originators address, and the request nonce.
</p>
<p>It is sent from the destination address received in the Request
            to the source address received in the Request which is the same
            address used in the Relay Advertisement.
</p>
<p>The UDP source port is the IANA reserved AMT port number and
            the UDP destination port is the source port received in the
            Request message. The UDP checksum MUST be valid in AMT control
            messages.
</p><br /><hr class="insert" />
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     Type=0x4  |    Reserved   |         Response MAC          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|            Response MAC (continued)                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|            Request Nonce                                      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|            IGMP Membership Query or MLD Listener Query        |
|            (including IP Header)                              |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|            ...                                                |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;AMT Membership Query&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor35"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.4.1"></a><h3>6.4.1.&nbsp;
Type</h3>

<p>The type of the message.
</p>
<a name="anchor36"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.4.2"></a><h3>6.4.2.&nbsp;
Reserved</h3>

<p>A 8-bit reserved field. Sent as 0, ignored on receipt.
</p>
<a name="anchor37"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.4.3"></a><h3>6.4.3.&nbsp;
Response MAC</h3>

<p>A 48-bit hash generated by the respondent and sent to the
                originator for inclusion in the AMT Membership Update.
                The algorithm used for this is chosen by the respondent but
                an algorithm such as HMAC-MD5-48 <a class='info' href='#RFC2104'>[RFC2104]<span> (</span><span class='info'>Krawczyk, H., Bellare, M., and R. Canetti, &ldquo;HMAC: Keyed-Hashing for Message Authentication,&rdquo; February&nbsp;1997.</span><span>)</span></a>
                SHOULD be used at a minimum.
</p>
<a name="anchor38"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.4.4"></a><h3>6.4.4.&nbsp;
Request Nonce</h3>

<p>A 32-bit identifier used to distinguish this request
                echoed back to the originator.
</p>
<a name="anchor39"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.4.5"></a><h3>6.4.5.&nbsp;
IGMP/MLD Query (including IP Header)</h3>

<p>The message contains either an IGMP Query or an MLD Multicast
                Listener Query. The IGMP or MLD version sent should default
		to IGMPv3 or MLDv2 unless explicitly configured to use IGMPv2
		or MLDv1.  The IGMP/MLD Query includes a full
                IP Header. The IP source address of the query would match
                the anycast address on the pseudo interface. The TTL of the
                outer header should be sufficient to reach the tunnel endpoint
                and not mimic the inner header TTL which is typically 1
                for IGMP/MLD messages.
</p>
<a name="anchor40"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.5"></a><h3>6.5.&nbsp;
AMT Membership Update</h3>

<p>An AMT Membership Update is sent to report a membership after a valid
            Response MAC has been received.
            It contains the original IGMP/MLD Membership/Listener
            Report or Leave/Done received over the AMT pseudo-interface
	          including the original IP header.
            It echoes the Response MAC received in the AMT Membership Query
            so the respondent can verify return routability to the
            originator.
</p>
<p>It is sent from the destination address received in the Query
            to the source address received in the Query which should both
            be the same as the original Request.
</p>
<p>The UDP source and destination port numbers should be the same
            ones sent in the original Request.
</p>
<p>The relay is not required to use the IP source address of the IGMP Membership Report for any particular purpose.
</p>
<p>The same Request Nonce and Response MAC can be used across multiple AMT
	  Membership Update messages without having to send individual AMT Membership
	  Query messages.
</p><br /><hr class="insert" />
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     Type=0x5  |    Reserved   |         Response MAC          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|            Response MAC (continued)                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|            Request Nonce                                      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|            IGMP or MLD Message (including IP header)          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|            ...                                                |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;AMT Membership Update&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor41"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.5.1"></a><h3>6.5.1.&nbsp;
Type</h3>

<p>The type of the message.
</p>
<a name="anchor42"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.5.2"></a><h3>6.5.2.&nbsp;
Reserved</h3>

<p>A 8-bit reserved field. Sent as 0, ignored on receipt.
</p>
<a name="anchor43"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.5.3"></a><h3>6.5.3.&nbsp;
Response MAC</h3>

<p>The 48-bit MAC received in the Membership Query and
                echoed back in the Membership Update.
</p>
<a name="anchor44"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.5.4"></a><h3>6.5.4.&nbsp;
Request Nonce</h3>

<p>A 32-bit identifier used to distinguish this request.
</p>
<a name="anchor45"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.5.5"></a><h3>6.5.5.&nbsp;
IGMP/MLD Message (including IP Header)</h3>

<p>The message contains either an IGMP Membership Report, an IGMP
                Membership Leave, an MLD Multicast Listener Report, or an
                MLD Listener Done. The IGMP or MLD version sent should be
                in response the version of the query received in the AMT
                Membership Query. The IGMP/MLD Message includes a full
                IP Header.
</p>
<a name="anchor46"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.6"></a><h3>6.6.&nbsp;
AMT IP Multicast Data</h3>

<p>The AMT Data message is a UDP packet encapsulating the IP Multicast
            data requested by the originator based on a previous AMT Membership
            Update message.
</p>
<p>It is sent from the unicast destination address of the Membership
            update to the source address of the Membership Update.
</p>
<p>The UDP source and destination port numbers should be the same
            ones sent in the original Query. The UDP checksum MUST be valid
			in AMT control messages.
</p><br /><hr class="insert" />

<p>The payload of the UDP packet contains the following
                fields.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     Type=0x6  |    Reserved   |     IP Multicast Data ...     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|            ...                                                |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;AMT IP Multicast Data&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor47"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.6.1"></a><h3>6.6.1.&nbsp;
Type</h3>

<p>The type of the message.
</p>
<a name="anchor48"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.6.2"></a><h3>6.6.2.&nbsp;
Reserved</h3>

<p>An 8-bit reserved field. Sent as 0, ignored on receipt.
</p>
<a name="anchor49"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.6.3"></a><h3>6.6.3.&nbsp;
IP Multicast Data</h3>

<p>The original IP Multicast data packet that is being
                replicated by the relay to the gateways including the
                original IP header.
</p>
<a name="anchor50"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.7"></a><h3>6.7.&nbsp;
AMT Membership Teardown</h3>

<p>An AMT Membership Teardown is sent to report an IGMP Membership
	        Leave or MLD Listener Done after a valid Response MAC has been 		
			received and after the source address that was used to generate
			the Response MAC is no longer available for sourcing packets.
</p>
<p>An AMT Membership Teardown from the original source address and
			source port is NOT valid and should be discarded if received.
			Use an AMT Membership Update instead.
</p>
<p>An AMT Membership Teardown can only contain either an IGMP
			Membership Leave or an MLD Listener Done message. The
			encapsulated IGMP/MLD message will have to be fabricated by
			the sender of the AMT Membership Teardown in the case where
			there wasn't an original IGMP/MLD message to be forwarded.
</p>
<p>In order for the receiver to verify the Membership Teardown
		    message, it must contain the original source address and source
		    port in addition to the Original Request Nonce and Original 
			Response MAC.
</p>
<p>It is sent to the source address received in the original Query
	 		which should be the same as the original Request.
</p>
<p>The UDP destination port number should be the same
            one sent in the original Request.
</p>
<p>The relay is not required to use the IP source address of the
		    IGMP Membership Report for any particular purpose.
</p><br /><hr class="insert" />
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     Type=0x7  |    Reserved   |    Original Response MAC      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|            Original Response MAC (continued)                  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|            Original Request Nonce                             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     Original Source Port      |         Source AFI            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|            Original Source Address                            |
|            ...                                                |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|            IGMP Membership Leave or                           |
|            MLD Listener Done (including IP header)            |
|            ...                                                |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;AMT Membership Teardown&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor51"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.7.1"></a><h3>6.7.1.&nbsp;
Type</h3>

<p>The type of the message.
</p>
<a name="anchor52"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.7.2"></a><h3>6.7.2.&nbsp;
Reserved</h3>

<p>A 8-bit reserved field. Sent as 0, ignored on receipt.
</p>
<a name="anchor53"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.7.3"></a><h3>6.7.3.&nbsp;
Original Response MAC</h3>

<p>The 48-bit MAC received in the Membership Query and
                echoed back in the Membership Update.
</p>
<a name="anchor54"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.7.4"></a><h3>6.7.4.&nbsp;
Original Request Nonce</h3>

<p>A 32-bit identifier used to distinguish this request.
</p>
<a name="anchor55"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.7.5"></a><h3>6.7.5.&nbsp;
Original Source Port</h3>

<p>The 16-bit port number used in the original AMT Membership
	            update that was used to generate the Original Response
	 			MAC.
</p>
<a name="anchor56"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.7.6"></a><h3>6.7.6.&nbsp;
Source AFI</h3>

<p>A 16-bit Address Family Identifier (AFI)
				<a class='info' href='#RFC4760'>[RFC4760]<span> (</span><span class='info'>Bates, T., Chandra, R., Katz, D., and Y. Rekhter, &ldquo;Multiprotocol Extensions for BGP-4,&rdquo; January&nbsp;2007.</span><span>)</span></a> used to determine the protocol
				address family of the following Original Source Address.
</p>
<p>Presently defined values for the Address Family Identifier
				field are specified in IANA's
				<a class='info' href='#IANA.AFN'>Address Family Numbers registry<span> (</span><span class='info'>IANA, &ldquo;Address Family Numbers,&rdquo; .</span><span>)</span></a> [IANA.AFN]
				
</p>
<a name="anchor57"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.7.7"></a><h3>6.7.7.&nbsp;
Original Source Address</h3>

<p>The source address used in the original AMT Membership
			    update that was used to generate the Original Response
			 	MAC.
</p>
<a name="anchor58"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.7.8"></a><h3>6.7.8.&nbsp;
IGMP/MLD Message (including IP Header)</h3>

<p>The message contains either an IGMP Membership Leave or an
                MLD Listener Done. The IGMP or MLD version sent should be
                in response the version of the query received in the
				original AMT Membership Query. The IGMP/MLD Message includes
				a full IP Header.
</p>
<a name="amtgw"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
AMT Gateway Details</h3>

<p>This section details the behavior of an AMT Gateway, which may be a
    router serving an AMT site, or the site may consist of a single
    host, serving as its own gateway.
</p>
<a name="anchor59"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.1"></a><h3>7.1.&nbsp;
At Startup Time</h3>

<p>At startup time, the AMT gateway will bring up an AMT pseudo-
        interface to be used for encapsulation.  The gateway needs to discover
        an AMT Relay to send Membership Requests. It can send an AMT Relay Discovery
        at startup time or wait until it has a group membership to report. The
        AMT Relay Discovery message is sent to the AMT Relay Anycast Address.
        A unicast address (which is treated as a link-layer address
        to the encapsulation interface) is received in the AMT Relay Advertisement
        message. The discovery process SHOULD be done periodically (e.g., once a
        day) to re-resolve the unicast address of a close relay. To prevent startup
        synchronization, the timer SHOULD use at least 10 percent jitter.
</p>
<p>If the gateway is serving as a local router, it SHOULD also
            function as an IGMP/MLD Proxy, as described in
            <a class='info' href='#RFC4605'>[RFC4605]<span> (</span><span class='info'>Fenner, B., He, H., Haberman, B., and H. Sandick, &ldquo;Internet Group Management Protocol (IGMP) / Multicast Listener Discovery (MLD)-Based Multicast Forwarding (&quot;IGMP/MLD Proxying&quot;),&rdquo; August&nbsp;2006.</span><span>)</span></a>, with its
        IGMP/MLD host-mode interface being the AMT pseudo-interface.  This
        enables it to translate group memberships on its downstream
        interfaces into IGMP/MLD Reports. Hosts receiving multicast packets
        through an AMT gateway acting as a proxy should ensure that their
	M-RIB accepts multicast packets from the AMT gateway for the sources
	it is joining.
</p>
<a name="gwsg"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.2"></a><h3>7.2.&nbsp;
Gateway Group and Source Addresses</h3>

<p>To support sourcing traffic to SSM groups by a gateway
            with a global unicast address, the AMT Subnet Anycast Prefix is
            treated as the subnet prefix of the AMT pseudo-interface, and
            an anycast address is added on the interface.  This anycast
            address is formed by concatenating the AMT Subnet Anycast Prefix
            followed by the high bits of the gateway's global unicast
            address.
</p>
<p>The remaining bits of its global unicast address are
        appended to the SSM prefix to create the group address and any spare
	bits may be allocated using local policy.
</p>
<p>If a gateway wants to source multicast traffic, it must select the gateway source address and SSM group address in such a way that the AMT relay can have enough information to reconstruct the gateway's unicast address when it receives an SSM join for the source.
</p>
<p>Note that multiple gateways might end up with the same anycast address assigned to their pseudo-interfaces.
</p>
<a name="ipv4prefix"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.2.1"></a><h3>7.2.1.&nbsp;
IPv4</h3>

<p>For example, if IANA assigns the IPv4 prefix x.y/16 as the AMT
            Subnet Anycast Prefix, and the gateway has global unicast address a.b.c.d,
            then the AMT Gateway's Anycast Source Address will be x.y.a.b.
            Since the
            IPv4 SSM group range is 232/8, it MUST allocate IPv4 SSM groups in
            the range 232.c.d/24.
</p><br /><hr class="insert" />
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
        Group:
              8                  16                 8
        +------------+------------------------+-------------+
        | SSM prefix |     Low 16 bits of     |    Local    |
        |   232/8    |  real source address   |    Policy   |
        +------------+------------------------+-------------+

        Source:
        +-------------------------+-------------------------+
        |16-bit AMT unicast prefix| high 16 bits of real src|
        +-------------------------+-------------------------+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;IPv4 format&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>This allows for 2^8 (256) IPv4 group addresses for use by
                each AMT gateway.
</p>
<a name="ipv6prefix"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.2.2"></a><h3>7.2.2.&nbsp;
IPv6</h3>

<p>Similarly for IPv6, this is illustrated in the following figure.
</p><br /><hr class="insert" />
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
        Group:
              32                  64                 32
        +------------+------------------------+-------------+
        | SSM prefix |     Low 64 bits of     |    Local    |
        | FF3x::/32  |  real source address   |    Policy   |
        +------------+------------------------+-------------+

        Source:
        +-------------------------+-------------------------+
        |64-bit AMT unicast prefix| high 64 bits of real src|
        +-------------------------+-------------------------+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;IPv6 format&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>This allows for 2^32 (over 4 billion) IPv6 group addresses
                for use by each AMT gateway.
</p>
<a name="anchor60"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.3"></a><h3>7.3.&nbsp;
Joining Groups with MBone Sources</h3>

<p>The IGMP/MLD protocol usually operates by having the Querier
	    multicast an IGMP/MLD Query message on the link.  This
	    behavior does not work on NBMA links which do not support
	    multicast.  Since the set of gateways is typically
	    unknown to the relay (and potentially quite large),
	    unicasting the queries is also impractical.  The following
	    behavior is used instead.
</p>
<p>Applications residing in a gateway should join groups on the AMT
	    pseudo-interface, causing IGMP/MLD Membership/Listener
	    Reports to be sent over that interface.  When UDP
	    encapsulating the membership reports (and in fact any
	    other messages, unless specified otherwise in this
	    document), the destination address in the outer IP
	    header is the relay's unicast address.  Robustness is
	    provided by the underlying IGMP/MLD protocol messages
	    sent on the AMT pseudo-interface.  In other words, the
	    gateway does not need to retransmit IGMP/MLD
	    Membership/Listener Reports and Leave/Done messages
	    received on the pseudo-interface since IGMP/MLD will
	    already do this.  The gateway simply needs to encapsulate
	    each IGMP/MLD Membership/Listener Report and Leave/Done
            message it receives.
</p>
<p>However, since periodic IGMP/MLD Membership/Listener Reports are
      sent in response to IGMP/MLD Queries, a mechanism to trigger
      periodic Membership/Listener Reports and Leave/Done messages is
      necessary. The gateway should use a timer to trigger periodic AMT Membership
        Updates.
</p>
<p>If the gateway is behind a firewall device, the firewall may require
          the gateway to periodically refresh the UDP state in the firewall
          at a shorter interval than the standard IGMP/MLD Query interval.
          AMT Requests can be sent periodically to solicit IGMP/MLD Queries.
          The interval at which the AMT Requests are sent should be configurable to
          ensure the firewall does not revert to blocking the UDP
          encapsulated IP Multicast data packets. When the AMT Query is received,
          it can be ignored unless it is time for a periodic AMT Membership Update.
</p>
<p>The relay can use the Querier's Robustness Variable (QRV) defined in
          <a class='info' href='#RFC3376'>[RFC3376]<span> (</span><span class='info'>Cain, B., Deering, S., Kouvelas, I., Fenner, B., and A. Thyagarajan, &ldquo;Internet Group Management Protocol, Version 3,&rdquo; October&nbsp;2002.</span><span>)</span></a> and <a class='info' href='#RFC3810'>[RFC3810]<span> (</span><span class='info'>Vida, R. and L. Costa, &ldquo;Multicast Listener Discovery Version 2 (MLDv2) for IPv6,&rdquo; June&nbsp;2004.</span><span>)</span></a>
      	  to adjust the number of Membership/Listener Reports that are sent by
      	  the host joining the group.
</p>
<a name="anchor61"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.4"></a><h3>7.4.&nbsp;
Responding to Relay Changes</h3>

<p>When a gateway determines that its current relay is unreachable
            (e.g., upon receipt of an ICMP Unreachable message
		<a class='info' href='#RFC0792'>[RFC0792]<span> (</span><span class='info'>Postel, J., &ldquo;Internet Control Message Protocol,&rdquo; September&nbsp;1981.</span><span>)</span></a> for the relay's unicast address), it may
		need to repeat relay address discovery. However, care should be taken
		not to abandon the current relay too quickly due to transient network 
		conditions.
</p>
<a name="anchor62"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.5"></a><h3>7.5.&nbsp;
Joining SSM Groups with AMT Gateway Sources</h3>

<p>An IGMPv3/MLDv2 Report for a given (source, group) pair MAY be
encapsulated directly to the source, when the source address belongs
to the AMT Subnet Anycast Prefix.
</p>
<p>The "link-layer" address to use as the destination address in the
outer IP header is obtained as follows.  The source address in the
inclusion list of the IGMPv3/MLDv2 report will be an AMT Gateway Anycast
Address with the high bits of the address, and the remaining bits
will be in the middle of the group address.
</p>
<p><a class='info' href='#gwsg'>Section&nbsp;7.2<span> (</span><span class='info'>Gateway Group and Source Addresses</span><span>)</span></a> describes this format to recover the
gateway source address.
</p>
<a name="anchor63"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.6"></a><h3>7.6.&nbsp;
Receiving AMT Membership Updates by the Gateway</h3>

<p>When an AMT Request is received by the gateway from another
gateway or relay, it follows the
same 3-way handshake procedure a relay would follow if it received
the AMT Request. It generates a MAC and responds with an AMT Membership
Query. When the AMT Membership Update is received, it verifies the
MAC and then processes the IGMP/MLD Membership/Listener Report or
Leave/Done.
</p>
<p>At the gateway, the IGMP/MLD packet should be an IGMPv3/MLDv2 source specific
    (S,G) join or leave.
</p>
<p>If S is not the AMT Gateway Anycast Address, the packet is silently
discarded.  If G does not contain the low bits of the global unicast
address (as described above), the packet is also silently discarded.
</p>
<p>The gateway adds the source address (from the outer IP header) and
UDP port of the report to a membership list for G.  Maintaining
this membership list may be done in any implementation-dependent
manner.  For example, it might be maintained by the "link-layer"
inside the AMT pseudo-interface, making it invisible to the normal
IGMP/MLD module.
</p>
<a name="anchor64"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.7"></a><h3>7.7.&nbsp;
Sending data to SSM groups</h3>

<p>When multicast packets are sent on the AMT pseudo-interface, they
are encapsulated as follows.  If the group address is not an SSM
group, then the packet is silently discarded (this memo does not currently
provide a way to send to non-SSM groups).
</p>
<p>If the group address is an SSM group, then the packet is unicast
encapsulated to each remote node from which the gateway has received
an IGMPv3/MLDv2 report for the packet's (source, group) pair.
</p>
<a name="anchor65"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Relay Router Details</h3>

<a name="anchor66"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.1"></a><h3>8.1.&nbsp;
At Startup time</h3>

<p>At startup time, the relay router will bring up an NBMA-style AMT
pseudo-interface.  It shall also add the AMT Relay Anycast Address
on some interface.
</p>
<p>The relay router shall then advertise the AMT Relay Anycast Prefix
into the unicast-only Internet, as if it were a connection to an
external network.  When the advertisement is done using BGP, the AS
path leading to the AMT Relay Anycast Prefix shall include the
identifier of the local AS.
</p>
<p>The relay router shall also enable IGMPv3/MLDv2 on the AMT pseudo-
interface, except that it shall not multicast Queries (this might be
done, for example, by having the AMT pseudo-device drop them, or by
having the IGMP/MLD module not send them in the first place).
</p>
<p>Finally, to support sourcing SSM traffic from AMT sites, the AMT
Subnet Anycast Prefix is assigned to the AMT pseudo-interface, and the AMT
Subnet Anycast Prefix is injected by the AMT Relay into the M-RIB of MBGP.
</p>
<a name="anchor67"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.2"></a><h3>8.2.&nbsp;
Receiving Relay Discovery messages sent to the Anycast Address</h3>

<p>When a relay receives an AMT Relay Discovery message directed to the
AMT Relay Anycast Address, it should respond with an AMT Relay
Advertisement containing its unicast address.  The source and
destination addresses of the advertisement should be the same as the
destination and source addresses of the discovery message
respectively. Further, the nonce in the discovery message MUST be
copied into the advertisement message.
</p>
<a name="anchor68"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.3"></a><h3>8.3.&nbsp;
Receiving Membership Updates from AMT Gateways</h3>

<p>The relay operates passively, sending no periodic IGMP/MLD
            Queries but simply tracking membership information according
            to AMT Request/Query/Membership Update tuples received.
            In addition, the relay must also do explicit membership tracking,
            as to which gateways on the AMT pseudo-interface have joined
            which groups. Once an AMT Membership Update has been successfully
            received, it updates the forwarding state for the appropriate
            group and source (if provided).  When data arrives for that
            group, the traffic must be encapsulated to each gateway
            which has joined that group or (S,G).
</p>
<p>The explicit membership tracking and unicast replication may be
            done in any implementation-specific manner.  Some examples are:
</p>
<p>
        </p>
<ol class="text">
<li>The AMT pseudo-device driver might track the group information
                and perform the replication at the "link-layer", with no
                changes to a pre-existing IGMP/MLD module.
</li>
<li>The IGMP/MLD module might have native support for explicit
                membership tracking, especially if it supports other NBMA-style
                interfaces.
</li>
</ol><p>
        
</p>
<p>If a relay wants to affect the rate at which the AMT Requests are
            originated from a gateway, it can tune the membership timeout
            by adjusting the Querier's Query Interval Code (QQIC) field in
            the IGMP/MLD Query contained within the AMT Membership Query
            message. The QQIC field is defined in <a class='info' href='#RFC3376'>[RFC3376]<span> (</span><span class='info'>Cain, B., Deering, S., Kouvelas, I., Fenner, B., and A. Thyagarajan, &ldquo;Internet Group Management Protocol, Version 3,&rdquo; October&nbsp;2002.</span><span>)</span></a>
            and <a class='info' href='#RFC3810'>[RFC3810]<span> (</span><span class='info'>Vida, R. and L. Costa, &ldquo;Multicast Listener Discovery Version 2 (MLDv2) for IPv6,&rdquo; June&nbsp;2004.</span><span>)</span></a>. However, since the gateway may need
            to send AMT Requests frequently enough to prevent firewall state from
            timing out, the relay may be limited in its ability to spread out
            Requests coming from a gateway by adjusting the QQIC field.
        
</p>
<a name="anchor69"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.4"></a><h3>8.4.&nbsp;
Receiving (S,G) Joins from the Native Side, for AMT Sources</h3>

<p>The relay sends an IGMPv3/MLDv2 report to the AMT source as
            described above in <a class='info' href='#spoofing'>Section&nbsp;5.1.2<span> (</span><span class='info'>Spoofing Considerations</span><span>)</span></a>
</p>
<a name="anchor70"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
IANA Considerations</h3>

<a name="anchor71"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.1"></a><h3>9.1.&nbsp;
IPv4 and IPv6 Anycast Prefix Allocation</h3>

<p>The IANA should allocate an IPv4 prefix and an IPv6 prefix dedicated
to the public AMT Relays to advertise to the native multicast
backbone.  The prefix length should be determined by the IANA; the
prefix should be large enough to guarantee advertisement in the
default-free BGP networks.
</p>
<a name="anchor72"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.1.1"></a><h3>9.1.1.&nbsp;
IPv4</h3>

<p>A prefix length of 16 will meet this requirement.
</p>
<a name="anchor73"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.1.2"></a><h3>9.1.2.&nbsp;
IPv6</h3>

<p>A prefix length of 32 will meet this requirement. IANA has
                previously set aside the range 2001::/16 for allocating
                prefixes for this purpose.
</p>
<a name="anchor74"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.2"></a><h3>9.2.&nbsp;
IPv4 and IPv6 AMT Subnet Prefix Allocation</h3>

<p>It should also be noted that this prefix length directly affects
    the number of groups available to be created by the AMT gateway: in
    the IPv4 case, a prefix length of 16 gives 256 groups, and a prefix
    length of 8 gives 65536 groups.
</p>
<p>All allocations are a one time effort and there will be no need for any
        recurring assignment after this stage.
</p>
<a name="anchor75"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.2.1"></a><h3>9.2.1.&nbsp;
IPv4</h3>

<p>As described above in <a class='info' href='#ipv4prefix'>Section&nbsp;7.2.1<span> (</span><span class='info'>IPv4</span><span>)</span></a> an IPv4
                prefix with a length of 16 is requested for this purpose.
            
</p>
<a name="anchor76"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.2.2"></a><h3>9.2.2.&nbsp;
IPv6</h3>

<p>As described above in <a class='info' href='#ipv6prefix'>Section&nbsp;7.2.2<span> (</span><span class='info'>IPv6</span><span>)</span></a> an IPv6
            prefix with a length of 32 is requested.
</p>
<a name="anchor77"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.3"></a><h3>9.3.&nbsp;
UDP Port number</h3>

<p>IANA has previously allocated UDP reserved port number 2268 for AMT
            encapsulation.
</p>
<a name="anchor78"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
Security Considerations</h3>

<p>The anycast technique introduces a risk that a rogue router or a
rogue AS could introduce a bogus route to the AMT Relay Anycast
prefix, and thus divert the traffic.  Network managers have to
guarantee the integrity of their routing to the AMT Relay Anycast
prefix in much the same way that they guarantee the integrity of all
other routes.
</p>
<p>Within the native MBGP infrastructure, there is a risk that a rogue
router or a rogue AS could inject a false route to the AMT Subnet
Anycast Prefix, and thus divert joins and cause RPF failures of multicast
traffic.  As the AMT Subnet Anycast Prefix will be advertised by multiple
entities, guaranteeing the integrity of this shared MBGP prefix is
much more challenging than verifying the correctness of a regular
unicast advertisement.  To mitigate this threat, routing operators
should configure the BGP sessions to filter out any more specific
advertisements for the AMT Subnet Anycast Prefix.
</p>
<p>Gateways and relays will accept and decapsulate multicast traffic
from any source from which regular unicast traffic is accepted. If
this is for any reason felt to be a security risk, then additional
source address based packet filtering MUST be applied:
</p>
<p>
</p>
<ol class="text">
<li>To prevent a rogue sender (that can't do traditional spoofing
because of e.g. access lists deployed by its ISP) from making use of AMT
to send packets to an SSM tree, a relay that receives an
encapsulated multicast packet MUST discard the multicast packet if
the IP source address in the outer header does not match the source
address that would be extracted using the rules of <a class='info' href='#gwsg'>Section&nbsp;7.2<span> (</span><span class='info'>Gateway Group and Source Addresses</span><span>)</span></a>.
</li>
<li>A gateway MUST discard encapsulated multicast packets if the
source address in the outer header is not the address to which the
encapsulated join message was sent. An AMT Gateway that receives an
encapsulated IGMPv3/MLDv2 (S,G)-Join MUST discard the message if the
IP destination address in the outer header does not match the source
address that would be extracted using the rules of <a class='info' href='#gwsg'>Section&nbsp;7.2<span> (</span><span class='info'>Gateway Group and Source Addresses</span><span>)</span></a>.
</li>
</ol><p>

</p>
<a name="anchor79"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
Contributors</h3>

<p>The following people provided significant contributions to earlier
       versions of this draft.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  Dirk Ooms
  OneSparrow
  Belegstraat 13; 2018 Antwerp; Belgium
  EMail: dirk@onesparrow.com
</pre></div>
<a name="anchor80"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12"></a><h3>12.&nbsp;
Acknowledgments</h3>

<p>Most of the mechanisms described in this document are based on
       similar work done by the NGTrans WG for obtaining automatic IPv6
       connectivity without explicit tunnels ("6to4").  Tony Ballardie
       provided helpful discussion that inspired this document.
</p>
<p>In addition, extensive comments were received from Pekka Savola,
        Greg Shepherd, Dino Farinacci, Toerless Eckert, Marshall Eubanks,
        John Zwiebel, and Lenny Giuliano.
</p>
<p>Juniper Networks was instrumental in funding several versions of this
       draft as well as an open source implementation.
</p>
<p>Greg Shepherd suggested the inclusion of the AMT Membership Teardown
		message based on field experience.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.13"></a><h3>13.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>13.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC0792">[RFC0792]</a></td>
<td class="author-text">Postel, J., &ldquo;<a href="http://tools.ietf.org/html/rfc792">Internet Control Message Protocol</a>,&rdquo; STD&nbsp;5, RFC&nbsp;792, September&nbsp;1981 (<a href="http://www.rfc-editor.org/rfc/rfc792.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3376">[RFC3376]</a></td>
<td class="author-text">Cain, B., Deering, S., Kouvelas, I., Fenner, B., and A. Thyagarajan, &ldquo;<a href="http://tools.ietf.org/html/rfc3376">Internet Group Management Protocol, Version 3</a>,&rdquo; RFC&nbsp;3376, October&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3376.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3810">[RFC3810]</a></td>
<td class="author-text">Vida, R. and L. Costa, &ldquo;<a href="http://tools.ietf.org/html/rfc3810">Multicast Listener Discovery Version 2 (MLDv2) for IPv6</a>,&rdquo; RFC&nbsp;3810, June&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3810.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4605">[RFC4605]</a></td>
<td class="author-text">Fenner, B., He, H., Haberman, B., and H. Sandick, &ldquo;<a href="http://tools.ietf.org/html/rfc4605">Internet Group Management Protocol (IGMP) / Multicast Listener Discovery (MLD)-Based Multicast Forwarding ("IGMP/MLD Proxying")</a>,&rdquo; RFC&nbsp;4605, August&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4605.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4607">[RFC4607]</a></td>
<td class="author-text">Holbrook, H. and B. Cain, &ldquo;<a href="http://tools.ietf.org/html/rfc4607">Source-Specific Multicast for IP</a>,&rdquo; RFC&nbsp;4607, August&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4607.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>13.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="IANA.AFN">[IANA.AFN]</a></td>
<td class="author-text">IANA, &ldquo;<a href="http://www.iana.org/assignments/address-family-numbers/address-family-numbers.txt">Address Family Numbers</a>.&rdquo;</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1112">[RFC1112]</a></td>
<td class="author-text"><a href="mailto:deering@PESCADERO.STANFORD.EDU">Deering, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1112">Host extensions for IP multicasting</a>,&rdquo; STD&nbsp;5, RFC&nbsp;1112, August&nbsp;1989 (<a href="http://www.rfc-editor.org/rfc/rfc1112.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1546">[RFC1546]</a></td>
<td class="author-text"><a href="mailto:craig@bbn.com">Partridge, C.</a>, <a href="mailto:tmendez@bbn.com">Mendez, T.</a>, and <a href="mailto:milliken@bbn.com">W. Milliken</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1546">Host Anycasting Service</a>,&rdquo; RFC&nbsp;1546, November&nbsp;1993 (<a href="http://www.rfc-editor.org/rfc/rfc1546.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2104">[RFC2104]</a></td>
<td class="author-text"><a href="mailto:hugo@watson.ibm.com">Krawczyk, H.</a>, <a href="mailto:mihir@cs.ucsd.edu">Bellare, M.</a>, and <a href="mailto:canetti@watson.ibm.com">R. Canetti</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2104">HMAC: Keyed-Hashing for Message Authentication</a>,&rdquo; RFC&nbsp;2104, February&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2104.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3053">[RFC3053]</a></td>
<td class="author-text">Durand, A., Fasano, P., Guardini, I., and D. Lento, &ldquo;<a href="http://tools.ietf.org/html/rfc3053">IPv6 Tunnel Broker</a>,&rdquo; RFC&nbsp;3053, January&nbsp;2001 (<a href="http://www.rfc-editor.org/rfc/rfc3053.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3056">[RFC3056]</a></td>
<td class="author-text">Carpenter, B. and K. Moore, &ldquo;<a href="http://tools.ietf.org/html/rfc3056">Connection of IPv6 Domains via IPv4 Clouds</a>,&rdquo; RFC&nbsp;3056, February&nbsp;2001 (<a href="http://www.rfc-editor.org/rfc/rfc3056.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3068">[RFC3068]</a></td>
<td class="author-text">Huitema, C., &ldquo;<a href="http://tools.ietf.org/html/rfc3068">An Anycast Prefix for 6to4 Relay Routers</a>,&rdquo; RFC&nbsp;3068, June&nbsp;2001 (<a href="http://www.rfc-editor.org/rfc/rfc3068.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4291">[RFC4291]</a></td>
<td class="author-text">Hinden, R. and S. Deering, &ldquo;<a href="http://tools.ietf.org/html/rfc4291">IP Version 6 Addressing Architecture</a>,&rdquo; RFC&nbsp;4291, February&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4291.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4601">[RFC4601]</a></td>
<td class="author-text">Fenner, B., Handley, M., Holbrook, H., and I. Kouvelas, &ldquo;<a href="http://tools.ietf.org/html/rfc4601">Protocol Independent Multicast - Sparse Mode (PIM-SM): Protocol Specification (Revised)</a>,&rdquo; RFC&nbsp;4601, August&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4601.txt">TXT</a>, <a href="http://www.rfc-editor.org/rfc/rfc4601.pdf">PDF</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4760">[RFC4760]</a></td>
<td class="author-text">Bates, T., Chandra, R., Katz, D., and Y. Rekhter, &ldquo;<a href="http://tools.ietf.org/html/rfc4760">Multiprotocol Extensions for BGP-4</a>,&rdquo; RFC&nbsp;4760, January&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4760.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Dave Thaler</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Microsoft Corporation</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">One Microsoft Way</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Redmond, WA  98052-6399</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 425 703 8835</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:dthaler@microsoft.com">dthaler@microsoft.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Mohit Talwar</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Microsoft Corporation</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">One Microsoft Way</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Redmond, WA  98052-6399</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 425 705 3131</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:mohitt@microsoft.com">mohitt@microsoft.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Amit Aggarwal</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Microsoft Corporation</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">One Microsoft Way</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Redmond, WA  98052-6399</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 425 706 0593</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:amitag@microsoft.com">amitag@microsoft.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Lorenzo Vicisano</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Qualcomm Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">3165 Kifer Road</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Santa Clara, CA  95051</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:vicisano@qualcomm.com">vicisano@qualcomm.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Tom Pusateri</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">!j</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">2109 Mountain High Rd.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Wake Forest, NC  27587</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:pusateri@bangj.com">pusateri@bangj.com</a></td></tr>
</table>
</body></html>
