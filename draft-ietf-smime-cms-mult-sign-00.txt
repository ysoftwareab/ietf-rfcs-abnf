



S/MIME Working Group                           R. Housley (Vigil Security)
Updates: 3852 (once approved)                                   April 2006
Expires October 2006



                   Cryptographic Message Syntax (CMS)
                     Multiple Signer Clarification
                <draft-ietf-smime-cms-mult-sign-00.txt>


                          Status of this Memo

   By submitting this Internet-Draft, each author represents that any
   applicable patent or other IPR claims of which he or she is aware
   have been or will be disclosed, and any of which he or she becomes
   aware will be disclosed, in accordance with Section 6 of BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups.  Note that
   other groups may also distribute working documents as Internet-
   Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than a "work in progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/1id-abstracts.html

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html

Abstract

   This document updates the Cryptographic Message Syntax (CMS), which
   is published in RFC 3852.  This document clarifies the proper
   handling of the SignedData protected content type when more than one
   digital signature is present.











Housley                                                         [Page 1]

INTERNET DRAFT      CMS Multiple Signer Clarification         April 2006


1.  Introduction

   This document updates the Cryptographic Message Syntax (CMS) [CMS].
   The CMS SignedData protected content type allows multiple digital
   signatures, but the specification is unclear about the appropriate
   processing by a recipient of such a signed content.  This document
   provides replacement text for a few paragraphs, making it clear that
   the protected content is valid if any of the digital signatures is
   valid.

   This property is especially important in two cases.  First, when the
   recipients do not all implement the same digital signature algorithm,
   the signer can sign the content with several different digital
   signature algorithms so that each of the recipients can find an
   acceptable signature.  For example, if some recipients support RSA
   and some recipients support ECDSA, then the signer can generate two
   signatures, one with RSA and one with ECDSA, so that each recipient
   will be able to validate one of the signature.  Second, when a
   community is transitioning one-way hash functions or digital
   signature algorithms, the signer can sign the content with the older
   and the newer signature algorithms so that each recipient can find an
   acceptable signature, regardless of their state in the transition.
   For example, consider a transition from RSA with SHA-1 to RSA with
   SHA-256.  The signer can generate two signatures, one with SHA-1 and
   one with SHA-256, so that each recipient will be able to validate at
   least one of the RSA signatures.

2.  Terminology

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in RFC 2119 [STDWORDS].

3.  Update to RFC 3852, Section 5: Signed-data Content Type

   RFC 3852, section 5, the next to the last paragraph says:

|  A recipient independently computes the message digest.  This message
|  digest and the signer's public key are used to verify the signature
|  value.  The signer's public key is referenced either by an issuer
|  distinguished name along with an issuer-specific serial number or by
|  a subject key identifier that uniquely identifies the certificate
|  containing the public key.  The signer's certificate can be included
|  in the SignedData certificates field.







Housley                                                         [Page 2]

INTERNET DRAFT      CMS Multiple Signer Clarification         April 2006


   This block of text is replaced with:

|  A recipient independently computes the message digest.  This message
|  digest and the signer's public key are used to verify the signature
|  value.  The signer's public key is referenced either by an issuer
|  distinguished name along with an issuer-specific serial number or by
|  a subject key identifier that uniquely identifies the certificate
|  containing the public key.  The signer's certificate can be included
|  in the SignedData certificates field.
|
|  When more than one signature is present, the successful validation
|  of any one of these signatures ought to be treated as a successful
|  validation of the signed-data content type.  The primary reason
|  is that signers may include separate signatures for different
|  communities of recipients.  For example, the signed-data content
|  type might include signatures generated with the RSA signature
|  algorithm and with the ECDSA signature algorithm.  This allows
|  recipients to verify one algorithm or the other.

4.  Update to RFC 3852, Section 5.1: SignedData Type

   RFC 3852, section 5.1, the next to the last paragraph says:

|     signerInfos is a collection of per-signer information.  There MAY
|     be any number of elements in the collection, including zero.  The
|     details of the SignerInfo type are discussed in section 5.3.
|     Since each signer can employ a digital signature technique and
|     future specifications could update the syntax, all implementations
|     MUST gracefully handle unimplemented versions of SignerInfo.
|     Further, since all implementations will not support every possible
|     signature algorithm, all implementations MUST gracefully handle
|     unimplemented signature algorithms when they are encountered.

   This block of text is replaced with:

|     signerInfos is a collection of per-signer information.  There MAY
|     be any number of elements in the collection, including zero.  When
|     the collection represents more than one signature, the successful
|     validation of any one of these collection members ought to be
|     treated as a successful validation of the signed-data content
|     type.  The details of the SignerInfo type are discussed in
|     section 5.3.  Since each signer can employ a digital signature
|     technique and future specifications could update the syntax, all
|     implementations MUST gracefully handle unimplemented versions of
|     SignerInfo.  Further, since all implementations will not support
|     every possible signature algorithm, all implementations MUST
|     gracefully handle unimplemented signature algorithms when they
|     are encountered.



Housley                                                         [Page 3]

INTERNET DRAFT      CMS Multiple Signer Clarification         April 2006


6.  Security Considerations

   The replacement text will reduce the likelihood of interoperability
   errors during the transition from MD5 and SHA-1 to stronger one-way
   hash functions.

7.  Normative References

   [CMS]       Housley, R., "Cryptographic Message Syntax (CMS)",
               RFC 3852, July 2004.

   [STDWORDS]  S. Bradner, "Key words for use in RFCs to Indicate
               Requirement Levels", BCP 14, RFC 2119, March 1997.

8.  IANA Considerations

   None.  Please remove this section prior to publication as an RFC.

Authors' Addresses


   Russell Housley
   Vigil Security, LLC
   918 Spring Knoll Drive
   Herndon, VA 20170
   USA

   EMail: housley(at)vigilsec.com























Housley                                                         [Page 4]

INTERNET DRAFT      CMS Multiple Signer Clarification         April 2006


Copyright Statement

   Copyright (C) The Internet Society (2006).

   This document is subject to the rights, licenses and restrictions
   contained in BCP 78, and except as set forth therein, the authors
   retain all their rights.

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY AND THE INTERNET
   ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS OR IMPLIED,
   INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE
   INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in BCP 78 and BCP 79.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   http://www.ietf.org/ipr.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.














Housley                                                         [Page 5]
