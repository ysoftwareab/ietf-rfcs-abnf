pkR = DeserializePublicKey(ECHConfig.contents.public_key)
final_payload = context.Seal(ClientHelloOuterAAD,
                                    EncodedClientHelloInner)
context = SetupBaseR(ECHClientHello.enc, skR,
                            "tls ech" || 0x00 || ECHConfig)
EncodedClientHelloInner = context.Open(ClientHelloOuterAAD,
                                            ECHClientHello.payload)

EncodedClientHelloInner = context.Open(ClientHelloOuterAAD,
                                            ECHClientHello.payload)

accept_confirmation = HKDF-Expand-Label(
         HKDF-Extract(0, ClientHelloInner.random),
         "ech accept confirmation",
         transcript_ech_conf,
         8)

hrr_accept_confirmation = HKDF-Expand-Label(
         HKDF-Extract(0, ClientHelloInner1.random),
         "hrr ech accept confirmation",
         transcript_hrr_ech_conf,
         8)

