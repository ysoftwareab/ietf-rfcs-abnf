<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Routing for RPL Leaves</title>
<meta content="Pascal Thubert" name="author">
<meta content="Michael C. Richardson" name="author">
<meta content="
       This specification extends RFC6550 and RFC8505 to provide unicast and
   multicast routing services in a RPL domain to 6LNs that are plain Hosts and
   do not participate to RPL, and enables the RPL Root to proxy the EDAR/EDAC
   flow on behalf of the RULs and RANs in its DODAG.
 
    " name="description">
<meta content="xml2rfc 2.40.1" name="generator">
<meta content="draft-ietf-roll-unaware-leaves-10" name="ietf.draft">
<link href="/tmp/unaware-leaves-_ucufb4v.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Avoid wrapping of URLs in references */
@media screen {
  .references a {
    white-space: nowrap;
  }
}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin: 0 0 0.25em 0;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/*
  The margin-left: 0 on <dd> removes all distinction
  between levels from nested <dl>s.  Undo that.
*/
dl.olPercent > dd,
dd {
  margin-left: revert;
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">RPL Unaware Leaves</td>
<td class="right">March 2020</td>
</tr></thead>
<tfoot><tr>
<td class="left">Thubert &amp; Richardson</td>
<td class="center">Expires 13 September 2020</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">ROLL</dd>
<dt class="label-updates">Updates:</dt>
<dd class="updates">
<a href="https://www.rfc-editor.org/rfc/rfc6550" class="eref">6550</a>, <a href="https://www.rfc-editor.org/rfc/rfc8505" class="eref">8505</a> (if approved)</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2020-03-12" class="published">12 March 2020</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2020-09-13">13 September 2020</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">P. Thubert, <span class="editor">Ed.</span>
</div>
<div class="org">Cisco Systems</div>
</div>
<div class="author">
      <div class="author-name">M. Richardson</div>
<div class="org">Sandelman</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Routing for RPL Leaves</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This specification extends RFC6550 and RFC8505 to provide unicast and
   multicast routing services in a RPL domain to 6LNs that are plain Hosts and
   do not participate to RPL, and enables the RPL Root to proxy the EDAR/EDAC
   flow on behalf of the RULs and RANs in its DODAG.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 13 September 2020.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2020 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a><a href="#section-toc.1-1.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-terminology" class="xref">Terminology</a><a href="#section-toc.1-1.2.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-bcp-14" class="xref">BCP 14</a><a href="#section-toc.1-1.2.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-references" class="xref">References</a><a href="#section-toc.1-1.2.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="xref">2.3</a>.  <a href="#name-glossary" class="xref">Glossary</a><a href="#section-toc.1-1.2.2.3.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-6lowpan-neighbor-discovery" class="xref">6LoWPAN Neighbor Discovery</a><a href="#section-toc.1-1.3.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-rfc-6775-address-registrati" class="xref">RFC 6775 Address Registration</a><a href="#section-toc.1-1.3.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-rfc-8505-extended-address-r" class="xref">RFC 8505 Extended Address Registration</a><a href="#section-toc.1-1.3.2.2.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.3.2.2.2.1">
                    <p id="section-toc.1-1.3.2.2.2.1.1"><a href="#section-3.2.1" class="xref">3.2.1</a>.  <a href="#name-r-flag" class="xref">R Flag</a><a href="#section-toc.1-1.3.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.2.2.2">
                    <p id="section-toc.1-1.3.2.2.2.2.1"><a href="#section-3.2.2" class="xref">3.2.2</a>.  <a href="#name-tid-i-field-and-opaque-fiel" class="xref">TID, I Field and Opaque Fields</a><a href="#section-toc.1-1.3.2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.2.2.3">
                    <p id="section-toc.1-1.3.2.2.2.3.1"><a href="#section-3.2.3" class="xref">3.2.3</a>.  <a href="#name-rovr" class="xref">ROVR</a><a href="#section-toc.1-1.3.2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-rfc-8505-extended-dar-dac" class="xref">RFC 8505 Extended DAR/DAC</a><a href="#section-toc.1-1.3.2.3.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.3.2.3.2.1">
                    <p id="section-toc.1-1.3.2.3.2.1.1"><a href="#section-3.3.1" class="xref">3.3.1</a>.  <a href="#name-rfc-7400-capability-indicat" class="xref">RFC 7400 Capability Indication Option</a><a href="#section-toc.1-1.3.2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-updating-rfc-6550" class="xref">Updating RFC 6550</a><a href="#section-toc.1-1.4.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-updating-rfc-8505" class="xref">Updating RFC 8505</a><a href="#section-toc.1-1.5.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-requirements-on-the-rpl-unw" class="xref">Requirements on the RPL-Unware Leaf</a><a href="#section-toc.1-1.6.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-support-of-6lowpan-nd" class="xref">Support of 6LoWPAN ND</a><a href="#section-toc.1-1.6.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-external-routes-and-rpl-art" class="xref">External Routes and RPL Artifacts</a><a href="#section-toc.1-1.6.2.2.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.6.2.2.2.1">
                    <p id="section-toc.1-1.6.2.2.2.1.1"><a href="#section-6.2.1" class="xref">6.2.1</a>.  <a href="#name-support-of-ipv6-encapsulati" class="xref">Support of IPv6 Encapsulation</a><a href="#section-toc.1-1.6.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.6.2.2.2.2">
                    <p id="section-toc.1-1.6.2.2.2.2.1"><a href="#section-6.2.2" class="xref">6.2.2</a>.  <a href="#name-support-of-the-hbh-header" class="xref">Support of the HbH Header</a><a href="#section-toc.1-1.6.2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.6.2.2.2.3">
                    <p id="section-toc.1-1.6.2.2.2.3.1"><a href="#section-6.2.3" class="xref">6.2.3</a>.  <a href="#name-support-of-the-routing-head" class="xref">Support of the Routing Header</a><a href="#section-toc.1-1.6.2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-updated-rpl-status" class="xref">Updated RPL Status</a><a href="#section-toc.1-1.7.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-updated-rpl-target-option" class="xref">Updated RPL Target option</a><a href="#section-toc.1-1.8.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-protocol-operations-for-uni" class="xref">Protocol Operations for Unicast Addresses</a><a href="#section-toc.1-1.9.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="xref">9.1</a>.  <a href="#name-general-flow" class="xref">General Flow</a><a href="#section-toc.1-1.9.2.1.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.9.2.1.2.1">
                    <p id="section-toc.1-1.9.2.1.2.1.1"><a href="#section-9.1.1" class="xref">9.1.1</a>.  <a href="#name-in-rpl-non-storing-mode" class="xref">In RPL Non-Storing-Mode</a><a href="#section-toc.1-1.9.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.9.2.1.2.2">
                    <p id="section-toc.1-1.9.2.1.2.2.1"><a href="#section-9.1.2" class="xref">9.1.2</a>.  <a href="#name-in-rpl-storing-mode" class="xref">In RPL Storing-Mode</a><a href="#section-toc.1-1.9.2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="xref">9.2</a>.  <a href="#name-detailed-operation" class="xref">Detailed Operation</a><a href="#section-toc.1-1.9.2.2.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.9.2.2.2.1">
                    <p id="section-toc.1-1.9.2.2.2.1.1"><a href="#section-9.2.1" class="xref">9.2.1</a>.  <a href="#name-by-the-6ln" class="xref">By the 6LN</a><a href="#section-toc.1-1.9.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.9.2.2.2.2">
                    <p id="section-toc.1-1.9.2.2.2.2.1"><a href="#section-9.2.2" class="xref">9.2.2</a>.  <a href="#name-by-the-6lr" class="xref">By the 6LR</a><a href="#section-toc.1-1.9.2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.9.2.2.2.3">
                    <p id="section-toc.1-1.9.2.2.2.3.1"><a href="#section-9.2.3" class="xref">9.2.3</a>.  <a href="#name-by-the-rpl-root" class="xref">By the RPL Root</a><a href="#section-toc.1-1.9.2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.9.2.2.2.4">
                    <p id="section-toc.1-1.9.2.2.2.4.1"><a href="#section-9.2.4" class="xref">9.2.4</a>.  <a href="#name-by-the-6lbr" class="xref">By the 6LBR</a><a href="#section-toc.1-1.9.2.2.2.4.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-protocol-operations-for-mul" class="xref">Protocol Operations for Multicast Addresses</a><a href="#section-toc.1-1.10.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>. <a href="#name-security-considerations" class="xref">Security Considerations</a><a href="#section-toc.1-1.11.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="xref">12</a>. <a href="#name-iana-considerations" class="xref">IANA Considerations</a><a href="#section-toc.1-1.12.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#section-12.1" class="xref">12.1</a>.  <a href="#name-resizing-the-aro-status-val" class="xref">Resizing the ARO Status values</a><a href="#section-toc.1-1.12.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#section-12.2" class="xref">12.2</a>.  <a href="#name-new-dodag-configuration-opt" class="xref">New DODAG Configuration Option Flag</a><a href="#section-toc.1-1.12.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.12.2.3">
                <p id="section-toc.1-1.12.2.3.1"><a href="#section-12.3" class="xref">12.3</a>.  <a href="#name-rpl-target-option-flags" class="xref">RPL Target Option Flags</a><a href="#section-toc.1-1.12.2.3.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.12.2.4">
                <p id="section-toc.1-1.12.2.4.1"><a href="#section-12.4" class="xref">12.4</a>.  <a href="#name-new-subregistry-for-the-rpl" class="xref">New Subregistry for the RPL Non-Rejection Status values</a><a href="#section-toc.1-1.12.2.4.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.12.2.5">
                <p id="section-toc.1-1.12.2.5.1"><a href="#section-12.5" class="xref">12.5</a>.  <a href="#name-new-subregistry-for-the-rpl-" class="xref">New Subregistry for the RPL Rejection Status values</a><a href="#section-toc.1-1.12.2.5.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="xref">13</a>. <a href="#name-acknowledgments" class="xref">Acknowledgments</a><a href="#section-toc.1-1.13.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-14" class="xref">14</a>. <a href="#name-normative-references" class="xref">Normative References</a><a href="#section-toc.1-1.14.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#section-15" class="xref">15</a>. <a href="#name-informative-references" class="xref">Informative References</a><a href="#section-toc.1-1.15.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#section-appendix.a" class="xref">Appendix A</a>.  <a href="#name-example-compression" class="xref">Example Compression</a><a href="#section-toc.1-1.16.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a href="#section-appendix.b" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a><a href="#section-toc.1-1.17.1" class="pilcrow">¶</a></p>
</li>
</ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">The design of Low Power and Lossy Networks (LLNs) is generally focused on
   saving energy, which is the most constrained resource of all. Other design
   constraints, such as a limited memory capacity, duty cycling of the LLN
   devices and low-power lossy transmissions, derive from that primary concern.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">The IETF produced the <span><a href="#RFC6550" class="xref">"Routing Protocol for Low Power
   and Lossy Networks"</a> [<a href="#RFC6550" class="xref">RFC6550</a>]</span> (RPL) to provide IPv6 <span>[<a href="#RFC8200" class="xref">RFC8200</a>]</span>
   routing services within such constraints. RPL belongs to the class of
   Distance-Vector protocol, which, compared to link-state protocols,
   limits the amount of topological knowledge that needs to be installed and
   maintained in each node.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3"> In order to operate in constrained networks,
   RPL allows a routing stretch (see <span>[<a href="#RFC6687" class="xref">RFC6687</a>]</span>), whereby routing
   is only performed along an acyclic graph optimized to reach a Root node,
   as opposed to straight along a shortest path
   between 2 peers, whatever that would mean in a given LLN.
   This trades the quality of peer-to-peer (P2P) paths for a vastly reduced
   amount of control traffic and routing state that would be required to
   operate a any-to-any shortest path protocol.
   Finally, broken routes may be fixed lazily and on-demand, based on dataplane
   inconsistency discovery, which avoids wasting energy in the proactive repair
   of unused paths.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">
   In order to cope with lossy transmissions, RPL forms Direction-Oriented
   Directed Acyclic Graphs (DODAGs) using DODAG Information Solicitation (DIS)
   and DODAG Information Object (DIO) messages. For many of the nodes, though
   not all, a DODAG provides multiple forwarding solutions towards the Root of
   the topology via so-called parents.
   RPL is designed to adapt to fuzzy connectivity, whereby the physical topology
   cannot be expected to reach a stable state, with a lazy control that creates
   the routes proactively, but may only fix them reactively, upon actual traffic.
   The result is that RPL provides reachability for most of the LLN nodes, most
   of the time, but may not converge in the classical sense.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">
   <span>[<a href="#RFC6550" class="xref">RFC6550</a>]</span> provides unicast and multicast routing services
   back to RPL-Aware nodes (RANs), either as a collection tree or with routing
   back. In tha latter case, a RAN injects routes to itself using Destination
   Advertisement Object (DAO) messages sent to either parent-nodes in the RPL
   Storing Mode or to the Root indicating their parent in the Non-Storing Mode.
   This process effectively forms a DODAG back to the device that is a subset of
   the DODAG to the Root with all links reversed.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">
   RPL can be deployed as an extension to IPv6 Neighbor Discovery (ND)
   <span>[<a href="#RFC4861" class="xref">RFC4861</a>]</span><span>[<a href="#RFC4862" class="xref">RFC4862</a>]</span> and 6LoWPAN ND
   <span>[<a href="#RFC6775" class="xref">RFC6775</a>]</span><span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span> to maintain reachability
   within a Non-Broadcast Multi-Access (NBMA) subnet.
   In that mode, some nodes may act as Routers and
   participate to the forwarding operations whereas others will only terminate
   packets, acting as Hosts in the data-plane.
   In <span>[<a href="#RFC6550" class="xref">RFC6550</a>]</span> terms, a Host that is reachable over the RPL
   network is called a Leaf.<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7">
   <span><a href="#I-D.ietf-roll-useofrplinfo" class="xref">"When to use RFC 6553, 6554 and IPv6-in-IPv6"</a> [<a href="#I-D.ietf-roll-useofrplinfo" class="xref">USEofRPLinfo</a>]</span> introduces the term
   RPL-Aware-Leaf (RAL) for a Leaf that injects routes in RPL to manage the
   reachability of its own IPv6 addresses.
   In contrast, the term RPL-Unaware Leaf (RUL) designates a Leaf does not
   participate to RPL at all. A RUL is a plain Host that needs a
   RPL-Aware Router to obtain routing services over the RPL network.<a href="#section-1-7" class="pilcrow">¶</a></p>
<p id="section-1-8">
   This specification leverages the Address Registration mechanism defined in
   6LoWPAN ND to enable a RUL as a 6LoWPAN Node (6LN) to interface with a
   RPL-Aware Router as a 6LoWPAN Router (6LR) to request that the 6LR injects
   the relevant routing information for the Registered Address in the RPL domain
   on its behalf.
   The unicast packet forwarding operation by the 6LR serving a 6LN that is a
   RPL Leaf is described in <span>[<a href="#I-D.ietf-roll-useofrplinfo" class="xref">USEofRPLinfo</a>]</span>.<a href="#section-1-8" class="pilcrow">¶</a></p>
<p id="section-1-9">
   Examples of routing-agnostic 6LNs include lightly-powered sensors such as
   window smash sensor (alarm system), and kinetically powered light switches.
   Other application of this specification may include a smart grid network that
   controls appliances - such as washing machines or the heating system - in the
   home. Appliances may not participate to the RPL protocol operated in the
   Smartgrid network but can still interact with the Smartgrid for control and/or
   metering.<a href="#section-1-9" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-2">
      <h2 id="name-terminology">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
      </h2>
<div id="bcp">
<section id="section-2.1">
        <h3 id="name-bcp-14">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-bcp-14" class="section-name selfRef">BCP 14</a>
        </h3>
<p id="section-2.1-1">

    The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
    "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
    "OPTIONAL" in this document are to be interpreted as described in BCP 14
 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span><span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they
    appear in all capitals, as shown here.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="lo">
<section id="section-2.2">
        <h3 id="name-references">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-references" class="section-name selfRef">References</a>
        </h3>
<p id="section-2.2-1">
   The Terminology used in this document is consistent with and incorporates
   that described in <span><a href="#RFC7102" class="xref">Terms Used in Routing for Low-Power
   and Lossy Networks (LLNs).</a> [<a href="#RFC7102" class="xref">RFC7102</a>]</span>.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<p id="section-2.2-2">
   A glossary of classical 6LoWPAN acronyms is given in <a href="#gloss" class="xref">Section 2.3</a>.<a href="#section-2.2-2" class="pilcrow">¶</a></p>
<p id="section-2.2-3">
   The term "byte" is used in its now customary sense as a synonym for "octet".<a href="#section-2.2-3" class="pilcrow">¶</a></p>
<p id="section-2.2-4">"RPL", the "RPL Packet Information" (RPI), "RPL Instance" (indexed by a
   RPLInstanceID)are defined in <span><a href="#RFC6550" class="xref">"RPL: IPv6 Routing
   Protocol for Low-Power and Lossy Networks"</a> [<a href="#RFC6550" class="xref">RFC6550</a>]</span> .
   The DODAG Information Solicitation (DIS), Destination Advertisement Object
   (DAO) and DODAG Information Object (DIO) messages are also specified in
   <span>[<a href="#RFC6550" class="xref">RFC6550</a>]</span>. The Destination Cleanup Object (DCO) message
   is defined in <span>[<a href="#I-D.ietf-roll-efficient-npdao" class="xref">EFFICIENT-NPDAO</a>]</span>.<a href="#section-2.2-4" class="pilcrow">¶</a></p>
<p id="section-2.2-5">

   This document uses the terms RPL-Unaware Leaf (RUL) and RPL Aware Leaf
   (RAL) consistently with <span>[<a href="#I-D.ietf-roll-useofrplinfo" class="xref">USEofRPLinfo</a>]</span>.
   The term RPL-Aware Node (RAN) is introduced to refer to a node that is either
   a RAL or a RPL Router. As opposed to a RUL, a RAN manages the reachability of
   its addresses and prefixes by injecting them in RPL by itself.<a href="#section-2.2-5" class="pilcrow">¶</a></p>
<p id="section-2.2-6">

   Other terms in use in LLNs are found in <span><a href="#RFC7228" class="xref">Terminology for Constrained-Node Networks</a> [<a href="#RFC7228" class="xref">RFC7228</a>]</span>.<a href="#section-2.2-6" class="pilcrow">¶</a></p>
<p id="section-2.2-7">
    Readers are expected to be familiar with all the terms and concepts
    that are discussed in<a href="#section-2.2-7" class="pilcrow">¶</a></p>
<ul>
<li id="section-2.2-8.1">
            <span><a href="#RFC4861" class="xref">"Neighbor Discovery for IP version 6"</a> [<a href="#RFC4861" class="xref">RFC4861</a>]</span>,<a href="#section-2.2-8.1" class="pilcrow">¶</a>
</li>
<li id="section-2.2-8.2">
            <span><a href="#RFC4862" class="xref">"IPv6 Stateless Address Autoconfiguration"</a> [<a href="#RFC4862" class="xref">RFC4862</a>]</span>,<a href="#section-2.2-8.2" class="pilcrow">¶</a>
</li>
<li id="section-2.2-8.3">
            <span><a href="#RFC6606" class="xref">"Problem Statement and Requirements for
    IPv6 over Low-Power Wireless Personal Area Network (6LoWPAN) Routing"</a> [<a href="#RFC6606" class="xref">RFC6606</a>]</span>,<a href="#section-2.2-8.3" class="pilcrow">¶</a>
</li>
<li id="section-2.2-8.4">
            <span><a href="#RFC4919" class="xref">"IPv6 over Low-Power
     Wireless Personal Area Networks (6LoWPANs): Overview, Assumptions,
     Problem Statement, and Goals"</a> [<a href="#RFC4919" class="xref">RFC4919</a>]</span>,<a href="#section-2.2-8.4" class="pilcrow">¶</a>
</li>
<li id="section-2.2-8.5">
            <span><a href="#RFC6775" class="xref">"Neighbor Discovery Optimization
  for Low-power and Lossy Networks"</a> [<a href="#RFC6775" class="xref">RFC6775</a>]</span>, and<a href="#section-2.2-8.5" class="pilcrow">¶</a>
</li>
<li id="section-2.2-8.6">
            <span><a href="#RFC8505" class="xref">"Registration Extensions for IPv6 over
 Low-Power Wireless Personal Area Network (6LoWPAN) Neighbor Discovery"</a> [<a href="#RFC8505" class="xref">RFC8505</a>]</span>.<a href="#section-2.2-8.6" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-2.2-9"><a href="#section-2.2-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="gloss">
<section id="section-2.3">
        <h3 id="name-glossary">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-glossary" class="section-name selfRef">Glossary</a>
        </h3>
<p id="section-2.3-1"> This document often uses the following acronyms:<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-2.3-2">
          <dt id="section-2.3-2.1">AR:</dt>
<dd id="section-2.3-2.2">  Address Resolution (aka Address Lookup)<a href="#section-2.3-2.2" class="pilcrow">¶</a>
</dd>
<dt id="section-2.3-2.3">6CIO:</dt>
<dd id="section-2.3-2.4"> 6LoWPAN Capability Indication Option<a href="#section-2.3-2.4" class="pilcrow">¶</a>
</dd>
<dt id="section-2.3-2.5">6LN:</dt>
<dd id="section-2.3-2.6"> 6LoWPAN Node (a Low Power Host or Router)<a href="#section-2.3-2.6" class="pilcrow">¶</a>
</dd>
<dt id="section-2.3-2.7">6LR:</dt>
<dd id="section-2.3-2.8"> 6LoWPAN Router<a href="#section-2.3-2.8" class="pilcrow">¶</a>
</dd>
<dt id="section-2.3-2.9">(E)ARO:</dt>
<dd id="section-2.3-2.10"> (Extended) Address Registration Option<a href="#section-2.3-2.10" class="pilcrow">¶</a>
</dd>
<dt id="section-2.3-2.11">(E)DAR:</dt>
<dd id="section-2.3-2.12"> (Extended) Duplicate Address Request<a href="#section-2.3-2.12" class="pilcrow">¶</a>
</dd>
<dt id="section-2.3-2.13">(E)DAC:</dt>
<dd id="section-2.3-2.14"> (Extended) Duplicate Address Confirmation<a href="#section-2.3-2.14" class="pilcrow">¶</a>
</dd>
<dt id="section-2.3-2.15">DAD:</dt>
<dd id="section-2.3-2.16"> Duplicate Address Detection<a href="#section-2.3-2.16" class="pilcrow">¶</a>
</dd>
<dt id="section-2.3-2.17">DAO:</dt>
<dd id="section-2.3-2.18"> Destination Advertisement Object (a RPL message)<a href="#section-2.3-2.18" class="pilcrow">¶</a>
</dd>
<dt id="section-2.3-2.19">DCO:</dt>
<dd id="section-2.3-2.20"> Destination Cleanup Object (a RPL message)<a href="#section-2.3-2.20" class="pilcrow">¶</a>
</dd>
<dt id="section-2.3-2.21">DIS:</dt>
<dd id="section-2.3-2.22"> DODAG Information Solicitation (a RPL message)<a href="#section-2.3-2.22" class="pilcrow">¶</a>
</dd>
<dt id="section-2.3-2.23">DIO:</dt>
<dd id="section-2.3-2.24"> DODAG Information Object (a RPL message)<a href="#section-2.3-2.24" class="pilcrow">¶</a>
</dd>
<dt id="section-2.3-2.25">DODAG:</dt>
<dd id="section-2.3-2.26"> Destination-Oriented Directed Acyclic Graph<a href="#section-2.3-2.26" class="pilcrow">¶</a>
</dd>
<dt id="section-2.3-2.27">LLN:</dt>
<dd id="section-2.3-2.28"> Low-Power and Lossy Network<a href="#section-2.3-2.28" class="pilcrow">¶</a>
</dd>
<dt id="section-2.3-2.29">NA:</dt>
<dd id="section-2.3-2.30">  Neighbor Advertisement<a href="#section-2.3-2.30" class="pilcrow">¶</a>
</dd>
<dt id="section-2.3-2.31">NCE:</dt>
<dd id="section-2.3-2.32">  Neighbor Cache Entry<a href="#section-2.3-2.32" class="pilcrow">¶</a>
</dd>
<dt id="section-2.3-2.33">ND:</dt>
<dd id="section-2.3-2.34">  Neighbor Discovery<a href="#section-2.3-2.34" class="pilcrow">¶</a>
</dd>
<dt id="section-2.3-2.35">NS:</dt>
<dd id="section-2.3-2.36">  Neighbor Solicitation<a href="#section-2.3-2.36" class="pilcrow">¶</a>
</dd>
<dt id="section-2.3-2.37">RA:</dt>
<dd id="section-2.3-2.38">  Router Advertisement<a href="#section-2.3-2.38" class="pilcrow">¶</a>
</dd>
<dt id="section-2.3-2.39">ROVR:</dt>
<dd id="section-2.3-2.40"> Registration Ownership Verifier<a href="#section-2.3-2.40" class="pilcrow">¶</a>
</dd>
<dt id="section-2.3-2.41">RPI:</dt>
<dd id="section-2.3-2.42"> RPL Packet Information (the abstract information RPL places in data packets as the RPL Option within the IPv6 Hop-By-Hop Header, and by extension the RPL Option itself)<a href="#section-2.3-2.42" class="pilcrow">¶</a>
</dd>
<dt id="section-2.3-2.43">RAL:</dt>
<dd id="section-2.3-2.44"> RPL-Aware Leaf<a href="#section-2.3-2.44" class="pilcrow">¶</a>
</dd>
<dt id="section-2.3-2.45">RAN:</dt>
<dd id="section-2.3-2.46"> RPL-Aware Node (either a RPL Router or a RPL-Aware Leaf)<a href="#section-2.3-2.46" class="pilcrow">¶</a>
</dd>
<dt id="section-2.3-2.47">RUL:</dt>
<dd id="section-2.3-2.48"> RPL-Unaware Leaf<a href="#section-2.3-2.48" class="pilcrow">¶</a>
</dd>
<dt id="section-2.3-2.49">TID:</dt>
<dd id="section-2.3-2.50"> Transaction ID (a sequence counter in the EARO)<a href="#section-2.3-2.50" class="pilcrow">¶</a>
</dd>
</dl>
<p id="section-2.3-3"><a href="#section-2.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
<div id="lpnd">
<section id="section-3">
      <h2 id="name-6lowpan-neighbor-discovery">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-6lowpan-neighbor-discovery" class="section-name selfRef">6LoWPAN Neighbor Discovery</a>
      </h2>
<div id="R6775">
<section id="section-3.1">
        <h3 id="name-rfc-6775-address-registrati">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-rfc-6775-address-registrati" class="section-name selfRef">RFC 6775 Address Registration</a>
        </h3>
<p id="section-3.1-1">
   The classical "IPv6 Neighbor Discovery (IPv6 ND) Protocol"
   <span>[<a href="#RFC4861" class="xref">RFC4861</a>]</span> <span>[<a href="#RFC4862" class="xref">RFC4862</a>]</span> was defined for transit
   media such a Ethernet. It is a reactive protocol that relies heavily on
   multicast operations for address discovery (aka lookup) and duplicate
   address detection (DAD).<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">
   <span><a href="#RFC6775" class="xref">"Neighbor Discovery Optimizations for 6LoWPAN networks"</a> [<a href="#RFC6775" class="xref">RFC6775</a>]</span>
   adapts IPv6 ND for operations over energy-constrained LLNs.
   The main functions of <span>[<a href="#RFC6775" class="xref">RFC6775</a>]</span> are to proactively establish
   the Neighbor Cache Entry (NCE) in the 6LR and to prevent address duplication.
   To that effect, <span>[<a href="#RFC6775" class="xref">RFC6775</a>]</span> introduces a new unicast Address
   Registration  mechanism that contributes to reducing the use of multicast
   messages compared to the classical IPv6 ND protocol.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<p id="section-3.1-3"><span>[<a href="#RFC6775" class="xref">RFC6775</a>]</span> defines a new Address
   Registration Option (ARO) that is carried in the unicast
   Neighbor Solicitation (NS) and Neighbor Advertisement (NA) messages between
   the 6LoWPAN Node (6LN) and the 6LoWPAN Router (6LR).

   It also defines the Duplicate Address Request (DAR) and Duplicate
   Address Confirmation (DAC) messages between the 6LR and the 6LoWPAN Border
   Router (6LBR).
   In an LLN, the 6LBR is the central repository of all the Registered Addresses
   in its domain and the source of truth for uniqueness and ownership.<a href="#section-3.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="R8505E">
<section id="section-3.2">
        <h3 id="name-rfc-8505-extended-address-r">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-rfc-8505-extended-address-r" class="section-name selfRef">RFC 8505 Extended Address Registration</a>
        </h3>
<p id="section-3.2-1">
   <span><a href="#RFC8505" class="xref">"Registration Extensions for 6LoWPAN Neighbor Discovery"</a> [<a href="#RFC8505" class="xref">RFC8505</a>]</span>
   updates the behavior of RFC 6775 to enable a generic
   Address Registration to services such as routing and ND proxy, and defines the
   Extended Address Registration Option (EARO) as shown
   in <a href="#EARO" class="xref">Figure 1</a>:<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<span id="name-earo-option-format"></span><div id="EARO">
<figure id="figure-1">
          <div class="artwork art-text alignCenter" id="section-3.2-2.1">
<pre>
   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |     Type      |     Length    |    Status     |    Opaque     |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |  Rsvd | I |R|T|     TID       |     Registration Lifetime     |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                                                               |
 ...             Registration Ownership Verifier                 ...
  |                                                               |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-earo-option-format" class="selfRef">EARO Option Format</a>
          </figcaption></figure>
</div>
<div id="R8505ER">
<section id="section-3.2.1">
          <h4 id="name-r-flag">
<a href="#section-3.2.1" class="section-number selfRef">3.2.1. </a><a href="#name-r-flag" class="section-name selfRef">R Flag</a>
          </h4>
<p id="section-3.2.1-1">
<span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span> introduces the "R" flag in the EARO.
   The Registering Node sets the "R" flag to indicate whether the 6LR should
   ensure reachability for the Registered Address.
   If the "R" flag is not set, then the Registering Node handles the reachability
   of the Registered Address by other means, which means in a RPL network that
   it is a RAN or that it uses another RPL Router for reachability services.<a href="#section-3.2.1-1" class="pilcrow">¶</a></p>
<p id="section-3.2.1-2">
   This document specifies how the "R" flag is used in the context of RPL. A 6LN
   is a RUL that requires reachability services for an IPv6 address iff it sets
   the "R" flag in the EARO used to register the address to a RPL router.
   Conversely, this document specifies the behavior of a RPL Router acting as
   6LR depending on the setting of the "R" flag in the EARO.
   The RPL Router generates a DAO message for the
   Registered Address upon an NS(EARO) iff the "R" flag is set.<a href="#section-3.2.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="R8505ETID">
<section id="section-3.2.2">
          <h4 id="name-tid-i-field-and-opaque-fiel">
<a href="#section-3.2.2" class="section-number selfRef">3.2.2. </a><a href="#name-tid-i-field-and-opaque-fiel" class="section-name selfRef">TID, I Field and Opaque Fields</a>
          </h4>
<p id="section-3.2.2-1">
   The EARO also includes a sequence counter called Transaction ID (TID),
   which maps to the Path Sequence Field found in Transit Options in RPL DAO
   messages. This is the reason why the support of <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span>
   by the RUL as opposed to only <span>[<a href="#RFC6775" class="xref">RFC6775</a>]</span> is a prerequisite for
   this specification (more in <a href="#prereq6lp" class="xref">Section 6.1</a>). The EARO also
   transports an Opaque field and an "I" field that describes what the Opaque
   field transports and how to use it. <a href="#ln" class="xref">Section 9.2.1</a> specifies the use of
   the "I" field and of the Opaque field by a RUL.<a href="#section-3.2.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="R8505EROVR">
<section id="section-3.2.3">
          <h4 id="name-rovr">
<a href="#section-3.2.3" class="section-number selfRef">3.2.3. </a><a href="#name-rovr" class="section-name selfRef">ROVR</a>
          </h4>
<p id="section-3.2.3-1">
   Section 5.3. of <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span> introduces the Registration
   Ownership Verifier (ROVR) field of variable length from 64 to 256 bits.
   
   The ROVR is a replacement of the EUI-64 in the ARO
   <span>[<a href="#RFC6775" class="xref">RFC6775</a>]</span> that was used to identify uniquely an Address
   Registration with the Link-Layer address of the owner, but provided no
   protection against spoofing.<a href="#section-3.2.3-1" class="pilcrow">¶</a></p>
<p id="section-3.2.3-2">

   <span><a href="#I-D.ietf-6lo-ap-nd" class="xref">"Address Protected Neighbor Discovery for
   Low-power and Lossy Networks"</a> [<a href="#I-D.ietf-6lo-ap-nd" class="xref">AP-ND</a>]</span> leverages the ROVR field as a
   cryptographic proof of ownership to prevent a rogue third party from misusing
   the address.
   <span>[<a href="#I-D.ietf-6lo-ap-nd" class="xref">AP-ND</a>]</span> adds a challenge/response exchange to the
   <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span> Address Registration and enables Source Address Validation
   by a 6LR that will drop packets with a spoofed address.<a href="#section-3.2.3-2" class="pilcrow">¶</a></p>
<p id="section-3.2.3-3">

   This specification does not address how the protection by
   <span>[<a href="#I-D.ietf-6lo-ap-nd" class="xref">AP-ND</a>]</span> could be extended to RPL. On the other
   hand, it adds the ROVR to the DAO to build the proxied EDAR at the Root
   (see <a href="#tgt" class="xref">Section 8</a>),
   which means that nodes that are aware of the Host route to the 6LN are made
   aware of the associated ROVR as well.<a href="#section-3.2.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="R8505D">
<section id="section-3.3">
        <h3 id="name-rfc-8505-extended-dar-dac">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-rfc-8505-extended-dar-dac" class="section-name selfRef">RFC 8505 Extended DAR/DAC</a>
        </h3>
<p id="section-3.3-1">
   <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span> updates the periodic DAR/DAC exchange that takes
   place between the 6LR and the 6LBR using Extended DAR/DAC messages which can
   carry a ROVR field of variable size.
   The periodic EDAR/EDAC exchange is triggered by a NS(EARO)
   message and is intended to create and then refresh the corresponding state in
   the 6LBR for a lifetime that is indicated by the 6LN.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2">
   Conversely, RPL
   <span>[<a href="#RFC6550" class="xref">RFC6550</a>]</span> specifies a periodic DAO from the 6LN all the way to
   the Root that maintains the routing state in the RPL network for the lifetime
   indicated by the source of the DAO.
   This means that for each address, there are two keep-alive messages
   that traverse the whole network, one to the Root and one to the 6LBR.<a href="#section-3.3-2" class="pilcrow">¶</a></p>
<p id="section-3.3-3">

   This specification saves the extraneous keep-alive across the LLN. The 6LR
   turns the periodic Address Registration from the RUL into a DAO message to
   the Root every time, but only generates the EDAR upon the first registration,
   for the purpose of DAD. Upon a refresher DAO,
   the Root proxies the EDAR exchange to refresh the state at the 6LBR on behalf
   of the 6LR, as illustrated in <a href="#fReg2" class="xref">Figure 7</a>.<a href="#section-3.3-3" class="pilcrow">¶</a></p>
<div id="R7400">
<section id="section-3.3.1">
          <h4 id="name-rfc-7400-capability-indicat">
<a href="#section-3.3.1" class="section-number selfRef">3.3.1. </a><a href="#name-rfc-7400-capability-indicat" class="section-name selfRef">RFC 7400 Capability Indication Option</a>
          </h4>
<p id="section-3.3.1-1">
   <span><a href="#RFC7400" class="xref">"6LoWPAN-GHC: Generic Header Compression for IPv6
   over Low-Power Wireless Personal Area Networks (6LoWPANs)"</a> [<a href="#RFC7400" class="xref">RFC7400</a>]</span> defines the
   6LoWPAN Capability Indication Option (6CIO) that enables a node to expose its
   capabilities in Router Advertisement (RA) messages.

   <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span> defines a number of bits in the 6CIO, in particular:<a href="#section-3.3.1-1" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-3.3.1-2">
            <dt id="section-3.3.1-2.1">L:</dt>
<dd id="section-3.3.1-2.2"> Node is a 6LR.<a href="#section-3.3.1-2.2" class="pilcrow">¶</a>
</dd>
<dt id="section-3.3.1-2.3">E:</dt>
<dd id="section-3.3.1-2.4"> Node is an IPv6 ND Registrar -- i.e., it supports
   registrations based on EARO.<a href="#section-3.3.1-2.4" class="pilcrow">¶</a>
</dd>
<dt id="section-3.3.1-2.5">P:</dt>
<dd id="section-3.3.1-2.6"> Node is a Routing Registrar, -- i.e., an IPv6 ND Registrar
         that also provides reachability services for the Registered Addres<a href="#section-3.3.1-2.6" class="pilcrow">¶</a>
</dd>
</dl>
<span id="name-6cio-flags"></span><div id="CIO">
<figure id="figure-2">
            <div class="artwork art-text alignCenter" id="section-3.3.1-3.1">
<pre>
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Type      |   Length = 1  |     Reserved      |D|L|B|P|E|G|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                           Reserved                            |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-6cio-flags" class="selfRef">6CIO flags</a>
            </figcaption></figure>
</div>
<p id="section-3.3.1-4">

    A 6LR that can provide reachability services for a RUL in a RPL network
    as specified in this document SHOULD include a 6CIO in its RA messages and
    set the L, P and E flags as prescribed by <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span>,
    see <a href="#prereq6lp" class="xref">Section 6.1</a> for the behavior of the RUL.<a href="#section-3.3.1-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="upd">
<section id="section-4">
      <h2 id="name-updating-rfc-6550">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-updating-rfc-6550" class="section-name selfRef">Updating RFC 6550</a>
      </h2>
<p id="section-4-1">
   This document specifies a new behavior whereby a 6LR injects DAO messages
   for unicast addresses (see <a href="#op" class="xref">Section 9</a>) and multicast addresses
   (see <a href="#multiop" class="xref">Section 10</a>) on behalf of leaves that are not aware of RPL.
   The addresses are exposed as external targets <span>[<a href="#RFC6550" class="xref">RFC6550</a>]</span>.
   Per
   <span>[<a href="#I-D.ietf-roll-useofrplinfo" class="xref">USEofRPLinfo</a>]</span>, an IP-in-IP encapsulation that
   terminates at the RPL Root is used to remove RPL artifacts and compression
   techniques that may not be processed correctly outside of the RPL domain.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">
   This document also synchronizes the liveness monitoring at the Root and the
   6LBR. A same value of lifetime is used for both, and a single keep-alive
   message, the RPL DAO, traverses the RPL network. A new behavior is introduced
   whereby the RPL Root proxies the EDAR message to the 6LBR on behalf of the
   6LR (more in <a href="#upd2" class="xref">Section 5</a>), for any 6LN, RUL or RAN.<a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3">
   RPL defines a configuration option that is registered to
   IANA in section 20.14. of <span>[<a href="#RFC6550" class="xref">RFC6550</a>]</span>. This specification
   defines a new flag "Root Proxies EDAR/EDAC" (P) that is encoded in
   one of the reserved control bits in the option. The new flag is set to
   indicate that the Root performs the proxy operation and that all nodes in
   the network must refrain from renewing the 6LBR state directly. The bit
   position of the "P" flag is indicated in <a href="#iana-conf" class="xref">Section 12.2</a>.<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4">
   Section 6.3.1.
   of <span>[<a href="#RFC6550" class="xref">RFC6550</a>]</span> defines a 3-bit Mode of Operation (MOP) in the
   DIO Base Object. The new "P" flag is defined only for MOP value between 0 to
   6. For a MOP value of 7 or above, the flag MAY indicate something different
   and MUST NOT be interpreted as "Root Proxies EDAR/EDAC" unless the
   specification of the MOP indicates to do so.<a href="#section-4-4" class="pilcrow">¶</a></p>
<p id="section-4-5">
   The RPL Status defined in section 6.5.1. of <span>[<a href="#RFC6550" class="xref">RFC6550</a>]</span>
   for use in the DAO-Ack message is extended to be used in the DCO messages
   <span>[<a href="#I-D.ietf-roll-efficient-npdao" class="xref">EFFICIENT-NPDAO</a>]</span> as well. Furthermore, this
   specification enables to use a RPL Status to transport the IPv6 ND Status
   defined for use in the EARO, more in <a href="#stat" class="xref">Section 7</a>.<a href="#section-4-5" class="pilcrow">¶</a></p>
<p id="section-4-6">
   Section 6.7. of <span>[<a href="#RFC6550" class="xref">RFC6550</a>]</span> introduces the RPL Control message
   Options such as the RPL Target Option that can be included in a RPL Control
   message such as the DAO. <a href="#tgt" class="xref">Section 8</a> updates the RPL Target Option
   to optionally transport the ROVR used in the IPv6 Registration
   (see <a href="#R8505EROVR" class="xref">Section 3.2.3</a>) so the RPL Root can generate a full
   EDAR message.<a href="#section-4-6" class="pilcrow">¶</a></p>
<p id="section-4-7"><a href="#section-4-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="upd2">
<section id="section-5">
      <h2 id="name-updating-rfc-8505">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-updating-rfc-8505" class="section-name selfRef">Updating RFC 8505</a>
      </h2>
<p id="section-5-1">

   This document updates <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span> to introduce the anonymous
   EDAR and NS(EARO) messages. The anonymous messages are used for backward
   compatibility. The anonymous messages are recognizable by a zero ROVR
   field and can only be used as a refresher for a pre-existing state associated
   to the Registered Address. More specifically, an anonymous message can only
   increase the lifetime and/or increment the TID of an existing state at the
   6LBR.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">
   Upon the renewal of a 6LoWPAN ND Address Registration, this specification
   changes the behavior of a RPL Router acting as 6LR for the registration. If
   the Root indicates the capability to proxy the EDAR/EDAC exchange to the 6LBR
   then the 6LR refrains from sending an EDAR message; if the Root is separated
   from the 6LBR, the Root regenerates the EDAR message to the 6LBR upon a DAO
   message that signals the liveliness of the Address. The regenerated message
   is anonymous iff the DAO is a legacy message that does not carry a ROVR as
   specified in <a href="#tgt" class="xref">Section 8</a>.<a href="#section-5-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="prereq">
<section id="section-6">
      <h2 id="name-requirements-on-the-rpl-unw">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-requirements-on-the-rpl-unw" class="section-name selfRef">Requirements on the RPL-Unware Leaf</a>
      </h2>
<p id="section-6-1">
   This document provides RPL routing for a RUL, that is a 6LN acting as an IPv6
   Host and not aware of RPL. Still, a minimal RPL-independent functionality is
   required from the RUL in order to obtain routing services from the 6LR.<a href="#section-6-1" class="pilcrow">¶</a></p>
<div id="prereq6lp">
<section id="section-6.1">
        <h3 id="name-support-of-6lowpan-nd">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-support-of-6lowpan-nd" class="section-name selfRef">Support of 6LoWPAN ND</a>
        </h3>
<p id="section-6.1-1">
   In order to obtain routing services from a 6LR, a RUL MUST implement
   <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span> and set the "R" flag in the EARO option.
   The RUL MUST NOT request routing services from a 6LR unless
   the 6LR originates RA messages with a CIO that has the L, P and E
   flags are all set as discussed in <a href="#R7400" class="xref">Section 3.3.1</a>.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">
   The RUL MUST register to all the 6LRs from which it requests routing services.
   The Address Registrations SHOULD be performed in a rapid sequence, using the
   exact same EARO for a same Address. Gaps between the Address Registrations
   will invalidate some of the routes till the Address Registration finally
   shows on those routes as well.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<p id="section-6.1-3"><span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span> introduces error Status values in the NA(EARO)
   which can be received synchronously upon an NS(EARO) or asynchronously. The
   RUL MUST support both cases and MUST refrain from using the address
   when the Status value indicates a rejection.<a href="#section-6.1-3" class="pilcrow">¶</a></p>
<p id="section-6.1-4">
   A RUL SHOULD support <span>[<a href="#I-D.ietf-6lo-ap-nd" class="xref">AP-ND</a>]</span> to protect the
   ownership of its addresses.<a href="#section-6.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="prereqv6">
<section id="section-6.2">
        <h3 id="name-external-routes-and-rpl-art">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-external-routes-and-rpl-art" class="section-name selfRef">External Routes and RPL Artifacts</a>
        </h3>
<p id="section-6.2-1">
   Section 4.1. of <span>[<a href="#I-D.ietf-roll-useofrplinfo" class="xref">USEofRPLinfo</a>]</span> provides a set of
   rules that MUST be followed for the routing operations to a RUL.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">
   Non-Storing Mode DAO messages are used to signal external routes to the Root,
   even if the DODAG is operated in Storing Mode. A RUL is an example of a
   destination that is reachable via an external route which happens to be a
   Host route.<a href="#section-6.2-2" class="pilcrow">¶</a></p>
<p id="section-6.2-3">
   The Non-Storing Mode DAO messaging enables to advertise the 6LR that serves
   the RUL and injects the route to the Root. It also forces all packets to
   the RUL to be routed via the Root since the path to the RUL is not known
   inside the RPL domain, even in Storing Mode.<a href="#section-6.2-3" class="pilcrow">¶</a></p>
<p id="section-6.2-4">
   The use of Non-Storing Mode signaling in Storing Mode and the associated
   IP-in-IP encapsulation are transparent to intermediate Routers that only see
   packets back and forth between the Root and the 6LR and do not need a special
   support for external routes, so the mmechanism is backward compatible.<a href="#section-6.2-4" class="pilcrow">¶</a></p>
<p id="section-6.2-5">
   The RPL data packets from/to a RUL are encapsulated using an
   IP-in-IP tunnel between the Root and the 6LR that serves the RUL, except for
   packets from the RUL to a RAN in the RPL domain.
   The RPL data packets also carry a Hop-by-Hop Header to transport a RPL
   Packet Information (RPI) <span>[<a href="#RFC6550" class="xref">RFC6550</a>]</span>.
   In Non-Storing Mode, packets going down carry a Source Routing Header (SRH).
   These headers are called the "RPL artifacts" and can be compressed with
   <span>[<a href="#RFC8138" class="xref">RFC8138</a>]</span>.<a href="#section-6.2-5" class="pilcrow">¶</a></p>
<p id="section-6.2-6">
   RPL data packets going down to the RUL
   (see <a href="#rtghc" class="xref">Figure 12</a> for the compressed format in Storing Mode)
   are decapsulated by the 6LR that serves the RUL.
   The inner packet that is forwarded to the RUL is free of RPL artifacts,
   except for an RPI if the packet was generated by a RAN in the same RPL
   domain as the RUL and reencapsulated with the original RPI still present in
   the inner header by the Root.<a href="#section-6.2-6" class="pilcrow">¶</a></p>
<p id="section-6.2-7">
   <span>[<a href="#I-D.ietf-roll-useofrplinfo" class="xref">USEofRPLinfo</a>]</span> expects the RUL to support the
   basic <span><a href="#RFC8504" class="xref">"IPv6 Node Requirements"</a> [<a href="#RFC8504" class="xref">RFC8504</a>]</span>, in particular
   to ignore the RPL artifacts that are either consumed or not applicable to a
   Host, which is the case of the RPI.<a href="#section-6.2-7" class="pilcrow">¶</a></p>
<p id="section-6.2-8">

   Additionally, the RUL is not expected to support the compression method
   defined in <span>[<a href="#RFC8138" class="xref">RFC8138</a>]</span>. The 6LR that injected the route MUST
   uncompress the packet before forwarding over an external route, even when
   delivering to a RUL, even when it is not the destination in the outer header
   of the incoming packet, unless configured to do otherwise.<a href="#section-6.2-8" class="pilcrow">¶</a></p>
<div id="prereqv6ip">
<section id="section-6.2.1">
          <h4 id="name-support-of-ipv6-encapsulati">
<a href="#section-6.2.1" class="section-number selfRef">6.2.1. </a><a href="#name-support-of-ipv6-encapsulati" class="section-name selfRef">Support of IPv6 Encapsulation</a>
          </h4>
<p id="section-6.2.1-1">
   Section 2.1 of <span>[<a href="#I-D.ietf-roll-useofrplinfo" class="xref">USEofRPLinfo</a>]</span> sets the rules
   for forwarding IP-in-IP either to the final 6LN or to a parent 6LR.
   In order to enable IP-in-IP to the 6LN in Non-Storing Mode, the 6LN must be
   able to decapsulate the tunneled packet and either drop the inner packet if
   it is not the final destination, or pass it to the upper layer for further
   processing. Unless it is aware that the RUL can handle IP-in-IP properly, the
   Root that encapsulates a packet to a RUL terminates the IP-in-IP tunnel at
   the parent 6LR . For that reason, it is beneficial but not necessary for a
   RUL to support IP-in-IP.<a href="#section-6.2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="prereqv6hh">
<section id="section-6.2.2">
          <h4 id="name-support-of-the-hbh-header">
<a href="#section-6.2.2" class="section-number selfRef">6.2.2. </a><a href="#name-support-of-the-hbh-header" class="section-name selfRef">Support of the HbH Header</a>
          </h4>
<p id="section-6.2.2-1">
   A RUL is expected to process an unknown Option Type in a
   Hop-by-Hop Header as prescribed by section 4.2 of <span>[<a href="#RFC8200" class="xref">RFC8200</a>]</span>.
   This means in particular that an RPI with an Option Type of 0x23
   <span>[<a href="#I-D.ietf-roll-useofrplinfo" class="xref">USEofRPLinfo</a>]</span> is ignored when not
    understood.<a href="#section-6.2.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="prereqv6rh">
<section id="section-6.2.3">
          <h4 id="name-support-of-the-routing-head">
<a href="#section-6.2.3" class="section-number selfRef">6.2.3. </a><a href="#name-support-of-the-routing-head" class="section-name selfRef">Support of the Routing Header</a>
          </h4>
<p id="section-6.2.3-1">
   A RUL is expected to process an unknown Routing Header Type as
   prescribed by section 4.4 of <span>[<a href="#RFC8200" class="xref">RFC8200</a>]</span>.
   This means in particular that Routing Header with a Routing Type of 3
   <span>[<a href="#RFC6553" class="xref">RFC6553</a>]</span> is ignored when the Segments Left is zero, and
   dropped otherwise.<a href="#section-6.2.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="stat">
<section id="section-7">
      <h2 id="name-updated-rpl-status">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-updated-rpl-status" class="section-name selfRef">Updated RPL Status</a>
      </h2>
<p id="section-7-1">The RPL Status is defined in section 6.5.1. of <span>[<a href="#RFC6550" class="xref">RFC6550</a>]</span>
    for use in the DAO-Ack message and values are assigned as follows:<a href="#section-7-1" class="pilcrow">¶</a></p>
<span id="name-rpl-status-per-rfc-6550"></span><div id="irplStatusbl">
<table class="center" id="table-1">
        <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-rpl-status-per-rfc-6550" class="selfRef">RPL Status per RFC 6550</a>
        </caption>
<thead>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">Range</td>
            <td class="text-left" rowspan="1" colspan="1">Meaning</td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">0</td>
            <td class="text-left" rowspan="1" colspan="1">Success/Unqualified acceptance</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">1-127</td>
            <td class="text-left" rowspan="1" colspan="1">Not an outright rejection</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">128-255</td>
            <td class="text-left" rowspan="1" colspan="1">Rejection</td>
          </tr>
        </tbody>
      </table>
</div>
<p id="section-7-3">
    This specification extends the scope of the RPL Status to be used in RPL DCO
    messages. Furthermore, this specification enables to carry the IPv6 ND
    Status values defined for use in the EARO and initially listed in table 1
    of <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span> in a RPL Status.<a href="#section-7-3" class="pilcrow">¶</a></p>
<p id="section-7-4">
    <a href="#iana-aro" class="xref">Section 12.1</a> reduces the range of EARO Status values to 0-63
    ensure that they fit within a RPL Status as shown in <a href="#rpst" class="xref">Figure 3</a>.<a href="#section-7-4" class="pilcrow">¶</a></p>
<span id="name-rpl-status-format"></span><div id="rpst">
<figure id="figure-3">
        <div class="artwork art-text alignCenter" id="section-7-5.1">
<pre>
    0
    0 1 2 3 4 5 6 7
   +-+-+-+-+-+-+-+-+
   |E|A|  Value    |
   +-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-rpl-status-format" class="selfRef">RPL Status Format</a>
        </figcaption></figure>
</div>
<p id="section-7-6"> RPL Status subfields:<a href="#section-7-6" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-7-7">
        <dt id="section-7-7.1">E:</dt>
<dd id="section-7-7.2"> 1-bit flag. Set to indicate a rejection. When not set, a value of 0
    indicates Success/Unqualified acceptance and other values indicate "not an
    outright rejection" as per RFC 6550.<a href="#section-7-7.2" class="pilcrow">¶</a>
</dd>
<dt id="section-7-7.3">A:</dt>
<dd id="section-7-7.4"> 1-bit flag. Indicates the type of the Status value.<a href="#section-7-7.4" class="pilcrow">¶</a>
</dd>
<dt id="section-7-7.5">Status Value:</dt>
<dd id="section-7-7.6"> 6-bit unsigned integer. If the 'A' flag is set this
    field transports a Status value defined for IPv6 ND EARO. When the 'A' flag
    is not set, the Status value is defined in a RPL extension.<a href="#section-7-7.6" class="pilcrow">¶</a>
</dd>
</dl>
<p id="section-7-8">
   When building a DCO or a DAO-ACK message upon an IPv6 ND NA or a DAC message,
   the RPL Root MUST copy the ARO Status unchanged in a RPL Status with the 'A'
   bit set. The RPL Root MUST set the 'E' flag for all values in range 1-10
   which are all considered rejections.<a href="#section-7-8" class="pilcrow">¶</a></p>
<p id="section-7-9">
   Conversely, the 6LR MUST copy the value of the RPL Status unchanged in the
   EARO of an NA message that is built upon a RPL Status with the 'A' bit
   set in a DCO or a DAO-ACK message.<a href="#section-7-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="tgt">
<section id="section-8">
      <h2 id="name-updated-rpl-target-option">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-updated-rpl-target-option" class="section-name selfRef">Updated RPL Target option</a>
      </h2>
<p id="section-8-1"> This specification updates the RPL Target option to transport the ROVR.
    This enables the RPL Root to generate a full EDAR message as opposed to an
    anonymous EDAR that has restricted properties.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">
    The Target Prefix field MUST be aligned to the next 4-byte boundary after
    the size indicated by the Prefix Length.
    If necessary the transported prefix MUST be padded with zeros.<a href="#section-8-2" class="pilcrow">¶</a></p>
<p id="section-8-3">
    With this specification the ROVR is the remainder of the RPL Target Option.
    The size of the ROVR is indicated in a new ROVR Size field that is encoded
    to map one-to-one with the Code Suffix in the EDAR message
    (see table 4 of <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span>).<a href="#section-8-3" class="pilcrow">¶</a></p>
<p id="section-8-4">
    The modified format is illustrated in <a href="#frpltgt" class="xref">Figure 4</a>.
    It is backward compatible with the Target Option in
    <span>[<a href="#RFC6550" class="xref">RFC6550</a>]</span> and SHOULD be used as a replacement.<a href="#section-8-4" class="pilcrow">¶</a></p>
<span id="name-updated-target-option"></span><div id="frpltgt">
<figure id="figure-4">
        <div class="artwork art-text alignLeft" id="section-8-5.1">
<pre>
   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   Type = 0x05 | Option Length |ROVRsz | Flags | Prefix Length |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   +                                                               +
   |                Target Prefix (Variable Length)                |
   .                Aligned to 4-byte boundary                     .
   .                                                               .
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
  ...            Registration Ownership Verifier (ROVR)           ...
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-updated-target-option" class="selfRef">Updated Target Option</a>
        </figcaption></figure>
</div>
<p id="section-8-6"> New fields:<a href="#section-8-6" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-8-7">
        <dt id="section-8-7.1">ROVRsz:</dt>
<dd id="section-8-7.2"> Indicates the Size of the ROVR.
                        It MAY be 1, 2, 3, or 4, denoting a ROVR size of
                        64, 128, 192, or 256 bits, respectively.<a href="#section-8-7.2" class="pilcrow">¶</a>
</dd>
<dt id="section-8-7.3">Registration Ownership Verifier (ROVR):</dt>
<dd id="section-8-7.4">
                  This is the same field as in the EARO,
                  see <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span><a href="#section-8-7.4" class="pilcrow">¶</a>
</dd>
</dl>
</section>
</div>
<div id="op">
<section id="section-9">
      <h2 id="name-protocol-operations-for-uni">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-protocol-operations-for-uni" class="section-name selfRef">Protocol Operations for Unicast Addresses</a>
      </h2>
<p id="section-9-1">
  The description below assumes that the Root sets the "P" flag in the
  DODAG Configuration Option and performs the EDAR proxy operation.<a href="#section-9-1" class="pilcrow">¶</a></p>
<div id="flow">
<section id="section-9.1">
        <h3 id="name-general-flow">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-general-flow" class="section-name selfRef">General Flow</a>
        </h3>
<p id="section-9.1-1">
   This specification enables to save the exchange of keep-alive Extended
   Duplicate Address messages, EDAR and EDAC, from a 6LN all the way to the 6LBR
   across a RPL mesh. Instead, the EDAR/EDAC exchange with the 6LBR is proxied
   by the RPL Root upon a DAO message that refreshes the RPL routing state.<a href="#section-9.1-1" class="pilcrow">¶</a></p>
<p id="section-9.1-2">
   To achieve this, the lifetimes and
   sequence counters in 6LoWPAN ND and RPL are aligned. In other words, the Path
   Sequence and the Path Lifetime in the DAO message are taken from the
   Transaction ID and the Address Registration lifetime in the NS(EARO) message
   from the 6LN.<a href="#section-9.1-2" class="pilcrow">¶</a></p>
<p id="section-9.1-3">
   The proxy operation applies to both RULs and RANs. In a RPL
   network where the function is enabled, refreshing the state in the 6LBR is
   the responsibility of the Root. Consequently, only addresses that are
   injected in RPL will be kept alive by the RPL Root.<a href="#section-9.1-3" class="pilcrow">¶</a></p>
<p id="section-9.1-4">
   In a same fashion, if an additional routing
   protocol is deployed on a same network, that additional routing protocol may
   need to handle the keep alive procedure for the addresses that it serves.<a href="#section-9.1-4" class="pilcrow">¶</a></p>
<p id="section-9.1-5">
   On the first Address Registration, illustrated in <a href="#fReg1" class="xref">Figure 5</a>
   and <a href="#fReg2bis" class="xref">Figure 8</a> for RPL Non-Storing and Storing Mode
   respectively, the Extended Duplicate Address exchange takes place as
   prescribed by <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span>. Any of the functions 6LR, Root and
   6LBR might be collapsed in a single node.<a href="#section-9.1-5" class="pilcrow">¶</a></p>
<p id="section-9.1-6">

   When successful, the flow creates a Neighbor Cache Entry (NCE) in the 6LR,
   and the 6LR injects the Registered Address in RPL using DAO/DAO-ACK
   exchanges all the way to the RPL DODAG Root.
   The protocol does not carry a specific information that the Extended
   Duplicate Address messages were already exchanged, so the Root proxies
   them anyway.<a href="#section-9.1-6" class="pilcrow">¶</a></p>
<div id="rnsm">
<section id="section-9.1.1">
          <h4 id="name-in-rpl-non-storing-mode">
<a href="#section-9.1.1" class="section-number selfRef">9.1.1. </a><a href="#name-in-rpl-non-storing-mode" class="section-name selfRef">In RPL Non-Storing-Mode</a>
          </h4>
<p id="section-9.1.1-1">
    In Non-Storing Mode, the DAO message flow can be nested within the Address
    Registration flow as illustrated in <a href="#fReg1" class="xref">Figure 5</a>.<a href="#section-9.1.1-1" class="pilcrow">¶</a></p>
<span id="name-first-registration-flow-in-"></span><div id="fReg1">
<figure id="figure-5">
            <div class="artwork art-text alignLeft" id="section-9.1.1-2.1">
<pre>
     6LN              6LR            Root               6LBR
      |                |              |                   |
      |   NS(EARO)     |              |                   |
      |---------------&gt;|                                  |
      |                |          Extended DAR            |
      |                |---------------------------------&gt;|
      |                |                                  |
      |                |          Extended DAC            |
      |                |&lt;---------------------------------|
      |                |      DAO     |                   |
      |                |-------------&gt;|                   |
      |                |              | (anonymous) EDAR  |
      |                |              |------------------&gt;|
      |                |              |       EDAC        |
      |                |              |&lt;------------------|
      |                |    DAO-ACK   |                   |
      |                |&lt;-------------|                   |
      |   NA(EARO)     |              |                   |
      |&lt;---------------|              |                   |
      |                |              |                   |
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-first-registration-flow-in-" class="selfRef">First Registration Flow in Non-Storing Mode</a>
            </figcaption></figure>
</div>
<p id="section-9.1.1-3">
   An issue may be detected later, e.g., the address moves within the LLN or to
   a different Root on a backbone <span>[<a href="#I-D.ietf-6lo-backbone-router" class="xref">6BBR</a>]</span>.
   In that case the value of the status that indicates the issue can be passed
   from 6LoWPAN ND to RPL and back as illustrated in <a href="#fReg1.5" class="xref">Figure 6</a>.<a href="#section-9.1.1-3" class="pilcrow">¶</a></p>
<span id="name-asynchronous-issue"></span><div id="fReg1.5">
<figure id="figure-6">
            <div class="artwork art-text alignLeft" id="section-9.1.1-4.1">
<pre>
     6LN                6LR           Root              6LBR
      |                  |             |                  |
      |                  |             | NA(EARO, Status) |
      |                  |             |&lt;-----------------|
      |                  | DCO(Status) |                  |
      |                  |&lt;------------|                  |
      | NA(EARO, Status) |             |                  |
      |&lt;-----------------|             |                  |
      |                  |             |                  |
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-asynchronous-issue" class="selfRef">Asynchronous Issue</a>
            </figcaption></figure>
</div>
<p id="section-9.1.1-5">
    An Address re-Registration is performed by the 6LN to maintain the NCE in the 6LR
    alive before lifetime expires. Upon an Address  re-Registration, as
    illustrated in <a href="#fReg2" class="xref">Figure 7</a>,
    the 6LR redistributes the Registered Address NS(EARO) in RPL.<a href="#section-9.1.1-5" class="pilcrow">¶</a></p>
<span id="name-next-registration-flow-in-n"></span><div id="fReg2">
<figure id="figure-7">
            <div class="artwork art-text alignLeft" id="section-9.1.1-6.1">
<pre>
     6LN              6LR            Root               6LBR
      |                |              |                   |
      |   NS(EARO)     |              |                   |
      |---------------&gt;|                                  |
      |                |      DAO     |                   |
      |                |-------------&gt;|                   |
      |                |              | (anonymous) EDAR  |
      |                |              |------------------&gt;|
      |                |              |       EDAC        |
      |                |              |&lt;------------------|
      |                |    DAO-ACK   |                   |
      |                |&lt;-------------|                   |
      |   NA(EARO)     |              |                   |
      |&lt;---------------|              |                   |
</pre>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-next-registration-flow-in-n" class="selfRef">Next Registration Flow in Non-Storing Mode</a>
            </figcaption></figure>
</div>
<p id="section-9.1.1-7">
    This causes the RPL DODAG Root to refresh the state in the 6LBR with an
    EDAC message or an anonymous EDAC if the ROVR is not indicated in the
    Target Option. In both cases, the EDAC message sent in response by the 6LBR
    contains the actual value of the ROVR field for that Address Registration.
    In case of an error on the proxied EDAR flow, the error MUST be
    returned in the DAO-ACK - if one was requested - using a RPL Status with the 'A' flag set that imbeds a 6LoWPAN Status value as discussed in <a href="#stat" class="xref">Section 7</a>.<a href="#section-9.1.1-7" class="pilcrow">¶</a></p>
<p id="section-9.1.1-8">
    If the Root could not return the negative Status in the DAO-ACK then it
    sends an asynchronous Destination Cleanup Object (DCO) message
    <span>[<a href="#I-D.ietf-roll-efficient-npdao" class="xref">EFFICIENT-NPDAO</a>]</span> to the 6LR placing the
    negative Status in the RPL Status with the 'A' flag set. Note that if both
    are used in a short
    interval of time, the DAO-ACK and DCO messages are not guaranteed to arrive
    in the same order at the 6LR.<a href="#section-9.1.1-8" class="pilcrow">¶</a></p>
<p id="section-9.1.1-9">
    The 6LR may still receive a requested DAO-ACK even after it received a
    DCO, but the negative Status in the DCO supercedes a positive
    Status in the DAO-ACK regardless of the order in which they are received.
    Upon the DAO-ACK - or the DCO if it arrives first - the 6LR responds to the
    RUL with a NA(EARO). If the RPL Status has the 'A' flag set, then the ND
    Status is extracted and passed in the EARO; else, if the 'E' flag is set,
    indicating a rejection, then the status 4 "Removed" is used; else, the
    ND Status of 0 indicating "Success" is used.<a href="#section-9.1.1-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="rsm">
<section id="section-9.1.2">
          <h4 id="name-in-rpl-storing-mode">
<a href="#section-9.1.2" class="section-number selfRef">9.1.2. </a><a href="#name-in-rpl-storing-mode" class="section-name selfRef">In RPL Storing-Mode</a>
          </h4>
<p id="section-9.1.2-1">
  In RPL Storing Mode, the DAO-ACK is optional. When it is used, it is generated
  by the RPL parent, which does not need to wait for the grand-parent to send
  the acknowledgement. A successful DAO-ACK is not a guarantee that the DAO
  has yet reached the Root or that the EDAR has succeeded.<a href="#section-9.1.2-1" class="pilcrow">¶</a></p>
<span id="name-next-registration-flow-in-s"></span><div id="fReg2bis">
<figure id="figure-8">
            <div class="artwork art-text alignLeft" id="section-9.1.2-2.1">
<pre>
6LN             6LR             6LR            Root              6LBR
 |               |               |               |                  |
 |   NS(EARO)    |               |               |                  |
 |--------------&gt;|               |               |                  |
 |   NA(EARO)    |               |               |                  |
 |&lt;--------------|               |               |                  |
 |               |               |               |                  |
 |               |      DAO      |               |                  |
 |               |--------------&gt;|               |                  |
 |               |    DAO-ACK    |               |                  |
 |               |&lt;--------------|               |                  |
 |               |               |               |                  |
 |               |               |      DAO      |                  |
 |               |               |--------------&gt;|                  |
 |               |               |    DAO-ACK    |                  |
 |               |               |&lt;--------------|                  |
 |               |               |               |                  |
 |               |               |               | (anonymous) EDAR |
 |               |               |               |-----------------&gt;|
 |               |               |               |   EDAC(ROVR)     |
 |               |               |               |&lt;-----------------|
 |               |               |               |                  |
</pre>
</div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a>:
<a href="#name-next-registration-flow-in-s" class="selfRef">Next Registration Flow in Storing Mode</a>
            </figcaption></figure>
</div>
<p id="section-9.1.2-3">
  If the keep-alive fails, or an asynchronous issue is reported,
  the path can be cleaned up asynchronously using a DCO message
  <span>[<a href="#I-D.ietf-roll-efficient-npdao" class="xref">EFFICIENT-NPDAO</a>]</span> as illustrated in
  <a href="#fReg2ter" class="xref">Figure 9</a> and described in further details in
  <a href="#Root" class="xref">Section 9.2.3</a>.<a href="#section-9.1.2-3" class="pilcrow">¶</a></p>
<span id="name-issue-in-storing-mode"></span><div id="fReg2ter">
<figure id="figure-9">
            <div class="artwork art-text alignLeft" id="section-9.1.2-4.1">
<pre>
6LN                6LR           6LR          Root              6LBR
 |                  |             |             |                  |
 |                  |             |             | NA(EARO, Status) |
 |                  |             |             |&lt;-----------------|
 |                  |             |             |                  |
 |                  |             | DCO(Status) |                  |
 |                  |             |&lt;------------|                  |
 |                  |             |             |                  |
 |                  | DCO(Status) |             |                  |
 |                  |&lt;------------|             |                  |
 |                  |             |             |                  |
 | NA(EARO, Status) |             |             |                  |
 |&lt;-----------------|             |             |                  |
 |                  |             |             |                  |
</pre>
</div>
<figcaption><a href="#figure-9" class="selfRef">Figure 9</a>:
<a href="#name-issue-in-storing-mode" class="selfRef">Issue in Storing Mode</a>
            </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="oper">
<section id="section-9.2">
        <h3 id="name-detailed-operation">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-detailed-operation" class="section-name selfRef">Detailed Operation</a>
        </h3>
<div id="ln">
<section id="section-9.2.1">
          <h4 id="name-by-the-6ln">
<a href="#section-9.2.1" class="section-number selfRef">9.2.1. </a><a href="#name-by-the-6ln" class="section-name selfRef">By the 6LN</a>
          </h4>
<p id="section-9.2.1-1">
  This specification does not alter the operation of a 6LoWPAN ND-compliant 6LN,
  and a RUL is expected to operate as follows:<a href="#section-9.2.1-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-9.2.1-2.1">
   The 6LN obtains an IPv6 global address, either using Stateless Address Autoconfiguration (SLAAC) <span>[<a href="#RFC4862" class="xref">RFC4862</a>]</span> based on a Prefix
   Information Option (PIO) <span>[<a href="#RFC4861" class="xref">RFC4861</a>]</span> found in a Router
   Advertisement message, or some other means such as DHCPv6
   <span>[<a href="#RFC3315" class="xref">RFC3315</a>]</span>.<a href="#section-9.2.1-2.1" class="pilcrow">¶</a>
</li>
<li id="section-9.2.1-2.2">
   Once it has formed an address, the 6LN (re)registers its address periodically,
   within the Lifetime of the previous Address Registration, as prescribed by
<span>[<a href="#RFC6775" class="xref">RFC6775</a>]</span> and <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span>.<a href="#section-9.2.1-2.2" class="pilcrow">¶</a>
</li>
<li id="section-9.2.1-2.3">
   The 6LN can register to more than one 6LR at the same time. In that case, it
   MUST use the same value of TID for all of the parallel Address Registrations.<a href="#section-9.2.1-2.3" class="pilcrow">¶</a>
</li>
<li id="section-9.2.1-2.4">
   Following section 5.1 of <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span>,
   a 6LN acting as a RUL sets the "R" flag in the EARO of at least one
   registration, whereas acting as a RAN it never does.
   If the "R" flag is set in the NS but not echoed in the NA, the RUL SHOULD
   attempt to use another 6LR.<a href="#section-9.2.1-2.4" class="pilcrow">¶</a>
</li>
<li id="section-9.2.1-2.5">
   Upon each consecutive Address Registration, the 6LN increases the TID field in the
   EARO, as prescribed by <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span> section 5.2.<a href="#section-9.2.1-2.5" class="pilcrow">¶</a>
</li>
<li id="section-9.2.1-2.6">
   The 6LN may use any of the 6LRs to which it register to forward its packets.
   Using a 6LR to which the 6LN is not registered may result in packets dropped
   at the 6LR by a Source Address Validation function (SAVI) so it is NOT RECOMMENDED.<a href="#section-9.2.1-2.6" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-9.2.1-3"><a href="#section-9.2.1-3" class="pilcrow">¶</a></p>
<p id="section-9.2.1-4">
   Even without support for RPL, a RUL may be aware of opaque values to be
   provided to the routing protocol. If the RUL has a knowledge of the RPL
   Instance the packet should be injected into, then it SHOULD set the Opaque
   field in the EARO to the RPLInstanceID, else it MUST leave the Opaque field
   to zero.<a href="#section-9.2.1-4" class="pilcrow">¶</a></p>
<p id="section-9.2.1-5">
   Regardless of the setting of the Opaque field, the 6LN MUST set the "I"
   field to zero to signal "topological information to be passed to a routing
   process" as specified in section 5.1 of <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span>.<a href="#section-9.2.1-5" class="pilcrow">¶</a></p>
<p id="section-9.2.1-6">
   A RUL is not expected to produce RPL artifacts in the data packets, but it
   MAY do so. For instance, if the RUL has a minimal awareness of the RPL
   Instance then it can build an RPI. A RUL that places an RPI in a data packet
   MUST indicate the RPLInstanceID that corresponds to the RPL Instance the
   packet should be injected into. All the flags and the Rank field are set
   to zero as specified by section 11.2 of <span>[<a href="#RFC6550" class="xref">RFC6550</a>]</span>.<a href="#section-9.2.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="lr">
<section id="section-9.2.2">
          <h4 id="name-by-the-6lr">
<a href="#section-9.2.2" class="section-number selfRef">9.2.2. </a><a href="#name-by-the-6lr" class="section-name selfRef">By the 6LR</a>
          </h4>
<p id="section-9.2.2-1">
   Also as prescribed by <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span>,
   the 6LR generates an EDAR message upon reception of a valid NS(EARO)
   message for the Address Registration of a new IPv6 Address by a 6LN. If the Duplicate
   Address exchange succeeds, then the 6LR installs an NCE.
   If the "R" flag was set in the EARO of the NS message, and this 6LR can
   manage the reachability of Registered Address, then the 6LR sets the "R" flag
   in the EARO of the NA message that is sends in response.<a href="#section-9.2.2-1" class="pilcrow">¶</a></p>
<p id="section-9.2.2-2">From then on, the 6LN periodically sends a new NS(EARO) to refresh the NCE
   state before the lifetime indicated in the EARO expires, with TID that is
   incremented each time till it wraps in a lollipop fashion (see section 5.2.1
   of <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span> which is fully compatible with section 7.2 of
<span>[<a href="#RFC6550" class="xref">RFC6550</a>]</span>). As long as the "R"
   flag is set and this Router can still manage the reachability of Registered
   Address, the 6LR keeps setting the "R" flag in the EARO of the response NA
   message, but the exchange of keep-alive Extended Duplicate Address messages
   with the 6LBR is avoided if the RPL Root has indicated that it proxies for it.<a href="#section-9.2.2-2" class="pilcrow">¶</a></p>
<p id="section-9.2.2-3">
   The Opaque field in the EARO hints the 6LR on the RPL Instance that should
   be used for the DAO advertisements, and for the forwarding of packets sourced
   at the registered address when there is no RPI in the packet, in which case
   the 6LR MUST encapsulate the packet to the Root adding an RPI in the
   outer header.
   If the Opaque field is zero, the 6LR is free to use the default RPL Instance
   (zero) for the registered address or to select an Instance of its choice.<a href="#section-9.2.2-3" class="pilcrow">¶</a></p>
<p id="section-9.2.2-4">
   if the "I" field is not zero, then the 6LR MUST consider that the Opaque
   field is zero. If the Opaque field is not zero, then it is expected to
   carry a RPLInstanceID for the RPL Instance suggested by the 6LN.
   If the 6LR does not participate to the associated Instance, then the 6LR MUST
   consider that the Opaque field is zero;
   else, that is if the 6LR participates to the suggested Instance, then the
   6LR SHOULD use that Instance for the registered address.<a href="#section-9.2.2-4" class="pilcrow">¶</a></p>
<p id="section-9.2.2-5">
  The DAO message advertising the Registered Address MUST be constructed as
  follows:<a href="#section-9.2.2-5" class="pilcrow">¶</a></p>
<ul>
<li id="section-9.2.2-6.1">The Registered Address is placed in a RPL Target Option in the DAO
  message as the Target Prefix, and the Prefix Length is set to 128;<a href="#section-9.2.2-6.1" class="pilcrow">¶</a>
</li>
<li id="section-9.2.2-6.2">
  RPL Non-Storing Mode is used, and the 6LR indicates one of its global or unique-local IPv6 unicast addresses as the Parent Address in the associated
  RPL Transit Information Option (TIO).<a href="#section-9.2.2-6.2" class="pilcrow">¶</a>
</li>
<li id="section-9.2.2-6.3">
  the External 'E' flag in the TIO is set to indicate that the 6LR redistributes
  an external target into the RPL network.<a href="#section-9.2.2-6.3" class="pilcrow">¶</a>
</li>
<li id="section-9.2.2-6.4">
  the Path Lifetime in the TIO is computed from the Lifetime in the EARO Option
  to adapt it to the Lifetime Units used in the RPL operation. Note that if the
  lifetime is 0, then the 6LR generates a No-Path DAO message that cleans up
  the routes down to the Address of the 6LN;<a href="#section-9.2.2-6.4" class="pilcrow">¶</a>
</li>
<li id="section-9.2.2-6.5">
  the Path Sequence in the TIO is set to the TID value found in the EARO option;<a href="#section-9.2.2-6.5" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-9.2.2-7"><a href="#section-9.2.2-7" class="pilcrow">¶</a></p>
<p id="section-9.2.2-8">
   Upon an NS(EARO), iff the "R" flag was set, the 6LR SHOULD inject the Registered Address in RPL by sending a DAO message on behalf of the 6LN.
   If the Registration Lifetime was 0, the effect is to remove the route and
   then the NCE.<a href="#section-9.2.2-8" class="pilcrow">¶</a></p>
<p id="section-9.2.2-9">
   If for whatever reason the 6LR does not inject the Registered Address in RPL,
   it MUST send an NA(EARO) back with the appropriate status and the "R" flag
   not set.<a href="#section-9.2.2-9" class="pilcrow">¶</a></p>
<p id="section-9.2.2-10">
   If the 6LR injects the Registered Address in RPL and either a DAO-ACK was not
   requested or is received with a RPL Status that is not a rejection ("E" flag
   not set), the 6LR MUST install or refresh the NCE for the address and reply
   to the RUL with an NA(EARO) with a Status of 0 (Success) and the "R" flag set.<a href="#section-9.2.2-10" class="pilcrow">¶</a></p>
<p id="section-9.2.2-11">
   In case of a DAO-ACK or a DCO indicating transporting an EARO
   Status Value of 5 (Validation Requested), a 6LR that supports
   Address Protected Neighbor Discovery (AP-ND) MUST
   challenge the 6LN for ownership of the address, as described in section
   6.1 of <span>[<a href="#I-D.ietf-6lo-ap-nd" class="xref">AP-ND</a>]</span>. If the challenge succeeds then
   the operations continue as normal. In particular a DAO message is generated
   upon the NS(EARO) that proves the ownership of the address. If the challenge
   failed, the 6LR rejects the registration as prescribed by AP-ND and may take
   actions to protect itself against DoS attacks by a rogue 6LN, see
   <a href="#security-considerations" class="xref">Section 11</a>. If the 6LR does not
   support AP-ND, it MUST send an NA to the 6LN with a Status of 0 (Success) and
   the "R" flag not set.<a href="#section-9.2.2-11" class="pilcrow">¶</a></p>
<p id="section-9.2.2-12">
   The other rejection codes indicate that the 6LR failed to inject the address
   into the RPL network. If an EARO Status is transported, the 6LR MUST send a
   NA(EARO) to the RUL with that Status value, and the "R" flag not set. Similarly, upon receiving a DCO message indicating that the address of a RUL
   should be removed from the routing table, the 6LR issues an asynchronous NA(EARO) to the RUL with the embedded ND Status value if there was one, and
   the "R" flag not set.<a href="#section-9.2.2-12" class="pilcrow">¶</a></p>
<p id="section-9.2.2-13">

   If a 6LR receives a valid NS(EARO) message with the "R" flag reset and a
   Registration Lifetime that is not 0, and the 6LR
   was redistributing the Registered Address due to previous NS(EARO) messages
   with the flag set, then it MUST stop injecting the address.
   It is up to the Registering 6LN to maintain the corresponding route from then
   on, either keeping it active via a different 6LR or by acting as a RAN and
   managing its own reachability.<a href="#section-9.2.2-13" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Root">
<section id="section-9.2.3">
          <h4 id="name-by-the-rpl-root">
<a href="#section-9.2.3" class="section-number selfRef">9.2.3. </a><a href="#name-by-the-rpl-root" class="section-name selfRef">By the RPL Root</a>
          </h4>
<p id="section-9.2.3-1">
   In RPL Storing Mode of Operation (MOP), the DAO message is propagated from
   child to parent all the way to the Root along the DODAG, populating routing
   state as it goes. In Non-Storing Mode, The DAO message is sent directly to the
   RPL Root.
   Upon reception of a DAO message, for each RPL Target option that creates or
   updates an existing RPL state:<a href="#section-9.2.3-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-9.2.3-2.1">
   the Root notifies the 6LBR using an internal API if they are co-located, or
   using a proxied EDAR/EDAC exchange if they are separated. If the RPL Target
   option transports a ROVR, then the Root MUST use it to build
   a full EDAR message; else, an anonymous EDAR is used with
   the ROVR field set to zero.<a href="#section-9.2.3-2.1" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-9.2.3-3"><a href="#section-9.2.3-3" class="pilcrow">¶</a></p>
<p id="section-9.2.3-4">
  The EDAR  message MUST be constructed as follows:<a href="#section-9.2.3-4" class="pilcrow">¶</a></p>
<ul>
<li id="section-9.2.3-5.1">
  The Target IPv6 address from the RPL Target Option is placed in the
  Registered Address field of the EDAR message;<a href="#section-9.2.3-5.1" class="pilcrow">¶</a>
</li>
<li id="section-9.2.3-5.2">
  the Registration Lifetime is adapted from the Path Lifetime in the TIO by
  converting the Lifetime Units used in RPL into units of 60 seconds used in the
  6LoWPAN ND messages;<a href="#section-9.2.3-5.2" class="pilcrow">¶</a>
</li>
<li id="section-9.2.3-5.3">
              
  the TID value is set to the Path Sequence in the TIO and indicated with an ICMP
  code of 1 in the EDAR message;<a href="#section-9.2.3-5.3" class="pilcrow">¶</a>
</li>
<li id="section-9.2.3-5.4">
  If the ROVR is present in the RPL Target option, it is copied as is in the
  EDAR and the ICMP Code Suffix is set to the appropriate value as shown in
  Table 4 of <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span> depending on the size of the ROVR field;
  else, the ROVR field in the EDAR is set to zero indicating an anonymous EDAR.<a href="#section-9.2.3-5.4" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-9.2.3-6"><a href="#section-9.2.3-6" class="pilcrow">¶</a></p>
<p id="section-9.2.3-7">
  Upon a Status value in an EDAC message that is not "Success", the Root SHOULD
  destroy the formed paths using either a DAO-ACK (in Non-Storing Mode) or a DCO
  downwards as specified in <span>[<a href="#I-D.ietf-roll-efficient-npdao" class="xref">EFFICIENT-NPDAO</a>]</span>.
  Failure to destroy the former path would result in Stale routing state and
  local black holes if the address belongs to another party elsewhere in the
  network. The RPL Status value that maps the 6LoWPAN ND Status value MUST be
  embedded in the RPL Status in the DCO.<a href="#section-9.2.3-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="lbr">
<section id="section-9.2.4">
          <h4 id="name-by-the-6lbr">
<a href="#section-9.2.4" class="section-number selfRef">9.2.4. </a><a href="#name-by-the-6lbr" class="section-name selfRef">By the 6LBR</a>
          </h4>
<p id="section-9.2.4-1">
   Upon reception of an EDAR message with the ROVR field is set to zero
   indicating an anonymous EDAR, the 6LBR checks whether an entry exists for the
   and computes whether the TID in the DAR message is fresher than that in the
   entry as prescribed in section 4.2.1. of <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span>.<a href="#section-9.2.4-1" class="pilcrow">¶</a></p>
<p id="section-9.2.4-2">
   If the entry does not exist, the 6LBR does not create the entry, and answers
   with a Status "Removed" in the EDAC message.
   If the entry exists but is not fresher, the 6LBR does not update the entry,
   and answers with a Status "Success" in the EDAC message.<a href="#section-9.2.4-2" class="pilcrow">¶</a></p>
<p id="section-9.2.4-3">
   If the entry exists and the TID in the DAR message is fresher, the 6LBR
   updates the TID in the entry, and if the
   lifetime of the entry is extended by the Registration Lifetime in the DAR
   message, it also updates the lifetime of the entry.
   In that case, the 6LBR replies with a Status "Success" in the DAC message.<a href="#section-9.2.4-3" class="pilcrow">¶</a></p>
<p id="section-9.2.4-4">
   The EDAC that is constructed is the same as if the anonymous EDAR was a full
   EDAR, and includes the ROVR that is associated to the Address Registration.<a href="#section-9.2.4-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="multiop">
<section id="section-10">
      <h2 id="name-protocol-operations-for-mul">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-protocol-operations-for-mul" class="section-name selfRef">Protocol Operations for Multicast Addresses</a>
      </h2>
<p id="section-10-1"> Section 12 of <span>[<a href="#RFC6550" class="xref">RFC6550</a>]</span> details the RPL support for
    multicast flows. This support is not source-specific and only operates as
    an extension to the Storing Mode of Operation for unicast packets. Note that
    it is the RPL model that the multicast packet is passed as a Layer-2 unicast
    to each if the interested children.
    This remains true when forwarding between the 6LR and the listener 6LN.<a href="#section-10-1" class="pilcrow">¶</a></p>
<p id="section-10-2">
 <span><a href="#RFC2710" class="xref">"Multicast Listener Discovery (MLD) for IPv6"</a> [<a href="#RFC2710" class="xref">RFC2710</a>]</span>
    and its updated version <span><a href="#RFC3810" class="xref">"Multicast Listener Discovery Version 2 (MLDv2) for IPv6"</a> [<a href="#RFC3810" class="xref">RFC3810</a>]</span> provide an
    interface for a listener to register to multicast flows.
    MLDv2 is backwards compatible with MLD, and adds in particular the
    capability to filter the sources via black lists and white lists.
    In the MLD model, the Router is a "querier" and the Host is a multicast
    listener that registers to the querier to obtain copies of the particular
    flows it is interested in.<a href="#section-10-2" class="pilcrow">¶</a></p>
<p id="section-10-3">
     On the first Address Registration, as illustrated in <a href="#fReg3" class="xref">Figure 10</a>, the
     6LN, as an MLD listener, sends an unsolicited Report to the 6LR in order to
     start receiving the flow immediately. Since multicast Layer-2 messages are
     avoided, it is important that the asynchronous messages for unsolicited
     Report and Done are sent reliably, for instance using an Layer-2
     acknoledgement, or attempted multiple times.<a href="#section-10-3" class="pilcrow">¶</a></p>
<span id="name-first-multicast-registratio"></span><div id="fReg3">
<figure id="figure-10">
        <div class="artwork art-text alignLeft" id="section-10-4.1">
<pre>
     6LN                  6LR             Root                6LBR
      |                    |               |                    |
      | unsolicited Report |               |                    |
      |-------------------&gt;|               |                    |
      |     &lt;L2 ack&gt;       |               |                    |
      |                    | DAO           |                    |
      |                    |--------------&gt;|                    |
      |                    |    DAO-ACK    |                    |
      |                    |&lt;--------------|                    |
      |                    |               | &lt;if not listening&gt; |
      |                    |               | unsolicited Report |
      |                    |               |-------------------&gt;|
      |                    |               |                    |
      |                    |               |                    |
</pre>
</div>
<figcaption><a href="#figure-10" class="selfRef">Figure 10</a>:
<a href="#name-first-multicast-registratio" class="selfRef">First Multicast Registration Flow</a>
        </figcaption></figure>
</div>
<p id="section-10-5">
     The 6LR acts as a generic MLD querier and generates a DAO for the multicast
     target. The lifetime of the DAO is set to be in the order of the Query
     Interval, yet larger to account for variable propagation delays.<a href="#section-10-5" class="pilcrow">¶</a></p>
<p id="section-10-6">
     The Root proxies the MLD echange as listener with the 6LBR acting as the
     querier, so as to get packets from a source external to the RPL domain.
     Upon a DAO with a multicast target, the RPL Root checks if it is
     already registered as a listener for that address, and if not, it performs
     its own unsolicited Report for the multicast target.<a href="#section-10-6" class="pilcrow">¶</a></p>
<p id="section-10-7">
    An Address re-Registration is pulled periodically by 6LR acting as querier.
    Note that th  message may be sent unicast to all the known individual
    listeners. Upon a
    time out of the Query Interval, the 6LR sends a Query to each of its
    listeners, and gets a Report back that is mapped into a DAO, as illustrated
    in <a href="#fReg4" class="xref">Figure 11</a>:<a href="#section-10-7" class="pilcrow">¶</a></p>
<span id="name-next-registration-flow"></span><div id="fReg4">
<figure id="figure-11">
        <div class="artwork art-text alignLeft" id="section-10-8.1">
<pre>
     6LN                  6LR             Root                6LBR
      |                    |               |                    |
      |       Query        |               |                    |
      |&lt;-------------------|               |                    |
      |       Report       |               |                    |
      |-------------------&gt;|               |                    |
      |                    | DAO           |                    |
      |                    |--------------&gt;|                    |
      |                    |    DAO-ACK    |                    |
      |                    |&lt;--------------|                    |
      |                    |               |                    |
      |                    |               |       Query        |
      |                    |               |&lt;-------------------|
      |                    |               |       Report       |
      |                    |               |-------------------&gt;|
      |                    |               |                    |
      |                    |               |                    |
</pre>
</div>
<figcaption><a href="#figure-11" class="selfRef">Figure 11</a>:
<a href="#name-next-registration-flow" class="selfRef">Next Registration Flow</a>
        </figcaption></figure>
</div>
<p id="section-10-9">Note that any of the functions 6LR, Root and 6LBR might be collapsed in a
    single node, in which case the flow above happens internally, and possibly
    through internal API calls as opposed to messaging.<a href="#section-10-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-considerations">
<section id="section-11">
      <h2 id="name-security-considerations">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-11-1">
 The LLN nodes depend on the 6LBR and the RPL participants for their
    operation.
 A trust model must be put in place to ensure that the right devices are
 acting in these roles, so as to avoid threats such as black-holing,
        (see <span>[<a href="#RFC7416" class="xref">RFC7416</a>]</span> section 7)
 or bombing attack whereby an impersonated 6LBR would destroy state in
 the network by using the "Removed" Status code.<a href="#section-11-1" class="pilcrow">¶</a></p>
<p id="section-11-2">
    This trust model could be
    at a minimum based on a Layer-2 Secure joining and the Link-Layer security.
    This is a generic 6LoWPAN requirement, see Req5.1 in Appendix of <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span>.<a href="#section-11-2" class="pilcrow">¶</a></p>
<p id="section-11-3">
    Additionally, the trust model could include a role validation
    to ensure that the node that claims to be a 6LBR or a RPL Root is entitled
    to do so.<a href="#section-11-3" class="pilcrow">¶</a></p>
<p id="section-11-4">
    The anonymous EDAR message does not carry a valid Registration Unique ID
    <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span> in the form of a ROVR and may be played by any node
    on the network without the need to know the ROVR.
    The 6LBR MUST NOT create an entry based on a
    anonymous EDAR that does not match an existing entry. All it can do is
    refresh the lifetime and the TID of an existing entry. So the
    message cannot be used to create a binding state in the 6LBR but it can be
 use to maitain one active longer than expected.<a href="#section-11-4" class="pilcrow">¶</a></p>
<p id="section-11-5">
 Note that a full EDAR message
 with a lifetime of 0 will destroy that state and the anonymous message will not recreate it. Note also that a rogue that has access to the network can attack the 6LBR with other (forged) addresses and ROVR, and that this is a much easier DoS
 attack than trying to keep existing state alive longer.<a href="#section-11-5" class="pilcrow">¶</a></p>
<p id="section-11-6">
    At the time of this writing RPL does not have a zerotrust model whereby
    the it is possible to validate the origin of an address that is injected
    in a DAO. This specification makes a first step in that direction by
    allowing the Root to challenge the RUL by the 6LR that serves it.<a href="#section-11-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-12">
      <h2 id="name-iana-considerations">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<div id="iana-aro">
<section id="section-12.1">
        <h3 id="name-resizing-the-aro-status-val">
<a href="#section-12.1" class="section-number selfRef">12.1. </a><a href="#name-resizing-the-aro-status-val" class="section-name selfRef">Resizing the ARO Status values</a>
        </h3>
<p id="section-12.1-1"> IANA is requested to modify the
    Address Registration Option Status Values Registry as follows:
    The unassigned values range is reduced from 11-255 to 11-63.<a href="#section-12.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-conf">
<section id="section-12.2">
        <h3 id="name-new-dodag-configuration-opt">
<a href="#section-12.2" class="section-number selfRef">12.2. </a><a href="#name-new-dodag-configuration-opt" class="section-name selfRef">New DODAG Configuration Option Flag</a>
        </h3>
<p id="section-12.2-1">
    This specification updates the Registry for the "DODAG Configuration Option
    Flags" that was created for <span>[<a href="#RFC6550" class="xref">RFC6550</a>]</span> as follows:<a href="#section-12.2-1" class="pilcrow">¶</a></p>
<span id="name-new-dodag-configuration-opti"></span><div id="nexndopt">
<table class="center" id="table-2">
          <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-new-dodag-configuration-opti" class="selfRef">New DODAG Configuration Option Flag</a>
          </caption>
<thead>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Bit Number</td>
              <td class="text-left" rowspan="1" colspan="1">Capability Description</td>
              <td class="text-left" rowspan="1" colspan="1">Reference</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">Root Proxies EDAR/EDAC (P)</td>
              <td class="text-left" rowspan="1" colspan="1">THIS RFC</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="iana-lgds">
<section id="section-12.3">
        <h3 id="name-rpl-target-option-flags">
<a href="#section-12.3" class="section-number selfRef">12.3. </a><a href="#name-rpl-target-option-flags" class="section-name selfRef">RPL Target Option Flags</a>
        </h3>
<p id="section-12.3-1">Section 20.15 of <span>[<a href="#RFC6550" class="xref">RFC6550</a>]</span> creates a registry for the 8-bit
    RPL Target Option Flags field. This specification reduces the field to 4
    bits. The IANA is requested to reduce the size of the registry accordingly.<a href="#section-12.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-stats-nonrej">
<section id="section-12.4">
        <h3 id="name-new-subregistry-for-the-rpl">
<a href="#section-12.4" class="section-number selfRef">12.4. </a><a href="#name-new-subregistry-for-the-rpl" class="section-name selfRef">New Subregistry for the RPL Non-Rejection Status values</a>
        </h3>
<p id="section-12.4-1">
 This specification creates a new Subregistry for the RPL Non-Rejection Status values
    for use in RPL DAO-ACK and RCO messages, under the ICMPv6 parameters registry.<a href="#section-12.4-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-12.4-2.1"> Possible values are 6-bit unsigned integers (0..63).<a href="#section-12.4-2.1" class="pilcrow">¶</a>
</li>
<li id="section-12.4-2.2"> Registration procedure is "Standards Action" <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>.<a href="#section-12.4-2.2" class="pilcrow">¶</a>
</li>
<li id="section-12.4-2.3"> Initial allocation is as indicated in <a href="#iana-ack-Status" class="xref">Table 3</a>:<a href="#section-12.4-2.3" class="pilcrow">¶</a>
</li>
</ul>
<span id="name-acceptance-values-of-the-rp"></span><div id="iana-ack-Status">
<table class="center" id="table-3">
          <caption>
<a href="#table-3" class="selfRef">Table 3</a>:
<a href="#name-acceptance-values-of-the-rp" class="selfRef">Acceptance values of the RPL Status</a>
          </caption>
<thead>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Value</td>
              <td class="text-left" rowspan="1" colspan="1">Meaning</td>
              <td class="text-left" rowspan="1" colspan="1">Reference</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0</td>
              <td class="text-left" rowspan="1" colspan="1">Unqualified acceptance</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 6550</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="iana-stats-rej">
<section id="section-12.5">
        <h3 id="name-new-subregistry-for-the-rpl-">
<a href="#section-12.5" class="section-number selfRef">12.5. </a><a href="#name-new-subregistry-for-the-rpl-" class="section-name selfRef">New Subregistry for the RPL Rejection Status values</a>
        </h3>
<p id="section-12.5-1">
 This specification creates a new Subregistry for the RPL Rejection Status values
    for use in RPL DAO-ACK and RCO messages, under the ICMPv6 parameters registry.<a href="#section-12.5-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-12.5-2.1"> Possible values are 6-bit unsigned integers (0..63).<a href="#section-12.5-2.1" class="pilcrow">¶</a>
</li>
<li id="section-12.5-2.2"> Registration procedure is "Standards Action" <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>.<a href="#section-12.5-2.2" class="pilcrow">¶</a>
</li>
<li id="section-12.5-2.3"> Initial allocation is as indicated in <a href="#iana-nack-Status" class="xref">Table 4</a>:<a href="#section-12.5-2.3" class="pilcrow">¶</a>
</li>
</ul>
<span id="name-rejection-values-of-the-rpl"></span><div id="iana-nack-Status">
<table class="center" id="table-4">
          <caption>
<a href="#table-4" class="selfRef">Table 4</a>:
<a href="#name-rejection-values-of-the-rpl" class="selfRef">Rejection values of the RPL Status</a>
          </caption>
<thead>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Value</td>
              <td class="text-left" rowspan="1" colspan="1">Meaning</td>
              <td class="text-left" rowspan="1" colspan="1">Reference</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0</td>
              <td class="text-left" rowspan="1" colspan="1">Unqualified rejection</td>
              <td class="text-left" rowspan="1" colspan="1">This document</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
</section>
</div>
<div id="acknowledgments">
<section id="section-13">
      <h2 id="name-acknowledgments">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="section-13-1">
   The authors wish to thank Georgios Papadopoulos
   for their early reviews of and contributions to this document<a href="#section-13-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-14">
      <h2 id="name-normative-references">
<a href="#section-14" class="section-number selfRef">14. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
      </h2>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
<dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dt id="RFC2710">[RFC2710]</dt>
<dd>
<span class="refAuthor">Deering, S.</span><span class="refAuthor">, Fenner, W.</span><span class="refAuthor">, and B. Haberman</span>, <span class="refTitle">"Multicast Listener Discovery (MLD) for IPv6"</span>, <span class="seriesInfo">RFC 2710</span>, <span class="seriesInfo">DOI 10.17487/RFC2710</span>, <time datetime="1999-10">October 1999</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2710">https://www.rfc-editor.org/info/rfc2710</a>&gt;</span>. </dd>
<dt id="RFC3810">[RFC3810]</dt>
<dd>
<span class="refAuthor">Vida, R., Ed.</span><span class="refAuthor"> and L. Costa, Ed.</span>, <span class="refTitle">"Multicast Listener Discovery Version 2 (MLDv2) for IPv6"</span>, <span class="seriesInfo">RFC 3810</span>, <span class="seriesInfo">DOI 10.17487/RFC3810</span>, <time datetime="2004-06">June 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3810">https://www.rfc-editor.org/info/rfc3810</a>&gt;</span>. </dd>
<dt id="RFC4919">[RFC4919]</dt>
<dd>
<span class="refAuthor">Kushalnagar, N.</span><span class="refAuthor">, Montenegro, G.</span><span class="refAuthor">, and C. Schumacher</span>, <span class="refTitle">"IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs): Overview, Assumptions, Problem Statement, and Goals"</span>, <span class="seriesInfo">RFC 4919</span>, <span class="seriesInfo">DOI 10.17487/RFC4919</span>, <time datetime="2007-08">August 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4919">https://www.rfc-editor.org/info/rfc4919</a>&gt;</span>. </dd>
<dt id="RFC4861">[RFC4861]</dt>
<dd>
<span class="refAuthor">Narten, T.</span><span class="refAuthor">, Nordmark, E.</span><span class="refAuthor">, Simpson, W.</span><span class="refAuthor">, and H. Soliman</span>, <span class="refTitle">"Neighbor Discovery for IP version 6 (IPv6)"</span>, <span class="seriesInfo">RFC 4861</span>, <span class="seriesInfo">DOI 10.17487/RFC4861</span>, <time datetime="2007-09">September 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4861">https://www.rfc-editor.org/info/rfc4861</a>&gt;</span>. </dd>
<dt id="RFC4862">[RFC4862]</dt>
<dd>
<span class="refAuthor">Thomson, S.</span><span class="refAuthor">, Narten, T.</span><span class="refAuthor">, and T. Jinmei</span>, <span class="refTitle">"IPv6 Stateless Address Autoconfiguration"</span>, <span class="seriesInfo">RFC 4862</span>, <span class="seriesInfo">DOI 10.17487/RFC4862</span>, <time datetime="2007-09">September 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4862">https://www.rfc-editor.org/info/rfc4862</a>&gt;</span>. </dd>
<dt id="RFC6550">[RFC6550]</dt>
<dd>
<span class="refAuthor">Winter, T., Ed.</span><span class="refAuthor">, Thubert, P., Ed.</span><span class="refAuthor">, Brandt, A.</span><span class="refAuthor">, Hui, J.</span><span class="refAuthor">, Kelsey, R.</span><span class="refAuthor">, Levis, P.</span><span class="refAuthor">, Pister, K.</span><span class="refAuthor">, Struik, R.</span><span class="refAuthor">, Vasseur, JP.</span><span class="refAuthor">, and R. Alexander</span>, <span class="refTitle">"RPL: IPv6 Routing Protocol for Low-Power and Lossy Networks"</span>, <span class="seriesInfo">RFC 6550</span>, <span class="seriesInfo">DOI 10.17487/RFC6550</span>, <time datetime="2012-03">March 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6550">https://www.rfc-editor.org/info/rfc6550</a>&gt;</span>. </dd>
<dt id="RFC6553">[RFC6553]</dt>
<dd>
<span class="refAuthor">Hui, J.</span><span class="refAuthor"> and JP. Vasseur</span>, <span class="refTitle">"The Routing Protocol for Low-Power and Lossy Networks (RPL) Option for Carrying RPL Information in Data-Plane Datagrams"</span>, <span class="seriesInfo">RFC 6553</span>, <span class="seriesInfo">DOI 10.17487/RFC6553</span>, <time datetime="2012-03">March 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6553">https://www.rfc-editor.org/info/rfc6553</a>&gt;</span>. </dd>
<dt id="RFC6775">[RFC6775]</dt>
<dd>
<span class="refAuthor">Shelby, Z., Ed.</span><span class="refAuthor">, Chakrabarti, S.</span><span class="refAuthor">, Nordmark, E.</span><span class="refAuthor">, and C. Bormann</span>, <span class="refTitle">"Neighbor Discovery Optimization for IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs)"</span>, <span class="seriesInfo">RFC 6775</span>, <span class="seriesInfo">DOI 10.17487/RFC6775</span>, <time datetime="2012-11">November 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6775">https://www.rfc-editor.org/info/rfc6775</a>&gt;</span>. </dd>
<dt id="RFC7400">[RFC7400]</dt>
<dd>
<span class="refAuthor">Bormann, C.</span>, <span class="refTitle">"6LoWPAN-GHC: Generic Header Compression for IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs)"</span>, <span class="seriesInfo">RFC 7400</span>, <span class="seriesInfo">DOI 10.17487/RFC7400</span>, <time datetime="2014-11">November 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7400">https://www.rfc-editor.org/info/rfc7400</a>&gt;</span>. </dd>
<dt id="RFC8126">[RFC8126]</dt>
<dd>
<span class="refAuthor">Cotton, M.</span><span class="refAuthor">, Leiba, B.</span><span class="refAuthor">, and T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time datetime="2017-06">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dt id="RFC8138">[RFC8138]</dt>
<dd>
<span class="refAuthor">Thubert, P., Ed.</span><span class="refAuthor">, Bormann, C.</span><span class="refAuthor">, Toutain, L.</span><span class="refAuthor">, and R. Cragie</span>, <span class="refTitle">"IPv6 over Low-Power Wireless Personal Area Network (6LoWPAN) Routing Header"</span>, <span class="seriesInfo">RFC 8138</span>, <span class="seriesInfo">DOI 10.17487/RFC8138</span>, <time datetime="2017-04">April 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8138">https://www.rfc-editor.org/info/rfc8138</a>&gt;</span>. </dd>
<dt id="RFC8174">[RFC8174]</dt>
<dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dt id="RFC8200">[RFC8200]</dt>
<dd>
<span class="refAuthor">Deering, S.</span><span class="refAuthor"> and R. Hinden</span>, <span class="refTitle">"Internet Protocol, Version 6 (IPv6) Specification"</span>, <span class="seriesInfo">STD 86</span>, <span class="seriesInfo">RFC 8200</span>, <span class="seriesInfo">DOI 10.17487/RFC8200</span>, <time datetime="2017-07">July 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8200">https://www.rfc-editor.org/info/rfc8200</a>&gt;</span>. </dd>
<dt id="RFC8505">[RFC8505]</dt>
<dd>
<span class="refAuthor">Thubert, P., Ed.</span><span class="refAuthor">, Nordmark, E.</span><span class="refAuthor">, Chakrabarti, S.</span><span class="refAuthor">, and C. Perkins</span>, <span class="refTitle">"Registration Extensions for IPv6 over Low-Power Wireless Personal Area Network (6LoWPAN) Neighbor Discovery"</span>, <span class="seriesInfo">RFC 8505</span>, <span class="seriesInfo">DOI 10.17487/RFC8505</span>, <time datetime="2018-11">November 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8505">https://www.rfc-editor.org/info/rfc8505</a>&gt;</span>. </dd>
<dt id="I-D.ietf-6lo-ap-nd">[AP-ND]</dt>
<dd>
<span class="refAuthor">Thubert, P.</span><span class="refAuthor">, Sarikaya, B.</span><span class="refAuthor">, Sethi, M.</span><span class="refAuthor">, and R. Struik</span>, <span class="refTitle">"Address Protected Neighbor Discovery for Low-power and Lossy Networks"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-6lo-ap-nd-19</span>, <time datetime="2020-02-06">6 February 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-6lo-ap-nd-19">https://tools.ietf.org/html/draft-ietf-6lo-ap-nd-19</a>&gt;</span>. </dd>
<dt id="I-D.ietf-roll-useofrplinfo">[USEofRPLinfo]</dt>
<dd>
<span class="refAuthor">Robles, I.</span><span class="refAuthor">, Richardson, M.</span><span class="refAuthor">, and P. Thubert</span>, <span class="refTitle">"Using RPI option Type, Routing Header for Source Routes and IPv6-in-IPv6 encapsulation in the RPL Data Plane"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-roll-useofrplinfo-36</span>, <time datetime="2020-02-26">26 February 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-roll-useofrplinfo-36">https://tools.ietf.org/html/draft-ietf-roll-useofrplinfo-36</a>&gt;</span>. </dd>
<dt id="I-D.ietf-roll-efficient-npdao">[EFFICIENT-NPDAO]</dt>
<dd>
<span class="refAuthor">Jadhav, R.</span><span class="refAuthor">, Thubert, P.</span><span class="refAuthor">, Sahoo, R.</span><span class="refAuthor">, and Z. Cao</span>, <span class="refTitle">"Efficient Route Invalidation"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-roll-efficient-npdao-17</span>, <time datetime="2019-10-30">30 October 2019</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-roll-efficient-npdao-17">https://tools.ietf.org/html/draft-ietf-roll-efficient-npdao-17</a>&gt;</span>. </dd>
<dt id="RFC7102">[RFC7102]</dt>
<dd>
<span class="refAuthor">Vasseur, JP.</span>, <span class="refTitle">"Terms Used in Routing for Low-Power and Lossy Networks"</span>, <span class="seriesInfo">RFC 7102</span>, <span class="seriesInfo">DOI 10.17487/RFC7102</span>, <time datetime="2014-01">January 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7102">https://www.rfc-editor.org/info/rfc7102</a>&gt;</span>. </dd>
</dl>
</section>
<section id="section-15">
      <h2 id="name-informative-references">
<a href="#section-15" class="section-number selfRef">15. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
      </h2>
<dl class="references">
<dt id="RFC6606">[RFC6606]</dt>
<dd>
<span class="refAuthor">Kim, E.</span><span class="refAuthor">, Kaspar, D.</span><span class="refAuthor">, Gomez, C.</span><span class="refAuthor">, and C. Bormann</span>, <span class="refTitle">"Problem Statement and Requirements for IPv6 over Low-Power Wireless Personal Area Network (6LoWPAN) Routing"</span>, <span class="seriesInfo">RFC 6606</span>, <span class="seriesInfo">DOI 10.17487/RFC6606</span>, <time datetime="2012-05">May 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6606">https://www.rfc-editor.org/info/rfc6606</a>&gt;</span>. </dd>
<dt id="RFC3315">[RFC3315]</dt>
<dd>
<span class="refAuthor">Droms, R., Ed.</span><span class="refAuthor">, Bound, J.</span><span class="refAuthor">, Volz, B.</span><span class="refAuthor">, Lemon, T.</span><span class="refAuthor">, Perkins, C.</span><span class="refAuthor">, and M. Carney</span>, <span class="refTitle">"Dynamic Host Configuration Protocol for IPv6 (DHCPv6)"</span>, <span class="seriesInfo">RFC 3315</span>, <span class="seriesInfo">DOI 10.17487/RFC3315</span>, <time datetime="2003-07">July 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3315">https://www.rfc-editor.org/info/rfc3315</a>&gt;</span>. </dd>
<dt id="RFC6282">[RFC6282]</dt>
<dd>
<span class="refAuthor">Hui, J., Ed.</span><span class="refAuthor"> and P. Thubert</span>, <span class="refTitle">"Compression Format for IPv6 Datagrams over IEEE 802.15.4-Based Networks"</span>, <span class="seriesInfo">RFC 6282</span>, <span class="seriesInfo">DOI 10.17487/RFC6282</span>, <time datetime="2011-09">September 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6282">https://www.rfc-editor.org/info/rfc6282</a>&gt;</span>. </dd>
<dt id="RFC6687">[RFC6687]</dt>
<dd>
<span class="refAuthor">Tripathi, J., Ed.</span><span class="refAuthor">, de Oliveira, J., Ed.</span><span class="refAuthor">, and JP. Vasseur, Ed.</span>, <span class="refTitle">"Performance Evaluation of the Routing Protocol for Low-Power and Lossy Networks (RPL)"</span>, <span class="seriesInfo">RFC 6687</span>, <span class="seriesInfo">DOI 10.17487/RFC6687</span>, <time datetime="2012-10">October 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6687">https://www.rfc-editor.org/info/rfc6687</a>&gt;</span>. </dd>
<dt id="RFC7228">[RFC7228]</dt>
<dd>
<span class="refAuthor">Bormann, C.</span><span class="refAuthor">, Ersue, M.</span><span class="refAuthor">, and A. Keranen</span>, <span class="refTitle">"Terminology for Constrained-Node Networks"</span>, <span class="seriesInfo">RFC 7228</span>, <span class="seriesInfo">DOI 10.17487/RFC7228</span>, <time datetime="2014-05">May 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7228">https://www.rfc-editor.org/info/rfc7228</a>&gt;</span>. </dd>
<dt id="RFC7416">[RFC7416]</dt>
<dd>
<span class="refAuthor">Tsao, T.</span><span class="refAuthor">, Alexander, R.</span><span class="refAuthor">, Dohler, M.</span><span class="refAuthor">, Daza, V.</span><span class="refAuthor">, Lozano, A.</span><span class="refAuthor">, and M. Richardson, Ed.</span>, <span class="refTitle">"A Security Threat Analysis for the Routing Protocol for Low-Power and Lossy Networks (RPLs)"</span>, <span class="seriesInfo">RFC 7416</span>, <span class="seriesInfo">DOI 10.17487/RFC7416</span>, <time datetime="2015-01">January 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7416">https://www.rfc-editor.org/info/rfc7416</a>&gt;</span>. </dd>
<dt id="RFC8025">[RFC8025]</dt>
<dd>
<span class="refAuthor">Thubert, P., Ed.</span><span class="refAuthor"> and R. Cragie</span>, <span class="refTitle">"IPv6 over Low-Power Wireless Personal Area Network (6LoWPAN) Paging Dispatch"</span>, <span class="seriesInfo">RFC 8025</span>, <span class="seriesInfo">DOI 10.17487/RFC8025</span>, <time datetime="2016-11">November 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8025">https://www.rfc-editor.org/info/rfc8025</a>&gt;</span>. </dd>
<dt id="RFC8504">[RFC8504]</dt>
<dd>
<span class="refAuthor">Chown, T.</span><span class="refAuthor">, Loughney, J.</span><span class="refAuthor">, and T. Winters</span>, <span class="refTitle">"IPv6 Node Requirements"</span>, <span class="seriesInfo">BCP 220</span>, <span class="seriesInfo">RFC 8504</span>, <span class="seriesInfo">DOI 10.17487/RFC8504</span>, <time datetime="2019-01">January 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8504">https://www.rfc-editor.org/info/rfc8504</a>&gt;</span>. </dd>
<dt id="I-D.ietf-6lo-backbone-router">[6BBR]</dt>
<dd>
<span class="refAuthor">Thubert, P.</span><span class="refAuthor">, Perkins, C.</span><span class="refAuthor">, and E. Levy-Abegnoli</span>, <span class="refTitle">"IPv6 Backbone Router"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-6lo-backbone-router-19</span>, <time datetime="2020-03-03">3 March 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-6lo-backbone-router-19">https://tools.ietf.org/html/draft-ietf-6lo-backbone-router-19</a>&gt;</span>. </dd>
</dl>
</section>
<div id="u8138">
<section id="section-appendix.a">
      <h2 id="name-example-compression">
<a href="#section-appendix.a" class="section-number selfRef">Appendix A. </a><a href="#name-example-compression" class="section-name selfRef">Example Compression</a>
      </h2>
<p id="section-appendix.a-1">

 <a href="#rtghc" class="xref">Figure 12</a> illustrates the case in Storing Mode where the packet
    is received from the Internet, then the Root encapsulates the packet to
    insert the RPI and deliver to the 6LR that is the parent and last hop to the
    final destination, which is not known to support <span>[<a href="#RFC8138" class="xref">RFC8138</a>]</span>.<a href="#section-appendix.a-1" class="pilcrow">¶</a></p>
<span id="name-encapsulation-to-parent-6lr"></span><div id="rtghc">
<figure id="figure-12">
        <div class="artwork art-text alignLeft" id="section-appendix.a-2.1">
<pre>

+-+ ... -+-+ ... +-+- ... -+-+ ... -+-+-+ ... +-+-+ ... -+ ... +-...
|11110001|SRH-6LoRH| RPI-  |IP-in-IP| NH=1      |11110CPP| UDP | UDP
|Page 1  |Type1 S=0| 6LoRH | 6LoRH  |LOWPAN_IPHC| UDP    | hdr |Payld
+-+ ... -+-+ ... +-+- ... -+-+ ... -+-+-+ ... +-+-+ ... -+ ... +-...
         &lt;-4 bytes-&gt;                &lt;-        RFC 6282        -&gt;
                                    &lt;-     No RPL artifact ...
</pre>
</div>
<figcaption><a href="#figure-12" class="selfRef">Figure 12</a>:
<a href="#name-encapsulation-to-parent-6lr" class="selfRef">Encapsulation to Parent 6LR in Storing Mode</a>
        </figcaption></figure>
</div>
<p id="section-appendix.a-3">
    The difference with the example format presented in Figure 19 of
    <span>[<a href="#RFC8138" class="xref">RFC8138</a>]</span> is the addition of a SRH-6LoRH before the RPI-6LoRH
    to transport the compressed address of the 6LR as the destination address of
    the outer IPv6 header. In the original example the destination IP of the
    outer header was elided and was implicitly the same address as the
    destination of the inner header.

    Type 1 was arbitrarily chosen for this example, and
    the size of 0 denotes a single address in the SRH.<a href="#section-appendix.a-3" class="pilcrow">¶</a></p>
<p id="section-appendix.a-4">
     In <a href="#rtghc" class="xref">Figure 12</a>, the source of the IP-in-IP encapsulation is
          the Root, so it is elided in the IP-in-IP 6LoRH. The destination is
          the parent 6LR of the destination of the inner packet so it cannot be
          elided. In Storing Mode, it is placed as the single entry in an
          SRH-6LoRH as the first 6LoRH. Since there is a single entry so the
          SRH-6LoRH Size is 0. In this particular example, the 6LR address can
          be compressed to 2 bytes so a Type of 1 is used.
          It results that the total length of the SRH-6LoRH is 4 bytes.<a href="#section-appendix.a-4" class="pilcrow">¶</a></p>
<p id="section-appendix.a-5">
          In Non-Storing Mode, the encapsulation from the Root would be similar
          to that represented in <a href="#rtghc" class="xref">Figure 12</a> with possibly more hops
          in the SRH-6LoRH and possibly multiple SRH-6LoRHs if the various
          addresses in the routing header are not compressed to the same format.
          Note that on the last hop to the parent 6LR, the RH3 is consumed and
          removed from the compressed form, so the use of Non-Storing Mode vs.
          Storing Mode is indistinguishable from the packet format.<a href="#section-appendix.a-5" class="pilcrow">¶</a></p>
<p id="section-appendix.a-6">
          Follows the RPI-6LoRH and then the IP-in-IP 6LoRH. When the
          IP-in-IP 6LoRH is removed, all the Router headers that precede it are
          also removed.<a href="#section-appendix.a-6" class="pilcrow">¶</a></p>
<p id="section-appendix.a-7">
          The Paging Dispatch <span>[<a href="#RFC8025" class="xref">RFC8025</a>]</span> may also be removed if
          there was no previous Page change to a Page other than 0 or 1, since
          the LOWPAN_IPHC is encoded in the same fashion in the default Page 0
          and in Page 1. The resulting packet to the destination is the inner
          packet compressed with <span>[<a href="#RFC6282" class="xref">RFC6282</a>]</span>.<a href="#section-appendix.a-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="section-appendix.b">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Pascal Thubert (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">Cisco Systems, Inc</span></div>
<div dir="auto" class="left"><span class="street-address">Building D<br>45 Allee des Ormes - BP1200</span></div>
<div dir="auto" class="left">
<span class="postal-code">06254</span> <span class="locality">Mougins - Sophia Antipolis</span>
</div>
<div dir="auto" class="left"><span class="country-name">France</span></div>
<div class="tel">
<span>Phone:</span>
<a href="tel:+33%20497%2023%2026%2034" class="tel">+33 497 23 26 34</a>
</div>
<div class="email">
<span>Email:</span>
<a href="mailto:pthubert@cisco.com" class="email">pthubert@cisco.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Michael C. Richardson</span></div>
<div dir="auto" class="left"><span class="org">Sandelman Software Works</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:mcr+ietf@sandelman.ca" class="email">mcr+ietf@sandelman.ca</a>
</div>
<div class="url">
<span>URI:</span>
<a href="http://www.sandelman.ca/" class="url">http://www.sandelman.ca/</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
