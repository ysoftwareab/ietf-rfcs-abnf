SUIT_Envelope_Tagged = #6.107(SUIT_Envelope)
SUIT_Envelope = {
suit-authentication-wrapper => bstr .cbor SUIT_Authentication,
suit-manifest  => bstr .cbor SUIT_Manifest,
suit-protection-wrappers => bstr .cbor {
         *(int/str) => [+ SUIT_Encryption_Info]
SUIT_Manifest = {
suit-manifest-version         => 1,
suit-manifest-sequence-number => uint,
suit-common                   => bstr .cbor SUIT_Common,
COSE_Encrypt_Tagged = #6.96(COSE_Encrypt)

SUIT_Encryption_Info = COSE_Encrypt_Tagged

COSE_Encrypt = [
   protected   : bstr .cbor outer_header_map_protected,
   unprotected : outer_header_map_unprotected,
   ciphertext  : null,                  ; because of detached ciphertext
   recipients  : [ + COSE_recipient ]
outer_header_map_protected =
outer_header_map_unprotected =
COSE_recipient = [
   protected   : bstr .size 0,
   unprotected : recipient_header_map,
   ciphertext  : bstr        ; CEK encrypted with KEK
recipient_header_map =
Enc_structure = [
            context : "Encrypt",
            protected : empty_or_serialized_map,
            external_aad : bstr
COSE_Encrypt_Tagged = #6.96(COSE_Encrypt)

SUIT_Encryption_Info = COSE_Encrypt_Tagged

COSE_Encrypt = [
   protected   : bstr .cbor header_map, ; must contain alg
   unprotected : header_map,            ; must contain iv
   ciphertext  : null,                  ; because of detached ciphertext
   recipients  : [+COSE_recipient_outer]
COSE_recipient_outer = [
   protected   : bstr .size 0,
   unprotected : header_map, ; must contain alg
   encCEK      : bstr,       ; CEK encrypted based on HPKE algo
   recipients  : [ + COSE_recipient_inner ]
COSE_recipient_inner = [
   protected   : bstr .cbor header_map, ; must contain HPKE alg
   unprotected : header_map, ; must contain kid and ephemeral public key
   empty       : null,
   empty       : null
header_map = {
   Generic_Headers,
   * label =values,
Generic_Headers = (
     ? 1 => int,         ; algorithm identifier
     ? 2 => crv,         ; EC identifier
     ? 4 => bstr,        ; key identifier
     ? 5 => bstr         ; IV
