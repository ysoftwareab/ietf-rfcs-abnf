



opsawg                                                             Z. Li
Internet-Draft                                              China Mobile
Intended status: Standards Track                               P. Aitken
Expires: January 1, 2018            Brocade Communications Systems, Inc.
                                                           June 30, 2017


 Extended Length Message Support for IP Flow Information Export (IPFIX)
               draft-li-opsawg-ipfix-extended-message-00

Abstract

   The specification of the IP Flow Information Export (IPFIX) Protocol
   [RFC7011] defines an IPFIX Message length of 16 bits.  As new
   Information Elements (IEs) are introduced in IPFIX to export long
   information, such as the BGP community information
   [I-D.ietf-opsawg-ipfix-bgp-community], an IPFIX Message no longer has
   sufficient space to fit all the information of a specific flow.  This
   document updates the IPFIX specification by extending the IPFIX
   Message length from 16 bits to 32 bits.  For backwards compatibility,
   a new version of IPFIX (i.e., 11) is introduced to support the 32-bit
   Message length.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at http://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on January 1, 2018.

Copyright Notice

   Copyright (c) 2017 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (http://trustee.ietf.org/license-info) in effect on the date of



Li & Aitken              Expires January 1, 2018                [Page 1]

Internet-Draft  Extended Length Message Support for IPFIX      June 2017


   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
   2.  Terminology . . . . . . . . . . . . . . . . . . . . . . . . .   2
   3.  IPFIX Extended Length Message . . . . . . . . . . . . . . . .   3
     3.1.  IPFIX Extended Length Message Header  . . . . . . . . . .   3
     3.2.  IPFIX Extended Length Set Header  . . . . . . . . . . . .   3
     3.3.  IPFIX Extended Variable-Length IE . . . . . . . . . . . .   4
   4.  Transport Protocol Considerations . . . . . . . . . . . . . .   4
   5.  Security Considerations . . . . . . . . . . . . . . . . . . .   5
   6.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .   5
   7.  Acknowledgements  . . . . . . . . . . . . . . . . . . . . . .   5
   8.  References  . . . . . . . . . . . . . . . . . . . . . . . . .   5
     8.1.  Normative References  . . . . . . . . . . . . . . . . . .   5
     8.2.  Informative References  . . . . . . . . . . . . . . . . .   5
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .   6

1.  Introduction

   The IP Flow Information Export (IPFIX) Protocol [RFC7011] provides
   network administrators with traffic flow information using the
   Information Elements (IEs) defined in IANA's IPFIX registry
   [IANA-IPFIX].  [RFC7011] specifies an IPFIX Message length of 16
   bits.  As new IEs are introduced in IPFIX to export long information,
   such as the BGP community information
   [I-D.ietf-opsawg-ipfix-bgp-community], one IPFIX Message no longer
   has sufficient space to fit all the information of a specific flow.
   The maximum IPFIX message size needs to be extended beyond 65535
   octets.  This document updates the IPFIX specification by extending
   the IPFIX Message length from 16 bits to 32 bits, which means the
   maximum IPFIX message size is 4 giga bytes.  For backwards
   compatibility, a new version of IPFIX (i.e., 11) is introduced to
   support the 32-bit Message length.

2.  Terminology

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [RFC2119].





Li & Aitken              Expires January 1, 2018                [Page 2]

Internet-Draft  Extended Length Message Support for IPFIX      June 2017


3.  IPFIX Extended Length Message

   The goal of this document is to allow the export of IPFIX messages up
   to 4294967295 (4 giga) octets to satisfy the two situations that may
   result in the IPFIX message beyond 65535 octets.  One is the IPFIX
   message consisting of many small fields where each field is 8-bits or
   16-bits long.  The other one is the IPFIX message consisting of at
   least one IE which is longer than 65535 octets, such as the IEs
   defined in [I-D.ietf-opsawg-ipfix-bgp-community].

   To satisfy the two situations, this document extends the following
   length fields to 32 bits: the Length field in the IPFIX Message
   Header, the Length field in the Set Header and the Length field in
   the variable-length IE.

3.1.  IPFIX Extended Length Message Header

   The IPFIX Message Header with a 32 bits length field is called the
   IPFIX Extended Length Message Header, whose format is shown in
   Figure 1.  The version number MUST be 11.  The length field is
   32-bits long.  The meanings and other specifications of the fields in
   the Extended Length Message Header are in accordance with [RFC7011].
   Please refer to Figure F in [RFC7011].

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
                                   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                                   |        Version Number         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                              Length                           |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                            Export Time                        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                          Sequence Number                      |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                       Observation Domain ID                   |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

           Figure 1: IPFIX Extended Length Message Header Format

3.2.  IPFIX Extended Length Set Header

   The IPFIX Set Header with a 32 bits length field is called the IPFIX
   Extended Length Set Header, whose format is shown in Figure 2.  The
   meanings and other specifications of the fields in the Extended
   Length Set Header are in accordance with [RFC7011].  Please refer to
   Figure I in [RFC7011].




Li & Aitken              Expires January 1, 2018                [Page 3]

Internet-Draft  Extended Length Message Support for IPFIX      June 2017


    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
                                   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                                   |            Set ID             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                              Length                           |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                Figure 2: Extended Length Set Header Format

3.3.  IPFIX Extended Variable-Length IE

   The Extended Variable-Length IE allows export of variable-length IEs
   with size greater than or equal to 65535 octets, the length field of
   which is extended to 32 bits as shown in Figure 3.  The meanings and
   other specifications of the fields in the Extended Variable-Length IE
   are in accordance with [RFC7011].  Please refer to Figure S in
   [RFC7011].

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
                                                   +-+-+-+-+-+-+-+-+
                                                   |     255       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                 Length (0 to 4294967295)                      |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                            IE                                 |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                 ... continuing as needed                      |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                   Figure 3: Extended Variable-Length IE

4.  Transport Protocol Considerations

   As per section 10 of RFC7011, the IPFIX Protocol is transport
   protocol independent.  SCTP [RFC4960] using the Partially Reliable
   SCTP (PR-SCTP) extension as specified in [RFC3758] MUST be
   implemented by all compliant implementations.  UDP [RFC768] MAY also
   be implemented by compliant implementations.  TCP [RFC793] MAY also
   be implemented by compliant implementations.  The Collecting Process
   of a compliant implementation supporting IPFIX Extended Length
   Message MUST be able to handle IPFIX Message lengths of up to
   4294967295 octets.







Li & Aitken              Expires January 1, 2018                [Page 4]

Internet-Draft  Extended Length Message Support for IPFIX      June 2017


5.  Security Considerations

   This extension to IPFIX does not change IPFIX's underlying security
   issues, please refer to RFC7011.

6.  IANA Considerations

   A new IPFIX Version Number value of 11 is reserved in IANA's IPFIX
   registry [IANA-IPFIX] for the IPFIX Extended Length Message specified
   in this document.

7.  Acknowledgements

   The authors would like to thank Ignas Bagdonas and Stewart Bryant for
   their constructive discussion.

8.  References

8.1.  Normative References

   [IANA-IPFIX]
              IANA, "IPFIX Information Elements registry",
              <http://www.iana.org/assignments/ipfix/ipfix.xml>.

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <http://www.rfc-editor.org/info/rfc2119>.

   [RFC7011]  Claise, B., Ed., Trammell, B., Ed., and P. Aitken,
              "Specification of the IP Flow Information Export (IPFIX)
              Protocol for the Exchange of Flow Information", STD 77,
              RFC 7011, DOI 10.17487/RFC7011, September 2013,
              <http://www.rfc-editor.org/info/rfc7011>.

8.2.  Informative References

   [I-D.ietf-opsawg-ipfix-bgp-community]
              Li, Z., Gu, R., and J. Dong, "Export BGP community
              information in IP Flow Information Export (IPFIX)", draft-
              ietf-opsawg-ipfix-bgp-community-02 (work in progress),
              June 2017.

   [RFC3758]  Stewart, R., Ramalho, M., Xie, Q., Tuexen, M., and P.
              Conrad, "Stream Control Transmission Protocol (SCTP)
              Partial Reliability Extension", RFC 3758,
              DOI 10.17487/RFC3758, May 2004,
              <http://www.rfc-editor.org/info/rfc3758>.



Li & Aitken              Expires January 1, 2018                [Page 5]

Internet-Draft  Extended Length Message Support for IPFIX      June 2017


   [RFC4960]  Stewart, R., Ed., "Stream Control Transmission Protocol",
              RFC 4960, DOI 10.17487/RFC4960, September 2007,
              <http://www.rfc-editor.org/info/rfc4960>.

Authors' Addresses

   Zhenqiang Li
   China Mobile
   32 Xuanwumen West Ave, Xicheng District
   Beijing  100053
   China

   Email: li_zhenqiang@hotmail.com


   Paul Aitken
   Brocade Communications Systems, Inc.
   19a Canning Street, Level 3
   Edinburgh, Scotland  EH3 8EG
   United Kingdom

   Email: paitken@brocade.com





























Li & Aitken              Expires January 1, 2018                [Page 6]
