<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>MessageVortex Protocol</title>
<meta content="Martin Gwerder" name="author">
<meta content="
       The MessageVortex (referred to as Vortex) protocol achieves different degrees of anonymity, including sender, receiver, and third-party anonymity, by specifying messages embedded within the existing transfer protocols, such as SMTP or XMPP, sent via peer nodes to one or more recipients. 
       The protocol outperforms others by decoupling the transport from the final transmitter and receiver. No trust is placed into any infrastructure except for that of the sending and receiving parties of the message. The creator of the routing block (routing block builder; RBB) has full control over the message flow. Routing nodes gain no non-obvious knowledge about the messages even when collaborating. While third-party anonymity is always achieved, the protocol also allows for either sender or receiver anonymity. 
    " name="description">
<meta content="xml2rfc 3.10.0" name="generator">
<meta content="SMTP" name="keyword">
<meta content="XMPP" name="keyword">
<meta content="IMAPrev4" name="keyword">
<meta content="MessageVortex" name="keyword">
<meta content="Anonymity" name="keyword">
<meta content="draft-gwerder-messagevortexmain-08" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.10.0
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.5.2
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.6.3
    pycountry 20.7.3
    pyflakes 2.3.1
    PyYAML 5.4.1
    requests 2.26.0
    setuptools 58.0.4
    six 1.16.0
-->
<link href="/tmp/draft-gwerder-messagevortexmain-08-5tnci7hj.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">MessageVortex Protocol</td>
<td class="right">October 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Gwerder</td>
<td class="center">Expires 7 April 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Internet Engineering Task Force</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-gwerder-messagevortexmain-08</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2021-10-04" class="published">4 October 2021</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Experimental</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-04-07">7 April 2022</time></dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">M. Gwerder</div>
<div class="org">FHNW</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">MessageVortex Protocol</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">The MessageVortex (referred to as Vortex) protocol achieves different degrees of anonymity, including sender, receiver, and third-party anonymity, by specifying messages embedded within the existing transfer protocols, such as SMTP or XMPP, sent via peer nodes to one or more recipients.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">The protocol outperforms others by decoupling the transport from the final transmitter and receiver. No trust is placed into any infrastructure except for that of the sending and receiving parties of the message. The creator of the routing block (routing block builder; RBB) has full control over the message flow. Routing nodes gain no non-obvious knowledge about the messages even when collaborating. While third-party anonymity is always achieved, the protocol also allows for either sender or receiver anonymity.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 7 April 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-requirements-language" class="xref">Requirements Language</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="xref">1.2</a>.  <a href="#name-protocol-specification" class="xref">Protocol Specification</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.3">
                <p id="section-toc.1-1.1.2.3.1" class="keepWithNext"><a href="#section-1.3" class="xref">1.3</a>.  <a href="#name-number-specification" class="xref">Number Specification</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-entities-overview" class="xref">Entities Overview</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-node" class="xref">Node</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.1">
                    <p id="section-toc.1-1.2.2.1.2.1.1"><a href="#section-2.1.1" class="xref">2.1.1</a>.  <a href="#name-blocks" class="xref">Blocks</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.2">
                    <p id="section-toc.1-1.2.2.1.2.2.1"><a href="#section-2.1.2" class="xref">2.1.2</a>.  <a href="#name-nodespec" class="xref">NodeSpec</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.2.2.1">
                        <p id="section-toc.1-1.2.2.1.2.2.2.1.1"><a href="#section-2.1.2.1" class="xref">2.1.2.1</a>.  <a href="#name-nodespec-for-smtp-nodes" class="xref">NodeSpec for SMTP nodes</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.2.2.2">
                        <p id="section-toc.1-1.2.2.1.2.2.2.2.1"><a href="#section-2.1.2.2" class="xref">2.1.2.2</a>.  <a href="#name-nodespec-for-xmpp-nodes" class="xref">NodeSpec for XMPP nodes</a></p>
</li>
                    </ul>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-peer-partners" class="xref">Peer Partners</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="xref">2.3</a>.  <a href="#name-encryption-keys" class="xref">Encryption Keys</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3.2.1">
                    <p id="section-toc.1-1.2.2.3.2.1.1"><a href="#section-2.3.1" class="xref">2.3.1</a>.  <a href="#name-identity-keys" class="xref">Identity Keys</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3.2.2">
                    <p id="section-toc.1-1.2.2.3.2.2.1"><a href="#section-2.3.2" class="xref">2.3.2</a>.  <a href="#name-peer-key" class="xref">Peer Key</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3.2.3">
                    <p id="section-toc.1-1.2.2.3.2.3.1"><a href="#section-2.3.3" class="xref">2.3.3</a>.  <a href="#name-sender-key" class="xref">Sender Key</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a href="#section-2.4" class="xref">2.4</a>.  <a href="#name-vortex-message" class="xref">Vortex Message</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.5">
                <p id="section-toc.1-1.2.2.5.1"><a href="#section-2.5" class="xref">2.5</a>.  <a href="#name-message" class="xref">Message</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.6">
                <p id="section-toc.1-1.2.2.6.1"><a href="#section-2.6" class="xref">2.6</a>.  <a href="#name-key-and-mac-specifications-" class="xref">Key and MAC specifications and usage</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.6.2.1">
                    <p id="section-toc.1-1.2.2.6.2.1.1"><a href="#section-2.6.1" class="xref">2.6.1</a>.  <a href="#name-asymmetric-keys" class="xref">Asymmetric Keys</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.6.2.2">
                    <p id="section-toc.1-1.2.2.6.2.2.1"><a href="#section-2.6.2" class="xref">2.6.2</a>.  <a href="#name-symmetric-keys" class="xref">Symmetric Keys</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.7">
                <p id="section-toc.1-1.2.2.7.1"><a href="#section-2.7" class="xref">2.7</a>.  <a href="#name-transport-address" class="xref">Transport Address</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.8">
                <p id="section-toc.1-1.2.2.8.1"><a href="#section-2.8" class="xref">2.8</a>.  <a href="#name-identity" class="xref">Identity</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.8.2.1">
                    <p id="section-toc.1-1.2.2.8.2.1.1"><a href="#section-2.8.1" class="xref">2.8.1</a>.  <a href="#name-peer-identity" class="xref">Peer Identity</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.8.2.2">
                    <p id="section-toc.1-1.2.2.8.2.2.1"><a href="#section-2.8.2" class="xref">2.8.2</a>.  <a href="#name-ephemeral-identity" class="xref">Ephemeral Identity</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.8.2.3">
                    <p id="section-toc.1-1.2.2.8.2.3.1"><a href="#section-2.8.3" class="xref">2.8.3</a>.  <a href="#name-official-identity" class="xref">Official Identity</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.9">
                <p id="section-toc.1-1.2.2.9.1"><a href="#section-2.9" class="xref">2.9</a>.  <a href="#name-workspace" class="xref">Workspace</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.10">
                <p id="section-toc.1-1.2.2.10.1"><a href="#section-2.10" class="xref">2.10</a>. <a href="#name-multi-use-reply-blocks" class="xref">Multi-use Reply Blocks</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.11">
                <p id="section-toc.1-1.2.2.11.1"><a href="#section-2.11" class="xref">2.11</a>. <a href="#name-protocol-version" class="xref">Protocol Version</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-layer-overview" class="xref">Layer Overview</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-transport-layer" class="xref">Transport Layer</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-blending-layer" class="xref">Blending Layer</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-routing-layer" class="xref">Routing Layer</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="xref">3.4</a>.  <a href="#name-accounting-layer" class="xref">Accounting Layer</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-vortex-message-2" class="xref">Vortex Message</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-overview" class="xref">Overview</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-message-prefix-block-mprefi" class="xref">Message Prefix Block (MPREFIX)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.  <a href="#name-inner-message-block" class="xref">Inner Message Block</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.1">
                    <p id="section-toc.1-1.4.2.3.2.1.1"><a href="#section-4.3.1" class="xref">4.3.1</a>.  <a href="#name-control-prefix-block" class="xref">Control Prefix Block</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.2">
                    <p id="section-toc.1-1.4.2.3.2.2.1"><a href="#section-4.3.2" class="xref">4.3.2</a>.  <a href="#name-control-blocks" class="xref">Control Blocks</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.2.2.1">
                        <p id="section-toc.1-1.4.2.3.2.2.2.1.1"><a href="#section-4.3.2.1" class="xref">4.3.2.1</a>.  <a href="#name-header-block" class="xref">Header Block</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.2.2.2">
                        <p id="section-toc.1-1.4.2.3.2.2.2.2.1"><a href="#section-4.3.2.2" class="xref">4.3.2.2</a>.  <a href="#name-routing-block" class="xref">Routing Block</a></p>
</li>
                    </ul>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.3">
                    <p id="section-toc.1-1.4.2.3.2.3.1"><a href="#section-4.3.3" class="xref">4.3.3</a>.  <a href="#name-payload-block" class="xref">Payload Block</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-general-notes" class="xref">General notes</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-supported-symmetric-ciphers" class="xref">Supported Symmetric Ciphers</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-supported-asymmetric-cipher" class="xref">Supported Asymmetric Ciphers</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="xref">5.3</a>.  <a href="#name-supported-macs" class="xref">Supported MACs</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="xref">5.4</a>.  <a href="#name-supported-paddings" class="xref">Supported Paddings</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5">
                <p id="section-toc.1-1.5.2.5.1"><a href="#section-5.5" class="xref">5.5</a>.  <a href="#name-supported-modes" class="xref">Supported Modes</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-blending" class="xref">Blending</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-blending-in-attachments" class="xref">Blending in Attachments</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.1">
                    <p id="section-toc.1-1.6.2.1.2.1.1"><a href="#section-6.1.1" class="xref">6.1.1</a>.  <a href="#name-plain-embedding-into-attach" class="xref">PLAIN embedding into attachments</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.2">
                    <p id="section-toc.1-1.6.2.1.2.2.1"><a href="#section-6.1.2" class="xref">6.1.2</a>.  <a href="#name-f5-embedding-into-attachmen" class="xref">F5 embedding into attachments</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-blending-into-an-smtp-layer" class="xref">Blending into an SMTP layer</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="xref">6.3</a>.  <a href="#name-blending-into-an-xmpp-layer" class="xref">Blending into an XMPP layer</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-routing" class="xref">Routing</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.  <a href="#name-vortex-message-processing" class="xref">Vortex Message Processing</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1.2.1">
                    <p id="section-toc.1-1.7.2.1.2.1.1"><a href="#section-7.1.1" class="xref">7.1.1</a>.  <a href="#name-processing-of-incoming-vort" class="xref">Processing of incoming Vortex Messages</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1.2.2">
                    <p id="section-toc.1-1.7.2.1.2.2.1"><a href="#section-7.1.2" class="xref">7.1.2</a>.  <a href="#name-processing-of-routing-block" class="xref">Processing of Routing Blocks in the Workspace</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1.2.3">
                    <p id="section-toc.1-1.7.2.1.2.3.1"><a href="#section-7.1.3" class="xref">7.1.3</a>.  <a href="#name-processing-of-outgoing-vort" class="xref">Processing of Outgoing Vortex Messages</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="xref">7.2</a>.  <a href="#name-header-requests" class="xref">Header Requests</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.1">
                    <p id="section-toc.1-1.7.2.2.2.1.1"><a href="#section-7.2.1" class="xref">7.2.1</a>.  <a href="#name-request-new-ephemeral-ident" class="xref">Request New Ephemeral Identity</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.2">
                    <p id="section-toc.1-1.7.2.2.2.2.1"><a href="#section-7.2.2" class="xref">7.2.2</a>.  <a href="#name-request-message-quota" class="xref">Request Message Quota</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.3">
                    <p id="section-toc.1-1.7.2.2.2.3.1"><a href="#section-7.2.3" class="xref">7.2.3</a>.  <a href="#name-request-increase-of-message" class="xref">Request Increase of Message Quota</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.4">
                    <p id="section-toc.1-1.7.2.2.2.4.1"><a href="#section-7.2.4" class="xref">7.2.4</a>.  <a href="#name-request-transfer-quota" class="xref">Request Transfer Quota</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.5">
                    <p id="section-toc.1-1.7.2.2.2.5.1"><a href="#section-7.2.5" class="xref">7.2.5</a>.  <a href="#name-query-quota" class="xref">Query Quota</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.6">
                    <p id="section-toc.1-1.7.2.2.2.6.1"><a href="#section-7.2.6" class="xref">7.2.6</a>.  <a href="#name-request-capabilities" class="xref">Request Capabilities</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.7">
                    <p id="section-toc.1-1.7.2.2.2.7.1"><a href="#section-7.2.7" class="xref">7.2.7</a>.  <a href="#name-request-nodes" class="xref">Request Nodes</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.8">
                    <p id="section-toc.1-1.7.2.2.2.8.1"><a href="#section-7.2.8" class="xref">7.2.8</a>.  <a href="#name-request-identity-replace" class="xref">Request Identity Replace</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.9">
                    <p id="section-toc.1-1.7.2.2.2.9.1"><a href="#section-7.2.9" class="xref">7.2.9</a>.  <a href="#name-request-upgrade" class="xref">Request Upgrade</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="xref">7.3</a>.  <a href="#name-special-blocks" class="xref">Special Blocks</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.1">
                    <p id="section-toc.1-1.7.2.3.2.1.1"><a href="#section-7.3.1" class="xref">7.3.1</a>.  <a href="#name-error-block" class="xref">Error Block</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.2">
                    <p id="section-toc.1-1.7.2.3.2.2.1"><a href="#section-7.3.2" class="xref">7.3.2</a>.  <a href="#name-requirement-block" class="xref">Requirement Block</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.2.2.1">
                        <p id="section-toc.1-1.7.2.3.2.2.2.1.1"><a href="#section-7.3.2.1" class="xref">7.3.2.1</a>.  <a href="#name-puzzle-requirement" class="xref">Puzzle Requirement</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.2.2.2">
                        <p id="section-toc.1-1.7.2.3.2.2.2.2.1"><a href="#section-7.3.2.2" class="xref">7.3.2.2</a>.  <a href="#name-payment-requirement" class="xref">Payment Requirement</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.2.2.3">
                        <p id="section-toc.1-1.7.2.3.2.2.2.3.1"><a href="#section-7.3.2.3" class="xref">7.3.2.3</a>.  <a href="#name-upgrade" class="xref">Upgrade</a></p>
</li>
                    </ul>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="xref">7.4</a>.  <a href="#name-routing-operations" class="xref">Routing Operations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4.2.1">
                    <p id="section-toc.1-1.7.2.4.2.1.1"><a href="#section-7.4.1" class="xref">7.4.1</a>.  <a href="#name-mapping-operation" class="xref">Mapping Operation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4.2.2">
                    <p id="section-toc.1-1.7.2.4.2.2.1"><a href="#section-7.4.2" class="xref">7.4.2</a>.  <a href="#name-split-and-merge-operations" class="xref">Split and Merge Operations</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4.2.3">
                    <p id="section-toc.1-1.7.2.4.2.3.1"><a href="#section-7.4.3" class="xref">7.4.3</a>.  <a href="#name-encrypt-and-decrypt-operati" class="xref">Encrypt and Decrypt Operations</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4.2.4">
                    <p id="section-toc.1-1.7.2.4.2.4.1"><a href="#section-7.4.4" class="xref">7.4.4</a>.  <a href="#name-add-and-remove-redundancy-o" class="xref">Add and Remove Redundancy Operations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4.2.4.2.1">
                        <p id="section-toc.1-1.7.2.4.2.4.2.1.1"><a href="#section-7.4.4.1" class="xref">7.4.4.1</a>.  <a href="#name-padding-operation" class="xref">Padding Operation</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4.2.4.2.2">
                        <p id="section-toc.1-1.7.2.4.2.4.2.2.1"><a href="#section-7.4.4.2" class="xref">7.4.4.2</a>.  <a href="#name-apply-matrix" class="xref">Apply Matrix</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4.2.4.2.3">
                        <p id="section-toc.1-1.7.2.4.2.4.2.3.1"><a href="#section-7.4.4.3" class="xref">7.4.4.3</a>.  <a href="#name-encrypt-target-block" class="xref">Encrypt Target Block</a></p>
</li>
                    </ul>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5">
                <p id="section-toc.1-1.7.2.5.1"><a href="#section-7.5" class="xref">7.5</a>.  <a href="#name-processing-of-vortex-messag" class="xref">Processing of Vortex Messages</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-accounting" class="xref">Accounting</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="xref">8.1</a>.  <a href="#name-accounting-operations" class="xref">Accounting Operations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1.2.1">
                    <p id="section-toc.1-1.8.2.1.2.1.1"><a href="#section-8.1.1" class="xref">8.1.1</a>.  <a href="#name-time-based-garbage-collecti" class="xref">Time-Based Garbage Collection</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1.2.2">
                    <p id="section-toc.1-1.8.2.1.2.2.1"><a href="#section-8.1.2" class="xref">8.1.2</a>.  <a href="#name-time-based-routing-initiati" class="xref">Time-Based Routing Initiation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1.2.3">
                    <p id="section-toc.1-1.8.2.1.2.3.1"><a href="#section-8.1.3" class="xref">8.1.3</a>.  <a href="#name-routing-based-quota-updates" class="xref">Routing Based Quota Updates</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1.2.4">
                    <p id="section-toc.1-1.8.2.1.2.4.1"><a href="#section-8.1.4" class="xref">8.1.4</a>.  <a href="#name-routing-based-authorization" class="xref">Routing Based Authorization</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1.2.5">
                    <p id="section-toc.1-1.8.2.1.2.5.1"><a href="#section-8.1.5" class="xref">8.1.5</a>.  <a href="#name-ephemeral-identity-creation" class="xref">Ephemeral Identity Creation</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>. <a href="#name-references" class="xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="xref">11.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="xref">11.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-A" class="xref">Appendix A</a>.  <a href="#name-the-asn1-schema-for-vortex-" class="xref">The ASN.1 schema for Vortex messages</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#appendix-A.1" class="xref">A.1</a>.  <a href="#name-the-main-messagevortex-bloc" class="xref">The Main MessageVortex Blocks</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#appendix-A.2" class="xref">A.2</a>.  <a href="#name-the-messagevortex-ciphers-s" class="xref">The MessageVortex Ciphers Structures</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.3">
                <p id="section-toc.1-1.12.2.3.1"><a href="#appendix-A.3" class="xref">A.3</a>.  <a href="#name-the-messagevortex-request-s" class="xref">The MessageVortex Request Structures</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.4">
                <p id="section-toc.1-1.12.2.4.1"><a href="#appendix-A.4" class="xref">A.4</a>.  <a href="#name-the-messagevortex-replies-s" class="xref">The MessageVortex Replies Structures</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.5">
                <p id="section-toc.1-1.12.2.5.1"><a href="#appendix-A.5" class="xref">A.5</a>.  <a href="#name-the-messagevortex-requireme" class="xref">The MessageVortex Requirements Structures</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.6">
                <p id="section-toc.1-1.12.2.6.1"><a href="#appendix-A.6" class="xref">A.6</a>.  <a href="#name-the-messagevortex-helpers-s" class="xref">The MessageVortex Helpers Structures</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.7">
                <p id="section-toc.1-1.12.2.7.1"><a href="#appendix-A.7" class="xref">A.7</a>.  <a href="#name-the-messagevortex-additiona" class="xref">The MessageVortex Additional Structures</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-B" class="xref">Appendix B</a>.  <a href="#name-changelog" class="xref">Changelog</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-C" class="xref"></a><a href="#name-authors-address" class="xref">Author's Address</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Anonymization is difficult to achieve. Most previous attempts relied on either trust in a dedicated infrastructure or a specialized networking protocol.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">Instead of defining a transport layer, Vortex piggybacks on other transport protocols. A blending layer embeds MessageVortex messages (VortexMessage) into ordinary messages of the respective transport protocol. This layer picks up the messages, passes them to a routing layer, which applies local operations to the messages, and resends the new message chunks to the next recipients.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">A processing node learns as little as possible from the message or the network utilized. The operations have been designed to be sensible in any context. The 'onionized' structure of the protocol makes it impossible to follow the trace of a message without having control over the processing node.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">MessageVortex is a protocol that allows sending and receiving messages by using a routing block instead of a destination address. With this approach, the sender has full control over all parameters of the message flow.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">A message is split and reassembled during transmission. Chunks of the message may carry redundant information to avoid service interruptions during transit. Decoy and message traffic are not differentiable as the nature of the addRedundancy operation allows each generated portion to be either message or decoy. Therefore, all routing nodes are unable to distinguish between message and decoy traffic.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">After processing, a potential receiver node knows if the message is destined for it (by creating a chunk with ID 0) or other nodes. Due to missing keys, no other node may perform this processing.<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7">This RFC begins with general terminology (see <a href="#entities_overview" class="xref">Section 2</a>) followed by an overview of the process (see <a href="#layer_overview" class="xref">Section 3</a>). The subsequent sections describe the details of the protocol.<a href="#section-1-7" class="pilcrow">¶</a></p>
<section id="section-1.1">
        <h3 id="name-requirements-language">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-requirements-language" class="section-name selfRef">Requirements Language</a>
        </h3>
<p id="section-1.1-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span>.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
</section>
<section id="section-1.2">
        <h3 id="name-protocol-specification">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-protocol-specification" class="section-name selfRef">Protocol Specification</a>
        </h3>
<p id="section-1.2-1"><a href="#asn_one" class="xref">Appendix A</a> specifies all relevant parts of the protocol in ASN.1 (see <span>[<a href="#CCITT.X680.2002" class="xref">CCITT.X680.2002</a>]</span> and <span>[<a href="#CCITT.X208.1988" class="xref">CCITT.X208.1988</a>]</span>). The blocks are DER-encoded, if not otherwise specified.<a href="#section-1.2-1" class="pilcrow">¶</a></p>
</section>
<section id="section-1.3">
        <h3 id="name-number-specification">
<a href="#section-1.3" class="section-number selfRef">1.3. </a><a href="#name-number-specification" class="section-name selfRef">Number Specification</a>
        </h3>
<p id="section-1.3-1">All numbers within this document are, if not suffixed, decimal numbers. Numbers suffixed with a small letter 'h' followed by two hexadecimal digits are octets written in hexadecimal. For example, a blank ASCII character (' ') is written as 20h and a capital 'K' in ASCII as 4Bh.<a href="#section-1.3-1" class="pilcrow">¶</a></p>
</section>
</section>
<div id="entities_overview">
<section id="section-2">
      <h2 id="name-entities-overview">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-entities-overview" class="section-name selfRef">Entities Overview</a>
      </h2>
<p id="section-2-1">The following entities used in this document are defined below.<a href="#section-2-1" class="pilcrow">¶</a></p>
<div id="entities_node">
<section id="section-2.1">
        <h3 id="name-node">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-node" class="section-name selfRef">Node</a>
        </h3>
<p id="section-2.1-1">The term 'node' describes any computer system connected to other nodes, which support the MessageVortex protocol. A 'node address' is typically an email address, an XMPP address, or other transport protocol identity supporting the MessageVortex protocol. Any address SHOULD include a public part of an 'identity key' to allow messages to transmit safely. One or more addresses MAY belong to the same node.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<div id="entities_blocks">
<section id="section-2.1.1">
          <h4 id="name-blocks">
<a href="#section-2.1.1" class="section-number selfRef">2.1.1. </a><a href="#name-blocks" class="section-name selfRef">Blocks</a>
          </h4>
<p id="section-2.1.1-1">A 'block' represents an ASN.1 sequence in a transmitted message. We embed messages in the transport protocol, and these messages may be of any size.<a href="#section-2.1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="entities_node_spec">
<section id="section-2.1.2">
          <h4 id="name-nodespec">
<a href="#section-2.1.2" class="section-number selfRef">2.1.2. </a><a href="#name-nodespec" class="section-name selfRef">NodeSpec</a>
          </h4>
<p id="section-2.1.2-1">A nodeSpec block, as specified in <a href="#asnOne_helpers" class="xref">Appendix A.6</a>, expresses an addressable node in a unified format. The nodeSpec contains a reference to the routing protocol, the routing address within this protocol, and the keys required for addressing the node. This RFC specifies transport layers for XMPP and SMTP. Additional transport layers will require an extension to this RFC.<a href="#section-2.1.2-1" class="pilcrow">¶</a></p>
<div id="entities_node_spec_smtp">
<section id="section-2.1.2.1">
            <h5 id="name-nodespec-for-smtp-nodes">
<a href="#section-2.1.2.1" class="section-number selfRef">2.1.2.1. </a><a href="#name-nodespec-for-smtp-nodes" class="section-name selfRef">NodeSpec for SMTP nodes</a>
            </h5>
<p id="section-2.1.2.1-1">An alternative address representation is defined that allows a standard email client to address a Vortex node. A node SHOULD support the smtpAlternateSpec (its specification is noted in ABNF as in <span>[<a href="#RFC5234" class="xref">RFC5234</a>]</span>). For applications with QR code support, an implementation SHOULD use the smtpUrl representation.<a href="#section-2.1.2.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-abnf art-text artwork" id="section-2.1.2.1-2">
<pre>
localPart         = &lt;local part of address&gt;
domain            = &lt;domain part of address&gt;
email             = localPart "@" domain
keySpec           = &lt;BASE64 encoded AsymmetricKey [DER encoded]&gt;
smtpAlternateSpec = localPart ".." keySpec ".." domain "@localhost"
smtpUrl           = "vortexsmtp://" smtpAlternateSpec
</pre><a href="#section-2.1.2.1-2" class="pilcrow">¶</a>
</div>
<p id="section-2.1.2.1-3">This representation does not support quoted local part SMTP addresses.<a href="#section-2.1.2.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="entities_node_spec_spec">
<section id="section-2.1.2.2">
            <h5 id="name-nodespec-for-xmpp-nodes">
<a href="#section-2.1.2.2" class="section-number selfRef">2.1.2.2. </a><a href="#name-nodespec-for-xmpp-nodes" class="section-name selfRef">NodeSpec for XMPP nodes</a>
            </h5>
<p id="section-2.1.2.2-1">Typically, a node specification follows the ASN.1 block NodeSpec. For support of XMPP clients, an implementation SHOULD support the jidAlternateSpec (its specification is noted in ABNF as in <span>[<a href="#RFC5234" class="xref">RFC5234</a>]</span>).<a href="#section-2.1.2.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-abnf art-text artwork" id="section-2.1.2.2-2">
<pre>
localPart         = &lt;local part of address&gt;
domain            = &lt;domain part of address&gt;
resourcePart      = &lt;resource part of the address&gt;
jid               = localPart "@" domain [ "/" resourcePart ]
keySpec           = &lt;BASE64 encoded AsymmetricKey [DER encoded]&gt;;
jidAlternateSpec  = localPart ".." keySpec ".."
                    domain "@localhost" [ "/" resourcePart ]
jidUrl            = "vortexxmpp://" jidAlternateSpec
</pre><a href="#section-2.1.2.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="entities_peer">
<section id="section-2.2">
        <h3 id="name-peer-partners">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-peer-partners" class="section-name selfRef">Peer Partners</a>
        </h3>
<p id="section-2.2-1">This document refers to two or more message sending or receiving entities as peer partners. One partner sends a message, and all others receive one or more messages. Peer partners are message specific, and each partner always connects directly to a node.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="entities_keys">
<section id="section-2.3">
        <h3 id="name-encryption-keys">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-encryption-keys" class="section-name selfRef">Encryption Keys</a>
        </h3>
<p id="section-2.3-1">Several keys are required for a Vortex message. For identities and ephemeral identities (see below), we use asymmetric keys, while symmetric keys are used for message encryption.<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<div id="entities_node_identity">
<section id="section-2.3.1">
          <h4 id="name-identity-keys">
<a href="#section-2.3.1" class="section-number selfRef">2.3.1. </a><a href="#name-identity-keys" class="section-name selfRef">Identity Keys</a>
          </h4>
<p id="section-2.3.1-1">Every participant of the network includes an asymmetric key, which SHOULD be either an EC key with a minimum length of 384 bits or an RSA key with a minimum length of 2048 bits.<a href="#section-2.3.1-1" class="pilcrow">¶</a></p>
<p id="section-2.3.1-2">The public key must be known by all parties writing to or through the node.<a href="#section-2.3.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="entities_keys_peer">
<section id="section-2.3.2">
          <h4 id="name-peer-key">
<a href="#section-2.3.2" class="section-number selfRef">2.3.2. </a><a href="#name-peer-key" class="section-name selfRef">Peer Key</a>
          </h4>
<p id="section-2.3.2-1">Peer keys are symmetrical keys transmitted with a Vortex message and are always known to the node sending the message, the node receiving the message, and the creator of the routing block.<a href="#section-2.3.2-1" class="pilcrow">¶</a></p>
<p id="section-2.3.2-2">A peer key is included in the Vortex message as well as the building instructions for subsequent Vortex messages (see RoutingCombo in <a href="#asn_one" class="xref">Appendix A</a>).<a href="#section-2.3.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="entities_keys_sender">
<section id="section-2.3.3">
          <h4 id="name-sender-key">
<a href="#section-2.3.3" class="section-number selfRef">2.3.3. </a><a href="#name-sender-key" class="section-name selfRef">Sender Key</a>
          </h4>
<p id="section-2.3.3-1">The sender key is a symmetrical key protecting the identity and routing block of a Vortex message. It is encrypted with the receiving peer key and prefixed to the identity block. This key further decouples the identity and processing information from the previous key.<a href="#section-2.3.3-1" class="pilcrow">¶</a></p>
<p id="section-2.3.3-2">A sender key is known to only one peer of a Vortex message and the creator of the routing block.<a href="#section-2.3.3-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="entities_vortex_message">
<section id="section-2.4">
        <h3 id="name-vortex-message">
<a href="#section-2.4" class="section-number selfRef">2.4. </a><a href="#name-vortex-message" class="section-name selfRef">Vortex Message</a>
        </h3>
<p id="section-2.4-1">The term 'Vortex message' represents a single transmission between two routing layers. A message adapted to the transport layer by the blending layer is called a 'blended Vortex message' (see <a href="#layer_overview" class="xref">Section 3</a>).<a href="#section-2.4-1" class="pilcrow">¶</a></p>
<p id="section-2.4-2">A complete Vortex message contains the following items:<a href="#section-2.4-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.4-3.1">The peer key, which is encrypted with the host key of the node and stored in a prefixBlock, protects the inner Vortex message (innerMessageBlock).<a href="#section-2.4-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.4-3.2">The sender key, also encrypted with the host key of the node, protects the identity and routing block.<a href="#section-2.4-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.4-3.3">The identity block, protected by the sender key, contains information about the ephemeral identity of the sender, replay
            protection information, header requests (optional), and a requirement reply (optional).<a href="#section-2.4-3.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.4-3.4">The routing block, protected by the sender key, contains information on how subsequent messages are processed, assembled, and blended.<a href="#section-2.4-3.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.4-3.5">The payload block, protected by the peer key, contains payload chunks for processing.<a href="#section-2.4-3.5" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="entities_message">
<section id="section-2.5">
        <h3 id="name-message">
<a href="#section-2.5" class="section-number selfRef">2.5. </a><a href="#name-message" class="section-name selfRef">Message</a>
        </h3>
<p id="section-2.5-1">A message is content to be transmitted from a single sender to a recipient. The sender uses a routing block either built by themself or provided by the receiver to perform the transmission. While a message may be anonymous, there are different degrees of anonymity as described in the following.<a href="#section-2.5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.5-2.1">If the sender of a message is not known to anyone else except the sender, then this degree is referred to as 'sender anonymity.'<a href="#section-2.5-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.5-2.2">If the receiver of a message is not known to anyone else except the receiver, then the degree is 'receiver anonymity.'<a href="#section-2.5-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.5-2.3">If an attacker is unable to determine the content, original sender, and final receiver, then the degree is considered 'third-party anonymity.'<a href="#section-2.5-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.5-2.4">If a sender or a receiver may be determined as one of a set of &lt;k&gt; entities, then it is referred to as k-anonymity<span>[<a href="#KAnon" class="xref">KAnon</a>]</span>.<a href="#section-2.5-2.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-2.5-3">A message is always MIME-encoded as specified in <span>[<a href="#RFC2045" class="xref">RFC2045</a>]</span>.<a href="#section-2.5-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="keys">
<section id="section-2.6">
        <h3 id="name-key-and-mac-specifications-">
<a href="#section-2.6" class="section-number selfRef">2.6. </a><a href="#name-key-and-mac-specifications-" class="section-name selfRef">Key and MAC specifications and usage</a>
        </h3>
<p id="section-2.6-1">MessageVortex uses a unique encoding for keys. This encoding is designed to be small and flexible while maintaining a specific base structure.<a href="#section-2.6-1" class="pilcrow">¶</a></p>
<p id="section-2.6-2">The following key structures are available:<a href="#section-2.6-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.6-3.1">SymmetricKey<a href="#section-2.6-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.6-3.2">AsymmetricKey<a href="#section-2.6-3.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-2.6-4">MAC does not require a complete structure containing specs and values, and only a MacAlgorithmSpec is available. The following sections outline the constraints for specifying parameters of these structures where a node MUST NOT specify any parameter more than once.<a href="#section-2.6-4" class="pilcrow">¶</a></p>
<p id="section-2.6-5">If a crypto mode is specified requiring an IV, then a node MUST provide the IV when specifying the key.<a href="#section-2.6-5" class="pilcrow">¶</a></p>
<div id="asymmetricKey">
<section id="section-2.6.1">
          <h4 id="name-asymmetric-keys">
<a href="#section-2.6.1" class="section-number selfRef">2.6.1. </a><a href="#name-asymmetric-keys" class="section-name selfRef">Asymmetric Keys</a>
          </h4>
<p id="section-2.6.1-1">Nodes use asymmetric keys for identifying peer nodes (i.e., Identities) and encrypting symmetric keys (for subsequent de-/encryption of the payload or blocks). All asymmetric keys MUST contain a key type specifying a strictly normed key. Also, they MUST contain a public part of the key encoded as an X.509 container and a private key specified in PKCS#8 wherever possible.<a href="#section-2.6.1-1" class="pilcrow">¶</a></p>
<p id="section-2.6.1-2">RSA and EC keys MUST contain a keySize parameter. All asymmetric keys SHOULD have a padding parameter, and a node SHOULD assume PKCS#1 if no padding is specified.<a href="#section-2.6.1-2" class="pilcrow">¶</a></p>
<p id="section-2.6.1-3">NTRU specification MUST provide the parameters "n", "p", and "q".<a href="#section-2.6.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="symmetricKey">
<section id="section-2.6.2">
          <h4 id="name-symmetric-keys">
<a href="#section-2.6.2" class="section-number selfRef">2.6.2. </a><a href="#name-symmetric-keys" class="section-name selfRef">Symmetric Keys</a>
          </h4>
<p id="section-2.6.2-1">Nodes use symmetric keys for encrypting payloads and control blocks. These symmetric keys MUST contain a key type specifying a key, which MUST be in an encoded form.<a href="#section-2.6.2-1" class="pilcrow">¶</a></p>
<p id="section-2.6.2-2">A node MUST provide a keySize parameter if the key (or equivalently, the block) size is not standardized or encoded in the name. All symmetric key specifications MUST contain a mode and padding parameter. A node MAY list multiple padding or mode parameters in a ReplyCapability block to offer the recipient a free choice.<a href="#section-2.6.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="entities_transport_address">
<section id="section-2.7">
        <h3 id="name-transport-address">
<a href="#section-2.7" class="section-number selfRef">2.7. </a><a href="#name-transport-address" class="section-name selfRef">Transport Address</a>
        </h3>
<p id="section-2.7-1">The term 'transport address' represents the token required to address the next immediate node on the transport layer. An email transport layer would have SMTP addresses, such as 'vortex@example.com,' as the transport address.<a href="#section-2.7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="entities_identity">
<section id="section-2.8">
        <h3 id="name-identity">
<a href="#section-2.8" class="section-number selfRef">2.8. </a><a href="#name-identity" class="section-name selfRef">Identity</a>
        </h3>
<div id="entities_identity_peer">
<section id="section-2.8.1">
          <h4 id="name-peer-identity">
<a href="#section-2.8.1" class="section-number selfRef">2.8.1. </a><a href="#name-peer-identity" class="section-name selfRef">Peer Identity</a>
          </h4>
<p id="section-2.8.1-1">The peer identity may contain the following information of a peerpartner:<a href="#section-2.8.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.8.1-2.1">A transport address (always) and the public key of thisidentity, given there is no recipient anonymity.<a href="#section-2.8.1-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-2.8.1-2.2">A routing block, which may be used to contact the sender. If striving for recipient anonymity, then this block is required.<a href="#section-2.8.1-2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-2.8.1-2.3">The private key, which is only known by the owner of the identity.<a href="#section-2.8.1-2.3" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="entities_identity_ephemeral">
<section id="section-2.8.2">
          <h4 id="name-ephemeral-identity">
<a href="#section-2.8.2" class="section-number selfRef">2.8.2. </a><a href="#name-ephemeral-identity" class="section-name selfRef">Ephemeral Identity</a>
          </h4>
<p id="section-2.8.2-1">Ephemeral identities are temporary identities created on a single node. These identities MUST NOT relate to another identity on any other node so that they allow bookkeeping for a node. Each ephemeral identity has a workspace assigned and may also have the following items assigned.<a href="#section-2.8.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.8.2-2.1">An asymmetric key pair to represent the identity.<a href="#section-2.8.2-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-2.8.2-2.2">A validity time of the identity.<a href="#section-2.8.2-2.2" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="entities_identity_official">
<section id="section-2.8.3">
          <h4 id="name-official-identity">
<a href="#section-2.8.3" class="section-number selfRef">2.8.3. </a><a href="#name-official-identity" class="section-name selfRef">Official Identity</a>
          </h4>
<p id="section-2.8.3-1">An official identity may have the following items assigned.<a href="#section-2.8.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.8.3-2.1">Routing blocks used to reply to the node.<a href="#section-2.8.3-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-2.8.3-2.2">A list of assigned ephemeral identities on all other nodes and their projected quotas.<a href="#section-2.8.3-2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-2.8.3-2.3">A list of known nodes with the respective node identity.<a href="#section-2.8.3-2.3" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="entities_workspace">
<section id="section-2.9">
        <h3 id="name-workspace">
<a href="#section-2.9" class="section-number selfRef">2.9. </a><a href="#name-workspace" class="section-name selfRef">Workspace</a>
        </h3>
<p id="section-2.9-1">Every official or ephemeral identity has a workspace, which consists of the following elements.<a href="#section-2.9-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.9-2.1">Zero or more routing blocks to be processed.<a href="#section-2.9-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.9-2.2">
            <p id="section-2.9-2.2.1">Slots for a payload block sequentially numbered. Every slot:<a href="#section-2.9-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.9-2.2.2.1">MUST contain a numerical ID identifying the slot.<a href="#section-2.9-2.2.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-2.9-2.2.2.2">MAY contain payload content.<a href="#section-2.9-2.2.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-2.9-2.2.2.3">If a block contains a payload, then it MUST contain a validity period.<a href="#section-2.9-2.2.2.3" class="pilcrow">¶</a>
</li>
            </ul>
</li>
        </ul>
</section>
</div>
<div id="entities_murb">
<section id="section-2.10">
        <h3 id="name-multi-use-reply-blocks">
<a href="#section-2.10" class="section-number selfRef">2.10. </a><a href="#name-multi-use-reply-blocks" class="section-name selfRef">Multi-use Reply Blocks</a>
        </h3>
<p id="section-2.10-1">'Multi-use reply blocks' (MURB) are a special type routing block sent to a receiver of a message or request. A sender may use such a block one or several times to reply to the sender linked to the ephemeral identity, and it is possible to achieve sender anonymity using MURBs.<a href="#section-2.10-1" class="pilcrow">¶</a></p>
<p id="section-2.10-2">A vortex node MAY deny the use of MURBs by indicating a maxReplay equal to zero when sending a ReplyCapability block. An unobservable node SHOULD deny the use of MURBs.<a href="#section-2.10-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="entities_version">
<section id="section-2.11">
        <h3 id="name-protocol-version">
<a href="#section-2.11" class="section-number selfRef">2.11. </a><a href="#name-protocol-version" class="section-name selfRef">Protocol Version</a>
        </h3>
<p id="section-2.11-1">This document describes version 1 of the protocol. The message PrefixBlock contains an optional version indicator. If the protocol verion is absent protocol version 1 should be assumed.<a href="#section-2.11-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="layer_overview">
<section id="section-3">
      <h2 id="name-layer-overview">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-layer-overview" class="section-name selfRef">Layer Overview</a>
      </h2>
<p id="section-3-1">The protocol is designed in four layers as shown in <a href="#fig_layer_overview" class="xref">Figure 1</a>.<a href="#section-3-1" class="pilcrow">¶</a></p>
<span id="name-layer-overview-2"></span><div id="fig_layer_overview">
<figure id="figure-1">
        <div class="alignCenter art-ascii-art art-text artwork" id="section-3-2.1">
<pre>+------------------------------------------------------------------+
| Vortex Node                                                      |
| +--------------------------------------------------------------+ |
| |                       Accounting                             | |
| |______________________________________________________________| |
|                                                                  |
| +--------------------------------------------------------------+ |
| |                         Routing                              | |
| |______________________________________________________________| |
|                                                                  |
| +---------------------------+ +--------------------------------+ |
| |           Blending        | |             Blending           | |
| |___________________________| |________________________________| |
|__________________________________________________________________|
  +---------------------------+ +--------------+ +---------------+
  |          Transport        | | Transport in | | Transport out |
  |___________________________| |______________| |_______________|
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-layer-overview-2" class="selfRef">Layer overview</a>
        </figcaption></figure>
</div>
<p id="section-3-3">Every participating node MUST implement the layer's blending, routing, and accounting. There MUST be at least one incoming and one outgoing transport layer available to a node. All blending layers SHOULD connect to the respective transport layers for sending and receiving packets.<a href="#section-3-3" class="pilcrow">¶</a></p>
<div id="layer_overview_transport">
<section id="section-3.1">
        <h3 id="name-transport-layer">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-transport-layer" class="section-name selfRef">Transport Layer</a>
        </h3>
<p id="section-3.1-1">The transport layer transfers the blended Vortex messages to the next vortex node and stores it until the next blending layer picks up the message.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">The transport layer infrastructure SHOULD NOT be specific to anonymous communication and should contain significant portions of non-Vortex traffic.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="layer_overview_blending">
<section id="section-3.2">
        <h3 id="name-blending-layer">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-blending-layer" class="section-name selfRef">Blending Layer</a>
        </h3>
<p id="section-3.2-1">The blending layer embeds blended Vortex message into the transport layer data stream and extracts the packets from the transport layer.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="layer_overview_routing">
<section id="section-3.3">
        <h3 id="name-routing-layer">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-routing-layer" class="section-name selfRef">Routing Layer</a>
        </h3>
<p id="section-3.3-1">The routing layer expands the information contained in MessageVortex packets, processes them, and passes generated packets to the respective blending layer.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="layer_overview_accounting">
<section id="section-3.4">
        <h3 id="name-accounting-layer">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-accounting-layer" class="section-name selfRef">Accounting Layer</a>
        </h3>
<p id="section-3.4-1">The accounting layer tracks all ephemeral identities authorized to use a MessageVortex node and verifies the available quotas to an ephemeral identity.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<section id="section-4">
      <h2 id="name-vortex-message-2">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-vortex-message-2" class="section-name selfRef">Vortex Message</a>
      </h2>
<section id="section-4.1">
        <h3 id="name-overview">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-overview" class="section-name selfRef">Overview</a>
        </h3>
<p id="section-4.1-1"><a href="#fig_message_overview" class="xref">Figure 2</a> shows a Vortex message. The enclosed sections denote encrypted blocks, and the three- or four-letter abbreviations denote the key required for decryption. The abbreviation k_h stands for the asymmetric host key, and sk_p is the symmetric peer key. The receiving node obtains this key by decrypting MPREFIX with its host key k_h. Then, sk_s is the symmetric sender key. When decrypting the MPREFIX block, the node obtains this key. The sender key protects the header and routing blocks by guaranteeing that the node assembling the message does not know about upcoming identities, operations, and requests. The peer key protects the message, including its structure, from third-party observers.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<span id="name-vortex-message-overview"></span><div id="fig_message_overview">
<figure id="figure-2">
          <div class="alignCenter art-ascii-art art-text artwork" id="section-4.1-2.1">
<pre>
+-+---+-+-+---+-+---+-+-+---+-+-+-+-------+-+
| |   | | | | C | | |   | | | R | |       | |
| |   | | | | P | | | H | | | O | |       | |
| | M | | | | R | | | E | | | U | |   P   | |
| | P | | | | E | | | A | | | T | |   A   | |
| | R | | | | F | | | D | | | I | |   Y   | |
| | E | | | | I | | | E | | | N | |   L   | |
| | F | | | | X | | | R | | | G | |   O   | |
| | I | | | +---+ | |___| | |___| |   A   | |
| | X | | |  k_h  | sk_s  | sk_s  |   D   | |
| |___| | |_______|_______|_______|_______| |
|  k_h  |                sk_p               |
|_______|___________________________________|
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-vortex-message-overview" class="selfRef">Vortex message overview</a>
          </figcaption></figure>
</div>
</section>
<section id="section-4.2">
        <h3 id="name-message-prefix-block-mprefi">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-message-prefix-block-mprefi" class="section-name selfRef">Message Prefix Block (MPREFIX)</a>
        </h3>
<p id="section-4.2-1">The PrefixBlock contains a symmetrical key as defined in <a href="#asnOne_schema" class="xref">Appendix A.1</a> and is encrypted using the host key of the receiving peer host. The symmetric key utilized MUST be from the set advertised by a CapabilitiesReplyBlock (see <a href="#routing_header_req_cap" class="xref">Section 7.2.6</a>). A node MAY choose any parameters omitted in the CapabilitiesReplyBlock freely unless stated otherwise in <a href="#routing_header_req_cap" class="xref">Section 7.2.6</a>. A node SHOULD avoid sending unencrypted PrefixBlocks. A host MAY reply to a message with an unencrypted message block, but any reply to a message SHOULD be encrypted.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">The sender MUST choose a key that may be encrypted with the host key in the respective PrefixBlock using the padding advertised by the CapabilitiesReplyBlock.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
</section>
<section id="section-4.3">
        <h3 id="name-inner-message-block">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-inner-message-block" class="section-name selfRef">Inner Message Block</a>
        </h3>
<p id="section-4.3-1">A node MUST always encrypt an InnerMessageBlock with the symmetric key of the PrefixBlock to hide the inner structure of the message. The InnerMessageBlock SHOULD always accommodate four or more payload chunks.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<section id="section-4.3.1">
          <h4 id="name-control-prefix-block">
<a href="#section-4.3.1" class="section-number selfRef">4.3.1. </a><a href="#name-control-prefix-block" class="section-name selfRef">Control Prefix Block</a>
          </h4>
<p id="section-4.3.1-1">Control prefix (CPREFIX) and MPREFIX blocks share the same structure and logic as well as containing the sender key sk_s. If an MPREFIX block is unencrypted, a node MAY omit the CPREFIX block. An omitted CPREFIX block results in unencrypted control blocks (e.g., the HeaderBlock and RoutingBlock).<a href="#section-4.3.1-1" class="pilcrow">¶</a></p>
</section>
<section id="section-4.3.2">
          <h4 id="name-control-blocks">
<a href="#section-4.3.2" class="section-number selfRef">4.3.2. </a><a href="#name-control-blocks" class="section-name selfRef">Control Blocks</a>
          </h4>
<p id="section-4.3.2-1">The control blocks of the HeaderBlock and a RoutingBlock contain the core information to process the payload.<a href="#section-4.3.2-1" class="pilcrow">¶</a></p>
<section id="section-4.3.2.1">
            <h5 id="name-header-block">
<a href="#section-4.3.2.1" class="section-number selfRef">4.3.2.1. </a><a href="#name-header-block" class="section-name selfRef">Header Block</a>
            </h5>
<p id="section-4.3.2.1-1">The header block (see HeaderBlock in <a href="#asn_one" class="xref">Appendix A</a>) contains the following information.<a href="#section-4.3.2.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.2.1-2.1">It MUST contain the local ephemeral identity of the routing block builder.<a href="#section-4.3.2.1-2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.3.2.1-2.2">It MAY contain header requests.<a href="#section-4.3.2.1-2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.3.2.1-2.3">It MAY contain the solution to a PuzzleRequired block previously opposed in a header request.<a href="#section-4.3.2.1-2.3" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-4.3.2.1-3">The list of header requests MAY be one of the following.<a href="#section-4.3.2.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.2.1-4.1">Empty.<a href="#section-4.3.2.1-4.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.3.2.1-4.2">Contain a single identity create request (HeaderRequestIdentity).<a href="#section-4.3.2.1-4.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.3.2.1-4.3">Contain a single increase quota request.<a href="#section-4.3.2.1-4.3" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-4.3.2.1-5">If a header block violates these rules, then a node MUST NOT reply to any header request. The payload and routing blocks SHOULD still be added to the workspace and processed if the message quota is not exceeded.<a href="#section-4.3.2.1-5" class="pilcrow">¶</a></p>
</section>
<section id="section-4.3.2.2">
            <h5 id="name-routing-block">
<a href="#section-4.3.2.2" class="section-number selfRef">4.3.2.2. </a><a href="#name-routing-block" class="section-name selfRef">Routing Block</a>
            </h5>
<p id="section-4.3.2.2-1">The routing block (see RoutingBlock in <a href="#asn_one" class="xref">Appendix A</a>) contains the following information.<a href="#section-4.3.2.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.2.2-2.1">It MUST contain a serial number uniquely identifying the routing block of this user. The serial number MUST be unique during the lifetime of the routing block.<a href="#section-4.3.2.2-2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.3.2.2-2.2">It MUST contain the same forward secret as the two prefix blocks and the header block.<a href="#section-4.3.2.2-2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.3.2.2-2.3">It MAY contain assembly and processing instructions for subsequent messages.<a href="#section-4.3.2.2-2.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.3.2.2-2.4">It MAY contain a reply block for messages assigned to the owner of the identity.<a href="#section-4.3.2.2-2.4" class="pilcrow">¶</a>
</li>
            </ul>
</section>
</section>
<section id="section-4.3.3">
          <h4 id="name-payload-block">
<a href="#section-4.3.3" class="section-number selfRef">4.3.3. </a><a href="#name-payload-block" class="section-name selfRef">Payload Block</a>
          </h4>
<p id="section-4.3.3-1">Each InnerMessageBlock with routing information SHOULD contain at least four PayloadChunks.<a href="#section-4.3.3-1" class="pilcrow">¶</a></p>
</section>
</section>
</section>
<section id="section-5">
      <h2 id="name-general-notes">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-general-notes" class="section-name selfRef">General notes</a>
      </h2>
<p id="section-5-1">The MessageVortex protocol is a modular protocol that allows the use of different encryption algorithms. For its operation, a Vortex node SHOULD always support at least two distinct types of algorithms,  paddings, or modes such that they rely on two mathematical problems.<a href="#section-5-1" class="pilcrow">¶</a></p>
<section id="section-5.1">
        <h3 id="name-supported-symmetric-ciphers">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-supported-symmetric-ciphers" class="section-name selfRef">Supported Symmetric Ciphers</a>
        </h3>
<p id="section-5.1-1">A node MUST support the following symmetric ciphers.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1-2.1">AES128 (see <span>[<a href="#FIPS-AES" class="xref">FIPS-AES</a>]</span> for AES implementation details).<a href="#section-5.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.1-2.2">AES256.<a href="#section-5.1-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.1-2.3">CAMELLIA128 (see <span>[<a href="#RFC3657" class="xref">RFC3657</a>]</span> Chapter 3 for Camellia implementation details).<a href="#section-5.1-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.1-2.4">CAMELLIA256.<a href="#section-5.1-2.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.1-3">A node SHOULD support any standardized key larger than the smallest key size.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
<p id="section-5.1-4">A node MAY support Twofish ciphers (see <span>[<a href="#TWOFISH" class="xref">TWOFISH</a>]</span>).<a href="#section-5.1-4" class="pilcrow">¶</a></p>
</section>
<section id="section-5.2">
        <h3 id="name-supported-asymmetric-cipher">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-supported-asymmetric-cipher" class="section-name selfRef">Supported Asymmetric Ciphers</a>
        </h3>
<p id="section-5.2-1">A node MUST support the following asymmetric ciphers.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2-2.1">RSA with key sizes larger or equal to 2048 (<span>[<a href="#RFC8017" class="xref">RFC8017</a>]</span>).<a href="#section-5.2-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-2.2">ECC with named curves secp384r1, sect409k1 or secp521r1 (see <span>[<a href="#SEC1" class="xref">SEC1</a>]</span>).<a href="#section-5.2-2.2" class="pilcrow">¶</a>
</li>
        </ul>
</section>
<section id="section-5.3">
        <h3 id="name-supported-macs">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-supported-macs" class="section-name selfRef">Supported MACs</a>
        </h3>
<p id="section-5.3-1">A node MUST support the following Message Authentication Codes (MAC).<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3-2.1">SHA3-256 (see <span>[<a href="#ISO-10118-3" class="xref">ISO-10118-3</a>]</span> for SHA implementation details).<a href="#section-5.3-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.3-2.2">RipeMD160 (see <span>[<a href="#ISO-10118-3" class="xref">ISO-10118-3</a>]</span> for RIPEMD implementation details).<a href="#section-5.3-2.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.3-3">A node SHOULD support the following MACs.<a href="#section-5.3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3-4.1">SHA3-512.<a href="#section-5.3-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.3-4.2">RipeMD256.<a href="#section-5.3-4.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.3-4.3">RipeMD512.<a href="#section-5.3-4.3" class="pilcrow">¶</a>
</li>
        </ul>
</section>
<section id="section-5.4">
        <h3 id="name-supported-paddings">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-supported-paddings" class="section-name selfRef">Supported Paddings</a>
        </h3>
<p id="section-5.4-1">A node MUST support the following paddings specified in <span>[<a href="#RFC8017" class="xref">RFC8017</a>]</span>.<a href="#section-5.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.4-2.1">PKCS1 (see <span>[<a href="#RFC8017" class="xref">RFC8017</a>]</span>).<a href="#section-5.4-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.4-2.2">PKCS7 (see <span>[<a href="#RFC5958" class="xref">RFC5958</a>]</span>).<a href="#section-5.4-2.2" class="pilcrow">¶</a>
</li>
        </ul>
</section>
<section id="section-5.5">
        <h3 id="name-supported-modes">
<a href="#section-5.5" class="section-number selfRef">5.5. </a><a href="#name-supported-modes" class="section-name selfRef">Supported Modes</a>
        </h3>
<p id="section-5.5-1">A node MUST support the following modes.<a href="#section-5.5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.5-2.1">CBC (see <span>[<a href="#RFC1423" class="xref">RFC1423</a>]</span>) such that the utilized IV must be of equal length as the key.<a href="#section-5.5-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.5-2.2">EAX (see <span>[<a href="#EAX" class="xref">EAX</a>]</span>).<a href="#section-5.5-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.5-2.3">GCM (see <span>[<a href="#RFC5288" class="xref">RFC5288</a>]</span>).<a href="#section-5.5-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.5-2.4">NONE (only used in special cases, see <a href="#security" class="xref">Section 10</a>).<a href="#section-5.5-2.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.5-3">A node SHOULD NOT use the following modes.<a href="#section-5.5-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.5-4.1">NONE (except as stated when using the addRedundancy function).<a href="#section-5.5-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.5-4.2">ECB.<a href="#section-5.5-4.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.5-5">A node SHOULD support the following modes.<a href="#section-5.5-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.5-6.1">CTR (<span>[<a href="#RFC3686" class="xref">RFC3686</a>]</span>).<a href="#section-5.5-6.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.5-6.2">CCM (<span>[<a href="#RFC3610" class="xref">RFC3610</a>]</span>).<a href="#section-5.5-6.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.5-6.3">OCB (<span>[<a href="#RFC7253" class="xref">RFC7253</a>]</span>).<a href="#section-5.5-6.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.5-6.4">OFB (<span>[<a href="#MODES" class="xref">MODES</a>]</span>).<a href="#section-5.5-6.4" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</section>
<div id="blending">
<section id="section-6">
      <h2 id="name-blending">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-blending" class="section-name selfRef">Blending</a>
      </h2>
<p id="section-6-1">Each node supports a fixed set of blending capabilities, which may be different for incoming and outgoing messages.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">The following sections describe the blending mechanism. There are currently two blending layers specified with one for the Simple Mail Transfer Protocol (SMTP, see <span>[<a href="#RFC5321" class="xref">RFC5321</a>]</span>) and the second for the Extensible Messaging and Presence Protocol (XMPP, see <span>[<a href="#RFC6120" class="xref">RFC6120</a>]</span>). All nodes MUST at least support "encoding=plain:0,256".<a href="#section-6-2" class="pilcrow">¶</a></p>
<div id="blending_general">
<section id="section-6.1">
        <h3 id="name-blending-in-attachments">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-blending-in-attachments" class="section-name selfRef">Blending in Attachments</a>
        </h3>
<p id="section-6.1-1">There are two types of blending supported when using attachments.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-2.1">Plain binary encoding with offset (PLAIN).<a href="#section-6.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.1-2.2">Embedding with F5 in an image (F5).<a href="#section-6.1-2.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-6.1-3">A node MUST support PLAIN blending for reasons of interoperability, whereas a node MAY support blending using F5.<a href="#section-6.1-3" class="pilcrow">¶</a></p>
<p id="section-6.1-4">A routing block builder (RBB) MUST take care of sizing restrictions of the transport layer when composing routing blocks<a href="#section-6.1-4" class="pilcrow">¶</a></p>
<div id="blending_general_plain">
<section id="section-6.1.1">
          <h4 id="name-plain-embedding-into-attach">
<a href="#section-6.1.1" class="section-number selfRef">6.1.1. </a><a href="#name-plain-embedding-into-attach" class="section-name selfRef">PLAIN embedding into attachments</a>
          </h4>
<p id="section-6.1.1-1">A blending layer embeds a VortexMessage in a carrier file with an offset for PLAIN blending. For replacing a file start, a node MUST use the offset 0. The routing node MUST choose the payload file for the message and SHOULD use a credible payload type (e.g., MIMEtype) with high entropy. Furthermore, it SHOULD prefix a valid header structure to avoid easy detection of the Vortex message. Finally, a routing node SHOULD use a valid footer, if any, to a payload file to improve blending.<a href="#section-6.1.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1.1-2">The blended Vortex message is embedded in one or more message chunks, each starting with a chunk header. The chunk header consists of two unsigned integers of variable length. The integer starts with the LSB, and if bit 7 is set, then another byte follows.           There cannot be more than four bytes whereas the last, fourth byte is always 8 bit. The three preceding bytes have a payload of seven bits each, which results in a maximum number of 2^29 bits. The first of the extracted numbers (modulo remaining document bytes starting from the first and including byte of the chunk header) reflect the number of bytes in the chunk after the chunk header. The second contains the number of bytes (again modulo remaining document bytes) to be skipped after the current chunk to reach the next chunk. There is no "last chunk" indicator. A gap or chunk may surpass the end of the file.<a href="#section-6.1.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-ascii-art art-text artwork" id="section-6.1.1-3">
<pre>

pos: 00h   02h   04h   06h   08h...400h  402h  404h  406h  408h  40Ah
val: 01 02 03 04 05 06 07 08 09 ...01 05 0A 0B 0C 0D 0E 0F f0 03 12 13

Embedding: "(plain:1024)"

Result:  0A 13 (+ 494 omitted bytes; then skip 12 bytes to next chunk)

</pre><a href="#section-6.1.1-3" class="pilcrow">¶</a>
</div>
<p id="section-6.1.1-4">A node SHOULD offer at least one PLAIN blending method and MAY offer multiple offsets for incoming Vortex messages.<a href="#section-6.1.1-4" class="pilcrow">¶</a></p>
<p id="section-6.1.1-5">A plain blending is specified as follows.<a href="#section-6.1.1-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-abnf art-text artwork" id="section-6.1.1-6">
<pre>
plainEncoding = "("plain:" &lt;numberOfBytesOfOffset&gt;
                [ "," &lt;numberOfBytesOfOffset&gt; ]* ")"
</pre><a href="#section-6.1.1-6" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="blending_general_F5">
<section id="section-6.1.2">
          <h4 id="name-f5-embedding-into-attachmen">
<a href="#section-6.1.2" class="section-number selfRef">6.1.2. </a><a href="#name-f5-embedding-into-attachmen" class="section-name selfRef">F5 embedding into attachments</a>
          </h4>
<p id="section-6.1.2-1">For F5, a blending layer embeds a Vortex message into a jpeg file according to <span>[<a href="#F5" class="xref">F5</a>]</span>. The password for blending may be public, and a routing node MAY advertise multiple passwords. The use of F5 adds approximately tenfold transfer volume to the message. A          routing block building node SHOULD only use F5 blending where appropriate.<a href="#section-6.1.2-1" class="pilcrow">¶</a></p>
<p id="section-6.1.2-2">A blending in F5 is specified as the following.<a href="#section-6.1.2-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-abnf art-text artwork" id="section-6.1.2-3">
<pre>
f5Encoding = "(F5:" &lt;passwordString&gt; [ "," &lt;PasswordString&gt; ]* ")"
</pre><a href="#section-6.1.2-3" class="pilcrow">¶</a>
</div>
<p id="section-6.1.2-4">Commas and backslashes in passwords MUST be escaped with a backslash whereas closing brackets are treated as normal password characters unless they are the final character of the encoding specification string.<a href="#section-6.1.2-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="blending_smtp">
<section id="section-6.2">
        <h3 id="name-blending-into-an-smtp-layer">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-blending-into-an-smtp-layer" class="section-name selfRef">Blending into an SMTP layer</a>
        </h3>
<p id="section-6.2-1">Email messages with content MUST be encoded with Multipurpose Internet Mail Extensions (MIME) as specified in <span>[<a href="#RFC2045" class="xref">RFC2045</a>]</span>. All nodes MUST support BASE64 encoding and MUST test all sections of a MIME message for the presence of a VortexMessage.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">A Vortex message is present if a block containing the peer key at the known offset of any MIME part decodes correctly.<a href="#section-6.2-2" class="pilcrow">¶</a></p>
<p id="section-6.2-3">A node SHOULD support SMTP-blending for sending and receiving. For sending SMTP, the specification in <span>[<a href="#RFC5321" class="xref">RFC5321</a>]</span> must be      used. TLS layers MUST always be applied when obtaining messages using   POP3 (as specified in <span>[<a href="#RFC1939" class="xref">RFC1939</a>]</span> and <span>[<a href="#RFC2595" class="xref">RFC2595</a>]</span>) or IMAP (as specified in <span>[<a href="#RFC3501" class="xref">RFC3501</a>]</span>). Any SMTP connection MUST employ a TLS encryption when passing credentials.<a href="#section-6.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="blending_xmpp">
<section id="section-6.3">
        <h3 id="name-blending-into-an-xmpp-layer">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-blending-into-an-xmpp-layer" class="section-name selfRef">Blending into an XMPP layer</a>
        </h3>
<p id="section-6.3-1">For interoperability, an implementation SHOULD provide XMPP-blending.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<p id="section-6.3-2">Blending into XMPP traffic is performed using the <span>[<a href="#XEP-0231" class="xref">XEP-0231</a>]</span> extension of the XMPP protocol.<a href="#section-6.3-2" class="pilcrow">¶</a></p>
<p id="section-6.3-3">PLAIN- and F5-blending are acceptable for this transport layer.<a href="#section-6.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="routing">
<section id="section-7">
      <h2 id="name-routing">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-routing" class="section-name selfRef">Routing</a>
      </h2>
<div id="routing_message">
<section id="section-7.1">
        <h3 id="name-vortex-message-processing">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-vortex-message-processing" class="section-name selfRef">Vortex Message Processing</a>
        </h3>
<div id="routing_incoming">
<section id="section-7.1.1">
          <h4 id="name-processing-of-incoming-vort">
<a href="#section-7.1.1" class="section-number selfRef">7.1.1. </a><a href="#name-processing-of-incoming-vort" class="section-name selfRef">Processing of incoming Vortex Messages</a>
          </h4>
<p id="section-7.1.1-1">An incoming message is considered initially unauthenticated. A node should consider a VortexMessage as authenticated as soon as the ephemeral identity is known and is not temporary.<a href="#section-7.1.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1.1-2">For an unauthenticated message, the following rules apply.<a href="#section-7.1.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.1.1-3.1">A node MUST ignore all routing blocks.<a href="#section-7.1.1-3.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-7.1.1-3.2">A node MUST ignore all payload blocks.<a href="#section-7.1.1-3.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-7.1.1-3.3">A node SHOULD accept identity creation requests in unauthenticated messages.<a href="#section-7.1.1-3.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-7.1.1-3.4">A node MUST ignore all other header requests except identity creation requests.<a href="#section-7.1.1-3.4" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-7.1.1-3.5">A node MUST ignore all identity creation requests belonging to an existing identity.<a href="#section-7.1.1-3.5" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-7.1.1-4">A message is considered authenticated as soon as the identity used in the header block is known and not temporary. A node MUST NOT treat a message as authenticated if the specified maximum number of replays is reached. For authenticated messages, the following rules apply.<a href="#section-7.1.1-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.1.1-5.1">A node MUST ignore identity creation requests.<a href="#section-7.1.1-5.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-7.1.1-5.2">A node MUST replace the current reply block with the reply block provided in the routing block (if any). The node MUST keep the reply block if none is provided.<a href="#section-7.1.1-5.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-7.1.1-5.3">A node SHOULD process all header requests.<a href="#section-7.1.1-5.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-7.1.1-5.4">A node SHOULD add all routing blocks to the workspace.<a href="#section-7.1.1-5.4" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-7.1.1-5.5">A node SHOULD add all payload blocks to the workspace.<a href="#section-7.1.1-5.5" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-7.1.1-6">A routing node MUST decrement the message quota by one if a          received message is authenticated, valid, and contains at least one payload block. If a message is identified as a duplicate according to reply protection, then a node MUST NOT decrement the message quota.<a href="#section-7.1.1-6" class="pilcrow">¶</a></p>
<p id="section-7.1.1-7">The message processing works according to the pseudo-code shown below.<a href="#section-7.1.1-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-pseudocode art-text artwork" id="section-7.1.1-8">
<pre>
function incomming_message(VortexMessage blendedMessage) {
  try{
    msg = unblend( blendedMessage );
    if( not msg ) {
      // Abort processing
      throw exception( "no embedded message found" )
    } else {
      hdr = get_header( msg )
      if( not known_identity( hdr.identity ) {
        if( get_requests( hdr ) contains HeaderRequestIdentity ) {
          create_new_identity( hdr ).set_temporary( true )
          send_message( create_requirement( hdr )  )
        } else {
          // Abort processing
          throw exception( "identity unknown" )
        }
      } else {
        if( is_duplicate_or_replayed( msg ) ) {
          // Abort processing
          throw exception "duplicate or replayed message" )
        } else {
          if( get_accounting( hdr.identity ).is_temporary() ) {
            if( not verify_requirement( hdr.identity, msg ) ) {
              get_accounting( hdr.identity ).set_temporary( false )
            }
          }
          if( get_accounting( hdr ).is_temporary() ) {
            throw exception( "no processing on temporary identity" )
          }

          // Message authenticated
          get_accounting( hdr.identity )
           .register_for_replay_protection( msg )
          if( not verify_mtching_forward_secrets( msg ) ) {
            throw exception( "forward secret missmatch" )
          }
          if( contains_payload( msg ) ) {
            if( get_accounting( hdr.identity
                .decrement_message_quota() ) {
              while index,nextPayloadBlock
                  == get_next_payload_block( msg ) {
                add_workspace( header.identity,
               index, nextPayloadBlock )
              }
              while nextRoutingBlock = get_next_routing_block( msg ) {
                add_workspace( hdr.identity,
               add_routing( nextRoutingBlock ) )
              }
              process_reserved_mapping_space( msg )
              while nextRequirement = get_next_requirement( hdr ) {
                add_workspace( hdr.identity, nextRequirement )
              }
            } else {
              throw exception( "Message quota exceeded" )
            }
          }
        }
      }
  } catch( exception e ) {
    // Message processing failed
    throw e;
  }
}
</pre><a href="#section-7.1.1-8" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="routing_workspace">
<section id="section-7.1.2">
          <h4 id="name-processing-of-routing-block">
<a href="#section-7.1.2" class="section-number selfRef">7.1.2. </a><a href="#name-processing-of-routing-block" class="section-name selfRef">Processing of Routing Blocks in the Workspace</a>
          </h4>
<p id="section-7.1.2-1">A routing workspace consists of the following items.<a href="#section-7.1.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.1.2-2.1">The linked identity, which determines the lifetime of the workspace.<a href="#section-7.1.2-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-7.1.2-2.2">The linked routing combos (RoutingCombo).<a href="#section-7.1.2-2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-7.1.2-2.3">
              <p id="section-7.1.2-2.3.1">A payload chunk space with the following multiple subspaces available:<a href="#section-7.1.2-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.1.2-2.3.2.1">ID 0 represents a message to be embedded (when reading) or a message to be extracted to the user (when written).<a href="#section-7.1.2-2.3.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-7.1.2-2.3.2.2">ID 1 to ID maxPayloadBlocks represent the payload chunk slots in the target message.<a href="#section-7.1.2-2.3.2.2" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-7.1.2-2.3.2.3">All blocks between ID maxPayloadBlocks + 1 to ID 32766 belong to a temporary routing block-specific space.<a href="#section-7.1.2-2.3.2.3" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-7.1.2-2.3.2.4">ID 32767 MUST be used to signal a solicited reply block.<a href="#section-7.1.2-2.3.2.4" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-7.1.2-2.3.2.5">All blocks between ID 32768 to ID 65535 belong to a shared space available to all operations of the identity.<a href="#section-7.1.2-2.3.2.5" class="pilcrow">¶</a>
</li>
              </ul>
</li>
          </ul>
<p id="section-7.1.2-3">The accounting layer typically triggers processing and represents either a cleanup action or a routing event. A cleanup event deletes the following information from all workspaces.<a href="#section-7.1.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.1.2-4.1">All processed routing combos.<a href="#section-7.1.2-4.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-7.1.2-4.2">All routing combos with expired usagePeriod.<a href="#section-7.1.2-4.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-7.1.2-4.3">All payload chunks exceeding the maxProcess time.<a href="#section-7.1.2-4.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-7.1.2-4.4">All expired objects.<a href="#section-7.1.2-4.4" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-7.1.2-4.5">All expired puzzles.<a href="#section-7.1.2-4.5" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-7.1.2-4.6">All expired identities.<a href="#section-7.1.2-4.6" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-7.1.2-4.7">All expired replay protections.<a href="#section-7.1.2-4.7" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-7.1.2-5">Note that maxProcessTime reflects the number of seconds since the arrival of the last octet of the message at the transport layer facility. A node SHOULD NOT take additional processing time (e.g., for anti-UBE or anti-virus) into account.<a href="#section-7.1.2-5" class="pilcrow">¶</a></p>
<p id="section-7.1.2-6">The accounting layer triggers routing events occurring at least the minProcessTime after the last octet of the message arrived at the routing layer. A node SHOULD choose the latest possible moment at which the peer node receives the last octet of the assembled message before the maxProcessTime is reached. The calculation of this last point in time where a message may be set SHOULD always assume that the target node is working. A sending node SHOULD choose the time within these bounds randomly. An accounting layer MAY trigger multiple routing combos in bulk to further obfuscate the identity of a single transport message.<a href="#section-7.1.2-6" class="pilcrow">¶</a></p>
<p id="section-7.1.2-7">First, the processing node escapes the payload chunk at ID 0 if needed (e.g., a non-special block is starting with a backslash). Next, it executes all processing instructions of the routing combo in the specified sequence. If an instruction fails, then the block at the target ID of the operation remains unchanged. The routing layer proceeds with the subsequent processing instructions by ignoring the error. For a detailed description of the operations, see <a href="#routing_operations" class="xref">Section 7.4</a>. If a node succeeds in building at least one payload chunk, then a VortexMessage is composed and passed to the blending layer.<a href="#section-7.1.2-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="routing_outgoing">
<section id="section-7.1.3">
          <h4 id="name-processing-of-outgoing-vort">
<a href="#section-7.1.3" class="section-number selfRef">7.1.3. </a><a href="#name-processing-of-outgoing-vort" class="section-name selfRef">Processing of Outgoing Vortex Messages</a>
          </h4>
<p id="section-7.1.3-1">The blending layer MUST compose a transport layer message according to the specification provided in the routing combo. It SHOULD choose any decoy message or steganographic carrier in such a way that the Dead Parrot syndrome, as specified in <span>[<a href="#DeadParrot" class="xref">DeadParrot</a>]</span>, is avoided.<a href="#section-7.1.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="routing_header">
<section id="section-7.2">
        <h3 id="name-header-requests">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-header-requests" class="section-name selfRef">Header Requests</a>
        </h3>
<p id="section-7.2-1">Header requests are control requests for the anonymization system. Messages with requests or replies only MUST NOT affect any quota.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<div id="routing_header_eid">
<section id="section-7.2.1">
          <h4 id="name-request-new-ephemeral-ident">
<a href="#section-7.2.1" class="section-number selfRef">7.2.1. </a><a href="#name-request-new-ephemeral-ident" class="section-name selfRef">Request New Ephemeral Identity</a>
          </h4>
<p id="section-7.2.1-1">Requesting a new ephemeral identity is performed by sending a message containing a header block with the new identity and an identity creation request (HeaderRequestIdentity) to a node. The node MAY send an error block (see <a href="#routing_special_error" class="xref">Section 7.3.1</a>) if it rejects the request.<a href="#section-7.2.1-1" class="pilcrow">¶</a></p>
<p id="section-7.2.1-2">If a node accepts an identity creation request, then it MUST send a reply. A node accepting a request without a requirement MUST send back a special block containing "no error". A node accepting a request under the precondition of a requirement to be fulfilled MUST send a special block containing a requirement block.<a href="#section-7.2.1-2" class="pilcrow">¶</a></p>
<p id="section-7.2.1-3">A node SHOULD NOT reply to any cleartext requests if the node does not want to officially disclose its identity as a Vortex node. A node MUST reply with an error block if a valid identity is used for the request.<a href="#section-7.2.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="routing_header_req_msg_quota">
<section id="section-7.2.2">
          <h4 id="name-request-message-quota">
<a href="#section-7.2.2" class="section-number selfRef">7.2.2. </a><a href="#name-request-message-quota" class="section-name selfRef">Request Message Quota</a>
          </h4>
<p id="section-7.2.2-1">Any valid ephemeral identity may request an increase of the current message quota to a specific value at any time. The request MUST include a reply block in the header and may contain other parts. If a requested value is lower than the current quota, then the node SHOULD NOT refuse the quota request and SHOULD send a "no error" status.<a href="#section-7.2.2-1" class="pilcrow">¶</a></p>
<p id="section-7.2.2-2">A node SHOULD reply to a HeaderRequestIncreaseMessageQuota request (see <a href="#asn_one" class="xref">Appendix A</a>) of a valid ephemera identity. The reply MUST include a requirement, an error message or a "no error" status message.<a href="#section-7.2.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="routing_header_inc_msg_quota">
<section id="section-7.2.3">
          <h4 id="name-request-increase-of-message">
<a href="#section-7.2.3" class="section-number selfRef">7.2.3. </a><a href="#name-request-increase-of-message" class="section-name selfRef">Request Increase of Message Quota</a>
          </h4>
<p id="section-7.2.3-1">A node may request to increase the current message quota by sending a HeaderRequestIncreaseMessageQuota request to the routing node. The value specified within the node is the new quota. HeaderRequestIncreaseMessageQuota requests MUST include a reply block, and a node SHOULD NOT use a previously sent MURB to reply.<a href="#section-7.2.3-1" class="pilcrow">¶</a></p>
<p id="section-7.2.3-2">If the requested quota is higher than the current quota, then the node SHOULD send a "no error" reply. If the requested quota is not accepted, then the node SHOULD send a requestedQuotaOutOfBand reply.<a href="#section-7.2.3-2" class="pilcrow">¶</a></p>
<p id="section-7.2.3-3">A node accepting the request MUST send a RequirementBlock or a "no error block."<a href="#section-7.2.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="routing_header_req_trans_quota">
<section id="section-7.2.4">
          <h4 id="name-request-transfer-quota">
<a href="#section-7.2.4" class="section-number selfRef">7.2.4. </a><a href="#name-request-transfer-quota" class="section-name selfRef">Request Transfer Quota</a>
          </h4>
<p id="section-7.2.4-1">Any valid ephemeral identity may request to increase the current transfer quota to a specific value at any time. The request MUST include a reply block in the header and may contain other parts. If a requested value is lower than the current quota, then the node SHOULD NOT refuse the quota request and SHOULD send a "no error" status.<a href="#section-7.2.4-1" class="pilcrow">¶</a></p>
<p id="section-7.2.4-2">A node SHOULD reply to a eaderRequestIncreaseTransferQuota request (see <a href="#asn_one" class="xref">Appendix A</a>) of a valid ephemeral identity. The reply MUST include a requirement, an error message or a "no error" status message.<a href="#section-7.2.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="routing_header_qry_quota">
<section id="section-7.2.5">
          <h4 id="name-query-quota">
<a href="#section-7.2.5" class="section-number selfRef">7.2.5. </a><a href="#name-query-quota" class="section-name selfRef">Query Quota</a>
          </h4>
<p id="section-7.2.5-1">Any valid ephemeral identity may request the current message and transfer quota. The request MUST include a reply block in the header and may contain other parts.<a href="#section-7.2.5-1" class="pilcrow">¶</a></p>
<p id="section-7.2.5-2">A node MUST reply to a HeaderRequestQueryQuota request (see <a href="#asn_one" class="xref">Appendix A</a>), which MUST include the current message quota and the current message transfer quota. The reply to this request MUST NOT include a requirement.<a href="#section-7.2.5-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="routing_header_req_cap">
<section id="section-7.2.6">
          <h4 id="name-request-capabilities">
<a href="#section-7.2.6" class="section-number selfRef">7.2.6. </a><a href="#name-request-capabilities" class="section-name selfRef">Request Capabilities</a>
          </h4>
<p id="section-7.2.6-1">Any node MAY request the capabilities of another node, which include all information necessary to create a parsable VortexMessage. Any node SHOULD reply to any encrypted HeaderRequestCapability.<a href="#section-7.2.6-1" class="pilcrow">¶</a></p>
<p id="section-7.2.6-2">A node SHOULD NOT reply to cleartext requests if the node does not want to officially disclose its identity as a Vortex node. A node MUST reply if a valid identity is used for the request, and it MAY reply to unknown identities.<a href="#section-7.2.6-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="routing_header_req_nodes">
<section id="section-7.2.7">
          <h4 id="name-request-nodes">
<a href="#section-7.2.7" class="section-number selfRef">7.2.7. </a><a href="#name-request-nodes" class="section-name selfRef">Request Nodes</a>
          </h4>
<p id="section-7.2.7-1">A node may ask another node for a list of routing node addresses and keys, which may be used to bootstrap a new node and add routing nodes to increase the anonymization of a node. The receiving node of
          such a request SHOULD reply with a requirement (e.g.,RequirementPuzzleRequired).<a href="#section-7.2.7-1" class="pilcrow">¶</a></p>
<p id="section-7.2.7-2">A node MAY reply to a HeaderRequest request (see <a href="#asn_one" class="xref">Appendix A</a>) of a valid ephemeral identity, and the reply MUST include a requirement, an error message, or a "no error" status message. A node MUST NOT reply to an unknown identity and SHOULD always reply with the same result set to the same identity.<a href="#section-7.2.7-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="routing_header_req_identity_replace">
<section id="section-7.2.8">
          <h4 id="name-request-identity-replace">
<a href="#section-7.2.8" class="section-number selfRef">7.2.8. </a><a href="#name-request-identity-replace" class="section-name selfRef">Request Identity Replace</a>
          </h4>
<p id="section-7.2.8-1">This request type allows a receiving node to replace an existing identity with the identity provided in the message and is required if an adversary manages to deny the usage of a node (e.g., by deleting the corresponding transport account). Any sending node may recover from such an attack by sending a valid authenticated message to another identity to provide the new transport and key details.<a href="#section-7.2.8-1" class="pilcrow">¶</a></p>
<p id="section-7.2.8-2">A node SHOULD reply to such a request from a valid known identity, and the reply MUST include an error message or a "no error" status message.<a href="#section-7.2.8-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="routing_header_req_upgrade">
<section id="section-7.2.9">
          <h4 id="name-request-upgrade">
<a href="#section-7.2.9" class="section-number selfRef">7.2.9. </a><a href="#name-request-upgrade" class="section-name selfRef">Request Upgrade</a>
          </h4>
<p id="section-7.2.9-1">This request type allows a node to request a new version of the software in an anonymous, unlinked manor. The identifier MUST identify the software product uniquely. The version MUST reflect the version tag of the currently installed version or a similarly usable tag.<a href="#section-7.2.9-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="routing_special">
<section id="section-7.3">
        <h3 id="name-special-blocks">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-special-blocks" class="section-name selfRef">Special Blocks</a>
        </h3>
<p id="section-7.3-1">Special blocks are payload messages that reflect messages from one node to another and are not visible to the user. A special block starts with the character sequence '\special' (or 5Ch 73h 70h 65h 63h 69h 61h 6Ch) followed by a DER-encoded special block (SpecialBlock). Any non-special message decoding to ID 0 in a workspace starting with this character sequence MUST escape all backslashes within the payload chunk with an additional backslash.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
<div id="routing_special_error">
<section id="section-7.3.1">
          <h4 id="name-error-block">
<a href="#section-7.3.1" class="section-number selfRef">7.3.1. </a><a href="#name-error-block" class="section-name selfRef">Error Block</a>
          </h4>
<p id="section-7.3.1-1">An error block may be sent as a reply contained in the payload section. The error block is embedded in a special block and sent with any provided reply block. Error messages SHOULD contain the serial number of the offending header block and MAY contain human-readable text providing additional messages about the error.<a href="#section-7.3.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="routing_special_requirement">
<section id="section-7.3.2">
          <h4 id="name-requirement-block">
<a href="#section-7.3.2" class="section-number selfRef">7.3.2. </a><a href="#name-requirement-block" class="section-name selfRef">Requirement Block</a>
          </h4>
<p id="section-7.3.2-1">If a node receives a requirement block, then it MUST assume that the request block is accepted, is not yet processed, and is to be processed if it meets the contained requirement. A node MUST process a request as soon as the requirement is fulfilled and MUST resend the request as soon as it meets the requirement.<a href="#section-7.3.2-1" class="pilcrow">¶</a></p>
<p id="section-7.3.2-2">A node MAY reject a request, accept a request without a requirement, accept a request upon payment (RequirementPaymentRequired), or accept a request upon solving a proof of work puzzle (RequirementPuzzleRequired).<a href="#section-7.3.2-2" class="pilcrow">¶</a></p>
<div id="routing_special_requirement_puzzle">
<section id="section-7.3.2.1">
            <h5 id="name-puzzle-requirement">
<a href="#section-7.3.2.1" class="section-number selfRef">7.3.2.1. </a><a href="#name-puzzle-requirement" class="section-name selfRef">Puzzle Requirement</a>
            </h5>
<p id="section-7.3.2.1-1">If a node requests a puzzle, then it MUST send a RequirementPuzzleRequired block. The puzzle requirement is solved if the node receiving the puzzle replies with a header block that contains the puzzle block, and the hash of the encoded block begins with the bit sequence mentioned in the puzzle within the period specified in the field 'valid.'<a href="#section-7.3.2.1-1" class="pilcrow">¶</a></p>
<p id="section-7.3.2.1-2">A node solving a puzzle requires sending a VortexMessage to the requesting node, which MUST contain a header block that includes the puzzle block and MUST have a MAC fingerprint starting with the bit sequence as specified in the challenge. The receiving node calculates the MAC from the unencrypted DER-encoded HeaderBlock with the algorithm specified by the node. The sending node may achieve the requirement by adding a proofOfWork field to the HeaderBlock containing any content fulfilling the criteria. The sending node SHOULD keep the proofOfWork field as short as possible.<a href="#section-7.3.2.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="routing_special_requirement_payment">
<section id="section-7.3.2.2">
            <h5 id="name-payment-requirement">
<a href="#section-7.3.2.2" class="section-number selfRef">7.3.2.2. </a><a href="#name-payment-requirement" class="section-name selfRef">Payment Requirement</a>
            </h5>
<p id="section-7.3.2.2-1">If a node requests a payment, then it MUST send a RequirementPaymentRequired block. As soon as the requested fee is paid and confirmed, the requesting node MUST send a "no error" status message. The usage period 'valid' describes the period during which the payment may be carried out. A node MUST accept the payment if it occurs within the 'valid' period but is confirmed later. A node SHOULD return all unsolicited payments to the sending address.<a href="#section-7.3.2.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="routing_special_upgrade">
<section id="section-7.3.2.3">
            <h5 id="name-upgrade">
<a href="#section-7.3.2.3" class="section-number selfRef">7.3.2.3. </a><a href="#name-upgrade" class="section-name selfRef">Upgrade</a>
            </h5>
<p id="section-7.3.2.3-1">If a node requests an upgrade, a ReplyUpgrade block MAY be sent. The block must contain the identifier and version of the most recent software version. The blob MAY contain the software if there is a newer one available.<a href="#section-7.3.2.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="routing_operations">
<section id="section-7.4">
        <h3 id="name-routing-operations">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-routing-operations" class="section-name selfRef">Routing Operations</a>
        </h3>
<p id="section-7.4-1">Routing operations are contained in a routing block and processed upon arrival of a message or when compiling a new message. All operations are reversible, and no operation is available for generating decoy traffic, which may be used through encryption of an unpadded block or the addRedundancy operation.<a href="#section-7.4-1" class="pilcrow">¶</a></p>
<p id="section-7.4-2">All payload chunk blocks inherit the validity time from the message routing combos as arrival time + max(maxProcessTime).<a href="#section-7.4-2" class="pilcrow">¶</a></p>
<p id="section-7.4-3">When applying an operation to a source block, the resulting target block inherits the expiration of the source block. When multiple expiration times exist, the one furthest in the future is applied to the target block. If the operation fails, then the target expiration remains unchanged.<a href="#section-7.4-3" class="pilcrow">¶</a></p>
<div id="routing_operations_mapping">
<section id="section-7.4.1">
          <h4 id="name-mapping-operation">
<a href="#section-7.4.1" class="section-number selfRef">7.4.1. </a><a href="#name-mapping-operation" class="section-name selfRef">Mapping Operation</a>
          </h4>
<p id="section-7.4.1-1">The straightforward mapping operation is used in inOperations of a routing block to map the routing block's specific blocks to a permanent workspace.<a href="#section-7.4.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="routing_operations_mergesplit">
<section id="section-7.4.2">
          <h4 id="name-split-and-merge-operations">
<a href="#section-7.4.2" class="section-number selfRef">7.4.2. </a><a href="#name-split-and-merge-operations" class="section-name selfRef">Split and Merge Operations</a>
          </h4>
<p id="section-7.4.2-1">The split and merge operations allow splitting and recombining message chunks. A node MUST adhere to the following constraints.<a href="#section-7.4.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.4.2-2.1">The operation must be applied at an absolute (measuring in bytes) or relative (measured as a float value in the range
              0&gt;value&gt;100) position.<a href="#section-7.4.2-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-7.4.2-2.2">All calculations must be performed according to <span><a href="#IEEE754" class="xref">IEEE 754</a> [<a href="#IEEE754" class="xref">IEEE754</a>]</span> and in 64-bit precision.<a href="#section-7.4.2-2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-7.4.2-2.3">If a relative value is a non-integer result, then a floor operation (i.e., cutting off all non-integer parts) determines the number of bytes.<a href="#section-7.4.2-2.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-7.4.2-2.4">If an absolute value is negative, then the size represents the number of bytes counted from the end of the message chunk.<a href="#section-7.4.2-2.4" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-7.4.2-2.5">If an absolute value is greater than the number of bytes in a block, then all bytes are mapped to the respective target block, and the other target block becomes a zero byte-sized block.<a href="#section-7.4.2-2.5" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-7.4.2-3">An operation MUST fail if relative values are equal to, or less than zero. An operation MUST fail if a relative value is equal to, or greater than 100. All floating-point operations must be performed according to <span>[<a href="#IEEE754" class="xref">IEEE754</a>]</span> and in 64-bit precision.<a href="#section-7.4.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="routing_operations_crypt">
<section id="section-7.4.3">
          <h4 id="name-encrypt-and-decrypt-operati">
<a href="#section-7.4.3" class="section-number selfRef">7.4.3. </a><a href="#name-encrypt-and-decrypt-operati" class="section-name selfRef">Encrypt and Decrypt Operations</a>
          </h4>
<p id="section-7.4.3-1">Encryption and decryption are executed according to the standards mentioned above. An encryption operation encrypts a block symmetrically and places the result in the target block. The parameters MUST contain IV, padding, and cipher modes. An encryption operation without a valid parameter set MUST fail.<a href="#section-7.4.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="routing_operations_redundancy">
<section id="section-7.4.4">
          <h4 id="name-add-and-remove-redundancy-o">
<a href="#section-7.4.4" class="section-number selfRef">7.4.4. </a><a href="#name-add-and-remove-redundancy-o" class="section-name selfRef">Add and Remove Redundancy Operations</a>
          </h4>
<p id="section-7.4.4-1">The addRedundancy and removeRedundancy operations are core to the protocol. They may be used to split messages and distribute message content across multiple routing nodes. The operation is separated into three steps.<a href="#section-7.4.4-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-7.4.4-2">
<li id="section-7.4.4-2.1">Pad the input block to a multiple of the key block size in the resulting output blocks.<a href="#section-7.4.4-2.1" class="pilcrow">¶</a>
</li>
            <li id="section-7.4.4-2.2">Apply a Vandermonde matrix with the given sizes.<a href="#section-7.4.4-2.2" class="pilcrow">¶</a>
</li>
            <li id="section-7.4.4-2.3">Encrypt each resulting block with a separate key.<a href="#section-7.4.4-2.3" class="pilcrow">¶</a>
</li>
          </ol>
<p id="section-7.4.4-3">The following sections describe the order of the operations within an addRedundancy operation. For a removeRedundancy operation, invert the functions and order. If the removeRedundancy has more than the required blocks to recover the information, then it should take only the required number beginning from the smallest. If a seed and PRNG are provided, then the removeRedundancy operation MAY test any combination until recovery is successful.<a href="#section-7.4.4-3" class="pilcrow">¶</a></p>
<div id="routing_operations_redundancy_padding">
<section id="section-7.4.4.1">
            <h5 id="name-padding-operation">
<a href="#section-7.4.4.1" class="section-number selfRef">7.4.4.1. </a><a href="#name-padding-operation" class="section-name selfRef">Padding Operation</a>
            </h5>
<p id="section-7.4.4.1-1">Padding is done in multiple steps. First, we calculate the padding value p. We then concatenate the padding value p as 32-bit little-endian unit with the message and fill the remaining bytes required with the seeded PRNG.<a href="#section-7.4.4.1-1" class="pilcrow">¶</a></p>
<p id="section-7.4.4.1-2">A processing node calculates the final length of all payload blocks, including redundancy. This is done in three steps, followed by the calculation of the padding value p.<a href="#section-7.4.4.1-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-7.4.4.1-3">
<li id="section-7.4.4.1-3.1">i=len(&lt;input block&gt;) [calculate the size of the input block]<a href="#section-7.4.4.1-3.1" class="pilcrow">¶</a>
</li>
              <li id="section-7.4.4.1-3.2">e=lcm(&lt;Blocksize of output encyrption in # bytes&gt;,&lt;# of output blocks&gt;) [Calculate Minimum size of the output block]<a href="#section-7.4.4.1-3.2" class="pilcrow">¶</a>
</li>
              <li id="section-7.4.4.1-3.3">l=roof((i+4+C2)/e)*e [Calculate the final length of the padded stream suitable for the subsequent operations. C2 is a
                constant which is either provided by the RBB or 0 if not specified.]<a href="#section-7.4.4.1-3.3" class="pilcrow">¶</a>
</li>
              <li id="section-7.4.4.1-3.4">p=i+(C1*l(mod (roof((2^32-1-i)/l)*))) [Calculate padding value p. C1 is a positive integer constant and MUST be
                provided by the RBB to maintain diagnosability.]<a href="#section-7.4.4.1-3.4" class="pilcrow">¶</a>
</li>
            </ol>
<p id="section-7.4.4.1-4"> 
 The remainder of the input block, up to length L, is padded with random data. A routing block builder should specify the value of the randomInteger. If not specified, the routing node may choose a random positive integer value. A routing block builder SHOULD specify a PRNG and a seed used for this padding. If GF(16) is applied, then all numbers are treated as little-endian representations. Only GF(8) and GF(16) are allowed fields.<a href="#section-7.4.4.1-4" class="pilcrow">¶</a></p>
<p id="section-7.4.4.1-5">The length of 0 is a valid length<a href="#section-7.4.4.1-5" class="pilcrow">¶</a></p>
<p id="section-7.4.4.1-6">This padding guarantees that each resulting block matches the block size of the subsequent encryption operation and does not require further padding.<a href="#section-7.4.4.1-6" class="pilcrow">¶</a></p>
<p id="section-7.4.4.1-7">For padding removal, the padding p at the start is first removed as a little-endian integer. Second, the length of the output block is calculated by applying &lt;output block size in bytes&gt;=p (mod &lt;input block size in bytes&gt;-4)<a href="#section-7.4.4.1-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="routing_operations_redundancy_matrix">
<section id="section-7.4.4.2">
            <h5 id="name-apply-matrix">
<a href="#section-7.4.4.2" class="section-number selfRef">7.4.4.2. </a><a href="#name-apply-matrix" class="section-name selfRef">Apply Matrix</a>
            </h5>
<p id="section-7.4.4.2-1">Next, the input block is organized in a data matrix D of dimensions (inrows, incols) where incols=(&lt;number of data blocks&gt;-&lt;number of redundancy blocks&gt;) and inrows=L/(&lt;number of data blocks&gt;-&lt;number of redundancy blocks&gt;). The input block data is first distributed in this matrix across, and then down.<a href="#section-7.4.4.2-1" class="pilcrow">¶</a></p>
<p id="section-7.4.4.2-2">Next, the data matrix D is multiplied by a Vandermonde matrix V with its number of rows equal to the incols calculated and columns equal to the &lt;number of data blocks&gt;. The content of the matrix is formed by v(i,j)=pow(i,j), where i reflects the row number starting at 0, and j reflects the column number starting at 0. The calculations described must be carried out in the GF noted in the respective operation to be successful. The completed operation results in matrix A.<a href="#section-7.4.4.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="routing_operations_redundancy_encrypt">
<section id="section-7.4.4.3">
            <h5 id="name-encrypt-target-block">
<a href="#section-7.4.4.3" class="section-number selfRef">7.4.4.3. </a><a href="#name-encrypt-target-block" class="section-name selfRef">Encrypt Target Block</a>
            </h5>
<p id="section-7.4.4.3-1">Each row vector of A is a new data block encrypted with the corresponding encryption key noted in the keys of the addRedundancyOperation. If there are not enough keys available, then the keys used for encryption are reused from the beginning after the final key is used. A routing block builder SHOULD provide enough keys so that all target blocks may be encrypted with a unique key. All encryptions SHOULD NOT use padding.<a href="#section-7.4.4.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="routing_processing">
<section id="section-7.5">
        <h3 id="name-processing-of-vortex-messag">
<a href="#section-7.5" class="section-number selfRef">7.5. </a><a href="#name-processing-of-vortex-messag" class="section-name selfRef">Processing of Vortex Messages</a>
        </h3>
<p id="section-7.5-1">The accounting layer triggers processing according to the information contained in a routing block in the workspace. All operations MUST be executed in the sequence provided in the routing block, and any failing operation must leave the result block unmodified.<a href="#section-7.5-1" class="pilcrow">¶</a></p>
<p id="section-7.5-2">All workspace blocks resulting in IDs of 1 to maxPayloadBlock are then added to the message and passed to the blending layer with appropriate instructions.<a href="#section-7.5-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="accounting">
<section id="section-8">
      <h2 id="name-accounting">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-accounting" class="section-name selfRef">Accounting</a>
      </h2>
<div id="accounting_operations">
<section id="section-8.1">
        <h3 id="name-accounting-operations">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-accounting-operations" class="section-name selfRef">Accounting Operations</a>
        </h3>
<p id="section-8.1-1">The accounting layer has two types of operations.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.1-2.1">Time-based (e.g., cleanup jobs and initiation of routing).<a href="#section-8.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.1-2.2">Routing triggered (e.g., updating quotas, authorizing operations, and pickup of incoming messages).<a href="#section-8.1-2.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-8.1-3">Implementations MUST provide sufficient locking mechanisms to guarantee the integrity of accounting information and the workspace at any time.<a href="#section-8.1-3" class="pilcrow">¶</a></p>
<div id="accounting_timed_gc">
<section id="section-8.1.1">
          <h4 id="name-time-based-garbage-collecti">
<a href="#section-8.1.1" class="section-number selfRef">8.1.1. </a><a href="#name-time-based-garbage-collecti" class="section-name selfRef">Time-Based Garbage Collection</a>
          </h4>
<p id="section-8.1.1-1">The accounting layer SHOULD keep a list of expiration times. As soon as an entry (e.g., payload block or identity) expires, the respective structure should be removed from the workspace. An implementation MAY choose to remove expired items periodically or when encountering them during normal operation.<a href="#section-8.1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="accounting_timed_routing">
<section id="section-8.1.2">
          <h4 id="name-time-based-routing-initiati">
<a href="#section-8.1.2" class="section-number selfRef">8.1.2. </a><a href="#name-time-based-routing-initiati" class="section-name selfRef">Time-Based Routing Initiation</a>
          </h4>
<p id="section-8.1.2-1">The accounting layer MAY keep a list of when a routing block is activated. For improved privacy, the accounting layer should use a slotted model where, whenever possible, multiple routing blocks are handled in the same period, and the requests to the blending layers are mixed between the transactions.<a href="#section-8.1.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="accounting_timed_quota">
<section id="section-8.1.3">
          <h4 id="name-routing-based-quota-updates">
<a href="#section-8.1.3" class="section-number selfRef">8.1.3. </a><a href="#name-routing-based-quota-updates" class="section-name selfRef">Routing Based Quota Updates</a>
          </h4>
<p id="section-8.1.3-1">A node MUST update quotas on the respective operations. For example, a node MUST decrease the message quota before processing routing blocks in the workspace and after the processing of header requests.<a href="#section-8.1.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="accounting_routhing_auth">
<section id="section-8.1.4">
          <h4 id="name-routing-based-authorization">
<a href="#section-8.1.4" class="section-number selfRef">8.1.4. </a><a href="#name-routing-based-authorization" class="section-name selfRef">Routing Based Authorization</a>
          </h4>
<p id="section-8.1.4-1">The transfer quota MUST be checked and decreased by the number of data bytes in the payload chunks after an outgoing message is processed and fully assembled. The message quota MUST be decreased by one on each routing block triggering the assembly of an outgoing message.<a href="#section-8.1.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="accounting_create_identity">
<section id="section-8.1.5">
          <h4 id="name-ephemeral-identity-creation">
<a href="#section-8.1.5" class="section-number selfRef">8.1.5. </a><a href="#name-ephemeral-identity-creation" class="section-name selfRef">Ephemeral Identity Creation</a>
          </h4>
<p id="section-8.1.5-1">Any packet may request the creation of an ephemeral identity. A node SHOULD NOT accept such a request without a costly requirement since the request includes a lifetime of the ephemeral identity. The costs for creating the ephemeral identity SHOULD increase if a longer lifetime is requested.<a href="#section-8.1.5-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="IANA">
<section id="section-9">
      <h2 id="name-iana-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-9-1">This memo includes no request to IANA.<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">Additional encryption algorithms, paddings, modes, blending layers or puzzles MUST be added by writing an extension to this or a subsequent RFC. For testing purposes, IDs above 1,000,000 should be used.<a href="#section-9-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security">
<section id="section-10">
      <h2 id="name-security-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-10-1">The MessageVortex protocol should be understood as a toolset instead of a fixed product. Depending on the usage of the toolset, anonymity and security are affected. For a detailed analysis, see <span>[<a href="#MVAnalysis" class="xref">MVAnalysis</a>]</span>.<a href="#section-10-1" class="pilcrow">¶</a></p>
<p id="section-10-2">The primary goals for security within this protocol rely on the following focus areas.<a href="#section-10-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10-3.1">Confidentiality<a href="#section-10-3.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-10-3.2">Integrity<a href="#section-10-3.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-10-3.3">Availability<a href="#section-10-3.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-10-3.4">
          <p id="section-10-3.4.1">Anonymity<a href="#section-10-3.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10-3.4.2.1">Third-party anonymity<a href="#section-10-3.4.2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-10-3.4.2.2">Sender anonymity<a href="#section-10-3.4.2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-10-3.4.2.3">Receiver anonymity<a href="#section-10-3.4.2.3" class="pilcrow">¶</a>
</li>
          </ul>
</li>
      </ul>
<p id="section-10-4">These aspects are affected by the usage of the protocol, and the following sections provide additional information on how they impact the primary goals.<a href="#section-10-4" class="pilcrow">¶</a></p>
<p id="section-10-5">The Vortex protocol does not rely on any encryption of the transport layer since Vortex messages are already encrypted. In addition, confidentiality is not affected by the protection mechanisms of the transport layer.<a href="#section-10-5" class="pilcrow">¶</a></p>
<p id="section-10-6">If a transport layer supports encryption, then a Vortex node SHOULD use it to improve the privacy of the message.<a href="#section-10-6" class="pilcrow">¶</a></p>
<p id="section-10-7">Anonymity is affected by the inner workings of the blending layer in many ways. A Vortex message cannot be read by anyone except the peer nodes and routing block builder. The presence of a Vortex node message may be detected through the typical high entropy of an encrypted file, broken structures of a carrier file, meaningless content of a carrier file, or the contextless communication of the transport layer with its peer partner. A blending layer SHOULD minimize the possibility of simple detection by minimizing these effects.<a href="#section-10-7" class="pilcrow">¶</a></p>
<p id="section-10-8">A blending layer SHOULD use carrier files with high compression or encryption. Carrier files SHOULD NOT have inner structures such that the payload is comparable to valid content. To achieve undetectability by a human reviewer, a routing block builder should use F5 instead of PLAIN blending. This approach however, increases the protocol overhead by approximately tenfold.<a href="#section-10-8" class="pilcrow">¶</a></p>
<p id="section-10-9">The two layers of 'routing' and 'accounting' have the deepest insight into a Vortex message's inner workings. Each is aware of the immediate peer sender and the peer recipients of all payload chunks. As decoy traffic is generated by combining chunks and applying redundancy calculations, a node can never know if a malfunction (e.g., during a recovery calculation) was intended. Therefore, a node is unable to distinguish a failed transaction from a terminated transaction as well as content from decoy traffic.<a href="#section-10-9" class="pilcrow">¶</a></p>
<p id="section-10-10">A routing block builder SHOULD follow the following rules not to compromise a Vortex message's anonymity.<a href="#section-10-10" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10-11.1">All operations applied SHOULD be credibly involved in a message transfer.<a href="#section-10-11.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-10-11.2">A sufficient subset of the result of an addRedundancy operation should always be sent to peers to allow recovery of the data built.<a href="#section-10-11.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-10-11.3">The anonymity set of a message should be sufficiently large to avoid legal prosecution of all jurisdictional entities involved, even if a certain amount of the anonymity set cooperates with an adversary.<a href="#section-10-11.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-10-11.4">Encryption and decryption SHOULD follow normal usage whenever possible by avoiding the encryption of a block on a node with one key and decrypting it with a different key on the same or adjacent node.<a href="#section-10-11.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-10-11.5">Traffic peaks SHOULD be uniformly distributed within the entire anonymity set.<a href="#section-10-11.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-10-11.6">A routing block SHOULD be used for a limited number of messages. If used as a message block for the node, then it should be used only once. A block builder SHOULD use the HeaderRequestReplaceIdentity block to update the reply to routing blocks regularly. Implementers should always remember that the same routing block is identifiable by its structure.<a href="#section-10-11.6" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-10-12">An active adversary cannot use blocks from other routing block builders. While the adversary may falsify the result by injecting an incorrect message chunk or not sending a message, such message disruptions may be detected by intentionally routing information to the routing block builder (RBB) node. If the Vortex message does not carry the information expected, then the node may safely assume that one of the involved nodes is misbehaving. A block building node MAY calculate the reputation for involved nodes over time and MAY build redundancy paths into a routing block to withstand such malicious nodes.<a href="#section-10-12" class="pilcrow">¶</a></p>
<p id="section-10-13">Receiver anonymity is at risk if the handling of the message header and content is not done with care. An attacker might send a bugged message (e.g., with a DKIM header) to de-anonymize a recipient. Careful attention is required when handling anything other than local references when processing, verifying or rendering a message.<a href="#section-10-13" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-11">
      <h2 id="name-references">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-11.1">
        <h3 id="name-normative-references">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="CCITT.X208.1988">[CCITT.X208.1988]</dt>
        <dd>
<span class="refAuthor">International Telephone and Telegraph Consultative Committee</span>, <span class="refTitle">"Specification of Abstract Syntax Notation One (ASN.1)"</span>, <span class="seriesInfo">CCITT Recommendation X.208</span>, <time datetime="1998-11" class="refDate">November 1998</time>. </dd>
<dd class="break"></dd>
<dt id="CCITT.X680.2002">[CCITT.X680.2002]</dt>
        <dd>
<span class="refAuthor">International Telephone and Telegraph Consultative Committee</span>, <span class="refTitle">"Abstract Syntax Notation One (ASN.1): Specification of Basic Notation"</span>, <time datetime="2002-11" class="refDate">November 2002</time>. </dd>
<dd class="break"></dd>
<dt id="EAX">[EAX]</dt>
        <dd>
<span class="refAuthor">Bellare, M.</span>, <span class="refAuthor">Rogaway, P.</span>, and <span class="refAuthor">D. Wagner</span>, <span class="refTitle">"The EAX Mode of Operation"</span>, <time datetime="2011" class="refDate">2011</time>. </dd>
<dd class="break"></dd>
<dt id="F5">[F5]</dt>
        <dd>
<span class="refAuthor">Westfeld, A.</span>, <span class="refTitle">"F5 - A Steganographic Algorithm - High Capacity Despite Better Steganalysis"</span>, <time datetime="2001-10-24" class="refDate">24 October 2001</time>. </dd>
<dd class="break"></dd>
<dt id="FIPS-AES">[FIPS-AES]</dt>
        <dd>
<span class="refAuthor">Federal Information Processing Standard (FIPS)</span>, <span class="refTitle">"Specification for the ADVANCED ENCRYPTION STANDARD (AES)"</span>, <time datetime="2011-11" class="refDate">November 2011</time>. </dd>
<dd class="break"></dd>
<dt id="IEEE754">[IEEE754]</dt>
        <dd>
<span class="refAuthor">IEEE</span>, <span class="refTitle">"754-2008 - IEEE Standard for Floating-Point Arithmetic"</span>, <time datetime="2008-08-29" class="refDate">29 August 2008</time>. </dd>
<dd class="break"></dd>
<dt id="ISO-10118-3">[ISO-10118-3]</dt>
        <dd>
<span class="refAuthor">International Organization for Standardization</span>, <span class="refTitle">"ISO/IEC 10118-3:2004 -- Information Technology -- Security Techniques -- Hash-Functions -- Part 3: Dedicated Hash-Functions"</span>, <time datetime="2004-03" class="refDate">March 2004</time>. </dd>
<dd class="break"></dd>
<dt id="MODES">[MODES]</dt>
        <dd>
<span class="refAuthor">National Institute for Standards and Technology (NIST)</span>, <span class="refTitle">"Recommendation for Block Cipher Modes of Operation: Methods and Techniques"</span>, <time datetime="2001-12" class="refDate">December 2001</time>. </dd>
<dd class="break"></dd>
<dt id="RFC1423">[RFC1423]</dt>
        <dd>
<span class="refAuthor">Balenson, D.</span>, <span class="refTitle">"Privacy Enhancement for Internet Electronic Mail: Part III: Algorithms, Modes, and Identifiers"</span>, <span class="seriesInfo">RFC 1423</span>, <span class="seriesInfo">DOI 10.17487/RFC1423</span>, <time datetime="1993-02" class="refDate">February 1993</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1423">https://www.rfc-editor.org/info/rfc1423</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3610">[RFC3610]</dt>
        <dd>
<span class="refAuthor">Whiting, D.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">N. Ferguson</span>, <span class="refTitle">"Counter with CBC-MAC (CCM)"</span>, <span class="seriesInfo">RFC 3610</span>, <span class="seriesInfo">DOI 10.17487/RFC3610</span>, <time datetime="2003-09" class="refDate">September 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3610">https://www.rfc-editor.org/info/rfc3610</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3657">[RFC3657]</dt>
        <dd>
<span class="refAuthor">Moriai, S.</span> and <span class="refAuthor">A. Kato</span>, <span class="refTitle">"Use of the Camellia Encryption Algorithm in Cryptographic Message Syntax (CMS)"</span>, <span class="seriesInfo">RFC 3657</span>, <span class="seriesInfo">DOI 10.17487/RFC3657</span>, <time datetime="2004-01" class="refDate">January 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3657">https://www.rfc-editor.org/info/rfc3657</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3686">[RFC3686]</dt>
        <dd>
<span class="refAuthor">Housley, R.</span>, <span class="refTitle">"Using Advanced Encryption Standard (AES) Counter Mode With IPsec Encapsulating Security Payload (ESP)"</span>, <span class="seriesInfo">RFC 3686</span>, <span class="seriesInfo">DOI 10.17487/RFC3686</span>, <time datetime="2004-01" class="refDate">January 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3686">https://www.rfc-editor.org/info/rfc3686</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5234">[RFC5234]</dt>
        <dd>
<span class="refAuthor">Crocker, D., Ed.</span> and <span class="refAuthor">P. Overell</span>, <span class="refTitle">"Augmented BNF for Syntax Specifications: ABNF"</span>, <span class="seriesInfo">STD 68</span>, <span class="seriesInfo">RFC 5234</span>, <span class="seriesInfo">DOI 10.17487/RFC5234</span>, <time datetime="2008-01" class="refDate">January 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5234">https://www.rfc-editor.org/info/rfc5234</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5288">[RFC5288]</dt>
        <dd>
<span class="refAuthor">Salowey, J.</span>, <span class="refAuthor">Choudhury, A.</span>, and <span class="refAuthor">D. McGrew</span>, <span class="refTitle">"AES Galois Counter Mode (GCM) Cipher Suites for TLS"</span>, <span class="seriesInfo">RFC 5288</span>, <span class="seriesInfo">DOI 10.17487/RFC5288</span>, <time datetime="2008-08" class="refDate">August 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5288">https://www.rfc-editor.org/info/rfc5288</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5958">[RFC5958]</dt>
        <dd>
<span class="refAuthor">Turner, S.</span>, <span class="refTitle">"Asymmetric Key Packages"</span>, <span class="seriesInfo">RFC 5958</span>, <span class="seriesInfo">DOI 10.17487/RFC5958</span>, <time datetime="2010-08" class="refDate">August 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5958">https://www.rfc-editor.org/info/rfc5958</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7253">[RFC7253]</dt>
        <dd>
<span class="refAuthor">Krovetz, T.</span> and <span class="refAuthor">P. Rogaway</span>, <span class="refTitle">"The OCB Authenticated-Encryption Algorithm"</span>, <span class="seriesInfo">RFC 7253</span>, <span class="seriesInfo">DOI 10.17487/RFC7253</span>, <time datetime="2014-05" class="refDate">May 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7253">https://www.rfc-editor.org/info/rfc7253</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8017">[RFC8017]</dt>
        <dd>
<span class="refAuthor">Moriarty, K., Ed.</span>, <span class="refAuthor">Kaliski, B.</span>, <span class="refAuthor">Jonsson, J.</span>, and <span class="refAuthor">A. Rusch</span>, <span class="refTitle">"PKCS #1: RSA Cryptography Specifications Version 2.2"</span>, <span class="seriesInfo">RFC 8017</span>, <span class="seriesInfo">DOI 10.17487/RFC8017</span>, <time datetime="2016-11" class="refDate">November 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8017">https://www.rfc-editor.org/info/rfc8017</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SEC1">[SEC1]</dt>
        <dd>
<span class="refAuthor">Certicom Research</span>, <span class="refTitle">"SEC 1: Elliptic Curve Cryptography"</span>, <time datetime="2009-05-21" class="refDate">21 May 2009</time>. </dd>
<dd class="break"></dd>
<dt id="TWOFISH">[TWOFISH]</dt>
        <dd>
<span class="refAuthor">Schneier, B.</span>, <span class="refTitle">"The Twofish Encryptions Algorithm: A 128-Bit Block Cipher, 1st Edition"</span>, <time datetime="1999-03" class="refDate">March 1999</time>. </dd>
<dd class="break"></dd>
<dt id="XEP-0231">[XEP-0231]</dt>
      <dd>
<span class="refAuthor">Peter, S.A.</span> and <span class="refAuthor">P. Simerda</span>, <span class="refTitle">"XEP-0231: Bits of Binary"</span>, <time datetime="2008-09-03" class="refDate">3 September 2008</time>, <span>&lt;<a href="https://xmpp.org/extensions/xep-0231.html">https://xmpp.org/extensions/xep-0231.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-11.2">
        <h3 id="name-informative-references">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="DeadParrot">[DeadParrot]</dt>
        <dd>
<span class="refAuthor">Houmansadr, A.</span>, <span class="refAuthor">Burbaker, C.</span>, and <span class="refAuthor">V. Shmatikov</span>, <span class="refTitle">"The Parrot is Dead: Observing Unobservable Network Communications"</span>, <time datetime="2013" class="refDate">2013</time>, <span>&lt;<a href="https://people.cs.umass.edu/~amir/papers/parrot.pdf">https://people.cs.umass.edu/~amir/papers/parrot.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="KAnon">[KAnon]</dt>
        <dd>
<span class="refAuthor">Ahn, L.</span>, <span class="refAuthor">Bortz, A.</span>, and <span class="refAuthor">N.J. Hopper</span>, <span class="refTitle">"k-Anonymous Message Transmission"</span>, <time datetime="2003" class="refDate">2003</time>. </dd>
<dd class="break"></dd>
<dt id="MVAnalysis">[MVAnalysis]</dt>
        <dd>
<span class="refAuthor">Gwerder, M.</span>, <span class="refTitle">"MessageVortex"</span>, <time datetime="2018" class="refDate">2018</time>, <span>&lt;<a href="https://messagevortex.net/devel/messageVortex.pdf">https://messagevortex.net/devel/messageVortex.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1939">[RFC1939]</dt>
        <dd>
<span class="refAuthor">Myers, J.</span> and <span class="refAuthor">M. Rose</span>, <span class="refTitle">"Post Office Protocol - Version 3"</span>, <span class="seriesInfo">STD 53</span>, <span class="seriesInfo">RFC 1939</span>, <span class="seriesInfo">DOI 10.17487/RFC1939</span>, <time datetime="1996-05" class="refDate">May 1996</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1939">https://www.rfc-editor.org/info/rfc1939</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2045">[RFC2045]</dt>
        <dd>
<span class="refAuthor">Freed, N.</span> and <span class="refAuthor">N. Borenstein</span>, <span class="refTitle">"Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies"</span>, <span class="seriesInfo">RFC 2045</span>, <span class="seriesInfo">DOI 10.17487/RFC2045</span>, <time datetime="1996-11" class="refDate">November 1996</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2045">https://www.rfc-editor.org/info/rfc2045</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2595">[RFC2595]</dt>
        <dd>
<span class="refAuthor">Newman, C.</span>, <span class="refTitle">"Using TLS with IMAP, POP3 and ACAP"</span>, <span class="seriesInfo">RFC 2595</span>, <span class="seriesInfo">DOI 10.17487/RFC2595</span>, <time datetime="1999-06" class="refDate">June 1999</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2595">https://www.rfc-editor.org/info/rfc2595</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3501">[RFC3501]</dt>
        <dd>
<span class="refAuthor">Crispin, M.</span>, <span class="refTitle">"INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1"</span>, <span class="seriesInfo">RFC 3501</span>, <span class="seriesInfo">DOI 10.17487/RFC3501</span>, <time datetime="2003-03" class="refDate">March 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3501">https://www.rfc-editor.org/info/rfc3501</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5321">[RFC5321]</dt>
        <dd>
<span class="refAuthor">Klensin, J.</span>, <span class="refTitle">"Simple Mail Transfer Protocol"</span>, <span class="seriesInfo">RFC 5321</span>, <span class="seriesInfo">DOI 10.17487/RFC5321</span>, <time datetime="2008-10" class="refDate">October 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5321">https://www.rfc-editor.org/info/rfc5321</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6120">[RFC6120]</dt>
      <dd>
<span class="refAuthor">Saint-Andre, P.</span>, <span class="refTitle">"Extensible Messaging and Presence Protocol (XMPP): Core"</span>, <span class="seriesInfo">RFC 6120</span>, <span class="seriesInfo">DOI 10.17487/RFC6120</span>, <time datetime="2011-03" class="refDate">March 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6120">https://www.rfc-editor.org/info/rfc6120</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="asn_one">
<section id="appendix-A">
      <h2 id="name-the-asn1-schema-for-vortex-">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-the-asn1-schema-for-vortex-" class="section-name selfRef">The ASN.1 schema for Vortex messages</a>
      </h2>
<p id="appendix-A-1">The following sections contain the ASN.1 modules specifying the MessageVortex Protocol.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<div id="asnOne_schema">
<section id="appendix-A.1">
        <h3 id="name-the-main-messagevortex-bloc">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-the-main-messagevortex-bloc" class="section-name selfRef">The Main MessageVortex Blocks</a>
        </h3>
<div class="alignLeft art-asn.1 art-text artwork" id="appendix-A.1-1">
<pre>MessageVortex-Schema DEFINITIONS EXPLICIT TAGS ::=
BEGIN
  EXPORTS PrefixBlock, InnerMessageBlock, RoutingBlock,
          maxWorkspaceID;
  IMPORTS SymmetricKey, AsymmetricKey, MacAlgorithmSpec, CipherSpec
                FROM MessageVortex-Ciphers
          HeaderRequest
                FROM MessageVortex-Requests
          PayloadOperation, MapBlockOperation
                FROM MessageVortex-Operations

          UsagePeriod, BlendingSpec
                FROM MessageVortex-Helpers;

  --***************************************************************
  -- Constant definitions
  --***************************************************************
  -- maximum serial number
  maxSerial               INTEGER ::= 4294967295
  -- maximum number of administrative requests
  maxNumOfRequests        INTEGER ::= 8
  -- maximum number of seconds which the message might be delayed
  -- in the local queue (starting from startOffset)
  maxDurationOfProcessing INTEGER ::= 86400
  -- maximum id of an operation
  minWorkspaceID          INTEGER ::= 32768
  -- maximum number of routing blocks in a message
  maxRoutingBlks          INTEGER ::= 127
  -- maximum number a block may be replayed
  maxNumOfReplays         INTEGER ::= 127
  -- maximum number of payload chunks in a message
  maxPayloadBlks          INTEGER ::= 127
  -- maximum number of seconds a proof of non revocation may be old
  maxTimeCachedProof      INTEGER ::= 86400
  -- The maximum ID of the workspace
  maxWorkspaceId          INTEGER ::= 65535
  -- The maximum number of assembly instructions per combo
  maxAssemblyInstr        INTEGER ::= 255


  --***************************************************************
  -- Types
  --***************************************************************
  PuzzleIdentifier ::= OCTET STRING ( SIZE(0..32) )
  ChainSecret      ::= OCTET STRING  (SIZE (16..64))

  --***************************************************************
  -- Block Definitions
  --***************************************************************
  PrefixBlock ::= SEQUENCE {
    version         [0] INTEGER OPTIONAL,
    key             [2] SymmetricKey
  }

  InnerMessageBlock ::= SEQUENCE {
    padding   OCTET STRING,
    prefix    CHOICE {
        plain           [11011] PrefixBlock,
        -- contains prefix encrypted with receivers
        -- public key
        encrypted       [11012] OCTET STRING
    },
    header  CHOICE  {
      -- debug/internal use only
      plain     [11021] HeaderBlock,
      -- contains encrypted identity block
      encyrpted [11022] OCTET STRING
    },
    -- contains signature of Identity [as stored in
    -- HeaderBlock; signed unencrypted HeaderBlock without
    -- Tag]
    identitySignature OCTET STRING,
    -- contains routing information (next hop) for the
    -- payloads
    routing     [11001] CHOICE {
      plain     [11031] RoutingBlock,
      -- contains encrypted routing block
      encyrpted [11032] OCTET STRING
    },
    -- contains the actual payload
    payload     SEQUENCE (SIZE (0..maxPayloadBlks))
                OF OCTET STRING
  }

  HeaderBlock ::= SEQUENCE {
    -- Public key of the identity representing this
    -- transmission
    identityKey        AsymmetricKey,
    -- serial identifying this block
    serial             INTEGER (0..maxSerial),
    -- number of times this block may be replayed
    -- (Tuple is identityKey, serial while
    -- UsagePeriod of block)
    maxReplays         INTEGER (0..maxNumOfReplays),
    -- subsequent Blocks are not processed before
    -- valid time.
    -- Host may reject too long retention.
    -- Recomended validity support &gt;=1Mt.
    valid              UsagePeriod,
    --  contains the MAC-Algorithm used for signing
    signAlgorithm      MacAlgorithmSpec,
    -- contains administrative requests such as
    -- quota requests
    requests           SEQUENCE
                       (SIZE (0..maxNumOfRequests))
                       OF HeaderRequest ,
    -- Reply Block for the requests
    requestReplyBlock   RoutingCombo OPTIONAL,
    -- padding and identitifier required to solve
    -- the cryptopuzzle
    identifier [12201] PuzzleIdentifier OPTIONAL,
    -- This is for solving crypto puzzles
    proofOfWork[12202] OCTET STRING OPTIONAL
  }

  RoutingBlock ::= SEQUENCE {
    -- contains the routingCombos
    routing    [331] SEQUENCE
                         (SIZE (0..maxRoutingBlks))
                     OF RoutingCombo,
    -- contains the mapping operations to map
    -- payloads to the workspace
    mappings   [332] SEQUENCE
                     (SIZE (0..maxPayloadBlks))
                     OF MapBlockOperation,
    -- contains a routing block which may be used
    -- when sending error messages back to the quota
    -- owner this routing block may be cached for
        -- future use
    replyBlock [332]   SEQUENCE {
         murb           RoutingCombo,
         maxReplay      INTEGER,
         validity       UsagePeriod
    } OPTIONAL
  }

  RoutingCombo ::= SEQUENCE {
    -- contains the period when the payload should
    -- be processed.
    -- Router might refuse too long queue retention
    -- Recommended support for retention &gt;=1h
    minProcessTime INTEGER
                       (0..maxDurationOfProcessing),
    maxProcessTime INTEGER
                       (0..maxDurationOfProcessing),
    -- The message key to encrypt the message
    peerKey        [401] SEQUENCE
                             (SIZE (1..maxNumOfReplays))
                         OF SymmetricKey OPTIONAL,
    -- contains the next recipient
    recipient      [402] BlendingSpec,
    -- PrefixBlock encrypted with message key
    mPrefix        [403] SEQUENCE
                             (SIZE (1..maxNumOfReplays))
                         OF OCTET STRING OPTIONAL,
    -- PrefixBlock encrypted with sender key
    cPrefix        [404] OCTET STRING OPTIONAL,
    -- HeaderBlock encrypted with sender key
    header         [405] OCTET STRING OPTIONAL,
    -- RoutingBlock encrypted with sender key
    routing        [406] OCTET STRING OPTIONAL,
    -- contains information for building messages
    -- (when used as MURB)
    -- ID 0 denotes original/local message
    -- ID 1-maxPayloadBlks denotes target message
        -- ID 32767 denotes a solicited reply block
    -- 32768-maxWorkspaceId shared workspace for all
    -- blocks of this identity)
    assembly       [407] SEQUENCE
                   (SIZE (0..maxAssemblyInstr))
                   OF PayloadOperation,
    -- optional for storage of the arrival time
    validity       [408] UsagePeriod OPTIONAL
  }

END</pre><a href="#appendix-A.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="asnOne_Ciphers">
<section id="appendix-A.2">
        <h3 id="name-the-messagevortex-ciphers-s">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-the-messagevortex-ciphers-s" class="section-name selfRef">The MessageVortex Ciphers Structures</a>
        </h3>
<div class="alignLeft art-asn.1 art-text artwork" id="appendix-A.2-1">
<pre>MessageVortex-Ciphers DEFINITIONS EXPLICIT TAGS ::=
BEGIN
  EXPORTS SymmetricKey, AsymmetricKey, MacAlgorithmSpec,
          MacAlgorithm, CipherSpec, PRNGType;

  CipherSpec ::= SEQUENCE {
      asymmetric  [16001] AsymAlgSpec OPTIONAL,
      symmetric   [16002] SymAlgSpec OPTIONAL,
      mac         [16003] MacAlgorithmSpec OPTIONAL,
      cipherUsage [16004] CipherUsage
  }

  CipherUsage ::= ENUMERATED {
    sign          (200),
    encrypt       (210)
  }

  SymAlgSpec  ::=  SEQUENCE  {
    algorithm     [16101]SymmetricAlgorithm,
    -- if ommited: pkcs7
    padding       [16102]CipherPadding OPTIONAL,
    -- if ommited: cbc
    mode          [16103]CipherMode OPTIONAL,
    parameter     [16104]AlgParameters OPTIONAL
  }

  AsymAlgSpec  ::=  SEQUENCE  {
    algorithm     AsymmetricAlgorithm,
    -- if ommited: pkcs1
    padding       [16102]CipherPadding OPTIONAL,
    parameter     AlgParameters OPTIONAL
  }

  SymmetricKey ::= SEQUENCE {
    keyType       SymmetricAlgorithm,
    parameter     AlgParameters,
    key           OCTET STRING (SIZE(16..512))
  }

  AsymmetricKey ::= SEQUENCE {
    keyType       AsymmetricAlgorithm,
    -- private key encoded as PKCS#8/PrivateKeyInfo
    publicKey     [2] OCTET STRING,
    -- private key encoded as
        -- X.509/SubjectPublicKeyInfo
    privateKey    [3] OCTET STRING OPTIONAL
  }

  SymmetricAlgorithm ::= ENUMERATED {
    aes128        (1000),  -- required
    aes192        (1001),  -- optional support
    aes256        (1002),  -- required
    camellia128   (1100),  -- required
    camellia192   (1101),  -- optional support
    camellia256   (1102),  -- required
    twofish128    (1200),  -- optional support
    twofish192    (1201),  -- optional support
    twofish256    (1202)   -- optional support
  }

  AsymmetricAlgorithm ::= ENUMERATED {
    rsa           (2000),
    dsa           (2100),
    ec            (2200),
    ntru          (2300)
  }
  ECCurveType ::= ENUMERATED{
    secp384r1     (2500),
    sect409k1     (2501),
    secp521r1     (2502)
  }
  AlgParameters ::= SEQUENCE {
    keySize      [9000] INTEGER (0..65535) OPTIONAL,
    curveType    [9001] ECCurveType   OPTIONAL,
    iv           [9002] OCTET STRING  OPTIONAL,
    nonce        [9003] OCTET STRING  OPTIONAL,
    mode         [9004] CipherMode    OPTIONAL,
    padding      [9005] CipherPadding OPTIONAL,
    n            [9010] INTEGER       OPTIONAL,
    p            [9011] INTEGER       OPTIONAL,
    q            [9012] INTEGER       OPTIONAL,
    k            [9013] INTEGER       OPTIONAL,
    t            [9014] INTEGER       OPTIONAL
  }

  CipherMode ::= ENUMERATED {
    cbc           (10000), -- required
    ctr           (10001), -- required
    ccm           (10002), -- optional support
    gcm           (10003), -- optional support
    ocb           (10004), -- optional support
    ofb           (10005), -- optional support
    xts           (10006), -- optional support
    none          (10100)  -- required
  }

  CipherPadding ::= ENUMERATED {
    none           (10200), -- required
    pkcs1          (10201), -- required
    rsaesOaep      (10202), -- optional support
    oaepSha256Mgf1 (10203), -- optional support
    pkcs7          (10301), -- required
    ap             (10221)  -- required
  }

  MacAlgorithm ::= ENUMERATED {
    sha3-256      (3000), -- required
    sha3-384      (3001), -- optional support
    sha3-512      (3002), -- required
    ripemd160     (3100), -- optional support
    ripemd256     (3101), -- required
    ripemd320     (3102)  -- optional support
  }

  MacAlgorithmSpec  ::=  SEQUENCE  {
    algorithm     MacAlgorithm,
    parameter     AlgParameters
  }

  PRNGAlgorithmSpec ::= SEQUENCE {
    type          PRNGType,
    seed          OCTET STRING
  }

  PRNGType ::= ENUMERATED {
    mrg32k3a      (10300), -- required
    blumMicali    (10301)  -- required
  }

END</pre><a href="#appendix-A.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="asnOne_requests">
<section id="appendix-A.3">
        <h3 id="name-the-messagevortex-request-s">
<a href="#appendix-A.3" class="section-number selfRef">A.3. </a><a href="#name-the-messagevortex-request-s" class="section-name selfRef">The MessageVortex Request Structures</a>
        </h3>
<div class="alignLeft art-asn.1 art-text artwork" id="appendix-A.3-1">
<pre>MessageVortex-Requests DEFINITIONS EXPLICIT TAGS ::=
BEGIN
  EXPORTS HeaderRequest;
  IMPORTS RequirementBlock
                FROM MessageVortex-Requirements
          UsagePeriod, NodeSpec
                FROM MessageVortex-Helpers;

  HeaderRequest ::= CHOICE {
    identity      [0] HeaderRequestIdentity,
    capabilities  [1] HeaderRequestCapability,
    messageQuota  [2] HeaderRequestIncreaseMessageQuota,
    transferQuota [3] HeaderRequestIncreaseTransferQuota,
    quotaQuery    [4] HeaderRequestQuota,
    nodeQuery     [5] HeaderRequestNodes,
    replace       [6] HeaderRequestReplaceIdentity
  }

  HeaderRequestIdentity ::= SEQUENCE {
    period UsagePeriod
  }

  HeaderRequestReplaceIdentity ::= SEQUENCE {
    replace           SEQUENCE {
        old            NodeSpec,
        new            NodeSpec OPTIONAL
    },
    identitySignature OCTET STRING
  }

  HeaderRequestQuota ::= SEQUENCE {
  }

  HeaderRequestNodes ::= SEQUENCE {
    numberOfNodes   INTEGER (0..255)
  }

  HeaderRequestIncreaseMessageQuota ::= SEQUENCE {
    messages INTEGER (0..4294967295)
  }

  HeaderRequestIncreaseTransferQuota ::= SEQUENCE {
    size     INTEGER (0..4294967295)
  }

  HeaderRequestCapability ::= SEQUENCE {
    period UsagePeriod
  }

  HeaderRequestUpgrade ::= SEQUENCE {
    version     OCTET STRING,
    identifier  OCTET STRING
  }


END</pre><a href="#appendix-A.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="asnOne_replies">
<section id="appendix-A.4">
        <h3 id="name-the-messagevortex-replies-s">
<a href="#appendix-A.4" class="section-number selfRef">A.4. </a><a href="#name-the-messagevortex-replies-s" class="section-name selfRef">The MessageVortex Replies Structures</a>
        </h3>
<div class="alignLeft art-asn.1 art-text artwork" id="appendix-A.4-1">
<pre>MessageVortex-Replies DEFINITIONS EXPLICIT TAGS ::=
BEGIN
  EXPORTS SpecialBlock;
  IMPORTS BlendingSpec, NodeSpec
                FROM MessageVortex-Helpers
          RequirementBlock
                FROM MessageVortex-Requirements
          CipherSpec, PRNGType, MacAlgorithm
                FROM MessageVortex-Ciphers
          maxGFSize
                FROM MessageVortex-Operations
          maxNumberOfReplays
                FROM MessageVortex-Schema;

  SpecialBlock ::= CHOICE {
    capabilities  [1]  ReplyCapability,
    requirement   [2]  SEQUENCE (SIZE (1..127))
                       OF RequirementBlock,
    quota         [4]  ReplyCurrentQuota,
    nodes         [5]  ReplyNodes,
    status        [99] StatusBlock
  }

  StatusBlock ::= SEQUENCE {
    code            StatusCode
  }

  StatusCode ::= ENUMERATED {

    -- System messages
    ok                          (2000),
    quotaStatus                 (2101),
    puzzleRequired              (2201),

    -- protocol usage failures
    transferQuotaExceeded       (3001),
    messageQuotaExceeded        (3002),
    requestedQuotaOutOfBand     (3003),
    identityUnknown             (3101),
    messageChunkMissing         (3201),
    messageLifeExpired          (3202),
    puzzleUnknown               (3301),

    -- capability errors
    macAlgorithmUnknown         (3801),
    symmetricAlgorithmUnknown   (3802),
    asymmetricAlgorithmUnknown  (3803),
    prngAlgorithmUnknown        (3804),
    missingParameters           (3820),
    badParameters               (3821),

    -- Mayor host specific errors
    hostError                   (5001)
  }

  ReplyNodes ::= SEQUENCE {
    node   SEQUENCE (SIZE (1..5))
           OF NodeSpec
  }

  ReplyCapability ::= SEQUENCE {
    -- supported ciphers
    cipher            SEQUENCE (SIZE (2..256))
                          OF CipherSpec,
    -- supported mac algorithms
    mac               SEQUENCE (SIZE (2..256))
                          OF MacAlgorithm,
    -- supported PRNGs
    prng              SEQUENCE (SIZE (2..256))
                          OF PRNGType,
    -- maximum number of bytes to be transferred
        -- (outgoing bytes in vortex message without blending)
    maxTransferQuota  INTEGER (0..4294967295),
    -- maximum number of messages to process for this identity
    maxMessageQuota   INTEGER (0..4294967295),
    -- maximum simultaneously tracked header serials
    maxHeaderSerials  INTEGER (0..4294967295),
    -- maximum simultaneously valid build operations in workspace
    maxBuildOps       INTEGER (0..4294967295),
    -- maximum payload size
    maxPayloadSize    INTEGER (0..4294967295),
    -- maximum active payloads (without intermediate products)
    maxActivePayloads INTEGER (0..4294967295),
    -- maximum header lifespan in seconds
    maxHeaderLive     INTEGER (0..4294967295),
    -- maximum number of replays accepted,
    maxReplay         INTEGER (0..maxNumberOfReplays),
    -- Supported inbound blending
    supportedBlendingIn SEQUENCE OF BlendingSpec,
    -- Supported outbound blending
    supportedBlendingOut SEQUENCE OF BlendingSpec,
    -- supported galoise fields
    supportedGFSize   SEQUENCE OF INTEGER (1..maxGF)
  }

  ReplyCurrentQuota ::= SEQUENCE {
    messages INTEGER (0..4294967295),
    size     INTEGER (0..4294967295)
  }

  ReplyUpgrade ::= SEQUENCE {
    -- The offered version
    version    [0] OCTET STRING,
    -- The offered identitfier
    identifier [1] OCTET STRING,
    -- The archive or blob containing the software
    blob       [2] OCTET STRING OPTIONAL
  }

END</pre><a href="#appendix-A.4-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="asnOne_requirements">
<section id="appendix-A.5">
        <h3 id="name-the-messagevortex-requireme">
<a href="#appendix-A.5" class="section-number selfRef">A.5. </a><a href="#name-the-messagevortex-requireme" class="section-name selfRef">The MessageVortex Requirements Structures</a>
        </h3>
<div class="alignLeft art-asn.1 art-text artwork" id="appendix-A.5-1">
<pre>MessageVortex-Requirements DEFINITIONS EXPLICIT TAGS ::=
BEGIN
  EXPORTS RequirementBlock;
  IMPORTS MacAlgorithmSpec
                FROM MessageVortex-Ciphers
          UsagePeriod, UsagePeriod
                FROM MessageVortex-Helpers;

  RequirementBlock ::= CHOICE {
    puzzle  [1] RequirementPuzzleRequired,
    payment [2] RequirementPaymentRequired
  }

  RequirementPuzzleRequired ::= SEQUENCE {
    -- bit sequence at beginning of hash from
        -- the encrypted identity block
    challenge     BIT STRING,
    mac           MacAlgorithmSpec,
    valid         UsagePeriod,
    identifier    INTEGER (0..4294967295)
  }

  RequirementPaymentRequired ::= SEQUENCE {
    account       OCTET STRING,
    ammount       REAL,
    currency      Currency
  }

  Currency ::= ENUMERATED {
    btc      (8001),
    eth      (8002),
    zec      (8003)
  }

END</pre><a href="#appendix-A.5-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="asnOne_helpers">
<section id="appendix-A.6">
        <h3 id="name-the-messagevortex-helpers-s">
<a href="#appendix-A.6" class="section-number selfRef">A.6. </a><a href="#name-the-messagevortex-helpers-s" class="section-name selfRef">The MessageVortex Helpers Structures</a>
        </h3>
<div class="alignLeft art-asn.1 art-text artwork" id="appendix-A.6-1">
<pre>MessageVortex-Helpers DEFINITIONS EXPLICIT TAGS ::=
BEGIN
  EXPORTS UsagePeriod, BlendingSpec, NodeSpec;
  IMPORTS AsymmetricKey, SymmetricKey
                FROM MessageVortex-Ciphers;

  -- the maximum number of embeddable parameters
  maxNumberOfParameter      INTEGER ::= 127

  UsagePeriod ::= CHOICE {
    absolute [2] AbsoluteUsagePeriod,
    relative [3] RelativeUsagePeriod
  }

  AbsoluteUsagePeriod ::= SEQUENCE {
    notBefore       [0]     GeneralizedTime OPTIONAL,
    notAfter        [1]     GeneralizedTime OPTIONAL
  }

  RelativeUsagePeriod ::= SEQUENCE {
    notBefore       [0]     INTEGER OPTIONAL,
    notAfter        [1]     INTEGER OPTIONAL
  }

  -- contains a node spec of a routing point
  -- At the moment either smtp:&lt;email&gt; or xmpp:&lt;jabber&gt;
  BlendingSpec ::= SEQUENCE {
    target            [1] NodeSpec,
    blendingType      [2] IA5String,
    parameter         [3] SEQUENCE
                          ( SIZE (0..maxNumberOfParameter) )
                          OF BlendingParameter
  }

  BlendingParameter ::= CHOICE {
    offset          [1] INTEGER,
    symmetricKey    [2] SymmetricKey,
    asymmetricKey   [3] AsymmetricKey,
    passphrase      [4] OCTET STRING
  }

  NodeSpec ::= SEQUENCE {
    transportProtocol [1] Protocol,
    recipientAddress  [2] IA5String,
    recipientKey      [3] AsymmetricKey OPTIONAL
  }

  Protocol ::= ENUMERATED {
    smtp  (100),
    xmmp  (110)
  }

END</pre><a href="#appendix-A.6-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="asnOne_additional">
<section id="appendix-A.7">
        <h3 id="name-the-messagevortex-additiona">
<a href="#appendix-A.7" class="section-number selfRef">A.7. </a><a href="#name-the-messagevortex-additiona" class="section-name selfRef">The MessageVortex Additional Structures</a>
        </h3>
<div class="alignLeft art-asn.1 art-text artwork" id="appendix-A.7-1">
<pre>-- States reflected:
--   Tuple()=Val()[vallidity; allowed operations]
--   {Store}
-- - Tuple(identity)=Val(messageQuota,transferQuota,
--   sequence of Routingblocks for Error Message
--   Routing) [validity; Requested at creation; may
--   be extended upon request] {identityStore}
-- - Tuple(Identity,Serial)=maxReplays ['valid' from
--   Identity Block; from First Identity Block; may
--   only be reduced] {IdentityReplayStore}

MessageVortex-NonProtocolBlocks DEFINITIONS
                                EXPLICIT TAGS ::=
BEGIN
  IMPORTS PrefixBlock, InnerMessageBlock,
          RoutingBlock,
          maxWorkspaceID
                FROM MessageVortex-Schema
          UsagePeriod, NodeSpec, BlendingSpec
                FROM MessageVortex-Helpers
          AsymmetricKey
                FROM MessageVortex-Ciphers
          RequirementBlock
                FROM MessageVortex-Requirements;

  -- maximum size of transfer quota in bytes of an
  -- identity
  maxTransferQuota          INTEGER ::= 4294967295
  -- maximum # of messages quota in messages of an
  -- identity
  maxMessageQuota           INTEGER ::= 4294967295

  -- do not use these blocks for protocol encoding
  -- (internal only)
  VortexMessage ::= SEQUENCE {
    prefix        CHOICE {
        plain           [10011] PrefixBlock,
        -- contains prefix encrypted with receivers
                -- public key
        encrypted       [10012] OCTET STRING
    },
    innerMessage  CHOICE {
        plain     [10021] InnerMessageBlock,
        -- contains inner message encrypted with
        -- Symmetric key from prefix
        encrypted [10022] OCTET STRING
    }
  }

  MemoryPayloadChunk ::= SEQUENCE {
    id            INTEGER (0..maxWorkspaceID),
    payload       [100] OCTET STRING,
    validity      UsagePeriod
  }

  IdentityStore ::= SEQUENCE {
    identities SEQUENCE (SIZE (0..4294967295))
               OF IdentityStoreBlock
  }

  IdentityStoreBlock ::= SEQUENCE {
    valid          UsagePeriod,
    messageQuota   INTEGER (0..maxMessageQuota),
    transferQuota  INTEGER (0..maxTransferQuota),
    -- if omitted this is a node identity
    identity       [1001] AsymmetricKey OPTIONAL,
    -- if ommited own identity key
    nodeAddress    [1002] NodeSpec      OPTIONAL,
    -- Contains the identity of the owning node;
    -- May be ommited if local node
    nodeKey        [1003] SEQUENCE OF AsymmetricKey
                            OPTIONAL,
    routingBlocks  [1004] SEQUENCE OF RoutingBlock
                               OPTIONAL,
    replayStore    [1005] IdentityReplayStore,
    requirement    [1006] RequirementBlock OPTIONAL
  }

  IdentityReplayStore ::= SEQUENCE {
    replays   SEQUENCE (SIZE (0..4294967295))
              OF IdentityReplayBlock
  }

  IdentityReplayBlock ::= SEQUENCE {
    identity         AsymmetricKey,
    valid            UsagePeriod,
    replaysRemaining INTEGER (0..4294967295)
  }

END</pre><a href="#appendix-A.7-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="changelog">
<section id="appendix-B">
      <h2 id="name-changelog">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-changelog" class="section-name selfRef">Changelog</a>
      </h2>
<span id="name-changes-in-versions"></span><div id="table_ex">
<table class="center" id="table-1">
        <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-changes-in-versions" class="selfRef">changes in versions</a>
        </caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Version #</th>
            <th class="text-left" rowspan="1" colspan="1">Date</th>
            <th class="text-left" rowspan="1" colspan="1">Changes</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">0</td>
            <td class="text-left" rowspan="1" colspan="1">11-2018</td>
            <td class="text-left" rowspan="1" colspan="1">Initial version</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">1</td>
            <td class="text-left" rowspan="1" colspan="1">02-2019</td>
            <td class="text-left" rowspan="1" colspan="1">Removed term block and added more precise spec about blending. Change in spec for XMPP blending (from XEP-234 to XEP-231). Restructured ASN.1.</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">2</td>
            <td class="text-left" rowspan="1" colspan="1">03-2019</td>
            <td class="text-left" rowspan="1" colspan="1">Language and consistency improvements. Added example for chunked plain embedding. Added pseudo-code for incoming message processing. Improved wording of hashes in ASN.1.</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">3</td>
            <td class="text-left" rowspan="1" colspan="1">09-2019</td>
            <td class="text-left" rowspan="1" colspan="1">Removed LaTeX notation in padding.</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">4</td>
            <td class="text-left" rowspan="1" colspan="1">03-2020</td>
            <td class="text-left" rowspan="1" colspan="1">Added spec for Software update using MV. Minor language improvements.</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">5</td>
            <td class="text-left" rowspan="1" colspan="1">09-2020</td>
            <td class="text-left" rowspan="1" colspan="1">Reinserted lost ASN.1 specs (unintentinally lost in last two versions). Added changelog. Modified padding to improve credibility of bad values.</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">6</td>
            <td class="text-left" rowspan="1" colspan="1">02-2021</td>
            <td class="text-left" rowspan="1" colspan="1">Removed some outdated references and updated draft according to the final research document. Refining of language.</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">7</td>
            <td class="text-left" rowspan="1" colspan="1">04-2021</td>
            <td class="text-left" rowspan="1" colspan="1">Lectorate and improved rendering.</td>
          </tr>
        </tbody>
      </table>
</div>
<p id="appendix-B-2"></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-address">
<a href="#name-authors-address" class="section-name selfRef">Author's Address</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Martin Gwerder</span></div>
<div dir="auto" class="left"><span class="org">University of Applied Sciences and Arts Northwestern Switzerland</span></div>
<div dir="auto" class="left"><span class="street-address">Bahnhofstrasse 5</span></div>
<div dir="auto" class="left">CH-<span class="postal-code">5210</span> <span class="locality">Windisch</span>
</div>
<div dir="auto" class="left"><span class="country-name">Switzerland</span></div>
<div class="tel">
<span>Phone:</span>
<a href="tel:+41%2056%20202%2076%2081" class="tel">+41 56 202 76 81</a>
</div>
<div class="email">
<span>Email:</span>
<a href="mailto:rfc@messagevortex.net" class="email">rfc@messagevortex.net</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
