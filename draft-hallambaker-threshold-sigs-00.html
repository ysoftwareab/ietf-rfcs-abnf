<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Threshold Signatures Using Ed25519 and Ed448</title>
<meta content="Phillip Hallam-Baker" name="author">
<meta content="
       A Threshold signature scheme is described. The signatures created are 
computationally indistinguishable from those produced using the Ed25519 
and Ed448 curves as specified in RFC8032 except in that they are 
non-deterministic. Threshold signatures are a form of digital 
signature whose creation requires two or more parties to interact 
but does not disclose the number or identities of the parties involved. 
    " name="description">
<meta content="xml2rfc 2.37.2" name="generator">
<meta content="Threshold Cryptography" name="keyword">
<meta content="Elliptic Curve" name="keyword">
<meta content="Threshold Signature" name="keyword">
<meta content="Digital Signature" name="keyword">
<meta content="draft-hallambaker-threshold-sigs-00" name="ietf.draft">
<link href="/tmp/draft-hallambaker-threshold-sigs-00-VZE_5U.xml" type="application/rfc+xml" rel="alternate">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Avoid wrapping of URLs in references */
@media screen {
  .references a {
    white-space: nowrap;
  }
}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin: 0 0 0.25em 0;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}</style>
<link href="rfc-local.css" type="text/css" rel="stylesheet">
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Threshold Signatures Ed25519 &amp; Ed448</td>
<td class="right">January 2020</td>
</tr></thead>
<tfoot><tr>
<td class="left">Hallam-Baker</td>
<td class="center">Expires 8 July 2020</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-hallambaker-threshold-sigs</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2020-01-05" class="published">5 January 2020</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2020-07-08">8 July 2020</time></dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">P. M. Hallam-Baker</div>
<div class="org">Venture Cryptography.</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Threshold Signatures Using Ed25519 and Ed448</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">A Threshold signature scheme is described. The signatures created are 
computationally indistinguishable from those produced using the Ed25519 
and Ed448 curves as specified in RFC8032 except in that they are 
non-deterministic. Threshold signatures are a form of digital 
signature whose creation requires two or more parties to interact 
but does not disclose the number or identities of the parties involved.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 8 July 2020.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2020 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (https://trustee.ietf.org/license-info) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a><a href="#section-toc.1-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-definitions" class="xref">Definitions</a><a href="#section-toc.1-1.2.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-requirements-language" class="xref">Requirements Language</a><a href="#section-toc.1-1.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-defined-terms" class="xref">Defined Terms</a><a href="#section-toc.1-1.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="xref">2.3</a>.  <a href="#name-related-specifications" class="xref">Related Specifications</a><a href="#section-toc.1-1.2.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a href="#section-2.4" class="xref">2.4</a>.  <a href="#name-implementation-status" class="xref">Implementation Status</a><a href="#section-toc.1-1.2.2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-threshold-signature-constru" class="xref">Threshold Signature Construction</a><a href="#section-toc.1-1.3.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-threshold-signature" class="xref">Threshold signature</a><a href="#section-toc.1-1.3.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-ed2519-signature" class="xref">Ed2519 Signature</a><a href="#section-toc.1-1.3.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-ed448-signature" class="xref">Ed448 Signature</a><a href="#section-toc.1-1.3.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="xref">3.4</a>.  <a href="#name-security-analysis" class="xref">Security Analysis</a><a href="#section-toc.1-1.3.2.4.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.3.2.4.2.1">
                    <p id="section-toc.1-1.3.2.4.2.1.1"><a href="#section-3.4.1" class="xref">3.4.1</a>.  <a href="#name-replay-attack" class="xref">Replay Attack</a><a href="#section-toc.1-1.3.2.4.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="toc ulEmpty" id="section-toc.1-1.3.2.4.2.2">
                    <p id="section-toc.1-1.3.2.4.2.2.1"><a href="#section-3.4.2" class="xref">3.4.2</a>.  <a href="#name-malicious-contribution-atta" class="xref">Malicious Contribution Attack</a><a href="#section-toc.1-1.3.2.4.2.2.1" class="pilcrow">¶</a></p>
</li>
                  <li class="toc ulEmpty" id="section-toc.1-1.3.2.4.2.3">
                    <p id="section-toc.1-1.3.2.4.2.3.1"><a href="#section-3.4.3" class="xref">3.4.3</a>.  <a href="#name-rogue-key-attack" class="xref">Rogue Key Attack</a><a href="#section-toc.1-1.3.2.4.2.3.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="toc ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-unanimous-signature" class="xref">Unanimous Signature</a><a href="#section-toc.1-1.4.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-using-threshold-key-generat" class="xref">Using threshold key generation</a><a href="#section-toc.1-1.4.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-using-key-splitting" class="xref">Using key splitting</a><a href="#section-toc.1-1.4.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-quorate-signature" class="xref">Quorate Signature</a><a href="#section-toc.1-1.5.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-key-generation" class="xref">Key Generation</a><a href="#section-toc.1-1.5.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-calculating-the-secret-scal" class="xref">Calculating the secret scalar value</a><a href="#section-toc.1-1.5.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-test-vectors" class="xref">Test Vectors</a><a href="#section-toc.1-1.6.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-unanimous-threshold-signatu" class="xref">Unanimous Threshold Signature Ed25519</a><a href="#section-toc.1-1.6.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-unanimous-threshold-signatur" class="xref">Unanimous Threshold Signature Ed448</a><a href="#section-toc.1-1.6.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="xref">6.3</a>.  <a href="#name-quorate-threshold-signature" class="xref">Quorate Threshold Signature Ed25519</a><a href="#section-toc.1-1.6.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="xref">6.4</a>.  <a href="#name-quorate-threshold-signature-" class="xref">Quorate Threshold Signature Ed448</a><a href="#section-toc.1-1.6.2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a><a href="#section-toc.1-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a><a href="#section-toc.1-1.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-acknowledgements" class="xref">Acknowledgements</a><a href="#section-toc.1-1.9.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-normative-references" class="xref">Normative References</a><a href="#section-toc.1-1.10.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>. <a href="#name-informative-references" class="xref">Informative References</a><a href="#section-toc.1-1.11.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="n-introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Threshold encryption and key generation provide compelling advantages over single private key approaches because splitting the private key permits the use of that key to be divided between two or more roles.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">All existing digital signatures allow the signer role to be divided between multiple parties by attaching multiple signatures to the signed document. This approach, known as multi-signatures is distinguished from a threshold signature scheme in that the identity and roles of the individual signers is exposed. In a threshold signature scheme, the creation of a single signature requires the participation of multiple signers and the signature itself does not reveal the means by which it was constructed.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">Rather than considering multi-signatures or threshold signatures to be inherently superior, it is more useful to regard both as two points on a continuum of choices:<a href="#section-1-3" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-1-4">
        <dt id="section-1-4.1">Multi-signatures </dt>
        <dd id="section-1-4.2">
          <p id="section-1-4.2.1">Multiple digital signatures on the same document. Multi-signatures are simple to create and provide the verifier with more information but require the acceptance criteria to be specified independently of the signature itself. This requires that the application logic or PKI provide some means of describing the criteria to be applied.<a href="#section-1-4.2.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1-4.3">Multi-party key release</dt>
        <dd id="section-1-4.4">
          <p id="section-1-4.4.1">A single signature created using a single private key stored in an encrypted form whose use requires participation of multiple key decryption shares.<a href="#section-1-4.4.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1-4.5">Threshold signatures </dt>
        <dd id="section-1-4.6">
          <p id="section-1-4.6.1">A single signature created using multiple signature key shares. Signature creation may be subject to complex criteria such as requiring an (n,t) quorum of signers but these criteria are fixed at the time the signature is created<a href="#section-1-4.6.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1-4.7">Aggregate Signatures </dt>
        <dd id="section-1-4.8">
          <p id="section-1-4.8.1">A single signature created using multiple signature key shares such that validation of the aggregate signature serves to validate the participation of each of the individual signers.<a href="#section-1-4.8.1" class="pilcrow">¶</a></p>
</dd>
</dl>
<p id="section-1-5">This document describes a scheme that creates threshold signatures that are computationally indistinguishable from those produced according to the algorithm specified in <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>. The scheme does not support the creation of aggregate signatures.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">Two versions of the algorithm are presented. Both versions allow a creation of a signature to be divided between a set of n signers such that a minimum of t signers are required to create a signature. The first version of the algorithm (unanimous signature) requires that every member of the set of signers participate in the signing process (i.e. n=t). The second version (quorate signature) allows a signature to be created by a subset of the authorized signers.<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7">The unanimous signature scheme allows key shares to be generated by either dividing a master key or using threshold key generation to construct the master key from two or more key contributions as described in <span>[<a href="#draft-hallambaker-threshold" class="xref">draft-hallambaker-threshold</a>]</span>.<a href="#section-1-7" class="pilcrow">¶</a></p>
<p id="section-1-8">The quorate signature scheme requires that the signature key shares be derived from a master signature key using Shamir secret sharing. The process of key share generation is thus fundamentally one of dividing a master key.<a href="#section-1-8" class="pilcrow">¶</a></p>
<p id="section-1-9">If required, division of the signing key administration roles may be achieved by using threshold key generation to construct the master key and performing the key splitting process separately for each contribution.<a href="#section-1-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-definitions">
<section id="section-2">
      <h2 id="name-definitions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-definitions" class="section-name selfRef">Definitions</a>
      </h2>
<p id="section-2-1">This section presents the related specifications and standard, the terms that are used as terms of art within the documents and the terms used as requirements language.<a href="#section-2-1" class="pilcrow">¶</a></p>
<div id="n-requirements-language">
<section id="section-2.1">
        <h3 id="name-requirements-language">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-requirements-language" class="section-name selfRef">Requirements Language</a>
        </h3>
<p id="section-2.1-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as described in <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span>.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-defined-terms">
<section id="section-2.2">
        <h3 id="name-defined-terms">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-defined-terms" class="section-name selfRef">Defined Terms</a>
        </h3>
<p id="section-2.2-1">See  <span>[<a href="#draft-hallambaker-threshold" class="xref">draft-hallambaker-threshold</a>]</span>.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-related-specifications">
<section id="section-2.3">
        <h3 id="name-related-specifications">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-related-specifications" class="section-name selfRef">Related Specifications</a>
        </h3>
<p id="section-2.3-1">This document extends the approach described in  <span>[<a href="#draft-hallambaker-threshold" class="xref">draft-hallambaker-threshold</a>]</span> to support threshold signatures. The use of Lagrange polynomials to resolve Shamir Secret Shares is currently described in the Uniform Data Fingerprint specification <span>[<a href="#draft-hallambaker-mesh-udf" class="xref">draft-hallambaker-mesh-udf</a>]</span>. It is expected that these three documents will eventually form the basis for two CFRG proposals.<a href="#section-2.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-implementation-status">
<section id="section-2.4">
        <h3 id="name-implementation-status">
<a href="#section-2.4" class="section-number selfRef">2.4. </a><a href="#name-implementation-status" class="section-name selfRef">Implementation Status</a>
        </h3>
<p id="section-2.4-1">The implementation status of the reference code base is described in the companion document <span>[<a href="#draft-hallambaker-mesh-developer" class="xref">draft-hallambaker-mesh-developer</a>]</span>.<a href="#section-2.4-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="n-threshold-signature-construction">
<section id="section-3">
      <h2 id="name-threshold-signature-constru">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-threshold-signature-constru" class="section-name selfRef">Threshold Signature Construction</a>
      </h2>
<p id="section-3-1">The threshold signatures created according to the algorithms described in this document are compatible with but not identical to the signatures created according to the scheme described in <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>. In particular:<a href="#section-3-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-3-2.1">The signature verification algorithm is unchanged.<a href="#section-3-2.1" class="pilcrow">¶</a>
</li>
        <li id="section-3-2.2">The unanimous threshold scheme produces values of R and S that are deterministic but different from the values that would be obtained by using the aggregate private key to sign the same document.<a href="#section-3-2.2" class="pilcrow">¶</a>
</li>
        <li id="section-3-2.3">The deterministic quorate threshold scheme produces values of R and S that are deterministic for a given set of signers but will change for a different set of signers or if the aggregate private key was used to sign the same document.<a href="#section-3-2.3" class="pilcrow">¶</a>
</li>
        <li id="section-3-2.4">?The non-deterministic quorate threshold scheme produces values of R and S that will be different each time the document is signed.<a href="#section-3-2.4" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-3-3">Recall that a digital signature as specified by <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span> consists of a pair of values S, R calculated as follows:<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">R = r.B<a href="#section-3-4" class="pilcrow">¶</a></p>
<p id="section-3-5">S = r + k.s mod L<a href="#section-3-5" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-3-6">
        <dt id="section-3-6.1">Where </dt>
        <dd id="section-3-6.2">
          <p id="section-3-6.2.1">B is the base point of the elliptic curve.<a href="#section-3-6.2.1" class="pilcrow">¶</a></p>
<p id="section-3-6.2.2">r is an unique, unpredictable integer value such that 0  r  L<a href="#section-3-6.2.2" class="pilcrow">¶</a></p>
<p id="section-3-6.2.3">k is the result of applying a message digest function determined by the curve (Ed25519, Ed448) to a set of parameters known to the verifier which include the values R, A and PH(M).<a href="#section-3-6.2.3" class="pilcrow">¶</a></p>
<p id="section-3-6.2.4">A is the public key of the signer, A = s.B<a href="#section-3-6.2.4" class="pilcrow">¶</a></p>
<p id="section-3-6.2.5">PH(M) is the prehash function of the message value.<a href="#section-3-6.2.5" class="pilcrow">¶</a></p>
<p id="section-3-6.2.6">s is the secret scalar value<a href="#section-3-6.2.6" class="pilcrow">¶</a></p>
<p id="section-3-6.2.7">L is the order of the elliptic curve group.<a href="#section-3-6.2.7" class="pilcrow">¶</a></p>
</dd>
</dl>
<p id="section-3-7">To verify the signature, the verifier calculates:<a href="#section-3-7" class="pilcrow">¶</a></p>
<p id="section-3-8">S.B = R + k.A<a href="#section-3-8" class="pilcrow">¶</a></p>
<p id="section-3-9">Therefore:<a href="#section-3-9" class="pilcrow">¶</a></p>
<p id="section-3-10">S.B = (r + k.s).B = r.B +k.(s.B) = R + k.A<a href="#section-3-10" class="pilcrow">¶</a></p>
<p id="section-3-11">The value r plays a critical role in the signature scheme as it serves to prevent disclosure of the secret scalar. If the value r is known, s can be calculated as s = (S-r).k<sup>-1</sup> mod L. It is therefore essential that the value r be unguessable.<a href="#section-3-11" class="pilcrow">¶</a></p>
<p id="section-3-12">Furthermore, if the same value of r is used to sign two different documents, this results two signatures with the same value R and different values of k and S. Thus<a href="#section-3-12" class="pilcrow">¶</a></p>
<p id="section-3-13">S<sub>1</sub> = r + k<sub>1</sub>.s mod L<a href="#section-3-13" class="pilcrow">¶</a></p>
<p id="section-3-14">S<sub>2</sub> = r + k2.s mod L<a href="#section-3-14" class="pilcrow">¶</a></p>
<p id="section-3-15">s = (S<sub>1</sub> - S<sub>2</sub>)(k<sub>1</sub> - k<sub>2</sub>)<sup>-1</sup> mod L<a href="#section-3-15" class="pilcrow">¶</a></p>
<p id="section-3-16">The method of constructing r specified in <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span> ensures that the value r is unique and unguessable provided that the private key from which the secret scalar value is derived is kept secret.<a href="#section-3-16" class="pilcrow">¶</a></p>
<p id="section-3-17">The use of a deterministic means of generating the value r permits auditing of hardware and software implementations to determine if the correct means of constructing r is used by importing a known private key and verifying that the expected values of R are produced when a set of documents is signed.<a href="#section-3-17" class="pilcrow">¶</a></p>
<p id="section-3-18">The threshold schemes described in this document have been designed to preserve the ability to audit the means of constructing the values of r for each individual key share even though the sum of these values and hence the value R will vary according to the number of signature shares used.<a href="#section-3-18" class="pilcrow">¶</a></p>
<div id="n-threshold-signature">
<section id="section-3.1">
        <h3 id="name-threshold-signature">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-threshold-signature" class="section-name selfRef">Threshold signature</a>
        </h3>
<p id="section-3.1-1">A threshold signature R, S is constructed by summing a set of signature contributions from two or more signers. Each signer <em>i</em> provides a contribution as follows:<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">A<sub>i</sub> = s<sub>i</sub>.B<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<p id="section-3.1-3">R<sub>i</sub> = r<sub>i</sub>.B<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<p id="section-3.1-4">S<sub>i</sub> = r<sub>i</sub> + k.s<sub>i</sub> mod L<a href="#section-3.1-4" class="pilcrow">¶</a></p>
<p id="section-3.1-5">Where s<sub>i</sub> and r<sub>i</sub> are the secret scalar and unguessable value for the individual signer.<a href="#section-3.1-5" class="pilcrow">¶</a></p>
<p id="section-3.1-6">The contributions of signers {1, 2, ... n} are then combined as follows:<a href="#section-3.1-6" class="pilcrow">¶</a></p>
<p id="section-3.1-7">R = R<sub>1</sub> + R<sub>2</sub> + ... + R<sub>n</sub><a href="#section-3.1-7" class="pilcrow">¶</a></p>
<p id="section-3.1-8">S = S<sub>1</sub> + S<sub>2</sub> + ... + S<sub>n</sub><a href="#section-3.1-8" class="pilcrow">¶</a></p>
<p id="section-3.1-9">A = s.B<a href="#section-3.1-9" class="pilcrow">¶</a></p>
<p id="section-3.1-10">Where s =  (s<sub>1</sub> + s<sub>2</sub> + ... + s<sub>n</sub>) mod L<a href="#section-3.1-10" class="pilcrow">¶</a></p>
<p id="section-3.1-11">The threshold signature is verified in the same manner as before:<a href="#section-3.1-11" class="pilcrow">¶</a></p>
<p id="section-3.1-12">S.B = R + k.A<a href="#section-3.1-12" class="pilcrow">¶</a></p>
<p id="section-3.1-13">Substituting for S.B we get:<a href="#section-3.1-13" class="pilcrow">¶</a></p>
<p id="section-3.1-14">= (S<sub>1</sub> + S<sub>2</sub> + ... + S<sub>n</sub>).B<a href="#section-3.1-14" class="pilcrow">¶</a></p>
<p id="section-3.1-15">= S<sub>1</sub>.B + S<sub>2</sub>.B + ... + S<sub>n</sub>.B<a href="#section-3.1-15" class="pilcrow">¶</a></p>
<p id="section-3.1-16">= (r<sub>1</sub> + k.s<sub>1</sub>).B + (r<sub>2</sub> + k.s<sub>2</sub>).B + ... + (r<sub>n</sub> + k.s<sub>n</sub>).B<a href="#section-3.1-16" class="pilcrow">¶</a></p>
<p id="section-3.1-17">= (r<sub>1</sub>.B + k.s<sub>1</sub>.B) + (r<sub>2</sub>.B + k.s<sub>2</sub>.B) + ... + (r<sub>n</sub>.B + k.s<sub>n</sub>.B)<a href="#section-3.1-17" class="pilcrow">¶</a></p>
<p id="section-3.1-18">= (R1 + k.A1) + (R1 + k.A1) + ... + (Rn + k.An)<a href="#section-3.1-18" class="pilcrow">¶</a></p>
<p id="section-3.1-19">Substituting for R + k.A we get:<a href="#section-3.1-19" class="pilcrow">¶</a></p>
<p id="section-3.1-20">= R<sub>1</sub> + R<sub>2</sub> + ... + R<sub>n</sub> + k.(A<sub>1</sub> + A<sub>2</sub> + ... + A<sub>n</sub>)<a href="#section-3.1-20" class="pilcrow">¶</a></p>
<p id="section-3.1-21">= R<sub>1</sub> + R<sub>2</sub> + ... + R<sub>n</sub> + k.A<sub>1</sub> + k.A<sub>2</sub> + ... + k.A<sub>n</sub><a href="#section-3.1-21" class="pilcrow">¶</a></p>
<p id="section-3.1-22">= (R<sub>1</sub> + k.A<sub>1</sub>) + (R<sub>1</sub> + k.A<sub>1</sub>) + ... + (R<sub>n</sub> + k.A<sub>n</sub>)<a href="#section-3.1-22" class="pilcrow">¶</a></p>
<p id="section-3.1-23">As expected, the operation of threshold signature makes use of the same approach as threshold key generation and threshold decryption as described in <span>[<a href="#draft-hallambaker-threshold" class="xref">draft-hallambaker-threshold</a>]</span>. As with threshold decryption it is not necessary for each key share holder to have a public key corresponding to their key share. All that is required is that the sum of the secret scalar values used in calculation of the signature modulo the group order be the value of the aggregate secret scalar corresponding to the aggregate secret key.<a href="#section-3.1-23" class="pilcrow">¶</a></p>
<p id="section-3.1-24">While verification of <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span> signatures is unchanged, the use of threshold signatures requires a different approach to signing. In particular, the fact that the value k is bound to the value R means that the participants in the threshold signature scheme must agree on the value R before the value k can be calculated. Since k is required to calculate the signature contributions S<sub>i</sub> can be calculated, it is thus necessary to calculate the values R<sub>i</sub> and S<sub>i</sub> in separate phases. The process of using a threshold signature to sign a document thus has the following stages orchestrated by a coordinator as follows:<a href="#section-3.1-24" class="pilcrow">¶</a></p>
<ol start="0" type="1" class="normal" id="section-3.1-25">
          <li id="section-3.1-25.1">The coordinator determines the values F, C and PH(M) as specified in <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span> and transmits them to the signers {1, 2, ... n}.<a href="#section-3.1-25.1" class="pilcrow">¶</a>
</li>
          <li id="section-3.1-25.2">Each signer generates a random value r<sub>i</sub> such that 1  r<sub>i</sub>  L, calculates the value R<sub>i</sub> = r<sub>i</sub>.B and returns R to the coordinator.<a href="#section-3.1-25.2" class="pilcrow">¶</a>
</li>
          <li id="section-3.1-25.3">The coordinator calculates the value R = R<sub>1</sub> + R<sub>2</sub> + ... + R<sub>n</sub> and transmits R and A to the signers {1, 2, ... n}.<a href="#section-3.1-25.3" class="pilcrow">¶</a>
</li>
          <li id="section-3.1-25.4">Each signer uses the suppled data to determine the value k and hence S<sub>i</sub> = r<sub>i</sub> + k.s<sub>i</sub> mod L and transmits it to the coordinator.<a href="#section-3.1-25.4" class="pilcrow">¶</a>
</li>
          <li id="section-3.1-25.5">The coordinator calculates the value S = S<sub>1</sub> + S<sub>2</sub> + ... + S<sub>n</sub> and verifies that the resulting signature R, S verifies according to the mechanism specified in <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>. If the signature is correct, the coordinator publishes it. Otherwise, the coordinator <span class="bcp14">MAY</span> identify the signer(s) that provided incorrect contributions by verifying the values R<sub>i</sub> and S<sub>i</sub> for each.<a href="#section-3.1-25.5" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-3.1-26">For clarity, the coordinator role is presented here as being implemented by a single party.<a href="#section-3.1-26" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-ed2519-signature">
<section id="section-3.2">
        <h3 id="name-ed2519-signature">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-ed2519-signature" class="section-name selfRef">Ed2519 Signature</a>
        </h3>
<p id="section-3.2-1">The process for creating an Ed25519 signature contribution is as follows<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<ol start="0" type="1" class="normal" id="section-3.2-2">
          <li id="section-3.2-2.1">Determine the value of the secret scalar value s<sub>i</sub> according to the means used to construct the secret shares.<a href="#section-3.2-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-3.2-2.2">Generate a random integer r<sub>i</sub> such that 1  r<sub>i</sub>  L<a href="#section-3.2-2.2" class="pilcrow">¶</a>
</li>
          <li id="section-3.2-2.3">Compute the point R<sub>i</sub> = r<sub>i</sub>B.  For efficiency, do this by first reducing r<sub>i</sub> modulo L, the group order of B.  Let the string R<sub>i</sub> be the encoding of this point.<a href="#section-3.2-2.3" class="pilcrow">¶</a>
</li>
          <li id="section-3.2-2.4">Transmit the value R<sub>i</sub> to the coordinator<a href="#section-3.2-2.4" class="pilcrow">¶</a>
</li>
          <li id="section-3.2-2.5">Note that the construction of prefix is chosen so as to guarantee that the use of a different message value M or secret scalar value s<sub>i</sub> will result in a different value of prefix and thus ensure a different choice of the value r<sub>i</sub>.<a href="#section-3.2-2.5" class="pilcrow">¶</a>
</li>
          <li id="section-3.2-2.6">At some later point, the coordinator <span class="bcp14">MAY</span> complete the signature by returning the values F, C, A and R as specified in <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>. The signer <span class="bcp14">MAY</span> then complete the signature contribution as follows:<a href="#section-3.2-2.6" class="pilcrow">¶</a>
</li>
          <li id="section-3.2-2.7">Compute SHA512(dom2(F, C) || R || A || PH(M)), and interpret the 64-octet digest as a little-endian integer k.<a href="#section-3.2-2.7" class="pilcrow">¶</a>
</li>
          <li id="section-3.2-2.8">Compute S<sub>i</sub> = (r<sub>i</sub> + k * s<sub>i</sub>) mod L.  For efficiency, again reduce k modulo L first.<a href="#section-3.2-2.8" class="pilcrow">¶</a>
</li>
          <li id="section-3.2-2.9">Return the values R<sub>i</sub>, S<sub>i</sub> to the coordinator.<a href="#section-3.2-2.9" class="pilcrow">¶</a>
</li>
          <li id="section-3.2-2.10">The coordinator assembles the signature values R = S = S<sub>1</sub> + S<sub>2</sub> + ... + S<sub>n</sub><a href="#section-3.2-2.10" class="pilcrow">¶</a>
</li>
          <li id="section-3.2-2.11">The coordinator verifies that the signature R, S is valid.<a href="#section-3.2-2.11" class="pilcrow">¶</a>
</li>
        </ol>
</section>
</div>
<div id="n-ed448-signature">
<section id="section-3.3">
        <h3 id="name-ed448-signature">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-ed448-signature" class="section-name selfRef">Ed448 Signature</a>
        </h3>
<p id="section-3.3-1">The process for creating an Ed448 signature contribution is as follows<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<ol start="0" type="1" class="normal" id="section-3.3-2">
          <li id="section-3.3-2.1">Determine the value of the secret scalar value s<sub>i</sub> according to the means used to construct the secret shares.<a href="#section-3.3-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-3.3-2.2">Generate a random integer r<sub>i</sub> such that 1  r<sub>i</sub>  L<a href="#section-3.3-2.2" class="pilcrow">¶</a>
</li>
          <li id="section-3.3-2.3">Compute the point R<sub>i</sub> = r<sub>i</sub>B.  For efficiency, do this by first reducing r<sub>i</sub> modulo L, the group order of B.  Let the string R<sub>i</sub> be the encoding of this point.<a href="#section-3.3-2.3" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-3.3-3">Transmit the value R<sub>i</sub> to the coordinator<a href="#section-3.3-3" class="pilcrow">¶</a></p>
<p id="section-3.3-4">At some later point, the coordinator <span class="bcp14">MAY</span> complete the signature by returning the values F, C, A and R as specified in <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>. The signer <span class="bcp14">MAY</span> then complete the signature contribution as follows:<a href="#section-3.3-4" class="pilcrow">¶</a></p>
<ol start="0" type="1" class="normal" id="section-3.3-5">
          <li id="section-3.3-5.1">Compute SHAKE256(dom4(F, C) || R || A || PH(M), 114), and interpret the 114-octet digest as a little-endian integer k.<a href="#section-3.3-5.1" class="pilcrow">¶</a>
</li>
          <li id="section-3.3-5.2">Compute S<sub>i</sub> = (r<sub>i</sub> + k * s<sub>i</sub>) mod L.  For efficiency, again reduce k modulo L first.<a href="#section-3.3-5.2" class="pilcrow">¶</a>
</li>
          <li id="section-3.3-5.3">Return the values R<sub>i</sub>, S<sub>i</sub> to the coordinator.<a href="#section-3.3-5.3" class="pilcrow">¶</a>
</li>
          <li id="section-3.3-5.4">The coordinator assembles the signature values R = S = S<sub>1</sub> + S<sub>2</sub> + ... + S<sub>n</sub><a href="#section-3.3-5.4" class="pilcrow">¶</a>
</li>
          <li id="section-3.3-5.5">The coordinator verifies that the signature R, S is valid.<a href="#section-3.3-5.5" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-3.3-6">Note that the process of generating the signature contribution is deterministic for a given secret scalar value but the signature computed <span class="bcp14">MAY</span> be deterministic or non-deterministic according to the desired signature properties.<a href="#section-3.3-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-security-analysis">
<section id="section-3.4">
        <h3 id="name-security-analysis">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-security-analysis" class="section-name selfRef">Security Analysis</a>
        </h3>
<p id="section-3.4-1">We consider a successful breach of the threshold signature scheme to be any attack that allows the attacker to create a valid signature for any message without the participation of the required threshold of signers.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<p id="section-3.4-2">Potential breaches include:<a href="#section-3.4-2" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.4-3.1">Disclosure of the signature key or signature key share.<a href="#section-3.4-3.1" class="pilcrow">¶</a>
</li>
          <li id="section-3.4-3.2">Modification of signature data relating to message M to allow creation of a signature for message M'.<a href="#section-3.4-3.2" class="pilcrow">¶</a>
</li>
          <li id="section-3.4-3.3">Ability of one of the signers to choose the value of the aggregate public key.<a href="#section-3.4-3.3" class="pilcrow">¶</a>
</li>
          <li id="section-3.4-3.4">Access control attacks inducing a signer to create a signature contribution that was not properly authenticated or authorized.<a href="#section-3.4-3.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.4-4">We regard attacks on the access control channel to be out of scope for the threshold signature algorithm, though they are certainly a concern for any system in which a threshold signature algorithm is employed.<a href="#section-3.4-4" class="pilcrow">¶</a></p>
<p id="section-3.4-5">We do not consider the ability of a signer to cause creation of an invalid signature to represent a breach.<a href="#section-3.4-5" class="pilcrow">¶</a></p>
<div id="n-replay-attack">
<section id="section-3.4.1">
          <h4 id="name-replay-attack">
<a href="#section-3.4.1" class="section-number selfRef">3.4.1. </a><a href="#name-replay-attack" class="section-name selfRef">Replay Attack</a>
          </h4>
<p id="section-3.4.1-1">The most serious concern in the implementation of any Schnorr type signature scheme is the need to ensure that the value r<sub>i</sub> is never revealed to any other party and is never used to create signatures for two different values of k.s<sub>i</sub>.<a href="#section-3.4.1-1" class="pilcrow">¶</a></p>
<p id="section-3.4.1-2">Ensuring this does not occur imposes significant design constraints as creating a correct signature contribution requires that the signer use the same value of r<sub>i</sub> to construct its value or R<sub>i</sub> and S<sub>i</sub>.<a href="#section-3.4.1-2" class="pilcrow">¶</a></p>
<p id="section-3.4.1-3">For example, a HSM device may be required to perform multiple signature operations simultaneously. Since the storage capabilities of an HSM device are typically constrained, it is tempting to attempt to avoid the need to track the value of r<sub>i</sub> within the device itself using an appropriately authenticated and encrypted opaque state token. Such mechanisms provide the HSM with the value of r<sub>i</sub> but do not and cannot provide protection against a replay attack in which the same state token is presented with a request to sign different values of k.<a href="#section-3.4.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-malicious-contribution-attack">
<section id="section-3.4.2">
          <h4 id="name-malicious-contribution-atta">
<a href="#section-3.4.2" class="section-number selfRef">3.4.2. </a><a href="#name-malicious-contribution-atta" class="section-name selfRef">Malicious Contribution Attack</a>
          </h4>
<p id="section-3.4.2-1">In a malicious contribution attack, one or more parties present a signature contribution that does not meet the criteria R<sub>i</sub> = r<sub>i</sub>.B and S<sub>i</sub> = r<sub>i</sub> + ks<sub>i</sub>.<a href="#section-3.4.2-1" class="pilcrow">¶</a></p>
<p id="section-3.4.2-2">Such an attack is not considered to be a breach as it merely causes the signature process to fail.<a href="#section-3.4.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="roguekey">
<section id="section-3.4.3">
          <h4 id="name-rogue-key-attack">
<a href="#section-3.4.3" class="section-number selfRef">3.4.3. </a><a href="#name-rogue-key-attack" class="section-name selfRef">Rogue Key Attack</a>
          </h4>
<p id="section-3.4.3-1">A threshold signature scheme that allows the participants to 'bring their own key' may be vulnerable to a rogue key attack in which a signer is able to select the value of the aggregate public signature key by selecting a malicious public signature key value.<a href="#section-3.4.3-1" class="pilcrow">¶</a></p>
<p id="section-3.4.3-2">The scheme described in this document is a threshold signature scheme and does not support this feature. Consequently, this attack is not relevant. It is described here for illustrative purposes only.<a href="#section-3.4.3-2" class="pilcrow">¶</a></p>
<p id="section-3.4.3-3">This particular attack only applies when the individual signers create their own signature shares. It is not a concern when the signature shares are created by splitting a master signature private key.<a href="#section-3.4.3-3" class="pilcrow">¶</a></p>
<p id="section-3.4.3-4">Consider the case where the aggregate public key signature is calculated from the sum of public signature key share values presented by the signers:<a href="#section-3.4.3-4" class="pilcrow">¶</a></p>
<p id="section-3.4.3-5">A = A<sub>1</sub> + A<sub>2</sub> + ... + A<sub>n</sub><a href="#section-3.4.3-5" class="pilcrow">¶</a></p>
<p id="section-3.4.3-6">If the public key values are presented in turn, the last signer presenting their key share can force the selection of any value of A that they choose by selecting A<sub>n</sub> = A<sub>m</sub> -  (A<sub>1</sub> + A<sub>2</sub> + ... + A<sub>n-1</sub>)<a href="#section-3.4.3-6" class="pilcrow">¶</a></p>
<p id="section-3.4.3-7">The attacker can thus gain control of the aggregate signature key by choosing A<sub>m</sub> = s<sub>m</sub>.B where s<sub>m</sub> is a secret scalar known only to the attacker. But does so at the cost of not knowing the value s<sub>n</sub> and so the signer cannot participate in the signature protocol.<a href="#section-3.4.3-7" class="pilcrow">¶</a></p>
<p id="section-3.4.3-8">This attack allows the attacker and the attacker alone to create signatures which are validated under the aggregate signature key.<a href="#section-3.4.3-8" class="pilcrow">¶</a></p>
<p id="section-3.4.3-9">The attack is a consequence of the mistaken assumption that a signature created under the signature key A<sub>1</sub> + A<sub>2</sub> + ... + A<sub>n</sub> provides evidence of the individual participation of the corresponding key holders without separate validation of the aggregate key.<a href="#section-3.4.3-9" class="pilcrow">¶</a></p>
<p id="section-3.4.3-10">Enabling the use of threshold signature techniques by ad-hoc groups of signers using their existing signature keys as signature key shares presents serious technical challenges that are outside the scope of this specification.<a href="#section-3.4.3-10" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="n-unanimous-signature">
<section id="section-4">
      <h2 id="name-unanimous-signature">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-unanimous-signature" class="section-name selfRef">Unanimous Signature</a>
      </h2>
<p id="section-4-1">A unanimous threshold signature is a signature created by a set of two or more signers that requires the participation of every member of the set. The key shares used by the signers <span class="bcp14">MAY</span> be generated by either:<a href="#section-4-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-4-2.1">Each key share holder generating their own unique key share and combining them.<a href="#section-4-2.1" class="pilcrow">¶</a>
</li>
        <li id="section-4-2.2">Generating a master signature key and dividing it.<a href="#section-4-2.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-4-3">Both approaches are described in <span>[<a href="#draft-hallambaker-threshold" class="xref">draft-hallambaker-threshold</a>]</span>.<a href="#section-4-3" class="pilcrow">¶</a></p>
<div id="key-generation">
<section id="section-4.1">
        <h3 id="name-using-threshold-key-generat">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-using-threshold-key-generat" class="section-name selfRef">Using threshold key generation</a>
        </h3>
<p id="section-4.1-1">To create a threshold signature key share using threshold key generation, each signer generates a pair {A<sub>i</sub>, s<sub>i</sub>} and transmits the public component to the coordinator.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">The coordinator calculates the aggregate public key A = A<sub>1</sub> + A<sub>2</sub> + ... + A<sub>n</sub><a href="#section-4.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1-3">= s<sub>1</sub>.B + s<sub>2</sub>.B + ... + s<sub>n</sub>.B<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1-4">= ((s<sub>1</sub> + s<sub>2</sub> + ... + s<sub>n</sub>) mod L).B<a href="#section-4.1-4" class="pilcrow">¶</a></p>
<p id="section-4.1-5">= s.B<a href="#section-4.1-5" class="pilcrow">¶</a></p>
<p id="section-4.1-6">Where s =  s<sub>1</sub> + s<sub>2</sub> + ... + s<sub>n</sub>) mod L<a href="#section-4.1-6" class="pilcrow">¶</a></p>
<p id="section-4.1-7">The coordinator <span class="bcp14">MUST</span> require and verify proof of possession of the private key component s<sub>i</sub> to defeat rogue key attacks of the type described in <a href="#roguekey" class="xref">Section 3.4.3</a>.<a href="#section-4.1-7" class="pilcrow">¶</a></p>
<p id="section-4.1-8">For example, the coordinator <span class="bcp14">MAY</span> require each signer to create a test signature for their individual signature key share or to participate in creating a test signature under the aggregate signature key. Such a test signature <span class="bcp14">MAY</span> be a Certificate Signing Request as specified in <span>[<a href="#RFC2314" class="xref">RFC2314</a>]</span>.<a href="#section-4.1-8" class="pilcrow">¶</a></p>
<p id="section-4.1-9">Relying parties <span class="bcp14">MUST NOT</span> accept signatures purporting to be aggregate signatures under ad-hoc collections of public keys as proof of the involvement of the signers.<a href="#section-4.1-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-using-key-splitting">
<section id="section-4.2">
        <h3 id="name-using-key-splitting">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-using-key-splitting" class="section-name selfRef">Using key splitting</a>
        </h3>
<p id="section-4.2-1">To divide a keypair {A, p} into n parts, we begin by generating n-1 key pairs according to the method described in <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">To calculate the final secret scalar share s<sub>n</sub> we begin by calculating the secret scalar value s corresponding to the master private key p and the key shares s<sub>1</sub>, s<sub>2</sub>, ..., s<sub>n-1</sub>. The final secret scalar is given by:<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2-3">s<sub>n</sub> = s - s<sub>1</sub>, s<sub>2</sub>, ..., s<sub>n-1</sub><a href="#section-4.2-3" class="pilcrow">¶</a></p>
<p id="section-4.2-4">Since the final secret scalar is not derived from a private key by means of a digest, it is not possible to use <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span> format to store keys. The format described in <span>[<a href="#draft-hallambaker-threshold" class="xref">draft-hallambaker-threshold</a>]</span> is used instead.<a href="#section-4.2-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="n-quorate-signature">
<section id="section-5">
      <h2 id="name-quorate-signature">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-quorate-signature" class="section-name selfRef">Quorate Signature</a>
      </h2>
<p id="section-5-1">Constructing the set of secret scalar key shares using the Shamir secret sharing scheme allows a signature scheme in which the threshold of signers t required to create a signature is smaller than the number of key shares n.<a href="#section-5-1" class="pilcrow">¶</a></p>
<div id="n-key-generation">
<section id="section-5.1">
        <h3 id="name-key-generation">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-key-generation" class="section-name selfRef">Key Generation</a>
        </h3>
<p id="section-5.1-1">The key generation process begins with the generation of a master signature key {A, p}. The private key p is used to calculate the secret scalar value s according to the procedure specified in <a href="#key-generation" class="xref">Section 4.1</a> above.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">The secret scalar is then divided as follows.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1-3">First, we construct a polynomial of degree t in the modular field L, where L is the order of the curve sub-group:<a href="#section-5.1-3" class="pilcrow">¶</a></p>
<p id="section-5.1-4">f(x) = a<sub>0</sub> + a<sub>1</sub>.x + a<sub>2</sub>.x<sup>2</sup> + ... a<sub>t</sub>.x<sup>t</sup> mod L<a href="#section-5.1-4" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-5.1-5">
          <dt id="section-5.1-5.1">where</dt>
          <dd id="section-5.1-5.2">
            <p id="section-5.1-5.2.1">a<sub>0</sub> = s<a href="#section-5.1-5.2.1" class="pilcrow">¶</a></p>
<p id="section-5.1-5.2.2">a<sub>1</sub> ... a<sub>t</sub> are randomly chosen integers in the range 1  a<sub>i</sub>  L<a href="#section-5.1-5.2.2" class="pilcrow">¶</a></p>
</dd>
</dl>
<p id="section-5.1-6">The values of the key shares are the values <em>f</em>(x<sub>1</sub>), <em>f</em>(x<sub>2</sub>), ... ,<em> f</em>(x<sub>n</sub>). That is<a href="#section-5.1-6" class="pilcrow">¶</a></p>
<p id="section-5.1-7">p<sub>i</sub> = <em>f</em>(x<sub>i</sub>)<a href="#section-5.1-7" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-5.1-8">
          <dt id="section-5.1-8.1">where</dt>
          <dd id="section-5.1-8.2">
            <p id="section-5.1-8.2.1">p<sub>1</sub> ... p<sub>n</sub> are the private key shares<a href="#section-5.1-8.2.1" class="pilcrow">¶</a></p>
<p id="section-5.1-8.2.2">x<sub>1</sub> ... x<sub>n</sub> are distinct integers in the range 1  x<sub>i</sub>  L<a href="#section-5.1-8.2.2" class="pilcrow">¶</a></p>
</dd>
</dl>
<p id="section-5.1-9">The means of constructing distinct values x<sub>1</sub> ... x<sub>n</sub> is left to the implementation. It is not necessary for these values to be secret.<a href="#section-5.1-9" class="pilcrow">¶</a></p>
<p id="section-5.1-10">As with the final secret scalar value above, it is not possible to use <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span> format to store keys. The format described in <span>[<a href="#draft-hallambaker-threshold" class="xref">draft-hallambaker-threshold</a>]</span> is used instead.<a href="#section-5.1-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-calculating-the-secret-scalar-value">
<section id="section-5.2">
        <h3 id="name-calculating-the-secret-scal">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-calculating-the-secret-scal" class="section-name selfRef">Calculating the secret scalar value</a>
        </h3>
<p id="section-5.2-1">The value of the secret scalar value used to create a signature depends on the specific choice of signature shares used to construct it. Since the numbering of the key shares is arbitrary, we choose the set of signers {1, 2, ... , t}.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">Lagrange polynomials are used to compute a set of coeficients l<sub>1</sub>, l<sub>2</sub>, ... l<sub>t</sub> such that<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2-3">s = a<sub>0</sub> = l<sub>1</sub>p<sub>1</sub> + l<sub>2</sub>p<sub>2</sub> + ... + l<sub>t</sub>p<sub>t</sub><a href="#section-5.2-3" class="pilcrow">¶</a></p>
<p id="section-5.2-4">The value of the secret scalars s<sub>1</sub> + s<sub>2</sub> + ... + s<sub>n</sub> are thus given by<a href="#section-5.2-4" class="pilcrow">¶</a></p>
<p id="section-5.2-5">s<sub>i</sub> = l<sub>i</sub>p<sub>i</sub><a href="#section-5.2-5" class="pilcrow">¶</a></p>
<p id="section-5.2-6">The coordinator identifies the signers to participate in the signature event and uses the set of x coordinates corresponding to their key shares to calculate the corresponding Lagrange coefficient li for each as described in <span>[<a href="#draft-hallambaker-mesh-udf" class="xref">draft-hallambaker-mesh-udf</a>]</span>.<a href="#section-5.2-6" class="pilcrow">¶</a></p>
<p id="section-5.2-7">[Note: The discussion of Shamir Secret Sharing should probably be moved from its current location in <span>[<a href="#draft-hallambaker-mesh-udf" class="xref">draft-hallambaker-mesh-udf</a>]</span> to either this document or the base document <span>[<a href="#draft-hallambaker-threshold" class="xref">draft-hallambaker-threshold</a>]</span>. Which document is better suited will depend on whether it is decided to implement (n,k) threshold signatures and/or key escrow of elliptic curve scalar secrets.]<a href="#section-5.2-7" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="n-test-vectors">
<section id="section-6">
      <h2 id="name-test-vectors">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-test-vectors" class="section-name selfRef">Test Vectors</a>
      </h2>
<div id="n--unanimous-threshold-signature-ed25519-">
<section id="section-6.1">
        <h3 id="name-unanimous-threshold-signatu">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-unanimous-threshold-signatu" class="section-name selfRef">Unanimous Threshold Signature Ed25519</a>
        </h3>
<p id="section-6.1-1">The signers are Alice and Bob. Each creates a key pair:<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<div id="section-6.1-2">
<pre class="sourcecode">ED25519Alice's Key (ED25519)
    UDF:        ZAAA-GTSI-GXED-255X-XALI-CEXS-XKEY
    Scalar:     56271244081186130980636545017945156580516101894352492
        459594967614223399428880
    Encoded Private
  33 40 0E 22  D8 67 17 F4  8A 9F 6A 46  61 B4 0E AD
  8C D0 DD C3  79 CD 85 BD  95 5C 90 B9  6C CB 8C 23
    X: 11116793672970427161790264469280294507189044728140547954071022
        7976454124042406369344932655633664630560242213431409139866940
        284702002648469365756492647970
    Y: 61655404171611396573021808119108664749574235125343680206454285
        6299141386615046548323087409388548650272224487089895079970526
        0143544115364878870129761259200
    Encoded Public
  E2 AB 8F 37  62 C8 7B F9  E9 BC 59 0C  2E 99 A5 58
  0C C3 19 D5  CD DA 53 DF  3E C1 F0 C0  FE D3 55 5E
ED25519Bob's Key (ED25519)
    UDF:        ZAAA-GTSI-G2ED-255X-XBOB-XSXK-EY
    Scalar:     54940772670153459146152925564198105262971485730889818
        986727608573229799020168
    Encoded Private
  68 9A 68 92  8A 06 17 84  35 3C B7 08  F8 56 00 3F
  BA 31 8C 42  B0 42 FE 2D  18 F2 7F AB  CD 10 49 F1
    X: 14271495069349838216379540196263140964032393512903842206168182
        5518850827098876289800868735522232908519794251130907125878675
        6343411484065706313568410880015
    Y: 28094328948004112428189466223757440886388684291254605355859923
        6240968229706795825282419594219442074647093851302547452470435
        9438513477629978601366725015573
    Encoded Public
  32 E5 8D 5E  66 B2 F9 E9  14 79 08 71  96 3B 9A 75
  A2 31 59 4B  8E ED 18 EF  BD FF 11 D4  47 2A 8C F4</pre><a href="#section-6.1-2" class="pilcrow">¶</a>
</div>
<p id="section-6.1-3">The Aggregate Signature Key A = A<sub>a</sub> + A<sub>b</sub><a href="#section-6.1-3" class="pilcrow">¶</a></p>
<div id="section-6.1-4">
<pre class="sourcecode">Aggregate Key = Alice + Bob ()
    UDF:        TBS
    Scalar:     26569330913556569171916721364983482306308422345436973
        56293312113171384684213
    Encoded Private
  B5 CE 0E B3  9C CF 18 99  CF 8D 4C BB  AE 81 79 1F
  CE 13 AA 3E  63 59 5B AC  8D 2C EB A4  55 C5 DF 05
    X: 67872685043898469012456949773240814121645904736114813455820339
        8688906486811443744733724675994181258029547346985079901494367
        752381127781166234556148580090
    Y: 36481740058369645484420180976004932062085375941522344052907594
        0118552792158551197107484892204562290802810655253510302448455
        4128548992118101415797909250954
    Encoded Public
  29 65 63 86  4F FB 10 8D  BA 7A 0A 68  04 6D 00 DA
  9B 1D C3 A4  AF BA 95 B4  5D 27 B4 35  00 2F DF 32</pre><a href="#section-6.1-4" class="pilcrow">¶</a>
</div>
<p id="section-6.1-5">To sign the text "This is a test", Alice and Bob first generate their values r which they multiply by the base point to obtain the value R<sub>i</sub>:<a href="#section-6.1-5" class="pilcrow">¶</a></p>
<div id="section-6.1-6">
<pre class="sourcecode">Alice:
r_a =  63604859197442869293148706887422539627692219221403898700132668
    2121229168067
R_a =  System.Byte[]

Bob:
r_a =  90588289213224300609691011367428583037027596393781713986313426
    4309321564224
R_a =  System.Byte[]</pre><a href="#section-6.1-6" class="pilcrow">¶</a>
</div>
<p id="section-6.1-7">The aggregate value R = R<sub>a</sub> + R<sub>b</sub><a href="#section-6.1-7" class="pilcrow">¶</a></p>
<div id="section-6.1-8">
<pre class="sourcecode">R =
  FB 4A B1 B4  53 C4 90 54  C4 F3 FD 00  87 AE EF 3D
  33 CE 2B 5B  F2 88 DB 13  FD F7 28 67  26 EE 07 1F</pre><a href="#section-6.1-8" class="pilcrow">¶</a>
</div>
<p id="section-6.1-9">The value k is calculated<a href="#section-6.1-9" class="pilcrow">¶</a></p>
<div id="section-6.1-10">
<pre class="sourcecode">k =  4033579620745134235581641900982768938545463892767267607223155591
    591374371726</pre><a href="#section-6.1-10" class="pilcrow">¶</a>
</div>
<p id="section-6.1-11">Alice and Bob both calculate their signature scalar contribution:<a href="#section-6.1-11" class="pilcrow">¶</a></p>
<div id="section-6.1-12">
<pre class="sourcecode">Alice:
S_a =  66555407144639732988508254705363964829787697756754631094914457
    8662199168944

Bob:
S_b =  14755481297036888929325321941188765612781723011853930571004511
    25046339648114</pre><a href="#section-6.1-12" class="pilcrow">¶</a>
</div>
<p id="section-6.1-13">The coordinator calculates the aggregate value S = S<sub>a</sub> + S<sub>b</sub><a href="#section-6.1-13" class="pilcrow">¶</a></p>
<div id="section-6.1-14">
<pre class="sourcecode">S =  2141102201150086222817614741172516209576049278752939368049595703
    708538817058</pre><a href="#section-6.1-14" class="pilcrow">¶</a>
</div>
<p id="section-6.1-15">The coordinator checks to see that the signature verifies:<a href="#section-6.1-15" class="pilcrow">¶</a></p>
<div id="section-6.1-16">
<pre class="sourcecode">S.B = R + kA =
    X: 20168784599297644264752251999842912626695351875278949808545814
        238064903547119
    Y: 17798208503807446200181400098695224792791795831502230059016274
        558554804974562</pre><a href="#section-6.1-16" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="n--unanimous-threshold-signature-ed448-">
<section id="section-6.2">
        <h3 id="name-unanimous-threshold-signatur">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-unanimous-threshold-signatur" class="section-name selfRef">Unanimous Threshold Signature Ed448</a>
        </h3>
<p id="section-6.2-1">The signers are Alice and Bob. Each creates a key pair:<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<div id="section-6.2-2">
<pre class="sourcecode">ED448Alice's Key (ED448)
    UDF:        ZAAA-ITSI-GXED-44XA-LICE-XSXK-EY
    Scalar:     63495803583658817688110446314786076976347236361354035
        5597788771064742993095132758589292255654895141583596922516472
        738879360490167934280
    Encoded Private
  A0 53 4C 93  3C 34 00 76  AE 5D B5 4A  C2 71 5F 43
  E1 D6 63 2C  5C 56 53 C8  98 A0 8F 03  FF F5 22 96
  91 45 8C 2B  CF E3 FD 7E  2A 9E 0B D6  F4 CC 66 61
  43 62 72 7B  34 B4 79 92
    X: 24743197509267833262111449556527285120868167712209919570838426
        3466168536901525943558973091346360088759980994772668117646359
        614426660579
    Y: 21342899120576770537664462049685258390853729788303428349051130
        8752175233505795318243164692156369495328007220135137156078814
        081547431302
    Encoded Public
  0A 3B F3 27  E7 E1 67 63  2C 59 E2 1C  D1 84 C7 83
  E8 1E D1 68  9F 32 A1 16  99 00 5C DA  29 B9 6C 08
  E4 15 57 7E  E5 63 C2 32  08 23 41 68  5F 49 1F FF
  BC 4D CD 3A  4E A6 85 49  00
ED448Bob's Key (ED448)
    UDF:        ZAAA-ITSI-G2ED-44XB-OBXS-XKEY
    Scalar:     72649803773199751564998543891898904839718409312910780
        0262041941160989643727331987658132182181970054245587322070535
        846720571414845714224
    Encoded Private
  BC 53 B4 74  3E A7 A7 FA  9F 05 9A BC  8C 22 26 15
  A1 4E BB 10  0E B5 59 6B  DE 9C 1B E9  F2 3C 65 42
  E7 B4 47 18  60 AC 18 A6  D2 78 B8 BC  CE F5 F4 28
  B2 3A FF 08  61 EF 6B 7C
    X: 58235851934808640621920816872959059172692411187640950432203039
        8116748997750134460231406698091317008063030408798536634284207
        667468558264
    Y: 34390767697909283892495761259186538632120422458392131201372282
        6056455656591826216381185634080685718154852726725624178995827
        091591132128
    Encoded Public
  93 63 5A 45  2D 4C 94 32  45 23 CD E2  A8 46 E4 78
  A0 80 59 DA  36 CB 6B 0C  06 64 6F BE  51 AB C0 BF
  1E DB A8 3F  2B 3B 80 0F  BF 00 E6 78  DD E0 83 E9
  AC 20 02 55  87 07 39 38  00</pre><a href="#section-6.2-2" class="pilcrow">¶</a>
</div>
<p id="section-6.2-3">The Aggregate Signature Key A = A<sub>a</sub> + A<sub>b</sub><a href="#section-6.2-3" class="pilcrow">¶</a></p>
<div id="section-6.2-4">
<pre class="sourcecode">Aggregate Key = Alice + Bob ()
    UDF:        TBS
    Scalar:     89488306051273634069773238262841883041784075539841550
        3672228636597106090916876462340541507950185640860121886233669
        49466515613996100051
    Encoded Private
  D3 29 DD AB  F6 0D 99 8B  75 65 B8 06  36 C9 3A 2C
  D4 08 C3 9B  7C F9 77 8C  68 29 0E 3D  5D C7 3E 00
  92 8B DC AE  26 FB 16 39  CD 25 1B 23  4A 5A 05 61
  1D 5C C4 70  0A C9 84 1F
    X: 17985659098670117617173315763082238685735647626871251468000984
        2080317111091696183607307614171726960576308774975742249260532
        199160570999
    Y: 31506323224859159594386181995639405170623657273945727288760063
        1624406694682617334725040181287905351066763414658543828623841
        509161975864
    Encoded Public
  9B 3E DF 49  55 40 9F 7B  EA 0B AA 40  B7 3D 15 82
  60 9F 7C 40  CF 67 DE 56  56 0D 03 87  63 3B 15 F2
  45 33 FE 48  BD 2D A0 A2  8B CC 74 DA  94 0F 39 00
  AC 39 CB 0A  9F A4 EB B0  00</pre><a href="#section-6.2-4" class="pilcrow">¶</a>
</div>
<p id="section-6.2-5">To sign the text "This is a test", Alice and Bob first generate their values r which they multiply by the base point to obtain the value R<sub>i</sub>:<a href="#section-6.2-5" class="pilcrow">¶</a></p>
<div id="section-6.2-6">
<pre class="sourcecode">Alice:
r_a =  73759418290054794861373572858566288781619358129342401750774507
    86228048858000588481919454774928817062768941685761418007593280530
    2999804
R_a =  System.Byte[]

Bob:
r_a =  46237963278513215322396148050034865586946889704122042348536832
    25811783723521941968309643248450810747601167927994249458319388189
    6018677
R_a =  System.Byte[]</pre><a href="#section-6.2-6" class="pilcrow">¶</a>
</div>
<p id="section-6.2-7">The aggregate value R = R<sub>a</sub> + R<sub>b</sub><a href="#section-6.2-7" class="pilcrow">¶</a></p>
<div id="section-6.2-8">
<pre class="sourcecode">R =
  A0 FF BC 4A  92 40 39 FE  A3 E2 98 19  8A CB 60 54
  65 E1 EF C5  3E E2 AA 54  8D 27 78 CB  F8 34 DC E2
  9C DF A0 D7  F1 D2 7F EA  33 A2 A7 07  76 29 A1 7C
  EB D4 97 F1  A3 CE 0B 61  80</pre><a href="#section-6.2-8" class="pilcrow">¶</a>
</div>
<p id="section-6.2-9">The value k is calculated<a href="#section-6.2-9" class="pilcrow">¶</a></p>
<div id="section-6.2-10">
<pre class="sourcecode">k =  4253302316461679481082434282193340085469714728082631996749509171
    36528863341161130189337827407821840447093029569242109238035123293
    90659</pre><a href="#section-6.2-10" class="pilcrow">¶</a>
</div>
<p id="section-6.2-11">Alice and Bob both calculate their signature scalar contribution:<a href="#section-6.2-11" class="pilcrow">¶</a></p>
<div id="section-6.2-12">
<pre class="sourcecode">Alice:
S_a =  98531765382438321188310203252700171214078910507928709174117939
    03719918811956876581076180944672089155783210289818359855928311296
    3570131

Bob:
S_b =  10826185029558642533243398893637670455024435365016467182849367
    92853602994592020853268312315426021226313042112304897550405147626
    03231952</pre><a href="#section-6.2-12" class="pilcrow">¶</a>
</div>
<p id="section-6.2-13">The coordinator calculates the aggregate value S = S<sub>a</sub> + S<sub>b</sub><a href="#section-6.2-13" class="pilcrow">¶</a></p>
<div id="section-6.2-14">
<pre class="sourcecode">S =  2508393460412302388341324021707574217591292398626386593223906852
    74134836172312654213972856976306382258260204195816912950241197071
    52304</pre><a href="#section-6.2-14" class="pilcrow">¶</a>
</div>
<p id="section-6.2-15">The coordinator checks to see that the signature verifies:<a href="#section-6.2-15" class="pilcrow">¶</a></p>
<div id="section-6.2-16">
<pre class="sourcecode">S.B = R + kA =
    X: 87229317542997013818252634997777965098763712747235444768375375
        25263195569863
    Y: 48426719549368988040047207185774675871089544448034802040243984
        177418779288237</pre><a href="#section-6.2-16" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="n--quorate-threshold-signature-ed25519-">
<section id="section-6.3">
        <h3 id="name-quorate-threshold-signature">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-quorate-threshold-signature" class="section-name selfRef">Quorate Threshold Signature Ed25519</a>
        </h3>
<p id="section-6.3-1">The administrator creates the aggregate key pair<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<div id="section-6.3-2">
<pre class="sourcecode">ED25519Aggregate Key (ED25519)
    UDF:        ZAAA-GTSI-GQED-255X-XAGG-REGA-TEXK-EY
    Scalar:     39348647608109113656999806950437958090469802387424444
        589375066079861075223816
    Encoded Private
  37 39 5E 7A  8B A5 A0 19  46 4B 58 22  EA 24 A5 71
  45 2C 2A AC  7A 3E FB CA  CE 3F D4 12  9A BA EB 70
    X: 14198837758377867455716504277518729070915183249890461230792115
        9904969716778427995951234766002164511738587575257530388758374
        7824906047250057721855068523970
    Y: 20211025649802071998810413948266748565975140520947927724517956
        2067625505077751598018629551746824533726709810990193455662385
        6152736116303441031851305458040
    Encoded Public
  6E 13 79 B4  39 DA 97 9C  5A 34 CE 79  CD 1B 50 DF
  A0 76 AD 49  81 6D 52 59  A4 2C DB CE  44 FF 3E F5</pre><a href="#section-6.3-2" class="pilcrow">¶</a>
</div>
<p id="section-6.3-3">Three key shares are required for Alice, Bob and Carol with a threshold of two.  The parameters of the Shamir Secret Sharing polynomial are:<a href="#section-6.3-3" class="pilcrow">¶</a></p>
<div id="section-6.3-4">
<pre class="sourcecode">a0 = 3934864760810911365699980695043795809046980238742444458937506607
    9861075223816
a1 = 6478235074936669232922546709062853526800747723284435893560379998
    498854036401</pre><a href="#section-6.3-4" class="pilcrow">¶</a>
</div>
<p id="section-6.3-5">The key share values for the participants are<a href="#section-6.3-5" class="pilcrow">¶</a></p>
<div id="section-6.3-6">
<pre class="sourcecode">xa = 1
ya = 2404849219052209606083234281242846172127851954429434846923740448
    647203754283

xb = 2
yb = 1646078716656616625032594427262705458071483318333963134482169508
    860603539695

xc = 3
yc = 8873082142610236439819545732825647440151146822384914220405985690
    74003325107</pre><a href="#section-6.3-6" class="pilcrow">¶</a>
</div>
<p id="section-6.3-7">Alice and Carol are selected to sign the message "This is another test"<a href="#section-6.3-7" class="pilcrow">¶</a></p>
<p id="section-6.3-8">The Lagrange coefficients are:<a href="#section-6.3-8" class="pilcrow">¶</a></p>
<div id="section-6.3-9">
<pre class="sourcecode">la = 3618502788666131106986593281521497120428558179689953803000975469
    142727125496
lc = 3618502788666131106986593281521497120428558179689953803000975469
    142727125494</pre><a href="#section-6.3-9" class="pilcrow">¶</a>
</div>
<p id="section-6.3-10">Alice and Carol select their values ra, rc<a href="#section-6.3-10" class="pilcrow">¶</a></p>
<div id="section-6.3-11">
<pre class="sourcecode">ra = 5467990291185231529722642292282910677180928186673090898286725351
    703148584114
Ra = System.Byte[]

rc = 3842295179874978910349644562407562715869337917437976620141371939
    137906271828
Rc = System.Byte[]</pre><a href="#section-6.3-11" class="pilcrow">¶</a>
</div>
<p id="section-6.3-12">The aggregate value R = R<sub>a</sub> + R<sub>c</sub><a href="#section-6.3-12" class="pilcrow">¶</a></p>
<div id="section-6.3-13">
<pre class="sourcecode">R =
  B1 23 76 E0  38 C5 15 2A  B4 0F AB E2  FA 0C AC 81
  D0 34 28 B7  13 14 75 A2  29 08 3C C0  62 3B 97 2D</pre><a href="#section-6.3-13" class="pilcrow">¶</a>
</div>
<p id="section-6.3-14">The value k is<a href="#section-6.3-14" class="pilcrow">¶</a></p>
<div id="section-6.3-15">
<pre class="sourcecode">k = 24387631527158770388984723649123275410144206977564237560989138844
    76357243053</pre><a href="#section-6.3-15" class="pilcrow">¶</a>
</div>
<p id="section-6.3-16">The values R and k (or the document to be signed) and the  Lagrange coefficients are passed to Alice and Carol who use them to  calculate their secret scalar values:<a href="#section-6.3-16" class="pilcrow">¶</a></p>
<div id="section-6.3-17">
<pre class="sourcecode">sa = 7225776617244445516111444703385766378620336111334106073386586142
    113532756919;
sc = 3174848681535619284995615994880214748421000838570708091980676184
    605725462941</pre><a href="#section-6.3-17" class="pilcrow">¶</a>
</div>
<p id="section-6.3-18">The signature contributions can now be calulated:<a href="#section-6.3-18" class="pilcrow">¶</a></p>
<div id="section-6.3-19">
<pre class="sourcecode">Sa = 5258509372798138258048339062398668871787395474915394506826958407
    016143211994
Sc = 2369087102951219635858054121785113036716245524183189984191118268
    317926650670</pre><a href="#section-6.3-19" class="pilcrow">¶</a>
</div>
<p id="section-6.3-20">The coordinator calculates the aggregate value S = S<sub>a</sub> + S<sub>b</sub><a href="#section-6.3-20" class="pilcrow">¶</a></p>
<div id="section-6.3-21">
<pre class="sourcecode">S =  3905908984170956799332066211407876676465246397186768850161257370
    48615611675</pre><a href="#section-6.3-21" class="pilcrow">¶</a>
</div>
<p id="section-6.3-22">The coordinator checks to see that the signature verifies:<a href="#section-6.3-22" class="pilcrow">¶</a></p>
<div id="section-6.3-23">
<pre class="sourcecode">S.B = R + kA =
    X: 44137199296357774791154193859950611817340233105447413062332736
        902705770844448
    Y: 29688538012678578878269116100526571773188243259702429043049505
        096610475369173</pre><a href="#section-6.3-23" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="n--quorate-threshold-signature-ed448-">
<section id="section-6.4">
        <h3 id="name-quorate-threshold-signature-">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-quorate-threshold-signature-" class="section-name selfRef">Quorate Threshold Signature Ed448</a>
        </h3>
<p id="section-6.4-1">The administrator creates the aggregate key pair<a href="#section-6.4-1" class="pilcrow">¶</a></p>
<div id="section-6.4-2">
<pre class="sourcecode">ED448Aggregate Key (ED448)
    UDF:        ZAAA-ITSI-GQED-44XA-GGRE-GATE-XKEY
    Scalar:     50890460656419721531273587958284096015810982760541575
        4207268050539683337837216003977228732536078674802149039736292
        653681850024283019712
    Encoded Private
  78 22 7E 3B  89 95 80 5D  04 19 DC 27  F1 7F 9B E4
  86 2B 0B DD  55 64 EE 04  19 49 4D DE  B9 04 3B 9E
  8B 7D DC EC  EC 8F DD 1D  E7 88 86 FD  11 FD 78 EF
  1A 8B 84 8F  77 00 73 65
    X: 44109173355278142669484438370724914685176368933547176239809629
        7503768465595321590690311221269514682222687386378631457535068
        446135118173
    Y: 53219402718535721212460981200104434180077825188675868294070079
        5084662920552823356888138706016038637934794839496624474125511
        419755284720
    Encoded Public
  43 61 20 A0  B1 DF AA BD  6B 55 00 97  A3 BE CB B8
  09 57 20 88  16 69 E4 B9  E1 7E 9C 13  C0 41 5B CB
  4D 3E E4 99  2E 2D 48 89  1C C0 FB 26  58 C2 DD 5C
  C1 DC 17 82  D7 A0 43 EE  80</pre><a href="#section-6.4-2" class="pilcrow">¶</a>
</div>
<p id="section-6.4-3">Three key shares are required for Alice, Bob and Carol with a threshold of two.  The parameters of the Shamir Secret Sharing polynomial are:<a href="#section-6.4-3" class="pilcrow">¶</a></p>
<div id="section-6.4-4">
<pre class="sourcecode">a0 = 0
a1 = 3230310441090132544881502506497842088200690521964525360879407271
    94765745753141655224661941966620396823169163035586912417623145586
    91569</pre><a href="#section-6.4-4" class="pilcrow">¶</a>
</div>
<p id="section-6.4-5">The key share values for the participants are<a href="#section-6.4-5" class="pilcrow">¶</a></p>
<div id="section-6.4-6">
<pre class="sourcecode">xa = 1
ya = 3230310441090132544881502506497842088200690521964525360879407271
    94765745753141655224661941966620396823169163035586912417623145586
    91569

xb = 2
yb = 6460620882180265089763005012995684176401381043929050721758814543
    89531491506283310449323883933240793646338326071173824835246291173
    83138

xc = 3
yc = 9690931323270397634644507519493526264602071565893576082638221815
    84297237259424965673985825899861190469507489106760737252869436760
    74707</pre><a href="#section-6.4-6" class="pilcrow">¶</a>
</div>
<p id="section-6.4-7">Alice and Carol are selected to sign the message "This is another test"<a href="#section-6.4-7" class="pilcrow">¶</a></p>
<p id="section-6.4-8">The Lagrange coefficients are:<a href="#section-6.4-8" class="pilcrow">¶</a></p>
<div id="section-6.4-9">
<pre class="sourcecode">la = 9085484053695086131866547598600056679420517008591475753518627489
    75730019807697928580978776458461879816551468545458311523868779298
    24891
lc = 9085484053695086131866547598600056679420517008591475753518627489
    75730019807697928580978776458461879816551468545458311523868779298
    24889</pre><a href="#section-6.4-9" class="pilcrow">¶</a>
</div>
<p id="section-6.4-10">Alice and Carol select their values ra, rc<a href="#section-6.4-10" class="pilcrow">¶</a></p>
<div id="section-6.4-11">
<pre class="sourcecode">ra = 9916409373832855445680225409665819204694890272466243758088723611
    70412660541692764122871086733859409013013307204388508168153245726
    71888
Ra = System.Byte[]

rc = 1073609511703983208477950323599584281909008734279687416788909134
    22950735978683478421395579947183492087041733558644230420650276766
    461770
Rc = System.Byte[]</pre><a href="#section-6.4-11" class="pilcrow">¶</a>
</div>
<p id="section-6.4-12">The aggregate value R = R<sub>a</sub> + R<sub>c</sub><a href="#section-6.4-12" class="pilcrow">¶</a></p>
<div id="section-6.4-13">
<pre class="sourcecode">R =
  30 A1 B3 17  69 AB 99 0E  57 5E 0B A5  2E 51 72 C0
  BA 31 35 39  51 7C 83 B8  22 01 9F 85  45 93 9B 54
  19 A2 FA FD  34 7A CA 88  7D 05 52 A6  21 5C E0 B7
  69 62 F4 94  6C 15 C3 11  80</pre><a href="#section-6.4-13" class="pilcrow">¶</a>
</div>
<p id="section-6.4-14">The value k is<a href="#section-6.4-14" class="pilcrow">¶</a></p>
<div id="section-6.4-15">
<pre class="sourcecode">k = 10235373755332719753132453070965244233375545860969817073088585850
    34984308611997081872546544930901042673608404328479261067005777756
    07973</pre><a href="#section-6.4-15" class="pilcrow">¶</a>
</div>
<p id="section-6.4-16">The values R and k (or the document to be signed) and the  Lagrange coefficients are passed to Alice and Carol who use them to  calculate their secret scalar values:<a href="#section-6.4-16" class="pilcrow">¶</a></p>
<div id="section-6.4-17">
<pre class="sourcecode">sa = 1393094971533028494918880135834681981172155279153826379483773839
    76787863843741041141797168940839247505130521309883868015030349767
    862243;
sc = 4240018392059887314544293838853293547119481225644687712199516581
    83581401177985445743985863508531284581797723992077942897434060917
    87536</pre><a href="#section-6.4-17" class="pilcrow">¶</a>
</div>
<p id="section-6.4-18">The signature contributions can now be calulated:<a href="#section-6.4-18" class="pilcrow">¶</a></p>
<div id="section-6.4-19">
<pre class="sourcecode">Sa = 1176422144911387757819650694682546452875900733977789124175969611
    96064995455877990887534924392638074098909532952322658866770310075
    667839
Sc = 1261695317878032144403764439936251221873899581791569343175257655
    85463382113907822175563223482227224266776195506309879565242141085
    378620</pre><a href="#section-6.4-19" class="pilcrow">¶</a>
</div>
<p id="section-6.4-20">The coordinator calculates the aggregate value S = S<sub>a</sub> + S<sub>b</sub><a href="#section-6.4-20" class="pilcrow">¶</a></p>
<div id="section-6.4-21">
<pre class="sourcecode">S =  6210206520504026758501056148987863388656969140510633166475017698
    63823736082462273469023925831729224023754347495408761272386953013
    96680</pre><a href="#section-6.4-21" class="pilcrow">¶</a>
</div>
<p id="section-6.4-22">The coordinator checks to see that the signature verifies:<a href="#section-6.4-22" class="pilcrow">¶</a></p>
<div id="section-6.4-23">
<pre class="sourcecode">S.B = R + kA =
    X: 41458922531347602467333936260245029252955857925674064823925020
        498684283758735
    Y: 46892836594134893138380416498249507660693894634845371281694628
        683354340901899</pre><a href="#section-6.4-23" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="n-security-considerations">
<section id="section-7">
      <h2 id="name-security-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-7-1">TBS.<a href="#section-7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-iana-considerations">
<section id="section-8">
      <h2 id="name-iana-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-8-1">This document requires no IANA actions.<a href="#section-8-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-acknowledgements">
<section id="section-9">
      <h2 id="name-acknowledgements">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
    </h2>
</section>
</div>
<section id="section-10">
      <h2 id="name-normative-references">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
      </h2>
<dl class="references">
<dt id="draft-hallambaker-mesh-udf">[draft-hallambaker-mesh-udf]</dt>
      <dd>
<span class="refAuthor">Hallam-Baker, P.</span>, <span class="refTitle">"Mathematical Mesh 3.0 Part II: Uniform Data Fingerprint."</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-hallambaker-mesh-udf-07</span>, <time datetime="2019-10-18">18 October 2019</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-hallambaker-mesh-udf-07">https://tools.ietf.org/html/draft-hallambaker-mesh-udf-07</a>&gt;</span>. </dd>
<dt id="draft-hallambaker-threshold">[draft-hallambaker-threshold]</dt>
      <dd>
<span class="refTitle">"[Reference Not Found!]"</span>, <time></time>. </dd>
<dt id="RFC2119">[RFC2119]</dt>
      <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dt id="RFC8032">[RFC8032]</dt>
    <dd>
<span class="refAuthor">Josefsson, S.</span><span class="refAuthor"> and I. Liusvaara</span>, <span class="refTitle">"Edwards-Curve Digital Signature Algorithm (EdDSA)"</span>, <span class="seriesInfo">RFC 8032</span>, <span class="seriesInfo">DOI 10.17487/RFC8032</span>, <time datetime="2017-01">January 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8032">https://www.rfc-editor.org/rfc/rfc8032</a>&gt;</span>. </dd>
</dl>
</section>
<section id="section-11">
      <h2 id="name-informative-references">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
      </h2>
<dl class="references">
<dt id="draft-hallambaker-mesh-developer">[draft-hallambaker-mesh-developer]</dt>
      <dd>
<span class="refAuthor">Hallam-Baker, P.</span>, <span class="refTitle">"Mathematical Mesh: Reference Implementation"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-hallambaker-mesh-developer-09</span>, <time datetime="2019-10-23">23 October 2019</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-hallambaker-mesh-developer-09">https://tools.ietf.org/html/draft-hallambaker-mesh-developer-09</a>&gt;</span>. </dd>
<dt id="RFC2314">[RFC2314]</dt>
    <dd>
<span class="refAuthor">Kaliski, B.</span>, <span class="refTitle">"PKCS #10: Certification Request Syntax Version 1.5"</span>, <span class="seriesInfo">RFC 2314</span>, <span class="seriesInfo">DOI 10.17487/RFC2314</span>, <time datetime="1998-03">March 1998</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2314">https://www.rfc-editor.org/rfc/rfc2314</a>&gt;</span>. </dd>
</dl>
</section>
<script>var toc = document.getElementById("toc");
var tocToggle = toc.querySelector("h2");
var tocNav = toc.querySelector("nav");

// mobile menu toggle
tocToggle.onclick = function(event) {
    if (window.innerWidth < 1024) {
 var tocNavDisplay = tocNav.currentStyle ? tocNav.currentStyle.display : getComputedStyle(tocNav, null).display;
 if (tocNavDisplay == "none") {
     tocNav.style.display = "block";
 } else {
     tocNav.style.display = "none";
 }
    }
}

// toc anchor scroll to anchor
tocNav.addEventListener("click", function (event) {
    event.preventDefault();
    if (event.target.nodeName == 'A') {
 if (window.innerWidth < 1024) {
     tocNav.style.display = "none";
 }
 var href = event.target.getAttribute("href");
 var anchorId = href.substr(1);
 var anchor =  document.getElementById(anchorId);
 anchor.scrollIntoView(true);
 window.history.pushState("","",href);
    }
});

// switch toc mode when window resized
window.onresize = function () {
    if (window.innerWidth < 1024) {
 tocNav.style.display = "none";
    } else {
 tocNav.style.display = "block";
    }
}
</script>
</body>
</html>
