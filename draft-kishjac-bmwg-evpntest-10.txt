



Internet Engineering Task Force                            S. Jacob, Ed.
Internet-Draft                                           K. Tiruveedhula
Intended status: Standards Track                        Juniper Networks
Expires: December 26, 2018                                 June 24, 2018


             Benchmarking Methodology for EVPN and PBB-EVPN
                     draft-kishjac-bmwg-evpntest-10

Abstract

   This document defines methodologies for benchmarking EVPN and PBB-
   EVPN performance.  EVPN is defined in RFC 7432, and is being deployed
   in Service Provider networks.  Specifically this document defines the
   methodologies for benchmarking EVPN/PBB-EVPN convergence, data plane
   performance, and control plane performance.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on December 26, 2018.

Copyright Notice

   Copyright (c) 2018 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (https://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.



Jacob & Tiruveedhula    Expires December 26, 2018               [Page 1]

Internet-Draft        EVPN Benchmarking Methodology            June 2018


Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   3
     1.1.  Requirements Language . . . . . . . . . . . . . . . . . .   3
     1.2.  Terminologies . . . . . . . . . . . . . . . . . . . . . .   3
   2.  Test Topology . . . . . . . . . . . . . . . . . . . . . . . .   4
   3.  Test Cases  . . . . . . . . . . . . . . . . . . . . . . . . .   6
     3.1.  How long it takes to learn local mac address in EVPN  . .   6
     3.2.  How long it takes to learn local mac address in PBB EVPN    6
     3.3.  How long it takes to learn the remote macs  . . . . . . .   7
     3.4.  PBB-EVPN How long it takes to learn the mac from remote
           peer  . . . . . . . . . . . . . . . . . . . . . . . . . .   8
     3.5.  How long it takes to flush the local macs due to CE link
           flap and measure the relearning rate of MACs  . . . . . .   8
     3.6.  PBB-EVPN  how long it takes to flush the local macs and
           measure the relearning rate of macs during PE-CE  link
           flap  . . . . . . . . . . . . . . . . . . . . . . . . . .   9
     3.7.  How long it takes to flush the remote macs, due to remote
           link failure. . . . . . . . . . . . . . . . . . . . . . .  10
     3.8.  PBB-EVPN How long it takes to flush the remote macs due
           to remote link failure  . . . . . . . . . . . . . . . . .  10
     3.9.  To measure the MAC aging time.  . . . . . . . . . . . . .  11
     3.10. PBB-EVPN To measure the MAC aging time. . . . . . . . . .  12
     3.11. How long it takes to age out the remote macs  . . . . . .  12
     3.12. PBB-EVPN How long it takes to age out the remote macs.  .  13
     3.13. How long it takes to learn both local and remote macs.  .  14
     3.14. PBB-EVPN How long it takes to learn both local and remote
           macs  . . . . . . . . . . . . . . . . . . . . . . . . . .  14
   4.  High Availability . . . . . . . . . . . . . . . . . . . . . .  15
     4.1.  To Record the whether there is traffic loss due to
           routing engine failover for redundancy test.  . . . . . .  15
     4.2.  PBB-EVPN To Record the whether there is traffic loss due
           to routing engine failover for redundancy test  . . . . .  16
   5.  ARP/ND Scale  . . . . . . . . . . . . . . . . . . . . . . . .  16
     5.1.  To find ARP/ND scale  . . . . . . . . . . . . . . . . . .  16
   6.  Scale . . . . . . . . . . . . . . . . . . . . . . . . . . . .  17
     6.1.  To Measure the scale limit of DUT with trigger (Scale
           without traffic)  . . . . . . . . . . . . . . . . . . . .  17
     6.2.  PBB-EVPN To measure the scale limit with trigger. . . . .  17
     6.3.  To measure the convergence time of DUT with scale and
           traffic.  . . . . . . . . . . . . . . . . . . . . . . . .  18
     6.4.  .PBB-EVPN To measure the convergence time of DUT with
           scale and traffic.  . . . . . . . . . . . . . . . . . . .  19
   7.  SOAK Test . . . . . . . . . . . . . . . . . . . . . . . . . .  19
     7.1.  To Measure the stability of the DUT with scale and
           traffic.  . . . . . . . . . . . . . . . . . . . . . . . .  19
     7.2.  PBB-EVPN to measure the stability of DUT with scale and
           traffic.  . . . . . . . . . . . . . . . . . . . . . . . .  20



Jacob & Tiruveedhula    Expires December 26, 2018               [Page 2]

Internet-Draft        EVPN Benchmarking Methodology            June 2018


   8.  Acknowledgements  . . . . . . . . . . . . . . . . . . . . . .  21
   9.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .  21
   10. Security Considerations . . . . . . . . . . . . . . . . . . .  21
   11. References  . . . . . . . . . . . . . . . . . . . . . . . . .  21
     11.1.  Normative References . . . . . . . . . . . . . . . . . .  21
     11.2.  Informative References . . . . . . . . . . . . . . . . .  21
   Appendix A.  Appendix . . . . . . . . . . . . . . . . . . . . . .  22
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  22

1.  Introduction

   EVPN is defined in RFC 7432, and describes BGP MPLS- based Ethernet
   VPNs (EVPN).  PBB-EVPN is defined in RFC 7623, discusses how Ethernet
   Provider backbone Bridging can be combined with EVPNs to provide a
   new/combined solution.  This draft defines methodologies that can be
   used to benchmark both RFC 7432 and RFC 7623 solutions.  Further,
   this draft provides methodologies for benchmarking the performance of
   EVPN data and control planes, MAC learning, MAC flushing, MAC ageing,
   convergence, high availability, and scale.

1.1.  Requirements Language

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in RFC 2119 [RFC2119].

1.2.  Terminologies

   MHPE Multi homed Provide Edge router.

   RR Route Reflector.

   P Provider Router.

   CE Customer Router/Devices/Switch.

   MHPE2 Multi homed Provider Edge router 2.

   MHPE1 Multi homed Provider Edge router 1.

   SHPE3 Single homed Provider Edge Router 3.

   AA EVPN Terminologies AA All-Active.

   SA EVPN Terminologies SA Single-Active.

   RT Router Tester.




Jacob & Tiruveedhula    Expires December 26, 2018               [Page 3]

Internet-Draft        EVPN Benchmarking Methodology            June 2018


   Sub Interface Each physical Interfaces is subdivided in to Logical
   units.

   EVI EVPN Instances which will be running on sub interface or physical
   port of the provider Edge routers.

   DF Designated Forwarder.

   ESI Ethernet Segment Identifier.

2.  Test Topology

   EVPN/PBB-EVPN Services running on R1, MHPE1 and MHPE2 in Single
   Active Mode:





































Jacob & Tiruveedhula    Expires December 26, 2018               [Page 4]

Internet-Draft        EVPN Benchmarking Methodology            June 2018


                             Topology Diagram


         | [Traffic Generator ] Router Tester  sending layer 2 bi directional traffic sender/receiver
+----------+
|          |
|  R1      |
|          |
+----------+
    |
    |Core link
+----------+
|          |
|  RR      |
|          | Route Reflector/Core router
+----------+-------------|
   |                     |
   |     Core links      |
+----------+       +-----------+
|          |       |    MHPE2  |
|   DUT    |       |           |
|  MHPE1   |       |           |
+----------+       +-----------+
     |    PE-CE link    |
+----------+------------
|          |
|  CE      |
|  layer2  |
|bridge    |
+----------+------------ [Traffic Generator](Router Tester sending bi directional layer 2 traffic with different VLAN sender/receiver)



                             Topology Diagram

                                 Figure 1

   There are five routers in the topology.  R1, RR/P, MHPE1 and MHPE2
   emulating a service provider network.  CE is a customer device
   connected to MHPE1 and MHPE2, it is configured with bridge domains in
   different vlans.  The Router tester is connected to R1 and CE which
   send layer 2 traffic for configured vlans.  MHPE1,MHPE2,RR/P,R1 run
   MPLS.  The EVPN/PBB-EVPN services are running on MHPE1,MHPE2 and R1.
   The MHPE1 acts DUT.  The RT will act as sender and receiver.  The
   measurement will be taken in DUT.






Jacob & Tiruveedhula    Expires December 26, 2018               [Page 5]

Internet-Draft        EVPN Benchmarking Methodology            June 2018


3.  Test Cases

   The following tests are conducted to measure the time taken to learn
   the "X" number of MAC's locally in EVI . The data plane learning of
   MAC will happen locally from connected interface.  The control plane
   learning of MAC is through BGP advertisements from the remote
   PE(SHPE3).  The control plane learning of "X" MAC.  The data plane
   MAC learning can be measured using the parameters defined in RFC 2889
   section 5.8.

3.1.  How long it takes to learn local mac address in EVPN

   Objective:

   To Record the time taken to learn the MAC address locally in DUT.

   Procedure:

   Configure EVPN EVI in R1, MHPE2, DUT.  All 4 routers except CE are
   running MPLS, BGP, RR is acting as route reflector to R1,MHPE2 and
   DUT.  For MH PE ESI must be configured per IFD/Interface.  Using RT
   (traffic generator)to send the traffic to the CE.  The traffic is
   unidirectional.  Since CE is working in bridge mode, frames will be
   send to ingress sub interface of DUT.  The BGP must be established in
   R1, MHPE1(DUT), RR, MHPE2.  Send "X" unicast frames from CE to
   MHPE1(DUT) working in SA mode with "X" different source and
   destination address from RT.  The DUT must learn these "X" macs in
   data plane.

   Measurement :

   Measure the time taken to learn "X" MACs in DUT evpn mac table.  The
   data plane measurement is taken by considering DUT as black box the
   range of X MAC is known from RT and the same must be learned in DUT,
   the time taken to learn "X" macs is measured.

   Repeat these test and plot the data.  The test is repeated for "N"
   times and the values are collected.  The mac learning time is
   calculated by averaging the values obtained from "N" samples.

   Mac learning in sec = (T1+T2+..Tn/N)

3.2.  How long it takes to learn local mac address in PBB EVPN

   Objective:

   To Record the time taken to learn the MAC address locally.




Jacob & Tiruveedhula    Expires December 26, 2018               [Page 6]

Internet-Draft        EVPN Benchmarking Methodology            June 2018


   Procedure:

   Configure PBB-EVPN EVI in R1,MHPE2,DUT.  All 4 routers except CE are
   running MPLS, BGP, RR is acting as route reflector to R1,MHPE2 and
   DUT.  Once the BGP comes up.  Record the DUT PBB-EVPN table.  For MH
   PE ESI must be configured per IFD/Interface.  From RT (traffic
   generator) send the traffic to the DUT.  The BGP must be established
   in R1,MHPE1 (DUT), RR, MHPE2.  The traffic is unidirectional.  Since
   CE is working in bridge mode, frames will be send to ingress sub
   interface of DUT.

   Send "X" unicast frames from CE to MHPE1(DUT) working in SA mode with
   "X" different source and destination address from RT.  The DUT must
   learn "X" macs in data plane.

   Measurement :

   Measure the time taken by the DUT to learn the "X" MACs in the data
   plane.  The data plane measurement is taken by considering DUT as
   black box the range of "X" MAC is known from RT and the same must be
   learned in DUT, the time taken to learn "X" MAC is measured.  Repeat
   these test and plot the data.  The test is repeated for "N" times and
   the values are collected.  The mac learning time is calculated by
   averaging the values obtained from "N" samples.

   Mac learning in sec = (T1+T2+..Tn/N)

3.3.  How long it takes to learn the remote macs

   Objective:

   To Record the time taken to learn the remote macs.

   Procedure:

   Configure EVPN EVI in R1,MHPE2,DUT.  All 4 routers except CE are
   running MPLS,BGP,RR is acting as route reflector to R1,MHPE2 and DUT.
   Record the DUT EVPN table.  For MH PE ESI must be configured per IFD/
   Interface.  Using RT(traffic generator) send the traffic to R1.The
   traffic is uni directional.  There wont be any traffic flow from CE
   to DUT during this test.  The BGP must be in established state.  The
   MACS learned in R1 will be advertised to DUT by BGP.

   Send X frames with X different SA and DA to R1 from RT.  R1 will
   advertise these locally learned macs to MHPE1 and MHPE2 via control
   plane.Measure the time taken to learn these X MACs from remote peer
   in DUT EVPN MAC address table.The DUT and MHPE2 are running SA mode.




Jacob & Tiruveedhula    Expires December 26, 2018               [Page 7]

Internet-Draft        EVPN Benchmarking Methodology            June 2018


   Measurement :

   Measure the time taken by the DUT to learn the "X" MACs in the data
   plane.Repeat these test and plot the data.The test is repeated for
   "N" times and the values are collected.The mac learning time is
   calculated by averaging the values obtained from "N" samples.

   Mac learning in sec = (T1+T2+..Tn/N)

3.4.  PBB-EVPN How long it takes to learn the mac from remote peer

   Objective:

   To Record the time taken to learn the remote macs.

   Procedure:

   Configure PBB-EVPN EVI in R1,MHPE2,DUT.All 4 routers except CE are
   running MPLS,BGP,RR is acting as route reflector to R1,MHPE2 and DUT.
   Record the DUT PBB-EVPN table.  For MHPE ESI must be configured per
   IFD/Interface.  Using RT(traffic generator) send the traffic to R1.
   The traffic is uni directional.There wont be any traffic flow from CE
   to DUT during this test.The BGP must be in established state.

   Send X frames with X different SA and DA to R1 from RT.These macs
   will be flooded to MHPE1 and MHPE2 by R1.The DUT and MHPE2 are
   running SA mode.

   Measurement :

   Measure the time taken to learn X mac address in DUT mac table.
   Repeat these test and plot the data.The test is repeated for "N"
   times and the values are collected.The mac learning time is
   calculated by averaging the values obtained by "N" samples.

   Mac learning in sec = (T1+T2+..Tn/N)

3.5.  How long it takes to flush the local macs due to CE link flap and
      measure the relearning rate of MACs

   Objective:

   To record the time taken to flush the mac learned locally and the
   time taken to relearn the same amount of macs.

   Procedure:





Jacob & Tiruveedhula    Expires December 26, 2018               [Page 8]

Internet-Draft        EVPN Benchmarking Methodology            June 2018


   Configure EVPN EVI in R1,MHPE2,DUT.  All 4 routers except CE are
   running MPLS,BGP,RR is acting as route reflector to R1,MHPE2 and DUT.
   Once the BGP is established.  Record the DUT EVPN table.  For MH PE
   ESI must be configured per IFD/Interface.  Using RT(traffic
   generator) send the traffic.  In this scenario traffic will be only
   send from CE side.

   Send X frames with X different SA and DA to DUT from CE using traffic
   generator.  Wait till the MHPE1 learns all X MAC address.  Then fail
   the MHPE1 CE link and measure the time taken to flush these X MACs
   from the EVPN MAC table.  Bring up the link which was made Down(the
   link between MHPE1 and CE).Measure time taken to relearn it.  The DUT
   and MHPE2 are running SA mode.

   Measurement :

   Measure the time taken for flushing these X MAC address.  Measure the
   time taken to relearn the X MACs in DUT.  Repeat these test and plot
   the data.  The test is repeated for "N" times and the values are
   collected.  The flush and the relearning time is calculated by
   averaging the values obtained by "N" samples.

   Flush time for X Macs in sec = (T1+T2+..Tn/N) Relearning time for X
   macs in sec = (T1+T2+..Tn/N)

3.6.  PBB-EVPN how long it takes to flush the local macs and measure the
      relearning rate of macs during PE-CE link flap

   Objective:

   To record the time taken to flush the mac learned locally and the
   time taken to relearn the same amount of macs.

   Procedure:

   Configure PBB-EVPN EVI in R1,MHPE2,DUT.  All 4 routers except CE are
   running MPLS,BGP,RR is acting as route reflector to R1,MHPE2 and DUT.
   Once the BGP is established.  Record the DUT PBB-EVPN table.  For MH
   PE ESI must be configured per IFD/Interface.  Using RT(traffic
   generator) send the traffic to the CE.  The traffic is uni
   directional.

   Send X frames with X different SA and DA to DUT from CE using traffic
   generator.  Wait till the MHPE1 learn all X MAC address.  Then fail
   the MHPE1 CE link and measure the time taken to flush these X MACs
   from the PBB-EVPN MAC table.  Then bring up the link.  Measure the
   time taken to relearn X MACS.  The DUT and MHPE2 are running SA mode.




Jacob & Tiruveedhula    Expires December 26, 2018               [Page 9]

Internet-Draft        EVPN Benchmarking Methodology            June 2018


   Measurement :

   Measure the time taken for flushing these X MAC address.  Measure the
   time taken to relearn the X MACs in DUT.  Repeat these test and plot
   the data.  The test is repeated for "N" times and the values are
   collected.  The flush and the relearning time is calculated by
   averaging the values obtained by "N" samples.

   Flush time for X Macs in sec = (T1+T2+..Tn/N) Relearning time for X
   macs in sec = (T1+T2+..Tn/N)

3.7.  How long it takes to flush the remote macs, due to remote link
      failure.

   Objective:

   To record the time taken to flush the remote mac learned in DUT
   during remote link failure.

   Procedure:

   Configure EVPN EVI in R1,MHPE2,DUT.All 4 routers except CE are
   running MPLS,BGP,RR is acting as route reflector to R1,MHPE2 and DUT.
   Once the BGP is established Record the DUT EVPN table.  For MHPE ESI
   must be configured per IFD/Interface.  Using RT(traffic generator)
   send the traffic to R1.There wont be any traffic flowing to CE from
   RT.

   Send X frames with X different SA and DA to DUT from R1 using traffic
   generator.  Bring down the link between R1 and traffic generator.
   Then measure the time taken to flush the DUT EVPN MAC table.  The DUT
   and MHPE2 are running SA mode.

   Measurement :

   Measure the time taken to flush X remote MACs from EVPN MAC table of
   DUT.  Repeat these test and plot the data.  The test is repeated for
   "N" times and the values are collected.  The flush rate is calculated
   averaging the values obtained by "N" samples.

   Flush time for X Macs in sec = (T1+T2+..Tn/N)

3.8.  PBB-EVPN How long it takes to flush the remote macs due to remote
      link failure

   Objective:





Jacob & Tiruveedhula    Expires December 26, 2018              [Page 10]

Internet-Draft        EVPN Benchmarking Methodology            June 2018


   To record the time taken to flush the remote mac learned in DUT
   during remote link failure.

   Procedure:

   Configure PBB-EVPN EVI in R1,MHPE2,DUT.All 4 routers except CE are
   running MPLS,BGP,RR is acting as route reflector to R1,MHPE2 and DUT.
   Once the BGP is established Record the DUT PBB-EVPN MAC table.  For
   MHPE ESI must be configured per IFD/Interface.  Using RT(traffic
   generator) send the traffic to R1.In this scenario traffic will be
   flowing only from R1.

   Send X frames with X different SA and DA to DUT from R1 using traffic
   generator.  Bring down the link between R1 and traffic generator.
   Then measure the time taken to flush the DUT PBB-EVPN MAC address
   table.  The remote MACs will be learned by Data plane, but the B-MAC
   will be learned by control plane.  The DUT and MHPE2 are running SA
   mode.

   Measurement :

   Measure the time taken to flush X remote MACs from PBB-EVPN MAC table
   of DUT.  Repeat these test and plot the data.  The test is repeated
   for "N" times and the values are collected.  The flush rate is
   calculated by averaging the values obtained by "N" samples.

   Flush time for X Macs in sec = (T1+T2+..Tn/N)

3.9.  To measure the MAC aging time.

   Objective:

   To measure the mac aging time.

   Procedure:

   Configure EVPN EVI in R1,MHPE2,DUT.  All 4 routers except CE are
   running MPLS,BGP,RR is acting as route reflector to R1,MHPE2 and DUT
   .Once the BGP is established.  Record the DUT EVPN table.  For MHPE
   ESI must be configured per IFD/Interface.  Using RT(traffic
   generator), send the traffic to the DUT.  The traffic will be flowing
   from CE to DUT.  There wont be any traffic from R1.

   Send X frames with X different SA and DA to DUT from CE using traffic
   generator.  Wait till X MAC address are learned.  Then stop the
   traffic.  Record the time taken to flush X MACS from DUT EVPN MAC
   table due to aging.  The DUT and MHPE2 are running SA mode




Jacob & Tiruveedhula    Expires December 26, 2018              [Page 11]

Internet-Draft        EVPN Benchmarking Methodology            June 2018


   Measurement :

   Measure the time taken to flush X MAC address due to aging.  Repeat
   these test and plot the data.  The test is repeated for "N" times and
   the values are collected.  The aging is calculated averaging the
   values obtained by "N" samples.

   Aging time for X Macs in sec = (T1+T2+..Tn/N)

3.10.  PBB-EVPN To measure the MAC aging time.

   Objective:

   To measure the mac aging time.

   Procedure:

   Configure PBB-EVPN EVI in R1,MHPE2,DUT.All 4 routers except CE are
   running MPLS,BGP,RR is acting as route reflector to R1,MHPE2 and
   DUT.Once the BGP is established.  Record the DUT PBB-EVPN MAC table.
   For MH PE ESI must be configured per IFD/Interface.  Using RT(traffic
   generator) send the traffic to the DUT.  The traffic is
   unidirectional flowing from CE to DUT.

   Send X frames with X different SA and DA to DUT from CE using traffic
   generator.  Wait till X MAC address are learned in DUT PBB- EVPN MAC
   table.  Then stop the traffic.  Record the time taken to flush X MAC
   entries due to aging.  The DUT and MHPE2 running in SA mode

   Measurement :

   Measure the time taken to flush X MAC address due to aging.  Repeat
   these test and plot the data.  The test is repeated for "N" times and
   the values are collected.  The aging is calculated by averaging the
   values obtained by "N" samples.

   Aging time for X Macs in sec = (T1+T2+..Tn/N)

3.11.  How long it takes to age out the remote macs

   Objective:

   To measure the remote mac aging time.

   Procedure:

   Configure EVPN EVI in R1,MHPE2,DUT.All 4 routers except CE are
   running MPLS,BGP,RR is acting as route reflector to R1,MHPE2 and DUT.



Jacob & Tiruveedhula    Expires December 26, 2018              [Page 12]

Internet-Draft        EVPN Benchmarking Methodology            June 2018


   Once the BGP is established.  Record the DUT EVPN table.  For MH PE
   ESI must be configured per IFD/Interface.  Using RT(traffic
   generator) send the traffic to R1.There wont be any traffic from CE.

   Send X frames with X different SA and DA to DUT from R1 using traffic
   generator.  Stop the traffic at remote PE R1.Due to MAC aging R1 will
   withdraw its routes from DUT and MHPE2.  Measure the time taken to
   remove these MACs from DUT EVPN MAC table.  DUT and MHPE2 are running
   in SA mode

   Measurement :

   Measure the time taken to flush X remote MACs learned in DUT EVPN MAC
   table due to aging.  Repeat these test and plot the data.  The test
   is repeated for "N" times and the values are collected.  The aging is
   calculated by averaging the values obtained by "N" samples.

   Aging time for X Macs in sec = (T1+T2+..Tn/N)

3.12.  PBB-EVPN How long it takes to age out the remote macs.

   Objective:

   To measure the remote mac aging time.

   Procedure:

   Configure PBB-EVPN EVI in R1,MHPE2,DUT.All 4 routers except CE are
   running MPLS,BGP,RR is acting as route reflector to R1,MHPE2 and DUT.
   Once the BGP is established.  Record the DUT MAC table.  For MH PE
   ESI must be configured per IFD/Interface.  Using RT(traffic
   Generator) send the traffic to R1.  There is no traffic from CE side.

   Send X frames with X different SA and DA to DUT from R1 using traffic
   generator.  Stop the traffic at remote PE(R1).Measure the time taken
   to remove these remote MACs from DUT PBB-EVPN MAC table.  The DUT and
   MHPE2 are running in SA mode.

   Measurement :

   Measure the time taken to flush the X remote MACs from DUT PBB-EVPN
   MAC table due to aging Repeat these test and plot the data.  The test
   is repeated for "N" times and the values are collected.  The aging is
   calculated by averaging the values obtained by "N" samples.

   Aging time for X Macs in sec = (T1+T2+..Tn/N)





Jacob & Tiruveedhula    Expires December 26, 2018              [Page 13]

Internet-Draft        EVPN Benchmarking Methodology            June 2018


3.13.  How long it takes to learn both local and remote macs.

   Objective:

   To record the time taken to learn both local and remote macs.

   Procedure:

   Configure EVPN EVI in R1,MHPE2,DUT.All 4 routers except CE are
   running MPLS,BGP,RR is acting as route reflector to R1,MHPE2 and DUT.
   Once the BGP is established.  Record the DUT EVPN table.  For MH PE
   ESI must be configured per IFD/Interface.  Using RT(traffic
   generator) send the traffic to the routers.  The traffic is bi
   directional.

   Send X frames with X different SA and DA to DUT from R1 using traffic
   generator.  Send X frames with different SA and DA from traffic
   generator connected to CE.  The SA and DA of flows must be
   complimentary to have unicast flows.  Measure the time taken by the
   DUT to learn 2X in EVPN MAC.  DUT and MHPE2 are running in SA mode.

   Measurement :

   Measure the time taken to learn 2X MAC address in DUT EVPN MAC table.
   Repeat these test and plot the data.  The test is repeated for "N"
   times and the values are collected.  The mac learning time is
   calculated by averaging the values obtained by "N" samples.

   Time to learn 2X Macs in sec = (T1+T2+..Tn/N)

3.14.  PBB-EVPN How long it takes to learn both local and remote macs

   Objective:

   To record the time taken to learn both local and remote macs.

   Procedure:

   Configure PBB-EVPN EVI in R1,MHPE2,DUT.All 4 routers except CE are
   running MPLS,BGP,RR is acting as route reflector to R1,MHPE2 and DUT.
   Once the BGP is established.  Record the DUT EVPN table.For MH PE ESI
   must be configured per IFD/Interface.  Using RT(traffic generator)
   send the traffic to the routers.

   Send X frames with X different SA and DA to DUT from R1 using traffic
   generator.  Send X frames with different SA and DA from traffic
   generator connected to CE.  The SA and DA of flows must be




Jacob & Tiruveedhula    Expires December 26, 2018              [Page 14]

Internet-Draft        EVPN Benchmarking Methodology            June 2018


   complimentary to have unicast flows.  Measure the time taken by the
   DUT to learn 2X in MAC table.  DUT and MHPE2 are running in SA mode.

   Measurement :

   Measure the time taken to learn 2X MAC address table in DUT PBB-EVPN
   MAC table.  Repeat these test and plot the data.  The test is
   repeated for "N" times and the values are collected.  The mac
   learning time is calculated by averaging the values obtained by "N"
   samples.

   Time to learn 2X Macs in sec = (T1+T2+..Tn/N)

4.  High Availability

4.1.  To Record the whether there is traffic loss due to routing engine
      failover for redundancy test.

   Objective:

   To record traffic loss during routing engine failover.

   Procedure:

   Configure EVPN EVI in R1,MHPE2,DUT.All 4 routers except CE are
   running MPLS,BGP,RR is acting as route reflector to R1,MHPE2 and DUT.
   Once the BGP is established.  Record the DUT EVPN table.  For MH PE
   ESI must be configured per IFD/Interface.  Using RT(traffic
   generator) Send bi directional to the routers.

   Send X frames from CE to DUT from traffic generator withX different
   SA and DA.  Send X frames from traffic generator to R1 with X
   different SA and DA so that 2X MAC address will be learned in DUT.
   There is a bi directional traffic flow with X pps in each direction.
   Then do a routing engine fail-over.

   Measurement :

   There should be 0 traffic loss which is the ideal case, No change in
   the DF role.  DUT should not withdraw any routes.Repeat the test "N"
   times and plot the data.The packet loss is calculated by averaging
   the values obtained from "N" samples.

   Packet loss in sec = (T1+T2+..Tn/N)







Jacob & Tiruveedhula    Expires December 26, 2018              [Page 15]

Internet-Draft        EVPN Benchmarking Methodology            June 2018


4.2.  PBB-EVPN To Record the whether there is traffic loss due to
      routing engine failover for redundancy test

   Objective:

   To record traffic loss during routing engine failover.

   Procedure:

   Configure PBB-EVPN EVI in R1,MHPE2,DUT.  All 4 routers except CE are
   running MPLS,BGP,RR is acting as route reflector to R1,MHPE2 and DUT.
   Once the BGP is established.  Record the DUT PBB-EVPN table.  For MH
   PE ESI must be configured per IFD/Interface.  Using RT(traffic
   generator) send the traffic to the routers.

   Send X frames to DUT with X different SA and DA from CE using the
   traffic generator.  Send X frames from traffic generator to R1 with X
   different SA and DA so that 2X MAC address will be Learned in DUT.
   There is a bi directional traffic flow with X pps in each direction.
   Then do a routing engine fail-over.

   Measurement :

   There should be 0 traffic loss which is the ideal case, No change in
   the DF role.  DUT should not withdraw any routes.Repeat the test "N"
   times and plot the data.The packet loss is calculated by averaging
   the values obtained from "N" samples.

   Packet loss in sec = (T1+T2+..Tn/N)

5.  ARP/ND Scale

   These tests are conducted to Record the scaling parameter of ARP/ND
   of the DUT.

5.1.  To find ARP/ND scale

   Objective:

   To Record the ARP/ND scale of the DUT.

   Procedure:

   Configure EPN EVI in R1,MHPE2,DUT.All 4 routers except CE are running
   MPLS,BGP,RR is acting as route reflector to R1,MHPE2 and DUT.  Once
   the BGP is established.  Record the DUT EVPN table.  For MH PE ESI
   must be configured per IFD/Interface.  Using RT(traffic generator)
   send arp/ICMPv6 request to the DUT which has gateway configured.



Jacob & Tiruveedhula    Expires December 26, 2018              [Page 16]

Internet-Draft        EVPN Benchmarking Methodology            June 2018


   Send X arp/icmpv6 request from RT to DUT with different sender ip/
   ipv6 address to the same target gateway ip address.  Measure whether
   X MAC+IPv4 address/MAC+IPv6 address of the hosts are learned in DUT.

   Measurement :

   The DUT must learn X MAC+IPV4/MAC+IPv6 and it must advertise the X
   MAC+IPV4/MAC+IPV6 to the remote router.

6.  Scale

   This is to measure the performance of DUT in scaling to "X" EVPN
   instances.  The measured parameters are CPU usage, memory
   leak,crashes.

6.1.  To Measure the scale limit of DUT with trigger (Scale without
      traffic)

   Objective:

   To measure the scale limit of DUT for EVPN.

   Procedure:

   Configure EVPN EVI in R1,MHPE2,DUT.All 4 routers except CE are
   running MPLS,BGP,RR is acting as route reflector to R1,MHPE2 and DUT.
   Once the BGP is established.  Record the DUT EVPN table.  For
   MHPE,DUT ESI must be configured per IFD/Interface.

   The DUT,MHPE2 and R1 are scaled to "N" EVI.Clear BGP neighbors of the
   DUT.  Once adjacency is established in the DUT.  Measure the routes
   received from MHPE2 and R1 for "N" EVI in the DUT.

   Measurement :

   There should not be any loss of route types 1,2,3 and 4 in DUT.  DUT
   must relearn all type 1,2,3 and 4 from remote routers.  The DUT must
   be subjected to various values of N to find the optimal scale limit

6.2.  PBB-EVPN To measure the scale limit with trigger.

   Objective:

   To measure the scale limit of DUT for PBB-EVPN.

   Procedure:





Jacob & Tiruveedhula    Expires December 26, 2018              [Page 17]

Internet-Draft        EVPN Benchmarking Methodology            June 2018


   Configure "N" PBB-EVPN instances in R1,MHPE2,DUT.All 4 routers except
   CE are running MPLS,BGP,RR is acting route reflector to R1,MHPE2 and
   DUT.  Once BGP is established.  Record the DUT PBB-EVPN table.For
   MHPE ESI must be configured on IFD/Interface.

   The DUT,MHPE2 and R1 are scaled to "N" PBB-EVPN instances.  Clear BGP
   neighbors in the DUT Once adjacency is established in DUT, check
   routes received from R1 and MHPE2.

   Measurement :

   There should not be any loss of route types 2,3 and 4 in DUT.  The
   DUT must relearn all type 2,3 and 4 routes from remote routers.  The
   DUT must be subjected to various values of N to find the optimal
   scale limit.

6.3.  To measure the convergence time of DUT with scale and traffic.

   Objective:

   To measure the convergence time of DUT when the DUT is scaled with
   EVPN instance along with traffic.

   Procedure:

   Configure EVPN EVI in R1,MHPE2,DUT.All 4 routers except CE are
   running MPLS,BGP,RR is acting as route reflector to R1,MHPE2 and DUT.
   Once the BGP is established.  Record the DUT EVPN table.  For MH PE
   ESI must be configured per IFD/Interface.  Using RT(traffic
   generator)send the traffic to the routers.

   Scale N EVIs in DUT,R1 and MHPE2.Send F frames to DUT from CE using
   traffic generator with X different SA and DA for N EVI's.  Send F
   frames from traffic generator to R1 with X different SA and DA.
   There will be 2X number of MAC address will be learned in DUT EVPN
   MAC table.  There is a bi directional traffic flow with F pps in each
   direction.  Then clear the BGP neighbors in the DUT.  Once the
   adjacency is restored in DUT.  Measure the time taken to learn 2X MAC
   address in DUT MAC table.

   Measurement :

   The DUT must learn 2X MAC address.  Measure the time taken to learn
   2X MAC in DUT.  Repeat these test and plot the data.The test is
   repeated for "N" times and the values are collected.The convergence
   time is calculated by averaging the values obtained by "N" samples.

   Convergence time in sec = (T1+T2+..Tn/N)



Jacob & Tiruveedhula    Expires December 26, 2018              [Page 18]

Internet-Draft        EVPN Benchmarking Methodology            June 2018


6.4.  .PBB-EVPN To measure the convergence time of DUT with scale and
      traffic.

   Objective:

   To measure the convergence time of DUT when the DUT is scaled with
   PBB-EVPN instance along with traffic.

   Procedure:

   Configure PBB-EVPN instances in R1,MHPE2,DUT.All 4 routers except CE
   are running MPLS,BGP,RR is acting as route reflector to R1,MHPE2 and
   DUT.  Once BGP is established.  Record the DUT EVPN table.  For MH PE
   ESI must be configured per IFD/Interface.  Using RT(traffic
   generator) send the traffic to the routers.

   Scale N PBB-EVI's in DUT,R1 and MHPE2.Send F frames to DUT from CE
   using traffic generator with X different SA and DA for N EVI's.  Send
   F frames from traffic generator to R1 with X different SA and DA.
   There will be 2X number of MAC address will be learned in DUT PBB-
   EVPN MAC table.  There is a bi directional traffic flow with F pps in
   each direction.  Then clear the BGP neighbors in the DUT.  Once the
   adjacency is restored in DUT.  Measure the time taken to learn 2X MAC
   address in DUT PBB-MAC table.

   Measurement :

   The DUT must learn 2X MAC address.  Measure the time taken to learn
   2X MAC in DUT.  Repeat these test and plot the data.  The test is
   repeated for "N" times and the values are collected.  The convergence
   time is calculated by averaging the values obtained by "N" samples.

   Convergence time in sec = (T1+T2+..Tn/N)

7.  SOAK Test

   This is measuring the performance of DUT running with scaled
   configuration with traffic over a peroid of time "T'".  In each
   interval "t1" the parameters measured are CPU usage, memory usage,
   crashes.

7.1.  To Measure the stability of the DUT with scale and traffic.

   Objective:

   To measure the stability of the DUT in a scaled environment with
   traffic.




Jacob & Tiruveedhula    Expires December 26, 2018              [Page 19]

Internet-Draft        EVPN Benchmarking Methodology            June 2018


   Procedure:

   Configure EVPN EVI in R1,MHPE2,DUT.All 4 routers except CE are
   running MPLS,BGP,RR is acting as route reflector to R1,MHPE2 and DUT.
   Once the BGP is established.  Record the DUT EVPN table.  For MH PE
   ESI must be configured per IFD/Interface.  Using RT(traffic
   generator) send the traffic to the routers.

   Scale N EVI's in DUT,R1 and MHPE2.Send F frames to DUT from CE using
   traffic generator with different X SA and DA for N EVI's.  Send F
   frames from traffic generator to R1 with X different SA and DA.
   There will be 2X number of MAC address will be learned in DUT EVPN
   MAC table.  There is a bi directional traffic flow with F pps in each
   direction.  The DUT must run with traffic for 24 hours, every hour
   check for memory leak, crash.

   Measurement :

   Take the hourly reading of CPU, process memory.  There should not be
   any leak, crashes, CPU spikes.

7.2.  PBB-EVPN to measure the stability of DUT with scale and traffic.

   Objective:

   To measure the stability of the DUT in a scaled environment with
   traffic.

   Procedure:

   Configure N PBB-EVPN instances in R1, MHPE2, DUT.  All 4 routers
   except CE are running MPLS,BGP,RR is acting as route reflector to
   R1,MHPE2 and DUT.  Once the BGP comes up Record the DUT EVPN table.
   for MH PE ESI must be configured per IFD/Interface.  Using RT(traffic
   generator)send the traffic to the routers.

   Scale N PBB-EVI's in DUT,R1 and MHPE2.Send F frames to DUT from CE
   using traffic generator with X different SA and DA for N EVI's.  Send
   F frames from traffic generator to R1 with X different SA and DA.
   There will be 2X number of MAC address will be learned in DUT PBB-
   EVPN MAC table.  There is a bi directional traffic flow with F pps in
   Each direction.  The DUT must run with traffic for 24 hours, every
   hour check the memory leak, crashes.

   Measurement :

   Take the hourly reading of CPU process, memory usages.  There should
   not be any memory leak, crashes,CPU spikes.



Jacob & Tiruveedhula    Expires December 26, 2018              [Page 20]

Internet-Draft        EVPN Benchmarking Methodology            June 2018


8.  Acknowledgements

   We would like to thank Fioccola Giuseppe of Telecom Italia reviewing
   our draft and commenting it.  We would like to thank Sarah Banks for
   guiding and mentoring us.

9.  IANA Considerations

   This memo includes no request to IANA.

10.  Security Considerations

   There is no additional consideration from RFC 6192.

11.  References

11.1.  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <https://www.rfc-editor.org/info/rfc2119>.

   [RFC2544]  Bradner, S. and J. McQuaid, "Benchmarking Methodology for
              Network Interconnect Devices", RFC 2544,
              DOI 10.17487/RFC2544, March 1999,
              <https://www.rfc-editor.org/info/rfc2544>.

   [RFC2899]  Ginoza, S., "Request for Comments Summary RFC Numbers
              2800-2899", RFC 2899, DOI 10.17487/RFC2899, May 2001,
              <https://www.rfc-editor.org/info/rfc2899>.

11.2.  Informative References

   [RFC7432]  Sajassi, A., Ed., Aggarwal, R., Bitar, N., Isaac, A.,
              Uttaro, J., Drake, J., and W. Henderickx, "BGP MPLS-Based
              Ethernet VPN", RFC 7432, DOI 10.17487/RFC7432, February
              2015, <https://www.rfc-editor.org/info/rfc7432>.

   [RFC7623]  Sajassi, A., Ed., Salam, S., Bitar, N., Isaac, A., and W.
              Henderickx, "Provider Backbone Bridging Combined with
              Ethernet VPN (PBB-EVPN)", RFC 7623, DOI 10.17487/RFC7623,
              September 2015, <https://www.rfc-editor.org/info/rfc7623>.








Jacob & Tiruveedhula    Expires December 26, 2018              [Page 21]

Internet-Draft        EVPN Benchmarking Methodology            June 2018


Appendix A.  Appendix

Authors' Addresses

   Sudhin Jacob (editor)
   Juniper Networks
   Bangalore
   India

   Phone: +91 8061212543
   Email: sjacob@juniper.net


   Kishore Tiruveedhula
   Juniper Networks
   10 Technology Park Dr
   Westford, MA  01886
   USA

   Phone: +1 9785898861
   Email: kishoret@juniper.net






























Jacob & Tiruveedhula    Expires December 26, 2018              [Page 22]
