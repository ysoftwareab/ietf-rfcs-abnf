<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Flow Bindings in Mobile IPv6 and NEMO Basic
            Support</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Flow Bindings in Mobile IPv6 and NEMO Basic
            Support">
<meta name="keywords" content="I-D, Internet-Draft">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 60em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 60em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">IETF MEXT Working Group</td><td class="header">G. Tsirtsis</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Qualcomm</td></tr>
<tr><td class="header">Updates: <a href='http://tools.ietf.org/html/rfc5648'>5648</a> (if&nbsp;approved)</td><td class="header">H. Soliman</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">Elevate Technologies</td></tr>
<tr><td class="header">Expires: February 17, 2011</td><td class="header">N. Montavont</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">IT/TB</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">G. Giaretta</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Qualcomm</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">K. Kuladinithi</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">University of Bremen</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">August 16, 2010</td></tr>
</table></td></tr></table>
<h1><br />Flow Bindings in Mobile IPv6 and NEMO Basic
            Support<br />draft-ietf-mext-flow-binding-08.txt</h1>

<h3>Abstract</h3>

<p>This document introduces extensions to Mobile IPv6 that allow
                nodes to bind one or more flows to a care-of address. These
                extensions allow multihomed nodes to instruct home agents and
                other Mobile IPv6 entities to direct inbound flows to specific
                addresses.
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted  in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF).  Note that other groups may also distribute
working documents as Internet-Drafts.  The list of current
Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
This Internet-Draft will expire on February 17, 2011.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the Simplified BSD License.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Requirements notation<br />
<a href="#intro">2.</a>&nbsp;
Introduction<br />
<a href="#term">3.</a>&nbsp;
Terminology<br />
<a href="#MIPv6ext">4.</a>&nbsp;
Mobile IPv6 Extensions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#BIDUpdate">4.1.</a>&nbsp;
Definition Update for Binding Identifier Mobility Option<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#FIDoption">4.2.</a>&nbsp;
Flow Identification Mobility Option<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#suboptdef">4.2.1.</a>&nbsp;
Flow Identification Sub-Options definition<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#FIDSum">4.2.2.</a>&nbsp;
Flow Summary Mobility Option<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#BCext">4.3.</a>&nbsp;
Flow Bindings entries list and its relationship to Binding Cache<br />
<a href="#operation">5.</a>&nbsp;
Protocol operations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">5.1.</a>&nbsp;
General<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#defaultbinding">5.1.1.</a>&nbsp;
Preferred Care-of address<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">5.2.</a>&nbsp;
Mobile Node Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sendBID">5.2.1.</a>&nbsp;
Sending BU with BID Options<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">5.2.2.</a>&nbsp;
Sending BU with Flow Identification Mobility Options<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#refreshFDs">5.2.3.</a>&nbsp;
Sending BU with a Flow Summary Option<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#deletingFDs">5.2.4.</a>&nbsp;
Removing flow bindings<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">5.2.5.</a>&nbsp;
Returning Home<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">5.2.6.</a>&nbsp;
Receiving Binding Acknowledgements<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#mn-rrp">5.2.7.</a>&nbsp;
Return Routability Procedure<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#HAops">5.3.</a>&nbsp;
HA, MAP, and CN Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#recvBID">5.3.1.</a>&nbsp;
Handling Binding Identifier Mobility Options<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#HAops-receiving2">5.3.2.</a>&nbsp;
Handling Flow Identification Mobility Options<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#HAFIDSum">5.3.3.</a>&nbsp;
Handling Flow Summary Mobility Option<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#HAdeletingFDs">5.3.4.</a>&nbsp;
Flow Binding Removals<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sendBA">5.3.5.</a>&nbsp;
Sending Binding Acknowledgements<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">5.3.6.</a>&nbsp;
Packet Processing<br />
<a href="#anchor9">6.</a>&nbsp;
MTU Considerations<br />
<a href="#security">7.</a>&nbsp;
Security considerations<br />
<a href="#anchor10">8.</a>&nbsp;
IANA Considerations<br />
<a href="#anchor11">9.</a>&nbsp;
Contributors<br />
<a href="#ack">10.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">11.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">11.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">11.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Requirements notation</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
                NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and
                "OPTIONAL" in this document are to be interpreted as described
                in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<a name="intro"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Introduction</h3>

<p>Mobile IPv6 <a class='info' href='#RFC3775'>[RFC3775]<span> (</span><span class='info'>Johnson, D., Perkins, C., and J. Arkko, &ldquo;Mobility Support in IPv6,&rdquo; June&nbsp;2004.</span><span>)</span></a>, DSMIPv6 <a class='info' href='#RFC5555'>[RFC5555]<span> (</span><span class='info'>Soliman, H., &ldquo;Mobile IPv6 Support for Dual Stack Hosts and Routers,&rdquo; June&nbsp;2009.</span><span>)</span></a> and NEMO Basic Support <a class='info' href='#RFC3963'>[RFC3963]<span> (</span><span class='info'>Devarapalli, V., Wakikawa, R., Petrescu, A., and P. Thubert, &ldquo;Network Mobility (NEMO) Basic Support Protocol,&rdquo; January&nbsp;2005.</span><span>)</span></a> allow a mobile node / mobile router to
                manage its mobility using the binding update message, which
                binds one care-of address to one home address and associated
                mobile networks. The binding update message can be sent to the
                home agent. In Mobile IPv6, the binding update can also be sent
                to correspondent node or to a mobility anchor point (see <a class='info' href='#RFC5380'>[RFC5380]<span> (</span><span class='info'>Soliman, H., Castelluccia, C., ElMalki, K., and L. Bellier, &ldquo;Hierarchical Mobile IPv6 (HMIPv6) Mobility Management,&rdquo; October&nbsp;2008.</span><span>)</span></a>). The semantics of the binding update are
                limited to care-of address changes. That is, <a class='info' href='#RFC3775'>[RFC3775]<span> (</span><span class='info'>Johnson, D., Perkins, C., and J. Arkko, &ldquo;Mobility Support in IPv6,&rdquo; June&nbsp;2004.</span><span>)</span></a>, <a class='info' href='#RFC5555'>[RFC5555]<span> (</span><span class='info'>Soliman, H., &ldquo;Mobile IPv6 Support for Dual Stack Hosts and Routers,&rdquo; June&nbsp;2009.</span><span>)</span></a>, and <a class='info' href='#RFC3963'>[RFC3963]<span> (</span><span class='info'>Devarapalli, V., Wakikawa, R., Petrescu, A., and P. Thubert, &ldquo;Network Mobility (NEMO) Basic Support Protocol,&rdquo; January&nbsp;2005.</span><span>)</span></a> do not allow a mobile node / mobile
                router to bind more than one address to the home address. In
                    <a class='info' href='#RFC5648'>[RFC5648]<span> (</span><span class='info'>Wakikawa, R., Devarapalli, V., Tsirtsis, G., Ernst, T., and K. Nagami, &ldquo;Multiple Care-of Addresses Registration,&rdquo; October&nbsp;2009.</span><span>)</span></a> Mobile IPv6 and NEMO Basic Support
                are extended to allow the binding of more than one care-of
                address to a home address. This specification further extends
                Mobile IPv6, DSMIPv6, and NEMO Basic Support to allow it to
                specify policies associated with each binding. A policy can
                contain a request for special treatment of a particular IPv4 or
                IPv6 flow, which is viewed as a group of packets matching a
                traffic selector. Hence, this specification allows a mobile node
                / mobile router to bind a particular flow to a care-of address
                without affecting other flows using the same home address. In
                addition, this specification allows to bind a particular flow to
                a particular care-of address directly with correspondent node
                and mobility agents (i.e., home agents <a class='info' href='#RFC3775'>[RFC3775]<span> (</span><span class='info'>Johnson, D., Perkins, C., and J. Arkko, &ldquo;Mobility Support in IPv6,&rdquo; June&nbsp;2004.</span><span>)</span></a>
                and mobility anchor points <a class='info' href='#RFC5380'>[RFC5380]<span> (</span><span class='info'>Soliman, H., Castelluccia, C., ElMalki, K., and L. Bellier, &ldquo;Hierarchical Mobile IPv6 (HMIPv6) Mobility Management,&rdquo; October&nbsp;2008.</span><span>)</span></a>).
</p>
<p>In this document, a flow is defined as a set of IP packets
                matching a traffic selector. A traffic selector can identify the
                source and destination IP addresses, transport protocol number,
                the source and destination port numbers and other fields in IP
                and higher layer headers. This specification, however, does not
                define traffic selectors and it is assumed that one or more ways
                of defining traffic selectors are going to be defined in other
                specifications. This specification, however, does define the
                traffic selector sub-option format to be used for any defined
                traffic selectors. 
</p>
<p> Using the flow identifier option introduced in this
                specification a mobile node / mobile router can bind one or more
                flows to a care-of address while maintaining the reception of
                other flows on another care-of address. The mobile node / mobile
                router assembles the flow binding request based local policies,
                link characteristics and the types of applications running at
                the time. Such policies are outside the scope of this document.
</p>
<p>It should be noted that the flow identification mobility option
                can be associated with any binding update, whether it is sent to
                a mobility agent or a correspondent node.
</p>
<p>Note that per-packet load balancing may have negative impacts on
                TCP congestion avoidance mechanisms as it is desirable to
                maintain order between packets belonging to the same TCP
                connection. This behaviour is specified in <a class='info' href='#RFC2702'>[RFC2702]<span> (</span><span class='info'>Awduche, D., Malcolm, J., Agogbua, J., O&apos;Dell, M., and J. McManus, &ldquo;Requirements for Traffic Engineering Over MPLS,&rdquo; September&nbsp;1999.</span><span>)</span></a>. Other negative impacts are also foreseen
                for other types of real time connections due to the potential
                variations in round trip time between packets. Moreover,
                per-packet load-balancing will negatively affect traffic with
                anti-reply protection mechanisms. Hence, per-packet load
                balancing is not envisioned in this specification. 
</p>
<p>In the rest of the document, the term "mobile node" is used to
                designate either a mobile node as defined in <a class='info' href='#RFC3775'>[RFC3775]<span> (</span><span class='info'>Johnson, D., Perkins, C., and J. Arkko, &ldquo;Mobility Support in IPv6,&rdquo; June&nbsp;2004.</span><span>)</span></a> and <a class='info' href='#RFC5648'>[RFC5648]<span> (</span><span class='info'>Wakikawa, R., Devarapalli, V., Tsirtsis, G., Ernst, T., and K. Nagami, &ldquo;Multiple Care-of Addresses Registration,&rdquo; October&nbsp;2009.</span><span>)</span></a>, or a mobile
                router as defined in <a class='info' href='#RFC3963'>[RFC3963]<span> (</span><span class='info'>Devarapalli, V., Wakikawa, R., Petrescu, A., and P. Thubert, &ldquo;Network Mobility (NEMO) Basic Support Protocol,&rdquo; January&nbsp;2005.</span><span>)</span></a> unless stated
                otherwise.
</p>
<a name="term"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Terminology</h3>

<p>Terms used in this document are defined in <a class='info' href='#RFC3753'>[RFC3753]<span> (</span><span class='info'>Manner, J. and M. Kojo, &ldquo;Mobility Related Terminology,&rdquo; June&nbsp;2004.</span><span>)</span></a> and <a class='info' href='#RFC4885'>[RFC4885]<span> (</span><span class='info'>Ernst, T. and H-Y. Lach, &ldquo;Network Mobility Support Terminology,&rdquo; July&nbsp;2007.</span><span>)</span></a>. The following terms are also
                used in this document:</p>
<blockquote class="text">
<p>Flow: A flow is a sequence of packets for which the MN
                        desires special handling either by the Home Agent (HA),
                        the Corresponding Node (CN) or the (Mobility Anchor
                        Point) MAP.
</p>
<p>Traffic Selector: One or more parameters that can be
                        matched against fields in the packet's headers for the
                        purpose of classifying a packet. Examples of such
                        parameters include the source and destination IP
                        addresses, transport protocol number, the source and
                        destination port numbers and other fields in IP and
                        higher layer headers. 
</p>
<p>Flow binding: It consists of a traffic selector, and an
                        action. IP packets from one or more flows that match the
                        traffic selector associated with the flow binding, are
                        processed according to the action associated with the
                        same flow binding.
</p>
<p>Flow Identifier: A flow identifier uniquely identifies a
                        flow binding associated with a mobile node. It is
                        generated by a mobile node and is cached in the table of
                        flow binding entries maintained by the MN, HA, CN or
                        MAP.
</p>
</blockquote><p>
            
</p>
<a name="MIPv6ext"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Mobile IPv6 Extensions</h3>

<p>This section introduces extensions to Mobile IPv6 that are
                necessary for supporting the flow binding mechanism described in
                this document.
</p>
<a name="BIDUpdate"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Definition Update for Binding Identifier Mobility Option</h3>

<p>This specification updates the definition of the Binding
                    Identifier Mobility option defined in <a class='info' href='#RFC5648'>[RFC5648]<span> (</span><span class='info'>Wakikawa, R., Devarapalli, V., Tsirtsis, G., Ernst, T., and K. Nagami, &ldquo;Multiple Care-of Addresses Registration,&rdquo; October&nbsp;2009.</span><span>)</span></a>, as follows:
</p><br /><hr class="insert" />
<a name="BIDup"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
                            1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
                                       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                                       |   Type = 35   |     Length    |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |       Binding ID (BID)        |     Status    |H|   BID-PRI   |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-------------------------------+
       +                                                               +
       :                 IPv4 or IPv6 care-of address (CoA)            :
       +                                                               +
       +---------------------------------------------------------------+


</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: The Binding Identifier Mobility option&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>
                    </p>
<blockquote class="text">
<p>
                            </p>
<blockquote class="text"><dl>
<dt>BID-PRI</dt>
<dd>
                                    <br />
 This is a 7-bit
                                    unsigned integer placing each BID to a
                                    relative priority with other registered
                                    BIDs. Value '0' is reserved and MUST NOT be
                                    used. A lower number in this field indicates
                                    a higher priority, while BIDs with the same
                                    BID-PRI value have equal priority meaning
                                    that, the BID used is an implementation
                                    issue. This is consistent with current
                                    practice in packet classifiers. 
</dd>
</dl></blockquote>
                        

</blockquote><p>
                
</p>
<a name="FIDoption"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Flow Identification Mobility Option</h3>

<p>The flow identification mobility option is a new mobility
                    option <a class='info' href='#RFC3775'>[RFC3775]<span> (</span><span class='info'>Johnson, D., Perkins, C., and J. Arkko, &ldquo;Mobility Support in IPv6,&rdquo; June&nbsp;2004.</span><span>)</span></a> and it is included in the
                    binding update and acknowledgement messages. This option
                    contains information that allows the receiver of a binding
                    update to install policies on a traffic flow and route it to
                    a given care-of address. Multiple options may exist within
                    the same binding update message. The alignment requirement
                    for this option is 2n.
</p><br /><hr class="insert" />
<a name="FIDformat"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    | Option Type   |  Option Len   |              FID              |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |   FID-PRI     |   Action      |  Rsvd         |     Status    |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |   Sub-options (optional) ...
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;2: The Flow Identification Mobility Option&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>
                    </p>
<blockquote class="text">
<p>
                            </p>
<blockquote class="text"><dl>
<dt>Option Type</dt>
<dd>
                                    <br />
 To be assigned by
                                    IANA
</dd>
<dt>Option Len</dt>
<dd>
                                    <br />
 Length of the
                                    option in octets as per <a class='info' href='#RFC3775'>[RFC3775]<span> (</span><span class='info'>Johnson, D., Perkins, C., and J. Arkko, &ldquo;Mobility Support in IPv6,&rdquo; June&nbsp;2004.</span><span>)</span></a>.
</dd>
<dt>FID</dt>
<dd>
                                    <br />
 The Flow Identifier
                                    field is a 16-bit unsigned integer that
                                    includes the unique identifier for the flow
                                    binding. This field is used to refer to an
                                    existing flow binding or to create a new
                                    flow binding. The value of this field is set
                                    by the mobile node. FID = 0 is reserved and
                                    MUST NOT be used.
</dd>
<dt>FID-PRI</dt>
<dd>
                                    <br />
 This is an 8-bit
                                    unsigned priority field to indicate the
                                    priority of a particular option. This field
                                    is needed in cases where two different flow
                                    descriptions in two different options
                                    overlap. The priority field decides which
                                    policy should be in those cases. A lower
                                    number in this field indicates a higher
                                    priority. Value '0' is reserved and MUST NOT
                                    be used. FID-PRI MUST be unique to each of
                                    the flows pertaining to a given MN.
</dd>
<dt>Action</dt>
<dd>
                                    <br />
 This 8-bit unsigned
                                    integer field specifies the action that
                                    needs to be taken by the receiver of the
                                    binding update containing the flow
                                    identification option. The details of these
                                    requests are discussed below. The following
                                    values are reserved for the Action field in
                                    this option: 
<blockquote class="text"><dl>
<dt></dt>
<dd>0 Reserved and MUST NOT be used
</dd>
<dt></dt>
<dd>1 'Discard'. This value indicates a
                                        request to discard all packets in
                                        the flow described by the option. No
                                        BIDs are associated with this
                                        Action. Care should be taken when
                                        using this Action as it will lead to
                                        disrupting applications
                                        communication. Implementations may
                                        consider notifying impacted
                                        applications in mobile nodes.
</dd>
<dt></dt>
<dd>2 'Forward'. This value indicates a
                                        request to send the flow to one or
                                        more addresses indicated in the
                                        binding reference sub-option (see
                                        <a class='info' href='#BIDRef'>Section&nbsp;4.2.1.3<span> (</span><span class='info'>Binding Reference Sub-option</span><span>)</span></a>). One or
                                        more BIDs MUST be associated with
                                        this Action. If only one BID is
                                        associated with this action then it
                                        is essentially a request to forward
                                        packets to that CoA, otherwise
                                        matching packets are replicated and
                                        forwarded to all of the indicated
                                        CoAs. Care should be taken when
                                        multiple BIDs are used in
                                        combination with the 'Forward'
                                        action as some transport layers may
                                        not be able to handle packet
                                        duplication and this can affect
                                        their performance.
</dd>
<dt></dt>
<dd>3-255 Reserved for future use
</dd>
</dl></blockquote>
                                
</dd>
<dt>Rsvd</dt>
<dd>
                                    <br />
 This field is
                                    unused. It MUST be set to zero by the sender
                                    and ignored by the receiver.
</dd>
<dt>Status</dt>
<dd>
                                    <br />
 This 8-bit unsigned
                                    integer field indicates the success or
                                    failure of the flow binding operation for
                                    the particular flow in the option. This
                                    field is not relevant to the binding update
                                    message as a whole or to other flow
                                    identification options. This field is only
                                    relevant when included in the Binding
                                    Acknowledgement message and must be ignored
                                    in the binding update message. The following
                                    values are reserved for the status field
                                    within the flow identification mobility
                                    option: 
<blockquote class="text"><dl>
<dt></dt>
<dd>0 Flow binding successful
</dd>
<dt></dt>
<dd>128 Administratively prohibited
</dd>
<dt></dt>
<dd>129 Flow binding rejected, reason
                                        unspecified
</dd>
<dt></dt>
<dd>130 Flow identification mobility
                                        option malformed
</dd>
<dt></dt>
<dd>131 BID not found
</dd>
<dt></dt>
<dd>132 FID not found
</dd>
<dt></dt>
<dd>133 Traffic selector format not
                                        supported
</dd>
<dt></dt>
<dd>134 Discard function not supported
</dd>
<dt></dt>
<dd>135 Forward function not
                                        supported
</dd>
</dl></blockquote>
                                
</dd>
<dt>Sub-options (optional)</dt>
<dd>
                                    <br />
 zero or more
                                    sub-options, defined in <a class='info' href='#suboptdef'>Section&nbsp;4.2.1<span> (</span><span class='info'>Flow Identification Sub-Options definition</span><span>)</span></a>
                                
</dd>
</dl></blockquote>
                        

</blockquote><p>
                
</p>
<a name="suboptdef"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.1"></a><h3>4.2.1.&nbsp;
Flow Identification Sub-Options definition</h3>

<p> Flow identification sub-options are encoded within the
                        remaining space of the flow identification mobility
                        option, using a sub-option type-length-value (TLV)
                        format as follows:
</p><br /><hr class="insert" />
<a name="subopt"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   | Sub-Opt Type  |Sub-Opt Length |   Sub-Option Data...
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;3: Flow Identification Sub-Option format&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>
                        </p>
<blockquote class="text">
<p>
                                </p>
<blockquote class="text"><dl>
<dt>Sub-opt Type</dt>
<dd>
                                        <br />
 8-bit unsigned
                                        integer indicating the sub-option Type.
                                        When processing a flow identification
                                        mobility option containing an option for
                                        which the sub-option Type value is not
                                        recognized by the receiver, the receiver
                                        MUST silently ignore and skip over the
                                        option, correctly handling any remaining
                                        sub-options in the same option. 
</dd>
<dt>Sub-opt Len</dt>
<dd>
                                        <br />
 8-bit unsigned
                                        integer, representing the length in
                                        octets of the flow identification
                                        sub-option. This field indicates the
                                        length of the sub-option not including
                                        the Sub-opt Type and Sub-opt Length
                                        fields. Note that Sub-opt Type '0'
                                        (<a class='info' href='#pad1'>Section&nbsp;4.2.1.1<span> (</span><span class='info'>Pad1</span><span>)</span></a>) is a special
                                        case that does not take a Sub-opt Length
                                        field.
</dd>
<dt>Sub-Option Data</dt>
<dd>
                                        <br />
 A variable
                                        length field that contains data specific
                                        to the sub-option 
</dd>
</dl></blockquote>
                            

</blockquote><p>
                    
</p>
<p> The following subsections specify the sub-option types
                        which are currently defined for use in the flow
                        identification option. Implementations MUST silently
                        ignore any sub-options that they do not understand.
</p>
<p> These sub-options may have alignment requirements.
                        Following the convention in <a class='info' href='#RFC3775'>[RFC3775]<span> (</span><span class='info'>Johnson, D., Perkins, C., and J. Arkko, &ldquo;Mobility Support in IPv6,&rdquo; June&nbsp;2004.</span><span>)</span></a>,
                        regarding mobility options, these sub-options are
                        aligned in a packet so that multi-octet values within
                        the sub-option Data field of each sub-option fall on
                        natural boundaries (i.e., fields of width n octets are
                        placed at an integer multiple of n octets from the start
                        of the header, for n = 1, 2, 4, or 8) .
</p>
<a name="pad1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.1.1"></a><h3>4.2.1.1.&nbsp;
Pad1</h3>

<p>The Pad1 sub-option does not have any alignment
                            requirements. Its format is as follows:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
       0
       0 1 2 3 4 5 6 7
      +-+-+-+-+-+-+-+-+
      | Sub-Opt Type  |
      +-+-+-+-+-+-+-+-+
</pre></div>
<p>
                            </p>
<blockquote class="text"><dl>
<dt>Sub-opt Type</dt>
<dd>
                                    <br />
 0 
</dd>
</dl></blockquote><p>
                        
</p>
<p> NOTE! the format of the Pad1 sub-option is a special
                            case - it has neither sub-option Length nor
                            sub-option Data fields.
</p>
<p> The Pad1 sub-option is used to insert one octet of
                            padding in the flow identification option. If more
                            than one octet of padding is required, the PadN
                            sub-option, described next, should be used rather
                            than multiple Pad1 sub-options.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.1.2"></a><h3>4.2.1.2.&nbsp;
PadN</h3>

<p> The PadN sub-option does not have any alignment
                            requirements. Its format is as follows:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
       0                   1
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+- - - - - - - - -
      | Sub-Opt Type  | Sub-Opt Len   | Option Data
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+- - - - - - - - -
</pre></div>
<p>
                            </p>
<blockquote class="text"><dl>
<dt>Sub-opt Type</dt>
<dd>
                                    <br />
 1 
</dd>
<dt>Sub-opt Len</dt>
<dd>
                                    <br />
 set to the length
                                    of the sub-option
</dd>
<dt>Sub-opt Data</dt>
<dd>
                                    <br />
 0 or more bytes set
                                    to 0 by the sender and ignored by the
                                    receiver.
</dd>
</dl></blockquote><p>
                        
</p>
<p>The PadN sub-option is used to insert two or more
                            octets of padding in the flow identification
                            mobility option. For N octets of padding, the
                            sub-option Length field contains the value N, and
                            the sub-option data consists of N-2 zero-valued
                            octets. PadN sub-option data MUST be ignored by the
                            receiver.
</p>
<a name="BIDRef"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.1.3"></a><h3>4.2.1.3.&nbsp;
Binding Reference Sub-option</h3>

<p>This section introduces the binding reference
                            sub-option, which may be included in the flow
                            identification mobility option. A node MUST NOT
                            include more than one binding reference sub-options
                            in a given flow binding identification option. The
                            binding reference sub-option includes one or more
                            BIDs defined in MCoA <a class='info' href='#RFC5648'>[RFC5648]<span> (</span><span class='info'>Wakikawa, R., Devarapalli, V., Tsirtsis, G., Ernst, T., and K. Nagami, &ldquo;Multiple Care-of Addresses Registration,&rdquo; October&nbsp;2009.</span><span>)</span></a>. When
                            this sub-option is included in the flow
                            identification mobility option it associates the
                            flow described with one or more registered BIDs.
</p>
<p>When binding a flow using this sub-option, the
                            binding identifier mobility option, defined in <a class='info' href='#RFC5648'>[RFC5648]<span> (</span><span class='info'>Wakikawa, R., Devarapalli, V., Tsirtsis, G., Ernst, T., and K. Nagami, &ldquo;Multiple Care-of Addresses Registration,&rdquo; October&nbsp;2009.</span><span>)</span></a>, MUST be included in either
                            the same or an earlier Binding Update (BU). The
                            binding reference sub-option is shown below. The
                            alignment requirement for this sub-option is 2n.
</p><br /><hr class="insert" />
<a name="BIDREFFormat"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |Sub-opt Type   |  Sub-Opt Len  |              BID              |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |     BID  ........
    +-+-+-+-+-+-+-+-+-+-
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;4: The Binding Reference sub-option&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>
                            </p>
<blockquote class="text">
<p>
                                    </p>
<blockquote class="text"><dl>
<dt>Sub-opt Type</dt>
<dd>
                                        <br />
 2 
</dd>
<dt>Sub-opt Len</dt>
<dd>
                                        <br />
 Variable
</dd>
<dt>BID</dt>
<dd>
                                        <br />
 A 16-bit
                                        unsigned integer indicating the BID
                                        that the mobile node wants to
                                        associate with the flow
                                        identification option. One or more
                                        BID fields can be included in this
                                        sub-option. Since each BID is 2
                                        bytes long, the value of the Sub-opt
                                        Len field indicates the number of
                                        BIDs present. Number of BIDs =
                                        Sub-opt Len/2. 
</dd>
</dl></blockquote>
                                

</blockquote><p>
                        
</p>
<a name="FDsub"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.1.4"></a><h3>4.2.1.4.&nbsp;
Traffic Selector sub-option</h3>

<p>The traffic selector sub-option includes the
                            parameters used to match packets for a specific flow
                            binding. A node MUST NOT include more than one
                            traffic selector sub-option in a given flow binding
                            identification option. 
</p><br /><hr class="insert" />
<a name="FDsubFormat"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |Sub-opt Type   |  Sub-Opt Len  |   TS Format   |   Reserved    |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |  Traffic Selector ...
    +-+-+-+-+-+-+-+-+-+-+-+

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;5: The Traffic Selector sub-option&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>
                            </p>
<blockquote class="text"><dl>
<dt>Sub-opt Type</dt>
<dd>
                                    <br />
 3 
</dd>
<dt>Sub-opt Len</dt>
<dd>
                                    <br />
 variable
</dd>
<dt>TS Format</dt>
<dd>
                                    <br />
 An 8-bit unsigned
                                    integer indicating the Traffic Selector
                                    Format. Value "0" is reserved and MUST NOT
                                    be used.
</dd>
<dt>Reserved</dt>
<dd>
                                    <br />
 An 8-bit reserved
                                    field. It MUST be set to zero by the sender
                                    and ignored by the receiver.
</dd>
<dt>Traffic Selector</dt>
<dd>
                                    <br />
 A variable length
                                    field, the format and content of which is
                                    out of scope for this specification. The
                                    traffic selector defined in <a class='info' href='#I-D.ietf-mext-binary-ts'>[I&#8209;D.ietf&#8209;mext&#8209;binary&#8209;ts]<span> (</span><span class='info'>Tsirtsis, G., Giaretta, G., Soliman, H., and N. Montavont, &ldquo;Traffic Selectors for Flow Bindings,&rdquo; February&nbsp;2010.</span><span>)</span></a> is
                                    mandatory to implement. 
</dd>
</dl></blockquote><p>
                        
</p>
<a name="FIDSum"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.2"></a><h3>4.2.2.&nbsp;
Flow Summary Mobility Option</h3>

<p>The flow summary mobility option is a new mobility option
                            <a class='info' href='#RFC3775'>[RFC3775]<span> (</span><span class='info'>Johnson, D., Perkins, C., and J. Arkko, &ldquo;Mobility Support in IPv6,&rdquo; June&nbsp;2004.</span><span>)</span></a>, which includes one or more
                        flow identifiers (FIDs) for the purpose of refreshing
                        their state. A node MUST NOT include more than one flow
                        summary mobility option in a given binding update
                        message. The alignment requirement for this option is
                        2n.
</p><br /><hr class="insert" />
<a name="FIDSumFormat"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    | Option Type   |  Option Len   |              FID              |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |     FID  ........
    +-+-+-+-+-+-+-+-+-+-
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;6: The Flow Summary Mobility Option&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>
                        </p>
<blockquote class="text">
<p>
                                </p>
<blockquote class="text"><dl>
<dt>Option Type</dt>
<dd>
                                        <br />
To be assigned
                                        by IANA
</dd>
<dt>Option Length</dt>
<dd>
                                        <br />
 Length of the
                                        option in octets as per <a class='info' href='#RFC3775'>[RFC3775]<span> (</span><span class='info'>Johnson, D., Perkins, C., and J. Arkko, &ldquo;Mobility Support in IPv6,&rdquo; June&nbsp;2004.</span><span>)</span></a>
                                    
</dd>
<dt>FID</dt>
<dd>
                                        <br />
 A 16-bit
                                        unsigned integer indicating a registered
                                        FID. One or more FID fields can be
                                        included in this option. Number of FIDs
                                        = Option Len/2
</dd>
</dl></blockquote>
                            

</blockquote><p>
                    
</p>
<a name="BCext"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
Flow Bindings entries list and its relationship to Binding Cache</h3>

<p> The conceptual mobile IPv6 binding cache was defined in
                        <a class='info' href='#RFC3775'>[RFC3775]<span> (</span><span class='info'>Johnson, D., Perkins, C., and J. Arkko, &ldquo;Mobility Support in IPv6,&rdquo; June&nbsp;2004.</span><span>)</span></a> to identify the mobile IP state
                    maintained by the mobile node, mobility agent, and
                    correspondent node. The binding cache includes, between
                    others, the mobile node's home address, the registered
                    care-of address, and the lifetime of the binding. The
                    binding cache has been extended by <a class='info' href='#RFC5648'>[RFC5648]<span> (</span><span class='info'>Wakikawa, R., Devarapalli, V., Tsirtsis, G., Ernst, T., and K. Nagami, &ldquo;Multiple Care-of Addresses Registration,&rdquo; October&nbsp;2009.</span><span>)</span></a>
                    to include more than one care-of addresses and to associate
                    each of them with a Binding Identifier (BID).
</p>
<p>This specification does not modify the mobile IPv6 binding
                    cache any further.
</p>
<p>Flow bindings can be thought of as a conceptual list of
                    entries that is separate from the binding cache. The flow
                    bindings list contains an entry for each of the registered
                    flow bindings. Flow binding entries can point to an entry in
                    the binding cache by means of the BID. Each flow binding
                    entry includes the following parameters :
</p>
<p>
                    </p>
<ul class="text">
<li>FID (Flow Identifier): For a given mobile node,
                            identified by its primary home address, the FID MUST
                            uniquely identify an entry, i.e. a unique flow
                            binding. Each mobile node can only have a single
                            entry identified by a given FID at any one time. A
                            given FID number space is used for all the addresses
                            associated to a given MN by the HA (e.g., via <a class='info' href='#RFC3963'>[RFC3963]<span> (</span><span class='info'>Devarapalli, V., Wakikawa, R., Petrescu, A., and P. Thubert, &ldquo;Network Mobility (NEMO) Basic Support Protocol,&rdquo; January&nbsp;2005.</span><span>)</span></a>). Different mobile nodes use
                            the same FID number space. 
</li>
<li>A Traffic Selector: Included in a traffic selector
                            sub-option. 
</li>
<li>BID(s): The list of BIDs associated with the entry as
                            defined by the binding reference sub-option included
                            in the FID option that created it.
</li>
<li>Action: The action associated with a given entry as
                            defined by the Action field of the FID option that
                            created it
</li>
<li>Active/Inactive flag: This flag indicates whether the
                            entry is active or inactive.
</li>
<li>FID-PRI: This field indicates the priority of the
                            flow and is used to break the tie between
                            overlapping flows.
</li>
</ul><p>
                
</p>
<p>The flow bindings list is associated with a given mobile
                    node, and the correspondent binding cache. An entry in the
                    flow bindings list, however, is identified by the FID and
                    the list is ordered according to the FID-PRI field as
                    defined in the FID option that created each entry.
</p>
<p> For entries that take BIDs (i.e., entries that do not
                    indicate a 'Discard' action), a valid BID is required to
                    make the entry 'Active'. If all of the BIDs pointed to by a
                    given entry are deregistered <a class='info' href='#RFC5648'>[RFC5648]<span> (</span><span class='info'>Wakikawa, R., Devarapalli, V., Tsirtsis, G., Ernst, T., and K. Nagami, &ldquo;Multiple Care-of Addresses Registration,&rdquo; October&nbsp;2009.</span><span>)</span></a>, the
                    flow binding entry becomes 'Inactive', in other words it
                    does not affect data traffic. Note that if the action
                    parameter in an entry indicates 'Forward' then the entry
                    becomes 'Inactive' only if all of the BIDs are deregistered.
                    If only some of the BIDs are still valid, the invalid BIDs
                    are simply ignored.
</p>
<p>Also note that the state described in this section is
                    maintained by the mobile node as well as in mobility agents
                    and correspondent nodes. As such the mobile node is fully
                    aware of which are the valid BIDs at any time and which flow
                    binding entries are active/inactive. <a class='info' href='#operation'>Section&nbsp;5<span> (</span><span class='info'>Protocol operations</span><span>)</span></a> defines how these flow binding
                    entries are manipulated by the mobile node in detail.
</p>
<p>As an example the following represents an ordered flow
                    binding entry table for a mobile node that has registered
                    multiple care-of addresses and flow bindings.
</p><br /><hr class="insert" />
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
FID-PRI     FID    Traffic Selector    BIDs    Action       A/I
-------     ---    ----------------    ----    -------     ------
   10        4           TCP            2      Forward      Active
   20        3       srcAddr=IPx       N/A     Discard      Active
   30        2       srcAddr=IPy        4      Forward      Inactive
   40        5           UDP           1,3     Forward      Active

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Ordered Flow Binding Entries&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>
</p>
<p>According to the above list of flow binding entries, all TCP
                    traffic will match the first entry, and according to the
                    Action indicated it will be forwarded to BID2, corresponding
                    to a given care-of address (IP3), as shown below. Any
                    traffic that is not TCP, but has as source address IPx will
                    match the second entry, and according to the associated
                    Action it will be discarded. Note that any TCP traffic with
                    source address IPx will match the first entry and thus it
                    will be forwarded as per that entry. 
</p>
<p> The third entry is marked as Inactive since the BID 4 does
                    not exist in the ordered list of BID entries below. Inactive
                    entries do not affect traffic, i.e., packets are not matched
                    against them.
</p>
<p> Any UDP traffic that does not match any of the earlier
                    entries will match the forth rule and according to the
                    Action indicated, it will be replicated and forwarded to
                    BIDs 1 and 3, corresponding to care-of addresses IP1 and IP2
                    shown below. 
</p>
<p>Finally any remaining packets that do not match any of the
                    entries above will be simply forwarded to the care-of
                    address indicated by the highest order BID in the table
                    below. In the example, such packets will be forwarded to
                    BID1 corresponding to care-of address IP1.
</p><br /><hr class="insert" />
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
 BID-PRI          BID        CoA
---------         ---        ---
    20             1         IP1
    30             3         IP2
    30             2         IP3
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Ordered BID Entries&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>Mobility agent and corresponding node implementations should
                    take care to avoid flow binding rules affecting the
                    fundamental operation of Mobile IPv6 and its extensions. In
                    particular, flow binding rules MUST NOT apply to Mobile IPv6
                    signaling generated by mobility agents and corresponding
                    nodes communicating with a given mobile node, since that
                    could adversely affect the operation of the protocol. Other,
                    non Mobile IPv6 traffic generated by these entities SHOULD
                    be matched against the mobile node's flow binding rules as
                    normal.
</p>
<a name="operation"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Protocol operations</h3>

<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
General</h3>

<p>This specification introduces a flow bindings list of entries
                    and an ordered list of flow binding identifiers, allowing
                    mobile nodes to associate flow binding policies with the
                    registered care-of addresses.
</p>
<p>The flow identification mobility option defines how the
                    mobile node can control a set of flow binding entries
                    maintained in a mobility agent, or correspondent node. The
                    fields of the flow identification mobility option are
                    necessary for ordering flow identification mobility options,
                    indicating the sort of action that should be undertaken to
                    the recipient's flow binding list of entries or for carrying
                    the results of such a petition. 
</p>
<p>This specification allows mobile nodes to direct flows to a
                    particular care-of address. The granularity of what
                    constitutes a flow depends on the traffic selector used. 
</p>
<p>The remainder of this section discusses how mobile nodes can
                    use the options and sub-options defined in this document
                    when sending binding updates to the correspondent node, home
                    agent, or mobility anchor point. In addition, refresh,
                    deletion, and modification of flow binding entries are all
                    discussed below.
</p>
<a name="defaultbinding"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.1"></a><h3>5.1.1.&nbsp;
Preferred Care-of address</h3>

<p>Any node that supports this specification MUST maintain
                        an ordered list of care-of addresses for each mobile
                        node it maintains a list of flow bindings for. The
                        ordered list of care-of addresses is built based on the
                        BID-PRI field of the binding identifier mobility option
                        (see <a class='info' href='#BIDUpdate'>Section&nbsp;4.1<span> (</span><span class='info'>Definition Update for Binding Identifier Mobility Option</span><span>)</span></a>).
</p>
<p>The ordered list of BIDs is used to determine how to
                        forward a packet to a given mobile node when the packet
                        does not match any of the flow binding entries defined
                        in <a class='info' href='#BCext'>Section&nbsp;4.3<span> (</span><span class='info'>Flow Bindings entries list and its relationship to Binding Cache</span><span>)</span></a>. A packet that does not match
                        any of the flow binding entries SHOULD be forwarded to
                        the care-of address identified by the BID with the
                        highest priority i.e., lowest BID-PRI value.
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Mobile Node Considerations</h3>

<p>This specification allows the mobile node to maintain several
                    bindings with its mobility agent, and correspondent nodes
                    and to direct packets to different care-of addresses
                    according to flow bindings. This section details the mobile
                    node operations necessary to implement this specification.
</p>
<p>The mobility agent and correspondent node list of flow
                    bindings is manipulated by the mobile node, via flow
                    identification and flow summary mobility options included in
                    binding update messages. Each flow binding update can add,
                    modify, refresh, or delete a given binding. More than one
                    flow identification mobility options MAY be included in the
                    same binding update but each of them MUST include a
                    different FID. In other words, two flow identification
                    options in the same message can not be about the same flow
                    binding. 
</p>
<p>All flow binding state MUST be refreshed in every binding
                    update the mobile node sends. Any previously registered flow
                    binding that is not included in a given binding update will
                    be deleted. So, any flow bindings that are not added or
                    modified by a flow identification mobility option, but have
                    previously registered and need to be maintained MUST be
                    included in a flow summary mobility option. Only one flow
                    summary mobility option can be included in a given binding
                    update.
</p>
<a name="sendBID"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2.1"></a><h3>5.2.1.&nbsp;
Sending BU with BID Options</h3>

<p>This specification (see <a class='info' href='#BIDUpdate'>Section&nbsp;4.1<span> (</span><span class='info'>Definition Update for Binding Identifier Mobility Option</span><span>)</span></a>)
                        updates the definition of the binding identifier
                        mobility option, originally defined in <a class='info' href='#RFC5648'>[RFC5648]<span> (</span><span class='info'>Wakikawa, R., Devarapalli, V., Tsirtsis, G., Ernst, T., and K. Nagami, &ldquo;Multiple Care-of Addresses Registration,&rdquo; October&nbsp;2009.</span><span>)</span></a>. According to this specification
                        the BID option includes a BID-PRI field assigning each
                        registered care-of address a priority, and thus placing
                        them in an ordered list as also described in <a class='info' href='#BCext'>Section&nbsp;4.3<span> (</span><span class='info'>Flow Bindings entries list and its relationship to Binding Cache</span><span>)</span></a>. 
</p>
<p>To ensure backwards compatibility with <a class='info' href='#RFC5648'>[RFC5648]<span> (</span><span class='info'>Wakikawa, R., Devarapalli, V., Tsirtsis, G., Ernst, T., and K. Nagami, &ldquo;Multiple Care-of Addresses Registration,&rdquo; October&nbsp;2009.</span><span>)</span></a> for the purpose of this
                        specification the field BID-PRI MUST NOT be set to zero.
                        Receiver implementation of this specification will take
                        a BID-PRI field of value zero as an indication that this
                        is a BID option of the format defined in <a class='info' href='#RFC5648'>[RFC5648]<span> (</span><span class='info'>Wakikawa, R., Devarapalli, V., Tsirtsis, G., Ernst, T., and K. Nagami, &ldquo;Multiple Care-of Addresses Registration,&rdquo; October&nbsp;2009.</span><span>)</span></a>.
</p>
<p>Mobile nodes supporting this specification MUST use the
                        BID option format defined in <a class='info' href='#BIDUpdate'>Section&nbsp;4.1<span> (</span><span class='info'>Definition Update for Binding Identifier Mobility Option</span><span>)</span></a>.
                        Mobile nodes MUST also register all care-of addresses
                        using the updated BID option format, either in the same
                        BU as any flow identification mobility options using
                        them, or in earlier BUs.
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2.2"></a><h3>5.2.2.&nbsp;
Sending BU with Flow Identification Mobility Options</h3>

<a name="addingFDs"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2.2.1"></a><h3>5.2.2.1.&nbsp;
New Flow Bindings</h3>

<p>When adding a new flow binding, a mobile node sends
                            the flow identification mobility option in the
                            binding update, with the FID field set to a value
                            that is not already present in the list of flow
                            binding entries maintained by the receiver. The
                            care-of address(es) associated with each flow
                            identification mobility options in the binding
                            update, must be logically registered by this binding
                            update, or must have already been registered by the
                            receiver of the binding update in an earlier binding
                            update, as defined in <a class='info' href='#sendBID'>Section&nbsp;5.2.1<span> (</span><span class='info'>Sending BU with BID Options</span><span>)</span></a>.
</p>
<p>The flow identification mobility option MUST include
                            a unique flow identifier in the FID field. The FID
                            needs only be unique for the receiver of the binding
                            update and for the same sender, i.e. the same FID
                            can be used across different receivers of the
                            binding update, for the same sender. </p>
<blockquote class="text">
<p>The FID-PRI field is set to the desired
                                    unique priority of the FID, defining the
                                    order of the flow binding to be added in the
                                    list of flow binding entries as defined in
                                        <a class='info' href='#BCext'>Section&nbsp;4.3<span> (</span><span class='info'>Flow Bindings entries list and its relationship to Binding Cache</span><span>)</span></a>.
</p>
<p>The Action field is set to one of the defined
                                    action codes (see <a class='info' href='#FIDoption'>Section&nbsp;4.2<span> (</span><span class='info'>Flow Identification Mobility Option</span><span>)</span></a>).
</p>
<p>The Status field is set to zero in all
                                    binding update messages.
</p>
</blockquote><p>
                        
</p>
<p>Since this flow identification mobility option is
                            requesting the addition of a new flow binding in the
                            list of flow bindings maintained by the receiver,
                            the mobile node MUST include exactly one Traffic
                            Selector sub-option (see <a class='info' href='#FDsub'>Section&nbsp;4.2.1.4<span> (</span><span class='info'>Traffic Selector sub-option</span><span>)</span></a>)
                            describing the flow associated with the new flow
                            binding. The TS Format field of the Traffic Selector
                            sub-option MUST be set to the non-zero value of the
                            format used by the mobile node.
</p>
<p>The mobile node MAY also include up to one BID
                            Reference sub-option (see <a class='info' href='#BIDRef'>Section&nbsp;4.2.1.3<span> (</span><span class='info'>Binding Reference Sub-option</span><span>)</span></a>)
                            to associate the flow binding with a given set of
                            BIDs and corresponding CoAs. Depending on the Action
                            field of the flow identification mobility option,
                            the following rules MUST be followed with respect to
                            the binding reference sub-option: </p>
<blockquote class="text">
<p>- if the Action indicates 'Discard', the
                                    binding reference sub-option SHOULD NOT be
                                    included. If it is included it will be
                                    ignored by the receiver.
</p>
<p>- if the Action indicates 'Forward', a single
                                    binding reference sub-option with one or
                                    more BIDs MUST be included. 
</p>
</blockquote><p>
                        
</p>
<a name="modifyingFDs"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2.2.2"></a><h3>5.2.2.2.&nbsp;
Updating Flow Bindings</h3>

<p>Flow binding modification is essentially a process
                            where parameters associated with an existing flow
                            binding in the list of flow binding entries is
                            replaced by parameters included in the flow
                            identification mobility option, and the same FID is
                            maintained. With this procedure the mobile node can
                            change the action, the priority, the BID, and/or the
                            traffic selector associated with a flow binding.
</p>
<p>To modify an existing flow binding the mobile node
                            MUST send a binding update with a flow
                            identification option, with the FID field set to one
                            of the FID values already in the list of flow
                            binding entries. </p>
<blockquote class="text">
<p>The FID-PRI and Action fields MUST be set to
                                    the priority value for the flow binding
                                    entry.
</p>
<p>The Status field is set to zero since this
                                    option is in a binding update.
</p>
</blockquote><p>
                        
</p>
<p>The mobile node MAY include exactly one traffic
                            selector sub-option (see <a class='info' href='#FDsub'>Section&nbsp;4.2.1.4<span> (</span><span class='info'>Traffic Selector sub-option</span><span>)</span></a>)
                            describing the updated flow to be associated with
                            the flow binding. The mobile node MAY, however, omit
                            the traffic selector sub-option if it wants the
                            traffic selector currently associated with the flow
                            binding entry identified by the FID field to be
                            maintained.
</p>
<p>The mobile node MAY include exactly one binding
                            reference sub-option (see <a class='info' href='#BIDRef'>Section&nbsp;4.2.1.3<span> (</span><span class='info'>Binding Reference Sub-option</span><span>)</span></a>)
                            to associate the existing flow binding with a new
                            set of CoAs. If the mobile node includes a binding
                            reference sub-option then it should follow the rules
                            described in <a class='info' href='#addingFDs'>Section&nbsp;5.2.2.1<span> (</span><span class='info'>New Flow Bindings</span><span>)</span></a>. The mobile
                            node MAY omit the binding reference sub-option if it
                            wants the BIDs currently associated with the flow
                            binding entry identified by the FID field to be
                            maintained. 
</p>
<p>Note that it is also possible for the mobile node to
                            effectively modify the effect of a flow binding
                            entry without actually changing the entry itself.
                            This can be done by changing the CoA associated with
                            a given BID, which is a process defined in detail in
                                <a class='info' href='#RFC5648'>[RFC5648]<span> (</span><span class='info'>Wakikawa, R., Devarapalli, V., Tsirtsis, G., Ernst, T., and K. Nagami, &ldquo;Multiple Care-of Addresses Registration,&rdquo; October&nbsp;2009.</span><span>)</span></a>.
</p>
<a name="refreshFDs"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2.3"></a><h3>5.2.3.&nbsp;
Sending BU with a Flow Summary Option</h3>

<p>When the mobile node sends a binding update it MUST
                        refresh all flow bindings it wants to maintain even if
                        it does not want to change any of their parameters.
</p>
<p>To refresh an existing flow binding the mobile node MUST
                        send a binding update with a flow summary option. The
                        flow summary option MUST include one or more FID fields
                        as indicated in <a class='info' href='#FIDSum'>Section&nbsp;4.2.2<span> (</span><span class='info'>Flow Summary Mobility Option</span><span>)</span></a>. Each FID field
                        included MUST be set to one of the FID values already in
                        the list of flow binding entries. 
</p>
<p>Any flow bindings (active or inactive) that are not
                        included in a binding update will be removed from the
                        list of flow binding entries.
</p>
<p>Note that any inactive flow bindings, i.e., flow bindings
                        without associated BIDs that are marked as Inactive in
                        the list of flow binding entries (see <a class='info' href='#BCext'>Section&nbsp;4.3<span> (</span><span class='info'>Flow Bindings entries list and its relationship to Binding Cache</span><span>)</span></a>), MUST also be refreshed, or
                        modified, to be maintained. If they are not included in
                        a BU they will be removed.
</p>
<a name="deletingFDs"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2.4"></a><h3>5.2.4.&nbsp;
Removing flow bindings</h3>

<p>Removal of flow binding entries is performed implicitly
                        by omission of a given FID from a binding update.
</p>
<p>To remove a flow binding the MN simply sends a binding
                        update that includes flow identification and flow
                        summary mobility options for all the FIDs that need to
                        be refreshed, modified, or added, and simply omits any
                        FIDs that need to be removed.
</p>
<p>Note that a mobile node can also render a flow binding
                        inactive by removing the BIDs associated with it,
                        without removing the flow binding itself. The procedure
                        for removing a BID is defined in detail in <a class='info' href='#RFC5648'>[RFC5648]<span> (</span><span class='info'>Wakikawa, R., Devarapalli, V., Tsirtsis, G., Ernst, T., and K. Nagami, &ldquo;Multiple Care-of Addresses Registration,&rdquo; October&nbsp;2009.</span><span>)</span></a>.
</p>
<p>When all the BIDs associated with a flow binding are
                        removed, the flow binding MUST be marked as inactive in
                        the list of flow binding entries as shown in <a class='info' href='#BCext'>Section&nbsp;4.3<span> (</span><span class='info'>Flow Bindings entries list and its relationship to Binding Cache</span><span>)</span></a>. In other words the state
                        associated with the flow binding MUST be maintained but
                        it does no longer affect the mobile node's traffic. The
                        MN can return an inactive flow binding to the active
                        state by using the flow binding modification process
                        described in <a class='info' href='#modifyingFDs'>Section&nbsp;5.2.2.2<span> (</span><span class='info'>Updating Flow Bindings</span><span>)</span></a>, to associate
                        it again with one or more valid BIDs. Remember that flow
                        bindings indicating a 'Discard' action do not take BIDs
                        and thus cannot be rendered inactive. Instead these
                        entries can only be removed by omitting their FID from a
                        subsequent BU.
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2.5"></a><h3>5.2.5.&nbsp;
Returning Home</h3>

<p>This specification is compatible to the home registration
                        procedures defined in <a class='info' href='#RFC3775'>[RFC3775]<span> (</span><span class='info'>Johnson, D., Perkins, C., and J. Arkko, &ldquo;Mobility Support in IPv6,&rdquo; June&nbsp;2004.</span><span>)</span></a> and <a class='info' href='#RFC5648'>[RFC5648]<span> (</span><span class='info'>Wakikawa, R., Devarapalli, V., Tsirtsis, G., Ernst, T., and K. Nagami, &ldquo;Multiple Care-of Addresses Registration,&rdquo; October&nbsp;2009.</span><span>)</span></a>. More specifically, if the mobile
                        node performs an <a class='info' href='#RFC3775'>[RFC3775]<span> (</span><span class='info'>Johnson, D., Perkins, C., and J. Arkko, &ldquo;Mobility Support in IPv6,&rdquo; June&nbsp;2004.</span><span>)</span></a> style
                        deregistration, all of its bindings, including flow
                        bindings are deleted. If the mobile node, however,
                        performs an <a class='info' href='#RFC5648'>[RFC5648]<span> (</span><span class='info'>Wakikawa, R., Devarapalli, V., Tsirtsis, G., Ernst, T., and K. Nagami, &ldquo;Multiple Care-of Addresses Registration,&rdquo; October&nbsp;2009.</span><span>)</span></a> style home
                        registration, then the home link is associated with a
                        specific BID and so, as far as this specification is
                        concerned, it is treated as any other link associated
                        with a given BID.
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2.6"></a><h3>5.2.6.&nbsp;
Receiving Binding Acknowledgements</h3>

<p>According to <a class='info' href='#RFC3775'>[RFC3775]<span> (</span><span class='info'>Johnson, D., Perkins, C., and J. Arkko, &ldquo;Mobility Support in IPv6,&rdquo; June&nbsp;2004.</span><span>)</span></a> all nodes are
                        required to silently ignore mobility options not
                        understood while processing binding updates. As such a
                        mobile node receiving a Binding Acknowledgement in
                        response to the transmission of a binding update MUST
                        determine if the Binding Acknowledgement contains a copy
                        of every flow identification mobility options included
                        in the binding update. A Binding Acknowledgement without
                        flow identification option(s), in response to a Binding
                        Update with flow identification mobility option, would
                        indicate inability (or unwillingness) on behalf of the
                        source node to support the extensions presented in this
                        document.
</p>
<p>If a received Binding Acknowledgement contains a copy of
                        each flow identification mobility option that was sent
                        within the binding update, the status field of each flow
                        identification option indicates the status of the flow
                        binding on the distant node.
</p>
<a name="mn-rrp"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2.7"></a><h3>5.2.7.&nbsp;
Return Routability Procedure</h3>

<p>A mobile node may perform route optimization with
                        correspondent nodes as defined in <a class='info' href='#RFC3775'>[RFC3775]<span> (</span><span class='info'>Johnson, D., Perkins, C., and J. Arkko, &ldquo;Mobility Support in IPv6,&rdquo; June&nbsp;2004.</span><span>)</span></a>. Route optimization allows a mobile node to bind a
                        care-of address to a home address in order to allow the
                        correspondent node to direct the traffic to the current
                        location of the mobile node. Before sending a Binding
                        Update to correspondent node, the Return Routability
                        Procedure needs to be performed between the mobile node
                        and the correspondent node.This procedure is not
                        affected by the extensions defined in this document.
</p>
<a name="HAops"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3"></a><h3>5.3.&nbsp;
HA, MAP, and CN Considerations</h3>

<p>This specification allows the mobility agents (Home Agents
                    and Mobility Anchor Points), and correspondent nodes to
                    maintain several flow bindings for a given home address and
                    to direct packets to different care-of addresses according
                    to flow bindings. This section details the home agent
                    operations necessary to implement this specification. These
                    operations are identical for MAPs and CNs unless otherwise
                    stated.
</p>
<p>Note that route optimization is only defined for mobile nodes
                    (MIPv6 <a class='info' href='#RFC3775'>[RFC3775]<span> (</span><span class='info'>Johnson, D., Perkins, C., and J. Arkko, &ldquo;Mobility Support in IPv6,&rdquo; June&nbsp;2004.</span><span>)</span></a>), and not mobile routers
                    (NEMOv6 <a class='info' href='#RFC3963'>[RFC3963]<span> (</span><span class='info'>Devarapalli, V., Wakikawa, R., Petrescu, A., and P. Thubert, &ldquo;Network Mobility (NEMO) Basic Support Protocol,&rdquo; January&nbsp;2005.</span><span>)</span></a>). Thus, these sections only
                    apply to correspondent nodes with respect to mobile nodes
                    and not for mobile routers.
</p>
<a name="recvBID"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.1"></a><h3>5.3.1.&nbsp;
Handling Binding Identifier Mobility Options</h3>

<p>This specification (see <a class='info' href='#BIDUpdate'>Section&nbsp;4.1<span> (</span><span class='info'>Definition Update for Binding Identifier Mobility Option</span><span>)</span></a>)
                        updates the definition of the binding identifier
                        mobility option, originally defined in <a class='info' href='#RFC5648'>[RFC5648]<span> (</span><span class='info'>Wakikawa, R., Devarapalli, V., Tsirtsis, G., Ernst, T., and K. Nagami, &ldquo;Multiple Care-of Addresses Registration,&rdquo; October&nbsp;2009.</span><span>)</span></a>. According to this specification
                        the BID option includes a BID-PRI field assigning each
                        registered care-of address a priority, and thus placing
                        them in an ordered list (see <a class='info' href='#BCext'>Section&nbsp;4.3<span> (</span><span class='info'>Flow Bindings entries list and its relationship to Binding Cache</span><span>)</span></a>). 
</p>
<p>Home agents receiving BUs including BID options and flow
                        identification options MUST logically process BID
                        options first. This is because BID Reference sub-options
                        included in the flow identification mobility options
                        might refer to BIDs defined in BID options included in
                        the same message.
</p>
<p>The BID option is processed as defined in <a class='info' href='#RFC5648'>[RFC5648]<span> (</span><span class='info'>Wakikawa, R., Devarapalli, V., Tsirtsis, G., Ernst, T., and K. Nagami, &ldquo;Multiple Care-of Addresses Registration,&rdquo; October&nbsp;2009.</span><span>)</span></a> but then the BID to care-of
                        address mapping is placed in an ordered list according
                        to the BID-PRI field of the BID option.
</p>
<p>Binding Identifier registrations and deregistrations
                        indirectly affect the MN's flow binding entries. The
                        home agent MUST update the flow binding entries table
                        accordingly as BIDs are added or removed ( <a class='info' href='#RFC5648'>[RFC5648]<span> (</span><span class='info'>Wakikawa, R., Devarapalli, V., Tsirtsis, G., Ernst, T., and K. Nagami, &ldquo;Multiple Care-of Addresses Registration,&rdquo; October&nbsp;2009.</span><span>)</span></a>). For example, as discussed in
                            <a class='info' href='#BCext'>Section&nbsp;4.3<span> (</span><span class='info'>Flow Bindings entries list and its relationship to Binding Cache</span><span>)</span></a>, if all of the BIDs
                        associated with a given flow binding entry are removed
                        (i.e., become invalid) the entry MUST be marked as
                        inactive. While if any of the invalid BIDs associated
                        with an inactive flow binding entry are registered
                        (i.e., become valid), the entry MUST be marked as
                        active.
</p>
<a name="HAops-receiving2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.2"></a><h3>5.3.2.&nbsp;
Handling Flow Identification Mobility Options</h3>

<p>When the home agent receives a binding update which
                        includes at least one flow identification mobility
                        option, it first performs the operation described in
                        section 10.3.1 of RFC3775, followed by the operations
                        defined in <a class='info' href='#recvBID'>Section&nbsp;5.3.1<span> (</span><span class='info'>Handling Binding Identifier Mobility Options</span><span>)</span></a> of this document. 
</p>
<p>Home agents that do not support this specification will
                        ignore the flow identification mobility options and all
                        their sub-options, having no effect on the operation of
                        the rest of the protocol.
</p>
<p>If the binding update is accepted, and the home agent is
                        willing to support flow bindings for this MN, the home
                        agent checks the flow identification mobility options. 
</p>
<p>If more than one flow identification mobility option in
                        the same BU, has the same value in the FID field, all
                        the flow identification mobility options MUST be
                        rejected.
</p>
<p>If all FID fields have different values the flow
                        identification mobility options can be processed further
                        and in any order, as defined by the following
                        subsections.
</p>
<a name="BUaddingFDs"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.2.1"></a><h3>5.3.2.1.&nbsp;
Handling new FIDs</h3>

<p> If the FID field of the flow identification mobility
                            option is not already present in the list of flow
                            binding entries for this mobile node, then this is a
                            request for a new entry. 
</p>
<p>If the flow identification mobility option does not
                            include a traffic selector sub-option, the home
                            agent MUST reject this request by copying the flow
                            identification mobility option in the BA, and
                            setting the Status field to the value defined in
                                <a class='info' href='#FIDformat'>Figure&nbsp;2<span> (</span><span class='info'>The Flow Identification Mobility Option</span><span>)</span></a> for "Flow
                            identification option malformed". 
</p>
<p>If the flow identification option does include a
                            traffic selector sub-option, but the format
                            indicated in the TS Format field is not supported,
                            the home agent MUST reject this request by copying
                            the flow identification mobility option in the BA,
                            and setting the Status field to the value defined in
                                <a class='info' href='#FIDformat'>Figure&nbsp;2<span> (</span><span class='info'>The Flow Identification Mobility Option</span><span>)</span></a> for "Traffic Selector
                            format not supported". 
</p>
<p>Then the home agent MUST check the Action field in
                            combination with the Binding Reference sub-option if
                            present.
</p>
<p>- if the Action indicates 'Discard', </p>
<blockquote class="text">
<p>Any binding reference sub-options that might
                                    be present SHOULD be ignored.
</p>
<p>The home agent SHOULD add a new entry in the
                                    mobile node's list of flow binding entries,
                                    as defined below.
</p>
</blockquote><p>
                        
</p>
<p>- if the Action indicates 'Forward",</p>
<blockquote class="text">
<p>If the Binding reference sub-option is not
                                    included, the home agent MUST reject this
                                    request by copying the flow identification
                                    mobility option in the BA, and setting the
                                    Status field to the value defined for "Flow
                                    identification mobility option malformed" in
                                        <a class='info' href='#FIDoption'>Section&nbsp;4.2<span> (</span><span class='info'>Flow Identification Mobility Option</span><span>)</span></a>.
</p>
<p>If the binding reference sub-option is
                                    present and includes one or more BIDs that
                                    are not present in the binding cache of the
                                    mobile node the home agent MUST reject this
                                    request by copying the flow identification
                                    option in the BA, and setting the Status
                                    field to the value defined for "BID not
                                    found" in <a class='info' href='#FIDoption'>Section&nbsp;4.2<span> (</span><span class='info'>Flow Identification Mobility Option</span><span>)</span></a>. 
</p>
<p>If the binding reference sub-option is
                                    present and includes one or more BIDs, and
                                    the BIDs exist in the mobile node's binding
                                    cache, the home agent SHOULD add a new entry
                                    in the mobile node's list of flow binding
                                    entries, as defined below.
</p>
</blockquote><p>
                        
</p>
<p>When the home agent decides to add an entry in the
                            mobile node's list of flow binding entries, as
                            discussed above, it MUST do it according to the
                            following rules: The entry MUST be placed according
                            to the order indicated by the FID-PRI field of the
                            flow identification mobility option and it MUST include:</p>
<blockquote class="text">
<p>the FID as a key to the entry
</p>
<p>The traffic selector included in the
                                    corresponding sub-option
</p>
<p>the action indicated in the Action field
</p>
<p>the BIDs, depending on action field,
                                    indicated in the binding reference
                                    sub-option
</p>
<p>the entry MUST be marked as Active, as shown
                                    in <a class='info' href='#BCext'>Section&nbsp;4.3<span> (</span><span class='info'>Flow Bindings entries list and its relationship to Binding Cache</span><span>)</span></a>
                                
</p>
</blockquote><p>
                        
</p>
<a name="HAmodifyingFDs"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.2.2"></a><h3>5.3.2.2.&nbsp;
Handling known FIDs</h3>

<p> If the FID field of the flow identification mobility
                            option is already present in the list of flow
                            binding entries for this mobile node, then this is a
                            request to update the existing entry. 
</p>
<p>The flow binding modification is essentially a
                            process where parameters associated with an existing
                            flow binding entry are replaced by the parameters
                            included in a flow identification mobility option
                            with the same FID as the existing entry.
</p>
<p>The home agent MUST: </p>
<blockquote class="text">
<p>Change the priority of the entry according to
                                    the FID-PRI field of the flow identification
                                    mobility option.
</p>
<p>Change the action associated with the entry
                                    according to the Action field of the flow
                                    identification mobility option.
</p>
</blockquote><p>
                        
</p>
<p>Since this flow identification mobility option is
                            designed to update an existing entry it may or may
                            not include a traffic selector sub-option. </p>
<blockquote class="text">
<p>If a traffic selector sub-option is not
                                    included in the flow identification mobility
                                    option, then the traffic selector already
                                    associated with entry MUST be maintained,
</p>
<p>otherwise the traffic selector in the entry
                                    MUST be replaced by the traffic selector in
                                    the sub-option.
</p>
</blockquote><p>
                        
</p>
<p>Like <a class='info' href='#BUaddingFDs'>Section&nbsp;5.3.2.1<span> (</span><span class='info'>Handling new FIDs</span><span>)</span></a>, if the Action
                            field in the flow identification mobility option is
                            set to 'Discard' if a binding reference sub-option
                            is included in the option, it SHOULD be ignored; and
                            any BIDs associated with the existing flow binding
                            entry SHOULD be removed.
</p>
<p> Unlike <a class='info' href='#BUaddingFDs'>Section&nbsp;5.3.2.1<span> (</span><span class='info'>Handling new FIDs</span><span>)</span></a>, however, if the
                            Action field in the flow identification mobility
                            option is set to 'Forward', and since this flow
                            identification mobility option is designed to update
                            an existing entry, it may or may not include a
                            binding reference sub-option. </p>
<blockquote class="text">
<p>If a binding reference sub-option is not
                                    included in the flow identification mobility
                                    option, then the BIDs already associated
                                    with entry MUST be maintained,
</p>
<p>otherwise the BIDs in the entry MUST be
                                    replaced by the BIDs in the sub-option.
</p>
</blockquote><p>
                        
</p>
<a name="HAFIDSum"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.3"></a><h3>5.3.3.&nbsp;
Handling Flow Summary Mobility Option</h3>

<p>When the home agent receives a binding update which
                        includes a flow summary mobility option, it first
                        performs the operation described in section 10.3.1 of
                        RFC3775. Binding update messages including more than one
                        flow summary mobility option MUST be rejected.
</p>
<p> An <a class='info' href='#RFC3775'>[RFC3775]<span> (</span><span class='info'>Johnson, D., Perkins, C., and J. Arkko, &ldquo;Mobility Support in IPv6,&rdquo; June&nbsp;2004.</span><span>)</span></a> de-registration binding
                        update (with a zero lifetime) would result in deleting
                        all bindings, including all flow bindings regardless of
                        the presence of the flow summary mobility option. A
                        binding update (with a zero lifetime) would result in
                        deleting all bindings, including all flow bindings
                        regardless of the presence of the flow summary mobility
                        option. A specific binding de-registration, however, as
                        defined in <a class='info' href='#RFC5648'>[RFC5648]<span> (</span><span class='info'>Wakikawa, R., Devarapalli, V., Tsirtsis, G., Ernst, T., and K. Nagami, &ldquo;Multiple Care-of Addresses Registration,&rdquo; October&nbsp;2009.</span><span>)</span></a> (with lifetime of
                        zero and one or mobe Binding Identifier mobility options
                        identifying specific BIDs)does not remove all the
                        bindings for the MN and thus it SHOULD include a Flow
                        Summary Mobility Option to maintain the flow bindings
                        that need to be preserved.
</p>
<p> If the value of any of the FID fields included in the
                        flow summary mobility option is not present in the list
                        of flow binding entries for this mobile node, the home
                        agent MUST reject this flow binding refresh by including
                        a flow identification mobility option in the BA for each
                        FID that is not found, and by setting the FID field to
                        the value of the FID that is not found and the Status
                        field to the value defined for "FID not found" in <a class='info' href='#FIDoption'>Section&nbsp;4.2<span> (</span><span class='info'>Flow Identification Mobility Option</span><span>)</span></a>. 
</p>
<p>If the value of the FID field is present in the mobile
                        nodes list of flow binding entries the, home agent
                        SHOULD refresh the flow binding entry identified by the
                        FID without changing any of the other parameters
                        associated with it. 
</p>
<a name="HAdeletingFDs"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.4"></a><h3>5.3.4.&nbsp;
Flow Binding Removals</h3>

<p>Removal of flow bindings is performed implicitly by
                        omission of a given FID from a binding update.
</p>
<p> When a valid binding update is received, any registered
                        FIDs that are not explicitly referred to in a flow
                        identification mobility option or in a flow summary
                        mobility option, in the same binding update, MUST be
                        removed from the list of flow binding entries for the
                        mobile node. 
</p>
<a name="sendBA"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.5"></a><h3>5.3.5.&nbsp;
Sending Binding Acknowledgements</h3>

<p>Upon the reception of a binding update, the home agent is
                        required to send back a Binding Acknowledgment. The
                        status code in the Binding Acknowledgement must be set
                        as recommended in <a class='info' href='#RFC3775'>[RFC3775]<span> (</span><span class='info'>Johnson, D., Perkins, C., and J. Arkko, &ldquo;Mobility Support in IPv6,&rdquo; June&nbsp;2004.</span><span>)</span></a>. This status
                        code does not give information on the success or failure
                        of flow bindings.
</p>
<p>In order to inform the mobile node about the status of
                        the flow binding(s) requested by a mobile node, flow
                        identification options SHOULD be included in the Binding
                        Acknowledgement message. Specifically, the home agent
                        SHOULD copy each flow identification mobility option
                        received in the binding update and set its status code
                        to an appropriate value. Note that the home agent does
                        not need to respond specifically regarding FIDs included
                        in a flow summary mobility option but only to those in
                        flow identification mobility options. If an operation
                        requested in a flow identification option by a mobile
                        node is performed successfully by the home agent, the
                        status field on the copied flow identification mobility
                        option in the BA, SHOULD be set to the value defined for
                        "Flow binding successful" in <a class='info' href='#FIDoption'>Section&nbsp;4.2<span> (</span><span class='info'>Flow Identification Mobility Option</span><span>)</span></a>,
                        otherwise it SHOULD be set to one of the rejection codes
                        also defined in <a class='info' href='#FIDoption'>Section&nbsp;4.2<span> (</span><span class='info'>Flow Identification Mobility Option</span><span>)</span></a>. <a class='info' href='#HAops-receiving2'>Section&nbsp;5.3.2<span> (</span><span class='info'>Handling Flow Identification Mobility Options</span><span>)</span></a> identifies a number of
                        cases where specific error codes should be used.
</p>
<p>Home agents that support this specification MAY refuse to
                        maintain flow bindings by setting the status field of
                        any flow identification mobility options to the value
                        defined for "Administratively prohibited" in <a class='info' href='#FIDoption'>Section&nbsp;4.2<span> (</span><span class='info'>Flow Identification Mobility Option</span><span>)</span></a>, or by just ignoring all the
                        flow binding options.
</p>
<p>Note that BID options and their Status field are handled
                        as defined in <a class='info' href='#RFC5648'>[RFC5648]<span> (</span><span class='info'>Wakikawa, R., Devarapalli, V., Tsirtsis, G., Ernst, T., and K. Nagami, &ldquo;Multiple Care-of Addresses Registration,&rdquo; October&nbsp;2009.</span><span>)</span></a>.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.6"></a><h3>5.3.6.&nbsp;
Packet Processing</h3>

<p>This section defines packet processing rules according to
                        this specification. This specification does not change
                        any of the packet interception rules defined in <a class='info' href='#RFC3775'>[RFC3775]<span> (</span><span class='info'>Johnson, D., Perkins, C., and J. Arkko, &ldquo;Mobility Support in IPv6,&rdquo; June&nbsp;2004.</span><span>)</span></a>, and <a class='info' href='#RFC5555'>[RFC5555]<span> (</span><span class='info'>Soliman, H., &ldquo;Mobile IPv6 Support for Dual Stack Hosts and Routers,&rdquo; June&nbsp;2009.</span><span>)</span></a>.
                        These rules apply to HAs, MAPs, and CNs, as part of the
                        routing process for any packet with destination address
                        set to a valid home address of the mobile node. For
                        nodes other than CNs this also applies to packets with
                        destination address set to an address under any of the
                        registered prefixes. These rules apply equally to IPv6
                        packets as well as to IPv4 packets as per <a class='info' href='#RFC5555'>[RFC5555]<span> (</span><span class='info'>Soliman, H., &ldquo;Mobile IPv6 Support for Dual Stack Hosts and Routers,&rdquo; June&nbsp;2009.</span><span>)</span></a>. 
</p>
<p>Before a packet is forwarded to the mobile node it MUST
                        be matched against the ordered list of flow bindings
                        stored in the list of flow binding entries for this
                        mobile node (see <a class='info' href='#BCext'>Section&nbsp;4.3<span> (</span><span class='info'>Flow Bindings entries list and its relationship to Binding Cache</span><span>)</span></a>). A match is
                        attempted with the traffic selector included in the
                        first line (highest order) of the table. If the packet
                        matches the traffic selector, the action defined by the
                        action parameter of the table SHOULD be performed. </p>
<blockquote class="text">
<p>- if the Action indicates 'Discard', the packet
                                is silently discarded 
</p>
<p>- if the Action indicates 'Forward", a copy of
                                the packet is forwarded to each of the care-of
                                addresses associated with the BIDs indicated in
                                the same line of the table. 
</p>
</blockquote><p>
                    
</p>
<p>If the action indicated in one of the entries in the list
                        of flow bindings is 'Discard' then, no BIDs need to be
                        indicated in the same entry since the packet is not
                        forwarded. If, however, the action indicated in an entry
                        of the list of flow bindings is 'Forward", the entry
                        should indicate one or more valid BIDs. For 'Forward' if
                        any of the BIDs indicated does not correspond to a valid
                        care-of address, e.g., the BID was deregistered then
                        that BID has no effect on the traffic. In other words,
                        packets matching the flow binding are forwarded to the
                        remaining BIDs, pointing to registered care-of
                        addresses. If none of the BIDs pointed to in a flow
                        binding entry is valid then the entry is considered to
                        be inactive (as defined in <a class='info' href='#BCext'>Section&nbsp;4.3<span> (</span><span class='info'>Flow Bindings entries list and its relationship to Binding Cache</span><span>)</span></a>) and
                        is skipped. In other words packets should not be matched
                        against that entry.
</p>
<p>If a packet does not match any of the active flow binding
                        entries for the given MN, the packet SHOULD be forwarded
                        to the care-of address associated with the BID with the
                        highest BID-PRI. 
</p>
<p>If a packet is fragmented, only the first fragment
                        contains all IP and transport layer headers, while
                        subsequent fragments only contain an IP header without
                        transport layer headers. For this reason it is possible
                        that subsequent fragments do not match the same traffic
                        selector as the initial fragment of such a packet.
                        Unless specific measures are taken the likely outcome is
                        that the initial fragment is routed as the MN intended
                        while subsequent fragments are routed differently, and
                        probably based on the default flow binding. HAs, MAPs,
                        and CNs SHOULD take care to forward all fragments of a
                        given packet the same way, and in accordance to the flow
                        binding matching the first fragment of said packet. This
                        should be possible given the fact that fragment headers
                        include enough information to identify a fragment as
                        part of a specific packet, but the details of how this
                        is ensured are implementation specific and are not
                        defined in this specification. 
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
MTU Considerations</h3>

<p> The options and sub-options defined in this specification add to
                those defined in <a class='info' href='#RFC3775'>[RFC3775]<span> (</span><span class='info'>Johnson, D., Perkins, C., and J. Arkko, &ldquo;Mobility Support in IPv6,&rdquo; June&nbsp;2004.</span><span>)</span></a> and other related
                specifications, all of which potentially adds to the size of
                binding update messages. Implementations SHOULD take care to
                minimize fragmentation by forming binding updates that are
                shorter than what the path MTU allows whenever possible.
</p>
<p>This specification offers a number of mechanisms for reducing the
                size of binding updates. The operations defined in this
                specification that require the most verbose options are those
                registering new BIDs <a class='info' href='#BIDUpdate'>Section&nbsp;4.1<span> (</span><span class='info'>Definition Update for Binding Identifier Mobility Option</span><span>)</span></a> and identifying
                new flows <a class='info' href='#FDsub'>Section&nbsp;4.2.1.4<span> (</span><span class='info'>Traffic Selector sub-option</span><span>)</span></a>. Implementations are
                encouradged to keep binding updates to sizes below than that of
                the path's MTU by making full use of BID Reference <a class='info' href='#BIDRef'>Section&nbsp;4.2.1.3<span> (</span><span class='info'>Binding Reference Sub-option</span><span>)</span></a> and FID Summary <a class='info' href='#FIDSum'>Section&nbsp;4.2.2<span> (</span><span class='info'>Flow Summary Mobility Option</span><span>)</span></a>
                sub-options, which allows them to refer to already registered
                care-off addresses and flows, while registering new ones in
                subsequent binding update messages.
</p>
<a name="security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Security considerations</h3>

<p>This draft introduces a new option that adds more granularity to
                the binding update and acknowledgement messages defined in <a class='info' href='#RFC3775'>[RFC3775]<span> (</span><span class='info'>Johnson, D., Perkins, C., and J. Arkko, &ldquo;Mobility Support in IPv6,&rdquo; June&nbsp;2004.</span><span>)</span></a>, <a class='info' href='#RFC5555'>[RFC5555]<span> (</span><span class='info'>Soliman, H., &ldquo;Mobile IPv6 Support for Dual Stack Hosts and Routers,&rdquo; June&nbsp;2009.</span><span>)</span></a>, and <a class='info' href='#RFC3963'>[RFC3963]<span> (</span><span class='info'>Devarapalli, V., Wakikawa, R., Petrescu, A., and P. Thubert, &ldquo;Network Mobility (NEMO) Basic Support Protocol,&rdquo; January&nbsp;2005.</span><span>)</span></a>, so it inherits the security
                considerations discussed in these documents. The new option
                allows the mobile node to associate some flows to one interface
                and other flows to another interface. Since the flow
                identification mobility option is part of the mobility header,
                it uses the same security as the Binding Update, whether it is
                sent to a mobility agent, or to a correspondent node.
</p>
<p>This specification does not open up new fundamental lines of
                attack on communications between the MN and its correspondent
                nodes. However, it allows attacks of a finer granularity than
                those on the binding update. For instance, the attacker can
                divert or replicate flows of special interest to the attacker to
                an address of the attacker's choosing, if the attacker is able
                to impersonate the MN or modify a binding update sent by the MN.
                Hence it becomes doubly critical that authentication and
                integrity services are applied to binding updates.
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
IANA Considerations</h3>

<p>This specification requires the following IANA assignments on
                existing namespaces as well as the creation of some new
                namespaces.
</p>
<p>
                </p>
<blockquote class="text">
<p>1) New Mobility Options <a class='info' href='#RFC3775'>[RFC3775]<span> (</span><span class='info'>Johnson, D., Perkins, C., and J. Arkko, &ldquo;Mobility Support in IPv6,&rdquo; June&nbsp;2004.</span><span>)</span></a>: This
                        registry is available from http://www.iana.org under
                        "Mobile IPv6 parameters". The following type numbers
                        need to be assigned for: </p>
<blockquote class="text">
<p>Flow Identification Mobility Option, define in
                                    <a class='info' href='#FIDoption'>Section&nbsp;4.2<span> (</span><span class='info'>Flow Identification Mobility Option</span><span>)</span></a>
                            
</p>
<p>Flow Summary Mobility Option, defined in <a class='info' href='#FIDSum'>Section&nbsp;4.2.2<span> (</span><span class='info'>Flow Summary Mobility Option</span><span>)</span></a>
                            
</p>
</blockquote>
                    

<p>2) New "Flow Identification Mobility Option Action codes"
                        namespace needs to be created. The following 'Action'
                        codes are defined in this specification, in <a class='info' href='#FIDoption'>Section&nbsp;4.2<span> (</span><span class='info'>Flow Identification Mobility Option</span><span>)</span></a>: </p>
<blockquote class="text">
<p>0 Reserved
</p>
<p>1 Discard
</p>
<p>2 Forward
</p>
<p>3-254 unassigned and available for allocation
                                based on Standards Action or IESG Approval as
                                per <a class='info' href='#RFC5226'>[RFC5226]<span> (</span><span class='info'>Narten, T. and H. Alvestrand, &ldquo;Guidelines for Writing an IANA Considerations Section in RFCs,&rdquo; May&nbsp;2008.</span><span>)</span></a>
                            
</p>
<p>255 reserved for experimental use. A single value
                                should be sufficient for experimenting with a
                                different flow identifiction format.
</p>
</blockquote>
                    

<p>3) New "Flow Identification Mobility Option Status codes"
                        namespace needs to be created. The following 'Status'
                        codes are defined in this specification, in <a class='info' href='#FIDoption'>Section&nbsp;4.2<span> (</span><span class='info'>Flow Identification Mobility Option</span><span>)</span></a>: </p>
<blockquote class="text">
<p>0 Flow binding successful
</p>
<p>1-127 unassigned and available for success codes
                                to be allocated via STD action
</p>
<p>128 Administratively prohibited
</p>
<p>129 Flow binding rejected, reason unspecified
</p>
<p>130 Flow identification mobility option malformed
</p>
<p>131 BID not found
</p>
<p>132 FID not found
</p>
<p>133 Traffic selector format not supported
</p>
<p>134 Discard function not supported
</p>
<p>135 Forward function not supported
</p>
<p>126-250 unassigned and available for reject codes
                                to be allocated via Standards Action or IESG
                                Approval as per <a class='info' href='#RFC5226'>[RFC5226]<span> (</span><span class='info'>Narten, T. and H. Alvestrand, &ldquo;Guidelines for Writing an IANA Considerations Section in RFCs,&rdquo; May&nbsp;2008.</span><span>)</span></a>
                            
</p>
<p>251-255 reserved for experimental use. This small
                                number of status codes should be sufficient for
                                experiments with currently unforeseen error
                                conditions.
</p>
</blockquote>
                    

<p>4) New "Flow Identification Sub-Options" namespace for
                        the Flow Identification Mobility Option. The sub-option
                        space is defined in <a class='info' href='#subopt'>Figure&nbsp;3<span> (</span><span class='info'>Flow Identification Sub-Option format</span><span>)</span></a>. The
                        following Sub-option Type values are defined in this
                        specification: </p>
<blockquote class="text">
<p>0 Pad
</p>
<p>1 PadN
</p>
<p>2 BID Reference
</p>
<p>3 Traffic Selector
</p>
<p>4-250 unassigned and available for allocation
                                based on Standards Action or IESG Approval as
                                per <a class='info' href='#RFC5226'>[RFC5226]<span> (</span><span class='info'>Narten, T. and H. Alvestrand, &ldquo;Guidelines for Writing an IANA Considerations Section in RFCs,&rdquo; May&nbsp;2008.</span><span>)</span></a>
                            
</p>
<p>251-255 reserved for experimental use. This small
                                number of sub-option types should be sufficient
                                for experiments with additional parameters
                                associated with a flow.
</p>
</blockquote>
                    

<p>5) New "Traffic Selector Format" namespace for the
                        Traffic Selector sub-option. The traffic selector format
                        space is defined by the TS Format field in <a class='info' href='#FDsubFormat'>Figure&nbsp;5<span> (</span><span class='info'>The Traffic Selector sub-option</span><span>)</span></a>. The following values are
                        defined in this specification: </p>
<blockquote class="text">
<p>0 Reserved
</p>
<p>1-250 unassigned and available for allocation
                                based on Standards Action or IESG Approval as
                                per <a class='info' href='#RFC5226'>[RFC5226]<span> (</span><span class='info'>Narten, T. and H. Alvestrand, &ldquo;Guidelines for Writing an IANA Considerations Section in RFCs,&rdquo; May&nbsp;2008.</span><span>)</span></a>
                            
</p>
<p>251-255 reserved for experimental use. This small
                                number of traffic selector format types should
                                be sufficient for experiments with different
                                ways of representing a traffic selector.
</p>
</blockquote>
                    

</blockquote><p>
            
</p>
<p>Similar to the procedures specified for Mobile IPv6 <a class='info' href='#RFC3775'>[RFC3775]<span> (</span><span class='info'>Johnson, D., Perkins, C., and J. Arkko, &ldquo;Mobility Support in IPv6,&rdquo; June&nbsp;2004.</span><span>)</span></a> number spaces, future allocations from
                the new number spaces requires Standards Action or IESG Approval
                as per <a class='info' href='#RFC5226'>[RFC5226]<span> (</span><span class='info'>Narten, T. and H. Alvestrand, &ldquo;Guidelines for Writing an IANA Considerations Section in RFCs,&rdquo; May&nbsp;2008.</span><span>)</span></a>
            
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Contributors</h3>

<p>We would like to explicitly acknowledge the following person who
                co-authored one of the documents used as source material for
                this document.
</p>
<p>
                </p>
<blockquote class="text">
<p>Nikolaus A. Fikouras, niko@comnets.uni-bremen.de
</p>
</blockquote><p>
            
</p>
<a name="ack"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
Acknowledgements</h3>

<p>We would also like to acknowledge the following people in
                alphabetical order for their contributions to this
                specification: C. Castelluccia, D. Craig, K. ElMalki, K.
                Georgios, , C. Goerg, C. Kaas-Petersen, J. Laganier, T. Noel,
                F.-N. Pavlidou, V. Park, P. Stupar. Also, Gabor Fekete for the
                analysis that led to the inclusion of the BIDRef sub-option, and
                Henrik Levkowetz for suggesting support for other ways of
                describing flows.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>11.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3775">[RFC3775]</a></td>
<td class="author-text">Johnson, D., Perkins, C., and J. Arkko, &ldquo;<a href="http://tools.ietf.org/html/rfc3775">Mobility Support in IPv6</a>,&rdquo; RFC&nbsp;3775, June&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3775.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3963">[RFC3963]</a></td>
<td class="author-text">Devarapalli, V., Wakikawa, R., Petrescu, A., and P. Thubert, &ldquo;<a href="http://tools.ietf.org/html/rfc3963">Network Mobility (NEMO) Basic Support Protocol</a>,&rdquo; RFC&nbsp;3963, January&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc3963.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5226">[RFC5226]</a></td>
<td class="author-text">Narten, T. and H. Alvestrand, &ldquo;<a href="http://tools.ietf.org/html/rfc5226">Guidelines for Writing an IANA Considerations Section in RFCs</a>,&rdquo; BCP&nbsp;26, RFC&nbsp;5226, May&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5226.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5555">[RFC5555]</a></td>
<td class="author-text">Soliman, H., &ldquo;<a href="http://tools.ietf.org/html/rfc5555">Mobile IPv6 Support for Dual Stack Hosts and Routers</a>,&rdquo; RFC&nbsp;5555, June&nbsp;2009 (<a href="http://www.rfc-editor.org/rfc/rfc5555.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5648">[RFC5648]</a></td>
<td class="author-text">Wakikawa, R., Devarapalli, V., Tsirtsis, G., Ernst, T., and K. Nagami, &ldquo;<a href="http://tools.ietf.org/html/rfc5648">Multiple Care-of Addresses Registration</a>,&rdquo; RFC&nbsp;5648, October&nbsp;2009 (<a href="http://www.rfc-editor.org/rfc/rfc5648.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>11.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.ietf-mext-binary-ts">[I-D.ietf-mext-binary-ts]</a></td>
<td class="author-text">Tsirtsis, G., Giaretta, G., Soliman, H., and N. Montavont, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-mext-binary-ts-04.txt">Traffic Selectors for Flow Bindings</a>,&rdquo; draft-ietf-mext-binary-ts-04 (work in progress), February&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-mext-binary-ts-04.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2702">[RFC2702]</a></td>
<td class="author-text"><a href="mailto:awduche@uu.net">Awduche, D.</a>, <a href="mailto:jmalcolm@uu.net">Malcolm, J.</a>, <a href="mailto:ja@uu.net">Agogbua, J.</a>, <a href="mailto:mo@uu.net">O&#039;Dell, M.</a>, and <a href="mailto:jmcmanus@uu.net">J. McManus</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2702">Requirements for Traffic Engineering Over MPLS</a>,&rdquo; RFC&nbsp;2702, September&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2702.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3753">[RFC3753]</a></td>
<td class="author-text">Manner, J. and M. Kojo, &ldquo;<a href="http://tools.ietf.org/html/rfc3753">Mobility Related Terminology</a>,&rdquo; RFC&nbsp;3753, June&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3753.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4885">[RFC4885]</a></td>
<td class="author-text">Ernst, T. and H-Y. Lach, &ldquo;<a href="http://tools.ietf.org/html/rfc4885">Network Mobility Support Terminology</a>,&rdquo; RFC&nbsp;4885, July&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4885.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5380">[RFC5380]</a></td>
<td class="author-text">Soliman, H., Castelluccia, C., ElMalki, K., and L. Bellier, &ldquo;<a href="http://tools.ietf.org/html/rfc5380">Hierarchical Mobile IPv6 (HMIPv6) Mobility Management</a>,&rdquo; RFC&nbsp;5380, October&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5380.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">George Tsirtsis</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Qualcomm</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:tsirtsis@qualcomm.com">tsirtsis@qualcomm.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Hesham Soliman</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Elevate Technologies</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:hesham@elevatemobile.com">hesham@elevatemobile.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Nicolas Montavont</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Institut Telecom / Telecom Bretagne</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">2, rue de la chataigneraie</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cesson Sevigne  35576</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">France</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">(+33) 2 99 12 70 23</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:nicolas.montavont@telecom-bretagne.eu">nicolas.montavont@telecom-bretagne.eu</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.rennes.enst-bretagne.fr/~nmontavo//">http://www.rennes.enst-bretagne.fr/~nmontavo//</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Gerardo Giaretta</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Qualcomm</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:gerardog@qualcomm.com">gerardog@qualcomm.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Koojana Kuladinithi</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">University of Bremen</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">ComNets-ikom,University of Bremen.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Otto-Hahn-Allee NW 1</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Bremen, Bremen  28359</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Germany</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+49-421-218-8264</td></tr>
<tr><td class="author" align="right">Fax:&nbsp;</td>
<td class="author-text">+49-421-218-3601</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:koo@comnets.uni-bremen.de">koo@comnets.uni-bremen.de</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.comnets.uni-bremen.de/~koo/">http://www.comnets.uni-bremen.de/~koo/</a></td></tr>
</table>
</body></html>
