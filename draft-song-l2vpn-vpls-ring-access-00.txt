

Network Working Group                                            X. Song
Internet-Draft                                                     S. Wu
Intended status: Informational                                   H. Shao
Expires: April 30, 2009                                  ZTE Corporation
                                                        October 27, 2008


               VPLS protection switching with ring access
                draft-song-l2vpn-vpls-ring-access-00.txt

Status of this Memo

   By submitting this Internet-Draft, each author represents that any
   applicable patent or other IPR claims of which he or she is aware
   have been or will be disclosed, and any of which he or she becomes
   aware will be disclosed, in accordance with Section 6 of BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups.  Note that
   other groups may also distribute working documents as Internet-
   Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt.

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html.

   This Internet-Draft will expire on April 30, 2009.

Abstract

   This document introduces a new method to access VPLS network using
   ring techonology .  This method can improve VPLS access reliability.
   Fast switch can be done within 50 ms after link failure detection.
   It not only can be used in normal VPLS, but also can be used in VPLS
   PBB network.









Song, et al.             Expires April 30, 2009                 [Page 1]

Internet-Draft   VPLS protect switching with ring access    October 2008


Table of Contents

   1.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . .  3
     1.1.  General Terminology  . . . . . . . . . . . . . . . . . . .  3
   2.  Conventions used in this document  . . . . . . . . . . . . . .  3
   3.  Scenarios  . . . . . . . . . . . . . . . . . . . . . . . . . .  3
   4.  Dual-homing operation  . . . . . . . . . . . . . . . . . . . .  5
     4.1.  Single CE ring access dual-homing operation  . . . . . . .  5
     4.2.  Dual CE ring dual-homing operation . . . . . . . . . . . .  6
     4.3.  Multi CE ring multi-homing operation . . . . . . . . . . .  7
     4.4.  PE operation in the ring . . . . . . . . . . . . . . . . .  8
   5.  Security Considerations  . . . . . . . . . . . . . . . . . . .  8
   6.  IANA Considerations  . . . . . . . . . . . . . . . . . . . . .  8
   7.  Acknowledgments  . . . . . . . . . . . . . . . . . . . . . . .  8
   8.  References . . . . . . . . . . . . . . . . . . . . . . . . . .  9
     8.1.  Normative References . . . . . . . . . . . . . . . . . . .  9
     8.2.  Informative References . . . . . . . . . . . . . . . . . .  9
   Authors' Addresses . . . . . . . . . . . . . . . . . . . . . . . .  9
   Intellectual Property and Copyright Statements . . . . . . . . . . 10
































Song, et al.             Expires April 30, 2009                 [Page 2]

Internet-Draft   VPLS protect switching with ring access    October 2008


1.  Introduction

   Virtual Private LAN Service (VPLS) is a Layer 2 Virtual Private
   Network (VPN) that gives its customers the appearance that their
   sites are connected via a Local Area Network (LAN).  It is often
   required for a Service Provider (SP) to give the customer redundant
   connectivity to one or more sites, often called "multi-homing".  Ring
   access to VPLS will be a good method to implement "multi-homing"
   technology .on one hand the access link will be protected more
   efficiently ,on the other hand ,ring is used very frequently in the
   current Ethernet network ,so deployment of the ring access to VPLS
   network is easy.

   Section 3 lays out some of the scenarios of ring access multi-homing.
   Section 4 describe how to implement the protect switch.  Section 5
   may someday discuss security considerations.

1.1.  General Terminology

   Some general terminology is defined here; most is from [RFC4761] or
   [RFC4364].  Terminology specific to this memo is introduced as needed
   in later sections.

   A "Customer Edge" (CE) device, typically located on customer
   premises, connects to a "Provider Edge" (PE) device, which is owned
   and operated by the SP.  A "Provider" (P) device is also owned and
   operated by the SP, but has no direct customer connections.  A "VPLS
   Edge" (VE) device is a PE that offers VPLS services A VPLS domain
   represents a bridging domain per customer.  A VPLS site is a grouping
   of ports on a PE that belong to the same VPLS domain.  Sites are
   referred to as local or remote depending on whether they are
   configured on the PE router in context or on one of the remote PE
   routers (network peers).


2.  Conventions used in this document

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in RFC-2119.


3.  Scenarios

   The most basic scenario is shown in Figure 1.  CE1 is a VPLS CE that
   is dual-homed to both PE1 and PE2 for redundant connectivity.





Song, et al.             Expires April 30, 2009                 [Page 3]

Internet-Draft   VPLS protect switching with ring access    October 2008


                                 ...............
                                .               .    ___ CE2
                          ___ PE1                .  /
                         /    :                   PE3
                      __/     :       Service      :
                  CE1 __      :       Provider    PE4
                        \     :                   . \___ CE3
                         \___ PE2                .
                                .               .
                                 ...............

                           Figure 1: Scenario 1

   Another extends of dual-homed VPLS module is shown in Figure 2.


                               ...............
                              .               .     ___ CE2
                  CE1 ----- PE1                 .  /
                   |          :                  PE3
                   |          :     Service       :
                   |          :     Provider     PE4
                   |          :                  . \___ CE3
                  CE2 ----- PE2                 .
                              .               .
                               ...............

                           Figure 2: Scenario 2

   In Figure 2, PE-CE-CE-PE forms a non-close ring.  It is a typical
   ring access to VPLS, later the operation of ring will be described.


                                       ...............
                                      .               .   ___ CE2
                        CE1 ----- PE1                  . /
                         |          :                  PE3
                         |          :     Service       :
          Other User access point   :     Provider     PE4
                         |          :                  . \___ CE3
                        CE2 ----- PE2                 .
                                     .               .
                                      ...............

                           Figure 3: Scenario 3






Song, et al.             Expires April 30, 2009                 [Page 4]

Internet-Draft   VPLS protect switching with ring access    October 2008


                               ...............
                              .               .
                  CE1 ----- PE1                 .
                   |          :                  .     CE4
                   |          :                       /
                   |          :      Service     PE4
                   |          :                   :
                  CE2 ----- PE2      Provider     :
                   |          :                  PE5
                   |          :                 .     \
                   |          :                .       CE5
                   |          :               .
                  CE3 ----- PE3 ..............

                           Figure 4: Scenario 4


4.  Dual-homing operation

   Before we start discussing ring access to VPLS network, some basic
   concept of ring technology must be represented.

      D1----D2-----D3----D4

   From the Scenario above, D1-D4 is a simple non-close ring.  When D1
   and D4 access to one VPLS network, it seems that it is a close ring.
   One device of ring is selected to be master node.  In normal
   operation, the master node must block one side link for all non-
   control Ethernet frames belonging to the given Domain, thereby
   avoiding a loop in the ring.  If some link is detected failure, the
   master node will receive a link failure message, and then it unblocks
   the blocked link and allows Ethernet data frames to pass through that
   link.

   Later some Scenario of ring access to VPLS will be discussed.

4.1.  Single CE ring access dual-homing operation

   Figure 1 shows a basic module of dual-homing VPLS system.  PE1-CE1-
   PE2 can be regarded a simple ring.

   In the normal state, CE1 is a master node, CE1-PE1 is set in
   "forwarding" state and CE1-PE2 is in "blocking" state.  And then
   traffic of CE1 only can flow to PE1, PE1 sends it to PE3.  In the
   other direction, PE1 receives the traffic from PE3 and then sends to
   CE1.PE2 also maybe can receive the traffic from PE3, but because the
   CE-PE2 is blocked, so the traffic can not arrive CE1.




Song, et al.             Expires April 30, 2009                 [Page 5]

Internet-Draft   VPLS protect switching with ring access    October 2008


   If PE1-CE1 link is detected failure (the method of detection is
   outside the scope of this document).CE1 will be notified the failure
   and set CE1-PE2 "forwarding" state.

   Supposed that the traffic is bidirectional, traffic of CE1 finds PE1-
   CE1 is link failure, so floods itself to PE2, and then PE2 sent it to
   PE3.  In the process of PE2 and PE3, MAC will be updated.  In the
   other direction, traffic will flow through the updated path PE3-PE2-
   CE1.

   Supposed that the traffic is unidirectional the traffic from CE1 to
   PE3 is the same as bidirectional.  But the traffic from PE3 to CE1
   can not switch to PE3-PE2-CE1 without MAC update of the other
   direction so the switch must rely on the PE MAC withdrawn massage.

   All above can make the traffic recover quickly when link failure.
   But there is a disadvantage .  CE1 is the only access between user
   and VPLS network.  If CE1 device is disabled, the traffic will be
   totally cut down.

4.2.  Dual CE ring dual-homing operation

   Figure 2 is a module of dual CE dual-homing VPLS system.  PE1-CE1-
   CE2-PE2 can be regarded a ring.

   This module can relax the disadvantage of single CE ring dual-homing
   module.  Because there are many accesses between users and VPLS
   network, the network layout can split the user to different CE.

   In the normal state CE1 is selected a master node.  CE1-PE1 is set in
   "forwarding" state, CE1-CE2 in "blocking" state, CE2-PE2 "forwarding"
   state.  Then traffic of CE1 only can flow to PE1 .  PE1 sends it to
   PE3.  Traffic of CE2 only can flow to PE2.PE2 sends it to PE3.  In
   the other direction, PE1 receives the traffic from PE3 and then sends
   it to CE1.  PE2 also can receives the traffic from PE3 and sends it
   to CE2.

   If PE1-CE1 link is detected failure (the method of detection is
   outside the scope of this document), CE1 will be notified and then
   set CE1-CE2 in "forwarding" state.

   Supposed that the traffic is bidirectional, traffic of CE1 finds PE1-
   CE1 is link failure, so floods itself.  Because CE1-CE2 is in
   "forwarding" state, CE2 can receive the traffic, then CE2 send it to
   PE2 and PE2 send it to PE3.  In the process of PE2 and PE3, MAC will
   be updated.  In the other direction, traffic will flow through the
   updated path PE3-PE2-CE2-CE1.




Song, et al.             Expires April 30, 2009                 [Page 6]

Internet-Draft   VPLS protect switching with ring access    October 2008


   Supposed that the traffic is unidirectional, the traffic from CE1 to
   PE3 is the same as bidirectional.  But the traffic from PE3 to CE1
   can't switch to PE3-PE2-CE1 without MAC update of the other
   direction.  So the switch must rely on the PE MAC withdrawn massage.

   Figure3 is also a module of dual CE ring dual-homing.  In this module
   the access point between user and VPLS network are more.


                               CE1 ----- PE1
                               |          :
                               C1
                               |
                               C2
                               ><
                               CE2 ----- PE2

                                 Figure 5

   In figure 5, PE1-CE1-C1-C2-CE2-PE2 is a ring.  We set C2 is a master
   node.  C2 will set one side link (C1-C2) in "forwarding" state and
   set the other side of link (C2-CE2) in "blocking " state.  The user
   data of C2, C1, CE1 will arrive VPLS through PE1.The user data of CE2
   will arrive VPLS network through PE2.

   If any link between PE1 and PE2 is detected failure, one message will
   sent to C2 (master node) and C2 will set C2-CE2 in "forwarding"
   state.  Supposed that CE1-C1 is detected failure, C2 will open C2-
   CE2.  The user data of C1, C2, CE2 will arrive VPLS network through
   PE2.  The data of CE1 arrive VPLS network through PE1.  It is shown
   in Figure 6.


                               CE1 ----- PE1
                               ><
                               C1
                               |
                               C2
                               |
                               CE2 ----- PE2

                                 Figure 6

4.3.  Multi CE ring multi-homing operation

   Figure 4 is a module of multi CE ring multi-homing VPLS system.  PE1-
   CE1-CE2-PE2 can be regarded a ring.  CE2-CE3-PE3 is another ring.
   The operation of PE1-CE1-CE2-PE2 ring is the same as dual CE ring



Song, et al.             Expires April 30, 2009                 [Page 7]

Internet-Draft   VPLS protect switching with ring access    October 2008


   access dual-homing.

   In ring CE2-CE3-PE3, We set CE3 a master node of the ring.  CE3-PE3
   is in "forwarding" state and CE2-CE3 is in "blocking" state in normal
   operation.  Once CE3-PE3 is detected failure, CE2-CE3 is set
   "forwarding".  So the data of CE3 will sent to CE2 .CE2 send the
   traffic to VPLS network through PE2.

4.4.  PE operation in the ring

   Chapter 4.1, 4.2, 4.3 describe that middle device of the ring do
   switching when some link is detected failure.  This chapter will
   discuss edge of ring PE do some switching at the moment of link
   failure.

   In Figure 1, PE2 is the master node.  At normal status, CE1-PE2 is
   set in "blocking" state.  When CE1-PE1 link is detected failure, PE1
   send a control message through PW to PE2, then PE2 set CE1-PE2 in
   "forwarding" state and send MAC flush message to PE1 and PE3.
   Traffic will flood and learn MAC over again.

   In figure 2, PE2 is also the master node.  At normal status, CE2-PE2
   is set in "blocking" state.  So CE2 send traffic to CE1 and then CE1
   send to PE1.  When CE1-PE1 link is detected failure, PE1 sends one
   message to PE2, then PE2 sets CE2-PE2 in "forwarding" state and sends
   MAC flush message to PE1, PE3.  Traffic will flood and then CE1 sent
   traffic to CE2, CE2 send it to PE2.


5.  Security Considerations

   The security considerations in here are the same as the ones
   described in [RFC-4762], and there are no additional security aspects
   that need to be considered beyond the ones described in [RFC-4762].


6.  IANA Considerations

   There have been no IANA considerations so far in this document.


7.  Acknowledgments

   The authors gratefully acknowledge the contributions of Wu Shaoyong,
   Shao Hong, Luo Jian.


8.  References



Song, et al.             Expires April 30, 2009                 [Page 8]

Internet-Draft   VPLS protect switching with ring access    October 2008


8.1.  Normative References

   [RFC4762]  Lasserre, M. and V. Kompella, "Virtual Private LAN Service
              (VPLS) Using Label Distribution Protocol (LDP) Signaling",
              RFC 4762, January 2007.

8.2.  Informative References

   [RFC4664]  Andersson, L. and E. Rosen, "Framework for Layer 2 Virtual
              Private Networks (L2VPNs)", RFC 4664, September 2006.

   [RFC4761]  Kompella, K. and Y. Rekhter, "Virtual Private LAN Service
              (VPLS) Using BGP for Auto-Discovery and Signaling",
              RFC 4761, January 2007.


Authors' Addresses

   Xiaojuan Song
   ZTE Corporation
   68 zhijinghua Road
   Yuhuatai distinct,Nanjing  210000
   P.R.China

   Email: song.xiaojuan@zte.com.cn


   Shaoyong Wu
   ZTE Corporation
   68 zhijinghua Road
   Yuhuatai distinct,Nanjing  210000
   P.R.China

   Email: wu.shaoyong@zte.com.cn


   Hong Shao
   ZTE Corporation
   68 zhijinghua Road
   Yuhuatai distinct,Nanjing  210000
   P.R.China

   Email: shao.hong@zte.com.cn








Song, et al.             Expires April 30, 2009                 [Page 9]

Internet-Draft   VPLS protect switching with ring access    October 2008


Full Copyright Statement

   Copyright (C) The IETF Trust (2008).

   This document is subject to the rights, licenses and restrictions
   contained in BCP 78, and except as set forth therein, the authors
   retain all their rights.

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST AND
   THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS
   OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF
   THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.


Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in BCP 78 and BCP 79.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   http://www.ietf.org/ipr.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.











Song, et al.             Expires April 30, 2009                [Page 10]


