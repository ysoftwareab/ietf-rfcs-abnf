<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Mechanism for performing
    LSP-Ping over MPLS tunnels</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Mechanism for performing
    LSP-Ping over MPLS tunnels">
<meta name="keywords" content="Internet-Draft, MPLS OAM, lsp ping">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 60em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 60em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">N. Bahadur</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">K. Kompella</td></tr>
<tr><td class="header">Updates: <a href='http://tools.ietf.org/html/rfc4379'>4379</a> (if&nbsp;approved)</td><td class="header">Juniper Networks, Inc.</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">G. Swallow</td></tr>
<tr><td class="header">Expires: November 27, 2010</td><td class="header">Cisco Systems</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">May 26, 2010</td></tr>
</table></td></tr></table>
<h1><br />Mechanism for performing
    LSP-Ping over MPLS tunnels<br />draft-ietf-mpls-lsp-ping-enhanced-dsmap-05</h1>

<h3>Abstract</h3>

<p>This document describes methods for performing lsp-ping traceroute
      over mpls tunnels and for traceroute of stitched mpls LSPs. The
      techniques outlined in RFC 4379 are insufficient to perform traceroute
      FEC validation and path discovery for a LSP that goes over other mpls
      tunnels or for a stitched LSP. This document describes enhancements to
      the downstream-mapping TLV (defined in RFC 4379). These enhancements
      along with other procedures outlined in this document can be used to
      trace such LSPs.
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted  in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF).  Note that other groups may also distribute
working documents as Internet-Drafts.  The list of current
Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
This Internet-Draft will expire on November 27, 2010.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the Simplified BSD License.</p>
<p>
This document may contain material from IETF Documents or IETF
Contributions published or made publicly available before November
10, 2008.  The person(s) controlling the copyright in some of this
material may not have granted the IETF Trust the right to allow
modifications of such material outside the IETF Standards Process.
Without obtaining an adequate license from the person(s) controlling
the copyright in such materials, this document may not be modified
outside the IETF Standards Process, and derivative works of it may
not be created outside the IETF Standards Process, except to format
it for publication as an RFC or to translate it into languages other
than English.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#intro">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor1">1.1.</a>&nbsp;
Conventions used in this document<br />
<a href="#motivation">2.</a>&nbsp;
Motivation<br />
<a href="#packet-format">3.</a>&nbsp;
Packet format<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#pkt-format-intro">3.1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">3.2.</a>&nbsp;
New Return Codes<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rc-per-ddmap">3.2.1.</a>&nbsp;
Return code per downstream<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rc-for-stitched">3.2.2.</a>&nbsp;
Return code for stitched LSPs<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ddmap-tlv">3.3.</a>&nbsp;
Downstream Detailed Mapping TLV<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">3.3.1.</a>&nbsp;
Multipath data sub-TLV<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">3.3.2.</a>&nbsp;
Label stack sub-TLV<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#dsmap-fec-stack-tlv">3.3.3.</a>&nbsp;
FEC Stack change sub-TLV<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">3.4.</a>&nbsp;
Deprecation of Downstream Mapping TLV<br />
<a href="#method">4.</a>&nbsp;
Performing lsp-ping traceroute on tunnels<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#transit-proc">4.1.</a>&nbsp;
Transit node procedure<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">4.1.1.</a>&nbsp;
Addition of a new tunnel<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">4.1.2.</a>&nbsp;
Transition between tunnels<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ingress-proc">4.2.</a>&nbsp;
Ingress node procedure<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">4.2.1.</a>&nbsp;
Processing Downstream Detailed Mapping TLV<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#no-target-fec">4.2.1.1.</a>&nbsp;
Stack Change sub-TLV not present<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">4.2.1.2.</a>&nbsp;
Stack Change sub-TLV(s) present<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">4.2.2.</a>&nbsp;
Modifications to handling to EGRESS_OK responses.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">4.2.3.</a>&nbsp;
Handling of new return codes<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#old-dsmap-procedure">4.3.</a>&nbsp;
Handling deprecated Downstream Mapping TLV<br />
<a href="#anchor12">5.</a>&nbsp;
Security Considerations<br />
<a href="#anchor13">6.</a>&nbsp;
IANA Considerations<br />
<a href="#anchor16">7.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">8.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">8.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">8.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="intro"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>This documents describes methods for performing lsp-ping traceroute
      over mpls tunnels. The techniques outlined in <a class='info' href='#RFC4379'>[RFC4379]<span> (</span><span class='info'>Kompella, K. and G. Swallow, &ldquo;Detecting Multi-Protocol Label Switched (MPLS) Data Plane Failures,&rdquo; February&nbsp;2006.</span><span>)</span></a> outline a traceroute mechanism that includes
      FEC validation and ECMP path discovery. Those mechanisms are
      insufficient and do not provide details in case the FEC being traced
      traverses one or more mpls tunnels and in case where LSP stitching is in
      use. This document defines enhancements to the downstream-mapping TLV
      <a class='info' href='#RFC4379'>[RFC4379]<span> (</span><span class='info'>Kompella, K. and G. Swallow, &ldquo;Detecting Multi-Protocol Label Switched (MPLS) Data Plane Failures,&rdquo; February&nbsp;2006.</span><span>)</span></a> to make it more extensible and to enable
      retrieval of detailed information. Using the enhanced TLV format along
      with the existing definitions of <a class='info' href='#RFC4379'>[RFC4379]<span> (</span><span class='info'>Kompella, K. and G. Swallow, &ldquo;Detecting Multi-Protocol Label Switched (MPLS) Data Plane Failures,&rdquo; February&nbsp;2006.</span><span>)</span></a>, this
      document describes procedures by which a traceroute request can
      correctly traverse mpls tunnels with proper FEC and label
      validations.
</p>
<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Conventions used in this document</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
        "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
        document are to be interpreted as described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<a name="motivation"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Motivation</h3>

<p>A LSP-Ping traceroute may cross multiple mpls tunnels en-route the
      destination. Let us consider a simple case.
</p><br /><hr class="insert" />
<a name="tunnel-fig"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

A          B          C           D           E
o -------- o -------- o --------- o --------- o
  \_____/  | \______/   \______/  | \______/
    LDP    |   RSVP       RSVP    |    LDP
           |                      |
            \____________________/
                     LDP

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: LDP over RSVP tunnel&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>When a traceroute is initiated from router A, router B returns
      downstream mapping information for node C in the echo-response. The next
      echo request reaches router C with a LDP FEC. Node C is a pure RSVP node
      and does not run LDP. Node C will receive the packet with 2 labels but
      only 1 FEC in the Target FEC stack. Consequently, node C will be unable
      to perform FEC complete validation. It will let the trace continue by
      just providing next-hop information based on incoming label, and by
      looking up the forwarding state associated with that label. However,
      ignoring FEC validation defeats the purpose of control plane
      validatations. The echo request should contain sufficient information to
      allow node C to perform FEC validations to catch any misrouted
      echo-requests.
</p>
<p>The above problem can be extended for a generic case of tunnel over
      tunnel or multiple tunnels (e.g. B-C can be a separate RSVP tunnel and
      C-D can be a separate RSVP tunnel). The problem of FEC validation for
      tunnels can be solved if the transit routers (router B in the above
      example) provide some hint or information to the ingress regarding the
      start of a new tunnel.
</p>
<p>Stitched LSPs involve 2 or more LSP segments stitched together. The
      LSP segments can be signaled using the same or different signaling
      protocols. In order to perform an end-to-end trace of a stitched LSP,
      the ingress needs to know FEC information regarding each of the stitched
      LSP segments. For example, conside the figure below.
</p><br /><hr class="insert" />
<a name="stitched-lsp-fig"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

A          B          C           D          E         F
o -------- o -------- o --------- o -------- o ------- o
  \_____/    \______/   \______/    \______/  \_______/
    LDP        LDP         BGP         RSVP      RSVP

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;2: Stitched LSP&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>Consider ingress (A) tracing end-to-end LSP A--F. When an echo
      request reaches router C, there is a FEC stack change happening at
      router C. With current lsp-ping mechanisms, there is no way to convey
      this information to A. Consequently, when the next echo request reaches
      router D, router D will know nothing about the LDP FEC that A is trying
      to trace.
</p>
<p>Thus, the procedures outlined <a class='info' href='#RFC4379'>[RFC4379]<span> (</span><span class='info'>Kompella, K. and G. Swallow, &ldquo;Detecting Multi-Protocol Label Switched (MPLS) Data Plane Failures,&rdquo; February&nbsp;2006.</span><span>)</span></a> do not
      make it possible for the ingress node to:
</p>
<p></p>
<ol class="text">
<li>Know that tunneling has occured
</li>
<li>Trace the path of the tunnel
</li>
<li>Trace the path of stitched LSPs
</li>
</ol>

<a name="packet-format"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Packet format</h3>

<p>
</p>
<a name="pkt-format-intro"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Introduction</h3>

<p>In many cases there has been a need to associate additional data in
        the lsping echo response. In most cases, the additional data needs to
        be associated on a per downstream neighbor basis. Currently, the echo
        response contains 1 downstream map TLV (DSMAP) per downstream
        neighbor. But the DSMAP format is not extensible and hence it's not
        possible to associate more information with a downstream neighbor.
        This draft defines a new extensible format for the DSMAP and provides
        mechanisms for solving the tunneled lsp-ping problem using the new
        format. In summary, the draft makes the following TLV changes:
</p>
<p></p>
<ul class="text">
<li>Addition of new Downstream Detailed Mapping TLV (DDMAP).
</li>
<li>Deprecation of existing Downstream Mapping TLV.
</li>
<li>Addition of Downstream FEC Stack Change Sub-TLV to DDMAP.
</li>
</ul>

<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
New Return Codes</h3>

<a name="rc-per-ddmap"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.1"></a><h3>3.2.1.&nbsp;
Return code per downstream</h3>

<p>A new Return Code is being defined "See DDM TLV for Return Code
          and Return SubCode" (<a class='info' href='#new-return-code'>Section&nbsp;6.3<span> (</span><span class='info'>New Return Codes</span><span>)</span></a>) to
          indicate that the Return Code is per Downstream Detailed Mapping TLV
          (<a class='info' href='#ddmap-tlv'>Section&nbsp;3.3<span> (</span><span class='info'>Downstream Detailed Mapping TLV</span><span>)</span></a>). This Return Code MUST be used
          only in the message header and MUST be set only in the echo response
          message. If the Return Code is set in the echo request message, then
          it SHOULD be ignored. When this Return Code is set, each 
          Downstream Detailed Mapping TLV MUST have an appropriate Return Code and
          Return SubCode. This Return Code is to be used when there are
          multiple downstreams for a given node (such as P2MP or ECMP), and
          the node wants to return a different Return Code/Return SubCode for
          each downstream.
</p>
<a name="rc-for-stitched"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.2"></a><h3>3.2.2.&nbsp;
Return code for stitched LSPs</h3>

<p>When a traceroute is being performed on stitched LSPs <a class='info' href='#multiple-tunnel-fig'>Figure&nbsp;10<span> (</span><span class='info'>Stitched LSPs</span><span>)</span></a>, the stitching point SHOULD
          indicate the stitching action to the node performing the trace. This
          is done by setting the Return Code to "Label switched with FEC
          change" (<a class='info' href='#new-return-code'>Section&nbsp;6.3<span> (</span><span class='info'>New Return Codes</span><span>)</span></a>). If a node is
          performing FEC hiding, then it MAY choose to set the Return Code to
          a value other than "Label switched with FEC change". This Return
          Code MUST NOT be used if no Label Stack sub-TLVs (<a class='info' href='#dsmap-fec-stack-tlv'>Section&nbsp;3.3.3<span> (</span><span class='info'>FEC Stack change sub-TLV</span><span>)</span></a>) are present in the
          Downstream Detailed Mapping TLV(s). This new Return Code MAY be used for
          hierarchical LSPs (for indicating start or end of an outer LSP).
</p>
<a name="ddmap-tlv"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
Downstream Detailed Mapping TLV</h3>

<p>A new TLV has been added to the mandatory range of TLVs. The TLV
        type is pending IANA allocation.
</p><br /><hr class="insert" />
<a name="dsmap-detailed-type"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

     Type #   Value Field
     ------   ------------

     TBD      Downstream detailed mapping

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;3&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>The Downstream Detailed Mapping object is a TLV that MAY be
        included in an echo request message. Only one Downstream Detailed
        Mapping object may appear in an echo request. The presence of a
        Downstream Mapping object is a request that Downstream Detailed
        Mapping objects be included in the echo reply. If the replying router
        is the destination of the FEC, then a Downstream Detailed Mapping TLV
        SHOULD NOT be included in the echo reply. Otherwise the replying
        router SHOULD include a Downstream Detailed Mapping object for each
        interface over which this FEC could be forwarded.
</p><br /><hr class="insert" />
<a name="dsmap-detailed-format"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |               MTU             | Address Type  |    DS Flags   |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |             Downstream IP Address (4 or 16 octets)            |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |         Downstream Interface Address (4 or 16 octets)         |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |  Return Code  | Return SubCode|        Sub-tlv length         |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      .                                                               .
      .                      List of Sub TLVs                         .
      .                                                               .
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;4: Downstream Detailed Mapping TLV&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>The Downstream Detailed Mapping TLV format is derived from the
        Downstream Mapping TLV format. The key change is that variable length
        and optional fields have been coverted into sub-TLVs. The fields have
        the same use and meaning as in <a class='info' href='#RFC4379'>[RFC4379]<span> (</span><span class='info'>Kompella, K. and G. Swallow, &ldquo;Detecting Multi-Protocol Label Switched (MPLS) Data Plane Failures,&rdquo; February&nbsp;2006.</span><span>)</span></a>. The
        newly added sub-TLVs and their fields are as described below.
</p>
<p>Return code</p>
<blockquote class="text">
<p>The Return Code and Return SubCode are set to zero by the
            sender. The receiver can set it to one of the values specified in
            the "Multi-Protocol Label Switching (MPLS) Label Switched Paths
            (LSPs) Parameters" registry, "Return Codes" sub-registry. The
            notation &lt;RSC&gt; refers to the Return SubCode. This field is
            filled in with the stack-depth for those codes that specify that.
            For all other codes, the Return SubCode MUST be set to zero. 
</p>
<p>
</p>
<p>If the receiver sets a non-zero value of the Return Code field 
            in the Downstream Detailed Mapping TLV, then the receiver
            MUST also set the Return Code field in the echo response header to "See DDM
            TLV for Return Code and Return SubCode" (<a class='info' href='#new-return-code'>Section&nbsp;6.3<span> (</span><span class='info'>New Return Codes</span><span>)</span></a>). An exception to this is if the receiver is a bud node
            and is replying as both an egress and a transit node with a Return Code 
            of 3 ("Replying router is an egress for the FEC") in the echo response header.
</p>
<p>
</p>
<p>If the Return Code of the echo response message is not set to
            either "See DDM TLV for Return Code and Return SubCode" (<a class='info' href='#new-return-code'>Section&nbsp;6.3<span> (</span><span class='info'>New Return Codes</span><span>)</span></a>) or "Replying router is an egress for the FEC", 
            then the Return Code and Return
            SubCode specified in the Downstream Detailed Mapping TLV SHOULD be
            ignored.
</p>
</blockquote>

<p>Sub-tlv length</p>
<blockquote class="text">
<p>Total length in bytes of the sub-TLVs associated with this
            TLV.
</p>
</blockquote>
<br /><hr class="insert" />
<a name="dsmap-sub-tlv-list"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

     Sub-Type    Value Field
     ---------   ------------
     TBD         Multipath data
     TBD         Label stack
     TBD         FEC Stack change

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;5: Downstream Detailed Mapping Sub-TLV List&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.1"></a><h3>3.3.1.&nbsp;
Multipath data sub-TLV</h3>
<br /><hr class="insert" />
<a name="multipath-sub-tlv"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |Multipath Type |       Multipath Length        |Reserved (MBZ) |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                                                               |
      |                  (Multipath Information)                      |
      |                                                               |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;6: Multipath Sub-TLV&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>The multipath data sub-TLV includes information multipath
          information. The TLV fields and their usage is as defined in <a class='info' href='#RFC4379'>[RFC4379]<span> (</span><span class='info'>Kompella, K. and G. Swallow, &ldquo;Detecting Multi-Protocol Label Switched (MPLS) Data Plane Failures,&rdquo; February&nbsp;2006.</span><span>)</span></a>.
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.2"></a><h3>3.3.2.&nbsp;
Label stack sub-TLV</h3>
<br /><hr class="insert" />
<a name="label-stack-sub-tlv"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |               Downstream Label                |    Protocol   |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      .                                                               .
      .                                                               .
      .                                                               .
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |               Downstream Label                |    Protocol   |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;7: Label Stack Sub-TLV&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>The Label stack sub-TLV contains the set of labels in the label
          stack as it would have appeared if this router were forwarding the
          packet through this interface. Any Implicit Null labels are
          explicitly included. The number of labels present in the sub-TLV is
          determined based on the sub-TLV data length. Labels are treated as
          numbers, i.e., they are right justified in the field. The label
          format and protocol type are as defined in <a class='info' href='#RFC4379'>[RFC4379]<span> (</span><span class='info'>Kompella, K. and G. Swallow, &ldquo;Detecting Multi-Protocol Label Switched (MPLS) Data Plane Failures,&rdquo; February&nbsp;2006.</span><span>)</span></a>. When the Downstream Detailed Mapping TLV
          in sent in the echo response, this sub-TLV MUST be included.
</p>
<a name="dsmap-fec-stack-tlv"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.3"></a><h3>3.3.3.&nbsp;
FEC Stack change sub-TLV</h3>

<p>A router SHOULD include the the FEC Stack change sub-TLV when the
          downstream node in the echo response has a different FEC stack than
          the FEC stack received in the echo request. One or more FEC Stack
          change sub-TLVs MAY be present in the Downstream Detailed Mapping
          TLV. The format is as below.
</p><br /><hr class="insert" />
<a name="dsmap-fec-change-format"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

0                   1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|Operation Type | Address type  | FEC-tlv length|  Reserved     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|           Remote Peer Address (0, 4 or 16 octets)             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
.                                                               .
.                         FEC TLV                               .
.                                                               .
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;8: FEC Stack Change Sub-TLV&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>Operation Type
</p>
<p></p>
<blockquote class="text">
<p>The operation type specifies the action associated with the
              FEC stack change. The following operation types are defined.
</p>
</blockquote>
<br /><hr class="insert" />
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
     Type #     Operation
     ------     ---------
     1          Push
     2          Pop
     3          Swap


</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Operation Type Values&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p></p>
<blockquote class="text">
<p>A FEC Stack change sub-TLV containing a PUSH operation MUST
              NOT be followed by a FEC Stack change sub-TLV containing a POP
              operation. One or more POP operations MAY be followed by one or
              more PUSH operations. One FEC Stack change sub-TLV MUST be
              included per FEC stack change. For example, if 2 labels are
              going to be pushed, then 1 FEC Stack change sub-TLV MUST be
              included for each FEC. A FEC splice operation (an operation
              where 1 FEC ends and another FEC starts, see <a class='info' href='#multiple-tunnel-fig'>Figure&nbsp;10<span> (</span><span class='info'>Stitched LSPs</span><span>)</span></a>) SHOULD be performed by
              including a POP type FEC Stack change sub-TLV followed by a PUSH
              type FEC Stack change sub-TLV.
</p>
<p>A Downstream detailed mapping TLV containing only 1 FEC
              change sub-TLV with Pop operation is equivalent to EGRESS_OK 
              (Return code 3, <a class='info' href='#RFC4379'>[RFC4379]<span> (</span><span class='info'>Kompella, K. and G. Swallow, &ldquo;Detecting Multi-Protocol Label Switched (MPLS) Data Plane Failures,&rdquo; February&nbsp;2006.</span><span>)</span></a>) for
              the outermost FEC in the FEC stack. The ingress router
              performing the lsp trace MUST treat such a case as an EGRESS_OK
              for the outermost FEC.
</p>
<p>The Downstream Detailed Mapping TLV MUST contain at most 1
              FEC Stack change sub-TLV of type Swap. In a FEC Stack change
              sub-TLV with Swap operation, the address-type MAY be set to
              Unspecified and the FEC-tlv length MAY be set to 0.
</p>
</blockquote>

<p>FEC tlv Length
</p>
<p></p>
<blockquote class="text">
<p>Length in bytes of the FEC TLV.
</p>
</blockquote>

<p>Address Type
</p>
<p></p>
<blockquote class="text">
<p>The Address Type indicates the remote peer's address type.
              The Address Type is set to one of the following values. The peer
              address length is determined based on the address type. The
              address type MAY be different from the address type included in
              the Downstream Detailed Mapping TLV. This can happen in case the
              LSP goes over a tunnel of a different address family. The
              address type MAY be set to Unspecified if the peer-address is
              either unavailable or the transit router does not wish it
              provide it for security or administrative reasons.
</p>
</blockquote>
<br /><hr class="insert" />
<a name="remote-peer-address-format"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

     Type #   Address Type   Address length
     ------   ------------   --------------

     0        Unspecified    0
     1        IPv4           4
     2        IPv6           16
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;9: Remote peer address type&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>Remote peer address
</p>
<p></p>
<blockquote class="text">
<p>The remote peer address specifies the remote peer which is
              the next-hop for the FEC being currently traced. E.g. In the LDP
              over RSVP case <a class='info' href='#tunnel-fig'>Figure&nbsp;1<span> (</span><span class='info'>LDP over RSVP tunnel</span><span>)</span></a>, router B would
              respond back with the address of router D as the remote peer
              address for the LDP FEC being traced. This allows the ingress
              node to provide helpful information regarding FEC peers. If the
              operation type is PUSH, the remote peer address is the address
              of the peer from which the FEC was learned. If the operation
              type is POP, the remote peer address MAY be set to Unspecified.
              For upstream assigned labels <a class='info' href='#RFC5331'>[RFC5331]<span> (</span><span class='info'>Aggarwal, R., Rekhter, Y., and E. Rosen, &ldquo;MPLS Upstream Label Assignment and Context-Specific Label Space,&rdquo; August&nbsp;2008.</span><span>)</span></a>, an
              operation type of POP will have a remote peer address (the
              upstream node that assigned the label) and this SHOULD be
              included in the FEC Stack change sub-TLV.
</p>
</blockquote>

<p>FEC TLV</p>
<blockquote class="text">
<p>The FEC TLV is present only when FEC-tlv length field is
              non-zero. The FEC TLV specifies the FEC associated with the FEC
              stack change operation. This TLV MAY be included when the
              operation type is POP. It SHOULD be included when the operation
              type is PUSH. The FEC TLV contains exactly 1 FEC from the list
              of FECs specified in <a class='info' href='#RFC4379'>[RFC4379]<span> (</span><span class='info'>Kompella, K. and G. Swallow, &ldquo;Detecting Multi-Protocol Label Switched (MPLS) Data Plane Failures,&rdquo; February&nbsp;2006.</span><span>)</span></a>. A NIL FEC
              MAY be associated with a PUSH operation if the responding router
              wishes to hide the details of the FEC being pushed.
</p>
</blockquote>

<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4"></a><h3>3.4.&nbsp;
Deprecation of Downstream Mapping TLV</h3>

<p>The Downstream Mapping TLV has been deprecated. LSP-ping procedures
        should now use the Downstream Detailed Mapping TLV. Detailed
        procedures regarding interoperability between the deprecated TLV and
        the new tlv are specified in <a class='info' href='#old-dsmap-procedure'>Section&nbsp;4.3<span> (</span><span class='info'>Handling deprecated Downstream Mapping TLV</span><span>)</span></a>.
</p>
<a name="method"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Performing lsp-ping traceroute on tunnels</h3>

<p>This section describes the procedures to be followed by an ingress
      node and transit nodes when performing lsp-ping traceroute over mpls
      tunnels.
</p>
<a name="transit-proc"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Transit node procedure</h3>

<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1.1"></a><h3>4.1.1.&nbsp;
Addition of a new tunnel</h3>

<p>A transit node (<a class='info' href='#tunnel-fig'>Figure&nbsp;1<span> (</span><span class='info'>LDP over RSVP tunnel</span><span>)</span></a>) knows when the
          FEC being traced is going to enter a tunnel at that node. Thus, it
          knows about the new outer FEC. All transit nodes that are the
          origination point of a new tunnel SHOULD add the a FEC Stack change
          sub-TLV (<a class='info' href='#dsmap-fec-stack-tlv'>Section&nbsp;3.3.3<span> (</span><span class='info'>FEC Stack change sub-TLV</span><span>)</span></a>) to the
          Downstream Detailed Mapping TLV (<a class='info' href='#dsmap-detailed-format'>Figure&nbsp;4<span> (</span><span class='info'>Downstream Detailed Mapping TLV</span><span>)</span></a>) in the echo-response. The
          transit node SHOULD add 1 FEC Stack change sub-TLV of operation type
          PUSH, per new tunnel being originated at the transit node.
</p>
<p>A transit node that sends a Downstream FEC Stack change sub-TLV
          in the echo response SHOULD fill the address of the remote peer;
          which is the peer of the current LSP being traced. If the transit
          node does not know the address of the remote peer, it MAY leave it
          as unspecified.
</p>
<p>If the transit node wishes to hide the nature of the tunnel from
          the ingress of the echo-request, then it MAY not want to send
          details about the new tunnel FEC to the ingress. In such a case, the
          transit node SHOULD use the NIL FEC. The echo response would then
          contain a FEC Stack change sub-TLV with operation type PUSH and a
          NIL FEC. The value of the label in the NIL FEC MUST be set to zero.
          The remote peer
          address type MUST be set to Unspecified. The transit node SHOULD add
          1 FEC Stack change sub-TLV of operation type PUSH, per new tunnel
          being originated at the transit node.
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1.2"></a><h3>4.1.2.&nbsp;
Transition between tunnels</h3>
<br /><hr class="insert" />
<a name="multiple-tunnel-fig"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

A          B          C           D          E         F
o -------- o -------- o --------- o -------- o ------- o
  \_____/    \______/   \______/    \______/  \_______/
    LDP        LDP         BGP         RSVP      RSVP


</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;10: Stitched LSPs&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>In the above figure, we have 3 seperate LSP segments stitched at
          C and D. Node C SHOULD include 2 FEC Stack change sub-TLVs. One with
          a POP operation for the LDP FEC and one with the PUSH operation for
          the BGP FEC. Similarly, node D SHOULD include 2 FEC Stack change
          sub-TLVs, one with a POP operation for the BGP FEC and one with a
          PUSH operation for the RSVP FEC. Nodes C and D SHOULD set the Return
          Code to "Label switched with FEC change" (<a class='info' href='#new-return-code'>Section&nbsp;6.3<span> (</span><span class='info'>New Return Codes</span><span>)</span></a>) to indicate change in FEC being
          traced.
</p>
<p>If node C wishes to perform FEC hiding, it SHOULD respond back
          with 2 FEC Stack change sub-TLVs. One POP followed by 1 PUSH. The
          POP operation MAY either exclude the FEC TLV (by setting FEC TLV
          length to 0) or set the FEC TLV to contain the LDP FEC. The PUSH
          operation SHOULD have the FEC TLV containing the NIL FEC. The Return
          Code SHOULD be set to "Label switched with FEC change".
</p>
<p>If node C performs FEC hiding and node D also performs FEC
          hiding, then node D MAY choose to not send any FEC Stack change
          sub-TLVs in the echo response since the number of labels has not
          changed (for the downstream of node D) and the FEC type also has not
          changed (NIL FEC). In such a case, node D MUST NOT set the Return
          Code to "Label switched with FEC change". If node D performs FEC
          hiding, then node F will respond as EGRESS_OK for the NIL FEC. The
          ingress (node A) will know that EGRESS_OK corresponds to the
          end-to-end LSP.
</p><br /><hr class="insert" />
<a name="hierarchical-lsp-fig"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

A          B          C           D           E           F
o -------- o -------- o --------- o --------- o --------- o
  \_____/  |\____________________/            |\_______/
    LDP    |\       RSVP-A                    |    LDP
           | \_______________________________/|
           |       RSVP-B                     |
            \________________________________/
                            LDP



</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;11: Hierarchical LSPs&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>In the above figure, the following sequence of FEC Stack change
          sub-TLVs will be performed
</p>
<p>Node B:
</p>
<p>Respond with 2 FEC Stack change sub-TLVs: PUSH RSVP-B, PUSH
          RSVP-A.
</p>
<p>Node D:
</p>
<p>Respond with a Return Code of EGRESS_OK when RSVP-A is top of FEC
          stack. Downstream information for node E when echo request contains
          RSVP-B as top of FEC stack and an appropriate Return Code.
</p>
<p>If node B is performing tunnel hiding, then:
</p>
<p>Node B:
</p>
<p>Respond with 2 FEC Stack change sub-TLVs: PUSH NIL-FEC, PUSH
          NIL-FEC.
</p>
<p>Node D:
</p>
<p>Respond with either Return Code of EGRESS_OK (if D can co-relate
          that the NIL-FEC corresponds to RSVP-A which is terminating at D) or
          respond with FEC Stack change sub-TLV: POP (since D knows that
          number of labels towards next-hop is decreasing).
</p><br /><hr class="insert" />
<a name="stitched-hierarchical-lsp-fig"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

A          B          C        D        E       F       G
o -------- o -------- o ------ o ------ o ----- o ----- o
     LDP       LDP        BGP   \  RSVP    RSVP /  LDP
                                 \_____________/
                                      LDP


</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;12: Stitched hierarchical LSPs&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>In the above case, node D will send 3 FEC Stack change sub-TLVs.
          One POP (for the BGP FEC) followed by 2 PUSHes (one for LDP and one
          for RSVP). Nodes C and D SHOULD set the Return Code to "Label
          switched with FEC change" (<a class='info' href='#new-return-code'>Section&nbsp;6.3<span> (</span><span class='info'>New Return Codes</span><span>)</span></a>)
          to indicate change in FEC being traced.
</p>
<a name="ingress-proc"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Ingress node procedure</h3>

<p>It is the responsibility of an ingress node to understand tunnel
        within tunnel semantics and lsp stitching semantics when performing a
        lsp traceroute. This section describes the ingress node procedure
        based on the kind of response an ingress node receives from a transit
        node.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.1"></a><h3>4.2.1.&nbsp;
Processing Downstream Detailed Mapping TLV</h3>

<p>Downstream Detailed Mapping TLV should be processed in procedures
          similar to those of Downstream Mapping TLV, defined in Section 4.4
          of <a class='info' href='#RFC4379'>[RFC4379]<span> (</span><span class='info'>Kompella, K. and G. Swallow, &ldquo;Detecting Multi-Protocol Label Switched (MPLS) Data Plane Failures,&rdquo; February&nbsp;2006.</span><span>)</span></a>
</p>
<a name="no-target-fec"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.1.1"></a><h3>4.2.1.1.&nbsp;
Stack Change sub-TLV not present</h3>

<p>This would be the default behavior as described in <a class='info' href='#RFC4379'>[RFC4379]<span> (</span><span class='info'>Kompella, K. and G. Swallow, &ldquo;Detecting Multi-Protocol Label Switched (MPLS) Data Plane Failures,&rdquo; February&nbsp;2006.</span><span>)</span></a>. The ingress node MUST perform echo
            response processing as per the procedures in <a class='info' href='#RFC4379'>[RFC4379]<span> (</span><span class='info'>Kompella, K. and G. Swallow, &ldquo;Detecting Multi-Protocol Label Switched (MPLS) Data Plane Failures,&rdquo; February&nbsp;2006.</span><span>)</span></a>.
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.1.2"></a><h3>4.2.1.2.&nbsp;
Stack Change sub-TLV(s) present</h3>

<p>If one or more FEC Stack change sub-TLVs (<a class='info' href='#dsmap-fec-stack-tlv'>Section&nbsp;3.3.3<span> (</span><span class='info'>FEC Stack change sub-TLV</span><span>)</span></a>) are received in the echo
            response, the ingress node SHOULD process them and perform some
            validation.
</p>
<p>The FEC stack changes are associated with a downstream neighbor
            and along a particular path of the LSP. Consequently, the ingress
            will need to maintain a FEC-stack per path being traced (in case
            of multipath). All changes to the FEC stack resulting from the
            processing of FEC Stack change sub-TLV(s) should be applied only
            for the path along a given downstream neighbor. The following
            algorithm should be followed for processing FEC Stack change
            sub-TLVs.
</p><br /><hr class="insert" />
<a name="fec-change-tlv-processing"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
 push_seen = FALSE
 fec_stack_depth = current-depth-of-fec-stack-being-traced
 saved_fec_stack = current_fec_stack

 while (sub-tlv = get_next_sub_tlv(downstream_detailed_map_tlv))

     if (sub-tlv == NULL) break

     if (sub-tlv.type == FEC-Stack-Change) {

         if (sub-tlv.operation == POP) {
             if (push_seen) {
                 Drop the echo response
                 current_fec_stack = saved_fec_stack
                 return
             }

             if (fec_stack_depth == 0) {
                 Drop the echo response
                 current_fec_stack = saved_fec_stack
                 return
             }

             Pop FEC from FEC stack being traced
             fec_stack_depth--;
         }

         if (sub-tlv.operation == PUSH) {
             push_seen = 1
             Push FEC on FEC stack being traced
             fec_stack_depth++;
         }
      }
  }


  if (fec_stack_depth == 0) {
      Drop the echo response
      current_fec_stack = saved_fec_stack
      return
  }

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;13: FEC Stack Change Sub-TLV Processing Guideline&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>The next echo request along the same path should use the
            modified FEC stack obtained after processing the FEC Stack change
            sub-TLVs. A non-NIL FEC guarantees that the next echo request
            along the same path will have the Downstream Detailed Mapping TLV
            validated for IP address, Interface address and label stack
            mismatches.
</p>
<p>If the top of the FEC stack is a NIL FEC and the echo response
            does not contain any FEC Stack change sub-TLV, then it does not
            necessarily mean that the LSP has not started traversing a
            different tunnel. It could be that the LSP associated with the NIL
            FEC terminated at a transit node and at the same time a new LSP
            started at the same transit node. The NIL FEC would now be
            associated with the new LSP (and the ingress has no way of knowing
            this). Thus, it is not possible to build an accurate hierarchical
            LSP topology if a traceroute contains NIL FECs.
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.2"></a><h3>4.2.2.&nbsp;
Modifications to handling to EGRESS_OK responses.</h3>

<p>The procedures above allow the addition of new FECs to the
          original FEC being traced. Consequently, the EGRESS_OK response from
          a downstream node may not necessarily be for the FEC being traced.
          It could be for one of the new FECs that was added. On receipt of an
          EGRESS_OK response, the ingress should check if the depth of Target
          FEC sent to the node that just responded, was the same as the depth
          of the FEC that was being traced. If it was not, then it should pop
          the an entry from the Target FEC stack and resend the request with
          the same TTL (as previously sent). The process of popping a FEC is
          to be repeated until either the ingress receives a non-EGRESS_OK
          response or until all the additional FECs added to the FEC stack
          have already been popped. Using EGRESS_OK responses, an ingress can
          build a map of the hierarchical LSP structure traversed by a given
          FEC. 
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.3"></a><h3>4.2.3.&nbsp;
Handling of new return codes</h3>

<p>When the echo response Return Code is "Label switched with FEC
          change" (<a class='info' href='#rc-for-stitched'>Section&nbsp;3.2.2<span> (</span><span class='info'>Return code for stitched LSPs</span><span>)</span></a>), the ingress node
          SHOULD manipulate the FEC stack as per the FEC Stack change sub-TLVs
          contained in the detailed downstream mapping TLV. A transit node can
          use this Return Code for stitched LSPs and for hierarchical LSPs. In
          case of ECMP or P2MP, there could be multiple paths and detailed
          downstream mapping TLVs with different return codes (<a class='info' href='#rc-per-ddmap'>Section&nbsp;3.2.1<span> (</span><span class='info'>Return code per downstream</span><span>)</span></a>). The ingress node should build the
          topology based off the Return Code per ECMP path/P2MP branch.
</p>
<a name="old-dsmap-procedure"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
Handling deprecated Downstream Mapping TLV</h3>

<p>The Downstream Mapping TLV has been deprecated. Applications should
        now use the Downstream Detailed Mapping TLV. The following procedures
        SHOULD be used for backward compatibility with routers that do not
        support the Downstream Detailed Mapping TLV.
</p>
<p></p>
<ul class="text">
<li>The Downstream Mapping TLV and the Downstream Detailed Mapping
            TLV MUST never be sent together in the same echo request or in the
            same echo response.
</li>
<li>If the echo request contains a Downstream Detailed Mapping TLV
            and the corresponding echo response contains an Return Code of 2
            (one or more of the TLVs was not understood), then the sender of
            the echo request MAY resend the echo request with the Downstream
            Mapping TLV (instead of the Downstream Detailed Mapping TLV). In
            cases where a detailed response is needed, the sender can choose
            to ignore the router that does not support the Downstream Detailed
            Mapping TLV.
</li>
<li>If the echo request contains a Downstream Mapping TLV, then a
            Downstream Detailed Mapping TLV MUST NOT be sent in the echo
            response. This is to handle the case that the sender of the echo
            request does not support the new TLV.
</li>
<li>If echo request forwarding is in use; such that the echo
            request is processed at an intermediate router and then forwarded
            on; then the intermediate router is responsible for making sure
            that the TLVs being used among the ingress, intermediate and
            destination are consistent. The intermediate router MUST NOT
            forward an echo request or an echo response containing a
            Downstream Detailed Mapping TLV if it itself does not support that
            TLV.
</li>
</ul>

<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Security Considerations</h3>

<p>Tracing inside a tunnel might have some security implications. There
      are different ways to prevent tracing tunnel details.
</p>
<p></p>
<ol class="text">
<li>If one wants to prevent tracing inside a tunnel, one can hide the
          outer MPLS tunnel by not propagating the MPLS TTL into the outer
          tunnel (at the start of the outer tunnel). By doing this, lsp-ping
          packets will not expire in the outer tunnel and the outer tunnel
          will not get traced. TTL hiding can be imposed on a per LSP basis,
          as need be.
</li>
<li>If one doesn't wish to expose the details of the new outer LSP,
          then the NIL FEC can be used to hide those details. Using the NIL
          FEC ensures that the trace progresses without false negatives and
          all transit nodes (of the new outer tunnel) perform some minimal
          validations on the received echo requests.
</li>
</ol>

<p>In inter-AS (autonomous system) scenarios, information regarding the
      LSP FEC change(s) SHOULD NOT be passed across domains. A NIL FEC MAY be
      used to make the trace go through without false positives. An ASBR
      (autonomous system border router) may choose to intercept all echo
      requests and echo responses and change them to hide FEC information from
      other domains. Detailed operation regarding the same is outside the
      scope of this document. Passing of FEC stack change information between
      domains MAY be done if the two AS domains belong to the same
      provider/organization.
</p>
<p>Other security considerations, as discussed in <a class='info' href='#RFC4379'>[RFC4379]<span> (</span><span class='info'>Kompella, K. and G. Swallow, &ldquo;Detecting Multi-Protocol Label Switched (MPLS) Data Plane Failures,&rdquo; February&nbsp;2006.</span><span>)</span></a> are also applicable to this document.
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
IANA Considerations</h3>

<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
New TLV</h3>

<p>IANA is requested to assign TLV type value to the following TLV
        from the "Multiprotocol Label Switching Architecture (MPLS) Label
        Switched Paths (LSPs) Parameters - TLVs" registry, "TLVs and sub-TLVs"
        sub-registry.
</p>
<p>Downstream Detailed Mapping TLV (See <a class='info' href='#ddmap-tlv'>Section&nbsp;3.3<span> (</span><span class='info'>Downstream Detailed Mapping TLV</span><span>)</span></a>). Suggested value: 20.
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
New Sub-TLV types and associated registry</h3>

<p>IANA is requested to create a new registry for the Sub-Type field
        of Downstream Detailed Mapping TLV. The valid range for this is
        0-65535. Assignments in the range 0-16383 and 32768-49161 are made via
        Standards Action as defined in <a class='info' href='#RFC3692'>[RFC3692]<span> (</span><span class='info'>Narten, T., &ldquo;Assigning Experimental and Testing Numbers Considered Useful,&rdquo; January&nbsp;2004.</span><span>)</span></a>;
        assignments in the range 16384-31743 and 49162-64511 are made via
        Specification Required (<a class='info' href='#RFC4379'>[RFC4379]<span> (</span><span class='info'>Kompella, K. and G. Swallow, &ldquo;Detecting Multi-Protocol Label Switched (MPLS) Data Plane Failures,&rdquo; February&nbsp;2006.</span><span>)</span></a>); values in the
        range 31744-32767 and 64512-65535 are for Vendor Private Use, and MUST
        NOT be allocated. If a sub-TLV has a Type that falls in the range for
        Vendor Private Use, the Length MUST be at least 4, and the first four
        octets MUST be that vendor's SMI Enterprise Code, in network octet
        order. The rest of the Value field is private to the vendor.
</p>
<p>It is requested that IANA assign sub-TLV types from this new
        registry to the following sub-TLVs (See <a class='info' href='#dsmap-sub-tlv-list'>Figure&nbsp;5<span> (</span><span class='info'>Downstream Detailed Mapping Sub-TLV List</span><span>)</span></a>).
</p>
<p>Multipath data sub-TLV: Suggested value: 1
</p>
<p>Label stack sub-TLV: Suggested value: 2
</p>
<p>FEC Stack change sub-TLV: Suggested value: 3
</p>
<a name="new-return-code"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.3"></a><h3>6.3.&nbsp;
New Return Codes</h3>

<p>IANA is requested to assign new Return Code values from the
        "Multi-Protocol Label Switching (MPLS) Label Switched Paths (LSPs)
        Parameters" registry, "Return Codes" sub-registry as follows using a
        Standards Action value.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    Value    Meaning
    -----    -------
    TBD      See DDM TLV for Return Code and Return SubCode
    TBD      Label switched with FEC change
</pre></div>
<p>Suggested values: 14 and 15 respectively
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Acknowledgements</h3>

<p>The authors would like to thank Yakov Rekhter and Adrian Farrel for
      their suggestions on the draft.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>8.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3692">[RFC3692]</a></td>
<td class="author-text">Narten, T., &ldquo;<a href="http://tools.ietf.org/html/rfc3692">Assigning Experimental and Testing Numbers Considered Useful</a>,&rdquo; BCP&nbsp;82, RFC&nbsp;3692, January&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3692.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4379">[RFC4379]</a></td>
<td class="author-text">Kompella, K. and G. Swallow, &ldquo;<a href="http://tools.ietf.org/html/rfc4379">Detecting Multi-Protocol Label Switched (MPLS) Data Plane Failures</a>,&rdquo; RFC&nbsp;4379, February&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4379.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>8.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC5331">[RFC5331]</a></td>
<td class="author-text">Aggarwal, R., Rekhter, Y., and E. Rosen, &ldquo;<a href="http://tools.ietf.org/html/rfc5331">MPLS Upstream Label Assignment and Context-Specific Label Space</a>,&rdquo; RFC&nbsp;5331, August&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5331.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Nitin Bahadur</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Juniper Networks, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">1194 N. Mathilda Avenue</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Sunnyvale, CA  94089</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 408 745 2000</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:nitinb@juniper.net">nitinb@juniper.net</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="www.juniper.net">www.juniper.net</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Kireeti Kompella</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Juniper Networks, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">1194 N. Mathilda Avenue</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Sunnyvale, CA  94089</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 408 745 2000</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:kireeti@juniper.net">kireeti@juniper.net</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="www.juniper.net">www.juniper.net</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">George Swallow</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">1414 Massachusetts Ave</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Boxborough, MA  01719</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:swallow@cisco.com">swallow@cisco.com</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="www.cisco.com">www.cisco.com</a></td></tr>
</table>
</body></html>
