<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Token Revocation</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Token Revocation">
<meta name="keywords" content="token revocation, oauth2">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 60em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 60em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Open Authentication Protocol</td><td class="header">T. Lodderstedt</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Deutsche Telekom AG</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">September 8, 2010</td></tr>
<tr><td class="header">Expires: March 12, 2011</td><td class="header">&nbsp;</td></tr>
</table></td></tr></table>
<h1><br />Token Revocation<br />draft-lodderstedt-oauth-revocation-00</h1>

<h3>Abstract</h3>

<p>This draft proposes an additional endpoint for OAuth authorization servers for revoking tokens.
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted  in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF).  Note that other groups may also distribute
working documents as Internet-Drafts.  The list of current
Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
This Internet-Draft will expire on March 12, 2011.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the Simplified BSD License.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#anchor2">2.</a>&nbsp;
Token Revocation<br />
<a href="#Acknowledgements">3.</a>&nbsp;
Acknowledgements<br />
<a href="#IANA">4.</a>&nbsp;
IANA Considerations<br />
<a href="#Security">5.</a>&nbsp;
Security Considerations<br />
<a href="#rfc.references1">6.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Author's Address<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>
				The current OAuth 2.0 draft <a class='info' href='#draft-ietf-oauth-v2-10'>[draft&#8209;ietf&#8209;oauth&#8209;v2&#8209;10]<span> (</span><span class='info'>Hammer-Lahav, E., Ed., Recordon, D., and D. Hardt, &ldquo;The OAuth 2.0 Protocol draft-ietf-oauth-v2-10,&rdquo; July&nbsp;2010.</span><span>)</span></a> 
				defines several ways for a client to obtain refresh and access 
 				tokens. This specification supplements the draft with a mechanism to 
				finalize the life cycle of both types of tokens. From an end user's perspective, 
			   this mechanism is used to realize application logout or the removal of a persistent 
			   application's permission to access the user's resources.
			
</p>
<p>By using an additional endpoint, the token revocation endpoint, clients 
			   can request the revocation of a particular token. Compliant implementation must
			   support the revocation of refresh tokens, access token revocation is an optional 
			   feature.
			
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Token Revocation</h3>

<p>The client requests the revocation of a particular token by 
		making an HTTP "POST" request to the token revocation endpoint.  
		The location of the token revocation endpoint can be found in the authorization
		servers documentation, or can be obtained by using [[OAuth Discovery ]].  
		The token endpoint URI MAY include a query component.
</p>
<p>Since requests to the token revocation endpoint result in the transmission of
   plain text credentials in the HTTP request, the
   authorization server MUST require the use of a transport-layer
   security mechanism when sending requests to the token revocation endpoints.
   Authorization servers MUST support TLS 1.2 as defined in [RFC5246], and MAY support
   additional transport-layer security mechanisms.
</p>
<p>The client authenticates with the authorization server by adding its
   client credentials to the request as described in Section 2 of 
   <a class='info' href='#draft-ietf-oauth-v2-10'>[draft&#8209;ietf&#8209;oauth&#8209;v2&#8209;10]<span> (</span><span class='info'>Hammer-Lahav, E., Ed., Recordon, D., and D. Hardt, &ldquo;The OAuth 2.0 Protocol draft-ietf-oauth-v2-10,&rdquo; July&nbsp;2010.</span><span>)</span></a>.
</p>
<p>The client constructs the request by including the following
   parameters using the "application/x-www-form-urlencoded" format in
   the HTTP request entity-body:
   
   	</p>
<blockquote class="text"><dl>
<dt>token</dt>
<dd>REQUIRED.  The token that the client wants to get revoked.
</dd>
<dt>token_type</dt>
<dd>
							REQUIRED. The type of the token to be revoked, either "refresh_token" or "access_token".
         Information about the supported token types can be found in the 
         authorization server's documentation, or can be obtained by using
         [[OAuth Discovery ]].
</dd>
</dl></blockquote><p>

</p>
<p>For example, a client may request the revocation of a refresh token with the following request (line breaks are for display purposes only):
					</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
     POST /revoke HTTP/1.1
     Host: server.example.com
     Content-Type: application/x-www-form-urlencoded

     token=45ghiukldjahdnhzdauz&amp;token_type=refresh_token&amp;
     client_id=s6BhdRkqt3&amp;client_secret=gX1fBat3bV
</pre></div><p>
					
					
</p>
<p>The authorization server first verifies whether the client is authorized to revoke 
 the particular token based on the client credentials and its policy. For example, only 
 the client the token has been issued for might be allowed to revoke it. It is also
 conceivable to allow a dedicated user self-care portal to revoke all kinds of tokens.
</p>
<p>In the next step, the authorization server invalidates the token. Whether the 
revocation takes effect instantly or with some delay depends on the architecture 
of the particular deployment. The client shall not make any assumption about the 
timing and MUST NOT use the token again.
</p>
<p>If the processed token is a refresh token and the authorization server supports the revocation
of access tokens, then the authorization server must also invalidate all access tokens issued 
for that refresh 
token. 
</p>
<p>The authorization server indicates a successful processing of the request by a HTTP status code 204. 
Status code 401 indicates a failed client authentication, whereas a status code 403 is used if the
client is not authorized to revoke the particular token. For all other error conditions, a status 
code 400 is used along with an error response as defined in section 4.3. of <a class='info' href='#draft-ietf-oauth-v2-10'>[draft&#8209;ietf&#8209;oauth&#8209;v2&#8209;10]<span> (</span><span class='info'>Hammer-Lahav, E., Ed., Recordon, D., and D. Hardt, &ldquo;The OAuth 2.0 Protocol draft-ietf-oauth-v2-10,&rdquo; July&nbsp;2010.</span><span>)</span></a>.
The following error codes are defined for the token revocation endpoint:
   	</p>
<blockquote class="text"><dl>
<dt>unsupported_token_type</dt>
<dd>The authorization server 
						does not support the revocation of the presented token type. i.e. 
						the	client tried to revoke an access token on a server not supporting 
						this feature.
</dd>
<dt>invalid_token</dt>
<dd>The presented token is invalid.
</dd>
</dl></blockquote><p>

</p>
<a name="Acknowledgements"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Acknowledgements</h3>

<p>I would like to thank Stefanie Dronia, Sebastian Ebling, and 
			Christian Stübner for their valuable feedback.
</p>
<a name="IANA"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
IANA Considerations</h3>

<p>This draft includes no request to IANA.
</p>
<a name="Security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Security Considerations</h3>

<p>All relevant security considerations have been given in the functional specification.
</p>
<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>6.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="draft-ietf-oauth-v2-10">[draft-ietf-oauth-v2-10]</a></td>
<td class="author-text">Hammer-Lahav, E., Ed., Recordon, D., and D. Hardt, &ldquo;<a href="http://tools.ietf.org/html/draft-ietf-oauth-v2-10">The OAuth 2.0 Protocol draft-ietf-oauth-v2-10</a>,&rdquo; July&nbsp;2010.</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Author's Address</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Dr.-Ing. Torsten Lodderstedt</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Deutsche Telekom AG</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:torsten@lodderstedt.net">torsten@lodderstedt.net</a></td></tr>
</table>
</body></html>
