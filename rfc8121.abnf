K_c1 = g^(S_c1) mod q

t_1 = INT(H(octet(1) | OCTETS(K_c1)))

K_s1 = (J(pi) * K_c1^(t_1))^(S_s1) mod q

t_2 = INT(H(octet(2) | OCTETS(K_c1) | OCTETS(K_s1)))

z = K_s1^((S_c1 + t_2) / (S_c1 * t_1 + pi) mod r) mod q
z = (K_c1 * g^(t_2))^(S_s1) mod q

K_c1 = P(K_c1'), where K_c1' = [S_c1] * G

t_1 = INT(H(octet(1) | OCTETS(K_c1)))

K_s1 = P([S_s1] * (J(pi) + [t_1] * K_c1'))

t_2 = INT(H(octet(2) | OCTETS(K_c1) | OCTETS(K_s1)))

z = P([(S_c1 + t_2) / (S_c1 * t_1 + pi) mod r] * P'(K_s1))

z = P([S_s1] * (P'(K_c1) + [t_2] * G))
q = 0xFFFFFFFF FFFFFFFF C90FDAA2 2168C234 C4C6628B 80DC1CD1
            29024E08 8A67CC74 020BBEA6 3B139B22 514A0879 8E3404DD
            EF9519B3 CD3A431B 302B0A6D F25F1437 4FE1356D 6D51C245
            E485B576 625E7EC6 F44C42E9 A637ED6B 0BFF5CB6 F406B7ED
            EE386BFB 5A899FA5 AE9F2411 7C4B1FE6 49286651 ECE45B3D
            C2007CB8 A163BF05 98DA4836 1C55D39A 69163FA8 FD24CF5F
            83655D23 DCA3AD96 1C62F356 208552BB 9ED52907 7096966D
            670C354E 4ABC9804 F1746C08 CA18217C 32905E46 2E36CE3B
            E39E772C 180E8603 9B2783A2 EC07A28F B5C55DF0 6F4C52C9
            DE2BCBF6 95581718 3995497C EA956AE5 15D22618 98FA0510
            15728E5A 8AACAA68 FFFFFFFF FFFFFFFF

g = 2

r = (q - 1) / 2 =
          0x7FFFFFFF FFFFFFFF E487ED51 10B4611A 62633145 C06E0E68
            94812704 4533E63A 0105DF53 1D89CD91 28A5043C C71A026E
            F7CA8CD9 E69D218D 98158536 F92F8A1B A7F09AB6 B6A8E122
            F242DABB 312F3F63 7A262174 D31BF6B5 85FFAE5B 7A035BF6
            F71C35FD AD44CFD2 D74F9208 BE258FF3 24943328 F6722D9E
            E1003E5C 50B1DF82 CC6D241B 0E2AE9CD 348B1FD4 7E9267AF
            C1B2AE91 EE51D6CB 0E3179AB 1042A95D CF6A9483 B84B4B36
            B3861AA7 255E4C02 78BA3604 650C10BE 19482F23 171B671D
            F1CF3B96 0C074301 CD93C1D1 7603D147 DAE2AEF8 37A62964
            EF15E5FB 4AAC0B8C 1CCAA4BE 754AB572 8AE9130C 4C7D0288
            0AB9472D 45565534 7FFFFFFF FFFFFFFF
q = 0xFFFFFFFF FFFFFFFF C90FDAA2 2168C234 C4C6628B 80DC1CD1
            29024E08 8A67CC74 020BBEA6 3B139B22 514A0879 8E3404DD
            EF9519B3 CD3A431B 302B0A6D F25F1437 4FE1356D 6D51C245
            E485B576 625E7EC6 F44C42E9 A637ED6B 0BFF5CB6 F406B7ED
            EE386BFB 5A899FA5 AE9F2411 7C4B1FE6 49286651 ECE45B3D
            C2007CB8 A163BF05 98DA4836 1C55D39A 69163FA8 FD24CF5F
            83655D23 DCA3AD96 1C62F356 208552BB 9ED52907 7096966D
            670C354E 4ABC9804 F1746C08 CA18217C 32905E46 2E36CE3B
            E39E772C 180E8603 9B2783A2 EC07A28F B5C55DF0 6F4C52C9
            DE2BCBF6 95581718 3995497C EA956AE5 15D22618 98FA0510
            15728E5A 8AAAC42D AD33170D 04507A33 A85521AB DF1CBA64
            ECFB8504 58DBEF0A 8AEA7157 5D060C7D B3970F85 A6E1E4C7
            ABF5AE8C DB0933D7 1E8C94E0 4A25619D CEE3D226 1AD2EE6B
            F12FFA06 D98A0864 D8760273 3EC86A64 521F2B18 177B200C
            BBE11757 7A615D6C 770988C0 BAD946E2 08E24FA0 74E5AB31
            43DB5BFC E0FD108E 4B82D120 A9210801 1A723C12 A787E6D7
            88719A10 BDBA5B26 99C32718 6AF4E23C 1A946834 B6150BDA
            2583E9CA 2AD44CE8 DBBBC2DB 04DE8EF9 2E8EFC14 1FBECAA6
            287C5947 4E6BC05D 99B2964F A090C3A2 233BA186 515BE7ED
            1F612970 CEE2D7AF B81BDD76 2170481C D0069127 D5B05AA9
            93B4EA98 8D8FDDC1 86FFB7DC 90A6C08F 4DF435C9 34063199
            FFFFFFFF FFFFFFFF

g = 2
r = (q - 1) / 2 =
          0x7FFFFFFF FFFFFFFF E487ED51 10B4611A 62633145 C06E0E68
            94812704 4533E63A 0105DF53 1D89CD91 28A5043C C71A026E
            F7CA8CD9 E69D218D 98158536 F92F8A1B A7F09AB6 B6A8E122
            F242DABB 312F3F63 7A262174 D31BF6B5 85FFAE5B 7A035BF6
            F71C35FD AD44CFD2 D74F9208 BE258FF3 24943328 F6722D9E
            E1003E5C 50B1DF82 CC6D241B 0E2AE9CD 348B1FD4 7E9267AF
            C1B2AE91 EE51D6CB 0E3179AB 1042A95D CF6A9483 B84B4B36
            B3861AA7 255E4C02 78BA3604 650C10BE 19482F23 171B671D
            F1CF3B96 0C074301 CD93C1D1 7603D147 DAE2AEF8 37A62964
            EF15E5FB 4AAC0B8C 1CCAA4BE 754AB572 8AE9130C 4C7D0288
            0AB9472D 45556216 D6998B86 82283D19 D42A90D5 EF8E5D32
            767DC282 2C6DF785 457538AB AE83063E D9CB87C2 D370F263
            D5FAD746 6D8499EB 8F464A70 2512B0CE E771E913 0D697735
            F897FD03 6CC50432 6C3B0139 9F643532 290F958C 0BBD9006
            5DF08BAB BD30AEB6 3B84C460 5D6CA371 047127D0 3A72D598
            A1EDADFE 707E8847 25C16890 54908400 8D391E09 53C3F36B
            C438CD08 5EDD2D93 4CE1938C 357A711E 0D4A341A 5B0A85ED
            12C1F4E5 156A2674 6DDDE16D 826F477C 97477E0A 0FDF6553
            143E2CA3 A735E02E CCD94B27 D04861D1 119DD0C3 28ADF3F6
            8FB094B8 67716BD7 DC0DEEBB 10B8240E 68034893 EAD82D54
            C9DA754C 46C7EEE0 C37FDBEE 48536047 A6FA1AE4 9A0318CC
            FFFFFFFF FFFFFFFF
