<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>PCAP Next Generation (pcapng) Capture File Format</title>
<meta content="Michael Tuexen" name="author">
<meta content="Fulvio Risso" name="author">
<meta content="Jasper Bongertz" name="author">
<meta content="Gerald Combs" name="author">
<meta content="Guy Harris" name="author">
<meta content="Michael Richardson" name="author">
<meta content="
       This document describes a format to record captured packets to a file.
This format is extensible; Wireshark can currently read and write it, and libpcap can currently read some pcapng files. 
       RFCEDITOR-please-remove: this document is being worked on at: https://github.com/pcapng/pcapng.git 
    " name="description">
<meta content="xml2rfc 3.1.1" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-tuexen-opsawg-pcapng-02" name="ietf.draft">
<link href="/tmp/draft-tuexen-opsawg-pcapng-02-3wwdkzsx.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">pcapng</td>
<td class="right">September 2020</td>
</tr></thead>
<tfoot><tr>
<td class="left">Tuexen, et al.</td>
<td class="center">Expires 1 April 2021</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">OPSAWG Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-tuexen-opsawg-pcapng-02</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2020-09-28" class="published">28 September 2020</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2021-04-01">1 April 2021</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">M. Tuexen</div>
<div class="org">Muenster University of Applied Sciences</div>
</div>
<div class="author">
      <div class="author-name">F. Risso</div>
<div class="org">Politecnico di Torino</div>
</div>
<div class="author">
      <div class="author-name">J. Bongertz</div>
<div class="org">Airbus Defence and Space CyberSecurity</div>
</div>
<div class="author">
      <div class="author-name">G. Combs</div>
<div class="org">Wireshark Foundation</div>
</div>
<div class="author">
      <div class="author-name">G. Harris</div>
</div>
<div class="author">
      <div class="author-name">M. Richardson</div>
<div class="org">Sandelman Software Works</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">PCAP Next Generation (pcapng) Capture File Format</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document describes a format to record captured packets to a file.
This format is extensible; Wireshark can currently read and write it, and libpcap can currently read some pcapng files.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">RFCEDITOR-please-remove: this document is being worked on at: https://github.com/pcapng/pcapng.git<a href="#section-abstract-2" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-discussion-venues">
<a href="#name-discussion-venues" class="section-name selfRef">Discussion Venues</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">Discussion of this document takes place on the
  OPSAWG Working Group mailing list (opsawg@ietf.org),
  which is archived at <a href="https://mailarchive.ietf.org/arch/browse/opsawg/">https://mailarchive.ietf.org/arch/browse/opsawg/</a>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">Source for this draft and an issue tracker can be found at
  <a href="https://github.com/pcapng/pcapng">https://github.com/pcapng/pcapng</a>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 1 April 2021.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2020 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a><a href="#section-toc.1-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="xref">2</a>.  <a href="#name-terminology" class="xref">Terminology</a><a href="#section-toc.1-1.2.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-acronyms" class="xref">Acronyms</a><a href="#section-toc.1-1.2.2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-general-file-structure" class="xref">General File Structure</a><a href="#section-toc.1-1.3.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-general-block-structure" class="xref">General Block Structure</a><a href="#section-toc.1-1.3.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-block-types" class="xref">Block Types</a><a href="#section-toc.1-1.3.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-logical-block-hierarchy" class="xref">Logical Block Hierarchy</a><a href="#section-toc.1-1.3.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="xref">3.4</a>.  <a href="#name-physical-file-layout" class="xref">Physical File Layout</a><a href="#section-toc.1-1.3.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="xref">3.5</a>.  <a href="#name-options" class="xref">Options</a><a href="#section-toc.1-1.3.2.5.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.3.2.5.2.1">
                    <p id="section-toc.1-1.3.2.5.2.1.1"><a href="#section-3.5.1" class="xref">3.5.1</a>.  <a href="#name-custom-options" class="xref">Custom Options</a><a href="#section-toc.1-1.3.2.5.2.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.3.2.6">
                <p id="section-toc.1-1.3.2.6.1"><a href="#section-3.6" class="xref">3.6</a>.  <a href="#name-data-format" class="xref">Data format</a><a href="#section-toc.1-1.3.2.6.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.3.2.6.2.1">
                    <p id="section-toc.1-1.3.2.6.2.1.1"><a href="#section-3.6.1" class="xref">3.6.1</a>.  <a href="#name-endianness" class="xref">Endianness</a><a href="#section-toc.1-1.3.2.6.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.3.2.6.2.2">
                    <p id="section-toc.1-1.3.2.6.2.2.1"><a href="#section-3.6.2" class="xref">3.6.2</a>.  <a href="#name-alignment" class="xref">Alignment</a><a href="#section-toc.1-1.3.2.6.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-block-definition" class="xref">Block Definition</a><a href="#section-toc.1-1.4.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-section-header-block" class="xref">Section Header Block</a><a href="#section-toc.1-1.4.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-interface-description-block" class="xref">Interface Description Block</a><a href="#section-toc.1-1.4.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.  <a href="#name-enhanced-packet-block" class="xref">Enhanced Packet Block</a><a href="#section-toc.1-1.4.2.3.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.4.2.3.2.1">
                    <p id="section-toc.1-1.4.2.3.2.1.1"><a href="#section-4.3.1" class="xref">4.3.1</a>.  <a href="#name-enhanced-packet-block-flags" class="xref">Enhanced Packet Block Flags Word</a><a href="#section-toc.1-1.4.2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="xref">4.4</a>.  <a href="#name-simple-packet-block" class="xref">Simple Packet Block</a><a href="#section-toc.1-1.4.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="xref">4.5</a>.  <a href="#name-name-resolution-block" class="xref">Name Resolution Block</a><a href="#section-toc.1-1.4.2.5.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.6">
                <p id="section-toc.1-1.4.2.6.1"><a href="#section-4.6" class="xref">4.6</a>.  <a href="#name-interface-statistics-block" class="xref">Interface Statistics Block</a><a href="#section-toc.1-1.4.2.6.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.7">
                <p id="section-toc.1-1.4.2.7.1"><a href="#section-4.7" class="xref">4.7</a>.  <a href="#name-systemd-journal-export-bloc" class="xref">systemd Journal Export Block</a><a href="#section-toc.1-1.4.2.7.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.8">
                <p id="section-toc.1-1.4.2.8.1"><a href="#section-4.8" class="xref">4.8</a>.  <a href="#name-decryption-secrets-block" class="xref">Decryption Secrets Block</a><a href="#section-toc.1-1.4.2.8.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.9">
                <p id="section-toc.1-1.4.2.9.1"><a href="#section-4.9" class="xref">4.9</a>.  <a href="#name-custom-block" class="xref">Custom Block</a><a href="#section-toc.1-1.4.2.9.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-experimental-blocks-deserve" class="xref">Experimental Blocks (deserve further investigation)</a><a href="#section-toc.1-1.5.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-alternative-packet-blocks-e" class="xref">Alternative Packet Blocks (experimental)</a><a href="#section-toc.1-1.5.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-compression-block-experimen" class="xref">Compression Block (experimental)</a><a href="#section-toc.1-1.5.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="xref">5.3</a>.  <a href="#name-encryption-block-experiment" class="xref">Encryption Block (experimental)</a><a href="#section-toc.1-1.5.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="xref">5.4</a>.  <a href="#name-fixed-length-block-experime" class="xref">Fixed Length Block (experimental)</a><a href="#section-toc.1-1.5.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.5.2.5">
                <p id="section-toc.1-1.5.2.5.1"><a href="#section-5.5" class="xref">5.5</a>.  <a href="#name-directory-block-experimenta" class="xref">Directory Block (experimental)</a><a href="#section-toc.1-1.5.2.5.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.5.2.6">
                <p id="section-toc.1-1.5.2.6.1"><a href="#section-5.6" class="xref">5.6</a>.  <a href="#name-traffic-statistics-and-moni" class="xref">Traffic Statistics and Monitoring Blocks (experimental)</a><a href="#section-toc.1-1.5.2.6.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.5.2.7">
                <p id="section-toc.1-1.5.2.7.1"><a href="#section-5.7" class="xref">5.7</a>.  <a href="#name-event-security-block-experi" class="xref">Event/Security Block (experimental)</a><a href="#section-toc.1-1.5.2.7.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-vendor-specific-custom-exte" class="xref">Vendor-Specific Custom Extensions</a><a href="#section-toc.1-1.6.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-supported-use-cases" class="xref">Supported Use-Cases</a><a href="#section-toc.1-1.6.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-controlling-copy-behavior" class="xref">Controlling Copy Behavior</a><a href="#section-toc.1-1.6.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="xref">6.3</a>.  <a href="#name-strings-vs-octets" class="xref">Strings vs. Octets</a><a href="#section-toc.1-1.6.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="xref">6.4</a>.  <a href="#name-endianness-issues" class="xref">Endianness Issues</a><a href="#section-toc.1-1.6.2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-recommended-file-name-exten" class="xref">Recommended File Name Extension: .pcapng</a><a href="#section-toc.1-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-conclusions" class="xref">Conclusions</a><a href="#section-toc.1-1.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-implementations" class="xref">Implementations</a><a href="#section-toc.1-1.9.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-security-considerations" class="xref">Security Considerations</a><a href="#section-toc.1-1.10.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>. <a href="#name-iana-considerations" class="xref">IANA Considerations</a><a href="#section-toc.1-1.11.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="xref">11.1</a>.  <a href="#name-standardized-block-type-cod" class="xref">Standardized Block Type Codes</a><a href="#section-toc.1-1.11.2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="xref">12</a>. <a href="#name-contributors" class="xref">Contributors</a><a href="#section-toc.1-1.12.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="xref">13</a>. <a href="#name-acknowledgments" class="xref">Acknowledgments</a><a href="#section-toc.1-1.13.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-14" class="xref">14</a>. <a href="#name-url-references" class="xref">URL References</a><a href="#section-toc.1-1.14.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#section-15" class="xref">15</a>. <a href="#name-normative-references" class="xref">Normative References</a><a href="#section-toc.1-1.15.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#section-appendix.a" class="xref">Appendix A</a>.  <a href="#name-packet-block-obsolete" class="xref">Packet Block (obsolete!)</a><a href="#section-toc.1-1.16.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a href="#section-appendix.b" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a><a href="#section-toc.1-1.17.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">The problem of exchanging packet traces becomes more and more
   critical every day; unfortunately, no standard solutions exist for
   this task right now.  One of the most accepted packet interchange
   formats is the one defined by libpcap, which is rather old and is
   lacking in functionality for more modern applications particularly
   from the extensibility point of view.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">This document proposes a new format for recording packet traces.  The
   following goals are being pursued:<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">Extensibility:  It should be possible to add new standard
      capabilities to the file format over time, and third parties
      should be able to enrich the information embedded in the file with
      proprietary extensions, with tools unaware of newer extensions
      being able to ignore them.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">Portability:  A capture trace must contain all the information needed
      to read data independently from network, hardware and operating
      system of the machine that made the capture.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">Merge/Append data:  It should be possible to add data at the end of a
      given file, and the resulting file must still be readable.<a href="#section-1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="terminology">
<section id="section-2">
      <h2 id="name-terminology">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
      </h2>
<p id="section-2-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED",
"MAY", and "OPTIONAL" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
<div id="acronyms">
<section id="section-2.1">
        <h3 id="name-acronyms">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-acronyms" class="section-name selfRef">Acronyms</a>
        </h3>
<p id="section-2.1-1">The following acronyms are used throughout this document:<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2.1-2">
          <dt id="section-2.1-2.1">SHB:</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-2.2">
  Section Header Block<a href="#section-2.1-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-2.3">IDB:</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-2.4">
  Interface Description Block<a href="#section-2.1-2.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-2.5">ISB:</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-2.6">
  Interface Statistics Block<a href="#section-2.1-2.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-2.7">EPB:</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-2.8">
  Enhanced Packet Block<a href="#section-2.1-2.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-2.9">SPB:</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-2.10">
  Simple Packet Block<a href="#section-2.1-2.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-2.11">NRB:</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-2.12">
  Name Resolution Block<a href="#section-2.1-2.12" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-2.13">CB:</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-2.14">
  Custom Block<a href="#section-2.1-2.14" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="general-file-structure">
<section id="section-3">
      <h2 id="name-general-file-structure">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-general-file-structure" class="section-name selfRef">General File Structure</a>
      </h2>
<div id="general-block-structure">
<section id="section-3.1">
        <h3 id="name-general-block-structure">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-general-block-structure" class="section-name selfRef">General Block Structure</a>
        </h3>
<p id="section-3.1-1">A capture file is organized in blocks, that are appended one to
   another to form the file.  All the blocks share a common format,
   which is shown in Figure 1.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<span id="name-basic-block-structure"></span><div id="general-block-fig">
<figure id="figure-1">
          <div class="artwork art-text alignLeft" id="section-3.1-2.1">
<pre>
      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                          Block Type                           |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                      Block Total Length                       |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     /                          Block Body                           /
     /              variable length, padded to 32 bits               /
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                      Block Total Length                       |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-basic-block-structure" class="selfRef">Basic block structure.</a>
          </figcaption></figure>
</div>
<p id="section-3.1-3">The fields have the following meaning:<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<p id="section-3.1-4">o  Block Type (32 bits): a unique unsigned value that identifies the
      block.  Values whose Most Significant Bit (MSB) is equal to 1 are
      reserved for local use.  They can be used to make extensions to
      the file format to save private data to the file.  The list of
      currently defined types can be found in Section 11.1.<a href="#section-3.1-4" class="pilcrow">¶</a></p>
<p id="section-3.1-5">o  Block Total Length (32 bits): an unsigned value giving the total
      size of this block, in octets.  For instance, the length of a
      block that does not have a body is 12 octets: 4 octets for the
      Block Type, 4 octets for the initial Block Total Length and 4
      octets for the trailing Block Total Length.  This value MUST be a
      multiple of 4.<a href="#section-3.1-5" class="pilcrow">¶</a></p>
<p id="section-3.1-6">o  Block Body: content of the block.<a href="#section-3.1-6" class="pilcrow">¶</a></p>
<p id="section-3.1-7">o  Block Total Length: total size of this block, in octets.  This
      field is duplicated to permit backward file navigation.<a href="#section-3.1-7" class="pilcrow">¶</a></p>
<p id="section-3.1-8">This structure, shared among all blocks, makes it easy to process a
   file and to skip unneeded or unknown blocks.  Some blocks can contain
   other blocks inside (nested blocks).  Some of the blocks are
   mandatory, i.e. a capture file is not valid if they are not present,
   other are optional.<a href="#section-3.1-8" class="pilcrow">¶</a></p>
<p id="section-3.1-9">The General Block Structure allows defining other blocks if needed.
   A parser that does not understand them can simply ignore their
   content.<a href="#section-3.1-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="block-types">
<section id="section-3.2">
        <h3 id="name-block-types">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-block-types" class="section-name selfRef">Block Types</a>
        </h3>
<p id="section-3.2-1">The currently standardized Block Type codes are specified in
   Section 11.1; they have been grouped in the following four
   categories:<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">The following MANDATORY block MUST appear at least once in each file:<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<p id="section-3.2-3">o  Section Header Block (Section 4.1): it defines the most important
      characteristics of the capture file.<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<p id="section-3.2-4">The following OPTIONAL blocks MAY appear in a file:<a href="#section-3.2-4" class="pilcrow">¶</a></p>
<p id="section-3.2-5">o  Interface Description Block (Section 4.2): it defines the most
      important characteristics of the interface(s) used for capturing
      traffic.  This block is required in certain cases, as described
      later.<a href="#section-3.2-5" class="pilcrow">¶</a></p>
<p id="section-3.2-6">o  Enhanced Packet Block (Section 4.3): it contains a single captured
      packet, or a portion of it.  It represents an evolution of the
      original, now obsolete, Packet Block (Appendix A).  If this
      appears in a file, an Interface Description Block is also
      required, before this block.<a href="#section-3.2-6" class="pilcrow">¶</a></p>
<p id="section-3.2-7">o  Simple Packet Block (Section 4.4): it contains a single captured
      packet, or a portion of it, with only a minimal set of information
      about it.  If this appears in a file, an Interface Description
      Block is also required, before this block.<a href="#section-3.2-7" class="pilcrow">¶</a></p>
<p id="section-3.2-8">o  Name Resolution Block (Section 4.5): it defines the mapping from
      numeric addresses present in the packet capture and the canonical
      name counterpart.<a href="#section-3.2-8" class="pilcrow">¶</a></p>
<p id="section-3.2-9">o  Interface Statistics Block (Section 4.6): it defines how to store
      some statistical data (e.g. packet dropped, etc) which can be
      useful to understand the conditions in which the capture has been
      made.  If this appears in a file, an Interface Description Block
      is also required, before this block.<a href="#section-3.2-9" class="pilcrow">¶</a></p>
<p id="section-3.2-10">o  Custom Block (Section 4.9): it contains vendor-specific data in a
      portable fashion.<a href="#section-3.2-10" class="pilcrow">¶</a></p>
<p id="section-3.2-11">The following OBSOLETE block SHOULD NOT appear in newly written files
   (but is documented in the Appendix for reference):<a href="#section-3.2-11" class="pilcrow">¶</a></p>
<p id="section-3.2-12">o  Packet Block (Appendix A): it contains a single captured packet,
      or a portion of it.  It is OBSOLETE, and superseded by the
      Enhanced Packet Block (Section 4.3).<a href="#section-3.2-12" class="pilcrow">¶</a></p>
<p id="section-3.2-13">The following EXPERIMENTAL blocks are considered interesting but the
   authors believe that they deserve more in-depth discussion before
   being defined:<a href="#section-3.2-13" class="pilcrow">¶</a></p>
<p id="section-3.2-14">o  Alternative Packet Blocks<a href="#section-3.2-14" class="pilcrow">¶</a></p>
<p id="section-3.2-15">o  Compression Block<a href="#section-3.2-15" class="pilcrow">¶</a></p>
<p id="section-3.2-16">o  Encryption Block<a href="#section-3.2-16" class="pilcrow">¶</a></p>
<p id="section-3.2-17">o  Fixed Length Block<a href="#section-3.2-17" class="pilcrow">¶</a></p>
<p id="section-3.2-18">o  Directory Block<a href="#section-3.2-18" class="pilcrow">¶</a></p>
<p id="section-3.2-19">o  Traffic Statistics and Monitoring Blocks<a href="#section-3.2-19" class="pilcrow">¶</a></p>
<p id="section-3.2-20">o  Event/Security Blocks<a href="#section-3.2-20" class="pilcrow">¶</a></p>
<p id="section-3.2-21">Requests for new standardized Block Type codes should be sent to the
   pcap-ng-format mailing list [1].<a href="#section-3.2-21" class="pilcrow">¶</a></p>
</section>
</div>
<div id="logical-block-hierarchy">
<section id="section-3.3">
        <h3 id="name-logical-block-hierarchy">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-logical-block-hierarchy" class="section-name selfRef">Logical Block Hierarchy</a>
        </h3>
<p id="section-3.3-1">The blocks build a logical hierarchy as they refer to each other.
   Figure 2 shows the logical hierarchy of the currently defined blocks
   in the form of a "tree view":<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<span id="name-logical-block-hierarchy-of-"></span><div id="logical-block-fig">
<figure id="figure-2">
          <div class="artwork art-text alignLeft" id="section-3.3-2.1">
<pre>
   Section Header
   |
   +- Interface Description
   |  +- Simple Packet
   |  +- Enhanced Packet
   |  +- Interface Statistics
   |
   +- Name Resolution
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-logical-block-hierarchy-of-" class="selfRef">Logical Block Hierarchy of a pcapng File</a>
          </figcaption></figure>
</div>
<p id="section-3.3-3">For example: each captured packet refers to a specific capture
   interface, the interface itself refers to a specific section.<a href="#section-3.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="physical-file-layout">
<section id="section-3.4">
        <h3 id="name-physical-file-layout">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-physical-file-layout" class="section-name selfRef">Physical File Layout</a>
        </h3>
<p id="section-3.4-1">The file MUST begin with a Section Header Block.  However, more than
   one Section Header Block can be present in the capture file, each one
   covering the data following it until the next one (or the end of
   file).  A Section includes the data delimited by two Section Header
   Blocks (or by a Section Header Block and the end of the file),
   including the first Section Header Block.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<p id="section-3.4-2">In case an application cannot read a Section because of different
   version number, it MUST skip everything until the next Section Header
   Block.  Note that, in order to properly skip the blocks until the
   next section, all blocks MUST have the fields Type and Length at the
   beginning.  In order to properly skip blocks in the backward
   direction, all blocks MUST have the Length repeated at the end of the
   block.  These are mandatory requirements that MUST be maintained in
   future versions of the block format.<a href="#section-3.4-2" class="pilcrow">¶</a></p>
<p id="section-3.4-3"><a href="#physical-file-layout-fig" class="xref">Figure 3</a> shows a typical file layout, with a single Section Header
   that covers the whole file.<a href="#section-3.4-3" class="pilcrow">¶</a></p>
<span id="name-file-structure-example-typi"></span><div id="physical-file-layout-fig">
<figure id="figure-3">
          <div class="artwork art-text alignLeft" id="section-3.4-4.1">
<pre>
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   | SHB v1.0  |                      Data                         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-file-structure-example-typi" class="selfRef">File structure example: Typical layout with a single Section Header Block</a>
          </figcaption></figure>
</div>
<p id="section-3.4-5"><a href="#three-section-blocks-fig" class="xref">Figure 4</a> shows a file that contains three headers, and is normally
   the result of file concatenation.  An application that understands
   only version 1.0 of the file format skips the intermediate section
   and restart processing the packets after the third Section Header.<a href="#section-3.4-5" class="pilcrow">¶</a></p>
<span id="name-file-structure-example-thre"></span><div id="three-section-blocks-fig">
<figure id="figure-4">
          <div class="artwork art-text alignLeft" id="section-3.4-6.1">
<pre>
   |--   1st Section   --|--   2nd Section   --|--  3rd Section  --|
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   | SHB v1.0  |  Data   | SHB V1.1  |  Data   | SHB V1.0  |  Data |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-file-structure-example-thre" class="selfRef">File structure example: three Section Header Blocks in a single file</a>
          </figcaption></figure>
</div>
<p id="section-3.4-7"><a href="#pcapng-classic-libpcap-fig" class="xref">Figure 5</a> shows a file comparable to a "classic libpcap" file - the minimum for a useful capture file.
It contains a single Section Header Block (SHB), a single Interface Description Block (IDB) and a few Enhanced Packet Blocks (EPB).<a href="#section-3.4-7" class="pilcrow">¶</a></p>
<span id="name-file-structure-example-a-pc"></span><div id="pcapng-classic-libpcap-fig">
<figure id="figure-5">
          <div class="artwork art-text alignLeft" id="section-3.4-8.1">
<pre>
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   | SHB | IDB | EPB | EPB |    ...    | EPB |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-file-structure-example-a-pc" class="selfRef">File structure example: a pcapng file similar to a classical libpcap file</a>
          </figcaption></figure>
</div>
<p id="section-3.4-9"><a href="#complex-pcapng-fig" class="xref">Figure 6</a> shows a complex example file.
In addition to the minimum file above, it contains packets captured from three interfaces,
   capturing on the third of which begins after packets have arrived on
   other interfaces, and also includes some Name Resolution Blocks (NRB)
   and an Interface Statistics Block (ISB).<a href="#section-3.4-9" class="pilcrow">¶</a></p>
<span id="name-file-structure-example-comp"></span><div id="complex-pcapng-fig">
<figure id="figure-6">
          <div class="artwork art-text alignLeft" id="section-3.4-10.1">
<pre>
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   | SHB | IDB | IDB | EPB | NRB |...| IDB | EPB | ISB | NRB | EPB |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-file-structure-example-comp" class="selfRef">File structure example: complex pcapng file</a>
          </figcaption></figure>
</div>
<p id="section-3.4-11">The last example should make it obvious that the block structure
makes the file format very flexible compared to the classical libpcap
format.<a href="#section-3.4-11" class="pilcrow">¶</a></p>
</section>
</div>
<div id="options">
<section id="section-3.5">
        <h3 id="name-options">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-options" class="section-name selfRef">Options</a>
        </h3>
<p id="section-3.5-1">All the block bodies MAY embed optional fields.  Optional fields can
   be used to insert some information that may be useful when reading
   data, but that is not really needed for packet processing.<a href="#section-3.5-1" class="pilcrow">¶</a></p>
<p id="section-3.5-2">Therefore, each tool can either read the content of the optional
   fields (if any), or skip some of them or even all at once.<a href="#section-3.5-2" class="pilcrow">¶</a></p>
<p id="section-3.5-3">A block that may contain options must be structured so that the
   number of octets of data in the Block Body that precede the options
   can be determined from that data; that allows the beginning of the
   options to be found.  That is true for all standard blocks that
   support options; for Custom Blocks that support options, the Custom
   Data must be structured in such a fashion.  This means that the Block
   Length field (present in the General Block Structure, see
   Section 3.1) can be used to determine how many octets of optional
   fields, if any, are present in the block.  That number can be used to
   determine whether the block has optional fields (if it is zero, there
   are no optional fields), to check, when processing optional fields,
   whether any optional fields remain, and to skip all the optional
   fields at once.<a href="#section-3.5-3" class="pilcrow">¶</a></p>
<p id="section-3.5-4">Options are a list of Type - Length - Value fields, each one
   containing a single value:<a href="#section-3.5-4" class="pilcrow">¶</a></p>
<p id="section-3.5-5">o  Option Type (16 bits): an unsigned value that contains the code
      that specifies the type of the current TLV record.  Option types
      whose Most Significant Bit is equal to one are reserved for local
      use; therefore, there is no guarantee that the code used is unique
      among all capture files (generated by other applications), and is
      most certainly not portable.  For cross-platform globally unique
      vendor-specific extensions, the Custom Option MUST be used
      instead, as defined in Section 3.5.1).<a href="#section-3.5-5" class="pilcrow">¶</a></p>
<p id="section-3.5-6">o  Option Length (16 bits): an unsigned value that contains the
      actual length of the following 'Option Value' field without the
      padding octets.<a href="#section-3.5-6" class="pilcrow">¶</a></p>
<p id="section-3.5-7">o  Option Value (variable length): the value of the given option,
      padded to a 32-bit boundary.  The actual length of this field
      (i.e. without the padding octets) is specified by the Option
      Length field.<a href="#section-3.5-7" class="pilcrow">¶</a></p>
<p id="section-3.5-8">Requests for new standardized option codes for a given block should
   be sent to the pcap-ng-format mailing list [2].<a href="#section-3.5-8" class="pilcrow">¶</a></p>
<p id="section-3.5-9">A given option may have a fixed length, in which case all instances
   of that option have a length that is equal to the specified fixed
   length, or a variable length, in which case the option has a minimum
   length and all instances of that option must have a length equal to
   or greater than the specified minimum length.  The length of fixed-
   length options, and the minimum length of variable-length options, is
   specified in the description of the option; if the minimum length of
   a variable-length option is not specified, a zero-length option is
   valid.  Software that reads these files SHOULD report options that
   have an invalid length as errors; the software MAY stop processing
   the file if it sees an option that has invalid length, or MAY ignore
   the option and continue processing it.  Software that writes these
   files MUST not write files with options that have invalid lengths.<a href="#section-3.5-9" class="pilcrow">¶</a></p>
<p id="section-3.5-10">If an option's value is a string, the value is not necessarily zero-
   terminated.  Software that reads these files MUST NOT assume that
   strings are zero-terminated, and MUST treat a zero-value octet as a
   string terminator.<a href="#section-3.5-10" class="pilcrow">¶</a></p>
<p id="section-3.5-11">Some options may be repeated several times; for example, a block can
   have multiple comments, and an Interface Description Block can give
   multiple IPv4 or IPv6 addresses for the interface if it has multiple
   IPv4 or IPv6 addresses assigned to it.  Other options may appear at
   most once in a given block.<a href="#section-3.5-11" class="pilcrow">¶</a></p>
<p id="section-3.5-12">The option list is terminated by a option which uses the special 'End
   of Option' code (opt_endofopt).  Code that writes pcapng files MUST
   put an opt_endofopt option at the end of an option list.  Code that
   reads pcapng files MUST NOT assume an option list will have an
   opt_endofopt option at the end; it MUST also check for the end of the
   block, and SHOULD treat blocks where the option list has no
   opt_endofopt option as if the option list had an opt_endofopt option
   at the end.<a href="#section-3.5-12" class="pilcrow">¶</a></p>
<p id="section-3.5-13">The format of the optional fields is shown in Figure 7.<a href="#section-3.5-13" class="pilcrow">¶</a></p>
<span id="name-options-format"></span><div id="option-code-fig">
<figure id="figure-7">
          <div class="artwork art-text alignLeft" id="section-3.5-14.1">
<pre>
      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |      Option Code              |         Option Length         |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     /                       Option Value                            /
     /              variable length, padded to 32 bits               /
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     /                                                               /
     /                 . . . other options . . .                     /
     /                                                               /
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |   Option Code == opt_endofopt  |  Option Length == 0          |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-options-format" class="selfRef">Options Format</a>
          </figcaption></figure>
</div>
<p id="section-3.5-15">The following codes can always be present in any optional field:<a href="#section-3.5-15" class="pilcrow">¶</a></p>
<span id="name-common-options"></span><div id="option-code-table">
<figure id="figure-8">
          <div class="artwork art-text alignLeft" id="section-3.5-16.1">
<pre>
   +--------------+-----------------------+--------------+-------------+
   | Name         | Code                  | Length       | Multiple    |
   |              |                       |              | allowed?    |
   +--------------+-----------------------+--------------+-------------+
   | opt_endofopt | 0                     | 0            | no          |
   | opt_comment  | 1                     | variable     | yes         |
   | opt_custom   | 2988/2989/19372/19373 | variable,    | yes         |
   |              |                       | minimum 4    |             |
   +--------------+-----------------------+--------------+-------------+
</pre>
</div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a>:
<a href="#name-common-options" class="selfRef">Common Options</a>
          </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-3.5-17">
          <dt id="section-3.5-17.1">opt_endofopt:</dt>
          <dd style="margin-left: 1.5em" id="section-3.5-17.2">
  The opt_endofopt option delimits the end of the optional fields.
This option MUST NOT be repeated within a given list of options.<a href="#section-3.5-17.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.5-17.3">opt_comment:</dt>
          <dd style="margin-left: 1.5em" id="section-3.5-17.4">
  The opt_comment option is a UTF-8 string containing human-readable comment text that is associated to the current block.
Line separators SHOULD be a carriage-return + linefeed ('\r\n') or just linefeed ('\n'); either form may appear and be considered a line separator.
The string is not zero-terminated.<a href="#section-3.5-17.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-3.5-18">Examples: "This packet is the beginning of all of our problems", "Packets 17-23 showing a bogus TCP retransmission!\r\n This is reported in bugzilla entry 1486.\nIt will be fixed in the future.".<a href="#section-3.5-18" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.5-19">
          <dt id="section-3.5-19.1">opt_custom:</dt>
          <dd style="margin-left: 1.5em" id="section-3.5-19.2">
  This option is described in detail in <a href="#custom-options" class="xref">Section 3.5.1</a><a href="#section-3.5-19.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<div id="custom-options">
<section id="section-3.5.1">
          <h4 id="name-custom-options">
<a href="#section-3.5.1" class="section-number selfRef">3.5.1. </a><a href="#name-custom-options" class="section-name selfRef">Custom Options</a>
          </h4>
<p id="section-3.5.1-1">Customs Options are used for portable, vendor-specific data related
   to the block they're in.  A Custom Option can be in any block type
   that can have options, can be repeated any number of times in a
   block, and may come before or after other option types - except the
   opt_endofopt which is always the last option.  Different Custom
   Options, of different type codes and/or different Private Enterprise
   Numbers, may be used in the same pcapng file.  See Section 6 for
   additional details.<a href="#section-3.5.1-1" class="pilcrow">¶</a></p>
<span id="name-custom-options-format"></span><div id="custom-option-fig">
<figure id="figure-9">
            <div class="artwork art-text alignLeft" id="section-3.5.1-2.1">
<pre>
      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |     Custom Option Code        |         Option Length         |
     +---------------------------------------------------------------+
     |                Private Enterprise Number (PEN)                |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     /                        Custom Data                            /
     /              variable length, padded to 32 bits               /
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-9" class="selfRef">Figure 9</a>:
<a href="#name-custom-options-format" class="selfRef">Custom Options Format</a>
            </figcaption></figure>
</div>
<p id="section-3.5.1-3">The Custom Option has the following fields:<a href="#section-3.5.1-3" class="pilcrow">¶</a></p>
<p id="section-3.5.1-4">o  Custom Option Code: The code number for the Custom Option, which
      can be one of the following decimal numbers:<a href="#section-3.5.1-4" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.5.1-5">
<pre>
  2988:
          This option code identifies a Custom Option containing a
          UTF-8 string in the Custom Data portion.  The string is
          not zero-terminated.  This Custom Option can be safely
          copied to a new file if the pcapng file is manipulated by
          an application; otherwise 19372 should be used instead.
          See Section 6.2 for details.

  2989:
          This option code identifies a Custom Option containing
          binary octets in the Custom Data portion.  This Custom
          Option can be safely copied to a new file if the pcapng
          file is manipulated by an application; otherwise 19372
          should be used instead.  See Section 6.2 for details.

  19372:
          This option code identifies a Custom Option containing a
          UTF-8 string in the Custom Data portion.  The string is
          not zero-terminated.  This Custom Option should not be
          copied to a new file if the pcapng file is manipulated by
          an application.  See Section 6.2 for details.

  19373:
          This option code identifies a Custom Option containing
          binary octets in the Custom Data portion.  This Custom
          Option should not be copied to a new file if the pcapng
          file is manipulated by an application.  See Section 6.2
          for details.
</pre><a href="#section-3.5.1-5" class="pilcrow">¶</a>
</div>
<p id="section-3.5.1-6">o  Option Length: as described in Section 3.1, this contains the
      length of the option's value, which includes the 4-octet Private
      Enterprise Number and variable-length Custom Data fields, without
      the padding octets.<a href="#section-3.5.1-6" class="pilcrow">¶</a></p>
<p id="section-3.5.1-7">o  Private Enterprise Number: An IANA-assigned Private Enterprise
      Number identifying the organization which defined the Custom
      Option.  See Section 6.1 for details.  The PEN number MUST be
      encoded using the same endianness as the Section Header Block it
      is within the scope of.<a href="#section-3.5.1-7" class="pilcrow">¶</a></p>
<p id="section-3.5.1-8">o  Custom Data: the custom data, padded to a 32 bit boundary.<a href="#section-3.5.1-8" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="data-format">
<section id="section-3.6">
        <h3 id="name-data-format">
<a href="#section-3.6" class="section-number selfRef">3.6. </a><a href="#name-data-format" class="section-name selfRef">Data format</a>
        </h3>
<div id="endianness">
<section id="section-3.6.1">
          <h4 id="name-endianness">
<a href="#section-3.6.1" class="section-number selfRef">3.6.1. </a><a href="#name-endianness" class="section-name selfRef">Endianness</a>
          </h4>
<p id="section-3.6.1-1">Data contained in each section will always be saved according to the
   characteristics (little endian / big endian) of the capturing
   machine.  This refers to all the fields that are saved as numbers and
   that span over two or more octets.<a href="#section-3.6.1-1" class="pilcrow">¶</a></p>
<p id="section-3.6.1-2">The approach of having each section saved in the native format of the
   generating host is more efficient because it avoids translation of
   data when reading / writing on the host itself, which is the most
   common case when generating/processing capture captures.<a href="#section-3.6.1-2" class="pilcrow">¶</a></p>
<p id="section-3.6.1-3">Please note: The endianness is indicated by the Section Header Block
   (Section 4.1).  Since this block can appear several times in a pcapng
   file, a single file can contain both endianness variants.<a href="#section-3.6.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="alignment">
<section id="section-3.6.2">
          <h4 id="name-alignment">
<a href="#section-3.6.2" class="section-number selfRef">3.6.2. </a><a href="#name-alignment" class="section-name selfRef">Alignment</a>
          </h4>
<p id="section-3.6.2-1">All fields of this specification use proper alignment for 16- and
   32-bit values.  This makes it easier and faster to read/write file
   contents if using techniques like memory mapped files.<a href="#section-3.6.2-1" class="pilcrow">¶</a></p>
<p id="section-3.6.2-2">The alignment octets (marked in this document e.g. with "padded to 32
   bits") MUST be filled with zeroes.<a href="#section-3.6.2-2" class="pilcrow">¶</a></p>
<p id="section-3.6.2-3">Please note: 64-bit values are not aligned to 64-bit boundaries.
   This is because the file is naturally aligned to 32-bit boundaries
   only.  Special care MUST be taken when reading and writing such
   values.  (Note also that some 64-bit values are represented as a
   64-bit integer in the endianness of the machine that wrote the file,
   and others are represented as 2 32-bit values, one containing the
   upper 32 bits of the value and one containing the lower 32 bits of
   the value, each written as 32-bit integers in the endianness of the
   machine that wrote the file.  Neither of these formats guarantee
   64-bit alignment.)<a href="#section-3.6.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="block-definition">
<section id="section-4">
      <h2 id="name-block-definition">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-block-definition" class="section-name selfRef">Block Definition</a>
      </h2>
<p id="section-4-1">This section details the format of the blocks currently defined.<a href="#section-4-1" class="pilcrow">¶</a></p>
<div id="shb-section-header-block">
<section id="section-4.1">
        <h3 id="name-section-header-block">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-section-header-block" class="section-name selfRef">Section Header Block</a>
        </h3>
<p id="section-4.1-1">The Section Header Block (SHB) is mandatory.  It identifies the
beginning of a section of the capture capture file.  The
Section Header Block does not contain data but it rather identifies a
list of blocks (interfaces, packets) that are logically correlated.
Its format is shown in Figure 9.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<span id="name-section-header-block-format"></span><div id="shg-section-header-block-fig">
<figure id="figure-10">
          <div class="artwork art-text alignLeft" id="section-4.1-2.1">
<pre>
      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +---------------------------------------------------------------+
    0 |                   Block Type = 0x0A0D0D0A                     |
      +---------------------------------------------------------------+
    4 |                      Block Total Length                       |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    8 |                      Byte-Order Magic                         |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   12 |          Major Version        |         Minor Version         |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   16 |                                                               |
      |                          Section Length                       |
      |                                                               |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   24 /                                                               /
      /                      Options (variable)                       /
      /                                                               /
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                      Block Total Length                       |
      +---------------------------------------------------------------+
</pre>
</div>
<figcaption><a href="#figure-10" class="selfRef">Figure 10</a>:
<a href="#name-section-header-block-format" class="selfRef">Section Header Block Format</a>
          </figcaption></figure>
</div>
<p id="section-4.1-3">The meaning of the fields is:<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1-4">o  Block Type: The block type of the Section Header Block is the
      integer corresponding to the 4-char string "\n\r\r\n"
      (0x0A0D0D0A).  This particular value is used for 2 reasons:<a href="#section-4.1-4" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.1-5">
<pre>
  1.  This number is used to detect if a file has been transferred
      via FTP or HTTP from a machine to another with an
      inappropriate ASCII conversion.  In this case, the value of
      this field will differ from the standard one ("\n\r\r\n") and
      the reader can detect a possibly corrupted file.

  2.  This value is palindromic, so that the reader is able to
      recognize the Section Header Block regardless of the
      endianness of the section.  The endianness is recognized by
      reading the Byte Order Magic, that is located 8 octets after
      the Block Type.
</pre><a href="#section-4.1-5" class="pilcrow">¶</a>
</div>
<p id="section-4.1-6">o  Block Total Length: total size of this block, as described in
      Section 3.1.<a href="#section-4.1-6" class="pilcrow">¶</a></p>
<p id="section-4.1-7">o  Byte-Order Magic (32 bits): an unsigned magic number, whose value
      is the hexadecimal number 0x1A2B3C4D.  This number can be used to
      distinguish sections that have been saved on little-endian
      machines from the ones saved on big-endian machines, and to
      heuristically identify pcapng files.<a href="#section-4.1-7" class="pilcrow">¶</a></p>
<p id="section-4.1-8">o  Major Version (16 bits): an unsigned value, giving the number of
      the current major version of the format.  The value for the
      current version of the format is 1.  This value should change if
      the format changes in such a way that code that reads the new
      format could not read the old format (i.e., code to read both
      formats would have to check the version number and use different
      code paths for the two formats) and code that reads the old format
      could not read the new format.  Note that adding a new block type
      or a new option is NOT such a change.<a href="#section-4.1-8" class="pilcrow">¶</a></p>
<p id="section-4.1-9">o  Minor Version (16 bits): an unsigned value, giving the number of
      the current minor version of the format.  The value is for the
      current version of the format is 0.  This value should change if
      the format changes in such a way that code that reads the new
      format could read the old format without checking the version
      number but code that reads the old format could not read all files
      in the new format.  Note that adding a new block type or a new
      option is NOT such a change.<a href="#section-4.1-9" class="pilcrow">¶</a></p>
<p id="section-4.1-10">o  Section Length (64 bits): a signed value specifying the length in
      octets of the following section, excluding the Section Header
      Block itself.  This field can be used to skip the section, for
      faster navigation inside large files.  If the Section Length is -1
      (0xFFFFFFFFFFFFFFFF), this means that the size of the section is
      not specified, and the only way to skip the section is to parse
      the blocks that it contains.  Please note that if this field is
      valid (i.e.  not negative), its value is always a multiple of 4,
      as all the blocks are aligned to and padded to 32-bit (4 octet)
      boundaries.  Also, special care should be taken in accessing this
      field: since the alignment of all the blocks in the file is
      32-bits, this field is not guaranteed to be aligned to a 64-bit
      boundary.  This could be a problem on 64-bit processors.<a href="#section-4.1-10" class="pilcrow">¶</a></p>
<p id="section-4.1-11">o  Options: optionally, a list of options (formatted according to the
      rules defined in Section 3.5) can be present.<a href="#section-4.1-11" class="pilcrow">¶</a></p>
<p id="section-4.1-12">Adding new block types or options would not necessarily require that
   either Major or Minor numbers be changed, as code that does not know
   about the block type or option should just skip it; only if skipping
   a block or option does not work should the minor version number be
   changed.<a href="#section-4.1-12" class="pilcrow">¶</a></p>
<p id="section-4.1-13">Aside from the options defined in Section 3.5, the following options
   are valid within this block:<a href="#section-4.1-13" class="pilcrow">¶</a></p>
<span id="name-section-header-block-option"></span><div id="shg-section-header-block-options-table">
<figure id="figure-11">
          <div class="artwork art-text alignLeft" id="section-4.1-14.1">
<pre>
          +--------------+------+----------+-------------------+
          | Name         | Code | Length   | Multiple allowed? |
          +--------------+------+----------+-------------------+
          | shb_hardware | 2    | variable | no                |
          | shb_os       | 3    | variable | no                |
          | shb_userappl | 4    | variable | no                |
          +--------------+------+----------+-------------------+
</pre>
</div>
<figcaption><a href="#figure-11" class="selfRef">Figure 11</a>:
<a href="#name-section-header-block-option" class="selfRef">Section Header Block Options</a>
          </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.1-15">
          <dt id="section-4.1-15.1">shb_hardware:</dt>
          <dd style="margin-left: 1.5em" id="section-4.1-15.2">
            <p id="section-4.1-15.2.1">
  The shb_hardware option is a UTF-8 string containing the
         description of the hardware used to create this section.  The
         string is not zero-terminated.<a href="#section-4.1-15.2.1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.1-15.2.2">
<pre>
     Examples: "x86 Personal Computer", "Sun Sparc Workstation".
</pre><a href="#section-4.1-15.2.2" class="pilcrow">¶</a>
</div>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-15.3">shb_os:</dt>
          <dd style="margin-left: 1.5em" id="section-4.1-15.4">
            <p id="section-4.1-15.4.1">
  The shb_os option is a UTF-8 string containing the name of
         the operating system used to create this section.  The string
         is not zero-terminated.<a href="#section-4.1-15.4.1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.1-15.4.2">
<pre>
     Examples: "Windows XP SP2", "openSUSE 10.2".
</pre><a href="#section-4.1-15.4.2" class="pilcrow">¶</a>
</div>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-15.5">shb_userappl:</dt>
          <dd style="margin-left: 1.5em" id="section-4.1-15.6">
            <p id="section-4.1-15.6.1">
  The shb_userappl option is a UTF-8 string containing the name
         of the application used to create this section.  The string
         is not zero-terminated.<a href="#section-4.1-15.6.1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.1-15.6.2">
<pre>
     Examples: "dumpcap V0.99.7".
</pre><a href="#section-4.1-15.6.2" class="pilcrow">¶</a>
</div>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.1-16">(XXX Open issue: does a program which re-writes a capture file change the
original hardware/os/application info?)<a href="#section-4.1-16" class="pilcrow">¶</a></p>
</section>
</div>
<div id="interface-description-block">
<section id="section-4.2">
        <h3 id="name-interface-description-block">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-interface-description-block" class="section-name selfRef">Interface Description Block</a>
        </h3>
<p id="section-4.2-1">An Interface Description Block (IDB) is the container for information
   describing an interface on which packet data is captured.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">Tools that write / read the capture file associate an incrementing
   unsigned 32-bit number (starting from '0') to each Interface
   Definition Block, called the Interface ID for the interface in
   question.  This number is unique within each Section and identifies
   the interface to which the IDB refers; it is only unique inside the
   current section, so, two Sections can have different interfaces
   identified by the same Interface ID values.  This unique identifier
   is referenced by other blocks, such as Enhanced Packet Blocks and
   Interface Statistic Blocks, to indicate the interface to which the
   block refers (such the interface that was used to capture the packet
   that an Enhanced Packet Block contains or to which the statistics in
   an Interface Statistic Block refer).<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2-3">There must be an Interface Description Block for each interface to
   which another block refers.  Blocks such as an Enhanced Packet Block
   or an Interface Statistics Block contain an Interface ID value
   referring to a particular interface, and a Simple Packet Block
   implicitly refers to an interface with an Interface ID of 0.  If the
   file does not contain any blocks that use an Interface ID, then the
   file does not need to have any IDBs.<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<p id="section-4.2-4">An Interface Description Block is valid only inside the section to
   which it belongs.  The structure of a Interface Description Block is
   shown in Figure 10.<a href="#section-4.2-4" class="pilcrow">¶</a></p>
<span id="name-interface-description-block-"></span><div id="interface-description-block-fig">
<figure id="figure-12">
          <div class="artwork art-text alignLeft" id="section-4.2-5.1">
<pre>
       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +---------------------------------------------------------------+
    0 |                    Block Type = 0x00000001                    |
      +---------------------------------------------------------------+
    4 |                      Block Total Length                       |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    8 |           LinkType            |           Reserved            |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   12 |                            SnapLen                            |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   16 /                                                               /
      /                      Options (variable)                       /
      /                                                               /
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                      Block Total Length                       |
      +---------------------------------------------------------------+
</pre>
</div>
<figcaption><a href="#figure-12" class="selfRef">Figure 12</a>:
<a href="#name-interface-description-block-" class="selfRef">Interface Description Block Format</a>
          </figcaption></figure>
</div>
<p id="section-4.2-6">The meaning of the fields is:<a href="#section-4.2-6" class="pilcrow">¶</a></p>
<p id="section-4.2-7">o  Block Type: The block type of the Interface Description Block is
      1.<a href="#section-4.2-7" class="pilcrow">¶</a></p>
<p id="section-4.2-8">o  Block Total Length: total size of this block, as described in
      Section 3.1.<a href="#section-4.2-8" class="pilcrow">¶</a></p>
<p id="section-4.2-9">o  LinkType (16 bits): an unsigned value that defines the link layer
      type of this interface.  The list of Standardized Link Layer Type
      codes is available in the tcpdump.org link-layer header types
      registry [3].<a href="#section-4.2-9" class="pilcrow">¶</a></p>
<p id="section-4.2-10">o  Reserved (16 bits): not used - MUST be filled with 0 by pcap file
      writers, and MUST be ignored by pcapng file readers.<a href="#section-4.2-10" class="pilcrow">¶</a></p>
<p id="section-4.2-11">o  SnapLen (32 bits): an unsigned value indicating the maximum number
      of octets captured from each packet.  The portion of each packet
      that exceeds this value will not be stored in the file.  A value
      of zero indicates no limit.<a href="#section-4.2-11" class="pilcrow">¶</a></p>
<p id="section-4.2-12">o  Options: optionally, a list of options (formatted according to the
      rules defined in Section 3.5) can be present.<a href="#section-4.2-12" class="pilcrow">¶</a></p>
<p id="section-4.2-13">In addition to the options defined in Section 3.5, the following
   options are valid within this block:<a href="#section-4.2-13" class="pilcrow">¶</a></p>
<span id="name-interface-description-block-o"></span><div id="interface-description-block-option-table">
<figure id="figure-13">
          <div class="artwork art-text alignLeft" id="section-4.2-14.1">
<pre>
    +----------------+------+---------------------+-------------------+
    | Name           | Code | Length              | Multiple allowed? |
    +----------------+------+---------------------+-------------------+
    | if_name        | 2    | variable            | no                |
    | if_description | 3    | variable            | no                |
    | if_IPv4addr    | 4    | 8                   | yes               |
    | if_IPv6addr    | 5    | 17                  | yes               |
    | if_MACaddr     | 6    | 6                   | no                |
    | if_EUIaddr     | 7    | 8                   | no                |
    | if_speed       | 8    | 8                   | no                |
    | if_tsresol     | 9    | 1                   | no                |
    | if_tzone       | 10   | 4                   | no                |
    | if_filter      | 11   | variable, minimum 1 | no                |
    | if_os          | 12   | variable            | no                |
    | if_fcslen      | 13   | 1                   | no                |
    | if_tsoffset    | 14   | 8                   | no                |
    | if_hardware    | 15   | variable            | no                |
    +----------------+------+---------------------+-------------------+
</pre>
</div>
<figcaption><a href="#figure-13" class="selfRef">Figure 13</a>:
<a href="#name-interface-description-block-o" class="selfRef">Interface Description Block Options</a>
          </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.2-15">
          <dt id="section-4.2-15.1">if_name:</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-15.2">
  The if_name option is a UTF-8 string containing the name of
           the device used to capture data.  The string is not zero-
           terminated.<a href="#section-4.2-15.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<div class="artwork art-text alignLeft" id="section-4.2-16">
<pre>
       Examples: "eth0",
       "\Device\NPF\_{AD1CE675-96D0-47C5-ADD0-2504B9126B68}".
</pre><a href="#section-4.2-16" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.2-17">
          <dt id="section-4.2-17.1">if_description:</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-17.2">
  The if_description option is a UTF-8 string containing the
           description of the device used to capture data.  The string
           is not zero-terminated.<a href="#section-4.2-17.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<div class="artwork art-text alignLeft" id="section-4.2-18">
<pre>
       Examples: "Wi-Fi", "Local Area Connection", "Wireless Network
       Connection", "First Ethernet Interface".
</pre><a href="#section-4.2-18" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.2-19">
          <dt id="section-4.2-19.1">if_IPv4addr:</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-19.2">
  The if_IPv4addr option is an IPv4 network address and
           corresponding netmask for the interface.  The first four
           octets are the IP address, and the next four octets are the
           netmask.  This option can be repeated multiple times within
           the same Interface Description Block when multiple IPv4
           addresses are assigned to the interface.  Note that the IP
           address and netmask are both treated as four octets, one for
           each octet of the address or mask; they are not 32-bit
           numbers, and thus the endianness of the SHB does not affect
           this field's value.<a href="#section-4.2-19.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<div class="artwork art-text alignLeft" id="section-4.2-20">
<pre>
       Examples: '192 168 1 1 255 255 255 0'.
</pre><a href="#section-4.2-20" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.2-21">
          <dt id="section-4.2-21.1">if_IPv6addr:</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-21.2">
  The if_IPv6addr option is an IPv6 network address and
           corresponding prefix length for the interface.  The first 16
           octets are the IP address and the next octet is the prefix
           length.  This option can be repeated multiple times within
           the same Interface Description Block when multiple IPv6
           addresses are assigned to the interface.<a href="#section-4.2-21.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<div class="artwork art-text alignLeft" id="section-4.2-22">
<pre>
       Example: 2001:0db8:85a3:08d3:1319:8a2e:0370:7344/64 is
       written (in hex) as '20 01 0d b8 85 a3 08 d3 13 19 8a 2e 03
       70 73 44 40'.
</pre><a href="#section-4.2-22" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.2-23">
          <dt id="section-4.2-23.1">if_MACaddr:</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-23.2">
  The if_MACaddr option is the Interface Hardware MAC address
           (48 bits), if available.<a href="#section-4.2-23.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<div class="artwork art-text alignLeft" id="section-4.2-24">
<pre>
       Example: '00 01 02 03 04 05'.
</pre><a href="#section-4.2-24" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.2-25">
          <dt id="section-4.2-25.1">if_EUIaddr:</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-25.2">
  The if_EUIaddr option is the Interface Hardware EUI address
(64 bits), if available.

Example: '02 34 56 FF FE 78 9A BC'.<a href="#section-4.2-25.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-25.3">if_speed:</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-25.4">
  The if_speed option is a 64-bit unsigned value indicating the
           interface speed, in bits per second.<a href="#section-4.2-25.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<div class="artwork art-text alignLeft" id="section-4.2-26">
<pre>
       Example: the 64-bit decimal number 100000000 for 100Mbps.
</pre><a href="#section-4.2-26" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.2-27">
          <dt id="section-4.2-27.1">if_tsresol:</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-27.2">
  The if_tsresol option identifies the resolution of
           timestamps.  If the Most Significant Bit is equal to zero,
           the remaining bits indicates the resolution of the timestamp
           as a negative power of 10 (e.g. 6 means microsecond
           resolution, timestamps are the number of microseconds since
           1970-01-01 00:00:00 UTC).  If the Most Significant Bit is
           equal to one, the remaining bits indicates the resolution as
           as negative power of 2 (e.g. 10 means 1/1024 of second).  If
           this option is not present, a resolution of 10^-6 is assumed
           (i.e. timestamps have the same resolution of the standard
           'libpcap' timestamps).<a href="#section-4.2-27.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<div class="artwork art-text alignLeft" id="section-4.2-28">
<pre>
       Example: '6'.
</pre><a href="#section-4.2-28" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.2-29">
          <dt id="section-4.2-29.1">if_tzone:</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-29.2">
  The if_tzone option identifies the time zone for GMT support
(TODO: specify better).

Example: TODO: give a good example.<a href="#section-4.2-29.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-29.3">if_filter:</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-29.4">
  The if_filter option identifies the filter (e.g. "capture
           only TCP traffic") used to capture traffic.  The first octet
           of the Option Data keeps a code of the filter used (e.g. if
           this is a libpcap string, or BPF bytecode, and more).  More
           details about this format will be presented in Appendix XXX
           (TODO).  (TODO: better use different options for different
           fields? e.g. if_filter_pcap, if_filter_bpf, ...)<a href="#section-4.2-29.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<div class="artwork art-text alignLeft" id="section-4.2-30">
<pre>
       Example: '00'"tcp port 23 and host 192.0.2.5".
</pre><a href="#section-4.2-30" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.2-31">
          <dt id="section-4.2-31.1">if_os:</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-31.2">
  The if_os option is a UTF-8 string containing the name of the
           operating system of the machine in which this interface is
           installed.  This can be different from the same information
           that can be contained by the Section Header Block
           (Section 4.1) because the capture can have been done on a
           remote machine.  The string is not zero-terminated.<a href="#section-4.2-31.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<div class="artwork art-text alignLeft" id="section-4.2-32">
<pre>
       Examples: "Windows XP SP2", "openSUSE 10.2".
</pre><a href="#section-4.2-32" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.2-33">
          <dt id="section-4.2-33.1">if_fcslen:</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-33.2">
  The if_fcslen option is an 8-bit unsigned integer value that
           specifies the length of the Frame Check Sequence (in bits)
           for this interface.  For link layers whose FCS length can
           change during time, the Enhanced Packet Block epb_flags
           Option can be used in each Enhanced Packet Block (see
           Section 4.3.1).<a href="#section-4.2-33.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<div class="artwork art-text alignLeft" id="section-4.2-34">
<pre>
       Example: '4'.
</pre><a href="#section-4.2-34" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.2-35">
          <dt id="section-4.2-35.1">if_tsoffset:</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-35.2">
  The if_tsoffset option is a 64-bit signed integer value that
           specifies an offset (in seconds) that must be added to the
           timestamp of each packet to obtain the absolute timestamp of
           a packet.  If the option is missing, the timestamps stored in
           the packet MUST be considered absolute timestamps.  The time
           zone of the offset can be specified with the option if_tzone.
           TODO: won't a if_tsoffset_low for fractional second offsets
           be useful for highly synchronized capture systems?<a href="#section-4.2-35.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<div class="artwork art-text alignLeft" id="section-4.2-36">
<pre>
       Example: '1234'.
</pre><a href="#section-4.2-36" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.2-37">
          <dt id="section-4.2-37.1">if_hardware:</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-37.2">
  The if_hardware option is a UTF-8 string containing the
           description of the interface hardware.  The string is not
           zero-terminated.<a href="#section-4.2-37.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<div class="artwork art-text alignLeft" id="section-4.2-38">
<pre>
       Examples: "Broadcom NetXtreme", "Intel(R) PRO/1000 MT Network
       Connection", "NETGEAR WNA1000Mv2 N150 Wireless USB Micro
       Adapter".
</pre><a href="#section-4.2-38" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="enhanced-packet-block">
<section id="section-4.3">
        <h3 id="name-enhanced-packet-block">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-enhanced-packet-block" class="section-name selfRef">Enhanced Packet Block</a>
        </h3>
<p id="section-4.3-1">An Enhanced Packet Block (EPB) is the standard container for storing
   the packets coming from the network.  The Enhanced Packet Block is
   optional because packets can be stored either by means of this block
   or the Simple Packet Block, which can be used to speed up capture
   file generation; or a file may have no packets in it.  The format of
   an Enhanced Packet Block is shown in Figure 11.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">The Enhanced Packet Block is an improvement over the original, now
   obsolete, Packet Block (Appendix A):<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<p id="section-4.3-3">o  it stores the Interface Identifier as a 32-bit integer value.
      This is a requirement when a capture stores packets coming from a
      large number of interfaces;<a href="#section-4.3-3" class="pilcrow">¶</a></p>
<p id="section-4.3-4">o  unlike the Packet Block (Appendix A), the number of packets
      dropped by the capture system between this packet and the previous
      one is not stored in the header, but rather in an option of the
      block itself.<a href="#section-4.3-4" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.3-5">
<pre>
      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +---------------------------------------------------------------+
    0 |                    Block Type = 0x00000006                    |
      +---------------------------------------------------------------+
    4 |                      Block Total Length                       |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    8 |                         Interface ID                          |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   12 |                        Timestamp (High)                       |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   16 |                        Timestamp (Low)                        |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   20 |                    Captured Packet Length                     |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   24 |                    Original Packet Length                     |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   28 /                                                               /
      /                          Packet Data                          /
      /              variable length, padded to 32 bits               /
      /                                                               /
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      /                                                               /
      /                      Options (variable)                       /
      /                                                               /
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                      Block Total Length                       |
      +---------------------------------------------------------------+

                  Figure 11: Enhanced Packet Block Format
</pre><a href="#section-4.3-5" class="pilcrow">¶</a>
</div>
<p id="section-4.3-6">The Enhanced Packet Block has the following fields:<a href="#section-4.3-6" class="pilcrow">¶</a></p>
<p id="section-4.3-7">o  Block Type: The block type of the Enhanced Packet Block is 6.<a href="#section-4.3-7" class="pilcrow">¶</a></p>
<p id="section-4.3-8">o  Block Total Length: total size of this block, as described in
      Section 3.1.<a href="#section-4.3-8" class="pilcrow">¶</a></p>
<p id="section-4.3-9">o  Interface ID (32 bits): an unsigned value that specifies the
      interface on which this packet was received or transmitted; the
      correct interface will be the one whose Interface Description
      Block (within the current Section of the file) is identified by
      the same number (see Section 4.2) of this field.  The interface ID
      MUST be valid, which means that an matching interface description
      block MUST exist.<a href="#section-4.3-9" class="pilcrow">¶</a></p>
<p id="section-4.3-10">o  Timestamp (High) and Timestamp (Low): upper 32 bits and lower 32
      bits of a 64-bit timestamp.  The timestamp is a single 64-bit
      unsigned integer that represents the number of units of time that
      have elapsed since 1970-01-01 00:00:00 UTC.  The length of a unit
      of time is specified by the 'if_tsresol' option (see Figure 10) of
      the Interface Description Block referenced by this packet.  Note
      that, unlike timestamps in the libpcap file format, timestamps in
      Enhanced Packet Blocks are not saved as two 32-bit values that
      represent the seconds and microseconds that have elapsed since
      1970-01-01 00:00:00 UTC.  Timestamps in Enhanced Packet Blocks are
      saved as two 32-bit words that represent the upper and lower 32
      bits of a single 64-bit quantity.<a href="#section-4.3-10" class="pilcrow">¶</a></p>
<p id="section-4.3-11">o  Captured Packet Length (32 bits): an unsigned value that indicates
      the number of octets captured from the packet (i.e. the length of
      the Packet Data field).  It will be the minimum value among the
      Original Packet Length and the snapshot length for the interface
      (SnapLen, defined in Figure 10).  The value of this field does not
      include the padding octets added at the end of the Packet Data
      field to align the Packet Data field to a 32-bit boundary.<a href="#section-4.3-11" class="pilcrow">¶</a></p>
<p id="section-4.3-12">o  Original Packet Length (32 bits): an unsigned value that indicates
      the actual length of the packet when it was transmitted on the
      network.  It can be different from the Captured Packet Length if
      the packet has been truncated by the capture process.<a href="#section-4.3-12" class="pilcrow">¶</a></p>
<p id="section-4.3-13">o  Packet Data: the data coming from the network, including link-
      layer headers.  The actual length of this field is Captured Packet
      Length plus the padding to a 32-bit boundary.  The format of the
      link-layer headers depends on the LinkType field specified in the
      Interface Description Block (see Section 4.2) and it is specified
      in the entry for that format in the the tcpdump.org link-layer
      header types registry [4].<a href="#section-4.3-13" class="pilcrow">¶</a></p>
<p id="section-4.3-14">o  Options: optionally, a list of options (formatted according to the
      rules defined in Section 3.5) can be present.<a href="#section-4.3-14" class="pilcrow">¶</a></p>
<p id="section-4.3-15">In addition to the options defined in Section 3.5, the following
   options are valid within this block:<a href="#section-4.3-15" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.3-16">
<pre>
   +---------------+------+----------------------------+---------------+
   | Name          | Code | Length                     | Multiple      |
   |               |      |                            | allowed?      |
   +---------------+------+----------------------------+---------------+
   | epb_flags     | 2    | 4                          | no            |
   | epb_hash      | 3    | variable, minimum hash     | yes           |
   |               |      | type-dependent             |               |
   | epb_dropcount | 4    | 8                          | no            |
   +---------------+------+----------------------------+---------------+

                  Table 4: Enhanced Packet Block Options
</pre><a href="#section-4.3-16" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.3-17">
          <dt id="section-4.3-17.1">epb_flags:</dt>
          <dd style="margin-left: 1.5em" id="section-4.3-17.2">
  The epb_flags option is a 32-bit flags word containing link-
           layer information.  A complete specification of the allowed
           flags can be found in Section 4.3.1.<a href="#section-4.3-17.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<div class="artwork art-text alignLeft" id="section-4.3-18">
<pre>
       Example: '0'.
</pre><a href="#section-4.3-18" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.3-19">
          <dt id="section-4.3-19.1">epb_hash:</dt>
          <dd style="margin-left: 1.5em" id="section-4.3-19.2">
  The epb_hash option contains a hash of the packet.  The first
           octet specifies the hashing algorithm, while the following
           octets contain the actual hash, whose size depends on the
           hashing algorithm, and hence from the value in the first
           octet.  The hashing algorithm can be: 2s complement
           (algorithm octet = 0, size = XXX), XOR (algorithm octet = 1,
           size=XXX), CRC32 (algorithm octet = 2, size = 4), MD-5
           (algorithm octet = 3, size = 16), SHA-1 (algorithm octet = 4,
           size = 20), Toeplitz (algorithm octet = 5, size = 4).  The
           hash covers only the packet, not the header added by the
           capture driver: this gives the possibility to calculate it
           inside the network card.  The hash allows easier comparison/
           merging of different capture files, and reliable data
           transfer between the data acquisition system and the capture
           library.<a href="#section-4.3-19.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<div class="artwork art-text alignLeft" id="section-4.3-20">
<pre>
       Examples: '02 EC 1D 87 97', '03 45 6E C2 17 7C 10 1E 3C 2E 99
       6E C2 9A 3D 50 8E'.
</pre><a href="#section-4.3-20" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.3-21">
          <dt id="section-4.3-21.1">epb_dropcount:</dt>
          <dd style="margin-left: 1.5em" id="section-4.3-21.2">
  The epb_dropcount option is a 64-bit unsigned integer value
           specifying the number of packets lost (by the interface and
           the operating system) between this packet and the preceding
           one for the same interface or, for the first packet for an
           interface, between this packet and the start of the capture
           process.<a href="#section-4.3-21.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<div class="artwork art-text alignLeft" id="section-4.3-22">
<pre>
       Example: '0'.
</pre><a href="#section-4.3-22" class="pilcrow">¶</a>
</div>
<div id="enhanced-packet-block-flags-word">
<section id="section-4.3.1">
          <h4 id="name-enhanced-packet-block-flags">
<a href="#section-4.3.1" class="section-number selfRef">4.3.1. </a><a href="#name-enhanced-packet-block-flags" class="section-name selfRef">Enhanced Packet Block Flags Word</a>
          </h4>
<p id="section-4.3.1-1">The Enhanced Packet Block Flags Word is a 32-bit value that contains
   link-layer information about the packet.<a href="#section-4.3.1-1" class="pilcrow">¶</a></p>
<p id="section-4.3.1-2">The word is encoded as an unsigned 32-bit integer, using the
   endianness of the Section Header Block scope it is in.  In the
   following table, the bits are numbered with 0 being the least-
   significant bit and 31 being the most-significant bit of the 32-bit
   unsigned integer.  The meaning of the bits is the following:<a href="#section-4.3.1-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.3.1-3">
<pre>
   +--------+----------------------------------------------------------+
   | Bit    | Description                                              |
   | Number |                                                          |
   +--------+----------------------------------------------------------+
   | 0-1    | Inbound / Outbound packet (00 = information not          |
   |        | available, 01 = inbound, 10 = outbound)                  |
   | 2-4    | Reception type (000 = not specified, 001 = unicast, 010  |
   |        | = multicast, 011 = broadcast, 100 = promiscuous).        |
   | 5-8    | FCS length, in octets (0000 if this information is not   |
   |        | available).  This value overrides the if_fcslen option   |
   |        | of the Interface Description Block, and is used with     |
   |        | those link layers (e.g. PPP) where the length of the FCS |
   |        | can change during time.                                  |
   | 9-15   | Reserved (MUST be set to zero).                          |
   | 16-31  | link-layer-dependent errors (Bit 31 = symbol error, Bit  |
   |        | 30 = preamble error, Bit 29 = Start Frame Delimiter      |
   |        | error, Bit 28 = unaligned frame error, Bit 27 = wrong    |
   |        | Inter Frame Gap error, Bit 26 = packet too short error,  |
   |        | Bit 25 = packet too long error, Bit 24 = CRC error,      |
   |        | other?? are 16 bit enough?).                             |
   +--------+----------------------------------------------------------+

</pre><a href="#section-4.3.1-3" class="pilcrow">¶</a>
</div>
<p id="section-4.3.1-4">NOTE: in earlier versions of this specification, the bits were
   specified as being numbered with 0 being the most-significant bit and
   31 being the least-significant bit of the 32-bit unsigned integer,
   rather than with 0 being the least-significant bit and 31 being the
   most-significant bit.  Several implementations number the bits with 0
   being the least-significant bit, and no known implementations number
   them with 0 being the most-significant bit, so the specification was
   changed to reflect that reality.<a href="#section-4.3.1-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="simple-packet-block">
<section id="section-4.4">
        <h3 id="name-simple-packet-block">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-simple-packet-block" class="section-name selfRef">Simple Packet Block</a>
        </h3>
<p id="section-4.4-1">The Simple Packet Block (SPB) is a lightweight container for storing
   the packets coming from the network.  Its presence is optional.<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<p id="section-4.4-2">A Simple Packet Block is similar to an Enhanced Packet Block (see
   Section 4.3), but it is smaller, simpler to process and contains only
   a minimal set of information.  This block is preferred to the
   standard Enhanced Packet Block when performance or space occupation
   are critical factors, such as in sustained traffic capture
   applications.  A capture file can contain both Enhanced Packet Blocks
   and Simple Packet Blocks: for example, a capture tool could switch
   from Enhanced Packet Blocks to Simple Packet Blocks when the hardware
   resources become critical.<a href="#section-4.4-2" class="pilcrow">¶</a></p>
<p id="section-4.4-3">The Simple Packet Block does not contain the Interface ID field.
   Therefore, it MUST be assumed that all the Simple Packet Blocks have
   been captured on the interface previously specified in the first
   Interface Description Block.<a href="#section-4.4-3" class="pilcrow">¶</a></p>
<p id="section-4.4-4">Figure 12 shows the format of the Simple Packet Block.<a href="#section-4.4-4" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.4-5">
<pre>
       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +---------------------------------------------------------------+
    0 |                    Block Type = 0x00000003                    |
      +---------------------------------------------------------------+
    4 |                      Block Total Length                       |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    8 |                    Original Packet Length                     |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   12 /                                                               /
      /                          Packet Data                          /
      /              variable length, padded to 32 bits               /
      /                                                               /
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                      Block Total Length                       |
      +---------------------------------------------------------------+

                   Figure 12: Simple Packet Block Format
</pre><a href="#section-4.4-5" class="pilcrow">¶</a>
</div>
<p id="section-4.4-6">The Simple Packet Block has the following fields:<a href="#section-4.4-6" class="pilcrow">¶</a></p>
<p id="section-4.4-7">o  Block Type: The block type of the Simple Packet Block is 3.<a href="#section-4.4-7" class="pilcrow">¶</a></p>
<p id="section-4.4-8">o  Block Total Length: total size of this block, as described in
      Section 3.1.<a href="#section-4.4-8" class="pilcrow">¶</a></p>
<p id="section-4.4-9">o  Original Packet Length (32 bits): an unsigned value indicating the
      actual length of the packet when it was transmitted on the
      network.  It can be different from length of the Packet Data
      field's length if the packet has been truncated by the capture
      process, in which case the SnapLen value in Section 4.2 will be
      less than this Original Packet Length value, and the SnapLen value
      MUST be used to determine the size of the Packet Data field
      length.<a href="#section-4.4-9" class="pilcrow">¶</a></p>
<p id="section-4.4-10">o  Packet Data: the data coming from the network, including link-
      layer headers.  The length of this field can be derived from the
      field Block Total Length, present in the Block Header, and it is
      the minimum value among the SnapLen (present in the Interface
      Description Block) and the Original Packet Length (present in this
      header).  The format of the data within this Packet Data field
      depends on the LinkType field specified in the Interface
      Description Block (see Section 4.2) and it is specified in the
      entry for that format in the tcpdump.org link-layer header types
      registry [5].<a href="#section-4.4-10" class="pilcrow">¶</a></p>
<p id="section-4.4-11">The Simple Packet Block does not contain the timestamp because this
   is often one of the most costly operations on PCs.  Additionally,
   there are applications that do not require it; e.g. an Intrusion
   Detection System is interested in packets, not in their timestamp.<a href="#section-4.4-11" class="pilcrow">¶</a></p>
<p id="section-4.4-12">A Simple Packet Block cannot be present in a Section that has more
   than one interface because of the impossibility to refer to the
   correct one (it does not contain any Interface ID field).<a href="#section-4.4-12" class="pilcrow">¶</a></p>
<p id="section-4.4-13">The Simple Packet Block is very efficient in term of disk space: a
   snapshot whose length is 100 octets requires only 16 octets of
   overhead, which corresponds to an efficiency of more than 86%.<a href="#section-4.4-13" class="pilcrow">¶</a></p>
</section>
</div>
<div id="name-resolution-block">
<section id="section-4.5">
        <h3 id="name-name-resolution-block">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-name-resolution-block" class="section-name selfRef">Name Resolution Block</a>
        </h3>
<p id="section-4.5-1">The Name Resolution Block (NRB) is used to support the correlation of
   numeric addresses (present in the captured packets) and their
   corresponding canonical names and it is optional.  Having the literal
   names saved in the file prevents the need for performing name
   resolution at a later time, when the association between names and
   addresses may be different from the one in use at capture time.
   Moreover, the NRB avoids the need for issuing a lot of DNS requests
   every time the trace capture is opened, and also provides name
   resolution when reading the capture with a machine not connected to
   the network.<a href="#section-4.5-1" class="pilcrow">¶</a></p>
<p id="section-4.5-2">A Name Resolution Block is often placed at the beginning of the file,
   but no assumptions can be taken about its position.  Multiple NRBs
   can exist in a pcapng file, either due to memory constraints or
   because additional name resolutions were performed by file processing
   tools, like network analyzers.<a href="#section-4.5-2" class="pilcrow">¶</a></p>
<p id="section-4.5-3">A Name Resolution Block need not contain any Records, except the
   nrb_record_end Record which MUST be the last Record.  The addresses
   and names in NRB Records MAY be repeated multiple times; i.e., the
   same IP address may resolve to multiple names, the same name may
   resolve to the multiple IP addresses, and even the same address-to-
   name pair may appear multiple times, in the same NRB or across NRBs.<a href="#section-4.5-3" class="pilcrow">¶</a></p>
<p id="section-4.5-4">The format of the Name Resolution Block is shown in Figure 13.<a href="#section-4.5-4" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.5-5">
<pre>
       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +---------------------------------------------------------------+
    0 |                    Block Type = 0x00000004                    |
      +---------------------------------------------------------------+
    4 |                      Block Total Length                       |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    8 |      Record Type              |      Record Value Length      |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   12 /                       Record Value                            /
      /              variable length, padded to 32 bits               /
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      .                                                               .
      .                  . . . other records . . .                    .
      .                                                               .
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |  Record Type = nrb_record_end |   Record Value Length = 0     |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      /                                                               /
      /                      Options (variable)                       /
      /                                                               /
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                      Block Total Length                       |
      +---------------------------------------------------------------+

                  Figure 13: Name Resolution Block Format
</pre><a href="#section-4.5-5" class="pilcrow">¶</a>
</div>
<p id="section-4.5-6">The Name Resolution Block has the following fields:<a href="#section-4.5-6" class="pilcrow">¶</a></p>
<p id="section-4.5-7">o  Block Type: The block type of the Name Resolution Block is 4.<a href="#section-4.5-7" class="pilcrow">¶</a></p>
<p id="section-4.5-8">o  Block Total Length: total size of this block, as described in
      Section 3.1.<a href="#section-4.5-8" class="pilcrow">¶</a></p>
<p id="section-4.5-9">This is followed by zero or more Name Resolution Records (in the TLV
   format), each of which contains an association between a network
   address and a name.  An nrb_record_end MUST be added after the last
   Record, and MUST exist even if there are no other Records in the NRB.
   There are currently three possible types of records:<a href="#section-4.5-9" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.5-10">
<pre>
                  +-----------------+--------+----------+
                  | Name            | Code   | Length   |
                  +-----------------+--------+----------+
                  | nrb_record_end  | 0x0000 | 0        |
                  | nrb_record_ipv4 | 0x0001 | variable |
                  | nrb_record_ipv6 | 0x0002 | variable |
                  +-----------------+--------+----------+

                  Table 5: Name Resolution Block Records
</pre><a href="#section-4.5-10" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.5-11">
          <dt id="section-4.5-11.1">nrb_record_end:</dt>
          <dd style="margin-left: 1.5em" id="section-4.5-11.2">
  The nrb_record_end record delimits the end of name resolution
           records.  This record is needed to determine when the list of
           name resolution records has ended and some options (if any)
           begin.<a href="#section-4.5-11.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.5-11.3">nrb_record_ipv4:</dt>
          <dd style="margin-left: 1.5em" id="section-4.5-11.4">
  The nrb_record_ipv4 record specifies an IPv4 address
           (contained in the first 4 octets), followed by one or more
           zero-terminated UTF-8 strings containing the DNS entries for
           that address.  The minimum valid Record Length for this
           Record Type is thus 6: 4 for the IP octets, 1 character, and
           a zero-value octet terminator.  Note that the IP address is
           treated as four octets, one for each octet of the IP address;
           it is not a 32-bit word, and thus the endianness of the SHB
           does not affect this field's value.<a href="#section-4.5-11.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<div class="artwork art-text alignLeft" id="section-4.5-12">
<pre>
       Example: '127 0 0 1'"localhost".

       [Open issue: is an empty string (i.e., just a zero-value
       octet) valid?]
</pre><a href="#section-4.5-12" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.5-13">
          <dt id="section-4.5-13.1">nrb_record_ipv6:</dt>
          <dd style="margin-left: 1.5em" id="section-4.5-13.2">
  The nrb_record_ipv6 record specifies an IPv6 address
           (contained in the first 16 octets), followed by one or more
           zero-terminated strings containing the DNS entries for that
           address.  The minimum valid Record Length for this Record
           Type is thus 18: 16 for the IP octets, 1 character, and a
           zero-value octet terminator.<a href="#section-4.5-13.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<div class="artwork art-text alignLeft" id="section-4.5-14">
<pre>
       Example: '20 01 0d b8 00 00 00 00 00 00 00 00 12 34 56
       78'"somehost".

       (Open issue: is an empty string (i.e., just a zero-value
       octet) valid?)
</pre><a href="#section-4.5-14" class="pilcrow">¶</a>
</div>
<p id="section-4.5-15">Record Types other than those specified earlier MUST be ignored and
   skipped past.  More Record Types will likely be defined in the
   future, and MUST NOT break backwards compatibility.<a href="#section-4.5-15" class="pilcrow">¶</a></p>
<p id="section-4.5-16">Each Record Value is aligned to and padded to a 32-bit boundary.  The
   corresponding Record Value Length reflects the actual length of the
   Record Value; it does not include the lengths of the Record Type
   field, the Record Value Length field, any padding for the Record
   Value, or anything after the Record Value.  For Record Types with
   name strings, the Record Length does include the zero-value octet
   terminating that string.  A Record Length of 0 is valid, unless
   indicated otherwise.<a href="#section-4.5-16" class="pilcrow">¶</a></p>
<p id="section-4.5-17">After the list of Name Resolution Records, optionally, a list of
   options (formatted according to the rules defined in Section 3.5) can
   be present.<a href="#section-4.5-17" class="pilcrow">¶</a></p>
<p id="section-4.5-18">In addition to the options defined in Section 3.5, the following
   options are valid within this block:<a href="#section-4.5-18" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.5-19">
<pre>
          +---------------+------+----------+-------------------+
          | Name          | Code | Length   | Multiple allowed? |
          +---------------+------+----------+-------------------+
          | ns_dnsname    | 2    | variable | no                |
          | ns_dnsIP4addr | 3    | 4        | no                |
          | ns_dnsIP6addr | 4    | 16       | no                |
          +---------------+------+----------+-------------------+

                  Table 6: Name Resolution Block Options
</pre><a href="#section-4.5-19" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.5-20">
          <dt id="section-4.5-20.1">ns_dnsname:</dt>
          <dd style="margin-left: 1.5em" id="section-4.5-20.2">
  The ns_dnsname option is a UTF-8 string containing the name
           of the machine (DNS server) used to perform the name
           resolution.  The string is not zero-terminated.<a href="#section-4.5-20.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<div class="artwork art-text alignLeft" id="section-4.5-21">
<pre>
       Example: "our\_nameserver".
</pre><a href="#section-4.5-21" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.5-22">
          <dt id="section-4.5-22.1">ns_dnsIP4addr:</dt>
          <dd style="margin-left: 1.5em" id="section-4.5-22.2">
  The ns_dnsIP4addr option specifies the IPv4 address of the
           DNS server.  Note that the IP address is treated as four
           octets, one for each octet of the IP address; it is not a
           32-bit word, and thus the endianness of the SHB does not
           affect this field's value.<a href="#section-4.5-22.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<div class="artwork art-text alignLeft" id="section-4.5-23">
<pre>
       Example: '192 168 0 1'.
</pre><a href="#section-4.5-23" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.5-24">
          <dt id="section-4.5-24.1">ns_dnsIP6addr:</dt>
          <dd style="margin-left: 1.5em" id="section-4.5-24.2">
            <p id="section-4.5-24.2.1">
  The ns_dnsIP6addr option specifies the IPv6 address of the DNS server.<a href="#section-4.5-24.2.1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.5-24.2.2">
<pre>
     Example: '20 01 0d b8 00 00 00 00 00 00 00 00 12 34 56 78'.
</pre><a href="#section-4.5-24.2.2" class="pilcrow">¶</a>
</div>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="interface-statistics-block">
<section id="section-4.6">
        <h3 id="name-interface-statistics-block">
<a href="#section-4.6" class="section-number selfRef">4.6. </a><a href="#name-interface-statistics-block" class="section-name selfRef">Interface Statistics Block</a>
        </h3>
<p id="section-4.6-1">The Interface Statistics Block (ISB) contains the capture statistics
   for a given interface and it is optional.  The statistics are
   referred to the interface defined in the current Section identified
   by the Interface ID field.  An Interface Statistics Block is normally
   placed at the end of the file, but no assumptions can be taken about
   its position - it can even appear multiple times for the same
   interface.<a href="#section-4.6-1" class="pilcrow">¶</a></p>
<p id="section-4.6-2">The format of the Interface Statistics Block is shown in Figure 14.<a href="#section-4.6-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.6-3">
<pre>
       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +---------------------------------------------------------------+
    0 |                   Block Type = 0x00000005                     |
      +---------------------------------------------------------------+
    4 |                      Block Total Length                       |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    8 |                         Interface ID                          |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   12 |                        Timestamp (High)                       |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   16 |                        Timestamp (Low)                        |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   20 /                                                               /
      /                      Options (variable)                       /
      /                                                               /
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                      Block Total Length                       |
      +---------------------------------------------------------------+

               Figure 14: Interface Statistics Block Format
</pre><a href="#section-4.6-3" class="pilcrow">¶</a>
</div>
<p id="section-4.6-4">The fields have the following meaning:<a href="#section-4.6-4" class="pilcrow">¶</a></p>
<p id="section-4.6-5">o  Block Type: The block type of the Interface Statistics Block is 5.<a href="#section-4.6-5" class="pilcrow">¶</a></p>
<p id="section-4.6-6">o  Block Total Length: total size of this block, as described in
      Section 3.1.<a href="#section-4.6-6" class="pilcrow">¶</a></p>
<p id="section-4.6-7">o  Interface ID: specifies the interface these statistics refers to;
      the correct interface will be the one whose Interface Description
      Block (within the current Section of the file) is identified by
      same number (see Section 4.2) of this field.<a href="#section-4.6-7" class="pilcrow">¶</a></p>
<p id="section-4.6-8">o  Timestamp: time this statistics refers to.  The format of the
      timestamp is the same already defined in the Enhanced Packet Block
      (Section 4.3); the length of a unit of time is specified by the
      'if_tsresol' option (see Figure 10) of the Interface Description
      Block referenced by this packet.<a href="#section-4.6-8" class="pilcrow">¶</a></p>
<p id="section-4.6-9">o  Options: optionally, a list of options (formatted according to the
      rules defined in Section 3.5) can be present.<a href="#section-4.6-9" class="pilcrow">¶</a></p>
<p id="section-4.6-10">All the statistic fields are defined as options in order to deal with
   systems that do not have a complete set of statistics.  Therefore, In
   addition to the options defined in Section 3.5, the following options
   are valid within this block:<a href="#section-4.6-10" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.6-11">
<pre>
         +------------------+------+--------+-------------------+
         | Name             | Code | Length | Multiple allowed? |
         +------------------+------+--------+-------------------+
         | isb_starttime    | 2    | 8      | no                |
         | isb_endtime      | 3    | 8      | no                |
         | isb_ifrecv       | 4    | 8      | no                |
         | isb_ifdrop       | 5    | 8      | no                |
         | isb_filteraccept | 6    | 8      | no                |
         | isb_osdrop       | 7    | 8      | no                |
         | isb_usrdeliv     | 8    | 8      | no                |
         +------------------+------+--------+-------------------+

                Table 7: Interface Statistics Block Options
</pre><a href="#section-4.6-11" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.6-12">
          <dt id="section-4.6-12.1">isb_starttime:</dt>
          <dd style="margin-left: 1.5em" id="section-4.6-12.2">
  The isb_starttime option specifies the time the capture
           started; time will be stored in two blocks of four octets
           each.  The format of the timestamp is the same as the one
           defined in the Enhanced Packet Block (Section 4.3); the
           length of a unit of time is specified by the 'if_tsresol'
           option (see Figure 10) of the Interface Description Block
           referenced by this packet.<a href="#section-4.6-12.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<div class="artwork art-text alignLeft" id="section-4.6-13">
<pre>
       Example: '96 c3 04 00 73 89 6a 65', in Little Endian, decodes
       to 2012-06-29 06:17:00.834163 UTC.
</pre><a href="#section-4.6-13" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.6-14">
          <dt id="section-4.6-14.1">isb_endtime:</dt>
          <dd style="margin-left: 1.5em" id="section-4.6-14.2">
  The isb_endtime option specifies the time the capture ended;
           time will be stored in two blocks of four octets each.  The
           format of the timestamp is the same as the one defined in the
           Enhanced Packet Block (Section 4.3); the length of a unit of
           time is specified by the 'if_tsresol' option (see Figure 10)
           of the Interface Description Block referenced by this packet.<a href="#section-4.6-14.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<div class="artwork art-text alignLeft" id="section-4.6-15">
<pre>
       Example: '97 c3 04 00 aa 47 ca 64', in Little Endian, decodes
       to 2012-06-29 07:28:25.298858 UTC.
</pre><a href="#section-4.6-15" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.6-16">
          <dt id="section-4.6-16.1">isb_ifrecv:</dt>
          <dd style="margin-left: 1.5em" id="section-4.6-16.2">
  The isb_ifrecv option specifies the 64-bit unsigned integer
           number of packets received from the physical interface
           starting from the beginning of the capture.<a href="#section-4.6-16.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<div class="artwork art-text alignLeft" id="section-4.6-17">
<pre>
       Example: the decimal number 100.
</pre><a href="#section-4.6-17" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.6-18">
          <dt id="section-4.6-18.1">isb_ifdrop:</dt>
          <dd style="margin-left: 1.5em" id="section-4.6-18.2">
  The isb_ifdrop option specifies the 64-bit unsigned integer
           number of packets dropped by the interface due to lack of
           resources starting from the beginning of the capture.<a href="#section-4.6-18.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<div class="artwork art-text alignLeft" id="section-4.6-19">
<pre>
       Example: '0'.
</pre><a href="#section-4.6-19" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.6-20">
          <dt id="section-4.6-20.1">isb_filteraccept:</dt>
          <dd style="margin-left: 1.5em" id="section-4.6-20.2">
  The isb_filteraccept option specifies the 64-bit unsigned
           integer number of packets accepted by filter starting from
           the beginning of the capture.<a href="#section-4.6-20.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<div class="artwork art-text alignLeft" id="section-4.6-21">
<pre>
       Example: the decimal number 100.
</pre><a href="#section-4.6-21" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.6-22">
          <dt id="section-4.6-22.1">isb_osdrop:</dt>
          <dd style="margin-left: 1.5em" id="section-4.6-22.2">
  The isb_osdrop option specifies the 64-bit unsigned integer
           number of packets dropped by the operating system starting
           from the beginning of the capture.<a href="#section-4.6-22.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<div class="artwork art-text alignLeft" id="section-4.6-23">
<pre>
       Example: '0'.
</pre><a href="#section-4.6-23" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.6-24">
          <dt id="section-4.6-24.1">isb_usrdeliv:</dt>
          <dd style="margin-left: 1.5em" id="section-4.6-24.2">
  The isb_usrdeliv option specifies the 64-bit unsigned integer
           number of packets delivered to the user starting from the
           beginning of the capture.  The value contained in this field
           can be different from the value 'isb_filteraccept -
           isb_osdrop' because some packets could still be in the OS
           buffers when the capture ended.<a href="#section-4.6-24.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<div class="artwork art-text alignLeft" id="section-4.6-25">
<pre>
       Example: '0'.
</pre><a href="#section-4.6-25" class="pilcrow">¶</a>
</div>
<p id="section-4.6-26">All the fields that refer to packet counters are 64-bit values,
   represented with the octet order of the current section.  Special
   care must be taken in accessing these fields: since all the blocks
   are aligned to a 32-bit boundary, such fields are not guaranteed to
   be aligned on a 64-bit boundary.<a href="#section-4.6-26" class="pilcrow">¶</a></p>
</section>
</div>
<div id="systemd-journal-export-block">
<section id="section-4.7">
        <h3 id="name-systemd-journal-export-bloc">
<a href="#section-4.7" class="section-number selfRef">4.7. </a><a href="#name-systemd-journal-export-bloc" class="section-name selfRef">systemd Journal Export Block</a>
        </h3>
<p id="section-4.7-1">The systemd [6] Journal Export Block [7] is a lightweight containter
   for systemd Journal Export Format entry data.<a href="#section-4.7-1" class="pilcrow">¶</a></p>
<p id="section-4.7-2">One of the primary components of the systemd System and Service
   Manager is the "Journal", a message logging system that uses arrays
   of key-value pairs.  Journal entries are stored in a databse-like
   file on disk but can be serialized to easily parseable "Journal
   Export Format" data or to a JSON object.  The block described here is
   limited to Journal Export Format data only.<a href="#section-4.7-2" class="pilcrow">¶</a></p>
<p id="section-4.7-3">A systemd Journal Export Block contains a single systemd Journal
   Export Format entry.  Each entry MUST contain a __REALTIME_TIMESTAMP=
   field.  If a timestamp for the block is required it can be derived
   from this field.  Each entry MUST be zero-padded to 32 bits.
   Although the primary use of this block is intended for importing data
   from systemd, it could potentially be used to include arbitrary key-
   value data in a capture file.<a href="#section-4.7-3" class="pilcrow">¶</a></p>
<p id="section-4.7-4">Figure 15 shows the format of the Journal Export Block.<a href="#section-4.7-4" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.7-5">
<pre>
       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +---------------------------------------------------------------+
    0 |                    Block Type = 0x00000009                    |
      +---------------------------------------------------------------+
    4 |                      Block Total Length                       |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    8 /                                                               /
      /                         Journal Entry                         /
      /              variable length, padded to 32 bits               /
      /                                                               /
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                      Block Total Length                       |
      +---------------------------------------------------------------+

              Figure 15: systemd Journal Export Block Format
</pre><a href="#section-4.7-5" class="pilcrow">¶</a>
</div>
<p id="section-4.7-6">The systemd Journal Export Block has the following fields:<a href="#section-4.7-6" class="pilcrow">¶</a></p>
<p id="section-4.7-7">o  Block Type: The block type of the Journal Export Block is 9.<a href="#section-4.7-7" class="pilcrow">¶</a></p>
<p id="section-4.7-8">o  Block Total Length: total size of this block, as described in
      Section 3.1.<a href="#section-4.7-8" class="pilcrow">¶</a></p>
<p id="section-4.7-9">o  Journal Entry: A journal entry as described in the Journal Export
      Format [8] documentation.  Entries consist of a series of field
      names followed by text or binary field data.  Common field names
      can be found in the systemd.journal-fields [9] documentation.  The
      __REALTIME_TIMESTAMP= field MUST be present and valid as described
      above.  Entries are not guaranteed to be a multiple of four octets
      and must be zero-padded.  This allows the length of the entry to
      be be determined by finding the last non-zero octet in the Journal
      Entry data.  An entry may contain an entry separator (trailing
      newline) as described in the Journal Export Format specification<a href="#section-4.7-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="decryption-secrets-block">
<section id="section-4.8">
        <h3 id="name-decryption-secrets-block">
<a href="#section-4.8" class="section-number selfRef">4.8. </a><a href="#name-decryption-secrets-block" class="section-name selfRef">Decryption Secrets Block</a>
        </h3>
<p id="section-4.8-1">A Decryption Secrets Block (DSB) stores (session) secrets that enable
   decryption of packets within the capture file.  The format of these
   secrets is defined by the Secrets Type.<a href="#section-4.8-1" class="pilcrow">¶</a></p>
<p id="section-4.8-2">Multiple DSBs can exist in a pcapng file, but they SHOULD be written
   before packet blocks that require those secrets.  Tools MAY limit
   decryption to secrets that appear before packet blocks.<a href="#section-4.8-2" class="pilcrow">¶</a></p>
<p id="section-4.8-3">The structure of a Decryption Secrets Block is shown in Figure 16.<a href="#section-4.8-3" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.8-4">
<pre>
      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +---------------------------------------------------------------+
    0 |                   Block Type = 0x0000000A                     |
      +---------------------------------------------------------------+
    4 |                      Block Total Length                       |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    8 |                          Secrets Type                         |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   12 |                         Secrets Length                        |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   16 /                                                               /
      /                          Secrets Data                         /
      /              (variable length, padded to 32 bits)             /
      /                                                               /
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      /                                                               /
      /                       Options (variable)                      /
      /                                                               /
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      /                       Block Total Length                      /
      +---------------------------------------------------------------+

                Figure 16: Decryption Secrets Block Format
</pre><a href="#section-4.8-4" class="pilcrow">¶</a>
</div>
<p id="section-4.8-5">The Decryption Secrets Block has the following fields.<a href="#section-4.8-5" class="pilcrow">¶</a></p>
<p id="section-4.8-6">o  Block Type: The block type of the Decryption Secrets Block is 10.<a href="#section-4.8-6" class="pilcrow">¶</a></p>
<p id="section-4.8-7">o  Block Total Length: total size of this block, as described in
      Section 3.1.<a href="#section-4.8-7" class="pilcrow">¶</a></p>
<p id="section-4.8-8">o  Secrets Type (32 bits): an unsigned integer identifier that
      describes the format of the following Secrets field.  Requests for
      new Secrets Type codes should be sent to the pcap-ng-format
      mailing list [10].<a href="#section-4.8-8" class="pilcrow">¶</a></p>
<p id="section-4.8-9">o  Secrets Length (32 bits): an unsigned integer that indicates the
      size of the following Secrets field, without any padding octets.<a href="#section-4.8-9" class="pilcrow">¶</a></p>
<p id="section-4.8-10">o  Secrets Data: binary data containing secrets, padded to a 32 bit
      boundary.<a href="#section-4.8-10" class="pilcrow">¶</a></p>
<p id="section-4.8-11">o  Options: optionally, a list of options (formatted according to the
      rules defined in Section 3.5) can be present.  No DSB-specific
      options are currently defined.<a href="#section-4.8-11" class="pilcrow">¶</a></p>
<p id="section-4.8-12">The following is a list of Secrets Types.<a href="#section-4.8-12" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.8-13">
          <dt id="section-4.8-13.1">0x544c534b:</dt>
          <dd style="margin-left: 1.5em" id="section-4.8-13.2">
  TLS Key Log. This format is described at NSS Key Log Format
           [11].  Every line MUST be properly terminated with either
           carriage return and linefeed ('\r\n') or linefeed ('\n').
           Tools MUST be able to handle both line endings.<a href="#section-4.8-13.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.8-13.3">0x57474b4c:</dt>
          <dd style="margin-left: 1.5em" id="section-4.8-13.4">
  WireGuard Key Log.  Every line consists of the key type,
           equals sign ('='), and the base64-encoded 32-byte key with
           optional spaces before and in between.  The key type is one
           of LOCAL_STATIC_PRIVATE_KEY, REMOTE_STATIC_PUBLIC_KEY,
           LOCAL_EPHEMERAL_PRIVATE_KEY, or PRESHARED_KEY.  This matches
           the output of extract-handshakes.sh [12] which is part of the
           WireGuard [13] project.  A PRESHARED_KEY line is linked to a
           session matched by a previous LOCAL_EPHEMERAL_PRIVATE_KEY
           line.  Every line MUST be properly terminated with either
           carriage return and linefeed ('\r\n') or linefeed ('\n').
           Tools MUST be able to handle both line endings.<a href="#section-4.8-13.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<div class="artwork art-text alignLeft" id="section-4.8-14">
<pre>
       Warning: LOCAL\_STATIC\_PRIVATE\_KEY and potentially
       PRESHARED\_KEY are long-term secrets, users SHOULD only store
       non-production keys, or ensure proper protection of the
       pcapng file.
</pre><a href="#section-4.8-14" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="custom-block">
<section id="section-4.9">
        <h3 id="name-custom-block">
<a href="#section-4.9" class="section-number selfRef">4.9. </a><a href="#name-custom-block" class="section-name selfRef">Custom Block</a>
        </h3>
<p id="section-4.9-1">A Custom Block (CB) is the container for storing custom data that is
   not part of another block; for storing custom data as part of another
   block, see Section 3.5.1.  The Custom Block is optional, can be
   repeated any number of times, and can appear before or after any
   other block except the first Section Header Block which must come
   first in the file.  Different Custom Blocks, of different type codes
   and/or different Private Enterprise Numbers, may be used in the same
   pcapng file.  The format of a Custom Block is shown in Figure 17.<a href="#section-4.9-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.9-2">
<pre>
      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +---------------------------------------------------------------+
    0 |             Block Type = 0x00000BAD or 0x40000BAD             |
      +---------------------------------------------------------------+
    4 |                      Block Total Length                       |
      +---------------------------------------------------------------+
    8 |                Private Enterprise Number (PEN)                |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   12 /                                                               /
      /                          Custom Data                          /
      /              variable length, padded to 32 bits               /
      /                                                               /
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      /                                                               /
      /                      Options (variable)                       /
      /                                                               /
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                      Block Total Length                       |
      +---------------------------------------------------------------+

                      Figure 17: Custom Block Format
</pre><a href="#section-4.9-2" class="pilcrow">¶</a>
</div>
<p id="section-4.9-3">The Custom Block uses the type code 0x00000BAD (2989 in decimal) for
   a custom block that pcapng re-writers can copy into new files, and
   the type code 0x40000BAD (1073744813 in decimal) for one that should
   not be copied.  See Section 6.2 for details.<a href="#section-4.9-3" class="pilcrow">¶</a></p>
<p id="section-4.9-4">The Custom Block has the following fields:<a href="#section-4.9-4" class="pilcrow">¶</a></p>
<p id="section-4.9-5">o  Block Type: The block type of the Custom Block is 0x00000BAD or
      0x40000BAD, as described previously.<a href="#section-4.9-5" class="pilcrow">¶</a></p>
<p id="section-4.9-6">o  Block Total Length: total size of this block, as described in
      Section 3.1.<a href="#section-4.9-6" class="pilcrow">¶</a></p>
<p id="section-4.9-7">o  Private Enterprise Number (32 bits): An IANA-assigned Private
      Enterprise Number identifying the organization which defined the
      Custom Block.  See Section 6.1 for details.  The PEN MUST be
      encoded using the same endianness as the Section Header Block it
      is within the scope of.<a href="#section-4.9-7" class="pilcrow">¶</a></p>
<p id="section-4.9-8">o  Custom Data: the custom data, padded to a 32 bit boundary.<a href="#section-4.9-8" class="pilcrow">¶</a></p>
<p id="section-4.9-9">o  Options: optionally, a list of options (formatted according to the
      rules defined in Section 3.5) can be present.  Note that custom
      options for the Custom Block still use the custom option format
      and type code, as described in Section 3.5.1.<a href="#section-4.9-9" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="experimental-blocks-deserve-further-investigation">
<section id="section-5">
      <h2 id="name-experimental-blocks-deserve">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-experimental-blocks-deserve" class="section-name selfRef">Experimental Blocks (deserve further investigation)</a>
      </h2>
<div id="alternative-packet-blocks-experimental">
<section id="section-5.1">
        <h3 id="name-alternative-packet-blocks-e">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-alternative-packet-blocks-e" class="section-name selfRef">Alternative Packet Blocks (experimental)</a>
        </h3>
<p id="section-5.1-1">Can some other packet blocks (besides the ones described in the
   previous paragraphs) be useful?<a href="#section-5.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="compression-block-experimental">
<section id="section-5.2">
        <h3 id="name-compression-block-experimen">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-compression-block-experimen" class="section-name selfRef">Compression Block (experimental)</a>
        </h3>
<p id="section-5.2-1">The Compression Block is optional.  A file can contain an arbitrary
   number of these blocks.  A Compression Block, as the name says, is
   used to store compressed data.  Its format is shown in Figure 18.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-5.2-2">
<pre>
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +---------------------------------------------------------------+
   |                        Block Type = ?                         |
   +---------------------------------------------------------------+
   |                      Block Total Length                       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |  Compr. Type  |                                               |
   +-+-+-+-+-+-+-+-+                                               |
   |                                                               |
   |                       Compressed Data                         |
   |                                                               |
   |  variable length, octet-aligned and padded to end on a 32-bit |
   |                         boundary                              |
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                      Block Total Length                       |
   +---------------------------------------------------------------+

                    Figure 18: Compression Block Format
</pre><a href="#section-5.2-2" class="pilcrow">¶</a>
</div>
<p id="section-5.2-3">The fields have the following meaning:<a href="#section-5.2-3" class="pilcrow">¶</a></p>
<p id="section-5.2-4">o  Block Type: The block type of the Compression Block is not yet
      assigned.<a href="#section-5.2-4" class="pilcrow">¶</a></p>
<p id="section-5.2-5">o  Block Total Length: total size of this block, as described in
      Section 3.1.<a href="#section-5.2-5" class="pilcrow">¶</a></p>
<p id="section-5.2-6">o  Compression Type (8 bits): an unsigned value that specifies the
      compression algorithm.  Possible values for this field are 0
      (uncompressed), 1 (Lempel-Ziv), 2 (Gzip), other?? Probably some
      kind of dumb and fast compression algorithm could be effective
      with some types of traffic (for example web), but which?<a href="#section-5.2-6" class="pilcrow">¶</a></p>
<p id="section-5.2-7">o  Compressed Data: data of this block.  Once decompressed, it is
      made of other blocks.<a href="#section-5.2-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="encryption-block-experimental">
<section id="section-5.3">
        <h3 id="name-encryption-block-experiment">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-encryption-block-experiment" class="section-name selfRef">Encryption Block (experimental)</a>
        </h3>
<p id="section-5.3-1">The Encryption Block is optional.  A file can contain an arbitrary
   number of these blocks.  An Encryption Block is used to store
   encrypted data.  Its format is shown in Figure 19.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-5.3-2">
<pre>
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +---------------------------------------------------------------+
   |                        Block Type = ?                         |
   +---------------------------------------------------------------+
   |                      Block Total Length                       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   Encr. Type  |                                               |
   +-+-+-+-+-+-+-+-+                                               |
   |                                                               |
   |                       Encrypted Data                          |
   |                                                               |
   |                 variable length, octet-aligned                |
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                      Block Total Length                       |
   +---------------------------------------------------------------+

                    Figure 19: Encryption Block Format
</pre><a href="#section-5.3-2" class="pilcrow">¶</a>
</div>
<p id="section-5.3-3">The fields have the following meaning:<a href="#section-5.3-3" class="pilcrow">¶</a></p>
<p id="section-5.3-4">o  Block Type: The block type of the Encryption Block is not yet
      assigned.<a href="#section-5.3-4" class="pilcrow">¶</a></p>
<p id="section-5.3-5">o  Block Total Length: total size of this block, as described in
      Section 3.1.<a href="#section-5.3-5" class="pilcrow">¶</a></p>
<p id="section-5.3-6">o  Encryption Type (8 bits): an unsigned value that specifies the
      encryption algorithm.  Possible values for this field are ???
      (TODO) NOTE: this block should probably contain other fields,
      depending on the encryption algorithm.  To be defined precisely.<a href="#section-5.3-6" class="pilcrow">¶</a></p>
<p id="section-5.3-7">o  Encrypted Data: data of this block.  Once decrypted, it originates
      other blocks.<a href="#section-5.3-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="fixed-length-block-experimental">
<section id="section-5.4">
        <h3 id="name-fixed-length-block-experime">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-fixed-length-block-experime" class="section-name selfRef">Fixed Length Block (experimental)</a>
        </h3>
<p id="section-5.4-1">The Fixed Length Block is optional.  A file can contain an arbitrary
   number of these blocks.  A Fixed Length Block can be used to optimize
   the access to the file.  Its format is shown in Figure 20.  A Fixed
   Length Block stores records with constant size.  It contains a set of
   Blocks (normally Enhanced Packet Blocks or Simple Packet Blocks), of
   which it specifies the size.  Knowing this size a priori helps to
   scan the file and to load some portions of it without truncating a
   block, and is particularly useful with cell-based networks like ATM.<a href="#section-5.4-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-5.4-2">
<pre>
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +---------------------------------------------------------------+
   |                        Block Type = ?                         |
   +---------------------------------------------------------------+
   |                      Block Total Length                       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |          Cell Size            |                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |
   |                                                               |
   |                        Fixed Size Data                        |
   |                                                               |
   |                 variable length, octet-aligned                |
   |                                                               |
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                      Block Total Length                       |
   +---------------------------------------------------------------+

                   Figure 20: Fixed Length Block Format
</pre><a href="#section-5.4-2" class="pilcrow">¶</a>
</div>
<p id="section-5.4-3">The fields have the following meaning:<a href="#section-5.4-3" class="pilcrow">¶</a></p>
<p id="section-5.4-4">o  Block Type: The block type of the Fixed Length Block is not yet
      assigned.<a href="#section-5.4-4" class="pilcrow">¶</a></p>
<p id="section-5.4-5">o  Block Total Length: total size of this block, as described in
      Section 3.1.<a href="#section-5.4-5" class="pilcrow">¶</a></p>
<p id="section-5.4-6">o  Cell size (16 bits): an unsigned value that indicates the size of
      the blocks contained in the data field.<a href="#section-5.4-6" class="pilcrow">¶</a></p>
<p id="section-5.4-7">o  Fixed Size Data: data of this block.<a href="#section-5.4-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="directory-block-experimental">
<section id="section-5.5">
        <h3 id="name-directory-block-experimenta">
<a href="#section-5.5" class="section-number selfRef">5.5. </a><a href="#name-directory-block-experimenta" class="section-name selfRef">Directory Block (experimental)</a>
        </h3>
<p id="section-5.5-1">If present, this block contains the following information:<a href="#section-5.5-1" class="pilcrow">¶</a></p>
<p id="section-5.5-2">o  number of indexed packets (N)<a href="#section-5.5-2" class="pilcrow">¶</a></p>
<p id="section-5.5-3">o  table with position and length of any indexed packet (N entries)<a href="#section-5.5-3" class="pilcrow">¶</a></p>
<p id="section-5.5-4">A directory block MUST be followed by at least N packets, otherwise
   it MUST be considered invalid.  It can be used to efficiently load
   portions of the file to memory and to support operations on memory
   mapped files.  This block can be added by tools like network
   analyzers as a consequence of file processing.<a href="#section-5.5-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="traffic-statistics-and-monitoring-blocks-experimental">
<section id="section-5.6">
        <h3 id="name-traffic-statistics-and-moni">
<a href="#section-5.6" class="section-number selfRef">5.6. </a><a href="#name-traffic-statistics-and-moni" class="section-name selfRef">Traffic Statistics and Monitoring Blocks (experimental)</a>
        </h3>
<p id="section-5.6-1">One or more blocks could be defined to contain network statistics or
   traffic monitoring information.  They could be use to store data
   collected from RMON or Netflow probes, or from other network
   monitoring tools.<a href="#section-5.6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="eventsecurity-block-experimental">
<section id="section-5.7">
        <h3 id="name-event-security-block-experi">
<a href="#section-5.7" class="section-number selfRef">5.7. </a><a href="#name-event-security-block-experi" class="section-name selfRef">Event/Security Block (experimental)</a>
        </h3>
<p id="section-5.7-1">This block could be used to store events.  Events could contain
   generic information (for example network load over 50%, server
   down...) or security alerts.  An event could be:<a href="#section-5.7-1" class="pilcrow">¶</a></p>
<p id="section-5.7-2">o  skipped, if the application doesn't know how to do with it<a href="#section-5.7-2" class="pilcrow">¶</a></p>
<p id="section-5.7-3">o  processed independently by the packets.  In other words, the
      applications skips the packets and processes only the alerts<a href="#section-5.7-3" class="pilcrow">¶</a></p>
<p id="section-5.7-4">o  processed in relation to packets: for example, a security tool
      could load only the packets of the file that are near a security
      alert; a monitoring tool could skip the packets captured while the
      server was down.<a href="#section-5.7-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="vendor-specific-custom-extensions">
<section id="section-6">
      <h2 id="name-vendor-specific-custom-exte">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-vendor-specific-custom-exte" class="section-name selfRef">Vendor-Specific Custom Extensions</a>
      </h2>
<p id="section-6-1">This section uses the term "vendor" to describe an organization which
   extends the pcapng file with custom, proprietary blocks or options.
   It should be noted, however, that the "vendor" is just an abstract
   entity that agrees on a custom extension format: for example it may<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">be a manufacturer, industry association, an individual user, or
   collective group of users.<a href="#section-6-2" class="pilcrow">¶</a></p>
<div id="supported-use-cases">
<section id="section-6.1">
        <h3 id="name-supported-use-cases">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-supported-use-cases" class="section-name selfRef">Supported Use-Cases</a>
        </h3>
<p id="section-6.1-1">There are two different supported use-cases for vendor-specific
   custom extensions: local and portable.  Local use means the custom
   data is only expected to be usable on the same machine, and the same
   application, which encoded it into the file.  This limitation is due
   to the lack of a common registry for the local use number codes (the
   block or option type code numbers with the Most Significant Bit set).
   Since two different vendors may choose the same number, one vendor's
   application reading the other vendor's file would result in decoding
   failure.  Therefore, vendors SHOULD instead use the portable method,
   as described next.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">The portable use-case supports vendor-specific custom extensions in
   pcapng files which can be shared across systems, organizations, etc.
   To avoid number space collisions, an IANA-registered Private
   Enterprise Number (PEN) is encoded into the Custom Block or Custom
   Option, using the PEN number that belongs to the vendor defining the
   extension.  Anyone can register a new PEN with IANA, for free, by
   filling out the online request form at http://pen.iana.org/pen/
   PenApplication.page [14].<a href="#section-6.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="controlling-copy-behavior">
<section id="section-6.2">
        <h3 id="name-controlling-copy-behavior">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-controlling-copy-behavior" class="section-name selfRef">Controlling Copy Behavior</a>
        </h3>
<p id="section-6.2-1">Both Custom Blocks and Custom Options support two different codes to
   distinguish their "copy" behavior: a code for when the block or
   option can be safely copied into a new pcapng file by a pcapng
   manipulating application, and a code for when it should not be
   copied.  A common reason for not copying a Custom Block or Custom
   Option is because it depends on other blocks or options in some way
   that would invalidate the custom data if the other blocks/options
   were removed or re-ordered.  For example, if a Custom Block's data
   includes an Interface ID number in its Custom Data portion, then it
   cannot be safely copied by a pcapng application that merges pcapng
   files, because the merging application might re-order or remove one
   or more of the Interface Description Blocks, and thereby change the
   Interface IDs that the Custom Block depends upon.  The same issue
   arises if a Custom Block or Custom Option depends on the presence of,
   or specific ordering of, other standard-based or custom-defined
   blocks or options.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">Note that the copy semantics is not related to privacy - there is no
   guarantee that a pcapng anonymizer will remove a Custom Block or
   Custom Option, even if the appropriate code is used requesting it not
   be copied; and the original pcapng file can be shared anyway.  If the
   Custom Data portion of the Custom Block or Custom Option contains
   sensitive information, then it should be encrypted in some fashion.<a href="#section-6.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="strings-vs-octets">
<section id="section-6.3">
        <h3 id="name-strings-vs-octets">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-strings-vs-octets" class="section-name selfRef">Strings vs. Octets</a>
        </h3>
<p id="section-6.3-1">For the Custom Options, there are two Custom Data formats supported:
   a UTF-8 string and a binary data payload.  The rationale for this
   separation is that a pcapng display application which does not
   understand the specific PEN's Custom Option can still display the
   data as a string if it's a string type code, rather than as hex-ascii
   of the octets.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="endianness-issues">
<section id="section-6.4">
        <h3 id="name-endianness-issues">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-endianness-issues" class="section-name selfRef">Endianness Issues</a>
        </h3>
<p id="section-6.4-1">Implementers writing Custom Blocks or Custom Options should be aware
   that a pcapng file can be re-written by machines using a different
   endianness than the original file, which means all known fields of
   the pcapng file will change endianness in the new file.  Since the
   Custom Data payload of the Custom Block or Custom Option might be an
   arbitrary sequence of unknown octets to such machines, they cannot
   convert multi-octet values inside the Custom Data into the
   appropriate endianness.<a href="#section-6.4-1" class="pilcrow">¶</a></p>
<p id="section-6.4-2">For example, a little-endian machine can create a new pcapng file and
   add some binary data Custom Options to some Block(s) in the file.
   This file can then be sent to a big-endian host, which will convert
   it to big-endian format if it re-writes the file.  It will, however,
   leave the Custom Data payload alone (as little-endian format).  If
   this file then gets sent back to the little-endian machine, then when
   that little-endian machine reads the file it will detect the format
   is big- endian, and swap the endianness while it parses the file -
   but that will cause the Custom Data payload to be incorrect since it
   was already in little-endian format.<a href="#section-6.4-2" class="pilcrow">¶</a></p>
<p id="section-6.4-3">Therefore, the vendor should either encode all of their fields in a
   consistent manner, such as always in big-endian or always little-
   endian format, regardless of the host platform's endianness, or
   should encode some flag in the Custom Data payload to indicate in
   which endianness the rest of the payload is written.<a href="#section-6.4-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="recommended-file-name-extension-pcapng">
<section id="section-7">
      <h2 id="name-recommended-file-name-exten">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-recommended-file-name-exten" class="section-name selfRef">Recommended File Name Extension: .pcapng</a>
      </h2>
<p id="section-7-1">The recommended file name extension for the "PCAP Next Generation
   Capture File Format" specified in this document is ".pcapng".<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">On Windows and macOS, files are distinguished by an extension to
   their filename.  Such an extension is technically not actually
   required, as applications should be able to automatically detect the
   pcapng file format through the "magic bytes" at the beginning of the
   file, as some other UN*X desktop environments do.  However, using
   name extensions makes it easier to work with files (e.g. visually
   distinguish file formats) so it is recommended - though not required
   - to use .pcapng as the name extension for files following this
   specification.<a href="#section-7-2" class="pilcrow">¶</a></p>
<p id="section-7-3">Please note: To avoid confusion (such as the current usage of .cap
   for a plethora of different capture file formats) other file name
   extensions than .pcapng should be avoided.<a href="#section-7-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="conclusions">
<section id="section-8">
      <h2 id="name-conclusions">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-conclusions" class="section-name selfRef">Conclusions</a>
      </h2>
<p id="section-8-1">The file format proposed in this document should be very versatile
   and satisfy a wide range of applications.  In the simplest case, it
   can contain a raw capture of the network data, made of a series of
   Simple Packet Blocks.  In the most complex case, it can be used as a
   repository for heterogeneous information.  In every case, the file
   remains easy to parse and an application can always skip the data it
   is not interested in; at the same time, different applications can
   share the file, and each of them can benefit of the information
   produced by the others.  Two or more files can be concatenated
   obtaining another valid file.<a href="#section-8-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="implementations">
<section id="section-9">
      <h2 id="name-implementations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-implementations" class="section-name selfRef">Implementations</a>
      </h2>
<p id="section-9-1">Some known implementations that read or write the pcapng file format
   are listed on the pcapng GitHub wiki [15].<a href="#section-9-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-considerations">
<section id="section-10">
      <h2 id="name-security-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-10-1">TBD.<a href="#section-10-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-11">
      <h2 id="name-iana-considerations">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-11-1">TBD.<a href="#section-11-1" class="pilcrow">¶</a></p>
<p id="section-11-2">[Open issue: decide whether the block types, option types, NRB Record
   types, etc. should be IANA registries.  And if so, what the IANA
   policy for each should be (see RFC 5226)]<a href="#section-11-2" class="pilcrow">¶</a></p>
<div id="standardized-block-type-codes">
<section id="section-11.1">
        <h3 id="name-standardized-block-type-cod">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-standardized-block-type-cod" class="section-name selfRef">Standardized Block Type Codes</a>
        </h3>
<p id="section-11.1-1">Every Block is uniquely identified by a 32-bit integer value, stored
   in the Block Header.<a href="#section-11.1-1" class="pilcrow">¶</a></p>
<p id="section-11.1-2">As pointed out in Section 3.1, Block Type codes whose Most
   Significant Bit (bit 31) is set to 1 are reserved for local use by
   the application.<a href="#section-11.1-2" class="pilcrow">¶</a></p>
<p id="section-11.1-3">All the remaining Block Type codes (0x00000000 to 0x7FFFFFFF) are
   standardized by this document.  Requests for new Block Type codes
   should be sent to the pcap-ng-format mailing list [16].<a href="#section-11.1-3" class="pilcrow">¶</a></p>
<p id="section-11.1-4">The following is a list of the Standardized Block Type Codes:<a href="#section-11.1-4" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-11.1-5">
<pre>
   +-----------------------+-------------------------------------------+
   | Block Type Code       | Description                               |
   +-----------------------+-------------------------------------------+
   | 0x00000000            | Reserved ???                              |
   | 0x00000001            | Interface Description Block (Section 4.2) |
   | 0x00000002            | Packet Block (Appendix A)                 |
   | 0x00000003            | Simple Packet Block (Section 4.4)         |
   | 0x00000004            | Name Resolution Block (Section 4.5)       |
   | 0x00000005            | Interface Statistics Block (Section 4.6)  |
   | 0x00000006            | Enhanced Packet Block (Section 4.3)       |
   | 0x00000007            | IRIG Timestamp Block (requested by        |
   |                       | Gianluca Varenni                          |
   |                       | &lt;gianluca.varenni@cacetech.com&gt;, CACE     |
   |                       | Technologies LLC); code also used for     |
   |                       | Socket Aggregation Event Block [17]       |
   | 0x00000008            | ARINC 429 [18] in AFDX Encapsulation      |
   |                       | Information Block (requested by Gianluca  |
   |                       | Varenni &lt;gianluca.varenni@cacetech.com&gt;,  |
   |                       | CACE Technologies LLC)                    |
   | 0x00000009            | systemd Journal Export Block (Section     |
   |                       | 4.7)                                      |
   | 0x0000000A            | Decryption Secrets Block (Section 4.8)    |
   | 0x00000101            | Hone Project [19] Machine Info Block [20] |
   |                       | (see also Google version [21])            |
   | 0x00000102            | Hone Project [22] Connection Event Block  |
   |                       | [23] (see also Google version [24])       |
   | 0x00000201            | Sysdig [25] Machine Info Block            |
   | 0x00000202            | Sysdig [26] Process Info Block, version 1 |
   | 0x00000203            | Sysdig [27] FD List Block                 |
   | 0x00000204            | Sysdig [28] Event Block                   |
   | 0x00000205            | Sysdig [29] Interface List Block          |
   | 0x00000206            | Sysdig [30] User List Block               |
   | 0x00000207            | Sysdig [31] Process Info Block, version 2 |
   | 0x00000208            | Sysdig [32] Event Block with flags        |
   | 0x00000209            | Sysdig [33] Process Info Block, version 3 |
   | 0x00000210            | Sysdig [34] Process Info Block, version 4 |
   | 0x00000211            | Sysdig [35] Process Info Block, version 5 |
   | 0x00000212            | Sysdig [36] Process Info Block, version 6 |
   | 0x00000213            | Sysdig [37] Process Info Block, version 7 |
   | 0x00000BAD            | Custom Block that rewriters can copy into |
   |                       | new files (Section 4.9)                   |
   | 0x40000BAD            | Custom Block that rewriters should not    |
   |                       | copy into new files (Section 4.9)         |
   | 0x0A0D0D0A            | Section Header Block (Section 4.1)        |
   | 0x0A0D0A00-0x0A0D0AFF | Reserved. Used to detect trace files      |
   |                       | corrupted because of file transfers using |
   |                       | the HTTP protocol in text mode.           |
   | 0x000A0D0A-0xFF0A0D0A | Reserved. Used to detect trace files      |
   |                       | corrupted because of file transfers using |
   |                       | the HTTP protocol in text mode.           |
   | 0x000A0D0D-0xFF0A0D0D | Reserved. Used to detect trace files      |
   |                       | corrupted because of file transfers using |
   |                       | the HTTP protocol in text mode.           |
   | 0x0D0D0A00-0x0D0D0AFF | Reserved. Used to detect trace files      |
   |                       | corrupted because of file transfers using |
   |                       | the FTP protocol in text mode.            |
   | 0x80000000-0xFFFFFFFF | Reserved for local use.                   |
   +-----------------------+-------------------------------------------+

                  Table 8: Standardized Block Type Codes
</pre><a href="#section-11.1-5" class="pilcrow">¶</a>
</div>
<p id="section-11.1-6">[Open issue: reserve 0x40000000-0x7FFFFFFF for do-not-copy-bit range
   of base types?]<a href="#section-11.1-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="contributors">
<section id="section-12">
      <h2 id="name-contributors">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-contributors" class="section-name selfRef">Contributors</a>
      </h2>
<p id="section-12-1">Loris Degioanni and Gianluca Varenni were coauthoring this document
   before it was submitted to the IETF.<a href="#section-12-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="acknowledgments">
<section id="section-13">
      <h2 id="name-acknowledgments">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="section-13-1">The authors wish to thank Anders Broman, Ulf Lamping, Richard Sharpe
   and many others for their invaluable comments.<a href="#section-13-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="url-references">
<section id="section-14">
      <h2 id="name-url-references">
<a href="#section-14" class="section-number selfRef">14. </a><a href="#name-url-references" class="section-name selfRef">URL References</a>
      </h2>
<p id="section-14-1">To be translated into proper references.<a href="#section-14-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-14-2">
<pre>
   [2] https://www.winpcap.org/mailman/listinfo/pcap-ng-format

   [3] http://www.tcpdump.org/linktypes.html

   [4] http://www.tcpdump.org/linktypes.html

   [5] http://www.tcpdump.org/linktypes.html

   [6] https://www.freedesktop.org/wiki/Software/systemd/

   [7] https://www.freedesktop.org/wiki/Software/systemd/export/

   [8] https://www.freedesktop.org/wiki/Software/systemd/export/

   [9] https://www.freedesktop.org/software/systemd/man/systemd.journal-
       fields.html

   [10] https://www.winpcap.org/mailman/listinfo/pcap-ng-format

   [11] https://developer.mozilla.org/NSS_Key_Log_Format

   [12] https://git.zx2c4.com/WireGuard/tree/contrib/examples/extract-
        handshakes/README

   [13] https://www.wireguard.com/

   [14] http://pen.iana.org/pen/PenApplication.page

   [15] https://github.com/pcapng/pcapng/wiki/Implementations

   [16] https://www.winpcap.org/mailman/listinfo/pcap-ng-format

   [17] https://github.com/google/linux-sensor/blob/master/hone-
        pcapng.txt

   [18] https://en.wikipedia.org/wiki/ARINC_429

   [19] https://github.com/HoneProject

   [20] https://github.com/HoneProject/Linux-Sensor/wiki/Augmented-PCAP-
        Next-Generation-Dump-File-Format

   [21] https://github.com/google/linux-sensor/blob/master/hone-
        pcapng.txt

   [22] https://github.com/HoneProject

   [23] https://github.com/HoneProject/Linux-Sensor/wiki/Augmented-PCAP-
        Next-Generation-Dump-File-Format

   [24] https://github.com/google/linux-sensor/blob/master/hone-
        pcapng.txt

   [25] https://github.com/draios/sysdig

   [26] https://github.com/draios/sysdig

   [27] https://github.com/draios/sysdig

   [28] https://github.com/draios/sysdig

   [29] https://github.com/draios/sysdig

   [30] https://github.com/draios/sysdig

   [31] https://github.com/draios/sysdig

   [32] https://github.com/draios/sysdig

   [33] https://github.com/draios/sysdig

   [34] https://github.com/draios/sysdig

   [35] https://github.com/draios/sysdig

   [36] https://github.com/draios/sysdig

   [37] https://github.com/draios/sysdig

   [38] http://www.tcpdump.org/linktypes.html
</pre><a href="#section-14-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<section id="section-15">
      <h2 id="name-normative-references">
<a href="#section-15" class="section-number selfRef">15. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
      </h2>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
      <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8179">[RFC8179]</dt>
    <dd>
<span class="refAuthor">Bradner, S.</span><span class="refAuthor"> and J. Contreras</span>, <span class="refTitle">"Intellectual Property Rights in IETF Technology"</span>, <span class="seriesInfo">BCP 79</span>, <span class="seriesInfo">RFC 8179</span>, <span class="seriesInfo">DOI 10.17487/RFC8179</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8179">https://www.rfc-editor.org/info/rfc8179</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<div id="packet-block-obsolete">
<section id="section-appendix.a">
      <h2 id="name-packet-block-obsolete">
<a href="#section-appendix.a" class="section-number selfRef">Appendix A. </a><a href="#name-packet-block-obsolete" class="section-name selfRef">Packet Block (obsolete!)</a>
      </h2>
<p id="section-appendix.a-1">The Packet Block is obsolete, and MUST NOT be used in new files.  Use
   the Enhanced Packet Block or Simple Packet Block instead.  This
   section is for historical reference only.<a href="#section-appendix.a-1" class="pilcrow">¶</a></p>
<p id="section-appendix.a-2">A Packet Block was a container for storing packets coming from the
   network.<a href="#section-appendix.a-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-appendix.a-3">
<pre>
       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +---------------------------------------------------------------+
    0 |                    Block Type = 0x00000002                    |
      +---------------------------------------------------------------+
    4 |                      Block Total Length                       |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    8 |         Interface ID          |          Drops Count          |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   12 |                        Timestamp (High)                       |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   16 |                        Timestamp (Low)                        |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   20 |                    Captured Packet Length                     |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   24 |                    Original Packet Length                     |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   28 /                                                               /
      /                          Packet Data                          /
      /              variable length, padded to 32 bits               /
      /                                                               /
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      /                                                               /
      /                      Options (variable)                       /
      /                                                               /
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                      Block Total Length                       |
      +---------------------------------------------------------------+

                      Figure 21: Packet Block Format
</pre><a href="#section-appendix.a-3" class="pilcrow">¶</a>
</div>
<p id="section-appendix.a-4">The Packet Block has the following fields:<a href="#section-appendix.a-4" class="pilcrow">¶</a></p>
<p id="section-appendix.a-5">o  Block Type: The block type of the Packet Block is 2.<a href="#section-appendix.a-5" class="pilcrow">¶</a></p>
<p id="section-appendix.a-6">o  Block Total Length: total size of this block, as described in
      Section 3.1.<a href="#section-appendix.a-6" class="pilcrow">¶</a></p>
<p id="section-appendix.a-7">o  Interface ID: specifies the interface this packet comes from; the
      correct interface will be the one whose Interface Description
      Block (within the current Section of the file) is identified by
      the same number (see Section 4.2) of this field.  The interface ID
      MUST be valid, which means that an matching interface description
      block MUST exist.<a href="#section-appendix.a-7" class="pilcrow">¶</a></p>
<p id="section-appendix.a-8">o  Drops Count: a local drop counter.  It specifies the number of
      packets lost (by the interface and the operating system) between
      this packet and the preceding one.  The value xFFFF (in
      hexadecimal) is reserved for those systems in which this
      information is not available.<a href="#section-appendix.a-8" class="pilcrow">¶</a></p>
<p id="section-appendix.a-9">o  Timestamp (High) and Timestamp (Low): timestamp of the packet.
      The format of the timestamp is the same as was already defined for
      the Enhanced Packet Block (Section 4.3).<a href="#section-appendix.a-9" class="pilcrow">¶</a></p>
<p id="section-appendix.a-10">o  Captured Packet Length: number of octets captured from the packet
      (i.e. the length of the Packet Data field).  It will be the
      minimum value among the Original Packet Length and the snapshot
      length for the interface (SnapLen, defined in Figure 10).  The
      value of this field does not include the padding octets added at
      the end of the Packet Data field to align the Packet Data field to
      a 32-bit boundary.<a href="#section-appendix.a-10" class="pilcrow">¶</a></p>
<p id="section-appendix.a-11">o  Original Packet Length: actual length of the packet when it was
      transmitted on the network.  It can be different from Captured
      Packet Length if the packet has been truncated by the capture
      process.<a href="#section-appendix.a-11" class="pilcrow">¶</a></p>
<p id="section-appendix.a-12">o  Packet Data: the data coming from the network, including link-
      layer headers.  The actual length of this field is Captured Packet
      Length plus the padding to a 32-bit boundary.  The format of the
      link-layer headers depends on the LinkType field specified in the
      Interface Description Block (see Section 4.2) and it is specified
      in the entry for that format in the the tcpdump.org link-layer
      header types registry [38].<a href="#section-appendix.a-12" class="pilcrow">¶</a></p>
<p id="section-appendix.a-13">o  Options: optionally, a list of options (formatted according to the
      rules defined in Section 3.5) can be present.<a href="#section-appendix.a-13" class="pilcrow">¶</a></p>
<p id="section-appendix.a-14">In addition to the options defined in Section 3.5, the following
   options were valid within this block:<a href="#section-appendix.a-14" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-appendix.a-15">
<pre>
           +------------+------+----------+-------------------+
           | Name       | Code | Length   | Multiple allowed? |
           +------------+------+----------+-------------------+
           | pack_flags | 2    | 4        | no                |
           | pack_hash  | 3    | variable | yes               |
           +------------+------+----------+-------------------+

                       Table 9: Packet Block Options
</pre><a href="#section-appendix.a-15" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-appendix.a-16">
        <dt id="section-appendix.a-16.1">pack_flags:</dt>
        <dd style="margin-left: 1.5em" id="section-appendix.a-16.2">
  The pack_flags option is the same as the epb_flags of the
           enhanced packet block.<a href="#section-appendix.a-16.2" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<div class="artwork art-text alignLeft" id="section-appendix.a-17">
<pre>
       Example: '0'.
</pre><a href="#section-appendix.a-17" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-appendix.a-18">
        <dt id="section-appendix.a-18.1">pack_hash:</dt>
        <dd style="margin-left: 1.5em" id="section-appendix.a-18.2">
  The pack_hash option is the same as the epb_hash of the
           enhanced packet block.<a href="#section-appendix.a-18.2" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<div class="artwork art-text alignLeft" id="section-appendix.a-19">
<pre>
       Examples: '02 EC 1D 87 97', '03 45 6E C2 17 7C 10 1E 3C 2E 99
       6E C2 9A 3D 50 8E'.
</pre><a href="#section-appendix.a-19" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="authors-addresses">
<section id="section-appendix.b">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Michael Tuexen</span></div>
<div dir="auto" class="left"><span class="org">Muenster University of Applied Sciences</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:tuexen@fh-muenster.de" class="email">tuexen@fh-muenster.de</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Fulvio Risso</span></div>
<div dir="auto" class="left"><span class="org">Politecnico di Torino</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:fulvio.risso@polito.it" class="email">fulvio.risso@polito.it</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Jasper Bongertz</span></div>
<div dir="auto" class="left"><span class="org">Airbus Defence and Space CyberSecurity</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:jasper@packet-foo.com" class="email">jasper@packet-foo.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Gerald Combs</span></div>
<div dir="auto" class="left"><span class="org">Wireshark Foundation</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:gerald@wireshark.org" class="email">gerald@wireshark.org</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Guy Harris</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:gharris@sonic.net" class="email">gharris@sonic.net</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Michael Richardson</span></div>
<div dir="auto" class="left"><span class="org">Sandelman Software Works</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:mcr+ietf@sandelman.ca" class="email">mcr+ietf@sandelman.ca</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
