<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>A Basic Interactive
			Voice Response (IVR) Control Package for the Session
			Initiation Protocol (SIP)</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="A Basic Interactive
			Voice Response (IVR) Control Package for the Session
			Initiation Protocol (SIP)">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">C. Boulton</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Ubiquity Software Corporation</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">T. Melanchuk</td></tr>
<tr><td class="header">Expires: April 29, 2007</td><td class="header">BlankSpace</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">S. McGlashan</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Hewlett-Packard</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">A. Shiratzky</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Radvision</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">October 26, 2006</td></tr>
</table></td></tr></table>
<h1><br />A Basic Interactive
			Voice Response (IVR) Control Package for the Session
			Initiation Protocol (SIP)<br />draft-boulton-ivr-control-package-02</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on April 29, 2007.</p>

<h3>Abstract</h3>

<p>This document defines a Session Initiation (SIP) Control
			Package for basic Interactive Voice Response (IVR)
			interaction.  The control of Media Servers and their related
			resources in decomposed network architectures plays an
			important role in various Next Generation Networks.  This
			Control Package provides IVR functionality using the SIP
			Control Framework.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#terminology">2.</a>&nbsp;
Conventions and Terminology<br />
<a href="#sec:Control_Package_Definition">3.</a>&nbsp;
Control Package
Definition<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec:Control_Package_Name">3.1.</a>&nbsp;
Control Package Name<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec:Message_Usage">3.2.</a>&nbsp;
Framework Message Usage<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec:Common_XML">3.3.</a>&nbsp;
Common XML Support<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec:Control_Body">3.4.</a>&nbsp;
CONTROL Message Body<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec:REPORT_Body">3.5.</a>&nbsp;
REPORT Message Body<br />
<a href="#definitions">4.</a>&nbsp;
Element Definitions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#defn.requests">4.1.</a>&nbsp;
Requests<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#defn.dialogprepare">4.1.1.</a>&nbsp;
&lt;dialogprepare><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#defn.dialogstart">4.1.2.</a>&nbsp;
&lt;dialogstart><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#defn.dialogterminate">4.1.3.</a>&nbsp;
&lt;dialogterminate><br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#defn.responses">4.2.</a>&nbsp;
Responses<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#defn.response">4.2.1.</a>&nbsp;
&lt;response><br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#defn.notifications">4.3.</a>&nbsp;
Notifications<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#defn.event">4.3.1.</a>&nbsp;
&lt;event><br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#defn.data">4.4.</a>&nbsp;
&lt;data><br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#defn.subscribe">4.5.</a>&nbsp;
&lt;subscribe><br />
<a href="#defn.templates">5.</a>&nbsp;
IVR Template Dialogs<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">5.1.</a>&nbsp;
Play Announcement<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">5.2.</a>&nbsp;
Prompt and Collect<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">5.3.</a>&nbsp;
Prompt and Record<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">5.4.</a>&nbsp;
Status Codes<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">5.5.</a>&nbsp;
Type Definitions<br />
<a href="#examples.protocol">6.</a>&nbsp;
AS-MS Interaction Examples<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">6.1.</a>&nbsp;
Starting an IVR dialog<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">6.2.</a>&nbsp;
IVR dialog fails to start<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">6.3.</a>&nbsp;
Preparing and starting an IVR dialog<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">6.4.</a>&nbsp;
Terminating a dialog immediately<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">6.5.</a>&nbsp;
Terminating a dialog non-immediately<br />
<a href="#examples.templates">7.</a>&nbsp;
Template Dialog Examples<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">7.1.</a>&nbsp;
playannouncement<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">7.2.</a>&nbsp;
promptandcollect<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">7.3.</a>&nbsp;
promptandrecord<br />
<a href="#schema">8.</a>&nbsp;
Formal Syntax<br />
<a href="#anchor15">9.</a>&nbsp;
Security Considerations<br />
<a href="#sec:IANA_Considerations">10.</a>&nbsp;
IANA Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec:Control_Package_Reg">10.1.</a>&nbsp;
Control Package Registration<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec:URN_Reg">10.2.</a>&nbsp;
URN Sub-Namespace Registration<br />
<a href="#anchor16">11.</a>&nbsp;
Change Summary<br />
<a href="#anchor17">12.</a>&nbsp;
Acknowledgments<br />
<a href="#rfc.references1">13.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">13.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">13.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>The SIP Control Framework <a class='info' href='#SIPCF'>[SIPCF]<span> (</span><span class='info'>Boulton, C., Melanchuk, T., McGlashan, S., and A. Shiratzky, &ldquo;A Control Framework for the Session Initiation         Protocol (SIP),&rdquo; October&nbsp;2006.</span><span>)</span></a> provides a generic
approach for establishment and reporting capabilities of remotely
initiated commands.  The Framework utilizes many functions provided by
the Session Initiation Protocol <a class='info' href='#RFC3261'>[RFC3261]<span> (</span><span class='info'>Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;SIP: Session Initiation Protocol,&rdquo; June&nbsp;2002.</span><span>)</span></a> (SIP) for the
rendezvous and establishment of a reliable channel for control
interactions.  The Control Framework also introduces the concept of a
Control Package.  A Control Package is an explicit usage of the Control
Framework for a particular interaction set.  This specification defines
a package for basic IVR. 
</p>
<p>The scope of the package is control of media server functions for
basic interactive media (e.g. play a prompt, collecting DTMF, recording
user input) as well as notifications related to these functions. 
</p>
<p>These functions and notifications are defined as messages in XML
<a class='info' href='#XML'>[XML]<span> (</span><span class='info'>Bray, T., Paoli, J., Sperberg-McQueen, C M., Maler, E., and F. Yergeau, &ldquo;Extensible Markup Language (XML) 1.0 (Third Edition),&rdquo; February&nbsp;2004.</span><span>)</span></a>. The message use XML elements for preparing,
starting and stopping dialogs, as well as elements for responses and
notifications (<a class='info' href='#CCXML10'>[CCXML10]<span> (</span><span class='info'>Auburn, R J., &ldquo;Voice Browser Call Control: CCXML Version 1.0,&rdquo; June&nbsp;2005.</span><span>)</span></a>, <a class='info' href='#MSML'>[MSML]<span> (</span><span class='info'>Saleem, A. and G. Sharratt, &ldquo;Media Session Markup Language (MSML),&rdquo; June&nbsp;2006.</span><span>)</span></a> and
<a class='info' href='#MSCP'>[MSCP]<span> (</span><span class='info'>McGlashan, S., Auburn, R., Burke, D., Candell, E., and R. Surapaneni, &ldquo;Media Server Control Protocol (MSCP),&rdquo; July&nbsp;2006.</span><span>)</span></a>).  
</p>
<p>This basic IVR package uses  template dialogs to provide IVR
 functionality.   Three template dialogs are defined:
   </p>
<blockquote class="text"><dl>
<dt>playannouncement:</dt>
<dd>
         a dialog to play one or more prompts to the user
</dd>
<dt>promptandcollect:</dt>
<dd>
         a dialog to prompt the user and collect their input
</dd>
<dt>promptandrecord:</dt>
<dd>
         a dialog to prompt the user and record their input
</dd>
</dl></blockquote><p>

</p>
<p>Template dialogs are intended to provide basic IVR
        functionality (<a class='info' href='#H.248.9'>[H.248.9]<span> (</span><span class='info'>, &ldquo;Gateway control protocol: Advanced media server packages,&rdquo; .</span><span>)</span></a>, <a class='info' href='#RFC4240'>[RFC4240]<span> (</span><span class='info'>Burger, E., Van Dyke, J., and A. Spitzer, &ldquo;Basic Network Media Services with SIP,&rdquo; December&nbsp;2005.</span><span>)</span></a>, <a class='info' href='#MSML'>[MSML]<span> (</span><span class='info'>Saleem, A. and G. Sharratt, &ldquo;Media Session Markup Language (MSML),&rdquo; June&nbsp;2006.</span><span>)</span></a>, <a class='info' href='#RFC2897'>[RFC2897]<span> (</span><span class='info'>Cromwell, D., &ldquo;Proposal for an MGCP Advanced Audio Package,&rdquo; August&nbsp;2000.</span><span>)</span></a> and <a class='info' href='#MSCML'>[MSCML]<span> (</span><span class='info'>Van Dyke, J., Burger, E., and A. Spitzer, &ldquo;Media Server Control Markup Language (MSCML) and Protocol,&rdquo; June&nbsp;2006.</span><span>)</span></a>). The template
        approach follows previous approaches in that it provides IVR
        functionality which is commonly required for applications. It
        differs in that the functionality is expressed in XML using a
        reference to the template dialog, and parameters expressed in a
        simple XML data structure. This is a lightweight approach since
        the contents of the dialog itself does not need to be
        transported over the control channel (or fetched from an
        external source), only a template reference plus configuration
        data is required. From the developer's perspective, this
        simplifies application development: they do not need to write
        their IVR dialog using custom XML elements, they only need to
        reference the template dialog and, if required, populate a
        simple XML data structure to pass configuration data.  
</p>
<p>To use a template dialog, the AS developer references it by name in
    an XML message for preparing or starting a dialog; for example
    &lt;dialogstart src="promptandrecord"/>. The XML message may also
    contain template input parameters in a &lt;data> element to
    configure specific behavior defined by the template dialog;
    e.g. using "prompts" with the value
    "http://www.example.com/welcome.wav". If the dialog starts
    successfully, a &lt;response status="200"/> is returned. When the
    dialog is completed, the MS returns template output parameters in a
    dialogexit &lt;event> notification to the AS. 
</p>
<p>The implementation of template dialogs requires only that they
      adhere to the syntax and semantics of templates described in this
      document. 
</p>
<p>Other control packages MAY be defined which extend the capabilities
   of the templates dialogs defined in this document. Such control packages
   MUST respect the syntax and semantics of this control package.

</p>
<p>This document specifies how the basic IVR control package fulfils the
    requirements of the SIP Control Framework control packages (<a class='info' href='#sec:Control_Package_Definition'>Section&nbsp;3<span> (</span><span class='info'>Control Package Definition</span><span>)</span></a>), which XML elements are
    defined by the package (<a class='info' href='#definitions'>Section&nbsp;4<span> (</span><span class='info'>Element Definitions</span><span>)</span></a>), the template
    dialog definitions (<a class='info' href='#defn.templates'>Section&nbsp;5<span> (</span><span class='info'>IVR Template Dialogs</span><span>)</span></a>) as well as
    providing examples (<a class='info' href='#examples.protocol'>Section&nbsp;6<span> (</span><span class='info'>AS-MS Interaction Examples</span><span>)</span></a>, <a class='info' href='#examples.templates'>Section&nbsp;7<span> (</span><span class='info'>Template Dialog Examples</span><span>)</span></a>) and an XML schema (<a class='info' href='#schema'>Section&nbsp;8<span> (</span><span class='info'>Formal Syntax</span><span>)</span></a>). 
</p>
<a name="terminology"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Conventions and Terminology</h3>

<p>In this document, <a class='info' href='#RFC2119'>BCP 14/RFC 2119<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a> [RFC2119]
defines the key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY",
and "OPTIONAL".  In addition, BCP 15 indicates requirement levels for
compliant implementations.  
</p>
<p>The following additional terms are defined for use in this document:
			
</p>
<blockquote class="text"><dl>
<dt>Dialog:</dt>
<dd>A dialog performs media interaction with a user. A
dialog is identified by a URI and has an associated mimetype.  Dialogs
typically feature basic capabilities such as playing audio prompts,
collecting DTMF input and recording audio input from the user. More
advanced dialogs may also feature synthesized speech, recording and
playback of video, recognition of spoken input, and mixed initiative
conversations.
</dd>
<dt>Application server:</dt>
<dd>A SIP <a class='info' href='#RFC3261'>[RFC3261]<span> (</span><span class='info'>Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;SIP: Session Initiation Protocol,&rdquo; June&nbsp;2002.</span><span>)</span></a>
application server (AS) hosts and executes services such as interactive
media and conferencing in an operator's network. An AS influences and
impacts the SIP session, in particular by terminating SIP sessions on a
media server, which is under its control.
</dd>
<dt>Media Server:</dt>
<dd>A media server (MS) processes media streams
on behalf of an AS by offering functionality such as interactive media,
conferencing, and transcoding to the end user. Interactive media
functionality is realized by way of dialogs, which are identified by a
URI and initiated by the application server.  
</dd>
</dl></blockquote><p>

</p>
<a name="sec:Control_Package_Definition"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Control Package
Definition</h3>

<p>This section fulfills the mandatory requirement for information that
MUST be specified during the definition of a Control Framework Package,
as detailed in Section 9 of <a class='info' href='#SIPCF'>[SIPCF]<span> (</span><span class='info'>Boulton, C., Melanchuk, T., McGlashan, S., and A. Shiratzky, &ldquo;A Control Framework for the Session Initiation         Protocol (SIP),&rdquo; October&nbsp;2006.</span><span>)</span></a>.
</p>
<a name="sec:Control_Package_Name"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Control Package Name</h3>

<p>The Control Framework requires a Control Package definition to
specify and register a unique name and version.
</p>
<p>The name and version of this Control Package is "msc-ivr-basic/1.0"
(Media Server Control - Interactive Voice Response - Basic - version 1.0
).  
</p>
<a name="sec:Message_Usage"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Framework Message Usage</h3>

<p>IVR functionality includes capabilities such as playing prompts,
collecting DTMF and recording user input.  These functions are expressed
using template dialogs defined in <a class='info' href='#defn.templates'>Section&nbsp;5<span> (</span><span class='info'>IVR Template Dialogs</span><span>)</span></a>. 
</p>
<p>This package defines XML elements in <a class='info' href='#definitions'>Section&nbsp;4<span> (</span><span class='info'>Element Definitions</span><span>)</span></a> and
    provides an XML Schema in <a class='info' href='#schema'>Section&nbsp;8<span> (</span><span class='info'>Formal Syntax</span><span>)</span></a>. 
    
</p>
<p>The XML elements in this package are split into requests, responses
    and event notifications.

    Requests are carried in CONTROL message bodies; &lt;dialogprepare>,
	&lt;dialogstart> and &lt;dialogterminate> elements are defined as
	package requests.

    Responses are carried either in REPORT message or Control Framework
	200 response bodies; the &lt;response> element is defined as a
	package response. 

    Event notifications are also carried in REPORT message bodies; the
	&lt;event> element is defined for package event notifications.


</p>
<p>Note that package responses are different from framework response
	codes. Framework error response codes (see Section 8 of <a class='info' href='#SIPCF'>[SIPCF]<span> (</span><span class='info'>Boulton, C., Melanchuk, T., McGlashan, S., and A. Shiratzky, &ldquo;A Control Framework for the Session Initiation         Protocol (SIP),&rdquo; October&nbsp;2006.</span><span>)</span></a>) are used when the request or event notification is
	invalid; for example, a request is invalid XML (400), or not
	understood (500). Package responses are carried in 200 response or
	REPORT message bodies. This package's response codes are defined in
	<a class='info' href='#defn.response'>Section&nbsp;4.2.1<span> (</span><span class='info'>&lt;response></span><span>)</span></a>. 
</p>
<p>
    The schema uses "connection-id" and "conf-id" attributes which are
    imported from schema defined in core Control Framework <a class='info' href='#SIPCF'>[SIPCF]<span> (</span><span class='info'>Boulton, C., Melanchuk, T., McGlashan, S., and A. Shiratzky, &ldquo;A Control Framework for the Session Initiation         Protocol (SIP),&rdquo; October&nbsp;2006.</span><span>)</span></a>.
   
</p>
<a name="sec:Common_XML"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
Common XML Support</h3>

<p>The Control Framework requires a Control Package definition to
specify if the attributes for media dialog or conference references are
required.
</p>
<p>This package requires that the XML Schema in Section 16.1 of <a class='info' href='#SIPCF'>[SIPCF]<span> (</span><span class='info'>Boulton, C., Melanchuk, T., McGlashan, S., and A. Shiratzky, &ldquo;A Control Framework for the Session Initiation         Protocol (SIP),&rdquo; October&nbsp;2006.</span><span>)</span></a> MUST be supported for media dialogs and conferences. 
</p>
<a name="sec:Control_Body"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4"></a><h3>3.4.&nbsp;
CONTROL Message Body</h3>

<p>A valid CONTROL body message MUST conform to the schema defined in
    <a class='info' href='#schema'>Section&nbsp;8<span> (</span><span class='info'>Formal Syntax</span><span>)</span></a> and described in <a class='info' href='#definitions'>Section&nbsp;4<span> (</span><span class='info'>Element Definitions</span><span>)</span></a>. XML messages appearing in CONTROL messages
    MUST contain a &lt;dialogprepare>, &lt;dialogstart> or
    &lt;dialogterminate> request element (<a class='info' href='#defn.requests'>Section&nbsp;4.1<span> (</span><span class='info'>Requests</span><span>)</span></a>).  
</p>
<a name="sec:REPORT_Body"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.5"></a><h3>3.5.&nbsp;
REPORT Message Body</h3>

<p>A valid REPORT body MUST conform to the schema defined in <a class='info' href='#schema'>Section&nbsp;8<span> (</span><span class='info'>Formal Syntax</span><span>)</span></a> and described in <a class='info' href='#definitions'>Section&nbsp;4<span> (</span><span class='info'>Element Definitions</span><span>)</span></a>. XML
messages appearing in REPORT messages MUST contain a &lt;response>
(<a class='info' href='#defn.responses'>Section&nbsp;4.2<span> (</span><span class='info'>Responses</span><span>)</span></a>), or a (notification) &lt;event>
element (<a class='info' href='#defn.notifications'>Section&nbsp;4.3<span> (</span><span class='info'>Notifications</span><span>)</span></a>).


</p>
<a name="definitions"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Element Definitions</h3>

<p>This section defines the XML messages for this control package. 
</p>
<p>[Editors Note: since XML Schema may not be able to express all
    constraints expressed in these definitions, in cases where there is
    a difference in constraints, the definitions in the section take
    priority.]
</p>
<a name="defn.requests"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Requests</h3>

<p>The following request elements are defined:

        </p>
<blockquote class="text"><dl>
<dt>&lt;dialogprepare>:</dt>
<dd> prepare an IVR dialog for
            later execution 
</dd>
<dt>&lt;dialogstart>:</dt>
<dd> start an IVR dialog on a
            connection or conference
</dd>
<dt>&lt;dialogterminate>:</dt>
<dd>terminate an active IVR dialog
</dd>
</dl></blockquote><p>


        
</p>
<a name="defn.dialogprepare"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1.1"></a><h3>4.1.1.&nbsp;
&lt;dialogprepare></h3>

<p>The &lt;dialogprepare> request is sent from the AS to the MS to
request preparation of an IVR dialog. A prepared dialog is executed when
the AS sends a &lt;dialogstart> request referencing the prepared dialog
(see <a class='info' href='#defn.dialogstart'>Section&nbsp;4.1.2<span> (</span><span class='info'>&lt;dialogstart></span><span>)</span></a>).
</p>
<p>A &lt;dialogprepare> element has the following attributes:

</p>
<blockquote class="text"><dl>
<dt>src:</dt>
<dd>string identifying the URI of the dialog document to
prepare. The attribute is mandatory. The MS MUST support
"playannouncement", "promptandcollect" and "promptandrecord" template dialogs
as the value for this attribute.
</dd>
<dt>dialogid:</dt>
<dd>string indicating a unique name for the
    dialog. If this attribute is not specified, the MS creates a unique
    name for the dialog. The value is used in subsequent references to
    the dialog (e.g. as dialogid in a &lt;response>). It is an error if
    a dialog with the same name already exists on the MS.
    The attribute is optional. 
</dd>
</dl></blockquote><p>


</p>
<p>The &lt;dialogprepare> element has the following child elements: 

</p>
<blockquote class="text"><dl>
<dt>&lt;data>:</dt>
<dd>an XML data structure (see <a class='info' href='#defn.data'>Section&nbsp;4.4<span> (</span><span class='info'>&lt;data></span><span>)</span></a>) to pass parameters into the dialog. It is
    an error if a specified parameter is not supported by the implementation.
    The element is optional. 
</dd>
<dt>&lt;subscribe>:</dt>
<dd>an XML data structure (see <a class='info' href='#defn.subscribe'>Section&nbsp;4.5<span> (</span><span class='info'>&lt;subscribe></span><span>)</span></a>) indicating notification events to which
    the AS subscribes. It is an error if a specified notification event
    is not supported by the implementation. The element is
    optional. 
</dd>
</dl></blockquote><p>


</p>
<p> For example, a request to prepare a playannouncement dialog where a
single prompt is played once:

</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;dialogprepare src="playannouncement"&gt;
  &lt;data&gt;
     &lt;item name="prompts"
              value="http://www.example.com/prompt1.wav"/&gt;
     &lt;item name="iterations" value="1"/&gt;
  &lt;/data&gt;
&lt;/dialogprepare&gt;
</pre></div><p>



</p>
<p>When an MS has successfully received a &lt;dialogprepare> request, it
MUST reply with a &lt;response> element (<a class='info' href='#defn.responses'>Section&nbsp;4.2<span> (</span><span class='info'>Responses</span><span>)</span></a>). 

</p>
<a name="defn.dialogstart"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1.2"></a><h3>4.1.2.&nbsp;
&lt;dialogstart></h3>

<p>The &lt;dialogstart> element is sent by the AS to request execution
of a dialog. The dialog may be defined in the dialogstart request
itself, or reference a previously prepared dialog. 
</p>
<p>The &lt;dialogstart> element has the following attributes:

</p>
<blockquote class="text"><dl>
<dt>src:</dt>
<dd> string identifying the URI of the dialog document to
start. The attribute is optional. The MS MUST support playannouncement,
promptandcollect and promptandrecord template dialogs as the value for
this attribute.  
</dd>
<dt>dialogid:</dt>
<dd>string indicating a unique name for the
    dialog. If this attribute is not specified, the MS creates a unique
    name for the dialog. The value is used in subsequent references to
    the dialog (e.g. as dialogid in a &lt;response>). It is an error if
    a dialog with the same name already exists on the MS.
    The attribute is optional.
    
</dd>
<dt>prepareddialogid:</dt>
<dd>string identifying a dialog previously
prepared using a dialogprepare request. The attribute is optional.
</dd>
<dt>connection-id:</dt>
<dd>string identifying the SIP dialog
    connection on which this dialog is to be started (see Section 16.1
    of <a class='info' href='#SIPCF'>[SIPCF]<span> (</span><span class='info'>Boulton, C., Melanchuk, T., McGlashan, S., and A. Shiratzky, &ldquo;A Control Framework for the Session Initiation         Protocol (SIP),&rdquo; October&nbsp;2006.</span><span>)</span></a>).  The attribute is optional. 
</dd>
<dt>conf-id:</dt>
<dd>string identifying the conference on which this
    dialog is to be started (see Section 16.1 of <a class='info' href='#SIPCF'>[SIPCF]<span> (</span><span class='info'>Boulton, C., Melanchuk, T., McGlashan, S., and A. Shiratzky, &ldquo;A Control Framework for the Session Initiation         Protocol (SIP),&rdquo; October&nbsp;2006.</span><span>)</span></a>). The attribute is optional. 
</dd>
</dl></blockquote><p>

</p>
<p>If the prepareddialogid is specified, it is an error to specify the
    src or dialogid attributes. 
</p>
<p>If the prepareddialogid is not specified, exactly the src attribute
    MUST be specified; otherwise, it is an error. 
</p>
<p>Exactly one of the connection-id or conf-id attributes MUST be
 specified. It is an error to specify both connection-id and
 conf-id.
</p>
<p>The &lt;dialogstart> element has the following child elements
defined: 

</p>
<blockquote class="text"><dl>
<dt>&lt;stream>:</dt>
<dd> contains the following
attributes:
    
<blockquote class="text"><dl>
<dt>media:</dt>
<dd>a string indicating the type of media
        associated with the stream. It is strongly recommended that the
        following values are used for common types of media: "audio" for
        audio media, and "video" for video media.  The attribute is
        mandatory. 
</dd>
<dt>label:</dt>
<dd>a string indicating the SDP label
        associated with a media stream (<a class='info' href='#RFC4574'>[RFC4574]<span> (</span><span class='info'>Levin, O. and G. Camarillo, &ldquo;The Session Description Protocol (SDP) Label Attribute,&rdquo; August&nbsp;2006.</span><span>)</span></a>).  The
        attribute is optional.  
</dd>
<dt>direction:</dt>
<dd>a string indicating the direction of
        the media flow between a dialog and its end point conference or
        connection. Defined values are: "sendrecv" (media can be sent
        and received), "sendonly" (media can only be sent), and
        "recvonly" (media can only be received). The default value is
        "sendrecv". The attribute is optional. 
</dd>
</dl></blockquote> 

    One or more &lt;stream> elements may be specified so that individual
    media streams can be controlled independently; for example, audio
    only for transmission, but video only for reception. 

    The &lt;stream> element is optional. If no &lt;stream> elements are
    specified, then the default is the media configuration of the
    connection or conference.

    It is an error if a &lt;stream> element is in conflict with (a)
    another &lt;stream> element, (b) with dialog, connection or
    conference media capabilities, or (c) with a SDP label value as part
    of the connection-id (see Section 16.1 of <a class='info' href='#SIPCF'>[SIPCF]<span> (</span><span class='info'>Boulton, C., Melanchuk, T., McGlashan, S., and A. Shiratzky, &ldquo;A Control Framework for the Session Initiation         Protocol (SIP),&rdquo; October&nbsp;2006.</span><span>)</span></a>).
    
</dd>
<dt>&lt;data>:</dt>
<dd>an XML data structure (see <a class='info' href='#defn.data'>Section&nbsp;4.4<span> (</span><span class='info'>&lt;data></span><span>)</span></a>) to pass parameters into the dialog.  It is
    an error if a specified parameter is not supported by the
    implementation.  The element is optional. 
</dd>
<dt>&lt;subscribe>:</dt>
<dd>an XML data structure (see <a class='info' href='#defn.subscribe'>Section&nbsp;4.5<span> (</span><span class='info'>&lt;subscribe></span><span>)</span></a>) indicating notification events to which
    the AS subscribes. It is an error if a specified notification event
    is not supported by the implementation.The element is optional. 
</dd>
</dl></blockquote><p>
    
</p>
<p>[Editors Note: the &lt;stream> element assumes that the use of the
    SDP label by itself is insufficent for media stream control. In
    particular, the SDP label does not address directionality, nor does
    it address conferences. Further investigation of the &lt;stream> is
    is required.]  
</p>
<p>If the prepareddialogid is specified and the &lt;dialogprepare>
contained a &lt;data> element, it is an error to specify it in
&lt;dialogstart>.  Likewise, If the prepareddialogid is specified and
the &lt;dialogprepare> contained a &lt;subscribe> element, it is an
error to specify it in &lt;dialogstart>.

</p>
<p>For example, a request to start a promptandrecord template dialog on
a conference:
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
 &lt;dialogstart conf-id="conference11" src="playandrecord"&gt;
    &lt;data&gt;
      &lt;item name="maxtime" value="384000s"/&gt;
    &lt;/data&gt;
 &lt;/dialogstart&gt;
</pre></div><p>

    
</p>
<p>When an MS has successfully received a &lt;dialogstart> request, it
MUST reply with a &lt;response> element (<a class='info' href='#defn.responses'>Section&nbsp;4.2<span> (</span><span class='info'>Responses</span><span>)</span></a>).  
</p>
<a name="defn.dialogterminate"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1.3"></a><h3>4.1.3.&nbsp;
&lt;dialogterminate></h3>

<p>A dialog that has been successfully prepared or started can be
terminated by a &lt;dialogterminate> request element from the AS.
</p>
<p>The &lt;dialogterminate> element has the following attributes:

</p>
<blockquote class="text"><dl>
<dt>dialogid:</dt>
<dd>string identifying an existing dialog. The
attribute is mandatory.
</dd>
<dt>immediate:</dt>
<dd>string with the values "true" or "false"
    indicating whether the dialog is to be terminated immediately or
    not. If a dialog is terminated immediately, no further dialog event
    notifications are sent (including a dialogexit &lt;event>). The default
    is "false". The attribute is optional. 
</dd>
</dl></blockquote><p>

</p>
<p>For example, assuming a dialog with the dialogid "vxi1" has been
started, it can be terminated immediately with the following request:

</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;dialogterminate dialogid="vxi1" immediate="true"/&gt;
</pre></div><p>


</p>
<p>When an MS has successfully received a &lt;dialogterminate> request, it
MUST reply with a &lt;response> element (<a class='info' href='#defn.responses'>Section&nbsp;4.2<span> (</span><span class='info'>Responses</span><span>)</span></a>).  
</p>
<a name="defn.responses"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Responses</h3>

<p>Responses are specified in a &lt;response> element. 
</p>
<a name="defn.response"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.1"></a><h3>4.2.1.&nbsp;
&lt;response></h3>

<p>Reponses to requests are indicated by a &lt;response> element. 
</p>
<p>The &lt;response> element has following attributes:

</p>
<blockquote class="text"><dl>
<dt>status:</dt>
<dd>numeric code indicating the response status. The
attribute is mandatory.
</dd>
<dt>reason:</dt>
<dd>string specifying a reason for the response
status. The attribute is optional. 
</dd>
<dt>dialogid:</dt>
<dd>string identifying the dialog. The attribute is
optional.
</dd>
<dt>connection-id:</dt>
<dd>string identifying the SIP dialog
    connection associated with the dialog (see Section 16.1 of <a class='info' href='#SIPCF'>[SIPCF]<span> (</span><span class='info'>Boulton, C., Melanchuk, T., McGlashan, S., and A. Shiratzky, &ldquo;A Control Framework for the Session Initiation         Protocol (SIP),&rdquo; October&nbsp;2006.</span><span>)</span></a>). The attribute is optional.
</dd>
<dt>conf-id:</dt>
<dd>string identifying the conference associated with
    the dialog (see Section 16.1 of <a class='info' href='#SIPCF'>[SIPCF]<span> (</span><span class='info'>Boulton, C., Melanchuk, T., McGlashan, S., and A. Shiratzky, &ldquo;A Control Framework for the Session Initiation         Protocol (SIP),&rdquo; October&nbsp;2006.</span><span>)</span></a>). The
    attribute is optional.
</dd>
</dl></blockquote><p>

</p>
<p>The following status codes are defined: 
</p><br /><hr class="insert" />
<a name="defn.response.statuscodes"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left" width="15%"><col align="left" width="85%">
<tr><th align="left">code</th><th align="left">description</th></tr>
<tr>
<td align="left">200</td>
<td align="left">OK</td>
</tr>
<tr>
<td align="left">401</td>
<td align="left">dialogid already exists</td>
</tr>
<tr>
<td align="left">402</td>
<td align="left">dialogid does not exist</td>
</tr>
<tr>
<td align="left">403</td>
<td align="left">connection-id does not exist</td>
</tr>
<tr>
<td align="left">404</td>
<td align="left">conf-id does not exist</td>
</tr>
<tr>
<td align="left">405</td>
<td align="left">Unknown or unsupported element</td>
</tr>
<tr>
<td align="left">406</td>
<td align="left">Element required</td>
</tr>
<tr>
<td align="left">407</td>
<td align="left">Unknown or unsupported attribute</td>
</tr>
<tr>
<td align="left">408</td>
<td align="left">Attribute required</td>
</tr>
<tr>
<td align="left">409</td>
<td align="left">template dialog not supported</td>
</tr>
<tr>
<td align="left">410</td>
<td align="left">data parameter not supported</td>
</tr>
<tr>
<td align="left">411</td>
<td align="left">event subscription not supported</td>
</tr>
<tr>
<td align="left">412</td>
<td align="left">stream parameter invalid</td>
</tr>
<tr>
<td align="left">499</td>
<td align="left">other error</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 1: &lt;response> status codes&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>[Editors Note: more status codes may need to be defined.]
</p>
<p>For example, a response when a dialog was prepared successfully:

</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;response status="200" dialogid="vxi1"/&gt;
</pre></div><p>


</p>
<p>The response if dialog preparation failed due to an unknown template:

</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
 &lt;response status="409" dialogid="vxi1"
    reason="Unknown template: promptandrecod"/&gt;
</pre></div><p>


</p>
<p>For example, a response when the dialog was started successfully.

</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
 &lt;response status="200" dialogid="vxi1"
              connection-id="7HDY839~HJKSkyHS"/&gt;
</pre></div><p>



</p>
<a name="defn.notifications"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
Notifications</h3>

<p>Event notifications are specified in an &lt;event> element. 
</p>
<a name="defn.event"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.1"></a><h3>4.3.1.&nbsp;
&lt;event></h3>

<p>Dialog event notifications are either manual or automatic. 
</p>
<p> Manual event notifications are defined when an AS subscribes to
    notifications for dialog events using the &lt;subscribe> element of
    &lt;dialogprepare> or &lt;dialogstart>.  
</p>
<p> Automatic event notifications are defined as part of a Control
    Package. The AS SHOULD NOT subscribe to these event
    notifications. The MS MUST support these event notifications. This
    package defines one automatic notification event: "dialogexit" which
    indicates that an active dialog has terminated. Note that this
    notification is not sent if the dialog has been terminated by the AS
    using a &lt;dialogterminate/> request where "immediate=true". 
</p>
<p> When a dialog generates a notification event, the MS sends the event
    to the AS using an &lt;event> element. 
</p>
<p>The &lt;event> element has the following attributes:

</p>
<blockquote class="text"><dl>
<dt>name:</dt>
<dd>string indicating the name of dialog event. The
string is restricted to a sequence of alphanumeric or "."
characters. The attribute is mandatory. 
</dd>
<dt>dialogid:</dt>
<dd>string identifying the dialog. The attribute is
mandatory. 
</dd>
</dl></blockquote><p>

</p>
<p>The &lt;event> element has the following child element: 

</p>
<blockquote class="text"><dl>
<dt>&lt;data>:</dt>
<dd> an XML data structure (see <a class='info' href='#defn.data'>Section&nbsp;4.4<span> (</span><span class='info'>&lt;data></span><span>)</span></a>) to pass information additional information
    about the dialog event.  The element is optional. 
</dd>
</dl></blockquote><p> 


</p>
<p>For example, when a dialog exits the MS may send a dialogexit
    &lt;event> with data indicating the status of a template
    dialog:

</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;event name="dialogexit" dialogid="vxi1"&gt;
 &lt;data&gt;
   &lt;item name="status" value="1"/&gt;
 &lt;/data&gt;
&lt;/event&gt;
</pre></div><p>


</p>
<a name="defn.data"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4"></a><h3>4.4.&nbsp;
&lt;data></h3>

<p>The &lt;data> element is a general container for parameterized data.
    
</p>
<p>The &lt;data> element has no attributes, but has the
    following child elements defined:


      </p>
<blockquote class="text"><dl>
<dt>&lt;item>:</dt>
<dd> contains the following attributes:

        
<blockquote class="text"><dl>
<dt>name:</dt>
<dd>a string indicating the name of the
            parameter.  The attribute is mandatory. 
</dd>
<dt>value:</dt>
<dd>a string indicating the value of the
        parameter. Multiple values of a parameters can be specified 
        using space separation. The attribute is mandatory.  
</dd>
</dl></blockquote>
    
</dd>
</dl></blockquote><p>

      Multiple &lt;item> elements may be specified. 
</p>
<p>For example, a &lt;data> specifying promptandcollect template
parameters with simple values:

</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;data&gt;
   &lt;item name="iterations" value="5"/&gt;
   &lt;item name="timeout" value="10s"/&gt;
&lt;/data&gt;
</pre></div><p>



</p>
<p>In this example, a &lt;data> specifying a playannouncement
    template with a complex value for the prompts parameter:

</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;data&gt;
 &lt;item name="prompts" value="http://example.com/balance.wav
          http://example.com/five.wav http://example.com/euros.wav"/&gt;
&lt;/data&gt;
</pre></div><p>


</p>
<p>[Editors Note: we may also want to investigate the use of 
&lt;item>s nested within a  top-level &lt;item> to specify complex
    values. ]
</p>
<a name="defn.subscribe"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5"></a><h3>4.5.&nbsp;
&lt;subscribe></h3>

<p> The &lt;subscribe> element is a container for specifying dialog
    notification events to which an AS subscribes. Notifications of
    dialog events are delivered using the &lt;event> element (see <a class='info' href='#defn.event'>Section&nbsp;4.3.1<span> (</span><span class='info'>&lt;event></span><span>)</span></a>).

</p>
<p>The &lt;subscribe> element has no attributes, but has the
    following child elements defined:

      </p>
<blockquote class="text"><dl>
<dt>&lt;notify>:</dt>
<dd> contains the following attributes:

        
<blockquote class="text"><dl>
<dt>name:</dt>
<dd>a string indicating the name of the event to
            be notified of.  The attribute is mandatory. 
</dd>
</dl></blockquote>

        The &lt;notify> element may have a &lt;data> child element. 
</dd>
</dl></blockquote><p>
      Multiple &lt;notify> elements may be specified. 
    
</p>
<p>For example, the AS wishes to subscribe to DTMF and bargein
    notification events associated with a dialog:

</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;dialogstart src="promptandcollect"
     connection-id="7HDY839~HJKSkyHS~HUwkuh7ns"&gt;
 &lt;subscribe&gt;
    &lt;notify name="dtmf"/&gt;
    &lt;notify name="bargein"/&gt;
  &lt;/subscribe&gt;
&lt;/dialogstart&gt;
</pre></div><p>



If the MS supports these notification events, then it would use the
    &lt;event> element to send notifications during the dialog to the AS
    when the events occured.  
</p>
<p>[Editors Note: It may be possible to define a general event
    subscription mechanism as part of the SIP Control Framework.] 
</p>
<p>[Editors Note: This Control Package does not specify dialog
    notification events apart from "dialogexit". Later versions may
    define events such as: "dtmf" (a DTMF key is pressed), "mediastart"
    (media playback started), "bargein" (user has barged in on a
    prompt), and "rtpcontrol" (control data, e.g. VFU, PoC, etc, is
    received over the RTP control channel.] 
</p>
<a name="defn.templates"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
IVR Template Dialogs</h3>

<p>The execution of IVR template dialog takes place on the
            MS. The AS specifies the name of the template and
            configuration parameters, and receives the result from the
            MS after the dialog has been executed. 
</p>
<p>Input parameters are used to configure and customize the
      behavior of the template. For many input parameters, the templates
      provide default values; a developer can specify an alternative
      value if the default is not appropriate for their
      application. Input parameters for templates may be mandatory,
      requiring a specific value to be provided. 
</p>
<p>The result of executing a template dialog is reported to the AS
      using output parameters. These parameters may describe status
      information, error information or information collected from the
      user. Output parameters are mandatory or optional depending on the
      specific template; mandatory parameters must be specified by the
      implementation. 
</p>
<p>Template dialogs are invoked by referencing them in the src
    attribute of &lt;dialogprepare> (<a class='info' href='#defn.dialogprepare'>Section&nbsp;4.1.1<span> (</span><span class='info'>&lt;dialogprepare></span><span>)</span></a>) or &lt;dialogstart> (<a class='info' href='#defn.dialogstart'>Section&nbsp;4.1.2<span> (</span><span class='info'>&lt;dialogstart></span><span>)</span></a>). Input parameters are specified in the
    &lt;data> child element (<a class='info' href='#defn.data'>Section&nbsp;4.4<span> (</span><span class='info'>&lt;data></span><span>)</span></a>) of these
    elements. Output parameters are specified in the &lt;data> child
    element of a dialogexit &lt;event> notification (<a class='info' href='#defn.event'>Section&nbsp;4.3.1<span> (</span><span class='info'>&lt;event></span><span>)</span></a>). The detailed mapping of template dialogs to
    XML CONTROL and REPORT messages is described in <a class='info' href='#sec:Control_Package_Definition'>Section&nbsp;3<span> (</span><span class='info'>Control Package Definition</span><span>)</span></a> and examples are provided
    in <a class='info' href='#examples.templates'>Section&nbsp;7<span> (</span><span class='info'>Template Dialog Examples</span><span>)</span></a>.  
</p>
<p>The implementation of template dialogs MUST adhere to the
      syntax and semantics of templates described in this document.
      Implementations MAY support additional parameters of the defined
      template dialogs.  Implementations MAY support additional template
      dialogs. The actual implementation may be based on any
      technology or scripting language.  
</p>
<p>The media requirements on the template implementation are
     restricted to the capability to play audio prompts (specified as
     <a class='info' href='#defn.uri'>URI<span> (</span><span class='info'>URI</span><span>)</span></a>s), collect DTMF input, and
     record audio input. The implementation MUST support G.711 audio
     formats (headerless and wav) for playback and recording. The
     implementation MAY support other media formats. 
</p>
<p>[Editors Note: Later versions may consider additional media
    requirements including TTS, ASR, video, etc. ] 
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Play Announcement</h3>

<p>A template dialog to play announcements to the user. 
</p>
<p>The template dialog is invoked using the URI
        "playannouncement".
</p>
<p>The dialog execution model consists of:

            </p>
<ol class="text">
<li>Playing <a class='info' href='#playannouncement.prompts'>prompts<span> (</span><span class='info'>prompts</span><span>)</span></a> in the order
                specified until completion. 
                
</li>
<li>Repeating step 1 for the value of  <a class='info' href='#playannouncement.iterations'>iterations<span> (</span><span class='info'>iterations</span><span>)</span></a>. 
</li>
<li>Returning <a class='info' href='#playannouncement.status'>status<span> (</span><span class='info'>status</span><span>)</span></a> and 
                    <a class='info' href='#playannouncement.reason'>reason<span> (</span><span class='info'>reason</span><span>)</span></a> parameters.
                    
</li>
</ol><p>

        
</p>
<p>The input and output parameters are summarized and defined
        below.
</p><br /><hr class="insert" />
<a name="playannouncement.parameters"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left" width="15%"><col align="left" width="15%"><col align="left" width="40%"><col align="left" width="10%">
<tr><th align="left">Name</th><th align="left">Direction</th><th align="left">Description</th><th align="left">Definition</th></tr>
<tr>
<td align="left">prompts</td>
<td align="left">input</td>
<td align="left">prompts to play</td>
<td align="left"><a class='info' href='#playannouncement.prompts'>Table&nbsp;3<span> (</span><span class='info'>prompts</span><span>)</span></a></td>
</tr>
<tr>
<td align="left">iterations</td>
<td align="left">input</td>
<td align="left">maximum iterations</td>
<td align="left"><a class='info' href='#playannouncement.iterations'>Table&nbsp;4<span> (</span><span class='info'>iterations</span><span>)</span></a></td>
</tr>
<tr>
<td align="left">status</td>
<td align="left">output</td>
<td align="left">status code</td>
<td align="left"><a class='info' href='#playannouncement.status'>Table&nbsp;5<span> (</span><span class='info'>status</span><span>)</span></a></td>
</tr>
<tr>
<td align="left">reason</td>
<td align="left">output</td>
<td align="left">reason for status</td>
<td align="left"><a class='info' href='#playannouncement.reason'>Table&nbsp;6<span> (</span><span class='info'>reason</span><span>)</span></a></td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 2: playannouncement parameter overview&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>Note that playannouncement requires at least one prompt
          specified in <a class='info' href='#playannouncement.prompts'>prompts<span> (</span><span class='info'>prompts</span><span>)</span></a>.
</p><br /><hr class="insert" />
<a name="playannouncement.prompts"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left" width="15%"><col align="left" width="85%">
<tr><th align="left">Name</th><th align="left">prompts</th></tr>
<tr>
<td align="left">Description</td>
<td align="left">One or more prompts to play</td>
</tr>
<tr>
<td align="left">Direction</td>
<td align="left">input</td>
</tr>
<tr>
<td align="left">Type</td>
<td align="left"><a class='info' href='#defn.urilist'>URIList<span> (</span><span class='info'>URIList</span><span>)</span></a></td>
</tr>
<tr>
<td align="left">Optional</td>
<td align="left">No</td>
</tr>
<tr>
<td align="left">Possible Values</td>
<td align="left">A valid URIList which is non-empty</td>
</tr>
<tr>
<td align="left">Default</td>
<td align="left">none</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 3: prompts&nbsp;</b></font><br /></td></tr></table><hr class="insert" />
<br /><hr class="insert" />
<a name="playannouncement.iterations"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left" width="15%"><col align="left" width="85%">
<tr><th align="left">Name</th><th align="left">iterations</th></tr>
<tr>
<td align="left">Description</td>
<td align="left">Maximum number of times the
            playannouncement  dialog is to be played</td>
</tr>
<tr>
<td align="left">Direction</td>
<td align="left">input</td>
</tr>
<tr>
<td align="left">Type</td>
<td align="left">
              <a class='info' href='#defn.nonneginteger'>Non-Negative Integer<span> (</span><span class='info'>Non-Negative Integer</span><span>)</span></a>
            </td>
</tr>
<tr>
<td align="left">Optional</td>
<td align="left">Yes</td>
</tr>
<tr>
<td align="left">Possible Values</td>
<td align="left">A valid non-negative integer.
                    A value of 0 indicates that the dialog is repeated
                       until halted by other means.</td>
</tr>
<tr>
<td align="left">Default</td>
<td align="left">1</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 4: iterations&nbsp;</b></font><br /></td></tr></table><hr class="insert" />
<br /><hr class="insert" />
<a name="playannouncement.status"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left" width="15%"><col align="left" width="85%">
<tr><th align="left">Name</th><th align="left">status</th></tr>
<tr>
<td align="left">Description</td>
<td align="left">A status code indicating success or failure of the
    playannouncement dialog</td>
</tr>
<tr>
<td align="left">Direction</td>
<td align="left">output</td>
</tr>
<tr>
<td align="left">Type</td>
<td align="left">
              <a class='info' href='#defn.nonneginteger'>Non-Negative Integer<span> (</span><span class='info'>Non-Negative Integer</span><span>)</span></a>
            </td>
</tr>
<tr>
<td align="left">Optional</td>
<td align="left">No</td>
</tr>
<tr>
<td align="left">Possible Values</td>
<td align="left">1 for success; otherwise an error code (600, 601, 602). 
               See <a class='info' href='#allstatuscodes'>Table&nbsp;30<span> (</span><span class='info'>status codes                 for all templates dialogs</span><span>)</span></a>
            </td>
</tr>
<tr>
<td align="left">Default</td>
<td align="left">none</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 5: status&nbsp;</b></font><br /></td></tr></table><hr class="insert" />
<br /><hr class="insert" />
<a name="playannouncement.reason"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left" width="15%"><col align="left" width="85%">
<tr><th align="left">Name</th><th align="left">reason</th></tr>
<tr>
<td align="left">Description</td>
<td align="left">A textual description providing a reason
            for the status code; e.g. details about an error</td>
</tr>
<tr>
<td align="left">Direction</td>
<td align="left">output</td>
</tr>
<tr>
<td align="left">Type</td>
<td align="left"><a class='info' href='#defn.string'>String<span> (</span><span class='info'>String</span><span>)</span></a></td>
</tr>
<tr>
<td align="left">Optional</td>
<td align="left">Yes</td>
</tr>
<tr>
<td align="left">Possible Values</td>
<td align="left">A valid String value</td>
</tr>
<tr>
<td align="left">Default</td>
<td align="left">Empty string</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 6: reason&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>The following additional input parameters are under
            consideration for later versions:
</p><br /><hr class="insert" />
<a name="playannouncement.extensions"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left" width="15%"><col align="left" width="85%">
<tr><th align="left">Name</th><th align="left">Description</th></tr>
<tr>
<td align="left">duration</td>
<td align="left">maximum duration for the dialog including iterations</td>
</tr>
<tr>
<td align="left">interval</td>
<td align="left">time to elapse between successive
        iterations</td>
</tr>
<tr>
<td align="left">audiomaxage</td>
<td align="left">maxage cache control for prompts</td>
</tr>
<tr>
<td align="left">audiomaxstale</td>
<td align="left">maxstale cache control for prompts</td>
</tr>
<tr>
<td align="left">speed</td>
<td align="left">playback speed for prompts</td>
</tr>
<tr>
<td align="left">volume</td>
<td align="left">playback volume for prompts</td>
</tr>
<tr>
<td align="left">offset</td>
<td align="left">play from offset in prompts</td>
</tr>
<tr>
<td align="left">variables</td>
<td align="left">references to common types such as money, time, numbers, etc </td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 7: Additional playannouncement parameters&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Prompt and Collect</h3>

<p>A template dialog to play prompts and collect DTMF input.  
</p>
<p>The dialog is invoked with the URI "promptandcollect". 
</p>
<p>The dialog execution model consists of:

            </p>
<ol class="text">
<li>Clearing the digit buffer depending on the value of
                <a class='info' href='#promptandcollect.cleardigitbuffer'>cleardigitbuffer<span> (</span><span class='info'>cleardigitbuffer</span><span>)</span></a>.
</li>
<li>Playing <a class='info' href='#promptandcollect.prompts'>prompts<span> (</span><span class='info'>prompts</span><span>)</span></a> in the order
                specified.  The <a class='info' href='#promptandcollect.bargein'>bargein<span> (</span><span class='info'>bargein</span><span>)</span></a> parameter determines
                whether user input can be collected during prompt
                playback stops (if so, prompt playback is stopped).
                
</li>
<li>Collecting DTMF input from the user. Valid DTMF
                patterns are either a simple digit string where the
                maximum length is determined by <a class='info' href='#promptandcollect.maxdigits'>maxdigits<span> (</span><span class='info'>maxdigits</span><span>)</span></a> and may be
                terminated by the character in <a class='info' href='#promptandcollect.termchar'>termchar<span> (</span><span class='info'>termchar</span><span>)</span></a>; or a custom DTMF
                grammar specified by <a class='info' href='#promptandcollect.grammar'>grammar<span> (</span><span class='info'>grammar</span><span>)</span></a>. The parameters
                <a class='info' href='#promptandcollect.timeout'>timeout<span> (</span><span class='info'>timeout</span><span>)</span></a>, <a class='info' href='#promptandcollect.interdigittimeout'>interdigittimeout<span> (</span><span class='info'>interdigittimeout</span><span>)</span></a> and <a class='info' href='#promptandcollect.termtimeout'>termtimeout<span> (</span><span class='info'>termtimeout</span><span>)</span></a>
                control user input timeout, interdigit timeout and the
                terminating timeout respectively.  
</li>
<li>If no input is collected or the input is invalid,
                    steps 1 - 3 are repeated for the value of <a class='info' href='#promptandcollect.iterations'>iterations<span> (</span><span class='info'>iterations</span><span>)</span></a>.
                  
</li>
<li>Returning <a class='info' href='#promptandcollect.status'>status<span> (</span><span class='info'>status</span><span>)</span></a>,
                    <a class='info' href='#promptandcollect.reason'>reason<span> (</span><span class='info'>reason</span><span>)</span></a> and
                    <a class='info' href='#promptandcollect.result'>result<span> (</span><span class='info'>result</span><span>)</span></a> 
                    parameters.
                    
</li>
</ol><p>

        
</p>
<p>The input and output parameter are summarized and defined
     below. 
</p><br /><hr class="insert" />
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left" width="15%"><col align="left" width="15%"><col align="left" width="40%"><col align="left" width="10%">
<tr><th align="left">Name</th><th align="left">Direction</th><th align="left">Description</th><th align="left">Definition</th></tr>
<tr>
<td align="left">prompts</td>
<td align="left">input</td>
<td align="left">prompts to play</td>
<td align="left"><a class='info' href='#promptandcollect.prompts'>Table&nbsp;8<span> (</span><span class='info'>prompts</span><span>)</span></a></td>
</tr>
<tr>
<td align="left">iterations</td>
<td align="left">input</td>
<td align="left">maximum attempts</td>
<td align="left">
              <a class='info' href='#promptandcollect.iterations'>Table&nbsp;9<span> (</span><span class='info'>iterations</span><span>)</span></a>
            </td>
</tr>
<tr>
<td align="left">cleardigitbuffer</td>
<td align="left">input</td>
<td align="left">dtmf buffer clearing</td>
<td align="left">
              <a class='info' href='#promptandcollect.cleardigitbuffer'>Table&nbsp;10<span> (</span><span class='info'>cleardigitbuffer</span><span>)</span></a>
            </td>
</tr>
<tr>
<td align="left">bargein</td>
<td align="left">input</td>
<td align="left">interruption of prompts </td>
<td align="left">
              <a class='info' href='#promptandcollect.bargein'>Table&nbsp;11<span> (</span><span class='info'>bargein</span><span>)</span></a>
            </td>
</tr>
<tr>
<td align="left">timeout</td>
<td align="left">input</td>
<td align="left">timeout for user input </td>
<td align="left">
              <a class='info' href='#promptandcollect.timeout'>Table&nbsp;12<span> (</span><span class='info'>timeout</span><span>)</span></a>
            </td>
</tr>
<tr>
<td align="left">interdigittimeout</td>
<td align="left">input</td>
<td align="left">timeout between digits </td>
<td align="left">
              <a class='info' href='#promptandcollect.interdigittimeout'>Table&nbsp;13<span> (</span><span class='info'>interdigittimeout</span><span>)</span></a>
            </td>
</tr>
<tr>
<td align="left">termtimeout</td>
<td align="left">input</td>
<td align="left">terminating timeout </td>
<td align="left">
              <a class='info' href='#promptandcollect.termtimeout'>Table&nbsp;14<span> (</span><span class='info'>termtimeout</span><span>)</span></a>
            </td>
</tr>
<tr>
<td align="left">termchar</td>
<td align="left">input</td>
<td align="left">terminating character </td>
<td align="left">
              <a class='info' href='#promptandcollect.termchar'>Table&nbsp;15<span> (</span><span class='info'>termchar</span><span>)</span></a>
            </td>
</tr>
<tr>
<td align="left">maxdigits</td>
<td align="left">input</td>
<td align="left">maximum number of digits </td>
<td align="left">
              <a class='info' href='#promptandcollect.maxdigits'>Table&nbsp;16<span> (</span><span class='info'>maxdigits</span><span>)</span></a>
            </td>
</tr>
<tr>
<td align="left">grammar</td>
<td align="left">input</td>
<td align="left">custom grammar </td>
<td align="left">
              <a class='info' href='#promptandcollect.grammar'>Table&nbsp;17<span> (</span><span class='info'>grammar</span><span>)</span></a>
            </td>
</tr>
<tr>
<td align="left">status</td>
<td align="left">output</td>
<td align="left">status code</td>
<td align="left">
              <a class='info' href='#promptandcollect.status'>Table&nbsp;18<span> (</span><span class='info'>status</span><span>)</span></a>
            </td>
</tr>
<tr>
<td align="left">reason</td>
<td align="left">output</td>
<td align="left">reason for status</td>
<td align="left">
              <a class='info' href='#promptandcollect.reason'>Table&nbsp;19<span> (</span><span class='info'>reason</span><span>)</span></a>
            </td>
</tr>
<tr>
<td align="left">result</td>
<td align="left">output</td>
<td align="left">input collected</td>
<td align="left">
              <a class='info' href='#promptandcollect.result'>Table&nbsp;20<span> (</span><span class='info'>result</span><span>)</span></a>
            </td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;promptandcollect parameter overview&nbsp;</b></font><br /></td></tr></table><hr class="insert" />
<br /><hr class="insert" />
<a name="promptandcollect.prompts"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left" width="15%"><col align="left" width="85%">
<tr><th align="left">Name</th><th align="left">prompts</th></tr>
<tr>
<td align="left">Description</td>
<td align="left">Initial prompts to play</td>
</tr>
<tr>
<td align="left">Direction</td>
<td align="left">input</td>
</tr>
<tr>
<td align="left">Type</td>
<td align="left">
              <a class='info' href='#defn.urilist'>URIList<span> (</span><span class='info'>URIList</span><span>)</span></a>
            </td>
</tr>
<tr>
<td align="left">Optional</td>
<td align="left">Yes</td>
</tr>
<tr>
<td align="left">Possible Values</td>
<td align="left">A valid URIList</td>
</tr>
<tr>
<td align="left">Default</td>
<td align="left">none</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 8: prompts&nbsp;</b></font><br /></td></tr></table><hr class="insert" />
<br /><hr class="insert" />
<a name="promptandcollect.iterations"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left" width="15%"><col align="left" width="85%">
<tr><th align="left">Name</th><th align="left">iterations</th></tr>
<tr>
<td align="left">Description</td>
<td align="left">Maximum number of times the
            promptandcollect dialog is to be played</td>
</tr>
<tr>
<td align="left">Direction</td>
<td align="left">input</td>
</tr>
<tr>
<td align="left">Type</td>
<td align="left">
              <a class='info' href='#defn.nonneginteger'>Non-Negative Integer<span> (</span><span class='info'>Non-Negative Integer</span><span>)</span></a>
            </td>
</tr>
<tr>
<td align="left">Optional</td>
<td align="left">Yes</td>
</tr>
<tr>
<td align="left">Possible Values</td>
<td align="left">A valid non-negative integer. A value of 0
            indicates the dialog is  repeated
            until halted by other means.</td>
</tr>
<tr>
<td align="left">Default</td>
<td align="left">0</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 9: iterations&nbsp;</b></font><br /></td></tr></table><hr class="insert" />
<br /><hr class="insert" />
<a name="promptandcollect.cleardigitbuffer"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left" width="15%"><col align="left" width="85%">
<tr><th align="left">Name</th><th align="left">cleardigitbuffer</th></tr>
<tr>
<td align="left">Description</td>
<td align="left">Clear digit buffer prior to
            prompt playback</td>
</tr>
<tr>
<td align="left">Direction</td>
<td align="left">input</td>
</tr>
<tr>
<td align="left">Type</td>
<td align="left">
              <a class='info' href='#defn.boolean'>Boolean<span> (</span><span class='info'>Boolean</span><span>)</span></a>
            </td>
</tr>
<tr>
<td align="left">Optional</td>
<td align="left">Yes</td>
</tr>
<tr>
<td align="left">Possible Values</td>
<td align="left">A valid boolean value. A value of
            true indicates that the digitbuffer is to be cleared. A
            value of false indicates that the digitbuffer is not to be
            cleared. </td>
</tr>
<tr>
<td align="left">Default</td>
<td align="left">true</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 10: cleardigitbuffer&nbsp;</b></font><br /></td></tr></table><hr class="insert" />
<br /><hr class="insert" />
<a name="promptandcollect.bargein"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left" width="15%"><col align="left" width="85%">
<tr><th align="left">Name</th><th align="left">bargein</th></tr>
<tr>
<td align="left">Description</td>
<td align="left">Indicates whether the user can interrupt
            the prompt with their input</td>
</tr>
<tr>
<td align="left">Direction</td>
<td align="left">input</td>
</tr>
<tr>
<td align="left">Type</td>
<td align="left">
              <a class='info' href='#defn.boolean'>Boolean<span> (</span><span class='info'>Boolean</span><span>)</span></a>
            </td>
</tr>
<tr>
<td align="left">Optional</td>
<td align="left">Yes</td>
</tr>
<tr>
<td align="left">Possible Values</td>
<td align="left">A valid boolean value. A value of
            true indicates that bargein is permitted.  A
            value of false indicates that bargein is not permitted. </td>
</tr>
<tr>
<td align="left">Default</td>
<td align="left">true</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 11: bargein&nbsp;</b></font><br /></td></tr></table><hr class="insert" />
<br /><hr class="insert" />
<a name="promptandcollect.timeout"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left" width="15%"><col align="left" width="85%">
<tr><th align="left">Name</th><th align="left">timeout</th></tr>
<tr>
<td align="left">Description</td>
<td align="left">Indicates the time to wait for user input
        </td>
</tr>
<tr>
<td align="left">Direction</td>
<td align="left">input</td>
</tr>
<tr>
<td align="left">Type</td>
<td align="left">
              <a class='info' href='#defn.timedesignation'>Time Designation<span> (</span><span class='info'>Time Designation</span><span>)</span></a>
            </td>
</tr>
<tr>
<td align="left">Optional</td>
<td align="left">Yes</td>
</tr>
<tr>
<td align="left">Possible Values</td>
<td align="left">A valid TimeDesignation value. </td>
</tr>
<tr>
<td align="left">Default</td>
<td align="left">5s</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 12: timeout&nbsp;</b></font><br /></td></tr></table><hr class="insert" />
<br /><hr class="insert" />
<a name="promptandcollect.interdigittimeout"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left" width="15%"><col align="left" width="85%">
<tr><th align="left">Name</th><th align="left">interdigittimeout</th></tr>
<tr>
<td align="left">Description</td>
<td align="left">The inter-digit timeout value to use
            when recognizing DTMF input
        </td>
</tr>
<tr>
<td align="left">Direction</td>
<td align="left">input</td>
</tr>
<tr>
<td align="left">Type</td>
<td align="left">
              <a class='info' href='#defn.timedesignation'>Time Designation<span> (</span><span class='info'>Time Designation</span><span>)</span></a>
            </td>
</tr>
<tr>
<td align="left">Optional</td>
<td align="left">Yes</td>
</tr>
<tr>
<td align="left">Possible Values</td>
<td align="left">A valid TimeDesignation value. </td>
</tr>
<tr>
<td align="left">Default</td>
<td align="left">2s</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 13: interdigittimeout&nbsp;</b></font><br /></td></tr></table><hr class="insert" />
<br /><hr class="insert" />
<a name="promptandcollect.termtimeout"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left" width="15%"><col align="left" width="85%">
<tr><th align="left">Name</th><th align="left">termtimeout</th></tr>
<tr>
<td align="left">Description</td>
<td align="left">The terminating timeout to use when
        recognizing DTMF input </td>
</tr>
<tr>
<td align="left">Direction</td>
<td align="left">input</td>
</tr>
<tr>
<td align="left">Type</td>
<td align="left">
              <a class='info' href='#defn.timedesignation'>Time Designation<span> (</span><span class='info'>Time Designation</span><span>)</span></a>
            </td>
</tr>
<tr>
<td align="left">Optional</td>
<td align="left">Yes</td>
</tr>
<tr>
<td align="left">Possible Values</td>
<td align="left">A valid TimeDesignation value. </td>
</tr>
<tr>
<td align="left">Default</td>
<td align="left">0s</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 14: termtimeout&nbsp;</b></font><br /></td></tr></table><hr class="insert" />
<br /><hr class="insert" />
<a name="promptandcollect.termchar"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left" width="15%"><col align="left" width="85%">
<tr><th align="left">Name</th><th align="left">termchar</th></tr>
<tr>
<td align="left">Description</td>
<td align="left">The terminating DTMF character for DTMF
            input recognition. This parameter is
    ignored if the <a class='info' href='#promptandcollect.grammar'>grammar<span> (</span><span class='info'>grammar</span><span>)</span></a> parameter is specified.</td>
</tr>
<tr>
<td align="left">Direction</td>
<td align="left">input</td>
</tr>
<tr>
<td align="left">Type</td>
<td align="left">
              <a class='info' href='#defn.dtmfchar'>DTMFChar<span> (</span><span class='info'>DTMFChar</span><span>)</span></a>
            </td>
</tr>
<tr>
<td align="left">Optional</td>
<td align="left">Yes</td>
</tr>
<tr>
<td align="left">Possible Values</td>
<td align="left">A valid DTMFChar value. To disable
                termination by a conventional DTMF character, set the parameter
    to an unconventional character like 'A'. </td>
</tr>
<tr>
<td align="left">Default</td>
<td align="left">#</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 15: termchar&nbsp;</b></font><br /></td></tr></table><hr class="insert" />
<br /><hr class="insert" />
<a name="promptandcollect.maxdigits"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left" width="15%"><col align="left" width="85%">
<tr><th align="left">Name</th><th align="left">maxdigits</th></tr>
<tr>
<td align="left">Description</td>
<td align="left">The maximum number of digits to collect
    using an internal digits (0-9 only) grammar. This parameter is
    ignored if the <a class='info' href='#promptandcollect.grammar'>grammar<span> (</span><span class='info'>grammar</span><span>)</span></a> parameter is specified. </td>
</tr>
<tr>
<td align="left">Direction</td>
<td align="left">input</td>
</tr>
<tr>
<td align="left">Type</td>
<td align="left">
              <a class='info' href='#defn.posinteger'>Positive Integer<span> (</span><span class='info'>Positive Integer</span><span>)</span></a>
            </td>
</tr>
<tr>
<td align="left">Optional</td>
<td align="left">Yes</td>
</tr>
<tr>
<td align="left">Possible Values</td>
<td align="left">A valid positive integer value. </td>
</tr>
<tr>
<td align="left">Default</td>
<td align="left">5</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 16: maxdigits&nbsp;</b></font><br /></td></tr></table><hr class="insert" />
<br /><hr class="insert" />
<a name="promptandcollect.grammar"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left" width="15%"><col align="left" width="85%">
<tr><th align="left">Name</th><th align="left">grammar</th></tr>
<tr>
<td align="left">Description</td>
<td align="left">A URI reference to a custom DTMF grammar. If this
    parameter is specified, then the referenced DTMF grammar is used
    instead of the internal digits grammar (i.e. <a class='info' href='#promptandcollect.maxdigits'>maxdigits<span> (</span><span class='info'>maxdigits</span><span>)</span></a> and <a class='info' href='#promptandcollect.termchar'>termchar<span> (</span><span class='info'>termchar</span><span>)</span></a> are ignored even if
    specified). Custom grammars permit the full range of DTMF characters
    including '*' and '#' to be specified for DTMF pattern
    matching. </td>
</tr>
<tr>
<td align="left">Direction</td>
<td align="left">input</td>
</tr>
<tr>
<td align="left">Type</td>
<td align="left">
              <a class='info' href='#defn.uri'>URI<span> (</span><span class='info'>URI</span><span>)</span></a>
            </td>
</tr>
<tr>
<td align="left">Optional</td>
<td align="left">Yes</td>
</tr>
<tr>
<td align="left">Possible Values</td>
<td align="left">A valid URI value referencing a
    valid custom DTMF grammar. </td>
</tr>
<tr>
<td align="left">Default</td>
<td align="left">none</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 17: grammar&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p> [Editors note: The format of the custom DTMF grammar is not yet
    defined. Possibilities include: <a class='info' href='#SRGS'>[SRGS]<span> (</span><span class='info'>Hunt, A. and S. McGlashan, &ldquo;Speech Recognition Grammar Specification Version         1.0,&rdquo; March&nbsp;2004.</span><span>)</span></a>, <a class='info' href='#H.248.1'>[H.248.1]<span> (</span><span class='info'>, &ldquo;Gateway control protocol: Version 3,&rdquo; .</span><span>)</span></a>, and <a class='info' href='#KPML'>[KPML]<span> (</span><span class='info'>Burger, E. and M. Dolly, &ldquo;A Session Initiation Protocol (SIP) Event Package for  Key Press                             Stimulus (KPML),&rdquo; July&nbsp;2006.</span><span>)</span></a>. If more than one
    format is permitted, then an additional input parameter
    "grammartype" would indicate the format used in the grammar
    parameter.]
</p><br /><hr class="insert" />
<a name="promptandcollect.status"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left" width="15%"><col align="left" width="85%">
<tr><th align="left">Name</th><th align="left">status</th></tr>
<tr>
<td align="left">Description</td>
<td align="left">A status code indicating success or failure of the
    promptandcollect dialog</td>
</tr>
<tr>
<td align="left">Direction</td>
<td align="left">output</td>
</tr>
<tr>
<td align="left">Type</td>
<td align="left">
              <a class='info' href='#defn.nonneginteger'>Non-Negative Integer<span> (</span><span class='info'>Non-Negative Integer</span><span>)</span></a>
            </td>
</tr>
<tr>
<td align="left">Optional</td>
<td align="left">No</td>
</tr>
<tr>
<td align="left">Possible Values</td>
<td align="left">1 for success; otherwise an error code (600, 601, 603). 
               See <a class='info' href='#allstatuscodes'>Table&nbsp;30<span> (</span><span class='info'>status codes                 for all templates dialogs</span><span>)</span></a>
            </td>
</tr>
<tr>
<td align="left">Default</td>
<td align="left">none</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 18: status&nbsp;</b></font><br /></td></tr></table><hr class="insert" />
<br /><hr class="insert" />
<a name="promptandcollect.reason"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left" width="15%"><col align="left" width="85%">
<tr><th align="left">Name</th><th align="left">reason</th></tr>
<tr>
<td align="left">Description</td>
<td align="left">A textual description providing a reason
            for the status code; e.g. details on an error</td>
</tr>
<tr>
<td align="left">Direction</td>
<td align="left">output</td>
</tr>
<tr>
<td align="left">Type</td>
<td align="left"><a class='info' href='#defn.string'>String<span> (</span><span class='info'>String</span><span>)</span></a></td>
</tr>
<tr>
<td align="left">Optional</td>
<td align="left">Yes</td>
</tr>
<tr>
<td align="left">Possible Values</td>
<td align="left">A valid String value</td>
</tr>
<tr>
<td align="left">Default</td>
<td align="left">Empty string</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 19: reason&nbsp;</b></font><br /></td></tr></table><hr class="insert" />
<br /><hr class="insert" />
<a name="promptandcollect.result"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left" width="15%"><col align="left" width="85%">
<tr><th align="left">Name</th><th align="left">result</th></tr>
<tr>
<td align="left">Description</td>
<td align="left"> The DTMF input collected from the user. </td>
</tr>
<tr>
<td align="left">Direction</td>
<td align="left">output</td>
</tr>
<tr>
<td align="left">Type</td>
<td align="left"><a class='info' href='#defn.dtmfstring'>DTMFString<span> (</span><span class='info'>DTMFString</span><span>)</span></a></td>
</tr>
<tr>
<td align="left">Optional</td>
<td align="left">The parameter is mandatory if status is 1;
            otherwise, optional.</td>
</tr>
<tr>
<td align="left">Possible Values</td>
<td align="left">A valid DTMFString (no spaces between characters).
</td>
</tr>
<tr>
<td align="left">Default</td>
<td align="left">Empty String</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 20: result&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>In addition to the prompt extensions described in <a class='info' href='#playannouncement.extensions'>Table&nbsp;7<span> (</span><span class='info'>Additional playannouncement parameters</span><span>)</span></a>, the following parameters are
    under consideration for later versions:
</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left" width="15%"><col align="left" width="85%">
<tr><th align="left">Name</th><th align="left">Description</th></tr>
<tr>
<td align="left">nomatchprompts</td>
<td align="left">prompts to play when input doesn't match
        the DTMF grammar</td>
</tr>
<tr>
<td align="left">noinputprompts</td>
<td align="left">prompts to play when there is no user
        input</td>
</tr>
<tr>
<td align="left">successprompts</td>
<td align="left">prompts to play when user input is
        collected</td>
</tr>
<tr>
<td align="left">failureprompts</td>
<td align="left">prompts to play when no valid user
        input has been collected after all iterations tried</td>
</tr>
<tr>
<td align="left">escapechar</td>
<td align="left">character which causes the dialog to
        restart without incrementing the iterations counter</td>
</tr>
<tr>
<td align="left">iterationcount</td>
<td align="left">number of iterations
    (output)</td>
</tr>
<tr>
<td align="left">promptplayedamount</td>
<td align="left">duration of initial prompts played if
    prompt interrupted (output)</td>
</tr>
</table>
<br clear="all" />

<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3"></a><h3>5.3.&nbsp;
Prompt and Record</h3>

<p>A template dialog to prompt the user and record their audio
        input.
</p>
<p>The dialog is invoked with the URI "promptandrecord". 
</p>
<p>The dialog execution model consists of:

            </p>
<ol class="text">
<li>Playing <a class='info' href='#promptandrecord.prompts'>prompts<span> (</span><span class='info'>prompts</span><span>)</span></a> in the order
                specified until completion.  
</li>
<li>Recording audio input from the user. Recording is
                initiated if user input is received before <a class='info' href='#promptandrecord.timeout'>timeout<span> (</span><span class='info'>timeout</span><span>)</span></a>
                expires.  The recording is terminated by DTMF input,
                the maximum duration being exceeded or a final silence
                after recording, as specified in <a class='info' href='#promptandrecord.dtmfterm'>dtmfterm<span> (</span><span class='info'>dtmfterm</span><span>)</span></a>, <a class='info' href='#promptandrecord.maxtime'>maxtime<span> (</span><span class='info'>maxtime</span><span>)</span></a> and <a class='info' href='#promptandrecord.finalsilence'>finalsilence<span> (</span><span class='info'>finalsilence</span><span>)</span></a>
                parameters respectively.
                        
</li>
<li>If recording is not initiated, steps 1 - 2 are
                    repeated for the value of <a class='info' href='#promptandrecord.iterations'>iterations<span> (</span><span class='info'>iterations</span><span>)</span></a>.  
</li>
<li>Returning <a class='info' href='#promptandrecord.status'>status<span> (</span><span class='info'>status</span><span>)</span></a>,
                    <a class='info' href='#promptandrecord.reason'>reason<span> (</span><span class='info'>reason</span><span>)</span></a> and
                    <a class='info' href='#promptandrecord.result'>result<span> (</span><span class='info'>result</span><span>)</span></a> 
                    parameters.
                    
</li>
</ol><p>

        
</p>
<p>The input and output parameter are summarized and defined
        below. 
</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left" width="15%"><col align="left" width="15%"><col align="left" width="60%"><col align="left" width="10%">
<tr><th align="left">Name</th><th align="left">Direction</th><th align="left">Description</th><th align="left">Definition</th></tr>
<tr>
<td align="left">prompts</td>
<td align="left">input</td>
<td align="left">prompts to play</td>
<td align="left">
              <a class='info' href='#promptandrecord.prompts'>Table&nbsp;21<span> (</span><span class='info'>prompts</span><span>)</span></a>
            </td>
</tr>
<tr>
<td align="left">iterations</td>
<td align="left">input</td>
<td align="left">maximum attempts</td>
<td align="left">
              <a class='info' href='#promptandrecord.iterations'>Table&nbsp;22<span> (</span><span class='info'>iterations</span><span>)</span></a>
            </td>
</tr>
<tr>
<td align="left">timeout</td>
<td align="left">input</td>
<td align="left">timeout to wait for input </td>
<td align="left">
              <a class='info' href='#promptandrecord.timeout'>Table&nbsp;23<span> (</span><span class='info'>timeout</span><span>)</span></a>
            </td>
</tr>
<tr>
<td align="left">dtmf</td>
<td align="left">input</td>
<td align="left">recording terminated by DTMF </td>
<td align="left">
              <a class='info' href='#promptandrecord.dtmfterm'>Table&nbsp;24<span> (</span><span class='info'>dtmfterm</span><span>)</span></a>
            </td>
</tr>
<tr>
<td align="left">maxtime</td>
<td align="left">input</td>
<td align="left">maximum duration of recording </td>
<td align="left">
              <a class='info' href='#promptandrecord.maxtime'>Table&nbsp;25<span> (</span><span class='info'>maxtime</span><span>)</span></a>
            </td>
</tr>
<tr>
<td align="left">finalsilence</td>
<td align="left">input</td>
<td align="left">final silence to terminate recording </td>
<td align="left">
              <a class='info' href='#promptandrecord.finalsilence'>Table&nbsp;26<span> (</span><span class='info'>finalsilence</span><span>)</span></a>
            </td>
</tr>
<tr>
<td align="left">status</td>
<td align="left">output</td>
<td align="left">status code</td>
<td align="left">
              <a class='info' href='#promptandrecord.status'>Table&nbsp;27<span> (</span><span class='info'>status</span><span>)</span></a>
            </td>
</tr>
<tr>
<td align="left">reason</td>
<td align="left">output</td>
<td align="left">reason for status</td>
<td align="left">
              <a class='info' href='#promptandrecord.reason'>Table&nbsp;28<span> (</span><span class='info'>reason</span><span>)</span></a>
            </td>
</tr>
<tr>
<td align="left">result</td>
<td align="left">output</td>
<td align="left">URI for recording</td>
<td align="left">
              <a class='info' href='#promptandrecord.result'>Table&nbsp;29<span> (</span><span class='info'>result</span><span>)</span></a>
            </td>
</tr>
</table>
<br clear="all" />
<br /><hr class="insert" />
<a name="promptandrecord.prompts"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left" width="15%"><col align="left" width="85%">
<tr><th align="left">Name</th><th align="left">prompts</th></tr>
<tr>
<td align="left">Description</td>
<td align="left">Initial prompts to play</td>
</tr>
<tr>
<td align="left">Direction</td>
<td align="left">input</td>
</tr>
<tr>
<td align="left">Type</td>
<td align="left">
              <a class='info' href='#defn.urilist'>URIList<span> (</span><span class='info'>URIList</span><span>)</span></a>
            </td>
</tr>
<tr>
<td align="left">Optional</td>
<td align="left">Yes</td>
</tr>
<tr>
<td align="left">Possible Values</td>
<td align="left">A valid URIList</td>
</tr>
<tr>
<td align="left">Default</td>
<td align="left">none</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 21: prompts&nbsp;</b></font><br /></td></tr></table><hr class="insert" />
<br /><hr class="insert" />
<a name="promptandrecord.iterations"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left" width="15%"><col align="left" width="85%">
<tr><th align="left">Name</th><th align="left">iterations</th></tr>
<tr>
<td align="left">Description</td>
<td align="left">Maximum number of times the
            promptandrecord dialog is to be played</td>
</tr>
<tr>
<td align="left">Direction</td>
<td align="left">input</td>
</tr>
<tr>
<td align="left">Type</td>
<td align="left">
              <a class='info' href='#defn.nonneginteger'>Non-Negative Integer<span> (</span><span class='info'>Non-Negative Integer</span><span>)</span></a>
            </td>
</tr>
<tr>
<td align="left">Optional</td>
<td align="left">Yes</td>
</tr>
<tr>
<td align="left">Possible Values</td>
<td align="left">A valid non-negative integer. A value of 0
            indicates that the dialog is repeated
            until halted by other means.</td>
</tr>
<tr>
<td align="left">Default</td>
<td align="left">0</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 22: iterations&nbsp;</b></font><br /></td></tr></table><hr class="insert" />
<br /><hr class="insert" />
<a name="promptandrecord.timeout"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left" width="15%"><col align="left" width="85%">
<tr><th align="left">Name</th><th align="left">timeout</th></tr>
<tr>
<td align="left">Description</td>
<td align="left">Indicates the time to wait for user input.
        </td>
</tr>
<tr>
<td align="left">Direction</td>
<td align="left">input</td>
</tr>
<tr>
<td align="left">Type</td>
<td align="left">
              <a class='info' href='#defn.timedesignation'>Time Designation<span> (</span><span class='info'>Time Designation</span><span>)</span></a>
            </td>
</tr>
<tr>
<td align="left">Optional</td>
<td align="left">Yes</td>
</tr>
<tr>
<td align="left">Possible Values</td>
<td align="left">A valid TimeDesignation value. </td>
</tr>
<tr>
<td align="left">Default</td>
<td align="left">5s</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 23: timeout&nbsp;</b></font><br /></td></tr></table><hr class="insert" />
<br /><hr class="insert" />
<a name="promptandrecord.dtmfterm"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left" width="15%"><col align="left" width="85%">
<tr><th align="left">Name</th><th align="left">dtmfterm</th></tr>
<tr>
<td align="left">Description</td>
<td align="left">Indicates whether recording can be
    terminated by DTMF input
        </td>
</tr>
<tr>
<td align="left">Direction</td>
<td align="left">input</td>
</tr>
<tr>
<td align="left">Type</td>
<td align="left">
              <a class='info' href='#defn.boolean'>Boolean<span> (</span><span class='info'>Boolean</span><span>)</span></a>
            </td>
</tr>
<tr>
<td align="left">Optional</td>
<td align="left">Yes</td>
</tr>
<tr>
<td align="left">Possible Values</td>
<td align="left">A valid Boolean value. A value of
    true indicates that recording can be terminated by DTMF. A value of
    false indicates that recording cannot be terminated by DTMF.</td>
</tr>
<tr>
<td align="left">Default</td>
<td align="left">true</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 24: dtmfterm&nbsp;</b></font><br /></td></tr></table><hr class="insert" />
<br /><hr class="insert" />
<a name="promptandrecord.maxtime"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left" width="15%"><col align="left" width="85%">
<tr><th align="left">Name</th><th align="left">maxtime</th></tr>
<tr>
<td align="left">Description</td>
<td align="left">The maximum duration of the recording
        </td>
</tr>
<tr>
<td align="left">Direction</td>
<td align="left">input</td>
</tr>
<tr>
<td align="left">Type</td>
<td align="left">
              <a class='info' href='#defn.timedesignation'>Time Designation<span> (</span><span class='info'>Time Designation</span><span>)</span></a>
            </td>
</tr>
<tr>
<td align="left">Optional</td>
<td align="left">Yes</td>
</tr>
<tr>
<td align="left">Possible Values</td>
<td align="left">A valid TimeDesignation value. </td>
</tr>
<tr>
<td align="left">Default</td>
<td align="left">15s</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 25: maxtime&nbsp;</b></font><br /></td></tr></table><hr class="insert" />
<br /><hr class="insert" />
<a name="promptandrecord.finalsilence"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left" width="15%"><col align="left" width="85%">
<tr><th align="left">Name</th><th align="left">finalsilence</th></tr>
<tr>
<td align="left">Description</td>
<td align="left">The interval of silence that indicates
            end of speech
        </td>
</tr>
<tr>
<td align="left">Direction</td>
<td align="left">input</td>
</tr>
<tr>
<td align="left">Type</td>
<td align="left">
              <a class='info' href='#defn.timedesignation'>Time Designation<span> (</span><span class='info'>Time Designation</span><span>)</span></a>
            </td>
</tr>
<tr>
<td align="left">Optional</td>
<td align="left">Yes</td>
</tr>
<tr>
<td align="left">Possible Values</td>
<td align="left">A valid TimeDesignation value. </td>
</tr>
<tr>
<td align="left">Default</td>
<td align="left">5s</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 26: finalsilence&nbsp;</b></font><br /></td></tr></table><hr class="insert" />
<br /><hr class="insert" />
<a name="promptandrecord.status"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left" width="15%"><col align="left" width="85%">
<tr><th align="left">Name</th><th align="left">status</th></tr>
<tr>
<td align="left">Description</td>
<td align="left">A status code indicating success or failure of the
    promptandrecord dialog</td>
</tr>
<tr>
<td align="left">Direction</td>
<td align="left">output</td>
</tr>
<tr>
<td align="left">Type</td>
<td align="left">
              <a class='info' href='#defn.nonneginteger'>Non-Negative Integer<span> (</span><span class='info'>Non-Negative Integer</span><span>)</span></a>
            </td>
</tr>
<tr>
<td align="left">Optional</td>
<td align="left">No</td>
</tr>
<tr>
<td align="left">Possible Values</td>
<td align="left">1 for success; otherwise an error code (600, 601, 603). 
               See <a class='info' href='#allstatuscodes'>Table&nbsp;30<span> (</span><span class='info'>status codes                 for all templates dialogs</span><span>)</span></a>
                </td>
</tr>
<tr>
<td align="left">Default</td>
<td align="left">none</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 27: status&nbsp;</b></font><br /></td></tr></table><hr class="insert" />
<br /><hr class="insert" />
<a name="promptandrecord.reason"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left" width="15%"><col align="left" width="85%">
<tr><th align="left">Name</th><th align="left">reason</th></tr>
<tr>
<td align="left">Description</td>
<td align="left">A textual description providing a reason
        for the status code; e.g. details on an error</td>
</tr>
<tr>
<td align="left">Direction</td>
<td align="left">output</td>
</tr>
<tr>
<td align="left">Type</td>
<td align="left"><a class='info' href='#defn.string'>String<span> (</span><span class='info'>String</span><span>)</span></a></td>
</tr>
<tr>
<td align="left">Optional</td>
<td align="left">Yes</td>
</tr>
<tr>
<td align="left">Possible Values</td>
<td align="left">A valid String value</td>
</tr>
<tr>
<td align="left">Default</td>
<td align="left">Empty string</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 28: reason&nbsp;</b></font><br /></td></tr></table><hr class="insert" />
<br /><hr class="insert" />
<a name="promptandrecord.result"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left" width="15%"><col align="left" width="85%">
<tr><th align="left">Name</th><th align="left">result</th></tr>
<tr>
<td align="left">Description</td>
<td align="left">A URI referencing the media recording</td>
</tr>
<tr>
<td align="left">Direction</td>
<td align="left">output</td>
</tr>
<tr>
<td align="left">Type</td>
<td align="left">
              <a class='info' href='#defn.uri'>URI<span> (</span><span class='info'>URI</span><span>)</span></a>
            </td>
</tr>
<tr>
<td align="left">Optional</td>
<td align="left">The parameter is mandatory if status is 1;
            otherwise, optional.</td>
</tr>
<tr>
<td align="left">Possible Values</td>
<td align="left">A valid URI value</td>
</tr>
<tr>
<td align="left">Default</td>
<td align="left">Empty string</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 29: result&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>In addition to the prompt extensions described in <a class='info' href='#playannouncement.extensions'>Table&nbsp;7<span> (</span><span class='info'>Additional playannouncement parameters</span><span>)</span></a>, 
the following additional parameters are under consideration for a later version.

</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left" width="15%"><col align="left" width="85%">
<tr><th align="left">Name</th><th align="left">Description</th></tr>
<tr>
<td align="left">destination</td>
<td align="left">URI to send recording using HTTP</td>
</tr>
<tr>
<td align="left">mimetype</td>
<td align="left">mimetype to use for recording (including media and file formats)  </td>
</tr>
<tr>
<td align="left">beep</td>
<td align="left">indicates whether a platform-specific beep is
    used immediately prior to recording </td>
</tr>
<tr>
<td align="left">noinputprompts</td>
<td align="left">prompts to play when there is no user
        input</td>
</tr>
<tr>
<td align="left">successprompts</td>
<td align="left">prompts to play when recording is
        successful</td>
</tr>
<tr>
<td align="left">failureprompts</td>
<td align="left">prompts to play when no recording 
        has been made after all the iterations tried</td>
</tr>
<tr>
<td align="left">duration</td>
<td align="left">duration of the recording
    (output)</td>
</tr>
<tr>
<td align="left">mimetype</td>
<td align="left">mimetype of the recording
    (output)</td>
</tr>
<tr>
<td align="left">iterationcount</td>
<td align="left">number of iterations
    (output)</td>
</tr>
<tr>
<td align="left">terminationmode</td>
<td align="left">indication of why recording
        terminated: e.g. dtmf, maxtime reached, externalevent or finalsilence
        detected (output)
</td>
</tr>
<tr>
<td align="left">promptplayedamount</td>
<td align="left">duration of initial prompts played if
    prompt interrupted (output)</td>
</tr>
</table>
<br clear="all" />

<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.4"></a><h3>5.4.&nbsp;
Status Codes</h3>

<p>The following table describes the codes returned in the status output
    parameter for template dialogs.
</p><br /><hr class="insert" />
<a name="allstatuscodes"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left" width="15%"><col align="left" width="85%">
<tr><th align="left">status</th><th align="left">description</th></tr>
<tr>
<td align="left">0</td>
<td align="left">dialog terminated externally</td>
</tr>
<tr>
<td align="left">1</td>
<td align="left">success</td>
</tr>
<tr>
<td align="left">600</td>
<td align="left">unspecified error</td>
</tr>
<tr>
<td align="left">601</td>
<td align="left">invalid input parameter</td>
</tr>
<tr>
<td align="left">602</td>
<td align="left">no prompts defined (only playannouncement) </td>
</tr>
<tr>
<td align="left">603</td>
<td align="left">maximum iterations reached without valid input (not playannouncement)</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 30: status codes
                for all templates dialogs&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.5"></a><h3>5.5.&nbsp;
Type Definitions</h3>

<p>This section defines types referenced in template parameters. 
</p>
<a name="defn.boolean"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.5.1"></a><h3>5.5.1.&nbsp;
Boolean</h3>

<p>The value space of boolean is the set {true, false}. 
</p>
<a name="defn.dtmfchar"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.5.2"></a><h3>5.5.2.&nbsp;
DTMFChar</h3>

<p>A DTMF character. The value space is the set
            {0, 1, 2, 3, 4, 5, 6, 7, 8, 9, #, *, A, B, C, D}. 
        
</p>
<a name="defn.dtmfstring"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.5.3"></a><h3>5.5.3.&nbsp;
DTMFString</h3>

<p>A String composed of one or more <a class='info' href='#defn.dtmfchar'>DTMFChar<span> (</span><span class='info'>DTMFChar</span><span>)</span></a>s. 
</p>
<a name="defn.nonneginteger"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.5.4"></a><h3>5.5.4.&nbsp;
Non-Negative Integer</h3>

<p>The value space of non-negative integer is the infinite
        set {0,1,2,...}. 
</p>
<a name="defn.posinteger"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.5.5"></a><h3>5.5.5.&nbsp;
Positive Integer</h3>

<p>The value space of positive integer is the infinite
        set {1,2,...}. 
</p>
<a name="defn.string"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.5.6"></a><h3>5.5.6.&nbsp;
String</h3>

<p>A string in the character encoding associated with the XML
        element.
        
</p>
<a name="defn.timedesignation"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.5.7"></a><h3>5.5.7.&nbsp;
Time Designation</h3>

<p>A time designation consists of a non-negative real number
            followed by a time unit identifier. 
</p>
<p>The time unit identifiers are: "ms" (milliseconds) and "s"
            (seconds). 
</p>
<p>Examples include: "3s", "850ms", "0.7s", ".5s" and "+1.5s". 
</p>
<a name="defn.uri"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.5.8"></a><h3>5.5.8.&nbsp;
URI</h3>

<p>Uniform Resource Indicator as defined in <a class='info' href='#RFC2396'>[RFC2396]<span> (</span><span class='info'>Berners-Lee, T., Fielding, R., and L. Masinter, &ldquo;Uniform Resource Identifiers (URI): Generic Syntax,&rdquo; August&nbsp;1998.</span><span>)</span></a>. 
        
</p>
<a name="defn.urilist"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.5.9"></a><h3>5.5.9.&nbsp;
URIList</h3>

<p>A list of <a class='info' href='#defn.uri'>URI<span> (</span><span class='info'>URI</span><span>)</span></a>s. 
</p>
<a name="examples.protocol"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
AS-MS Interaction Examples</h3>

<p>The following example assume a control channel has been established
    as described in the SIP Control Framework <a class='info' href='#SIPCF'>[SIPCF]<span> (</span><span class='info'>Boulton, C., Melanchuk, T., McGlashan, S., and A. Shiratzky, &ldquo;A Control Framework for the Session Initiation         Protocol (SIP),&rdquo; October&nbsp;2006.</span><span>)</span></a>.
    
</p>
<p>The XML messages are in angled brackets; the REPORT status is
    in round brackets. Other aspects of the protocol are omitted for
    readability.

</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
Starting an IVR dialog</h3>

<p>An IVR dialog is started successfully, and dialogexit notification
    &lt;event> is sent from the MS to the AS when the dialog exits
    normally.  
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

          Application Server (AS)                   Media Server (MS)
             |                                             |
             |       (1) CONTROL: &lt;dialogstart&gt;            |
             |  ----------------------------------------&gt;  |
             |                                             |
             |       (2) 202                               |
             |  &lt;---------------------------------------   |
             |                                             |
             |       (3) REPORT: (pending)                 |
             |  &lt;----------------------------------------  |
             |                                             |
             |       (4) 200                               |
             |  ----------------------------------------&gt;  |
             |                                             |
             |       (5) REPORT: &lt;response status="200"/&gt;  |
             |                   (terminate)               |
             |  &lt;----------------------------------------  |
             |                                             |
             |       (6) 200                               |
             |  ----------------------------------------&gt;  |
             |                                             |
             |       (7) REPORT:&lt;event name="dialogexit"/&gt; |
             |                   (notify)                  |
             |  &lt;----------------------------------------  |
             |                                             |
             |       (8) 200                               |
             |  ----------------------------------------&gt;  |
             |                                             |
</pre></div>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
IVR dialog fails to start</h3>

<p>An IVR dialog fails to start due to an unknown template. 

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

          Application Server (AS)                   Media Server (MS)
             |                                             |
             |       (1) CONTROL: &lt;dialogstart&gt;            |
             |  ----------------------------------------&gt;  |
             |                                             |
             |       (2) 202                               |
             |  &lt;---------------------------------------   |
             |                                             |
             |       (3) REPORT: (pending)                 |
             |  &lt;----------------------------------------  |
             |                                             |
             |       (4) 200                               |
             |  ----------------------------------------&gt;  |
             |                                             |
             |       (5) REPORT: &lt;response status="409"/&gt;  |
             |                   (terminate)               |
             |  &lt;----------------------------------------  |
             |                                             |
             |       (6) 200                               |
             |  ----------------------------------------&gt;  |
             |                                             |
</pre></div>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.3"></a><h3>6.3.&nbsp;
Preparing and starting an IVR dialog</h3>

<p>An IVR dialog is prepared and started successfully, and then the
    dialog exits normally.  
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

          Application Server (AS)                   Media Server (MS)
             |                                             |
             |       (1) CONTROL: &lt;dialogprepare&gt;          |
             |  ----------------------------------------&gt;  |
             |                                             |
             |       (2) 202                               |
             |  &lt;---------------------------------------   |
             |                                             |
             |       (3) REPORT: (pending)                 |
             |  &lt;----------------------------------------  |
             |                                             |
             |       (4) 200                               |
             |  ----------------------------------------&gt;  |
             |                                             |
             |       (5) REPORT: &lt;response status="200"/&gt;  |
             |                   (terminate)               |
             |  &lt;----------------------------------------  |
             |                                             |
             |       (6) 200                               |
             |  ----------------------------------------&gt;  |
             |                                             |
             |       (7) CONTROL: &lt;dialogstart&gt;            |
             |  ----------------------------------------&gt;  |
             |                                             |
             |       (8) 202                               |
             |  &lt;---------------------------------------   |
             |                                             |
             |       (9) REPORT: (pending)                 |
             |  &lt;----------------------------------------  |
             |                                             |
             |       (10) 200                              |
             |  ---------------------------------------&gt;   |
             |                                             |
             |       (11) REPORT: &lt;response status="200"/&gt; |
             |                   (terminate)               |
             |  &lt;----------------------------------------  |
             |                                             |
             |       (12) 200                              |
             |  ----------------------------------------&gt;  |
             |                                             |
             |       (13) REPORT:&lt;event name="dialogexit"/&gt;|
             |                   (notify)                  |
             |  &lt;----------------------------------------  |
             |                                             |
             |       (14) 200                              |
             |  ----------------------------------------&gt;  |
             |                                             |
</pre></div>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.4"></a><h3>6.4.&nbsp;
Terminating a dialog immediately</h3>

<p>An IVR dialog is started successfully, and then terminated
    immediately by the AS. No dialog notification &lt;event>s are sent
    back to the AS. 
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

          Application Server (AS)                   Media Server (MS)
             |                                             |
             |       (1) CONTROL: &lt;dialogstart&gt;            |
             |  ----------------------------------------&gt;  |
             |                                             |
             |       (2) 202                               |
             |  &lt;---------------------------------------   |
             |                                             |
             |       (3) REPORT: (pending)                 |
             |  &lt;----------------------------------------  |
             |                                             |
             |       (4) 200                               |
             |  ----------------------------------------&gt;  |
             |                                             |
             |       (5) REPORT: &lt;response status="200"/&gt;  |
             |                   (terminate)               |
             |  &lt;----------------------------------------  |
             |                                             |
             |       (6) 200                               |
             |  ----------------------------------------&gt;  |
             |                                             |
             |       (7) CONTROL: &lt;dialogterminate&gt;        |
             |  ----------------------------------------&gt;  |
             |                                             |
             |       (8) 200: &lt;response status="200"/&gt;     |
             |  &lt;----------------------------------------  |
             |                                             |
</pre></div>
<p>Note that in (8) the response to the &lt;dialogterminate/> request is
    carried on a framework 200 response. 

</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.5"></a><h3>6.5.&nbsp;
Terminating a dialog non-immediately</h3>

<p>An IVR dialog is started successfully, and then terminated
    non-immediately by the AS, allowing the MS to send a dialogexit
    notification &lt;event> with information collected during the dialog.
   
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

          Application Server (AS)                   Media Server (MS)
             |                                             |
             |       (1) CONTROL: &lt;dialogstart&gt;            |
             |  ----------------------------------------&gt;  |
             |                                             |
             |       (2) 202                               |
             |  &lt;---------------------------------------   |
             |                                             |
             |       (3) REPORT: (pending)                 |
             |  &lt;----------------------------------------  |
             |                                             |
             |       (4) 200                               |
             |  ----------------------------------------&gt;  |
             |                                             |
             |       (5) REPORT: &lt;response status="200"/&gt;  |
             |                   (terminate)               |
             |  &lt;----------------------------------------  |
             |                                             |
             |       (6) 200                               |
             |  ----------------------------------------&gt;  |
             |                                             |
             |       (7) CONTROL: &lt;dialogterminate&gt;        |
             |  ----------------------------------------&gt;  |
             |                                             |
             |       (8) 200: &lt;response status="200"/&gt;     |
             |  &lt;----------------------------------------  |
             |                                             |
             |       (9) REPORT:&lt;event name="dialogexit"/&gt; |
             |                   (notify)                  |
             |  &lt;----------------------------------------  |
             |                                             |
             |       (10) 200                              |
             |  ----------------------------------------&gt;  |
             |                                             |
</pre></div>
<p>Note that in (8) the response to the &lt;dialogterminate/> request is
    carried on a framework 200 response. 

</p>
<a name="examples.templates"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Template Dialog Examples</h3>

<p>The following examples show how playannouncement, promptandcollect
    and promptandrecord template dialogs are used with
    &lt;dialogprepare>, &lt;dialogstart> and &lt;event>
    elements. 
</p>
<p>The examples do not specify all messages between the AS and MS. 
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.1"></a><h3>7.1.&nbsp;
playannouncement</h3>

<p>This example prepares an announcement composed of two
    prompts. 
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

&lt;dialogprepare src="playannouncement"&gt;
    &lt;data&gt;
       &lt;item name="prompts"
             value="http://www.example.com/media/Number_09.wav
                    http://www.example.com/media/Number_11.wav"/&gt;
       &lt;item name="iterations" value="2"/&gt;
    &lt;/data&gt;
&lt;/dialogprepare&gt;

</pre></div>
<p>If the dialog is prepared successfully, a dialogprepared message is
    returned:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

&lt;response status="200" dialogid="vxi78"/&gt;

</pre></div>
<p>The prepared dialog is then started on a conference playing the
    prompts twice:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

&lt;dialogstart prepareddialogid="vxi78" conf-id="conference11"/&gt;

</pre></div>
<p>In the case of a successful dialog, the output is provided in
    &lt;event&gt;; for example 
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

&lt;event name="dialogexit" dialogid="vxi78"&gt;
    &lt;data&gt;
       &lt;item name="status" value="1"/&gt;
    &lt;/data&gt;
&lt;/event&gt;

</pre></div>
<p>In this example, the dialog is started on a sip dialog connection,
   but no &lt;data&gt; is specified:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

&lt;dialogstart src="playannouncement"
             connection-id="7HDY839~HJKSkyHS~HUwkuh7ns"/&gt;

</pre></div>
<p>and an error message is returned:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

&lt;event name="dialogexit" dialogid="vxi79"&gt;
    &lt;data&gt;
       &lt;item name="status" value="602"/&gt;
       &lt;item name="reason" value="prompts not defined"/&gt;
    &lt;/data&gt;
&lt;/event&gt;

</pre></div>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.2"></a><h3>7.2.&nbsp;
promptandcollect</h3>

<p>This example plays no prompts and just waits for input from the
    user: 
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

&lt;dialogstart src="promptandcollect"
             connection-id="7HDY839~HJKSkyHS~HUwkuh7ns"/&gt;

</pre></div>
<p>If the dialog is successful, then "dialogexit" 
          &lt;event&gt; contains the
            dtmf collected in its result parameter: 
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

&lt;event name="dialogexit" dialogid="vxi80"&gt;
    &lt;data&gt;
       &lt;item name="status" value="1"/&gt;
       &lt;item name="result" value="12345"/&gt;
    &lt;/data&gt;
&lt;/event&gt;

</pre></div>
<p>In this example, a prompt is played and then we wait for 3 hours for
    a two digit sequence:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

&lt;dialogstart src="promptandcollect"
             connection-id="7HDY839~HJKSkyHS~HUwkuh7ns"&gt;
 &lt;data&gt;
  &lt;item name="prompts" value="http://www.example.com/prompt1.wav"/&gt;
  &lt;item name="timeout" value="1080s"/&gt;
  &lt;item name="maxdigits" value="2"/&gt;
  &lt;item name="iterations" value="1"/&gt;
 &lt;/data&gt;
&lt;/dialogstart&gt;

</pre></div>
<p>If no user input is collected within 3 hours, then following would
    be returned:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

&lt;event name="dialogexit" dialogid="vxi81"&gt;
    &lt;data&gt;
       &lt;item name="status" value="603"/&gt;
    &lt;/data&gt;
&lt;/event&gt;

</pre></div>
<p>And finally in this example, one of the input parameters is
    invalid: 
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

&lt;dialogstart src="promptandcollect"
             connection-id="7HDY839~HJKSkyHS~HUwkuh7ns"&gt;
 &lt;data&gt;
   &lt;item name="prompts" value="http://www.example.com/prompt1.wav"/&gt;
   &lt;item name="iterations" value="two"/&gt;
   &lt;item name="cleardigitbuffer" value="true"/&gt;
   &lt;item name="bargein" value="true"/&gt;
   &lt;item name="timeout" value="4s"/&gt;
   &lt;item name="interdigittimeout" value="2s"/&gt;
   &lt;item name="termtimeout" value="0s"/&gt;
   &lt;item name="maxdigits" value="2"/&gt;
 &lt;/data&gt;
&lt;/dialogstart&gt;

</pre></div>
<p>The error is reported in a dialogexit &lt;event&gt;:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

&lt;event name="dialogexit" dialogid="vxi82"&gt;
    &lt;data&gt;
       &lt;item name="status" value="601"/&gt;
       &lt;item name="reason" value="iterations invalid: two"/&gt;
    &lt;/data&gt;
&lt;/event&gt;

</pre></div>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.3"></a><h3>7.3.&nbsp;
promptandrecord</h3>

<p>In this example, the user is prompted, then their input is
    recorded for a maximum of 30 seconds.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

&lt;dialogstart src="promptandrecord"
             connection-id="7HDY839~HJKSkyHS~HUwkuh7ns"&gt;
    &lt;data&gt;
       &lt;item name="prompts"
             value="http://www.example.com/media/sayname.wav
                    http://www.example.com/media/beep.wav"/&gt;
       &lt;item name="dtmfterm" value="false"/&gt;
       &lt;item name="maxtime" value="30s"/&gt;
    &lt;/data&gt;
&lt;/dialogstart&gt;

</pre></div>
<p>If successful, the following is returned in a dialogexit
&lt;event&gt;:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

&lt;event name="dialogexit" dialogid="vxi83"&gt;
 &lt;data&gt;
  &lt;item name="status" value="1"/&gt;
  &lt;item name="result" value="http://www.example.com/recording1.wav"/&gt;
 &lt;/data&gt;
&lt;/event&gt;

</pre></div>
<a name="schema"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Formal Syntax</h3>

<p>[Editors Note: A later version of the XML schema will provide
    more constraints as expressed in the textual definitions; for
    example, single occurrence of &lt;data> elements, co-occurence
    on attributes, etc.]
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;xsd:schema targetNamespace="urn:ietf:params:xml:ns:msc-ivr-basic"
xmlns:fw="urn:ietf:params:xml:ns:control:framework-attributes"
elementFormDefault="qualified"
xmlns="urn:ietf:params:xml:ns:msc-ivr-basic"
xmlns:xsd="http://www.w3.org/2001/XMLSchema"&gt;

 &lt;xsd:annotation&gt;
  &lt;xsd:documentation&gt;Basic IVR 1.0 schema (20061019)&lt;/xsd:documentation&gt;
 &lt;/xsd:annotation&gt;

   &lt;xsd:import
    namespace="urn:ietf:params:xml:ns:control:framework-attributes"
   schemaLocation="framework.xsd"/&gt;

 &lt;xsd:element name="dialogprepare"&gt;
  &lt;xsd:complexType&gt;
   &lt;xsd:choice minOccurs="0" maxOccurs="unbounded"&gt;
    &lt;xsd:element ref="data"/&gt;
    &lt;xsd:element ref="subscribe"/&gt;
    &lt;xsd:any namespace="##other" processContents="strict"/&gt;
   &lt;/xsd:choice&gt;
   &lt;xsd:attribute name="src" type="URI.datatype" use="required"/&gt;
   &lt;xsd:attribute name="dialogid" type="dialogid.datatype"/&gt;
   &lt;xsd:anyAttribute namespace="##other" processContents="strict"/&gt;
  &lt;/xsd:complexType&gt;

 &lt;/xsd:element&gt;

 &lt;xsd:element name="dialogstart"&gt;
  &lt;xsd:complexType&gt;
   &lt;xsd:choice minOccurs="0" maxOccurs="unbounded"&gt;
    &lt;xsd:element ref="stream"/&gt;
    &lt;xsd:element ref="data"/&gt;
    &lt;xsd:element ref="subscribe"/&gt;
    &lt;xsd:any namespace="##other" processContents="strict"/&gt;
   &lt;/xsd:choice&gt;
   &lt;xsd:attribute name="src" type="URI.datatype"/&gt;
   &lt;xsd:attribute name="dialogid" type="dialogid.datatype"/&gt;
   &lt;xsd:attribute name="prepareddialogid" type="dialogid.datatype"/&gt;
   &lt;xsd:attributeGroup ref="fw:framework-attributes"/&gt;
   &lt;xsd:anyAttribute namespace="##other" processContents="strict"/&gt;
  &lt;/xsd:complexType&gt;
 &lt;/xsd:element&gt;

 &lt;xsd:element name="dialogterminate"&gt;
  &lt;xsd:complexType&gt;
   &lt;xsd:choice minOccurs="0" maxOccurs="unbounded"&gt;
    &lt;xsd:any namespace="##other" processContents="strict"/&gt;
   &lt;/xsd:choice&gt;
   &lt;xsd:attribute name="dialogid" type="dialogid.datatype"
       use="required"/&gt;
   &lt;xsd:attribute name="immediate" type="boolean.datatype"
       default="false"/&gt;
   &lt;xsd:anyAttribute namespace="##other" processContents="strict"/&gt;
  &lt;/xsd:complexType&gt;
 &lt;/xsd:element&gt;


 &lt;xsd:element name="response"&gt;
  &lt;xsd:complexType&gt;
   &lt;xsd:choice minOccurs="0" maxOccurs="unbounded"&gt;
    &lt;xsd:any namespace="##other" processContents="strict"/&gt;
   &lt;/xsd:choice&gt;
   &lt;xsd:attribute name="status" type="status.datatype"
       use="required"/&gt;
   &lt;xsd:attribute name="reason" type="xsd:string"/&gt;
   &lt;xsd:attribute name="dialogid" type="dialogid.datatype"/&gt;
   &lt;xsd:attributeGroup ref="fw:framework-attributes"/&gt;
   &lt;xsd:anyAttribute namespace="##other" processContents="strict"/&gt;
  &lt;/xsd:complexType&gt;
 &lt;/xsd:element&gt;


 &lt;xsd:element name="event"&gt;
  &lt;xsd:complexType&gt;
   &lt;xsd:choice minOccurs="0" maxOccurs="unbounded"&gt;
    &lt;xsd:element ref="data"/&gt;
    &lt;xsd:any namespace="##other" processContents="strict"/&gt;
   &lt;/xsd:choice&gt;
   &lt;xsd:attribute name="name" type="eventname.datatype"
       use="required"/&gt;
   &lt;xsd:attribute name="dialogid" type="dialogid.datatype"
       use="required"/&gt;
   &lt;xsd:anyAttribute namespace="##other" processContents="strict"/&gt;
  &lt;/xsd:complexType&gt;
 &lt;/xsd:element&gt;



 &lt;!-- DATATYPES --&gt;

    &lt;xsd:simpleType name="URI.datatype"&gt;
        &lt;xsd:restriction base="xsd:anyURI"/&gt;
    &lt;/xsd:simpleType&gt;

    &lt;xsd:simpleType name="dialogid.datatype"&gt;
        &lt;xsd:restriction base="xsd:string"/&gt;
    &lt;/xsd:simpleType&gt;

 &lt;xsd:simpleType name="boolean.datatype"&gt;
  &lt;xsd:restriction base="xsd:NMTOKEN"&gt;
   &lt;xsd:enumeration value="true"/&gt;
   &lt;xsd:enumeration value="false"/&gt;
  &lt;/xsd:restriction&gt;
 &lt;/xsd:simpleType&gt;


 &lt;xsd:simpleType name="eventname.datatype"&gt;
  &lt;xsd:restriction base="xsd:NMTOKEN"&gt;
   &lt;xsd:pattern value="[a-zA-Z0-9\.]+"/&gt;
  &lt;/xsd:restriction&gt;
 &lt;/xsd:simpleType&gt;

 &lt;xsd:simpleType name="status.datatype"&gt;
  &lt;xsd:restriction base="xsd:NMTOKEN"&gt;
   &lt;xsd:pattern value="[0-9][0-9][0-9]"/&gt;
  &lt;/xsd:restriction&gt;
 &lt;/xsd:simpleType&gt;

 &lt;xsd:simpleType name="media.datatype"&gt;
    &lt;xsd:restriction base="xsd:string"/&gt;
 &lt;/xsd:simpleType&gt;

 &lt;xsd:simpleType name="label.datatype"&gt;
    &lt;xsd:restriction base="xsd:string"/&gt;
 &lt;/xsd:simpleType&gt;

 &lt;xsd:simpleType name="direction.datatype"&gt;
  &lt;xsd:restriction base="xsd:NMTOKEN"&gt;
   &lt;xsd:enumeration value="sendrecv"/&gt;
   &lt;xsd:enumeration value="sendonly"/&gt;
   &lt;xsd:enumeration value="recvonly"/&gt;
  &lt;/xsd:restriction&gt;
 &lt;/xsd:simpleType&gt;


 &lt;!-- SHARED ELEMENTS --&gt;

 &lt;xsd:element name="data"&gt;
  &lt;xsd:complexType&gt;
   &lt;xsd:choice minOccurs="0" maxOccurs="unbounded"&gt;
    &lt;xsd:element ref="item"/&gt;
    &lt;xsd:any namespace="##other" processContents="strict"/&gt;
   &lt;/xsd:choice&gt;
   &lt;xsd:anyAttribute namespace="##other" processContents="strict"/&gt;
  &lt;/xsd:complexType&gt;
 &lt;/xsd:element&gt;

 &lt;xsd:element name="item"&gt;
  &lt;xsd:complexType&gt;
   &lt;xsd:attribute name="name" type="xsd:string"
       use="required"/&gt;
   &lt;xsd:attribute name="value" type="xsd:string"
       use="required"/&gt;
   &lt;xsd:anyAttribute namespace="##other" processContents="strict"/&gt;
  &lt;/xsd:complexType&gt;
 &lt;/xsd:element&gt;


 &lt;xsd:element name="stream"&gt;
  &lt;xsd:complexType&gt;
   &lt;xsd:choice minOccurs="0" maxOccurs="unbounded"&gt;
    &lt;xsd:any namespace="##other" processContents="strict"/&gt;
   &lt;/xsd:choice&gt;
   &lt;xsd:attribute name="media" type="media.datatype"
       use="required"/&gt;
   &lt;xsd:attribute name="label" type="label.datatype"/&gt;
   &lt;xsd:attribute name="direction" type="direction.datatype"
                  default="sendrecv" /&gt;
   &lt;xsd:anyAttribute namespace="##other" processContents="strict"/&gt;
  &lt;/xsd:complexType&gt;
 &lt;/xsd:element&gt;


 &lt;xsd:element name="subscribe"&gt;
  &lt;xsd:complexType&gt;
   &lt;xsd:choice minOccurs="0" maxOccurs="unbounded"&gt;
    &lt;xsd:element ref="notify"/&gt;
   &lt;/xsd:choice&gt;
   &lt;xsd:anyAttribute namespace="##other" processContents="strict"/&gt;
  &lt;/xsd:complexType&gt;
 &lt;/xsd:element&gt;

 &lt;xsd:element name="notify"&gt;
  &lt;xsd:complexType&gt;
   &lt;xsd:choice minOccurs="0" maxOccurs="1"&gt;
    &lt;xsd:element ref="data"/&gt;
   &lt;/xsd:choice&gt;
   &lt;xsd:attribute name="name" type="xsd:string" use="required"/&gt;
   &lt;xsd:anyAttribute namespace="##other" processContents="strict"/&gt;
  &lt;/xsd:complexType&gt;
 &lt;/xsd:element&gt;

&lt;/xsd:schema&gt;


</pre></div>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Security Considerations</h3>

<p>Security Considerations to be included in later versions of this document.
</p>
<a name="sec:IANA_Considerations"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
IANA Considerations</h3>

<p>This document registers a new SIP Control Framework Package and a new
XML namespace.
</p>
<a name="sec:Control_Package_Reg"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.1"></a><h3>10.1.&nbsp;
Control Package Registration</h3>

<p>Control Package name: msc-ivr-basic/1.0
</p>
<a name="sec:URN_Reg"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.2"></a><h3>10.2.&nbsp;
URN Sub-Namespace Registration</h3>

<p>XML namespace: urn:ietf:params:xml:ns:msc-ivr-basic
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
Change Summary</h3>

<p> The following are the major changes between the -02 of the draft and the
-01 version.

</p>
<ul class="text">
<li>added version 1.0 to package name 
</li>
<li>separate section for element definitions
</li>
<li>dialogterminate treated as request rather than notification
</li>
<li>simplified responses: single element &lt;response> 
</li>
<li>removed response elements: &lt;dialogprepared>, &lt;dialogstarted>,
       &lt;errordialognotprepared>,  &lt;errordialognotstarted> 
</li>
<li>simplified event notifications to single &lt;event> element
    carried in a REPORT  
</li>
<li>&lt;dialogexit> element replaced with &lt;event name="dialogexit">
</li>
<li>removed &lt;dialoguser> element 
</li>
<li>added &lt;stream> element as child of &lt;dialogstart>
</li>
<li>removed 'type' attribute from &lt;dialogprepare> and &lt;dialogstart>
</li>
<li>added dialogid attribute to &lt;dialogprepare> and
    &lt;dialogstart>
</li>
<li>removed template "Sample Implementation" section
</li>
<li>renamed &lt;namelist> to &lt;data> 
</li>
<li>re-organized so that template details after general package
        framework and element description. 
</li>
</ul><p>


</p>
<p>
The following are the primary changes between the -01 of the draft and
the -00 version. 

</p>
<ul class="text">
<li>Removed requirement for VoiceXML dialog support
</li>
<li>Added requirement for template dialog support
</li>
</ul><p>


</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12"></a><h3>12.&nbsp;
Acknowledgments</h3>

<p> The authors would like to thank Adnan Saleem of Convedia and Gene
   Shtirmer of Intel for useful review of this work.  

</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.13"></a><h3>13.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>13.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>13.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="CCXML10">[CCXML10]</a></td>
<td class="author-text">Auburn, R J., &ldquo;Voice Browser Call Control: CCXML Version 1.0,&rdquo; W3C&nbsp;Working Draft (work in progress), June&nbsp;2005.</td></tr>
<tr><td class="author-text" valign="top"><a name="H.248.1">[H.248.1]</a></td>
<td class="author-text">&ldquo;Gateway control protocol: Version 3,&rdquo; ITU-T Recommendation&nbsp;H.248.1.</td></tr>
<tr><td class="author-text" valign="top"><a name="H.248.9">[H.248.9]</a></td>
<td class="author-text">&ldquo;Gateway control protocol: Advanced media server packages,&rdquo; ITU-T Recommendation&nbsp;H.248.9.</td></tr>
<tr><td class="author-text" valign="top"><a name="KPML">[KPML]</a></td>
<td class="author-text">Burger, E. and M. Dolly, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-sipping-kpml-08.txt">A Session Initiation Protocol (SIP) Event Package for  Key Press
                            Stimulus (KPML)</a>,&rdquo; draft-ietf-sipping-kpml-08 (work in progress), July&nbsp;2006.</td></tr>
<tr><td class="author-text" valign="top"><a name="MSCML">[MSCML]</a></td>
<td class="author-text">Van Dyke, J., Burger, E., and A. Spitzer, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-vandyke-mscml-09.txt">Media Server Control Markup Language (MSCML) and Protocol</a>,&rdquo; draft-vandyke-mscml-09 (work in progress), June&nbsp;2006.</td></tr>
<tr><td class="author-text" valign="top"><a name="MSCP">[MSCP]</a></td>
<td class="author-text">McGlashan, S., Auburn, R., Burke, D., Candell, E., and R. Surapaneni, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-mcglashan-mscp-02.txt">Media Server Control Protocol (MSCP)</a>,&rdquo; draft-mcglashan-mscp-02 (work in progress), July&nbsp;2006.</td></tr>
<tr><td class="author-text" valign="top"><a name="MSML">[MSML]</a></td>
<td class="author-text">Saleem, A. and G. Sharratt, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-saleem-msml-01.txt">Media Session Markup Language (MSML)</a>,&rdquo; draft-saleem-msml-01 (work in progress), June&nbsp;2006.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2396">[RFC2396]</a></td>
<td class="author-text"><a href="mailto:timbl@w3.org">Berners-Lee, T.</a>, <a href="mailto:fielding@ics.uci.edu">Fielding, R.</a>, and <a href="mailto:masinter@parc.xerox.com">L. Masinter</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2396">Uniform Resource Identifiers (URI): Generic Syntax</a>,&rdquo; RFC&nbsp;2396, August&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2396.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2396.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2396.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2616">[RFC2616]</a></td>
<td class="author-text"><a href="mailto:fielding@ics.uci.edu">Fielding, R.</a>, <a href="mailto:jg@w3.org">Gettys, J.</a>, <a href="mailto:mogul@wrl.dec.com">Mogul, J.</a>, <a href="mailto:frystyk@w3.org">Frystyk, H.</a>, <a href="mailto:masinter@parc.xerox.com">Masinter, L.</a>, <a href="mailto:paulle@microsoft.com">Leach, P.</a>, and <a href="mailto:timbl@w3.org">T. Berners-Lee</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2616">Hypertext Transfer Protocol -- HTTP/1.1</a>,&rdquo; RFC&nbsp;2616, June&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2616.txt">TXT</a>, <a href="http://www.rfc-editor.org/rfc/rfc2616.ps">PS</a>, <a href="http://www.rfc-editor.org/rfc/rfc2616.pdf">PDF</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2616.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2616.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2897">[RFC2897]</a></td>
<td class="author-text">Cromwell, D., &ldquo;<a href="http://tools.ietf.org/html/rfc2897">Proposal for an MGCP Advanced Audio Package</a>,&rdquo; RFC&nbsp;2897, August&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2897.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3261">[RFC3261]</a></td>
<td class="author-text">Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;<a href="http://tools.ietf.org/html/rfc3261">SIP: Session Initiation Protocol</a>,&rdquo; RFC&nbsp;3261, June&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3261.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3262">[RFC3262]</a></td>
<td class="author-text">Rosenberg, J. and H. Schulzrinne, &ldquo;<a href="http://tools.ietf.org/html/rfc3262">Reliability of Provisional Responses in Session Initiation Protocol (SIP)</a>,&rdquo; RFC&nbsp;3262, June&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3262.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3263">[RFC3263]</a></td>
<td class="author-text">Rosenberg, J. and H. Schulzrinne, &ldquo;<a href="http://tools.ietf.org/html/rfc3263">Session Initiation Protocol (SIP): Locating SIP Servers</a>,&rdquo; RFC&nbsp;3263, June&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3263.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3264">[RFC3264]</a></td>
<td class="author-text">Rosenberg, J. and H. Schulzrinne, &ldquo;<a href="http://tools.ietf.org/html/rfc3264">An Offer/Answer Model with Session Description Protocol (SDP)</a>,&rdquo; RFC&nbsp;3264, June&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3264.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4240">[RFC4240]</a></td>
<td class="author-text">Burger, E., Van Dyke, J., and A. Spitzer, &ldquo;<a href="http://tools.ietf.org/html/rfc4240">Basic Network Media Services with SIP</a>,&rdquo; RFC&nbsp;4240, December&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4240.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4574">[RFC4574]</a></td>
<td class="author-text">Levin, O. and G. Camarillo, &ldquo;<a href="http://tools.ietf.org/html/rfc4574">The Session Description Protocol (SDP) Label Attribute</a>,&rdquo; RFC&nbsp;4574, August&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4574.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="SIPCF">[SIPCF]</a></td>
<td class="author-text">Boulton, C., Melanchuk, T., McGlashan, S., and A. Shiratzky, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-boulton-sip-control-framework-04.txt">A Control Framework for the Session Initiation
        Protocol (SIP)</a>,&rdquo; draft-boulton-sip-control-framework-04 (work in progress), October&nbsp;2006.</td></tr>
<tr><td class="author-text" valign="top"><a name="SRGS">[SRGS]</a></td>
<td class="author-text">Hunt, A. and S. McGlashan, &ldquo;Speech Recognition Grammar Specification Version
        1.0,&rdquo; W3C&nbsp;Recommendation, March&nbsp;2004.</td></tr>
<tr><td class="author-text" valign="top"><a name="XML">[XML]</a></td>
<td class="author-text">Bray, T., Paoli, J., Sperberg-McQueen, C M., Maler, E., and F. Yergeau, &ldquo;Extensible Markup Language (XML) 1.0 (Third Edition),&rdquo; W3C&nbsp;Recommendation, February&nbsp;2004.</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Chris Boulton</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Ubiquity Software Corporation</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Building 3</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Wern Fawr Lane</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">St Mellons</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cardiff, South Wales  CF3 5EA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:cboulton@ubiquitysoftware.com">cboulton@ubiquitysoftware.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Tim Melanchuk</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">BlankSpace</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:tim.melanchuk@gmail.com">tim.melanchuk@gmail.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Scott McGlashan</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Hewlett-Packard</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Gustav III:s boulevard 36</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">SE-16985 Stockholm, Sweden</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:scott.mcglashan@hp.com">scott.mcglashan@hp.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Asher Shiratzky</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Radvision</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">24 Raoul Wallenberg st</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Tel-Aviv, Israel</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:ashers@radvision.com">ashers@radvision.com</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2006).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
