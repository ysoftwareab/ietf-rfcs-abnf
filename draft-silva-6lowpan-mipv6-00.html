<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>An Adaptation Model for Mobile IPv6 support in lowPANs</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="An Adaptation Model for Mobile IPv6 support in lowPANs">
<meta name="keywords" content="Mobility, Mobile IPv6, MIPv6, lowPAN">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Internet Engineering Task Force</td><td class="header">R. Silva, Ed.</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">J. Sa Silva, Ed.</td></tr>
<tr><td class="header">Intended status: Historic</td><td class="header">University of Coimbra</td></tr>
<tr><td class="header">Expires: November 12, 2009</td><td class="header">May 11, 2009</td></tr>
</table></td></tr></table>
<h1><br />An Adaptation Model for Mobile IPv6 support in lowPANs<br />draft-silva-6lowpan-mipv6-00</h1>

<h3>Status of This Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.
This document may contain material from IETF Documents or IETF
Contributions published or made publicly available before November
10, 2008. The person(s) controlling the copyright in some of this
material may not have granted the IETF Trust the right to allow
modifications of such material outside the IETF Standards Process.
Without obtaining an adequate license from the person(s) controlling
the copyright in such materials, this document may not be modified
outside the IETF Standards Process, and derivative works of it may
not be created outside the IETF Standards Process, except to format
it for publication as an RFC or to translate it into languages other
than English.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on November 12, 2009.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2009 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents in effect on the date of
publication of this document (http://trustee.ietf.org/license-info).
Please review these documents carefully, as they describe your
rights and restrictions with respect to this document.</p>

<h3>Abstract</h3>

<p>Real deployments of wireless sensor networks (WSN) are rare, and
   virtually all have considerable limitations when node mobility is
   concerned.  On one hand, research in WSNs tends to favour complex
   multi-hop routing protocols and, on the other hand, IP and mobility
   are considered too demanding for these environments. In this document
   we contradict this general belief by proposing an adaptation model
   for Mobile IPv6 in 6lowPANs.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#anchor2">2.</a>&nbsp;
Mobile IPv6 main issues for lowPANs<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">2.1.</a>&nbsp;
Routing<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">2.2.</a>&nbsp;
Data<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">2.3.</a>&nbsp;
Handover<br />
<a href="#anchor6">3.</a>&nbsp;
Conventions<br />
<a href="#anchor8">4.</a>&nbsp;
Overview<br />
<a href="#anchor9">5.</a>&nbsp;
LowPAN adaptation Layer<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">5.1.</a>&nbsp;
MIPv6 Header Compression<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">5.2.</a>&nbsp;
Mobility Message Compression<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">5.2.1.</a>&nbsp;
Binding Refresh Request<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">5.2.2.</a>&nbsp;
Home Test Init<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">5.2.3.</a>&nbsp;
Care-of Test Init<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">5.2.4.</a>&nbsp;
Home Test<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor16">5.2.5.</a>&nbsp;
Care-of Test<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor17">5.2.6.</a>&nbsp;
Binding Update<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">5.2.7.</a>&nbsp;
Biding Acknowledge<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor19">5.2.8.</a>&nbsp;
Binding Error<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor20">5.3.</a>&nbsp;
Mobility Options<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor21">5.3.1.</a>&nbsp;
Pad1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor22">5.3.2.</a>&nbsp;
PadN<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor23">5.3.3.</a>&nbsp;
Binding Refresh Advice<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor24">5.3.4.</a>&nbsp;
Alternate Care-of Address<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor25">5.3.5.</a>&nbsp;
Nonces Indices<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor26">5.3.6.</a>&nbsp;
Binding Authorization Data<br />
<a href="#anchor27">6.</a>&nbsp;
Definitions<br />
<a href="#anchor28">7.</a>&nbsp;
Security Considerations<br />
<a href="#anchor29">8.</a>&nbsp;
IANA Considerations<br />
<a href="#anchor30">9.</a>&nbsp;
Contributors<br />
<a href="#rfc.references1">10.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">10.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">10.2.</a>&nbsp;
Informative References<br />
<a href="#anchor33">Appendix&nbsp;A.</a>&nbsp;
Change Log <br />
<a href="#anchor34">Appendix&nbsp;B.</a>&nbsp;
Open Issues<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>MobilieIPv6 or only MIPv6 <a class='info' href='#RFC3775'>[RFC3775]<span> (</span><span class='info'>Johnson, D., Perkins, C., and J. Arkko, &ldquo;Mobility Support in IPv6,&rdquo; June&nbsp;2004.</span><span>)</span></a> is the native support of Mobile IP, firstly developed for IPv4, in IPv6. The main goal of Mobile IP is to allow mobile nodes to move between heterogeneous networks maintaining the connectivity. Such process aims also to be completely transparent at the transport and upper layers.
</p>
<p>Based on L2 Handover, concept inherited from Cellular Networks,
   Mobile IP introduced L3 Handover and specific mechanisms to support
   it.  Those mechanisms required new entities within each network, to
   control the overall process.  A set of agents, tables and control
   messages were introduced and originated the first Mobile IP
   version. 
</p>
<p>The first version of Mobile IP introduced the concept of Home Agent,
   Foreign Agent, Correspondent Node, Mobile Node, Care of Address and
   Mobility Binding Tables.  The Home Agent is the local entity
   responsible for the Mobile Nodes management. Maintaining a Binding Cache 
   it registers the information of all local nodes that are currently connected to
   foreign networks.  The Foreign Agent also maintains an updated table,
   containing the visitors' list.  Each time a Mobile Node (MN) is
   connected to a foreign network, a care-of-address is associated to
   it.
</p>
<p>Due to the potential of IPv6, the Mobile IP version for this new
   release was optimised and natively integrated.  Firstly, since IPv6
   supports stateless and stateful address configuration associated to
   Neighbour Discovery mechanisms, the existence of a Foreign Agent
   became unnecessary.  Such role is now played by the Mobile Node,
   which triggers and controls the entire handoff process.  One of the multiple 
   Care-of Addresses is marked as primary, therefore, guaranteeing
   access from more than one network in the range.  Considering that
   each Care-of Address has a lifetime associated to it, in some cases the
   Mobile Node is able to receive from multiple Addresses, since
   they are active.  Such capability is known as Smooth-HandOff.
</p>
<p>MIPv6 also brings the ability to natively deal with the routing
   questions providing new features as the Return Routability as well as
   the use of security mechanisms in all protocol communications
   (IPSec).
</p>
<p>The mobility of nodes in lowPANs, is a behaviour that directly inherit from the characteristics of nodes. Nodes are small, battery powered and able to communicate wirelessly, which means that they are portable. Consequently, nodes are easily deployed on mobile bodies, like humans or vehicles, becoming in mobile nodes. Many applications consider the use of nodes on mobile bodies, like for instance in battlefields, rescues or cities monitoring systems, using buses or other vehicles. Therefore, the mobility support in lowPANs is crucial to the success of critical and non-critical mobility dependent applications.
</p>
<p>Considering the actual state of MIPv6 and the necessitation of mobility support in lowPANs, this document presents an adaptation model to integrate MIPv6 in 6lowPAN. MIPv6 is defined by specific messages, each one with a specific format. Such format can be compressed and coded, following the same rules used to adapt IPv6 packet to IEEE802.5.4 frames, presented in RFC 4944 <a class='info' href='#RFC4944'>[RFC4944]<span> (</span><span class='info'>Montenegro, G., Kushalnagar, N., Hui, J., and D. Culler, &ldquo;Transmission of IPv6 Packets over IEEE 802.15.4 Networks,&rdquo; September&nbsp;2007.</span><span>)</span></a>. The objective is to guarantee a controlled latency in the presence of mobility. Hence, a micro MIPv6 version for lowPANs is demanding. 
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Mobile IPv6 main issues for lowPANs</h3>

<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
Routing</h3>

<p>When it is assigned a new primary Care-of Address, Mobile Nodes must notice
   that, sending a Binding Update message, to the Home Agent and in some
   cases to the Correspondent Node(s).  As defined by the standard, the
   communication between the Correspondent Node and the Mobile Node can
   be done by tunnelling, through the Home Agent, or directly.
   Tunneling makes use of proxy Neighbour Discovery to intercept the
   IPv6 packets whose destination is the MN and encapsulate them with
   the CoA, IPv6-in-IPv6.  Whereas this process is efficient, it can
   lead to the triangulation problem and high latency.  Therefore, in
   order to avoid such problems, other approaches have appeared
   promoting the direct communication between MN and CN.  To support it,
   the Correspondent Node must maintain a Mobility Binding Table and the
   MN must send the Binding Update messages not only to the
   Home Agent but also to the CN.  Independently of the
   target, each Binding Update message must also be secured through
   IPSec ESP in transport mode.
</p>
<p>To provide a more secure communication, avoiding triangulation, MIPv6
   also introduces "Return Routeability".  Return Routeability is
   performed during the handover and reaches both, HoA and CN, at the
   same instant.  The objective is to secure that CN knows exactly to
   each MN it is talking to, and through each path the MN is available.
   Hence, when assigned a new primary CoA, MN sends a Binding Update to
   the Home Agent, a Home-Test Init (HoTI) to the CN via HA and a
   Care-of Test Init (CoTI) directly to the CN.  When the CN receives
   both messages, HoTI and CoTI, it generates two keygen tokens based on
   a pre-generated key(random number of 20 octets) and a pre-generated
   nonce (random octet string with any length), namely: home keygentoken
   and care-of keygentoken, respectively.  Then, via the same paths, CN
   sends back the generated keygen tokens in Home Test (HoT) and Care-of
   Test (CoT) messages, respectively.  When MN receives both, HoT and
   CoT, it computes a binding message key (bmK) to sign the Binding
   Update message that it then sends directly to the CN.  Finally, CN
   checks the signature, updates the Mobility Binding Table and sends
   back a Binding Acknowledgement.  All this messages are new extensions
   in the IPv6 packet header.  This process is too complex for use in
   lowPANs.  The used messages and the security mechanism are too heavy
   and MUST be adapted.
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
Data</h3>

<p>Mobility Binding Tables, previously mentioned, are the most important
   data structures in the Mobile IP protocol.  Every Home Agent
   maintains one, as well as some of the Correspondent Nodes (when
   bidirectional tunnelling is used CNs do not need to be aware about
   nodes mobility, therefore they do not need to maintain a Mobility
   Binding Table).  Each entry of a Mobility Binding Table is composed
   by the Home Address, the principal Care-of Address, the remaining
   lifetime, a flag indicating whether or not this entry is a home
   registration, the maximum value of the sequence number received in
   the last message of correspondent to the respective entry and usage
   information about the same.
</p>
<p>Home Agent also maintains a Home Agent List, where it is listed all
   Home Agents on the link.  Each entry has a link-local IP address, one
   or more global IP addresses, the remaining lifetime and the
   preference level for that home agent (higher means better).  Such
   list is useful when the Home Agent receives a Dynamic Home Agent
   Address Discovery message.  In that case the Home Agent replies with a Home
   Agent Address Discovery Reply message containing the list of Home
   Agent on the link.  This mechanism is useful when Mobile Nodes do not
   know the address of an available Home Agent on the link.  When
   the reply message is received, Mobile Nodes try to send the Binding
   Update for the list entry with higher preference.  If a Binding
   Acknowledgment is not received, the Mobile Node will try each one of
   the other entries.
</p>
<p>Mobile Nodes maintain a Binding Cache too, known as Binding Update
   List, where each entry corresponds to the last Binding Update message
   sent per target (CN or HA).  Each entry contains the IP address of
   the destination, the Care-of Address sent, the initial and remaining
   lifetime (when this value became zero the entry is removed), the
   maximum value of the sequence number, the time it was sent, the state
   of any retransmission needed and a flag specifying whether or not
   future BU message should be sent.  Besides, in the cases that Return
   Routeability is in use the same entry must have: the time the last
   HoTI and CoTI were sent, the state of any retransmission needed for
   this return routability, the cookies used in HoTI and CoTI and also
   the Home and Care-of Keygen tokens, as well as the Home and Care-of
   nonce indices received.
</p>
<p>Once again, lowPANs do not need to store so much information and data
   structures MUST be reduced.
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3"></a><h3>2.3.&nbsp;
Handover</h3>

<p>MobileIPv6 aims to perform the handoff as fast and as efficiently as the
   application requires.  However, for real time applications, the
   handover latency can be insupportable.  To overcome that
   some extensions were defined as alternatives to support Fast Handovers for
   MIPv6.  The main idea is to start the L3 handover before the end of
   the L2 handover.  To do that, MN should perform both almost at the same
   time.  Another issue related with handover latency is the time
   required by the Duplicate Address Detection (DAD).  After obtained
   the CoA, nodes should check if there are duplicate addresses in that
   subnet.  However, it is done using Multiple Neighbour Solicitations
   and it would take at least 1 second.  Return Routability, even secure 
   and technically efficient, also requires the
   double of the time needed to perform a simple tunnelling.  These
   questions have been approached and handover latency is a question
   that needs to be carefully analysed.

</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Conventions</h3>

<p>
</p>
<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
      "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
      document are to be interpreted as described in RFC 2119 <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Overview</h3>

<p>
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
LowPAN adaptation Layer</h3>

<p> Mobile IPv6 headers suffers a similar restriction as the IPv6 headers 
   in lowPANS. RFC4944 <a class='info' href='#RFC4944'>[RFC4944]<span> (</span><span class='info'>Montenegro, G., Kushalnagar, N., Hui, J., and D. Culler, &ldquo;Transmission of IPv6 Packets over IEEE 802.15.4 Networks,&rdquo; September&nbsp;2007.</span><span>)</span></a> defines that bits 5 and 6 identifies the next header. However, only UDP, TCP and ICMP were considering, being the remaining options carried in line. Hence, to identify the MIPv6 next header, 6lowPAN in the best case, will provide a HC1 with 3 bytes, being the Next Header field an uncompressed field.Independently of how HC1 signals the existence and type of the Next Header, in this point we present the first proposal for compression and encoding of the Mobility Header and respective messages. 
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
MIPv6 Header Compression</h3>

<p>The Mobility Header defined in the RFC3775 <a class='info' href='#RFC3775'>[RFC3775]<span> (</span><span class='info'>Johnson, D., Perkins, C., and J. Arkko, &ldquo;Mobility Support in IPv6,&rdquo; June&nbsp;2004.</span><span>)</span></a> is presented in figure 1
</p><br /><hr class="insert" />
<a name="figure1"></a>
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
                     1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Payload Proto |   Header Len  |     MH Type   |   Reserved    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|          Checksum             |                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |
|                                                               |
.                                                               .
.                         Message Data                          .
.                                                               .
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: Mobility Header.&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<ul class="text">
<li> 8 bits - Payload Proto   = Identifies the Next Header.
</li>
<li> 8 bits - Header Len = Identifies the length of the Mobility Header in unit of 8 octets.
</li>
<li> 8 bits - MH Type = Identifies the particular mobility message.
</li>
<li> 8 bits - Reserved
</li>
<li> 16 bits - Checksum = contains the checksum of the Mobility Header.
</li>
</ul>
<p>In order to make it compatible with WSNs, fields must be compressed. Hence, our proposal defines that:
</p>
<ul class="text">
<li> Payload Proto is coded into 2 bits, as defined by 6lowPAN in RFC4944 <a class='info' href='#RFC4944'>[RFC4944]<span> (</span><span class='info'>Montenegro, G., Kushalnagar, N., Hui, J., and D. Culler, &ldquo;Transmission of IPv6 Packets over IEEE 802.15.4 Networks,&rdquo; September&nbsp;2007.</span><span>)</span></a>.
</li>
<li> Header Len is coded in one bit:
<ul class="text">
<li>0: means that it was deleted and the entire length imported from layer 2.
</li>
<li>1: means that it is carried in line.
</li>
</ul>
 
</li>
<li>MH Type could be coded in 3 bits, but we choose 4 bits to give an higher range.
</li>
<li>Reserved can be remove.
</li>
<li>Checksum is coded in one bit: 
<ul class="text">
<li>0: included in the packet checksum.
</li>
<li>1: means carried in line.
</li>
</ul>
 
</li>
</ul>
<p>With 2 bits of Payload Proto plus, 1 bit of Header Lenght, plus 4 bits of MH Type and plus 1 bit of Checksum, we are able to compress the 48 original bits to 8bits. Figure 2 presents the compressed Mobility Header, which we called 6lowPAN_MHC (Mobility Header Compressed).
</p><br /><hr class="insert" />
<a name="figure2"></a>
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
                      1                   2
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |     MHC       |  Non-Compressed fields follow...
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |               |
 |                  |
 |                     |
 |                        |
 |                           |
 | 0   1   2   3   4   5   6   7 |
 +---+---+---+---+---+---+---+---+
 |   PP  | L |    MH Type    | C |
 +---+---+---+---+---+---+---+---+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;2: Mobility Header Compressed&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>The field Mobility Header Type is used to identify the mobility message. The next table presents each message and the respective type value, as defined in RFC3775 <a class='info' href='#RFC3775'>[RFC3775]<span> (</span><span class='info'>Johnson, D., Perkins, C., and J. Arkko, &ldquo;Mobility Support in IPv6,&rdquo; June&nbsp;2004.</span><span>)</span></a> of MIPv6.
</p><br /><hr class="insert" />
<a name="table_ex"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="center">
<tr><th align="left">Message#</th><th align="center">Mobile Header Type</th></tr>
<tr>
<td align="left">Binding Refresh Request (BRR)</td>
<td align="center">0</td>
</tr>
<tr>
<td align="left">Home Test Init (HoTI)</td>
<td align="center">1</td>
</tr>
<tr>
<td align="left">Care-of Test Init (CoTI)</td>
<td align="center">2</td>
</tr>
<tr>
<td align="left">Home Test (HoT)</td>
<td align="center">3</td>
</tr>
<tr>
<td align="left">Care-of Test (CoT)</td>
<td align="center">4</td>
</tr>
<tr>
<td align="left">Binding Update (BU)</td>
<td align="center">5</td>
</tr>
<tr>
<td align="left">Binding Acknowledge (BA)</td>
<td align="center">6</td>
</tr>
<tr>
<td align="left">Binding Error</td>
<td align="center">7</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 1: Mobility Messages&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>Each message type has its own defined fields, which must also be compressed. The next sections will approach each message type and present our proposal to compress each one.
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Mobility Message Compression</h3>

<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2.1"></a><h3>5.2.1.&nbsp;
Binding Refresh Request</h3>

<p>Binding Refresh Request (BRR) messages are used by Correspondent Nodes to request a refresh for a specific binding cache entry that stills active on deleting (eg. the entry lifetime expires but the binding stills active).   
BRR messages do not add any further field in the mobility header, however it defines the Message Data as follow:
</p>
<ul class="text">
<li>16 bits Reserved.
</li>
<li>Variable-length (multiple of 8 octets) of Mobility Options.
</li>
</ul>
<p>Considering the limitations of lowPANs we propose delete the Reserved field.The Mobility Option field is approached later in this document. Hence, BRR messages are identified only by the Mobile Header Type and, eventually, followed by any Mobility Option.
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2.2"></a><h3>5.2.2.&nbsp;
Home Test Init</h3>

<p>Home Test Init (HoTI) is used to initiate the return routability procedure, requesting a Home Keygen Token from  the Correspondent Node. To request that, Mobile Node must generate a Home Init Cookie, which is a random 64 bits values. To send it, the original message defined in the RFC3775 <a class='info' href='#RFC3775'>[RFC3775]<span> (</span><span class='info'>Johnson, D., Perkins, C., and J. Arkko, &ldquo;Mobility Support in IPv6,&rdquo; June&nbsp;2004.</span><span>)</span></a> is presented in the next figure.
</p><br /><hr class="insert" />
<a name="figure3"></a>
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
                     1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
                                +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                                |           Reserved            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+                         Home Init Cookie                      +
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
.                                                               .
.                         Mobility Options                      .
.                                                               .
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;3: HoTI Message format&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>[Granjal2008] <a class='info' href='#Granjal2008'>[Granjal2008]<span> (</span><span class='info'>Granjal, J., Silva, R., Sa Silva, J., and E. Monteiro, &ldquo;Why is IPSec a viable option for wireless sensor networks,&rdquo; 2008.</span><span>)</span></a> presented a study about the viability of IPSec in WSNs. The same study concluded that the conventional algorithms are not supported in limited devices. Although supported by some Wireless Sensor Nodes, the memory constrains limits its general implementation. Therefore, it is not suitable to use 64 bits keys in WSNs. Hence, we propose the use of 16bits keys, as maximum. Besides, Mobility Options SHOULD not be considered at this level. If so, Mobility Options must be Type-Length-Value (TLV) but in a compressed mode, defined later in this document.
</p>
<p>Home Test Init Compressed (HoTIC) has the follow format:
</p><br /><hr class="insert" />
<a name="figure4"></a>
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
                      1                   2
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |           HoTIC               |  Non-Compressed fields follow...
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                               |
 |                                    |
 |                                          |
 |                                               |
 |                                                    |
 |                                                         |
 | 0   1   2   3   4   5   6   7   8   9   0   1   2   3   4   5 |
 +---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+
 |                    Home Init Cookie 16bits	                 |
 +---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;4: HoTI Message compressed&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2.3"></a><h3>5.2.3.&nbsp;
Care-of Test Init</h3>

<p>Care-of Test Init (CoTI) has the same objective of HoTI, however is sent via a different path. The original format is equal to HoTI format as well as the compressed proposal.
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2.4"></a><h3>5.2.4.&nbsp;
Home Test</h3>

<p>Home Test (HoT) message is the response of Correspondent Nodes to the Home Test Init message. The format of this message is the follow.
</p><br /><hr class="insert" />
<a name="figure5"></a>
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
                     1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
                                +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                                |        Home Nonce Index       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+                         Home Init Cookie                      +
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+                        Home Keygen Token                      +
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
.                                                               .
.                         Mobility Options                      .
.                                                               .
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;5: HoT Message format&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<ul class="text">
<li>16bits Home Nonce Index - is used to be echoed back by the MN in the Binding Update.
</li>
<li>64bits Home Init Cookie - contains the cookie sent in the Home Test init message.
</li>
<li>64bits Home Keygen Token - contains the keygen token generated ans used in the router routability.
</li>
<li>Variable-length - Mobility Options.
</li>
</ul>
<p>Based on the same constrain mentioned in the Home Test Init case, we propose the reduction of 64 bits keys to 16 bits. Our proposal for Home Test compressed (HoTC) is the follow:
</p>
<ul class="text">
<li>Home Nonce Index reduced to 8 bits.
</li>
<li>Home init Cookie removed - Not necessary to be sent again.
</li>
<li>Home Keygen Token reduced to 16 bits.
</li>
<li>Mobility Options - suppressed. 
</li>
</ul>
<p>Compressed from 144 bits (w/o options) to 24 bits the HoTC format is presented in the next figure.
</p><br /><hr class="insert" />
<a name="figure6"></a>
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
                      1                   2
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                     HoTC                        |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                                                 |
 |                                                      |
 |                                                          |
 |                                                              |
 |                                                                  |
 | 0  1  2  3  4  5  6  7  8  9  0  1  2  3  4  5  6  7  8  9  0  1  2  3|
 +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
 |   Home Nonce Ind.     |         Home Keygen Token                     |
 +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;6: HoTC Message format&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2.5"></a><h3>5.2.5.&nbsp;
Care-of Test</h3>

<p>Care-of Test (CoT) has the same format of HoT, changing only the field's names to Care-of Nonce and Care-of Keygen Token. The same compression proposed for HoT is proposed for CoT. The compressed version of CoT is called CoTC.
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2.6"></a><h3>5.2.6.&nbsp;
Binding Update</h3>

<p>Binding Update messages are used to notify other nodes about new care-of addresses. Defined in RFC 3775 its format is the follow:
</p><br /><hr class="insert" />
<a name="figure7"></a>
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
                     1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
                                +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                                |          Sequence #           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|A|H|L|K|         Reserved      |           Lifetime            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
.                                                               .
.                        Mobility Options                       .
.                                                               .
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;7: BU Message format&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<ul class="text">
<li>16 bits - Sequence = used to sequence BU messages and to link to the correspondent Binding Acknowledge.
</li>
<li>1 bit - A = set 1 to require a Binding Acknowledge.
</li>
<li>1 bit - H = set 1 to indicate that the receiver must act as its Home Agent.
</li>
<li>1 bit - L = set 1 to indicate that both Link-local addresses, home and mobile, have the same Interface Identifier. 
</li>
<li>1 bit - K = used to IPSec control and only valid for BU to the Home Agent.
</li>
<li>12 bits - Reserved.
</li>
<li>16 bits - Lifetime = The number of time units remaining before the binding expires. (time unit = 4 s)
</li>
<li>Variable-length (multiple of 8 octets) of Mobility Options.
</li>
</ul>
<p>In order to compress Binding Update messages, taking in consideration the limitations, we propose:
</p>
<ul class="text">
<li>Sequence number reduced to 5 bits, allowing: 
</li>
<ul class="text">
<li>directly a sequence of 32 messages.
</li>
<li>the codification of each combination.
</li>
<li>the application of mathematic formula to achieve higher sequences on demand. 
</li>
</ul>
<li>A remains equal.
</li>
<li>H remains equal.
</li>
<li>L remains equal.
</li>
<li>K is removed since IPSec is not defined in lowPANs neither its support is guaranteed <a class='info' href='#Granjal2008'>[Granjal2008]<span> (</span><span class='info'>Granjal, J., Silva, R., Sa Silva, J., and E. Monteiro, &ldquo;Why is IPSec a viable option for wireless sensor networks,&rdquo; 2008.</span><span>)</span></a>.
</li>
<li>Reserved is removed.
</li>
<li>LifeTime is reduced to 8 bits only and time units increased to 8 seconds (at this stage).
</li>
<li>Mobility Options are approached separately and presented later in this document.
</li>
</ul>
<p>Hence, based on these approach our proposal for Binding Update messages (without considering Mobility Options), entitled BUC, compresses the message from 48 bits to 16 bits. Figure 8 shows the result.
</p><br /><hr class="insert" />
<a name="figure8"></a>
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
                     1                   2
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|              BUC              |  Non-Compressed fields follow...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                               |
|                                    |
|                                        |
|                                             |
|                                                   |
|                                                        |
|                                                             |
| 0   1   2   3   4   5   6   7   8   9   0   1   2   3   4   5
+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+
|        Sequence       | A | H | L |        LifeTime           |
+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;8: BUC Message format&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>The field LifeTime could be differently coded, more compressed or calculated on demand, however we believed that a tradeoff between the cost of sending a few bytes and the cost of compute it on demand must be found. Future evaluation will prove this question.
</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2.7"></a><h3>5.2.7.&nbsp;
Biding Acknowledge</h3>

<p>Binding Acknowledge message are used to notify the reception of a Binding Update message. As defined in the RFC3775 <a class='info' href='#RFC3775'>[RFC3775]<span> (</span><span class='info'>Johnson, D., Perkins, C., and J. Arkko, &ldquo;Mobility Support in IPv6,&rdquo; June&nbsp;2004.</span><span>)</span></a> such message is composed by the following fields:
</p>
<ul class="text">
<li>8 bits - Status:
</li>
<ul class="text">
<li>Values less than 128 means that BU was accepted. (0 and 1 assigned)
</li>
<li>Values greater than or equal to 128 means than an error occurred. (assigned from 128 to 139)
</li>
</ul>
<li>1 bit - K = used to IPSec control and only valid for BU to the Home Agent.
</li>
<li>7 bits - Reserved = not used.
</li>
<li>16 bits - Sequence  = copied from the Binding Update message and used to link both.
</li>
<li>16 bits - Lifetime = the granted lifetime from which the node (HA or CN) should retain the binding cache entry.
</li>
<li>Variable-length - Mobility Options = in BA messages future options can be defined. The RFC mentions the 'Binding Authorization Data Option' and the 'Binding Refresh Advice Option.'
</li>
</ul>
<p>The next figure presents the Binding Acknowledge fields.
</p><br /><hr class="insert" />
<a name="figure9"></a>
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
                     1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
                                +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                                |      Status   |K|  Reserved   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|             Sequence#         |          Lifetime             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
.                                                               .
.                        Mobility Options                       .
.                                                               .
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;9: BA Message format&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>In order to compress this structure and based on the lowPANs requirements, we firstly propose the redefinition of the available Status. The RFC3775 <a class='info' href='#RFC3775'>[RFC3775]<span> (</span><span class='info'>Johnson, D., Perkins, C., and J. Arkko, &ldquo;Mobility Support in IPv6,&rdquo; June&nbsp;2004.</span><span>)</span></a> defines 14 Status resumed in the next table.
</p><br /><hr class="insert" />
<a name="table_ex1"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="center">
<tr><th align="left">Status</th><th align="center">Value</th></tr>
<tr>
<td align="left">Binding Update Accepted (BRR)</td>
<td align="center">0</td>
</tr>
<tr>
<td align="left">Accepted but prefix discovery necessary</td>
<td align="center">1</td>
</tr>
<tr>
<td align="left">Reason Unspecified</td>
<td align="center">128</td>
</tr>
<tr>
<td align="left">Adminsitratively Prohibited</td>
<td align="center">129</td>
</tr>
<tr>
<td align="left">Insufficient Resources</td>
<td align="center">130</td>
</tr>
<tr>
<td align="left">Home registration not supported</td>
<td align="center">131</td>
</tr>
<tr>
<td align="left">Not home subnet</td>
<td align="center">132</td>
</tr>
<tr>
<td align="left">Not home agent for this mobile node</td>
<td align="center">133</td>
</tr>
<tr>
<td align="left">Duplicate Address Detection failed</td>
<td align="center">134</td>
</tr>
<tr>
<td align="left">Sequence Number out of window</td>
<td align="center">135</td>
</tr>
<tr>
<td align="left">Expired home nonce index</td>
<td align="center">136</td>
</tr>
<tr>
<td align="left">Expired care-of nonce index</td>
<td align="center">137</td>
</tr>
<tr>
<td align="left">Expired nonce</td>
<td align="center">138</td>
</tr>
<tr>
<td align="left">Registration type change disallowed</td>
<td align="center">139</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 2: Binding Acknowlede Status&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>LowPAN requirements and capabilities are different from conventional
   networks.  Consequently, some of this status are not presented in such
   networks.  For instance, the message 133 could be sent by several
   nodes reached by the same anycast address.  In that case, it is not useful when the network
   and particularly the Mobile Node would be flooded with several
   messages.  To avoid this type of problems, we propose that
   Mobile Nodes, when request a Binding Acknowledge, define a time limit
   to receive it.  Thus, if any error occurs, the Mobile Node will not
   receive any acknowledge.  When the time is expired, the MN will know that an
   error happened without the need to receive any message.  At this stage we
   propose to keep only status 0 and 1 for success, and status 136, 137
   and 138 for questions related to return routeability.  Hence, we
   propose to resume this field to 3 bits, allowing a maximum of 8
   status, presented in the next table.
</p><br /><hr class="insert" />
<a name="table_ex2"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="center">
<tr><th align="left">Status</th><th align="center">Value</th></tr>
<tr>
<td align="left">Binding Update Accepted (BRR)</td>
<td align="center">0</td>
</tr>
<tr>
<td align="left">Accepted but prefix discovery necessary</td>
<td align="center">1</td>
</tr>
<tr>
<td align="left">Expired home nonce index</td>
<td align="center">2</td>
</tr>
<tr>
<td align="left">Expired care-of nonce index</td>
<td align="center">3</td>
</tr>
<tr>
<td align="left">Expired nonce</td>
<td align="center">4</td>
</tr>
<tr>
<td align="left">Reason Unspecified</td>
<td align="center">5</td>
</tr>
<tr>
<td align="left">Not defined</td>
<td align="center">6</td>
</tr>
<tr>
<td align="left">Not defined</td>
<td align="center">7</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 3: Compressed Binding Acknowlede Status&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>Therefore, our version of Binding Acknowledge message for lowPANs, proposes:
</p>
<ul class="text">
<li>Status - 3 bits.
</li>
<li>K - removed for the same reason of the BU messages.
</li>
<li>Reserved - removed.
</li>
<li>Sequence number reduced to 5 bits, allowing:
</li>
<ul class="text">
<li>directly a sequence of 32 messages.
</li>
<li>the codification of each combination.
</li>
<li>the application of mathematic formula to achieve higher sequences on demand.
</li>
</ul>
<li>LifeTime is reduced to 8 bits only and time units increased to 8 seconds (at this stage).
</li>
<li>Mobility Options are not defined here.
</li>
</ul>
<p>With this proposal the Compressed version of Binding Acknowledge (BAC) messages is constituted by 16 bits instead of the 48 bits (without considering the mobility options) of the conventional solution. The next figure resumes de BAC message.
</p><br /><hr class="insert" />
<a name="figure10"></a>
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
                      1                   2
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                    BAC        |  Non-Compressed fields follow...
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                               |
 |                                    |
 |                                         |
 |                                               |
 |                                                     |
 |                                                          |
 | 0   1   2   3   4   5   6   7   8   9   0   1   2   3   4   5 |
 +---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+
 |   Status  |     Sequence      |          LifeTime             |
 +---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;10: BUC Message format&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2.8"></a><h3>5.2.8.&nbsp;
Binding Error</h3>

<p>The Binding Error Message is used by the Correspondent Node, for instance to report any error related with the Home Address destination, in the case that no binding entry is registered. The format of this message is presented in the next figure.
</p><br /><hr class="insert" />
<a name="figure11"></a>
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
                     1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
                                +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                                |       Status  |   Reserved    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+                                                               +
|                          Home Address                         |
+                                                               +
|                                                               |
+                                                               +
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
.                                                               .
.                         Mobility Options                      .
.                                                               .
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;11: Binding Error Message format&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>The original version defines the message as follow:
</p>
<ul class="text">
<li> 8 bits - Status:
</li>
<ul class="text">
<li>1 - Unknown Binding for Home Address destination option
</li>
<li>2 - Unrecognized MH Type value.
</li>
</ul>
<li> 8 bits - Reserved
</li>
<li> 128 bits - Home Address
</li>
<li>Variable length - Mobility Options
</li>
</ul>
<p>For this type of message we won't propose any change. The reserved field could be removed as well as the Status field reduced. However, the Home Address MUST be sent anyway and probably PadN options would be necessary.
</p>
<p>This message format MUST be discussed in future. 
</p>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3"></a><h3>5.3.&nbsp;
Mobility Options</h3>

<p>Mobility Options allow a flexible extension of packets. Mobility messages can have zero, one or more options. Each Option must follow the Type-Length-Value (TLV) format. The RFC3775 <a class='info' href='#RFC3775'>[RFC3775]<span> (</span><span class='info'>Johnson, D., Perkins, C., and J. Arkko, &ldquo;Mobility Support in IPv6,&rdquo; June&nbsp;2004.</span><span>)</span></a> defines 6 mobility options presented next.
</p><br /><hr class="insert" />
<a name="table_ex3"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="center">
<tr><th align="left">Name</th><th align="center">Type</th></tr>
<tr>
<td align="left">Pad1</td>
<td align="center">0</td>
</tr>
<tr>
<td align="left">PadN</td>
<td align="center">1</td>
</tr>
<tr>
<td align="left">Binding Refresh Advice</td>
<td align="center">2</td>
</tr>
<tr>
<td align="left">Alternate Care-of Address</td>
<td align="center">3</td>
</tr>
<tr>
<td align="left">Nonce Indices</td>
<td align="center">4</td>
</tr>
<tr>
<td align="left">Binding Authorization Data</td>
<td align="center">5</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 4: Mobility Options&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>Firstly we propose to suppress the Option length field (from the TLV format), since we can obtain the entire message length from layer 2 and consequently check if there are mobility options or not.The next subsections approach each defined type deeply, proposing possible compressions. 
</p>
<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.1"></a><h3>5.3.1.&nbsp;
Pad1</h3>

<p>Since we are dealing with bits and not bytes we propose a dynamic Pad1. Instead of having one fixed byte of length, Pad1 can have from 1 to 8 bits of length. Thus, its propose remains almost the same, which means that it is responsible for maintaining the message length in octets. Since we compressed most of the messages, it is not guaranteed that all of them are mutliple of 8. Therefore, Pad1 must be used to guarantee it. If more than one octect is needed we propose to use Pad1 to regulate the first byte and PadN to set the remain message.
</p>
<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.2"></a><h3>5.3.2.&nbsp;
PadN</h3>

<p>For more than 1 octet we SHOULD use PadN. PadN follows the TLV format, being the "option data" ignored. The original option format is the follow:
</p><br /><hr class="insert" />
<a name="figure12"></a>
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
                     1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+- - - - - - - - - - - - - - - -
|    Type=1     |     Length    |   Option Data
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+- - - - - - - - - - - - - - - -

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;12: PadN Mobility Option format&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>We do not propose any change for PadN since its obective is to insert octets of padding in the Mobility Option area of a mobility message. 
</p>
<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.3"></a><h3>5.3.3.&nbsp;
Binding Refresh Advice</h3>

<p>Binding Refresh Advice option can only be sent with a Binding Acknowledgment from the Home Agent to the Mobile Node, in a response of a home registration. It indicates the remaining lifetime of that registration. The original format is the follow:
</p><br /><hr class="insert" />
<a name="figure13"></a>
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
                     1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
                                +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                                |    Type=2     |     Length    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|       Refresh Interval        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;13: Binding Refresh Advice Mobility Option format&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>The field refresh interval is a 16bits integer, representing the remaining lifetime in units of 4 seconds each. Accomplishing with our previous proposals, this field should be compressed to 8bits of 8 seconds each unit. 
</p>
<p>Therefore, considering the suppression of the length field, the compressed format of this message is the follow:
</p><br /><hr class="insert" />
<a name="figure14"></a>
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
                     1
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Type=2      |Refresh interv.|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;14: PadN Mobility Option compressed format&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.4"></a><h3>5.3.4.&nbsp;
Alternate Care-of Address</h3>

<p>This option is used to indicate in a Binding Update message an alternate Care-of Address for that used as source address. The format of this option is the follow:
</p><br /><hr class="insert" />
<a name="figure15"></a>
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
                     1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
                                +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                                |     Type =3   |     Length    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+                                                               +
|                     Alternate Care-of Address                 |
+                                                               +
|                                                               |
+                                                               +
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;15: Alternate Care-of Address Mobility Option format&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>We do not propose any compression for this type of option. 
</p>
<a name="anchor25"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.5"></a><h3>5.3.5.&nbsp;
Nonces Indices</h3>

<p>Home Nonce and Care-of Nonce indexes as mentioned when compressed HoT and CoT are used to be echoed back in the Binding Update message. Therefore, both are echoed back as a mobility option, whose original format is the follow:
</p><br /><hr class="insert" />
<a name="figure16"></a>
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
			         1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
                                +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                                |   Type=4      |    Length     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|         Home Nonce Index      |      Care-of Nonce Index      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;16: Nonce Indices Mobility Option format&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>As proposed in HoTC and CoTC, both indexes should be compressed to 8 bits. Considering the suppression of the option length field, the compressed format of this option is presented in the next figure.
</p><br /><hr class="insert" />
<a name="figure17"></a>
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
			         1                   2
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Type=4      |   Home Nonce  | Care-of Nonce |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;17: Nonce Indices Mobility Option compressed format&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor26"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.6"></a><h3>5.3.6.&nbsp;
Binding Authorization Data</h3>

<p>The Binding Authorization Data is the signature used by Mobile Nodes to sign the Binding Updates in order to make sure that they are the right senders. The content of this cryptographic signature is calculated in the context of return routability, and makes use of the nonces created by the Correspondent Node and sent in the HoT and CoT. The format of this message, as defined in the RFC3775 <a class='info' href='#RFC3775'>[RFC3775]<span> (</span><span class='info'>Johnson, D., Perkins, C., and J. Arkko, &ldquo;Mobility Support in IPv6,&rdquo; June&nbsp;2004.</span><span>)</span></a> is the follow:
</p><br /><hr class="insert" />
<a name="figure18"></a>
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
                     1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
                                +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                                |   Type = 5    | Option Length |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+                                                               +
|                          Authenticator                        |
+                                                               +
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;18: Binding Authorization Data - Mobility Option format&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>The Authenticator is calculated through a formula described in the RFC. Its original length is 96 bits which is too long for lowPANs. In a future step we aim to propose a simpler formula and reduce the authenticator length.
</p>
<a name="anchor27"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Definitions</h3>

<a name="anchor28"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Security Considerations</h3>

<p>Security is implicity in MIPv6. IPSec mechanisms MUST be provided to guarantee the reliability of the adaptation model and consequently the network security. 
</p>
<a name="anchor29"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
IANA Considerations</h3>

<p>This memo includes no request to IANA.
</p>
<a name="anchor30"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Contributors</h3>

<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>10.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2578">[RFC2578]</a></td>
<td class="author-text"><a href="mailto:kzm@cisco.com">McCloghrie, K., Ed.</a>, <a href="mailto:dperkins@snmpinfo.com">Perkins, D., Ed.</a>, and <a href="mailto:schoenw@ibr.cs.tu-bs.de">J. Schoenwaelder, Ed.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2578">Structure of Management Information Version 2 (SMIv2)</a>,&rdquo; STD&nbsp;58, RFC&nbsp;2578, April&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2578.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2579">[RFC2579]</a></td>
<td class="author-text"><a href="mailto:kzm@cisco.com">McCloghrie, K., Ed.</a>, <a href="mailto:dperkins@snmpinfo.com">Perkins, D., Ed.</a>, and <a href="mailto:schoenw@ibr.cs.tu-bs.de">J. Schoenwaelder, Ed.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2579">Textual Conventions for SMIv2</a>,&rdquo; STD&nbsp;58, RFC&nbsp;2579, April&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2579.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2580">[RFC2580]</a></td>
<td class="author-text"><a href="mailto:kzm@cisco.com">McCloghrie, K.</a>, <a href="mailto:dperkins@snmpinfo.com">Perkins, D.</a>, and <a href="mailto:schoenw@ibr.cs.tu-bs.de">J. Schoenwaelder</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2580">Conformance Statements for SMIv2</a>,&rdquo; STD&nbsp;58, RFC&nbsp;2580, April&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2580.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3775">[RFC3775]</a></td>
<td class="author-text">Johnson, D., Perkins, C., and J. Arkko, &ldquo;<a href="http://tools.ietf.org/html/rfc3775">Mobility Support in IPv6</a>,&rdquo; RFC&nbsp;3775, June&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3775.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4944">[RFC4944]</a></td>
<td class="author-text">Montenegro, G., Kushalnagar, N., Hui, J., and D. Culler, &ldquo;<a href="http://tools.ietf.org/html/rfc4944">Transmission of IPv6 Packets over IEEE 802.15.4 Networks</a>,&rdquo; RFC&nbsp;4944, September&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4944.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="Granjal2008">[Granjal2008]</a></td>
<td class="author-text">Granjal, J., Silva, R., Sa Silva, J., and E. Monteiro, &ldquo;Why is IPSec a viable option for wireless sensor networks,&rdquo; Wireless and Sensor Networks Security&nbsp;, 2008.</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>10.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
</table>

<a name="anchor33"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Change Log </h3>

<p>This optional section should be removed before the internet draft is
      submitted to the IESG for publication as an RFC.
</p>
<p>Note to RFC Editor: please remove this appendix before publication as an RFC.
</p>
<a name="anchor34"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B"></a><h3>Appendix B.&nbsp;
Open Issues</h3>

<p>The main content of this document aims to be discussed. The compression and codification of fields must be well evaluated. The authors are open to all contributions. 
</p>
<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Ricardo Nuno Mendao da Silva (editor)</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">University of Coimbra</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Department of Informatics Engineering, Faculty of Sciences and Technology, Polo II 3030-290</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Coimbra</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Portugal</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text"></td></tr>
<tr><td class="author" align="right">EMail:&nbsp;</td>
<td class="author-text"><a href="mailto:rnsilva@dei.uc.pt">rnsilva@dei.uc.pt</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Jorge Miguel Sa Silva (editor)</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">University of Coimbra</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Department of Informatics Engineering, Faculty of Sciences and Technology, Polo II 3030-290</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Coimbra</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Portugal</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text"></td></tr>
<tr><td class="author" align="right">EMail:&nbsp;</td>
<td class="author-text"><a href="mailto:sasilva@dei.uc.pt">sasilva@dei.uc.pt</a></td></tr>
</table>
</body></html>
