<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>A Session Initiation Protocol
  (SIP) Event Package for Session-Specific Session Policies.</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="A Session Initiation Protocol
  (SIP) Event Package for Session-Specific Session Policies.">
<meta name="keywords" content="SIP, Event Package, Session Policy">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">SIPPING Working Group</td><td class="header">V. Hilt</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Bell Labs/Alcatel-Lucent</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">G. Camarillo</td></tr>
<tr><td class="header">Expires: January 13, 2009</td><td class="header">Ericsson</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">July 12, 2008</td></tr>
</table></td></tr></table>
<h1><br />A Session Initiation Protocol
  (SIP) Event Package for Session-Specific Session Policies.<br />draft-ietf-sipping-policy-package-05</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on January 13, 2009.</p>

<h3>Abstract</h3>

<p>This specification defines a Session Initiation Protocol (SIP)
    event package for session-specific policies. This event package
    enables user agents to subscribe to session policies for a SIP
    session and to receive notifications if these policies change.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#anchor2">2.</a>&nbsp;
Terminology<br />
<a href="#sec:package">3.</a>&nbsp;
Event Package Formal Definition<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">3.1.</a>&nbsp;
Event Package Name<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">3.2.</a>&nbsp;
Event Package Parameters<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec:subbody">3.3.</a>&nbsp;
SUBSCRIBE Bodies<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">3.4.</a>&nbsp;
Subscription Duration<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">3.5.</a>&nbsp;
NOTIFY Bodies<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec:subgen">3.6.</a>&nbsp;
Subscriber generation of SUBSCRIBE requests<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec:subproc">3.7.</a>&nbsp;
Notifier processing of SUBSCRIBE requests<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec:notgen">3.8.</a>&nbsp;
Notifier generation of NOTIFY requests<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec:notproc">3.9.</a>&nbsp;
Subscriber processing of NOTIFY requests<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">3.10.</a>&nbsp;
Handling of forked requests<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">3.11.</a>&nbsp;
Rate of notifications<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">3.12.</a>&nbsp;
State Agents<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">3.13.</a>&nbsp;
Examples<br />
<a href="#sec:security">4.</a>&nbsp;
Security Considerations<br />
<a href="#sec:iana">5.</a>&nbsp;
IANA Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">5.1.</a>&nbsp;
Event Package Name<br />
<a href="#rfc.references1">6.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">6.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">6.2.</a>&nbsp;
Informative References<br />
<a href="#anchor14">Appendix&nbsp;A.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>The Framework for Session Initiation Protocol (SIP) <a class='info' href='#RFC3261'>[RFC3261]<span> (</span><span class='info'>Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;SIP: Session Initiation Protocol,&rdquo; June&nbsp;2002.</span><span>)</span></a> <a class='info' href='#I-D.ietf-sip-session-policy-framework'>Session
    Policies<span> (</span><span class='info'>Hilt, V., Camarillo, G., and J. Rosenberg, &ldquo;A Framework for Session     Initiation Protocol (SIP) Session Policies,&rdquo; April&nbsp;2008.</span><span>)</span></a> [I&#8209;D.ietf&#8209;sip&#8209;session&#8209;policy&#8209;framework] defines a protocol framework that enables a proxy
    to define and impact 
    policies on sessions such as the codecs or media types to be
    used. This framework identifies two types of session policies:
    session-specific and session-independent
    policies. Session-specific policies are policies that are created 
    for one particular session, based on the session description of
    this session. They enable a network intermediary to inspect the
    session description a UA is proposing and to return a policy
    specifically generated for this session description. For example,
    an intermediary could open pinholes in a firewall/NAT for each
    media stream in a session and return a policy that replaces the
    internal IP addresses and ports in the session description with
    external ones. Since 
    session-specific policies are tailored to a session, they only
    apply to the session they are created for. A user agent requests
    session-specific policies on a session-by-session basis at the
    time a session is created and the session description is
    known. Session-independent policies on the other hand are policies
    that are created independent of a session and generally apply to
    all the SIP sessions set up by a user agent.
</p>
<p>The <a class='info' href='#I-D.ietf-sip-session-policy-framework'>Framework for SIP
    Session Policies<span> (</span><span class='info'>Hilt, V., Camarillo, G., and J. Rosenberg, &ldquo;A Framework for Session     Initiation Protocol (SIP) Session Policies,&rdquo; April&nbsp;2008.</span><span>)</span></a> [I&#8209;D.ietf&#8209;sip&#8209;session&#8209;policy&#8209;framework] defines a 
    mechanism that enables UAs to discover the URIs of
    session-specific policy servers. This specification defines a SIP
    event package <a class='info' href='#RFC3265'>[RFC3265]<span> (</span><span class='info'>Roach, A., &ldquo;Session Initiation Protocol (SIP)-Specific Event Notification,&rdquo; June&nbsp;2002.</span><span>)</span></a> that enables UAs to
    subscribe to session-specific policies on a policy
    server. Subscribing to session-specific policies involves the
    following steps (see the <a class='info' href='#I-D.ietf-sip-session-policy-framework'>Session Policy
    Framework<span> (</span><span class='info'>Hilt, V., Camarillo, G., and J. Rosenberg, &ldquo;A Framework for Session     Initiation Protocol (SIP) Session Policies,&rdquo; April&nbsp;2008.</span><span>)</span></a> [I&#8209;D.ietf&#8209;sip&#8209;session&#8209;policy&#8209;framework]):
</p>
<p></p>
<ol class="text">
<li>A user agent submits the details of the session it is
      trying to establish to the policy server and asks whether a
      session using these parameters is permissible. For example, a
      user agent might propose a session that contains the media types
      audio and video.
</li>
<li>The policy server generates a policy decision for this
      session and returns the decision to the user agent. Possible
      policy decisions are (1) to deny the session, (2) to propose 
      changes to the session parameters with which the session would
      be acceptable, or (3) to accept the session as it was
      proposed. An example for a policy decision is to disallow the 
      use of video but agree to all other aspects of the proposed
      session.
</li>
<li>The policy server can update the policy decision at a later
      time. A policy decision update can require
      additional changes to the session (e.g., because the available
      bandwidth has changed) or deny a previously accepted session
      (i.e., disallow the continuation of a session).
</li>
</ol>

<p>The event package for session-specific policies enables a user
    agent to subscribe to the policies for a SIP session following the
    above model. The subscriber initiates a subscription by submitting
    the details of the session it is trying to establish to the
    notifier (i.e., the policy server) in the body of a SUBSCRIBE
    request. The notifier uses this information to determine the 
    policy decision for this session. It conveys the initial policy
    decision to the subscriber in a NOTIFY and all changes to this
    decision in subsequent NOTIFYs.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Terminology</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
    NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED",  "MAY", and
    "OPTIONAL" in this document are to be interpreted as described in
    <a class='info' href='#RFC2119'>RFC 2119<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a> [RFC2119].
</p>
<a name="sec:package"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Event Package Formal Definition</h3>

<p>This document provides the details for defining a SIP event
    package as required by <a class='info' href='#RFC3265'>RFC 3265<span> (</span><span class='info'>Roach, A., &ldquo;Session Initiation Protocol (SIP)-Specific Event Notification,&rdquo; June&nbsp;2002.</span><span>)</span></a> [RFC3265].
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Event Package Name</h3>

<p>The name of the event package defined in this specification
      is "session-spec-policy".
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Event Package Parameters</h3>

<p>This package defines the following two event package
      parameters:
</p>
<p></p>
<blockquote class="text"><dl>
<dt>local-only:</dt>
<dd>The "local-only" parameter is
        optional and only defined for NOTIFY requests. It MUST be
        ignored if received in a SUBSCRIBE request. The usage of the
        "local-only" parameter is described in <a class='info' href='#sec:subgen'>Section&nbsp;3.6<span> (</span><span class='info'>Subscriber generation of SUBSCRIBE requests</span><span>)</span></a>, <a class='info' href='#sec:notgen'>Section&nbsp;3.8<span> (</span><span class='info'>Notifier generation of NOTIFY requests</span><span>)</span></a> and <a class='info' href='#sec:notproc'>Section&nbsp;3.9<span> (</span><span class='info'>Subscriber processing of NOTIFY requests</span><span>)</span></a>.
</dd>
<dt>insufficient-info:</dt>
<dd>The "insufficient-info"
        parameter is optional and only defined for NOTIFY requests. It
        MUST be ignored if received in a SUBSCRIBE request. The usage
        of the "insufficient-info" parameter is described in <a class='info' href='#sec:subproc'>Section&nbsp;3.7<span> (</span><span class='info'>Notifier processing of SUBSCRIBE requests</span><span>)</span></a>, <a class='info' href='#sec:notgen'>Section&nbsp;3.8<span> (</span><span class='info'>Notifier generation of NOTIFY requests</span><span>)</span></a> and
        <a class='info' href='#sec:notproc'>Section&nbsp;3.9<span> (</span><span class='info'>Subscriber processing of NOTIFY requests</span><span>)</span></a>.
</dd>
</dl></blockquote>

<a name="sec:subbody"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
SUBSCRIBE Bodies</h3>

<p>A SUBSCRIBE for this event package MUST contain a body that
      describes a SIP session. The purpose of this body is to enable
      the notifier to generate the policies the subscriber is
      interested in. In this event package, the Request-URI, the event
      package name and event parameters are not sufficient to
      determine the resource a subscription is for. However, with the
      session description in the SUBSCRIBE body, the notifier can
      generate the requested policy decision and create policy events
      for this resource.
</p>
<p>All subscribers and notifiers MUST support the MIME type
      "application/media-policy-dataset+xml" as defined in the User Agent
      Profile Data Set for Media Policy <a class='info' href='#I-D.ietf-sipping-media-policy-dataset'>[I&#8209;D.ietf&#8209;sipping&#8209;media&#8209;policy&#8209;dataset]<span> (</span><span class='info'>Hilt, V., Camarillo, G., and J. Rosenberg, &ldquo;A User Agent Profile Data Set   for Media Policy,&rdquo; July&nbsp;2008.</span><span>)</span></a>. The
      "application/media-policy-dataset+xml" format is the default format
      for SUBSCRIBE bodies in this event package. Subscribers and
      notifiers MAY negotiate the use of other formats capable of
      representing a session. 
</p>
<p></p>
<blockquote class="text">
<p>Note: It has been proposed to directly use SDP <a class='info' href='#RFC4566'>[RFC4566]<span> (</span><span class='info'>Handley, M., Jacobson, V., and C. Perkins, &ldquo;SDP: Session Description Protocol,&rdquo; July&nbsp;2006.</span><span>)</span></a> instead of encoding the session
        descriptions in the Media Policy <a class='info' href='#I-D.ietf-sipping-media-policy-dataset'>[I&#8209;D.ietf&#8209;sipping&#8209;media&#8209;policy&#8209;dataset]<span> (</span><span class='info'>Hilt, V., Camarillo, G., and J. Rosenberg, &ldquo;A User Agent Profile Data Set   for Media Policy,&rdquo; July&nbsp;2008.</span><span>)</span></a>
        format. However, using a separate format such as the Media
        Policy format has a number of advantages over the direct use 
        of SDP: i) the Media Policy format is more flexible and allows
        the inclusion of information that can't be expressed in SDP
        (e.g., the target URI), ii) the Media Policy format enables the
        encoding of local and remote session descriptions in a single
        document (not requiring the use of MIME multipart and new
        content disposition types), and iii) it aligns the formats
        used for session-specific and session-independent policies. A
        drawback is that it requires the UA to encode SDP and session
        information in Media Policy documents.
</p>
</blockquote>

<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4"></a><h3>3.4.&nbsp;
Subscription Duration</h3>

<p>A subscription to the session-specific policy package is
      usually established at the beginning of a session and terminated
      when the corresponding session ends. A typical duration of a
      phone call is a few minutes. 
</p>
<p>Since the duration of a subscription to the session-specific
      policy package is related to the lifetime of the corresponding
      session, the value for the duration of a subscription is largely
      irrelevant. However, the duration SHOULD be longer than the typical
      duration of a session. The default subscription duration for
      this event package is set to two hours.
</p>
<p>A subscription MAY be terminated before a session ends by the
      notifier. For example, a notifier may terminate the subscription
      after the initial policy notification has been sent to the
      subscriber if it knows that these policies will not change
      during the session. A subscriber MUST NOT terminate a
      subscription unless it is terminating the session this
      subscription is for or discovers that the notifier has been
      removed from the list of policy servers relevant for this session (see
      the <a class='info' href='#I-D.ietf-sip-session-policy-framework'>Session
      Policy Framework<span> (</span><span class='info'>Hilt, V., Camarillo, G., and J. Rosenberg, &ldquo;A Framework for Session     Initiation Protocol (SIP) Session Policies,&rdquo; April&nbsp;2008.</span><span>)</span></a> [I&#8209;D.ietf&#8209;sip&#8209;session&#8209;policy&#8209;framework]).
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.5"></a><h3>3.5.&nbsp;
NOTIFY Bodies</h3>

<p>In this event package, the body of a notification contains
      the session policy requested by the subscriber. All subscribers
      and notifiers MUST support the format
      "application/media-policy-dataset+xml" <a class='info' href='#I-D.ietf-sipping-media-policy-dataset'>[I&#8209;D.ietf&#8209;sipping&#8209;media&#8209;policy&#8209;dataset]<span> (</span><span class='info'>Hilt, V., Camarillo, G., and J. Rosenberg, &ldquo;A User Agent Profile Data Set   for Media Policy,&rdquo; July&nbsp;2008.</span><span>)</span></a> as a format
      for NOTIFY bodies.
</p>
<p>The SUBSCRIBE request MAY contain an Accept header field. If
      no such header field is present, it has a default value of
      "application/media-policy-dataset+xml". If the header field is
      present, it MUST include "application/media-policy-dataset+xml", and
      MAY include any other MIME type capable of representing
      session-specific policies. As defined in <a class='info' href='#RFC3265'>RFC
      3265<span> (</span><span class='info'>Roach, A., &ldquo;Session Initiation Protocol (SIP)-Specific Event Notification,&rdquo; June&nbsp;2002.</span><span>)</span></a> [RFC3265], the body of notifications MUST be in one of the
      formats defined in the Accept header of the SUBSCRIBE request or
      in the default format.
</p>
<p>If the notifier uses the same format in NOTIFY bodies that was
      used by the subscriber in the SUBSCRIBE body
      (e.g., "application/media-policy-dataset+xml"), the notifier can expect
      that the subscriber supports all format extensions that were
      used in the SUBSCRIBE body. The notifier cannot assume that the
      subscriber supports other extensions beyond that and SHOULD NOT
      use such extensions.
</p>
<p>If the SUBSCRIBE request contained a representation of the local
      session description and the subscription was accepted, then the
      NOTIFY body MUST contain a policy for the local session
      description. If the SUBSCRIBE request of an accepted subscription
      contained the local and the remote session description, then the
      NOTIFY body MUST contain two policies, one for the local and one
      for the remote session description.
</p>
<a name="sec:subgen"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.6"></a><h3>3.6.&nbsp;
Subscriber generation of SUBSCRIBE requests</h3>

<p>The subscriber follows the general rules for generating
      SUBSCRIBE requests defined in <a class='info' href='#RFC3265'>RFC
      3265<span> (</span><span class='info'>Roach, A., &ldquo;Session Initiation Protocol (SIP)-Specific Event Notification,&rdquo; June&nbsp;2002.</span><span>)</span></a> [RFC3265]. The subscriber MUST provide sufficient information
      in the SUBSCRIBE body to fully describe the session for which it
      seeks to receive session-specific policies. The subscriber MUST
      use the most recent session description as a basis for this
      information.
</p>
<p>If the "application/media-policy-dataset+xml" format is used in
      SUBSCRIBE bodies, the subscriber MUST provide a value for each
      field that is defined for session information documents <a class='info' href='#I-D.ietf-sipping-media-policy-dataset'>[I&#8209;D.ietf&#8209;sipping&#8209;media&#8209;policy&#8209;dataset]<span> (</span><span class='info'>Hilt, V., Camarillo, G., and J. Rosenberg, &ldquo;A User Agent Profile Data Set   for Media Policy,&rdquo; July&nbsp;2008.</span><span>)</span></a> and for which
      the subscriber has information available. In other words, the
      subscriber MUST fill in the elements of a session information
      document as complete as possible. If the subscriber supports
      extensions of the "application/media-policy-dataset+xml" format,
      the subscriber MUST also provide a value for each field defined
      by this extension for session information documents, if
      possible. Providing as much information as possible avoids that
      a session is rejected due to a lack of session information and
      the negotiation of the information to be disclosed between
      notifier and subscriber. 
</p>
<p>Subscriptions to this event package are typically created in
      conjunction with an SDP offer/answer exchange <a class='info' href='#RFC3264'>[RFC3264]<span> (</span><span class='info'>Rosenberg, J. and H. Schulzrinne, &ldquo;An Offer/Answer Model with Session Description Protocol (SDP),&rdquo; June&nbsp;2002.</span><span>)</span></a> during the establishment of a session (see
      the <a class='info' href='#I-D.ietf-sip-session-policy-framework'>Session
      Policy Framework<span> (</span><span class='info'>Hilt, V., Camarillo, G., and J. Rosenberg, &ldquo;A Framework for Session     Initiation Protocol (SIP) Session Policies,&rdquo; April&nbsp;2008.</span><span>)</span></a> [I&#8209;D.ietf&#8209;sip&#8209;session&#8209;policy&#8209;framework]). If used with an offer/answer exchange,
      the subscriber MUST insert  
      the representation of the local session description in the
      SUBSCRIBE body. The local session description is the one that
      was created by the subscriber (e.g., the offer if the subscriber
      has initiated the offer/answer exchange). Under certain
      circumstances, a UA may not have a session description when
      subscribing to session-specific policies, for example, when it
      is composing an empty INVITE request (i.e., an INVITE request
      that does not contain an offer). In these cases, a UA SHOULD
      establish a subscription without including a representation of
      the local session description. The UA MUST refresh the
      subscription with a SUBSCRIBE request that contains this session
      description as soon as the session description becomes
      available, for example, when the UA receives a 200 OK to an
      empty INVITE request. A policy server can choose to admit a
      session only after the UA has disclosed the session
      descriptions.
</p>
<p>The subscriber SHOULD also include a representation of the
      remote session description in the SUBSCRIBE body. The remote
      session description is the one the subscriber has received
      (i.e., the answer if the subscriber has initiated the
      offer/answer exchange). In some scenarios, the remote session
      description is not available to the subscriber at the time the
      subscription to session-specific policies is established. In
      this case, the initial SUBSCRIBE message SHOULD only contain a
      representation of the local session description. When the remote
      description becomes available, the subscriber SHOULD refresh the 
      subscription by sending another SUBSCRIBE request, which then 
      contains the local and the remote session description, unless
      the subscriber has received a NOTIFY with the "local-only"
      parameter. This parameter indicates that the notifier does not
      need to see the remote session description.
</p>
<p>A user agent can change the session description of an ongoing
      session. A change in the session description will typically
      affect the policy decisions for this session. A subscriber MUST
      refresh the subscription to session-specific policies every time
      the session description of a session changes. It does this by
      sending a SUBSCRIBE request, which contains the details of the
      updated session descriptions.
</p>
<p>A subscriber may receive an error that indicates a server
      failure in response to a SUBSCRIBE request. In this case, the
      subscriber SHOULD try to locate an alternative server, for
      example, using the procedures described in <a class='info' href='#RFC3263'>[RFC3263]<span> (</span><span class='info'>Rosenberg, J. and H. Schulzrinne, &ldquo;Session Initiation Protocol (SIP): Locating SIP Servers,&rdquo; June&nbsp;2002.</span><span>)</span></a>. If no alternative server can be located,
      the subscriber MAY continue with the session for which it wanted 
      to receive session-specific policies without subscribing to
      session-specific policies. This is to avoid that a failed policy
      server prevents a UA from setting up or continuing with a
      session. Since the sessions created by the UA may not be policy
      compliant without this subscription, they may be blocked by
      policy enforcement mechanisms if they are in place.
</p>
<p>Session policies can contain sensitive information. Moreover,
      policy decisions can significantly impact the behavior of a user
      agent. A user agent should therefore verify the identity of a
      policy server and make sure that policies have not been altered
      in transit. All implementations of this package MUST support TLS
      <a class='info' href='#RFC4346'>[RFC4346]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.1,&rdquo; April&nbsp;2006.</span><span>)</span></a> and the SIPS URI scheme. A subscriber
      SHOULD use SIPS URIs when subscribing to session-specific
      policies so that policies are transmitted over TLS. See <a class='info' href='#sec:security'>Section&nbsp;4<span> (</span><span class='info'>Security Considerations</span><span>)</span></a>.
</p>
<a name="sec:subproc"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.7"></a><h3>3.7.&nbsp;
Notifier processing of SUBSCRIBE requests</h3>

<p>All subscriptions to session-specific policies SHOULD be
      authenticated and authorized before approval. However, a policy
      server may frequently encounter UAs it cannot authenticate. In
      these cases, the policy server MAY provide a generic policy that
      does not reveal sensitive information to these UAs. For details
      see <a class='info' href='#sec:security'>Section&nbsp;4<span> (</span><span class='info'>Security Considerations</span><span>)</span></a>.
</p>
<p>The authorization policy is at the discretion of the
      administrator. In general, all users SHOULD be allowed to
      subscribe to the session-specific policies of their sessions. A
      subscription to this event package will typically be established
      by a device that needs to know about the policies for its
      sessions. However, subscriptions may also be established by
      applications (e.g., a conference server). In those cases, an
      authorization policy will typically be provided for these
      applications.
</p>
<p>Responding in a timely manner to a SUBSCRIBE request is
      crucial for this event package. A notifier must minimize the
      time needed for processing SUBSCRIBE requests and generating the
      initial NOTIFY. This includes minimizing the time needed to
      generate an initial policy decision. A short response time is in
      particular important for this event package since it minimizes
      the delay for fetching policies during an INVITE transaction and
      therefore reduces call setup time. In addition, subscriptions to
      session-specific policies can be established while the
      subscriber is in an INVITE transaction at a point where it has 
      received the 200 OK but before sending the ACK. Delaying the 
      creation of the initial NOTIFY would delay the transmission of
      the ACK. A more detailed discussion of this scenario can be
      found in the <a class='info' href='#I-D.ietf-sip-session-policy-framework'>Session Policy
      Framework<span> (</span><span class='info'>Hilt, V., Camarillo, G., and J. Rosenberg, &ldquo;A Framework for Session     Initiation Protocol (SIP) Session Policies,&rdquo; April&nbsp;2008.</span><span>)</span></a> [I&#8209;D.ietf&#8209;sip&#8209;session&#8209;policy&#8209;framework].
</p>
<p>A subscriber may not have disclosed enough information in the
      SUBSCRIBE request to enable the notifier to generate a policy
      decision. For example, a UA may have subscribed to
      session-specific policies without including the representation 
      of a session description. The policy server SHOULD accept such a
      subscription. The policy server SHOULD generate a NOTIFY request
      that includes the "insufficient-info" event package parameter. A
      NOTIFY request with this parameter indicates that a policy
      decision could not be made due to insufficient information. The
      body of such a NOTIFY request can either be empty or
      contain a policy decision document that provides hints about
      which information was missing.
</p>
<a name="sec:notgen"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.8"></a><h3>3.8.&nbsp;
Notifier generation of NOTIFY requests</h3>

<p>A notifier sends a notification in response to SUBSCRIBE
      requests as defined in <a class='info' href='#RFC3265'>RFC
      3265<span> (</span><span class='info'>Roach, A., &ldquo;Session Initiation Protocol (SIP)-Specific Event Notification,&rdquo; June&nbsp;2002.</span><span>)</span></a> [RFC3265]. In addition, a notifier MAY send a notification at
      any time during the subscription. Typically, it will send one
      every time the policy decision this subscription is for has
      changed. When and why a policy decision changes is entirely at
      the discretion of the administrator. A policy decision can
      change for many reasons. For example, a network may become
      congested due to an increase in traffic and reduce the
      bandwidth available to an individual user. Another example is a
      session that has been started during "business hours" and
      continues into "evening hours" where more bandwidth or video
      sessions are available to the user according to the service
      level agreement.
</p>
<p>Policy decisions are expressed in the format negotiated for
      the NOTIFY body (e.g., "application/media-policy-dataset+xml"). The
      policy document in a NOTIFY body MUST represent a complete
      policy decision. Notifications that contain the deltas to
      previous policy decisions or partial policy decisions are not
      supported in this event package.
</p>
<p>The notifier SHOULD terminate the subscription if the policy
      decision is to reject a session and if it can be expected that
      this decision will not change in the foreseeable future. The
      notifier SHOULD keep the subscription alive, if it rejects a
      session but expects that the session can be admitted soon. For
      example, if the session was rejected due to a temporary shortage
      of resources and the notifier expects that these resources will
      become available again shortly it should keep the subscription
      alive. The decision to reject a session is expressed in the
      policy decision document. A session is admitted by returning a
      policy decision document that requires some or no changes to the
      session.
</p>
<p>If the notifier has not received enough information to make a
      policy decision from the subscriber (e.g., because it did not
      receive a session description), the notifier SHOULD NOT
      terminate the subscription since it can be expected that the UA
      refreshes the subscription with a SUBSCRIBE request that
      contains more information. The notifier SHOULD generate a NOTIFY
      request with the "insufficient-info" event package parameter to
      indicate that a policy decision could not be made due to
      insufficient information. This NOTIFY request can contain an
      empty body or a body that contains a policy decision document
      indicating which information was missing.
</p>
<p>Some session-specific policies do not require the disclosure
      of the remote session description to the notifier. If a notifier
      determines that this is the case after receiving a SUBSCRIBE
      request, the notifier SHOULD include the "local-only" event
      parameter in NOTIFY requests.
</p>
<a name="sec:notproc"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.9"></a><h3>3.9.&nbsp;
Subscriber processing of NOTIFY requests</h3>

<p>A subscriber MUST apply the policy decision received in a
      NOTIFY to the session associated with this subscription. If the
      UA decides not to apply the received policy decision, the UA MUST
      NOT set up the session and MUST terminate the session if the
      session is already in progress. If the UA has a pending INVITE
      transaction for this session, the UA MUST cancel or reject the
      INVITE request.
</p>
<p>If the subscriber receives a NOTIFY indicating that the
      session has been rejected, the subscriber MUST NOT attempt to
      establish this session. If the notifier has terminated the
      subscription after rejecting the session, the subscriber SHOULD
      NOT try to re-send the same SUBSCRIBE request again. The
      termination of the subscription by the notifier indicates that
      the policy decision for this session is final and will not
      change in the foreseeable future. The subscriber MAY try to
      re-subscribe for this session if at least one aspect of the
      session (e.g., a parameter in the session description or the
      target URI) has changed or if there is other reason to believe
      that re-trying the subscription will be successful (e.g.,
      because time has progressed significantly since the last
      attempt).
</p>
<p>The notifier may keep up the subscription after rejecting a 
      session to indicate that it may send an updated policy decision
      for this session to the subscriber at a later time. This is
      useful, for example, if the session was rejected due to a
      temporary shortage of resources and the notifier expects that
      this problem to be resolved shortly. In another example, the
      session was rejected because it was attempted in a restricted
      period during the day but this period is going to end soon. In
      this case, the subscriber SHOULD not terminate the subscription
      to session-specific policies.
</p>
<p>The subscriber may receive a NOTIFY which contains an
      "insufficient-info" event package parameter to indicate that the
      SUBSCRIBE request did not contain enough information. The
      subscriber SHOULD refresh the subscription with more complete
      information as soon as the missing information (e.g., the
      session description) is available.
</p>
<p>A subscriber may receive an update to a policy decision for a
      session that is already established. The subscriber MUST apply
      the new policy decision to this session. If a UA decides that it
      does not want to apply the new policy decision, the UA MUST
      terminate the session. An updated policy decision may require
      the UA to generate a re-INVITE or UPDATE request in this session
      if the session description has changed or it may need to
      terminate this session. A policy update that requires a UA to
      terminate a session can, for example, be triggered by the users
      account running out of credit or the detection of an emergency
      that requires the termination of non-emergency calls.
</p>
<p>If the subscriber receives a NOTIFY that contains the
      "local-only" event parameter, the subscriber SHOULD NOT include
      the remote session description in subsequent SUBSCRIBE requests
      within this subscription.
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.10"></a><h3>3.10.&nbsp;
Handling of forked requests</h3>

<p>This event package allows the creation of only one dialog as
      a result of an initial SUBSCRIBE request. The techniques to
      achieve this behavior are described in <a class='info' href='#RFC3265'>[RFC3265]<span> (</span><span class='info'>Roach, A., &ldquo;Session Initiation Protocol (SIP)-Specific Event Notification,&rdquo; June&nbsp;2002.</span><span>)</span></a>.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.11"></a><h3>3.11.&nbsp;
Rate of notifications</h3>

<p>It is anticipated that the rate of policy changes will be
      very low. In any case, notifications SHOULD NOT be generated at
      a rate of more than once every five seconds.
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.12"></a><h3>3.12.&nbsp;
State Agents</h3>

<p>State agents play no role in this package.
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.13"></a><h3>3.13.&nbsp;
Examples</h3>

<p>The following message flow illustrates how a user agent
      (Alice's phone) can subscribe to session-specific policies when
      establishing a call (here to Bob's phone). The flow assumes that
      the user agent has already received the policy server URI
      (e.g., through configuration or as described in the <a class='info' href='#I-D.ietf-sip-session-policy-framework'>Session Policy
      Framework<span> (</span><span class='info'>Hilt, V., Camarillo, G., and J. Rosenberg, &ldquo;A Framework for Session     Initiation Protocol (SIP) Session Policies,&rdquo; April&nbsp;2008.</span><span>)</span></a> [I&#8209;D.ietf&#8209;sip&#8209;session&#8209;policy&#8209;framework]) and it does not show messages for
      authentication on a transport or SIP level.
</p>
<p>These call flow examples are informative and not
      normative. Implementers should consult the main text of this 
      document for exact protocol details.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

Policy Server          Alice                Bob
     |                   |                   |
     |(1) SUBSCRIBE      |                   |
     |&lt;------------------|                   |
     |(2) 200 OK         |                   |
     |------------------&gt;|                   |
     |(3) NOTIFY         |                   |
     |------------------&gt;|                   |
     |(4) 200 OK         |                   |
     |&lt;------------------|                   |
     |                   |(5) INVITE         |
     |                   |------------------&gt;|
     |                   |                   |
     |                   |(6) 200 OK         |
     |                   |&lt;------------------|
     |                   |(7) ACK            |
     |                   |------------------&gt;|
     |(8) SUBSCRIBE      |                   |
     |&lt;------------------|                   |
     |(9) 200 OK         |                   |
     |------------------&gt;|                   |
     |(10) NOTIFY        |                   |
     |------------------&gt;|                   |
     |(11) 200 OK        |                   |
     |&lt;------------------|                   |
     |                   |                   |



   Message Details

      (1) SUBSCRIBE  Alice -&gt; Policy Server

      SUBSCRIBE sips:policy@biloxi.example.com SIP/2.0
      Via: SIP/2.0/TLS pc.biloxi.example.com:5061
       ;branch=z9hG4bK74bf
      Max-Forwards: 70
      From: Alice &lt;sips:alice@biloxi.example.com&gt;;tag=8675309
      To: PS &lt;sips:policy@biloxi.example.com&gt;
      Call-ID: rt4353gs2egg@pc.biloxi.example.com
      CSeq: 1 SUBSCRIBE
      Contact: &lt;sips:alice@pc.biloxi.example.com&gt;
      Expires: 7200
      Event: session-spec-policy
      Accept: application/media-policy-dataset+xml
      Content-Type: application/media-policy-dataset+xml
      Content-Length: ...

      [Local session description (offer)]


      (2) 200 OK  Policy Server -&gt; Alice

      (3) NOTIFY  Policy Server -&gt; Alice

      NOTIFY sips:alice@pc.biloxi.example.com SIP/2.0
      Via: SIP/2.0/TLS srvr.biloxi.example.com:5061
       ;branch=z9hG4bK74br
      Max-Forwards: 70
      From: PS &lt;sips:policy@biloxi.example.com&gt;;tag=31451098
      To: Alice &lt;sips:alice@biloxi.example.com&gt;;tag=8675309
      Call-ID: rt4353gs2egg@pc.biloxi.example.com
      CSeq: 1 NOTIFY
      Event: session-spec-policy
      Subscription-State: active;expires=7200
      Content-Type: application/media-policy-dataset+xml
      Content-Length: ...

      [Policy for local session description (offer)]


      (4) 200 OK  Alice -&gt; Policy Server

      (5) INVITE  Alice -&gt; Bob

      (6) 200 OK  Bob -&gt; Alice

      (7) ACK  Alice -&gt; Bob

      (8) SUBSCRIBE  Alice -&gt; Policy Server

      SUBSCRIBE sips:policy@biloxi.example.com SIP/2.0
      Via: SIP/2.0/TLS pc.biloxi.example.com:5061
       ;branch=z9hG4bKna998sl
      Max-Forwards: 70
      From: Alice &lt;sips:alice@biloxi.example.com&gt;;tag=8675309
      To: PS &lt;sips:policy@biloxi.example.com&gt;;tag=31451098
      Call-ID: rt4353gs2egg@pc.biloxi.example.com
      CSeq: 2 SUBSCRIBE
      Expires: 7200
      Event: session-spec-policy
      Accept: application/media-policy-dataset+xml
      Content-Type: application/media-policy-dataset+xml
      Content-Length: ...

      [Local session description (offer)]
      [Remote session description (answer)]


      (9) 200 OK  Policy Server -&gt; Alice

      (10) NOTIFY  Policy Server -&gt; Alice

      NOTIFY sips:alice@pc.biloxi.example.com SIP/2.0
      Via: SIP/2.0/TLS srvr.biloxi.example.com:5061
       ;branch=z9hG4bKna998sk
      Max-Forwards: 70
      From: PS &lt;sips:policy@biloxi.example.com&gt;;tag=31451098
      To: Alice &lt;sips:alice@biloxi.example.com&gt;;tag=8675309
      Call-ID: rt4353gs2egg@pc.biloxi.example.com
      CSeq: 2 NOTIFY
      Event: session-spec-policy
      Subscription-State: active;expires=7200
      Content-Type: application/media-policy-dataset+xml
      Content-Length: ...

      [Policy for local session description (offer)]
      [Policy for remote session description (answer)]


      F6 200 OK  Alice -&gt; Policy Server

</pre></div>
<a name="sec:security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Security Considerations</h3>

<p>Session policies can significantly change the behavior of a
    user agent and can therefore be used by an attacker to compromise
    a user agent. For example, session policies can be used to prevent
    a user agent from successfully establishing a session (e.g., by
    setting the available bandwidth to zero). Such a policy can be
    submitted to the user agent during a session, which may cause the
    UA to terminate the session.
</p>
<p>A user agent transmits session information to a policy server.
    This information may contain sensitive data the user may not want
    an eavesdropper or an unauthorized policy server to see. For
    example, the session information may contain the encryption keys
    for media streams. Vice versa, session policies may also contain
    sensitive information about the network or service level
    agreements the service provider may not want to disclose to an
    eavesdropper or an unauthorized user agent.
</p>
<p>It is therefore important to secure the communication between
    the user agent and the policy server. The following three discrete
    attributes need to be protected:
</p>
<p></p>
<ol class="text">
<li>authentication of the policy server and, if needed, the user
      agent,
</li>
<li>confidentiality of the messages exchanged between the user
      agent and the policy server and
</li>
<li>ensuring that private information is not exchanged between
      the two parties, even over a confidentiality-assured and
      authenticated session.
</li>
</ol>

<p>The confidentiality of the messages exchanged between the two
    parties can be protected by encrypting the data stream through a
    TLS session using the cipher suites specified in <a class='info' href='#RFC3261'>[RFC3261]<span> (</span><span class='info'>Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;SIP: Session Initiation Protocol,&rdquo; June&nbsp;2002.</span><span>)</span></a>.
</p>
<p>Accordingly, policy servers SHOULD be addressable only through
    a SIPS URI. Policy server and user agent MUST support TLS. The
    confidentiality of the communication between the policy server and
    the user agent will be assured as long as the policy server
    supports TLS and is reached through a SIPS URI.
</p>
<p>Authenticating the two parties can be performed using X.509
    certificates exchanged through TLS and other techniques such as
    HTTP Digest. When the user agent establishes a TLS session with
    the policy server, the policy server will present it a X.509
    certificate.  The user agent SHOULD ensure that the identity of
    the policy server encoded in the certificate matches the URI of
    the policy server the user agent has received either using the
    <a class='info' href='#I-D.ietf-sip-session-policy-framework'>Session
    Policy Framework<span> (</span><span class='info'>Hilt, V., Camarillo, G., and J. Rosenberg, &ldquo;A Framework for Session     Initiation Protocol (SIP) Session Policies,&rdquo; April&nbsp;2008.</span><span>)</span></a> [I&#8209;D.ietf&#8209;sip&#8209;session&#8209;policy&#8209;framework] or other means such as configuration.
</p>
<p>When a policy server receives a new subscription (as opposed to
    a refresh subscription), the policy server SHOULD try to
    authenticate the user agent using any means at its disposal. If
    the user agent has a TLS certificate, the identity of the user
    agent SHOULD be contained in the certificate, or if the user agent
    does not possess a certificate, the policy server SHOULD challenge
    the user agent using HTTP Digest. A policy server may frequently
    encounter UAs it cannot authenticate. In these cases, the policy
    server MAY provide a generic policy that does not reveal sensitive
    information to these UAs.
</p>
<p>And finally, the fact that the user agent and the policy server
    have successfully authenticated each other and have established a
    secure TLS session does not absolve either one from ensuring that
    they do not communicate sensitive information. For example, a
    session description may contain sensitive information -- session
    keys, for example -- that the user agent may not want to share
    with the policy server; and indeed, the policy server does not
    need such information to effectively formulate a policy.  Thus,
    the user agent should not insert such sensitive information in a
    session information document that it sends to the policy server.
    Likewise, the policy server may have information that is sensitive
    and of no use to the user agent -- network service level
    agreements, or network statistics, for example.  Thus, the policy
    server should refrain from transmitting such information to the
    user agent.
</p>
<a name="sec:iana"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
IANA Considerations</h3>

<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Event Package Name</h3>

<p>This specification registers an event package, based on the
    registration procedures defined in <a class='info' href='#RFC3265'>RFC
    3265<span> (</span><span class='info'>Roach, A., &ldquo;Session Initiation Protocol (SIP)-Specific Event Notification,&rdquo; June&nbsp;2002.</span><span>)</span></a> [RFC3265]. The following is the information required for such a 
    registration:
</p>
<p>Package Name: session-spec-policy
</p>
<p>Package or Template-Package: This is a package.
</p>
<p>Published Document: RFC XXXX (Note to RFC Editor: Please fill
    in XXXX with the RFC number of this specification).
</p>
<p>Person to Contact: Volker Hilt, volkerh@bell-labs.com.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>6.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.ietf-sip-session-policy-framework">[I-D.ietf-sip-session-policy-framework]</a></td>
<td class="author-text">Hilt, V., Camarillo, G., and J. Rosenberg, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-sip-session-policy-framework-03.txt">A Framework for Session
    Initiation Protocol (SIP) Session Policies</a>,&rdquo; draft-ietf-sip-session-policy-framework-03 (work in progress), April&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-sip-session-policy-framework-03.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-sipping-media-policy-dataset">[I-D.ietf-sipping-media-policy-dataset]</a></td>
<td class="author-text">Hilt, V., Camarillo, G., and J. Rosenberg, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-sipping-media-policy-dataset-07.txt">A User Agent Profile Data Set
  for Media Policy</a>,&rdquo; draft-ietf-sipping-media-policy-dataset-07 (work in progress), July&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-sipping-media-policy-dataset-07.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3261">[RFC3261]</a></td>
<td class="author-text">Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;<a href="http://tools.ietf.org/html/rfc3261">SIP: Session Initiation Protocol</a>,&rdquo; RFC&nbsp;3261, June&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3261.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3263">[RFC3263]</a></td>
<td class="author-text">Rosenberg, J. and H. Schulzrinne, &ldquo;<a href="http://tools.ietf.org/html/rfc3263">Session Initiation Protocol (SIP): Locating SIP Servers</a>,&rdquo; RFC&nbsp;3263, June&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3263.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3265">[RFC3265]</a></td>
<td class="author-text">Roach, A., &ldquo;<a href="http://tools.ietf.org/html/rfc3265">Session Initiation Protocol (SIP)-Specific Event Notification</a>,&rdquo; RFC&nbsp;3265, June&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3265.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4346">[RFC4346]</a></td>
<td class="author-text">Dierks, T. and E. Rescorla, &ldquo;<a href="http://tools.ietf.org/html/rfc4346">The Transport Layer Security (TLS) Protocol Version 1.1</a>,&rdquo; RFC&nbsp;4346, April&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4346.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>6.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC3264">[RFC3264]</a></td>
<td class="author-text">Rosenberg, J. and H. Schulzrinne, &ldquo;<a href="http://tools.ietf.org/html/rfc3264">An Offer/Answer Model with Session Description Protocol (SDP)</a>,&rdquo; RFC&nbsp;3264, June&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3264.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4566">[RFC4566]</a></td>
<td class="author-text">Handley, M., Jacobson, V., and C. Perkins, &ldquo;<a href="http://tools.ietf.org/html/rfc4566">SDP: Session Description Protocol</a>,&rdquo; RFC&nbsp;4566, July&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4566.txt">TXT</a>).</td></tr>
</table>

<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Acknowledgements</h3>

<p>Many thanks to Jonathan Rosenberg for the discussions and
  suggestions for this draft. Many thanks to Roni Even, Bob
  Penfield, Mary Barnes, Shida Schubert and Jon Peterson for reviewing
  the draft and to Vijay Gurbani for the contributions to the security 
  considerations section.
</p>
<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Volker Hilt</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Bell Labs/Alcatel-Lucent</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">791 Holmdel-Keyport Rd</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Holmdel, NJ  07733</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:volkerh@bell-labs.com">volkerh@bell-labs.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Gonzalo Camarillo</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Ericsson</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Hirsalantie 11</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Jorvas  02420</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Finland</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:Gonzalo.Camarillo@ericsson.com">Gonzalo.Camarillo@ericsson.com</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2008).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
