Network Working Group                                   Sudhin Jacob
Internet Draft                                        Juniper Networks
Intended Status: Experimental                       

                                                     sep 15, 2015

     
	 
	 Ethernet LDP( Label Distribution with out IP and routing protocols)
       			draft-jacob-mpls-ethldp-02.txt                    

Abstract

MPLS is the heart and soul of the service provider network. MPLS
can carry anydata payload which gives the flexibility to the service 
provider to provision new service with any expense.The benefit of this
technology is core router need not understand  the full customer route.
If the service a layer 2 then thereis no need of vrf, for customer the
service provider cloud is like a virtual switch.The protocol used for 
label distribution is LDP, BGP,RSVP. The most popular protocol for 
outer label distribution is LDP. LDP has the benefit of  adding more TLV to
its payload. In this the possibility of using ldp for generating labels 
for mac address rather for ip address which gives  the benefit to service
provider not to run complex routing protocol on core, this does not require
ip address. This gives service provider the flexibility to deploy any services, 
there is no need for changes in network layer when the customer goes for
ipv4 to ipv6. This can reduce the CAPEX and OPEX of the customer and reduces
the hardware cost too.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at http://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on April 15, 2015.

Copyright Notice

   Copyright (c) 2015 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (http://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of



   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.



























Table of Contents

1.Introduction.....................................................3
2.Eth-ldp Problem Statement........................................4
3.How Eth-ldp will work............................................4
3.4 ETH-LDP  for Customer Networks.................................7
3.5 ETH-LDP  handling BUM from multihomed CE.......................8
3.5 ETH-LDP Split Horizon label,Load balancing label...............10
4.1. Normative References..........................................11

















1.Introduction

The current technologies require ip address to establish a label advertising 
protocol.This paper  explains to have label adevertisement with out the ip address
and routing protocol.This saves the configuration ,provisioning and trobleshooting 
time. In this there is no requirment of routing protocol to advertise the loopback
address of the routers infact this have the cpablity to generate label per interface
so this is very helpful in load balancing the traffic.Once this is configured on 
interface it will pick up the interface mac address  and it will start communicating
automatically with the help of interface mac address. Once the hello is exchanged between
the two routers  the adjacencies are formed. Once the adjacency is established then 
it can start exchange labels.The label mapping message will be exchanged to the 
neighbor router, it will generate labels for its entire connected interfaces. 
These labels will be generated for mac addresses instead of IP addresses.
The labels are generated  for mac address instead of IP address there 
will be changes in the normal ldp TLV.This can reduce the overall cost of operation
 and maintenance.  The benefit is we can extend the label switching to metro ring and
remove the complex configurations and  vlan tagging.



















2. Problem Statement

There are different transport mechansim to carry customer data which requires
IP address, Eth-LDP addresses the fact that the data from a layer 2 network
from one geographical location to another can be transported to another using mac
ldp which is simpler reduces the overhead to the Service provider and gives the customer
more flexiblity to control the network.



 
 
 
 



3.How ETH-LDP will work

Router A----------------------Router B------------------Router C
                        
Example: 1

Consider three routers A, B and C the interfaces are connected. There are no 
other protocols configured in these routers.Once we enable Ethernet LDP over
the interface, it sends hello message, once hello message is received from the neighbor
router both the routers receives from the neighbor router the adjacency is established.
Once the adjacency is established,it sends label mapping message with labels for the 
connected interface and labels received from the other routers.Once the router gets
the label after processing it updates the LIB so the router A knows the label to reach
router C and vice versa. For example Router C advertise label 20 for its connected mac 
address it sends to Router B and router B sends label 21 for its connected mac address 
as well for the mac address of other routers reachable via router B to router A.
Router A sends label 23 for its connected interface to router B and the router B 
sends label 24 to router C for its connected interface and mac address of other routers 
reachable through B to router C.When the data packet arrives at router A destined to router B,
the label 21 is pushed by router A and send to router B.In router B the label swap 
operation is performed, router B knows once it gets a packet with label 20 it has to swap 
operation with label 21 and forwards the packet to to router C.  The same operation 
is performed when the return packet goes from  router C to router A. Router C pushes label 24 
sends to router B and it swaps label with 23 and sends it to A.




3.1 ETH-LDP Hellos and Adjacency formations 

ETH-LDP Hello TLV
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   | Version                       |         PDU Length             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                         LDP Identifier                        |
   +                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


   0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |U|F|        Type               |            Length             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   |                             Value                             |
   ~                                                               ~
   |                                                               |
   |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Here the header will version will be 1; ldp identifier will be the mac address of the router or
configured ID for identifying the router.The hello TLV consist of hold timer,flags, etc the
transport address is removed from this because the communication is based on the mac address.
The router will send hello at the configured hold interval divided by 3. The router is not
receiving hello it will mark the neighbor down  once the hold time is expired.
The adjacency is lost all the labels learned from the peer will be flushed. 
The format of the hello message is same like ipv4 ldp but certain fields are modified to
carry out the operation. The hello message id is same 0x100.






3.2 ETH-LDP Label Advertisements 
                            +-----------+                        +------------+
                            |           |                        |            |
                            |           |                        |            |
                            |   A       |---------------------------          |
                            |           |                        |  B         |
                            |           |                        |            |
                            +--|--------+                        |            |
                               |     --                          +-----|------+
                               |       --                       ---    |
                               |         --                  ---       |
                               |           --              --          |
                               |             --         ---            |
                               |          +---------------+            |
                               |          |               |            |
                               |          |               |            |
                              |           |    C          |            |
                              |           |               |            |
                              |           |               |            |
                              |           +---------------+            |
                              |             --          --             |
                              |          ---              --           |
                              |        --                   ---        |
                              |     ---                        --      |
                              |   --                             --    |
                          +---|--------------+             +-----------|----+
                          |                  |             |                |
                          |                  |             |                |
                          |   D              ----------------               |
                          |                  |             |     E          |
                          |                  |             |                |
                          |                  |             |                |
                          +------------------+             +----------------+

          

                  



Since we are not using routing protocol for label advertisements so routers dont have any 
idea for preventing loops because for the same mac address it receives labels from multiple
sources. In order to avoid this scenario the label advertisement message must carry labels 
along with hop count (distance) so the router receives multiple labels from routers it will
select only the lowest hop count (distance). It will not accept the labels for itself from others.
The label must be generated for per platform basis. For example Router D generates label for its
connected mac address to Router A and it advertises the same to router C and router B, router C
and B advertises about router D labels to router  A along with hop count when router A compares
the labels received for router D mac address from Router B,D and C.Router A sees labels for reaching router D 
is lowest from router D so it takes labels for destination in router D from router D because of its lowest
hop count. This prevents the loops. The other two details are cached in times of failure that can be used.
The behavior is different when there is multiple links from same router there remote mac address will 
have multiple labels based on  links and it will load balance based on different labels. 
 
 

   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |0|0| Hop Count                 |      Length                   |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     HC  Value |
   +-+-+-+-+-+-+-+-+


3.3 ETH-LDP Label Withdrawal

When the link is down the ETH-LDP sends a withdrawal message to withdraw the mac addess
and the label ascociated to it for the remote PE router.Then the label will be flushed
from the label database.


3.4 ETH-LDP  for Customer Networks

The PE routers which are connected to service provider can converged using above mentioned
mechanism.When the customer wants to be connected the service provider msut know what all
edge routers the customer traffic must be dropped.

                                
                                          

CE1--------PE1

              --------------P---------------------PE2--------CE3

CE2---------PE1

                      


											


Consider the above network customer A is multihomed and he wants to connect to remote
site located at PE2,the service provider will make a connection to remote PE2 from PE1 
and viceversa from PE2 to PE1.Once that is done the PE1 will generate a labels for BUM
traffic,for unicast mac address,PE2 will generate the same for customer A. When the 
traffic comes CE1 the PE1 will put the BUM label then PE1 will put the outer label
and forward the packet so once the packet reaches PE2 the label look up is done based on the
inner label the packet is put in the correct instances.

3.5 ETH-LDP  handling BUM from multihomed CE

When the BUM traffic is orginated from one of the multihomed CE, it will not send the traffic
back based on split horizon.When it is multihoming to different PE,one of PE will be elected 
as forwarder for this while configuring the PE's who all are in multihoming there must be
a TLV which shows it is multihoming.So PE's sends targetted ETH-LDP with multihoming flag set.
so based on the PE the PE with highest mac address is elected as DF, or there we can set priority
to select the DF so that we can control the forwarder election,the default priority is 1.
First it will check the highest priority, if there is a tie then it will select the highest mac address.
The DF will forward the BUM traffic. Once DF is elected it will send split horizon label to 
other non DF router to send BUM traffic, if the BUM traffic is comming to non DF routers it will
drop the traffic.Once the BUM traffic is coming to DF with split horizon label it will drop that
traffic to avoid loops.the DF will send loadbalancing labels to all routers excpet the multihoming
PE's this way it will load balance the traffic.



   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |0|0| Flags                     |      priority                 |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     HC  Value |
   +-+-+-+-+-+-+-+-+
   
   
 3.5 ETH-LDP Split Horizon label,Load balancing label
 
 
The above labels will be generated for multihoming PE's once the DF is elected, DF will send split
horizon label label to non DF's. This is used to prevent blocking BUM traffic sending back to 
the multihomed site.Once the BUM traffic recieved from attached CE's to non DF PE's it will 
use split horizon label to send it to DF PE's, it will add the BUM label,split horizon label
and outer label to reach to remote PE.Once it reaches the DF PE it sees the split horizon label,
it will drop the traffic.The load balancing label will be used to load balancing the traffic from remote 
PE's to multihoming PE's. This labels will be advertised by DF to remote PE's  so it will use to load balance
the traffic from remote PE to multihoming PE's



















 References
4.1. Normative References
[RFC5036] LDP Psecifications L. Andersson, Ed.





















Author Addresses
Sudhin Jacob
Bangalore, India
Email:sjacob@juniper.net
Email: sudhinjacob@rediffmail.com
