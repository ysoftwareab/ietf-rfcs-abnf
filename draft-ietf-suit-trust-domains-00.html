<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>SUIT Manifest Extensions for Multiple Trust Domains</title>
<meta content="Brendan Moran" name="author">
<meta content="
       This specification describes extensions to the SUIT manifest format (as
defined in  ) for use in deployments with
multiple trust domains. A device has more than one trust domain when it
uses different trust anchors for different purposes or components in the
context of firmware update. 
    " name="description">
<meta content="xml2rfc 3.12.3" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-ietf-suit-trust-domains-00" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.12.3
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.8.0
    MarkupSafe 2.0.1
    pycountry 22.1.10
    pyflakes 2.4.0
    PyYAML 6.0
    requests 2.27.1
    setuptools 59.6.0
    six 1.16.0
    WeasyPrint 52.5
-->
<link href="/tmp/draft-ietf-suit-trust-domains-w6xy04tj.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">SUIT Trust Domains</td>
<td class="right">March 2022</td>
</tr></thead>
<tfoot><tr>
<td class="left">Moran</td>
<td class="center">Expires 8 September 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">SUIT</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-suit-trust-domains-00</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2022-03-07" class="published">7 March 2022</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-09-08">8 September 2022</time></dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">B. Moran</div>
<div class="org">Arm Limited</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">SUIT Manifest Extensions for Multiple Trust Domains</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This specification describes extensions to the SUIT manifest format (as
defined in <span>[<a href="#I-D.ietf-suit-manifest" class="xref">I-D.ietf-suit-manifest</a>]</span>) for use in deployments with
multiple trust domains. A device has more than one trust domain when it
uses different trust anchors for different purposes or components in the
context of firmware update.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo-8">
<a href="#name-status-of-this-memo-8" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 8 September 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice-8">
<a href="#name-copyright-notice-8" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2022 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents-8">
<a href="#name-table-of-contents-8" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction-8" class="xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="xref">2</a>.  <a href="#name-conventions-and-terminology" class="xref">Conventions and Terminology</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1" class="keepWithNext"><a href="#section-3" class="xref">3</a>.  <a href="#name-changes-to-suit-workflow-mo" class="xref">Changes to SUIT Workflow Model</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-changes-to-manifest-metadat" class="xref">Changes to Manifest Metadata Structure</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-delegation-chains" class="xref">Delegation Chains</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-delegation-chains-2" class="xref">Delegation Chains</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-dependencies" class="xref">Dependencies</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-changes-to-required-checks" class="xref">Changes to Required Checks</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-changes-to-abstract-machine" class="xref">Changes to Abstract Machine Description</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="xref">6.3</a>.  <a href="#name-changes-to-special-cases-of" class="xref">Changes to Special Cases of Component Index and Dependency Index</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="xref">6.4</a>.  <a href="#name-processing-dependencies" class="xref">Processing Dependencies</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4.2.1">
                    <p id="section-toc.1-1.6.2.4.2.1.1"><a href="#section-6.4.1" class="xref">6.4.1</a>.  <a href="#name-multiple-manifest-processor" class="xref">Multiple Manifest Processors</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5">
                <p id="section-toc.1-1.6.2.5.1"><a href="#section-6.5" class="xref">6.5</a>.  <a href="#name-added-and-modified-commands" class="xref">Added and Modified Commands</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5.2.1">
                    <p id="section-toc.1-1.6.2.5.2.1.1"><a href="#section-6.5.1" class="xref">6.5.1</a>.  <a href="#name-suit-directive-set-componen" class="xref">suit-directive-set-component-index</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5.2.2">
                    <p id="section-toc.1-1.6.2.5.2.2.1"><a href="#section-6.5.2" class="xref">6.5.2</a>.  <a href="#name-suit-directive-set-dependen" class="xref">suit-directive-set-dependency-index</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5.2.3">
                    <p id="section-toc.1-1.6.2.5.2.3.1"><a href="#section-6.5.3" class="xref">6.5.3</a>.  <a href="#name-suit-directive-process-depe" class="xref">suit-directive-process-dependency</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5.2.4">
                    <p id="section-toc.1-1.6.2.5.2.4.1"><a href="#section-6.5.4" class="xref">6.5.4</a>.  <a href="#name-suit-directive-unlink" class="xref">suit-directive-unlink</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.6">
                <p id="section-toc.1-1.6.2.6.1"><a href="#section-6.6" class="xref">6.6</a>.  <a href="#name-suit_dependency-manifest-el" class="xref">SUIT_Dependency Manifest Element</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-creating-manifests" class="xref">Creating Manifests</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.  <a href="#name-dependency-template" class="xref">Dependency Template</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1.2.1">
                    <p id="section-toc.1-1.7.2.1.2.1.1"><a href="#section-7.1.1" class="xref">7.1.1</a>.  <a href="#name-composite-manifests" class="xref">Composite Manifests</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="xref">7.2</a>.  <a href="#name-encrypted-manifest-template" class="xref">Encrypted Manifest Template</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-iana-considerations-7" class="xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="xref">8.1</a>.  <a href="#name-suit-commands" class="xref">SUIT Commands</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-security-considerations-8" class="xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-references-9" class="xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="xref">10.1</a>.  <a href="#name-normative-references-8" class="xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="xref">10.2</a>.  <a href="#name-informative-references-6" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-A" class="xref">Appendix A</a>.  <a href="#name-a-full-cddl" class="xref">A. Full CDDL</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-B" class="xref"></a><a href="#name-authors-address-3" class="xref">Author's Address</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction-8">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction-8" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Devices that go beyond single-signer update require more complex rules for deploying firmware updates. For example, devices may require:<a href="#section-1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-2.1">long-term trust anchors with a mechanism to delegate trust to short term keys.<a href="#section-1-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-2.2">software components from multiple software signing authorities.<a href="#section-1-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-2.3">a mechanism to remove an uneeded component<a href="#section-1-2.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-2.4">single-object dependencies<a href="#section-1-2.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-2.5">a partly encrypted manifest so that distribution does not reveal private information<a href="#section-1-2.5" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-1-3">These mechanisms are not part of the core manifest specification, but they are needed for more advanced use cases, such as the architecture described in <span>[<a href="#I-D.ietf-teep-architecture" class="xref">I-D.ietf-teep-architecture</a>]</span>.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">This specification extends the SUIT Manifest specification (<span>[<a href="#I-D.ietf-suit-manifest" class="xref">I-D.ietf-suit-manifest</a>]</span>).<a href="#section-1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="conventions-and-terminology">
<section id="section-2">
      <h2 id="name-conventions-and-terminology">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions-and-terminology" class="section-name selfRef">Conventions and Terminology</a>
      </h2>
<p id="section-2-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED",
"MAY", and "OPTIONAL" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">Additionally, the following terminology is used throughout this document:<a href="#section-2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-3.1">SUIT: Software Update for the Internet of Things, also the IETF working group for this standard.<a href="#section-2-3.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.2">Payload: A piece of information to be delivered. Typically Firmware for the purposes of SUIT.<a href="#section-2-3.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.3">Resource: A piece of information that is used to construct a payload.<a href="#section-2-3.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.4">Manifest: A manifest is a bundle of metadata about the firmware for an IoT device, where to
find the firmware, and the devices to which it applies.<a href="#section-2-3.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.5">Envelope: A container with the manifest, an authentication wrapper with cryptographic information protecting the manifest, authorization information, and severable elements (see: TBD).<a href="#section-2-3.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.6">Update: One or more manifests that describe one or more payloads.<a href="#section-2-3.6" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.7">Update Authority: The owner of a cryptographic key used to sign updates, trusted by Recipients.<a href="#section-2-3.7" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.8">Recipient: The system, typically an IoT device, that receives and processes a manifest.<a href="#section-2-3.8" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.9">Manifest Processor: A component of the Recipient that consumes Manifests and executes the commands in the Manifest.<a href="#section-2-3.9" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.10">Component: An updatable logical block of the Firmware, Software, configuration, or data of the Recipient.<a href="#section-2-3.10" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.11">Component Set: A group of interdependent Components that must be updated simultaneously.<a href="#section-2-3.11" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.12">Command: A Condition or a Directive.<a href="#section-2-3.12" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.13">Condition: A test for a property of the Recipient or its Components.<a href="#section-2-3.13" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.14">Directive: An action for the Recipient to perform.<a href="#section-2-3.14" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.15">Trusted Invocation: A process by which a system ensures that only trusted code is executed, for example secure boot or launching a Trusted Application.<a href="#section-2-3.15" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.16">A/B images: Dividing a Recipient's storage into two or more bootable images, at different offsets, such that the active image can write to the inactive image(s).<a href="#section-2-3.16" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.17">Record: The result of a Command and any metadata about it.<a href="#section-2-3.17" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.18">Report: A list of Records.<a href="#section-2-3.18" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.19">Procedure: The process of invoking one or more sequences of commands.<a href="#section-2-3.19" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.20">Update Procedure: A procedure that updates a Recipient by fetching dependencies and images, and installing them.<a href="#section-2-3.20" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.21">Invocation Procedure: A procedure in which a Recipient verifies dependencies and images, loading images, and invokes one or more image.<a href="#section-2-3.21" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.22">Software: Instructions and data that allow a Recipient to perform a useful function.<a href="#section-2-3.22" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.23">Firmware: Software that is typically changed infrequently, stored in nonvolatile memory, and small enough to apply to <span>[<a href="#RFC7228" class="xref">RFC7228</a>]</span> Class 0-2 devices.<a href="#section-2-3.23" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.24">Image: Information that a Recipient uses to perform its function, typically firmware/software, configuration, or resource data such as text or images. Also, a Payload, once installed is an Image.<a href="#section-2-3.24" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.25">Slot: One of several possible storage locations for a given Component, typically used in A/B image systems<a href="#section-2-3.25" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.26">Abort: An event in which the Manifest Processor immediately halts execution of the current Procedure. It creates a Record of an error condition.<a href="#section-2-3.26" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="changes-to-suit-workflow-model">
<section id="section-3">
      <h2 id="name-changes-to-suit-workflow-mo">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-changes-to-suit-workflow-mo" class="section-name selfRef">Changes to SUIT Workflow Model</a>
      </h2>
<p id="section-3-1">The use of the features presented for use with multiple trust domains requires some augmentation of the workflow presented in the SUIT Manifest specification (<span>[<a href="#I-D.ietf-suit-manifest" class="xref">I-D.ietf-suit-manifest</a>]</span>):<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">One additional assumption is added for the Update Procedure:<a href="#section-3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-3.1">All dependency manifests should be present before any payload is fetched.<a href="#section-3-3.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-3-4">One additional assumption is added to the Invocation Procedure:<a href="#section-3-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-5.1">All dependencies must be validated prior to loading.<a href="#section-3-5.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-3-6">Two steps are added to the expected installation workflow of a Recipient:<a href="#section-3-6" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3-7">
<li id="section-3-7.1">
          <strong>Verify delegation chains</strong><a href="#section-3-7.1" class="pilcrow">¶</a>
</li>
        <li id="section-3-7.2">Verify the signature of the manifest.<a href="#section-3-7.2" class="pilcrow">¶</a>
</li>
        <li id="section-3-7.3">Verify the applicability of the manifest.<a href="#section-3-7.3" class="pilcrow">¶</a>
</li>
        <li id="section-3-7.4">
          <strong>Resolve dependencies.</strong><a href="#section-3-7.4" class="pilcrow">¶</a>
</li>
        <li id="section-3-7.5">Fetch payload(s).<a href="#section-3-7.5" class="pilcrow">¶</a>
</li>
        <li id="section-3-7.6">Install payload(s).<a href="#section-3-7.6" class="pilcrow">¶</a>
</li>
      </ol>
<p id="section-3-8">In addition, when multiple manifests are used for an update, each manifest's steps occur in a lockstep fashion; all manifests have dependency resolution performed before any manifest performs a payload fetch, etc.<a href="#section-3-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="metadata-structure-overview">
<section id="section-4">
      <h2 id="name-changes-to-manifest-metadat">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-changes-to-manifest-metadat" class="section-name selfRef">Changes to Manifest Metadata Structure</a>
      </h2>
<p id="section-4-1">To accomodate the additional metadata needed to enable these features, the envelope and manifest have several new elements added.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">The Envelope gains two more elements: Delegation chains and Integrated Dependencies
The Common metadata section in the Manifest also gains a list of dependencies.<a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3">The new metadata structure is shown below.<a href="#section-4-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4-4">
<pre>
+-------------------------+
| Envelope                |
+-------------------------+
| Delegation Chains       |
| Authentication Block    |
| Manifest           --------------&gt; +------------------------------+
| Severable Elements      |          | Manifest                     |
| Human-Readable Text     |          +------------------------------+
| COSWID                  |          | Structure Version            |
| Integrated Dependencies |          | Sequence Number              |
| Integrated Payloads     |          | Reference to Full Manifest   |
+-------------------------+    +------ Common Structure             |
                               | +---- Command Sequences            |
+-------------------------+    | |   | Digests of Envelope Elements |
| Common Structure        | &lt;--+ |   +------------------------------+
+-------------------------+      |
| Dependencies            |      +-&gt; +-----------------------+
| Component IDs           |          | Command Sequence      |
| Common Command Sequence ---------&gt; +-----------------------+
+-------------------------+          | List of ( pairs of (  |
                                     |   * command code      |
                                     |   * argument /        |
                                     |      reporting policy |
                                     | ))                    |
                                     +-----------------------+
</pre><a href="#section-4-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="ovr-delegation">
<section id="section-5">
      <h2 id="name-delegation-chains">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-delegation-chains" class="section-name selfRef">Delegation Chains</a>
      </h2>
<p id="section-5-1">Delegation Chains allow a Recipient to establish a chain of trust from a Trust Anchor to the signer of a manifest by validating delegation claims. Each delegation claim is a <span>[<a href="#RFC8392" class="xref">RFC8392</a>]</span> CBOR Web Tokens (CWTs). The first claim in each list is signed by a Trust Anchor. Each subsequent claim in a list is signed by the public key claimed in the preceding list element. The last element in each list claims a public key that can be used to verify a signature in the Authentication Block (See Sectino 5.2 of <span>[<a href="#I-D.ietf-suit-manifest" class="xref">I-D.ietf-suit-manifest</a>]</span>).<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">See <a href="#delegation-info" class="xref">Section 5.1</a> for more detail.<a href="#section-5-2" class="pilcrow">¶</a></p>
<div id="delegation-info">
<section id="section-5.1">
        <h3 id="name-delegation-chains-2">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-delegation-chains-2" class="section-name selfRef">Delegation Chains</a>
        </h3>
<p id="section-5.1-1">The suit-delegation element MAY carry one or more CBOR Web Tokens (CWTs) <span>[<a href="#RFC8392" class="xref">RFC8392</a>]</span>, with <span>[<a href="#RFC8747" class="xref">RFC8747</a>]</span> cnf claims. They can be used to perform enhanced authorization decisions. The CWTs are arranged into a list of lists. Each list starts with a CWT authorized by a Trust Anchor, and finishes with a key used to authenticate the Manifest (see Section 8.3 of <span>[<a href="#I-D.ietf-suit-manifest" class="xref">I-D.ietf-suit-manifest</a>]</span>). This allows an Update Authority to delegate from a long term Trust Anchor, down through intermediaries, to a delegate without any out-of-band provisioning of Trust Anchors or intermediary keys.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">A Recipient MAY choose to cache intermediaries and/or delegates. If an Update Distributor knows that a targeted Recipient has cached some intermediaries or delegates, it MAY choose to strip any cached intermediaries or delegates from the Delegation Chains in order to reduce bandwidth and energy.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="dependencies">
<section id="section-6">
      <h2 id="name-dependencies">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-dependencies" class="section-name selfRef">Dependencies</a>
      </h2>
<p id="section-6-1">A dependency is another SUIT_Envelope that describes additional components.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">Dependency manifests enable several additional use cases. In particular, they enable two or more entities who are trusted for different privileges to coordinate. This can be used in many scenarios, for example:<a href="#section-6-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6-3.1">An IoT device may contain a processor in its radio in addition to the primary processor. These two processors may have separate firmware with separate signing authorities. Dependencies allow the firmware for the primary processor to reference a manifest signed by a different authority.<a href="#section-6-3.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-3.2">A network operator may wish to provide local caching of update payloads. The network operator overrides the URI of payload by providing a dependent manifest that references the original manifest, but replaces its URI.<a href="#section-6-3.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-3.3">A device operator provides a device with some additional configuration. The device operator wants to test their configuration with each new firmware version before releasing it. The configuration is delivered as a binary in the same way as a firmware image. The device operator references the firmware manifest from the firmware author in their own manifest which also defines the configuration.<a href="#section-6-3.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-6-4">By using dependencies, components such as software, configuration, models, and other resoruces authenticated by different trust anchors can be delivered to devices.<a href="#section-6-4" class="pilcrow">¶</a></p>
<div id="required-checks">
<section id="section-6.1">
        <h3 id="name-changes-to-required-checks">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-changes-to-required-checks" class="section-name selfRef">Changes to Required Checks</a>
        </h3>
<p id="section-6.1-1">This section augments the definitions in Required Checks (Section 6.2) of <span>[<a href="#I-D.ietf-suit-manifest" class="xref">I-D.ietf-suit-manifest</a>]</span>.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">More checks are required when handling dependencies. By default, any signature of a dependency MUST be verified. However, there are some exceptions to this rule: where a device supports only one level of access (no ACLs defining which authorities have access to different componetns), it MAY choose to skip signature verification of dependencies, since they are referenced by digest. Where a device differentiates between trust levels, such as with an ACL, it MAY choose to defer the verification of signatures of dependencies until the list of affected components is known so that it can skip redundant signature verifications. For example, a dependency signed by the same author as the dependent does not require a signature verification. Similarly, if the signer of the dependent has full rights to the device, according to the ACL, then no signature verification is necessary on the dependency.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<p id="section-6.1-3">If the manifest contains more than one component and/or dependency, each command sequence MUST begin with a Set Component Index or Set Dependency Index command.<a href="#section-6.1-3" class="pilcrow">¶</a></p>
<p id="section-6.1-4">If a dependency is specified, then the manifest processor MUST perform the following checks:<a href="#section-6.1-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.1-5">
<li id="section-6.1-5.1">At the beginning of each section in the dependent: all previous sections of each dependency have been executed.<a href="#section-6.1-5.1" class="pilcrow">¶</a>
</li>
          <li id="section-6.1-5.2">At the end of each section in the dependent: The corresponding section in each dependency has been executed.<a href="#section-6.1-5.2" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-6.1-6">If the interpreter does not support dependencies and a manifest specifies a dependency, then the interpreter MUST reject the manifest.<a href="#section-6.1-6" class="pilcrow">¶</a></p>
<p id="section-6.1-7">If a Recipient supports groups of interdependent components (a Component Set), then it SHOULD verify that all Components in the Component Set are specified by one update, that is: a single manifest and all its dependencies that together:<a href="#section-6.1-7" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.1-8">
<li id="section-6.1-8.1">have sufficient permissions imparted by their signatures<a href="#section-6.1-8.1" class="pilcrow">¶</a>
</li>
          <li id="section-6.1-8.2">specify a digest and a payload for every Component in the Component Set.<a href="#section-6.1-8.2" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-6.1-9">The single dependent manifest is sometimes called a Root Manifest.<a href="#section-6.1-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="changes-to-abstract-machine-description">
<section id="section-6.2">
        <h3 id="name-changes-to-abstract-machine">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-changes-to-abstract-machine" class="section-name selfRef">Changes to Abstract Machine Description</a>
        </h3>
<p id="section-6.2-1">This section augments the Abstract Machine Description (Section 6.4) in <span>[<a href="#I-D.ietf-suit-manifest" class="xref">I-D.ietf-suit-manifest</a>]</span>
With the addition of dependencies, some changes are necessary to the abstract machine, outside the typical scope of added commands. These changes alter the behaviour of an existing command and way that the parser processes manifests:<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2-2.1">All commands may target dependency manifests as well as components. To support this behaviour, there is a new command instroduced: Set Dependency Index. This change works together with Set Component Index to choose the object on which the manifest is operating.<a href="#section-6.2-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.2-2.2">Dependencies are processed in lock-step with the Root Manifest. This means that every dependency's current command sequence must be executed before a dependent's later command sequence may be executed. For example, every dependency's Dependency Resolution step MUST be executed before any dependent's payload fetch step.<a href="#section-6.2-2.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-6.2-3">The logic of Set Componment Index is modified as below:<a href="#section-6.2-3" class="pilcrow">¶</a></p>
<p id="section-6.2-4">As in <span>[<a href="#I-D.ietf-suit-manifest" class="xref">I-D.ietf-suit-manifest</a>]</span>, To simplify the logic describing the command semantics, the object "current" is used. It represents the component identified by the Component Index or the dependency identified by the Dependency Index:<a href="#section-6.2-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2-5">
<pre>
current := components\[component-index\]
    if component-index is not false
    else dependencies\[dependency-index\]
</pre><a href="#section-6.2-5" class="pilcrow">¶</a>
</div>
<p id="section-6.2-6">As a result, Set Component Index is described as current := components[arg]. The actual operation performed for Set Component Index is described by the following pseudocode, however, because of the definition of current (above), these are semantically equivalent.<a href="#section-6.2-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2-7">
<pre>
component-index := arg
dependency-index := false
</pre><a href="#section-6.2-7" class="pilcrow">¶</a>
</div>
<p id="section-6.2-8">Similarly, Set Dependency Index is semantically equivalent to current := dependencies[arg], but the actual operation performed is:<a href="#section-6.2-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2-9">
<pre>
dependency-index := arg
component-index := false
</pre><a href="#section-6.2-9" class="pilcrow">¶</a>
</div>
<p id="section-6.2-10">Dependencies are identified by digest, but referenced in commands by Dependency Index, the index into the array of Dependencies.<a href="#section-6.2-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="index-true">
<section id="section-6.3">
        <h3 id="name-changes-to-special-cases-of">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-changes-to-special-cases-of" class="section-name selfRef">Changes to Special Cases of Component Index and Dependency Index</a>
        </h3>
<p id="section-6.3-1">The considerations that apply in Special Cases of Component Index and Dependency Index (Section 6.5) of <span>[<a href="#I-D.ietf-suit-manifest" class="xref">I-D.ietf-suit-manifest</a>]</span> are augmented to include Dependency Index as well as Component Index.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<p id="section-6.3-2">The target(s) assigned for each command are defined by the following pseudocode.<a href="#section-6.3-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.3-3">
<pre>
if component-index is true:
    current-list = components
else if component-index is array:
    current-list = [ components[idx] for idx in component-index ]
else if component-index is integer:
    current-list = [ components[component-index] ]
else if dependency-index is true:
    current-list = dependencies
else if dependency-index is array:
    current-list = [ dependencies[idx] for idx in dependency-index ]
else:
    current-list = [ dependencies[dependency-index] ]
for current in current-list:
    cmd(current)
</pre><a href="#section-6.3-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="processing-dependencies">
<section id="section-6.4">
        <h3 id="name-processing-dependencies">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-processing-dependencies" class="section-name selfRef">Processing Dependencies</a>
        </h3>
<p id="section-6.4-1">As described in <a href="#required-checks" class="xref">Section 6.1</a>, each manifest must invoke each of its dependencies' sections from the corresponding section of the dependent. Any changes made to parameters by the dependency persist in the dependent.<a href="#section-6.4-1" class="pilcrow">¶</a></p>
<p id="section-6.4-2">When a Process Dependency command is encountered, the interpreter loads the dependency identified by the Current Dependency Index. The interpreter first executes the common-sequence section of the identified dependency, then it executes the section of the dependency that corresponds to the currently executing section of the dependent.<a href="#section-6.4-2" class="pilcrow">¶</a></p>
<p id="section-6.4-3">If the specified dependency does not contain the current section, Process Dependency succeeds immediately.<a href="#section-6.4-3" class="pilcrow">¶</a></p>
<p id="section-6.4-4">The Manifest Processor MUST also support a Dependency Index of True, which applies to every dependency, as described in <a href="#index-true" class="xref">Section 6.3</a><a href="#section-6.4-4" class="pilcrow">¶</a></p>
<p id="section-6.4-5">The interpreter also performs the checks described in <a href="#required-checks" class="xref">Section 6.1</a> to ensure that the dependent is processing the dependency correctly.<a href="#section-6.4-5" class="pilcrow">¶</a></p>
<div id="hierarchical-interpreters">
<section id="section-6.4.1">
          <h4 id="name-multiple-manifest-processor">
<a href="#section-6.4.1" class="section-number selfRef">6.4.1. </a><a href="#name-multiple-manifest-processor" class="section-name selfRef">Multiple Manifest Processors</a>
          </h4>
<p id="section-6.4.1-1">When a system has multiple security domains, each domain might require independent verification of authenticity or security policies. Security domains might be divided by separation technology such as Arm TrustZone, Intel SGX, or another TEE technology. Security domains might also be divided into separate processors and memory spaces, with a communication interface between them.<a href="#section-6.4.1-1" class="pilcrow">¶</a></p>
<p id="section-6.4.1-2">For example, an application processor may have an attached communications module that contains a processor. The communications module might require metadata signed by a specific Trust Authority for regulatory approval. This may be a different Trust Authority than the application processor.<a href="#section-6.4.1-2" class="pilcrow">¶</a></p>
<p id="section-6.4.1-3">When there are two or more security domains (see <span>[<a href="#I-D.ietf-teep-architecture" class="xref">I-D.ietf-teep-architecture</a>]</span>), a manifest processor might be required in each. The first manifest processor is the normal manifest processor as described for the Recipient in Section 6 of <span>[<a href="#I-D.ietf-suit-manifest" class="xref">I-D.ietf-suit-manifest</a>]</span>. The second manifest processor only executes sections when the first manifest processor requests it. An API interface is provided from the second manifest processor to the first. This allows the first manifest processor to request a limited set of operations from the second. These operations are limited to: setting parameters, inserting an Envelope, invoking a Manifest Command Sequence. The second manifest processor declares a prefix to the first, which tells the first manifest processor when it should delegate to the second. These rules are enforced by underlying separation of privilege infrastructure, such as TEEs, or physical separation.<a href="#section-6.4.1-3" class="pilcrow">¶</a></p>
<p id="section-6.4.1-4">When the first manifest processor encounters a dependency prefix, that informs the first manifest processor that it should provide the second manifest processor with the corresponding dependency Envelope. This is done when the dependency is fetched. The second manifest processor immediately verifies any authentication information in the dependency Envelope. When a parameter is set for any component that matches the prefix, this parameter setting is passed to the second manifest processor via an API. As the first manifest processor works through the Procedure (set of command sequences) it is executing, each time it sees a Process Dependency command that is associated with the prefix declared by the second manifest processor, it uses the API to ask the second manifest processor to invoke that dependency section instead.<a href="#section-6.4.1-4" class="pilcrow">¶</a></p>
<p id="section-6.4.1-5">This mechanism ensures that the two or more manifest processors do not need to trust each other, except in a very limited case. When parameter setting across security domains is used, it must be very carefully considered. Only parameters that do not have an effect on security properties should be allowed. The dependency manifest MAY control which parameters are allowed to be set by using the Override Parameters directive. The second manifest processor MAY also control which parameters may be set by the first manifest processor by means of an ACL that lists the allowed parameters. For example, a URI may be set by a dependent without a substantial impact on the security properties of the manifest.<a href="#section-6.4.1-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="added-and-modified-commands">
<section id="section-6.5">
        <h3 id="name-added-and-modified-commands">
<a href="#section-6.5" class="section-number selfRef">6.5. </a><a href="#name-added-and-modified-commands" class="section-name selfRef">Added and Modified Commands</a>
        </h3>
<p id="section-6.5-1">All commands are modified in that they can also target dependencies. However, Set Component Index has a larger modification.<a href="#section-6.5-1" class="pilcrow">¶</a></p>
<table class="center" id="table-1">
          <caption><a href="#table-1" class="selfRef">Table 1</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Command Name</th>
              <th class="text-left" rowspan="1" colspan="1">Semantic of the Operation</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Set Component Index</td>
              <td class="text-left" rowspan="1" colspan="1">current := components[arg]</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Set Dependency Index</td>
              <td class="text-left" rowspan="1" colspan="1">current := dependencies[arg]</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Set Parameters</td>
              <td class="text-left" rowspan="1" colspan="1">current.params[k] := v if not k in params for-each k,v in arg</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Process Dependency</td>
              <td class="text-left" rowspan="1" colspan="1">exec(current[common]); exec(current[current-segment])</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Unlink</td>
              <td class="text-left" rowspan="1" colspan="1">unlink(current)</td>
            </tr>
          </tbody>
        </table>
<div id="suit-directive-set-component-index">
<section id="section-6.5.1">
          <h4 id="name-suit-directive-set-componen">
<a href="#section-6.5.1" class="section-number selfRef">6.5.1. </a><a href="#name-suit-directive-set-componen" class="section-name selfRef">suit-directive-set-component-index</a>
          </h4>
<p id="section-6.5.1-1">Set Component Index defines the component to which successive directives and conditions will apply. The supplied argument MUST be one of three types:<a href="#section-6.5.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.5.1-2">
<li id="section-6.5.1-2.1">An unsigned integer (REQUIRED to implement in parser)<a href="#section-6.5.1-2.1" class="pilcrow">¶</a>
</li>
            <li id="section-6.5.1-2.2">A boolean (REQUIRED to implement in parser ONLY IF 2 or more components supported)<a href="#section-6.5.1-2.2" class="pilcrow">¶</a>
</li>
            <li id="section-6.5.1-2.3">An array of unsigned integers (REQUIRED to implement in parser ONLY IF 3 or more components supported)<a href="#section-6.5.1-2.3" class="pilcrow">¶</a>
</li>
          </ol>
<p id="section-6.5.1-3">If the following commands apply to ONE component, an unsigned integer index into the component list is used. If the following commands apply to ALL components, then the boolean value "True" is used instead of an index. If the following commands apply to more than one, but not all components, then an array of unsigned integer indices into the component list is used.
See <a href="#index-true" class="xref">Section 6.3</a> for more details.<a href="#section-6.5.1-3" class="pilcrow">¶</a></p>
<p id="section-6.5.1-4">If the following commands apply to NO components, then the boolean value "False" is used. When suit-directive-set-dependency-index is used, suit-directive-set-component-index = False is implied. When suit-directive-set-component-index is used, suit-directive-set-dependency-index = False is implied.<a href="#section-6.5.1-4" class="pilcrow">¶</a></p>
<p id="section-6.5.1-5">If component index is set to True when a command is invoked, then the command applies to all components, in the order they appear in suit-common-components. When the Manifest Processor invokes a command while the component index is set to True, it must execute the command once for each possible component index, ensuring that the command receives the parameters corresponding to that component index.<a href="#section-6.5.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="suit-directive-set-dependency-index">
<section id="section-6.5.2">
          <h4 id="name-suit-directive-set-dependen">
<a href="#section-6.5.2" class="section-number selfRef">6.5.2. </a><a href="#name-suit-directive-set-dependen" class="section-name selfRef">suit-directive-set-dependency-index</a>
          </h4>
<p id="section-6.5.2-1">Set Dependency Index defines the manifest to which successive directives and conditions will apply. The supplied argument MUST be either a boolean or an unsigned integer index into the dependencies, or an array of unsigned integer indices into the list of dependencies. If the following directives apply to ALL dependencies, then the boolean value "True" is used instead of an index. If the following directives apply to NO dependencies, then the boolean value "False" is used. When suit-directive-set-component-index is used, suit-directive-set-dependency-index = False is implied. When suit-directive-set-dependency-index is used, suit-directive-set-component-index = False is implied.<a href="#section-6.5.2-1" class="pilcrow">¶</a></p>
<p id="section-6.5.2-2">If dependency index is set to True when a command is invoked, then the command applies to all dependencies, in the order they appear in suit-common-components. When the Manifest Processor invokes a command while the dependency index is set to True, the Manifest Processor MUST execute the command once for each possible dependency index, ensuring that the command receives the parameters corresponding to that dependency index. If the dependency index is set to an array of unsigned integers, then the Manifest Processor MUST execute the command once for each listed dependency index, ensuring that the command receives the parameters corresponding to that dependency index.<a href="#section-6.5.2-2" class="pilcrow">¶</a></p>
<p id="section-6.5.2-3">See <a href="#index-true" class="xref">Section 6.3</a> for more details.<a href="#section-6.5.2-3" class="pilcrow">¶</a></p>
<p id="section-6.5.2-4">Typical operations that require suit-directive-set-dependency-index include setting a source URI or Encryption Information, invoking "Fetch," or invoking "Process Dependency" for an individual dependency.<a href="#section-6.5.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="suit-directive-process-dependency">
<section id="section-6.5.3">
          <h4 id="name-suit-directive-process-depe">
<a href="#section-6.5.3" class="section-number selfRef">6.5.3. </a><a href="#name-suit-directive-process-depe" class="section-name selfRef">suit-directive-process-dependency</a>
          </h4>
<p id="section-6.5.3-1">Execute the commands in the common section of the current dependency, followed by the commands in the equivalent section of the current dependency. For example, if the current section is "fetch payload," this will execute "common" in the current dependency, then "fetch payload" in the current dependency. Once this is complete, the command following suit-directive-process-dependency will be processed.<a href="#section-6.5.3-1" class="pilcrow">¶</a></p>
<p id="section-6.5.3-2">If the current dependency is False, this directive has no effect. If the current dependency is True, then this directive applies to all dependencies. If the current section is "common," then the command sequence MUST be terminated with an error.<a href="#section-6.5.3-2" class="pilcrow">¶</a></p>
<p id="section-6.5.3-3">When SUIT_Process_Dependency completes, it forwards the last status code that occurred in the dependency.<a href="#section-6.5.3-3" class="pilcrow">¶</a></p>
<div id="suit-directive-set-parameters">
<section id="section-6.5.3.1">
            <h5 id="name-suit-directive-set-paramete">
<a href="#section-6.5.3.1" class="section-number selfRef">6.5.3.1. </a><a href="#name-suit-directive-set-paramete" class="section-name selfRef">suit-directive-set-parameters</a>
            </h5>
<p id="section-6.5.3.1-1">suit-directive-set-parameters allows the manifest to configure behavior of future directives by changing parameters that are read by those directives. When dependencies are used, suit-directive-set-parameters also allows a manifest to modify the behavior of its dependencies.<a href="#section-6.5.3.1-1" class="pilcrow">¶</a></p>
<p id="section-6.5.3.1-2">If a parameter is already set, suit-directive-set-parameters will skip setting the parameter to its argument. This provides the core of the override mechanism, allowing dependent manifests to change the behavior of a manifest.<a href="#section-6.5.3.1-2" class="pilcrow">¶</a></p>
<p id="section-6.5.3.1-3">suit-directive-set-parameters does not specify a reporting policy.<a href="#section-6.5.3.1-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="suit-directive-unlink">
<section id="section-6.5.4">
          <h4 id="name-suit-directive-unlink">
<a href="#section-6.5.4" class="section-number selfRef">6.5.4. </a><a href="#name-suit-directive-unlink" class="section-name selfRef">suit-directive-unlink</a>
          </h4>
<p id="section-6.5.4-1">suit-directive-unlink marks the current component as unused in the current manifest. This can be used to remove temporary storage or remove components that are no longer needed. Example use cases:<a href="#section-6.5.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.5.4-2.1">Temporary storage for encrypted download<a href="#section-6.5.4-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.5.4-2.2">Temporary storage for verifying decompressed file before writing to flash<a href="#section-6.5.4-2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.5.4-2.3">Removing Trusted Service no longer needed by Trusted Application<a href="#section-6.5.4-2.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-6.5.4-3">Once the current Command Sequence is complete, the manifest processors checks each marked component to see whether any other manifests have referenced it. Those marked components with no other references are deleted. The manifest processor MAY choose to ignore a Unlink directive depending on device policy.<a href="#section-6.5.4-3" class="pilcrow">¶</a></p>
<p id="section-6.5.4-4">suit-directive-unlink is OPTIONAL to implement in manifest processors.<a href="#section-6.5.4-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="SUIT_Dependency">
<section id="section-6.6">
        <h3 id="name-suit_dependency-manifest-el">
<a href="#section-6.6" class="section-number selfRef">6.6. </a><a href="#name-suit_dependency-manifest-el" class="section-name selfRef">SUIT_Dependency Manifest Element</a>
        </h3>
<p id="section-6.6-1">SUIT_Dependency specifies a manifest that describes a dependency of the current manifest. The Manifest is identified, but the Recipient should expect an Envelope when it acquires the dependency. This is because the Manifest is the one invariant element of the Envelope, where other elements may change by countersigning, adding authentication blocks, or severing elements.<a href="#section-6.6-1" class="pilcrow">¶</a></p>
<p id="section-6.6-2">The suit-dependency-digest specifies the dependency manifest uniquely by identifying a particular Manifest structure. This is identical to the digest that would be present as the payload of any suit-authentication-block in the dependency's Envelope. The digest is calculated over the Manifest structure instead of the COSE Sig_structure or Mac_structure. This is necessary to ensure that removing a signature from a manifest does not break dependencies due to missing signature elements. This is also necessary to support the trusted intermediary use case, where an intermediary re-signs the Manifest, removing the original signature, potentially with a different algorithm, or trading COSE_Sign for COSE_Mac.<a href="#section-6.6-2" class="pilcrow">¶</a></p>
<p id="section-6.6-3">The suit-dependency-prefix element contains a SUIT_Component_Identifier (see Section 8.4.5.1 of <span>[<a href="#I-D.ietf-suit-manifest" class="xref">I-D.ietf-suit-manifest</a>]</span>). This specifies the scope at which the dependency operates. This allows the dependency to be forwarded on to a component that is capable of parsing its own manifests. It also allows one manifest to be deployed to multiple dependent Recipients without those Recipients needing consistent component hierarchy. This element is OPTIONAL for Recipients to implement.<a href="#section-6.6-3" class="pilcrow">¶</a></p>
<p id="section-6.6-4">A dependency prefix can be used with a component identifier. This allows complex systems to understand where dependencies need to be applied. The dependency prefix can be used in one of two ways. The first simply prepends the prefix to all Component Identifiers in the dependency.<a href="#section-6.6-4" class="pilcrow">¶</a></p>
<p id="section-6.6-5">A dependency prefix can also be used to indicate when a dependency manifest needs to be processed by a secondary manifest processor, as described in <a href="#hierarchical-interpreters" class="xref">Section 6.4.1</a>.<a href="#section-6.6-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="creating-manifests">
<section id="section-7">
      <h2 id="name-creating-manifests">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-creating-manifests" class="section-name selfRef">Creating Manifests</a>
      </h2>
<p id="section-7-1">This section details a set of templates for creating manifests. These templates explain which parameters, commands, and orders of commands are necessary to achieve a stated goal.<a href="#section-7-1" class="pilcrow">¶</a></p>
<div id="template-dependency">
<section id="section-7.1">
        <h3 id="name-dependency-template">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-dependency-template" class="section-name selfRef">Dependency Template</a>
        </h3>
<p id="section-7.1-1">The goal of the Dependency template is to obtain, verify, and process a dependency manifest as appropriate.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">The following commands are placed into the dependency resolution sequence:<a href="#section-7.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.1-3.1">Set Dependency Index directive (see <a href="#suit-directive-set-dependency-index" class="xref">Section 6.5.2</a>)<a href="#section-7.1-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.1-3.2">Set Parameters directive (see <a href="#suit-directive-set-parameters" class="xref">Section 6.5.3.1</a>) for URI (see Section 8.4.8.9 of <span>[<a href="#I-D.ietf-suit-manifest" class="xref">I-D.ietf-suit-manifest</a>]</span>)<a href="#section-7.1-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.1-3.3">Fetch directive (see Section 8.4.10.4 of <span>[<a href="#I-D.ietf-suit-manifest" class="xref">I-D.ietf-suit-manifest</a>]</span>)<a href="#section-7.1-3.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.1-3.4">Check Image Match condition (see Section 8.4.9.2 of <span>[<a href="#I-D.ietf-suit-manifest" class="xref">I-D.ietf-suit-manifest</a>]</span> of <span>[<a href="#I-D.ietf-suit-manifest" class="xref">I-D.ietf-suit-manifest</a>]</span>)<a href="#section-7.1-3.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.1-3.5">Process Dependency directive (see <a href="#suit-directive-process-dependency" class="xref">Section 6.5.3</a>)<a href="#section-7.1-3.5" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-7.1-4">Then, the validate sequence contains the following operations:<a href="#section-7.1-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.1-5.1">Set Dependency Index directive (see <a href="#suit-directive-set-dependency-index" class="xref">Section 6.5.2</a>)<a href="#section-7.1-5.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.1-5.2">Check Image Match condition (see Section 8.4.9.2 of <span>[<a href="#I-D.ietf-suit-manifest" class="xref">I-D.ietf-suit-manifest</a>]</span>)<a href="#section-7.1-5.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.1-5.3">Process Dependency directive (see <a href="#suit-directive-process-dependency" class="xref">Section 6.5.3</a>)<a href="#section-7.1-5.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-7.1-6">NOTE: Any changes made to parameters in a dependency persist in the dependent.<a href="#section-7.1-6" class="pilcrow">¶</a></p>
<div id="composite-manifests">
<section id="section-7.1.1">
          <h4 id="name-composite-manifests">
<a href="#section-7.1.1" class="section-number selfRef">7.1.1. </a><a href="#name-composite-manifests" class="section-name selfRef">Composite Manifests</a>
          </h4>
<p id="section-7.1.1-1">An implementer MAY choose to place a dependency's envelope in the envelope of its dependent. The dependent envelope key for the dependency envelope MUST NOT be a value between 0 and 24 and it MUST NOT be used by any other envelope element in the dependent manifest.<a href="#section-7.1.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1.1-2">The URI for a dependency enclosed in this way MUST be expressed as a fragment-only reference, as defined in <span>[<a href="#RFC3986" class="xref">RFC3986</a>]</span>, Section 4.4. The fragment identifier is the stringified envelope key of the dependency. For example, an envelope that contains a dependency at key 42 would use a URI "#42", key -73 would use a URI "#-73".<a href="#section-7.1.1-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="template-encrypted-manifest">
<section id="section-7.2">
        <h3 id="name-encrypted-manifest-template">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-encrypted-manifest-template" class="section-name selfRef">Encrypted Manifest Template</a>
        </h3>
<p id="section-7.2-1">The goal of the Encrypted Manifest template is to fetch and decrypt a manifest so that it can be used as a dependency. To use an encrypted manifest, create a plaintext dependent, and add the encrypted manifest as a dependency. The dependent can include very little information.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<p id="section-7.2-2">NOTE: This template also requires the extensions defined in <span>[<a href="#I-D.ietf-suit-firmware-encryption" class="xref">I-D.ietf-suit-firmware-encryption</a>]</span><a href="#section-7.2-2" class="pilcrow">¶</a></p>
<p id="section-7.2-3">The following operations are placed into the dependency resolution block:<a href="#section-7.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.2-4.1">Set Dependency Index directive (see <a href="#suit-directive-set-dependency-index" class="xref">Section 6.5.2</a>)<a href="#section-7.2-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.2-4.2">
            <p id="section-7.2-4.2.1">Set Parameters directive (see <a href="#suit-directive-set-parameters" class="xref">Section 6.5.3.1</a>) for<a href="#section-7.2-4.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.2-4.2.2.1">URI (see Section 8.4.8.9 of <span>[<a href="#I-D.ietf-suit-manifest" class="xref">I-D.ietf-suit-manifest</a>]</span>)<a href="#section-7.2-4.2.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-7.2-4.2.2.2">Encryption Info (See <span>[<a href="#I-D.ietf-suit-firmware-encryption" class="xref">I-D.ietf-suit-firmware-encryption</a>]</span>)<a href="#section-7.2-4.2.2.2" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-7.2-4.3">Fetch directive (see Section 8.4.10.4 of <span>[<a href="#I-D.ietf-suit-manifest" class="xref">I-D.ietf-suit-manifest</a>]</span>)<a href="#section-7.2-4.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.2-4.4">Check Image Match condition (see Section 8.4.9.2 of <span>[<a href="#I-D.ietf-suit-manifest" class="xref">I-D.ietf-suit-manifest</a>]</span>)<a href="#section-7.2-4.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.2-4.5">Process Dependency directive (see <a href="#suit-directive-process-dependency" class="xref">Section 6.5.3</a>)<a href="#section-7.2-4.5" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-7.2-5">Then, the validate block contains the following operations:<a href="#section-7.2-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.2-6.1">Set Dependency Index directive (see <a href="#suit-directive-set-dependency-index" class="xref">Section 6.5.2</a>)<a href="#section-7.2-6.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.2-6.2">Check Image Match condition (see Section 8.4.9.2 of <span>[<a href="#I-D.ietf-suit-manifest" class="xref">I-D.ietf-suit-manifest</a>]</span>)<a href="#section-7.2-6.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.2-6.3">Process Dependency directive (see <a href="#suit-directive-process-dependency" class="xref">Section 6.5.3</a>)<a href="#section-7.2-6.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-7.2-7">A plaintext manifest and its encrypted dependency may also form a composite manifest (<a href="#composite-manifests" class="xref">Section 7.1.1</a>).<a href="#section-7.2-7" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana">
<section id="section-8">
      <h2 id="name-iana-considerations-7">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-iana-considerations-7" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-8-1">IANA is requested to allocate the following numbers in the listed registries:<a href="#section-8-1" class="pilcrow">¶</a></p>
<div id="suit-commands">
<section id="section-8.1">
        <h3 id="name-suit-commands">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-suit-commands" class="section-name selfRef">SUIT Commands</a>
        </h3>
<table class="center" id="table-2">
          <caption><a href="#table-2" class="selfRef">Table 2</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Label</th>
              <th class="text-left" rowspan="1" colspan="1">Name</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
              <th class="text-left" rowspan="1" colspan="1"> </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">13</td>
              <td class="text-left" rowspan="1" colspan="1">Set Dependency Index</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#suit-directive-set-dependency-index" class="xref">Section 6.5.2</a>
</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">18</td>
              <td class="text-left" rowspan="1" colspan="1">Process Dependency</td>
              <td class="text-left" rowspan="1" colspan="1">suit-directive-process-dependency</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#suit-directive-process-dependency" class="xref">Section 6.5.3</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">19</td>
              <td class="text-left" rowspan="1" colspan="1">Set Parameters</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#suit-directive-set-parameters" class="xref">Section 6.5.3.1</a>
</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">33</td>
              <td class="text-left" rowspan="1" colspan="1">Unlink</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#suit-directive-unlink" class="xref">Section 6.5.4</a>
</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
            </tr>
          </tbody>
        </table>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-9">
      <h2 id="name-security-considerations-8">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-security-considerations-8" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-9-1">This document is about a manifest format protecting and describing how to retrieve, install, and invoke firmware images and as such it is part of a larger solution for delivering firmware updates to IoT devices. A detailed security treatment can be found in the architecture <span>[<a href="#RFC9019" class="xref">RFC9019</a>]</span> and in the information model <span>[<a href="#I-D.ietf-suit-information-model" class="xref">I-D.ietf-suit-information-model</a>]</span> documents.<a href="#section-9-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-10">
      <h2 id="name-references-9">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-references-9" class="section-name selfRef">References</a>
      </h2>
<section id="section-10.1">
        <h3 id="name-normative-references-8">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-normative-references-8" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-suit-manifest">[I-D.ietf-suit-manifest]</dt>
        <dd>
<span class="refAuthor">Moran, B.</span>, <span class="refAuthor">Tschofenig, H.</span>, <span class="refAuthor">Birkholz, H.</span>, and <span class="refAuthor">K. Zandberg</span>, <span class="refTitle">"A Concise Binary Object Representation (CBOR)-based Serialization Format for the Software Updates for Internet of Things (SUIT) Manifest"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-suit-manifest-16</span>, <time datetime="2021-10-25" class="refDate">25 October 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-suit-manifest-16.txt">https://www.ietf.org/archive/id/draft-ietf-suit-manifest-16.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3986">[RFC3986]</dt>
        <dd>
<span class="refAuthor">Berners-Lee, T.</span>, <span class="refAuthor">Fielding, R.</span>, and <span class="refAuthor">L. Masinter</span>, <span class="refTitle">"Uniform Resource Identifier (URI): Generic Syntax"</span>, <span class="seriesInfo">STD 66</span>, <span class="seriesInfo">RFC 3986</span>, <span class="seriesInfo">DOI 10.17487/RFC3986</span>, <time datetime="2005-01" class="refDate">January 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3986">https://www.rfc-editor.org/info/rfc3986</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7228">[RFC7228]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span>, <span class="refAuthor">Ersue, M.</span>, and <span class="refAuthor">A. Keranen</span>, <span class="refTitle">"Terminology for Constrained-Node Networks"</span>, <span class="seriesInfo">RFC 7228</span>, <span class="seriesInfo">DOI 10.17487/RFC7228</span>, <time datetime="2014-05" class="refDate">May 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7228">https://www.rfc-editor.org/info/rfc7228</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8392">[RFC8392]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Wahlstroem, E.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"CBOR Web Token (CWT)"</span>, <span class="seriesInfo">RFC 8392</span>, <span class="seriesInfo">DOI 10.17487/RFC8392</span>, <time datetime="2018-05" class="refDate">May 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8392">https://www.rfc-editor.org/info/rfc8392</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8747">[RFC8747]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Seitz, L.</span>, <span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Proof-of-Possession Key Semantics for CBOR Web Tokens (CWTs)"</span>, <span class="seriesInfo">RFC 8747</span>, <span class="seriesInfo">DOI 10.17487/RFC8747</span>, <time datetime="2020-03" class="refDate">March 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8747">https://www.rfc-editor.org/info/rfc8747</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9019">[RFC9019]</dt>
      <dd>
<span class="refAuthor">Moran, B.</span>, <span class="refAuthor">Tschofenig, H.</span>, <span class="refAuthor">Brown, D.</span>, and <span class="refAuthor">M. Meriac</span>, <span class="refTitle">"A Firmware Update Architecture for Internet of Things"</span>, <span class="seriesInfo">RFC 9019</span>, <span class="seriesInfo">DOI 10.17487/RFC9019</span>, <time datetime="2021-04" class="refDate">April 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9019">https://www.rfc-editor.org/info/rfc9019</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-10.2">
        <h3 id="name-informative-references-6">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-informative-references-6" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-suit-firmware-encryption">[I-D.ietf-suit-firmware-encryption]</dt>
        <dd>
<span class="refAuthor">Tschofenig, H.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">B. Moran</span>, <span class="refTitle">"Firmware Encryption with SUIT Manifests"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-suit-firmware-encryption-03</span>, <time datetime="2022-03-07" class="refDate">7 March 2022</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-suit-firmware-encryption-03.txt">https://www.ietf.org/archive/id/draft-ietf-suit-firmware-encryption-03.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-suit-information-model">[I-D.ietf-suit-information-model]</dt>
        <dd>
<span class="refAuthor">Moran, B.</span>, <span class="refAuthor">Tschofenig, H.</span>, and <span class="refAuthor">H. Birkholz</span>, <span class="refTitle">"A Manifest Information Model for Firmware Updates in Internet of Things (IoT) Devices"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-suit-information-model-13</span>, <time datetime="2021-07-08" class="refDate">8 July 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-suit-information-model-13.txt">https://www.ietf.org/archive/id/draft-ietf-suit-information-model-13.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-teep-architecture">[I-D.ietf-teep-architecture]</dt>
      <dd>
<span class="refAuthor">Pei, M.</span>, <span class="refAuthor">Tschofenig, H.</span>, <span class="refAuthor">Thaler, D.</span>, and <span class="refAuthor">D. Wheeler</span>, <span class="refTitle">"Trusted Execution Environment Provisioning (TEEP) Architecture"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-teep-architecture-16</span>, <time datetime="2022-02-28" class="refDate">28 February 2022</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-teep-architecture-16.txt">https://www.ietf.org/archive/id/draft-ietf-teep-architecture-16.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="full-cddl">
<section id="appendix-A">
      <h2 id="name-a-full-cddl">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-a-full-cddl" class="section-name selfRef">A. Full CDDL</a>
      </h2>
<p id="appendix-A-1">To be valid, the following CDDL MUST be appended to the SUIT Manifest CDDL. The SUIT CDDL is defined in Appendix A of <span>[<a href="#I-D.ietf-suit-manifest" class="xref">I-D.ietf-suit-manifest</a>]</span><a href="#appendix-A-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-CDDL art-text artwork" id="appendix-A-2">
<pre>
$$SUIT_Envelope_Extensions //=
    (suit-delegation =&gt; bstr .cbor SUIT_Delegation)
$$SUIT_Envelope_Extensions //= SUIT_Integrated_Dependency

SUIT_Delegation = [ + [ + bstr .cbor CWT ] ]

CWT = SUIT_Authentication_Block

$$SUIT_severable-members-extensions //=
    (suit-dependency-resolution =&gt; bstr .cbor SUIT_Command_Sequence)

SUIT_Integrated_Dependency = (
    suit-integrated-dependency-key =&gt; bstr .cbor SUIT_Envelope)
suit-integrated-dependency-key = tstr

$$severable-manifest-members-choice-extensions //= (
    suit-dependency-resolution =&gt; \
        bstr .cbor SUIT_Command_Sequence / SUIT_Digest)

$$SUIT_Common-extensions //= (
        suit-dependencies =&gt; SUIT_Dependencies
)

SUIT_Dependencies         = [ + SUIT_Dependency ]

SUIT_Dependency = {
    suit-dependency-digest =&gt; SUIT_Digest,
    ? suit-dependency-prefix =&gt; SUIT_Component_Identifier,
    * $$SUIT_Dependency-extensions,
}

SUIT_Directive //= (
    suit-directive-set-dependency-index, IndexArg)
SUIT_Directive //= (
    suit-directive-process-dependency, SUIT_Rep_Policy)
SUIT_Directive //= (suit-directive-set-parameters,
    {+ SUIT_Parameters})
SUIT_Directive //= (
    suit-directive-unlink, SUIT_Rep_Policy)

suit-delegation = 1
suit-dependency-resolution = 7

suit-dependencies = 1

suit-dependency-digest = 1
suit-dependency-prefix = 2

suit-directive-set-dependency-index     = 13
suit-directive-process-dependency       = 18
suit-directive-set-parameters           = 19
suit-directive-unlink                   = 33

</pre><a href="#appendix-A-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-address-3">
<a href="#name-authors-address-3" class="section-name selfRef">Author's Address</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Brendan Moran</span></div>
<div dir="auto" class="left"><span class="org">Arm Limited</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:Brendan.Moran@arm.com" class="email">Brendan.Moran@arm.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
