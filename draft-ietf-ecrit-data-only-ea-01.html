<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Common Alerting Protocol (CAP) based Data-Only
      Emergency Alerts using the Session Initiation Protocol (SIP)</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Common Alerting Protocol (CAP) based Data-Only
      Emergency Alerts using the Session Initiation Protocol (SIP)">
<meta name="keywords" content="Internet-Draft, CAP, Common Alerting Protocol, Data-Only Emergency Alerts">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 60em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 60em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">ECRIT</td><td class="header">B. Rosen</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">NeuStar, Inc.</td></tr>
<tr><td class="header">Intended status: Experimental</td><td class="header">H. Schulzrinne</td></tr>
<tr><td class="header">Expires: April 28, 2011</td><td class="header">Columbia U.</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">H. Tschofenig</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Nokia Siemens Networks</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">October 25, 2010</td></tr>
</table></td></tr></table>
<h1><br />Common Alerting Protocol (CAP) based Data-Only
      Emergency Alerts using the Session Initiation Protocol (SIP)<br />draft-ietf-ecrit-data-only-ea-01.txt</h1>

<h3>Abstract</h3>

<p>The Common Alerting Protocol (CAP) is a document format for exchanging emergency
        alerts and public warnings. CAP is mainly used for conveying alerts and warnings between
        authorities and from authorities to citizen/individuals. This document describes how
        data-only emergency alerts allow devices to issue alerts using the CAP document format.
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted  in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF).  Note that other groups may also distribute
working documents as Internet-Drafts.  The list of current
Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
This Internet-Draft will expire on April 28, 2011.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the Simplified BSD License.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#introduction">1.</a>&nbsp;
Introduction<br />
<a href="#terminology">2.</a>&nbsp;
Terminology<br />
<a href="#arch">3.</a>&nbsp;
Architectural Overview<br />
<a href="#anchor1">4.</a>&nbsp;
Protocol Specification<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">4.1.</a>&nbsp;
CAP Transport<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">4.2.</a>&nbsp;
Profiling of the CAP Document Content<br />
<a href="#example">5.</a>&nbsp;
Example<br />
<a href="#sec-cons">6.</a>&nbsp;
Security Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec-cons-forged-assn">6.1.</a>&nbsp;
Forgery<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec-cons-replay-attack">6.2.</a>&nbsp;
Replay Attack<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec-cons-authorization">6.3.</a>&nbsp;
Injecting False Alerts<br />
<a href="#anchor4">7.</a>&nbsp;
IANA Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">7.1.</a>&nbsp;
Registration of the 'application/common-alerting-protocol+xml' MIME type<br />
<a href="#anchor6">8.</a>&nbsp;
Acknowledgments<br />
<a href="#rfc.references1">9.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">9.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">9.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="introduction"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>The Common Alerting Protocol (CAP) <a class='info' href='#cap'>[cap]<span> (</span><span class='info'>Jones, E. and A. Botterell, &ldquo;Common Alerting Protocol v. 1.1,&rdquo; October&nbsp;2005.</span><span>)</span></a> is an XML document format for
        exchanging emergency alerts and public warnings. CAP is mainly used for conveying alerts and
        warnings between authorities and from authorities to citizen/individuals. This document
        describes how data-only emergency calls are able to utilize the same CAP document format.
</p>
<p>
        Data-only emergency alerts are similar to regular emergency calls in the sense that they
        require emergency call routing functionality and may even have the same location requirements. 
        On the other hand, the initial communication interaction will not lead
        to the establishment of a voice or video channel.
</p>
<p>Based on the deployment experience with non-IP based systems we distinguish between 
        two types of environments, namely (1) data-only emergency alerts that
        are targeted directly to a recipient responsible for evaluating the alerts and for
        taking the necessary steps, including triggering an emergency call towards a Public Safety
        Answering Point (PSAP) and (2) alerts that are targeted to a Service URN as used for 
        regular IP-based emergency calls where the recipient is not known to the originator. We 
        describe these two cases in more detail in <a class='info' href='#arch'>Section&nbsp;3<span> (</span><span class='info'>Architectural Overview</span><span>)</span></a>.
</p>
<a name="terminology"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Terminology</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT",
        "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in
        RFC 2119 <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<p>This document utilizes terminology introduced in <a class='info' href='#I-D.ietf-atoca-requirements'>[I&#8209;D.ietf&#8209;atoca&#8209;requirements]<span> (</span><span class='info'>Schulzrinne, H., Norreys, S., Rosen, B., and H. Tschofenig, &ldquo;Requirements, Terminology and Framework for Exigent Communications,&rdquo; September&nbsp;2010.</span><span>)</span></a>.
      
</p>
<a name="arch"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Architectural Overview</h3>

<p>This section illustrates two envisioned usage modes; targeted and location-based emergency 
      alert routing. <a class='info' href='#targeted'>Figure&nbsp;1<span> (</span><span class='info'>Targeted Emergency Alert Routing</span><span>)</span></a> shows a deployment variant where a sensor, 
      as the author and originator of the alert, is pre-configured (using techniques outside the 
      scope of this document) to issue an alert to a receiver or an aggregator, a special form of mediator, 
      that processes these messages and performs whatever steps are necessary to appropriately 
      react on the alert. For example, a security firm may use different sensor inputs to 
      dispatch their security staff to a building they protect.
</p>
<p>
     <br /><hr class="insert" />
<a name="targeted"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

 +------------+              +------------+
 | Sensor     |              | Aggregator |
 |            |              |            |
 +---+--------+              +------+-----+
     |                              |
  Sensors                           |
  trigger                           |
  emergency                         |
  alert                             |
     |        MESSAGE with CAP      |
     |-----------------------------&gt;|
     |                              |
     |                           Aggregator
     |                           processes
     |                           emergency
     |                           alert
     |        200 (OK)              |
     |&lt;-----------------------------|
     |                              |
     |                              |
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: Targeted Emergency Alert Routing&nbsp;</b></font><br /></td></tr></table><hr class="insert" />


</p>
<p>
        In <a class='info' href='#location'>Figure&nbsp;2<span> (</span><span class='info'>Location-Based Emergency Alert Routing</span><span>)</span></a> a scenario is shown whereby the alert is routed 
        using location information and the Service URN. In case the LoST resolution is done 
        at an emergency services routing proxy rather than at the entity issuing the alert since 
        it may not know 
        the address of the receiver. A possible receiver is a PSAP and the recipient of the alert 
        may be call taker. In the generic case, there is very likely no prior relationship between 
        the originator and the receiver, e.g. PSAP. A PSAP, for example, is likely to receive and 
        accept alerts from entities it cannot authorize. This scenario corresponds more to the 
        classical emergency services use case and the description in 
        <a class='info' href='#I-D.ietf-ecrit-phonebcp'>[I&#8209;D.ietf&#8209;ecrit&#8209;phonebcp]<span> (</span><span class='info'>Rosen, B. and J. Polk, &ldquo;Best Current Practice for Communications Services in support of Emergency Calling,&rdquo; July&nbsp;2010.</span><span>)</span></a> is applicable.
      
</p>
<p>
      <br /><hr class="insert" />
<a name="location"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

                        +-----------+                  +----------+
   +--------+           | SIP Proxy |                  | PSAP as  |
   | Sensor |           | as Relay  |                  | Receiver |
   +---+----+           +---+-------+                  +---+------+
       |                    |                              |
    Sensors                 |                              |
    trigger                 |                              |
    emergency               |                              |
    alert                   |                              |
       |                    |                              |
       |                    |                              |
       | MESSAGE with CAP   |                              |
       | (including Service URN,                           |
       | such as urn:service:sos)                          |
       |-------------------&gt;|                              |
       |                    |                              |
       |              SIP Proxy performs                   |
       |              emergency alert                      |
       |              routing                              |
       |                    |  MESSAGE with CAP            |
       |                    |  (including identity info)   |
       |                    |-----------------------------&gt;|
       |                    |                              |
       |                    |                           PSAP
       |                    |                           processes
       |                    |                           emergency
       |                    |                           alert
       |                    |        200 (OK)              |
       |                    |&lt;-----------------------------|
       |                    |                              |
       |  200 (OK)          |                              |
       |&lt;-------------------|                              |
       |                    |                              |
       |                    |                              |
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;2: Location-Based Emergency Alert Routing&nbsp;</b></font><br /></td></tr></table><hr class="insert" />


      
</p>
<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Protocol Specification</h3>

<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
CAP Transport</h3>

<p>Since alerts structured via CAP require a "push" medium, they SHOULD be sent via the SIP
          MESSAGE. The MIME type is set to 'application/common-alerting-protocol+xml'.
</p>
<p>
          </p>
<blockquote class="text">
<p>Alternatively, the SIP PUBLISH mechanism or other SIP messages could be used.
              However, the usage of SIP MESSAGE is a simple enough approach from an implementation
              point of view. 
</p>
</blockquote><p>
        
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Profiling of the CAP Document Content</h3>

<p>The usage of CAP MUST conform to the specification provided with <a class='info' href='#cap'>[cap]<span> (</span><span class='info'>Jones, E. and A. Botterell, &ldquo;Common Alerting Protocol v. 1.1,&rdquo; October&nbsp;2005.</span><span>)</span></a>.
          For the usage with SIP the following additional requirements are imposed: 
</p>
<p></p>
<blockquote class="text"><dl>
<dt>sender:</dt>
<dd>When the CAP was created by a SIP-based entity then the element
              MUST be populated with the SIP URI of that entity. <br />

</dd>
<dt>incidents:</dt>
<dd> The &lt;incidents&gt; element MUST be present whenever there is 
             a possibility that alert information needs to be updated. The initial message will 
             then contain an incident identifier carried in the &lt;incidents&gt; element. This 
             incident identifier MUST be chosen in such a way that it is unique for a given 
             &lt;sender, expires, incidents&gt; combination. Note that the &lt;expires&gt; element 
             is optional and may not be present.<br />

</dd>
<dt>scope:</dt>
<dd>The value of the &lt;scope&gt; element MUST be set to
              "private" as the alert is not meant for public consumption. 
              The &lt;addresses&gt; element is, however, not used by this specification since the 
              message routing is performed by SIP and the respective address information is already 
              available in the geolocation header. 
              Populating location information twice into different parts of the message can quickly 
              lead to inconsistency. <br />
 
</dd>
<dt>parameter:</dt>
<dd>The &lt;parameter&gt; element MAY contain additional
              information specific to the sensor. <br />

</dd>
<dt>area:</dt>
<dd>It is RECOMMENDED to omit this element when constructing a message.
            In case that the CAP message already contained an &lt;area&gt; element then the specified
            location information MUST be copied into the PIDF-LO structure of the geolocation 
            header element.
</dd>
</dl></blockquote>

<a name="example"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Example</h3>

<p><a class='info' href='#warning1'>Figure&nbsp;3<span> (</span><span class='info'>Example Message conveying an Alert</span><span>)</span></a> shows a CAP document indicating a BURLARY alert issued by
        a sensor with the identity 'sensor1@domain.com'. The location of the sensor can be 
        obtained from the attached geolocation information provided via the geolocation header 
        contained in the SIP MESSAGE structure. Additionally, the sensor provided some
        data long with the alert message using proprietary information elements only to be 
        processed by the receiver, a SIP entity acting as an aggregator. This example 
        reflects the description in <a class='info' href='#targeted'>Figure&nbsp;1<span> (</span><span class='info'>Targeted Emergency Alert Routing</span><span>)</span></a>.
</p>
<p>
        <br /><hr class="insert" />
<a name="warning1"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

   MESSAGE sip:aggregator@domain.com SIP/2.0
   Via: SIP/2.0/TCP sensor1.domain.com;branch=z9hG4bK776sgdkse
   Max-Forwards: 70
   From: sip:sensor1@domain.com;tag=49583
   To: sip:aggregator@domain.com
   Call-ID: asd88asd77a@1.2.3.4
   Geolocation: &lt;cid:abcdef@domain.com&gt;
     ;routing-allowed=yes
   Supported: geolocation
   Accept: application/pidf+xml, application/common-alerting-protocol+xml
   CSeq: 1 MESSAGE
   Content-Type: multipart/mixed; boundary=boundary1
   Content-Length: ...

   --boundary1

   Content-Type: common-alerting-protocol+xml
   Content-ID: &lt;abcdef2@domain.com&gt;
  &lt;?xml version="1.0" encoding="UTF-8"?&gt;

  &lt;alert xmlns="urn:oasis:names:tc:emergency:cap:1.1"&gt;
    &lt;identifier&gt;S-1&lt;/identifier&gt;
    &lt;sender&gt;sip:sensor1@domain.com&lt;/sender&gt;
    &lt;sent&gt;2008-11-19T14:57:00-07:00&lt;/sent&gt;
    &lt;status&gt;Actual&lt;/status&gt;
    &lt;msgType&gt;Alert&lt;/msgType&gt;
    &lt;scope&gt;Private&lt;/scope&gt;
    &lt;incidents&gt;abc1234&lt;/incidents&gt;
    &lt;info&gt;
        &lt;category&gt;Security&lt;/category&gt;
        &lt;event&gt;BURGLARY&lt;/event&gt;
        &lt;urgency&gt;Expected&lt;/urgency&gt;
        &lt;certainty&gt;Likely&lt;/certainty&gt;
        &lt;severity&gt;Moderate&lt;/severity&gt;
        &lt;senderName&gt;SENSOR 1&lt;/senderName&gt;
        &lt;parameter&gt;
          &lt;valueName&gt;SENSOR-DATA-NAMESPACE1&lt;/valueName&gt;
          &lt;value&gt;123&lt;/value&gt;
        &lt;/parameter&gt;
        &lt;parameter&gt;
          &lt;valueName&gt;SENSOR-DATA-NAMESPACE2&lt;/valueName&gt;
          &lt;value&gt;TRUE&lt;/value&gt;
        &lt;/parameter&gt;
    &lt;/info&gt;
   &lt;/alert&gt;

   --boundary1

   Content-Type: application/pidf+xml
   Content-ID: &lt;abcdef2@domain.com&gt;
   &lt;?xml version="1.0" encoding="UTF-8"?&gt;
      &lt;presence xmlns="urn:ietf:params:xml:ns:pidf"
          xmlns:gp="urn:ietf:params:xml:ns:pidf:geopriv10"
          xmlns:cl="urn:ietf:params:xml:ns:pidf:geopriv10:civicAddr"
          xmlns:gml="http://www.opengis.net/gml"
          entity="pres:sensor1@domain.com"&gt;
        &lt;tuple id="12345"&gt;
         &lt;dm:device id="sensor1"&gt;
          &lt;gp:geopriv&gt;
            &lt;gp:location-info&gt;
              &lt;gml:location&gt;
                &lt;gml:Point srsName="urn:ogc:def:crs:EPSG::4326"&gt;
                  &lt;gml:pos&gt;32.86726 -97.16054&lt;/gml:pos&gt;
                &lt;/gml:Point&gt;
               &lt;/gml:location&gt;
            &lt;/gp:location-info&gt;
            &lt;gp:usage-rules&gt;
              &lt;gp:retransmission-allowed&gt;yes
              &lt;/gp:retransmission-allowed&gt;
              &lt;gp:retention-expiry&gt;2010-07-30T20:00:00Z
              &lt;/gp:retention-expiry&gt;
            &lt;/gp:usage-rules&gt;
            &lt;gp:method&gt;802.11&lt;/gp:method&gt;
           &lt;/gp:geopriv&gt;
          &lt;dm:deviceID&gt;mac:1234567890ab&lt;/dm:deviceID&gt;
          &lt;dm:timestamp&gt;2010-07-28T20:57:29Z&lt;/dm:timestamp&gt;
         &lt;/dm:device&gt;
        &lt;/tuple&gt;
      &lt;/presence&gt;

   --boundary1--
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;3: Example Message conveying an Alert&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

      
</p>
<a name="sec-cons"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Security Considerations</h3>

<p> This section discusses security considerations when using SIP to make data-only emergency
        alerts utilizing CAP. Location specific threats are not unique to this document and the 
        discussion in <a class='info' href='#I-D.ietf-ecrit-trustworthy-location'>[I&#8209;D.ietf&#8209;ecrit&#8209;trustworthy&#8209;location]<span> (</span><span class='info'>Tschofenig, H., Schulzrinne, H., and B. Aboba, &ldquo;Trustworthy Location Information,&rdquo; October&nbsp;2010.</span><span>)</span></a>.
</p>
<a name="sec-cons-forged-assn"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
Forgery</h3>

<p>
          </p>
<blockquote class="text"><dl>
<dt>Threat:</dt>
<dd>
              <br />
 An adversary could forge or alter a CAP document to report
              false emergency alarms.<br />
<br />
 
</dd>
<dt>Countermeasures:</dt>
<dd>
              <br />
 To avoid this kind of attack, the entities must assure that
              proper mechanisms for protecting the CAP documents are employed, e.g., signing the CAP
              document itself. Section 3.3.2.1 of <a class='info' href='#cap'>[cap]<span> (</span><span class='info'>Jones, E. and A. Botterell, &ldquo;Common Alerting Protocol v. 1.1,&rdquo; October&nbsp;2005.</span><span>)</span></a> specifies the signing of CAP
              documents. This does not protect against a legitimate sensor sending phrank alerts
              after being compromised.
</dd>
</dl></blockquote><p>
        
</p>
<a name="sec-cons-replay-attack"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
Replay Attack</h3>

<p>
          </p>
<blockquote class="text"><dl>
<dt>Threat:</dt>
<dd>
              <br />
An adversary could eavesdrop alerts and reply them at a later 
              time.<br />
<br />
 
</dd>
<dt>Countermeasures:</dt>
<dd>
              <br />
 A CAP document contains the mandatory
              &lt;identifier&gt;, &lt;sender&gt;, &lt;sent&gt; elements and
              an optional &lt;expire&gt; element. These attributes make the CAP document
              unique for a specific sender and provide time restrictions. An entity that has
              received a CAP message already within the indicated timeframe is able to detect a
              replayed message and, if the content of that message is unchanged, then no additional
              security vulnerability is created. Additionally, it is RECOMMENDED to make use of SIP
              security mechanisms, such as SIP Identity <a class='info' href='#RFC4474'>[RFC4474]<span> (</span><span class='info'>Peterson, J. and C. Jennings, &ldquo;Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP),&rdquo; August&nbsp;2006.</span><span>)</span></a>, to tie the 
              CAP message to the SIP message.
</dd>
</dl></blockquote><p>
        
</p>
<a name="sec-cons-authorization"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.3"></a><h3>6.3.&nbsp;
Injecting False Alerts</h3>

<p>
          </p>
<blockquote class="text"><dl>
<dt>Threat:</dt>
<dd>
              <br />
 When an entity receives a CAP message it has to determine
              whether the entity distributing the CAP messages is genuine to avoid accepting
              messages that are injected by adversaries. In scenario <br />
<br />

</dd>
<dt>Countermeasures:</dt>
<dd>
              <br />
For some types of data-only emergency calls author/originator
              and the receiver/recipient have a relationship with each other and
              hence it is possible (using cryptographic techniques) to verify whether a message
              was indeed issued by an authorized entity. <a class='info' href='#targeted'>Figure&nbsp;1<span> (</span><span class='info'>Targeted Emergency Alert Routing</span><span>)</span></a> is such an
              environment. Standard SIP security mechanisms can be re-used for this purpose. 
              For example, identity based access control is a viable approach utilizing the
              asserted identity of the alert originator using P-Asserted-Identity 
              <a class='info' href='#RFC3325'>[RFC3325]<span> (</span><span class='info'>Jennings, C., Peterson, J., and M. Watson, &ldquo;Private Extensions to the Session Initiation Protocol (SIP) for Asserted Identity within Trusted Networks,&rdquo; November&nbsp;2002.</span><span>)</span></a> or SIP Identity <a class='info' href='#RFC4474'>[RFC4474]<span> (</span><span class='info'>Peterson, J. and C. Jennings, &ldquo;Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP),&rdquo; August&nbsp;2006.</span><span>)</span></a>.
              <br />
<br />

              There are, however, other types of
              data-only emergency calls where there is no such relationship between the
              author/originator and the receiver/recipient. Incoming alerts need to be 
              treated more carefully than multi-media emergency calls that contain additional 
              information, such as audio, to allow a call taker to sort out phrank calls.
</dd>
</dl></blockquote><p>
        
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
IANA Considerations</h3>

<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.1"></a><h3>7.1.&nbsp;
Registration of the 'application/common-alerting-protocol+xml' MIME type</h3>

<p>
          </p>
<blockquote class="text"><dl>
<dt>To:</dt>
<dd> ietf-types@iana.org<br />
 
</dd>
<dt>Subject:</dt>
<dd>Registration of MIME media type application/
              common-alerting-protocol+xml<br />

</dd>
<dt>MIME media type name:</dt>
<dd> application <br />

</dd>
<dt>MIME subtype name:</dt>
<dd>common-alerting-protocol+xml <br />

</dd>
<dt>Required parameters:</dt>
<dd> (none)<br />
 
</dd>
<dt>Optional parameters:</dt>
<dd> charset; Indicates the character encoding of
              enclosed XML. Default is UTF-8 <a class='info' href='#RFC3629'>[RFC3629]<span> (</span><span class='info'>Yergeau, F., &ldquo;UTF-8, a transformation format of ISO 10646,&rdquo; November&nbsp;2003.</span><span>)</span></a>.<br />

</dd>
<dt>Encoding considerations:</dt>
<dd> Uses XML, which can employ 8-bit characters,
              depending on the character encoding used. See RFC 3023 <a class='info' href='#RFC3023'>[RFC3023]<span> (</span><span class='info'>Murata, M., St. Laurent, S., and D. Kohn, &ldquo;XML Media Types,&rdquo; January&nbsp;2001.</span><span>)</span></a>,
              Section 3.2.<br />

</dd>
<dt>Security considerations:</dt>
<dd> This content type is designed to carry payloads
              of the Common Alerting Protocol (CAP). <br />

</dd>
<dt>Interoperability considerations:</dt>
<dd> This content type provides a way to
              convey CAP payloads.<br />
 
</dd>
<dt>Published specification:</dt>
<dd> RFC XXX [Replace by the RFC number of this
              specification]. <br />

</dd>
<dt>Applications which use this media type:</dt>
<dd> Applications that convey alerts
              and warnings according to the CAP standard.<br />

</dd>
<dt>Additional information:</dt>
<dd> OASIS has published the Common Alerting Protocol
              at http://www.oasis-open.org/committees/documents.php&amp;wg_abbrev=emergency <br />

</dd>
<dt>Person & email address to contact for further information:</dt>
<dd> Hannes
              Tschofenig, Hannes.Tschofenig@nsn.com <br />

</dd>
<dt>Intended usage:</dt>
<dd> Limited use <br />

</dd>
<dt>Author/Change controller:</dt>
<dd> IETF SIPPING working group <br />

</dd>
<dt>Other information:</dt>
<dd> This media type is a specialization of application/xml
              RFC 3023 <a class='info' href='#RFC3023'>[RFC3023]<span> (</span><span class='info'>Murata, M., St. Laurent, S., and D. Kohn, &ldquo;XML Media Types,&rdquo; January&nbsp;2001.</span><span>)</span></a>, and many of the considerations described there also
              apply to application/common-alerting-protocol+xml. <br />

</dd>
</dl></blockquote><p>
        
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Acknowledgments</h3>

<p>The authors would like to thank the participants of the Early Warning adhoc meeting at
        IETF#69 for their feedback. Additionally, we would like to thank the members of the NENA
        Long Term Direction Working Group for their feedback. 
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text">Bradner, S., &ldquo;<a href="ftp://ftp.isi.edu/in-notes/rfc2119.txt">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; March&nbsp;1997.</td></tr>
<tr><td class="author-text" valign="top"><a name="cap">[cap]</a></td>
<td class="author-text">Jones, E. and A. Botterell, &ldquo;<a href="http://www.oasis-open.org/apps/org/workgroup/emergency/download.php/14205/emergency-CAPv1.1-Committee%20Specification.pdf">Common Alerting Protocol v. 1.1</a>,&rdquo; October&nbsp;2005.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3265">[RFC3265]</a></td>
<td class="author-text">Roach, A., &ldquo;<a href="http://tools.ietf.org/html/rfc3265">Session Initiation Protocol (SIP)-Specific Event Notification</a>,&rdquo; RFC&nbsp;3265, June&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3265.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3903">[RFC3903]</a></td>
<td class="author-text">Niemi, A., &ldquo;<a href="http://tools.ietf.org/html/rfc3903">Session Initiation Protocol (SIP) Extension for Event State Publication</a>,&rdquo; RFC&nbsp;3903, October&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3903.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3023">[RFC3023]</a></td>
<td class="author-text">Murata, M., St. Laurent, S., and D. Kohn, &ldquo;<a href="http://tools.ietf.org/html/rfc3023">XML Media Types</a>,&rdquo; RFC&nbsp;3023, January&nbsp;2001 (<a href="http://www.rfc-editor.org/rfc/rfc3023.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3629">[RFC3629]</a></td>
<td class="author-text">Yergeau, F., &ldquo;<a href="http://tools.ietf.org/html/rfc3629">UTF-8, a transformation format of ISO 10646</a>,&rdquo; STD&nbsp;63, RFC&nbsp;3629, November&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3629.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-ecrit-trustworthy-location">[I-D.ietf-ecrit-trustworthy-location]</a></td>
<td class="author-text">Tschofenig, H., Schulzrinne, H., and B. Aboba, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-ecrit-trustworthy-location-01.txt">Trustworthy Location Information</a>,&rdquo; draft-ietf-ecrit-trustworthy-location-01 (work in progress), October&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-ecrit-trustworthy-location-01.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.ietf-ecrit-phonebcp">[I-D.ietf-ecrit-phonebcp]</a></td>
<td class="author-text">Rosen, B. and J. Polk, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-ecrit-phonebcp-15.txt">Best Current Practice for Communications Services in support of Emergency Calling</a>,&rdquo; draft-ietf-ecrit-phonebcp-15 (work in progress), July&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-ecrit-phonebcp-15.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-atoca-requirements">[I-D.ietf-atoca-requirements]</a></td>
<td class="author-text">Schulzrinne, H., Norreys, S., Rosen, B., and H. Tschofenig, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-atoca-requirements-00.txt">Requirements, Terminology and Framework for Exigent Communications</a>,&rdquo; draft-ietf-atoca-requirements-00 (work in progress), September&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-atoca-requirements-00.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4474">[RFC4474]</a></td>
<td class="author-text">Peterson, J. and C. Jennings, &ldquo;<a href="http://tools.ietf.org/html/rfc4474">Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP)</a>,&rdquo; RFC&nbsp;4474, August&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4474.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3325">[RFC3325]</a></td>
<td class="author-text">Jennings, C., Peterson, J., and M. Watson, &ldquo;<a href="http://tools.ietf.org/html/rfc3325">Private Extensions to the Session Initiation Protocol (SIP) for Asserted Identity within Trusted Networks</a>,&rdquo; RFC&nbsp;3325, November&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3325.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Brian Rosen</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">NeuStar, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">470 Conrad Dr</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Mars, PA  16046</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text"></td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:br@brianrosen.net">br@brianrosen.net</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Henning Schulzrinne</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Columbia University</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Department of Computer Science</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">450 Computer Science Building</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">New York, NY  10027</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 212 939 7004</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:hgs+ecrit@cs.columbia.edu">hgs+ecrit@cs.columbia.edu</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.cs.columbia.edu">http://www.cs.columbia.edu</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Hannes Tschofenig</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Nokia Siemens Networks</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Linnoitustie 6</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Espoo  02600</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Finland</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+358 (50) 4871445</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:Hannes.Tschofenig@gmx.net">Hannes.Tschofenig@gmx.net</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.tschofenig.priv.at">http://www.tschofenig.priv.at</a></td></tr>
</table>
</body></html>
