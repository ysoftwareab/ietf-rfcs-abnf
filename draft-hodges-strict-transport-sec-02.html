<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>HTTP Strict Transport Security (HSTS)</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="HTTP Strict Transport Security (HSTS)">
<meta name="keywords" content="Internet-Draft">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 60em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 60em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">J. Hodges</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">PayPal</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">C. Jackson</td></tr>
<tr><td class="header">Expires: January 12, 2011</td><td class="header">Carnegie Mellon University</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">A. Barth</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">University of
	    California</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Berkeley</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">July 11, 2010</td></tr>
</table></td></tr></table>
<h1><br />HTTP Strict Transport Security (HSTS)<br />draft-hodges-strict-transport-sec-02</h1>

<h3>Abstract</h3>

<p>
        This specification defines a mechanism enabling Web sites to
        declare themselves accessible only via secure connections,
        and/or for users to be able to direct their user agent(s) to
        interact with given sites only over secure connections. This
        overall policy is referred to as HTTP Strict Transport
        Security (HSTS). The policy is declared by Web sites via the
        Strict-Transport-Security HTTP Response Header Field, and/or by
        other means, e.g. user agent configuration. 
      
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted  in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF).  Note that other groups may also distribute
working documents as Internet-Drafts.  The list of current
Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
This Internet-Draft will expire on January 12, 2011.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the Simplified BSD License.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#sec-intro">1.</a>&nbsp;
Introduction<br />
<a href="#sctn-overview">2.</a>&nbsp;
Overview<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sctn-use-cases">2.1.</a>&nbsp;
Use Cases<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sctn-sts-policy-summary">2.2.</a>&nbsp;
Strict Transport Security Policy Effects<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sctn-threat-model">2.3.</a>&nbsp;
Threat Model<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sctn-threats-addr">2.3.1.</a>&nbsp;
Threats Addressed<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sctn-psv-net-atkr">2.3.1.1.</a>&nbsp;
Passive Network Attackers<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sctn-actv-net-atkr">2.3.1.2.</a>&nbsp;
Active Network Attackers<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sctn-web-dvlp">2.3.1.3.</a>&nbsp;
Web Site Development and Deployment Bugs<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sctn-threats-not-addressed">2.3.2.</a>&nbsp;
Threats Not Addressed<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sctn-phishing">2.3.2.1.</a>&nbsp;
Phishing<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sctn-malware">2.3.2.2.</a>&nbsp;
Malware and Browser Vulnerabilities<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sctn-reqs">2.4.</a>&nbsp;
Requirements<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sctn-reqs-ovrl-req">2.4.1.</a>&nbsp;
Overall Requirement<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sctn-reqs-core">2.4.1.1.</a>&nbsp;
Detailed Core Requirements<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sctn-reqs-ancillary">2.4.1.2.</a>&nbsp;
Detailed Ancillary Requirements<br />
<a href="#sctn-conformance">3.</a>&nbsp;
Conformance Criteria<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor1">3.1.</a>&nbsp;
Document Conventions<br />
<a href="#sctn-terminology">4.</a>&nbsp;
Terminology<br />
<a href="#sctn-syntax">5.</a>&nbsp;
Syntax<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sctn-syntax-grammar">5.1.</a>&nbsp;
Strict-Transport-Security HTTP Response Header Field<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sctn-syntax-examples">5.2.</a>&nbsp;
Examples<br />
<a href="#server-processing-model">6.</a>&nbsp;
Server Processing Model<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">6.1.</a>&nbsp;
HTTP-over-Secure-Transport Request Type<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">6.2.</a>&nbsp;
HTTP Request Type<br />
<a href="#user-agent-processing-model">7.</a>&nbsp;
User Agent Processing Model<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sctn-resp-hdr-proc">7.1.</a>&nbsp;
Strict-Transport-Security Response Header Field Processing<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sctn-uaproc-stshf-note">7.1.1.</a>&nbsp;
Noting a HSTS Server<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sctn-ksts-dn-match">7.1.2.</a>&nbsp;
Known HSTS Server Domain Name Matching<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">7.2.</a>&nbsp;
URI Loading<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">7.3.</a>&nbsp;
Errors in Secure Transport Establishment<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">7.4.</a>&nbsp;
HTTP-Equiv &lt;Meta&gt; Element Attribute<br />
<a href="#sctn-force-tls-dns-name-toascii">8.</a>&nbsp;
Domain Name ToASCII Conversion Operation<br />
<a href="#sctn-hosting-spec-advice">9.</a>&nbsp;
Server Implementation Advice<br />
<a href="#sctn-ua-impl-advice">10.</a>&nbsp;
UA Implementation Advice<br />
<a href="#sctn-svrproc-httpreq-efi">11.</a>&nbsp;
Constructing an Effective Request URI<br />
<a href="#sctn-sec-cons">12.</a>&nbsp;
Security Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">12.1.</a>&nbsp;
Denial of Service (DoS)<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sctn-sec-cons-boot">12.2.</a>&nbsp;
Bootstrap MITM Vulnerability<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">12.3.</a>&nbsp;
Network Time Attacks<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sctn-sec-cons-bogus-ca">12.4.</a>&nbsp;
Bogus Root CA Certificate Phish plus DNS Cache Poisoning Attack<br />
<a href="#sec-iana-consid">13.</a>&nbsp;
IANA Considerations<br />
<a href="#design-decision-faq">14.</a>&nbsp;
Design Decision Notes<br />
<a href="#rfc.references1">15.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">15.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">15.2.</a>&nbsp;
Informative References<br />
<a href="#acknowledgments">Appendix&nbsp;A.</a>&nbsp;
Acknowledgments<br />
<a href="#anchor11">Appendix&nbsp;B.</a>&nbsp;
Change Log<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="sec-intro"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>
        [ Please disscuss this draft on the hasmat@ietf.org 
        mailing list <a class='info' href='#HASMAT'>[HASMAT]<span> (</span><span class='info'>, &ldquo;HASMAT -- HTTP Application Security Minus Authentication and Transport,&rdquo; .</span><span>)</span></a>. ]
      
</p>
<p>
        The HTTP protocol <a class='info' href='#RFC2616'>[RFC2616]<span> (</span><span class='info'>Fielding, R., Gettys, J., Mogul, J., Frystyk, H., Masinter, L., Leach, P., and T. Berners-Lee, &ldquo;Hypertext Transfer Protocol -- HTTP/1.1,&rdquo; June&nbsp;1999.</span><span>)</span></a> may be used over
        various transports, typically the Transmission Control
        Protocol (TCP) <a class='info' href='#RFC0793'>[RFC0793]<span> (</span><span class='info'>Postel, J., &ldquo;Transmission Control Protocol,&rdquo; September&nbsp;1981.</span><span>)</span></a>. However, TCP does
        not provide channel integrity protection, confidentiality, nor
        secure server identification. Thus the Secure Sockets Layer
        (SSL) protocol <a class='info' href='#I-D.ietf-tls-ssl-version3'>[I&#8209;D.ietf&#8209;tls&#8209;ssl&#8209;version3]<span> (</span><span class='info'>Freier, A., Karlton, P., and P. Kocher, &ldquo;The SSL Protocol Version 3.0,&rdquo; November&nbsp;1996.</span><span>)</span></a> and
        its successor Transport Layer Security (TLS) <a class='info' href='#RFC4346'>[RFC4346]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.1,&rdquo; April&nbsp;2006.</span><span>)</span></a>, were developed in order to provide
        channel-oriented security, and are typically layered between
        application protocols and TCP.  <a class='info' href='#RFC2818'>[RFC2818]<span> (</span><span class='info'>Rescorla, E., &ldquo;HTTP Over TLS,&rdquo; May&nbsp;2000.</span><span>)</span></a>
        specifies how HTTP is layered onto TLS, and defines the
        Universal Resource Identifier (URI) scheme of
        &quot;https&quot; (in practice however, HTTP user agents (UAs)
        typically offer their users choices among SSL2, SSL3, and TLS
        for secure transport). URIs themselves are specified in <a class='info' href='#RFC3986'>[RFC3986]<span> (</span><span class='info'>Berners-Lee, T., Fielding, R., and L. Masinter, &ldquo;Uniform Resource Identifier (URI): Generic Syntax,&rdquo; January&nbsp;2005.</span><span>)</span></a>.
      
</p>
<p>
        UAs employ various local security policies with respect to the
        characteristics of their interactions with web resources
        depending on (in part) whether they are communicating with a
        given web resource using HTTP or
        HTTP-over-a-Secure-Transport. For example, cookies (<a class='info' href='#RFC2109'>[RFC2109]<span> (</span><span class='info'>Kristol, D. and L. Montulli, &ldquo;HTTP State Management Mechanism,&rdquo; February&nbsp;1997.</span><span>)</span></a> and <a class='info' href='#RFC2965'>[RFC2965]<span> (</span><span class='info'>Kristol, D. and L. Montulli, &ldquo;HTTP State Management Mechanism,&rdquo; October&nbsp;2000.</span><span>)</span></a>) may be
        flagged as Secure.  UAs are to send such Secure cookies to
        their addressed server only over a secure transport. This is
        in contrast to non-Secure cookies, which are returned to the
        server regardless of transport (although modulo other rules).
      
</p>
<p>
        UAs typically annunciate to their users any issues with secure
        connection establishment, such as being unable to validate a
        server certificate trust chain, or if a server certificate is
        expired, or if a server's domain name appears incorrectly in
        the server certificate (see section 3.1 of <a class='info' href='#RFC2818'>[RFC2818]<span> (</span><span class='info'>Rescorla, E., &ldquo;HTTP Over TLS,&rdquo; May&nbsp;2000.</span><span>)</span></a>). 

        Often, UAs enable users to elect to continue to interact with
        a web resource in the face of such issues. This behavior is
        sometimes referred to as &quot;click(ing) through&quot;
        security <a class='info' href='#GoodDhamijaEtAl05'>[GoodDhamijaEtAl05]<span> (</span><span class='info'>Good, N., Dhamija, R., Grossklags, J., Thaw, D., Aronowitz, S., Mulligan, D., and J. Konstan, &ldquo;Stopping                Spyware at the Gate: A User Study of Privacy, Notice and               Spyware,&rdquo; July&nbsp;2005.</span><span>)</span></a> <a class='info' href='#SunshineEgelmanEtAl09'>[SunshineEgelmanEtAl09]<span> (</span><span class='info'>Sunshine, J., Egelman, S., Almuhimedi, H., Atri, N., and L. Cranor, &ldquo;Crying Wolf: An Empirical Study of SSL Warning Effectiveness,&rdquo; Augus&nbsp;2009.</span><span>)</span></a>, and thus can be described
        as &quot;click-through insecurity&quot; .
      
</p>
<p>
        Jackson and Barth proposed an approach, in <a class='info' href='#ForceHTTPS'>[ForceHTTPS]<span> (</span><span class='info'>Jackson, C. and A. Barth, &ldquo;ForceHTTPS:                Protecting High-Security Web Sites from Network               Attacks,&rdquo; 2008.</span><span>)</span></a>, to enable web sites and/or users 
        to declare that such issues are to be treated as fatal
        and without direct user recourse.  The aim is to prevent users
        from unintentionally downgrading their security.
      
</p>
<p>
        This specification embodies and refines the approach proposed
        in <a class='info' href='#ForceHTTPS'>[ForceHTTPS]<span> (</span><span class='info'>Jackson, C. and A. Barth, &ldquo;ForceHTTPS:                Protecting High-Security Web Sites from Network               Attacks,&rdquo; 2008.</span><span>)</span></a>, e.g. a HTTP response header
        field is used to convey site policy to the UA rather than a
        cookie.
      
</p>
<a name="sctn-overview"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Overview</h3>

<p>
        This section discusses the use cases, summarizes the HTTP Strict
        Transport Security (HSTS) policy, and continues with a
        discussion of the threat model, non-addressed threats, and
        derived requirements.
      
</p>
<a name="sctn-use-cases"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
Use Cases</h3>

<p>
          The high-level use case is a combination of:
        
</p>
<p>
          </p>
<ul class="text">
<li> 
              Web browser user wishes to discover, or be introduced
              to, and/or utilize various web sites (some arbitrary,
              some known) in a secure fashion.
            
</li>
<li> 
              Web site deployer wishes to offer their site in an
              explicitly secure fashion for both their own, as well as
              their users', benefit.
            
</li>
</ul><p>
        
</p>
<a name="sctn-sts-policy-summary"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
Strict Transport Security Policy Effects</h3>

<p>
          The characteristics of the HTTP Strict Transport Security policy,
          as applied by a UA in its interactions with a web site
          wielding HSTS Policy, known as a HSTS Server, is summarized as
          follows:
        
</p>
<p>
          </p>
<ol class="text">
<li> 
              All insecure (&quot;http&quot;) connections to a HSTS Server
              are redirected by the HSTS Server to be secure connections
              (&quot;https&quot;).
            
</li>
<li>
              The UA terminates, without user recourse, any secure
              transport connection attempts upon any and all secure
              transport errors or warnings, including those caused by a
              site presenting self-signed certificates.
            
</li>
<li> 
              UAs transform insecure URI references to a HSTS Server
              into secure URI references before dereferencing them.
            
</li>
</ol><p>
        
</p>
<a name="sctn-threat-model"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3"></a><h3>2.3.&nbsp;
Threat Model</h3>

<p>
          HSTS is concerned with three threat classes: passive network
          attackers, active network attackers, and imperfect web
          developers. However, it is explicitly not a remedy for two
          other classes of threats: phishing and malware. Addressed
          and not addressed threats are briefly discussed below.
          Readers may wish refer to <a class='info' href='#ForceHTTPS'>[ForceHTTPS]<span> (</span><span class='info'>Jackson, C. and A. Barth, &ldquo;ForceHTTPS:                Protecting High-Security Web Sites from Network               Attacks,&rdquo; 2008.</span><span>)</span></a> for
          details as well as relevant citations.
        
</p>
<a name="sctn-threats-addr"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3.1"></a><h3>2.3.1.&nbsp;
Threats Addressed</h3>

<a name="sctn-psv-net-atkr"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3.1.1"></a><h3>2.3.1.1.&nbsp;
Passive Network Attackers</h3>

<p>
              When a user browses the web on a local wireless network
              (e.g. an 802.11-based wireless local area network) 
              a nearby attacker can possibly eavesdrop on the user's
              unencrypted Internet Protocol-based connections, such as
              HTTP, regardless of whether or not the local wireless
              network itself is secured <a class='info' href='#BeckTews09'>[BeckTews09]<span> (</span><span class='info'>Beck, M. and E. Tews, &ldquo;Practical Attacks Against WEP and WPA,&rdquo; 2009.</span><span>)</span></a>.

              Freely available wireless sniffing toolkits, e.g. <a class='info' href='#Aircrack-ng'>[Aircrack&#8209;ng]<span> (</span><span class='info'>d'Otreppe, T., &ldquo;Aircrack-ng,&rdquo; .</span><span>)</span></a>, enable such passive eavesdropping
              attacks.

              A passive network attacker using such tools can steal session
              identifiers and hijack the user's web session(s), by
              obtaining cookies containing authentication credentials
              for example <a class='info' href='#ForceHTTPS'>[ForceHTTPS]<span> (</span><span class='info'>Jackson, C. and A. Barth, &ldquo;ForceHTTPS:                Protecting High-Security Web Sites from Network               Attacks,&rdquo; 2008.</span><span>)</span></a>. 
            
</p>
<p>
              To mitigate such threats, some Web sites support, but usually
              do not force, access using end-to-end secure transport
              -- e.g. signaled through URIs constructed with the
              &quot;https&quot; scheme <a class='info' href='#RFC2818'>[RFC2818]<span> (</span><span class='info'>Rescorla, E., &ldquo;HTTP Over TLS,&rdquo; May&nbsp;2000.</span><span>)</span></a>. This
              can lead users to believe that accessing such services
              using secure transport protects them from passive
              network attackers.  Unfortunately, this is often not the
              case in real-world deployments as session identifiers
              are often stored in non-Secure cookies to permit
              interoperability with versions of the service offered
              over insecure transport (&quot;Secure cookes&quot;  are those 
              cookies containing the &quot;Secure&quot; attribute
              <a class='info' href='#RFC2109'>[RFC2109]<span> (</span><span class='info'>Kristol, D. and L. Montulli, &ldquo;HTTP State Management Mechanism,&rdquo; February&nbsp;1997.</span><span>)</span></a>).  For example, if the session
              identifier for a web site (an email service, say) is
              stored in a non-Secure cookie, it permits an attacker to
              hijack the user's session if the user's UA makes a single
              insecure HTTP request to the site.
            
</p>
<a name="sctn-actv-net-atkr"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3.1.2"></a><h3>2.3.1.2.&nbsp;
Active Network Attackers</h3>

<p>
              A determined attacker can mount an active attack, either
              by impersonating a user's DNS server or, in a wireless
              network, by spoofing network frames or offering a
              similarly-named evil twin access point. If the user is
              behind a wireless home router, an attacker can attempt
              to reconfigure the router using default passwords and
              other vulnerabilities. Some sites, such as banks, rely
              on end-to-end secure transport to protect themselves and their
              users from such active attackers. Unfortunately,
              browsers allow their users to easily opt-out of these
              protections in order to be usable for sites that
              incorrectly deploy secure transport, for example by
              generating and self-signing their own certificates
              (without also distributing their CA certificate to their
              users' browsers). 
            
</p>
<a name="sctn-web-dvlp"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3.1.3"></a><h3>2.3.1.3.&nbsp;
Web Site Development and Deployment Bugs</h3>

<p>
              The security of an otherwise uniformly secure site (i.e.
              all of its content is materialized via &quot;https&quot;
              URIs), can be compromised completely by an active
              attacker exploiting a simple mistake, such as the
              loading of a cascading style sheet or a SWF movie over
              an insecure connection (both cascading style sheets and
              SWF movies can script the embedding page, to the
              surprise of many web developers -- most browsers do not
              issue mixed content warnings when insecure SWF files are
              embedded). Even if the site's developers carefully
              scrutinize their login page for mixed content, a single
              insecure embedding anywhere on the site compromises the
              security of their login page because an attacker can
              script (control) the login page by injecting script into
              the page with mixed content. 
            
</p>
<p>
              </p>
<blockquote class="text"><dl>
<dt>Note:</dt>
<dd>
                  &quot;Mixed content&quot; here refers to the same notion
                  referred to as &quot;mixed security context&quot; later
                  elsewhere in this specification. 
                
</dd>
</dl></blockquote><p>
            
</p>
<a name="sctn-threats-not-addressed"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3.2"></a><h3>2.3.2.&nbsp;
Threats Not Addressed</h3>

<a name="sctn-phishing"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3.2.1"></a><h3>2.3.2.1.&nbsp;
Phishing</h3>

<p>
              Phishing attacks occur when an attacker solicits
              authentication credentials from the user by hosting a
              fake site located on a different domain than the real
              site, perhaps driving traffic to the fake site by
              sending a link in an email message. Phishing attacks can
              be very effective because users find it difficult to
              distinguish the real site from a fake site. HSTS is not a
              defense against phishing per se; rather, it complements
              many existing phishing defenses by instructing the
              browser to protect session integrity and long-lived
              authentication tokens <a class='info' href='#ForceHTTPS'>[ForceHTTPS]<span> (</span><span class='info'>Jackson, C. and A. Barth, &ldquo;ForceHTTPS:                Protecting High-Security Web Sites from Network               Attacks,&rdquo; 2008.</span><span>)</span></a>.
            
</p>
<a name="sctn-malware"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3.2.2"></a><h3>2.3.2.2.&nbsp;
Malware and Browser Vulnerabilities</h3>

<p>
              Because HSTS  is implemented as a browser security
              mechanism, it relies on the trustworthiness of the
              user's system to protect the session. Malicious
              code executing on
              the user's system can compromise a browser session,
              regardless of whether HSTS is used. 
            
</p>
<a name="sctn-reqs"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.4"></a><h3>2.4.&nbsp;
Requirements</h3>

<p>
            This section identifies and enumerates various
            requirements derived from the use cases and the threats
            discussed above, and lists the detailed core requirements
            HTTP Strict Transport Security addresses, as well as ancillary
            requirements that are not directly addressed. 
          
</p>
<a name="sctn-reqs-ovrl-req"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.4.1"></a><h3>2.4.1.&nbsp;
Overall Requirement</h3>

<p>
            </p>
<ul class="text">
<li> 
                Minimize the risks to web browser users and web site
                deployers that are derived from passive and active
                network attackers, web site development and deployment
                bugs, as well as insecure user actions. 
              
</li>
</ul><p>
          
</p>
<a name="sctn-reqs-core"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.4.1.1"></a><h3>2.4.1.1.&nbsp;
Detailed Core Requirements</h3>

<p>
              These core requirements are derived from the overall
              requirement, and are addressed by this specification.
            
</p>
<p>
              </p>
<ol class="text">
<li> 
                  Web sites need to be able to declare to UAs that
                  they should be interacted with using a strict security
                  policy. 
                
</li>
<li> 
                  Web sites need to be able to instruct UAs that
                  contact them insecurely to do so securely. 
                
</li>
<li> 
                  UAs need to note web sites that signal strict
                  security policy enablement, for a web site declared
                  time span. 
                
</li>
<li> 
                  UAs need to re-write all insecure UA
                  &quot;http&quot; URI loads to use the
                  &quot;https&quot; secure scheme for those web sites
                  for which secure policy is enabled. 
                
</li>
<li> 
                  Web site administrators need to be able to signal
                  strict security policy application to subdomains of
                  higher-level domains for which strict security policy
                  is enabled, and UAs need to enforce such policy. 
                
</li>
<li>
                  For example, both example.com and foo.example.com
                  could set policy for bar.foo.example.com.
                
</li>
<li> 
                  UAs need to disallow security policy application to
                  peer domains, and/or higher-level domains, by domains
                  for which strict security policy is enabled. 
                
</li>
<li>
                  For example, neither bar.foo.example.com nor
                  foo.example.com can set policy for example.com, nor
                  can bar.foo.example.com set policy for
                  foo.example.com. Also, foo.example.com cannot set
                  policy for sibling.example.com.
                
</li>
<li> 
                  UAs need to prevent users from clicking-through
                  security warnings. Halting connection attempts in the
                  face of secure transport exceptions is acceptable. 
                
</li>
</ol><p> 
            
</p>
<p>
              </p>
<blockquote class="text"><dl>
<dt>Note:</dt>
<dd>
                  A means for uniformly securely meeting the first
                  core requirement above is not specifically addressed
                  by this specification (see <a class='info' href='#sctn-sec-cons-boot'>Section&nbsp;12.2<span> (</span><span class='info'>Bootstrap MITM Vulnerability</span><span>)</span></a> &quot;<a class='info' href='#sctn-sec-cons-boot'>Bootstrap MITM Vulnerability<span> (</span><span class='info'>Bootstrap MITM Vulnerability</span><span>)</span></a>&quot;). It may be addressed by a
                  future revision of this specification or some other
                  specification. Note also that there are means by
                  which UA implementations may more fully meet the
                  first core requirement, see <a class='info' href='#sctn-ua-impl-advice'>Section&nbsp;10<span> (</span><span class='info'>UA Implementation Advice</span><span>)</span></a> &quot;<a class='info' href='#sctn-ua-impl-advice'>UA Implementation Advice<span> (</span><span class='info'>UA Implementation Advice</span><span>)</span></a>&quot;.
                
</dd>
</dl></blockquote><p>
            
</p>
<a name="sctn-reqs-ancillary"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.4.1.2"></a><h3>2.4.1.2.&nbsp;
Detailed Ancillary Requirements</h3>

<p>
              These ancillary requirements are also derived from the
              overall requirement. They are not normatively addressed in
              this specification, but could be met by UA implementations
              at their implementor's discretion, although meeting these
              requirements may be complex. 
            
</p>
<p>
              </p>
<ol class="text">
<li> 
                  Disallow &quot;mixed security context&quot; (also
                  known as &quot;mixed-content&quot;) loads (see section
                  5.3 "Mixed Content" in <a class='info' href='#W3C.WD-wsc-ui-20100309'>[W3C.WD&#8209;wsc&#8209;ui&#8209;20100309]<span> (</span><span class='info'>Saldhana, A. and T. Roessler, &ldquo;Web Security Context: User Interface Guidelines,&rdquo; March&nbsp;2010.</span><span>)</span></a>).
                
</li>
<li>
                  Facilitate user declaration of web sites for which
                  strict security policy is enabled, regardless of whether
                  the sites signal HSTS Policy.
                
</li>
</ol><p>
            
</p>
<a name="sctn-conformance"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Conformance Criteria</h3>

<p>
        This specification is written for servers and user agents
          (UAs). 
      
</p>
<p>
        In this specification, the words MUST, MUST NOT, MAY, and SHOULD
          are to be interpreted as described
                  in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
      
</p>
<p>
        A conformant server is one that implements all the
          requirements listed in this specification that are
          applicable to servers.
      
</p>
<p>
        A conformant user agent is one that implements all the
          requirements listed in this specification that are
          applicable to user agents.
      
</p>
<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Document Conventions</h3>

<p>
          </p>
<blockquote class="text"><dl>
<dt>Note:</dt>
<dd>
                ..is a note to the reader. These are points that should be
                expressly kept in mind and/or considered.
            
</dd>
</dl></blockquote><p>

          </p>
<blockquote class="text"><dl>
<dt>Warning:</dt>
<dd>
                This is how a warning is shown. 
                These are things that can have suboptimal 
                downside risks if not heeded. 
            
</dd>
</dl></blockquote><p>

          <a class='info' href='#comment.XXXn'>[XXXn]<span> (</span><span class='info'>JeffH: Some of the more major known issues are marked like this  (where &quot;n&quot; in &quot;XXXn&quot;  is a number).</span><span>)</span></a><a name='XXXn'></a> 
        
</p>
<p>
          <a class='info' href='#comment.TODOn'>[TODOn]<span> (</span><span class='info'>JeffH: Things to fix   (where &quot;n&quot; in &quot;TODOn&quot;  is a number).</span><span>)</span></a><a name='TODOn'></a> 
        
</p>
<a name="sctn-terminology"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Terminology</h3>

<p>Terminology is defined in this section.
</p>
<p></p>
<blockquote class="text"><dl>
<dt>ASCII case-insensitive comparison</dt>
<dd> 
             
              means comparing two
          strings exactly, codepoint for codepoint, except that the
          characters in the range U+0041 .. U+005A (i.e. LATIN CAPITAL
          LETTER A to LATIN CAPITAL LETTER Z)  and the corresponding
          characters in the range U+0061 .. U+007A (i.e. LATIN SMALL
          LETTER A to LATIN SMALL LETTER Z) are considered to also
          match. See <a class='info' href='#Unicode5'>[Unicode5]<span> (</span><span class='info'>The Unicode Consortium, &ldquo;The Unicode Standard, Version 5.0,&rdquo; 2007.</span><span>)</span></a> for details.
          
</dd>
</dl></blockquote><p>
      
</p>
<p></p>
<blockquote class="text"><dl>
<dt>codepoint</dt>
<dd>
                  is a colloquial
          contraction of Code Point, which is any value in the Unicode
          codespace; that is, the range of integers from 0 to
          10FFFF(hex) <a class='info' href='#Unicode5'>[Unicode5]<span> (</span><span class='info'>The Unicode Consortium, &ldquo;The Unicode Standard, Version 5.0,&rdquo; 2007.</span><span>)</span></a>.
            
</dd>
</dl></blockquote><p>
      
</p>
<p></p>
<blockquote class="text"><dl>
<dt>Domain Name</dt>
<dd>
                      Domain Names, also
          referred to as DNS Names, are defined in <a class='info' href='#RFC1035'>[RFC1035]<span> (</span><span class='info'>Mockapetris, P., &ldquo;Domain names - implementation and specification,&rdquo; November&nbsp;1987.</span><span>)</span></a> to be represented outside of the DNS
          protocol itself (and implementations thereof) as a series of
          labels separated by dots, e.g. &quot;example.com&quot; or
          &quot;yet.another.example.org&quot;. In the context of this
          specification, Domain Names appear in that portion of a URI
          satisfying the reg-name production in &quot;Appendix A.
          Collected ABNF for URI&quot; in <a class='info' href='#RFC3986'>[RFC3986]<span> (</span><span class='info'>Berners-Lee, T., Fielding, R., and L. Masinter, &ldquo;Uniform Resource Identifier (URI): Generic Syntax,&rdquo; January&nbsp;2005.</span><span>)</span></a>,
          and the host component from the Host HTTP header field
          production in section 14.23 of <a class='info' href='#RFC2616'>[RFC2616]<span> (</span><span class='info'>Fielding, R., Gettys, J., Mogul, J., Frystyk, H., Masinter, L., Leach, P., and T. Berners-Lee, &ldquo;Hypertext Transfer Protocol -- HTTP/1.1,&rdquo; June&nbsp;1999.</span><span>)</span></a>.
 
            
<blockquote class="text"><dl>
<dt>Note:</dt>
<dd>
                The Domain Names appearing in actual URI instances and
                matching the aforementioned production components may or
                may not be FQDNs.
              
</dd>
</dl></blockquote>
          
</dd>
</dl></blockquote><p>
      
</p>
<p>
        </p>
<blockquote class="text"><dl>
<dt>Domain Name Label</dt>
<dd> 
            is that portion of a Domain Name appearing
            &quot;between the dots&quot;, i.e. consider
            &quot;foo.example.com&quot;: &quot;foo&quot;,
            &quot;example&quot;, and &quot;com&quot; are all domain
            name labels. 
          
</dd>
</dl></blockquote><p>
      
</p>
<p></p>
<blockquote class="text"><dl>
<dt>Effective Request URI</dt>
<dd> 
            
          is a URI that can be constructed by an
            HTTP server for any given HTTP request sent to it. Some
            HTTP requests do not contain a contiguous representation
            of the URI identifying the resource being addressed by the
            HTTP request. Rather, different portions of a resource's
            URI may be mapped to both the Request-Line header field
            and the Host header field in an HTTP request message <a class='info' href='#I-D.ietf-httpbis-p1-messaging'>[I&#8209;D.ietf&#8209;httpbis&#8209;p1&#8209;messaging]<span> (</span><span class='info'>Fielding, R., Gettys, J., Mogul, J., Nielsen, H., Masinter, L., Leach, P., Berners-Lee, T., and J. Reschke, &ldquo;HTTP/1.1, part 1: URIs, Connections, and Message Parsing,&rdquo; March&nbsp;2010.</span><span>)</span></a>. The HTTP
            server coalesces these URI fragments and constructs an
            equivalent of the Request-URI that was used by the UA to
            generate the received HTTP request message. See 
              <a class='info' href='#sctn-svrproc-httpreq-efi'>Section&nbsp;11<span> (</span><span class='info'>Constructing an Effective Request URI</span><span>)</span></a> 
              &quot;<a class='info' href='#sctn-svrproc-httpreq-efi'>Constructing an Effective Request URI<span> (</span><span class='info'>Constructing an Effective Request URI</span><span>)</span></a>&quot;, below.
        
</dd>
</dl></blockquote><p>
      
</p>
<p></p>
<blockquote class="text"><dl>
<dt>FQDN</dt>
<dd>
            is an acronym for Fully-qualified Domain Name. A FQDN is a
            Domain Name that includes all higher level domains
            relevant to the named entity (typically a HSTS Server in
            the context of this specification). If one thinks of the
            DNS as a tree-structure with each node having its own
            Domain Name Label, a FQDN for a specific node would be its
            label followed by the labels of all the other nodes
            between it and the root of the tree.  For example, for a
            host, a FQDN would include the label that identifies the
            particular host, plus all domains of which the host is a
            part, up to and including the top-level domain (the root
            domain is always null) <a class='info' href='#RFC1594'>[RFC1594]<span> (</span><span class='info'>Marine, A., Reynolds, J., and G. Malkin, &ldquo;FYI on Questions and Answers - Answers to Commonly asked &quot;New Internet User&quot; Questions,&rdquo; March&nbsp;1994.</span><span>)</span></a>. 
        
</dd>
</dl></blockquote><p>
      
</p>
<p></p>
<blockquote class="text"><dl>
<dt>HTTP Strict Transport Security</dt>
<dd>
            
              is the
            overall name for the combined UA- and server-side security
            policy defined by this specification. 
            
</dd>
</dl></blockquote><p>
      
</p>
<p></p>
<blockquote class="text"><dl>
<dt>HTTP Strict Transport Security Server</dt>
<dd> 
            
              is a
            HTTP server implementing the server aspects of the HSTS
            policy. 
            
</dd>
</dl></blockquote><p>
      
</p>
<p></p>
<blockquote class="text"><dl>
<dt>HTTP Strict Transport Security Policy</dt>
<dd> 
            
          is the name of the combined overall
            UA- and server-side facets of the behavior specified in
            this specification.
            
</dd>
</dl></blockquote><p>
      
</p>
<p></p>
<blockquote class="text"><dl>
<dt>HSTS</dt>
<dd> 
              See HTTP Strict Transport
            Security. 
            
</dd>
</dl></blockquote><p>
      
</p>
<p></p>
<blockquote class="text"><dl>
<dt>HSTS Policy</dt>
<dd> 
              See HTTP Strict Transport Security Policy.
            
</dd>
</dl></blockquote><p>
      
</p>
<p></p>
<blockquote class="text"><dl>
<dt>HSTS Server</dt>
<dd>
            See HTTP Strict
            Transport Security Server.
            
</dd>
</dl></blockquote><p>
      
</p>
<p></p>
<blockquote class="text"><dl>
<dt>Known HSTS Server</dt>
<dd> 
          is a HSTS
            Server for which the UA has an HSTS Policy in effect.
            
</dd>
</dl></blockquote><p>
      
</p>
<p></p>
<blockquote class="text"><dl>
<dt>Local policy</dt>
<dd> 
          is comprised
            of policy rules deployers specify and which are often
            manifested as &quot;configuration settings&quot;.
            
</dd>
</dl></blockquote><p>
      
</p>
<p></p>
<blockquote class="text"><dl>
<dt>MITM</dt>
<dd> 
          is an acronym for
            man-in-the-middle. See &quot;man-in-the-middle
            attack&quot; in <a class='info' href='#RFC4949'>[RFC4949]<span> (</span><span class='info'>Shirey, R., &ldquo;Internet Security Glossary, Version 2,&rdquo; August&nbsp;2007.</span><span>)</span></a>.
            
</dd>
</dl></blockquote><p>
      
</p>
<p></p>
<blockquote class="text"><dl>
<dt>Request URI</dt>
<dd> 
              is the URI used to
            cause a UA to issue an HTTP request message. 
            
</dd>
</dl></blockquote><p>
      
</p>
<p></p>
<blockquote class="text"><dl>
<dt>UA</dt>
<dd> 
              is a an acronym for user agent. For
            the purposes of this specification, a UA is an HTTP client
            application typically actively manipulated by a user <a class='info' href='#RFC2616'>[RFC2616]<span> (</span><span class='info'>Fielding, R., Gettys, J., Mogul, J., Frystyk, H., Masinter, L., Leach, P., and T. Berners-Lee, &ldquo;Hypertext Transfer Protocol -- HTTP/1.1,&rdquo; June&nbsp;1999.</span><span>)</span></a> .
          
</dd>
</dl></blockquote><p>
      
</p>
<a name="sctn-syntax"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Syntax</h3>

<p>
          This section defines the syntax of the new header this
          specification introduces. It also provides a short
          description of the function the header.
        
</p>
<p>
          The <a class='info' href='#server-processing-model'>Section&nbsp;6<span> (</span><span class='info'>Server Processing Model</span><span>)</span></a>
          &quot;<a class='info' href='#server-processing-model'>Server Processing Model<span> (</span><span class='info'>Server Processing Model</span><span>)</span></a>&quot;
            section details how servers are to
          use this header. Likewise, the 
          <a class='info' href='#user-agent-processing-model'>Section&nbsp;7<span> (</span><span class='info'>User Agent Processing Model</span><span>)</span></a>
          &quot;<a class='info' href='#user-agent-processing-model'>User Agent Processing Model<span> (</span><span class='info'>User Agent Processing Model</span><span>)</span></a>&quot;
          section details how user agents are to use this
          header.
          
</p>
<a name="sctn-syntax-grammar"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Strict-Transport-Security HTTP Response Header Field</h3>

<p>
              The Strict-Transport-Security HTTP response header field
              indicates to a UA that it MUST enforce the HSTS Policy in
              regards to the server emitting the response message
              containing this header field. 
            
</p>
<p>
              The ABNF syntax for the Strict-Transport-Security HTTP
              Response Header field is:
            
</p>
<p>
  </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
Strict-Transport-Security =

           "Strict-Transport-Security" ":"  OWS  STS-v  OWS

; value
STS-v      = STS-d
           / STS-d  *( OWS ";" OWS  STS-d  OWS )

; STS directive
STS-d      = STS-d-cur / STS-d-ext

; defined STS directives
STS-d-cur  = maxAge / includeSubDomains

maxAge     = "max-age"  OWS  "="  OWS  delta-seconds  v-ext

includeSubDomains =  [ "includeSubDomains" ]  v-ext


; extension points
STS-d-ext  = name      ; STS extension directive

v-ext      = value     ; STS extension value

name       = token

value      = OWS / %x21-3A  /  %x3C-7E   ; i.e. optional white space, or
           ;     [ ! .. : ]  [ &lt; .. ~ ] any visible chars other than ";"

;  productions imported from [ID.ietf-httpbis-p1-messaging]:

token

OWS        ; Optional White Space

</pre></div><p>


          </p>
<blockquote class="text"><dl>
<dt>Note:</dt>
<dd>
              <a class='info' href='#I-D.ietf-httpbis-p1-messaging'>[I&#8209;D.ietf&#8209;httpbis&#8209;p1&#8209;messaging]<span> (</span><span class='info'>Fielding, R., Gettys, J., Mogul, J., Nielsen, H., Masinter, L., Leach, P., Berners-Lee, T., and J. Reschke, &ldquo;HTTP/1.1, part 1: URIs, Connections, and Message Parsing,&rdquo; March&nbsp;2010.</span><span>)</span></a> is used
              as the ABNF basis in order to ensure that the new header
              has equivalent parsing rules to the header fields defined
              in that same specification. Also: 
              
<ol class="text">
<li>
                  Quoted-string literals in the above ABNF stanza
                  are case-insensitive. 
                
</li>
<li>
                  In order to correctly
                  match the grammar above, the
                  Strict-Transport-Security HTTP Response Header MUST
                  include at least a max-age directive with at least a
                  single-digit value for delta-seconds. 
                
</li>
</ol> 
            
</dd>
</dl></blockquote><p>
        
</p>
<p> 
            </p>
<blockquote class="text"><dl>
<dt>max-age</dt>
<dd>
                specifies the number of seconds,
                after the recption of the Strict-Transport-Security HTTP
                Response Header, during which the UA regards the host
                the message was received from as a Known HSTS Server (see
              also <a class='info' href='#sctn-uaproc-stshf-note'>Section&nbsp;7.1.1<span> (</span><span class='info'>Noting a HSTS Server</span><span>)</span></a>
                 &quot;<a class='info' href='#sctn-uaproc-stshf-note'>Noting a HSTS Server<span> (</span><span class='info'>Noting a HSTS Server</span><span>)</span></a>&quot;, 
                below). The delta-seconds production is
                specified in <a class='info' href='#RFC2616'>[RFC2616]<span> (</span><span class='info'>Fielding, R., Gettys, J., Mogul, J., Frystyk, H., Masinter, L., Leach, P., and T. Berners-Lee, &ldquo;Hypertext Transfer Protocol -- HTTP/1.1,&rdquo; June&nbsp;1999.</span><span>)</span></a>. 
              
</dd>
</dl></blockquote><p>
          
</p>
<p>
            <a class='info' href='#comment.TODO1'>[TODO1]<span> (</span><span class='info'>JeffH: The above para wrt max-age may need further refinement.</span><span>)</span></a><a name='TODO1'></a>
          
</p>
<p> 
            </p>
<blockquote class="text"><dl>
<dt>includeSubDomains</dt>
<dd>
                  is a flag which, if
                  present, signals to the UA that the HSTS Policy applies
                  to this HSTS Server as well as any subdomains of the
                  server's FQDN. 
              
</dd>
</dl></blockquote><p>
          
</p>
<a name="sctn-syntax-examples"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Examples</h3>

<p>
          The below HSTS header field stipulates that the HSTS policy is to remain in 
          effect for one year (there are approximately 31 536 000 seconds in a year), 
          and the policy applies only to the domain of the HSTS Server issuing it:
        
</p>
<p>
  </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

Strict-Transport-Security: max-age=31536000

</pre></div><p>


</p>
<p>
          The below HSTS header field is stipulates that the HSTS policy is to remain in 
          effect for approximately six months 
          and the policy applies only to the domain of the issuing HSTS Server
          and all of its subdomains:
        
</p>
<p>
  </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

Strict-Transport-Security: max-age=15768000 ; includeSubDomains

</pre></div><p>


</p>
<a name="server-processing-model"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Server Processing Model</h3>

<p>
        This section describes the processing model that HSTS Servers
        implement. The model is comprised of two facets: the first
        being the processing rules for HTTP request messages received
        over a secure transport (e.g. TLS <a class='info' href='#RFC4346'>[RFC4346]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.1,&rdquo; April&nbsp;2006.</span><span>)</span></a>,
        SSL <a class='info' href='#I-D.ietf-tls-ssl-version3'>[I&#8209;D.ietf&#8209;tls&#8209;ssl&#8209;version3]<span> (</span><span class='info'>Freier, A., Karlton, P., and P. Kocher, &ldquo;The SSL Protocol Version 3.0,&rdquo; November&nbsp;1996.</span><span>)</span></a>, or perhaps
        others, the second being the processing rules for HTTP request
        messages received over non-secure transports, i.e. over TCP/IP
        <a class='info' href='#RFC0793'>[RFC0793]<span> (</span><span class='info'>Postel, J., &ldquo;Transmission Control Protocol,&rdquo; September&nbsp;1981.</span><span>)</span></a>.
      
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
HTTP-over-Secure-Transport Request Type</h3>

<p>
          When replying to an HTTP request that was conveyed over a
          secure transport, a HSTS Server SHOULD include
          in its response message a Strict-Transport-Security HTTP
          Response Header that MUST satisfy the grammar
          specified above in <a class='info' href='#sctn-syntax-grammar'>Section&nbsp;5.1<span> (</span><span class='info'>Strict-Transport-Security HTTP Response Header Field</span><span>)</span></a> &quot;<a class='info' href='#sctn-syntax-grammar'>Strict-Transport-Security HTTP Response Header Field<span> (</span><span class='info'>Strict-Transport-Security HTTP Response Header Field</span><span>)</span></a>&quot;.

          If a Strict-Transport-Security HTTP Response Header is
          included, the HSTS Server MUST include
          only one such header.
        
</p>
<p>
          </p>
<blockquote class="text"><dl>
<dt>Note:</dt>
<dd>
              Including the Strict-Transport-Security HTTP Response Header is
              stipulated as a &quot;SHOULD&quot; in order to accomodate
              various server- and network-side caches and load-balancing
              configurations where it may be difficult to uniformly emit
              Strict-Transport-Security HTTP Response Headers on behalf
              of a given HSTS Server. 
            
</dd>
<dt></dt>
<dd>
              Establishing a given host as a Known HSTS Server, in the
              context of a given UA, MAY be accomplished over the HTTP
              protocol by correctly returning, per this specification,
              at least one valid Strict-Transport-Security HTTP
              Response Header to the UA.  Other mechanisms, such as a
              client-side pre-loaded Known HSTS Server list MAY also be
              used. E.g. see <a class='info' href='#sctn-ua-impl-advice'>Section&nbsp;10<span> (</span><span class='info'>UA Implementation Advice</span><span>)</span></a>
              &quot;<a class='info' href='#sctn-ua-impl-advice'>UA Implementation Advice<span> (</span><span class='info'>UA Implementation Advice</span><span>)</span></a>&quot;.
            
</dd>
</dl></blockquote><p>
        
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
HTTP Request Type</h3>

<p>
          If a HSTS Server receives a HTTP request message over a
          non-secure transport, it SHOULD send a HTTP response message
          containing a Status-Code of 301 and a Location header field
          value containing either the HTTP request's original
          Effective Request URI (see <a class='info' href='#sctn-svrproc-httpreq-efi'>Section&nbsp;11<span> (</span><span class='info'>Constructing an Effective Request URI</span><span>)</span></a> &quot;<a class='info' href='#sctn-svrproc-httpreq-efi'>Constructing an Effective Request URI<span> (</span><span class='info'>Constructing an Effective Request URI</span><span>)</span></a>&quot;, below)
          altered as necessary to have a URI scheme of
          &quot;https&quot;, or a URI generated according to local
          policy (which SHOULD employ a URI scheme of
          &quot;https&quot;).
        
</p>
<p>
          </p>
<blockquote class="text"><dl>
<dt>Note:</dt>
<dd>
              The above behavior is a &quot;SHOULD&quot; rather than a 
              &quot;MUST&&quot; because:
              
<blockquote class="text"><dl>
<dt></dt>
<dd>                 
                  There are risks in server-side 
                  non-secure-to-secure redirects <a class='info' href='#owaspTLSGuide'>[owaspTLSGuide]<span> (</span><span class='info'>Coates, M., Wichers, d., Boberski, M., and T. Reguly, &ldquo;Transport Layer Protection Cheat Sheet,&rdquo; .</span><span>)</span></a>.
                
</dd>
<dt></dt>
<dd>
                  Site deployment characteristics -- e.g. a site that incorporates 
                  third-party components may not behave correctly when 
                  doing server-side non-secure-to-secure redirects in the case
                  of being accessed over non-secure transport, but 
                  does behave correctly when accessed uniformly over 
                  secure transport. The latter is the case given a 
                  HSTS-capapble UA that has already noted
                  the site as a Known HSTS Server (by whatever means, e.g. 
                  prior interaction or UA configuration). 
                
</dd>
</dl></blockquote>
            
</dd>
</dl></blockquote><p>
        
</p>
<p>
      <a class='info' href='#comment.XXX1'>[XXX1]<span> (</span><span class='info'>JeffH: perhaps the &quot;SHOULD&quot; in the above behavior should be a &quot;MAY&quot; given the  reasons it's presently not a &quot;MUST&quot;.</span><span>)</span></a><a name='XXX1'></a>
      
</p>
<p>
          A HSTS Server
          MUST NOT include the
          Strict-Transport-Security HTTP Response Header in
          HTTP responses conveyed over a non-secure
          transport.
        
</p>
<a name="user-agent-processing-model"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
User Agent Processing Model</h3>

<p>
        This section describes the HTTP Strict Transport
	Security processing model for UAs. 

        There are several facets to the model, enumerated by the 
        following subsections. 
      
</p>
<p>
        Also, this processing model assumes that all Domain Names manipulated in this specification's 
        context are already in ASCII
        Compatible Encoding (ACE) format as specified in
        <a class='info' href='#RFC3490'>[RFC3490]<span> (</span><span class='info'>Faltstrom, P., Hoffman, P., and A. Costello, &ldquo;Internationalizing Domain Names in Applications (IDNA),&rdquo; March&nbsp;2003.</span><span>)</span></a>. If this is not the case in some situation, use the 
        operation given in 
        <a class='info' href='#sctn-force-tls-dns-name-toascii'>Section&nbsp;8<span> (</span><span class='info'>Domain Name ToASCII Conversion Operation</span><span>)</span></a> 
          &quot;<a class='info' href='#sctn-force-tls-dns-name-toascii'>Domain Name ToASCII Conversion Operation<span> (</span><span class='info'>Domain Name ToASCII Conversion Operation</span><span>)</span></a>&quot; 
        to convert any encountered internationalized Domain Names to 
        ACE format before processing them.
      
</p>
<a name="sctn-resp-hdr-proc"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.1"></a><h3>7.1.&nbsp;
Strict-Transport-Security Response Header Field Processing</h3>

<p>
          If an HTTP response, received over a secure transport,
          includes a Strict-Transport-Security
          HTTP Response Header field, 
          conforming to the grammar specified in 
          <a class='info' href='#sctn-syntax-grammar'>Section&nbsp;5.1<span> (</span><span class='info'>Strict-Transport-Security HTTP Response Header Field</span><span>)</span></a>
          &quot;<a class='info' href='#sctn-syntax-grammar'>Strict-Transport-Security HTTP Response Header Field<span> (</span><span class='info'>Strict-Transport-Security HTTP Response Header Field</span><span>)</span></a>&quot;
            (above),
          and there are no underlying secure transport
          errors or warnings, the UA MUST either:
        
</p>
<p>   
          </p>
<ul class="text">
<li>
              Note the server as a Known HSTS Server if it is not already
              so noted (see <a class='info' href='#sctn-uaproc-stshf-note'>Section&nbsp;7.1.1<span> (</span><span class='info'>Noting a HSTS Server</span><span>)</span></a>
                &quot;<a class='info' href='#sctn-uaproc-stshf-note'>Noting a HSTS Server<span> (</span><span class='info'>Noting a HSTS Server</span><span>)</span></a>&quot;, below),
            
</li>
</ul><p>
        
</p>
<p>
          or,
        
</p>
<p>
          </p>
<ul class="text">
<li>
              Update its cached information for the Known HSTS
              Server if the max-age and/or
              includeSubDomains header field
              value tokens are conveying information different than that
              already maintained by the UA. 
            
</li>
</ul><p>
        
</p>
<p>
              </p>
<blockquote class="text"><dl>
<dt>Note:</dt>
<dd>
                  The max-age value is essentially a &quot;time to live&quot; value
                  relative to the reception time of the Strict-Transport-Security HTTP Response Header. 
                
</dd>
</dl></blockquote><p>
            
</p>
<p>
        <a class='info' href='#comment.TODO2'>[TODO2]<span> (</span><span class='info'>JeffH: Decide UA behavior in face of encountering multiple HSTS headers in a message. Use first header? Last?</span><span>)</span></a><a name='TODO2'></a> 
        
</p>
<p>
          Otherwise:
        
</p>
<p>
          </p>
<ul class="text">
<li>     
              If an HTTP response is received over insecure
            transport, the UA MUST ignore
            any present Strict-Transport-Security HTTP Response
            Header(s).
            
</li>
<li>
              The UA MUST ignore any
            Strict-Transport-Security HTTP Response Headers not
            conforming to the grammar specified in 
              <a class='info' href='#sctn-syntax-grammar'>Section&nbsp;5.1<span> (</span><span class='info'>Strict-Transport-Security HTTP Response Header Field</span><span>)</span></a> 
              &quot;<a class='info' href='#sctn-syntax-grammar'>Strict-Transport-Security HTTP Response Header Field<span> (</span><span class='info'>Strict-Transport-Security HTTP Response Header Field</span><span>)</span></a>&quot;
              (above).
            
</li>
</ul><p>
        
</p>
<a name="sctn-uaproc-stshf-note"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.1.1"></a><h3>7.1.1.&nbsp;
Noting a HSTS Server</h3>

<p>
      If the substring matching the host production from the 
       Request-URI, that the server
      responded to, syntactically 
      matches the IP-literal or IPv4address
      productions from section 3.2.2 of  <a class='info' href='#RFC3986'>[RFC3986]<span> (</span><span class='info'>Berners-Lee, T., Fielding, R., and L. Masinter, &ldquo;Uniform Resource Identifier (URI): Generic Syntax,&rdquo; January&nbsp;2005.</span><span>)</span></a>, then
      the UA MUST NOT note 
      this server as a Known HSTS Server. 
    
</p>
<p>
      Otherwise, if the substring does not congruently match a presently known HSTS Server, 
      per the matching procedure specified in 
            <a class='info' href='#sctn-ksts-dn-match'>Section&nbsp;7.1.2<span> (</span><span class='info'>Known HSTS Server Domain Name Matching</span><span>)</span></a>
              &quot;<a class='info' href='#sctn-ksts-dn-match'>Known HSTS Server Domain Name Matching<span> (</span><span class='info'>Known HSTS Server Domain Name Matching</span><span>)</span></a>&quot;
      below, then 
      the UA MUST  
      note this server as a Known HSTS Server, caching the HSTS Server&#039;s
      Domain Name and noting along with it the expiry time of this information, as effectively stipulated  
      per the given max-age value, 
      as well as whether the includeSubDomains 
      flag is asserted or not.
    
</p>
<a name="sctn-ksts-dn-match"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.1.2"></a><h3>7.1.2.&nbsp;
Known HSTS Server Domain Name Matching</h3>

<p>
            A UA determines whether a Domain Name represents a Known
            HSTS Server by looking for a match between the query Domain
            Name and the UA's set of Known HSTS Servers.
          
</p>
<p>
            </p>
<ol class="text">
<li> 
                Compare the query Domain Name string with the Domain
                Names of the UA's set of Known HSTS Servers.
	  
                For each Known HSTS Server's Domain Name, the
                comparison is done with the query Domain Name
                label-by-label using an ASCII case-insensitive
                comparison beginning with the rightmost label, and
                continuing right-to-left, and ignoring separator
                characters (see clause 3.1(4) of <a class='info' href='#RFC3986'>[RFC3986]<span> (</span><span class='info'>Berners-Lee, T., Fielding, R., and L. Masinter, &ldquo;Uniform Resource Identifier (URI): Generic Syntax,&rdquo; January&nbsp;2005.</span><span>)</span></a>.

                
<ul class="text">
<li> 
                    If a label-for-label match between an entire
                    Known HSTS Server's Domain Name and a right-hand
                    portion of the query Domain Name is found, then the
                    Known HSTS Server's Domain Name is a superdomain
                    match for the query Domain Name.
                    <br />
<br />
 
                    For example:
                    <div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
          Query Domain Name:       bar.foo.example.com

       Superdomain matched
       Known HSTS Server DN:           foo.example.com
</pre></div>
                    <br />
<br />
 
                    At this point, the query Domain Name is
                    ascertained to effectively represent a Known HSTS
                    Server. There may also be additional matches
                    further down the Domain Name Label tree, up to and
                    including a congruent match.
                  
</li>
<li> 
                    If a label-for-label match between a Known HSTS
                    Server's Domain Name and the query domain name is found,
                    i.e.  there are no further labels to compare, then the
                    query Domain Name congruently matches this Known HSTS
                    Server.
                    <br />
<br />
 
                    For example:
                    <div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
          Query Domain Name:           foo.example.com

       Congruently matched
       Known HSTS Server DN:           foo.example.com
</pre></div>
                    <br />
<br />
 
                    The query Domain Name is ascertained to 
                    represent
                    a Known HSTS Server. However, if there are also 
                    superdomain matches, the one highest in the tree asserts
                    the HSTS Policy for this Known HSTS Server.
                  
</li>
<li>
                    Otherwise, if no matches are found, the query Domain Name does not represent a 
                    Known HSTS Server. 
                  
</li>
</ul>
              
</li>
</ol><p>
          
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.2"></a><h3>7.2.&nbsp;
URI Loading</h3>

<p>
          Whenever the UA prepares to &quot;load&quot;, also known as
          &quot;dereference&quot;, any URI where the host production
          of the URI <a class='info' href='#RFC3986'>[RFC3986]<span> (</span><span class='info'>Berners-Lee, T., Fielding, R., and L. Masinter, &ldquo;Uniform Resource Identifier (URI): Generic Syntax,&rdquo; January&nbsp;2005.</span><span>)</span></a> matches that of a Known
          HSTS Server -- either as a congruent match or as a
          superdomain match where the superdomain Known HSTS Server has
          includeSubDomains asserted -- and the URI's scheme is
          &quot;http&quot;, then the UA &quot;MUST&quot; 
          replace the URI scheme with
          &quot;https&quot; before proceeding with the load.
        
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.3"></a><h3>7.3.&nbsp;
Errors in Secure Transport Establishment</h3>

<p>
          When connecting to a Known HSTS Server, the UA MUST terminate
          the connection with no user recourse if there are any errors
          (e.g. certificate errors), whether &quot;warning&quot; or
          &quot;fatal&quot; or any other error level, with the
          underlying secure transport.
        
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.4"></a><h3>7.4.&nbsp;
HTTP-Equiv &lt;Meta&gt; Element Attribute</h3>

<p>
          UAs MUST NOT heed
          http-equiv=&quot;Strict-Transport-Security&quot; attribute
          settings on &lt;meta&gt; elements in received content.
        
</p>
<a name="sctn-force-tls-dns-name-toascii"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Domain Name ToASCII Conversion Operation</h3>

<p>
        This operation converts a string-serialized Domain Name
        possibly containing arbitrary Unicode characters <a class='info' href='#Unicode5'>[Unicode5]<span> (</span><span class='info'>The Unicode Consortium, &ldquo;The Unicode Standard, Version 5.0,&rdquo; 2007.</span><span>)</span></a> into a string-serialized Domain Name in
        ASCII Compatible Encoding (ACE) format as specified in <a class='info' href='#RFC3490'>[RFC3490]<span> (</span><span class='info'>Faltstrom, P., Hoffman, P., and A. Costello, &ldquo;Internationalizing Domain Names in Applications (IDNA),&rdquo; March&nbsp;2003.</span><span>)</span></a>.
      
</p>
<p>
      The operation is:
      
</p>
<p>
        </p>
<ul class="text">
<li>
            Apply the IDNA conversion operation 
            (section 4 of  <a class='info' href='#RFC3490'>[RFC3490]<span> (</span><span class='info'>Faltstrom, P., Hoffman, P., and A. Costello, &ldquo;Internationalizing Domain Names in Applications (IDNA),&rdquo; March&nbsp;2003.</span><span>)</span></a>) to the string, 
            selecting the ToASCII operation 
            and setting both the AllowUnassigned and UseSTD3ASCIIRules flags.
          
</li>
</ul><p>
      
</p>
<a name="sctn-hosting-spec-advice"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Server Implementation Advice</h3>

<p>
        HSTS Policy expiration time considerations:
      
</p>
<p>
        </p>
<ul class="text">
<li>
            Server implementations and deploying web sites need to
            consider whether they are setting an expiry time that is a
            constant value into the future, e.g. by constantly sending
            the same max-age value to UAs. For exmple:
            <div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      Strict-Transport-Security: max-age=778000
</pre></div>
            A max-age value of 778000 is 90 days.  Note that each
            receipt of this header by a UA will require the UA to
            update its notion of when it must delete its knowledge of
            this Known HSTS Server. The specifics of how this is
            accomplished is out of the scope of this specification.
          
</li>
<li>
            Or, whether they are
            setting an expiry time that is a fixed point in time,
            e.g. by sending max-age values that represent the
            remaining time until the expiry time.
          
</li>
<li>
            A consideration here is whether a deployer wishes to have 
            signaled HSTS Policy expiry time match that
            for the web site's domain certificate.
          
</li>
</ul><p>
      
</p>
<p>
        Considerations for using HTTP Strict Transport Security in conjunction with 
        self-signed public-key certificates:
      
</p>
<p>
        </p>
<ul class="text">
<li>
            If a web site/organization/enterprise is generating their
            own secure transport public-key certificates for web
            sites, and that organization's root certificate authority
            (CA) certificate is not typically embedded by default in
            browser CA certificate stores, and if HSTS Policy is
            enabled on a site identifying itself using a self-signed 
            certificate, then secure connections to that site will
            fail without user recourse, per the HSTS design. This is to
            protect against various active attacks, as discussed
            above.
          
</li>
<li>
            However, if said organization strongly wishes to employ
            self-signed certificates, and their own CA in concert with
            HSTS, they can do so by deploying their root CA certificate
            to their users' browsers. There are various ways in which
            this can be accomplished (details are out of scope for
            this specification). Once their root CA cert is installed
            in the browsers, they may employ HSTS Policy on their
            site(s).
            
<blockquote class="text"><dl>
<dt>Note:</dt>
<dd>
                Interactively distributing root CA certs to users, e.g. via email, and having the users
                install them, is arguably training the users to be susceptible to 
                a possible form of phishing attack, see 
                <a class='info' href='#sctn-sec-cons-bogus-ca'>Section&nbsp;12.4<span> (</span><span class='info'>Bogus Root CA Certificate Phish plus DNS Cache Poisoning Attack</span><span>)</span></a>
                &quot;<a class='info' href='#sctn-sec-cons-bogus-ca'>Bogus Root CA Certificate Phish plus DNS Cache Poisoning Attack<span> (</span><span class='info'>Bogus Root CA Certificate Phish plus DNS Cache Poisoning Attack</span><span>)</span></a>&quot;. 
              
</dd>
</dl></blockquote>
          
</li>
</ul><p>
      
</p>
<a name="sctn-ua-impl-advice"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
UA Implementation Advice</h3>

<p>
        In order to provide users and web sites more effective
        protection, UA implementors should consider including features
        such as:
      
</p>
<p>
        </p>
<ul class="text">
<li>
            Disallowing &quot;mixed security context&quot; 
            (also known as &quot;mixed-content&quot;) loads (see section 5.3 "Mixed Content" in 
            <a class='info' href='#W3C.WD-wsc-ui-20100309'>[W3C.WD&#8209;wsc&#8209;ui&#8209;20100309]<span> (</span><span class='info'>Saldhana, A. and T. Roessler, &ldquo;Web Security Context: User Interface Guidelines,&rdquo; March&nbsp;2010.</span><span>)</span></a>).
            
<blockquote class="text"><dl>
<dt>Note:</dt>
<dd>
                In order to provide behavioral uniformity across UA 
                implementations, the notion of mixed security context aka mixed-content
                will require (further) standardization work, 
                e.g. to more clearly define the term(s) and to define 
                specific behaviors with respect to it. 
              
</dd>
</dl></blockquote>
          
</li>
</ul><p>
      
</p>
<p>
        In order to provide users effective controls for 
        managing their UA's caching of HSTS Policy, 
        UA implementors should consider including features such 
        as:

        </p>
<ul class="text">
<li>
            Ability to delete UA's cached HSTS Policy 
            on a per HSTS Server basis. 

            
<blockquote class="text"><dl>
<dt>Note:</dt>
<dd>
                Adding such a feature should be done very carefully in both
                the user interface and security senses. 

                Deleting a cache entry for a Known HSTS Server 
                should be a very deliberate and well-considered act -- it shouldn't be something 
                users get used to just "clicking through" in order to get work done. 

                Also, it shouldn't be possible for an attacker to inject script 
                into the UA that silently and programmatically removes 
                entries from the UA's cache of Known HSTS Servers.
              
</dd>
</dl></blockquote>

          
</li>
</ul><p>
      
</p>
<p>
        In order to provide users and web sites more complete 
        protection, UAs could offer advanced 
        features such as these:
        </p>
<ul class="text">
<li> 
            Ability for users to explicitly declare a given Domain
            Name as representing a HSTS Server, thus seeding it as a
            Known HSTS Server before any actual interaction with it. This
            would help protect against the <a class='info' href='#sctn-sec-cons-boot'>Section&nbsp;12.2<span> (</span><span class='info'>Bootstrap MITM Vulnerability</span><span>)</span></a> &quot;<a class='info' href='#sctn-sec-cons-boot'>Bootstrap MITM Vulnerability<span> (</span><span class='info'>Bootstrap MITM Vulnerability</span><span>)</span></a>&quot;.

            
<blockquote class="text"><dl>
<dt>Note:</dt>
<dd>
                Such a feature is difficult to get right on a per-site
                basis -- see the discussion of &quot;rewrite
                rules&quot; in section 5.5 of <a class='info' href='#ForceHTTPS'>[ForceHTTPS]<span> (</span><span class='info'>Jackson, C. and A. Barth, &ldquo;ForceHTTPS:                Protecting High-Security Web Sites from Network               Attacks,&rdquo; 2008.</span><span>)</span></a>. For example, arbitrary web
                sites may not materialize all their URIs using the
                &quot;https&quot; scheme, and thus could
                &quot;break&quot; if a UA were to attempt to access
                the site exclusively using such URIs. Also note that
                this feature would complement, but is independent of
                the following described facility.
              
</dd>
</dl></blockquote>
          
</li>
<li>
            Facility whereby web site administrators can have UAs pre-configured
            with HSTS Policy for their site(s) by the 
            UA vendor(s) -- in a manner similar to how root CA certificates
            are embedded in browsers &quot;at the factory&quot;.  
            This would help protect against the 
            <a class='info' href='#sctn-sec-cons-boot'>Section&nbsp;12.2<span> (</span><span class='info'>Bootstrap MITM Vulnerability</span><span>)</span></a>
            &quot;<a class='info' href='#sctn-sec-cons-boot'>Bootstrap MITM Vulnerability<span> (</span><span class='info'>Bootstrap MITM Vulnerability</span><span>)</span></a>&quot;. 

            
<blockquote class="text"><dl>
<dt>Note:</dt>
<dd>
                Such a facility complements the preceding described feature.
              
</dd>
</dl></blockquote>
          
</li>
</ul><p>
      
</p>
<p>
      <a class='info' href='#comment.XXX2'>[XXX2]<span> (</span><span class='info'>JeffH: These latter items beg the question of having some means of secure web site metadata and policy discovery  and acquisition. There is extant work that may be of interest, e.g. the W3C POWDER work, OASIS XRI/XRD work  (as well as XRDS-Simple), and &quot;Link-based Resource Descriptor Discovery&quot; (draft-hammer-discovery).</span><span>)</span></a><a name='XXX2'></a>
      
</p>
<a name="sctn-svrproc-httpreq-efi"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
Constructing an Effective Request URI</h3>

<p>
      This section specifies how an HSTS Server must 
      construct the Effective
	Request URI for a received HTTP request.
    
</p>
<p>
      The first line of an HTTP request message is specified by the following ABNF 
      (<a class='info' href='#I-D.ietf-httpbis-p1-messaging'>[I&#8209;D.ietf&#8209;httpbis&#8209;p1&#8209;messaging]<span> (</span><span class='info'>Fielding, R., Gettys, J., Mogul, J., Nielsen, H., Masinter, L., Leach, P., Berners-Lee, T., and J. Reschke, &ldquo;HTTP/1.1, part 1: URIs, Connections, and Message Parsing,&rdquo; March&nbsp;2010.</span><span>)</span></a>
      section 4.1):

        </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  Request-Line   = Method SP request-target SP HTTP-Version CRLF
</pre></div><p>


      The request-target is following ABNF 
      (<a class='info' href='#I-D.ietf-httpbis-p1-messaging'>[I&#8209;D.ietf&#8209;httpbis&#8209;p1&#8209;messaging]<span> (</span><span class='info'>Fielding, R., Gettys, J., Mogul, J., Nielsen, H., Masinter, L., Leach, P., Berners-Lee, T., and J. Reschke, &ldquo;HTTP/1.1, part 1: URIs, Connections, and Message Parsing,&rdquo; March&nbsp;2010.</span><span>)</span></a>
      section 4.1.2):

        </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  request-target = "*"
                 / absolute-URI
                 / ( path-absolute [ "?" query ] )
                 / authority
</pre></div><p>


        Additionally, many HTTP requests contain an additional Host 
        request header field. It is specified by the following ABNF 
        (<a class='info' href='#I-D.ietf-httpbis-p1-messaging'>[I&#8209;D.ietf&#8209;httpbis&#8209;p1&#8209;messaging]<span> (</span><span class='info'>Fielding, R., Gettys, J., Mogul, J., Nielsen, H., Masinter, L., Leach, P., Berners-Lee, T., and J. Reschke, &ldquo;HTTP/1.1, part 1: URIs, Connections, and Message Parsing,&rdquo; March&nbsp;2010.</span><span>)</span></a>
        section 4.1.2):

        </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  Host = "Host:" OWS Host-v
  Host-v = uri-host [ ":" port ]
</pre></div><p>


        Thus an example HTTP message containing the above header fields is:

        </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  GET /hello.txt HTTP/1.1
  Host: www.example.com
</pre></div><p>


      Another example is:

        </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  GET HTTP://www.example.com/hello.txt  HTTP/1.1
</pre></div><p>


        An HSTS Server constructs the Effective
	Request URI using the following ABNF grammar (which imports
        some productions from the above ABNF for Request-Line, request-target, 
        and Host:

        </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

   Effective-Request-URI = absolute-URI-present / path-absolute-form

   absolute-URI-present  = absolute-URI

   path-absolute-form  = scheme "://" Host-v path-absolute [ "?" query ]

   where:

     scheme is &amp;quot;http&amp;quot; if the request was received over
     insecure transport, or scheme is &amp;quot;https&amp;quot; if the
     request was received over secure transport.

</pre></div><p>


        For example, if the request message contains a request-target
        component that matches the grammar of absolute-URI, then the
        Effective-Request-URI is simply the value of the absolute-URI
        component.  Otherwise, the Effective-Request-URI is a
        combination, per the path-absolute-form production, of the
        Host-v, path-absolute, and query components from the
        request-target and Host components of the request message.
      
</p>
<p>
        <a class='info' href='#comment.TODO3'>[TODO3]<span> (</span><span class='info'>JeffH: This is a first SWAG at this section. Fix/add prose as appropriate, fix ABNF as needed per review.</span><span>)</span></a><a name='TODO3'></a> 
      
</p>
<a name="sctn-sec-cons"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12"></a><h3>12.&nbsp;
Security Considerations</h3>

<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12.1"></a><h3>12.1.&nbsp;
Denial of Service (DoS)</h3>

<p>
      HSTS could be used to mount certain forms of DoS attacks, where
      attackers set fake HSTS headers on legitimate sites
      available only insecurely (e.g. social network service sites, wikis, etc.).
    
</p>
<a name="sctn-sec-cons-boot"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12.2"></a><h3>12.2.&nbsp;
Bootstrap MITM Vulnerability</h3>

<p>
          The bootstrap MITM (Man-In-The-Middle) vulnerability is a
          vulnerability users and HSTS Servers encounter in the
          situation where the user manually enters, or follows a link,
          to a HSTS Server using a &quot;http&quot; URI rather than a
          &quot;https&quot; URI. Because the UA uses an insecure
          channel in the initial attempt to interact with the
          specified serve, such an initial interaction is vulnerable
          to various attacks <a class='info' href='#ForceHTTPS'>[ForceHTTPS]<span> (</span><span class='info'>Jackson, C. and A. Barth, &ldquo;ForceHTTPS:                Protecting High-Security Web Sites from Network               Attacks,&rdquo; 2008.</span><span>)</span></a> .
        
</p>
<p>
          </p>
<blockquote class="text"><dl>
<dt>Note:</dt>
<dd>
              There are various features/facilities that UA
              implementations may employ in order to mitigate this
              vulnerability. Please see <a class='info' href='#sctn-ua-impl-advice'>Section&nbsp;10<span> (</span><span class='info'>UA Implementation Advice</span><span>)</span></a> <a class='info' href='#sctn-ua-impl-advice'>UA Implementation Advice<span> (</span><span class='info'>UA Implementation Advice</span><span>)</span></a>. 
</dd>
</dl></blockquote><p>
        
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12.3"></a><h3>12.3.&nbsp;
Network Time Attacks</h3>

<p>
          Active network attacks can subvert network time protocols
          (like NTP) - making this header less effective against
          clients that trust NTP and/or lack a real time
          clock. Network time attacks are therefore beyond the scope
          of the defense. Note that modern operating systems use NTP
          by default.
        
</p>
<a name="sctn-sec-cons-bogus-ca"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12.4"></a><h3>12.4.&nbsp;
Bogus Root CA Certificate Phish plus DNS Cache Poisoning Attack</h3>

<p>
          If an attacker can convince users of, say,
          https://bank.example.com (which is protected by HSTS Policy),
          to install their own version of a root CA certificate
          purporting to be bank.example.com's CA, e.g. via a phishing
          email message with a link to such a certificate -- then, if
          they can perform an attack on the users' DNS, e.g. via cache
          poisoning, and turn on HSTS Policy for their fake
          bank.example.com site, then they have themselves some new
          users.
        
</p>
<a name="sec-iana-consid"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.13"></a><h3>13.&nbsp;
IANA Considerations</h3>

<p>
        Below is the Internet Assigned Numbers Authority (IANA)
        Provisional Message Header Field registration
        information per <a class='info' href='#RFC3864'>[RFC3864]<span> (</span><span class='info'>Klyne, G., Nottingham, M., and J. Mogul, &ldquo;Registration Procedures for Message Header Fields,&rdquo; September&nbsp;2004.</span><span>)</span></a>.
      
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
Header field name:           Strict-Transport-Security
Applicable protocol:         HTTP
Status:                      provisional
Author/Change controller:    TBD
Specification document(s):   this one
</pre></div>
<a name="design-decision-faq"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.14"></a><h3>14.&nbsp;
Design Decision Notes</h3>

<p>This appendix documents various design decisions.
</p>
<p>
            </p>
<ol class="text">
<li> 
	  Cookies aren't appropriate for HSTS Policy 
	  expression as they are potentially
	  mutable (while stored in the UA),
	  therefore an HTTP header field is employed.
              
</li>
<li>
	  We chose to not attempt to 
	  specify how &quot;mixed security context loads&quot;
	  (aka &quot;mixed-content loads&quot;) are 
	  handled due to UA 
	  implementation considerations  as well as 
	  classification difficulties. 
              
</li>
<li>
	  A HSTS Server may update UA notions
	  of HSTS Policy via new HSTS header field
	  values. We chose to have UAs honor the
	  &quot;freshest&quot; information received from a server
	  because there is the chance of a web site sending out an
	  errornous HSTS Policy, such as a multi-year
	  max-age value, and/or an incorrect
	  includeSubDomains flag. If the
	  HSTS Server couldn't correct such errors over
	  protocol, it would require some form of annunciation to
	  users and manual intervention on their part, which could be
	  a non-trivial problem.
              
</li>
<li>
	  HSTS Servers are identified only via Domain Names --
	  explicit IP address identification of all forms is excluded. This is for 
	  simplification and also is in recognition of various issues with using 
	  direct IP address identification in concert with PKI-based security. 
              
</li>
</ol><p>
          
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.15"></a><h3>15.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>15.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.ietf-httpbis-p1-messaging">[I-D.ietf-httpbis-p1-messaging]</a></td>
<td class="author-text">Fielding, R., Gettys, J., Mogul, J., Nielsen, H., Masinter, L., Leach, P., Berners-Lee, T., and J. Reschke, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-httpbis-p1-messaging-09.txt">HTTP/1.1, part 1: URIs, Connections, and Message Parsing</a>,&rdquo; draft-ietf-httpbis-p1-messaging-09 (work in progress), March&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-httpbis-p1-messaging-09.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1035">[RFC1035]</a></td>
<td class="author-text">Mockapetris, P., &ldquo;<a href="http://tools.ietf.org/html/rfc1035">Domain names - implementation and specification</a>,&rdquo; STD&nbsp;13, RFC&nbsp;1035, November&nbsp;1987 (<a href="http://www.rfc-editor.org/rfc/rfc1035.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1594">[RFC1594]</a></td>
<td class="author-text"><a href="mailto:amarine@atlas.arc.nasa.gov">Marine, A.</a>, <a href="mailto:jkrey@isi.edu">Reynolds, J.</a>, and <a href="mailto:gmalkin@Xylogics.COM">G. Malkin</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1594">FYI on Questions and Answers - Answers to Commonly asked "New Internet User" Questions</a>,&rdquo; RFC&nbsp;1594, March&nbsp;1994 (<a href="http://www.rfc-editor.org/rfc/rfc1594.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1983">[RFC1983]</a></td>
<td class="author-text"><a href="mailto:gmalkin@Xylogics.COM">Malkin, G.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1983">Internet Users' Glossary</a>,&rdquo; RFC&nbsp;1983, August&nbsp;1996 (<a href="http://www.rfc-editor.org/rfc/rfc1983.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2109">[RFC2109]</a></td>
<td class="author-text"><a href="mailto:dmk@bell-labs.com">Kristol, D.</a> and <a href="mailto:montulli@netscape.com">L. Montulli</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2109">HTTP State Management Mechanism</a>,&rdquo; RFC&nbsp;2109, February&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2109.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2109.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2109.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2616">[RFC2616]</a></td>
<td class="author-text"><a href="mailto:fielding@ics.uci.edu">Fielding, R.</a>, <a href="mailto:jg@w3.org">Gettys, J.</a>, <a href="mailto:mogul@wrl.dec.com">Mogul, J.</a>, <a href="mailto:frystyk@w3.org">Frystyk, H.</a>, <a href="mailto:masinter@parc.xerox.com">Masinter, L.</a>, <a href="mailto:paulle@microsoft.com">Leach, P.</a>, and <a href="mailto:timbl@w3.org">T. Berners-Lee</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2616">Hypertext Transfer Protocol -- HTTP/1.1</a>,&rdquo; RFC&nbsp;2616, June&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2616.txt">TXT</a>, <a href="http://www.rfc-editor.org/rfc/rfc2616.ps">PS</a>, <a href="http://www.rfc-editor.org/rfc/rfc2616.pdf">PDF</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2616.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2616.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2818">[RFC2818]</a></td>
<td class="author-text">Rescorla, E., &ldquo;<a href="http://tools.ietf.org/html/rfc2818">HTTP Over TLS</a>,&rdquo; RFC&nbsp;2818, May&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2818.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2965">[RFC2965]</a></td>
<td class="author-text"><a href="mailto:dmk@bell-labs.com">Kristol, D.</a> and <a href="mailto:lou@montulli.org">L. Montulli</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2965">HTTP State Management Mechanism</a>,&rdquo; RFC&nbsp;2965, October&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2965.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2965.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2965.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3454">[RFC3454]</a></td>
<td class="author-text">Hoffman, P. and M. Blanchet, &ldquo;<a href="http://tools.ietf.org/html/rfc3454">Preparation of Internationalized Strings ("stringprep")</a>,&rdquo; RFC&nbsp;3454, December&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3454.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3490">[RFC3490]</a></td>
<td class="author-text">Faltstrom, P., Hoffman, P., and A. Costello, &ldquo;<a href="http://tools.ietf.org/html/rfc3490">Internationalizing Domain Names in Applications (IDNA)</a>,&rdquo; RFC&nbsp;3490, March&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3490.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3492">[RFC3492]</a></td>
<td class="author-text">Costello, A., &ldquo;<a href="http://tools.ietf.org/html/rfc3492">Punycode: A Bootstring encoding of Unicode for Internationalized Domain Names in Applications (IDNA)</a>,&rdquo; RFC&nbsp;3492, March&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3492.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3864">[RFC3864]</a></td>
<td class="author-text">Klyne, G., Nottingham, M., and J. Mogul, &ldquo;<a href="http://tools.ietf.org/html/rfc3864">Registration Procedures for Message Header Fields</a>,&rdquo; BCP&nbsp;90, RFC&nbsp;3864, September&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3864.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3986">[RFC3986]</a></td>
<td class="author-text"><a href="mailto:timbl@w3.org">Berners-Lee, T.</a>, <a href="mailto:fielding@gbiv.com">Fielding, R.</a>, and <a href="mailto:LMM@acm.org">L. Masinter</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc3986">Uniform Resource Identifier (URI): Generic Syntax</a>,&rdquo; STD&nbsp;66, RFC&nbsp;3986, January&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc3986.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc3986.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc3986.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4346">[RFC4346]</a></td>
<td class="author-text">Dierks, T. and E. Rescorla, &ldquo;<a href="http://tools.ietf.org/html/rfc4346">The Transport Layer Security (TLS) Protocol Version 1.1</a>,&rdquo; RFC&nbsp;4346, April&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4346.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4949">[RFC4949]</a></td>
<td class="author-text">Shirey, R., &ldquo;<a href="http://tools.ietf.org/html/rfc4949">Internet Security Glossary, Version 2</a>,&rdquo; RFC&nbsp;4949, August&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4949.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="Unicode5">[Unicode5]</a></td>
<td class="author-text">The Unicode Consortium, &ldquo;The Unicode Standard, Version 5.0,&rdquo; Boston, MA, Addison-Wesley&nbsp;ISBN 0-321-48091-0, 2007.</td></tr>
<tr><td class="author-text" valign="top"><a name="W3C.WD-html5-20100304">[W3C.WD-html5-20100304]</a></td>
<td class="author-text">Hyatt, D. and I. Hickson, &ldquo;<a href="http://www.w3.org/TR/2010/WD-html5-20100304">HTML5</a>,&rdquo; World Wide Web Consortium WD&nbsp;WD-html5-20100304, March&nbsp;2010 (<a href="http://www.w3.org/TR/2010/WD-html5-20100304">HTML</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>15.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="Aircrack-ng">[Aircrack-ng]</a></td>
<td class="author-text">d'Otreppe, T., &ldquo;<a href="http://www.aircrack-ng.org/">Aircrack-ng</a>,&rdquo; Accessed:&nbsp;11-Jul-2010.</td></tr>
<tr><td class="author-text" valign="top"><a name="BeckTews09">[BeckTews09]</a></td>
<td class="author-text">Beck, M. and E. Tews, &ldquo;<a href="http://wirelesscenter.dk/Crypt/wifi-security-attacks/Practical%20Attacks%20Against%20WEP%20and%20WPA.pdf">Practical Attacks Against WEP and WPA</a>,&rdquo; Second ACM Conference on Wireless Network Security&nbsp;Zurich, Switzerland, 2009.</td></tr>
<tr><td class="author-text" valign="top"><a name="ForceHTTPS">[ForceHTTPS]</a></td>
<td class="author-text">Jackson, C. and A. Barth, &ldquo;<a href="https://crypto.stanford.edu/forcehttps/">ForceHTTPS: 
              Protecting High-Security Web Sites from Network
              Attacks</a>,&rdquo; In Proceedings of
      the 17th International World Wide Web Conference (WWW2008)&nbsp;, 2008.</td></tr>
<tr><td class="author-text" valign="top"><a name="GoodDhamijaEtAl05">[GoodDhamijaEtAl05]</a></td>
<td class="author-text">Good, N., Dhamija, R., Grossklags, J., Thaw, D., Aronowitz, S., Mulligan, D., and J. Konstan, &ldquo;<a href="http://people.ischool.berkeley.edu/~rachna/papers/spyware_study.pdf">Stopping 
              Spyware at the Gate: A User Study of Privacy, Notice and
              Spyware</a>,&rdquo; In Proceedings of
	Symposium On Usable Privacy and Security (SOUPS)&nbsp;Pittsburgh, PA, USA, July&nbsp;2005.</td></tr>
<tr><td class="author-text" valign="top"><a name="HASMAT">[HASMAT]</a></td>
<td class="author-text">&ldquo;<a href="https://www.ietf.org/mailman/listinfo/hasmat">HASMAT -- HTTP Application Security Minus Authentication and Transport</a>.&rdquo;</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-tls-ssl-version3">[I-D.ietf-tls-ssl-version3]</a></td>
<td class="author-text">Freier, A., Karlton, P., and P. Kocher, &ldquo;<a href="http://tools.ietf.org/html/draft-ietf-tls-ssl-version3-00">The SSL Protocol Version 3.0</a>,&rdquo; draft-ietf-tls-ssl-version3 (work in progress), November&nbsp;1996.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC0793">[RFC0793]</a></td>
<td class="author-text">Postel, J., &ldquo;<a href="http://tools.ietf.org/html/rfc793">Transmission Control Protocol</a>,&rdquo; STD&nbsp;7, RFC&nbsp;793, September&nbsp;1981 (<a href="http://www.rfc-editor.org/rfc/rfc793.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2396">[RFC2396]</a></td>
<td class="author-text"><a href="mailto:timbl@w3.org">Berners-Lee, T.</a>, <a href="mailto:fielding@ics.uci.edu">Fielding, R.</a>, and <a href="mailto:masinter@parc.xerox.com">L. Masinter</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2396">Uniform Resource Identifiers (URI): Generic Syntax</a>,&rdquo; RFC&nbsp;2396, August&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2396.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2396.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2396.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="SunshineEgelmanEtAl09">[SunshineEgelmanEtAl09]</a></td>
<td class="author-text">Sunshine, J., Egelman, S., Almuhimedi, H., Atri, N., and L. Cranor, &ldquo;<a href="http://www.usenix.org/events/sec09/tech/full_papers/sunshine.pdf">Crying Wolf: An Empirical Study of SSL Warning Effectiveness</a>,&rdquo; In Proceedings of
	18th USENIX Security Symposium&nbsp;Montreal, Canada, Augus&nbsp;2009.</td></tr>
<tr><td class="author-text" valign="top"><a name="W3C.WD-wsc-ui-20100309">[W3C.WD-wsc-ui-20100309]</a></td>
<td class="author-text">Saldhana, A. and T. Roessler, &ldquo;<a href="http://www.w3.org/TR/2010/WD-wsc-ui-20100309">Web Security Context: User Interface Guidelines</a>,&rdquo; World Wide Web Consortium LastCall&nbsp;WD-wsc-ui-20100309, March&nbsp;2010 (<a href="http://www.w3.org/TR/2010/WD-wsc-ui-20100309">HTML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="owaspTLSGuide">[owaspTLSGuide]</a></td>
<td class="author-text">Coates, M., Wichers, d., Boberski, M., and T. Reguly, &ldquo;<a href="http://www.owasp.org/index.php/Transport_Layer_Protection_Cheat_Sheet">Transport Layer Protection Cheat Sheet</a>,&rdquo; Accessed:&nbsp;11-Jul-2010.</td></tr>
</table>

<a name="acknowledgments"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Acknowledgments</h3>

<p>The authors thank Michael Barrett, Sid Stamm, Maciej
      Stachowiak, Andy Steingrubl, Brandon Sterne, Daniel Veditz for
      their review and contributions. 
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B"></a><h3>Appendix B.&nbsp;
Change Log</h3>

<p>
        </p>
<blockquote class="text">
<p>
            Changes from -01 to -02:

            </p>
<ol class="text">
<li>
                updated abstract such that means for expressing HSTS Policy other 
                than via HSTS header field is noted. 
              
</li>
<li>
                Changed spec title to "HTTP Strict Transport Security
                (HSTS)" from "Strict Transport Security". Updated use
                of "STS" acronym throughout spec to HSTS (except for
                when specifically discussing syntax of
                Strict-Transport-Security HTTP Response Header field),
                updated &quot;Terminology&quot; appropriately.
              
</li>
<li>
                Updated the discussion of &quot;Passive Network Attackers&quot; to 
                be more precise and offered references. 
              
</li>
<li>
                Removed para on nomative/non-normative from &quot;Conformance Criteria&quot; 
                pending polishing said section to IETF RFC norms. 
              
</li>
<li>
                Added examples subsection to &quot;Syntax&quot; section. 
              
</li>
<li>
                Added OWS to maxAge production in Strict-Transport-Security ABNF.
              
</li>
<li>
                Cleaned up explanation in the &quot;Note:&quot;
                in the &quot;HTTP-over-Secure-Transport Request Type&quot; section, 
                folded 3d para into &quot;Note:&quot;,
                added conformance clauses to the latter. 
              
</li>
<li>
                Added exaplanatory &quot;Note:&quot; and reference to 
                &quot;HTTP Request Type&quot; section. Added &quot;XXX1&quot; 
                issue. 
              
</li>
<li>
                Added conformance clause to &quot;URI Loading&quot;.
              
</li>
<li>
                Moved &quot;Notes for STS Server implementors:&quot;
                from &quot;UA Implementation dvice &quot; to
                &quot;HSTS Policy expiration time
                considerations:&quot; in &quot;Server Implementation
                Advice&quot;, and also noted another option.
              
</li>
<li>
                Added cautionary &quot;Note:&quot; to &quot;Ability to
                delete UA's cached HSTS Policy on a per HSTS Server
                basis&quot;.
              
</li>
<li>
                Added some informative references. 
              
</li>
<li>
                Various minor editorial fixes. 
              
</li>
</ol>
          

<p>
            Changes from -00 to -01:

            </p>
<ol class="text">
<li>
                Added reference to HASMAT mailing list and request
                that this spec be discussed there.
              
</li>
</ol>
          

</blockquote><p>
      
</p>
<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Jeff Hodges</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">PayPal</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">2211 North First Street</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">San Jose, California  95131</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:Jeff.Hodges@PayPal.com">Jeff.Hodges@PayPal.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Collin Jackson</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Carnegie Mellon University</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:collin.jackson@sv.cmu.edu">collin.jackson@sv.cmu.edu</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Adam Barth</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">University of
	    California Berkeley</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:abarth@eecs.berkeley.edu">abarth@eecs.berkeley.edu</a></td></tr>
</table>
</body></html>
