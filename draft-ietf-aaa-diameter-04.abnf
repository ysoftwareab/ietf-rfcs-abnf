command-def      = command-name "::=" diameter-message

diameter-name    = ALPHA *(ALPHA / DIGIT / "-")

command-name     = diameter-name
                          ; The command-name has to be Command name,
                          ; defined in the base or extended Diameter
                          ; specifications.

diameter-message = header  [ *fixed] [ *required] [ *optional] [ *fixed]

header           = "<Diameter-Header:" command-id, message-flags">"
fixed            = [qual] "<" avp-spec ">"

required         = [qual] "{" avp-spec "}"

optional         = [qual] "[" avp-name "]"
                          ; The avp-name in the 'optional' rule cannot
                          ; evaluate to any AVP Name which is included
                          ; in a fixed or required rule.

qual             = [min] "*" [max]
                          ; See ABNF conventions, RFC 2234 section 6.6.
                          ; The absence of any qualifiers implies that one
                          ; and only one such AVP MUST be present.
                          ;
                          ; NOTE:  "[" and "]" have a different meaning
                          ; than in ABNF (see the optional rule, above).
                          ; These braces cannot be used to express
                          ; optional fixed rules (such as an optional
                          ; ICV at the end.)  To do this, the convention
                          ; is '0*1fixed'.

min              = 1*DIGIT
                          ; The minimum number of times the element may
                          ; be present.

max              = 1*DIGIT
                          ; The maximum number of times the element may
                          ; be present.

avp-spec         = diameter-name
                          ; The avp-spec has to be an AVP Name, defined
                          ; in the base or extended Diameter
                          ; specifications.

avp-name         = avp-spec | "AVP"
                          ; The string "AVP" stands for *any* arbitrary
                          ; AVP Name, which does not conflict with the
                          ; required or fixed position AVPs defined in
                          ; the command code definition.

example-avp-val = Origin-FQDN Host-IP-Address
Origin-FQDN     = ; See Section 5.1
Host-IP-Address = ; See Section 6.2.4

Host-IP-Address = "10.10.10.10" would be encoded as follows:
          0       1       2       3       4       5       6       7
      +-------+-------+-------+-------+-------+-------+-------+-------+
    0 |     Example AVP Header (AVP Code = 999999), Length = 40       |
      +-------+-------+-------+-------+-------+-------+-------+-------+
    8 |     Origin-FQDN AVP Header (AVP Code = 264), Length = 19      |
      +-------+-------+-------+-------+-------+-------+-------+-------+
Failed-AVP   = Offending-AVP Failed-Vendor-Id
Offending-AVP      = ; See Section 9.4
Failed-Vendor-Id   = ; See Section 9.5

Redirect-Host   = Redirect-Host-Address Redirect-Host-Port
Redirect-Host-Address = ; See Section 11.3.2
Redirect-Host-Port    = ; See Section 11.3.3

Proxy-Info   = Proxy-Address Proxy-State
Proxy-Address = ; See Section 11.4.5
Proxy-State    = ; See Section 11.4.6

template-type=service:diameter

template-version=0.0

template-description=
     The Diameter protocol is defined by draft-ietf-aaa-diameter-04.txt

template-url-syntax=
url-path= ; The standard service URL syntax is used.
               ; For example: 'service:diameter://aaa.example.com:1812
supported-extensions= string L M
supported-transports= string L M
