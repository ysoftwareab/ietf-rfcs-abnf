<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Explicit Congestion Notification (ECN) Deployment Observations</title>
<meta content="Peter G. Heist" name="author">
<meta content="Jonathan Morton" name="author">
<meta content="
       This note presents data gathered at an Internet Service Provider's gateway on
the observed deployment and usage of ECN. Relevant IP counter and flow tracking
data was collected and analyzed for TCP and other protocols. 
    " name="description">
<meta content="xml2rfc 3.5.0" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="ECN" name="keyword">
<meta content="congestion control" name="keyword">
<meta content="draft-heist-tsvwg-ecn-deployment-observations-02" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.5.0
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.3
    google-i18n-address 2.4.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.6.2
    pycountry 20.7.3
    pyflakes 2.2.0
    PyYAML 5.4.1
    requests 2.25.1
    setuptools 54.0.0
    six 1.15.0
-->
<link href="/tmp/draft-heist-tsvwg-ecn-deployment-observations-g2hj4ip_.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">ecndep</td>
<td class="right">March 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Heist &amp; Morton</td>
<td class="center">Expires 9 September 2021</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Transport Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-heist-tsvwg-ecn-deployment-observations-02</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2021-03-08" class="published">8 March 2021</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2021-09-09">9 September 2021</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">P. Heist</div>
</div>
<div class="author">
      <div class="author-name">J. Morton</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Explicit Congestion Notification (ECN) Deployment Observations</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This note presents data gathered at an Internet Service Provider's gateway on
the observed deployment and usage of ECN. Relevant IP counter and flow tracking
data was collected and analyzed for TCP and other protocols.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 9 September 2021.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulEmpty">
<li class="compact toc ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a><a href="#section-toc.1-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="compact toc ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="xref">2</a>.  <a href="#name-collection-details" class="xref">Collection Details</a><a href="#section-toc.1-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="compact toc ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-observations" class="xref">Observations</a><a href="#section-toc.1-1.3.1" class="pilcrow">¶</a></p>
<ul class="compact toc ulEmpty">
<li class="compact toc ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-ecn-endpoint-activity" class="xref">ECN Endpoint Activity</a><a href="#section-toc.1-1.3.2.1.1" class="pilcrow">¶</a></p>
<ul class="compact toc ulEmpty">
<li class="compact toc ulEmpty" id="section-toc.1-1.3.2.1.2.1">
                    <p id="section-toc.1-1.3.2.1.2.1.1" class="keepWithNext"><a href="#section-3.1.1" class="xref">3.1.1</a>.  <a href="#name-client-initiation" class="xref">Client Initiation</a><a href="#section-toc.1-1.3.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="compact toc ulEmpty" id="section-toc.1-1.3.2.1.2.2">
                    <p id="section-toc.1-1.3.2.1.2.2.1"><a href="#section-3.1.2" class="xref">3.1.2</a>.  <a href="#name-server-acceptance" class="xref">Server Acceptance</a><a href="#section-toc.1-1.3.2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-rfc3168-aqm-activity" class="xref">RFC3168 AQM Activity</a><a href="#section-toc.1-1.3.2.2.1" class="pilcrow">¶</a></p>
<ul class="compact toc ulEmpty">
<li class="compact toc ulEmpty" id="section-toc.1-1.3.2.2.2.1">
                    <p id="section-toc.1-1.3.2.2.2.1.1"><a href="#section-3.2.1" class="xref">3.2.1</a>.  <a href="#name-known-aqm-activity" class="xref">Known AQM Activity</a><a href="#section-toc.1-1.3.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="compact toc ulEmpty" id="section-toc.1-1.3.2.2.2.2">
                    <p id="section-toc.1-1.3.2.2.2.2.1"><a href="#section-3.2.2" class="xref">3.2.2</a>.  <a href="#name-identifying-possible-aqm-ac" class="xref">Identifying Possible AQM Activity</a><a href="#section-toc.1-1.3.2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                  <li class="compact toc ulEmpty" id="section-toc.1-1.3.2.2.2.3">
                    <p id="section-toc.1-1.3.2.2.2.3.1"><a href="#section-3.2.3" class="xref">3.2.3</a>.  <a href="#name-aqm-false-positives" class="xref">AQM False Positives</a><a href="#section-toc.1-1.3.2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
                  <li class="compact toc ulEmpty" id="section-toc.1-1.3.2.2.2.4">
                    <p id="section-toc.1-1.3.2.2.2.4.1"><a href="#section-3.2.4" class="xref">3.2.4</a>.  <a href="#name-limitations-in-aqm-identifi" class="xref">Limitations in AQM Identification</a><a href="#section-toc.1-1.3.2.2.2.4.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-ecn-codepoints-on-non-tcp-p" class="xref">ECN Codepoints on Non-TCP Protocols</a><a href="#section-toc.1-1.3.2.3.1" class="pilcrow">¶</a></p>
<ul class="compact toc ulEmpty">
<li class="compact toc ulEmpty" id="section-toc.1-1.3.2.3.2.1">
                    <p id="section-toc.1-1.3.2.3.2.1.1"><a href="#section-3.3.1" class="xref">3.3.1</a>.  <a href="#name-tunneled-ecn-traffic" class="xref">Tunneled ECN Traffic</a><a href="#section-toc.1-1.3.2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="compact toc ulEmpty" id="section-toc.1-1.3.2.3.2.2">
                    <p id="section-toc.1-1.3.2.3.2.2.1"><a href="#section-3.3.2" class="xref">3.3.2</a>.  <a href="#name-quic-ecn" class="xref">QUIC-ECN</a><a href="#section-toc.1-1.3.2.3.2.2.1" class="pilcrow">¶</a></p>
</li>
                  <li class="compact toc ulEmpty" id="section-toc.1-1.3.2.3.2.3">
                    <p id="section-toc.1-1.3.2.3.2.3.1"><a href="#section-3.3.3" class="xref">3.3.3</a>.  <a href="#name-use-of-the-ecn-field-for-hi" class="xref">Use of the ECN Field for Historical Reasons</a><a href="#section-toc.1-1.3.2.3.2.3.1" class="pilcrow">¶</a></p>
</li>
                  <li class="compact toc ulEmpty" id="section-toc.1-1.3.2.3.2.4">
                    <p id="section-toc.1-1.3.2.3.2.4.1"><a href="#section-3.3.4" class="xref">3.3.4</a>.  <a href="#name-use-of-the-ecn-field-inadve" class="xref">Use of the ECN Field Inadvertently</a><a href="#section-toc.1-1.3.2.3.2.4.1" class="pilcrow">¶</a></p>
</li>
                  <li class="compact toc ulEmpty" id="section-toc.1-1.3.2.3.2.5">
                    <p id="section-toc.1-1.3.2.3.2.5.1"><a href="#section-3.3.5" class="xref">3.3.5</a>.  <a href="#name-use-of-the-ecn-field-malici" class="xref">Use of the ECN Field Maliciously</a><a href="#section-toc.1-1.3.2.3.2.5.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-study-limitations-and-recom" class="xref">Study Limitations and Recommendations for Future Work</a><a href="#section-toc.1-1.4.1" class="pilcrow">¶</a></p>
<ul class="compact toc ulEmpty">
<li class="compact toc ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-ecn-acceptance-rate" class="xref">ECN Acceptance Rate</a><a href="#section-toc.1-1.4.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-not-ect-counts-by-ip" class="xref">Not-ECT Counts by IP</a><a href="#section-toc.1-1.4.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.  <a href="#name-ecn-marked-packets-on-not-e" class="xref">ECN Marked Packets on Not-ECN-Capable TCP Flows</a><a href="#section-toc.1-1.4.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="xref">4.4</a>.  <a href="#name-tunnels" class="xref">Tunnels</a><a href="#section-toc.1-1.4.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="xref">4.5</a>.  <a href="#name-non-tcp-protocols" class="xref">Non-TCP Protocols</a><a href="#section-toc.1-1.4.2.5.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.4.2.6">
                <p id="section-toc.1-1.4.2.6.1"><a href="#section-4.6" class="xref">4.6</a>.  <a href="#name-other-protocols" class="xref">Other Protocols</a><a href="#section-toc.1-1.4.2.6.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.4.2.7">
                <p id="section-toc.1-1.4.2.7.1"><a href="#section-4.7" class="xref">4.7</a>.  <a href="#name-cwr-flag" class="xref">CWR Flag</a><a href="#section-toc.1-1.4.2.7.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.4.2.8">
                <p id="section-toc.1-1.4.2.8.1"><a href="#section-4.8" class="xref">4.8</a>.  <a href="#name-ns-flag" class="xref">NS Flag</a><a href="#section-toc.1-1.4.2.8.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-abbreviated-output-from-ecn" class="xref">Abbreviated Output from ecn-stats</a><a href="#section-toc.1-1.5.1" class="pilcrow">¶</a></p>
<ul class="compact toc ulEmpty">
<li class="compact toc ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-all-ip" class="xref">All IP</a><a href="#section-toc.1-1.5.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-tcp-initiated-from-lan-to-w" class="xref">TCP initiated from LAN to WAN</a><a href="#section-toc.1-1.5.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="xref">5.3</a>.  <a href="#name-non-tcp-conntrack-supported" class="xref">Non-TCP conntrack-supported protocols initiated from LAN to WAN</a><a href="#section-toc.1-1.5.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a><a href="#section-toc.1-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="compact toc ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a><a href="#section-toc.1-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="compact toc ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-affiliation" class="xref">Affiliation</a><a href="#section-toc.1-1.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="compact toc ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-acknowledgements" class="xref">Acknowledgements</a><a href="#section-toc.1-1.9.1" class="pilcrow">¶</a></p>
</li>
          <li class="compact toc ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-informative-references" class="xref">Informative References</a><a href="#section-toc.1-1.10.1" class="pilcrow">¶</a></p>
</li>
          <li class="compact toc ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-appendix.a" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a><a href="#section-toc.1-1.11.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">To help guide the evolution of ECN, there is a need for more data on current
deployment status, and observed usage of the ECN related bits, including:<a href="#section-1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-2.1">the initiation and acceptance of ECN capable TCP flows<a href="#section-1-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-2.2">marking via CE, and feedback for TCP via the ECE and CWR flags<a href="#section-1-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-2.3">codepoints set on packets for protocols other than TCP<a href="#section-1-2.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-1-3">For several weeks, we gathered data on all traffic through an Internet Service
Provider's gateway. Though some of the results are informative, we caution that
a larger, more widely reviewed and geographically distributed survey would be
needed to be authoritative.<a href="#section-1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="collection-details">
<section id="section-2">
      <h2 id="name-collection-details">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-collection-details" class="section-name selfRef">Collection Details</a>
      </h2>
<p id="section-2-1">From December 28, 2020 to January 20, 2021, data was gathered on all traffic
into and out of the Internet gateway at FreeNet Liberec, a cooperative WISP in
an urban area of the Czech Republic. A total of 122.5 TB of incoming data and 12
TB of outgoing data was seen.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">Around 660 members belong to the ISP, and 861 member IP addresses on the LAN
were considered active during data collection. Most member IPs are used by a
household of users, while others are for individual devices and public
locations.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3"><span>[<a href="#IPTABLES-ECN" class="xref">IPTABLES-ECN</a>]</span> was used to collect and analyze the data. This consists of a
script to gather the data using iptables and ipsets in Linux, and an analysis
program that produces textual output. An abbreviated version of the output is
included in <a href="#ecn-stats-output" class="xref">Section 5</a>. See the referred to source repository for more
details and full output.<a href="#section-2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="observations">
<section id="section-3">
      <h2 id="name-observations">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-observations" class="section-name selfRef">Observations</a>
      </h2>
<p id="section-3-1">Our key observations are summarized as follows, and further expanded upon in the
following sections:<a href="#section-3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-2.1">1.44% of TCP flows attempted to initiate ECN, across 390 member IPs (45%).<a href="#section-3-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-2.2">The acceptance rate for ECN flows was likely &gt;50%.<a href="#section-3-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-2.3">382 member IPs (44%) successfully negotiated any TCP ECN flows, determined
by receipt of any ECN SYN/ACKs.<a href="#section-3-2.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-2.4">71 member IPs (18.6% of ECN negotiating) saw possible AQM marking via CE and
ECE, with 38 in one of two subnets with known AQMs, and 33 from other subnets,
with unknown, possible AQMs.<a href="#section-3-2.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-2.5">The 33 IPs that saw possible AQM marking from unknown, possible AQMs, were
from a population of 319 ECN negotiating IPs not in subnets with known AQMs,
leading to a rough estimate of 10.3% of random paths with AQMs present.<a href="#section-3-2.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-2.6">Nonzero ECN codepoints were observed on 0.053% of non-TCP packets, with
possible attribution to tunneled ECN and/or misuse of the ECN field.<a href="#section-3-2.6" class="pilcrow">¶</a>
</li>
      </ul>
<div id="ecn-endpoint-activity">
<section id="section-3.1">
        <h3 id="name-ecn-endpoint-activity">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-ecn-endpoint-activity" class="section-name selfRef">ECN Endpoint Activity</a>
        </h3>
<div id="client-initiation">
<section id="section-3.1.1">
          <h4 id="name-client-initiation">
<a href="#section-3.1.1" class="section-number selfRef">3.1.1. </a><a href="#name-client-initiation" class="section-name selfRef">Client Initiation</a>
          </h4>
<p id="section-3.1.1-1">Of 319.5 million TCP SYNs from LAN to WAN, 1.44% indicated ECN capability. Of
861 active member IP addresses, 390 (45.3%) attempted initiation for at least
one ECN flow. A large proportion of the ECN flows are thought to come from Apple
devices.<a href="#section-3.1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="server-acceptance">
<section id="section-3.1.2">
          <h4 id="name-server-acceptance">
<a href="#section-3.1.2" class="section-number selfRef">3.1.2. </a><a href="#name-server-acceptance" class="section-name selfRef">Server Acceptance</a>
          </h4>
<p id="section-3.1.2-1">While 4.6 million ECN TCP SYNs were seen from LAN to WAN, 3.3 million ECN
SYN-ACKs were seen in return. While it's not possible to get an exact ECN
acceptance rate from this, it appears to be reasonably high, likely due to
default acceptance on prevailing server operating systems like Linux, FreeBSD
and recent versions of Windows Server.<a href="#section-3.1.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="rfc3168-aqm-activity">
<section id="section-3.2">
        <h3 id="name-rfc3168-aqm-activity">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-rfc3168-aqm-activity" class="section-name selfRef">RFC3168 AQM Activity</a>
        </h3>
<p id="section-3.2-1">There appears to be some evidence of <span>[<a href="#RFC3168" class="xref">RFC3168</a>]</span> marking AQMs. Of 861 active
member IP addresses:<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-2.1">
            <p id="section-3.2-2.1.1">382 member IPs, or 44%, successfully negotiated any TCP ECN flows<a href="#section-3.2-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-2.1.2.1">63 of those (16.5%) were from subnets with known AQMs deployed<a href="#section-3.2-2.1.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.2-2.1.2.2">319 (83.5%) were from subnets without a known AQM<a href="#section-3.2-2.1.2.2" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-3.2-2.2">90 member IPs saw any CE or ECE marks on negotiated TCP ECN flows<a href="#section-3.2-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.2-2.3">
            <p id="section-3.2-2.3.1">71 member IPs (18.6% of ECN negotiating) saw possible AQM activity, of which:<a href="#section-3.2-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-2.3.2.1">38 are in subnets with known AQMs (60.3% of 63 in total, representing the
detection rate)<a href="#section-3.2-2.3.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.2-2.3.2.2">33 are in subnets with unknown AQMs (10.3% of 319 in total, representing the
proportion of possible AQMs on random paths)<a href="#section-3.2-2.3.2.2" class="pilcrow">¶</a>
</li>
            </ul>
</li>
        </ul>
<p id="section-3.2-3">Some factors may affect the 10.3% proportion of possible AQMs on random
paths:<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-4.1">There may be false positives and negatives in possible AQM identification.<a href="#section-3.2-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.2-4.2">We have not attempted to correct for the likelihood of missed AQMs, for
example by assuming a detection rate similar to that for the known AQMs.<a href="#section-3.2-4.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.2-5">The following subsections clarify what is known AQM activity, what is considered
possible activity, and some of the limitations in identifying AQMs.<a href="#section-3.2-5" class="pilcrow">¶</a></p>
<div id="known-aqm-activity">
<section id="section-3.2.1">
          <h4 id="name-known-aqm-activity">
<a href="#section-3.2.1" class="section-number selfRef">3.2.1. </a><a href="#name-known-aqm-activity" class="section-name selfRef">Known AQM Activity</a>
          </h4>
<p id="section-3.2.1-1">Two backhaul links have fq_codel <span>[<a href="#RFC8290" class="xref">RFC8290</a>]</span> deployed, serving the 10.45.64.0/24
and 10.45.235.0/24 subnets (also see <a href="#affiliation" class="xref">Section 8</a>). These are the known AQMs
that account for the 38/71 member IPs that saw possible AQM activity. It is
possible that additional AQMs exist within the known subnets with AQM
deployments, however those would be harder to identify. The source of the AQM
activity from the remaining subnets is unknown, and could be from CPE, an
external network, or both.<a href="#section-3.2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="identifying-aqm-activity">
<section id="section-3.2.2">
          <h4 id="name-identifying-possible-aqm-ac">
<a href="#section-3.2.2" class="section-number selfRef">3.2.2. </a><a href="#name-identifying-possible-aqm-ac" class="section-name selfRef">Identifying Possible AQM Activity</a>
          </h4>
<p id="section-3.2.2-1">For detection of <span>[<a href="#RFC3168" class="xref">RFC3168</a>]</span> AQM activity, we observe TCP flows. The ECE flag
seen on negotiated TCP ECN flows allows for a more accurate confirmation of
marking, since CE marks applied after traversal through the gateway will be
missed.<a href="#section-3.2.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2.2-2">To classify a member IP as having seen AQM activity, we use the following
criteria:<a href="#section-3.2.2-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.2.2-3">
<li id="section-3.2.2-3.1">Nonzero ECT(0) counts in both directions<a href="#section-3.2.2-3.1" class="pilcrow">¶</a>
</li>
            <li id="section-3.2.2-3.2">AND nonzero ECE in either direction<a href="#section-3.2.2-3.2" class="pilcrow">¶</a>
</li>
            <li id="section-3.2.2-3.3">AND for nonzero CE and ECE, ECE:CE ratio &gt;= 2:1, OR subtraction of the ECE
marks from the ECE marks in the opposite direction allows the opposite
direction to meet the same criteria, as explained in the following section.<a href="#section-3.2.2-3.3" class="pilcrow">¶</a>
</li>
          </ol>
</section>
</div>
<div id="aqm-false-positives">
<section id="section-3.2.3">
          <h4 id="name-aqm-false-positives">
<a href="#section-3.2.3" class="section-number selfRef">3.2.3. </a><a href="#name-aqm-false-positives" class="section-name selfRef">AQM False Positives</a>
          </h4>
<p id="section-3.2.3-1">Some of the member IP addresses showed small and nearly identical counts of CE
marks in one direction and ECE flags in both directions, which seems unlikely to
be the result of genuine congestion and AQM activity. Our hypothesis is that
these are part of a "fingerprinting" routine used by port scanners when they
find an open port.<a href="#section-3.2.3-1" class="pilcrow">¶</a></p>
<p id="section-3.2.3-2">To exclude these, we looked for cases where inbound CE mark counts were within a
2x factor of outbound ECE flags, and discounted these as evidence of inbound AQM
activity. In these cases we also applied a more stringent check for outbound
AQM activity, by subtracting the outbound ECE flags from the inbound ECE flags,
and looking for at least a 2x ratio between any remainder and the number of
any outbound CE marks observed.<a href="#section-3.2.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="limitations-in-aqm-identification">
<section id="section-3.2.4">
          <h4 id="name-limitations-in-aqm-identifi">
<a href="#section-3.2.4" class="section-number selfRef">3.2.4. </a><a href="#name-limitations-in-aqm-identifi" class="section-name selfRef">Limitations in AQM Identification</a>
          </h4>
<p id="section-3.2.4-1">It is possible that some false-positives and/or false-negatives still remain in
our classification method. Additionally, there is no way to know if we have
identified all utilized paths with AQMs present. Detection first requires an ECN
flow (1.44% of TCP SYNs requested ECN) and for that flow to encounter congestion
at a bottleneck with an AQM enabled.<a href="#section-3.2.4-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="ecn-codepoints-non-tcp">
<section id="section-3.3">
        <h3 id="name-ecn-codepoints-on-non-tcp-p">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-ecn-codepoints-on-non-tcp-p" class="section-name selfRef">ECN Codepoints on Non-TCP Protocols</a>
        </h3>
<p id="section-3.3-1">Referring to the packet counts in the <em>All IP</em> / <em>Both Directions</em> table in the
stats output in <a href="#ecn-stats-output" class="xref">Section 5</a>, where M indicates megapackets and G,
gigapackets:<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<table class="center" id="table-1">
          <caption><a href="#table-1" class="selfRef">Table 1</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1"></th>
              <th class="text-left" rowspan="1" colspan="1">TCP (X)</th>
              <th class="text-left" rowspan="1" colspan="1">Conntrack (XX)</th>
              <th class="text-left" rowspan="1" colspan="1">Other</th>
              <th class="text-left" rowspan="1" colspan="1">Total</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">All</td>
              <td class="text-left" rowspan="1" colspan="1">76.60 G</td>
              <td class="text-left" rowspan="1" colspan="1">-&gt;</td>
              <td class="text-left" rowspan="1" colspan="1">43.52 G</td>
              <td class="text-left" rowspan="1" colspan="1">120.14 G</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">CE</td>
              <td class="text-left" rowspan="1" colspan="1">10031</td>
              <td class="text-left" rowspan="1" colspan="1">3.38 M</td>
              <td class="text-left" rowspan="1" colspan="1">813951</td>
              <td class="text-left" rowspan="1" colspan="1">4.20 M</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">ECT(0)</td>
              <td class="text-left" rowspan="1" colspan="1">523.91 M</td>
              <td class="text-left" rowspan="1" colspan="1">9.66 M</td>
              <td class="text-left" rowspan="1" colspan="1">2.55 M</td>
              <td class="text-left" rowspan="1" colspan="1">536.12 M</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">ECT(1)</td>
              <td class="text-left" rowspan="1" colspan="1">63</td>
              <td class="text-left" rowspan="1" colspan="1">6.68 M</td>
              <td class="text-left" rowspan="1" colspan="1">182928</td>
              <td class="text-left" rowspan="1" colspan="1">6.86 M</td>
            </tr>
          </tbody>
        </table>
<p id="section-3.3-3">(X)  TCP ECN packet counts only for negotiated ECN flows<a href="#section-3.3-3" class="pilcrow">¶</a></p>
<p id="section-3.3-4">(XX) UDP, ICMP, DCCP, SCTP, GRE (Conntrack All packets included in Other)<a href="#section-3.3-4" class="pilcrow">¶</a></p>
<p id="section-3.3-5">We note the following, where TCP-ECN refers to TCP flows that have successfully
negotiated ECN support:<a href="#section-3.3-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3-6.1">TCP-ECN accounted for 97.7% of the 536 million ECT(0) marks<a href="#section-3.3-6.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.3-6.2">0.68% of all TCP packets were from TCP-ECN marked with a nonzero ECN codepoint<a href="#section-3.3-6.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.3-6.3">About 0.05% of all non-TCP packets were marked with a nonzero ECN codepoint<a href="#section-3.3-6.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.3-6.4">Not-TCP-ECN accounted for 99.8% of the 4.2 million CE marks<a href="#section-3.3-6.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.3-6.5">Not-TCP-ECN accounted for virtually all of the ECT(1) marks<a href="#section-3.3-6.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.3-6.6">6.4 of 6.68 million ECT(1) marks were to a single member IP<a href="#section-3.3-6.6" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.3-7">Possible explanations for ECN marks on non-TCP packets are explored further in
this section.<a href="#section-3.3-7" class="pilcrow">¶</a></p>
<div id="tunneled-ecn-traffic">
<section id="section-3.3.1">
          <h4 id="name-tunneled-ecn-traffic">
<a href="#section-3.3.1" class="section-number selfRef">3.3.1. </a><a href="#name-tunneled-ecn-traffic" class="section-name selfRef">Tunneled ECN Traffic</a>
          </h4>
<p id="section-3.3.1-1">There are several different encapsulation methods used when handling the ECN
field through tunnels, as per <span>[<a href="#RFC3168" class="xref">RFC3168</a>]</span> and <span>[<a href="#RFC6040" class="xref">RFC6040</a>]</span>:<a href="#section-3.3.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.3.1-2">
<li id="section-3.3.1-2.1">copy the ECN field from the inner to the outer packet<a href="#section-3.3.1-2.1" class="pilcrow">¶</a>
</li>
            <li id="section-3.3.1-2.2">reset the ECN field on the outer packet to ECT(0)<a href="#section-3.3.1-2.2" class="pilcrow">¶</a>
</li>
            <li id="section-3.3.1-2.3">set Not-ECT on the outer packet<a href="#section-3.3.1-2.3" class="pilcrow">¶</a>
</li>
          </ol>
<p id="section-3.3.1-3">When method 3 is used at both ends of a tunnel, we would not expect to see
ECN codepoint usage in either direction.<a href="#section-3.3.1-3" class="pilcrow">¶</a></p>
<p id="section-3.3.1-4">When methods 1 or 2 are used at both ends of a tunnel, we would expect to see
ECT(0) on both incoming and outgoing packets. We would also expect a bias
towards incoming packets, since more data is generally downloaded than uploaded,
and pure ACKs do not have ECT(0) marks.<a href="#section-3.3.1-4" class="pilcrow">¶</a></p>
<p id="section-3.3.1-5">When method 3 is used at only one end of the tunnel, we would expect to see
ECT(0) on packets in only one direction.<a href="#section-3.3.1-5" class="pilcrow">¶</a></p>
<p id="section-3.3.1-6">We note the following:<a href="#section-3.3.1-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3.1-7.1">Bi-directional ECT(0) marks were observed for two member IP / port pairs,
on UDP port 443 and 60001.<a href="#section-3.3.1-7.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.3.1-7.2">
              <p id="section-3.3.1-7.2.1">Uni-directional ECT(0) marks were observed for:<a href="#section-3.3.1-7.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3.1-7.2.2.1">UDP port 4500 (IPSec NAT traversal <span>[<a href="#RFC3948" class="xref">RFC3948</a>]</span>) with 23 member IP addresses
downstream, and 1 member IP address upstream.<a href="#section-3.3.1-7.2.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-3.3.1-7.2.2.2">UDP port 51820 <span>[<a href="#WIREGUARD" class="xref">WIREGUARD</a>]</span> with 2 member IP addresses downstream.<a href="#section-3.3.1-7.2.2.2" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-3.3.1-7.2.2.3">Numerous UDP ports in other ranges, mostly on the downstream.<a href="#section-3.3.1-7.2.2.3" class="pilcrow">¶</a>
</li>
              </ul>
</li>
          </ul>
<p id="section-3.3.1-8">While it's possible that some of the data observed was from tunneled ECN
traffic, this can't be established definitively.<a href="#section-3.3.1-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="quic-ecn">
<section id="section-3.3.2">
          <h4 id="name-quic-ecn">
<a href="#section-3.3.2" class="section-number selfRef">3.3.2. </a><a href="#name-quic-ecn" class="section-name selfRef">QUIC-ECN</a>
          </h4>
<p id="section-3.3.2-1">Since a production implementation of QUIC-ECN is known to exist, we could see
some of that traffic in the non-TCP data. One member IP / dstport pair to
udp:443 saw 4603 ECT(0) marks from the WAN, and 1882 ECT(0) marks from the LAN.
This may have been QUIC-ECN, although it can't be established definitively.<a href="#section-3.3.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="use-of-the-ecn-field-for-historical-reasons">
<section id="section-3.3.3">
          <h4 id="name-use-of-the-ecn-field-for-hi">
<a href="#section-3.3.3" class="section-number selfRef">3.3.3. </a><a href="#name-use-of-the-ecn-field-for-hi" class="section-name selfRef">Use of the ECN Field for Historical Reasons</a>
          </h4>
<p id="section-3.3.3-1">Some applications may still use historical definitions of the former TOS byte.
Although RFC791 reserved the ECN field for future use, the now obsolete
<span>[<a href="#RFC1349" class="xref">RFC1349</a>]</span> defined the TOS field as four bits within the Type of Service octet,
one of which overlaps with the ECN field. This may account for some of the
observed usage of ECT(0), since the value for "minimize monetary cost" was 0001,
shifted to the left one bit, coinciding with ECT(0).<a href="#section-3.3.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="use-of-the-ecn-field-inadvertently">
<section id="section-3.3.4">
          <h4 id="name-use-of-the-ecn-field-inadve">
<a href="#section-3.3.4" class="section-number selfRef">3.3.4. </a><a href="#name-use-of-the-ecn-field-inadve" class="section-name selfRef">Use of the ECN Field Inadvertently</a>
          </h4>
<p id="section-3.3.4-1">Users of operating system's socket APIs wishing to set a DiffServ codepoint may
be confused as to whether or not they need to shift the desired value left two
bits before passing it in. Additionally, OS header files have been seen with
out-of-date definitions for obsolete values in the former Type of Service octet,
and obsolete definitions from <span>[<a href="#RFC2481" class="xref">RFC2481</a>]</span>.<a href="#section-3.3.4-1" class="pilcrow">¶</a></p>
<p id="section-3.3.4-2">Another possible source of confusion is the TOS field values listed in the now
obsolete <span>[<a href="#RFC1349" class="xref">RFC1349</a>]</span>, without having been shifted. A casual reader could see the
value 0001 for "minimize monetary cost" and think that they should use this
value in the TOS byte, conflicting with ECT(1), not realizing that:<a href="#section-3.3.4-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3.4-3.1">
              <span>[<a href="#RFC1349" class="xref">RFC1349</a>]</span> is obsolete<a href="#section-3.3.4-3.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.3.4-3.2">even if it weren't obsolete, the TOS values must be shifted to the left <strong>by
one bit</strong><a href="#section-3.3.4-3.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-3.3.4-4">To reduce incorrect usages of the DS field, OS header files should be sanitized,
obsolete RFCs more prominently marked as such, and API documentation brought up
to date.<a href="#section-3.3.4-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="use-of-the-ecn-field-maliciously">
<section id="section-3.3.5">
          <h4 id="name-use-of-the-ecn-field-malici">
<a href="#section-3.3.5" class="section-number selfRef">3.3.5. </a><a href="#name-use-of-the-ecn-field-malici" class="section-name selfRef">Use of the ECN Field Maliciously</a>
          </h4>
<p id="section-3.3.5-1">It's possible that some software is using the ECN field to gain an advantage in
Internet queues or for some other nefarious purpose. Further analysis would be
needed to determine if this is the case.<a href="#section-3.3.5-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="study-limitations-and-recommendations-for-future-work">
<section id="section-4">
      <h2 id="name-study-limitations-and-recom">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-study-limitations-and-recom" class="section-name selfRef">Study Limitations and Recommendations for Future Work</a>
      </h2>
<p id="section-4-1">The main limitation of this study is that we use counter data at different
levels of granularity. In some cases, it would be possible to gain more
certainty by taking packet captures and analyzing individual flows, but this can
be more difficult to do on production data, both for technical and privacy
reasons.<a href="#section-4-1" class="pilcrow">¶</a></p>
<div id="ecn-acceptance-rate">
<section id="section-4.1">
        <h3 id="name-ecn-acceptance-rate">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-ecn-acceptance-rate" class="section-name selfRef">ECN Acceptance Rate</a>
        </h3>
<p id="section-4.1-1">While we captured the ratio of ECN SYNs to ECN SYN-ACKs, we do not have an exact
count of flows that were accepted or rejected. It may be possible to do this
more accurately with additional iptables rules in <span>[<a href="#IPTABLES-ECN" class="xref">IPTABLES-ECN</a>]</span>. Additionally,
flows are tracked as ECN capable upon receipt of an ECN SYN/ACK, regardless of
whether that SYN/ACK was associated with an outgoing ECN SYN. This could be
improved with more state tracking.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="not-ect-counts-by-ip">
<section id="section-4.2">
        <h3 id="name-not-ect-counts-by-ip">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-not-ect-counts-by-ip" class="section-name selfRef">Not-ECT Counts by IP</a>
        </h3>
<p id="section-4.2-1">While we captured the nonzero ECN codepoints by IP address, separately for TCP
and conntrack-supported protocols, we do not have a count of Not-ECT by IP
address. Although it may be possible to obtain this, it would require an ipset
lookup for every packet traversing the gateway.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ecn-marked-packets-on-not-ecn-capable-tcp-flows">
<section id="section-4.3">
        <h3 id="name-ecn-marked-packets-on-not-e">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-ecn-marked-packets-on-not-e" class="section-name selfRef">ECN Marked Packets on Not-ECN-Capable TCP Flows</a>
        </h3>
<p id="section-4.3-1">While we captured counts of ECN marked packets on ECN capable TCP flows,
identified upon receipt of an ECN SYN/ACK, we do not have separate counts of TCP
packets that were marked with ECN codepoints without having negotiated ECN. This
should be possible to obtain with additional iptables rules in <span>[<a href="#IPTABLES-ECN" class="xref">IPTABLES-ECN</a>]</span>.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="tunnels">
<section id="section-4.4">
        <h3 id="name-tunnels">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-tunnels" class="section-name selfRef">Tunnels</a>
        </h3>
<p id="section-4.4-1">Tunnel protocols are challenging because of the different encapsulation methods
and protocols used. An analysis at the flow level, rather than by IP address and
destination port pairs, might be more useful in identifying the usage of ECN over
tunnels.<a href="#section-4.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="non-tcp-protocols">
<section id="section-4.5">
        <h3 id="name-non-tcp-protocols">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-non-tcp-protocols" class="section-name selfRef">Non-TCP Protocols</a>
        </h3>
<p id="section-4.5-1">More research is needed into the reasons for ECN codepoints being set on non-TCP
traffic. Given the relatively low volume of this traffic, it might be practical
to take packet captures of it for further analysis.<a href="#section-4.5-1" class="pilcrow">¶</a></p>
<p id="section-4.5-2">Additionally, we are currently not able to differentiate between the total
number of packets for conntrack-supported and Other protocols. This could be
improved with some changes to <span>[<a href="#IPTABLES-ECN" class="xref">IPTABLES-ECN</a>]</span>.<a href="#section-4.5-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="other-protocols">
<section id="section-4.6">
        <h3 id="name-other-protocols">
<a href="#section-4.6" class="section-number selfRef">4.6. </a><a href="#name-other-protocols" class="section-name selfRef">Other Protocols</a>
        </h3>
<p id="section-4.6-1">While this study looked at signals by IP address for TCP and IP/port for
conntrack-supported protocols, it does not break down signals for Other
protocols by IP address. Among those protocols is IPSec ESP packets, using IP
protocol 50. The <span>[<a href="#IPTABLES-ECN" class="xref">IPTABLES-ECN</a>]</span> script could be modified to create more ipsets
of type hash:ip, parallel to what was done for IP traffic as a whole, to further
analyze these protocols for tunnel activity.<a href="#section-4.6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="cwr-flag">
<section id="section-4.7">
        <h3 id="name-cwr-flag">
<a href="#section-4.7" class="section-number selfRef">4.7. </a><a href="#name-cwr-flag" class="section-name selfRef">CWR Flag</a>
        </h3>
<p id="section-4.7-1">Counting occurrences of TCP's CWR flag could better help distinguish between
some of the false positives and negatives in AQM detection.<a href="#section-4.7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ns-flag">
<section id="section-4.8">
        <h3 id="name-ns-flag">
<a href="#section-4.8" class="section-number selfRef">4.8. </a><a href="#name-ns-flag" class="section-name selfRef">NS Flag</a>
        </h3>
<p id="section-4.8-1">Since <span>[<a href="#RFC8311" class="xref">RFC8311</a>]</span> declared that the NS (Nonce Sum) flag is again Reserved, after
its now historical use by <span>[<a href="#RFC3540" class="xref">RFC3540</a>]</span>, we could collect any observed usages of
this flag, to confirm that it's available for use in practice.<a href="#section-4.8-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="ecn-stats-output">
<section id="section-5">
      <h2 id="name-abbreviated-output-from-ecn">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-abbreviated-output-from-ecn" class="section-name selfRef">Abbreviated Output from ecn-stats</a>
      </h2>
<p id="section-5-1">This abbreviated output only includes LAN to WAN flows, and a small subset of
the non-TCP conntrack protocols by member IP address. For full output, see the
<span>[<a href="#IPTABLES-ECN" class="xref">IPTABLES-ECN</a>]</span> repository.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2"><strong>Note</strong> the IP addresses shown here have been anonymized within the 10.0.0.0/8
address space, in a way that retains the subnet structure.<a href="#section-5-2" class="pilcrow">¶</a></p>
<div id="all-ip">
<section id="section-5.1">
        <h3 id="name-all-ip">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-all-ip" class="section-name selfRef">All IP</a>
        </h3>
<div class="artwork art-text alignLeft" id="section-5.1-1">
<pre>Packets, CE, ECT(0) and ECT(1) are packet counts, and use
units of M, G or T for mega, giga, or terapackets.

Total (both directions):

               TCP [*]     Conntrack [+]   Other      Total
               -------     -------------   -----      -----
    Bytes      101.22 TB   -&gt;              33.22 TB   134.46 TB
    Packets    76.60 G     -&gt;              43.52 G    120.14 G
    |-CE       10031       3.38 M          813951     4.20 M
    |-ECT(0)   523.91 M    9.66 M          2.55 M     536.12 M
    |-ECT(1)   63          6.68 M          182928     6.86 M

WAN to LAN:

               TCP [*]    Conntrack [+]   Other      Total
               -------    -------------   -----      -----
    Bytes      95.79 TB   -&gt;              26.65 TB   122.45 TB
    Packets    41.43 G    -&gt;              30.29 G    71.72 G
    |-CE       9298       3.38 M          721002     4.11 M
    |-ECT(0)   480.35 M   9.62 M          1.93 M     491.91 M
    |-ECT(1)   62         6.68 M          65111      6.74 M

LAN to WAN:

               TCP [*]   Conntrack [+]   Other     Total
               -------   -------------   -----     -----
    Bytes      5.43 TB   -&gt;              6.57 TB   12.00 TB
    Packets    35.17 G   -&gt;              13.23 G   48.41 G
    |-CE       733       60              92949     93742
    |-ECT(0)   43.56 M   40366           614623    44.21 M
    |-ECT(1)   1         28              117817    117846

    [*] TCP ECN packet counts only for negotiated ECN flows
        Counts for non-ECN TCP flows in Other
    [+] Conntrack protocols: UDP, ICMP, DCCP, SCTP, GRE
        Conntrack total Bytes and Packets included in Other
</pre><a href="#section-5.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="tcp-initiated-from-lan-to-wan">
<section id="section-5.2">
        <h3 id="name-tcp-initiated-from-lan-to-w">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-tcp-initiated-from-lan-to-w" class="section-name selfRef">TCP initiated from LAN to WAN</a>
        </h3>
<div class="artwork art-text alignLeft" id="section-5.2-1">
<pre>SYN packet count totals for active IPs:

    All SYNs:     319560652
    ECN SYNs:     4601118 (1.44% of all)
    ECN SYN/ACKs: 3273815 (71.15% of ECN SYNs)

ECN packet count totals for active IPs:

    Direction CE   ECE    ECT(0)    ECT(1)
    --------- --   ---    ------    ------
    From LAN  733  502985 42903861  1
    From WAN  9298 19367  479756419 62

IP address counts with TCP and ECN activity:

    Active (sent &gt;= 10 SYNs):  861 (of 1195)
    Initiated any ECN flows:   390 (45.3%)
    Negotiated any ECN flows:  382 (44.4%)
    Saw CE or ECE on ECN flow: 90 (23.6% of ECN negotiating)
    Saw ECT(1) on ECN flow:    5

IP address counts with possible AQM activity:

    Negotiated any ECN flows:       382
    |- in subnet with known AQM:    63 (16.5% of ECN negotiating)
    |- in subnet without known AQM: 319 (83.5% of ECN negotiating)

    Criteria for possible AQM activity:
        nonzero ECT(0) in both directions
        AND nonzero ECE in either direction
        AND ECE:CE ratio &gt;= 2:1 OR opposite direction
            ECE difference meets same criteria

    IPs with possible AQM activity: 71 (18.6% of ECN negotiating)
    |- from known AQMs:             38 (60.3% of 63 /w known AQM)
    |- from unknown, possible AQMs: 33 (10.3% of 319 w/o known AQM)

ECN flow packet counts by active IP, for nonzero CE or ECE:

    Flags column:
        A: possible AQM activity (see Criteria above)
        K: known AQM deployment

                        ECT(0)   CE   ECE    ECT(0)  CE   ECE
                        from     from from   from    from from
    IP            Flags WAN      WAN  LAN    LAN     LAN  WAN
    --            ----- ---      ---  ---    ---     ---  ---
    10.45.9.88          17970    0    0      0       0    431
    10.45.64.3    AK    2909975  36   13348  245614  0    45
    10.45.64.4    AK    228451   0    2192   60531   0    0
    10.45.64.7    AK    1119810  28   4610   15970   0    35
    10.45.64.11   AK    158206   0    335    52721   0    0
    10.45.64.12   AK    466173   0    14955  28006   3    0
    10.45.64.13   AK    287196   0    223    17277   0    0
    10.45.64.14   AK    2264292  13   20863  362708  0    23
    10.45.64.15   AK    46467    0    9      33894   0    0
    10.45.64.16   AK    12238    0    1396   3339    0    0
    10.45.64.17   AK    1058702  0    464    10578   0    0
    10.45.64.31   AK    1137817  0    46740  114016  12   0
    10.45.64.39   AK    519279   0    11019  44094   0    0
    10.45.64.45   AK    229911   0    363    297811  0    0
    10.45.64.47   AK    1257622  0    15731  410234  321  6041
    10.45.64.59   AK    186455   0    44     71189   0    0
    10.45.64.85   AK    4958     0    57     1069    0    0
    10.45.64.93   AK    604641   0    16530  89847   0    0
    10.45.64.103  AK    660575   0    10649  129808  0    0
    10.45.64.105  AK    407561   0    2046   28347   0    0
    10.45.64.112  AK    2007755  0    1135   58168   1    1
    10.45.64.116  AK    427696   0    1042   30081   0    0
    10.45.64.118  AK    275449   163  710    94141   0    170
    10.45.64.123  AK    461008   0    3118   29852   0    0
    10.45.64.125  AK    540511   0    52960  57523   49   0
    10.45.64.126  AK    686366   0    12579  57480   122  0
    10.45.65.7    A     959608   0    176    94920   0    0
    10.45.65.16   A     1392760  0    4483   157057  0    0
    10.45.65.110  A     694373   0    1530   44914   0    0
    10.45.65.112  A     1140897  0    2313   171205  0    0
    10.45.65.124  A     73846    5    6      24228   0    9
    10.45.86.39   A     823913   1    13     135427  0    0
    10.45.86.41   A     6872888  72   3228   1116750 0    0
    10.45.87.32   A     62967    0    64     33255   0    0
    10.45.87.45         2052604  1    0      225774  0    0
    10.45.87.50         2500669  3    3      134178  0    0
    10.45.87.127  A     527732   17   22     58020   0    39
    10.45.101.96        1883157  155  156    270789  0    151
    10.45.104.24  A     1837837  55   63     416284  0    77
    10.45.107.73  A     1851297  400  416    463753  0    430
    10.45.108.24  A     230952   0    0      33749   0    36
    10.45.113.6         10491356 168  191    253856  0    174
    10.45.113.106 A     638565   34   37     173265  0    40
    10.45.114.98        1370882  1619 1792   309940  0    1739
    10.45.138.66        479880   43   56     95577   0    47
    10.45.140.73        6036     510  551    1918    0    520
    10.45.140.74        5396418  39   46     336854  0    38
    10.45.141.85  A     450018   39   50     157585  0    85
    10.45.145.2   A     118843   10   15     19309   0    25
    10.45.145.73        3484464  1    0      153147  0    0
    10.45.153.10        714256   6    11     80712   0    0
    10.45.154.82  A     2355299  22   25     263636  0    44
    10.45.155.68        1849086  1    1      349722  0    0
    10.45.155.71  A     9089268  144  143    660457  1    152
    10.45.158.197       17618743 493  53     369921  0    0
    10.45.158.198 A     1019414  13   13     222440  0    25
    10.45.176.114 A     736022   32   46     88713   0    62
    10.45.176.119 A     2393601  38   47     167329  0    68
    10.45.177.68  A     17191899 22   24     201187  0    27
    10.45.182.75  A     615134   6    7      100995  0    13
    10.45.183.117       199726   131  145    52876   6    152
    10.45.183.204       2729641  8    10     851838  0    0
    10.45.212.82  A     2497321  18   23     213484  0    48
    10.45.229.81  A     1043941  268  2104   36517   1    0
    10.45.230.25  A     4560825  3132 18481  290819  0    0
    10.45.230.204       28514121 1    1      321299  0    0
    10.45.231.31  A     62246    16   9      12782   0    30
    10.45.234.197       265034   188  225    98664   0    153
    10.45.235.6   AK    140242   0    217    42778   0    0
    10.45.235.24  AK    213822   0    388    50485   0    0
    10.45.235.59  AK    1017759  16   897    121453  0    30
    10.45.235.89  AK    8066090  56   31899  637830  176  5630
    10.45.235.90  AK    3878916  727  4278   460048  0    709
    10.45.235.92  AK    15410232 151  169965 1030037 41   1784
    10.45.235.94  AK    344002   0    1394   3913608 0    0
    10.45.235.196 AK    2234     0    157    1323    0    0
    10.45.235.199 AK    2166     0    56     676     0    0
    10.45.235.200 AK    5279     0    220    2311    0    0
    10.45.235.203 AK    2966     0    234    1765    0    0
    10.45.235.206 AK    154701   0    3484   333     0    0
    10.45.235.208 AK    5076     0    378    3240    0    0
    10.45.238.75        4916805  196  262    942367  0    229
    10.45.241.101 A     2838055  0    740    303980  0    0
    10.45.242.72  A     81526    5    5      36884   0    11
    10.45.242.146 A     894737   21   25     85268   0    44
    10.45.243.69        1946622  2    3      64838   0    0
    10.45.249.6   A     621444   0    2461   75061   0    0
    10.45.249.34  A     180747   0    2260   128409  0    0
    10.45.251.37  A     455964   39   171    18996   0    0
    10.45.251.114 A     14208298 134  13794  946610  0    0
</pre><a href="#section-5.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="non-tcp-conntrack-supported-protocols-initiated-from-lan-to-wan">
<section id="section-5.3">
        <h3 id="name-non-tcp-conntrack-supported">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-non-tcp-conntrack-supported" class="section-name selfRef">Non-TCP conntrack-supported protocols initiated from LAN to WAN</a>
        </h3>
<div class="artwork art-text alignLeft" id="section-5.3-1">
<pre>Protocols included:

    UDP, ICMP, DCCP, SCTP, GRE

Active IPs:

    Active IPs with ECN signals:              420
    Active IP/dstport pairs with ECN signals: 24972

ECN flow packet count totals for active IPs:

    Direction CE      ECT(0)  ECT(1)
    --------- --      ------  ------
    From LAN  59      26692   28
    From WAN  2838929 9562002 6632561

ECN codepoint packet counts by client IP, with selected ports:
    (ports with '*' had &gt;100 ECT(0) marks)

                           ECT(0)  CE      ECT(1)  ECT(0) CE   ECT(1)
                           from    from    from    from   from from
    IP/Port                WAN     WAN     WAN     LAN    LAN  LAN
    -------                ---     ---     ---     ---    ---  ---
    10.45.10.0             0       0       0       201    0    0
    10.45.10.4             0       0       0       14     0    0
    10.45.10.5             0       0       0       20     0    0
    10.45.10.6             0       0       0       9      0    0
    10.45.10.7             0       0       0       8      0    0
    10.45.10.8             0       0       0       39     0    0
    10.45.10.11            0       0       0       8      0    0
    10.45.10.12            0       0       0       2      0    0
    10.45.10.42            0       0       0       6      0    0
    10.45.10.61            0       0       0       2      0    0
    10.45.10.70            0       0       0       44     0    0
    10.45.10.71            0       0       0       5      0    0
    10.45.10.73            0       0       0       7      0    0
    10.45.10.77            0       0       0       13     0    0
    10.45.10.81            0       0       0       10     0    0
    10.45.10.82            0       0       0       8      0    0
    10.45.10.83            0       0       0       3      0    0
    10.45.10.95            0       0       0       59     0    0
    10.45.10.96            0       0       0       39     0    0
    10.45.10.129           0       403     1       0      0    0
    10.45.10.196           0       0       0       80     0    0
    10.45.10.197           0       0       0       63     0    0
    10.45.10.201           0       0       0       3      0    0
    10.45.10.204           0       0       0       25     0    0
    10.45.10.227           0       0       0       40     0    0
    10.45.10.228           0       0       0       7      0    0
    10.45.10.244           0       0       0       14     0    0
    10.45.10.245           0       0       0       7      0    0
    10.45.64.3             0       0       0       100    0    0
    10.45.64.4             0       0       0       31     0    0
    10.45.64.6             0       0       0       2      0    0
    10.45.64.7             12      126     20      8      0    0
    10.45.64.10            0       0       0       29     0    0
    10.45.64.11            0       0       0       67     0    0
    10.45.64.12            0       0       0       6      0    0
    10.45.64.13            0       0       0       35     0    0
    10.45.64.14            0       0       0       121    0    0
    10.45.64.15            0       0       0       52     0    0
    10.45.64.16            0       0       0       18     0    0
    10.45.64.19            16      0       0       0      0    0
      udp:4500 (ipsec-na.. 11      0       0       0      0    0
    10.45.64.31            34129   2468    58304   27     0    0
      udp:37658            0       0       4346    0      0    0
    * udp:38129            24957   2468    15281   0      0    0
      udp:38884            0       0       10409   0      0    0
    * udp:40871            288     0       2269    0      0    0
    * udp:41621            3057    0       14609   0      0    0
    * udp:41744            171     0       61      0      0    0
      udp:43588            0       0       6746    0      0    0
      udp:45444            0       0       1292    0      0    0
    * udp:45465            866     0       0       0      0    0
      udp:45483            0       0       1838    0      0    0
    * udp:45522            4764    0       708     0      0    0
    10.45.64.39            0       0       0       75     0    0
    10.45.64.45            0       0       0       50     0    0
    10.45.64.47            0       0       0       11     0    0
    10.45.64.51            0       0       0       2      0    0
    10.45.64.59            56      1624    10      593    0    0
      udp:3478 (stun)      56      1624    10      0      0    0
    10.45.64.85            0       0       0       4      0    0
    10.45.64.86            7       434404  3       9      0    0
      udp:4400 (ds-srv)    0       29065   0       0      0    0
      udp:14757            0       97175   0       0      0    0
      udp:24173            0       35437   0       0      0    0
      udp:29493            0       120959  0       0      0    0
      udp:44495            0       41547   0       0      0    0
      udp:53678            0       109978  0       0      0    0
    10.45.64.89            7       50      0       4      0    0
    10.45.64.93            598     2971    341     75     0    0
    * udp:3478 (stun)      598     2971    341     0      0    0
    10.45.64.98            0       0       32780   0      0    0
      udp:6008             0       0       9234    0      0    0
      udp:7008 (afs3-upd.. 0       0       23546   0      0    0
    10.45.64.99            132     2094    73      0      0    0
      udp:3478 (stun)      0       3       0       0      0    0
    10.45.64.103           0       0       0       47     0    0
    10.45.64.104           70      293     31      1      0    0
    10.45.64.105           213     33440   0       7      0    0
    * udp:443 (https)      213     33440   0       0      0    0
    10.45.64.107           0       0       0       2      0    0
    10.45.64.108           0       0       0       1      0    0
    10.45.64.111           1       1       0       0      0    0
    10.45.64.112           0       421     0       48     0    0
    10.45.64.116           4       143     8       64     0    8
    10.45.64.118           0       0       0       77     0    0
    10.45.64.121           0       2107    0       0      0    0
      udp:38603            0       2100    0       0      0    0
    10.45.64.123           0       0       0       13     0    0
    10.45.64.124           6       0       0       0      0    0
      udp:443 (https)      6       0       0       0      0    0
    10.45.64.125           0       0       0       22     0    0
    10.45.64.126           1       10      0       37     0    0
    10.45.65.0             0       0       0       42     0    0
    10.45.65.1             0       0       0       45     0    0
    10.45.65.5             0       0       0       17     0    0
    10.45.65.7             0       0       0       30     0    0
    10.45.65.11            0       0       0       6      0    0
    10.45.65.16            1686    40141   36888   505    0    0
    * udp:3478 (stun)      1595    22049   4       0      0    0
      udp:26808            0       0       36805   0      0    0
      udp:62348            0       15738   0       0      0    0
    10.45.65.17            0       4       0       0      0    0
    10.45.65.66            0       17      0       94     0    0
      udp:3478 (stun)      0       17      0       0      0    0
    10.45.65.94            319     0       1       25     0    0
      udp:3478 (stun)      0       0       1       0      0    0
    10.45.65.95            0       0       0       8      0    0
    10.45.65.104           0       0       0       41     0    0
    10.45.65.107           12      77      2       5      0    0
    10.45.65.110           0       0       0       38     0    0
    10.45.65.112           39      1168    18      75     0    0
    10.45.65.122           2       5       0       0      0    0
    10.45.65.123           0       0       0       1      0    0
    10.45.65.124           0       0       0       11     0    0
    10.45.65.127           0       0       0       5      0    0
    10.45.75.90            0       0       0       1      0    0
    10.45.80.28            2       8       1       0      0    0
    10.45.80.79            4       7       0       2      0    0
    10.45.80.85            0       0       0       10     0    0
    10.45.80.99            0       0       0       11     0    0
    10.45.83.76            0       0       0       3      0    0
    10.45.83.80            28      51      11      0      0    0
    10.45.85.127           301     174     30747   68     0    0
    * udp:599 (acp)        222     174     45      0      0    0
      udp:6008             0       0       30702   0      0    0
    * udp:60001            49      0       0       65     0    0
    10.45.86.16            13      0       0       2      0    0
      udp:4500 (ipsec-na.. 8       0       0       0      0    0
      udp:51820 (wiregua.. 5       0       0       0      0    0
    10.45.86.36            0       0       0       4      0    0
    10.45.86.39            205     37619   107     50     0    0
      udp:29492            0       2512    0       0      0    0
      udp:64733            0       30711   0       0      0    0
    10.45.86.40            2       0       0       0      0    0
      udp:443 (https)      2       0       0       0      0    0
    10.45.86.43            0       11      0       532    0    0
    10.45.86.68            760     3528    614     325    0    0
      udp:80 (http)        0       2       0       0      0    0
    10.45.87.32            12      0       0       14     0    0
    10.45.87.44            709     4963    623     0      0    0
      udp:80 (http)        0       1       0       0      0    0
      udp:6881             3       1313    43      0      0    0
    10.45.87.45            0       0       0       185    0    0
    10.45.87.48            0       0       0       82     0    0
    10.45.87.50            3       0       9       68     0    0
      udp:4500 (ipsec-na.. 3       0       9       0      0    0
    10.45.87.103           0       0       0       2      0    0
    10.45.87.112           0       1       0       0      0    0
    10.45.87.113           0       0       0       33     0    0
    10.45.87.127           0       0       0       44     0    0
    10.45.92.74            31      0       1       2      0    0
    10.45.93.69            15      122     6       0      0    0
    10.45.93.75            361     2945    278     4      0    0
    10.45.93.79            0       0       0       8      0    0
    10.45.98.71            2       8       0       0      0    0
    10.45.98.72            0       1       0       40     0    0
      udp:3478 (stun)      0       1       0       0      0    0
    10.45.101.96           0       0       0       140    0    0
    10.45.101.100          0       0       0       12     0    0
    10.45.101.101          2       10      7       0      0    0
    10.45.101.103          21      21899   15      0      0    0
      udp:58479            0       21372   0       0      0    0
    10.45.101.104          0       0       10      33     0    0
    10.45.104.24           0       0       0       324    0    0
    10.45.104.104          16      72      2       60     0    0
    10.45.107.73           32      0       1       58     0    0
      udp:4500 (ipsec-na.. 32      0       1       0      0    0
    10.45.107.79           34      0       0       70     0    0
      udp:443 (https)      34      0       0       0      0    0
    10.45.107.81           0       4421    0       3      0    0
      udp:61094            0       4421    0       0      0    0
    10.45.108.3            0       0       0       1      0    0
    10.45.108.4            33      5079    90      1      0    0
      udp:33027            0       2978    0       0      0    0
    10.45.108.13           0       0       0       14     0    0
    10.45.108.24           799     5543    1059    117    0    0
    * udp:40211            107     0       0       0      0    0
    10.45.108.25           1       2       1       799    0    0
    10.45.108.66           0       0       0       0      0    1
    10.45.108.69           0       0       0       2      0    0
    10.45.108.71           28      12830   0       0      0    0
      udp:34665            0       12462   0       0      0    0
    10.45.108.75           0       0       6395176 38     0    0
      udp:6008             0       0       1755476 0      0    0
      udp:7008 (afs3-upd.. 0       0       1827173 0      0    0
      udp:8008 (http-alt)  0       0       740987  0      0    0
      udp:9008             0       0       809024  0      0    0
      udp:10008 (octopus)  0       0       380001  0      0    0
      udp:11008            0       0       578400  0      0    0
      udp:12008 (accurac.. 0       0       231619  0      0    0
      udp:13008            0       0       72496   0      0    0
    10.45.108.76           0       0       0       2      0    0
    10.45.108.77           0       0       0       31     0    0
    10.45.108.80           337     1566    173     10     0    0
    10.45.108.95           1       5       0       283    0    0
    10.45.108.126          0       0       0       12     0    0
    10.45.112.74           9       95      4       371    0    0
    10.45.112.102          0       0       0       29     0    0
    10.45.112.139          0       0       0       5      0    0
    10.45.112.154          0       0       0       4      0    0
    10.45.112.165          0       0       0       24     0    0
    10.45.112.172          6333    0       0       0      0    0
    * udp:443 (https)      6333    0       0       0      0    0
    10.45.112.216          0       0       0       2      0    0
    10.45.113.6            147184  0       0       136    0    0
    * udp:4500 (ipsec-na.. 147184  0       0       0      0    0
    10.45.113.7            453     0       10      52     0    0
    * udp:443 (https)      309     0       0       0      0    0
    * udp:4500 (ipsec-na.. 144     0       10      0      0    0
    10.45.113.9            0       0       0       60     0    0
    10.45.113.11           0       0       0       187    0    0
    10.45.113.27           0       0       0       1      0    0
    10.45.113.30           0       0       0       4      0    0
    10.45.113.33           0       0       0       2      0    0
    10.45.113.34           0       0       0       58     0    0
    10.45.113.35           0       0       0       6      0    0
    10.45.113.36           0       0       0       2      0    0
    10.45.113.66           1       11      0       0      0    0
    10.45.113.90           0       0       0       163    0    0
    10.45.113.94           17      62      2       0      0    0
    10.45.113.97           0       0       0       19     0    0
    10.45.113.99           11      76      12      15     0    0
    10.45.113.104          818     0       0       0      0    0
    * udp:4500 (ipsec-na.. 818     0       0       0      0    0
    10.45.113.106          0       0       0       10     0    0
    10.45.113.119          0       178     0       313    0    0
      udp:3478 (stun)      0       178     0       0      0    0
    10.45.113.122          36      0       0       0      0    0
      udp:4500 (ipsec-na.. 36      0       0       0      0    0
    10.45.113.124          0       0       0       201    0    0
    10.45.114.8            0       3       0       0      0    0
    10.45.114.10           0       0       0       3      0    0
    10.45.114.42           286     12      67      3      0    0
    * udp:51820 (wiregua.. 286     0       66      0      0    0
    10.45.114.98           0       0       0       10     0    0
    10.45.120.25           0       0       0       53     0    0
    10.45.120.34           0       0       0       12     0    0
    10.45.120.78           0       0       0       715    0    0
    10.45.122.51           686     28190   122     66     0    0
      udp:45622            0       5782    0       0      0    0
      udp:59437            0       17791   0       0      0    0
    10.45.124.31           1720    5946    16897   105    0    0
      udp:3478 (stun)      0       6       0       0      0    0
    * udp:50451            1720    0       15875   0      0    0
      udp:50919            0       2428    0       0      0    0
      udp:50996            0       0       1016    0      0    0
      udp:57403            0       1944    0       0      0    0
    10.45.124.43           0       0       0       12     0    0
    10.45.124.73           37      0       0       0      0    0
      udp:4500 (ipsec-na.. 37      0       0       0      0    0
    10.45.124.74           0       0       0       1      0    0
    10.45.124.89           0       0       0       2      0    0
    10.45.124.107          142     626895  83      0      0    0
      udp:24616            0       501142  0       0      0    0
      udp:51123            0       124060  0       0      0    0
    10.45.124.111          0       1538    166     0      0    0
      udp:4748             0       1491    166     0      0    0
    10.45.124.117          0       0       0       248    0    0
    10.45.125.97           0       0       0       2      0    0
    10.45.125.99           130     6235    29      1      0    0
      udp:8609 (canon-cp.. 0       3002    0       0      0    0
    10.45.125.104          0       0       0       3      0    0
    10.45.125.105          0       0       0       7      0    0
    10.45.136.82           0       0       0       1      0    0
    10.45.136.198          0       0       0       8      0    0
    10.45.136.199          68      3210    7       0      0    0
      udp:22312            0       2452    0       0      0    0
    10.45.136.200          0       44      1       0      0    0
    10.45.137.4            4603    0       0       1882   0    0
    * udp:443 (https)      4603    0       0       1882   0    0
    10.45.137.21           0       0       0       118    0    0
    10.45.137.27           4       0       0       63     0    0
    10.45.137.29           0       0       0       0      0    1
    10.45.137.46           9       154     0       6      0    0
      udp:443 (https)      9       0       0       0      0    0
    10.45.137.53           0       0       0       7      0    0
    10.45.137.55           0       0       1       37     0    0
    10.45.137.62           5       29      1       14     0    0
      udp:443 (https)      2       0       0       0      0    0
    10.45.137.119          16      203825  12      4      0    0
      udp:16772            0       55846   0       0      0    0
      udp:25135            0       24694   0       0      0    0
      udp:25476            0       66965   0       0      0    0
      udp:51123            0       54265   0       0      0    0
      udp:55430            0       1138    0       0      0    0
    10.45.137.123          2       4190    1       1      0    0
      udp:29363            0       3283    0       0      0    0
    10.45.138.52           3093    18938   0       0      0    0
    * udp:42420            3087    18871   0       0      0    0
    10.45.138.66           0       0       0       249    0    0
    10.45.138.88           43      107     10      0      0    0
    10.45.138.95           0       0       0       20     0    0
    10.45.140.0            0       0       0       84     0    0
    10.45.140.5            0       0       0       2      0    0
    10.45.140.28           0       0       0       1      0    0
    10.45.140.74           0       0       0       12     0    0
    10.45.140.81           0       0       0       26     0    0
    10.45.140.100          143     465     37      0      0    0
    10.45.140.103          0       0       0       16     0    0
    10.45.140.104          0       0       0       4      0    0
    10.45.140.109          0       0       0       2      0    0
    10.45.140.118          0       0       0       27     0    0
    10.45.140.121          0       7032    0       17     0    0
      udp:49710            0       1160    0       0      0    0
      udp:53984            0       2694    0       0      0    0
      udp:58704            0       1597    0       0      0    0
    10.45.140.122          0       3       0       0      0    0
    10.45.140.123          0       0       4       0      0    0
    10.45.140.127          0       0       0       15     0    0
    10.45.140.133          0       0       0       0      1    0
    10.45.140.169          0       0       0       59     0    0
    10.45.140.171          0       0       0       14     0    0
    10.45.141.2            91      0       0       12     0    0
      udp:443 (https)      91      0       0       0      0    0
    10.45.141.6            0       0       0       24     0    0
    10.45.141.14           0       0       0       2      0    0
    10.45.141.17           2       37      1       17     0    0
    10.45.141.19           0       0       0       2      0    0
    10.45.141.82           579     0       0       21     0    0
    * udp:443 (https)      579     0       0       0      0    0
    10.45.141.83           0       0       0       14     0    0
    10.45.141.84           0       0       0       90     0    0
    10.45.141.85           0       0       0       518    0    0
    10.45.141.86           0       0       0       6      0    0
    10.45.141.87           0       0       0       2      0    0
    10.45.141.103          0       0       0       57     0    0
    10.45.141.106          7       190     3947    1079   0    0
      udp:3478 (stun)      0       24      12      0      0    0
    * udp:5001 (commplex.. 0       0       0       1072   0    0
      udp:40208            0       0       3932    0      0    0
    10.45.141.125          0       0       0       2      0    0
    10.45.144.20           2       6       2       1      0    0
    10.45.144.43           0       0       0       3      0    0
    10.45.144.55           0       0       0       2      0    0
    10.45.144.68           0       0       0       363    0    0
    10.45.144.73           0       0       0       14     0    0
    10.45.144.75           0       0       3       51     0    0
    10.45.144.77           51      289     35      24     0    0
    10.45.144.105          413     0       11      1      0    0
    * udp:4500 (ipsec-na.. 413     0       11      0      0    0
    10.45.144.139          1496    0       0       0      0    0
    * udp:443 (https)      1496    0       0       0      0    0
    10.45.144.197          0       0       0       102    0    0
    10.45.145.2            0       0       0       15     0    0
    10.45.145.26           0       0       0       44     0    0
    10.45.145.39           2503039 0       0       11     0    0
      udp:443 (https)      4       0       0       0      0    0
    * udp:4500 (ipsec-na.. 2503035 0       0       0      0    0
    10.45.145.56           0       0       0       3      0    0
    10.45.145.72           0       0       0       32     0    0
    10.45.145.75           3024    0       0       0      0    0
    * udp:443 (https)      3024    0       0       0      0    0
    10.45.145.81           8691    107114  8245    292    0    0
      udp:80 (http)        0       2       0       0      0    0
    * udp:6881             355     8092    672     0      0    0
      udp:19517            0       1097    0       0      0    0
      udp:22784            0       3441    0       0      0    0
    * udp:25223            110     0       0       0      0    0
    * udp:37526            139     0       0       0      0    0
    * udp:40631            191     0       0       0      0    0
      udp:40990            0       33415   0       0      0    0
      udp:51820 (wiregua.. 0       3       0       0      0    0
    10.45.145.96           0       0       0       7      0    0
    10.45.145.98           0       0       0       3      0    0
    10.45.145.107          0       9       0       0      0    0
    10.45.145.109          0       0       0       9      35   0
    10.45.145.115          0       0       0       11     0    0
    10.45.146.66           52      88      7       26     0    0
    10.45.146.195          0       0       0       2      0    0
    10.45.146.200          1471    0       0       49     0    0
    * udp:4500 (ipsec-na.. 1471    0       0       0      0    0
    10.45.146.201          0       0       0       9      0    0
    10.45.153.10           0       0       0       33     0    0
    10.45.153.194          2       86      2       0      0    0
    10.45.154.6            0       0       0       9      0    0
    10.45.154.81           0       0       0       4      0    0
    10.45.154.82           0       0       0       140    0    0
    10.45.154.100          0       0       0       14     0    0
    10.45.154.105          0       0       0       17     0    0
    10.45.154.112          0       0       0       5      0    0
    10.45.154.113          1       88      2       3      0    0
    10.45.154.115          0       0       0       224    0    0
    10.45.155.12           0       0       0       11     0    0
    10.45.155.67           0       0       0       1      0    0
    10.45.155.68           0       0       0       237    0    0
    10.45.155.69           0       0       0       1      0    0
    10.45.155.71           0       0       0       246    0    0
    10.45.155.73           0       0       0       72     0    0
    10.45.155.74           0       1       0       0      0    0
      udp:3478 (stun)      0       1       0       0      0    0
    10.45.155.75           0       4       0       0      0    0
    10.45.155.76           0       1       0       0      0    0
    10.45.155.217          0       0       0       15     0    0
    10.45.155.229          4       42      6       48     0    0
    10.45.156.94           25      152     8       0      0    0
    10.45.156.105          0       5362    0       19     0    0
      udp:58796            0       5362    0       0      0    0
    10.45.156.127          0       0       0       22     0    0
    10.45.158.115          0       0       0       402    0    0
    10.45.158.124          0       0       0       4      0    0
    10.45.158.127          0       0       0       3      0    0
    10.45.158.195          0       1630    3       25     0    0
      udp:6881             0       1610    0       0      0    0
    10.45.158.197          0       0       0       82     0    0
    10.45.158.198          0       0       0       204    0    0
    10.45.158.204          0       0       0       118    0    0
    10.45.158.206          9       32      2       0      0    0
    10.45.176.114          0       0       0       68     0    0
    10.45.176.116          188     1702    191     1      0    0
    10.45.176.117          0       0       0       35     0    0
    10.45.176.119          9320    1028270 11302   218    0    0
      udp:6881             0       91498   83      0      0    0
    * udp:6900             322     0       0       0      0    0
      udp:8999 (bctp)      0       405853  3       0      0    0
    * udp:10556            741     0       0       0      0    0
      udp:11778            0       311705  0       0      0    0
    * udp:12111            274     0       0       0      0    0
      udp:21606            0       5678    0       0      0    0
      udp:23578            0       4281    0       0      0    0
      udp:24488            0       2140    0       0      0    0
      udp:35849            0       2632    0       0      0    0
    * udp:37758            212     721     0       0      0    0
      udp:40954            0       27113   0       0      0    0
    * udp:42012            380     26      101     0      0    0
      udp:48235            0       3182    0       0      0    0
    * udp:50321            2066    14226   5982    0      0    0
    * udp:50838            389     0       0       0      0    0
      udp:50884            0       0       2743    0      0    0
      udp:51413            39      1712    0       0      0    0
      udp:54457            0       3504    0       0      0    0
      udp:56769            0       23761   0       0      0    0
      udp:59025            0       3034    0       0      0    0
    * udp:60050            3000    3961    1478    0      0    0
      udp:60062            0       13672   0       0      0    0
      udp:64329            0       75590   0       0      0    0
    10.45.176.120          0       0       0       73     21   18
    10.45.176.206          37      689     3       34     0    0
      udp:3478 (stun)      37      685     3       0      0    0
    10.45.176.207          8       143     0       5      0    0
    10.45.176.209          12      88      1       11     0    0
    10.45.176.210          10      32      4       1      0    0
    10.45.176.214          25      8900    0       18     0    0
      udp:6672 (vision-s.. 23      8900    0       0      0    0
    10.45.176.224          1       0       0       114    0    0
    10.45.176.225          120     786     137     1      0    0
    10.45.176.226          0       0       0       4      0    0
    10.45.176.237          4       0       0       0      0    0
      udp:443 (https)      4       0       0       0      0    0
    10.45.177.66           9       213     8349    0      0    0
      udp:6672 (vision-s.. 0       0       8334    0      0    0
    10.45.177.68           12      64      8       124    0    0
    10.45.177.75           0       2       0       66     0    0
    10.45.177.197          0       2       1       0      0    0
    10.45.182.75           44      71      17      25     0    0
    10.45.182.85           41      2612    5024    0      0    0
      udp:45864            0       0       4985    0      0    0
    10.45.182.136          0       0       0       8      0    0
    10.45.183.117          0       0       0       15     0    0
    10.45.183.199          45      1579    0       8      0    0
      udp:3478 (stun)      45      1578    0       0      0    0
    10.45.183.204          0       9478    0       731    0    0
    * udp:4500 (ipsec-na.. 0       0       0       237    0    0
      udp:22885            0       9404    0       0      0    0
    10.45.183.205          0       0       1       3      0    0
      udp:4500 (ipsec-na.. 0       0       1       0      0    0
    10.45.183.209          3       1       0       280    0    0
    10.45.183.219          0       0       0       61     0    0
    10.45.203.6            0       0       0       2      0    0
    10.45.212.17           10472   25127   16430   0      0    0
    * udp:62503            10452   23528   16423   0      0    0
    10.45.212.27           0       0       0       1      0    0
    10.45.212.29           0       0       0       30     0    0
    10.45.212.51           0       0       0       2      0    0
    10.45.212.82           0       1       1       28     0    0
    10.45.212.84           0       0       0       2      0    0
    10.45.212.199          0       0       0       1      0    0
    10.45.212.202          0       0       0       4      0    0
    10.45.212.205          0       0       0       299    0    0
    10.45.212.207          0       0       0       85     0    0
    10.45.229.75           3       0       0       0      0    0
      udp:443 (https)      3       0       0       0      0    0
    10.45.229.78           6694314 0       0       113    0    0
    * udp:4500 (ipsec-na.. 6694314 0       0       0      0    0
    10.45.229.79           0       0       0       27     0    0
    10.45.229.81           0       0       0       3      0    0
    10.45.229.101          0       0       0       69     0    0
    10.45.229.104          128     525     128     0      0    0
    10.45.229.119          0       0       0       20     0    0
    10.45.230.20           0       0       0       1      0    0
    10.45.230.25           10      0       72      32     0    0
      udp:4500 (ipsec-na.. 10      0       72      0      0    0
    10.45.230.89           495     3537    296     4      0    0
    10.45.230.99           7       0       5       2      0    0
      udp:4500 (ipsec-na.. 7       0       5       0      0    0
    10.45.230.204          9       57      18      110    0    0
    10.45.230.207          18      33      1       1      0    0
    10.45.230.212          0       0       0       2      0    0
    10.45.230.223          0       0       0       3      0    0
    10.45.230.224          27927   93      13      0      0    0
    * udp:50323            322     0       0       0      0    0
    * udp:50361            128     0       0       0      0    0
    * udp:52065            409     0       0       0      0    0
    * udp:55236            257     0       0       0      0    0
    * udp:57072            142     0       0       0      0    0
    * udp:58494            170     0       0       0      0    0
    * udp:59465            160     0       0       0      0    0
    * udp:59659            445     0       0       0      0    0
    * udp:60874            129     0       0       0      0    0
    * udp:60898            102     0       0       0      0    0
    * udp:61122            302     0       0       0      0    0
    * udp:61312            137     0       0       0      0    0
    * udp:61669            124     0       0       0      0    0
    * udp:62889            24738   0       0       0      0    0
    * udp:63354            122     0       0       0      0    0
    * udp:63474            107     0       0       0      0    0
    10.45.230.226          0       0       0       3      0    0
    10.45.230.228          0       45      0       0      1    0
    10.45.230.229          682     21      3       0      0    0
    * udp:4500 (ipsec-na.. 682     0       0       0      0    0
    10.45.231.16           433     0       0       24     0    0
    * udp:4500 (ipsec-na.. 433     0       0       0      0    0
    10.45.231.21           40      256     81      0      0    0
    10.45.231.31           0       0       0       32     0    0
    10.45.231.53           2       46      0       0      0    0
    10.45.231.61           4151    0       1       13     0    0
    * udp:4500 (ipsec-na.. 4151    0       1       0      0    0
    10.45.231.80           0       0       0       6      0    0
    10.45.231.99           0       0       0       40     0    0
    10.45.231.102          0       0       0       11     0    0
    10.45.231.114          0       0       0       47     0    0
    10.45.233.16           0       0       0       55     0    0
    10.45.233.39           1       13      2       1      0    0
    10.45.233.41           0       0       3       4      0    0
    10.45.233.42           0       0       0       115    0    0
    10.45.233.47           0       0       0       1      0    0
    10.45.233.55           0       0       0       3      0    0
    10.45.234.197          320     0       11      2      0    0
    * udp:4500 (ipsec-na.. 320     0       11      0      0    0
    10.45.235.6            107     454     62      6      0    0
    10.45.235.11           250     0       0       0      0    0
    * udp:443 (https)      249     0       0       0      0    0
    10.45.235.13           0       0       0       4      0    0
    10.45.235.16           24      56      3       0      0    0
    10.45.235.19           0       0       0       3      0    0
    10.45.235.24           0       2       0       33     0    0
    10.45.235.25           2310    28152   68      17     0    0
    * udp:443 (https)      2214    0       0       0      0    0
      udp:6881             0       13339   0       0      0    0
      udp:31708            0       4595    0       0      0    0
      udp:51413            0       5367    0       0      0    0
      udp:52372            0       3975    0       0      0    0
    10.45.235.49           672     3165    14      0      0    0
    * udp:443 (https)      672     79      0       0      0    0
      udp:59418            0       3078    0       0      0    0
    10.45.235.52           23      0       0       0      0    0
      udp:4500 (ipsec-na.. 23      0       0       0      0    0
    10.45.235.59           0       0       0       58     0    0
    10.45.235.66           0       0       0       4      0    0
    10.45.235.89           165     2580    23      582    0    0
    * udp:3478 (stun)      165     2580    23      0      0    0
    10.45.235.90           0       0       0       332    0    0
    10.45.235.92           0       0       0       1007   0    0
    10.45.235.93           229     3272    306     13     0    0
    10.45.235.94           0       0       0       10     0    0
    10.45.238.75           0       0       0       1744   0    0
    10.45.238.104          0       2576    0       7      0    0
      udp:443 (https)      0       2576    0       0      0    0
    10.45.239.66           40      0       5       0      0    0
      udp:4500 (ipsec-na.. 40      0       5       0      0    0
    10.45.239.219          1       0       0       18     0    0
      udp:443 (https)      1       0       0       0      0    0
    10.45.240.86           0       0       0       5      0    0
    10.45.241.57           216     66079   437     0      0    0
      udp:4500 (ipsec-na.. 0       0       21      0      0    0
      udp:33522            0       37844   0       0      0    0
      udp:37859            0       27536   0       0      0    0
    10.45.241.94           0       0       0       44     0    0
    10.45.241.98           0       0       0       4      0    0
    10.45.241.101          68946   10      2       120    0    0
    * udp:4500 (ipsec-na.. 68942   0       0       0      0    0
    10.45.241.121          0       0       0       2      0    0
    10.45.242.72           0       0       0       4      0    0
    10.45.242.81           0       0       0       14     1    0
    10.45.242.144          0       0       0       5      0    0
    10.45.242.146          0       0       0       30     0    0
    10.45.242.161          143     134     2297    139    0    0
    * udp:4500 (ipsec-na.. 115     0       4       0      0    0
      udp:27032            0       78      2293    0      0    0
    10.45.243.13           13877   63      1       0      0    0
    * udp:20911            13853   0       0       0      0    0
    10.45.243.41           12      0       0       14     0    0
      udp:443 (https)      12      0       0       0      0    0
    10.45.243.69           0       0       0       66     0    0
    10.45.243.71           0       28      0       2      0    0
      udp:80 (http)        0       28      0       0      0    0
    10.45.243.109          0       2008    0       7      0    0
      udp:41697            0       2002    0       0      0    0
    10.45.248.33           2       8       0       10     0    0
      udp:3478 (stun)      2       8       0       0      0    0
    10.45.248.94           0       0       0       11     0    0
    10.45.248.118          0       0       0       2      0    0
    10.45.249.6            0       0       0       1502   0    0
    10.45.249.34           25      0       0       154    0    0
      udp:443 (https)      25      0       0       0      0    0
    10.45.249.99           68      558     88      0      0    0
    10.45.249.104          0       0       0       7      0    0
      udp:4500 (ipsec-na.. 0       0       0       6      0    0
    10.45.250.89           0       0       0       5      0    0
    10.45.251.37           0       0       0       19     0    0
    10.45.251.110          9       72      1       0      0    0
    10.45.251.119          0       0       0       23     0    0
    10.45.253.59           0       0       0       1      0    0
      udp:4500 (ipsec-na.. 0       0       0       1      0    0
    10.45.253.61           0       0       0       53     0    0
    10.45.253.84           121     0       0       16     0    0
    * udp:443 (https)      121     0       0       0      0    0
    10.45.253.93           0       0       0       4      0    0
    10.45.253.100          0       0       0       142    0    0
    10.45.253.121          0       0       0       2      0    0
    10.45.254.94           0       0       0       12     0    0
    10.45.255.90           1       125     0       0      0    0
    10.45.255.97           0       0       0       36     0    0

ECN codepoint packet counts for selected ports:

                           ECT(0)  CE      ECT(1)  ECT(0) CE   ECT(1)
                           from    from    from    from   from from
    Port                   WAN     WAN     WAN     LAN    LAN  LAN
    ----                   ---     ---     ---     ---    ---  ---
    icmp:port-unreachable  6632    40795   3539    404    0    0
    icmp:host-unreachable  1171    2575    43      22990  0    0
    icmp:ttl-zero-during.. 65      2       66      0      0    0
    icmp:network-unreach.. 321     4       0       0      0    0
    ipencap:0              0       0       0       1      0    0
    udp:53 (domain)        0       403     1       0      0    0
    udp:80 (http)          0       33      0       0      0    0
    udp:443 (https)        20006   36095   0       1882   0    0
    udp:599 (acp)          238     261     59      0      0    0
    udp:1024-3457 [81]     100     618     9       34     59   28
    udp:3478 (stun)        2498    31725   394     0      0    0
    udp:3553-4492 [19]     1       29449   0       0      0    0
    udp:4500 (ipsec-nat-t) 9422229 0       151     244    0    0
    udp:4548-51819 [8177]  62692   2291117 6604184 1072   0    0
    udp:51820 (wireguard)  291     3       66      0      0    0
    udp:51821-65535 [9371] 45758   405849  24049   65     0    0
</pre><a href="#section-5.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-6">
      <h2 id="name-iana-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-6-1">This document has no IANA actions.<a href="#section-6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-considerations">
<section id="section-7">
      <h2 id="name-security-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-7-1">There are no known security considerations introduced by this note.<a href="#section-7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="affiliation">
<section id="section-8">
      <h2 id="name-affiliation">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-affiliation" class="section-name selfRef">Affiliation</a>
      </h2>
<p id="section-8-1">The author wrote the script used to deploy fq_codel to the two backhaul subnets
mentioned in <a href="#rfc3168-aqm-activity" class="xref">Section 3.2</a>.<a href="#section-8-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="acknowledgements">
<section id="section-9">
      <h2 id="name-acknowledgements">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="section-9-1">Thanks go to:<a href="#section-9-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9-2.1">Adam Pribyl, for gathering data at the FreeNet gateway<a href="#section-9-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-9-2.2">Jonathan Morton and Rodney Grimes, for helping to analyze the results<a href="#section-9-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-9-2.3">FreeNet Liberec, for allowing access for data collection<a href="#section-9-2.3" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<section id="section-10">
      <h2 id="name-informative-references">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
      </h2>
<dl class="references">
<dt id="IPTABLES-ECN">[IPTABLES-ECN]</dt>
      <dd>
<span class="refAuthor">Heist, P.G.</span>, <span class="refTitle">"iptables-ecn GitHub Repository"</span>, <span>&lt;<a href="https://github.com/heistp/iptables-ecn/">https://github.com/heistp/iptables-ecn/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1349">[RFC1349]</dt>
      <dd>
<span class="refAuthor">Almquist, P.</span>, <span class="refTitle">"Type of Service in the Internet Protocol Suite"</span>, <span class="seriesInfo">RFC 1349</span>, <span class="seriesInfo">DOI 10.17487/RFC1349</span>, <time datetime="1992-07" class="refDate">July 1992</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1349">https://www.rfc-editor.org/info/rfc1349</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2481">[RFC2481]</dt>
      <dd>
<span class="refAuthor">Ramakrishnan, K.</span><span class="refAuthor"> and S. Floyd</span>, <span class="refTitle">"A Proposal to add Explicit Congestion Notification (ECN) to IP"</span>, <span class="seriesInfo">RFC 2481</span>, <span class="seriesInfo">DOI 10.17487/RFC2481</span>, <time datetime="1999-01" class="refDate">January 1999</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2481">https://www.rfc-editor.org/info/rfc2481</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3168">[RFC3168]</dt>
      <dd>
<span class="refAuthor">Ramakrishnan, K.</span><span class="refAuthor">, Floyd, S.</span><span class="refAuthor">, and D. Black</span>, <span class="refTitle">"The Addition of Explicit Congestion Notification (ECN) to IP"</span>, <span class="seriesInfo">RFC 3168</span>, <span class="seriesInfo">DOI 10.17487/RFC3168</span>, <time datetime="2001-09" class="refDate">September 2001</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3168">https://www.rfc-editor.org/info/rfc3168</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3540">[RFC3540]</dt>
      <dd>
<span class="refAuthor">Spring, N.</span><span class="refAuthor">, Wetherall, D.</span><span class="refAuthor">, and D. Ely</span>, <span class="refTitle">"Robust Explicit Congestion Notification (ECN) Signaling with Nonces"</span>, <span class="seriesInfo">RFC 3540</span>, <span class="seriesInfo">DOI 10.17487/RFC3540</span>, <time datetime="2003-06" class="refDate">June 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3540">https://www.rfc-editor.org/info/rfc3540</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3948">[RFC3948]</dt>
      <dd>
<span class="refAuthor">Huttunen, A.</span><span class="refAuthor">, Swander, B.</span><span class="refAuthor">, Volpe, V.</span><span class="refAuthor">, DiBurro, L.</span><span class="refAuthor">, and M. Stenberg</span>, <span class="refTitle">"UDP Encapsulation of IPsec ESP Packets"</span>, <span class="seriesInfo">RFC 3948</span>, <span class="seriesInfo">DOI 10.17487/RFC3948</span>, <time datetime="2005-01" class="refDate">January 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3948">https://www.rfc-editor.org/info/rfc3948</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6040">[RFC6040]</dt>
      <dd>
<span class="refAuthor">Briscoe, B.</span>, <span class="refTitle">"Tunnelling of Explicit Congestion Notification"</span>, <span class="seriesInfo">RFC 6040</span>, <span class="seriesInfo">DOI 10.17487/RFC6040</span>, <time datetime="2010-11" class="refDate">November 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6040">https://www.rfc-editor.org/info/rfc6040</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8290">[RFC8290]</dt>
      <dd>
<span class="refAuthor">Hoeiland-Joergensen, T.</span><span class="refAuthor">, McKenney, P.</span><span class="refAuthor">, Taht, D.</span><span class="refAuthor">, Gettys, J.</span><span class="refAuthor">, and E. Dumazet</span>, <span class="refTitle">"The Flow Queue CoDel Packet Scheduler and Active Queue Management Algorithm"</span>, <span class="seriesInfo">RFC 8290</span>, <span class="seriesInfo">DOI 10.17487/RFC8290</span>, <time datetime="2018-01" class="refDate">January 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8290">https://www.rfc-editor.org/info/rfc8290</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8311">[RFC8311]</dt>
      <dd>
<span class="refAuthor">Black, D.</span>, <span class="refTitle">"Relaxing Restrictions on Explicit Congestion Notification (ECN) Experimentation"</span>, <span class="seriesInfo">RFC 8311</span>, <span class="seriesInfo">DOI 10.17487/RFC8311</span>, <time datetime="2018-01" class="refDate">January 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8311">https://www.rfc-editor.org/info/rfc8311</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="WIREGUARD">[WIREGUARD]</dt>
    <dd>
<span class="refTitle">"WireGuard web site"</span>, <span>&lt;<a href="https://www.wireguard.com">https://www.wireguard.com</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<div id="authors-addresses">
<section id="section-appendix.a">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Peter G. Heist</span></div>
<div dir="auto" class="left">
<span class="postal-code">463 11</span> <span class="locality">Liberec 30</span>
</div>
<div dir="auto" class="left"><span class="country-name">Czech Republic</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:pete@heistp.net" class="email">pete@heistp.net</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Jonathan Morton</span></div>
<div dir="auto" class="left"><span class="street-address">Kokkonranta 21</span></div>
<div dir="auto" class="left">FI-<span class="postal-code">31520</span> <span class="locality">Pitkajarvi</span>
</div>
<div dir="auto" class="left"><span class="country-name">Finland</span></div>
<div class="tel">
<span>Phone:</span>
<a href="tel:+358%2044%20927%202377" class="tel">+358 44 927 2377</a>
</div>
<div class="email">
<span>Email:</span>
<a href="mailto:chromatix99@gmail.com" class="email">chromatix99@gmail.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
