



IPPM Working Group                                        R. Gandhi, Ed.
Internet-Draft                                               C. Filsfils
Intended status: Standards Track                     Cisco Systems, Inc.
Expires: April 23, 2021                                         D. Voyer
                                                             Bell Canada
                                                                 M. Chen
                                                                  Huawei
                                                             B. Janssens
                                                                    Colt
                                                        October 20, 2020


      Simple TWAMP (STAMP) Extensions for Segment Routing Networks
                    draft-gandhi-ippm-stamp-srpm-00

Abstract

   Segment Routing (SR) leverages the source routing paradigm.  SR is
   applicable to both Multiprotocol Label Switching (SR-MPLS) and IPv6
   (SRv6) data planes.  This document specifies RFC 8762 (Simple Two-Way
   Active Measurement Protocol (STAMP)) extensions for Delay and Loss
   Measurement in Segment Routing networks, for both SR-MPLS and SRv6
   data planes.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on April 23, 2021.

Copyright Notice

   Copyright (c) 2020 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents



Gandhi, et al.           Expires April 23, 2021                 [Page 1]

Internet-Draft    STAMP Extensions for Segment Routing      October 2020


   (https://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
   2.  Conventions Used in This Document . . . . . . . . . . . . . .   3
     2.1.  Requirements Language . . . . . . . . . . . . . . . . . .   3
     2.2.  Abbreviations . . . . . . . . . . . . . . . . . . . . . .   3
     2.3.  Reference Topology  . . . . . . . . . . . . . . . . . . .   4
   3.  Probe Query Message . . . . . . . . . . . . . . . . . . . . .   4
     3.1.  Control Code Field Extension for STAMP Messages . . . . .   4
     3.2.  Loss Measurement Query Message Extensions . . . . . . . .   5
   4.  Probe Response Message  . . . . . . . . . . . . . . . . . . .   8
     4.1.  Loss Measurement Response Message Extensions  . . . . . .   8
   5.  Node Address TLV Extensions . . . . . . . . . . . . . . . . .  10
   6.  Return Path TLV Extensions  . . . . . . . . . . . . . . . . .  10
   7.  Security Considerations . . . . . . . . . . . . . . . . . . .  12
   8.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .  12
   9.  References  . . . . . . . . . . . . . . . . . . . . . . . . .  14
     9.1.  Normative References  . . . . . . . . . . . . . . . . . .  14
     9.2.  Informative References  . . . . . . . . . . . . . . . . .  14
   Acknowledgments . . . . . . . . . . . . . . . . . . . . . . . . .  15
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  15

1.  Introduction

   Segment Routing (SR) leverages the source routing paradigm and
   greatly simplifies network operations for Software Defined Networks
   (SDNs).  SR is applicable to both Multiprotocol Label Switching (SR-
   MPLS) and IPv6 (SRv6) data planes.  Built-in SR Performance
   Measurement (PM) is one of the essential requirements to provide
   Service Level Agreements (SLAs).

   The Simple Two-way Active Measurement Protocol (STAMP) provides
   capabilities for the measurement of various performance metrics in IP
   networks using probe messages [RFC8762].  It eliminates the need for
   control-channel signaling by using configuration data model to
   provision a test-channel (e.g.  UDP paths).
   [I-D.ietf-ippm-stamp-option-tlv] defines TLV extensions for STAMP
   messages.





Gandhi, et al.           Expires April 23, 2021                 [Page 2]

Internet-Draft    STAMP Extensions for Segment Routing      October 2020


   The STAMP message with a TLV for "direct measurement" can be used for
   combined Delay + Loss measurement [I-D.ietf-ippm-stamp-option-tlv].
   However, in order to use only for loss measurement purpose, it
   requires the node to support the delay measurement messages and
   support timestamp for these messages (which may also require clock
   synchronization).  Furthermore, for hardware-based counter collection
   for direct-mode loss measurement, the optional TLV based processing
   adds unnecessary overhead (as counters are not at well-known
   locations).

   This document specifies RFC 8762 (Simple Two-Way Active Measurement
   Protocol (STAMP)) extensions for Delay and Loss Measurement in
   Segment Routing networks, for both SR-MPLS and SRv6 data planes.

2.  Conventions Used in This Document

2.1.  Requirements Language

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [RFC2119] [RFC8174]
   when, and only when, they appear in all capitals, as shown here.

2.2.  Abbreviations

   BSID: Binding Segment ID.

   DM: Delay Measurement.

   HMAC: Hashed Message Authentication Code.

   LM: Loss Measurement.

   MPLS: Multiprotocol Label Switching.

   NTP: Network Time Protocol.

   OWAMP: One-Way Active Measurement Protocol.

   PM: Performance Measurement.

   PTP: Precision Time Protocol.

   SID: Segment ID.

   SL: Segment List.

   SR: Segment Routing.



Gandhi, et al.           Expires April 23, 2021                 [Page 3]

Internet-Draft    STAMP Extensions for Segment Routing      October 2020


   SRH: Segment Routing Header.

   SR-MPLS: Segment Routing with MPLS data plane.

   SRv6: Segment Routing with IPv6 data plane.

   SSID: STAMP Session Identifier.

   STAMP: Simple Two-way Active Measurement Protocol.

2.3.  Reference Topology

   In the reference topology shown below, the sender node R1 initiates a
   performance measurement probe query message and the reflector node R5
   sends a probe response message for the query message received.  The
   probe response message is typically sent to the sender node R1.

                          t1                t2
                         /                   \
                +-------+       Query         +-------+
                |       | - - - - - - - - - ->|       |
                |   R1  |=====================|   R5  |
                |       |<- - - - - - - - - - |       |
                +-------+       Response      +-------+
                         \                   /
                          t4                t3
                 Sender                        Reflector

                         Reference Topology

3.  Probe Query Message

3.1.  Control Code Field Extension for STAMP Messages

   In this document, the Control Code field is defined for delay and
   loss measurement probe query messages for STAMP protocol in
   unauthenticated and authenticated modes.  The modified delay
   measurement probe query message format is shown in Figure 1.  This
   message format is backwards compatible with the message format
   defined in STAMP [RFC8762] as its reflector MUST ignore the received
   field (previously identified as MBZ).  With this field, the reflector
   node does not require any additional state for PM (recall that in SR
   networks, the state is in the probe packet and signaling of the
   parameters is undesired).  The usage of the Control Code is not
   limited to the SR and can be used for non-SR network.






Gandhi, et al.           Expires April 23, 2021                 [Page 4]

Internet-Draft    STAMP Extensions for Segment Routing      October 2020


    .                                                               .
    .                                                               .
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                          Timestamp                            |
    |                                                               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |         Error Estimate        | SSID                          |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |         MBZ                                   |Se Control Code|
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    .                                                               .
    .                                                               .

             Figure 1: Sender Control Code in STAMP DM Message

   Sender Control Code: Set as follows in STAMP probe query message.

   In a Query:

       0x0: Out-of-band Response Requested.  Indicates that the probe
       response is not required over the same path in the reverse
       direction.  This is also the default behavior.

       0x1: In-band Response Requested.  Indicates that this query has
       been sent over a bidirectional path and the probe response is
       required over the same path in the reverse direction.

       0x2: No Response Requested.

3.2.  Loss Measurement Query Message Extensions

   In this document, STAMP probe query messages for loss measurement are
   defined as shown in Figure 2 and Figure 3.  The message formats are
   hardware efficient due to well-known locations of the counters and
   payload small in size.  They are stand-alone and similar to the delay
   measurement message formats (e.g. location of the Counter and
   Timestamp).  They also do not require backwards compatibility and
   support for the existing DM message formats from [RFC8762] as
   different user-configured destination UDP port is used for loss
   measurement.











Gandhi, et al.           Expires April 23, 2021                 [Page 5]

Internet-Draft    STAMP Extensions for Segment Routing      October 2020


    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                        Sequence Number                        |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                        Transmit Counter                       |
    |                                                               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |X|B| Reserved  | Block Number  | SSID                          |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |         MBZ                                   |Se Control Code|
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                                                               |
    |                        MBZ (24 octets)                        |
    |                                                               |
    |                                                               |
    |                                                               |
    |                                                               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

       Figure 2: STAMP LM Probe Query Message - Unauthenticated Mode

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                        Sequence Number                        |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                        MBZ (12 octets)                        |
    |                                                               |
    |                                                               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                        Transmit Counter                       |
    |                                                               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |X|B| Reserved  | Block Number  | SSID                          |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |         MBZ                                   |Se Control Code|
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                        MBZ (64 octets)                        |
    .                                                               .
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                                                               |
    |                        HMAC (16 octets)                       |
    |                                                               |
    |                                                               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

        Figure 3: STAMP LM Probe Query Message - Authenticated Mode



Gandhi, et al.           Expires April 23, 2021                 [Page 6]

Internet-Draft    STAMP Extensions for Segment Routing      October 2020


   Sequence Number (32-bit): As defined in [RFC8762].

   Transmit Counter (64-bit): The number of packets or octets sent by
   the sender node in the query message and by the reflector node in the
   response message.  The counter is always written at the well-known
   location in the probe query and response messages.

   Receive Counter (64-bit): The number of packets or octets received at
   the reflector node.  It is written by the reflector node in the probe
   response message.

   Sender Counter (64-bit): This is the exact copy of the transmit
   counter from the received query message.  It is written by the
   reflector node in the probe response message.

   Sender Sequence Number (32-bit): As defined in [RFC8762].

   Sender TTL: As defined in [RFC8762].

   LM Flags: The meanings of the Flag bits are:

      X: Extended counter format indicator.  Indicates the use of
      extended (64-bit) counter values.  Initialized to 1 upon creation
      (and prior to transmission) of an LM query and copied from an LM
      query to an LM response message.  Set to 0 when the LM message is
      transmitted or received over an interface that writes 32-bit
      counter values.

      B: Octet (byte) count.  When set to 1, indicates that the Counter
      1-4 fields represent octet counts.  The octet count applies to all
      packets within the LM scope, and the octet count of a packet sent
      or received includes the total length of that packet (but excludes
      headers, labels, or framing of the channel itself).  When set to
      0, indicates that the Counter fields represent packet counts.

   Block Number (8-bit): The Loss Measurement using Alternate-Marking
   method defined in [RFC8321] requires to color the data traffic.  To
   be able to correlate the transmit and receive traffic counters of the
   matching color, the Block Number (or color) of the traffic counters
   is carried by the probe query and response messages for loss
   measurement.  The Block Number can also be used to aggregate
   performance metrics collected.

   HMAC: The probe message in authenticated mode includes a key Hashed
   Message Authentication Code (HMAC) [RFC2104] hash.  Each probe query
   and response messages are authenticated by adding Sequence Number
   with Hashed Message Authentication Code (HMAC) TLV.  It can use HMAC-
   SHA-256 truncated to 128 bits (similarly to the use of it in IPSec



Gandhi, et al.           Expires April 23, 2021                 [Page 7]

Internet-Draft    STAMP Extensions for Segment Routing      October 2020


   defined in [RFC4868]); hence the length of the HMAC field is 16
   octets.

   HMAC uses its own key and the mechanism to distribute the HMAC key is
   outside the scope of this document.

   In authenticated mode, only the sequence number is encrypted, and the
   other payload fields are sent in clear text.  The probe message MAY
   include Comp.MBZ (Must Be Zero) variable length field to align the
   packet on 16 octets boundary.

4.  Probe Response Message

4.1.  Loss Measurement Response Message Extensions

   In this document, STAMP probe response message formats are defined
   for loss measurement as shown in Figure 4 and Figure 5.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                        Sequence Number                        |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                        Transmit Counter                       |
    |                                                               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |X|B| Reserved  | Block Number  | SSID                          |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                        Receive Counter                        |
    |                                                               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                        Sender Sequence Number                 |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                        Sender Counter                         |
    |                                                               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |X|B| Reserved  |Sender Block Nu|   MBZ                         |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |  Sender TTL   |      MBZ                                      |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

     Figure 4: STAMP LM Probe Response Message - Unauthenticated Mode









Gandhi, et al.           Expires April 23, 2021                 [Page 8]

Internet-Draft    STAMP Extensions for Segment Routing      October 2020


    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                        Sequence Number                        |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                        MBZ (12 octets)                        |
    |                                                               |
    |                                                               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                        Transmit Counter                       |
    |                                                               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |X|B| Reserved  | Block Number  | SSID                          |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                        MBZ (4 octets)                         |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                        Receive Counter                        |
    |                                                               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                        MBZ (8 octets)                         |
    |                                                               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                        Sender Sequence Number                 |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                        MBZ (12 octets)                        |
    |                                                               |
    |                                                               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                        Sender Counter                         |
    |                                                               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |X|B| Reserved  |Sender Block Nu|   MBZ                         |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                        MBZ (4 octets)                         |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |  Sender TTL   |                                               |
    +-+-+-+-+-+-+-+-+                                               |
    |                        MBZ (15 octets)                        |
    |                                                               |
    |                                                               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                                                               |
    |                        HMAC (16 octets)                       |
    |                                                               |
    |                                                               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

      Figure 5: STAMP LM Probe Response Message - Authenticated Mode



Gandhi, et al.           Expires April 23, 2021                 [Page 9]

Internet-Draft    STAMP Extensions for Segment Routing      October 2020


5.  Node Address TLV Extensions

   In this document, Node Address TLV is defined for STAMP message
   [I-D.ietf-ippm-stamp-option-tlv] and has the following format shown
   in Figure 6:

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |STAMP TLV Flags|     Type      |         Length                |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    | Reserved                      | Address Family                |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    ~                           Address                             ~
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                     Figure 6: Node Address TLV Format

   The Address Family field indicates the type of the address, and it
   SHALL be set to one of the assigned values in the "IANA Address
   Family Numbers" registry.

   The STAMP TLV Flags are set using the procedures described in
   [I-D.ietf-ippm-stamp-option-tlv].

   The following Type is defined and it contains Node Address TLV:

   Destination Node Address (value TBA1):

   The Destination Node Address TLV is optional.  The Destination Node
   Address TLV indicates the address of the intended recipient node of
   the probe message.  The reflector node MUST NOT send response message
   if it is not the intended destination node of the probe query
   message.

6.  Return Path TLV Extensions

   For two-way performance measurement, the reflector node needs to send
   the probe response message on a specific reverse path.  The sender
   node can request in the probe query message to the reflector node to
   send a response message back on a given reverse path (e.g. co-routed
   bidirectional path).  This way the reflector node does not require
   any additional state for PM (recall that in SR networks, the state is
   in the probe packet and signaling of the parameters is undesired).

   For one-way performance measurement, the sender node address may not
   be reachable via IP route from the reflector node.  The sender node




Gandhi, et al.           Expires April 23, 2021                [Page 10]

Internet-Draft    STAMP Extensions for Segment Routing      October 2020


   in this case needs to send its reachability path information to the
   reflector node.

   [I-D.ietf-ippm-stamp-option-tlv] defines STAMP probe query messages
   that can include one or more optional TLVs.  The TLV Type (value
   TBA2) is defined in this document for Return Path that carries
   reverse path for STAMP probe response messages (in the payload of the
   message).  The format of the Return Path TLV is shown in Figure 7:

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |STAMP TLV Flags|   Type=TBA2   |         Length                |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                    Return Path Sub-TLVs                       |
    .                                                               .
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                         Figure 7: Return Path TLV

   The STAMP TLV Flags are set using the procedures described in
   [I-D.ietf-ippm-stamp-option-tlv].

   The following Type defined for the Return Path TLV contains the Node
   Address sub-TLV using the format shown above in Figure 7:

   o  Type (value 0): Return Address.  Target node address of the
      response message different than the Source Address in the query

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |STAMP TLV Flags|     Type      |         Length                |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                    Segment(1)                                 |
    .                                                               .
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    .                                                               .
    .                                                               .
    .                                                               .

    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                    Segment(n)                                 |
    .                                                               .
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

             Figure 8: Segment List Sub-TLV in Return Path TLV




Gandhi, et al.           Expires April 23, 2021                [Page 11]

Internet-Draft    STAMP Extensions for Segment Routing      October 2020


   The Segment List Sub-TLV (shown above in Figure 8) in the Return Path
   TLV can be one of the following Types:

   o  Type (value 1): SR-MPLS Label Stack of the Reverse Path

   o  Type (value 2): SR-MPLS Binding SID
      [I-D.ietf-pce-binding-label-sid] of the Reverse SR Policy

   o  Type (value 3): SRv6 Segment List of the Reverse Path

   o  Type (value 4): SRv6 Binding SID [I-D.ietf-pce-binding-label-sid]
      of the Reverse SR Policy

   The Return Path TLV is optional.  The sender node MUST only insert
   one Return Path TLV in the probe query message and the reflector node
   MUST only process the first Return Path TLV in the probe query
   message and ignore other Return Path TLVs if present.  The reflector
   node MUST send probe response message back on the reverse path
   specified in the Return Path TLV and MUST NOT add Return Path TLV in
   the probe response message.

7.  Security Considerations

   The performance measurement is intended for deployment in well-
   managed private and service provider networks.  As such, it assumes
   that a node involved in a measurement operation has previously
   verified the integrity of the path and the identity of the far-end
   reflector node.

   If desired, attacks can be mitigated by performing basic validation
   and sanity checks, at the sender, of the counter or timestamp fields
   in received measurement response messages.  The minimal state
   associated with these protocols also limits the extent of measurement
   disruption that can be caused by a corrupt or invalid message to a
   single query/response cycle.

   Use of HMAC-SHA-256 in the authenticated mode protects the data
   integrity of the probe messages.  Cryptographic measures may be
   enhanced by the correct configuration of access-control lists and
   firewalls.

8.  IANA Considerations

   IANA will create a "STAMP TLV Type" registry for
   [I-D.ietf-ippm-stamp-option-tlv].  IANA is requested to allocate a
   value for the following Destination Address TLV Type from the IETF
   Review TLV range of this registry.  This TLV is to be carried in the
   probe messages.



Gandhi, et al.           Expires April 23, 2021                [Page 12]

Internet-Draft    STAMP Extensions for Segment Routing      October 2020


   o  Type TBA1: Destination Node Address TLV

   IANA is also requested to allocate a value for the following Return
   Path TLV Type from the IETF Review TLV range of the same registry.
   This TLV is to be carried in the probe query messages.

   o  Type TBA2: Return Path TLV

   IANA is requested to create a sub-registry for "Return Path Sub-TLV
   Type".  All code points in the range 1 through 175 in this registry
   shall be allocated according to the "IETF Review" procedure as
   specified in [RFC8126].  Code points in the range 176 through 239 in
   this registry shall be allocated according to the "First Come First
   Served" procedure as specified in [RFC8126].  Remaining code points
   are allocated according to Table 1:

               +-----------+--------------+---------------+
               | Value     | Description  | Reference     |
               +-----------+--------------+---------------+
               | 0         |   Reserved   | This document |
               | 1 - 175   |  Unassigned  | This document |
               | 176 - 239 |  Unassigned  | This document |
               | 240 - 251 | Experimental | This document |
               | 252 - 254 | Private Use  | This document |
               | 255       |   Reserved   | This document |
               +-----------+--------------+---------------+

                Table 1: Return Path Sub-TLV Type Registry

   IANA is requested to allocate the values for the following Sub-TLV
   Types from this registry.

   o  Type (value 1): Return Address

   o  Type (value 2): SR-MPLS Label Stack of the Reverse Path

   o  Type (value 3): SR-MPLS Binding SID
      [I-D.ietf-pce-binding-label-sid] of the Reverse SR Policy

   o  Type (value 4): SRv6 Segment List of the Reverse Path

   o  Type (value 5): SRv6 Binding SID [I-D.ietf-pce-binding-label-sid]
      of the Reverse SR Policy








Gandhi, et al.           Expires April 23, 2021                [Page 13]

Internet-Draft    STAMP Extensions for Segment Routing      October 2020


9.  References

9.1.  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <https://www.rfc-editor.org/info/rfc2119>.

   [RFC8174]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in RFC
              2119 Key Words", BCP 14, RFC 8174, DOI 10.17487/RFC8174,
              May 2017, <https://www.rfc-editor.org/info/rfc8174>.

   [RFC8762]  Mirsky, G., Jun, G., Nydell, H., and R. Foote, "Simple
              Two-Way Active Measurement Protocol", RFC 8762,
              DOI 10.17487/RFC8762, March 2020,
              <https://www.rfc-editor.org/info/rfc8762>.

   [I-D.ietf-ippm-stamp-option-tlv]
              Mirsky, G., Min, X., Nydell, H., Foote, R., Masputra, A.,
              and E. Ruffini, "Simple Two-way Active Measurement
              Protocol Optional Extensions", draft-ietf-ippm-stamp-
              option-tlv-09 (work in progress), August 2020.

9.2.  Informative References

   [RFC2104]  Krawczyk, H., Bellare, M., and R. Canetti, "HMAC: Keyed-
              Hashing for Message Authentication", RFC 2104,
              DOI 10.17487/RFC2104, February 1997,
              <https://www.rfc-editor.org/info/rfc2104>.

   [RFC4868]  Kelly, S. and S. Frankel, "Using HMAC-SHA-256, HMAC-SHA-
              384, and HMAC-SHA-512 with IPsec", RFC 4868,
              DOI 10.17487/RFC4868, May 2007,
              <https://www.rfc-editor.org/info/rfc4868>.

   [RFC8126]  Cotton, M., Leiba, B., and T. Narten, "Guidelines for
              Writing an IANA Considerations Section in RFCs", BCP 26,
              RFC 8126, DOI 10.17487/RFC8126, June 2017,
              <https://www.rfc-editor.org/info/rfc8126>.

   [RFC8321]  Fioccola, G., Ed., Capello, A., Cociglio, M., Castaldelli,
              L., Chen, M., Zheng, L., Mirsky, G., and T. Mizrahi,
              "Alternate-Marking Method for Passive and Hybrid
              Performance Monitoring", RFC 8321, DOI 10.17487/RFC8321,
              January 2018, <https://www.rfc-editor.org/info/rfc8321>.





Gandhi, et al.           Expires April 23, 2021                [Page 14]

Internet-Draft    STAMP Extensions for Segment Routing      October 2020


   [I-D.ietf-pce-binding-label-sid]
              Filsfils, C., Sivabalan, S., Tantsura, J., Hardwick, J.,
              Previdi, S., and C. Li, "Carrying Binding Label/Segment-ID
              in PCE-based Networks.", draft-ietf-pce-binding-label-
              sid-03 (work in progress), June 2020.

Acknowledgments

   The authors would like to thank Thierry Couture for the discussions
   on the use-cases for Performance Measurement in Segment Routing.  The
   authors would also like to thank Greg Mirsky for reviewing this
   document and providing useful comments and suggestions.  The authors
   would like to acknowledge the earlier work on the loss measurement
   using TWAMP described in draft-xiao-ippm-twamp-ext-direct-loss.

Authors' Addresses

   Rakesh Gandhi (editor)
   Cisco Systems, Inc.
   Canada

   Email: rgandhi@cisco.com


   Clarence Filsfils
   Cisco Systems, Inc.

   Email: cfilsfil@cisco.com


   Daniel Voyer
   Bell Canada

   Email: daniel.voyer@bell.ca


   Mach(Guoyi) Chen
   Huawei

   Email: mach.chen@huawei.com


   Bart Janssens
   Colt

   Email: Bart.Janssens@colt.net





Gandhi, et al.           Expires April 23, 2021                [Page 15]
