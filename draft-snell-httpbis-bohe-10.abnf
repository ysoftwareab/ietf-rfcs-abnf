header-block               = count *(index-header-group  /
                                    index-range-header-group  /
                                    cloned-index-header-group /
                                    literal-header-group)

count                      = OCTET

index-header-group-type    = 00
index-range-group-type     = 01
cloned-index-group-type    = 10
literal-group-type         = 11
count                      = 5bit

index-header-prefix        = index-header-group-type
                                  unset count ; 000xxxxx
index-range-header-prefix  = index-header-group-type
                                  unset count ; 010xxxxx
cloned-index-header-prefix = cloned-index-group-type
                                  bit   count ; 10?xxxxx
literal-header-prefix      = literal-group-type
                                  bit   count ; 11?xxxxx

cache-index                = %x00-FF

index-header-group         = index-header-prefix
                                  1*32cache-index

index-range-header-group   = index-range-header-prefix
                                  1*32(cache-index cache-index)

cloned-index-header-group  = cloned-index-header-prefix
                                  1*32(cache-index value)

literal-header-group       = literal-header-prefix
                                  1*32(name value)
value                      = text-value /
                                  number-value /
                                  timestamp-value /
                                  binary-value

text-value-type            = 000 ; three bits
number-value-type          = 001
timestamp-value-type       = 010
binary-value-type          = 011

text-value-prefix          = text-value-type count
number-value-prefix        = number-value-type count
timestamp-value-prefix     = timestamp-value-type count
binary-value-prefix        = binary-value-type count

text-value                 = text-value-prefix 1*32string
number-value               = number-value-type 1*32uvarint
timestamp-value            = timestamp-value-prefix 1*32uvarint
binary-value               = binary-value-prefix uvarint *OCTET

uvarint                    = *uvarint-continuation uvarint-final
uvarint-continuation       = %x80-FF
uvarint-final              = %x00-7F

name                       = OCTET 1*namechar

namechar                   = ":" / "!" / "#" / "$" / "%" / "&" /
                                  "'" / "*" / "+" / "-" / "." / "^" /
                                  "_" / "`" / "|" / "~" / DIGIT / %x61-7A

string                     = uvarint *(HUFFMAN-ENCODED-CHAR)
                                  HUFFMAN-EOF
                                  padding-to-nearest-byte;
padding-to-nearest-byte    = *7unset

bit                        = set / unset
unset                      = 0
set                        = 1


ret = []
m = num >>> 7    ; unsigned shift left 7 bits
num = m;
m   = 4294967296000
now = milliseconds since UNIX Epoch
era = now / m
ts  = now % m


era       = %x00-FF
ts        = uvarint
date-time = era ts


now = era * m + ts


