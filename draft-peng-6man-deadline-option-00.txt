



Network                                                     Shaofu. Peng
Internet-Draft                                                  Bin. Tan
Intended status: Standards Track                         ZTE Corporation
Expires: July 15, 2022                                  January 11, 2022


                            Deadline Option
                   draft-peng-6man-deadline-option-00

Abstract

   This document introduces new IPv6 options for Hop-by-Hop Options
   header, to carry deadline related information for deterministic
   flows.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on July 15, 2022.

Copyright Notice

   Copyright (c) 2022 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (https://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.





Peng & Tan                Expires July 15, 2022                 [Page 1]

Internet-Draft              Deadline Options                January 2022


Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
     1.1.  Requirements Language . . . . . . . . . . . . . . . . . .   2
   2.  Deadline Option . . . . . . . . . . . . . . . . . . . . . . .   3
   3.  Encapsulation of Deadline Options On Ingress Node . . . . . .   4
   4.  Operations of Deadline Options On Transit Node  . . . . . . .   5
   5.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .   6
   6.  Security Considerations . . . . . . . . . . . . . . . . . . .   6
   7.  Acknowledgements  . . . . . . . . . . . . . . . . . . . . . .   6
   8.  Normative References  . . . . . . . . . . . . . . . . . . . .   6
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .   7

1.  Introduction

   [RFC8655] describes the architecture of deterministic network and
   defines the QoS goals of deterministic forwarding: Minimum and
   maximum end-to-end latency from source to destination, timely
   delivery, and bounded jitter (packet delay variation); packet loss
   ratio under various assumptions as to the operational states of the
   nodes and links; an upper bound on out-of-order packet delivery.  In
   order to achieve these goals, deterministic networks use resource
   reservation, explicit routing, service protection and other means.
   In general, a deterministic path is a strictly explicit path
   calculated by a centralized controller, and resources are reserved on
   the nodes along the path to meet the SLA requirements of
   deterministic services.

   [I-D.peng-detnet-deadline-based-forwarding] describes a deadline
   based forwarding mechanism to get bounded latency and jitter.  A
   single or multiple planned deadline offset time, as well as dynamic
   delay budget adjustment, are used to control the packets scheduling
   of all nodes along the path.  The offset time is based on the time
   when the packet enters the node and represents the maximum time
   allowed for the packet to stay inside the node.

   This document introduces new IPv6 options for Hop-by-Hop Options
   header, to carry deadline related information for deterministic
   flows.

1.1.  Requirements Language

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in BCP
   14 [RFC2119] [RFC8174] when, and only when, they appear in all
   capitals, as shown here.




Peng & Tan                Expires July 15, 2022                 [Page 2]

Internet-Draft              Deadline Options                January 2022


2.  Deadline Option

   [I-D.peng-detnet-deadline-based-forwarding] describes the following
   deadline related informatin that can be carried in packets.

      Planned deadline.

      Existing accumulated planned deadline

      Existing accumulated actual dwell time

      Existing accumulated deadline deviation

   The planned deadline of the packet is an offset time, i.e., a delay
   budget allowed for the packet to stay inside the local node.

   The existing accumulated planned deadline of the packet refers to the
   sum of the planned deadline of all upstream nodes before the packet
   is transmitted to this node.

   The existing accumulated actual dwell time of the packet, refers to
   the sum of the actual dwell time of all upstream nodes before the
   packet is transmitted to this node.

   The existing accumulated deadline deviation equals existing
   accumulated planned deadline minus existing accumulated actual dwell
   time.  This value can be positive or negative.

   The deadline option has the following format:

        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |  Option Type  |  Opt Data Len |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |     Flags   |D|              Planned Deadline                 |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       | Accumulated Planned Deadline / Accumulated Deadline Deviation |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |          Accumulated Actual Dwell Time / Reserved             |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


                     Figure 1: Deadline Option Format

   Option Type: 8-bit identifier of the type of option.  Value TBD by
   IANA; the highest-order 3 bits of thie field is 001 to skip over this
   option and continue processing the header if the processing IPv6 node



Peng & Tan                Expires July 15, 2022                 [Page 3]

Internet-Draft              Deadline Options                January 2022


   does not recognize the Option Type and to permit the Option Data to
   be changed en route to the packet's final destination.

   Opt Data Len: 8-bit unsigned integer.  Length of the Option Data
   field of this option, in octets.  It is set to 12.

   Flags: 8-bit flags.  Currently D-flag is defined.  If D-flag is 0,
   the "Accumulated Planned Deadline / Accumulated Deadline Deviation"
   field contains Accumulated Planned Deadline information, and
   "Accumulated Actual Dwell Time / Reserved" contains Accumulated
   Actual Dwell Time information, otherwise these fields contain
   Accumulated Deadline Deviation and Reserved, respectively.

   Planned Deadline: 24-bit unsigned integer, represents the delay
   budget allowed for the packet to stay inside the received node.  A
   single planned deadline is used for each node along the path.  For
   multiple planned deadlines case, it is defined in future.

   Accumulated Planned Deadline: 32-bit unsigned integer, represents the
   sum of the planned deadline of all upstream nodes before the packet
   is transmitted to the received node.

   Accumulated Deadline Deviation: 32-bit signed integer, represents the
   sum of the deviation between delay budget and actual dwell time of
   all upstream nodes before the packet is transmitted to the received
   node.

   Accumulated Actual Dwell Time: 32-bit unsigned integer, represents
   the sum of the actual dwell time of all upstream nodes before the
   packet is transmitted to the received node.

   Reserved: 32-bit unused.

3.  Encapsulation of Deadline Options On Ingress Node

   The ingress PE node, when encapsulating the deterministic service
   flow, can explicitly insert the deadline option into the packet
   according to SLA.

   For a deterministic delay path based on deadline queue scheduling,
   the path it passes through has deterministic end-to-end delay
   requirements.  It includes two parts, one is the accumulated node
   delay and the other is the accumulated link transmission delay.  The
   end-to-end delay requirement is subtracted from the accumulated link
   transmission delay to obtain the accumulated node delay.  A simple
   method is that the accumulated node delay is shared equally by each
   intermediate node along the path to obtain the planning deadline of
   each node.



Peng & Tan                Expires July 15, 2022                 [Page 4]

Internet-Draft              Deadline Options                January 2022


   Suppose that the planned deadline is D, the actual dwell time is R,
   then the packet sent by the ingress PE may have one of the following
   deadline option information:

      D-flag is set to 0; Planned Deadline is set to D; Accumulated
      Planned Deadline is set to D; Accumulated Actual Dwell Time is set
      to R.

      D-flag is set to 1; Planned Deadline is set to D; Accumulated
      Deadline Deviation is set to D minus R;

4.  Operations of Deadline Options On Transit Node

   The intermediate node, after receiving the packet, can obtain the
   planned deadline from the packet as the delay budget of this node.
   It need get the existing accumulated deadline deviation, and then add
   it to the planned deadline of this node, to obtain the deadline
   adjustment value, and then on the basis of the deadline adjustment
   value, deducting the forwarding delay of the packet in the node, the
   allowable queuing delay value is obtained, and then the packet will
   be put to the deadline queue with TTL as the above allowable queuing
   delay value for sending.  See
   [I-D.peng-detnet-deadline-based-forwarding] for more details.

   If D-flag of the received packet is set to 0, the existing
   accumulated deadline deviation is the value of the Accumulated
   Planned Deadline field minus the value of the Accumulated Actual
   Dwell Time field.

   If D-flag of the received packet is set to 1, the existing
   accumulated deadline deviation is directly get from the Accumulated
   Deadline Deviation field.

   When the intermediate node continues to send the packet to the
   downstream node, it need update the Accumulated Planned Deadline
   field and the Accumulated Actual Dwell Time field, or the Accumulated
   Deadline Deviation field.  Note that field Planned Deadline remains
   unchanged.

   For the update of field Accumulated Planned Deadline, it can add the
   planned deadline of this node to this field.

   For the update of field Accumulated Actual Dwell Time, it can add the
   actual dwell time of this node to this field.  A possible method to
   get the actual dwell time in the node is that, the receiving and
   sending time of the packet can be recorded in the auxiliary data
   structure (note that is not packet itself) of the packet, then the




Peng & Tan                Expires July 15, 2022                 [Page 5]

Internet-Draft              Deadline Options                January 2022


   actual dwell time of the packet in the node can be calculated
   according to these two times.

   For the update of field Accumulated Deadline Deviation, it can add
   the difference of the planned deadline and the actual dwell time to
   this field.

5.  IANA Considerations

   This document updates the "Destination Options and Hop-by-Hop
   Options" under the "Internet Protocol Version 6 (IPv6) Parameters"
   registry:

    +---------+-----+-----+------+-------------------+-------------+
    |Hex Value| act | chg | rest |    Description    |  Reference  |
    +---------+-----+-----+------+-------------------+-------------+
    |   TBD   | 00  |  1  |00000 |  Deadline Option  |This document|
    +---------+-----+-----+------+-------------------+-------------+

6.  Security Considerations

   TBD

7.  Acknowledgements

   TBD

8.  Normative References

   [I-D.peng-detnet-deadline-based-forwarding]
              Peng, S. and B. Tan, "Deadline Based Deterministic
              Forwarding", draft-peng-detnet-deadline-based-
              forwarding-00 (work in progress), January 2022.

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <https://www.rfc-editor.org/info/rfc2119>.

   [RFC8174]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in RFC
              2119 Key Words", BCP 14, RFC 8174, DOI 10.17487/RFC8174,
              May 2017, <https://www.rfc-editor.org/info/rfc8174>.

   [RFC8655]  Finn, N., Thubert, P., Varga, B., and J. Farkas,
              "Deterministic Networking Architecture", RFC 8655,
              DOI 10.17487/RFC8655, October 2019,
              <https://www.rfc-editor.org/info/rfc8655>.




Peng & Tan                Expires July 15, 2022                 [Page 6]

Internet-Draft              Deadline Options                January 2022


Authors' Addresses

   Shaofu Peng
   ZTE Corporation
   China

   Email: peng.shaofu@zte.com.cn


   Bin Tan
   ZTE Corporation
   China

   Email: tan.bin@zte.com.cn





































Peng & Tan                Expires July 15, 2022                 [Page 7]
