



Network Working Group                                   J. Schoenwaelder
Internet-Draft                                                 V. Bajpai
Intended status: Standards Track                Jacobs University Bremen
Expires: May 4, 2016                                    November 1, 2015


             A YANG Data Model for LMAP Measurement Agents
                      draft-ietf-lmap-yang-02.txt

Abstract

   This document defines a data model for Large-Scale Measurement
   Platforms (LMAP).  The data model is defined using the YANG data
   modeling language.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at http://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on May 4, 2016.

Copyright Notice

   Copyright (c) 2015 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (http://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.





Schoenwaelder & Bajpai     Expires May 4, 2016                  [Page 1]

Internet-Draft               LMAP Data Model               November 2015


Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
     1.1.  Terminology . . . . . . . . . . . . . . . . . . . . . . .   2
     1.2.  Tree Diagrams . . . . . . . . . . . . . . . . . . . . . .   2
   2.  Data Model Overview . . . . . . . . . . . . . . . . . . . . .   3
   3.  Relationship to the Information Model . . . . . . . . . . . .   6
   4.  YANG Modules  . . . . . . . . . . . . . . . . . . . . . . . .   7
   5.  Security Considerations . . . . . . . . . . . . . . . . . . .  33
   6.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .  33
   7.  Acknowledgements  . . . . . . . . . . . . . . . . . . . . . .  34
   8.  References  . . . . . . . . . . . . . . . . . . . . . . . . .  34
     8.1.  Normative References  . . . . . . . . . . . . . . . . . .  34
     8.2.  Informative References  . . . . . . . . . . . . . . . . .  35
   Appendix A.  Open Issues  . . . . . . . . . . . . . . . . . . . .  35
   Appendix B.  Non-editorial Changes since -01  . . . . . . . . . .  36
   Appendix C.  Non-editorial Changes since -00  . . . . . . . . . .  36
   Appendix D.  Example Configuration (XML)  . . . . . . . . . . . .  37
   Appendix E.  Example Configuration (JSON) . . . . . . . . . . . .  40
   Appendix F.  Example State (XML)  . . . . . . . . . . . . . . . .  44
   Appendix G.  Example State (JSON) . . . . . . . . . . . . . . . .  45
   Appendix H.  Example Report (XML) . . . . . . . . . . . . . . . .  47
   Appendix I.  Example Report (JSON)  . . . . . . . . . . . . . . .  50
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  54

1.  Introduction

   This document defines a data model for Large-Scale Measurement
   Platforms (LMAP) [RFC7594].  The data model is defined using the YANG
   [RFC6020] data modeling language.  It aims to be consistent with the
   LMAP Information Model [I-D.ietf-lmap-information-model].

1.1.  Terminology

   This document uses the LMAP terminology defined in [RFC7594].

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [RFC2119].

1.2.  Tree Diagrams

   A simplified graphical representation of the data model is used in
   this document.  The meaning of the symbols in these diagrams is as
   follows:

   o  Brackets "[" and "]" enclose list keys.




Schoenwaelder & Bajpai     Expires May 4, 2016                  [Page 2]

Internet-Draft               LMAP Data Model               November 2015


   o  Abbreviations before data node names: "rw" means configuration
      (read-write), "ro" means state data (read-only), and "w" means RPC
      input date (write-only).

   o  Symbols after data node names: "?" means an optional node, "!"
      means a presence container, and "*" denotes a list and leaf-list.

   o  Parentheses enclose choice and case nodes, and case nodes are also
      marked with a colon (":").

   o  Ellipsis ("...") stands for contents of subtrees that are not
      shown.

2.  Data Model Overview

   The tree diagram below shows the structure of the configuration data
   model.


module: ietf-lmap-control
   +--rw lmap
      +--rw agent
      |  +--rw agent-id?                   yang:uuid
      |  +--rw device-id?                  inet:uri
      |  +--rw group-id?                   string
      |  +--rw measurement-point?          string
      |  +--rw report-agent-id?            boolean
      |  +--rw report-measurement-point?   boolean
      |  +--rw controller-timeout?         uint32
      +--rw schedules
      |  +--rw schedule* [name]
      |     +--rw name               string
      |     +--rw event              -> /lmap/events/event/name
      |     +--rw action* [name]
      |     |  +--rw name               string
      |     |  +--rw task               -> /lmap/tasks/task/name
      |     |  +--rw option* [name]
      |     |  |  +--rw name     string
      |     |  |  +--rw value?   string
      |     |  +--rw destination*       -> /lmap/schedules/schedule/name
      |     |  +--rw suppression-tag*   lmap-common:tag-type
      |     +--rw execution-mode?    enumeration
      |     +--rw suppression-tag*   lmap-common:tag-type
      +--rw suppressions
      |  +--rw suppression* [name]
      |     +--rw name            string
      |     +--rw start?          -> /lmap/events/event/name
      |     +--rw end?            -> /lmap/events/event/name



Schoenwaelder & Bajpai     Expires May 4, 2016                  [Page 3]

Internet-Draft               LMAP Data Model               November 2015


      |     +--rw tag*            union
      |     +--rw stop-running?   boolean
      +--rw tasks
      |  +--rw task* [name]
      |     +--rw name                   string
      |     +--rw metric* [uri]
      |     |  +--rw uri     inet:uri
      |     |  +--rw role*   string
      |     +--rw program?               string
      |     +--rw option* [name]
      |     |  +--rw name     string
      |     |  +--rw value?   string
      |     +--rw tag*                   string
      |     +--rw suppress-by-default?   boolean
      +--rw events
         +--rw event* [name]
            +--rw name               string
            +--rw (event-type)?
            |  +--:(periodic)
            |  |  +--rw periodic
            |  |     +--rw interval    uint32
            |  |     +--rw start?      yang:date-and-time
            |  |     +--rw end?        yang:date-and-time
            |  +--:(calendar)
            |  |  +--rw calendar
            |  |     +--rw month*             union
            |  |     +--rw weekday*           union
            |  |     +--rw day-of-month*      union
            |  |     +--rw hour*              union
            |  |     +--rw minute*            union
            |  |     +--rw second*            union
            |  |     +--rw timezone-offset?   lmap-common:timezone-offset
            |  |     +--rw start?             yang:date-and-time
            |  |     +--rw end?               yang:date-and-time
            |  +--:(one-off)
            |  |  +--rw one-off-time       yang:date-and-time
            |  +--:(immediate)
            |  |  +--rw immediate          empty
            |  +--:(startup)
            |  |  +--rw startup            empty
            |  +--:(controller-lost)
            |  |  +--rw controller-lost    empty
            |  +--:(controller-ok)
            |     +--rw controller-ok      empty
            +--rw random-spread?     int32


   The tree diagram below shows the structure of the state data model.



Schoenwaelder & Bajpai     Expires May 4, 2016                  [Page 4]

Internet-Draft               LMAP Data Model               November 2015


  module: ietf-lmap-control
     +--ro lmap-state
        +--ro agent
        |  +--ro agent-id        yang:uuid
        |  +--ro device-id       inet:uri
        |  +--ro hardware        string
        |  +--ro firmware        string
        |  +--ro version         string
        |  +--ro last-started    yang:date-and-time
        +--ro tasks
        |  +--ro task* [name]
        |     +--ro name       string
        |     +--ro metric* [uri]
        |     |  +--ro uri     inet:uri
        |     |  +--ro role*   string
        |     +--ro version?   string
        |     +--ro program?   string
        +--ro schedules
           +--ro schedule* [name]
              +--ro name               string
              +--ro state?             enumeration
              +--ro last-invocation?   yang:date-and-time
              +--ro action* [name]
                 +--ro name                      string
                 +--ro state?                    enumeration
                 +--ro last-invocation?          yang:date-and-time
                 +--ro last-completion?          yang:date-and-time
                 +--ro last-status?              lmap-common:status-code
                 +--ro last-message?             string
                 +--ro last-failed-completion?   yang:date-and-time
                 +--ro last-failed-status?       lmap-common:status-code
                 +--ro last-failed-message?      string


   The tree diagram below shows the structure of the reporting data
   model.















Schoenwaelder & Bajpai     Expires May 4, 2016                  [Page 5]

Internet-Draft               LMAP Data Model               November 2015


   module: ietf-lmap-report
   rpcs:
      +---x report
         +---w input
            +---w date                 yang:date-and-time
            +---w agent-id?            yang:uuid
            +---w group-id?            string
            +---w measurement-point?   string
            +---w task* [name]
               +---w name      string
               +---w metric* [uri]
               |  +---w uri     inet:uri
               |  +---w role*   string
               +---w option* [name]
               |  +---w name     string
               |  +---w value?   string
               +---w tag*      string
               +---w header
               |  +---w column*   string
               +---w row*
                  +---w start       yang:date-and-time
                  +---w end?        yang:date-and-time
                  +---w conflict*   string
                  +---w value*      string


3.  Relationship to the Information Model

   The LMAP information model [I-D.ietf-lmap-information-model] is
   devided into six sections.  They are mapped into the YANG data model
   as explained below:

   o  Pre-Configuration Information: This is not modeled explicitly
      since it is a subset of the configuration information.

   o  Configuration Information: This is modeled in the /lmap/agent
      subtree, the /lmap/schedules subtree, and the /lmap/tasks subtree
      described below.  Some items have been left out because they are
      expected to be dealt with by the underlying protocol.

   o  Instruction Information: This is modeled in the /lmap/suppressions
      subtree, the /lmap/schedules subtree, and the /lmap/tasks subtree
      described below.

   o  Logging Information: Some of the logging information, in
      particular 'success/failure/warning messages in response to
      information updates from the Controller', will be handled by the
      protocol used to manipulate the lmap specific configuration.



Schoenwaelder & Bajpai     Expires May 4, 2016                  [Page 6]

Internet-Draft               LMAP Data Model               November 2015


      [[CREF1: It needs to be discussed whether we can rely on informal
      syslog messages that can be accessed via protocols such RFC 5277
      or whether we want to define specific notifications in the YANG
      data model. --JS]]

   o  Capability and Status Information: Some of the status information
      is modeled in the /lmap-state/agent subtree and teh /lmap-state/
      schedules subtree.  Information about network interfaces can be
      obtained from the interfaces YANG data model [RFC7223].  The list
      of supported tasks is modeled in the /lmap-state/tasks subtree.

   o  Reporting Information: This is modeled by the report data model to
      be implemented by the Collector.  Measurement Agents send results
      to the Collector via an RPC operation.

   These six sections are build on the following common information
   objects:

   o  Schedules: This is modeled in the /lmap/schedules subtree.

   o  Channels: Channels are not modeled since the NETCONF and RESTCONF
      server configuration data model [I-D.ietf-netconf-server-model]
      already provides a mechanism to configure NETCONF and RESTCONF
      server channels.

   o  Task Configurations: This is modeled in the /lmap/tasks subtree.

   o  Event Information: This is modeled in the /lmap/events subtree.

4.  YANG Modules

   The modules import definitions from [RFC6991] and [RFC7223] and they
   reference [RFC7398].


   <CODE BEGINS> file "ietf-lmap-common@2015-10-28.yang"
   module ietf-lmap-common {

     namespace "urn:ietf:params:xml:ns:yang:ietf-lmap-common";
     prefix "lmap-common";

     import ietf-yang-types {
       prefix yang;
     }
     import ietf-inet-types {
       prefix inet;
     }




Schoenwaelder & Bajpai     Expires May 4, 2016                  [Page 7]

Internet-Draft               LMAP Data Model               November 2015


     organization
       "IETF Large-Scale Measurement Platforms Working Group";

     contact
       "WG Web:   <http://tools.ietf.org/wg/lmap/>
        WG List:  <mailto:lmap@ietf.org>

        Editor:   Juergen Schoenwaelder
                  <j.schoenwaelder@jacobs-university.de>

        Editor:   Vaibhav Bajpai
                  <v.bajpai@jacobs-university.de>";

     description
       "This module provides common definitions used by the data
        models written for Large-Scale Measurement Platforms (LMAP).
        This module defines typedefs and groupings but no schema
        tree elements.";

     revision "2015-10-28" {
       description
        "Initial version";
       reference
        "RFC XXX: A YANG Data Model for LMAP Measurement Agents";
     }

     /*
      * Typedefs
      */

     typedef tag-type {
       type string {
         length "1..max";
         pattern '[^\*].*';
       }
       description
         "A tag consists of at least one character and a tag is
          not allowed to start with an asterisk '*'.";
       // XXX: Does it make sense to have stricter rules,
       // XXX: e.g., disallow white space?
     }

     typedef tag-matchall-type {
       type string {
         pattern '\*';
       }
       description
         "The string containing a single asterisk '*' is used



Schoenwaelder & Bajpai     Expires May 4, 2016                  [Page 8]

Internet-Draft               LMAP Data Model               November 2015


          to match all tags.";
       // XXX: Allow glob-style matching, turning this into a
       // XXX: tag-match-type?
     }

     typedef wildcard {
       type string {
         pattern '\*';
       }
       description
         "A wildcard for calendar scheduling entries.";
     }

     typedef weekday {
       type enumeration {
         enum sunday {
           value 0;
           description "Sunday of the week";
         }
         enum monday {
           value 1;
           description "Monday of the week";
         }
         enum tuesday {
           value 2;
           description "Tuesday of the week";
         }
         enum wednesday {
           value 3;
           description "Wednesday of the week";
         }
         enum thursday {
           value 4;
           description "Thursday of the week";
         }
         enum friday {
           value 5;
           description "Friday of the week";
         }
         enum saturday {
           value 6;
           description "Saturday of the week";
         }
       }
       description
        "A type modeling the weekdays in the Greco-Roman
         tradition.";
     }



Schoenwaelder & Bajpai     Expires May 4, 2016                  [Page 9]

Internet-Draft               LMAP Data Model               November 2015


     typedef month {
       type enumeration {
         enum january {
           value 1;
           description "January of the Julian and Gregorian calendar";
         }
         enum february {
           value 2;
           description "February of the Julian and Gregorian calendar";
         }
         enum march {
           value 3;
           description "March of the Julian and Gregorian calendar";
         }
         enum april {
           value 4;
           description "April of the Julian and Gregorian calendar";
         }
         enum may {
           value 5;
           description "May of the Julian and Gregorian calendar";
         }
         enum june {
           value 6;
           description "June of the Julian and Gregorian calendar";
         }
         enum july {
           value 7;
           description "July of the Julian and Gregorian calendar";
         }
         enum august {
           value 8;
           description "August of the Julian and Gregorian calendar";
         }
         enum september {
           value 9;
           description "September of the Julian and Gregorian calendar";
         }
         enum october {
           value 10;
           description "October of the Julian and Gregorian calendar";
         }
         enum november {
           value 11;
           description "November of the Julian and Gregorian calendar";
         }
         enum december {
           value 12;



Schoenwaelder & Bajpai     Expires May 4, 2016                 [Page 10]

Internet-Draft               LMAP Data Model               November 2015


           description "December of the Julian and Gregorian calendar";
         }
       }
       description
         "A type modeling the month in the Julian and Gregorian
          tradition.";
     }

     typedef status-code {
       type int32;
       description
         "A status code returned by the execution of a task. Note that
          the actual range is implementation dependent but it should
          be portable to use values in the range 0..127 for regular
          exit codes. By convention, 0 indicates successful termination.
          Negative values may be used to indicate abnormal termination
          due to a signal; the absolute value may identify the signal
          number in this case.";
     }

     typedef timezone-offset {
       type string {
         pattern 'Z|[\+\-]\d{2}:\d{2}';
       }
       description
         "A timezone-offset as it is use in the yang:date-and-time
          type. The value Z is equivalent to +00:00. The value -00:00
          indicates and unknown time-offset.";
     }

     /*
      * Groupings
      */

     grouping metrics-grouping {
       description
         "This grouping models a list of entry in a metrics registry.";

       list metric {
         key uri;
         description
           "A list of entries in a metrics registry.";

         leaf uri {
           type inet:uri;
           description
             "A URI identifying an entry in a metrics registry.";
         }



Schoenwaelder & Bajpai     Expires May 4, 2016                 [Page 11]

Internet-Draft               LMAP Data Model               November 2015


         leaf-list role {
           type string;
           description
             "A set of roles for this metrics.";
         }
       }
     }

     grouping task-options-grouping {
       description
         "A list of options of a task. Each option is a name/value
          pair (where the value may be absent).";

       list option {
         key "name";
         ordered-by user;

         description
           "A list of options passed to the task. It is a list of
            key / value pairs and may be used to model options.
            Options may be used to identify the role of a task
            or to pass a channel name to a task.";

         // XXX This is kind of broken since making the option name
         // XXX a key means that a certain option may only appear once.
         // XXX This is not workable since some tests require a list of
         // XXX targets. Turning this into a leaf-list of args also
         // XXX does not work since YANG requires leaf-list values to
         // XXX be unique. Oops.

         leaf name {
           type string;
           description
             "The name of the option.";
         }

         leaf value {
           type string;
           description
             "The value of the option.";
         }
       }
     }
   }
   <CODE ENDS>






Schoenwaelder & Bajpai     Expires May 4, 2016                 [Page 12]

Internet-Draft               LMAP Data Model               November 2015


   <CODE BEGINS> file "ietf-lmap-control@2015-10-28.yang"
   module ietf-lmap-control {

     namespace "urn:ietf:params:xml:ns:yang:ietf-lmap-control";
     prefix "lmap-control";

     import ietf-yang-types {
       prefix yang;
     }
     import ietf-inet-types {
       prefix inet;
     }
     import ietf-lmap-common {
       prefix lmap-common;
     }

     organization
       "IETF Large-Scale Measurement Platforms Working Group";

     contact
       "WG Web:   <http://tools.ietf.org/wg/lmap/>
        WG List:  <mailto:lmap@ietf.org>

        Editor:   Juergen Schoenwaelder
                  <j.schoenwaelder@jacobs-university.de>

        Editor:   Vaibhav Bajpai
                  <v.bajpai@jacobs-university.de>";

     description
       "This module defines a data model for controlling measurement
        agents that are part of a Large-Scale Measurement Platform
        (LMAP). This data model is expected to be implemented by a
        measurement agent.";

     revision "2015-10-28" {
       description
        "Initial version";
       reference
        "RFC XXX: A YANG Data Model for LMAP Measurement Agents";
     }

     /*
      * Groupings
      */

     grouping timing-start-end-grouping {
       description



Schoenwaelder & Bajpai     Expires May 4, 2016                 [Page 13]

Internet-Draft               LMAP Data Model               November 2015


         "A grouping that provides start and end times for
          timing objects.";
       leaf start {
         type yang:date-and-time;
         description
           "The date and time when the timing object
            starts to create triggers.";
       }
       leaf end {
         type yang:date-and-time;
         description
           "The date and time when the timing object
            stops to create triggers.

            It is generally a good idea to always configure
            an end time and to refresh the configuration
            of timing object as needed to ensure that agents
            that loose connectivity to their controller
            do not continue their tasks forever.";
       }
     }

     /*
      * Configuration data nodes
      */

     container lmap {
       description
         "Configuration of the LMAP agent.";

       /*
        * Common Information Objects: Configuration
        */

       container agent {
         description
           "Configuration of parameters affecting the whole
            measurement agent.";

         leaf agent-id {
           type yang:uuid;
           description
             "The agent-id identifies a measurement agent with
              a very low probability of collision. In certain
              deployments, the agent-id may be considered
              sensitive and hence this object is optional.";
         }




Schoenwaelder & Bajpai     Expires May 4, 2016                 [Page 14]

Internet-Draft               LMAP Data Model               November 2015


         leaf device-id {
           type inet:uri;
           description
             "The device-id identifies a property of the
              device running the measurement agent. In certain
              deployments, the device-id may be considered
              sensitive and hence this object is optional.";
         }

         leaf group-id {
           type string;
           description
             "The group-id identifies a group of measurement
              agents. In certain deployments, the group-id
              may be considered less sensitive than the
              agent-id.";
         }

         leaf measurement-point {
           type string;
           description
             "The measurement point indicating where the
               measurement agent is located on a path.";
           reference
             "RFC 7398: A Reference Path and Measurement Points
                        for Large-Scale Measurement of Broadband
                        Performance";
         }

         leaf report-agent-id {
           type boolean;
           must "../agent-id" {
             description
               "An agent-id must exist for this to be set.";
           }
           description
             "The 'report-agent-id' controls whether the
              'agent-id' is reported to collectors if the
              'group-id' is configured. If the 'group-id'
              is not configured, the agent-id is always
              reported.";
         }

         leaf report-measurement-point {
           type boolean;
           must "../measurement-point" {
             description
               "A measurement-point must exist for this to be set.";



Schoenwaelder & Bajpai     Expires May 4, 2016                 [Page 15]

Internet-Draft               LMAP Data Model               November 2015


           }
           description
             "The 'report-measurement-point' controls whether
              the 'measurement-point' is reported to collectors
              if the 'measurement-point' is configured.";
         }

         leaf controller-timeout {
           type uint32;
           units "seconds";
           description
             "A timer is started after each successful contact
              with a controller. When the timer reaches the
              controller-timeout, an event is raised indicating
              that connectivity to the controller has been lost.";
           }
         }

       /*
        * Common Information Objects: Schedules
        */

       container schedules {
         description
           "Configuration of LMAP schedules. Schedules control which
            tasks are executed by the LMAP implementation.";

         list schedule {
           key name;
           description
             "Configuration of a particular schedule.";

           leaf name {
             type string;
             description
               "The locally-unique, administratively assigned name for
                this schedule.";
           }

           leaf event {
             type leafref {
               path "/lmap/events/event/name";
             }
             mandatory true;
             description
               "The event source controlling the start of the scheduled
                tasks.";
           }



Schoenwaelder & Bajpai     Expires May 4, 2016                 [Page 16]

Internet-Draft               LMAP Data Model               November 2015


           list action {
             key name;
             description
               "An action describes a task that is invoked by the
                schedule. Multiple actions are invoked sequentially.";

             leaf name {
               type string;
               description
                 "The unique identifier for this action.";
             }

             leaf task {
               type leafref {
                 path "/lmap/tasks/task/name";
               }
               mandatory true;
               description
                 "The tasks invoked by this action.";
             }

             uses lmap-common:task-options-grouping {
               description
                 "The list of action specific options that are
                  appended to the list of task specific options.";
             }

             leaf-list destination {
               type leafref {
                 path "/lmap/schedules/schedule/name";
               }
               description
                 "A schedule of receiving the output produced by
                  this action. A queue is internally used to pass
                  results to another schedule. The behaviour of
                  an action passing data to its own schedule is
                  implementation specific.

                  Data passed to a sequential or pipelined schedule
                  is consumed by the schedule's first action. Data
                  passed to a parallel schedule is consumed by all
                  actions of the schedule.";
             }

             leaf-list suppression-tag {
               type lmap-common:tag-type;
               description
                 "A list of suppression tags.";



Schoenwaelder & Bajpai     Expires May 4, 2016                 [Page 17]

Internet-Draft               LMAP Data Model               November 2015


             }
           }

           leaf execution-mode {
             type enumeration {
               enum sequential {
                 value 1;
                 description
                   "The actions of the schedule are executed
                    sequentially.";
               }
               enum parallel {
                 value 2;
                 description
                   "The actions of the schedule are executed
                    concurrently";
               }
               enum pipelined {
                 value 3;
                 description
                   "The actions of the schedule are executed in a
                    pipelined mode. Output created by an action is
                    passed as input to the subsequent action.";
               }
             }
             default pipelined;
             description
               "The execution mode of this schedule determins in
                which order the actions of the schedule are executed.";
           }

           leaf-list suppression-tag {
             type lmap-common:tag-type;
             description
               "A list of suppression tags.";
           }
         }
       }

       /*
        * Suppression
        */

       container suppressions {
         description
           "Suppression information to prevent schedules or
            certain actions from starting.";




Schoenwaelder & Bajpai     Expires May 4, 2016                 [Page 18]

Internet-Draft               LMAP Data Model               November 2015


         list suppression {
           key name;
           description
             "Configuration of a particular suppression.";

           leaf name {
             type string;
             description
               "The locally-unique, administratively assigned name for
                this suppression.";
           }

           leaf start {
             type leafref {
               path "/lmap/events/event/name";
             }
             description
               "The event source controlling the start of the
                suppression period.";
           }

           leaf end {
             type leafref {
               path "/lmap/events/event/name";
             }
             description
               "The event source controlling the end of the
                suppression period. If not present, supression
                continues indefinitely.";
           }

           leaf-list tag {
             type union {
               type lmap-common:tag-type;
               type lmap-common:tag-matchall-type;
             }
             description
               "A list of suppression tags. The suppression will
                apply to all schedules (and their actions) that have
                a matching value in their suppression-tags and to
                all actions that have a matching value in their
                suppression-tags.";
           }

           leaf stop-running {
             type boolean;
             default false;
             description



Schoenwaelder & Bajpai     Expires May 4, 2016                 [Page 19]

Internet-Draft               LMAP Data Model               November 2015


               "Setting 'stop-running' to true will cause running
                tasks to be terminated if suppression is activated.
                Otherwise, running tasks will not be affected if
                suppression is activated.";
           }
         }
       }

       /*
        * Common Information Objects: Task Configurations
        */

       container tasks {
         description
           "Configuration of LMAP tasks.";

         list task {
           key name;
           description
             "The list of tasks configured on the LMAP agent.";

           leaf name {
             type string;
             description
               "The unique name of a task.";
           }

           uses lmap-common:metrics-grouping;

           leaf program {
             type string;
             description
               "The (local) program to invoke in order to execute
                the task.";
           }

           uses lmap-common:task-options-grouping {
             description
               "The list of task specific options.";
           }

           leaf-list tag {
             type string;
             description
               "A tag contains additional information that is passed
                with the result record to the collector. A tag can be
                used to carry the Measurement Cycle ID.";
           }



Schoenwaelder & Bajpai     Expires May 4, 2016                 [Page 20]

Internet-Draft               LMAP Data Model               November 2015


           leaf suppress-by-default {
             type boolean;
             default true;
             description
               "Indicates whether the task will be suppressed by
                a default supression.";
           }
         }
       }

       /*
        * Common Information Objects: Event Information
        */

       container events {
         description
           "Configuration of LMAP events.

            Implementations may be forced to delay acting
            upon the occurance of events in the face of local
            constraints. An action triggered by an event
            therefore should not rely on the accuracy
            provided by the scheduler implementation.";

         list event {
           key name;
           description
             "The list of event sources configured on the
              LMAP agent.";

           leaf name {
             type string;
             description
               "The unique name of an event source.";
           }

           choice event-type {
             description
               "Different types of events are handled by
                different branches of this choice. Note that
                this choice can be extended via augmentations.";

             case periodic {
               container periodic {
                 description
                   "A periodic timing object triggers periodically
                    according to a regular interval.";




Schoenwaelder & Bajpai     Expires May 4, 2016                 [Page 21]

Internet-Draft               LMAP Data Model               November 2015


                 leaf interval {
                   type uint32;
                   units "milliseconds";
                   mandatory true;
                   description
                     "The number of milliseconds between two triggers
                      generated by this periodic timing object.

                      The execution system must not generate triggers
                      for periodic timing objects that have a interval
                      value of 0. A periodic timing object with an
                      interval of 0 milliseconds will therefore never
                      trigger.";
                 }
                 uses timing-start-end-grouping;
               }
             }

             case calendar {
               container calendar {
                 description
                   "A calendar timing object triggers based on the
                    current calendar date and time.";

                 leaf-list month {
                   type union {
                     type lmap-common:month;
                     type lmap-common:wildcard;
                   }
                   description
                     "A month at which this calendar timing will
                      trigger. The wildcard means all months.";
                 }

                 leaf-list weekday {
                   type union {
                     type lmap-common:weekday;
                     type lmap-common:wildcard;
                   }
                   description
                     "A weekday at which this calendar timing will
                      trigger. The wildcard means all weekdays.";
                 }

                 leaf-list day-of-month {
                   type union {
                     type int8 { range "-31..-1 | 1..31"; }
                     type lmap-common:wildcard;



Schoenwaelder & Bajpai     Expires May 4, 2016                 [Page 22]

Internet-Draft               LMAP Data Model               November 2015


                   }
                   description
                     "A day in the month at which this calendar
                      timing will trigger. Negative numbers indicate
                      days counted backwards from the end of the
                      months. The wildcard means all days of a month.";
                 }

                 leaf-list hour {
                   type union {
                     type int8 { range "0..23"; }
                     type lmap-common:wildcard;
                   }
                   description
                     "An hour at which this calendar timing will
                      trigger. The wildcard means all hours of a day.";
                 }

                 leaf-list minute {
                   type union {
                     type int8 { range "0..59"; }
                     type lmap-common:wildcard;
                   }
                   description
                     "A minute at which this calendar timing will
                      trigger. The wildcard means all minutes of
                      an hour.";
                 }

                 leaf-list second {
                   type union {
                     type int8 { range "0..59"; }
                     type lmap-common:wildcard;
                   }
                   description
                     "A second at which this calendar timing will
                      trigger. The wildcard means all seconds of
                      a minute.";
                 }

                 leaf timezone-offset {
                   type lmap-common:timezone-offset;
                   description
                     "The timezone in which this calendar timing
                      object will be evaluated.";
                 }
                 uses timing-start-end-grouping;
               }



Schoenwaelder & Bajpai     Expires May 4, 2016                 [Page 23]

Internet-Draft               LMAP Data Model               November 2015


             }

             case one-off {
               leaf one-off-time {
                 type yang:date-and-time;
                 mandatory true;
                 description
                   "This one-off timing object triggers once at the
                    configured one-off-time.";
               }
             }

             case immediate {
               leaf immediate {
                 type empty;
                 mandatory true;
                 description
                   "This immediate event object triggers immediately
                    when it is configured.";
               }
             }

             case startup {
               leaf startup {
                 type empty;
                 mandatory true;
                 description
                   "This startup event object triggers whenever the
                    LMAP agent (re)starts.";
               }
             }

             case controller-lost {
               leaf controller-lost {
                 type empty;
                 mandatory true;
                 description
                   "The controller-lost event object triggers when
                    the connectivity to the controller has been lost
                    for at least 'controller-timeout' seconds.";
               }
             }

             case controller-ok {
               leaf controller-ok {
                 type empty;
                 mandatory true;
                 description



Schoenwaelder & Bajpai     Expires May 4, 2016                 [Page 24]

Internet-Draft               LMAP Data Model               November 2015


                   "The controller-ok event object triggers when
                    the connectivity to the controller has been
                    restored after it was lost for at least
                    'controller-timeout' seconds.";
               }
             }
           }

           leaf random-spread {
             type int32;
             units milliseconds;
             description
               "This optional leaf adds a random spread to the
                computation of the trigger.";
           }
         }
       }
     }

     /*
      * The state subtree provides information about the capabilities
      * and the current status of the MA.
      */

     container lmap-state {
       config false;
       description
         "A tree exporting state information about the LMAP agent.";

       container agent {
         description
           "Operations state of the measurement agent.";

         leaf agent-id {
           type yang:uuid;
           mandatory true;
           description
             "The agent-id identifies a measurement agent with
              a very low probability of collision. In certain
              deployments, the agent-id may be considered
              sensitive and hence this object is optional.";
         }

         leaf device-id {
           type inet:uri;
           mandatory true;
           description
             "The device-id identifies a property of the



Schoenwaelder & Bajpai     Expires May 4, 2016                 [Page 25]

Internet-Draft               LMAP Data Model               November 2015


              device running the measurement agent. In certain
              deployments, the device-id may be considered
              sensitive and hence this object is optional.";
         }
         leaf hardware {
           type string;
           mandatory true;
           description
             "A short description of the hardware the measurement
              agent is running on. This should include the version
              number of the hardware";
         }
         leaf firmware {
           type string;
           mandatory true;
           description
             "A short description of the firmware the measurement
              agent is running on. This should include the version
              number of the firmware.";
         }
         leaf version {
           type string;
           mandatory true;
           description
             "A short description of the software implementing the
              measurement agent. This should include the version
              number of the measurement agent software.";
         }
         leaf last-started {
           type yang:date-and-time;
           mandatory true;
           description
             "The date and time the measurement agent last started.";
         }
       }

       container tasks {
         description
           "Available LMAP tasks, including information about their
            last execution and their last failed execution.";

         list task {
           key name;
           description
             "The list of tasks available on the LMAP agent.";

           leaf name {
             type string;



Schoenwaelder & Bajpai     Expires May 4, 2016                 [Page 26]

Internet-Draft               LMAP Data Model               November 2015


             description
               "The unique name of a task.";
           }

           uses lmap-common:metrics-grouping;

           leaf version {
             type string;
             description
               "A short description of the software implementing
                the task. This should include the version
                number of the measurement task software.";
           }

           leaf program {
             type string;
             description
               "The (local) program to invoke in order to execute
                the task.";
           }
         }
       }

       container schedules {
         description
           "State of LMAP schedules.";

         list schedule {
           key name;
           description
             "State of a particular schedule.";

           leaf name {
             type string;
             description
               "The locally-unique, administratively assigned name for
                this schedule.";
           }

           leaf state {
             type enumeration {
               enum enabled {
                 value 1;
                 description
                   "The value 'enabled' indicates that the
                    schedule is currently enabled.";
               }
               enum disabled {



Schoenwaelder & Bajpai     Expires May 4, 2016                 [Page 27]

Internet-Draft               LMAP Data Model               November 2015


                 value 2;
                 description
                   "The value 'disabled' indicates that the
                    schedule is currently disabled.";
               }
               enum suppressed {
                 value 3;
                 description
                   "The value 'suppressed' indicates that the
                    schedule is currently suppressed.";
               }
             }
             description
               "The current state of the schedule.";
           }

           leaf last-invocation {
             type yang:date-and-time;
             description
               "The date and time of the last invocation of
                this schedule.";
           }

           list action {
             key name;
             description
               "The state of the actions associated with this
                schedule entry.";

             leaf name {
               type string;
               description
                 "The unique identifier for this action.";
             }

             leaf state {
               type enumeration {
                 enum enabled {
                   value 1;
                   description
                     "The value 'enabled' indicates that the
                      action is currently enabled.";
                 }
                 enum disabled {
                   value 2;
                   description
                     "The value 'disabled' indicates that the
                      action is currently disabled.";



Schoenwaelder & Bajpai     Expires May 4, 2016                 [Page 28]

Internet-Draft               LMAP Data Model               November 2015


                 }
                 enum suppressed {
                   value 3;
                   description
                     "The value 'suppressed' indicates that the
                      action is currently suppressed.";
                 }
               }
               description
                 "The current state of the action.";
             }

             leaf last-invocation {
               type yang:date-and-time;
               description
                 "The date and time of the last invocation of
                  this action.";
             }

             leaf last-completion {
               type yang:date-and-time;
               description
                 "The date and time of the last completion of
                  this action.";
             }

             leaf last-status {
               type lmap-common:status-code;
               description
                 "The status code returned by the last execution of
                  this action.";
             }

             leaf last-message {
               type string;
               description
                 "The status message produced by the last execution
                  of this action.";
             }

             leaf last-failed-completion {
               type yang:date-and-time;
               description
                 "The date and time of the last failed completion
                  of this action.";
             }

             leaf last-failed-status {



Schoenwaelder & Bajpai     Expires May 4, 2016                 [Page 29]

Internet-Draft               LMAP Data Model               November 2015


               type lmap-common:status-code;
               description
                 "The status code returned by the last failed execution
                  of this action.";
             }

             leaf last-failed-message {
               type string;
               description
                 "The status message produced by the last failed
                  execution of this action.";
             }
           }
         }
       }
     }
   }
   <CODE ENDS>



<CODE BEGINS> file "ietf-lmap-report@2015-10-28.yang"
module ietf-lmap-report {

  namespace "urn:ietf:params:xml:ns:yang:ietf-lmap-report";
  prefix "lmap-report";

  import ietf-yang-types {
    prefix yang;
  }
  import ietf-lmap-common {
    prefix lmap-common;
  }

  organization
    "IETF Large-Scale Measurement Platforms Working Group";

  contact
    "WG Web:   <http://tools.ietf.org/wg/lmap/>
     WG List:  <mailto:lmap@ietf.org>

     Editor:   Juergen Schoenwaelder
               <j.schoenwaelder@jacobs-university.de>

     Editor:   Vaibhav Bajpai
               <v.bajpai@jacobs-university.de>";

  description



Schoenwaelder & Bajpai     Expires May 4, 2016                 [Page 30]

Internet-Draft               LMAP Data Model               November 2015


    "This module defines a data model for reporting results from
     measurement agents, which are part of a Large-Scale Measurement
     Platform (LMAP), to result data collectors. This data model is
     expected to be implemented by a collector.";

  revision "2015-10-28" {
    description
     "Initial version";
    reference
     "RFC XXX: A YANG Data Model for LMAP Measurement Agents";
  }

  rpc report {
    description
      "The report operation is used by an LMAP measurement agent to
       submit measurement results produced by measurement tasks to
       a collector.";

    input {

      leaf date {
        type yang:date-and-time;
        mandatory true;
        description
          "The date and time when this result report was sent to
           a collector.";
      }

      leaf agent-id {
        type yang:uuid;
        description
          "The agent-id of the agent from which this
           report originates.";
      }

      leaf group-id {
        type string;
        description
          "The group-id of the agent from which this
           report originates.";
      }

      leaf measurement-point {
        type string;
        description
          "The measurement-point of the agent from which this
           report originates.";
      }



Schoenwaelder & Bajpai     Expires May 4, 2016                 [Page 31]

Internet-Draft               LMAP Data Model               November 2015


      list task {
        key name;
        description
          "The list of tasks for which results are reported.";

        leaf name {
          type string;
          description
            "The unique name of the task.";
        }

        uses lmap-common:metrics-grouping;

        uses lmap-common:task-options-grouping {
          description
            "The list of task options there were in use then the
             measurement was performed. This list must include
             both the task specific options as well as the action
             specific options.";
        }

        leaf-list tag {
          type string;
          description
            "A tag contains additional information that is passed
             with the result record to the collector. A tag can be
             used to carry the Measurement Cycle ID.";
        }

        container header {
          description
            "This container lists the column labels. It does not
             really serve a purpose other than making the result
             data look nicely structured.";

          leaf-list column {
            type string;
            description
              "An ordered list of column labels. The order is determined
               by the system and must match the order of the columns in
               the result rows.";
          }
        }

        list row {
          description
            "The rows of the result record.";




Schoenwaelder & Bajpai     Expires May 4, 2016                 [Page 32]

Internet-Draft               LMAP Data Model               November 2015


          leaf start {
            type yang:date-and-time;
            mandatory true;
            description
              "The date and time when the measurement producing
              this result row started.";
          }

          leaf end {
            type yang:date-and-time;
            description
              "The date and time when the measurement producing
               this result row stopped.";
          }

          leaf-list conflict {
            type string;
            description
              "The name of a task overlapping with the execution
               of the task that has produced this result record.";
          }

          leaf-list value {
            type string;
            description
              "The value of a cell in the result row.";
          }
        }
      }
    }
  }
}
<CODE ENDS>


5.  Security Considerations

   TBD

6.  IANA Considerations

   This document registers a URI in the "IETF XML Registry" [RFC3688].
   Following the format in RFC 3688, the following registrations have
   been made.







Schoenwaelder & Bajpai     Expires May 4, 2016                 [Page 33]

Internet-Draft               LMAP Data Model               November 2015


         URI: urn:ietf:params:xml:ns:yang:ietf-lmap-control
         Registrant Contact: The IESG.
         XML: N/A; the requested URI is an XML namespace.

         URI: urn:ietf:params:xml:ns:yang:ietf-lmap-report
         Registrant Contact: The IESG.
         XML: N/A; the requested URI is an XML namespace.


   This document registers a YANG module in the "YANG Module Names"
   registry [RFC6020].


         name: ietf-lmap-common
         namespace: urn:ietf:params:xml:ns:yang:ietf-lmap-common
         prefix: lmap-common
         reference: RFC XXXX

         name: ietf-lmap-control
         namespace: urn:ietf:params:xml:ns:yang:ietf-lmap-control
         prefix: lmap-control
         reference: RFC XXXX

         name: ietf-lmap-report
         namespace: urn:ietf:params:xml:ns:yang:ietf-lmap-report
         prefix: lmap-report
         reference: RFC XXXX


7.  Acknowledgements

   Juergen Schoenwaelder and Vaibhav Bajpai worked in part on the Leone
   research project, which received funding from the European Union
   Seventh Framework Programme [FP7/2007-2013] under grant agreement
   number 317647.

   Juergen Schoenwaelder and Vaibhav Bajpai were partly funded by
   Flamingo, a Network of Excellence project (ICT-318488) supported by
   the European Commission under its Seventh Framework Programme.

8.  References

8.1.  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119, DOI 10.17487/
              RFC2119, March 1997,
              <http://www.rfc-editor.org/info/rfc2119>.



Schoenwaelder & Bajpai     Expires May 4, 2016                 [Page 34]

Internet-Draft               LMAP Data Model               November 2015


   [RFC6020]  Bjorklund, M., Ed., "YANG - A Data Modeling Language for
              the Network Configuration Protocol (NETCONF)", RFC 6020,
              DOI 10.17487/RFC6020, October 2010,
              <http://www.rfc-editor.org/info/rfc6020>.

   [RFC6991]  Schoenwaelder, J., Ed., "Common YANG Data Types", RFC
              6991, DOI 10.17487/RFC6991, July 2013,
              <http://www.rfc-editor.org/info/rfc6991>.

8.2.  Informative References

   [I-D.ietf-lmap-information-model]
              Burbridge, T., Eardley, P., Bagnulo, M., and J.
              Schoenwaelder, "Information Model for Large-Scale
              Measurement Platforms (LMAP)", draft-ietf-lmap-
              information-model-06 (work in progress), July 2015.

   [I-D.ietf-netconf-server-model]
              Watsen, K. and J. Schoenwaelder, "NETCONF Server and
              RESTCONF Server Configuration Models", draft-ietf-netconf-
              server-model-08 (work in progress), October 2015.

   [RFC3688]  Mealling, M., "The IETF XML Registry", BCP 81, RFC 3688,
              DOI 10.17487/RFC3688, January 2004,
              <http://www.rfc-editor.org/info/rfc3688>.

   [RFC7223]  Bjorklund, M., "A YANG Data Model for Interface
              Management", RFC 7223, DOI 10.17487/RFC7223, May 2014,
              <http://www.rfc-editor.org/info/rfc7223>.

   [RFC7398]  Bagnulo, M., Burbridge, T., Crawford, S., Eardley, P., and
              A. Morton, "A Reference Path and Measurement Points for
              Large-Scale Measurement of Broadband Performance", RFC
              7398, DOI 10.17487/RFC7398, February 2015,
              <http://www.rfc-editor.org/info/rfc7398>.

   [RFC7594]  Eardley, P., Morton, A., Bagnulo, M., Burbridge, T.,
              Aitken, P., and A. Akhter, "A Framework for Large-Scale
              Measurement of Broadband Performance (LMAP)", RFC 7594,
              DOI 10.17487/RFC7594, September 2015,
              <http://www.rfc-editor.org/info/rfc7594>.

Appendix A.  Open Issues

   o  The task-options-grouping needs fixing, see the comments inline.






Schoenwaelder & Bajpai     Expires May 4, 2016                 [Page 35]

Internet-Draft               LMAP Data Model               November 2015


Appendix B.  Non-editorial Changes since -01

   o  Updated and split examples (config vs state vs report).

   o  Refactored the definitions so that common definitions used by both
      the control and report data models are in the new module ietf-
      lmap-common.

   o  A report is submitted via an RPC operation instead of using a
      notification.

   o  The default execution mode is pipelined.

   o  Clarified which action consumes data in sequential, pipelines, and
      parallel execution mode.

   o  Added /lmap/agent/measurement-point, /lmap/agent/report-
      measurement-point, and /report/measurement-point to configure and
      report the measurement point.

   o  Turned /lmap/suppression into a list /lmap/suppressions/
      suppression that uses a start and stop event to define the
      beginning and end of a suppression period.

   o  Added controller-lost an controller-ok event choices to /lmap/
      events/event.

   o  Added a metrics-grouping to identify entries in a metric registry
      and associated roles.

   o  Added /lmap-state/schedules to report the status of schedules and
      their actions.  Refactored /lmap-state/tasks to only report the
      task capabilities.

Appendix C.  Non-editorial Changes since -00

   o  A task can now reference multiply registry entries.

   o  Schedules are triggered by Events instead of Timings; Timings are
      just one of many possible event sources.

   o  Actions feed into other Schedules (instead of Actions within other
      Schedules).

   o  Removed the notion of multiple task outputs.

   o  Support for sequential, parallel, and pipelined execution of
      Actions.



Schoenwaelder & Bajpai     Expires May 4, 2016                 [Page 36]

Internet-Draft               LMAP Data Model               November 2015


Appendix D.  Example Configuration (XML)


   <config xmlns="urn:ietf:params:xml:ns:netconf:base:1.0">
     <lmap xmlns="urn:ietf:params:xml:ns:yang:ietf-lmap-control">

       <agent>
         <agent-id>550e8400-e29b-41d4-a716-446655440000</agent-id>
         <device-id>urn:dev:mac:0024befffe804ff1</device-id>
         <group-id>wireless measurement at the north-pole</group-id>
         <report-agent-id>true</report-agent-id>
       </agent>

       <schedules>

         <schedule>
           <name>hourly-schedule</name>
           <event>hourly</event>
           <action>
             <name>icmp-latency-hourly</name>
             <task>icmp-latency-measurement</task>
             <destination>daily-schedule</destination>
           </action>
           <action>
             <name>udp-latency-weekdays-hourly</name>
             <task>udp-latency-measurement</task>
             <destination>daily-schedule</destination>
           </action>
           <execution-mode>sequential</execution-mode>
         </schedule>

         <schedule>
           <name>daily-schedule</name>
           <event>daily</event>
           <action>
             <name>report-daily</name>
             <task>lmap-reporting-task</task>
             <option>
               <name>channel</name>
               <value>http://collector.example.org/</value>
             </option>
           </action>
           <execution-mode>sequential</execution-mode>
         </schedule>

         <schedule>
           <name>immediate-schedule</name>
           <event>immediate</event>



Schoenwaelder & Bajpai     Expires May 4, 2016                 [Page 37]

Internet-Draft               LMAP Data Model               November 2015


           <action>
             <name>icmp-latency-immediate</name>
             <task>icmp-latency-measurement</task>
           </action>
           <action>
             <name>report-immediate</name>
             <task>lmap-reporting-task</task>
             <option>
               <name>channel</name>
               <value>http://collector.example.org/</value>
             </option>
           </action>
           <execution-mode>pipelined</execution-mode>
         </schedule>
       </schedules>

       <suppressions>
         <suppression>
           <name>controller-lost-suppression</name>
           <start>controller-lost</start>
           <end>controller-ok</end>
           <tag>*</tag>
         </suppression>
       </suppressions>

       <tasks>
         <task>
           <name>udp-latency-measurement</name>
           <metric>
             <uri>urn:....</uri>
             <role>source</role>
           </metric>
         </task>
         <task>
           <name>icmp-latency-measurement</name>
           <metric>
             <uri>urn:....</uri>
           </metric>
         </task>
         <task>
           <name>iperf-server</name>
           <program>/usr/bin/iperf</program>
           <option>
             <name>role</name>
             <value>server</value>
           </option>
           <suppress-by-default>false</suppress-by-default>
         </task>



Schoenwaelder & Bajpai     Expires May 4, 2016                 [Page 38]

Internet-Draft               LMAP Data Model               November 2015


         <task>
           <name>lmap-reporting-task</name>
           <program>/usr/bin/lmap-reporter</program>
         </task>
       </tasks>

       <events>
         <event>
           <name>hourly</name>
           <periodic>
             <interval>3600000</interval>
             <start>2014-09-01T17:44:00+02:00</start>
             <end>2015-09-30T00:00:00+02:00</end>
           </periodic>
         </event>
         <event>
           <name>daily</name>
           <calendar>
             <hour>4</hour>
           </calendar>
         </event>
         <event>
           <name>once-every-six-hours</name>
           <calendar>
             <hour>0</hour>
             <hour>6</hour>
             <hour>12</hour>
             <hour>18</hour>
             <minute>0</minute>
             <second>0</second>
             <end>2014-09-30T00:00:00+02:00</end>
           </calendar>
           <random-spread>21600000</random-spread>
         </event>
         <event>
           <name>immediate</name>
           <immediate/>
         </event>
         <event>
           <name>startup</name>
           <startup/>
           <random-spread>12345</random-spread>
         </event>
         <event>
           <name>controller-lost</name>
           <controller-lost/>
         </event>
         <event>



Schoenwaelder & Bajpai     Expires May 4, 2016                 [Page 39]

Internet-Draft               LMAP Data Model               November 2015


           <name>controller-ok</name>
           <controller-ok/>
         </event>
       </events>

     </lmap>
   </config>


Appendix E.  Example Configuration (JSON)


   {
     "ietf-lmap-control:lmap": {
       "agent": {
         "agent-id": "550e8400-e29b-41d4-a716-446655440000",
         "device-id": "urn:dev:mac:0024befffe804ff1",
         "group-id": "wireless measurement at the north-pole",
         "report-agent-id": true
       },
       "schedules": {
         "schedule": [
           {
             "name": "hourly-schedule",
             "event": "hourly",
             "action": [
               {
                 "name": "icmp-latency-hourly",
                 "task": "icmp-latency-measurement",
                 "destination": [
                   "daily-schedule"
                 ]
               },
               {
                 "name": "udp-latency-weekdays-hourly",
                 "task": "udp-latency-measurement",
                 "destination": [
                   "daily-schedule"
                 ]
               }
             ],
             "execution-mode": "sequential"
           },
           {
             "name": "daily-schedule",
             "event": "daily",
             "action": [
               {



Schoenwaelder & Bajpai     Expires May 4, 2016                 [Page 40]

Internet-Draft               LMAP Data Model               November 2015


                 "name": "report-daily",
                 "task": "lmap-reporting-task",
                 "option": [
                   {
                     "name": "channel",
                     "value": "http://collector.example.org/"
                   }
                 ]
               }
             ],
             "execution-mode": "sequential"
           },
           {
             "name": "immediate-schedule",
             "event": "immediate",
             "action": [
               {
                 "name": "icmp-latency-immediate",
                 "task": "icmp-latency-measurement"
               },
               {
                 "name": "report-immediate",
                 "task": "lmap-reporting-task",
                 "option": [
                   {
                     "name": "channel",
                     "value": "http://collector.example.org/"
                   }
                 ]
               }
             ],
             "execution-mode": "pipelined"
           }
         ]
       },
       "suppressions": {
         "suppression": [
           {
             "name": "controller-lost-suppression",
             "start": "controller-lost",
             "end": "controller-ok",
             "tag": [
               "*"
             ]
           }
         ]
       },
       "tasks": {



Schoenwaelder & Bajpai     Expires May 4, 2016                 [Page 41]

Internet-Draft               LMAP Data Model               November 2015


         "task": [
           {
             "name": "udp-latency-measurement",
             "metric": [
               {
                 "uri": "urn:....",
                 "role": [
                   "source"
                 ]
               }
             ]
           },
           {
             "name": "icmp-latency-measurement",
             "metric": [
               {
                 "uri": "urn:...."
               }
             ]
           },
           {
             "name": "iperf-server",
             "program": "/usr/bin/iperf",
             "option": [
               {
                 "name": "role",
                 "value": "server"
               }
             ],
             "suppress-by-default": false
           },
           {
             "name": "lmap-reporting-task",
             "program": "/usr/bin/lmap-reporter"
           }
         ]
       },
       "events": {
         "event": [
           {
             "name": "hourly",
             "periodic": {
               "interval": 3600000,
               "start": "2014-09-01T17:44:00+02:00",
               "end": "2015-09-30T00:00:00+02:00"
             }
           },
           {



Schoenwaelder & Bajpai     Expires May 4, 2016                 [Page 42]

Internet-Draft               LMAP Data Model               November 2015


             "name": "daily",
             "calendar": {
               "hour": [
                 4
               ]
             }
           },
           {
             "name": "once-every-six-hours",
             "calendar": {
               "hour": [
                 0,
                 6,
                 12,
                 18
               ],
               "minute": [
                 0
               ],
               "second": [
                 0
               ],
               "end": "2014-09-30T00:00:00+02:00"
             },
             "random-spread": 21600000
           },
           {
             "name": "immediate",
             "immediate": [null]
           },
           {
             "name": "startup",
             "startup": [null],
             "random-spread": 12345
           },
           {
             "name": "controller-lost",
             "controller-lost": [null]
           },
           {
             "name": "controller-ok",
             "controller-ok": [null]
           }
         ]
       }
     }
   }




Schoenwaelder & Bajpai     Expires May 4, 2016                 [Page 43]

Internet-Draft               LMAP Data Model               November 2015


Appendix F.  Example State (XML)


<data xmlns="urn:ietf:params:xml:ns:netconf:base:1.0">
  <lmap-state xmlns="urn:ietf:params:xml:ns:yang:ietf-lmap-control">

    <agent>
      <agent-id>550e8400-e29b-41d4-a716-446655440000</agent-id>
      <device-id>urn:dev:mac:0024befffe804ff1</device-id>
      <hardware>ACME home router</hardware>
      <firmware>OpenWrt version 10.03.1</firmware>
      <version>Measurement Agent Daemon (MAD) 4.2</version>
      <last-started>2015-04-10T17:24:42+02:00</last-started>
    </agent>

    <tasks>
      <task>
        <name>udp-latency-measurement</name>
        <metric>
          <uri>urn:....</uri>
          <role>source</role>
          <role>target</role>
        </metric>
      </task>

      <task>
        <name>icmp-latency-measurement</name>
        <metric>
          <uri>urn:....</uri>
        </metric>
      </task>

      <task>
        <name>iperf</name>
        <program>iperf</program>
      </task>

      <task>
        <name>lmap-reporting-task</name>
        <program>lmap-reportd</program>
      </task>
    </tasks>

    <schedules>
      <schedule>
        <name>hourly-schedule</name>
        <state>enabled</state>
        <last-invocation>2015-01-23T12:00:00+01:00</last-invocation>



Schoenwaelder & Bajpai     Expires May 4, 2016                 [Page 44]

Internet-Draft               LMAP Data Model               November 2015


        <action>
          <name>icmp-latency-hourly</name>
          <state>enabled</state>
          <last-invocation>2015-01-23T12:00:00+01:00</last-invocation>
          <last-completion>2015-01-23T12:00:01+01:00</last-completion>
          <last-status>0</last-status>
          <last-message>OK</last-message>
          <last-failed-completion>2015-01-23T03:00:00+01:00</last-failed-completion>
          <last-failed-status>42</last-failed-status>
          <last-failed-message>connection timed out</last-failed-message>
        </action>
        <action>
          <name>udp-latency-weekdays-hourly</name>
          <last-invocation>2015-01-23T12:00:01+01:00</last-invocation>
          <last-completion>2015-01-23T12:00:02+01:00</last-completion>
          <last-status>0</last-status>
          <last-message>OK</last-message>
          <last-failed-completion>2015-01-23T03:00:00+01:00</last-failed-completion>
          <last-failed-status>42</last-failed-status>
          <last-failed-message>connection timed out</last-failed-message>
        </action>
      </schedule>
    </schedules>
  </lmap-state>
</data>


Appendix G.  Example State (JSON)


   {
     "ietf-lmap-control:lmap-state": {
       "agent": {
         "agent-id": "550e8400-e29b-41d4-a716-446655440000",
         "device-id": "urn:dev:mac:0024befffe804ff1",
         "hardware": "ACME home router",
         "firmware": "OpenWrt version 10.03.1",
         "version": "Measurement Agent Daemon (MAD) 4.2",
         "last-started": "2015-04-10T17:24:42+02:00"
       },
       "tasks": {
         "task": [
           {
             "name": "udp-latency-measurement",
             "metric": [
               {
                 "uri": "urn:....",
                 "role": [



Schoenwaelder & Bajpai     Expires May 4, 2016                 [Page 45]

Internet-Draft               LMAP Data Model               November 2015


                   "source",
                   "target"
                 ]
               }
             ]
           },
           {
             "name": "icmp-latency-measurement",
             "metric": [
               {
                 "uri": "urn:...."
               }
             ]
           },
           {
             "name": "iperf",
             "program": "iperf"
           },
           {
             "name": "lmap-reporting-task",
             "program": "lmap-reportd"
           }
         ]
       },
       "schedules": {
         "schedule": [
           {
             "name": "hourly-schedule",
             "state": "enabled",
             "last-invocation": "2015-01-23T12:00:00+01:00",
             "action": [
               {
                 "name": "icmp-latency-hourly",
                 "state": "enabled",
                 "last-invocation": "2015-01-23T12:00:00+01:00",
                 "last-completion": "2015-01-23T12:00:01+01:00",
                 "last-status": 0,
                 "last-message": "OK",
                 "last-failed-completion": "2015-01-23T03:00:00+01:00",
                 "last-failed-status": 42,
                 "last-failed-message": "connection timed out"
               },
               {
                 "name": "udp-latency-weekdays-hourly",
                 "last-invocation": "2015-01-23T12:00:01+01:00",
                 "last-completion": "2015-01-23T12:00:02+01:00",
                 "last-status": 0,
                 "last-message": "OK",



Schoenwaelder & Bajpai     Expires May 4, 2016                 [Page 46]

Internet-Draft               LMAP Data Model               November 2015


                 "last-failed-completion": "2015-01-23T03:00:00+01:00",
                 "last-failed-status": 42,
                 "last-failed-message": "connection timed out"
               }
             ]
           }
         ]
       }
     }
   }


Appendix H.  Example Report (XML)


   <?xml version="1.0" encoding="utf-8"?>
   <rpc xmlns="urn:ietf:params:xml:ns:netconf:base:1.0"
        message-id="1">
     <report xmlns="urn:ietf:params:xml:ns:yang:ietf-lmap-report">
       <date>2015-10-28T13:27:42+02:00</date>
       <agent-id>550e8400-e29b-41d4-a716-446655440000</agent-id>
       <group-id>wireless measurement at the north-pole</group-id>
       <task>
         <name>icmp-latency-measurement</name>
         <!-- fping -A -d -C 5 -q www.ietf.org www.google.com -->
         <header>
           <column>target</column>
       <column>ip</column>
           <column>rtt-1</column>
           <column>rtt-2</column>
           <column>rtt-3</column>
           <column>rtt-4</column>
           <column>rtt-5</column>
         </header>
         <row>
           <start>2015-03-25T00:00:55+00:00</start>
       <value>www.ietf.org</value>
           <value>104.20.0.85</value>
           <value>14.15</value>
           <value>14.14</value>
           <value>14.09</value>
           <value>14.17</value>
           <value>14.51</value>
         </row>
         <row>
           <start>2015-03-25T00:00:56+00:00</start>
       <value>www.google.com</value>
           <value>216.58.213.36</value>



Schoenwaelder & Bajpai     Expires May 4, 2016                 [Page 47]

Internet-Draft               LMAP Data Model               November 2015


           <value>12.24</value>
       <value>11.99</value>
       <value>12.49</value>
       <value>11.87</value>
       <value>12.45</value>
         </row>
       </task>
       <task>
         <name>happy-dns-measurement</name>
         <!-- happy -m -a www.ietf.org www.google.com -->
         <header>
       <column>target</column>
       <column>ip</column>
       <column>name</column>
         </header>
         <row>
       <start>2015-03-25T00:00:56+00:00</start>
       <value>www.ietf.org</value>
       <value>2400:cb00:2048:1::6814:55</value>
       <value>www.ietf.org.cdn.cloudflare-dnssec.net</value>
         </row>
         <row>
       <start>2015-03-25T00:00:56+00:00</start>
       <value>www.ietf.org</value>
       <value>2400:cb00:2048:1::6814:155</value>
       <value>www.ietf.org.cdn.cloudflare-dnssec.net</value>
         </row>
         <row>
       <start>2015-03-25T00:00:56+00:00</start>
       <value>www.ietf.org</value>
       <value>104.20.1.85</value>
       <value>www.ietf.org.cdn.cloudflare-dnssec.net</value>
         </row>
         <row>
       <start>2015-03-25T00:00:56+00:00</start>
       <value>www.ietf.org</value>
       <value>104.20.0.85</value>
       <value>www.ietf.org.cdn.cloudflare-dnssec.net</value>
         </row>
         <row>
       <start>2015-03-25T00:00:56+00:00</start>
       <value>www.google.com</value>
       <value>2a00:1450:4008:800::1012</value>
       <!-- <value>www.google.com</value> xxx leaflist sucks -->
       <value>ber01s08-in-x12.1e100.net</value>
         </row>
         <row>
       <start>2015-03-25T00:00:56+00:00</start>



Schoenwaelder & Bajpai     Expires May 4, 2016                 [Page 48]

Internet-Draft               LMAP Data Model               November 2015


       <value>www.google.com</value>
       <value>216.58.213.36</value>
       <!-- <value>www.google.com</value> xxx leaflist sucks -->
       <value>ber01s15-in-f36.1e100.net</value>
         </row>
       </task>
       <task>
         <name>happy-connect-measurement</name>
         <!-- happy -m -a www.ietf.org www.google.com -->
         <header>
       <column>target</column>
       <column>port</column>
       <column>ip</column>
       <column>time-1</column>
       <column>time-2</column>
       <column>time-3</column>
         </header>
         <row>
       <start>2015-03-25T00:00:56+00:00</start>
       <value>www.ietf.org</value>
       <value>80</value>
       <value>2400:cb00:2048:1::6814:55</value>
       <value>8164</value>
       <value>8019</value>
       <value>14066</value>
         </row>
         <row>
       <start>2015-03-25T00:00:56+00:00</start>
       <value>www.ietf.org</value>
       <value>80</value>
       <value>2400:cb00:2048:1::6814:155</value>
       <value>14131</value>
       <value>14029</value>
       <value>7984</value>
         </row>
         <row>
       <start>2015-03-25T00:00:56+00:00</start>
       <value>www.ietf.org</value>
       <value>80</value>
       <value>104.20.1.85</value>
       <value>13821</value>
       <value>13736</value>
       <value>7995</value>
         </row>
         <row>
       <start>2015-03-25T00:00:56+00:00</start>
       <value>www.ietf.org</value>
       <value>80</value>



Schoenwaelder & Bajpai     Expires May 4, 2016                 [Page 49]

Internet-Draft               LMAP Data Model               November 2015


       <value>104.20.0.85</value>
       <value>14024</value>
       <value>13756</value>
       <value>8589</value>
         </row>
         <row>
       <start>2015-03-25T00:00:56+00:00</start>
       <value>www.google.com</value>
       <value>80</value>
       <value>2a00:1450:4008:800::1012</value>
       <value>19246</value>
       <value>19416</value>
       <value>19443</value>
         </row>
         <row>
       <start>2015-03-25T00:00:56+00:00</start>
       <value>www.google.com</value>
       <value>80</value>
       <value>216.58.213.36</value>
       <value>11692</value>
       <value>11668</value>
       <value>11933</value>
         </row>
       </task>
     </report>
   </rpc>


Appendix I.  Example Report (JSON)


   {
     "report": {
       "date": "2015-10-28T13:27:42+02:00",
       "agent-id": "550e8400-e29b-41d4-a716-446655440000",
       "group-id": "wireless measurement at the north-pole",
       "task": [
         {
           "name": "icmp-latency-measurement",
           "header": {
             "column": [
               "target",
               "ip",
               "rtt-1",
               "rtt-2",
               "rtt-3",
               "rtt-4",
               "rtt-5"



Schoenwaelder & Bajpai     Expires May 4, 2016                 [Page 50]

Internet-Draft               LMAP Data Model               November 2015


             ]
           },
           "row": [
             {
               "start": "2015-03-25T00:00:55+00:00",
               "value": [
                 "www.ietf.org",
                 "104.20.0.85",
                 "14.15",
                 "14.14",
                 "14.09",
                 "14.17",
                 "14.51"
               ]
             },
             {
               "start": "2015-03-25T00:00:56+00:00",
               "value": [
                 "www.google.com",
                 "216.58.213.36",
                 "12.24",
                 "11.99",
                 "12.49",
                 "11.87",
                 "12.45"
               ]
             }
           ]
         },
         {
           "name": "happy-dns-measurement",
           "header": {
             "column": [
               "target",
               "ip",
               "name"
             ]
           },
           "row": [
             {
               "start": "2015-03-25T00:00:56+00:00",
               "value": [
                 "www.ietf.org",
                 "2400:cb00:2048:1::6814:55",
                 "www.ietf.org.cdn.cloudflare-dnssec.net"
               ]
             },
             {



Schoenwaelder & Bajpai     Expires May 4, 2016                 [Page 51]

Internet-Draft               LMAP Data Model               November 2015


               "start": "2015-03-25T00:00:56+00:00",
               "value": [
                 "www.ietf.org",
                 "2400:cb00:2048:1::6814:155",
                 "www.ietf.org.cdn.cloudflare-dnssec.net"
               ]
             },
             {
               "start": "2015-03-25T00:00:56+00:00",
               "value": [
                 "www.ietf.org",
                 "104.20.1.85",
                 "www.ietf.org.cdn.cloudflare-dnssec.net"
               ]
             },
             {
               "start": "2015-03-25T00:00:56+00:00",
               "value": [
                 "www.ietf.org",
                 "104.20.0.85",
                 "www.ietf.org.cdn.cloudflare-dnssec.net"
               ]
             },
             {
               "start": "2015-03-25T00:00:56+00:00",
               "value": [
                 "www.google.com",
                 "2a00:1450:4008:800::1012",
                 "ber01s08-in-x12.1e100.net"
               ]
             },
             {
               "start": "2015-03-25T00:00:56+00:00",
               "value": [
                 "www.google.com",
                 "216.58.213.36",
                 "ber01s15-in-f36.1e100.net"
               ]
             }
           ]
         },
         {
           "name": "happy-connect-measurement",
           "header": {
             "column": [
               "target",
               "port",
               "ip",



Schoenwaelder & Bajpai     Expires May 4, 2016                 [Page 52]

Internet-Draft               LMAP Data Model               November 2015


               "time-1",
               "time-2",
               "time-3"
             ]
           },
           "row": [
             {
               "start": "2015-03-25T00:00:56+00:00",
               "value": [
                 "www.ietf.org",
                 "80",
                 "2400:cb00:2048:1::6814:55",
                 "8164",
                 "8019",
                 "14066"
               ]
             },
             {
               "start": "2015-03-25T00:00:56+00:00",
               "value": [
                 "www.ietf.org",
                 "80",
                 "2400:cb00:2048:1::6814:155",
                 "14131",
                 "14029",
                 "7984"
               ]
             },
             {
               "start": "2015-03-25T00:00:56+00:00",
               "value": [
                 "www.ietf.org",
                 "80",
                 "104.20.1.85",
                 "13821",
                 "13736",
                 "7995"
               ]
             },
             {
               "start": "2015-03-25T00:00:56+00:00",
               "value": [
                 "www.ietf.org",
                 "80",
                 "104.20.0.85",
                 "14024",
                 "13756",
                 "8589"



Schoenwaelder & Bajpai     Expires May 4, 2016                 [Page 53]

Internet-Draft               LMAP Data Model               November 2015


               ]
             },
             {
               "start": "2015-03-25T00:00:56+00:00",
               "value": [
                 "www.google.com",
                 "80",
                 "2a00:1450:4008:800::1012",
                 "19246",
                 "19416",
                 "19443"
               ]
             },
             {
               "start": "2015-03-25T00:00:56+00:00",
               "value": [
                 "www.google.com",
                 "80",
                 "216.58.213.36",
                 "11692",
                 "11668",
                 "11933"
               ]
             }
           ]
         }
       ]
     }
   }


Authors' Addresses

   Juergen Schoenwaelder
   Jacobs University Bremen

   Email: j.schoenwaelder@jacobs-university.de


   Vaibhav Bajpai
   Jacobs University Bremen

   Email: v.bajpai@jacobs-university.de








Schoenwaelder & Bajpai     Expires May 4, 2016                 [Page 54]
