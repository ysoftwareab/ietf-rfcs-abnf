<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>The OAuth 2.0 Authorization Protocol</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Roles">
<link href="#rfc.section.1.2" rel="Chapter" title="1.2 Protocol Flow">
<link href="#rfc.section.1.3" rel="Chapter" title="1.3 Access Token">
<link href="#rfc.section.1.4" rel="Chapter" title="1.4 Authorization Grant">
<link href="#rfc.section.1.4.1" rel="Chapter" title="1.4.1 Authorization Code">
<link href="#rfc.section.1.4.2" rel="Chapter" title="1.4.2 Implicit">
<link href="#rfc.section.1.4.3" rel="Chapter" title="1.4.3 Resource Owner Password Credentials">
<link href="#rfc.section.1.4.4" rel="Chapter" title="1.4.4 Client Credentials">
<link href="#rfc.section.1.4.5" rel="Chapter" title="1.4.5 Extensions">
<link href="#rfc.section.1.5" rel="Chapter" title="1.5 Refresh Token">
<link href="#rfc.section.1.6" rel="Chapter" title="1.6 Notational Conventions">
<link href="#rfc.section.2" rel="Chapter" title="2 Client Registration">
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 Client Types">
<link href="#rfc.section.2.2" rel="Chapter" title="2.2 Registration Requirements">
<link href="#rfc.section.2.3" rel="Chapter" title="2.3 Client Identifier">
<link href="#rfc.section.2.4" rel="Chapter" title="2.4 Client Authentication">
<link href="#rfc.section.2.4.1" rel="Chapter" title="2.4.1 Client Password">
<link href="#rfc.section.2.4.2" rel="Chapter" title="2.4.2 Other Authentication Methods">
<link href="#rfc.section.2.5" rel="Chapter" title="2.5 Unregistered Clients">
<link href="#rfc.section.3" rel="Chapter" title="3 Protocol Endpoints">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 Authorization Endpoint">
<link href="#rfc.section.3.1.1" rel="Chapter" title="3.1.1 Response Type">
<link href="#rfc.section.3.1.2" rel="Chapter" title="3.1.2 Redirection Endpoint">
<link href="#rfc.section.3.1.2.1" rel="Chapter" title="3.1.2.1 Endpoint Confidentiality">
<link href="#rfc.section.3.1.2.2" rel="Chapter" title="3.1.2.2 Registration Requirements">
<link href="#rfc.section.3.1.2.3" rel="Chapter" title="3.1.2.3 Dynamic Configuration">
<link href="#rfc.section.3.1.2.4" rel="Chapter" title="3.1.2.4 Invalid Endpoint">
<link href="#rfc.section.3.1.2.5" rel="Chapter" title="3.1.2.5 Endpoint Content">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 Token Endpoint">
<link href="#rfc.section.3.2.1" rel="Chapter" title="3.2.1 Client Authentication">
<link href="#rfc.section.4" rel="Chapter" title="4 Obtaining Authorization">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 Authorization Code">
<link href="#rfc.section.4.1.1" rel="Chapter" title="4.1.1 Authorization Request">
<link href="#rfc.section.4.1.2" rel="Chapter" title="4.1.2 Authorization Response">
<link href="#rfc.section.4.1.2.1" rel="Chapter" title="4.1.2.1 Error Response">
<link href="#rfc.section.4.1.3" rel="Chapter" title="4.1.3 Access Token Request">
<link href="#rfc.section.4.1.4" rel="Chapter" title="4.1.4 Access Token Response">
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 Implicit Grant">
<link href="#rfc.section.4.2.1" rel="Chapter" title="4.2.1 Authorization Request">
<link href="#rfc.section.4.2.2" rel="Chapter" title="4.2.2 Access Token Response">
<link href="#rfc.section.4.2.2.1" rel="Chapter" title="4.2.2.1 Error Response">
<link href="#rfc.section.4.3" rel="Chapter" title="4.3 Resource Owner Password Credentials">
<link href="#rfc.section.4.3.1" rel="Chapter" title="4.3.1 Authorization Request and Response">
<link href="#rfc.section.4.3.2" rel="Chapter" title="4.3.2 Access Token Request">
<link href="#rfc.section.4.3.3" rel="Chapter" title="4.3.3 Access Token Response">
<link href="#rfc.section.4.4" rel="Chapter" title="4.4 Client Credentials">
<link href="#rfc.section.4.4.1" rel="Chapter" title="4.4.1 Authorization Request and Response">
<link href="#rfc.section.4.4.2" rel="Chapter" title="4.4.2 Access Token Request">
<link href="#rfc.section.4.4.3" rel="Chapter" title="4.4.3 Access Token Response">
<link href="#rfc.section.4.5" rel="Chapter" title="4.5 Extensions">
<link href="#rfc.section.5" rel="Chapter" title="5 Issuing an Access Token">
<link href="#rfc.section.5.1" rel="Chapter" title="5.1 Successful Response">
<link href="#rfc.section.5.2" rel="Chapter" title="5.2 Error Response">
<link href="#rfc.section.6" rel="Chapter" title="6 Refreshing an Access Token">
<link href="#rfc.section.7" rel="Chapter" title="7 Accessing Protected Resources">
<link href="#rfc.section.7.1" rel="Chapter" title="7.1 Access Token Types">
<link href="#rfc.section.8" rel="Chapter" title="8 Extensibility">
<link href="#rfc.section.8.1" rel="Chapter" title="8.1 Defining Access Token Types">
<link href="#rfc.section.8.2" rel="Chapter" title="8.2 Defining New Endpoint Parameters">
<link href="#rfc.section.8.3" rel="Chapter" title="8.3 Defining New Authorization Grant Types">
<link href="#rfc.section.8.4" rel="Chapter" title="8.4 Defining New Authorization Endpoint Response Types">
<link href="#rfc.section.8.5" rel="Chapter" title="8.5 Defining Additional Error Codes">
<link href="#rfc.section.9" rel="Chapter" title="9 Native Applications">
<link href="#rfc.section.10" rel="Chapter" title="10 Security Considerations">
<link href="#rfc.section.10.1" rel="Chapter" title="10.1 Client Authentication">
<link href="#rfc.section.10.2" rel="Chapter" title="10.2 Client Impersonation">
<link href="#rfc.section.10.3" rel="Chapter" title="10.3 Access Tokens">
<link href="#rfc.section.10.4" rel="Chapter" title="10.4 Refresh Tokens">
<link href="#rfc.section.10.5" rel="Chapter" title="10.5 Authorization Codes">
<link href="#rfc.section.10.6" rel="Chapter" title="10.6 Authorization Code Leakage">
<link href="#rfc.section.10.7" rel="Chapter" title="10.7 Resource Owner Password Credentials">
<link href="#rfc.section.10.8" rel="Chapter" title="10.8 Request Confidentiality">
<link href="#rfc.section.10.9" rel="Chapter" title="10.9 Endpoints Authenticity">
<link href="#rfc.section.10.10" rel="Chapter" title="10.10 Credentials Guessing Attacks">
<link href="#rfc.section.10.11" rel="Chapter" title="10.11 Phishing Attacks">
<link href="#rfc.section.10.12" rel="Chapter" title="10.12 Cross-Site Request Forgery">
<link href="#rfc.section.10.13" rel="Chapter" title="10.13 Clickjacking">
<link href="#rfc.section.10.14" rel="Chapter" title="10.14 Code Injection and Input Validation">
<link href="#rfc.section.11" rel="Chapter" title="11 IANA Considerations">
<link href="#rfc.section.11.1" rel="Chapter" title="11.1 The OAuth Access Token Type Registry">
<link href="#rfc.section.11.1.1" rel="Chapter" title="11.1.1 Registration Template">
<link href="#rfc.section.11.2" rel="Chapter" title="11.2 The OAuth Parameters Registry">
<link href="#rfc.section.11.2.1" rel="Chapter" title="11.2.1 Registration Template">
<link href="#rfc.section.11.2.2" rel="Chapter" title="11.2.2 Initial Registry Contents">
<link href="#rfc.section.11.3" rel="Chapter" title="11.3 The OAuth Authorization Endpoint Response Type Registry">
<link href="#rfc.section.11.3.1" rel="Chapter" title="11.3.1 Registration Template">
<link href="#rfc.section.11.3.2" rel="Chapter" title="11.3.2 Initial Registry Contents">
<link href="#rfc.section.11.4" rel="Chapter" title="11.4 The OAuth Extensions Error Registry">
<link href="#rfc.section.11.4.1" rel="Chapter" title="11.4.1 Registration Template">
<link href="#rfc.section.12" rel="Chapter" title="12 Acknowledgements">
<link href="#rfc.references" rel="Chapter" title="13 References">
<link href="#rfc.references.1" rel="Chapter" title="13.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="13.2 Informative References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="The OAuth 2.0 authorization protocol enables a third-party application to obtain limited access to an HTTP service, either on behalf of a resource owner by orchestrating an approval interaction between the resource owner and the HTTP service, or by allowing the third-party application to obtain access on its own behalf.  " />
  <meta name="description" content="The OAuth 2.0 authorization protocol enables a third-party application to obtain limited access to an HTTP service, either on behalf of a resource owner by orchestrating an approval interaction between the resource owner and the HTTP service, or by allowing the third-party application to obtain access on its own behalf.  " />
  <meta name="keywords" content="" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Network Working Group</td>
<td class="right">E. Hammer-Lahav, Ed.</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Yahoo!</td>
</tr>
<tr>
<td class="left">Obsoletes: 5849 (if approved)</td>
<td class="right">D. Recordon</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">Facebook</td>
</tr>
<tr>
<td class="left">Expires: January 26, 2012</td>
<td class="right">D. Hardt</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Microsoft</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">July 25, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">The OAuth 2.0 Authorization Protocol<br />
  <span class="filename">draft-ietf-oauth-v2-19</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>The OAuth 2.0 authorization protocol enables a third-party application to obtain limited access to an HTTP service, either on behalf of a resource owner by orchestrating an approval interaction between the resource owner and the HTTP service, or by allowing the third-party application to obtain access on its own behalf.  </p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on January 26, 2012.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>1.1.   <a href="#rfc.section.1.1">Roles</a>
</li>
<li>1.2.   <a href="#rfc.section.1.2">Protocol Flow</a>
</li>
<li>1.3.   <a href="#rfc.section.1.3">Access Token</a>
</li>
<li>1.4.   <a href="#rfc.section.1.4">Authorization Grant</a>
</li>
<li>1.4.1.   <a href="#rfc.section.1.4.1">Authorization Code</a>
</li>
<li>1.4.2.   <a href="#rfc.section.1.4.2">Implicit</a>
</li>
<li>1.4.3.   <a href="#rfc.section.1.4.3">Resource Owner Password Credentials</a>
</li>
<li>1.4.4.   <a href="#rfc.section.1.4.4">Client Credentials</a>
</li>
<li>1.4.5.   <a href="#rfc.section.1.4.5">Extensions</a>
</li>
<li>1.5.   <a href="#rfc.section.1.5">Refresh Token</a>
</li>
<li>1.6.   <a href="#rfc.section.1.6">Notational Conventions</a>
</li>
<li>2.   <a href="#rfc.section.2">Client Registration</a>
</li>
<li>2.1.   <a href="#rfc.section.2.1">Client Types</a>
</li>
<li>2.2.   <a href="#rfc.section.2.2">Registration Requirements</a>
</li>
<li>2.3.   <a href="#rfc.section.2.3">Client Identifier</a>
</li>
<li>2.4.   <a href="#rfc.section.2.4">Client Authentication</a>
</li>
<li>2.4.1.   <a href="#rfc.section.2.4.1">Client Password</a>
</li>
<li>2.4.2.   <a href="#rfc.section.2.4.2">Other Authentication Methods</a>
</li>
<li>2.5.   <a href="#rfc.section.2.5">Unregistered Clients</a>
</li>
<li>3.   <a href="#rfc.section.3">Protocol Endpoints</a>
</li>
<li>3.1.   <a href="#rfc.section.3.1">Authorization Endpoint</a>
</li>
<li>3.1.1.   <a href="#rfc.section.3.1.1">Response Type</a>
</li>
<li>3.1.2.   <a href="#rfc.section.3.1.2">Redirection Endpoint</a>
</li>
<li>3.1.2.1.   <a href="#rfc.section.3.1.2.1">Endpoint Confidentiality</a>
</li>
<li>3.1.2.2.   <a href="#rfc.section.3.1.2.2">Registration Requirements</a>
</li>
<li>3.1.2.3.   <a href="#rfc.section.3.1.2.3">Dynamic Configuration</a>
</li>
<li>3.1.2.4.   <a href="#rfc.section.3.1.2.4">Invalid Endpoint</a>
</li>
<li>3.1.2.5.   <a href="#rfc.section.3.1.2.5">Endpoint Content</a>
</li>
<li>3.2.   <a href="#rfc.section.3.2">Token Endpoint</a>
</li>
<li>3.2.1.   <a href="#rfc.section.3.2.1">Client Authentication</a>
</li>
<li>4.   <a href="#rfc.section.4">Obtaining Authorization</a>
</li>
<li>4.1.   <a href="#rfc.section.4.1">Authorization Code</a>
</li>
<li>4.1.1.   <a href="#rfc.section.4.1.1">Authorization Request</a>
</li>
<li>4.1.2.   <a href="#rfc.section.4.1.2">Authorization Response</a>
</li>
<li>4.1.2.1.   <a href="#rfc.section.4.1.2.1">Error Response</a>
</li>
<li>4.1.3.   <a href="#rfc.section.4.1.3">Access Token Request</a>
</li>
<li>4.1.4.   <a href="#rfc.section.4.1.4">Access Token Response</a>
</li>
<li>4.2.   <a href="#rfc.section.4.2">Implicit Grant</a>
</li>
<li>4.2.1.   <a href="#rfc.section.4.2.1">Authorization Request</a>
</li>
<li>4.2.2.   <a href="#rfc.section.4.2.2">Access Token Response</a>
</li>
<li>4.2.2.1.   <a href="#rfc.section.4.2.2.1">Error Response</a>
</li>
<li>4.3.   <a href="#rfc.section.4.3">Resource Owner Password Credentials</a>
</li>
<li>4.3.1.   <a href="#rfc.section.4.3.1">Authorization Request and Response</a>
</li>
<li>4.3.2.   <a href="#rfc.section.4.3.2">Access Token Request</a>
</li>
<li>4.3.3.   <a href="#rfc.section.4.3.3">Access Token Response</a>
</li>
<li>4.4.   <a href="#rfc.section.4.4">Client Credentials</a>
</li>
<li>4.4.1.   <a href="#rfc.section.4.4.1">Authorization Request and Response</a>
</li>
<li>4.4.2.   <a href="#rfc.section.4.4.2">Access Token Request</a>
</li>
<li>4.4.3.   <a href="#rfc.section.4.4.3">Access Token Response</a>
</li>
<li>4.5.   <a href="#rfc.section.4.5">Extensions</a>
</li>
<li>5.   <a href="#rfc.section.5">Issuing an Access Token</a>
</li>
<li>5.1.   <a href="#rfc.section.5.1">Successful Response</a>
</li>
<li>5.2.   <a href="#rfc.section.5.2">Error Response</a>
</li>
<li>6.   <a href="#rfc.section.6">Refreshing an Access Token</a>
</li>
<li>7.   <a href="#rfc.section.7">Accessing Protected Resources</a>
</li>
<li>7.1.   <a href="#rfc.section.7.1">Access Token Types</a>
</li>
<li>8.   <a href="#rfc.section.8">Extensibility</a>
</li>
<li>8.1.   <a href="#rfc.section.8.1">Defining Access Token Types</a>
</li>
<li>8.2.   <a href="#rfc.section.8.2">Defining New Endpoint Parameters</a>
</li>
<li>8.3.   <a href="#rfc.section.8.3">Defining New Authorization Grant Types</a>
</li>
<li>8.4.   <a href="#rfc.section.8.4">Defining New Authorization Endpoint Response Types</a>
</li>
<li>8.5.   <a href="#rfc.section.8.5">Defining Additional Error Codes</a>
</li>
<li>9.   <a href="#rfc.section.9">Native Applications</a>
</li>
<li>10.   <a href="#rfc.section.10">Security Considerations</a>
</li>
<li>10.1.   <a href="#rfc.section.10.1">Client Authentication</a>
</li>
<li>10.2.   <a href="#rfc.section.10.2">Client Impersonation</a>
</li>
<li>10.3.   <a href="#rfc.section.10.3">Access Tokens</a>
</li>
<li>10.4.   <a href="#rfc.section.10.4">Refresh Tokens</a>
</li>
<li>10.5.   <a href="#rfc.section.10.5">Authorization Codes</a>
</li>
<li>10.6.   <a href="#rfc.section.10.6">Authorization Code Leakage</a>
</li>
<li>10.7.   <a href="#rfc.section.10.7">Resource Owner Password Credentials</a>
</li>
<li>10.8.   <a href="#rfc.section.10.8">Request Confidentiality</a>
</li>
<li>10.9.   <a href="#rfc.section.10.9">Endpoints Authenticity</a>
</li>
<li>10.10.   <a href="#rfc.section.10.10">Credentials Guessing Attacks</a>
</li>
<li>10.11.   <a href="#rfc.section.10.11">Phishing Attacks</a>
</li>
<li>10.12.   <a href="#rfc.section.10.12">Cross-Site Request Forgery</a>
</li>
<li>10.13.   <a href="#rfc.section.10.13">Clickjacking</a>
</li>
<li>10.14.   <a href="#rfc.section.10.14">Code Injection and Input Validation</a>
</li>
<li>11.   <a href="#rfc.section.11">IANA Considerations</a>
</li>
<li>11.1.   <a href="#rfc.section.11.1">The OAuth Access Token Type Registry</a>
</li>
<li>11.1.1.   <a href="#rfc.section.11.1.1">Registration Template</a>
</li>
<li>11.2.   <a href="#rfc.section.11.2">The OAuth Parameters Registry</a>
</li>
<li>11.2.1.   <a href="#rfc.section.11.2.1">Registration Template</a>
</li>
<li>11.2.2.   <a href="#rfc.section.11.2.2">Initial Registry Contents</a>
</li>
<li>11.3.   <a href="#rfc.section.11.3">The OAuth Authorization Endpoint Response Type Registry</a>
</li>
<li>11.3.1.   <a href="#rfc.section.11.3.1">Registration Template</a>
</li>
<li>11.3.2.   <a href="#rfc.section.11.3.2">Initial Registry Contents</a>
</li>
<li>11.4.   <a href="#rfc.section.11.4">The OAuth Extensions Error Registry</a>
</li>
<li>11.4.1.   <a href="#rfc.section.11.4.1">Registration Template</a>
</li>
<li>12.   <a href="#rfc.section.12">Acknowledgements</a>
</li>
<li>13.   <a href="#rfc.references">References</a>
</li>
<li>13.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>13.2.   <a href="#rfc.references.2">Informative References</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> Introduction</h1>
<p id="rfc.section.1.p.1">In the traditional client-server authentication model, the client accesses a protected resource on the server by authenticating with the server using the resource owner's credentials. In order to provide third-party applications access to protected resources, the resource owner shares its credentials with the third-party. This creates several problems and limitations: </p>
<p></p>

<ul>
<li>Third-party applications are required to store the resource owner's credentials for future use, typically a password in clear-text.  </li>
<li>Servers are required to support password authentication, despite the security weaknesses created by passwords.  </li>
<li>Third-party applications gain overly broad access to the resource owner's protected resources, leaving resource owners without any ability to restrict duration or access to a limited subset of resources.  </li>
<li>Resource owners cannot revoke access to an individual third-party without revoking access to all third-parties, and must do so by changing their password.  </li>
<li>Compromise of any third-party application results in compromise of the end-user&#8217;s password and all of the data protected by that password.  </li>
</ul>

<p> </p>
<p id="rfc.section.1.p.3">OAuth addresses these issues by introducing an authorization layer and separating the role of the client from that of the resource owner. In OAuth, the client requests access to resources controlled by the resource owner and hosted by the resource server, and is issued a different set of credentials than those of the resource owner.  </p>
<p id="rfc.section.1.p.4">Instead of using the resource owner's credentials to access protected resources, the client obtains an access token - a string denoting a specific scope, lifetime, and other access attributes. Access tokens are issued to third-party clients by an authorization server with the approval of the resource owner. The client uses the access token to access the protected resources hosted by the resource server.  </p>
<p id="rfc.section.1.p.5">For example, an end-user (resource owner) can grant a printing service (client) access to her protected photos stored at a photo sharing service (resource server), without sharing her username and password with the printing service. Instead, she authenticates directly with a server trusted by the photo sharing service (authorization server) which issues the printing service delegation-specific credentials (access token).  </p>
<p id="rfc.section.1.p.6">This specification is designed for use with HTTP <a href="#RFC2616">[RFC2616]</a>. The use of OAuth with any transport protocol other than HTTP is undefined.  </p>
<h1 id="rfc.section.1.1">
<a href="#rfc.section.1.1">1.1.</a> Roles</h1>
<p id="rfc.section.1.1.p.1">OAuth includes four roles working together to grant and provide access to protected resources - access restricted resources requiring authentication: </p>
<p></p>

<dl>
<dt>resource owner</dt>
<dd style="margin-left: 8">
<br> An entity capable of granting access to a protected resource (e.g. end-user).  </dd>
<dt>resource server</dt>
<dd style="margin-left: 8">
<br> The server hosting the protected resources, capable of accepting and responding to protected resource requests using access tokens.  </dd>
<dt>client</dt>
<dd style="margin-left: 8">
<br> An application making protected resource requests on behalf of the resource owner and with its authorization.  </dd>
<dt>authorization server</dt>
<dd style="margin-left: 8">
<br> The server issuing access tokens to the client after successfully authenticating the resource owner and obtaining authorization.  </dd>
</dl>

<p> </p>
<p id="rfc.section.1.1.p.3">The interaction between the authorization server and resource server is beyond the scope of this specification. The authorization server may be the same server as the resource server or a separate entity. A single authorization server may issue access tokens accepted by multiple resource servers.  </p>
<h1 id="rfc.section.1.2">
<a href="#rfc.section.1.2">1.2.</a> Protocol Flow</h1>
<div id="#rfc.figure.1"></div>
<div id="#Figure-1"></div>
<pre>
            
  +--------+                               +---------------+
  |        |--(A)- Authorization Request -&gt;|   Resource    |
  |        |                               |     Owner     |
  |        |&lt;-(B)-- Authorization Grant ---|               |
  |        |                               +---------------+
  |        |
  |        |                               +---------------+
  |        |--(C)-- Authorization Grant --&gt;| Authorization |
  | Client |                               |     Server    |
  |        |&lt;-(D)----- Access Token -------|               |
  |        |                               +---------------+
  |        |
  |        |                               +---------------+
  |        |--(E)----- Access Token ------&gt;|    Resource   |
  |        |                               |     Server    |
  |        |&lt;-(F)--- Protected Resource ---|               |
  +--------+                               +---------------+

          </pre>
<p id="rfc.section.1.2.p.1">The abstract flow illustrated in <a href="#Figure-1">Figure 1</a> describes the interaction between the four roles and includes the following steps: </p>
<p></p>

<dl>
<dt>(%C)</dt>
<dd>The client requests authorization from the resource owner. The authorization request can be made directly to the resource owner (as shown), or preferably indirectly via an intermediary such as an authorization server.  </dd>
<dt>(%C)</dt>
<dd>The client receives an authorization grant which represents the authorization provided by the resource owner. The authorization grant type depends on the method used by the client and supported by the authorization server to obtain it.  </dd>
<dt>(%C)</dt>
<dd>The client requests an access token by authenticating with the authorization server and presenting the authorization grant.  </dd>
<dt>(%C)</dt>
<dd>The authorization server authenticates the client and validates the authorization grant, and if valid issues an access token.  </dd>
<dt>(%C)</dt>
<dd>The client requests the protected resource from the resource server and authenticates by presenting the access token.  </dd>
<dt>(%C)</dt>
<dd>The resource server validates the access token, and if valid, serves the request.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.1.3">
<a href="#rfc.section.1.3">1.3.</a> Access Token</h1>
<p id="rfc.section.1.3.p.1">Access tokens are credentials used to access protected resources. An access token is a string representing an authorization issued to the client. The string is usually opaque to the client. Tokens represent specific scopes and durations of access, granted by the resource owner, and enforced by the resource server and authorization server.  </p>
<p id="rfc.section.1.3.p.2">The token may denote an identifier used to retrieve the authorization information, or self-contain the authorization information in a verifiable manner (i.e. a token string consisting of some data and a signature). Additional authentication credentials, which are beyond the scope of this specification, may be required in order for the client to use a token.  </p>
<p id="rfc.section.1.3.p.3">The access token provides an abstraction layer, replacing different authorization constructs (e.g. username and password) with a single token understood by the resource server. This abstraction enables issuing access tokens more restrictive than the authorization grant used to obtain them, as well as removing the resource server's need to understand a wide range of authentication methods.  </p>
<p id="rfc.section.1.3.p.4">Access tokens can have different formats, structures, and methods of utilization (e.g.  cryptographic properties) based on the resource server security requirements. Access token attributes and the methods used to access protected resources are beyond the scope of this specification and are defined by companion specifications.  </p>
<h1 id="rfc.section.1.4">
<a href="#rfc.section.1.4">1.4.</a> Authorization Grant</h1>
<p id="rfc.section.1.4.p.1">An authorization grant is a general term used to describe the intermediate credentials representing the resource owner authorization (to access its protected resources), and serves as an abstraction layer. An authorization grant is used by the client to obtain an access token.  </p>
<p id="rfc.section.1.4.p.2">This specification defines four grant types: authorization code, implicit, resource owner password credentials, and client credentials, as well as an extensibility mechanism for defining additional types.  </p>
<h1 id="rfc.section.1.4.1">
<a href="#rfc.section.1.4.1">1.4.1.</a> Authorization Code</h1>
<p id="rfc.section.1.4.1.p.1">The authorization code is obtained by using an authorization server as an intermediary between the client and resource owner. Instead of requesting authorization directly from the resource owner, the client directs the resource owner to an authorization server (via its user-agent as defined in <a href="#RFC2616">[RFC2616]</a>), which in turn directs the resource owner back to the client with the authorization code.  </p>
<p id="rfc.section.1.4.1.p.2">Before directing the resource owner back to the client with the authorization code, the authorization server authenticates the resource owner and obtains authorization.  Because the resource owner only authenticates with the authorization server, the resource owner's credentials are never shared with the client.  </p>
<p id="rfc.section.1.4.1.p.3">The authorization code provides a few important security benefits such as the ability to authenticate the client and issuing the access token directly to the client without potentially exposing it to others, including the resource owner.  </p>
<h1 id="rfc.section.1.4.2">
<a href="#rfc.section.1.4.2">1.4.2.</a> Implicit</h1>
<p id="rfc.section.1.4.2.p.1">The authorization grant is implicit when an access token is issued to the client directly as the result of the resource owner authorization, without using intermediate credentials (such as an authorization code).  </p>
<p id="rfc.section.1.4.2.p.2">When issuing an implicit grant, the authorization server does not authenticate the client and the client identity is verified via the redirection URI used to deliver the access token to the client. The access token may be exposed to the resource owner or other applications with access to the resource owner's user-agent.  </p>
<p id="rfc.section.1.4.2.p.3">Implicit grants improve the responsiveness and efficiency of some clients (such as a client implemented as an in-browser application) since it reduces the number of round trips required to obtain an access token. However, this convenience should be weighted against the security implications of using implicit grants, especially when the authorization code grant type is available.  </p>
<h1 id="rfc.section.1.4.3">
<a href="#rfc.section.1.4.3">1.4.3.</a> Resource Owner Password Credentials</h1>
<p id="rfc.section.1.4.3.p.1">The resource owner password credentials (e.g. a username and password) can be used directly as an authorization grant to obtain an access token. The credentials should only be used when there is a high degree of trust between the resource owner and the client (e.g. its device operating system or a highly privileged application), and when other authorization grant types are not available (such as an authorization code).  </p>
<p id="rfc.section.1.4.3.p.2">Even though this grant type requires direct client access to the resource owner credentials, the resource owner credentials are used for a single request and are exchanged for an access token. Unlike the HTTP Basic authentication scheme defined in <a href="#RFC2617">[RFC2617]</a>, this grant type (when combined with a refresh token) eliminates the need for the client to store the resource owner credentials for future use.  </p>
<h1 id="rfc.section.1.4.4">
<a href="#rfc.section.1.4.4">1.4.4.</a> Client Credentials</h1>
<p id="rfc.section.1.4.4.p.1">The client credentials (or other forms of client authentication) can be used as an authorization grant when the authorization scope is limited to the protected resources under the control of the client, or to protected resources previously arranged with the authorization server. Client credentials are used as an authorization grant typically when the client is acting on its own behalf (the client is also the resource owner).  </p>
<h1 id="rfc.section.1.4.5">
<a href="#rfc.section.1.4.5">1.4.5.</a> Extensions</h1>
<p id="rfc.section.1.4.5.p.1">Additional grant types may be defined to provide a bridge between OAuth and other protocols.  </p>
<h1 id="rfc.section.1.5">
<a href="#rfc.section.1.5">1.5.</a> Refresh Token</h1>
<p id="rfc.section.1.5.p.1">Refresh tokens are credentials used to obtain access tokens. Refresh tokens are issued to the client by the authorization server and are used to obtain a new access token when the current access token becomes invalid or expires, or to obtain additional access tokens with identical or narrower scope (access tokens may have a shorter lifetime and fewer permissions than authorized by the resource owner). Issuing a refresh token is optional and is included when issuing an access token.  </p>
<p id="rfc.section.1.5.p.2">A refresh token is a string representing the authorization granted to the client by the resource owner. The string is usually opaque to the client. The token denotes an identifier used to retrieve the authorization information. Unlike access tokens, refresh tokens are intended for use only with authorization servers and are never sent to resource servers.  </p>
<div id="#rfc.figure.2"></div>
<div id="#Figure-2"></div>
<pre>
            
  +--------+                                           +---------------+
  |        |--(A)------- Authorization Grant ---------&gt;|               |
  |        |                                           |               |
  |        |&lt;-(B)----------- Access Token -------------|               |
  |        |               &amp; Refresh Token             |               |
  |        |                                           |               |
  |        |                            +----------+   |               |
  |        |--(C)---- Access Token ----&gt;|          |   |               |
  |        |                            |          |   |               |
  |        |&lt;-(D)- Protected Resource --| Resource |   | Authorization |
  | Client |                            |  Server  |   |     Server    |
  |        |--(E)---- Access Token ----&gt;|          |   |               |
  |        |                            |          |   |               |
  |        |&lt;-(F)- Invalid Token Error -|          |   |               |
  |        |                            +----------+   |               |
  |        |                                           |               |
  |        |--(G)----------- Refresh Token -----------&gt;|               |
  |        |                                           |               |
  |        |&lt;-(H)----------- Access Token -------------|               |
  +--------+           &amp; Optional Refresh Token        +---------------+

          </pre>
<p id="rfc.section.1.5.p.3">The flow illustrated in <a href="#Figure-2">Figure 2</a> includes the following steps: </p>
<p></p>

<dl>
<dt>(%C)</dt>
<dd>The client requests an access token by authenticating with the authorization server, and presenting an authorization grant.  </dd>
<dt>(%C)</dt>
<dd>The authorization server authenticates the client and validates the authorization grant, and if valid issues an access token and a refresh token.  </dd>
<dt>(%C)</dt>
<dd>The client makes a protected resource requests to the resource server by presenting the access token.  </dd>
<dt>(%C)</dt>
<dd>The resource server validates the access token, and if valid, serves the request.  </dd>
<dt>(%C)</dt>
<dd>Steps (C) and (D) repeat until the access token expires. If the client knows the access token expired, it skips to step (G), otherwise it makes another protected resource request.  </dd>
<dt>(%C)</dt>
<dd>Since the access token is invalid, the resource server returns an invalid token error.  </dd>
<dt>(%C)</dt>
<dd>The client requests a new access token by authenticating with the authorization server and presenting the refresh token.  </dd>
<dt>(%C)</dt>
<dd>The authorization server authenticates the client and validates the refresh token, and if valid issues a new access token (and optionally, a new refresh token).  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.1.6">
<a href="#rfc.section.1.6">1.6.</a> Notational Conventions</h1>
<p id="rfc.section.1.6.p.1">The key words 'MUST', 'MUST NOT', 'REQUIRED', 'SHALL', 'SHALL NOT', 'SHOULD', 'SHOULD NOT', 'RECOMMENDED', 'MAY', and 'OPTIONAL' in this specification are to be interpreted as described in <a href="#RFC2119">[RFC2119]</a>.  </p>
<p id="rfc.section.1.6.p.2">This specification uses the Augmented Backus-Naur Form (ABNF) notation of <a href="#RFC5234">[RFC5234]</a>.  </p>
<p id="rfc.section.1.6.p.3">Certain security-related terms are to be understood in the sense defined in <a href="#RFC4949">[RFC4949]</a>. These terms include, but are not limited to, 'attack', 'authentication', 'authorization', 'certificate', 'confidentiality', 'credential', 'encryption', 'identity', 'sign', 'signature', 'trust', 'validate', and 'verify'.  </p>
<p id="rfc.section.1.6.p.4">Unless otherwise noted, all the protocol parameter names and values are case sensitive.  </p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> Client Registration</h1>
<p id="rfc.section.2.p.1">Before initiating the protocol, the client registers with the authorization server. The means through which the client registers with the authorization server are beyond the scope of this specification, but typically involve end-user interaction with an HTML registration form.  </p>
<p id="rfc.section.2.p.2">Client registration does not require a direct interaction between the client and the authorization server. When supported by the authorization server, registration can rely on other means for establishing trust and obtaining the required client properties (e.g.  redirection URI, client type). For example, registration can be accomplished using a self-issued or third-party-issued assertion, or by the authorization server performing client discovery using a trusted channel.  </p>
<h1 id="rfc.section.2.1">
<a href="#rfc.section.2.1">2.1.</a> <a href="#client-types" id="client-types">Client Types</a>
</h1>
<p id="rfc.section.2.1.p.1">OAuth defines two client types, based on their ability to authenticate securely with the authorization server (i.e. ability to maintain the confidentiality of their client credentials): </p>
<p></p>

<dl>
<dt>private</dt>
<dd style="margin-left: 8">
<br> Clients capable of maintaining the confidentiality of their credentials (e.g.  client implemented on a secure server with restricted access to the client credentials), or capable of secure client authentication using other means.  </dd>
<dt>public</dt>
<dd style="margin-left: 8">
<br> Clients incapable of maintaining the confidentiality of their credentials (e.g.  clients executing on the resource owner's device such as an installed native application or a user-agent-based application), and incapable of secure client authentication via any other mean.  </dd>
</dl>

<p> </p>
<p id="rfc.section.2.1.p.3">The client type designation is based on the authorization server's definition of secure authentication and its acceptable exposure levels of client credentials.  </p>
<p id="rfc.section.2.1.p.4">This specification has been designed around the following client profiles: </p>
<p></p>

<dl>
<dt>web application</dt>
<dd style="margin-left: 8">
<br> A web application is a private client running on a web server. Resource owners access the client via an HTML user interface rendered in a user-agent on the resource owner's device. The client credentials as well as any access token issued to the client are stored on the web server and are not exposed to or accessible by the resource owner.  </dd>
<dt>user-agent-based application</dt>
<dd style="margin-left: 8">
<br> A user-agent-based application is a public client in which the client code is downloaded from a web server and executes within a user-agent on the resource owner's device. Protocol data and credentials are easily accessible (and often visible) to the resource owner. Since such applications reside within the user-agent, they can make seamless use of the user-agent capabilities when requesting authorization.  </dd>
<dt>native application</dt>
<dd style="margin-left: 8">
<br> A native application is a public client installed and executed on the resource owner's device. Protocol data and credentials are accessible to the resource owner.  It is assumed that any client authentication credentials included in the application can be extracted. On the other hand, dynamically issued credentials such access tokens or refresh tokens, can receive an acceptable level of protection. At a minimum, these credentials are protected from hostile servers which the application may interact with. On some platform these credentials might be protected from other applications residing on the same device.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.2.2">
<a href="#rfc.section.2.2">2.2.</a> Registration Requirements</h1>
<p id="rfc.section.2.2.p.1">When registering a client, the client developer: </p>
<p></p>

<ul>
<li>specifies the client type as described in <a href="#client-types">Section 2.1</a>, </li>
<li>provides its client redirection URIs as described in <a href="#redirect-uri">Section 3.1.2</a>, and </li>
<li>includes any other information required by the authorization server (e.g. application name, website, description, logo image, the acceptance of legal terms).  </li>
</ul>

<p> </p>
<h1 id="rfc.section.2.3">
<a href="#rfc.section.2.3">2.3.</a> <a href="#client-identifier" id="client-identifier">Client Identifier</a>
</h1>
<p id="rfc.section.2.3.p.1">The authorization server issues the registered client a client identifier - a unique string representing the registration information provided by the client. The client identifier is not a secret, it is exposed to the resource owner, and cannot be used alone for client authentication.  </p>
<h1 id="rfc.section.2.4">
<a href="#rfc.section.2.4">2.4.</a> <a href="#client-authentication" id="client-authentication">Client Authentication</a>
</h1>
<p id="rfc.section.2.4.p.1">If the client type is private, the client and authorization server establish a client authentication method suitable for the security requirements of the authorization server.  The authorization server MAY accept any form of client authentication meeting its security requirements.  </p>
<p id="rfc.section.2.4.p.2">Private clients are typically issued (or establish) a set of client credentials used for authenticating with the authorization server (e.g. password, public/private key pair).  </p>
<p id="rfc.section.2.4.p.3">The authorization server SHOULD NOT make assumptions about the client type or accept the type information provided without establishing trust with the client or its developer.  The authorization server MAY establish a client authentication method with public clients. However, the authorization server MUST NOT rely on public client authentication for the purpose of identifying the client.  </p>
<p id="rfc.section.2.4.p.4">The client MUST NOT use more than one authentication method in each request.  </p>
<h1 id="rfc.section.2.4.1">
<a href="#rfc.section.2.4.1">2.4.1.</a> Client Password</h1>
<p id="rfc.section.2.4.1.p.1">Clients in possession of a client password MAY use the HTTP Basic authentication scheme as defined in <a href="#RFC2617">[RFC2617]</a> to authenticate with the authorization server.  The client identifier is used as the username, and the client password is used as the password.  </p>
<div id="#rfc.figure.3"></div>
<p>For example (extra line breaks are for display purposes only): </p>
<pre>
              
  Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW

            </pre>
<p id="rfc.section.2.4.1.p.2">Alternatively, the authorization server MAY allow including the client credentials in the request body using the following parameters: </p>
<p></p>

<dl>
<dt>client_id</dt>
<dd style="margin-left: 6">
<br> REQUIRED. The client identifier issued to the client during the registration process described by <a href="#client-identifier">Section 2.3</a>.  </dd>
<dt>client_secret</dt>
<dd style="margin-left: 6">
<br> REQUIRED. The client secret.  </dd>
</dl>

<p> </p>
<p id="rfc.section.2.4.1.p.4">Including the client credentials in the request body using the two parameters is NOT RECOMMENDED, and should be limited to clients unable to directly utilize the HTTP Basic authentication scheme (or other password-based HTTP authentication schemes).  </p>
<div id="#rfc.figure.4"></div>
<p>For example, requesting to refresh an access token (<a href="#token-refresh">Section 6</a>) using the body parameters (extra line breaks are for display purposes only): </p>
<pre>
              
  POST /token HTTP/1.1
  Host: server.example.com
  Content-Type: application/x-www-form-urlencoded;charset=UTF-8

  grant_type=refresh_token&amp;refresh_token=tGzv3JOkF0XG5Qx2TlKWIA
  &amp;client_id=s6BhdRkqt3&amp;client_secret=7Fjfp0ZBr1KtDRbnfVdmIw

            </pre>
<p id="rfc.section.2.4.1.p.5">The authorization server MUST require the use of a transport-layer security mechanism when sending requests to the token endpoint, as requests using this authentication method result in the transmission of clear-text credentials.  </p>
<h1 id="rfc.section.2.4.2">
<a href="#rfc.section.2.4.2">2.4.2.</a> Other Authentication Methods</h1>
<p id="rfc.section.2.4.2.p.1">The authorization server MAY support any suitable HTTP authentication scheme matching its security requirements. When using other authentication methods, the authorization server MUST define a mapping between the client identifier (registration record) and authentication scheme.  </p>
<h1 id="rfc.section.2.5">
<a href="#rfc.section.2.5">2.5.</a> Unregistered Clients</h1>
<p id="rfc.section.2.5.p.1">This specification does not exclude the use of unregistered clients. However, the use with such clients is beyond the scope of this specification, and requires additional security analysis and review of its interoperability impact.  </p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> Protocol Endpoints</h1>
<p id="rfc.section.3.p.1">The authorization process utilizes two endpoints (HTTP resources): </p>
<p></p>

<ul>
<li>Authorization endpoint - used to obtain authorization from the resource owner via user-agent redirection.  </li>
<li>Token endpoint - used to exchange an authorization grant for an access token, typically with client authentication.  </li>
</ul>

<p> </p>
<p id="rfc.section.3.p.3">Not every authorization grant type utilizes both endpoints. Extension grant types MAY define additional endpoints as needed.  </p>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> Authorization Endpoint</h1>
<p id="rfc.section.3.1.p.1">The authorization endpoint is used to interact with the resource owner and obtain authorization which is expressed explicitly as an authorization code (later exchanged for an access token), or implicitly by direct issuance of an access token.  </p>
<p id="rfc.section.3.1.p.2">The authorization server MUST first verify the identity of the resource owner. The way in which the authorization server authenticates the resource owner (e.g. username and password login, session cookies) is beyond the scope of this specification.  </p>
<p id="rfc.section.3.1.p.3">The means through which the client obtains the location of the authorization endpoint are beyond the scope of this specification but the location is typically provided in the service documentation. The endpoint URI MAY include a query component as defined by <a href="#RFC3986">[RFC3986]</a> section 3, which MUST be retained when adding additional query parameters. The endpoint URI MUST NOT include a fragment component.  </p>
<p id="rfc.section.3.1.p.4">Since requests to the authorization endpoint result in user authentication and the transmission of clear-text credentials (in the HTTP response), the authorization server MUST require the use of a transport-layer security mechanism when sending requests to the authorization endpoint. The authorization server MUST support TLS 1.2 as defined in <a href="#RFC5246">[RFC5246]</a>, and MAY support additional transport-layer mechanisms meeting its security requirements.  </p>
<p id="rfc.section.3.1.p.5">The authorization server MUST support the use of the HTTP <samp>GET</samp> method <a href="#RFC2616">[RFC2616]</a> for the authorization endpoint, and MAY support the use of the <samp>POST</samp> method as well.  </p>
<p id="rfc.section.3.1.p.6">Parameters sent without a value MUST be treated as if they were omitted from the request.  The authorization server SHOULD ignore unrecognized request parameters. Request and response parameters MUST NOT be included more than once.  </p>
<h1 id="rfc.section.3.1.1">
<a href="#rfc.section.3.1.1">3.1.1.</a> Response Type</h1>
<p id="rfc.section.3.1.1.p.1">The authorization endpoint is used by the authorization code grant type and implicit grant type flows. The client informs the authorization server of the desired grant type using the following parameter: </p>
<p></p>

<dl>
<dt>response_type</dt>
<dd style="margin-left: 6">
<br> REQUIRED. The value MUST be one of <samp>code</samp> for requesting an authorization code as described by <a href="#code-authz-req">Section 4.1.1</a>, <samp>token</samp> for requesting an access token (implicit grant) as described by <a href="#implicit-authz-req">Section 4.2.1</a>, or a registered extension value as described by <a href="#response-type-ext">Section 8.4</a>. If the response type contains one or more space characters (%x20), it is interpreted as a space-delimited list of values, where the order of values does not matter (e.g.  <samp>a b</samp> is the same as <samp>b a</samp>).  </dd>
</dl>

<p> </p>
<p id="rfc.section.3.1.1.p.3">If an authorization request is missing the <samp>response_type</samp> parameter, the authorization server SHOULD return an error response as described in <a href="#code-authz-error">Section 4.1.2.1</a>.  </p>
<h1 id="rfc.section.3.1.2">
<a href="#rfc.section.3.1.2">3.1.2.</a> <a href="#redirect-uri" id="redirect-uri">Redirection Endpoint</a>
</h1>
<p id="rfc.section.3.1.2.p.1">After completing its interaction with the resource owner, the authorization server directs the resource owner's user-agent back to the client. The authorization server redirects the user-agent to the client's redirection endpoint previously established with the authorization server during the client registration process or when initiating the authorization request.  </p>
<p id="rfc.section.3.1.2.p.2">The redirection endpoint URI MUST be an absolute URI as defined by <a href="#RFC3986">[RFC3986]</a> section 4.3, MAY include a query component which MUST be retained by the authorization server when adding additional query parameters, and MUST NOT include a fragment component.  </p>
<h1 id="rfc.section.3.1.2.1">
<a href="#rfc.section.3.1.2.1">3.1.2.1.</a> Endpoint Confidentiality</h1>
<p id="rfc.section.3.1.2.1.p.1">If a redirection request will result in the transmission of an authorization code or access token over an open network (between the resource owner's user-agent and the client), the client SHOULD require the use of a transport-layer security mechanism.  </p>
<p id="rfc.section.3.1.2.1.p.2">Lack of transport-layer security can have a severe impact on the security of the client and the protected resources it is authorized to access. The use of transport-layer security is particularly critical when the authorization process is used as a form of delegated end-user authentication by the client (e.g. third-party sign-in service).  </p>
<h1 id="rfc.section.3.1.2.2">
<a href="#rfc.section.3.1.2.2">3.1.2.2.</a> Registration Requirements</h1>
<p id="rfc.section.3.1.2.2.p.1">The authorization server MUST require public clients to register their redirection URI, MUST require all clients to register their redirection URI prior to utilizing the implicit grant type, and SHOULD require all clients to register their redirection URI prior to utilizing the authorization code grant type.  </p>
<p id="rfc.section.3.1.2.2.p.2">The authorization server SHOULD require the client to provide the complete redirection URI (the client MAY use the <samp>state</samp> request parameter to achieve per-request customization). The authorization server MAY allow the client to register multiple redirection URIs. If requiring the registration of the complete redirection URI is not possible, the authorization server SHOULD require the registration of the URI scheme, authority, and path.  </p>
<h1 id="rfc.section.3.1.2.3">
<a href="#rfc.section.3.1.2.3">3.1.2.3.</a> Dynamic Configuration</h1>
<p id="rfc.section.3.1.2.3.p.1">If multiple redirection URIs have been registered, if only part of the redirection URI has been registered, or if no redirection URI has been registered, the client MUST include a redirection URI with the authorization request using the <samp>redirect_uri</samp> request parameter.  </p>
<p id="rfc.section.3.1.2.3.p.2">When a redirection URI is included in an authorization request, the authorization server MUST compare and match the value received against at least one of the registered redirection URIs (or URI components) as defined in <a href="#RFC3986">[RFC3986]</a> section 6, if any redirection URIs were registered.  </p>
<p id="rfc.section.3.1.2.3.p.3">If the authorization server allows the client to dynamically change the query component of the redirection URI, the client MUST ensure that manipulation of the query component by an attacker cannot lead to an abuse of the redirection endpoint as an open redirector.  </p>
<h1 id="rfc.section.3.1.2.4">
<a href="#rfc.section.3.1.2.4">3.1.2.4.</a> Invalid Endpoint</h1>
<p id="rfc.section.3.1.2.4.p.1">If an authorization request fails validation due to a missing, invalid, or mismatching redirection URI, the authorization server SHOULD inform the resource owner of the error, and MUST NOT automatically redirect the user-agent to the invalid redirection URI.  </p>
<p id="rfc.section.3.1.2.4.p.2">The authorization server SHOULD NOT redirect the user-agent to unregistered or untrusted URIs to prevent the authorization endpoint from being used as an open redirector.  </p>
<h1 id="rfc.section.3.1.2.5">
<a href="#rfc.section.3.1.2.5">3.1.2.5.</a> Endpoint Content</h1>
<p id="rfc.section.3.1.2.5.p.1">The redirection request to the client's endpoint typically results in an HTML document response, processed by the user-agent. If the HTML response is served directly as the result of the redirection request, any script included in the HTML document will execute with full access to the redirection URI and the credentials it contains.  </p>
<p id="rfc.section.3.1.2.5.p.2">The client SHOULD NOT include any third-party scripts in the redirection endpoint response. Instead, it should extract the credentials from the URI and redirect the user-agent again to another endpoint without the credentials in the URI.  </p>
<p id="rfc.section.3.1.2.5.p.3">The client MUST NOT include any untrusted third-party scripts in the redirection endpoint response (e.g. third-party analytics, social plug-ins, ad networks) without first ensuring that its own scripts used to extract and remove the credentials from the URI will execute first.  </p>
<h1 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> Token Endpoint</h1>
<p id="rfc.section.3.2.p.1">The token endpoint is used by the client to obtain an access token by presenting its authorization grant or refresh token. The token endpoint is used with every authorization grant except for the implicit grant type (since an access token is issued directly).  </p>
<p id="rfc.section.3.2.p.2">The means through which the client obtains the location of the token endpoint are beyond the scope of this specification but is typically provided in the service documentation. The endpoint URI MAY include a query component, which MUST be retained when adding additional query parameters.  </p>
<p id="rfc.section.3.2.p.3">Since requests to the token endpoint result in the transmission of clear-text credentials (in the HTTP request and response), the authorization server MUST require the use of a transport-layer security mechanism when sending requests to the token endpoint. The authorization server MUST support TLS 1.2 as defined in <a href="#RFC5246">[RFC5246]</a>, and MAY support additional transport-layer mechanisms meeting its security requirements.  </p>
<p id="rfc.section.3.2.p.4">The client MUST use the HTTP <samp>POST</samp> method when making access token requests.  </p>
<p id="rfc.section.3.2.p.5">Parameters sent without a value MUST be treated as if they were omitted from the request.  The authorization server SHOULD ignore unrecognized request parameters. Request and response parameters MUST NOT be included more than once.  </p>
<h1 id="rfc.section.3.2.1">
<a href="#rfc.section.3.2.1">3.2.1.</a> <a href="#token-endpoint-auth" id="token-endpoint-auth">Client Authentication</a>
</h1>
<p id="rfc.section.3.2.1.p.1">Private clients, clients issued client credentials, or clients assigned other authentication requirements, MUST authenticate with the authorization server as described in <a href="#client-authentication">Section 2.4</a> when making requests to the token endpoint. Client authentication is used for: </p>
<p></p>

<ul>
<li>Enforcing the binding of refresh tokens and authorization codes to the client they are issued. Client authentication is critical when an authorization code is transmitted to the redirection endpoint over an insecure channel, or when the redirection URI has not been registered in full.  </li>
<li>Recovery from a compromised client by disabling the client or changing its credentials, by preventing an attacker from abusing stolen refresh tokens. Changing a single set of client credentials is significantly faster than revoking an entire set of refresh tokens.  </li>
<li>Implementing authentication management best practices which require periodic credentials rotation. Rotation of an entire set of refresh tokens can be challenging, while rotation of a single set of client credentials is significantly easier.  </li>
</ul>

<p> </p>
<p id="rfc.section.3.2.1.p.3">The security ramifications of allowing unauthenticated access by public clients to the token endpoint MUST be considered, as well as the issuance of refresh tokens to public clients, their scope, and lifetime.  </p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> Obtaining Authorization</h1>
<p id="rfc.section.4.p.1">To request an access token, the client obtains authorization from the resource owner. The authorization is expressed in the form of an authorization grant which the client uses to request the access token. OAuth defines four grant types: authorization code, implicit, resource owner password credentials, and client credentials. It also provides an extension mechanism for defining additional grant types.  </p>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> <a href="#grant-code" id="grant-code">Authorization Code</a>
</h1>
<p id="rfc.section.4.1.p.1">The authorization code grant type is used to obtain both access tokens and refresh tokens and is optimized for private clients. As a redirection-based flow, the client must be capable of interacting with the resource owner's user-agent (typically a web browser) and capable of receiving incoming requests (via redirection) from the authorization server.  </p>
<div id="#rfc.figure.5"></div>
<div id="#Figure-3"></div>
<pre>
            
  +----------+
  | resource |
  |   owner  |
  |          |
  +----------+
       ^
       |
      (B)      
  +----|-----+          Client Identifier      +---------------+
  |         -+----(A)-- &amp; Redirection URI ----&gt;|               |
  |  User-   |                                 | Authorization |
  |  Agent  -+----(B)-- User authenticates ---&gt;|     Server    |
  |          |                                 |               |
  |         -+----(C)-- Authorization Code ---&lt;|               |
  +-|----|---+                                 +---------------+
    |    |                                         ^      v
   (A)  (C)                                        |      |
    |    |                                         |      |
    ^    v                                         |      |
  +---------+                                      |      |
  |         |&gt;---(D)-- Authorization Code ---------'      |
  |  Client |          &amp; Redirection URI                  |
  |         |                                             |
  |         |&lt;---(E)----- Access Token -------------------'
  +---------+       (w/ Optional Refresh Token)

          </pre>
<p id="rfc.section.4.1.p.2">The flow illustrated in <a href="#Figure-3">Figure 5</a> includes the following steps: </p>
<p></p>

<dl>
<dt>(%C)</dt>
<dd>The client initiates the flow by directing the resource owner's user-agent to the authorization endpoint. The client includes its client identifier, requested scope, local state, and a redirection URI to which the authorization server will send the user-agent back once access is granted (or denied).  </dd>
<dt>(%C)</dt>
<dd>The authorization server authenticates the resource owner (via the user-agent) and establishes whether the resource owner grants or denies the client's access request.  </dd>
<dt>(%C)</dt>
<dd>Assuming the resource owner grants access, the authorization server redirects the user-agent back to the client using the redirection URI provided earlier. The redirection URI includes an authorization code and any local state provided by the client earlier.  </dd>
<dt>(%C)</dt>
<dd>The client requests an access token from the authorization server's token endpoint by including the authorization code received in the previous step. When making the request, the client authenticates with the authorization server. The client includes the redirection URI used to obtain the authorization code for verification.  </dd>
<dt>(%C)</dt>
<dd>The authorization server authenticates the client, validates the authorization code, and ensures the redirection URI received matches the URI used to redirect the client in step (C). If valid, responds back with an access token.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.4.1.1">
<a href="#rfc.section.4.1.1">4.1.1.</a> <a href="#code-authz-req" id="code-authz-req">Authorization Request</a>
</h1>
<p id="rfc.section.4.1.1.p.1">The client constructs the request URI by adding the following parameters to the query component of the authorization endpoint URI using the <samp>application/x-www-form-urlencoded</samp> format as defined by <a href="#W3C.REC-html401-19991224">[W3C.REC-html401-19991224]</a>: </p>
<p></p>

<dl>
<dt>response_type</dt>
<dd style="margin-left: 6">
<br> REQUIRED. Value MUST be set to <samp>code</samp>.  </dd>
<dt>client_id</dt>
<dd style="margin-left: 6">
<br> REQUIRED. The client identifier as described in <a href="#client-identifier">Section 2.3</a>.  </dd>
<dt>redirect_uri</dt>
<dd style="margin-left: 6">
<br> OPTIONAL, as described in <a href="#redirect-uri">Section 3.1.2</a>.  </dd>
<dt>scope</dt>
<dd style="margin-left: 6">
<br> OPTIONAL. The scope of the access request expressed as a list of space-delimited, case sensitive strings. The value is defined by the authorization server. If the value contains multiple space-delimited strings, their order does not matter, and each string adds an additional access range to the requested scope.  </dd>
<dt>state</dt>
<dd style="margin-left: 6">
<br> OPTIONAL. An opaque value used by the client to maintain state between the request and callback. The authorization server includes this value when redirecting the user-agent back to the client.  </dd>
</dl>

<p> </p>
<p id="rfc.section.4.1.1.p.3">The client directs the resource owner to the constructed URI using an HTTP redirection response, or by other means available to it via the user-agent.  </p>
<div id="#rfc.figure.6"></div>
<p>For example, the client directs the user-agent to make the following HTTP request using transport-layer security (extra line breaks are for display purposes only): </p>
<pre>
              
  GET /authorize?response_type=code&amp;client_id=s6BhdRkqt3&amp;state=xyz
      &amp;redirect_uri=https%3A%2F%2Fclient%2Eexample%2Ecom%2Fcb HTTP/1.1
  Host: server.example.com

            </pre>
<p id="rfc.section.4.1.1.p.4">The authorization server validates the request to ensure all required parameters are present and valid. If the request is valid, the authorization server authenticates the resource owner and obtains an authorization decision (by asking the resource owner or by establishing approval via other means).  </p>
<p id="rfc.section.4.1.1.p.5">When a decision is established, the authorization server directs the user-agent to the provided client redirection URI using an HTTP redirection response, or by other means available to it via the user-agent.  </p>
<h1 id="rfc.section.4.1.2">
<a href="#rfc.section.4.1.2">4.1.2.</a> Authorization Response</h1>
<p id="rfc.section.4.1.2.p.1">If the resource owner grants the access request, the authorization server issues an authorization code and delivers it to the client by adding the following parameters to the query component of the redirection URI using the <samp>application/x-www-form-urlencoded</samp> format: </p>
<p></p>

<dl>
<dt>code</dt>
<dd style="margin-left: 6">
<br> REQUIRED. The authorization code generated by the authorization server. The authorization code MUST expire shortly after it is issued to mitigate the risk of leaks. A maximum authorization code lifetime of 10 minutes is RECOMMENDED. The client MUST NOT reuse the authorization code. If an authorization code is used more than once, the authorization server SHOULD attempt to revoke all tokens previously issued based on that authorization code. The authorization code is bound to the client identifier and redirection URI.  </dd>
<dt>state</dt>
<dd style="margin-left: 6">
<br> REQUIRED if the <samp>state</samp> parameter was present in the client authorization request. Set to the exact value received from the client.  </dd>
</dl>

<p> </p>
<div id="#rfc.figure.7"></div>
<p>For example, the authorization server redirects the user-agent by sending the following HTTP response: </p>
<pre>
              
  HTTP/1.1 302 Found
  Location: https://client.example.com/cb?code=SplxlOBeZQQYbYS6WxSbIA
            &amp;state=xyz

            </pre>
<p id="rfc.section.4.1.2.p.3">The client SHOULD ignore unrecognized response parameters. The authorization code string size is left undefined by this specification. The client should avoid making assumptions about code value sizes. The authorization server should document the size of any value it issues.  </p>
<h1 id="rfc.section.4.1.2.1">
<a href="#rfc.section.4.1.2.1">4.1.2.1.</a> <a href="#code-authz-error" id="code-authz-error">Error Response</a>
</h1>
<p id="rfc.section.4.1.2.1.p.1">If the request fails due to a missing, invalid, or mismatching redirection URI, or if the client identifier provided is invalid, the authorization server SHOULD inform the resource owner of the error, and MUST NOT automatically redirect the user-agent to the invalid redirection URI.  </p>
<p id="rfc.section.4.1.2.1.p.2">If the resource owner denies the access request or if the request fails for reasons other than a missing or invalid redirection URI, the authorization server informs the client by adding the following parameters to the query component of the redirection URI using the <samp>application/x-www-form-urlencoded</samp> format: </p>
<p></p>

<dl>
<dt>error</dt>
<dd style="margin-left: 6">
<br> REQUIRED. A single error code from the following: <dl>
<dt>invalid_request</dt>
<dd style="margin-left: 6">
<br> The request is missing a required parameter, includes an unsupported parameter or parameter value, or is otherwise malformed.  </dd>
<dt>unauthorized_client</dt>
<dd style="margin-left: 6">
<br> The client is not authorized to request an authorization code using this method.  </dd>
<dt>access_denied</dt>
<dd style="margin-left: 6">
<br> The resource owner or authorization server denied the request.  </dd>
<dt>unsupported_response_type</dt>
<dd style="margin-left: 6">
<br> The authorization server does not support obtaining an authorization code using this method.  </dd>
<dt>invalid_scope</dt>
<dd style="margin-left: 6">
<br> The requested scope is invalid, unknown, or malformed.  </dd>
<dt>server_error</dt>
<dd style="margin-left: 6">
<br> The authorization server encountered an unexpected condition which prevented it from fulfilling the request.  </dd>
<dt>temporarily_unavailable</dt>
<dd style="margin-left: 6">
<br> The authorization server is currently unable to handle the request due to a temporary overloading or maintenance of the server.  </dd>
</dl>
<p> </p>
</dd>
<dt>error_description</dt>
<dd style="margin-left: 6">
<br> OPTIONAL. A human-readable UTF-8 encoded text providing additional information, used to assist the client developer in understanding the error that occurred.  </dd>
<dt>error_uri</dt>
<dd style="margin-left: 6">
<br> OPTIONAL. A URI identifying a human-readable web page with information about the error, used to provide the client developer with additional information about the error.  </dd>
<dt>state</dt>
<dd style="margin-left: 6">
<br> REQUIRED if a valid <samp>state</samp> parameter was present in the client authorization request. Set to the exact value received from the client.  </dd>
</dl>

<p> </p>
<div id="#rfc.figure.8"></div>
<p>For example, the authorization server redirects the user-agent by sending the following HTTP response: </p>
<pre>
                
  HTTP/1.1 302 Found
  Location: https://client.example.com/cb?error=access_denied&amp;state=xyz

              </pre>
<h1 id="rfc.section.4.1.3">
<a href="#rfc.section.4.1.3">4.1.3.</a> Access Token Request</h1>
<p id="rfc.section.4.1.3.p.1">The client makes a request to the token endpoint by adding the following parameters using the <samp>application/x-www-form-urlencoded</samp> format in the HTTP request entity-body: </p>
<p></p>

<dl>
<dt>grant_type</dt>
<dd style="margin-left: 6">
<br> REQUIRED. Value MUST be set to <samp>authorization_code</samp>.  </dd>
<dt>code</dt>
<dd style="margin-left: 6">
<br> REQUIRED. The authorization code received from the authorization server.  </dd>
<dt>redirect_uri</dt>
<dd style="margin-left: 6">
<br> REQUIRED, if the <samp>redirect_uri</samp> parameter was included in the authorization request described in <a href="#code-authz-req">Section 4.1.1</a>, and their values MUST be identical.  </dd>
</dl>

<p> </p>
<p id="rfc.section.4.1.3.p.3">If the client type is private or was issued client credentials (or assigned other authentication requirements), the client MUST authenticate with the authorization server as described in <a href="#token-endpoint-auth">Section 3.2.1</a>.  </p>
<div id="#rfc.figure.9"></div>
<p>For example, the client makes the following HTTP using transport-layer security (extra line breaks are for display purposes only): </p>
<pre>
              
  POST /token HTTP/1.1
  Host: server.example.com
  Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW
  Content-Type: application/x-www-form-urlencoded;charset=UTF-8

  grant_type=authorization_code&amp;code=SplxlOBeZQQYbYS6WxSbIA
  &amp;redirect_uri=https%3A%2F%2Fclient%2Eexample%2Ecom%2Fcb

            </pre>
<p id="rfc.section.4.1.3.p.4">The authorization server MUST: </p>
<p></p>

<ul>
<li>require client authentication for private clients or for any client issued client credentials (or with other authentication requirements), </li>
<li>authenticate the client if client authentication is included and ensure the authorization code was issued to the authenticated client, </li>
<li>verify that the authorization code is valid, and </li>
<li>ensure that the <samp>redirect_uri</samp> parameter is present if the <samp>redirect_uri</samp> parameter was included in the initial authorization request described in <a href="#code-authz-req">Section 4.1.1</a>, and that their values are identical.  </li>
</ul>

<p> </p>
<h1 id="rfc.section.4.1.4">
<a href="#rfc.section.4.1.4">4.1.4.</a> Access Token Response</h1>
<p id="rfc.section.4.1.4.p.1">If the access token request is valid and authorized, the authorization server issues an access token and optional refresh token as described in <a href="#token-response">Section 5.1</a>.  If the request client authentication failed or is invalid, the authorization server returns an error response as described in <a href="#token-errors">Section 5.2</a>.  </p>
<div id="#rfc.figure.10"></div>
<p>An example successful response: </p>
<pre>
              
  HTTP/1.1 200 OK
  Content-Type: application/json;charset=UTF-8
  Cache-Control: no-store
  Pragma: no-cache

  {
    "access_token":"2YotnFZFEjr1zCsicMWpAA",
    "token_type":"example",
    "expires_in":3600,
    "refresh_token":"tGzv3JOkF0XG5Qx2TlKWIA",
    "example_parameter":"example_value"
  }

            </pre>
<h1 id="rfc.section.4.2">
<a href="#rfc.section.4.2">4.2.</a> <a href="#grant-implicit" id="grant-implicit">Implicit Grant</a>
</h1>
<p id="rfc.section.4.2.p.1">The implicit grant type is used to obtain access tokens (it does not support the issuance of refresh tokens) and is optimized for public clients known to operate a particular redirection URI. These clients are typically implemented in a browser using a scripting language such as JavaScript.  </p>
<p id="rfc.section.4.2.p.2">As a redirection-based flow, the client must be capable of interacting with the resource owner's user-agent (typically a web browser) and capable of receiving incoming requests (via redirection) from the authorization server.  </p>
<p id="rfc.section.4.2.p.3">Unlike the authorization code grant type in which the client makes separate requests for authorization and access token, the client receives the access token as the result of the authorization request.  </p>
<p id="rfc.section.4.2.p.4">The implicit grant type does not include client authentication, and relies on the presence of the resource owner and the registration of the redirection URI. Because the access token is encoded into the redirection URI, it may be exposed to the resource owner and other applications residing on its device.  </p>
<div id="#rfc.figure.11"></div>
<div id="#Figure-4"></div>
<pre>
            
  +----------+
  | Resource |
  |  Owner   |
  |          |
  +----------+
       ^
       |
      (B)      
  +----|-----+          Client Identifier     +---------------+
  |         -+----(A)-- &amp; Redirection URI ---&gt;|               |
  |  User-   |                                | Authorization |
  |  Agent  -|----(B)-- User authenticates --&gt;|     Server    |
  |          |                                |               |
  |          |&lt;---(C)--- Redirection URI ----&lt;|               |
  |          |          with Access Token     +---------------+
  |          |            in Fragment
  |          |                                +---------------+
  |          |----(D)--- Redirection URI ----&gt;|   Web-Hosted  |
  |          |          without Fragment      |     Client    |
  |          |                                |    Resource   |
  |     (F)  |&lt;---(E)------- Script ---------&lt;|               |
  |          |                                +---------------+
  +-|--------+
    |    |    
   (A)  (G) Access Token
    |    |
    ^    v
  +---------+
  |         |
  |  Client |
  |         |
  +---------+

          </pre>
<p id="rfc.section.4.2.p.5">The flow illustrated in <a href="#Figure-4">Figure 11</a> includes the following steps: </p>
<p></p>

<dl>
<dt>(%C)</dt>
<dd>The client initiates the flow by directing the resource owner's user-agent to the authorization endpoint. The client includes its client identifier, requested scope, local state, and a redirection URI to which the authorization server will send the user-agent back once access is granted (or denied).  </dd>
<dt>(%C)</dt>
<dd>The authorization server authenticates the resource owner (via the user-agent) and establishes whether the resource owner grants or denies the client's access request.  </dd>
<dt>(%C)</dt>
<dd>Assuming the resource owner grants access, the authorization server redirects the user-agent back to the client using the redirection URI provided earlier. The redirection URI includes the access token in the URI fragment.  </dd>
<dt>(%C)</dt>
<dd>The user-agent follows the redirection instructions by making a request to the web-hosted client resource (which does not include the fragment). The user-agent retains the fragment information locally.  </dd>
<dt>(%C)</dt>
<dd>The web-hosted client resource returns a web page (typically an HTML document with an embedded script) capable of accessing the full redirection URI including the fragment retained by the user-agent, and extracting the access token (and other parameters) contained in the fragment.  </dd>
<dt>(%C)</dt>
<dd>The user-agent executes the script provided by the web-hosted client resource locally, which extracts the access token and passes it to the client.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.4.2.1">
<a href="#rfc.section.4.2.1">4.2.1.</a> <a href="#implicit-authz-req" id="implicit-authz-req">Authorization Request</a>
</h1>
<p id="rfc.section.4.2.1.p.1">The client constructs the request URI by adding the following parameters to the query component of the authorization endpoint URI using the <samp>application/x-www-form-urlencoded</samp> format: </p>
<p></p>

<dl>
<dt>response_type</dt>
<dd style="margin-left: 6">
<br> REQUIRED. Value MUST be set to <samp>token</samp>.  </dd>
<dt>client_id</dt>
<dd style="margin-left: 6">
<br> REQUIRED. The client identifier as described in <a href="#client-identifier">Section 2.3</a>.  </dd>
<dt>redirect_uri</dt>
<dd style="margin-left: 6">
<br> OPTIONAL, as described in <a href="#redirect-uri">Section 3.1.2</a>.  </dd>
<dt>scope</dt>
<dd style="margin-left: 6">
<br> OPTIONAL. The scope of the access request expressed as a list of space-delimited, case sensitive strings. The value is defined by the authorization server. If the value contains multiple space-delimited strings, their order does not matter, and each string adds an additional access range to the requested scope.  </dd>
<dt>state</dt>
<dd style="margin-left: 6">
<br> OPTIONAL. An opaque value used by the client to maintain state between the request and callback. The authorization server includes this value when redirecting the user-agent back to the client.  </dd>
</dl>

<p> </p>
<p id="rfc.section.4.2.1.p.3">The client directs the resource owner to the constructed URI using an HTTP redirection response, or by other means available to it via the user-agent.  </p>
<div id="#rfc.figure.12"></div>
<p>For example, the client directs the user-agent to make the following HTTP request using transport-layer security (extra line breaks are for display purposes only): </p>
<pre>
              
  GET /authorize?response_type=token&amp;client_id=s6BhdRkqt3&amp;state=xyz
      &amp;redirect_uri=https%3A%2F%2Fclient%2Eexample%2Ecom%2Fcb HTTP/1.1
  Host: server.example.com

            </pre>
<p id="rfc.section.4.2.1.p.4">The authorization server validates the request to ensure all required parameters are present and valid. The authorization server MUST verify that the redirection URI to which it will redirect the access token matches a redirection URI registered by the client as described in <a href="#redirect-uri">Section 3.1.2</a>.  </p>
<p id="rfc.section.4.2.1.p.5">If the request is valid, the authorization server authenticates the resource owner and obtains an authorization decision (by asking the resource owner or by establishing approval via other means).  </p>
<p id="rfc.section.4.2.1.p.6">When a decision is established, the authorization server directs the user-agent to the provided client redirection URI using an HTTP redirection response, or by other means available to it via the user-agent.  </p>
<h1 id="rfc.section.4.2.2">
<a href="#rfc.section.4.2.2">4.2.2.</a> Access Token Response</h1>
<p id="rfc.section.4.2.2.p.1">If the resource owner grants the access request, the authorization server issues an access token and delivers it to the client by adding the following parameters to the fragment component of the redirection URI using the <samp>application/x-www-form-urlencoded</samp> format: </p>
<p></p>

<dl>
<dt>access_token</dt>
<dd style="margin-left: 6">
<br> REQUIRED. The access token issued by the authorization server.  </dd>
<dt>token_type</dt>
<dd style="margin-left: 6">
<br> REQUIRED. The type of the token issued as described in <a href="#token-types">Section 7.1</a>. Value is case insensitive.  </dd>
<dt>expires_in</dt>
<dd style="margin-left: 6">
<br> OPTIONAL. The lifetime in seconds of the access token. For example, the value <samp>3600</samp> denotes that the access token will expire in one hour from the time the response was generated.  </dd>
<dt>scope</dt>
<dd style="margin-left: 6">
<br> OPTIONAL. The scope of the access token expressed as a list of space-delimited, case sensitive strings. The value is defined by the authorization server. If the value contains multiple space-delimited strings, their order does not matter, and each string adds an additional access range to the requested scope. The authorization server SHOULD include the parameter if the access token scope is different from the one requested by the client.  </dd>
<dt>state</dt>
<dd style="margin-left: 6">
<br> REQUIRED if the <samp>state</samp> parameter was present in the client authorization request. Set to the exact value received from the client.  </dd>
</dl>

<p> </p>
<div id="#rfc.figure.13"></div>
<p>For example, the authorization server redirects the user-agent by sending the following HTTP response (URI extra line breaks are for display purposes only): </p>
<pre>
              
  HTTP/1.1 302 Found
  Location: http://example.com/rd#access_token=2YotnFZFEjr1zCsicMWpAA
            &amp;state=xyz&amp;token_type=example&amp;expires_in=3600

            </pre>
<p>Developers should note that some HTTP client implementations do not support the inclusion of a fragment component in the HTTP <samp>Location</samp> response header field. Such client will require using other methods for redirecting the client than a 3xx redirection response. For example, returning an HTML page which includes a 'continue' button with an action linked to the redirection URI.  </p>
<p id="rfc.section.4.2.2.p.3">The client SHOULD ignore unrecognized response parameters. The access token string size is left undefined by this specification. The client should avoid making assumptions about value sizes. The authorization server should document the size of any value it issues.  </p>
<h1 id="rfc.section.4.2.2.1">
<a href="#rfc.section.4.2.2.1">4.2.2.1.</a> <a href="#implicit-authz-error" id="implicit-authz-error">Error Response</a>
</h1>
<p id="rfc.section.4.2.2.1.p.1">If the request fails due to a missing, invalid, or mismatching redirection URI, or if the client identifier provided is invalid, the authorization server SHOULD inform the resource owner of the error, and MUST NOT automatically redirect the user-agent to the invalid redirection URI.  </p>
<p id="rfc.section.4.2.2.1.p.2">If the resource owner denies the access request or if the request fails for reasons other than a missing or invalid redirection URI, the authorization server informs the client by adding the following parameters to the fragment component of the redirection URI using the <samp>application/x-www-form-urlencoded</samp> format: </p>
<p></p>

<dl>
<dt>error</dt>
<dd style="margin-left: 6">
<br> REQUIRED. A single error code from the following: <dl>
<dt>invalid_request</dt>
<dd style="margin-left: 6">
<br> The request is missing a required parameter, includes an unsupported parameter or parameter value, or is otherwise malformed.  </dd>
<dt>unauthorized_client</dt>
<dd style="margin-left: 6">
<br> The client is not authorized to request an access token using this method.  </dd>
<dt>access_denied</dt>
<dd style="margin-left: 6">
<br> The resource owner or authorization server denied the request.  </dd>
<dt>unsupported_response_type</dt>
<dd style="margin-left: 6">
<br> The authorization server does not support obtaining an access token using this method.  </dd>
<dt>invalid_scope</dt>
<dd style="margin-left: 6">
<br> The requested scope is invalid, unknown, or malformed.  </dd>
<dt>server_error</dt>
<dd style="margin-left: 6">
<br> The authorization server encountered an unexpected condition which prevented it from fulfilling the request.  </dd>
<dt>temporarily_unavailable</dt>
<dd style="margin-left: 6">
<br> The authorization server is currently unable to handle the request due to a temporary overloading or maintenance of the server.  </dd>
</dl>
<p> </p>
</dd>
<dt>error_description</dt>
<dd style="margin-left: 6">
<br> OPTIONAL. A human-readable UTF-8 encoded text providing additional information, used to assist the client developer in understanding the error that occurred.  </dd>
<dt>error_uri</dt>
<dd style="margin-left: 6">
<br> OPTIONAL. A URI identifying a human-readable web page with information about the error, used to provide the client developer with additional information about the error.  </dd>
<dt>state</dt>
<dd style="margin-left: 6">
<br> REQUIRED if a valid <samp>state</samp> parameter was present in the client authorization request. Set to the exact value received from the client.  </dd>
</dl>

<p> </p>
<div id="#rfc.figure.14"></div>
<p>For example, the authorization server redirects the user-agent by sending the following HTTP response: </p>
<pre>
                
  HTTP/1.1 302 Found
  Location: https://client.example.com/cb#error=access_denied&amp;state=xyz

              </pre>
<h1 id="rfc.section.4.3">
<a href="#rfc.section.4.3">4.3.</a> <a href="#grant-password" id="grant-password">Resource Owner Password Credentials</a>
</h1>
<p id="rfc.section.4.3.p.1">The resource owner password credentials grant type is suitable in cases where the resource owner has a trust relationship with the client, such as its device operating system or a highly privileged application. The authorization server should take special care when enabling the grant type, and only when other flows are not viable.  </p>
<p id="rfc.section.4.3.p.2">The grant type is suitable for clients capable of obtaining the resource owner credentials (username and password, typically using an interactive form). It is also used to migrate existing clients using direct authentication schemes such as HTTP Basic or Digest authentication to OAuth by converting the stored credentials to an access token.  </p>
<div id="#rfc.figure.15"></div>
<div id="#Figure-5"></div>
<pre>
            
  +----------+
  | Resource |
  |  Owner   |
  |          |
  +----------+
       v
       |    Resource Owner
      (A) Password Credentials
       |
       v
  +---------+                                  +---------------+
  |         |&gt;--(B)---- Resource Owner -------&gt;|               |
  |         |         Password Credentials     | Authorization |
  | Client  |                                  |     Server    |
  |         |&lt;--(C)---- Access Token ---------&lt;|               |
  |         |    (w/ Optional Refresh Token)   |               |
  +---------+                                  +---------------+

          </pre>
<p id="rfc.section.4.3.p.3">The flow illustrated in <a href="#Figure-5">Figure 15</a> includes the following steps: </p>
<p></p>

<dl>
<dt>(%C)</dt>
<dd>The resource owner provides the client with its username and password.  </dd>
<dt>(%C)</dt>
<dd>The client requests an access token from the authorization server's token endpoint by including the credentials received from the resource owner. When making the request, the client authenticates with the authorization server.  </dd>
<dt>(%C)</dt>
<dd>The authorization server authenticates the client and validates the resource owner credentials, and if valid issues an access token.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.4.3.1">
<a href="#rfc.section.4.3.1">4.3.1.</a> Authorization Request and Response</h1>
<p id="rfc.section.4.3.1.p.1">The method through which the client obtains the resource owner credentials is beyond the scope of this specification. The client MUST discard the credentials once an access token has been obtained.  </p>
<h1 id="rfc.section.4.3.2">
<a href="#rfc.section.4.3.2">4.3.2.</a> Access Token Request</h1>
<p id="rfc.section.4.3.2.p.1">The client makes a request to the token endpoint by adding the following parameters using the <samp>application/x-www-form-urlencoded</samp> format in the HTTP request entity-body: </p>
<p></p>

<dl>
<dt>grant_type</dt>
<dd style="margin-left: 6">
<br> REQUIRED. Value MUST be set to <samp>password</samp>.  </dd>
<dt>username</dt>
<dd style="margin-left: 6">
<br> REQUIRED. The resource owner username, encoded as UTF-8.  </dd>
<dt>password</dt>
<dd style="margin-left: 6">
<br> REQUIRED. The resource owner password, encoded as UTF-8.  </dd>
<dt>scope</dt>
<dd style="margin-left: 6">
<br> OPTIONAL. The scope of the access request expressed as a list of space-delimited, case sensitive strings. The value is defined by the authorization server. If the value contains multiple space-delimited strings, their order does not matter, and each string adds an additional access range to the requested scope.  </dd>
</dl>

<p> </p>
<p id="rfc.section.4.3.2.p.3">If the client type is private or was issued client credentials (or assigned other authentication requirements), the client MUST authenticate with the authorization server as described in <a href="#token-endpoint-auth">Section 3.2.1</a>.  </p>
<div id="#rfc.figure.16"></div>
<p>For example, the client makes the following HTTP request using transport-layer security (extra line breaks are for display purposes only): </p>
<pre>
              
  POST /token HTTP/1.1
  Host: server.example.com
  Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW
  Content-Type: application/x-www-form-urlencoded;charset=UTF-8
  
  grant_type=password&amp;username=johndoe&amp;password=A3ddj3w

            </pre>
<p id="rfc.section.4.3.2.p.4">The authorization server MUST: </p>
<p></p>

<ul>
<li>require client authentication for private clients or for any client issued client credentials (or with other authentication requirements), </li>
<li>authenticate the client if client authentication is included, and </li>
<li>validate the resource owner password credentials.  </li>
</ul>

<p> </p>
<p id="rfc.section.4.3.2.p.6">Since this access token request utilizes the resource owner's password, the authorization server MUST protect the endpoint against brute force attacks.  </p>
<h1 id="rfc.section.4.3.3">
<a href="#rfc.section.4.3.3">4.3.3.</a> Access Token Response</h1>
<p id="rfc.section.4.3.3.p.1">If the access token request is valid and authorized, the authorization server issues an access token and optional refresh token as described in <a href="#token-response">Section 5.1</a>.  If the request failed client authentication or is invalid, the authorization server returns an error response as described in <a href="#token-errors">Section 5.2</a>.  </p>
<div id="#rfc.figure.17"></div>
<p>An example successful response: </p>
<pre>
              
  HTTP/1.1 200 OK
  Content-Type: application/json;charset=UTF-8
  Cache-Control: no-store
  Pragma: no-cache

  {
    "access_token":"2YotnFZFEjr1zCsicMWpAA",
    "token_type":"example",
    "expires_in":3600,
    "refresh_token":"tGzv3JOkF0XG5Qx2TlKWIA",
    "example_parameter":"example_value"
  }

            </pre>
<h1 id="rfc.section.4.4">
<a href="#rfc.section.4.4">4.4.</a> <a href="#grant-client" id="grant-client">Client Credentials</a>
</h1>
<p id="rfc.section.4.4.p.1">The client can request an access token using only its client credentials (or other supported means of authentication) when the client is requesting access to the protected resources under its control, or those of another resource owner which has been previously arranged with the authorization server (the method of which is beyond the scope of this specification).  </p>
<p id="rfc.section.4.4.p.2">The client credentials grant type MUST only be used by private clients.  </p>
<div id="#rfc.figure.18"></div>
<div id="#Figure-6"></div>
<pre>
            
  +---------+                                  +---------------+
  |         |                                  |               |
  |         |&gt;--(A)- Client Authentication ---&gt;| Authorization |
  | Client  |                                  |     Server    |
  |         |&lt;--(B)---- Access Token ---------&lt;|               |
  |         |                                  |               |
  +---------+                                  +---------------+

          </pre>
<p id="rfc.section.4.4.p.3">The flow illustrated in <a href="#Figure-6">Figure 18</a> includes the following steps: </p>
<p></p>

<dl>
<dt>(%C)</dt>
<dd>The client authenticates with the authorization server and requests an access token from the token endpoint.  </dd>
<dt>(%C)</dt>
<dd>The authorization server authenticates the client, and if valid issues an access token.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.4.4.1">
<a href="#rfc.section.4.4.1">4.4.1.</a> Authorization Request and Response</h1>
<p id="rfc.section.4.4.1.p.1">Since the client authentication is used as the authorization grant, no additional authorization request is needed.  </p>
<h1 id="rfc.section.4.4.2">
<a href="#rfc.section.4.4.2">4.4.2.</a> Access Token Request</h1>
<p id="rfc.section.4.4.2.p.1">The client makes a request to the token endpoint by adding the following parameters using the <samp>application/x-www-form-urlencoded</samp> format in the HTTP request entity-body: </p>
<p></p>

<dl>
<dt>grant_type</dt>
<dd style="margin-left: 6">
<br> REQUIRED. Value MUST be set to <samp>client_credentials</samp>.  </dd>
<dt>scope</dt>
<dd style="margin-left: 6">
<br> OPTIONAL. The scope of the access request expressed as a list of space-delimited, case sensitive strings. The value is defined by the authorization server. If the value contains multiple space-delimited strings, their order does not matter, and each string adds an additional access range to the requested scope.  </dd>
</dl>

<p> </p>
<p id="rfc.section.4.4.2.p.3">The client MUST authenticate with the authorization server as described in <a href="#token-endpoint-auth">Section 3.2.1</a>.  </p>
<div id="#rfc.figure.19"></div>
<p>For example, the client makes the following HTTP request using transport-layer security (extra line breaks are for display purposes only): </p>
<pre>
              
  POST /token HTTP/1.1
  Host: server.example.com
  Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW
  Content-Type: application/x-www-form-urlencoded;charset=UTF-8
  
  grant_type=client_credentials

            </pre>
<p id="rfc.section.4.4.2.p.4">The authorization server MUST authenticate the client.  </p>
<h1 id="rfc.section.4.4.3">
<a href="#rfc.section.4.4.3">4.4.3.</a> Access Token Response</h1>
<p id="rfc.section.4.4.3.p.1">If the access token request is valid and authorized, the authorization server issues an access token as described in <a href="#token-response">Section 5.1</a>. A refresh token SHOULD NOT be included. If the request failed client authentication or is invalid, the authorization server returns an error response as described in <a href="#token-errors">Section 5.2</a>.  </p>
<div id="#rfc.figure.20"></div>
<p>An example successful response: </p>
<pre>
              
  HTTP/1.1 200 OK
  Content-Type: application/json;charset=UTF-8
  Cache-Control: no-store
  Pragma: no-cache
  
  {
    "access_token":"2YotnFZFEjr1zCsicMWpAA",
    "token_type":"example",
    "expires_in":3600,
    "example_parameter":"example_value"
  }

            </pre>
<h1 id="rfc.section.4.5">
<a href="#rfc.section.4.5">4.5.</a> Extensions</h1>
<p id="rfc.section.4.5.p.1">The client uses an extension grant type by specifying the grant type using an absolute URI (defined by the authorization server) as the value of the <samp>grant_type</samp> parameter of the token endpoint, and by adding any additional parameters necessary.  </p>
<div id="#rfc.figure.21"></div>
<p>For example, to request an access token using a SAML 2.0 assertion grant type as defined by <a href="#I-D.ietf-oauth-saml2-bearer">[I-D.ietf-oauth-saml2-bearer]</a>, the client makes the following HTTP request using transport-layer security (line breaks are for display purposes only): </p>
<pre>
            
  POST /token HTTP/1.1
  Host: server.example.com
  Content-Type: application/x-www-form-urlencoded;charset=UTF-8

  grant_type=http%3A%2F%2Foauth.net%2Fgrant_type%2Fassertion%2F
  saml%2F2.0%2Fbearer&amp;assertion=PEFzc2VydGlvbiBJc3N1ZUluc3RhbnQ
  [...omitted for brevity...]V0aG5TdGF0ZW1lbnQ-PC9Bc3NlcnRpb24-

          </pre>
<p id="rfc.section.4.5.p.2">If the access token request is valid and authorized, the authorization server issues an access token and optional refresh token as described in <a href="#token-response">Section 5.1</a>.  If the request failed client authentication or is invalid, the authorization server returns an error response as described in <a href="#token-errors">Section 5.2</a>.  </p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#token-issue" id="token-issue">Issuing an Access Token</a>
</h1>
<p id="rfc.section.5.p.1">If the access token request is valid and authorized, the authorization server issues an access token and optional refresh token as described in <a href="#token-response">Section 5.1</a>.  If the request failed client authentication or is invalid, the authorization server returns an error response as described in <a href="#token-errors">Section 5.2</a>.  </p>
<h1 id="rfc.section.5.1">
<a href="#rfc.section.5.1">5.1.</a> <a href="#token-response" id="token-response">Successful Response</a>
</h1>
<p id="rfc.section.5.1.p.1">The authorization server issues an access token and optional refresh token, and constructs the response by adding the following parameters to the entity body of the HTTP response with a 200 (OK) status code: </p>
<p></p>

<dl>
<dt>access_token</dt>
<dd style="margin-left: 6">
<br> REQUIRED. The access token issued by the authorization server.  </dd>
<dt>token_type</dt>
<dd style="margin-left: 6">
<br> REQUIRED. The type of the token issued as described in <a href="#token-types">Section 7.1</a>.  Value is case insensitive.  </dd>
<dt>expires_in</dt>
<dd style="margin-left: 6">
<br> OPTIONAL. The lifetime in seconds of the access token. For example, the value <samp>3600</samp> denotes that the access token will expire in one hour from the time the response was generated.  </dd>
<dt>refresh_token</dt>
<dd style="margin-left: 6">
<br> OPTIONAL. The refresh token which can be used to obtain new access tokens using the same authorization grant as described in <a href="#token-refresh">Section 6</a>.  </dd>
<dt>scope</dt>
<dd style="margin-left: 6">
<br> OPTIONAL. The scope of the access token expressed as a list of space-delimited, case sensitive strings. The value is defined by the authorization server. If the value contains multiple space-delimited strings, their order does not matter, and each string adds an additional access range to the requested scope. The authorization server SHOULD include the parameter if the access token scope is different from the one requested by the client.  </dd>
</dl>

<p> </p>
<p id="rfc.section.5.1.p.3">The parameters are included in the entity body of the HTTP response using the <samp>application/json</samp> media type as defined by <a href="#RFC4627">[RFC4627]</a>. The parameters are serialized into a JSON structure by adding each parameter at the highest structure level. Parameter names and string values are included as JSON strings. Numerical values are included as JSON numbers.  </p>
<p id="rfc.section.5.1.p.4">The authorization server MUST include the HTTP <samp>Cache-Control</samp> response header field <a href="#RFC2616">[RFC2616]</a> with a value of <samp>no-store</samp> in any response containing tokens, credentials, or other sensitive information, as well as the <samp>Pragma</samp> response header field <a href="#RFC2616">[RFC2616]</a> with a value of <samp>no-cache</samp>.  </p>
<div id="#rfc.figure.22"></div>
<p>For example: </p>
<pre>
            
  HTTP/1.1 200 OK
  Content-Type: application/json;charset=UTF-8
  Cache-Control: no-store
  Pragma: no-cache

  {
    "access_token":"2YotnFZFEjr1zCsicMWpAA",
    "token_type":"example",
    "expires_in":3600,
    "refresh_token":"tGzv3JOkF0XG5Qx2TlKWIA",
    "example_parameter":"example_value"
  }

          </pre>
<p id="rfc.section.5.1.p.5">The client SHOULD ignore unrecognized response parameters. The sizes of tokens and other values received from the authorization server are left undefined. The client should avoid making assumptions about value sizes. The authorization server should document the size of any value it issues.  </p>
<h1 id="rfc.section.5.2">
<a href="#rfc.section.5.2">5.2.</a> <a href="#token-errors" id="token-errors">Error Response</a>
</h1>
<p id="rfc.section.5.2.p.1">The authorization server responds with an HTTP 400 (Bad Request) status code and includes the following parameters with the response: </p>
<p></p>

<dl>
<dt>error</dt>
<dd style="margin-left: 6">
<br> REQUIRED. A single error code from the following: <dl>
<dt>invalid_request</dt>
<dd style="margin-left: 6">
<br> The request is missing a required parameter, includes an unsupported parameter or parameter value, repeats a parameter, includes multiple credentials, utilizes more than one mechanism for authenticating the client, or is otherwise malformed.  </dd>
<dt>invalid_client</dt>
<dd style="margin-left: 6">
<br> Client authentication failed (e.g. unknown client, no client authentication included, multiple client authentications included, or unsupported authentication method). The authorization server MAY return an HTTP 401 (Unauthorized) status code to indicate which HTTP authentication schemes are supported. If the client attempted to authenticate via the <samp>Authorization</samp> request header field, the authorization server MUST respond with an HTTP 401 (Unauthorized) status code, and include the <samp>WWW-Authenticate</samp> response header field matching the authentication scheme used by the client.  </dd>
<dt>invalid_grant</dt>
<dd style="margin-left: 6">
<br> The provided authorization grant is invalid, expired, revoked, does not match the redirection URI used in the authorization request, or was issued to another client.  </dd>
<dt>unauthorized_client</dt>
<dd style="margin-left: 6">
<br> The authenticated client is not authorized to use this authorization grant type.  </dd>
<dt>unsupported_grant_type</dt>
<dd style="margin-left: 6">
<br> The authorization grant type is not supported by the authorization server.  </dd>
<dt>invalid_scope</dt>
<dd style="margin-left: 6">
<br> The requested scope is invalid, unknown, malformed, or exceeds the scope granted by the resource owner.  </dd>
</dl>
<p> </p>
</dd>
<dt>error_description</dt>
<dd style="margin-left: 6">
<br> OPTIONAL. A human-readable UTF-8 encoded text providing additional information, used to assist the client developer in understanding the error that occurred.  </dd>
<dt>error_uri</dt>
<dd style="margin-left: 6">
<br> OPTIONAL. A URI identifying a human-readable web page with information about the error, used to provide the client developer with additional information about the error.  </dd>
</dl>

<p> </p>
<p id="rfc.section.5.2.p.3">The parameters are included in the entity body of the HTTP response using the <samp>application/json</samp> media type as defined by <a href="#RFC4627">[RFC4627]</a>. The parameters are serialized into a JSON structure by adding each parameter at the highest structure level. Parameter names and string values are included as JSON strings. Numerical values are included as JSON numbers.  </p>
<div id="#rfc.figure.23"></div>
<p>For example: </p>
<pre>
            
  HTTP/1.1 400 Bad Request
  Content-Type: application/json;charset=UTF-8
  Cache-Control: no-store
  Pragma: no-cache

  {
    "error":"invalid_request"
  }

          </pre>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#token-refresh" id="token-refresh">Refreshing an Access Token</a>
</h1>
<p id="rfc.section.6.p.1">If the authorization server issued a refresh token to the client, the client makes a refresh request to the token endpoint by adding the following parameters using the <samp>application/x-www-form-urlencoded</samp> format in the HTTP request entity-body: </p>
<p></p>

<dl>
<dt>grant_type</dt>
<dd style="margin-left: 6">
<br> REQUIRED. Value MUST be set to <samp>refresh_token</samp>.  </dd>
<dt>refresh_token</dt>
<dd style="margin-left: 6">
<br> REQUIRED. The refresh token issued to the client.  </dd>
<dt>scope</dt>
<dd style="margin-left: 6">
<br> OPTIONAL. The scope of the access request expressed as a list of space-delimited, case sensitive strings. The value is defined by the authorization server. If the value contains multiple space-delimited strings, their order does not matter, and each string adds an additional access range to the requested scope. The requested scope MUST be equal or lesser than the scope originally granted by the resource owner, and if omitted is treated as equal to the scope originally granted by the resource owner.  </dd>
</dl>

<p> </p>
<p id="rfc.section.6.p.3">Because refresh tokens are typically long-lasting credentials used to request additional access tokens, the refresh token is bound to the client it was issued. If the client type is private or was issued client credentials (or assigned other authentication requirements), the client MUST authenticate with the authorization server as described in <a href="#token-endpoint-auth">Section 3.2.1</a>.  </p>
<div id="#rfc.figure.24"></div>
<p>For example, the client makes the following HTTP request using transport-layer security (extra line breaks are for display purposes only): </p>
<pre>
          
  POST /token HTTP/1.1
  Host: server.example.com
  Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW
  Content-Type: application/x-www-form-urlencoded;charset=UTF-8
  
  grant_type=refresh_token&amp;refresh_token=tGzv3JOkF0XG5Qx2TlKWIA

        </pre>
<p id="rfc.section.6.p.4">The authorization server MUST: </p>
<p></p>

<ul>
<li>require client authentication for private clients or for any client issued client credentials (or with other authentication requirements), </li>
<li>authenticate the client if client authentication is included and ensure the refresh token was issued to the authenticated client, </li>
<li>validate the refresh token, and </li>
</ul>

<p> </p>
<p id="rfc.section.6.p.6">If valid and authorized, the authorization server issues an access token as described in <a href="#token-response">Section 5.1</a>. If the request failed verification or is invalid, the authorization server returns an error response as described in <a href="#token-errors">Section 5.2</a>.  </p>
<p id="rfc.section.6.p.7">The authorization server MAY issue a new refresh token, in which case the client MUST discard the old refresh token and replace it with the new refresh token. The authorization server MAY revoke the old refresh token after issuing a new refresh token to the client. If a new refresh token is issued, its scope MUST be identical to that of the refresh token included in the request.  </p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> <a href="#access-resource" id="access-resource">Accessing Protected Resources</a>
</h1>
<p id="rfc.section.7.p.1">The client accesses protected resources by presenting the access token to the resource server. The resource server MUST validate the access token and ensure it has not expired and that its scope covers the requested resource. The methods used by the resource server to validate the access token (as well as any error responses) are beyond the scope of this specification, but generally involve an interaction or coordination between the resource server and the authorization server.  </p>
<p id="rfc.section.7.p.2">The method in which the client utilized the access token to authenticate with the resource server depends on the type of access token issued by the authorization server. Typically, it involves using the HTTP <samp>Authorization</samp> request header field <a href="#RFC2617">[RFC2617]</a> with an authentication scheme defined by the access token type specification.  </p>
<h1 id="rfc.section.7.1">
<a href="#rfc.section.7.1">7.1.</a> <a href="#token-types" id="token-types">Access Token Types</a>
</h1>
<p id="rfc.section.7.1.p.1">The access token type provides the client with the information required to successfully utilize the access token to make a protected resource request (along with type-specific attributes). The client MUST NOT use an access token if it does not understand or does not trust the token type.  </p>
<div id="#rfc.figure.25"></div>
<p>For example, the <samp>bearer</samp> token type defined in <a href="#I-D.ietf-oauth-v2-bearer">[I-D.ietf-oauth-v2-bearer]</a> is utilized by simply including the access token string in the request: </p>
<pre>
            
  GET /resource/1 HTTP/1.1
  Host: example.com
  Authorization: Bearer 7Fjfp0ZBr1KtDRbnfVdmIw

          </pre>
<div id="#rfc.figure.26"></div>
<p>while the <samp>mac</samp> token type defined in <a href="#I-D.ietf-oauth-v2-http-mac">[I-D.ietf-oauth-v2-http-mac]</a> is utilized by issuing a MAC key together with the access token which is used to sign certain components of the HTTP requests: </p>
<pre>
            
  GET /resource/1 HTTP/1.1
  Host: example.com
  Authorization: MAC id="h480djs93hd8",
                     nonce="274312:dj83hs9s",
                     mac="kDZvddkndxvhGRXZhvuDjEWhGeE="

          </pre>
<p id="rfc.section.7.1.p.2">The above examples are provided for illustration purposes only. Developers are advised to consult the <a href="#I-D.ietf-oauth-v2-bearer">[I-D.ietf-oauth-v2-bearer]</a> and <a href="#I-D.ietf-oauth-v2-http-mac">[I-D.ietf-oauth-v2-http-mac]</a> specifications before use.  </p>
<p id="rfc.section.7.1.p.3">Each access token type definition specifies the additional attributes (if any) sent to the client together with the <samp>access_token</samp> response parameter.  It also defines the HTTP authentication method used to include the access token when making a protected resource request.  </p>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> <a href="#extensions" id="extensions">Extensibility</a>
</h1>
<h1 id="rfc.section.8.1">
<a href="#rfc.section.8.1">8.1.</a> <a href="#new-types" id="new-types">Defining Access Token Types</a>
</h1>
<p id="rfc.section.8.1.p.1">Access token types can be defined in one of two ways: registered in the access token type registry (following the procedures in <a href="#type-registry">Section 11.1</a>), or use a unique absolute URI as its name.  </p>
<p id="rfc.section.8.1.p.2">Types utilizing a URI name SHOULD be limited to vendor-specific implementations that are not commonly applicable, and are specific to the implementation details of the resource server where they are used.  </p>
<p id="rfc.section.8.1.p.3">All other types MUST be registered. Type names MUST conform to the type-name ABNF. If the type definition includes a new HTTP authentication scheme, the type name SHOULD be identical to the HTTP authentication scheme name (as defined by <a href="#RFC2617">[RFC2617]</a>).  </p>
<div id="#rfc.figure.27"></div>
<pre>
            
  type-name  = 1*name-char
  name-char   = "-" / "." / "_" / DIGIT / ALPHA

          </pre>
<h1 id="rfc.section.8.2">
<a href="#rfc.section.8.2">8.2.</a> Defining New Endpoint Parameters</h1>
<p id="rfc.section.8.2.p.1">New request or response parameters for use with the authorization endpoint or the token endpoint are defined and registered in the parameters registry following the procedure in <a href="#parameters-registry">Section 11.2</a>.  </p>
<p id="rfc.section.8.2.p.2">Parameter names MUST conform to the param-name ABNF and parameter values syntax MUST be well-defined (e.g., using ABNF, or a reference to the syntax of an existing parameter).  </p>
<div id="#rfc.figure.28"></div>
<pre>
            
  param-name  = 1*name-char
  name-char   = "-" / "." / "_" / DIGIT / ALPHA

          </pre>
<p id="rfc.section.8.2.p.3">Unregistered vendor-specific parameter extensions that are not commonly applicable, and are specific to the implementation details of the authorization server where they are used SHOULD utilize a vendor-specific prefix that is not likely to conflict with other registered values (e.g. begin with 'companyname_').  </p>
<h1 id="rfc.section.8.3">
<a href="#rfc.section.8.3">8.3.</a> Defining New Authorization Grant Types</h1>
<p id="rfc.section.8.3.p.1">New authorization grant types can be defined by assigning them a unique absolute URI for use with the <samp>grant_type</samp> parameter. If the extension grant type requires additional token endpoint parameters, they MUST be registered in the OAuth parameters registry as described by <a href="#parameters-registry">Section 11.2</a>.  </p>
<h1 id="rfc.section.8.4">
<a href="#rfc.section.8.4">8.4.</a> <a href="#response-type-ext" id="response-type-ext">Defining New Authorization Endpoint Response Types</a>
</h1>
<p id="rfc.section.8.4.p.1">New response types for use with the authorization endpoint are defined and registered in the authorization endpoint response type registry following the procedure in <a href="#response-type-registry">Section 11.3</a>. Response type names MUST conform to the response-type ABNF.  </p>
<div id="#rfc.figure.29"></div>
<pre>
            
  response-type  = response-name *( SP response-name )
  response-name  = 1*response-char
  response-char  = "_" / DIGIT / ALPHA

          </pre>
<p id="rfc.section.8.4.p.2">If a response type contains one of more space characters (%x20), it is compared as a space-delimited list of values in which the order of values does not matter. Only one order of values can be registered, which covers all other arrangements of the same set of values.  </p>
<p id="rfc.section.8.4.p.3">For example, the response type <samp>token code</samp> is left undefined by this specification. However, an extension can define and register the <samp>token code</samp> response type. Once registered, the same combination cannot be registered as <samp>code token</samp>, but both values can be used to denote the same response type.  </p>
<h1 id="rfc.section.8.5">
<a href="#rfc.section.8.5">8.5.</a> <a href="#new-errors" id="new-errors">Defining Additional Error Codes</a>
</h1>
<p id="rfc.section.8.5.p.1">In cases where protocol extensions (i.e. access token types, extension parameters, or extension grant types) require additional error codes to be used with the authorization code grant error response (<a href="#code-authz-error">Section 4.1.2.1</a>), the implicit grant error response (<a href="#implicit-authz-error">Section 4.2.2.1</a>), or the token error response (<a href="#token-errors">Section 5.2</a>), such error codes MAY be defined.  </p>
<p id="rfc.section.8.5.p.2">Extension error codes MUST be registered (following the procedures in <a href="#error-registry">Section 11.4</a>) if the extension they are used in conjunction with is a registered access token type, a registered endpoint parameter, or an extension grant type. Error codes used with unregistered extensions MAY be registered.  </p>
<p id="rfc.section.8.5.p.3">Error codes MUST conform to the error-code ABNF, and SHOULD be prefixed by an identifying name when possible. For example, an error identifying an invalid value set to the extension parameter <samp>example</samp> should be named <samp>example_invalid</samp>.  </p>
<div id="#rfc.figure.30"></div>
<pre>
            
  error-code   = ALPHA *error-char
  error-char   = "-" / "." / "_" / DIGIT / ALPHA

          </pre>
<h1 id="rfc.section.9">
<a href="#rfc.section.9">9.</a> Native Applications</h1>
<p id="rfc.section.9.p.1">Native applications are clients installed and executed on the resource owner's device (i.e. desktop application, native mobile application). Native applications may require special consideration related to security, platform capabilities, and overall end-user experience.  </p>
<p id="rfc.section.9.p.2">The authorization endpoint requires interaction between the client and the resource owner's user-agent. Native applications can invoke an external user-agent or embed a user-agent within the application. For example: </p>
<p></p>

<ul>
<li>External user-agent - the native application can capture the response from the authorization server using a redirection URI with an scheme registered with the operating system to invoke the client as the handler, manual copy-and-paste of the credentials, running a local web server, installing a user-agent extension, or by providing a redirection URI identifying a server-hosted resource under the client's control, which in turn makes the response available to the native application.  </li>
<li>Embedded user-agent - the native application obtains the response by directly communicating with the embedded user-agent by monitoring state changes emitted during the resource load, or accessing the user-agent's cookies storage.  </li>
</ul>

<p> </p>
<p id="rfc.section.9.p.4">When choosing between an external or embedded user-agent, developers should consider: </p>
<p></p>

<ul>
<li>External user-agents may improve completion rate as the resource owner may already have an active session with the authorization server removing the need to re-authenticate. It provides a familiar end-user experience and functionality. The resource owner may also rely on user-agent features or extensions to assist with authentication (e.g. password manager, 2-factor device reader).  </li>
<li>Embedded user-agents may offer an improved usability, as they remove the need to switch context and open new windows.  </li>
<li>Embedded user-agents pose a security challenge because resource owners are authenticating in an unidentified window without access to the visual protections found in most external user-agents.  Embedded user-agents educate end-user to trust unidentified requests for authentication (making phishing attacks easier to execute).  </li>
</ul>

<p> </p>
<p id="rfc.section.9.p.6">When choosing between the implicit grant type and the authorization code grant type, the following should be considered: </p>
<p></p>

<ul>
<li>Native applications that use the authorization code grant type SHOULD do so without using client credentials, due to the native application&#8217;s inability to keep credentials confidential.  </li>
<li>When using the implicit grant type flow a refresh token is not returned.  </li>
</ul>

<p> </p>
<h1 id="rfc.section.10">
<a href="#rfc.section.10">10.</a> Security Considerations</h1>
<p id="rfc.section.10.p.1">As a flexible and extensible framework, OAuth's security considerations depend on many factors. The following sections provide implementers with security guidelines focused on the three client profiles described in <a href="#client-types">Section 2.1</a>: web application, user-agent-based application, and native application.  </p>
<p id="rfc.section.10.p.2">A comprehensive OAuth security model and analysis, as well as background for the protocol design is provided by <a href="#I-D.ietf-oauth-v2-threatmodel">[I-D.ietf-oauth-v2-threatmodel]</a>.  </p>
<h1 id="rfc.section.10.1">
<a href="#rfc.section.10.1">10.1.</a> Client Authentication</h1>
<p id="rfc.section.10.1.p.1">The authorization server establishes client credentials with web application clients for the purpose of client authentication. The authorization server is encouraged to consider stronger client authentication means than a client password. Web application clients MUST ensure confidentiality of client passwords and other client credentials.  </p>
<p id="rfc.section.10.1.p.2">The authorization server MUST NOT issue client passwords or other client credentials to native application or user-agent-based application clients for the purpose of client authentication. The authorization server MAY issue a client password or other credentials for a specific installation of a native application client on a specific device.  </p>
<p id="rfc.section.10.1.p.3">When client authentication is not possible, the authorization server SHOULD employ other means to validate the client's identity. For example, by requiring the registration of the client redirection URI or enlisting the resource owner to confirm identity. The authorization server must consider the security implications of interacting with unauthenticated clients and take measures to limit the potential exposure of other credentials (e.g. refresh tokens) issued to such clients.  </p>
<h1 id="rfc.section.10.2">
<a href="#rfc.section.10.2">10.2.</a> Client Impersonation</h1>
<p id="rfc.section.10.2.p.1">A malicious client can impersonate another client and obtain access to protected resources, if the impersonated client fails to, or is unable to, keep is client credentials confidential.  </p>
<p id="rfc.section.10.2.p.2">The authorization server MUST authenticate the client whenever possible. If the authorization server cannot authenticate the client due to the client nature, the authorization server MUST require the registration of any redirection URI used for receiving authorization, and SHOULD utilize other means to protect resource owners from such malicious clients. For example, engage the resource owner to assist in identifying the client and its origin.  </p>
<p id="rfc.section.10.2.p.3">The authorization server SHOULD enforce explicit resource owner authentication and provide the resource owner with information about the client and the requested authorization scope and lifetime. It is up to the resource owner to review the information in the context of the current client, and authorize the request.  </p>
<p id="rfc.section.10.2.p.4">The authorization server SHOULD NOT process repeated authorization requests automatically (without active resource owner interaction) without authenticating the client or relying on other measures to ensure the repeated request comes from the original client and not an impersonator.  </p>
<h1 id="rfc.section.10.3">
<a href="#rfc.section.10.3">10.3.</a> Access Tokens</h1>
<p id="rfc.section.10.3.p.1">Access token (as well as any access token type-specific attributes) MUST be kept confidential in transit and storage, and only shared among the authorization server, the resource servers the access token is valid for, and the client to whom the access token is issued.  </p>
<p id="rfc.section.10.3.p.2">When using the implicit grant type, the access token is transmitted in the URI fragment, which can expose it to unauthorized parties.  </p>
<p id="rfc.section.10.3.p.3">The authorization server MUST ensure that access tokens cannot be generated, modified, or guessed to produce valid access tokens.  </p>
<p id="rfc.section.10.3.p.4">The client SHOULD request access tokens with the minimal scope and lifetime necessary.  The authorization server SHOULD take the client identity into account when choosing how to honor the requested scope and lifetime, and MAY issue an access token with a less rights than requested.  </p>
<h1 id="rfc.section.10.4">
<a href="#rfc.section.10.4">10.4.</a> Refresh Tokens</h1>
<p id="rfc.section.10.4.p.1">Authorization servers MAY issue refresh tokens to web application clients and native application clients.  </p>
<p id="rfc.section.10.4.p.2">Refresh tokens MUST be kept confidential in transit and storage, and shared only among the authorization server and the client to whom the refresh tokens were issued. The authorization server MUST maintain the binding between a refresh token and the client to whom it was issued.  </p>
<p id="rfc.section.10.4.p.3">The authorization server MUST verify the binding between the refresh token and client identity whenever the client identity can be authenticated. When client authentication is not possible, the authorization server SHOULD deploy other means to detect refresh token abuse.  </p>
<p id="rfc.section.10.4.p.4">For example, the authorization server could employ refresh tokens rotation in which a new refresh token is issued with every access token refresh response. The previous refresh token is invalidated but retained by the authorization server. If a refresh token is compromised and subsequently used by both the attacker and the legitimate client, one of them will present an invalidated refresh token which will inform the authorization server of the breach.  </p>
<p id="rfc.section.10.4.p.5">The authorization server MUST ensure that refresh tokens cannot be generated, modified, or guessed to produce valid refresh tokens.  </p>
<h1 id="rfc.section.10.5">
<a href="#rfc.section.10.5">10.5.</a> Authorization Codes</h1>
<p id="rfc.section.10.5.p.1">The transmission of authorization codes SHOULD be made over a secure channel, and the client SHOULD implement TLS for use with its redirection URI if the URI identifies a network resource. Effort should be made to keep authorization codes confidential. Since authorization codes are transmitted via user-agent redirections, they could potentially be disclosed through user-agent history and HTTP referrer headers.  </p>
<p id="rfc.section.10.5.p.2">Authorization codes operate as plaintext bearer credentials, used to verify that the resource owner who granted authorization at the authorization server, is the same resource owner returning to the client to complete the process. Therefore, if the client relies on the authorization code for its own resource owner authentication, the client redirection endpoint MUST require TLS.  </p>
<p id="rfc.section.10.5.p.3">Authorization codes MUST be short lived and single use. If the authorization server observes multiple attempts to exchange an authorization code for an access token, the authorization server SHOULD attempt to revoke all access tokens already granted based on the compromised authorization code.  </p>
<p id="rfc.section.10.5.p.4">If the client can be authenticated, the authorization servers MUST authenticate the client and ensure that the authorization code was issued to the same client.  </p>
<h1 id="rfc.section.10.6">
<a href="#rfc.section.10.6">10.6.</a> Authorization Code Leakage</h1>
<p id="rfc.section.10.6.p.1">An attacker can leverage the authorization code grant type by tricking a resource owner to authorize access to a legitimate client, but using a client account under the control of the attacker. The only difference between a valid request and the attack request is in how the victim reached the authorization server to grant access.  </p>
<p id="rfc.section.10.6.p.2">Once at the authorization server, the victim is prompted with a normal, valid request on behalf of a legitimate and familiar client. The attacker then uses the victim's authorization to gain access to the information authorized by the victim (via the client).  </p>
<p id="rfc.section.10.6.p.3">In order to prevent such an attack, authorization servers MUST ensure that the redirection URI used to obtain the authorization code, is the same as the redirection URI provided when exchanging the authorization code for an access token. The authorization server SHOULD require the client to register their redirection URI and if provided, MUST validate the redirection URI received in the authorization request against the registered value.  </p>
<h1 id="rfc.section.10.7">
<a href="#rfc.section.10.7">10.7.</a> Resource Owner Password Credentials</h1>
<p id="rfc.section.10.7.p.1">The resource owner password credentials grant type is often used for legacy or migration reasons. It reduces the overall risk of storing username and password by the client, but does not eliminate the need to expose highly privileged credentials to the client.  </p>
<p id="rfc.section.10.7.p.2">This grant type carries a higher risk than other grant types because it maintains the password anti-pattern this protocol seeks to avoid. The client could abuse the password or the password could unintentionally be disclosed to an attacker (e.g. via log files or other records kept by the client).  </p>
<p id="rfc.section.10.7.p.3">Additionally, because the resource owner does not have control over the authorization process (the resource owner involvement ends when it hands over its credentials to the client), the client can obtain access tokens with a broader scope and longer lifetime than desired by the resource owner. The authorization server SHOULD restrict the scope and lifetime of access tokens issued via this grant type.  </p>
<p id="rfc.section.10.7.p.4">The authorization server and client SHOULD minimize use of this grant type and utilize other grant types whenever possible.  </p>
<h1 id="rfc.section.10.8">
<a href="#rfc.section.10.8">10.8.</a> Request Confidentiality</h1>
<p id="rfc.section.10.8.p.1">Access tokens, refresh tokens, resource owner passwords, and client credentials MUST NOT be transmitted in the clear. Authorization codes SHOULD NOT be transmitted in the clear.  </p>
<h1 id="rfc.section.10.9">
<a href="#rfc.section.10.9">10.9.</a> Endpoints Authenticity</h1>
<p id="rfc.section.10.9.p.1">In order to prevent man-in-the-middle and phishing attacks, the authorization server MUST implement and require TLS with server authentication as defined by <a href="#RFC2818">[RFC2818]</a> for any request sent to the authorization and token endpoints.  The client MUST validate the authorization server's TLS certificate in accordance with its requirements for server identity authentication.  </p>
<h1 id="rfc.section.10.10">
<a href="#rfc.section.10.10">10.10.</a> Credentials Guessing Attacks</h1>
<p id="rfc.section.10.10.p.1">The authorization server MUST prevent attackers from guessing access tokens, authorization codes, refresh tokens, resource owner passwords, and client credentials.  </p>
<p id="rfc.section.10.10.p.2">When generating tokens and other credentials not intended for handling by end-users, the authorization server MUST use a reasonable level of entropy in order to mitigate the risk of guessing attacks. The authorization server MUST utilize other means to protect credentials intended for end-user usage.  </p>
<h1 id="rfc.section.10.11">
<a href="#rfc.section.10.11">10.11.</a> Phishing Attacks</h1>
<p id="rfc.section.10.11.p.1">Wide deployment of this and similar protocols may cause end-users to become inured to the practice of being redirected to websites where they are asked to enter their passwords. If end-users are not careful to verify the authenticity of these websites before entering their credentials, it will be possible for attackers to exploit this practice to steal resource owners' passwords.  </p>
<p id="rfc.section.10.11.p.2">Service providers should attempt to educate end-users about the risks phishing attacks pose, and should provide mechanisms that make it easy for end-users to confirm the authenticity of their sites. Client developers should consider the security implications of how they interact with the user-agent (e.g., external, embedded), and the ability of the end-user to verify the authenticity of the authorization server.  </p>
<p id="rfc.section.10.11.p.3">To reduce the risk of phishing attacks, the authorization servers MUST utilize TLS on every endpoint used for end-user interaction.  </p>
<h1 id="rfc.section.10.12">
<a href="#rfc.section.10.12">10.12.</a> Cross-Site Request Forgery</h1>
<p id="rfc.section.10.12.p.1">Cross-site request forgery (CSRF) is a web-based attack whereby HTTP requests are transmitted from the user-agent of an end-user the server trusts or has authenticated.  CSRF attacks on the authorization endpoint can allow an attacker to obtain authorization without the consent of the resource owner.  </p>
<p id="rfc.section.10.12.p.2">The <samp>state</samp> request parameter SHOULD be used to mitigate against CSRF attacks, particularly for login CSRF attacks. CSRF attacks against the client's redirection URI allow an attacker to inject their own authorization code or access token, which can result in the client using an access token associated with the attacker's account rather than the victim's. Depending on the nature of the client and the protected resources, this can have undesirable and damaging effects.  </p>
<p id="rfc.section.10.12.p.3">It is strongly RECOMMENDED that the client includes the <samp>state</samp> request parameter with authorization requests to the authorization server. The <samp>state</samp> request parameter MUST contain a non-guessable value, and the client MUST keep it in a location accessible only by the client or the user-agent (i.e., protected by same-origin policy).  </p>
<p id="rfc.section.10.12.p.4">For example, using a DOM variable (protected by JavaScript or other DOM-binding language's enforcement of SOP [[ add reference ]]), HTTP cookie, or HTML5 client-side storage. The authorization server includes the value of the <samp>state</samp> parameter when redirecting the user-agent back to the client which MUST then ensure the received value matches the stored value.  </p>
<h1 id="rfc.section.10.13">
<a href="#rfc.section.10.13">10.13.</a> Clickjacking</h1>
<p id="rfc.section.10.13.p.1">[[ Rework to use specification terminology ]] </p>
<p id="rfc.section.10.13.p.2">Clickjacking is the process of tricking end-users into revealing confidential information or taking control of their device while clicking on seemingly innocuous web pages. In more detail, a malicious site loads the target site in a transparent iframe overlaid on top of a set of dummy buttons which are carefully constructed to be placed directly under important buttons on the target site. When a user clicks a visible button, they are actually clicking a button (such as an "Authorize" button) on the hidden page.  </p>
<p id="rfc.section.10.13.p.3">To prevent clickjacking (and phishing attacks), native applications SHOULD use external browsers instead of embedding browsers in an iframe when requesting end-user authorization. For newer browsers, avoidance of iframes can be enforced by the authorization server using the <samp>x-frame-options</samp> header [[ Add reference ]]. This header can have two values, <samp>deny</samp> and <samp>sameorigin</samp>, which will block any framing or framing by sites with a different origin, respectively. For older browsers, javascript framebusting techniques can be used but may not be effective in all browsers.  </p>
<h1 id="rfc.section.10.14">
<a href="#rfc.section.10.14">10.14.</a> Code Injection and Input Validation</h1>
<p id="rfc.section.10.14.p.1">A code injection attack occurs when an input or otherwise external variable is used by an application in which that input can cause modification of the application logic when used unsanitized. This may allow an attacker to gain access to the application device or its data, cause denial of service, or a wide range of malicious side-effects.  </p>
<p id="rfc.section.10.14.p.2">The Authorization server and client MUST validate and sanitize any value received, and in particular, the value of the <samp>state</samp> and <samp>redirect_uri</samp> parameters.  </p>
<h1 id="rfc.section.11">
<a href="#rfc.section.11">11.</a> IANA Considerations</h1>
<h1 id="rfc.section.11.1">
<a href="#rfc.section.11.1">11.1.</a> <a href="#type-registry" id="type-registry">The OAuth Access Token Type Registry</a>
</h1>
<p id="rfc.section.11.1.p.1">This specification establishes the OAuth access token type registry.  </p>
<p id="rfc.section.11.1.p.2">Access token types are registered on the advice of one or more Designated Experts (appointed by the IESG or their delegate), with a Specification Required (using terminology from <a href="#RFC5226">[RFC5226]</a>). However, to allow for the allocation of values prior to publication, the Designated Expert(s) may approve registration once they are satisfied that such a specification will be published.  </p>
<p id="rfc.section.11.1.p.3">Registration requests should be sent to the [TBD]@ietf.org mailing list for review and comment, with an appropriate subject (e.g., "Request for access toke type: example").  [[ Note to RFC-EDITOR: The name of the mailing list should be determined in consultation with the IESG and IANA. Suggested name: oauth-ext-review. ]] </p>
<p id="rfc.section.11.1.p.4">Within at most 14 days of the request, the Designated Expert(s) will either approve or deny the registration request, communicating this decision to the review list and IANA.  Denials should include an explanation and, if applicable, suggestions as to how to make the request successful.  </p>
<p id="rfc.section.11.1.p.5">Decisions (or lack thereof) made by the Designated Expert can be first appealed to Application Area Directors (contactable using app-ads@tools.ietf.org email address or directly by looking up their email addresses on http://www.iesg.org/ website) and, if the appellant is not satisfied with the response, to the full IESG (using the iesg@iesg.org mailing list).  </p>
<p id="rfc.section.11.1.p.6">IANA should only accept registry updates from the Designated Expert(s), and should direct all requests for registration to the review mailing list.  </p>
<h1 id="rfc.section.11.1.1">
<a href="#rfc.section.11.1.1">11.1.1.</a> Registration Template</h1>
<p></p>

<dl>
<dt>Type name:</dt>
<dd style="margin-left: 8">
<br> The name requested (e.g., "example").  </dd>
<dt>Additional Token Endpoint Response Parameters:</dt>
<dd style="margin-left: 8">
<br> Additional response parameters returned together with the <samp>access_token</samp> parameter. New parameters MUST be separately registered in the OAuth parameters registry as described by <a href="#parameters-registry">Section 11.2</a>.  </dd>
<dt>HTTP Authentication Scheme(s):</dt>
<dd style="margin-left: 8">
<br> The HTTP authentication scheme name(s), if any, used to authenticate protected resources requests using access token of this type.  </dd>
<dt>Change controller:</dt>
<dd style="margin-left: 8">
<br> For standards-track RFCs, state "IETF". For others, give the name of the responsible party. Other details (e.g., postal address, e-mail address, home page URI) may also be included.  </dd>
<dt>Specification document(s):</dt>
<dd style="margin-left: 8">
<br> Reference to document that specifies the parameter, preferably including a URI that can be used to retrieve a copy of the document. An indication of the relevant sections may also be included, but is not required.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.11.2">
<a href="#rfc.section.11.2">11.2.</a> <a href="#parameters-registry" id="parameters-registry">The OAuth Parameters Registry</a>
</h1>
<p id="rfc.section.11.2.p.1">This specification establishes the OAuth parameters registry.  </p>
<p id="rfc.section.11.2.p.2">Additional parameters for inclusion in the authorization endpoint request, the authorization endpoint response, the token endpoint request, or the token endpoint response, are registered on the advice of one or more Designated Experts (appointed by the IESG or their delegate), with a Specification Required (using terminology from <a href="#RFC5226">[RFC5226]</a>). However, to allow for the allocation of values prior to publication, the Designated Expert(s) may approve registration once they are satisfied that such a specification will be published.  </p>
<p id="rfc.section.11.2.p.3">Registration requests should be sent to the [TBD]@ietf.org mailing list for review and comment, with an appropriate subject (e.g., "Request for parameter: example").  [[ Note to RFC-EDITOR: The name of the mailing list should be determined in consultation with the IESG and IANA. Suggested name: oauth-ext-review. ]] </p>
<p id="rfc.section.11.2.p.4">Within at most 14 days of the request, the Designated Expert(s) will either approve or deny the registration request, communicating this decision to the review list and IANA.  Denials should include an explanation and, if applicable, suggestions as to how to make the request successful.  </p>
<p id="rfc.section.11.2.p.5">Decisions (or lack thereof) made by the Designated Expert can be first appealed to Application Area Directors (contactable using app-ads@tools.ietf.org email address or directly by looking up their email addresses on http://www.iesg.org/ website) and, if the appellant is not satisfied with the response, to the full IESG (using the iesg@iesg.org mailing list).  </p>
<p id="rfc.section.11.2.p.6">IANA should only accept registry updates from the Designated Expert(s), and should direct all requests for registration to the review mailing list.  </p>
<h1 id="rfc.section.11.2.1">
<a href="#rfc.section.11.2.1">11.2.1.</a> Registration Template</h1>
<p></p>

<dl>
<dt>Parameter name:</dt>
<dd style="margin-left: 8">
<br> The name requested (e.g., "example").  </dd>
<dt>Parameter usage location:</dt>
<dd style="margin-left: 8">
<br> The location(s) where parameter can be used. The possible locations are: authorization request, authorization response, token request, or token response.  </dd>
<dt>Change controller:</dt>
<dd style="margin-left: 8">
<br> For standards-track RFCs, state "IETF". For others, give the name of the responsible party. Other details (e.g., postal address, e-mail address, home page URI) may also be included.  </dd>
<dt>Specification document(s):</dt>
<dd style="margin-left: 8">
<br> Reference to document that specifies the parameter, preferably including a URI that can be used to retrieve a copy of the document. An indication of the relevant sections may also be included, but is not required.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.11.2.2">
<a href="#rfc.section.11.2.2">11.2.2.</a> Initial Registry Contents</h1>
<p id="rfc.section.11.2.2.p.1">The OAuth Parameters Registry's initial contents are: </p>
<p></p>

<ul>
<li>Parameter name: client_id </li>
<li>Parameter usage location: authorization request, token request </li>
<li>Change controller: IETF </li>
<li>Specification document(s): [[ this document ]] </li>
</ul>

<p> </p>
<p></p>

<ul>
<li>Parameter name: client_secret </li>
<li>Parameter usage location: token request </li>
<li>Change controller: IETF </li>
<li>Specification document(s): [[ this document ]] </li>
</ul>

<p> </p>
<p></p>

<ul>
<li>Parameter name: response_type </li>
<li>Parameter usage location: authorization request </li>
<li>Change controller: IETF </li>
<li>Specification document(s): [[ this document ]] </li>
</ul>

<p> </p>
<p></p>

<ul>
<li>Parameter name: redirect_uri </li>
<li>Parameter usage location: authorization request, token request </li>
<li>Change controller: IETF </li>
<li>Specification document(s): [[ this document ]] </li>
</ul>

<p> </p>
<p></p>

<ul>
<li>Parameter name: scope </li>
<li>Parameter usage location: authorization request, authorization response, token request, token response </li>
<li>Change controller: IETF </li>
<li>Specification document(s): [[ this document ]] </li>
</ul>

<p> </p>
<p></p>

<ul>
<li>Parameter name: state </li>
<li>Parameter usage location: authorization request, authorization response </li>
<li>Change controller: IETF </li>
<li>Specification document(s): [[ this document ]] </li>
</ul>

<p> </p>
<p></p>

<ul>
<li>Parameter name: code </li>
<li>Parameter usage location: authorization response, token request </li>
<li>Change controller: IETF </li>
<li>Specification document(s): [[ this document ]] </li>
</ul>

<p> </p>
<p></p>

<ul>
<li>Parameter name: error_description </li>
<li>Parameter usage location: authorization response, token response </li>
<li>Change controller: IETF </li>
<li>Specification document(s): [[ this document ]] </li>
</ul>

<p> </p>
<p></p>

<ul>
<li>Parameter name: error_uri </li>
<li>Parameter usage location: authorization response, token response </li>
<li>Change controller: IETF </li>
<li>Specification document(s): [[ this document ]] </li>
</ul>

<p> </p>
<p></p>

<ul>
<li>Parameter name: grant_type </li>
<li>Parameter usage location: token request </li>
<li>Change controller: IETF </li>
<li>Specification document(s): [[ this document ]] </li>
</ul>

<p> </p>
<p></p>

<ul>
<li>Parameter name: access_token </li>
<li>Parameter usage location: authorization response, token response </li>
<li>Change controller: IETF </li>
<li>Specification document(s): [[ this document ]] </li>
</ul>

<p> </p>
<p></p>

<ul>
<li>Parameter name: token_type </li>
<li>Parameter usage location: authorization response, token response </li>
<li>Change controller: IETF </li>
<li>Specification document(s): [[ this document ]] </li>
</ul>

<p> </p>
<p></p>

<ul>
<li>Parameter name: expires_in </li>
<li>Parameter usage location: authorization response, token response </li>
<li>Change controller: IETF </li>
<li>Specification document(s): [[ this document ]] </li>
</ul>

<p> </p>
<p></p>

<ul>
<li>Parameter name: username </li>
<li>Parameter usage location: token request </li>
<li>Change controller: IETF </li>
<li>Specification document(s): [[ this document ]] </li>
</ul>

<p> </p>
<p></p>

<ul>
<li>Parameter name: password </li>
<li>Parameter usage location: token request </li>
<li>Change controller: IETF </li>
<li>Specification document(s): [[ this document ]] </li>
</ul>

<p> </p>
<p></p>

<ul>
<li>Parameter name: refresh_token </li>
<li>Parameter usage location: token request, token response </li>
<li>Change controller: IETF </li>
<li>Specification document(s): [[ this document ]] </li>
</ul>

<p> </p>
<h1 id="rfc.section.11.3">
<a href="#rfc.section.11.3">11.3.</a> <a href="#response-type-registry" id="response-type-registry">The OAuth Authorization Endpoint Response Type Registry</a>
</h1>
<p id="rfc.section.11.3.p.1">This specification establishes the OAuth authorization endpoint response type registry.  </p>
<p id="rfc.section.11.3.p.2">Additional response type for use with the authorization endpoint are registered on the advice of one or more Designated Experts (appointed by the IESG or their delegate), with a Specification Required (using terminology from <a href="#RFC5226">[RFC5226]</a>). However, to allow for the allocation of values prior to publication, the Designated Expert(s) may approve registration once they are satisfied that such a specification will be published.  </p>
<p id="rfc.section.11.3.p.3">Registration requests should be sent to the [TBD]@ietf.org mailing list for review and comment, with an appropriate subject (e.g., "Request for response type: example").  [[ Note to RFC-EDITOR: The name of the mailing list should be determined in consultation with the IESG and IANA. Suggested name: oauth-ext-review. ]] </p>
<p id="rfc.section.11.3.p.4">Within at most 14 days of the request, the Designated Expert(s) will either approve or deny the registration request, communicating this decision to the review list and IANA.  Denials should include an explanation and, if applicable, suggestions as to how to make the request successful.  </p>
<p id="rfc.section.11.3.p.5">Decisions (or lack thereof) made by the Designated Expert can be first appealed to Application Area Directors (contactable using app-ads@tools.ietf.org email address or directly by looking up their email addresses on http://www.iesg.org/ website) and, if the appellant is not satisfied with the response, to the full IESG (using the iesg@iesg.org mailing list).  </p>
<p id="rfc.section.11.3.p.6">IANA should only accept registry updates from the Designated Expert(s), and should direct all requests for registration to the review mailing list.  </p>
<h1 id="rfc.section.11.3.1">
<a href="#rfc.section.11.3.1">11.3.1.</a> Registration Template</h1>
<p></p>

<dl>
<dt>Response type name:</dt>
<dd style="margin-left: 8">
<br> The name requested (e.g., "example").  </dd>
<dt>Change controller:</dt>
<dd style="margin-left: 8">
<br> For standards-track RFCs, state "IETF". For others, give the name of the responsible party. Other details (e.g., postal address, e-mail address, home page URI) may also be included.  </dd>
<dt>Specification document(s):</dt>
<dd style="margin-left: 8">
<br> Reference to document that specifies the type, preferably including a URI that can be used to retrieve a copy of the document. An indication of the relevant sections may also be included, but is not required.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.11.3.2">
<a href="#rfc.section.11.3.2">11.3.2.</a> Initial Registry Contents</h1>
<p id="rfc.section.11.3.2.p.1">The OAuth Authorization Endpoint Response Type Registry's initial contents are: </p>
<p></p>

<ul>
<li>Response type name: code </li>
<li>Change controller: IETF </li>
<li>Specification document(s): [[ this document ]] </li>
</ul>

<p> </p>
<p></p>

<ul>
<li>Response type name: token </li>
<li>Change controller: IETF </li>
<li>Specification document(s): [[ this document ]] </li>
</ul>

<p> </p>
<h1 id="rfc.section.11.4">
<a href="#rfc.section.11.4">11.4.</a> <a href="#error-registry" id="error-registry">The OAuth Extensions Error Registry</a>
</h1>
<p id="rfc.section.11.4.p.1">This specification establishes the OAuth extensions error registry.  </p>
<p id="rfc.section.11.4.p.2">Additional error codes used together with other protocol extensions (i.e. extension grant types, access token types, or extension parameters) are registered on the advice of one or more Designated Experts (appointed by the IESG or their delegate), with a Specification Required (using terminology from <a href="#RFC5226">[RFC5226]</a>). However, to allow for the allocation of values prior to publication, the Designated Expert(s) may approve registration once they are satisfied that such a specification will be published.  </p>
<p id="rfc.section.11.4.p.3">Registration requests should be sent to the [TBD]@ietf.org mailing list for review and comment, with an appropriate subject (e.g., "Request for error code: example").  [[ Note to RFC-EDITOR: The name of the mailing list should be determined in consultation with the IESG and IANA. Suggested name: oauth-ext-review. ]] </p>
<p id="rfc.section.11.4.p.4">Within at most 14 days of the request, the Designated Expert(s) will either approve or deny the registration request, communicating this decision to the review list and IANA.  Denials should include an explanation and, if applicable, suggestions as to how to make the request successful.  </p>
<p id="rfc.section.11.4.p.5">Decisions (or lack thereof) made by the Designated Expert can be first appealed to Application Area Directors (contactable using app-ads@tools.ietf.org email address or directly by looking up their email addresses on http://www.iesg.org/ website) and, if the appellant is not satisfied with the response, to the full IESG (using the iesg@iesg.org mailing list).  </p>
<p id="rfc.section.11.4.p.6">IANA should only accept registry updates from the Designated Expert(s), and should direct all requests for registration to the review mailing list.  </p>
<h1 id="rfc.section.11.4.1">
<a href="#rfc.section.11.4.1">11.4.1.</a> Registration Template</h1>
<p></p>

<dl>
<dt>Error name:</dt>
<dd style="margin-left: 8">
<br> The name requested (e.g., "example").  </dd>
<dt>Error usage location:</dt>
<dd style="margin-left: 8">
<br> The location(s) where the error can be used. The possible locations are: authorization code grant error response (<a href="#code-authz-error">Section 4.1.2.1</a>), implicit grant error response (<a href="#implicit-authz-error">Section 4.2.2.1</a>), or token error response (<a href="#token-errors">Section 5.2</a>).  </dd>
<dt>Related protocol extension:</dt>
<dd style="margin-left: 8">
<br> The name of the extension grant type, access token type, or extension parameter, the error code is used in conjunction with.  </dd>
<dt>Change controller:</dt>
<dd style="margin-left: 8">
<br> For standards-track RFCs, state "IETF". For others, give the name of the responsible party. Other details (e.g., postal address, e-mail address, home page URI) may also be included.  </dd>
<dt>Specification document(s):</dt>
<dd style="margin-left: 8">
<br> Reference to document that specifies the error code, preferably including a URI that can be used to retrieve a copy of the document. An indication of the relevant sections may also be included, but is not required.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.12">
<a href="#rfc.section.12">12.</a> Acknowledgements</h1>
<p id="rfc.section.12.p.1">The initial OAuth 2.0 protocol specification was edited by David Recordon, based on two previous publications: the OAuth 1.0 community specification <a href="#RFC5849">[RFC5849]</a>, and OAuth WRAP (OAuth Web Resource Authorization Profiles) <a href="#I-D.draft-hardt-oauth-01">[I-D.draft-hardt-oauth-01]</a>. The Security Considerations section was drafted by Torsten Lodderstedt, Mark McGloin, Phil Hunt, and Anthony Nadalin.  </p>
<p id="rfc.section.12.p.2">The OAuth 1.0 community specification was edited by Eran Hammer-Lahav and authored by Mark Atwood, Dirk Balfanz, Darren Bounds, Richard M. Conlan, Blaine Cook, Leah Culver, Breno de Medeiros, Brian Eaton, Kellan Elliott-McCrea, Larry Halff, Eran Hammer-Lahav, Ben Laurie, Chris Messina, John Panzer, Sam Quigley, David Recordon, Eran Sandler, Jonathan Sergent, Todd Sieling, Brian Slesinsky, and Andy Smith.  </p>
<p id="rfc.section.12.p.3">The OAuth WRAP specification was edited by Dick Hardt and authored by Brian Eaton, Yaron Goland, Dick Hardt, and Allen Tom.  </p>
<p id="rfc.section.12.p.4">This specification is the work of the OAuth Working Group which includes dozens of active and dedicated participants. In particular, the following individuals contributed ideas, feedback, and wording which shaped and formed the final specification: </p>
<p id="rfc.section.12.p.5">Michael Adams, Andrew Arnott, Dirk Balfanz, Aiden Bell, Scott Cantor, Marcos Caceres, Blaine Cook, Brian Campbell, Brian Eaton, Leah Culver, Bill de h&#211;ra, Brian Eaton, Brian Ellin, Igor Faynberg, George Fletcher, Tim Freeman, Evan Gilbert, Yaron Goland, Brent Goldman, Kristoffer Gronowski, Justin Hart, Dick Hardt, Craig Heath, Phil Hunt, Michael B. Jones, John Kemp, Mark Kent, Raffi Krikorian, Chasen Le Hara, Rasmus Lerdorf, Torsten Lodderstedt, Hui-Lan Lu, Paul Madsen, Alastair Mair, Eve Maler, James Manger, Mark McGloin, Laurence Miao, Chuck Mortimore, Anthony Nadalin, Justin Richer, Peter Saint-Andre, Nat Sakimura, Rob Sayre, Marius Scurtescu, Naitik Shah, Luke Shepard, Vlad Skvortsov, Justin Smith, Jeremy Suriel, Christian St&#252;bner, Paul Tarjan, Allen Tom, Franklin Tse, Nick Walker, Shane Weeden, and Skylar Woodward.  </p>
<h1 id="rfc.references">
<a href="#rfc.references">13.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">13.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2616">[RFC2616]</b></td>
<td class="top">
<a href="mailto:fielding@ics.uci.edu" title="Department of Information and Computer Science">Fielding, R.</a>, <a href="mailto:jg@w3.org" title="World Wide Web Consortium">Gettys, J.</a>, <a href="mailto:mogul@wrl.dec.com" title="Compaq Computer Corporation">Mogul, J.</a>, <a href="mailto:frystyk@w3.org" title="World Wide Web Consortium">Frystyk, H.</a>, <a href="mailto:masinter@parc.xerox.com" title="Xerox Corporation">Masinter, L.</a>, <a href="mailto:paulle@microsoft.com" title="Microsoft Corporation">Leach, P.</a> and <a href="mailto:timbl@w3.org" title="World Wide Web Consortium">T. Berners-Lee</a>, "<a href="http://tools.ietf.org/html/rfc2616">Hypertext Transfer Protocol -- HTTP/1.1</a>", RFC 2616, June 1999.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2617">[RFC2617]</b></td>
<td class="top">
<a href="mailto:john@math.nwu.edu" title="Northwestern University, Department of Mathematics">Franks, J.</a>, <a href="mailto:pbaker@verisign.com" title="Verisign Inc.">Hallam-Baker, P.M.</a>, <a href="mailto:jeff@AbiSource.com" title="AbiSource, Inc.">Hostetler, J.L.</a>, <a href="mailto:lawrence@agranat.com" title="Agranat Systems, Inc.">Lawrence, S.D.</a>, <a href="mailto:paulle@microsoft.com" title="Microsoft Corporation">Leach, P.J.</a>, <a title="Netscape Communications Corporation">Luotonen, A.</a> and <a href="mailto:stewart@OpenMarket.com" title="Open Market, Inc.">L. Stewart</a>, "<a href="http://tools.ietf.org/html/rfc2617">HTTP Authentication: Basic and Digest Access Authentication</a>", RFC 2617, June 1999.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2818">[RFC2818]</b></td>
<td class="top">
<a>Rescorla, E.</a>, "<a href="http://tools.ietf.org/html/rfc2818">HTTP Over TLS</a>", RFC 2818, May 2000.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3986">[RFC3986]</b></td>
<td class="top">
<a href="mailto:timbl@w3.org" title="World Wide Web Consortium">Berners-Lee, T.</a>, <a href="mailto:fielding@gbiv.com" title="Day Software">Fielding, R.</a> and <a href="mailto:LMM@acm.org" title="Adobe Systems Incorporated">L. Masinter</a>, "<a href="http://tools.ietf.org/html/rfc3986">Uniform Resource Identifier (URI): Generic Syntax</a>", STD 66, RFC 3986, January 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4627">[RFC4627]</b></td>
<td class="top">
<a>Crockford, D.</a>, "<a href="http://tools.ietf.org/html/rfc4627">The application/json Media Type for JavaScript Object Notation (JSON)</a>", RFC 4627, July 2006.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4949">[RFC4949]</b></td>
<td class="top">
<a>Shirey, R.</a>, "<a href="http://tools.ietf.org/html/rfc4949">Internet Security Glossary, Version 2</a>", RFC 4949, August 2007.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5226">[RFC5226]</b></td>
<td class="top">
<a>Narten, T.</a> and <a>H. Alvestrand</a>, "<a href="http://tools.ietf.org/html/rfc5226">Guidelines for Writing an IANA Considerations Section in RFCs</a>", BCP 26, RFC 5226, May 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5234">[RFC5234]</b></td>
<td class="top">
<a>Crocker, D.</a> and <a>P. Overell</a>, "<a href="http://tools.ietf.org/html/rfc5234">Augmented BNF for Syntax Specifications: ABNF</a>", STD 68, RFC 5234, January 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5246">[RFC5246]</b></td>
<td class="top">
<a>Dierks, T.</a> and <a>E. Rescorla</a>, "<a href="http://tools.ietf.org/html/rfc5246">The Transport Layer Security (TLS) Protocol Version 1.2</a>", RFC 5246, August 2008.</td>
</tr>
<tr>
<td class="reference"><b id="W3C.REC-html401-19991224">[W3C.REC-html401-19991224]</b></td>
<td class="top">
<a>Raggett, D.</a>, <a>Hors, A.</a> and <a>I. Jacobs</a>, "<a>HTML 4.01 Specification</a>", World Wide Web Consortium Recommendation REC-html401-19991224, December 1999.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">13.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC5849">[RFC5849]</b></td>
<td class="top">
<a>Hammer-Lahav, E.</a>, "<a href="http://tools.ietf.org/html/rfc5849">The OAuth 1.0 Protocol</a>", RFC 5849, April 2010.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-oauth-v2-bearer">[I-D.ietf-oauth-v2-bearer]</b></td>
<td class="top">
<a>Jones, M</a>, <a>Hardt, D</a> and <a>D Recordon</a>, "<a href="http://tools.ietf.org/html/draft-ietf-oauth-v2-bearer-04">The OAuth 2.0 Protocol: Bearer Tokens</a>", Internet-Draft draft-ietf-oauth-v2-bearer-04, March 2011.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-oauth-saml2-bearer">[I-D.ietf-oauth-saml2-bearer]</b></td>
<td class="top">
<a>Campbell, B</a> and <a>C Mortimore</a>, "<a href="http://tools.ietf.org/html/draft-ietf-oauth-saml2-bearer-03">SAML 2.0 Bearer Assertion Grant Type Profile for OAuth 2.0</a>", Internet-Draft draft-ietf-oauth-saml2-bearer-03, February 2011.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-oauth-v2-http-mac">[I-D.ietf-oauth-v2-http-mac]</b></td>
<td class="top">
<a>Hammer-Lahav, E</a>, <a>Barth, A</a> and <a>B Adida</a>, "<a href="http://tools.ietf.org/html/draft-ietf-oauth-v2-http-mac-00">HTTP Authentication: MAC Access Authentication</a>", Internet-Draft draft-ietf-oauth-v2-http-mac-00, May 2011.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-oauth-v2-threatmodel">[I-D.ietf-oauth-v2-threatmodel]</b></td>
<td class="top">
<a>Lodderstedt, T</a>, <a>McGloin, M</a> and <a>P Hunt</a>, "<a href="http://tools.ietf.org/html/draft-ietf-oauth-v2-threatmodel-00">OAuth 2.0 Threat Model and Security Considerations</a>", Internet-Draft draft-ietf-oauth-v2-threatmodel-00, July 2011.</td>
</tr>
<tr>
<td class="reference"><b id="OASIS.saml-core-2.0-os">[OASIS.saml-core-2.0-os]</b></td>
<td class="top">
<a href="mailto:cantor.2@osu.edu" title="Internet2">Cantor, S.</a>, <a href="mailto:John.Kemp@nokia.com" title="Nokia">Kemp, J.</a>, <a href="mailto:rphilpott@rsasecurity.com" title="RSA Security">Philpott, R.</a> and <a href="mailto:eve.maler@sun.com" title="Sun Microsystems">E. Maler</a>, "<a>Assertions and Protocol for the OASIS Security Assertion Markup Language (SAML) V2.0</a>", OASIS Standard saml-core-2.0-os, March 2005.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.draft-hardt-oauth-01">[I-D.draft-hardt-oauth-01]</b></td>
<td class="top">
<a>Hardt, D</a>, <a>Tom, A</a>, <a>Eaton, B</a> and <a>Y Goland</a>, "<a>OAuth Web Resource Authorization Profiles</a>", January 2010.</td>
</tr>
</tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Eran Hammer-Lahav</span> editor
	  <span class="n hidden">
		<span class="family-name">Hammer-Lahav</span>
	  </span>
	</span>
	<span class="org vcardline">Yahoo!</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:eran@hueniverse.com">eran@hueniverse.com</a></span>

<span class="vcardline">URI: <a href="http://hueniverse.com">http://hueniverse.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">David Recordon</span> 
	  <span class="n hidden">
		<span class="family-name">Recordon</span>
	  </span>
	</span>
	<span class="org vcardline">Facebook</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:dr@fb.com">dr@fb.com</a></span>

<span class="vcardline">URI: <a href="http://www.davidrecordon.com/">http://www.davidrecordon.com/</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Dick Hardt</span> 
	  <span class="n hidden">
		<span class="family-name">Hardt</span>
	  </span>
	</span>
	<span class="org vcardline">Microsoft</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:dick.hardt@gmail.com">dick.hardt@gmail.com</a></span>

<span class="vcardline">URI: <a href="http://dickhardt.org/">http://dickhardt.org/</a></span>

  </address>
</div>

</body>
</html>