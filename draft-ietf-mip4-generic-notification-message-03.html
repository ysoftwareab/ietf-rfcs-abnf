<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Generic Notification Message for Mobile IPv4</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Generic Notification Message for Mobile IPv4">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">MIP4 Working Group</td><td class="header">H. Deng</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">China Mobile</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">H. Levkowetz</td></tr>
<tr><td class="header">Expires: August 15, 2008</td><td class="header">Ericsson Research</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">V. Devarapalli</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Azaire Networks</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">S. Gundavelli</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Cisco Systems</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">B. Haley</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Hewlett-Packard Company</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">February 12, 2008</td></tr>
</table></td></tr></table>
<h1><br />Generic Notification Message for Mobile IPv4<br />draft-ietf-mip4-generic-notification-message-03.txt</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on August 15, 2008.</p>

<h3>Abstract</h3>

<p>This document specifies protocol enhancements that allow Mobile IPv4
      entities to send and receive explicit notification messages using a
      new Mobile IPv4 message type designed for this purpose.
      
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#sect.intro">1.</a>&nbsp;
Introduction<br />
<a href="#sect.term">2.</a>&nbsp;
Terminology<br />
<a href="#sect.scen">3.</a>&nbsp;
Notification message - Usage Scenario's<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sect.ha2mn">3.1.</a>&nbsp;
Notification message from a Home Agent to a Mobile Node<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sect.ha2mn.fa">3.1.1.</a>&nbsp;
Mobile Registered using a Foreign Agent Care-of Address<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sect.ha2mn.co">3.1.2.</a>&nbsp;
Mobile Registered using a Co-located Care-of Address<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sect.fa2mn">3.2.</a>&nbsp;
Notification message from a Foreign Agent to a Mobile Node<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sect.ha2fa">3.3.</a>&nbsp;
Notification message from a Home Agent to a Foreign Agent<br />
<a href="#sect.message">4.</a>&nbsp;
Generic Notification Message and Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor1">4.1.</a>&nbsp;
Generic Notification Message<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">4.2.</a>&nbsp;
Generic Notification Acknowledgment Message<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">4.3.</a>&nbsp;
Mobile Node Consideration<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">4.3.1.</a>&nbsp;
Receiving Generic Notification Messages<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">4.3.2.</a>&nbsp;
Sending Generic Notification Acknowledgement Message<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">4.4.</a>&nbsp;
Foreign Agent Consideration<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">4.4.1.</a>&nbsp;
Receiving Generic Notification Message<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">4.4.2.</a>&nbsp;
Sending Generic Notification Acknowledgement Messages<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">4.4.3.</a>&nbsp;
Sending Generic Notification Messages<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">4.4.4.</a>&nbsp;
Receiving Generic Notification Acknowledgement Messages<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">4.5.</a>&nbsp;
Home Agent Consideration<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">4.5.1.</a>&nbsp;
Sending Generic Notification Messages<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">4.5.2.</a>&nbsp;
Receiving Generic Notification Acknowledgement Messages<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">4.5.3.</a>&nbsp;
Receiving Generic Notification Messages<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">4.5.4.</a>&nbsp;
Sending Generic Notification Acknowledgement Messages<br />
<a href="#sect.usage">5.</a>&nbsp;
Usage Example<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor16">5.1.</a>&nbsp;
Revocation Extension<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor17">5.2.</a>&nbsp;
Generic String Extension<br />
<a href="#sect.sec">6.</a>&nbsp;
Security Considerations<br />
<a href="#sect.iana">7.</a>&nbsp;
IANA Considerations<br />
<a href="#rfc.references1">8.</a>&nbsp;
Normative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="sect.intro"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>In some situations, there is a need for Mobile IPv4 entities, such as the home agent,
      foreign agent and mobile node to send and receive asynchronous
      notification messages during a mobility session. The base Mobile IP
      Specification <a class='info' href='#RFC3344'>[RFC3344]<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a> does not have a provision for this.
      
</p>
<p>This document defines a generic message and a notification model that can
      be used by Mobile IPv4 entities to send various notifications.
      However, this specification does not define any specific
      notification message or the actions that the receiving entity is
      required to perform on receiving that message. Specific extensions
      and the corresponding handler actions are outside the scope of this document.
      
</p>
<a name="sect.term"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Terminology</h3>

<p>It is assumed that the reader is familiar with the terminology used
      in <a class='info' href='#RFC3543'>[RFC3543]<span> (</span><span class='info'>Glass, S. and M. Chandra, &ldquo;Registration Revocation in Mobile IPv4,&rdquo; August&nbsp;2003.</span><span>)</span></a>, <a class='info' href='#RFC4917'>[RFC4917]<span> (</span><span class='info'>Sastry, V., Leung, K., and A. Patel, &ldquo;Mobile IPv4 Message String Extension,&rdquo; June&nbsp;2007.</span><span>)</span></a>, <a class='info' href='#RFC3344'>[RFC3344]<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a>.  
      In addition, the following terms are defined: 
</p>
<p>Notification Message 
</p>
<p></p>
<blockquote class="text">
<p>A message from a mobility agent to a mobile node or other mobility
        agent to asynchronously notify it about an event that is relevant to
        the mobility service it is currently providing.  
</p>
</blockquote>

<p>The keywords "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
      "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
      document are to be interpreted as described in RFC 2119, <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.  
</p>
<a name="sect.scen"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Notification message - Usage Scenario's</h3>

<p>
   There are several scenarios where a mobility agent could 
   initiate notification events.  Some of these are described in the following  
   sections. 
      
</p>
<a name="sect.ha2mn"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Notification message from a Home Agent to a Mobile Node</h3>

<a name="sect.ha2mn.fa"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.1"></a><h3>3.1.1.&nbsp;
Mobile Registered using a Foreign Agent Care-of Address</h3>

<p>In this case, the home agent cannot directly notify the mobile node, but
          must send the notification via the foreign agent.  
</p><br /><hr class="insert" />
<a name="fig1"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
+----+    notification +----+ notification +----+
| MN |&lt;================| FA |&lt;=============| HA |
+----+                 +----+              +----+

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: Home Agent notifies Mobile Node through Foreign Agent&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="sect.ha2mn.co"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.2"></a><h3>3.1.2.&nbsp;
Mobile Registered using a Co-located Care-of Address</h3>

<p> In this case, the mobile node has registered with the home
          agent directly, so the notification message can go directly to the mobile node.

           
</p>
<p> The notification mechanism as specified here does not support the
          case of Co-located CoA mode with registration through a foreign agent  
          (due to the 'R' bit being set in the foreign agent's advertisement  
          messages). 
           
</p><br /><hr class="insert" />
<a name="fig2"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
+----+               notification         +----+
| MN |&lt;===================================| HA |
+----+                                    +----+

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;2: Home Agent directly notifies Mobile Node&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="sect.fa2mn"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Notification message from a Foreign Agent to a Mobile Node</h3>

<p>There are two cases where a foreign agent may send notification
        messages to a mobile node, one where it is relaying a message,  the other
        where the notification is triggered by a message from another network entity, for example
        a AAA node(notification messages between a AAA entity and the foreign agent
        could be based on RADIUS or Diameter, but this is out of scope for
        this document). If the notification is initiated by a foreign agent,
        the foreign agent may need to also notify the home agent about the event.
        
</p><br /><hr class="insert" />
<a name="fig3"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
+----+    notification +----+ notification +--------+
| MN |&lt;================| FA |&lt;=============| AAA/HA |
+----+                 +----+              +--------+
                         ||   notification +----+
                          ================&gt;| HA |
                                           +----+

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;3: Foreign Agent notifies Mobile Node&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="sect.ha2fa"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
Notification message from a Home Agent to a Foreign Agent</h3>

<p>The home agent may also need to send a notification to the foreign
        agent, but not to the mobile node, as illustrated below:    
</p><br /><hr class="insert" />
<a name="fig4"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
+----+ notification +----+
| FA |&lt;=============| HA |
+----+              +----+

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;4: Home Agent notifies Foreign Agent&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="sect.message"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Generic Notification Message and Considerations</h3>

<p>This section describes in detail the generic notification message,
      generic notification acknowledgement message, and some considerations
      related to the handling of these messages in the mobile node, foreign  
      agent and home agent. 

</p>
<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Generic Notification Message</h3>

<p>A generic notification message is sent by a mobility agent to
        inform another mobility agent, or a mobile node, of MIP-related information. 
        These messages must use the same IP and UDP headers
        as any previous Registration Request or Reply message to the same entity.
        The generic notification message is defined as follows: 
</p>
<p>IP Fields:
          </p>
<blockquote class="text"><dl>
<dt>  Source Address</dt>
<dd> Sender's address.  
</dd>
<dt>  Destination Address</dt>
<dd> Receiver's address.  
</dd>
</dl></blockquote><p>
        
</p>
<p>UDP Fields:
          </p>
<blockquote class="text"><dl>
<dt>  Source Port</dt>
<dd>variable.
</dd>
<dt>  Destination Port</dt>
<dd>Same as the last Registration
            Reply/Request message.
</dd>
</dl></blockquote><p>
        
</p>
<p>The UDP header is followed by the Mobile IP fields shown below:
        
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Type      |   Subtype     |      MD       |A|  Reserved   |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                         Home Address                          |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                      Home Agent Address                       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                        Care-of Address                        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   +                       Identification                          +
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   Extensions...
   +-+-+-+-+-+-+-+-+-+-+-+-+-

</pre></div>
<p>Type    (TBD)
</p>
<p>Subtype	

          </p>
<blockquote class="text">
<p>
               This field describes the particular type of notification
               which is carried in the notification message. 
               The following values are reserved in this document.
          
</p>
<p>  0   Reserved   
</p>
<p>  1   Information carried in Vendor specific extensions  
</p>
<p>
               The value 0 is reserved and should not be used. The value 1
      indicates that the actual information is carried in vendor
      specific extensions. Other values are reserved for future
      extensions.

          
</p>
</blockquote><p>


        
</p>
<p>MD: Message Direction        
          </p>
<blockquote class="text">
<p> This memo defines the semantics of the following MD field value: 
            
</p>
<p>  0   --   Message sent by the home agent to the mobile node    
</p>
<p>  1   --   Message sent by the home agent to the foreign agent  
</p>
<p>  2   --   Message sent by the mobile node to the home agent    
</p>
<p>  3   --   Message sent by the mobile node to the foreign agent 
</p>
<p>  4   --   Message sent by the foreign agent to the mobile node 
</p>
<p>  5   --   Message sent by the foreing agent to the home agent  
</p>
</blockquote><p>
        
</p>
<p>A        
          </p>
<blockquote class="text">
<p> This bit indicates whether the notification message MUST be acknowledged by 
            the recipient.  
</p>
<p> Set to "1" to indicate that acknowledgement is required.  
</p>
<p> Set to "0" to indicate that acknowledgement is optional. 
</p>
</blockquote><p>
        
</p>
<p>Reserved

          </p>
<blockquote class="text">
<p>
               MUST be sent as 0, and ignored when received.
          
</p>
</blockquote><p>
        
</p>
<p>Home Address

          </p>
<blockquote class="text">
<p>
               The home IP address of the mobile node.
          
</p>
</blockquote><p>
        
</p>
<p>Home Agent Address

          </p>
<blockquote class="text">
<p>
               The IP address of the mobile node's home agent.
          
</p>
</blockquote><p>
        
</p>
<p>Care-of Address

          </p>
<blockquote class="text">
<p>
               The mobile node's care-of address, either the Co-located Care-of Address
               or the foreign agent care-of address.
          
</p>
</blockquote><p>
        
</p>
<p>Identification

          </p>
<blockquote class="text">
<p>
               A 64-bit number, constructed by the sender, used for
               matching Generic Notification with Generic Notification
               Acknowledgement,  and for protecting against replay
               attacks of notification messages.  See Sections 5.4
               and 5.7 of <a class='info' href='#RFC3344'>[RFC3344]<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a>.
          
</p>
</blockquote><p>
        
</p>
<p>Extensions

          </p>
<blockquote class="text">
<p>
               The fixed portion of the Generic Notification Message is followed
               by one or more extensions which may be used with this message, and
               by one or more authentication extensions (as defined in Section
               3.5 of [RFC3344]).  See Sections 3.6.1.3 and 3.7.2.2 of <a class='info' href='#RFC3344'>[RFC3344]<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a> 
               for information on the relative order in which different
               extensions, when present, must be placed in a Generic Notification
               Message.
          
</p>
</blockquote><p>
        
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Generic Notification Acknowledgment Message</h3>

<p> A generic notification acknowledgement message is sent by mobility
        agents or mobile nodes to indicate the successful receipt of a generic
        notification message.  
</p>
<p>IP Fields:
          </p>
<blockquote class="text"><dl>
<dt>  Source Address</dt>
<dd> Typically copied from the
            destination address of the Generic Notification to which the agent
            is replying. 
</dd>
<dt>  Destination Address</dt>
<dd> Copied from the source address
            of the Generic Notification to which the agent is replying.  
</dd>
</dl></blockquote><p>
        
</p>
<p>UDP Fields:
          </p>
<blockquote class="text"><dl>
<dt>  Source Port</dt>
<dd>variable.
</dd>
<dt>  Destination Port</dt>
<dd>Copied from the source port of the
            corresponding Generic Notification. 
</dd>
</dl></blockquote><p>
        
</p>
<p> The UDP header is followed by the Mobile IP fields shown below:
        
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     Type      |   Subtype     |      MD       |    Reserved   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                         Home Address                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                       Home Agent Address                      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                         Care-of Address                       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+                       Identification                          +
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Extensions...
+-+-+-+-+-+-+-+-+-+-+-+-+-

</pre></div>
<p>Type     (TBD) 
</p>
<p>Subtype	

          </p>
<blockquote class="text">
<p> This field specifies the particular type of notification
          acknowledgement message.
          The following values are reserved in this document.
          
</p>
<p>  0   Reserved   
</p>
<p>  1   Information carried in Vendor specific extensions  
</p>
<p>
               The value 0 is reserved and should not be used. The value 1
      indicates that the actual information is carried in vendor
      specific extensions. Other values are reserved for future
      extensions.
           
</p>
</blockquote><p>

        
</p>
<p>MD: Message Direction        
          </p>
<blockquote class="text">
<p> This memo defines the semantics of the following MD field value: 
            
</p>
<p>  0   --   Message sent by the home agent to the mobile node    
</p>
<p>  1   --   Message sent by the home agent to the foreign agent  
</p>
<p>  2   --   Message sent by the mobile node to the home agent    
</p>
<p>  3   --   Message sent by the mobile node to the foreign agent 
</p>
<p>  4   --   Message sent by the foreign agent to the mobile node 
</p>
<p>  5   --   Message sent by the foreing agent to the home agent  
</p>
</blockquote><p>
        
</p>
<p>Reserved
          </p>
<blockquote class="text">
<p>
               MUST be sent as 0, and ignored when received.
          
</p>
</blockquote><p>

        
</p>
<p>Home Address

          </p>
<blockquote class="text">
<p> The home IP address of the mobile node.  
</p>
</blockquote><p>
        
</p>
<p>Home Agent Address

          </p>
<blockquote class="text">
<p> The IP address of the sender's home agent.
          
</p>
</blockquote><p>
        
</p>
<p>Care-of Address

          </p>
<blockquote class="text">
<p>
           The mobile node's care-of address, either the Co-located Care-of Address
           or the foreign agent care-of address.

          
</p>
</blockquote><p>
        
</p>
<p> Identification

          </p>
<blockquote class="text">
<p> A 64-bit number used for matching Generic Notification with
          Generic Notification Acknowledgement, and for protecting against
          replay attacks of generic notification messages. The value is based
          on the Identification field from the Generic Notification message
          from the sender, and on the style of replay protection used in the
          security context between the receiver and sender (defined by the
          mobility security association between them, and SPI value in the
          authorization-enabling extension).  See Sections 5.4 and 5.7 of <a class='info' href='#RFC3344'>[RFC3344]<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a>.  
</p>
</blockquote><p>
        
</p>
<p>Extensions

          </p>
<blockquote class="text">
<p> The fixed portion of the generic notification
          acknowledgement message is followed by one or more of the Extensions
          listed in Section 3.5 of <a class='info' href='#RFC3344'>[RFC3344]<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a>. See Sections 3.6.1.3
          and 3.7.2.2 of <a class='info' href='#RFC3344'>[RFC3344]<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a> for information on the relative
          order in which different extensions, when present, MUST be placed in a
          Generic Notification message.  
</p>
</blockquote><p>
        
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
Mobile Node Consideration</h3>

<p>It is possible that the mobile node MAY receive a
        generic notification message from a foreign agent or home agent. Both in
        the case of FA-CoA and Co-located CoA, the mobile node MAY reply with a Generic
        Notification Acknowledgement message based on the "A" flag in the notification
        message.  
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.1"></a><h3>4.3.1.&nbsp;
Receiving Generic Notification Messages</h3>

<p>  When the mobile node is using FA-CoA and receives a Notification
               message, if the "MD" value is 0, it means that the notification
               message came from the home agent. If the "MD" value is 4, the
               notification came from the foreign agent.
          
</p>
<p>If this notification message came from a foreign agent and the mobile node
          accepts the foreign agent's generic notification message, it will
          process the notification extension according to the specific rules for
          that extension.  After that, the mobile node MAY
          reply with a Generic Notification Acknowledgement message back to
          the foreign agent.  If the "A" flag is set in the notification message,
          then the mobile node MUST send the acknowledgement.
          
</p>
<p>If this notification message came from the home agent, relayed by the
          foreign agent, or is a Co-located CoA, the Mobile-Home Authentication
          extension MUST be checked and the mobile node MUST check the
          Authenticator value in the Extension.  If no Mobile-Home
          Authentication Extension is found, or if more than one Mobile-Home
          Authentication Extension is found, or if the Authenticator is
          invalid, the mobile node MUST silently discard the Notification
          message.  If the mobile node accepts the home agent's generic notification
          message, it will process it according to the specific rules for that
          extension.  After
          that, the mobile node MAY reply with a Generic Notification
          Acknowledgement message back to the home agent based on the "A" flag
          in the notification message.  
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.2"></a><h3>4.3.2.&nbsp;
Sending Generic Notification Acknowledgement Message</h3>

<p>Both in the case of a Co-located CoA and FA-CoA, the mobile node MAY
             reply with a Generic Notification Acknowledgement Message based
             on the "A" flag in the notification message as follows: 
          
</p>
<p>If the notification message was initiated from the foreign agent to the
             mobile node ("MD" value is set to 4), the ordering
             of the extension is: any non-authentication Extensions used
             only by the foreign agent, followed by The Mobile-Foreign
             Authentication extension defined in section 3.5.3 of <a class='info' href='#RFC3344'>[RFC3344]<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a>. 
          
</p>
<p>In the case of a FA-CoA, the source address is the mobile node's address, the
             destination address is the foreign agent's address. 
</p>
<p>If the notification message was initiated from the home agent to the
          mobile node ("MD" value is set to 0) and in the case of Co-located CoA, 
          the ordering of the extension is: any non-authentication Extensions used 
          only by the home agent, followed by the Mobile-Home Authentication extension 
          defined in section 3.5.2 of <a class='info' href='#RFC3344'>[RFC3344]<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a> 
</p>
<p> In the case of a FA-CoA, the source address is the mobile node's CoA address
          and the destination address is the home agent's address ("MD" value is set to 2),
          the ordering of the extension is: any non-authentication
          Extensions used only by the home agent, followed by the Mobile-Home
          Authentication Extension defined in section 3.5.2. of <a class='info' href='#RFC3344'>[RFC3344]<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a>,
          followed by any non-authentication Extensions used only by
          the foreign agent, followed by The Mobile-Foreign Authentication
          extension defined in section 3.5.3 of <a class='info' href='#RFC3344'>[RFC3344]<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a>.  
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4"></a><h3>4.4.&nbsp;
Foreign Agent Consideration</h3>

<p>    The foreign agent cannot only relay generic notification message from
          the home agent and mobile node, but it can also initiate a generic
          notification message to the mobile node or home agent, but only when there 
          is a binding for the mobile node.  
        
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.1"></a><h3>4.4.1.&nbsp;
Receiving Generic Notification Message</h3>

<p>  If the foreign agent receives a notification message, and the "MD" value is set to 0, 
          it means that the home agent is asking the foreign agent to relay
          the message to the mobile node.  Otherwise, it means that the target of the
          notification is the foreign agent.
          
</p>
<p> If the "MD" value is set to 1, the Foreign-Home
          Authentication extension MUST be checked, and the foreign agent MUST
          check the Authenticator value in the Extension.  If no Foreign-Home
          Authentication Extension is found, or if more than one Foreign-Home
          Authentication Extension is found, or if the Authenticator is
          invalid, the foreign agent MUST silently discard the Notification
          message.  If foreign agent accepts the home agent's generic
          notification message, it will process it based on the specific rules
          for that extension.  The foreign agent MAY then reply with a Generic
          Notification Acknowledgement message back to the home agent based on
          the "A" flag in the notification message.  
</p>
<p> If the "MD" value is set to 0, the Foreign-Home
          Authentication extension MUST be checked, and the foreign agent MUST
          check the Authenticator value in the Extension.  If no Foreign-Home
          Authentication Extension is found, or if more than one Foreign-Home
          Authentication Extension is found, or if the Authenticator is
          invalid, the foreign agent MUST silently discard the Notification
          message. If foreign agent accepts the home agent's generic
          notification message, it MUST relay the Generic Notification to the
          mobile node's home address as specified in the Home Address field of
          the Generic Notification.  The foreign agent MUST NOT modify any of
          the fields beginning with the fixed portion of the Generic
          Notification message through and including the Mobile-Home Authentication
          Extension or other authentication extension supplied by the home
          agent as an authorization-enabling extension for the mobile node.
          Furthermore, the foreign agent MUST process and remove any Extensions following
          the Mobile-Home Authentication Extension and MAY append any of its own
          non-authentication Extensions of relevance to the mobile node, if
          applicable, and MUST append the Mobile-Foreign Authentication
          Extension, if the foreign agent shares a mobility security
          association with the Mobile Node.  
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.2"></a><h3>4.4.2.&nbsp;
Sending Generic Notification Acknowledgement Messages</h3>

<p>    The foreign agent may need to either relay a Generic Notification
           Acknowledgemnt message between the mobile node and the home agent or
           send one as a response to a notification messsage that was sent to
           it.  In both cases, the Generic Notification Acknowledgement Message
           is defined as follows:
                  
</p>
<p> The source address is the foreign agent address, the destination
          address is home agent address. 
</p>
<p> If the foreign agent is only relaying this message to the home agent, the
          foreign agent it MUST NOT modify any of the fields beginning with the
          fixed portion of the Generic Notification Acknowledgement through and
          including the Mobile-Home Authentication Extension or other
          authentication extension supplied by the home agent as an
          authorization-enabling extension for the mobile node. Furthermore, the foreign
          agent MUST process and remove any Extensions following the
          Mobile-Home Authentication Extension and MAY append any of its own
          non-authentication Extensions of relevance to the home agent, if
          applicable. It MUST also append the Foreign-Home Authentication
          Extension, if the foreign agent shares a mobility security
          association with the home agent.  
</p>
<p> If the notification message is from the home agent to the
          foreign agent then the "MD" value is set to 1 and
          the ordering of the extension is: any non-authentication Extensions
          used only by the home agent, followed by The Foreign-Home
          Authentication extension defined in section 3.5.4 of <a class='info' href='#RFC3344'>[RFC3344]<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a>.  
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.3"></a><h3>4.4.3.&nbsp;
Sending Generic Notification Messages</h3>

<p> If the foreign agent is initiating a notification to the mobile node
          using the generic notification message, it MAY also
          notify the home agent as well.  
</p>
<p> In the message to the mobile node, the source address
          is the foreign agent address, the destination address is the mobile node's
          address, the "MD" value is set to 4, and the ordering
          of the extension is: the notification extension, followed by any
          non-authentication Extensions used only by the mobile node, followed
          by The Mobile-Foreign Authentication extension defined in section
          3.5.3 of <a class='info' href='#RFC3344'>[RFC3344]<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a>. Computing Authentication Extension
          Value is the same as section 3.5.1 of <a class='info' href='#RFC3344'>[RFC3344]<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a>
          except the payload is the notification other than registration.  
</p>
<p> In the message to the home agent, the source address is
          the foreign agent's address, the destination address is the home agent's address
          (the "MD" value is set to 5), and the ordering of the
          extension is: notification extension, followed by any non-authentication
          Extensions used only by the home agent, followed by The Foreign-Home
          Authentication extension defined in section 3.5.4 of <a class='info' href='#RFC3344'>[RFC3344]<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a>. Computing Authentication Extension Value is the
          same as section 3.5.1 of <a class='info' href='#RFC3344'>[RFC3344]<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a> except the payload
          is the notification other than registration.  
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.4"></a><h3>4.4.4.&nbsp;
Receiving Generic Notification Acknowledgement Messages</h3>

<p> In the case of a FA-CoA, if the foreign agent receives this message, and
          the "MD" value is set to 3, it means that the 
          notification acknowledgement message came from the
          mobile node, otherwise it came from the home agent.   
</p>
<p> If the "MD" value is set to 1,  and the foreign agent accepted
          this message, the Foreign-Home Authentication extension MUST be checked, 
          and the home agent MUST check the Authenticator value in the Extension.  
          If no Foreign-Home Authentication Extension is found, or if more than 
          one Foreign-Home Authentication Extension is found, or if the Authenticator is
          invalid, the foreign agent MUST silently discard the Notification
          Acknowledgement message. If the foreign agent accepted
          this message, the home agent MAY also process it based on the notification
          event. 
</p>
<p> If the "MD" value is set to 3,  and the foreign agent accepted
          this message, the Mobile-Foreign Authentication extension MUST be
          checked, and the foreign agent MUST check the Authenticator value in the
          Extension.  If no Mobile-Foreign Authentication Extension is found, or
          if more than one Mobile-Foreign Authentication Extension is found, or if
          the Authenticator is invalid, the foreign agent MUST silently discard
          the Notification Acknowledgement message.  If the foreign agent accepted
          this message, the foreign agent MAY also process it based on the notification
          event.  
</p>
<p> In the case of a FA-CoA and if the "MD" value is set to 2, if the foreign agent
          received this message, the Mobile-Foreign Authentication extension MUST be checked,
          and the foreign agent MUST check the Authenticator value in the Extension.
          If no Mobile-Foreign Authentication Extension is found, or if more than
          one Mobile-Foreign Authentication Extension is found, or if the
          Authenticator is invalid, the foreign agent MUST silently discard the
          Notification Acknowledgement message. If foreign agent accepted the mobile node's 
          Generic Notification Acknowledgement message, it MUST relay this message to the
          home agent.  The foreign agent MUST NOT modify any of the fields beginning with 
          the fixed portion of the Generic Notification Acknowledgement message through and 
          including the Mobile-Home Authentication Extension or other authentication extension
          supplied by the home agent as an authorization-enabling extension for the mobile node.
          Furthermore, the foreign agent MUST process and remove any Extensions following
          the Mobile-Home Authentication Extension and MAY append any of its own
          non-authentication Extensions of relevance to the home agent, if
          applicable, and MUST append the Foreign-Home Authentication
          Extension, if the foreign agent shares a mobility security
          association with the home agent. 
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5"></a><h3>4.5.&nbsp;
Home Agent Consideration</h3>

<p>The Home agent MAY initiate a generic notification message to both the mobile
        node and foreign agent, and it also MAY receive a generic notification
        acknowledgement message from both the foreign agent and mobile node.
        The home agent also MAY receive a generic notification message from the foreign
        agent, but only when there is a binding for a mobile node.  
        If the home agent receives a notification message from a foreign
        agent and there is no corresponding mobile node registration,
        the home agent should drop the notification message.

        
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5.1"></a><h3>4.5.1.&nbsp;
Sending Generic Notification Messages</h3>

<p>    In the case of a FA-CoA, the home agent may either send a notification
            message to notify the foreign agent, or have the foreign agent relay
            the notification message to the mobile node if the mobile node needs
            to be notified.
         
</p>
<p> If the message is from the home agent to the foreign agent, the
          source address is the home agent's address, and the destination address is
          the foreign agent's address 
</p>
<p> If the foreign agent is working only as a relay agent, the "MD"
          value is set to 0, and the ordering of the extension
          is: the notification extension, followed by any non-authentication
          extension expected to be used by mobile node, followed by Mobile-Home
          Authentication Extension defined in section 3.5.2. of <a class='info' href='#RFC3344'>[RFC3344]<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a>,  followed by any non-authentication Extensions
          used only by the foreign agent, followed by The Foreign-Home
          Authentication extension defined in section 3.5.4 of <a class='info' href='#RFC3344'>[RFC3344]<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a>.  Computing Authentication Extension Value is the
          same as section 3.5.1 of <a class='info' href='#RFC3344'>[RFC3344]<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a>.  
</p>
<p> If the foreign agent is the target of this
          notification message, then the "MD" value is set to 1, 
          and the ordering of the extension is:
          the notification extension, followed by any non-authentication
          Extensions used only by the foreign agent, followed by The
          Foreign-Home Authentication extension defined in section 3.5.4 of
          <a class='info' href='#RFC3344'>[RFC3344]<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a>. Computing Authentication Extension Value
          is the same as section 3.5.1 of <a class='info' href='#RFC3344'>[RFC3344]<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a>.  
</p>
<p>In the case of a Co-located CoA, the home agent MAY send a 
          notification message directly to the mobile node if it needs to be
          notified. The "MD" value is set to 0, and the ordering of the extension
          is: the notification extension, followed by any non-authentication
          extension expected to be used by mobile node, followed by Mobile-Home
          Authentication Extension defined in section 3.5.2. of <a class='info' href='#RFC3344'>[RFC3344]<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a>. 
         
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5.2"></a><h3>4.5.2.&nbsp;
Receiving Generic Notification Acknowledgement Messages</h3>

<p> In the case of a FA-CoA, if the home agent receives this message, and
          the "MD" value is set to 2, it means that the 
          notification acknowledgement message came from
          mobile node, otherwise it came from the foreign agent.    
</p>
<p> If the "MD" value is set to 5,  and the home agent accepted
          this message, the home agent MAY also process it based on the notification
          event. The Foreign-Home
          Authentication extension MUST be checked, and the home agent MUST check
          the Authenticator value in the Extension.  If no Foreign-Home
          Authentication Extension is found, or if more than one Foreign-Home
          Authentication Extension is found, or if the Authenticator is
          invalid, the home agent MUST silently discard the Notification
          Acknowledgement message. 
</p>
<p> If the "MD" value is set to 2,  and the home agent accepted
          this message, the Mobile-Home Authentication extension MUST be
          checked, and the home agent MUST check the Authenticator value in the
          Extension.  If no Mobile-Home Authentication Extension is found, or
          if more than one Mobile-Home Authentication Extension is found, or if
          the Authenticator is invalid, the home agent MUST silently discard
          the Notification Acknowledgement message.  If the home agent accepted
          this message, the home agent MAY also process it based on the notification
          event.  
</p>
<p> In the case of a Co-located CoA, if the home agent received this
          message, the Mobile-Home Authentication extension MUST be checked,
          and the home agent MUST check the Authenticator value in the Extension.
          If no Mobile-Home Authentication Extension is found, or if more than
          one Mobile-Home Authentication Extension is found, or if the
          Authenticator is invalid, the home agent MUST silently discard the
          Notification Acknowledgement message. 
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5.3"></a><h3>4.5.3.&nbsp;
Receiving Generic Notification Messages</h3>

<p> The home agent MAY receive a generic notification message sent
          from the foreign agent. When the home agent receives this message, the
          Foreign-Home Authentication extension MUST be checked, and the home agent
          MUST check the Authenticator value in the Extension.  If no
          Foreign-Home Authentication Extension is found, or if more than one
          Foreign-Home Authentication Extension is found, or if the
          Authenticator is invalid, the home agent MUST silently discard the
          Notification message. If home agent accepts the foreign agent's
          generic notification message, it will process it based on the
          notification extension. Furthermore, the home agent MAY reply with a Generic
          Notification Acknowledgement message back to the foreign agent based
          on the "A" flag in the notification message.  
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5.4"></a><h3>4.5.4.&nbsp;
Sending Generic Notification Acknowledgement Messages</h3>

<p> If the generic notification message came from the foreign
          agent only, the home agent MAY reply with a generic notification
          acknowledgement message to the foreign agent based on the "A" flag in the
          notification message.  If the "A" flag is set in the notification
          message, then the home agent MUST send a Notification Acknowledgement message. 
          The message is as follows: The source address is home agent's address, the destination
          address is the foreign agent's address, the "MD" value is set to 1.
          The ordering of the extension is: any non-authentication
          Extensions used only by the foreign agent, followed by The
          Foreign-Home Authentication extension defined in section 3.5.4 of
          <a class='info' href='#RFC3344'>[RFC3344]<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a>.  
</p>
<a name="sect.usage"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Usage Example</h3>

<p>There are several applications that could use this generic notification message.
      for example, during handover between CDMA 2000 1x EV-DO and Wireless LAN,
      the PPP resource of CDMA side have to be removed on the foreign agent (PDSN) to avoid
      over-charging subscribers. Other applications such as registration revocation, 
      home agent switch over, NEMO prefix changes, service or billing related events,
      load balancing where the home agent wants to move some of the registered mobile
      nodes to other home agents, service termination due to end of prepaid time, 
      and service interruption due to system maintenance. 
      
</p>
<p>Here we give a example of using revocation extension and describe
      some possible event which could use the generic string extension <a class='info' href='#RFC3344'>[RFC3344]<span> (</span><span class='info'>Perkins, C., &ldquo;IP Mobility Support for IPv4,&rdquo; August&nbsp;2002.</span><span>)</span></a>based on
      this notification mechanism also. There is also the possibility that this
      notification message could carry many extensions at once. A new VSE extension
      could be defined to support this notification message. 
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Revocation Extension</h3>

<p>If one agent wants to notify another agent about registration
        revocation <a class='info' href='#RFC3543'>[RFC3543]<span> (</span><span class='info'>Glass, S. and M. Chandra, &ldquo;Registration Revocation in Mobile IPv4,&rdquo; August&nbsp;2003.</span><span>)</span></a>, it could easily be carried by a generic notification
        message and generic notification acknowledgement by
        specifying the exact "Subtype" in the two messages.  
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Generic String Extension</h3>

<p>In some case, the home agent or foreign agent needs to notify the mobile
        node about service termination due to the end of prepaid time,  or service
        interruption due to system maintenance. This information could be
        defined based on a string <a class='info' href='#RFC4917'>[RFC4917]<span> (</span><span class='info'>Sastry, V., Leung, K., and A. Patel, &ldquo;Mobile IPv4 Message String Extension,&rdquo; June&nbsp;2007.</span><span>)</span></a>which is recognized by the mobile node easily.
        An example would be "Maintenance Stopping", "Prepaid Expire". These
        string MUST be strictly defined so they could be easily understood by all
        of the network entities. "Subtype" number would need to be decided by the working
        group.  
</p>
<a name="sect.sec"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Security Considerations</h3>

<p>     This specification operates in the security constraints and
  requirements of [RFC3344].  It extends the operations of mobile node,
  home agent and foreign agent defined in [RFC3344] to notify each
  other about some events.  The Generic Notification message defined
  in the specification could carry information that modifies the
  mobility bindings.  Therefore the message MUST be integrity
  protected.  Replay protection MUST also be guaranteed.
</p>
<p>
  RFC 3344 provides replay protection only for registration requests
  sent by the mobile node.  There is no mechanism for replay
  protection for messages initiated by a Foreign Agent. The 64-bit
  Identification field specified in this document for the Generic
  Notification message is used to provide replay protection for the
  notification messages initiated by the Foreign Agent.
 
</p>
<a name="sect.iana"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
IANA Considerations</h3>

<p> This document describes two new messages, the Generic
       Notification message, section 4.1 and the Generic Notification
       Acknowledgement message, section 4.2. These two messages 
       should be allocated from the same address space used by the
       Registration Request and Registration Reply messages in [RFC3344].
       The subtype of these two messages indicate what kind of information
       is carried and will be under assigned by IANA namespace.
      
</p>
<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>8.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3344">[RFC3344]</a></td>
<td class="author-text">Perkins, C., &ldquo;<a href="http://tools.ietf.org/html/rfc3344">IP Mobility Support for IPv4</a>,&rdquo; RFC&nbsp;3344, August&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3344.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3543">[RFC3543]</a></td>
<td class="author-text">Glass, S. and M. Chandra, &ldquo;<a href="http://tools.ietf.org/html/rfc3543">Registration Revocation in Mobile IPv4</a>,&rdquo; RFC&nbsp;3543, August&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3543.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4917">[RFC4917]</a></td>
<td class="author-text">Sastry, V., Leung, K., and A. Patel, &ldquo;<a href="http://tools.ietf.org/html/rfc4917">Mobile IPv4 Message String Extension</a>,&rdquo; RFC&nbsp;4917, June&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4917.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Hui Deng</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">China Mobile</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">53A,Xibianmennei Ave.,</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Xuanwu District,</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Beijing  100053</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">China</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:denghui@chinamobile.com">denghui@chinamobile.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Henrik Levkowetz</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Ericsson Research</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Torshamsgatan 23</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">S-164 80, Stockholm</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">SWEDEN</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:henrik@levkowetz.com">henrik@levkowetz.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Vijay Devarapalli</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Azaire Networks</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">4800 Great America Pkwy</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Santa Clara, CA  95054</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:vijay.devarapalli@azairenet.com">vijay.devarapalli@azairenet.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Sri Gundavelli</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">170 W.Tasman Drive</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">San Jose, CA  95134</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:sgundave@cisco.com">sgundave@cisco.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Brian Haley</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Hewlett-Packard Company</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">110 Spitbrook Road</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Nashua, NH  03062</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:brian.haley@hp.com">brian.haley@hp.com</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2008).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
