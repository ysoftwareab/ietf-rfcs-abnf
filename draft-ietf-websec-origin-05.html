<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>The Web Origin Concept </title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.2" rel="Chapter" title="2 Conventions">
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 Conformance Criteria">
<link href="#rfc.section.2.2" rel="Chapter" title="2.2 Syntax Notation">
<link href="#rfc.section.2.3" rel="Chapter" title="2.3 Terminology">
<link href="#rfc.section.3" rel="Chapter" title="3 Principles of the Same-Origin Policy">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 Trust">
<link href="#rfc.section.3.1.1" rel="Chapter" title="3.1.1 Pitfalls">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 Origin">
<link href="#rfc.section.3.2.1" rel="Chapter" title="3.2.1 Examples">
<link href="#rfc.section.3.3" rel="Chapter" title="3.3 Authority">
<link href="#rfc.section.3.3.1" rel="Chapter" title="3.3.1 Pitfalls">
<link href="#rfc.section.3.4" rel="Chapter" title="3.4 Policy">
<link href="#rfc.section.3.4.1" rel="Chapter" title="3.4.1 Object Access">
<link href="#rfc.section.3.4.2" rel="Chapter" title="3.4.2 Network Access">
<link href="#rfc.section.3.4.3" rel="Chapter" title="3.4.3 Pitfalls">
<link href="#rfc.section.3.5" rel="Chapter" title="3.5 Conclusion">
<link href="#rfc.section.4" rel="Chapter" title="4 Origin of a URI">
<link href="#rfc.section.5" rel="Chapter" title="5 Comparing Origins">
<link href="#rfc.section.6" rel="Chapter" title="6 Serializing Origins">
<link href="#rfc.section.6.1" rel="Chapter" title="6.1 Unicode Serialization of an Origin">
<link href="#rfc.section.6.2" rel="Chapter" title="6.2 ASCII Serialization of an Origin">
<link href="#rfc.section.7" rel="Chapter" title="7 The HTTP Origin header field">
<link href="#rfc.section.7.1" rel="Chapter" title="7.1 Syntax">
<link href="#rfc.section.7.2" rel="Chapter" title="7.2 Semantics">
<link href="#rfc.section.7.3" rel="Chapter" title="7.3 User Agent Requirements">
<link href="#rfc.section.8" rel="Chapter" title="8 Security Considerations">
<link href="#rfc.section.8.1" rel="Chapter" title="8.1 Reliance on DNS">
<link href="#rfc.section.8.2" rel="Chapter" title="8.2 Divergent Units of Isolation">
<link href="#rfc.section.8.3" rel="Chapter" title="8.3 Ambient Authority">
<link href="#rfc.section.9" rel="Chapter" title="9 IANA Considerations">
<link href="#rfc.section.9.1" rel="Chapter" title="9.1 Origin">
<link href="#rfc.section.10" rel="Chapter" title="10 IDNA dependency and migration">
<link href="#rfc.references" rel="Chapter" title="11 References">
<link href="#rfc.references.1" rel="Chapter" title="11.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="11.2 Informative References">
<link href="#rfc.appendix.Appendix%20A" rel="Chapter" title="Appendix A Acknowledgements">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="This document defines the concept of an "origin", which is often used as the scope of authority or privilege by user agents. Typically, user agents isolate content retrieved from different origins to prevent malicious web site operators from interfering with the operation of benign web sites. In addition to outlining the principles that underlie the concept of origin, this document defines how to determine the origin of a URI, how to serialize an origin into a string, and an HTTP header field, named "Origin", that indicates which origins are associated with an HTTP request." />
  <meta name="description" content="This document defines the concept of an "origin", which is often used as the scope of authority or privilege by user agents. Typically, user agents isolate content retrieved from different origins to prevent malicious web site operators from interfering with the operation of benign web sites. In addition to outlining the principles that underlie the concept of origin, this document defines how to determine the origin of a URI, how to serialize an origin into a string, and an HTTP header field, named "Origin", that indicates which origins are associated with an HTTP request." />
  <meta name="keywords" content="" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">websec</td>
<td class="right">A. Barth</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Google, Inc.</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">September 23, 2011</td>
</tr>
<tr>
<td class="left">Expires: March 26, 2012</td>
<td class="right"></td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">The Web Origin Concept <br />
  <span class="filename">draft-ietf-websec-origin-05</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>This document defines the concept of an "origin", which is often used as the scope of authority or privilege by user agents. Typically, user agents isolate content retrieved from different origins to prevent malicious web site operators from interfering with the operation of benign web sites. In addition to outlining the principles that underlie the concept of origin, this document defines how to determine the origin of a URI, how to serialize an origin into a string, and an HTTP header field, named "Origin", that indicates which origins are associated with an HTTP request.</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on March 26, 2012.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>2.   <a href="#rfc.section.2">Conventions</a>
</li>
<li>2.1.   <a href="#rfc.section.2.1">Conformance Criteria</a>
</li>
<li>2.2.   <a href="#rfc.section.2.2">Syntax Notation</a>
</li>
<li>2.3.   <a href="#rfc.section.2.3">Terminology</a>
</li>
<li>3.   <a href="#rfc.section.3">Principles of the Same-Origin Policy</a>
</li>
<li>3.1.   <a href="#rfc.section.3.1">Trust</a>
</li>
<li>3.1.1.   <a href="#rfc.section.3.1.1">Pitfalls</a>
</li>
<li>3.2.   <a href="#rfc.section.3.2">Origin</a>
</li>
<li>3.2.1.   <a href="#rfc.section.3.2.1">Examples</a>
</li>
<li>3.3.   <a href="#rfc.section.3.3">Authority</a>
</li>
<li>3.3.1.   <a href="#rfc.section.3.3.1">Pitfalls</a>
</li>
<li>3.4.   <a href="#rfc.section.3.4">Policy</a>
</li>
<li>3.4.1.   <a href="#rfc.section.3.4.1">Object Access</a>
</li>
<li>3.4.2.   <a href="#rfc.section.3.4.2">Network Access</a>
</li>
<li>3.4.3.   <a href="#rfc.section.3.4.3">Pitfalls</a>
</li>
<li>3.5.   <a href="#rfc.section.3.5">Conclusion</a>
</li>
<li>4.   <a href="#rfc.section.4">Origin of a URI</a>
</li>
<li>5.   <a href="#rfc.section.5">Comparing Origins</a>
</li>
<li>6.   <a href="#rfc.section.6">Serializing Origins</a>
</li>
<li>6.1.   <a href="#rfc.section.6.1">Unicode Serialization of an Origin</a>
</li>
<li>6.2.   <a href="#rfc.section.6.2">ASCII Serialization of an Origin</a>
</li>
<li>7.   <a href="#rfc.section.7">The HTTP Origin header field</a>
</li>
<li>7.1.   <a href="#rfc.section.7.1">Syntax</a>
</li>
<li>7.2.   <a href="#rfc.section.7.2">Semantics</a>
</li>
<li>7.3.   <a href="#rfc.section.7.3">User Agent Requirements</a>
</li>
<li>8.   <a href="#rfc.section.8">Security Considerations</a>
</li>
<li>8.1.   <a href="#rfc.section.8.1">Reliance on DNS</a>
</li>
<li>8.2.   <a href="#rfc.section.8.2">Divergent Units of Isolation</a>
</li>
<li>8.3.   <a href="#rfc.section.8.3">Ambient Authority</a>
</li>
<li>9.   <a href="#rfc.section.9">IANA Considerations</a>
</li>
<li>9.1.   <a href="#rfc.section.9.1">Origin</a>
</li>
<li>10.   <a href="#rfc.section.10">IDNA dependency and migration</a>
</li>
<li>11.   <a href="#rfc.references">References</a>
</li>
<li>11.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>11.2.   <a href="#rfc.references.2">Informative References</a>
</li>
<li>Appendix A.   <a href="#rfc.appendix.Appendix%20A">Acknowledgements</a>
</li>
<li><a href="#rfc.authors">Author's Address</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> <a href="#intro" id="intro">Introduction</a>
</h1>
<p id="rfc.section.1.p.1">User agents interact with content created by a large number of authors. Although many of those authors are well-meaning, some authors might be malicious. To the extent that user agents undertake actions based on content they process, user agent implementors might wish to restrict the ability of malicious authors to disrupt the confidentiality or integrity of other content or servers.</p>
<p id="rfc.section.1.p.2">As an example, consider an HTTP user agent that renders HTML content retrieved from various servers. If the user agent executes scripts contained in those documents, the user agent implementor might wish to prevent scripts retrieved from a malicious server from reading documents stored on an honest server, which might, for example, be behind a firewall.</p>
<p id="rfc.section.1.p.3">Traditionally, user agents have divided content according to its "origin". More specifically, user agents allow content retrieved from one origin to interact freely with other content retrieved from that origin, but user agents restrict how that content can interact with content from another origin.</p>
<p id="rfc.section.1.p.4">This document describes the principles behind the so-called same-origin policy as well as the "nuts and bolts" of comparing and serializing origins. This document does not describe all the facets of the same-origin policy, the details of which are left to other specifications, such as HTML <a href="#HTML">[HTML]</a> and WebSockets <a href="#WEBSOCKETS">[WEBSOCKETS]</a>, because the details are often application-specific.</p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> <a href="#conventions" id="conventions">Conventions</a>
</h1>
<h1 id="rfc.section.2.1">
<a href="#rfc.section.2.1">2.1.</a> <a href="#conformance-criteria" id="conformance-criteria">Conformance Criteria</a>
</h1>
<p id="rfc.section.2.1.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">[RFC2119]</a>.</p>
<p id="rfc.section.2.1.p.2">Requirements phrased in the imperative as part of algorithms (such as "strip any leading space characters" or "return false and abort these steps") are to be interpreted with the meaning of the key word ("MUST", "SHOULD", "MAY", etc) used in introducing the algorithm.</p>
<p id="rfc.section.2.1.p.3">Conformance requirements phrased as algorithms or specific steps can be implemented in any manner, so long as the end result is equivalent. In particular, the algorithms defined in this specification are intended to be easy to understand and are not intended to be performant.</p>
<h1 id="rfc.section.2.2">
<a href="#rfc.section.2.2">2.2.</a> <a href="#syntax-notation" id="syntax-notation">Syntax Notation</a>
</h1>
<p id="rfc.section.2.2.p.1">This specification uses the Augmented Backus-Naur Form (ABNF) notation of <a href="#RFC5234">[RFC5234]</a>.</p>
<p id="rfc.section.2.2.p.2">The following core rules are included by reference, as defined in <a href="#RFC5234">[RFC5234]</a>, Appendix B.1: ALPHA (letters), CR (carriage return), CRLF (CR LF), CTL (controls), DIGIT (decimal 0-9), DQUOTE (double quote), HEXDIG (hexadecimal 0-9/A-F/a-f), LF (line feed), OCTET (any 8-bit sequence of data), SP (space), HTAB (horizontal tab), CHAR (any US-ASCII character), VCHAR (any visible US-ASCII character), and WSP (whitespace).</p>
<div id="#rfc.figure.1"></div>
<pre>
OWS            = *( [ obs-fold ] WSP )
                 ; "optional" whitespace
obs-fold       = CRLF
          </pre>
<p id="rfc.section.2.2.p.3">The OWS (optional whitespace) rule is used where zero or more linear whitespace characters MAY appear: </p>
<h1 id="rfc.section.2.3">
<a href="#rfc.section.2.3">2.3.</a> <a href="#terminology" id="terminology">Terminology</a>
</h1>
<p id="rfc.section.2.3.p.1">The terms user agent, client, server, proxy, and origin server have the same meaning as in the HTTP/1.1 specification (<a href="#RFC2616">[RFC2616]</a>, Section 1.3).</p>
<p id="rfc.section.2.3.p.2">A globally unique identifier is a value which is different from all other previously existing values.  For example, a sufficiently long random string is likely to be a globally unique identifier. If the origin value never leaves the user agent, a monotonically increasing counter local to the user agent can also serve as a globally unique identifier</p>
<p id="rfc.section.2.3.p.3">For the purposes of this document, we define "idna-canonicalized host name" as the string generated by the following algorithm: </p>

<ol>
<li>Convert the host name to a sequence of NR-LDH labels (see Section 2.3.2.2 of <a href="#RFC5890">[RFC5890]</a>) and/or A-labels according to the appropriate IDNA specification <a href="#RFC5891">[RFC5891]</a> or <a href="#RFC3490">[RFC3490]</a> (see <a href="#idna-migration">Section 10</a> of this specification)</li>
<li>Convert the labels to lower case (using the i;ascii-casemap collation defined in <a href="#RFC4790">[RFC4790]</a>).</li>
<li>Concatenate the labels, separating each label from the next with a %x2E (".") character.</li>
</ol>

<p> </p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#principles" id="principles">Principles of the Same-Origin Policy</a>
</h1>
<p id="rfc.section.3.p.1">Many user agents undertake actions on behalf of remote parties. For example, HTTP user agents follow redirects, which are instructions from remote servers and HTML user agents expose rich DOM interfaces to scripts retrieved from remote servers.</p>
<p id="rfc.section.3.p.2">Without any security model, user agents might undertake actions detrimental to the user or to other parties. Over time, many web-related technologies have converged towards a common security model, known colloquially as the "same-origin policy". Although this security model evolved largely organically, the same-origin policy can be understood in terms of a handful of key concepts. This section presents those concepts and provides advice about how to use these concepts securely.</p>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> <a href="#trust" id="trust">Trust</a>
</h1>
<div id="#rfc.figure.2"></div>
<pre>
             
&lt;script src="https://example.com/library.js"&gt;&lt;/script&gt;
          
          </pre>
<p id="rfc.section.3.1.p.1">The same-origin policy specifies trust by URI. For example, HTML documents designate which script to run with a URI: </p>
<p id="rfc.section.3.1.p.2">When a user agent processes this element, the user agent will fetch the script at the designated URI and execute the script with the privileges of the document. In this way, the document grants all the privileges it has to the resource designated by the URI. In essence, the document declares that it trusts the integrity of information retrieved from that URI.</p>
<div id="#rfc.figure.3"></div>
<pre>
             
&lt;form method="POST" action="https://example.com/login"&gt;
 ... &lt;input type="password"&gt; ...
&lt;/form&gt;
          
          </pre>
<p id="rfc.section.3.1.p.3">In addition to importing libraries from URIs, user agents also send information to remote parties designated by URI. For example, consider the HTML form element: </p>
<p id="rfc.section.3.1.p.4">When the user enters his or her password and submits the form, the user agent sends the password to the network endpoint designated by the URI. In this way, the document exports its secret data to that URI, in essence declaring that it trusts the confidentiality of information sent to that URI.</p>
<h1 id="rfc.section.3.1.1">
<a href="#rfc.section.3.1.1">3.1.1.</a> Pitfalls</h1>
<p id="rfc.section.3.1.1.p.1">When designing new protocols that use the same-origin policy, make sure that important trust distinctions are visible in URIs. For example, if both TLS and non-TLS protected resources used the "http" URI scheme (as in <a href="#RFC2817">[RFC2817]</a>), a document would be unable to specify that it wished to retrieve a script only over TLS.  By using the "https" URI scheme, documents are able to indicate that they wish to interact with resources that are protected from active network attackers.</p>
<h1 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> <a href="#origin" id="origin">Origin</a>
</h1>
<p id="rfc.section.3.2.p.1">In principle, user agents could treat every URI as a separate protection domain and require explicit consent for content retrieved from one URI to interact with another URI. Unfortunately, this design is cumbersome for developers because web applications often consist of a number of resources acting in concert.</p>
<p id="rfc.section.3.2.p.2">Instead, user agents group URIs together into protection domains called "origins". Roughly speaking, two URIs are part of the same origin (i.e., represent the same principal) if they have the same scheme, host, and port. (See <a href="#origin-of-a-uri">Section 4</a> for full details.)</p>
<p id="rfc.section.3.2.p.3">Q: Why not just use the host?</p>
<p id="rfc.section.3.2.p.4">A: Including the scheme in the origin tuple is essential for security. If user agents did not include the scheme, there would be no isolation between http://example.com and https://example.com because the two have the same host. However, without this isolation, an active network attacker could corrupt content retrieved from http://example.com and have that content instruct the user agent to compromise the confidentiality and integrity of content retrieved from https://example.com, bypassing the protections afforded by TLS <a href="#RFC5246">[RFC5246]</a>.</p>
<p id="rfc.section.3.2.p.5">Q: Why use the fully qualified host name instead of just the "top-level" domain?</p>
<p id="rfc.section.3.2.p.6">A: Although the DNS has hierarchical delegation, the trust relationships between host names vary by deployment. For example, at many educational institutions, students can host content at https://example.edu/~student/, but that does not mean a document authored by a student should be part of the same origin (i.e., inhabit the same protection domain) as a web application for managing grades hosted at https://grades.example.edu/.</p>
<p id="rfc.section.3.2.p.7">The example.edu deployment illustrates that grouping resources by origin does not always align perfectly with every deployment scenario.  In this deployment every student's web site inhabits the same origin, which might not be desirable. In some sense, the origin granularity is a historical artifact of how the security model evolved.</p>
<h1 id="rfc.section.3.2.1">
<a href="#rfc.section.3.2.1">3.2.1.</a> Examples</h1>
<div id="#rfc.figure.4"></div>
<pre>
               
http://example.com/
http://example.com:80/
http://example.com/path/file
            
            </pre>
<p id="rfc.section.3.2.1.p.1">All of the following resources have the same origin: </p>
<div id="#rfc.figure.5"></div>
<pre>
               
http://example.com/
http://example.com:8080/
http://www.example.com/
https://example.com:80/
https://example.com/
http://example.org/
http://ietf.org/
            
            </pre>
<p id="rfc.section.3.2.1.p.2">Each of the following resources has a different origin from the others.  </p>
<h1 id="rfc.section.3.3">
<a href="#rfc.section.3.3">3.3.</a> <a href="#authority" id="authority">Authority</a>
</h1>
<p id="rfc.section.3.3.p.1">Although user agents group URIs into origins, not every resource in an origin carries the same authority (in the security sense of the word "authority", not in the <a href="#RFC3986">[RFC3986]</a> sense). For example, an image is passive content and, therefore, carries no authority, meaning the image has no access to the objects and resources available to its origin. By contrast, an HTML document carries the full authority of its origin and scripts within (or imported into) the document can access every resource in its origin.</p>
<p id="rfc.section.3.3.p.2">User agents determine how much authority to grant a resource by examining its media type. For example, resources with a media type of image/png are treated as images and resources with a media type of text/html are treated as HTML documents.</p>
<p id="rfc.section.3.3.p.3">When hosting untrusted content (such as user-generated content), web applications can limit that content&#8217;s authority by restricting its media type. For example, serving user-generated content as image/png is less risky than serving user-generated content as text/html. Of course many web applications incorporate untrusted content in their HTML documents. If not done carefully, these applications risk leaking their origin&#8217;s authority to the untrusted content, a vulnerability commonly known as cross-site scripting.</p>
<h1 id="rfc.section.3.3.1">
<a href="#rfc.section.3.3.1">3.3.1.</a> Pitfalls</h1>
<p id="rfc.section.3.3.1.p.1">When designing new pieces of the web platform, be careful not to grant authority to resources irrespective of media type. Many web applications serve untrusted content with restricted media types. A new web platform feature that grants authority to these pieces of content risks introducing vulnerabilities into existing applications. Instead, prefer to grant authority to media types that already possess the origin&#8217;s full authority or to new media types designed specifically to carry the new authority.</p>
<p id="rfc.section.3.3.1.p.2">In order to remain compatible with servers that supply incorrect media types, some user agents employ "content sniffing" and treat content as if it had a different media type than the media type supplied by the server. If not done carefully, content sniffing can lead to security vulnerabilities because user agents might grant low-authority media types, such as images, the privileges of high-authority media types, such as HTML documents <a href="#SNIFF">[SNIFF]</a>.</p>
<h1 id="rfc.section.3.4">
<a href="#rfc.section.3.4">3.4.</a> <a href="#policy" id="policy">Policy</a>
</h1>
<p id="rfc.section.3.4.p.1">Generally speaking, user agents isolate different origins and permit controlled communication between origins. The details of how user agents provide isolation and communication vary depending on several factors.</p>
<h1 id="rfc.section.3.4.1">
<a href="#rfc.section.3.4.1">3.4.1.</a> Object Access</h1>
<p id="rfc.section.3.4.1.p.1">Most objects (also known as application programming interfaces or APIs) exposed by the user agent are available only to the same origin. Specifically, content retrieved from one URI can access objects associated with content retrieved from another URI if, and only if, the two URIs belong to the same origin, e.g., have same scheme, host, and port.</p>
<p id="rfc.section.3.4.1.p.2">There are some exceptions to this general rule. For example, some parts of HTML&#8217;s Location interface are available across origins (e.g., to allow for navigating other browsing contexts). As another example, HTML&#8217;s postMessage interface is visible across origins explicitly to facilitate cross-origin communication. Exposing objects to foreign origins is dangerous and should be done only with great care because doing so exposes these objects to potential attackers.</p>
<h1 id="rfc.section.3.4.2">
<a href="#rfc.section.3.4.2">3.4.2.</a> Network Access</h1>
<p id="rfc.section.3.4.2.p.1">Access to network resources varies depending on whether the resources are in the same origin as the content attempting to access them.</p>
<p id="rfc.section.3.4.2.p.2">Generally, reading information from another origin is forbidden.  However, an origin is permitted to use some kinds of resources retrieved from other origins. For example, an origin is permitted to execute script, render images, and apply style sheets from any origin. Likewise, an origin can display content from another origin, such as an HTML document in an HTML frame. Network resources can also opt into letting other origins read their information, for example using Cross-Origin Resource Sharing <a href="#CORS">[CORS]</a>. In these cases, access is typically granted on a per-origin basis.</p>
<p id="rfc.section.3.4.2.p.3">Sending information to another origin is permitted. However, sending information over the network in arbitrary formats is dangerous. For this reason, user agents restrict documents to sending information using particular protocols, such as in an HTTP request without custom headers. Expanding the set of allowed protocols, for example by adding support for WebSockets, must be done carefully to avoid introducing vulnerabilities <a href="#WEBSOCKETS">[WEBSOCKETS]</a>.</p>
<h1 id="rfc.section.3.4.3">
<a href="#rfc.section.3.4.3">3.4.3.</a> Pitfalls</h1>
<p id="rfc.section.3.4.3.p.1">Whenever user agents allow one origin to interact with resources from another origin, they invite security issues. For example, the ability to display images from another origin leaks their height and width. Similarly, the ability to send network requests to another origin gives rise to cross-site request forgery vulnerabilities <a href="#CSRF">[CSRF]</a>. However, user agent implementors often balance these risks against the benefits of allowing the cross-origin interaction. For example, an HTML user agent that blocked cross-origin network requests would prevent its users from following hyperlinks, a core feature of the web.</p>
<p id="rfc.section.3.4.3.p.2">When adding new functionality to the web platform, it can be tempting to grant a privilege to one resource but to withhold that privilege from another resource in the same origin. However, withholding privileges in this way is ineffective because the resource without the privilege can usually obtain the privilege anyway because user agents do not isolate resources within an origin. Instead, privileges should be granted or withheld from origins as a whole (rather than discriminating between individual resources within an origin) <a href="#BOFGO">[BOFGO]</a>.</p>
<h1 id="rfc.section.3.5">
<a href="#rfc.section.3.5">3.5.</a> <a href="#conclusion" id="conclusion">Conclusion</a>
</h1>
<p id="rfc.section.3.5.p.1">The same-origin policy uses URIs to designate trust relationships.  URIs are grouped together into origins, which represent protection domains. Some resources in an origin (e.g., active content) are granted the origin&#8217;s full authority, whereas other resources in the origin (e.g., passive content) are not granted the origin&#8217;s authority.  Content that carries its origin&#8217;s authority is granted access to objects and network resources within its own origin. This content is also granted limited access to objects and network resources of other origins, but these cross-origin privileges must be designed carefully to avoid security vulnerabilities.</p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#origin-of-a-uri" id="origin-of-a-uri">Origin of a URI</a>
</h1>
<p id="rfc.section.4.p.1">The origin of a URI is the value computed by the following algorithm: </p>

<ol>
<li>If the URI does not use a hierarchical element as a naming authority (see <a href="#RFC3986">[RFC3986]</a>, Section 3.2), or if the URI is not an absolute URI, then generate a fresh globally unique identifier and return that value.  <ul class="empty"><li>NOTE: Running this algorithm multiple times for the same URI can produce different values each time. Typically, user agents compute the origin of, for example, an HTML document once and use that origin for subsequent security checks rather than recomputing the origin for each security check.</li></ul>
<p> </p>
</li>
<li>Let uri-scheme be the scheme component of the URI, converted to lowercase.</li>
<li>If the implementation doesn't support the protocol given by uri-scheme, then return generate a fresh globally unique identifier and return that value.</li>
<li>If uri-scheme is "file", the implementation MAY return an implementation-defined value.  <ul class="empty"><li>NOTE: Historically, user agents have granted content from the file scheme a tremendous amount of privilege. However, granting all local files such wide privileges can lead to privilege escalation attacks. Some user agents have had success granting local files directory-based privileges, but this approach has not been widely adopted. Other user agents use globally unique identifiers for each file URI, which is the most secure option.</li></ul>
<p> </p>
</li>
<li>Let uri-host be the idna-canonicalized form of the host component of the URI.</li>
<li>If there is no port component of the URI: <ul class="empty"><li>Let uri-port be the default port for the protocol given by uri-scheme.</li></ul>
<p> Otherwise: </p>
<ul class="empty"><li>Let uri-port be the port component of the URI.</li></ul>
<p> </p>
</li>
<li>Return the triple (uri-scheme, uri-host, uri-port).</li>
</ol>

<p> </p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#same-origin" id="same-origin">Comparing Origins</a>
</h1>
<p id="rfc.section.5.p.1">Two origins are "the same" if, and only if, they are identical. In particular: </p>

<ul>
<li>If the two origins are scheme/host/port triples, the two origins are the same if, and only if, they have identical schemes, hosts, and ports.</li>
<li>An origin that is a globally unique identifier cannot be the same as an origin that is a scheme/host/port triple.</li>
</ul>

<p> </p>
<p id="rfc.section.5.p.2">Two URIs are the same-origin if their origins are the same.  </p>

<ul class="empty"><li>NOTE: A URI is not necessarily same-origin with itself. For example, a data URI <a href="#RFC2397">[RFC2397]</a> is not same-origin with itself because data URIs do not use a server-based naming authority and therefore have globally unique identifiers as origins.</li></ul>

<p> </p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#serialization" id="serialization">Serializing Origins</a>
</h1>
<p id="rfc.section.6.p.1">This section defines how to serialize an origin to a unicode <a href="#Unicode52">[Unicode52]</a> string and to an ASCII <a href="#RFC20">[RFC20]</a> string.</p>
<h1 id="rfc.section.6.1">
<a href="#rfc.section.6.1">6.1.</a> <a href="#unicode-serialization" id="unicode-serialization">Unicode Serialization of an Origin</a>
</h1>
<p id="rfc.section.6.1.p.1">The unicode-serialization of an origin is the value returned by the following algorithm: </p>

<ol>
<li>If the origin is not a scheme/host/port triple, then return the string <ul class="empty"><li>null</li></ul>
<p> (i.e., the code point sequence U+006E, U+0075, U+006C, U+006C) and abort these steps.</p>
</li>
<li>Otherwise, let result be the scheme part of the origin triple.</li>
<li>Append the string "://" to result.</li>
<li>Apply the IDNA ToUnicode algorithm (from the appropriate IDNA specification <a href="#RFC5891">[RFC5891]</a> or <a href="#RFC3490">[RFC3490]</a>, see <a href="#idna-migration">Section 10</a> of this specification) to each component of the host part of the origin triple, and append the results of each component, in the same order, separated by U+002E FULL STOP code points (".") to result.</li>
<li>If the port part of the origin triple is different than the default port for the protocol given by the scheme part of the origin triple: <ul class="empty"><li>Append a U+003A COLON code point (":") and the given port, in base ten, to result.</li></ul>
<p> </p>
</li>
<li>Return result.</li>
</ol>

<p> </p>
<h1 id="rfc.section.6.2">
<a href="#rfc.section.6.2">6.2.</a> <a href="#ascii-serialization" id="ascii-serialization">ASCII Serialization of an Origin</a>
</h1>
<p id="rfc.section.6.2.p.1">The ascii-serialization of an origin is the value returned by the following algorithm: </p>

<ol>
<li>If the origin is not a scheme/host/port triple, then return the string <ul class="empty"><li>null</li></ul>
<p> (i.e., the code point sequence U+006E, U+0075, U+006C, U+006C) and abort these steps.</p>
</li>
<li>Otherwise, let result be the scheme part of the origin triple.</li>
<li>Append the string "://" to result.</li>
<li>Append the host part of the origin triple to result.</li>
<li>If the port part of the origin triple is different than the default port for the protocol given by the scheme part of the origin triple: <ul class="empty"><li>Append a U+003A COLON code points (":") and the given port, in base ten, to result.</li></ul>
<p> </p>
</li>
<li>Return result.</li>
</ol>

<p> </p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> <a href="#origin-header" id="origin-header">The HTTP Origin header field</a>
</h1>
<p id="rfc.section.7.p.1">This section defines the HTTP Origin header field.</p>
<h1 id="rfc.section.7.1">
<a href="#rfc.section.7.1">7.1.</a> <a href="#origin-header-syntax" id="origin-header-syntax">Syntax</a>
</h1>
<div id="#rfc.figure.6"></div>
<pre>
            
origin              = "Origin:" OWS origin-list-or-null OWS
origin-list-or-null = "null" / origin-list
origin-list         = serialized-origin *( SP serialized-origin )
serialized-origin   = scheme "://" host [ ":" port ]
                    ; &lt;scheme&gt;, &lt;host&gt;, &lt;port&gt; productions from RFC3986
            
          </pre>
<p id="rfc.section.7.1.p.1">The Origin header field has the following syntax: </p>
<h1 id="rfc.section.7.2">
<a href="#rfc.section.7.2">7.2.</a> <a href="#origin-header-semantics" id="origin-header-semantics">Semantics</a>
</h1>
<p id="rfc.section.7.2.p.1">When included in an HTTP request, the Origin header field indicates the origin(s) that "caused" the user agent to issue the request, as defined by the API that triggered the user agent to issue the request.</p>
<p id="rfc.section.7.2.p.2">For example, consider a user agent that executes scripts on behalf of origins. If one of those scripts causes the user agent to issue an HTTP request, the user agent MAY use the Origin header field to inform the server of the security context in which the script was executing when it caused the user agent to issue the request.</p>
<p id="rfc.section.7.2.p.3">In some cases, a number of origins contribute to causing the user agents to issue an HTTP request. In those cases, the user agent MAY list all the origins in the Origin header field. For example, if the HTTP request was initially issued by one origin but then later redirected by another origin, the user agent MAY inform the server that two origins were involved in causing the user agent to issue the request.</p>
<h1 id="rfc.section.7.3">
<a href="#rfc.section.7.3">7.3.</a> <a href="#origin-header-ua-requirements" id="origin-header-ua-requirements">User Agent Requirements</a>
</h1>
<p id="rfc.section.7.3.p.1">The user agent MAY include an Origin header field in any HTTP request.</p>
<p id="rfc.section.7.3.p.2">The user agent MUST NOT include more than one Origin header field in any HTTP request.</p>
<p id="rfc.section.7.3.p.3">Whenever a user agent issues an HTTP request from a "privacy-sensitive" context, the user agent MUST send the value "null" in the Origin header field.  </p>

<ul class="empty"><li>NOTE: This document does not define the notion of a privacy-sensitive context. Applications that generate HTTP requests can designate contexts as privacy-sensitive to impose restrictions on how user agents generate Origin header fields.</li></ul>

<p> </p>
<p id="rfc.section.7.3.p.4">When generating an Origin header field, the user agent MUST meet the following requirements: </p>

<ul>
<li>Each of the serialized-origin productions in the grammar MUST be the ascii-serialization of an origin.</li>
<li>No two consecutive serialized-origin productions in the grammar can be identical.  In particular, if the user agent would generate two consecutive serialized-origins, the user agent MUST NOT generate the second one.</li>
</ul>

<p> </p>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> <a href="#security" id="security">Security Considerations</a>
</h1>
<p id="rfc.section.8.p.1">The same-origin policy is one of the cornerstones of security for many user agents, including web browsers. Historically, some user agents tried other security models, including taint tracking and exfiltration prevention, but those models proved difficult to implement at the time (although there has been recent interest in reviving some of these ideas).</p>
<p id="rfc.section.8.p.2">Evaluating the security of the same-origin policy is difficult because the origin concept itself plays such a central role in the security landscape. The notional origin itself is just a unit of isolation, imperfect as are most one-size-fits-all notions. That said, there are some systemic weaknesses, discussed below.</p>
<h1 id="rfc.section.8.1">
<a href="#rfc.section.8.1">8.1.</a> <a href="#reliance-on-dns" id="reliance-on-dns">Reliance on DNS</a>
</h1>
<p id="rfc.section.8.1.p.1">In practice, the same-origin policy relies upon the Domain Name System (DNS) for security because many commonly used URI schemes, such as http, use DNS-based naming authorities. If the DNS is partially or fully compromised, the same-origin policy might fail to provide the security properties required by applications.</p>
<p id="rfc.section.8.1.p.2">Some URI schemes, such as https, are more resistant to DNS compromise because user agents employ other mechanisms, such as certificates, to verify the source of content retrieved from these URIs. Other URI schemes, such as the chrome-extension URI scheme (see Section 4.3 of <a href="#CRX">[CRX]</a>), use a public-key-based naming authority and are fully secure against DNS compromise.</p>
<p id="rfc.section.8.1.p.3">That the web origin concept isolates content retrieved from different URI schemes is essential to containing the effects of DNS compromise.</p>
<h1 id="rfc.section.8.2">
<a href="#rfc.section.8.2">8.2.</a> <a href="#divergence" id="divergence">Divergent Units of Isolation</a>
</h1>
<p id="rfc.section.8.2.p.1">Over time, a number of technologies have converged on the web origin concept as a convenient unit of isolation. However, many technologies in use today, such as cookies <a href="#RFC6265">[RFC6265]</a>, pre-date the modern web origin concept. These technologies often have different isolation units, leading to vulnerabilities.</p>
<p id="rfc.section.8.2.p.2">One alternative is to use only the "registry-controlled" domain rather than the fully qualified domain name as the unit of isolation (e.g., "example.com" instead of "www.example.com"). This practice is problematic for a number of reasons, and is NOT RECOMMENDED: </p>

<ol>
<li>The notion of a "registry-controlled" domain is a function of human practice surrounding the DNS rather than a property of the DNS itself. For example, many municipalities in Japan run public registries quite deep in the DNS hierarchy. There are widely used "public suffix lists", but these lists are difficult to keep up to date and vary between implementations.</li>
<li>This practice is incompatible with URI schemes that do not use a DNS-based naming authority. For example, if a given URI scheme uses public keys as naming authorities, the notion of a "registry-controlled" public key is somewhat incoherent. Worse, some URI schemes, such as nntp, used dotted delegation in the opposite direction from DNS (e.g., alt.usenet.kooks) and others use the DNS, but present the labels in the reverse of the usual order (e.g., com.example.www).</li>
</ol>

<p> At best, using registry-controlled domains is URI-scheme- and implementation-specific. At worst, differences between URI schemes and implementations can lead to vulnerabilities.</p>
<h1 id="rfc.section.8.3">
<a href="#rfc.section.8.3">8.3.</a> <a href="#ambient-authority" id="ambient-authority">Ambient Authority</a>
</h1>
<p id="rfc.section.8.3.p.1">When using the same-origin policy, user agents grant authority to content based on its URI rather than based which objects the content can designate. This disentangling of designation from authority is an example of ambient authority and can lead to vulnerabilities.</p>
<p id="rfc.section.8.3.p.2">Consider, for example, cross-site scripting in HTML documents. If an attacker can inject script content into an HTML document, those scripts will run with the authority of the document's origin, perhaps allowing the script access to sensitive information, such as the user's medical records. If, however, the script's authority were limited to those objects that the script could designate, the attacker would not gain any advantage by injecting the script into an HTML document hosted by a third party.</p>
<h1 id="rfc.section.9">
<a href="#rfc.section.9">9.</a> <a href="#iana" id="iana">IANA Considerations</a>
</h1>
<p id="rfc.section.9.p.1">The permanent message header field registry (see <a href="#RFC3864">[RFC3864]</a>) should be updated with the following registrations:</p>
<h1 id="rfc.section.9.1">
<a href="#rfc.section.9.1">9.1.</a> Origin</h1>
<p id="rfc.section.9.1.p.1">Header field name: Origin</p>
<p id="rfc.section.9.1.p.2">Applicable protocol: http</p>
<p id="rfc.section.9.1.p.3">Status: standard</p>
<p id="rfc.section.9.1.p.4">Author/Change controller: IETF</p>
<p id="rfc.section.9.1.p.5">Specification document: this specification (<a href="#origin-header">Section 7</a>)</p>
<h1 id="rfc.section.10">
<a href="#rfc.section.10">10.</a> <a href="#idna-migration" id="idna-migration">IDNA dependency and migration</a>
</h1>
<p id="rfc.section.10.p.1">IDNA2008 <a href="#RFC5890">[RFC5890]</a> supersedes IDNA2003 <a href="#RFC3490">[RFC3490]</a> but is not backwards-compatible. For this reason, there will be a transition period (possibly of a number of years).  User agents SHOULD implement IDNA2008 <a href="#RFC5890">[RFC5890]</a> and MAY implement <a href="#UnicodeTR46">[UnicodeTR46]</a> in order to facilitate a smoother IDNA transition. If a user agent does not implement IDNA2008, the user agent MUST implement IDNA2003 <a href="#RFC3490">[RFC3490]</a>.</p>
<h1 id="rfc.references">
<a href="#rfc.references">11.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">11.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC20">[RFC20]</b></td>
<td class="top">
<a title="University California Los Angeles (UCLA)">Cerf, V.</a>, "<a href="http://tools.ietf.org/html/rfc20">ASCII format for network interchange</a>", RFC 20, October 1969.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels </a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2616">[RFC2616]</b></td>
<td class="top">
<a href="mailto:fielding@ics.uci.edu" title="University of California, Irvine">Fielding, R.</a>, <a href="mailto:jg@w3.org" title="W3C">Gettys, J.</a>, <a href="mailto:mogul@wrl.dec.com" title="Compaq Computer Corporation">Mogul, J.</a>, <a href="mailto:frystyk@w3.org" title="MIT Laboratory for Computer Science">Frystyk, H.</a>, <a href="mailto:masinter@parc.xerox.com" title="Xerox Corporation">Masinter, L.</a>, <a href="mailto:paulle@microsoft.com" title="Microsoft Corporation">Leach, P.</a> and <a href="mailto:timbl@w3.org" title="W3C">T. Berners-Lee</a>, "<a href="http://tools.ietf.org/html/rfc2616">Hypertext Transfer Protocol -- HTTP/1.1</a>", RFC 2616, June 1999.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3490">[RFC3490]</b></td>
<td class="top">
<a>Faltstrom, P.</a>, <a>Hoffman, P.</a> and <a>A. Costello</a>, "<a href="http://tools.ietf.org/html/rfc3490">Internationalizing Domain Names in Applications (IDNA)</a>", RFC 3490, March 2003.<p>See </p>
</td>
</tr>
<tr>
<td class="reference"><b id="RFC3864">[RFC3864]</b></td>
<td class="top">
<a>Klyne, G.</a>, <a>Nottingham, M.</a> and <a>J. Mogul</a>, "<a href="http://tools.ietf.org/html/rfc3864">Registration Procedures for Message Header Fields</a>", BCP 90, RFC 3864, September 2004.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3986">[RFC3986]</b></td>
<td class="top">
<a title="World Wide Web Consortium">Berners-Lee, T.</a>, <a title="Day Software">Fielding, R.</a> and <a title="Adobe Systems Incorporated">L. Masinter</a>, "<a href="http://tools.ietf.org/html/rfc3986">Uniform Resource Identifier (URI): Generic Syntax</a>", STD 66, RFC 3986, January 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4790">[RFC4790]</b></td>
<td class="top">
<a>Newman, C.</a>, <a>Duerst, M.</a> and <a>A. Gulbrandsen</a>, "<a href="http://tools.ietf.org/html/rfc4790">Internet Application Protocol Collation Registry</a>", RFC 4790, March 2007.</td>
</tr>
<tr>
<td class="reference"><b id="UnicodeTR46">[UnicodeTR46]</b></td>
<td class="top">
<a>The Unicode Consortium</a>, "<a>Unicode IDNA Compatibility Processing</a>", 2010.</td>
</tr>
<tr>
<td class="reference"><b id="Unicode52">[Unicode52]</b></td>
<td class="top">
<a>The Unicode Consortium</a>, "<a>The Unicode Standard, Version 5.1.0</a>", Unicode 5.0.0, Boston, MA, Addison-Wesley ISBN 0-321-48091-0, as amended by Unicode 5.1.0     http://www.unicode.org/versions/Unicode5.1.0/, 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5234">[RFC5234]</b></td>
<td class="top">
<a href="mailto:dcrocker@bbiw.net" title="Brandenburg InternetWorking">Crocker, D.</a> and <a href="mailto:paul.overell@thus.net" title="THUS plc.">P. Overell</a>, "<a href="http://tools.ietf.org/html/rfc5234">Augmented BNF for Syntax Specifications: ABNF </a>", STD 68, RFC 5234, January 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5890">[RFC5890]</b></td>
<td class="top">
<a>Klensin, J.</a>, "<a href="http://tools.ietf.org/html/rfc5890">Internationalized Domain Names for Applications (IDNA): Definitions and Document Framework</a>", RFC 5890, August 2010.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5891">[RFC5891]</b></td>
<td class="top">
<a>Klensin, J.</a>, "<a href="http://tools.ietf.org/html/rfc5891">Internationalized Domain Names in Applications (IDNA): Protocol</a>", RFC 5891, August 2010.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">11.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC5246">[RFC5246]</b></td>
<td class="top">
<a>Dierks, T.</a> and <a>E. Rescorla</a>, "<a href="http://tools.ietf.org/html/rfc5246">The Transport Layer Security (TLS) Protocol Version 1.2 </a>", RFC 5246, August 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2397">[RFC2397]</b></td>
<td class="top">
<a href="mailto:masinter@parc.xerox.com" title="Xerox Palo Alto Research Center">Masinter, L.</a>, "<a href="http://tools.ietf.org/html/rfc2397">The "data" URL scheme</a>", RFC 2397, August 1998.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2817">[RFC2817]</b></td>
<td class="top">
<a>Khare, R.</a> and <a>S. Lawrence</a>, "<a href="http://tools.ietf.org/html/rfc2817">Upgrading to TLS Within HTTP/1.1</a>", RFC 2817, May 2000.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6265">[RFC6265]</b></td>
<td class="top">
<a>Barth, A.</a>, "<a href="http://tools.ietf.org/html/rfc6265">HTTP State Management Mechanism</a>", RFC 6265, April 2011.</td>
</tr>
<tr>
<td class="reference"><b id="WEBSOCKETS">[WEBSOCKETS]</b></td>
<td class="top">
<a>Fette, I</a>, "<a href="http://tools.ietf.org/html/draft-ietf-hybi-thewebsocketprotocol-09">The WebSocket protocol</a>", Internet-Draft draft-ietf-hybi-thewebsocketprotocol-09, June 2011.</td>
</tr>
<tr>
<td class="reference"><b id="SNIFF">[SNIFF]</b></td>
<td class="top">
<a>Barth, A</a> and <a>I Hickson</a>, "<a href="http://tools.ietf.org/html/draft-ietf-websec-mime-sniff-03">Media Type Sniffing</a>", Internet-Draft draft-ietf-websec-mime-sniff-03, May 2011.</td>
</tr>
<tr>
<td class="reference"><b id="HTML">[HTML]</b></td>
<td class="top">
<a>Hickson, I.</a>, "<a>HTML5</a>", W3C Working Draft WD-html5-20110525, May 2011.<p>Latest version available at </p>
</td>
</tr>
<tr>
<td class="reference"><b id="CORS">[CORS]</b></td>
<td class="top">
<a>van Kesteren, A.</a>, "<a>Cross-Origin Resource Sharing</a>", W3C Working Draft WD-cors-20100727, July 2010.<p>Latest version available at </p>
</td>
</tr>
<tr>
<td class="reference"><b id="CSRF">[CSRF]</b></td>
<td class="top">
<a>Barth, A.</a>, <a>Jackson, C.</a> and <a>J. Mitchell</a>, "<a>Robust Defenses for Cross-Site Request Forgery</a>", 2008.</td>
</tr>
<tr>
<td class="reference"><b id="BOFGO">[BOFGO]</b></td>
<td class="top">
<a>Jackson, C.</a> and <a>A. Barth</a>, "<a>Beware of Finer-Grained Origins</a>", 2008.</td>
</tr>
<tr>
<td class="reference"><b id="CRX">[CRX]</b></td>
<td class="top">
<a>Barth, A.</a>, <a>Felt, A.</a>, <a>Saxena, P.</a> and <a>A. Boodman</a>, "<a>Protecting Browsers from Extension Vulnerabilities</a>", 2010.</td>
</tr>
</tbody></table>
<h1 id="rfc.appendix.Appendix A">
<a href="#rfc.appendix.Appendix%20A">Appendix A.</a> Acknowledgements</h1>
<p id="rfc.section.Appendix A.p.1">We would like to thank Lucas Adamski, Stephen Farrell, Miguel A.  Garcia, Tobias Gondrom, Ian Hickson, Anne van Kesteren, Collin Jackson, Larry Masinter, Alexey Melnikov, Mark Nottingham, Julian Reschke, Jonas Sicking, Sid Stamm, Daniel Veditz, and Chris Weber for their valuable feedback on this document.</p>
<h1 id="rfc.authors"><a href="#rfc.authors">Author's Address</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Adam Barth</span> 
	  <span class="n hidden">
		<span class="family-name">Barth</span>
	  </span>
	</span>
	<span class="org vcardline">Google, Inc.  </span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:ietf@adambarth.com">ietf@adambarth.com</a></span>

<span class="vcardline">URI: <a href="http://www.adambarth.com/">http://www.adambarth.com/</a></span>

  </address>
</div>

</body>
</html>