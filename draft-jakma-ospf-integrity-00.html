<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Stronger, Automatic Integrity Checks for OSPF Packets</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Stronger, Automatic Integrity Checks for OSPF Packets">
<meta name="keywords" content="RFC, OSPF, CRC, Checksum, Authentication">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 60em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 60em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Open Shortest Path First IGP</td><td class="header">P. Jakma</td></tr>
<tr><td class="header">Working Group</td><td class="header">DCS, Uni. of Glasgow</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">M. Bhatia</td></tr>
<tr><td class="header">Updates: <a href='http://tools.ietf.org/html/rfc2328'>2328</a> (if&nbsp;approved)</td><td class="header">Alcatel-Lucent</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">October 13, 2010</td></tr>
<tr><td class="header">Expires: April 16, 2011</td><td class="header">&nbsp;</td></tr>
</table></td></tr></table>
<h1><br />Stronger, Automatic Integrity Checks for OSPF Packets<br />draft-jakma-ospf-integrity-00</h1>

<h3>Abstract</h3>

<p>This document describes an extension to OSPFv2 and OSPFv3 to allow
         a stronger integrity check to be applied to the protocol packets,
         than the default OSPF checksum, which is known to be weak. 
         
</p>
<p>The extension allows OSPF speakers to negotiate the use of
         a CRC integrity check, as a new psuedo-authentication type.
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted  in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF).  Note that other groups may also distribute
working documents as Internet-Drafts.  The list of current
Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
This Internet-Draft will expire on April 16, 2011.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the Simplified BSD License.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Requirements Language<br />
<a href="#intro">2.</a>&nbsp;
Introduction<br />
<a href="#anchor2">3.</a>&nbsp;
Stronger Checksum mechanism for OSPFv2<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">3.1.</a>&nbsp;
Null Authentication Data<br />
<a href="#anchor4">4.</a>&nbsp;
Stronger Checksum mechanism for OSPFv3<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">4.1.</a>&nbsp;
EC-Bit in Options Field<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">4.2.</a>&nbsp;
Extended Checksum Data Block<br />
<a href="#anchor7">5.</a>&nbsp;
Generation<br />
<a href="#anchor8">6.</a>&nbsp;
Verification<br />
<a href="#anchor9">7.</a>&nbsp;
Stronger Integrity Algorithm Types<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">7.1.</a>&nbsp;
CRC32<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">7.2.</a>&nbsp;
MD5-Digest<br />
<a href="#anchor12">8.</a>&nbsp;
IANA Considerations<br />
<a href="#anchor13">9.</a>&nbsp;
Security Considerations<br />
<a href="#rfc.references1">10.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">10.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">10.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Requirements Language</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
      "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
      document are to be interpreted as described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
      
</p>
<a name="intro"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Introduction</h3>

<p>The integrity of Open Shortest Path First versions
         2 (OSPFv2)<a class='info' href='#RFC2328'>[RFC2328]<span> (</span><span class='info'>Moy, J., &ldquo;OSPF Version 2,&rdquo; April&nbsp;1998.</span><span>)</span></a>
         and 3 (OSPFv3)<a class='info' href='#RFC5340'>[RFC5340]<span> (</span><span class='info'>Coltun, R., Ferguson, D., Moy, J., and A. Lindem, &ldquo;OSPF for IPv6,&rdquo; July&nbsp;2008.</span><span>)</span></a>
         packets is protected either through
         the standard internet protocol checksum, or through some
         cryptographic integrity scheme within OSPF, or, more rarely,
         through IPSec. This provides a check against errors that can not
         be caught by the link-layer integrity checks, e.g.
         errors in lower layers of the software stack or in
         hardware of the host.
      
</p>
<p>
         The internet protocol checksum is known to have
         weaknesses<a class='info' href='#partridge'>[partridge]<span> (</span><span class='info'>Stone, J., Greenwald, M., Partridge, C., and J. Hughes, &ldquo;Performance of checksums and CRC's over real data,&rdquo; 1998.</span><span>)</span></a>.
         In particular it can not detect re-ordered words and certain patterns
         of bit flips. If stronger integrity checks are desired, the only
         option is to use cryptographic HMACs, either with MD5 (all conforming
         <a class='info' href='#RFC2328'>[RFC2328]<span> (</span><span class='info'>Moy, J., &ldquo;OSPF Version 2,&rdquo; April&nbsp;1998.</span><span>)</span></a> implementations) or, if supported, 
         the stronger algorithms
         specified by <a class='info' href='#RFC5709'>[RFC5709]<span> (</span><span class='info'>Bhatia, M., Manral, V., Fanto, M., White, R., Barnes, M., Li, T., and R. Atkinson, &ldquo;OSPFv2 HMAC-SHA Cryptographic Authentication,&rdquo; October&nbsp;2009.</span><span>)</span></a>. There are some disadvantages
         though to using the existing support for cryptographic HMACs
         purely for integrity checking. The algorithms require more computation,
         which may be noticable on less powerful and/or energy-sensitive
         platforms. Additionally, the need to configure key material is an
         additional administrative burden.
      
</p>
<p>
         This documents extends OSPF to allow for the automatic and backward 
         compatible use of stronger integrity checks. Backward compatibility
         implies the default null authentication type must be used and extended.
      
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Stronger Checksum mechanism for OSPFv2</h3>

<p>The null authentication mode of OSPFv2 is extended to make use
            of the authentication data field of the OSPFv2 packet header.
            Where previously this field was ignored for null authentication,
            now an OPTIONAL "Null Authentication Data" structure is recognised
            there.
         
</p>
<p>
            Implementations MUST provide a means to disable this extension,
            in case there are non-conforming RFC2328 implementations. 
            Implementations MAY wish to generate a CRC32 checksum by default
            via this extension, and SHOULD attempt to verify any received,
            regardless of whether they generate the same or not.
         
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Null Authentication Data</h3>
<br /><hr class="insert" />
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|          Checksum Type        |      0xA5     |  Data Length  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                            Ignored                            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure 1: Null Authentication Data&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>The authentication data field in the standard OSPFv2 packet header is
   redefined as shown above, when null authentication is used.
   The new field definitions are as follows:	

</p>
<p>
</p>
<blockquote class="text"><dl>
<dt>Checksum Type:</dt>
<dd>
    This field indicates the new checksum algorithm that the
    routers must use and is described in detail in the later sections.  
</dd>
<dt>Magic:</dt>
<dd>
     This field is set to 0xA5. This magic, in combination with
     the OSPF and IP packet lengths, signals the use of this extension.
</dd>
<dt>Data Length:</dt>
<dd>
      The length in 4-octet words of the extended checksum data block
       appended to the OSPFv2 packet.

</dd>
</dl></blockquote>

<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Stronger Checksum mechanism for OSPFv3</h3>

<p> OSPFv3 uses IPSec for protection and does not  carry any
	   authentication information in its headers. Thus it is not possible
       to overload the Null Authentication type as was done in case of OSPFv2.
	
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
EC-Bit in Options Field</h3>

<p> A new EC-bit (EC stands for Extended Checksum) is introduced
       into the OSPFv3 Options field. Routers MUST set the EC-bit in all
       OSPFv3 packets to indicate that the packet is carrying the new
       extended checksum data.
	 
</p><br /><hr class="insert" />
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
  0                   1                         2
   0 1 2 3 4 5 6 7 8 9 0 1 2 3  4  5 6 7  8  9  0  1  2  3
   +-+-+-+-+-+-+-+-+-+-+-+-+-+--+-+--+-+-+--+--+--+--+--+--+
   | | | | | | | | | | | | | |EC|L|AF|*|*|DC| R| N|MC| E|V6|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+--+-+--+-+-+--+--+--+--+--+--+

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure 2: OSPFv3 Options Field&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Extended Checksum Data Block</h3>

<p>  The data block for carrying extended checksum in OSPFv3 is formatted as 
     described below.

</p><br /><hr class="insert" />
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
0                   1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|          Checksum Type       |      0xA5     |   Data Length  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
~              Extended Checksum Data Block                     ~
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure 3: OSPFv3 Options Field&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p> The Checksum Type is of two octets and indicates the new checksum 
      algorithm that the routers must use. This is described in detail in the
      later sections. The next field is a reserved magic field set to 0xA5.
      The Data length field is of two octets and carries
      the size of the entire extended checksum data block that has been appended
      to the OSPFv3 payload, specified in units of 4-octet words.
      The Extended Checksum Data Block carries the
      checksum data that the recievers will use to verify the integrity of the
      OSPFv3 protocol payload.
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Generation</h3>

<p>The same steps are followed as for D.4.1 of <a class='info' href='#RFC2328'>[RFC2328]<span> (</span><span class='info'>Moy, J., &ldquo;OSPF Version 2,&rdquo; April&nbsp;1998.</span><span>)</span></a>.
          Additionally, a 2nd integrity check algorithm is also computed over 
          the packet data, with at least the same amount of zero padding, to
          produce an "extended checksum", which is appended to the OSPFv2
          packet. Its is size accounted for in the Null Authentication Data 
          "data length" field and in the IP length, but not in the OSPFv2 packet
          header, in a similar fashion to the standard OSPFv2 cryptographic 
          authentication
          mechanism.
        
</p>
<p>
          The "Checksum Type" and "Data Length" fields are set to the
          appropriate values for the 2nd integrity check algorithm.
        
</p>
<p> In case of OSPFv3 the entire extended checksum block
         is appended to the OSPFv3 packet, with its size accounted for
         in the IPv6 payload length, but not in the OSPFv3 packet header.
         
</p>
<p>
          Implementations MUST append the extended checksum data, that is
          carried as part of the OSPF protocol payload, before the link local
            signaling (LLS) <a class='info' href='#RFC5613'>[RFC5613]<span> (</span><span class='info'>Zinin, A., Roy, A., Nguyen, L., Friedman, B., and D. Yeung, &ldquo;OSPF Link-Local Signaling,&rdquo; August&nbsp;2009.</span><span>)</span></a> block (if it exists).
		 
</p><br /><hr class="insert" />
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
 +---------------------+ --              --  +---------------------+
 | IP Header           | ^               ^   | IPv6 Header         |
 | Length = HL+X+Y+Z   | | Header Length |   | Length = HL+X+Y+Z   |
 |                     | v               v   |                     |
 +---------------------+ --              --  +---------------------+
 | OSPF Header         | ^               ^   | OSPFv3 Header       |
 | Length = X          | |               |   | Length = X          |
 |                     | |               |   |                     |
 | NULL Authentication | |               |   |                     |
 | Length = Y          | |               |   |                     |
 |.....................| | X             | X |.....................|
 |                     | |               |   |                     |
 | OSPFv2 Data         | |               |   | OSPFv3 Data         |
 |                     | v               v   |                     |
 +---------------------+ --              --  +---------------------+
 |                     | ^               ^   |                     |
 | Extended Checksum   | | Y             | Y |  Extended Checksum  |
 |                     | v               v   |                     |
 +---------------------+ --              --  +---------------------+
 |                     | ^               ^   |                     |
 |  LLS Data           | | Z             | Z |  LLS Data           |
 |                     | v               v   |                     |
 +---------------------+ --              --  +---------------------+
`
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure 4: Extended Checksum Block in OSPFv2 and OSPFv3&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Verification</h3>

<p>The packet data is padded out, as required by <a class='info' href='#RFC2328'>[RFC2328]<span> (</span><span class='info'>Moy, J., &ldquo;OSPF Version 2,&rdquo; April&nbsp;1998.</span><span>)</span></a>.
        
</p>
<p>
           In case of OSPFv2, the Null Authentication Data "0xA5" magic field
           is examined. If it does not match, then verification proceeds as
           per D.5.1 of
           <a class='info' href='#RFC2328'>[RFC2328]<span> (</span><span class='info'>Moy, J., &ldquo;OSPF Version 2,&rdquo; April&nbsp;1998.</span><span>)</span></a>. If it matches, then the IP length in the
           header  MUST be verified. An incoming packet will only  
            contain a valid extended checksum if the length in the 
            IP header = length in OSPF header + "data length" in the 
            NULL Authentication header + data length in the LLS 
           <a class='info' href='#RFC5613'>[RFC5613]<span> (</span><span class='info'>Zinin, A., Roy, A., Nguyen, L., Friedman, B., and D. Yeung, &ldquo;OSPF Link-Local Signaling,&rdquo; August&nbsp;2009.</span><span>)</span></a> block  (if it exists). Implementations
           can trivially determine if an LLS block is being carried by
           inspecting the "L" bit in the OSPF Options field in the HELLOs and
           DDs. Implementations MUST proceed with regular checksum if these 
           numbers dont match. If they do then the IP checksum field
           of the OSPF header MUST be ignored. Instead the stronger integrity
           algorithm specified by the "Checksum Type" field is used, and
           verified against the corresponding checksum. The packet MUST be
           discarded if the computed checksum does not match with what's carried
           in the OSPF packet.
        
</p>
<p> In case of OSPFv3, the presence of the EC-bit in the OSPFv3
         Options field will indicate that a new checksum algorithm is being
         used. Routers MUST parse the packet till the end of the OSPFv3 payload
         till it reaches the start of the extended checksum data block. The
         processing that follows next is similar to the way its done for OSPFv2
         as explained earlier.
       
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Stronger Integrity Algorithm Types</h3>

<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.1"></a><h3>7.1.&nbsp;
CRC32</h3>

<p>The CRC32 algorithm, as used with IEEE 802.3 and defined by
           <a class='info' href='#hammond'>[hammond]<span> (</span><span class='info'>Hammond, J., Brown, J., and S. Lui, &ldquo;Development of a Transmission Error Model                    and an Error Control Model,&rdquo; May&nbsp;1975.</span><span>)</span></a> is used to calculate its 4-byte digest. The
           length set in the Null Authentication Data thus will be 1.
        
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.2"></a><h3>7.2.&nbsp;
MD5-Digest</h3>

<p>The MD5 algorithm, as per 5ref17 of <a class='info' href='#RFC2328'>[RFC2328]<span> (</span><span class='info'>Moy, J., &ldquo;OSPF Version 2,&rdquo; April&nbsp;1998.</span><span>)</span></a> is used
           in plain digest mode (i.e. solely over the data, unlike the HMAC mode
           used by cryptographic authentication) to calculate its 8-byte digest.
           The length set in the Null Authentication Data thus will be 2.
        
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
IANA Considerations</h3>

<p>OSPFv2 Null Authentication Checksum Types are maintained by the IANA.
       Extensions to OSPFv2 that require a new Checksum Type must be reviewed
       by a designated expert from the routing area. 
</p>
<p> This document assigns OSPF Null Authentication Checksum 
            Types 1 and 2, for CRC32 and MD5-Digest respectively.
</p>
<p> IANA is also requested to allocate EC-bit in the OSPFv3
         "Options Registry"
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Security Considerations</h3>

<p>This extension does not raise any new security concerns. It only is used
       where operators have chosen not to configure cryptographic security
       mechanisms.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>10.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2328">[RFC2328]</a></td>
<td class="author-text"><a href="mailto:jmoy@casc.com">Moy, J.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2328">OSPF Version 2</a>,&rdquo; STD&nbsp;54, RFC&nbsp;2328, April&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2328.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2328.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2328.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5340">[RFC5340]</a></td>
<td class="author-text">Coltun, R., Ferguson, D., Moy, J., and A. Lindem, &ldquo;<a href="http://tools.ietf.org/html/rfc5340">OSPF for IPv6</a>,&rdquo; RFC&nbsp;5340, July&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5340.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5709">[RFC5709]</a></td>
<td class="author-text">Bhatia, M., Manral, V., Fanto, M., White, R., Barnes, M., Li, T., and R. Atkinson, &ldquo;<a href="http://tools.ietf.org/html/rfc5709">OSPFv2 HMAC-SHA Cryptographic Authentication</a>,&rdquo; RFC&nbsp;5709, October&nbsp;2009 (<a href="http://www.rfc-editor.org/rfc/rfc5709.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="hammond">[hammond]</a></td>
<td class="author-text">Hammond, J., Brown, J., and S. Lui, &ldquo;<a href="http://handle.dtic.mil/100.2/ADA013939">Development of a Transmission Error Model
                   and an Error Control Model</a>,&rdquo; Technical Report&nbsp;Georgia Institute of Technology, May&nbsp;1975.</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>10.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC5613">[RFC5613]</a></td>
<td class="author-text">Zinin, A., Roy, A., Nguyen, L., Friedman, B., and D. Yeung, &ldquo;<a href="http://tools.ietf.org/html/rfc5613">OSPF Link-Local Signaling</a>,&rdquo; RFC&nbsp;5613, August&nbsp;2009 (<a href="http://www.rfc-editor.org/rfc/rfc5613.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="partridge">[partridge]</a></td>
<td class="author-text">Stone, J., Greenwald, M., Partridge, C., and J. Hughes, &ldquo;<a href="http://dx.doi.org/10.1109/90.731187">Performance of checksums and CRC's over real data</a>,&rdquo; IEEE/ACM Trans. Netw.&nbsp;vol 6, num 5, pages 529-543, 1998.</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Paul Jakma</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">School of Computing Science, University of Glasgow</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Lilybank Gardens</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Glasgow  G12 8QQ</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Scotland</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:paulj@dcs.gla.ac.uk">paulj@dcs.gla.ac.uk</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Manav Bhatia</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Alcatel-Lucent</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Bangalore,   </td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">India</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text"></td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:manav.bhatia@alcatel-lucent.com">manav.bhatia@alcatel-lucent.com</a></td></tr>
</table>
</body></html>
