<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Anti-Spam Policy Instruction/Distribution Operation </title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.2" rel="Chapter" title="2 Definitions">
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 Notational Conventions">
<link href="#rfc.section.2.2" rel="Chapter" title="2.2 Definitions">
<link href="#rfc.section.3" rel="Chapter" title="3 Anti-spam Policy Instruction/Distribution Procedures">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 Operation Procedure for Unsolicited Policy Instruction/Distribution">
<link href="#rfc.section.3.1.1" rel="Chapter" title="3.1.1 Server Procedure">
<link href="#rfc.section.3.1.2" rel="Chapter" title="3.1.2 Client Procedure">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 Operation Procedure for Notification to Subscribe/Unsubscribe Anti-Spam Policy  Instruction/Distribution">
<link href="#rfc.section.3.2.1" rel="Chapter" title="3.2.1 Client Procedure">
<link href="#rfc.section.3.2.2" rel="Chapter" title="3.2.2 Server Procedure">
<link href="#rfc.section.3.3" rel="Chapter" title="3.3 Operation Procedure for On-Demand of Anti-Spam Policy Instruction">
<link href="#rfc.section.3.3.1" rel="Chapter" title="3.3.1 Client Procedure">
<link href="#rfc.section.3.3.2" rel="Chapter" title="3.3.2 Server Procedure">
<link href="#rfc.section.4" rel="Chapter" title="4 Messages">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 Anti-Spam Policy Instruction/Distribution Messages">
<link href="#rfc.section.4.1.1" rel="Chapter" title="4.1.1 Request Message">
<link href="#rfc.section.4.1.2" rel="Chapter" title="4.1.2 Response Message">
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 Notification to Subscribe/Unsubscribe Anti-Spam Policy Instruction/Distribution">
<link href="#rfc.section.4.2.1" rel="Chapter" title="4.2.1 Request Message">
<link href="#rfc.section.4.2.2" rel="Chapter" title="4.2.2 Response Message">
<link href="#rfc.section.4.3" rel="Chapter" title="4.3 On-Demand Query of Anti-Spam Policy Instruction">
<link href="#rfc.section.4.3.1" rel="Chapter" title="4.3.1 Request Message">
<link href="#rfc.section.4.3.2" rel="Chapter" title="4.3.2 Response Message">
<link href="#rfc.section.5" rel="Chapter" title="5 Message Element Descriptions">
<link href="#rfc.section.5.1" rel="Chapter" title="5.1 Request ID">
<link href="#rfc.section.5.2" rel="Chapter" title="5.2 Request Timestamp ">
<link href="#rfc.section.5.3" rel="Chapter" title="5.3 Request Received Timestamp ">
<link href="#rfc.section.5.4" rel="Chapter" title="5.4 Response Timestamp ">
<link href="#rfc.section.5.5" rel="Chapter" title="5.5 Originating Node Address">
<link href="#rfc.section.5.6" rel="Chapter" title="5.6 Termination Node Address">
<link href="#rfc.section.5.7" rel="Chapter" title="5.7 Policy Body">
<link href="#rfc.section.5.8" rel="Chapter" title="5.8 Policy ID">
<link href="#rfc.section.5.9" rel="Chapter" title="5.9 Network Type">
<link href="#rfc.section.5.10" rel="Chapter" title="5.10 Protocol ID">
<link href="#rfc.section.5.11" rel="Chapter" title="5.11 Message Type">
<link href="#rfc.section.5.12" rel="Chapter" title="5.12 Message Attributes">
<link href="#rfc.section.5.13" rel="Chapter" title="5.13 Suspicious Network Domain">
<link href="#rfc.section.5.14" rel="Chapter" title="5.14 Suspicious Address">
<link href="#rfc.section.5.15" rel="Chapter" title="5.15 Suspicious Address Type">
<link href="#rfc.section.5.16" rel="Chapter" title="5.16 Spam Type ">
<link href="#rfc.section.5.17" rel="Chapter" title="5.17 Language Indicator">
<link href="#rfc.section.5.18" rel="Chapter" title="5.18 Detection Information">
<link href="#rfc.section.5.19" rel="Chapter" title="5.19 Action Information">
<link href="#rfc.section.5.20" rel="Chapter" title="5.20 Privacy Shield Information">
<link href="#rfc.section.5.21" rel="Chapter" title="5.21 Affective Filtering Start Timestamp">
<link href="#rfc.section.5.22" rel="Chapter" title="5.22 Affective Filtering Stop Timestamp">
<link href="#rfc.section.5.23" rel="Chapter" title="5.23 Result Code">
<link href="#rfc.section.5.24" rel="Chapter" title="5.24 Anti-Spam Policy Instruction Control">
<link href="#rfc.section.5.25" rel="Chapter" title="5.25 InstructionAction">
<link href="#rfc.section.5.26" rel="Chapter" title="5.26 Existing Policy IDs">
<link href="#rfc.section.6" rel="Chapter" title="6 Result Codes">
<link href="#rfc.section.6.1" rel="Chapter" title="6.1 Normal Return Codes">
<link href="#rfc.section.6.2" rel="Chapter" title="6.2 Error Return Codes">
<link href="#rfc.section.7" rel="Chapter" title="7 Protocols ">
<link href="#rfc.section.8" rel="Chapter" title="8 IANA Considerations">
<link href="#rfc.section.9" rel="Chapter" title="9 Security Considerations">
<link href="#rfc.section.10" rel="Chapter" title="10 Acknowledgements">
<link href="#rfc.references" rel="Chapter" title="11 References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="This document defines an anti-spam policy instruction and distribution operation from Spam Reporting Server or Spam Reporting Client to Spam Reporting Client or Clients.  " />
  <meta name="description" content="This document defines an anti-spam policy instruction and distribution operation from Spam Reporting Server or Spam Reporting Client to Spam Reporting Client or Clients.  " />
  <meta name="keywords" content="I-D, Internet-Draft" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">MARF WG</td>
<td class="right">Y. Cai</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">G. Shanker</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">S. Singh</td>
</tr>
<tr>
<td class="left">Expires: August 27, 2011</td>
<td class="right">M. Torabi</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Z. Zeltsan</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Alcatel-Lucent</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">February 23, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Anti-Spam Policy Instruction/Distribution Operation <br />
  <span class="filename">draft-cai-marf-policy-instruction-operation-00</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>This document defines an anti-spam policy instruction and distribution operation from Spam Reporting Server or Spam Reporting Client to Spam Reporting Client or Clients.  </p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on August 27, 2011.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>2.   <a href="#rfc.section.2">Definitions</a>
</li>
<li>2.1.   <a href="#rfc.section.2.1">Notational Conventions</a>
</li>
<li>2.2.   <a href="#rfc.section.2.2">Definitions</a>
</li>
<li>3.   <a href="#rfc.section.3">Anti-spam Policy Instruction/Distribution Procedures</a>
</li>
<li>3.1.   <a href="#rfc.section.3.1">Operation Procedure for Unsolicited Policy Instruction/Distribution</a>
</li>
<li>3.1.1.   <a href="#rfc.section.3.1.1">Server Procedure</a>
</li>
<li>3.1.2.   <a href="#rfc.section.3.1.2">Client Procedure</a>
</li>
<li>3.2.   <a href="#rfc.section.3.2">Operation Procedure for Notification to Subscribe/Unsubscribe Anti-Spam Policy  Instruction/Distribution</a>
</li>
<li>3.2.1.   <a href="#rfc.section.3.2.1">Client Procedure</a>
</li>
<li>3.2.2.   <a href="#rfc.section.3.2.2">Server Procedure</a>
</li>
<li>3.3.   <a href="#rfc.section.3.3">Operation Procedure for On-Demand of Anti-Spam Policy Instruction</a>
</li>
<li>3.3.1.   <a href="#rfc.section.3.3.1">Client Procedure</a>
</li>
<li>3.3.2.   <a href="#rfc.section.3.3.2">Server Procedure</a>
</li>
<li>4.   <a href="#rfc.section.4">Messages</a>
</li>
<li>4.1.   <a href="#rfc.section.4.1">Anti-Spam Policy Instruction/Distribution Messages</a>
</li>
<li>4.1.1.   <a href="#rfc.section.4.1.1">Request Message</a>
</li>
<li>4.1.2.   <a href="#rfc.section.4.1.2">Response Message</a>
</li>
<li>4.2.   <a href="#rfc.section.4.2">Notification to Subscribe/Unsubscribe Anti-Spam Policy Instruction/Distribution</a>
</li>
<li>4.2.1.   <a href="#rfc.section.4.2.1">Request Message</a>
</li>
<li>4.2.2.   <a href="#rfc.section.4.2.2">Response Message</a>
</li>
<li>4.3.   <a href="#rfc.section.4.3">On-Demand Query of Anti-Spam Policy Instruction</a>
</li>
<li>4.3.1.   <a href="#rfc.section.4.3.1">Request Message</a>
</li>
<li>4.3.2.   <a href="#rfc.section.4.3.2">Response Message</a>
</li>
<li>5.   <a href="#rfc.section.5">Message Element Descriptions</a>
</li>
<li>5.1.   <a href="#rfc.section.5.1">Request ID</a>
</li>
<li>5.2.   <a href="#rfc.section.5.2">Request Timestamp </a>
</li>
<li>5.3.   <a href="#rfc.section.5.3">Request Received Timestamp </a>
</li>
<li>5.4.   <a href="#rfc.section.5.4">Response Timestamp </a>
</li>
<li>5.5.   <a href="#rfc.section.5.5">Originating Node Address</a>
</li>
<li>5.6.   <a href="#rfc.section.5.6">Termination Node Address</a>
</li>
<li>5.7.   <a href="#rfc.section.5.7">Policy Body</a>
</li>
<li>5.8.   <a href="#rfc.section.5.8">Policy ID</a>
</li>
<li>5.9.   <a href="#rfc.section.5.9">Network Type</a>
</li>
<li>5.10.   <a href="#rfc.section.5.10">Protocol ID</a>
</li>
<li>5.11.   <a href="#rfc.section.5.11">Message Type</a>
</li>
<li>5.12.   <a href="#rfc.section.5.12">Message Attributes</a>
</li>
<li>5.13.   <a href="#rfc.section.5.13">Suspicious Network Domain</a>
</li>
<li>5.14.   <a href="#rfc.section.5.14">Suspicious Address</a>
</li>
<li>5.15.   <a href="#rfc.section.5.15">Suspicious Address Type</a>
</li>
<li>5.16.   <a href="#rfc.section.5.16">Spam Type </a>
</li>
<li>5.17.   <a href="#rfc.section.5.17">Language Indicator</a>
</li>
<li>5.18.   <a href="#rfc.section.5.18">Detection Information</a>
</li>
<li>5.19.   <a href="#rfc.section.5.19">Action Information</a>
</li>
<li>5.20.   <a href="#rfc.section.5.20">Privacy Shield Information</a>
</li>
<li>5.21.   <a href="#rfc.section.5.21">Affective Filtering Start Timestamp</a>
</li>
<li>5.22.   <a href="#rfc.section.5.22">Affective Filtering Stop Timestamp</a>
</li>
<li>5.23.   <a href="#rfc.section.5.23">Result Code</a>
</li>
<li>5.24.   <a href="#rfc.section.5.24">Anti-Spam Policy Instruction Control</a>
</li>
<li>5.25.   <a href="#rfc.section.5.25">InstructionAction</a>
</li>
<li>5.26.   <a href="#rfc.section.5.26">Existing Policy IDs</a>
</li>
<li>6.   <a href="#rfc.section.6">Result Codes</a>
</li>
<li>6.1.   <a href="#rfc.section.6.1">Normal Return Codes</a>
</li>
<li>6.2.   <a href="#rfc.section.6.2">Error Return Codes</a>
</li>
<li>7.   <a href="#rfc.section.7">Protocols </a>
</li>
<li>8.   <a href="#rfc.section.8">IANA Considerations</a>
</li>
<li>9.   <a href="#rfc.section.9">Security Considerations</a>
</li>
<li>10.   <a href="#rfc.section.10">Acknowledgements</a>
</li>
<li>11.   <a href="#rfc.references">References</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> Introduction</h1>
<p id="rfc.section.1.p.1">As the SMS/MMS spam problem continues to expand and potential solutions evolve, mobile operators are developing their own SMS/MMS anti-spam application on SMSC/MMSC or message gateways.  Open Mobile Alliance (OMA) developed <a href="#OMA%20TS%20SpamRep">OMA Mobile Spam Reporting Technical Specification</a> <cite title="NONE">[OMA TS SpamRep]</cite>, which addresses the Spam Reporting Server and Clients requirements for SMS/MMS and other spam reporting. This OMA SpamRep specification is to be adopted by IETF MARF group. However, there is no centralized message spam analysis system which receives reports from individual message centers, and in return, instructs the message centers with filtering criteria and policy rules which are developed based on spam reporting as well as spam analysis at the spam reporting server.  <br><br> This document introduces a new operation of anti-spam policy instruction and distribution between a centralized spam reporting server and distributed spam reporting clients. Optionally, a spam reporting client could also act as an agent to distribute the received anti-spam policy instruction to other spam reporting clients in the network.  This document, thus, creates a framework for anti-spam policy instruction and distribution among the distributed spam reporting nodes in the network.  <br><br> The spam policy instruction operation from the centralized spam reporting server will allow one or multiple spam reporting clients, which actually conduct spam filtering and detection, to: </p>

<ul>
<li>have latest spam filtering criteria and policies instructed by the networks </li>
<li>receive spam filtering and detection algorithms and rules from other spam reporting clients via the centralized spam reporting server </li>
<li>update and enhance existing local filtering algorithms and rule </li>
<li>prevent in advance from upcoming spam with new abuse contents and/or from new sources </li>
<li>optionally, further distribute the received policies to other spam reporting clients in its network </li>
</ul>

<p> </p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> Definitions</h1>
<h1 id="rfc.section.2.1">
<a href="#rfc.section.2.1">2.1.</a> Notational Conventions</h1>
<p id="rfc.section.2.1.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC%202119">RFC 2119</a> <cite title="NONE">[RFC 2119]</cite>.  </p>
<h1 id="rfc.section.2.2">
<a href="#rfc.section.2.2">2.2.</a> Definitions</h1>
<p id="rfc.section.2.2.p.1">Spam Reporting Server - The functionalities of a spam reporting server includes receiving spam reports from spam reporting clients, conducting spam analysis, summarizing anti-spam criteria/policies/rules, and distribution of anti-spam criteria/policies/rules to the distributed spam reporting clients.  <br><br> Spam Reporting Client - It is message center (SMSC, MMSC, email server, IM server, etc.) The functionalities of a spam reporting client includes detecting spam messages using local spam filtering criteria/rules, reporting spam messages to Spam Reporting Server, receiving the instruction of anti-spam policies/rules from Spam Reporting Server, and optionally receiving/forwarding the anti-spam policies/rules from/to other Spam Reporting Clients.  </p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> Anti-spam Policy Instruction/Distribution Procedures</h1>
<p id="rfc.section.3.p.1">The procedures support both of unsolicited and solicited models of anti-spam policy instruction/distribution.  </p>
<p id="rfc.section.3.p.2">In unsolicited model, the spam reporting server shall initiate a request for spam policy instruction/distribution operation to one or more spam reporting clients which conduct spam message filtering and detection in the network.  A spam reporting client may initiate a request for spam policy instruction/distribution operation to one or multiple other spam reporting clients in the network.  </p>
<p id="rfc.section.3.p.3">In solicited or on-demand model, a spam reporting client shall initiate a on-demand request for spam policy instruction/distribution operation to the spam reporting server. The spam reporting client shall indicate what filtering criteria/policy rules it current has, and what new policy rules it may expect and subscription time window.  The spam reporting server or spam report client that received the on-demand query request shall respond to the requesting entity with anti-spam policy instruction and/or appropriate result code. Optionally, asynchronous mechanism can be implemented where the anti-spam policy instruction is sent as a separate request after acknowledging the receipt of the query request from the client.  </p>
<p id="rfc.section.3.p.4">In both solicited and unsolicited models, the spam reporting clients who received the request of spam policy instruction/distribution operation shall respond to the requesting entity with corresponding result codes.  </p>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> Operation Procedure for Unsolicited Policy Instruction/Distribution</h1>
<p id="rfc.section.3.1.p.1">This procedure enables the push model for anti-spam policy instruction/distribution. Related procedures, described in section 3.2, provide control to subscriber/unsubscribe this push mechanism for specific spam reporting client(s) in the network.  </p>
<p id="rfc.section.3.1.p.2">The spam reporting server shall initiate a request for spam policy instruction/distribution operation to one or more spam reporting clients which conduct spam message filtering and detection in the network. A spam reporting client shall initiate a request for spam policy instruction/distribution operation to one or multiple other spam reporting clients in the network.  </p>
<p id="rfc.section.3.1.p.3">The spam reporting clients who received the request of spam policy instruction/distribution operation shall respond to the requesting entity with corresponding result codes.  </p>
<div id="#rfc.figure.1"></div>
<pre> 

     +-------------+                 +-------------+
     |             |   Request       |             |
     |             |&lt;----------------|             |
     |   Client    |   Response      |   Server    |
     |             |----------------&gt;|             |
     +-------------+                 +-------------+


     +-------------+   Request       +-------------+
     |             |&lt;----------------|             |
     |             |   Response      |             |
     |   Client    |----------------&gt;|   Client    |
     |             |                 |             |
     +-------------+                 +-------------+


</pre>
<h1 id="rfc.section.3.1.1">
<a href="#rfc.section.3.1.1">3.1.1.</a> Server Procedure</h1>
<p id="rfc.section.3.1.1.p.1">The procedures described below are performed by Spam Reporting Server.  </p>

<ol>
<li>Before sending the request to the clients, the server shall determine <br> <ul>
<li>which spam filtering criteria/policies/rules should be included in the operation </li>
<li>which clients should receive these spam filtering criteria/policies/rules </li>
<li>schedule (day and time) to send the request to client(s). The schedule can be provisioned statically or determined during run time.  </li>
</ul>
<p> </p>
</li>
<li>The server shall assemble the request message, for anti-spam policy instruction/distribution, with message elements described in Section 4.1.1.  </li>
<li>The server shall send the assembled request to identified spam reporting client(s) as per the selected schedule </li>
<li>The server shall receive the response from the client(s). The server shall determine whether to resend the request to the client(s) in case of an error result code received from client(s) </li>
<li>Re-attempt of distribution to a client shall be determined based on error code, client ID, and spam filtering criteria/policies/rules </li>
<li>Times and interval for re-attempt of distribution can be statically configured at the server or determined automatically </li>
</ol>

<p> </p>
<h1 id="rfc.section.3.1.2">
<a href="#rfc.section.3.1.2">3.1.2.</a> Client Procedure</h1>
<p id="rfc.section.3.1.2.p.1">The procedures described below are performed by Spam Reporting Client when receiving a request message for spam policy instruction/distribution operation from Spam Reporting Server or other Spam Reporting Clients.  </p>

<ol>
<li>The client shall parse the request and extract the message elements enclosed in the request </li>
<li>The client shall process the content of message elements and take appropriate action including one or more of the following: <ul>
<li>Accept a part or all of the filtering criteria/policies/rules included in the request </li>
<li>Ignore a part or all of the filtering criteria/policies/rules included in the request </li>
<li>Update existing filtering criteria/policies/rules with the accepted ones from the request </li>
<li>Activate new filtering criteria/policies/rules immediately or at a later time as determined by the client </li>
</ul>
<p> </p>
</li>
<li>The client shall send a response to the requesting entity with appropriate result codes (see Section 4.1.2) </li>
</ol>

<p> When there is a need for the spam reporting client to forward the request for spam policy instruction/distribution operation to other spam reporting client(s) in the network, the spam reporting client shall follow the procedure outlined for the server in section 3.1 above.  </p>
<h1 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> Operation Procedure for Notification to Subscribe/Unsubscribe Anti-Spam Policy  Instruction/Distribution</h1>
<p id="rfc.section.3.2.p.1">This procedure enables control to enable/disable the push mechanism, described in section 3.1, selectively by specific spam reporting client(s) in the network.  </p>
<p id="rfc.section.3.2.p.2">The spam reporting client(s) may initiate a request to subscribe/unsubscribe receiving spam policy instruction/distribution requests from a spam analysis server or another spam reporting client.  </p>
<p id="rfc.section.3.2.p.3">The spam analysis server or spam reporting client that received the request to subscribe/unsubscribe anti-spam policy instruction shall respond to the requesting entity with corresponding result code.  </p>
<div id="#rfc.figure.2"></div>
<pre> 
     

  +-------------+                 +-------------+
  |             |   Request       |             |
  |             |----------------&gt;|             |
  |   Client    |   Response      |   Server    |
  |             |&lt;----------------|             |
  +-------------+                 +-------------+


  +-------------+   Request       +-------------+
  |             |----------------&gt;|             |
  |             |   Response      |             |
  |   Client    |&lt;----------------|   Client    |
  |             |                 |             |
  +-------------+                 +-------------+

</pre>
<h1 id="rfc.section.3.2.1">
<a href="#rfc.section.3.2.1">3.2.1.</a> Client Procedure</h1>
<p id="rfc.section.3.2.1.p.1">The procedures described below are performed by a spam reporting client.  </p>

<ol>
<li>The client shall assemble the request message, to subscribe/unsubscribe anti-spam policy instruction/distribution, with message elements described in Section 4.2.1 </li>
<li>The client shall send the assembled request to identified entities, i.e., the spam reporting server and/or other spam reporting client(s) </li>
<li>The client shall receive the response from the entities to which the request was sent. The client shall determine whether to resend the request in case of an error result code received.  </li>
<li>Times and interval for re-attempt of notification to subscribe/unsubscribe anti-spam policy instruction/distribution can be statically configured at the client or determined automatically </li>
</ol>

<p> When the spam reporting client is also capable of spam policy instruction/distribution to other spam reporting clients, the spam reporting client shall support the server procedure described in section 3.2.2 below.  </p>
<h1 id="rfc.section.3.2.2">
<a href="#rfc.section.3.2.2">3.2.2.</a> Server Procedure</h1>
<p id="rfc.section.3.2.2.p.1">The procedures described below are performed by the spam reporting server when receiving a request message to subscribe/unsubscribe anti-spam policy instruction/distribution to the client. This procedure is also executed by a spam reporting client if it is capable of spam reporting policy instruction/distribution in which case the spam reporting client is fulfilling the server role for this operation.  </p>

<ol>
<li>The server shall parse the request and extract the message elements enclosed in the request </li>
<li>The server may extract existing policy IDs from the request as a base of appropriate actions. For example, if there is no new policy rule to be sent to the spam reporting client, the spam reporting server should send an appropriate result code (Section 6) to the spam reporting client; the spam reporting server may not send a policy instruction/distribution request to the spam reporting client in the period while no new policy rules applied, even the policy instruction/distribution status of the spam reporting client is recorded as subscribed </li>
<li>The server shall process the content of message elements and take appropriate action including one of the following: <ul>
<li>Start anti-spam policy instruction/distribution to the client, which sent the request, at the next scheduled event for anti-spam policy instruction/distribution </li>
<li>Stop subsequent anti-spam policy instruction/distribution to the client that sent the request </li>
</ul>
<p> </p>
</li>
<li>The server shall send a response to the requesting entity with appropriate result codes (see Section 6) </li>
</ol>

<p> </p>
<h1 id="rfc.section.3.3">
<a href="#rfc.section.3.3">3.3.</a> Operation Procedure for On-Demand of Anti-Spam Policy Instruction</h1>
<div id="#rfc.figure.3"></div>
<pre> 
 
   +-------------+                 +-------------+
   |             |   Request       |             |
   |             |----------------&gt;|             |
   |   Client    |   Response      |   Server    |
   |             |&lt;----------------|             |
   +-------------+                 +-------------+


   +-------------+   Request       +-------------+
   |             |----------------&gt;|             |
   |             |   Response      |             |
   |   Client    |&lt;----------------|   Client    |
   |             |                 |             |
   +-------------+                 +-------------+

</pre>
<p id="rfc.section.3.3.p.1">This procedure enables the on-demand pull model for anti-spam policy instruction/distribution.  <br><br> The spam reporting client(s) may initiate a request to query spam policy instruction/distribution on-demand from a spam reporting server or another spam reporting client.  <br><br> The spam reporting server or spam report client that received the on-demand query request shall respond to the requesting entity with anti-spam policy instruction and/or appropriate result code. Optionally, asynchronous mechanism can be implemented where the anti-spam policy instruction is sent as a separate request after acknowledging the receipt of the query request from the client.  <br><br> The flow for the synchronous mechanism is depicted here.  <br><br> <br><br> The flow for the asynchronous mechanism includes the flow depicted above, except that the response is an acknowledgement of the query instead of policy instruction, followed by the anti-spam policy instruction/distribution flow depicted in section 3.1 above.  </p>
<h1 id="rfc.section.3.3.1">
<a href="#rfc.section.3.3.1">3.3.1.</a> Client Procedure</h1>
<p id="rfc.section.3.3.1.p.1">The procedures described below are performed by a spam reporting client.  </p>

<ol>
<li>The client shall assemble the request message, to query anti-spam policy instruction, with message elements described in section 4.3.1.  </li>
<li>The client shall send the request to identified entities, i.e., the spam reporting server and/or other spam reporting client(s) </li>
<li>The client shall receive the response from the entities to which the request was sent. The client shall determine whether to resend the request in case of an error result code received </li>
<li>Times and interval for re-attempt of the query request for anti-spam policy instruction can be statically configured at the client or determined automatically </li>
</ol>

<p> When the spam reporting client is also capable of spam policy instruction/distribution to other spam reporting clients, the spam reporting client shall support the server procedure described in section 3.3.2 below </p>
<h1 id="rfc.section.3.3.2">
<a href="#rfc.section.3.3.2">3.3.2.</a> Server Procedure</h1>
<p id="rfc.section.3.3.2.p.1">The procedures described below are performed by the spam reporting server when receiving a request message for query of anti-spam policy instruction from a client. This procedure is also executed by a spam reporting client if it is capable of spam reporting policy instruction/distribution in which case the spam reporting client is fulfilling the server role for this operation.  </p>

<ol>
<li>The server shall parse the request and extract the message elements enclosed in the request </li>
<li>The server may extract existing policy IDs from the request as a base of appropriate actions. For example, if there is no new policy rule to be sent to the spam reporting client, the spam reporting server should send a response with an appropriate result code (Section 6) but without policy body to the spam reporting client </li>
<li>The server shall process the content of message elements and take appropriate action depending on whether the query mechanism is synchronous or asynchronous <ul>
<li>If the query mechanism is synchronous, the server shall assemble a response message enclosing the spam policy instruction and/or result code (see section 6) as specified in section 4.3.2.  </li>
<li>If the query mechanism is asynchronous, the server shall assemble a response message containing the result code (see section 6) to acknowledge the query request </li>
</ul>
<p> </p>
</li>
<li>The server shall send the assembled response to the requesting entity </li>
</ol>

<p> </p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> Messages</h1>
<p id="rfc.section.4.p.1">This section specifies the format of the request and response messages to support the operation procedures described in section 3 above.  </p>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> Anti-Spam Policy Instruction/Distribution Messages</h1>
<p id="rfc.section.4.1.p.1">There are two types of messages of anti-spam policy instruction/distribution operation: </p>

<ul>
<li>Request message (sent by either Spam Reporting Server or Spam Reporting Clients) </li>
<li>Response message (sent by Spam Reporting Clients) </li>
</ul>

<p> </p>
<h1 id="rfc.section.4.1.1">
<a href="#rfc.section.4.1.1">4.1.1.</a> Request Message</h1>
<p id="rfc.section.4.1.1.p.1">The request message of anti-spam policy instruction/distribution operation should contain following message elements: <br><br> Request: </p>

<dl>
<dt></dt>
<dd style="margin-left: 8">Request ID </dd>
<dt></dt>
<dd style="margin-left: 8">Request timestamp</dd>
<dt></dt>
<dd style="margin-left: 8">Originating node address</dd>
<dt></dt>
<dd style="margin-left: 8">Terminating node address</dd>
<dt></dt>
<dd style="margin-left: 8">* Policy Body</dd>
<dt></dt>
<dd style="margin-left: 8">{</dd>
<dt></dt>
<dd style="margin-left: 8">Policy ID</dd>
<dt></dt>
<dd style="margin-left: 8">Network types</dd>
<dt></dt>
<dd style="margin-left: 8">* Protocol ID</dd>
<dt></dt>
<dd style="margin-left: 8">* Message Types</dd>
<dt></dt>
<dd style="margin-left: 8">Message attributes</dd>
<dt></dt>
<dd style="margin-left: 8">* Suspicious network domain</dd>
<dt></dt>
<dd style="margin-left: 8">* Suspicious address</dd>
<dt></dt>
<dd style="margin-left: 8">* Suspicious address type</dd>
<dt></dt>
<dd style="margin-left: 8">Spam type</dd>
<dt></dt>
<dd style="margin-left: 8">Language indicator</dd>
<dt></dt>
<dd style="margin-left: 8">Detection information</dd>
<dt></dt>
<dd style="margin-left: 8">{</dd>
<dt></dt>
<dd style="margin-left: 8">* Algorithm ID</dd>
<dt></dt>
<dd style="margin-left: 8">* Rule ID</dd>
<dt></dt>
<dd style="margin-left: 8">* Spam Keyword</dd>
<dt></dt>
<dd style="margin-left: 8">* Spam Pattern</dd>
<dt></dt>
<dd style="margin-left: 8">}</dd>
<dt></dt>
<dd style="margin-left: 8">Action information</dd>
<dt></dt>
<dd style="margin-left: 8">{</dd>
<dt></dt>
<dd style="margin-left: 8">Block with notification</dd>
<dt></dt>
<dd style="margin-left: 8">Block without notification</dd>
<dt></dt>
<dd style="margin-left: 8">Unblock and deliver</dd>
<dt></dt>
<dd style="margin-left: 8">Hold and quarantine </dd>
<dt></dt>
<dd style="margin-left: 8">}</dd>
<dt></dt>
<dd style="margin-left: 8">Privacy shield information</dd>
<dt></dt>
<dd style="margin-left: 8">Affective filtering start timestamp</dd>
<dt></dt>
<dd style="margin-left: 8">Affective filtering stop timestamp</dd>
<dt></dt>
<dd style="margin-left: 8">}</dd>
</dl>

<p> * sign indicates the message element should be multiple occurrences.  </p>
<h1 id="rfc.section.4.1.2">
<a href="#rfc.section.4.1.2">4.1.2.</a> Response Message</h1>
<p id="rfc.section.4.1.2.p.1">The response message of anti-spam policy instruction/distribution operation should contain following message elements: <br><br> Response: </p>

<dl>
<dt></dt>
<dd style="margin-left: 8">Request ID </dd>
<dt></dt>
<dd style="margin-left: 8">Request received timestamp </dd>
<dt></dt>
<dd style="margin-left: 8">Response timestamp </dd>
<dt></dt>
<dd style="margin-left: 8">Originating node address </dd>
<dt></dt>
<dd style="margin-left: 8">Terminating node address </dd>
<dt></dt>
<dd style="margin-left: 8">Result Code </dd>
<dt></dt>
<dd style="margin-left: 8">* Policy Specific Result Code </dd>
<dt></dt>
<dd style="margin-left: 8">{ </dd>
<dt></dt>
<dd style="margin-left: 8">Policy ID </dd>
<dt></dt>
<dd style="margin-left: 8">Result Code </dd>
<dt></dt>
<dd style="margin-left: 8">} </dd>
</dl>

<p> * sign indicates the message element should be multiple occurrences.  </p>
<h1 id="rfc.section.4.2">
<a href="#rfc.section.4.2">4.2.</a> Notification to Subscribe/Unsubscribe Anti-Spam Policy Instruction/Distribution</h1>
<p id="rfc.section.4.2.p.1">There are two types of messages for operation for the notification to subscribe/unsubscribe anti-spam policy instruction/distribution.  </p>

<ul>
<li>Request message (sent by spam reporting clients) </li>
<li>Response message (sent by spam analysis server or spam reporting client) </li>
</ul>

<p> </p>
<h1 id="rfc.section.4.2.1">
<a href="#rfc.section.4.2.1">4.2.1.</a> Request Message</h1>
<p id="rfc.section.4.2.1.p.1">The request message for notification to subscribe/unsubscribe anti-spam policy instruction/distribution operation shall contain following message elements: <br><br> Request: </p>

<dl>
<dt></dt>
<dd style="margin-left: 8">Request ID </dd>
<dt></dt>
<dd style="margin-left: 8">Request timestamp </dd>
<dt></dt>
<dd style="margin-left: 8">Originating node address </dd>
<dt></dt>
<dd style="margin-left: 8">Terminating node address </dd>
<dt></dt>
<dd style="margin-left: 8">Anti-Spam Policy Instruction Control </dd>
<dt></dt>
<dd style="margin-left: 8">{ </dd>
<dt></dt>
<dd style="margin-left: 8">InstructionAction </dd>
<dt></dt>
<dd style="margin-left: 8">*Existing Policy IDs </dd>
<dt></dt>
<dd style="margin-left: 8">}     </dd>
</dl>

<p> * sign indicates the message element should be multiple occurrences.  </p>
<h1 id="rfc.section.4.2.2">
<a href="#rfc.section.4.2.2">4.2.2.</a> Response Message</h1>
<p id="rfc.section.4.2.2.p.1">The response message for the notification operation to start/stop anti-spam policy instruction/distribution should contain following message elements: <br><br> Response: </p>

<dl>
<dt></dt>
<dd style="margin-left: 8">Request ID </dd>
<dt></dt>
<dd style="margin-left: 8">Request received timestamp </dd>
<dt></dt>
<dd style="margin-left: 8">Response timestamp </dd>
<dt></dt>
<dd style="margin-left: 8">Originating node address </dd>
<dt></dt>
<dd style="margin-left: 8">Terminating node address </dd>
<dt></dt>
<dd style="margin-left: 8">Result Code </dd>
</dl>

<p> </p>
<h1 id="rfc.section.4.3">
<a href="#rfc.section.4.3">4.3.</a> On-Demand Query of Anti-Spam Policy Instruction</h1>
<p id="rfc.section.4.3.p.1">There are two types of messages for operation to query anti-spam policy instruction/distribution.  </p>

<ul>
<li>Request message (sent by spam reporting clients) </li>
<li>Response message (sent by spam analysis server or spam reporting client) </li>
</ul>

<p> In addition when the asynchronous query mechanism is used, the request and response messages specified in section 4.1 shall be used for the asynchronous anti-spam policy instruction/distribution.  </p>
<h1 id="rfc.section.4.3.1">
<a href="#rfc.section.4.3.1">4.3.1.</a> Request Message</h1>
<p id="rfc.section.4.3.1.p.1">The request message for the operation to query of anti-spam policy instruction should contain following message elements: <br><br> Request: </p>

<dl>
<dt></dt>
<dd style="margin-left: 8">Request ID </dd>
<dt></dt>
<dd style="margin-left: 8">Request timestamp </dd>
<dt></dt>
<dd style="margin-left: 8">Originating node address </dd>
<dt></dt>
<dd style="margin-left: 8">Terminating node address </dd>
<dt></dt>
<dd style="margin-left: 8">Anti-Spam Policy Instruction Control </dd>
<dt></dt>
<dd style="margin-left: 8">{ </dd>
<dt></dt>
<dd style="margin-left: 8">InstructionAction </dd>
<dt></dt>
<dd style="margin-left: 8">*Existing Policy IDs </dd>
<dt></dt>
<dd style="margin-left: 8">}     </dd>
</dl>

<p> * sign indicates the message element should be multiple occurrences.  </p>
<h1 id="rfc.section.4.3.2">
<a href="#rfc.section.4.3.2">4.3.2.</a> Response Message</h1>
<p id="rfc.section.4.3.2.p.1">The response message for the notification operation to start/stop anti-spam policy instruction/distribution should contain following message elements: <br><br> Response: </p>

<dl>
<dt></dt>
<dd style="margin-left: 8">Request ID </dd>
<dt></dt>
<dd style="margin-left: 8">Request received timestamp </dd>
<dt></dt>
<dd style="margin-left: 8">Response timestamp </dd>
<dt></dt>
<dd style="margin-left: 8">Originating node address </dd>
<dt></dt>
<dd style="margin-left: 8">Terminating node address </dd>
<dt></dt>
<dd style="margin-left: 8">Result Code </dd>
<dt></dt>
<dd style="margin-left: 8">* Policy Body </dd>
<dt></dt>
<dd style="margin-left: 8">{ </dd>
<dt></dt>
<dd style="margin-left: 8">Policy ID </dd>
<dt></dt>
<dd style="margin-left: 8">Network types </dd>
<dt></dt>
<dd style="margin-left: 8">* Protocol ID </dd>
<dt></dt>
<dd style="margin-left: 8">* Message Types </dd>
<dt></dt>
<dd style="margin-left: 8">Message attributes </dd>
<dt></dt>
<dd style="margin-left: 8">* Suspicious network domain </dd>
<dt></dt>
<dd style="margin-left: 8">* Suspicious address </dd>
<dt></dt>
<dd style="margin-left: 8">* Suspicious address type </dd>
<dt></dt>
<dd style="margin-left: 8">Spam type </dd>
<dt></dt>
<dd style="margin-left: 8">Language indicator </dd>
<dt></dt>
<dd style="margin-left: 8">Detection information </dd>
<dt></dt>
<dd style="margin-left: 8">{ </dd>
<dt></dt>
<dd style="margin-left: 8">* Algorithm ID </dd>
<dt></dt>
<dd style="margin-left: 8">* Rule ID </dd>
<dt></dt>
<dd style="margin-left: 8">* Spam Keyword </dd>
<dt></dt>
<dd style="margin-left: 8">* Spam Pattern </dd>
<dt></dt>
<dd style="margin-left: 8">} </dd>
<dt></dt>
<dd style="margin-left: 8">Action information </dd>
<dt></dt>
<dd style="margin-left: 8">{ </dd>
<dt></dt>
<dd style="margin-left: 8">Block with notification </dd>
<dt></dt>
<dd style="margin-left: 8">Block without notification </dd>
<dt></dt>
<dd style="margin-left: 8">Unblock and deliver </dd>
<dt></dt>
<dd style="margin-left: 8">Hold and quarantine  </dd>
<dt></dt>
<dd style="margin-left: 8">} </dd>
<dt></dt>
<dd style="margin-left: 8">Privacy shield information </dd>
<dt></dt>
<dd style="margin-left: 8">Affective filtering start timestamp </dd>
<dt></dt>
<dd style="margin-left: 8">Affective filtering stop timestamp </dd>
<dt></dt>
<dd style="margin-left: 8">} </dd>
</dl>

<p> * sign indicates the message element should be multiple occurrences.  </p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> Message Element Descriptions</h1>
<p id="rfc.section.5.p.1">Message elements included in the request and response messages of anti-spam policy instruction/distribution operation are described in this sub-section. All message elements are optional except those that are indicated as mandatory.  </p>
<h1 id="rfc.section.5.1">
<a href="#rfc.section.5.1">5.1.</a> Request ID</h1>
<p id="rfc.section.5.1.p.1">Request ID is a mandatory element of type string and is the unique identifier for the request message.  </p>
<h1 id="rfc.section.5.2">
<a href="#rfc.section.5.2">5.2.</a> Request Timestamp </h1>
<p id="rfc.section.5.2.p.1">Request timestamp is a mandatory element of type Time and holds the time the request message was originated by the originating node.  </p>
<h1 id="rfc.section.5.3">
<a href="#rfc.section.5.3">5.3.</a> Request Received Timestamp </h1>
<p id="rfc.section.5.3.p.1">Request received timestamp is a mandatory element of type Time and holds the time the request was received by the terminating node.  </p>
<h1 id="rfc.section.5.4">
<a href="#rfc.section.5.4">5.4.</a> Response Timestamp </h1>
<p id="rfc.section.5.4.p.1">Response timestamp is a mandatory element and of type Time and holds the time the response was sent by the terminating node.  </p>
<h1 id="rfc.section.5.5">
<a href="#rfc.section.5.5">5.5.</a> Originating Node Address</h1>
<p id="rfc.section.5.5.p.1">Originating node address is a mandatory element of type String and includes the originator address. It should be the address of Spam Reporting Server or Spam Reporting Client.  </p>
<h1 id="rfc.section.5.6">
<a href="#rfc.section.5.6">5.6.</a> Termination Node Address</h1>
<p id="rfc.section.5.6.p.1">Terminating node address is a mandatory element of type String and includes the recipient address. It should be the address of Spam Reporting Server or Spam Reporting Client.  </p>
<h1 id="rfc.section.5.7">
<a href="#rfc.section.5.7">5.7.</a> Policy Body</h1>
<p id="rfc.section.5.7.p.1">Policy body is a mandatory element of type Group and includes the policy elements. 0 or more policies can be included in the policy body. At least one policy must be present in the anti-spam instruction/distribution request message.  </p>
<h1 id="rfc.section.5.8">
<a href="#rfc.section.5.8">5.8.</a> Policy ID</h1>
<p id="rfc.section.5.8.p.1">Policy ID is a mandatory element of type Integer and is the unique identifier for this policy.  </p>
<h1 id="rfc.section.5.9">
<a href="#rfc.section.5.9">5.9.</a> Network Type</h1>
<p id="rfc.section.5.9.p.1">Network type is of type Enumerated and is the indicator for the network types: GSM, UMTS, LTE, 3GPP, CDMA, other, unknown, etc.  </p>
<h1 id="rfc.section.5.10">
<a href="#rfc.section.5.10">5.10.</a> Protocol ID</h1>
<p id="rfc.section.5.10.p.1">Protocol ID is of type Enumerated and is the indicator for the message protocol applicable for the policy: SMTP, SMPP, 3GPP MAP, 3GPP SIP, 3GPP2 SIP, ANSI SMDPP, etc.  </p>
<h1 id="rfc.section.5.11">
<a href="#rfc.section.5.11">5.11.</a> Message Type</h1>
<p id="rfc.section.5.11.p.1">Message type is of type Enumerated and is the indicator for the message types: email, SMS, MMS, IM, etc.  </p>
<h1 id="rfc.section.5.12">
<a href="#rfc.section.5.12">5.12.</a> Message Attributes</h1>
<p id="rfc.section.5.12.p.1">Message attribute is of type Data Structure and contains additional information about message applicable to the policy. The attributes depend on message types. Each message type has its own set of attributes.  </p>
<h1 id="rfc.section.5.13">
<a href="#rfc.section.5.13">5.13.</a> Suspicious Network Domain</h1>
<p id="rfc.section.5.13.p.1">Suspicious network domain is of type String. It includes the domain name of the network which is considered suspicious or bad.  </p>
<h1 id="rfc.section.5.14">
<a href="#rfc.section.5.14">5.14.</a> Suspicious Address</h1>
<p id="rfc.section.5.14.p.1">Suspicious address is of type String and includes the address which is considered suspicious or bad.  </p>
<h1 id="rfc.section.5.15">
<a href="#rfc.section.5.15">5.15.</a> Suspicious Address Type</h1>
<p id="rfc.section.5.15.p.1">Suspicious address type is of type String and is an indicator of type of suspicious address, IP address, mobile number (MSISDN, IMSI), email address, etc.  </p>
<h1 id="rfc.section.5.16">
<a href="#rfc.section.5.16">5.16.</a> Spam Type </h1>
<p id="rfc.section.5.16.p.1">Spam type optional field is of type Enumerated and includes the spam types: </p>

<ul>
<li>Spam </li>
<li>Phishing </li>
<li>Spoofing </li>
<li>Malware (e.g., virus/spyware) </li>
<li>Fake sender address </li>
<li>Miscategorized </li>
<li>Unauthorized sender/recipient </li>
<li>Suspicious network/domain </li>
<li>Message flooding  </li>
<li>Denial of service attack </li>
<li>Malware (e.g., virus/spyware) </li>
<li>Unauthorized message (violation of a security policy) </li>
<li>Invalid message format </li>
<li>Not Spam </li>
</ul>

<p> </p>
<h1 id="rfc.section.5.17">
<a href="#rfc.section.5.17">5.17.</a> Language Indicator</h1>
<p id="rfc.section.5.17.p.1">Message language indicator is of type Integer and is the indicator of the message language.  </p>
<h1 id="rfc.section.5.18">
<a href="#rfc.section.5.18">5.18.</a> Detection Information</h1>
<p id="rfc.section.5.18.p.1">Detection information is of type Structure and contains the information on the algorithms or method used to screening/filter the spam messages: </p>

<ul>
<li>Algorithm ID </li>
<li>Rule ID </li>
<li>Spam Keyword </li>
<li>White/black list </li>
<li>Spam Pattern Match </li>
<li>Volume threshold per sender match </li>
<li>Volume threshold per sending network/domain match </li>
<li>Others </li>
</ul>

<p> </p>
<h1 id="rfc.section.5.19">
<a href="#rfc.section.5.19">5.19.</a> Action Information</h1>
<p id="rfc.section.5.19.p.1">Action information is of type Enumerated and followings: </p>

<ul>
<li>Block with notification  </li>
<li>Block without notification  </li>
<li>Unblock and delivering  </li>
<li>Hold and quarantine </li>
<li>Others </li>
</ul>

<p> </p>
<h1 id="rfc.section.5.20">
<a href="#rfc.section.5.20">5.20.</a> Privacy Shield Information</h1>
<p id="rfc.section.5.20.p.1">Privacy shield information is of type Structure and contains privacy shield and sharing instruction.  </p>
<h1 id="rfc.section.5.21">
<a href="#rfc.section.5.21">5.21.</a> Affective Filtering Start Timestamp</h1>
<p id="rfc.section.5.21.p.1">Affective filtering start timestamp is of type Time and holds the time the policies included in the request should start to affect.  </p>
<h1 id="rfc.section.5.22">
<a href="#rfc.section.5.22">5.22.</a> Affective Filtering Stop Timestamp</h1>
<p id="rfc.section.5.22.p.1">Affective filtering start timestamp is of type Time and holds the time the policies included in the request should stop to affect.  </p>
<h1 id="rfc.section.5.23">
<a href="#rfc.section.5.23">5.23.</a> Result Code</h1>
<p id="rfc.section.5.23.p.1">Result Code is a mandatory element of type Integer and holds processing return result from the receiving node (see details in Section 6).  </p>
<h1 id="rfc.section.5.24">
<a href="#rfc.section.5.24">5.24.</a> Anti-Spam Policy Instruction Control</h1>
<p id="rfc.section.5.24.p.1">Anti-Spam Policy Instruction Control is of type Grouped. It includes information on the action requested by the client and information on any existing policy IDs that the client already has.  </p>
<h1 id="rfc.section.5.25">
<a href="#rfc.section.5.25">5.25.</a> InstructionAction</h1>
<p id="rfc.section.5.25.p.1">ActionInstruction is of type enumerated and can have any of these values: SubscribeInstruction, UnsubscribeInstruction, ImmediateInstruction.  </p>
<h1 id="rfc.section.5.26">
<a href="#rfc.section.5.26">5.26.</a> Existing Policy IDs</h1>
<p id="rfc.section.5.26.p.1">Existing Policy IDs is list of policy IDs that the client already has. This is useful for SubscriberInstruction and ImmediateInstruction option.  </p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> Result Codes</h1>
<p id="rfc.section.6.p.1">The receiving node shall include appropriate return code in the response message to the sending node for policy instruction/distribution operation. This section provides unexhausted result codes.  </p>
<h1 id="rfc.section.6.1">
<a href="#rfc.section.6.1">6.1.</a> Normal Return Codes</h1>
<p></p>

<dl>
<dt></dt>
<dd style="margin-left: 8">200 OK&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Receiving node accepted the request and there was no new policy to apply </dd>
<dt></dt>
<dd style="margin-left: 8">202 Accepted&#160;&#160;&#160;Receiving node accepted the request and there was no problem parsing the request </dd>
<dt></dt>
<dd style="margin-left: 8">212 Applied&#160;&#160;&#160;&#160;Received policies have been applied in the Spam Reporting Client for scheduled spam filtering and detection </dd>
</dl>

<p> </p>
<h1 id="rfc.section.6.2">
<a href="#rfc.section.6.2">6.2.</a> Error Return Codes</h1>
<p></p>

<ul class="empty">
<li>400 Bad request&#160;&#160;&#160;&#160;&#160;The request format and content could not be understood </li>
<li>401 Unauthorized&#160;&#160;&#160;&#160;&#160;The sending node is not authorized to send policy instruction/distribution request to the receiving node </li>
<li>406 Not Acceptable&#160;&#160;&#160;&#160;&#160;The policies received in the request are not acceptable </li>
<li>409 Conflict&#160;&#160;&#160;&#160;&#160;The request is conflict with existing policy rules </li>
<li>420 Unsupported Network Type&#160;&#160;&#160;&#160;&#160;Network type is not supported at receiving node </li>
<li>421 Unsupported Spam Type&#160;&#160;&#160;&#160;&#160;Spam type is not supported at receiving node </li>
<li>422 Unsupported Message Type &#160;&#160;&#160;&#160;&#160;Message type is not supported at receiving node </li>
<li>480 Temporarily Unavailable&#160;&#160;&#160;&#160;&#160;The receiving node is temporarily unavailable </li>
<li>500 Internal System Error&#160;&#160;&#160;&#160;&#160;The receiving node has internal system error </li>
<li>503 Service Unavailable&#160;&#160;&#160;&#160;&#160;The receiving node is unavailable for the requested service </li>
</ul>

<p> </p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> Protocols </h1>
<p id="rfc.section.7.p.1">The request and response messages specified for the anti-spam policy instruction/distribution framework operations specified in this document shall be communicated via a transaction protocol.  </p>
<p id="rfc.section.7.p.2">A sending node should initiate each transaction by sending an <a href="#RFC%202616">RFC 2616</a> <cite title="NONE">[RFC 2616]</cite> HTTP POST message to the URI of receiving node. The body of this HTTP request shall contain the request message content specified in section 4.  </p>
<p id="rfc.section.7.p.3">After receiving and processing the HTTP POST request, the receiving node shall respond with an <a href="#RFC%202616">RFC 2616</a> <cite title="NONE">[RFC 2616]</cite> HTTP response. The body of this HTTP response shall contain the response message content specified in section 4.  </p>
<p id="rfc.section.7.p.4">The XML schema for the request and response message content is to be specified following agreement on the message elements proposed in this document.  </p>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> IANA Considerations</h1>
<p id="rfc.section.8.p.1">None.  </p>
<h1 id="rfc.section.9">
<a href="#rfc.section.9">9.</a> Security Considerations</h1>
<p id="rfc.section.9.p.1">TBD </p>
<h1 id="rfc.section.10">
<a href="#rfc.section.10">10.</a> Acknowledgements</h1>
<p id="rfc.section.10.p.1">The authors thank Igor Faynberg for his invaluable help with preparing this document.  </p>
<h1 id="rfc.references">
<a href="#rfc.references">11.</a> References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC 2119">[RFC 2119]</b></td>
<td class="top">
<a>Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC 2616">[RFC 2616]</b></td>
<td class="top">
<a>Fielding, R.</a>, <a>Gettys, J.</a>, <a>Mogul, J.</a>, <a>Frystyk, H.</a>, <a>Masinter, L.</a>, <a>Leach, P.</a> and <a>T. Berners-Lee</a>, "<a href="http://tools.ietf.org/html/rfc2616">Hypertext Transfer Protocol -- HTTP/1.1</a>", RFC 2616, June 1999.</td>
</tr>
<tr>
<td class="reference"><b id="RFC 5965">[RFC 5965]</b></td>
<td class="top">
<a>Shafranovich, Y.</a>, <a>Levine, J.</a> and <a>M. Kucherawy</a>, "<a href="http://tools.ietf.org/html/rfc5965">An Extensible Format for Email Feedback Reports</a>", RFC 5965, August 2010.</td>
</tr>
<tr>
<td class="reference"><b id="OMA TS SpamRep">[OMA TS SpamRep]</b></td>
<td class="top">
<a>Mobile Spam Reporting Technical Specification</a>", October 2010.</td>, "</tr>
</tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Yigang Cai</span> 
	  <span class="n hidden">
		<span class="family-name">Cai</span>
	  </span>
	</span>
	<span class="org vcardline">Alcatel-Lucent</span>
	<span class="adr">
	  <span>2000 Lucent Ln</span>

	  <span class="vcardline">
		<span class="locality">Naperville</span>,  
		<span class="region">IL</span> 
		<span class="code">60563</span>
	  </span>
	  <span class="country-name vcardline">USA </span>
	</span>
	<span class="vcardline">Phone: +1 630 979 3303</span>

<span class="vcardline">EMail: <a href="mailto:Yigang.Cai@alcatel-lucent.com">Yigang.Cai@alcatel-lucent.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Gyan Shanker</span> 
	  <span class="n hidden">
		<span class="family-name">Shanker</span>
	  </span>
	</span>
	<span class="org vcardline">Alcatel-Lucent</span>
	<span class="adr">
	  <span>2000 Lucent Ln</span>

	  <span class="vcardline">
		<span class="locality">Naperville</span>,  
		<span class="region">IL</span> 
		<span class="code">60563</span>
	  </span>
	  <span class="country-name vcardline">USA </span>
	</span>
	<span class="vcardline">Phone: +1 630 979 4627</span>

<span class="vcardline">EMail: <a href="mailto:Gyan.Shanker@alcatel-lucent.com">Gyan.Shanker@alcatel-lucent.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Sanjeev K. Singh</span> 
	  <span class="n hidden">
		<span class="family-name">Singh</span>
	  </span>
	</span>
	<span class="org vcardline">Alcatel-Lucent</span>
	<span class="adr">
	  <span>6200 E. Broad St</span>

	  <span class="vcardline">
		<span class="locality">Columbus</span>,  
		<span class="region">OH</span> 
		<span class="code">43213</span>
	  </span>
	  <span class="country-name vcardline">USA </span>
	</span>
	<span class="vcardline">Phone: +1 614 367 5825</span>

<span class="vcardline">EMail: <a href="mailto:Sanjeev.Singh@alcatel-lucent.com">Sanjeev.Singh@alcatel-lucent.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Moh Torabi</span> 
	  <span class="n hidden">
		<span class="family-name">Torabi</span>
	  </span>
	</span>
	<span class="org vcardline">Alcatel-Lucent</span>
	<span class="adr">
	  <span>23812 Dasya Circle</span>

	  <span class="vcardline">
		<span class="locality">Monarch Beach</span>,  
		<span class="region">CA</span> 
		<span class="code">92629</span>
	  </span>
	  <span class="country-name vcardline">USA </span>
	</span>
	<span class="vcardline">Phone: +1 949 636 2116</span>

<span class="vcardline">EMail: <a href="mailto:Moh.Torabi@alcatel-lucent.com">Moh.Torabi@alcatel-lucent.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Zachary Zeltsan</span> 
	  <span class="n hidden">
		<span class="family-name">Zeltsan</span>
	  </span>
	</span>
	<span class="org vcardline">Alcatel-Lucent</span>
	<span class="adr">
	  <span>600 Mountain Avenue</span>

	  <span class="vcardline">
		<span class="locality">Murray Hill</span>,  
		<span class="region">NJ</span> 
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline">USA </span>
	</span>
	<span class="vcardline">Phone: +1 908 582 2359</span>

<span class="vcardline">EMail: <a href="mailto:Zachary.Zeltsan@alcatel-lucent.com">Zachary.Zeltsan@alcatel-lucent.com</a></span>

  </address>
</div>

</body>
</html>