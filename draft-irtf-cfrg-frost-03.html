<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Two-Round Threshold Schnorr Signatures with FROST</title>
<meta content="Deirdre Connolly" name="author">
<meta content="Chelsea Komlo" name="author">
<meta content="Ian Goldberg" name="author">
<meta content="Christopher A. Wood" name="author">
<meta content="
       In this draft, we present a two-round signing variant of FROST, a Flexible Round-Optimized
Schnorr Threshold signature scheme. FROST signatures can be issued after a threshold number
of entities cooperate to issue a signature, allowing for improved distribution of trust and
redundancy with respect to a secret key. Further, this draft specifies signatures that are
compatible with  . However, unlike  , the protocol for producing
signatures in this draft is not deterministic, so as to ensure protection against a
key-recovery attack that is possible when even only one participant is malicious. 
    " name="description">
<meta content="xml2rfc 3.12.3" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-irtf-cfrg-frost-03" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.12.3
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.8.0
    MarkupSafe 2.0.1
    pycountry 22.1.10
    pyflakes 2.4.0
    PyYAML 6.0
    requests 2.27.1
    setuptools 59.6.0
    six 1.16.0
    WeasyPrint 52.5
-->
<link href="/tmp/draft-irtf-cfrg-frost-03-k0jywi4s.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">FROST</td>
<td class="right">March 2022</td>
</tr></thead>
<tfoot><tr>
<td class="left">Connolly, et al.</td>
<td class="center">Expires 8 September 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">CFRG</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-irtf-cfrg-frost-03</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2022-03-07" class="published">7 March 2022</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-09-08">8 September 2022</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">D. Connolly</div>
<div class="org">Zcash Foundation</div>
</div>
<div class="author">
      <div class="author-name">C. Komlo</div>
<div class="org">University of Waterloo, Zcash Foundation</div>
</div>
<div class="author">
      <div class="author-name">I. Goldberg</div>
<div class="org">University of Waterloo</div>
</div>
<div class="author">
      <div class="author-name">C. A. Wood</div>
<div class="org">Cloudflare</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Two-Round Threshold Schnorr Signatures with FROST</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">In this draft, we present a two-round signing variant of FROST, a Flexible Round-Optimized
Schnorr Threshold signature scheme. FROST signatures can be issued after a threshold number
of entities cooperate to issue a signature, allowing for improved distribution of trust and
redundancy with respect to a secret key. Further, this draft specifies signatures that are
compatible with <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>. However, unlike <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>, the protocol for producing
signatures in this draft is not deterministic, so as to ensure protection against a
key-recovery attack that is possible when even only one participant is malicious.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-discussion-venues">
<a href="#name-discussion-venues" class="section-name selfRef">Discussion Venues</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">Discussion of this document takes place on the
    Crypto Forum Research Group mailing list (cfrg@ietf.org),
    which is archived at <span><a href="https://mailarchive.ietf.org/arch/search/?email_list=cfrg">https://mailarchive.ietf.org/arch/search/?email_list=cfrg</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">Source for this draft and an issue tracker can be found at
    <span><a href="https://github.com/cfrg/draft-irtf-cfrg-frost">https://github.com/cfrg/draft-irtf-cfrg-frost</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo-2">
<a href="#name-status-of-this-memo-2" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 8 September 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice-2">
<a href="#name-copyright-notice-2" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2022 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents-2">
<a href="#name-table-of-contents-2" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction-2" class="xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-change-log" class="xref">Change Log</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="xref">2</a>.  <a href="#name-conventions-and-definitions" class="xref">Conventions and Definitions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-cryptographic-dependencies" class="xref">Cryptographic Dependencies</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-prime-order-group" class="xref">Prime-Order Group</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-cryptographic-hash-function" class="xref">Cryptographic Hash Function</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-helper-functions" class="xref">Helper functions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-schnorr-signature-operation" class="xref">Schnorr Signature Operations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-polynomial-operations" class="xref">Polynomial Operations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a href="#section-4.2.1" class="xref">4.2.1</a>.  <a href="#name-evaluation-of-a-polynomial" class="xref">Evaluation of a polynomial</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.2">
                    <p id="section-toc.1-1.4.2.2.2.2.1"><a href="#section-4.2.2" class="xref">4.2.2</a>.  <a href="#name-lagrange-coefficients" class="xref">Lagrange coefficients</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.3">
                    <p id="section-toc.1-1.4.2.2.2.3.1"><a href="#section-4.2.3" class="xref">4.2.3</a>.  <a href="#name-deriving-the-constant-term-" class="xref">Deriving the constant term of a polynomial</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.  <a href="#name-commitment-list-encoding" class="xref">Commitment List Encoding</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="xref">4.4</a>.  <a href="#name-binding-factor-computation" class="xref">Binding Factor Computation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="xref">4.5</a>.  <a href="#name-group-commitment-computatio" class="xref">Group Commitment Computation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.6">
                <p id="section-toc.1-1.4.2.6.1"><a href="#section-4.6" class="xref">4.6</a>.  <a href="#name-signature-challenge-computa" class="xref">Signature Challenge Computation</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-two-round-frost" class="xref">Two-Round FROST</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-round-one-commitment" class="xref">Round One - Commitment</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-round-two-signature-share-g" class="xref">Round Two - Signature Share Generation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="xref">5.3</a>.  <a href="#name-signature-share-verificatio" class="xref">Signature Share Verification and Aggregation</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-ciphersuites" class="xref">Ciphersuites</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-frosted25519-sha-512" class="xref">FROST(Ed25519, SHA-512)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-frostristretto255-sha-512" class="xref">FROST(ristretto255, SHA-512)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="xref">6.3</a>.  <a href="#name-frosted448-shake256" class="xref">FROST(Ed448, SHAKE256)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="xref">6.4</a>.  <a href="#name-frostp-256-sha-256" class="xref">FROST(P-256, SHA-256)</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-security-considerations-2" class="xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.  <a href="#name-nonce-reuse-attacks" class="xref">Nonce Reuse Attacks</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="xref">7.2</a>.  <a href="#name-protocol-failures" class="xref">Protocol Failures</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="xref">7.3</a>.  <a href="#name-removing-the-coordinator-ro" class="xref">Removing the Coordinator Role</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="xref">7.4</a>.  <a href="#name-input-message-validation" class="xref">Input Message Validation</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-contributors-2" class="xref">Contributors</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-references-2" class="xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="xref">9.1</a>.  <a href="#name-normative-references-2" class="xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="xref">9.2</a>.  <a href="#name-informative-references-2" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-A" class="xref">Appendix A</a>.  <a href="#name-acknowledgments" class="xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-B" class="xref">Appendix B</a>.  <a href="#name-trusted-dealer-key-generati" class="xref">Trusted Dealer Key Generation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#appendix-B.1" class="xref">B.1</a>.  <a href="#name-shamir-secret-sharing" class="xref">Shamir Secret Sharing</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#appendix-B.2" class="xref">B.2</a>.  <a href="#name-verifiable-secret-sharing" class="xref">Verifiable Secret Sharing</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-C" class="xref">Appendix C</a>.  <a href="#name-wire-format" class="xref">Wire Format</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#appendix-C.1" class="xref">C.1</a>.  <a href="#name-signing-commitment" class="xref">Signing Commitment</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#appendix-C.2" class="xref">C.2</a>.  <a href="#name-signing-packages" class="xref">Signing Packages</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.3">
                <p id="section-toc.1-1.12.2.3.1"><a href="#appendix-C.3" class="xref">C.3</a>.  <a href="#name-signature-share" class="xref">Signature Share</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-D" class="xref">Appendix D</a>.  <a href="#name-test-vectors" class="xref">Test Vectors</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a href="#appendix-D.1" class="xref">D.1</a>.  <a href="#name-frosted25519-sha-512-2" class="xref">FROST(Ed25519, SHA-512)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a href="#appendix-D.2" class="xref">D.2</a>.  <a href="#name-frosted448-shake256-2" class="xref">FROST(Ed448, SHAKE256)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.3">
                <p id="section-toc.1-1.13.2.3.1"><a href="#appendix-D.3" class="xref">D.3</a>.  <a href="#name-frostristretto255-sha-512-2" class="xref">FROST(ristretto255, SHA-512)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.4">
                <p id="section-toc.1-1.13.2.4.1"><a href="#appendix-D.4" class="xref">D.4</a>.  <a href="#name-frostp-256-sha-256-2" class="xref">FROST(P-256, SHA-256)</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-E" class="xref"></a><a href="#name-authors-addresses-2" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction-2">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction-2" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">DISCLAIMER: This is a work-in-progress draft of FROST.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">RFC EDITOR: PLEASE REMOVE THE FOLLOWING PARAGRAPH The source for this draft is
maintained in GitHub. Suggested changes should be submitted as pull requests
at https://github.com/cfrg/draft-irtf-cfrg-frost. Instructions are on that page as
well.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">Unlike signatures in a single-party setting, threshold signatures
require cooperation among a threshold number of signers each holding a share
of a common private key. The security of threshold schemes in general assume
that an adversary can corrupt strictly fewer than a threshold number of participants.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">In this draft, we present a variant of FROST, a Flexible Round-Optimized Schnorr Threshold
signature scheme. FROST reduces network overhead during threshold signing operations while
employing a novel technique to protect against forgery attacks applicable to prior
Schnorr-based threshold signature constructions. FROST requires two rounds to compute
a signature.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">For select ciphersuites, the signatures produced by this draft are compatible with
<span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>. However, unlike <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>, signatures produced by FROST are not
deterministic, since deriving nonces deterministically, is insecure in a multi-party
signature setting.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">Further, this draft implements signing efficiency improvements for FROST described by
Crites, Komlo, and Maller in <span>[<a href="#Schnorr21" class="xref">Schnorr21</a>]</span>.<a href="#section-1-6" class="pilcrow">¶</a></p>
<div id="change-log">
<section id="section-1.1">
        <h3 id="name-change-log">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-change-log" class="section-name selfRef">Change Log</a>
        </h3>
<p id="section-1.1-1">draft-03<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-2.1">Refactor the second round to use state from the first round (#94).<a href="#section-1.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-2.2">Ensure that verificaftion of signature shares from the second round uses commitments from the first round (#94).<a href="#section-1.1-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-2.3">Clarify RFC8032 interoperability based on PureEdDSA (#86).<a href="#section-1.1-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-2.4">Specify signature serialization based on element and scalar serialization (#85).<a href="#section-1.1-2.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-2.5">Fix hash function domain separation formatting (#83).<a href="#section-1.1-2.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-2.6">Make trusted dealer key generation deterministic (#104).<a href="#section-1.1-2.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-2.7">Add additional constraints on participant indexes and nonce usage (#105, #103, #98, #97).<a href="#section-1.1-2.7" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-2.8">Apply various editorial improvements.<a href="#section-1.1-2.8" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-1.1-3">draft-02<a href="#section-1.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-4.1">Fully specify both rounds of FROST, as well as trusted dealer key generation.<a href="#section-1.1-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-4.2">Add ciphersuites and corresponding test vectors, including suites for RFC8032 compatibility.<a href="#section-1.1-4.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-4.3">Refactor document for editorial clarity.<a href="#section-1.1-4.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-1.1-5">draft-01<a href="#section-1.1-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-6.1">Specify operations, notation and cryptographic dependencies.<a href="#section-1.1-6.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-1.1-7">draft-00<a href="#section-1.1-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-8.1">Outline CFRG draft based on draft-komlo-frost.<a href="#section-1.1-8.1" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="conventions-and-definitions">
<section id="section-2">
      <h2 id="name-conventions-and-definitions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions-and-definitions" class="section-name selfRef">Conventions and Definitions</a>
      </h2>
<p id="section-2-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED",
"MAY", and "OPTIONAL" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">The following notation and terminology are used throughout this document.<a href="#section-2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-3.1">A participant is an entity that is trusted to hold a secret share.<a href="#section-2-3.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.2">
          <code>NUM_SIGNERS</code> denotes the number of participants, and the number of shares that <code>s</code> is split into.
This value MUST NOT exceed 2^16-1.<a href="#section-2-3.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.3">
          <code>THRESHOLD_LIMIT</code> denotes the threshold number of participants required to issue a signature. More specifically,
at least THRESHOLD_LIMIT shares must be combined to issue a valid signature.<a href="#section-2-3.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.4">
          <code>len(x)</code> is the length of integer input <code>x</code> as an 8-byte, big-endian integer.<a href="#section-2-3.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.5">
          <code>encode_uint16(x)</code>: Convert two byte unsigned integer (uint16) <code>x</code> to a 2-byte,
big-endian byte string. For example, <code>encode_uint16(310) = [0x01, 0x36]</code>.<a href="#section-2-3.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.6">|| denotes contatenation, i.e., x || y = xy.<a href="#section-2-3.6" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-2-4">Unless otherwise stated, we assume that secrets are sampled uniformly at random
using a cryptographically secure pseudorandom number generator (CSPRNG); see
<span>[<a href="#RFC4086" class="xref">RFC4086</a>]</span> for additional guidance on the generation of random numbers.<a href="#section-2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="cryptographic-dependencies">
<section id="section-3">
      <h2 id="name-cryptographic-dependencies">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-cryptographic-dependencies" class="section-name selfRef">Cryptographic Dependencies</a>
      </h2>
<p id="section-3-1">FROST depends on the following cryptographic constructs:<a href="#section-3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-2.1">Prime-order Group, <a href="#dep-pog" class="xref">Section 3.1</a>;<a href="#section-3-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-2.2">Cryptographic hash function, <a href="#dep-hash" class="xref">Section 3.2</a>;<a href="#section-3-2.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-3-3">These are described in the following sections.<a href="#section-3-3" class="pilcrow">¶</a></p>
<div id="dep-pog">
<section id="section-3.1">
        <h3 id="name-prime-order-group">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-prime-order-group" class="section-name selfRef">Prime-Order Group</a>
        </h3>
<p id="section-3.1-1">FROST depends on an abelian group <code>G</code> of prime order <code>p</code>. The fundamental group operation
is addition <code>+</code> with identity element <code>I</code>. For any elements <code>A</code> and <code>B</code> of the group <code>G</code>,
<code>A + B = B + A</code> is also a member of <code>G</code>. Also, for any <code>A</code> in <code>GG</code>, there exists an element
<code>-A</code> such that <code>A + (-A) = (-A) + A = I</code>. Scalar multiplication is equivalent to the repeated
application of the group operation on an element A with itself <code>r-1</code> times, this is denoted
as <code>r*A = A + ... + A</code>. For any element <code>A</code>, <code>p * A = I</code>. We denote <code>B</code> as the fixed generator
of the group. Scalar base multiplication is equivalent to the repeated application of the group
operation <code>B</code> with itself <code>r-1</code> times, this is denoted as <code>ScalarBaseMult(r)</code>. The set of
scalars corresponds to <code>GF(p)</code>, which refer to as the scalar field. This document uses types
<code>Element</code> and <code>Scalar</code> to denote elements of the group <code>G</code> and its set of scalars, respectively.
We denote equality comparison as <code>==</code> and assignment of values by <code>=</code>.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">We now detail a number of member functions that can be invoked on a prime-order group <code>G</code>.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-3.1">Order(): Outputs the order of <code>G</code> (i.e. <code>p</code>).<a href="#section-3.1-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-3.2">Identity(): Outputs the identity element of the group (i.e. <code>I</code>).<a href="#section-3.1-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-3.3">RandomScalar(): A member function of <code>G</code> that chooses at random a
non-zero Scalar element in GF(p).<a href="#section-3.1-3.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-3.4">SerializeElement(A): A member function of <code>G</code> that maps an Element <code>A</code>
to a unique byte array <code>buf</code> of fixed length <code>Ne</code>.<a href="#section-3.1-3.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-3.5">DeserializeElement(buf): A member function of <code>G</code> that attempts to map a
byte array <code>buf</code> to an Element <code>A</code>, and fails if the input is not a
valid byte representation of an element of the group. This function can
raise a DeserializeError if deserialization fails or <code>A</code> is the identity
element of the group; see <a href="#ciphersuites" class="xref">Section 6</a> for group-specific input validation
steps.<a href="#section-3.1-3.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-3.6">SerializeScalar(s): A member function of <code>G</code> that maps a Scalar <code>s</code>
to a unique byte array <code>buf</code> of fixed length <code>Ns</code>.<a href="#section-3.1-3.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-3.7">DeserializeScalar(buf): A member function of <code>G</code> that attempts to map a
byte array <code>buf</code> to a Scalar <code>s</code>. This function can raise a
DeserializeError if deserialization fails; see <a href="#ciphersuites" class="xref">Section 6</a> for
group-specific input validation steps.<a href="#section-3.1-3.7" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="dep-hash">
<section id="section-3.2">
        <h3 id="name-cryptographic-hash-function">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-cryptographic-hash-function" class="section-name selfRef">Cryptographic Hash Function</a>
        </h3>
<p id="section-3.2-1">FROST requires the use of a cryptographically secure hash function, generically
written as H, which functions effectively as a random oracle. For concrete
recommendations on hash functions which SHOULD BE used in practice, see
<a href="#ciphersuites" class="xref">Section 6</a>. Using H, we introduce three separate domain-separated hashes,
H1, H2, and H3, where H1 and H2 map arbitrary inputs to non-zero Scalar elements of
the prime-order group scalar field, and H3 is an alias for H with domain separation
applied. The details of H1, H2, and H3 vary based on ciphersuite. See <a href="#ciphersuites" class="xref">Section 6</a>
for more details about each.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="helpers">
<section id="section-4">
      <h2 id="name-helper-functions">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-helper-functions" class="section-name selfRef">Helper functions</a>
      </h2>
<p id="section-4-1">Beyond the core dependencies, the protocol in this document depends on the
following helper operations:<a href="#section-4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-2.1">Schnorr signatures, <a href="#dep-schnorr" class="xref">Section 4.1</a>;<a href="#section-4-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-2.2">Polynomial operations, <a href="#dep-polynomial" class="xref">Section 4.2</a>;<a href="#section-4-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-2.3">Encoding operations, <a href="#dep-encoding" class="xref">Section 4.3</a>;<a href="#section-4-2.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-2.4">Signature binding <a href="#dep-binding-factor" class="xref">Section 4.4</a>, group commitment <a href="#dep-group-commit" class="xref">Section 4.5</a>, and challenge computation <a href="#dep-sig-challenge" class="xref">Section 4.6</a><a href="#section-4-2.4" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-4-3">This sections describes these operations in more detail.<a href="#section-4-3" class="pilcrow">¶</a></p>
<div id="dep-schnorr">
<section id="section-4.1">
        <h3 id="name-schnorr-signature-operation">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-schnorr-signature-operation" class="section-name selfRef">Schnorr Signature Operations</a>
        </h3>
<p id="section-4.1-1">In the single-party setting, a Schnorr signature is generated with the
following operation.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1-2">
<pre>
  schnorr_signature_generate(msg, SK):

  Inputs:
  - msg, message to be signed, an octet string
  - SK, private key, a scalar

  Outputs: signature (R, z), a pair of scalar values

  def schnorr_signature_generate(msg, SK):
    PK = G.ScalarBaseMult(SK)
    k = G.RandomScalar()
    R = G.ScalarBaseMult(k)

    comm_enc = G.SerializeElement(R)
    pk_enc = G.SerializeElement(PK)
    challenge_input = comm_enc || pk_enc || msg
    c = H2(challenge_input)

    z = k + (c * SK)
    return (R, z)
</pre><a href="#section-4.1-2" class="pilcrow">¶</a>
</div>
<p id="section-4.1-3">The corresponding verification operation is as follows.<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1-4">
<pre>
  schnorr_signature_verify(msg, sig, PK):

  Inputs:
  - msg, signed message, an octet string
  - sig, a tuple (R, z) output from schnorr_signature_generate or FROST
  - PK, public key, a group element

  Outputs: 1 if signature is valid, and 0 otherwise

  def schnorr_signature_verify(msg, sig = (R, z), PK):
    comm_enc = G.SerializeElement(R)
    pk_enc = G.SerializeElement(PK)
    challenge_input = comm_enc || pk_enc || msg
    c = H2(challenge_input)

    l = G.ScalarBaseMult(z)
    r = R + (c * PK)
    if l == r:
      return 1
    return 0
</pre><a href="#section-4.1-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="dep-polynomial">
<section id="section-4.2">
        <h3 id="name-polynomial-operations">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-polynomial-operations" class="section-name selfRef">Polynomial Operations</a>
        </h3>
<p id="section-4.2-1">This section describes operations on and associated with polynomials
that are used in the main signing protocol. A polynomial of degree t
is represented as a sorted list of t coefficients. A point on the
polynomial is a tuple (x, y), where <code>y = f(x)</code>. For notational
convenience, we refer to the x-coordinate and y-coordinate of a
point p as <code>p.x</code> and <code>p.y</code>, respectively.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<div id="evaluation-of-a-polynomial">
<section id="section-4.2.1">
          <h4 id="name-evaluation-of-a-polynomial">
<a href="#section-4.2.1" class="section-number selfRef">4.2.1. </a><a href="#name-evaluation-of-a-polynomial" class="section-name selfRef">Evaluation of a polynomial</a>
          </h4>
<p id="section-4.2.1-1">This section describes a method for evaluating a polynomial <code>f</code> at a
particular input <code>x</code>, i.e., <code>y = f(x)</code> using Horner's method.<a href="#section-4.2.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.1-2">
<pre>
  polynomial_evaluate(x, coeffs):

  Inputs:
  - x, input at which to evaluate the polynomial, a scalar
  - coeffs, the polynomial coefficients, a list of scalars

  Outputs: Scalar result of the polynomial evaluated at input x

  def polynomial_evaluate(x, coeffs):
    value = 0
    for (counter, coeff) in coeffs.reverse():
      if counter == coeffs.len() - 1:
        value += coeff // add the constant term
      else:
        value += coeff
        value *= x

    return value
</pre><a href="#section-4.2.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="lagrange-coefficients">
<section id="section-4.2.2">
          <h4 id="name-lagrange-coefficients">
<a href="#section-4.2.2" class="section-number selfRef">4.2.2. </a><a href="#name-lagrange-coefficients" class="section-name selfRef">Lagrange coefficients</a>
          </h4>
<p id="section-4.2.2-1">Lagrange coefficients are used in FROST to evaluate a polynomial
<code>f</code> at <code>f(0)</code>, given a set of <code>t</code> other points, where <code>f</code> is
represented as a set of coefficients.<a href="#section-4.2.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.2-2">
<pre>
  derive_lagrange_coefficient(x_i, L):

  Inputs:
  - x_i, an x-coordinate contained in L, a scalar
  - L, the set of x-coordinates, each a scalar

  Outputs: L_i, the i-th Lagrange coefficient

  Errors:
  - "invalid parameters", if any coordinate is less than or equal to 0

  def derive_lagrange_coefficient(x_i, L):
    if x_i &lt;= 0:
      raise "invalid parameters"
    for x_j in L:
      if x_j &lt;= 0:
        raise "invalid parameters"

    numerator = 1
    denominator = 1
    for x_j in L:
      if x_j == x_i: continue
      numerator *= x_j
      denominator *= x_j - x_i

    L_i = numerator / denominator
    return L_i
</pre><a href="#section-4.2.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="deriving-the-constant-term-of-a-polynomial">
<section id="section-4.2.3">
          <h4 id="name-deriving-the-constant-term-">
<a href="#section-4.2.3" class="section-number selfRef">4.2.3. </a><a href="#name-deriving-the-constant-term-" class="section-name selfRef">Deriving the constant term of a polynomial</a>
          </h4>
<p id="section-4.2.3-1">Secret sharing requires "splitting" a secret, which is represented as
a constant term of some polynomial <code>f</code> of degree <code>t</code>. Recovering the
constant term occurs with a set of <code>t</code> points using polynomial
interpolation, defined as follows.<a href="#section-4.2.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.3-2">
<pre>
  Inputs:
  - points, a set of `t` points on a polynomial f, each a tuple of two
    scalar values representing the x and y coordinates

  Outputs: The constant term of f, i.e., f(0)

  def polynomial_interpolation(points):
    L = []
    for point in points:
      L.append(point.x)

    f_zero = F(0)
    for point in points:
      delta = point.y * derive_lagrange_coefficient(point.x, L)
      f_zero = f_zero + delta

    return f_zero
</pre><a href="#section-4.2.3-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="dep-encoding">
<section id="section-4.3">
        <h3 id="name-commitment-list-encoding">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-commitment-list-encoding" class="section-name selfRef">Commitment List Encoding</a>
        </h3>
<p id="section-4.3-1">This section describes the subroutine used for encoding a list of signer
commitments into a bytestring that is used in the FROST protocol.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.3-2">
<pre>
  Inputs:
  - commitment_list = [(i, hiding_nonce_commitment_i, binding_nonce_commitment_i), ...], a list of commitments issued by each signer,
    where each element in the list indicates the signer index i and their
    two commitment Element values (hiding_nonce_commitment_i, binding_nonce_commitment_i). This list MUST be sorted in ascending order
    by signer index.

  Outputs: A byte string containing the serialized representation of commitment_list.

  def encode_group_commitment_list(commitment_list):
    encoded_group_commitment = nil
    for (index, hiding_nonce_commitment, binding_nonce_commitment) in commitment_list:
      encoded_commitment = encode_uint16(index) ||
                           G.SerializeElement(hiding_nonce_commitment) ||
                           G.SerializeElement(binding_nonce_commitment)
      encoded_group_commitment = encoded_group_commitment || encoded_commitment
    return encoded_group_commitment
</pre><a href="#section-4.3-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="dep-binding-factor">
<section id="section-4.4">
        <h3 id="name-binding-factor-computation">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-binding-factor-computation" class="section-name selfRef">Binding Factor Computation</a>
        </h3>
<p id="section-4.4-1">This section describes the subroutine for computing the binding factor based
on the signer commitment list and message to be signed.<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.4-2">
<pre>
  Inputs:
  - encoded_commitment_list, an encoded commitment list (as computed
    by encode_group_commitment_list)
  - msg, the message to be signed (sent by the Coordinator).

  Outputs: binding_factor, a Scalar representing the binding factor

  def compute_binding_factor(encoded_commitment_list, msg):
    msg_hash = H3(msg)
    rho_input = encoded_commitment_list || msg_hash
    binding_factor = H1(rho_input)
    return binding_factor
</pre><a href="#section-4.4-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="dep-group-commit">
<section id="section-4.5">
        <h3 id="name-group-commitment-computatio">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-group-commitment-computatio" class="section-name selfRef">Group Commitment Computation</a>
        </h3>
<p id="section-4.5-1">This section describes the subroutine for creating the group commitment
from a commitment list.<a href="#section-4.5-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.5-2">
<pre>
  Inputs:
  - commitment_list = [(i, hiding_nonce_commitment_i, binding_nonce_commitment_i), ...], a list of
    commitments issued by each signer, where each element in the list indicates the signer index i and their
    two commitment Element values (hiding_nonce_commitment_i, binding_nonce_commitment_i).
    This list MUST be sorted in ascending order by signer index.
  - binding_factor, a Scalar

  Outputs: An Element representing the group commitment

  def compute_group_commitment(commitment_list, binding_factor):
    group_commitment = G.Identity()
    for (_, hiding_nonce_commitment, binding_nonce_commitment) in commitment_list:
      group_commitment = group_commitment + (hiding_nonce_commitment + (binding_nonce_commitment * binding_factor))
    return group_commitment
</pre><a href="#section-4.5-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="dep-sig-challenge">
<section id="section-4.6">
        <h3 id="name-signature-challenge-computa">
<a href="#section-4.6" class="section-number selfRef">4.6. </a><a href="#name-signature-challenge-computa" class="section-name selfRef">Signature Challenge Computation</a>
        </h3>
<p id="section-4.6-1">This section describes the subroutine for creating the per-message challenge.<a href="#section-4.6-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.6-2">
<pre>
  Inputs:
  - group_commitment, an Element representing the group commitment
  - group_public_key, public key corresponding to the signer secret key share.
  - msg, the message to be signed (sent by the Coordinator).

  Outputs: a challenge Scalar value

  def compute_challenge(group_commitment, group_public_key, msg):
    group_comm_enc = G.SerializeElement(group_commitment)
    group_public_key_enc = G.SerializeElement(group_public_key)
    challenge_input = group_comm_enc || group_public_key_enc || msg
    challenge = H2(challenge_input)
    return challenge
</pre><a href="#section-4.6-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="frost-spec">
<section id="section-5">
      <h2 id="name-two-round-frost">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-two-round-frost" class="section-name selfRef">Two-Round FROST</a>
      </h2>
<p id="section-5-1">FROST is a two-round threshold signature protocol for producing Schnorr signatures.
It involves signer participants and a coordinator. Signing participants are
entities with signing key shares that participate in the threshold signing
protocol. The coordinator is a distinguished signer with the following responsibilities:<a href="#section-5-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5-2">
<li id="section-5-2.1">Determining which signers will participate (at least THRESHOLD_LIMIT in number);<a href="#section-5-2.1" class="pilcrow">¶</a>
</li>
        <li id="section-5-2.2">Coordinating rounds (receiving and forwarding inputs among participants); and<a href="#section-5-2.2" class="pilcrow">¶</a>
</li>
        <li id="section-5-2.3">Aggregating signature shares output by each participant, and publishing the resulting signature.<a href="#section-5-2.3" class="pilcrow">¶</a>
</li>
      </ol>
<p id="section-5-3">FROST assumes the selection of all participants, including the dealer, signer, and
Coordinator are all chosen external to the protocol. Note that it is possible to
deploy the protocol without a distinguished Coordinator; see <a href="#no-coordinator" class="xref">Section 7.3</a> for
more information.<a href="#section-5-3" class="pilcrow">¶</a></p>
<p id="section-5-4">In FROST, all signers are assumed to have the group state and their corresponding signing
key shares. In particular, FROST assumes that each signing participant <code>P_i</code> knows the following:<a href="#section-5-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-5.1">Group public key, denoted <code>PK = G.ScalarMultBase(s)</code>, corresponding to the group secret key <code>s</code>.<a href="#section-5-5.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-5.2">Participant <code>i</code>s signing key, which is the i-th secret share of <code>s</code>.<a href="#section-5-5.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-5-6">The exact key generation mechanism is out of scope for this specification. In general,
key generation is a protocol that outputs (1) a shared, group public key PK owned
by each Signer, and (2) individual shares of the signing key owned by each Signer.
In general, two possible key generation mechanisms are possible, one that requires
a single, trusted dealer, and the other which requires performing a distributed
key generation protocol. We highlight key generation mechanism by a trusted dealer
in <a href="#dep-dealer" class="xref">Appendix B</a>, for reference.<a href="#section-5-6" class="pilcrow">¶</a></p>
<p id="section-5-7">There are two rounds in FROST: commitment and signature share generation. The first round serves
for each participant to issue a commitment. The second round receives commitments for all signers as well
as the message, and issues a signature share. The Coordinator performs the coordination of each
of these rounds. At the end of the second round, the Coordinator then performs an aggregation
step at the end and outputs the final signature. This complete interaction is shown in <a href="#fig-frost" class="xref">Figure 1</a>.<a href="#section-5-7" class="pilcrow">¶</a></p>
<span id="name-frost-signature-overview"></span><div id="fig-frost">
<figure id="figure-1">
        <div class="alignLeft art-text artwork" id="section-5-8.1">
<pre>
        (group info)             (group info,     (group info,
            |               signing key share)   signing key share)
            |                         |                |
            v                         v                v
        Coordinator               Signer-1   ...   Signer-n
    ------------------------------------------------------------
   message
------------&gt;
            |
      == Round 1 (Commitment) ==
            |    signer commitment   |                 |
            |&lt;-----------------------+                 |
            |          ...                             |
            |    signer commitment                     |
            |&lt;-----------------------------------------+

      == Round 2 (Signature Share Generation) ==
            |
            |     signer input       |                 |
            +------------------------&gt;                 |
            |     signature share    |                 |
            |&lt;-----------------------+                 |
            |          ...                             |
            |     signer input                         |
            +------------------------------------------&gt;
            |     signature share                      |
            &lt;------------------------------------------+
            |
      == Aggregation ==
            |
  signature |
&lt;-----------+
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-frost-signature-overview" class="selfRef">FROST signature overview</a>
        </figcaption></figure>
</div>
<p id="section-5-9">Details for round one are described in <a href="#frost-round-one" class="xref">Section 5.1</a>, and details for round two
are described in <a href="#frost-round-two" class="xref">Section 5.2</a>. The final Aggregation step is described in
<a href="#frost-aggregation" class="xref">Section 5.3</a>.<a href="#section-5-9" class="pilcrow">¶</a></p>
<p id="section-5-10">FROST assumes reliable message delivery between Coordinator and signing participants in
order for the protocol to complete. Messages exchanged during signing operations are all within
the public domain. An attacker masquerading as another participant will result only in an invalid
signature; see <a href="#sec-considerations" class="xref">Section 7</a>.<a href="#section-5-10" class="pilcrow">¶</a></p>
<div id="frost-round-one">
<section id="section-5.1">
        <h3 id="name-round-one-commitment">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-round-one-commitment" class="section-name selfRef">Round One - Commitment</a>
        </h3>
<p id="section-5.1-1">Round one involves each signer generating a pair of nonces and their corresponding public
commitments. A nonce is a pair of Scalar values, and a commitment is a pair of Element values.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">Each signer in round one generates a nonce <code>nonce = (hiding_nonce, binding_nonce)</code> and commitment
<code>comm = (hiding_nonce_commitment, binding_nonce_commitment)</code>.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1-3">
<pre>
  Inputs: None

  Outputs: (nonce, comm), a tuple of nonce and nonce commitment pairs.

  def commit():
    hiding_nonce = G.RandomScalar()
    binding_nonce = G.RandomScalar()
    hiding_nonce_commitment = G.ScalarBaseMult(hiding_nonce)
    binding_nonce_commitment = G.ScalarBaseMult(binding_nonce)
    nonce = (hiding_nonce, binding_nonce)
    comm = (hiding_nonce_commitment, binding_nonce_commitment)
    return (nonce, comm)
</pre><a href="#section-5.1-3" class="pilcrow">¶</a>
</div>
<p id="section-5.1-4">The private output <code>nonce</code> from Participant <code>P_i</code> is stored locally and kept private
for use in the second round. This nonce MUST NOT be reused in more than one invocation
of FROST, and it MUST be generated from a source of secure randomness. The public output
<code>comm</code> from Participant <code>P_i</code> is sent to the Coordinator; see <a href="#encode-commitment" class="xref">Appendix C.1</a>
for encoding recommendations.<a href="#section-5.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="frost-round-two">
<section id="section-5.2">
        <h3 id="name-round-two-signature-share-g">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-round-two-signature-share-g" class="section-name selfRef">Round Two - Signature Share Generation</a>
        </h3>
<p id="section-5.2-1">In round two, the Coordinator is responsible for sending the message to be signed, and
for choosing which signers will participate (of number at least THRESHOLD_LIMIT). Signers
additionally require locally held data; specifically, their private key and the
nonces corresponding to their commitment issued in round one.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">The Coordinator begins by sending each signer the message to be signed along with the
set of signing commitments for other signers in the participant list. Each signer
MUST validate the inputs before processing the Coordinator's request. In particular,
the Signer MUST validate commitment_list, deserializing each group Element in the
list using DeserializeElement from <a href="#dep-pog" class="xref">Section 3.1</a>. If deserialization fails, the Signer
MUST abort the protocol. Applications which require that signers not process arbitrary
input messages are also required to also perform relevant application-layer input
validation checks; see <a href="#message-validation" class="xref">Section 7.4</a> for more details.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2-3">Upon receipt and successful input validation, each Signer then runs the following
procedure to produce its own signature share.<a href="#section-5.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2-4">
<pre>
  Inputs:
  - index, Index `i` of the signer. Note index will never equal `0`.
  - sk_i, Signer secret key share.
  - group_public_key, public key corresponding to the signer secret key share.
  - nonce_i, pair of Scalar values (hiding_nonce, binding_nonce) generated in round one.
  - msg, the message to be signed (sent by the Coordinator).
  - commitment_list = [(j, hiding_nonce_commitment_j, binding_nonce_commitment_j), ...], a
    list of commitments issued in Round 1 by each signer, where each element in the list indicates the signer index j and their
    two commitment Element values (hiding_nonce_commitment_j, binding_nonce_commitment_j).
    This list MUST be sorted in ascending order by signer index.
  - participant_list, a set containing identifiers for each signer, similarly of length
    NUM_SIGNERS (sent by the Coordinator).

  Outputs: a Scalar value representing the signature share

  def sign(index, sk_i, group_public_key, nonce_i, msg, commitment_list, participant_list):
    # Encode the commitment list
    encoded_commitments = encode_group_commitment_list(commitment_list)

    # Compute the binding factor
    binding_factor = compute_binding_factor(encoded_commitments, msg)

    # Compute the group commitment
    group_commitment = compute_group_commitment(commitment_list, binding_factor)

    # Compute Lagrange coefficient
    lambda_i = derive_lagrange_coefficient(index, participant_list)

    # Compute the per-message challenge
    challenge = compute_challenge(group_commitment, group_public_key, msg)

    # Compute the signature share
    (hiding_nonce, binding_nonce) = nonce_i
    sig_share = hiding_nonce + (binding_nonce * binding_factor) + (lambda_i * sk_i * challenge)

    return sig_share
</pre><a href="#section-5.2-4" class="pilcrow">¶</a>
</div>
<p id="section-5.2-5">The output of this procedure is a signature share and group commitment share.
Each signer then sends these shares back to the collector; see
<a href="#encode-sig-share" class="xref">Appendix C.3</a> for encoding recommendations. Each signer MUST delete
the nonce and corresponding commitment after this round completes.<a href="#section-5.2-5" class="pilcrow">¶</a></p>
<p id="section-5.2-6">Upon receipt from each Signer, the Coordinator MUST validate the input
signature and commitment shares using DeserializeElement for each. If validation
fails, the Coordinator MUST abort the protocol. If validation succeeds, the
Coordinator then verifies the set of signature shares using the following procedure.<a href="#section-5.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="frost-aggregation">
<section id="section-5.3">
        <h3 id="name-signature-share-verificatio">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-signature-share-verificatio" class="section-name selfRef">Signature Share Verification and Aggregation</a>
        </h3>
<p id="section-5.3-1">After signers perform round two and send their signature shares to the Coordinator,
the Coordinator verifies each signature share for correctness. In particular,
for each signer, the Coordinator uses commitment pairs generated during round
one and the signature share generated during round two, along with other group
parameters, to check that the signature share is valid using the following procedure.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.3-2">
<pre>
  Inputs:
  - index, Index `i` of the signer. Note index will never equal `0`.
  - public_key_share_i, the public key for the ith signer, where public_key_share_i = G.ScalarBaseMult(s[i])
  - comm_i, pair of Element values (hiding_nonce_commitment, binding_nonce_commitment) generated
    in round one from the ith signer.
  - sig_share_i, a Scalar value indicating the signature share as produced in round two from the ith signer.
  - commitment_list = [(j, hiding_nonce_commitment_j, binding_nonce_commitment_j), ...], a list of commitments
    issued in Round 1 by each signer, where each element in the list indicates the signer index j and their
    two commitment Element values (hiding_nonce_commitment_j, binding_nonce_commitment_j).
    This list MUST be sorted in ascending order by signer index.
  - participant_list, a set containing identifiers for each signer, similarly of length
    NUM_SIGNERS (sent by the Coordinator).
  - group_public_key, the public key for the group
  - msg, the message to be signed

  Outputs: True if the signature share is valid, and False otherwise.

  def verify_signature_share(index, public_key_share_i, comm_i, sig_share_i, commitment_list,
                             participant_list, group_public_key, msg):
    # Encode the commitment list
    encoded_commitments = encode_group_commitment_list(commitment_list)

    # Compute the binding factor
    binding_factor = compute_binding_factor(encoded_commitments, msg)

    # Compute the group commitment
    group_commitment = compute_group_commitment(commitment_list, binding_factor)

    # Compute the commitment share
    (hiding_nonce_commitment, binding_nonce_commitment) = comm_i
    comm_share = hiding_nonce_commitment + (binding_nonce_commitment * binding_factor)

    # Compute the challenge
    challenge = compute_challenge(group_commitment, group_public_key, msg)

    # Compute Lagrange coefficient
    lambda_i = derive_lagrange_coefficient(index, participant_list)

    # Compute relation values
    l = G.ScalarBaseMult(sig_share_i)
    r = comm_share + (public_key_share_i * challenge * lambda_i)

    return l == r
</pre><a href="#section-5.3-2" class="pilcrow">¶</a>
</div>
<p id="section-5.3-3">If any signature share fails to verify, i.e., if verify_signature_share returns False for
any signer share, the Coordinator MUST abort the protocol. Otherwise, if all signer shares
are valid, the Coordinator performs the <code>aggregate</code> operation and publishes the resulting
signature.<a href="#section-5.3-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.3-4">
<pre>
  Inputs:
  - group_commitment, the group commitment returned by compute_group_commitment
  - sig_shares, a set of signature shares z_i for each signer, of length NUM_SIGNERS,
  where THRESHOLD_LIMIT &lt;= NUM_SIGNERS &lt;= MAX_SIGNERS.

  Outputs: (R, z), a Schnorr signature consisting of an Element and Scalar value.

  def frost_aggregate(group_commitment, sig_shares):
    z = 0
    for z_i in sig_shares:
      z = z + z_i
    return (group_commitment, z)
</pre><a href="#section-5.3-4" class="pilcrow">¶</a>
</div>
<p id="section-5.3-5">The output signature (R, z) from the aggregation step MUST be encoded as follows:<a href="#section-5.3-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.3-6">
<pre>
  struct {
    opaque R_encoded[Ne];
    opaque z_encoded[Ns];
  } Signature;
</pre><a href="#section-5.3-6" class="pilcrow">¶</a>
</div>
<p id="section-5.3-7">Where Signature.R_encoded is <code>G.SerializeElement(R)</code> and Signature.z_encoded is
<code>G.SerializeScalar(z)</code>.<a href="#section-5.3-7" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="ciphersuites">
<section id="section-6">
      <h2 id="name-ciphersuites">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-ciphersuites" class="section-name selfRef">Ciphersuites</a>
      </h2>
<p id="section-6-1">A FROST ciphersuite must specify the underlying prime-order group details
and cryptographic hash function. Each ciphersuite is denoted as (Group, Hash),
e.g., (ristretto255, SHA-512). This section contains some ciphersuites.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">The RECOMMENDED ciphersuite is (ristretto255, SHA-512) <a href="#recommended-suite" class="xref">Section 6.2</a>.
The (Ed25519, SHA-512) ciphersuite is included for backwards compatibility
with <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">The DeserializeElement and DeserializeScalar functions instantiated for a
particular prime-order group corresponding to a ciphersuite MUST adhere
to the description in <a href="#dep-pog" class="xref">Section 3.1</a>. Validation steps for these functions
are described for each the ciphersuites below. Future ciphersuites MUST
describe how input validation is done for DeserializeElement and DeserializeScalar.<a href="#section-6-3" class="pilcrow">¶</a></p>
<div id="frosted25519-sha-512">
<section id="section-6.1">
        <h3 id="name-frosted25519-sha-512">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-frosted25519-sha-512" class="section-name selfRef">FROST(Ed25519, SHA-512)</a>
        </h3>
<p id="section-6.1-1">This ciphersuite uses edwards25519 for the Group and SHA-512 for the Hash function <code>H</code>
meant to produce signatures indistinguishable from Ed25519 as specified in <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>.
The value of the contextString parameter is empty.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-2.1">
            <p id="section-6.1-2.1.1">Group: edwards25519 <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span><a href="#section-6.1-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-2.1.2.1">SerializeElement: Implemented as specified in <span>[<a href="#RFC8032" class="xref">RFC8032</a>], <a href="https://rfc-editor.org/rfc/rfc8032#section-5.1.2" class="relref">Section 5.1.2</a></span>.<a href="#section-6.1-2.1.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.1-2.1.2.2">DeserializeElement: Implemented as specified in <span>[<a href="#RFC8032" class="xref">RFC8032</a>], <a href="https://rfc-editor.org/rfc/rfc8032#section-5.1.3" class="relref">Section 5.1.3</a></span>.
Additionally, this function validates that the resulting element is not the group
identity element.<a href="#section-6.1-2.1.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.1-2.1.2.3">SerializeScalar: Implemented by outputting the little-endian 32-byte encoding of
the Scalar value.<a href="#section-6.1-2.1.2.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.1-2.1.2.4">DeserializeScalar: Implemented by attempting to deserialize a Scalar from a 32-byte
string. This function can fail if the input does not represent a Scalar between
the value 0 and <code>G.Order() - 1</code>.<a href="#section-6.1-2.1.2.4" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-6.1-2.2">
            <p id="section-6.1-2.2.1">Hash (<code>H</code>): SHA-512, and Nh = 64.<a href="#section-6.1-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-2.2.2.1">H1(m): Implemented by computing H("rho" || m), interpreting the lower
32 bytes as a little-endian integer, and reducing the resulting integer modulo
L = 2^252+27742317777372353535851937790883648493.<a href="#section-6.1-2.2.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.1-2.2.2.2">H2(m): Implemented by computing H(m), interpreting the lower 32 bytes
as a little-endian integer, and reducing the resulting integer modulo
L = 2^252+27742317777372353535851937790883648493.<a href="#section-6.1-2.2.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.1-2.2.2.3">H3(m): Implemented as an alias for H, i.e., H(m).<a href="#section-6.1-2.2.2.3" class="pilcrow">¶</a>
</li>
            </ul>
</li>
        </ul>
<p id="section-6.1-3">Normally H2 would also include a domain separator, but for backwards compatibility
with <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>, it is omitted.<a href="#section-6.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="recommended-suite">
<section id="section-6.2">
        <h3 id="name-frostristretto255-sha-512">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-frostristretto255-sha-512" class="section-name selfRef">FROST(ristretto255, SHA-512)</a>
        </h3>
<p id="section-6.2-1">This ciphersuite uses ristretto255 for the Group and SHA-512 for the Hash function <code>H</code>.
The value of the contextString parameter is "FROST-RISTRETTO255-SHA512".<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2-2.1">
            <p id="section-6.2-2.1.1">Group: ristretto255 <span>[<a href="#RISTRETTO" class="xref">RISTRETTO</a>]</span><a href="#section-6.2-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2-2.1.2.1">SerializeElement: Implemented using the 'Encode' function from <span>[<a href="#RISTRETTO" class="xref">RISTRETTO</a>]</span>.<a href="#section-6.2-2.1.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.2-2.1.2.2">DeserializElement: Implemented using the 'Decode' function from <span>[<a href="#RISTRETTO" class="xref">RISTRETTO</a>]</span>.<a href="#section-6.2-2.1.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.2-2.1.2.3">SerializeScalar: Implemented by outputting the little-endian 32-byte encoding of
the Scalar value.<a href="#section-6.2-2.1.2.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.2-2.1.2.4">DeserializeScalar: Implemented by attempting to deserialize a Scalar from a 32-byte
string. This function can fail if the input does not represent a Scalar between
the value 0 and <code>G.Order() - 1</code>.<a href="#section-6.2-2.1.2.4" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-6.2-2.2">
            <p id="section-6.2-2.2.1">Hash (<code>H</code>): SHA-512, and Nh = 64.<a href="#section-6.2-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2-2.2.2.1">H1(m): Implemented by computing H(contextString || "rho" || m) and mapping the
the output to a Scalar as described in <span>[<a href="#RISTRETTO" class="xref">RISTRETTO</a>], <a href="https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-ristretto255-decaf448-03#section-4.4" class="relref">Section 4.4</a></span>.<a href="#section-6.2-2.2.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.2-2.2.2.2">H2(m): Implemented by computing H(contextString || "chal" || m) and mapping the
the output to a Scalar as described in <span>[<a href="#RISTRETTO" class="xref">RISTRETTO</a>], <a href="https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-ristretto255-decaf448-03#section-4.4" class="relref">Section 4.4</a></span>.<a href="#section-6.2-2.2.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.2-2.2.2.3">H3(m): Implemented by computing H(contextString || "digest" || m).<a href="#section-6.2-2.2.2.3" class="pilcrow">¶</a>
</li>
            </ul>
</li>
        </ul>
</section>
</div>
<div id="frosted448-shake256">
<section id="section-6.3">
        <h3 id="name-frosted448-shake256">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-frosted448-shake256" class="section-name selfRef">FROST(Ed448, SHAKE256)</a>
        </h3>
<p id="section-6.3-1">This ciphersuite uses edwards448 for the Group and SHA256 for the Hash function <code>H</code>
meant to produce signatures indistinguishable from Ed448 as specified in <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>.
The value of the contextString parameter is empty.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.3-2.1">
            <p id="section-6.3-2.1.1">Group: edwards448 <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span><a href="#section-6.3-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.3-2.1.2.1">SerializeElement: Implemented as specified in <span>[<a href="#RFC8032" class="xref">RFC8032</a>], <a href="https://rfc-editor.org/rfc/rfc8032#section-5.2.2" class="relref">Section 5.2.2</a></span>.<a href="#section-6.3-2.1.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.3-2.1.2.2">DeserializeElement: Implemented as specified in <span>[<a href="#RFC8032" class="xref">RFC8032</a>], <a href="https://rfc-editor.org/rfc/rfc8032#section-5.2.3" class="relref">Section 5.2.3</a></span>.
Additionally, this function validates that the resulting element is not the group
identity element.<a href="#section-6.3-2.1.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.3-2.1.2.3">SerializeScalar: Implemented by outputting the little-endian 48-byte encoding of
the Scalar value.<a href="#section-6.3-2.1.2.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.3-2.1.2.4">DeserializeScalar: Implemented by attempting to deserialize a Scalar from a 48-byte
string. This function can fail if the input does not represent a Scalar between
the value 0 and <code>G.Order() - 1</code>.<a href="#section-6.3-2.1.2.4" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-6.3-2.2">
            <p id="section-6.3-2.2.1">Hash (<code>H</code>): SHAKE256, and Nh = 117.<a href="#section-6.3-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.3-2.2.2.1">H1(m): Implemented by computing H("rho" || m), interpreting the lower
57 bytes as a little-endian integer, and reducing the resulting integer modulo
L = 2^446 - 13818066809895115352007386748515426880336692474882178609894547503885.<a href="#section-6.3-2.2.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.3-2.2.2.2">H2(m): Implemented by computing H(m), interpreting the lower 57 bytes
as a little-endian integer, and reducing the resulting integer modulo
L = 2^446 - 13818066809895115352007386748515426880336692474882178609894547503885.<a href="#section-6.3-2.2.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.3-2.2.2.3">H3(m): Implemented as an alias for H, i.e., H(m).<a href="#section-6.3-2.2.2.3" class="pilcrow">¶</a>
</li>
            </ul>
</li>
        </ul>
<p id="section-6.3-3">Normally H2 would also include a domain separator, but for backwards compatibility
with <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>, it is omitted.<a href="#section-6.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="frostp-256-sha-256">
<section id="section-6.4">
        <h3 id="name-frostp-256-sha-256">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-frostp-256-sha-256" class="section-name selfRef">FROST(P-256, SHA-256)</a>
        </h3>
<p id="section-6.4-1">This ciphersuite uses P-256 for the Group and SHA-256 for the Hash function <code>H</code>.
The value of the contextString parameter is "FROST-P256-SHA256".<a href="#section-6.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.4-2.1">
            <p id="section-6.4-2.1.1">Group: P-256 (secp256r1) <span>[<a href="#x9.62" class="xref">x9.62</a>]</span><a href="#section-6.4-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.4-2.1.2.1">SerializeElement: Implemented using the compressed Elliptic-Curve-Point-to-Octet-String
method according to <span>[<a href="#SECG" class="xref">SECG</a>]</span>.<a href="#section-6.4-2.1.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.4-2.1.2.2">DeserializeElement: Implemented by attempting to deserialize a public key using
the compressed Octet-String-to-Elliptic-Curve-Point method according to <span>[<a href="#SECG" class="xref">SECG</a>]</span>,
and then performs partial public-key validation as defined in section 5.6.2.3.4 of
<span>[<a href="#KEYAGREEMENT" class="xref">KEYAGREEMENT</a>]</span>. This includes checking that the
coordinates of the resulting point are in the correct range, that the point is on
the curve, and that the point is not the point at infinity. Additionally, this function
validates  that the resulting element is not the group identity element.
If these checks fail, deserialization returns an error.<a href="#section-6.4-2.1.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.4-2.1.2.3">SerializeScalar: Implemented using the Field-Element-to-Octet-String conversion
according to <span>[<a href="#SECG" class="xref">SECG</a>]</span>.<a href="#section-6.4-2.1.2.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.4-2.1.2.4">DeserializeScalar: Implemented by attempting to deserialize a Scalar from a 32-byte
string using Octet-String-to-Field-Element from <span>[<a href="#SECG" class="xref">SECG</a>]</span>. This function can fail if the
input does not represent a Scalar between the value 0 and <code>G.Order() - 1</code>.<a href="#section-6.4-2.1.2.4" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-6.4-2.2">
            <p id="section-6.4-2.2.1">Hash (<code>H</code>): SHA-256, and Nh = 32.<a href="#section-6.4-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.4-2.2.2.1">H1(m): Implemented using hash_to_field from <span>[<a href="#HASH-TO-CURVE" class="xref">HASH-TO-CURVE</a>], <a href="https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-hash-to-curve-14#section-5.3" class="relref">Section 5.3</a></span>
using L = 48, <code>expand_message_xmd</code> with SHA-256, DST = contextString || "rho", and
prime modulus equal to <code>Order()</code>.<a href="#section-6.4-2.2.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.4-2.2.2.2">H2(m): Implemented using hash_to_field from <span>[<a href="#HASH-TO-CURVE" class="xref">HASH-TO-CURVE</a>], <a href="https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-hash-to-curve-14#section-5.3" class="relref">Section 5.3</a></span>
using L = 48, <code>expand_message_xmd</code> with SHA-256, DST = contextString || "chal", and
prime modulus equal to <code>Order()</code>.<a href="#section-6.4-2.2.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.4-2.2.2.3">H3(m): Implemented by computing H(contextString || "digest" || m).<a href="#section-6.4-2.2.2.3" class="pilcrow">¶</a>
</li>
            </ul>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="sec-considerations">
<section id="section-7">
      <h2 id="name-security-considerations-2">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-security-considerations-2" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-7-1">A security analysis of FROST exists in <span>[<a href="#FROST20" class="xref">FROST20</a>]</span>. The protocol as specified
in this document assumes the following threat model.<a href="#section-7-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-2.1">Trusted dealer. The dealer that performs key generation is trusted to follow
the protocol, although participants still are able to verify the consistency of their
shares via a VSS (verifiable secret sharing) step; see <a href="#dep-vss" class="xref">Appendix B.2</a>.<a href="#section-7-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-7-2.2">Unforgeability assuming less than <code>(t-1)</code> corrupted signers. So long as an adverary
corrupts fewer than <code>(t-1)</code> participants, the scheme remains secure against EUF-CMA attacks.<a href="#section-7-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-7-2.3">Coordinator. We assume the Coordinator at the time of signing does not perform a
denial of service attack. A denial of service would include any action which either
prevents the protocol from completing or causing the resulting signature to be invalid.
Such actions for the latter include sending inconsistent values to signing participants,
such as messages or the set of individual commitments. Note that the Coordinator
is <em>not</em> trusted with any private information and communication at the time of signing
can be performed over a public but reliable channel.<a href="#section-7-2.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-7-3">The protocol as specified in this document does not target the following goals:<a href="#section-7-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-4.1">Post quantum security. FROST, like generic Schnorr signatures, requires the hardness of the Discrete Logarithm Problem.<a href="#section-7-4.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-7-4.2">Robustness. In the case of failure, FROST requires aborting the protocol.<a href="#section-7-4.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-7-4.3">Downgrade prevention. The sender and receiver are assumed to agree on what algorithms to use.<a href="#section-7-4.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-7-4.4">Metadata protection. If protection for metadata is desired, a higher-level communication
channel can be used to facilitate key generation and signing.<a href="#section-7-4.4" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-7-5">The rest of this section documents issues particular to implementations or deployments.<a href="#section-7-5" class="pilcrow">¶</a></p>
<div id="nonce-reuse-attacks">
<section id="section-7.1">
        <h3 id="name-nonce-reuse-attacks">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-nonce-reuse-attacks" class="section-name selfRef">Nonce Reuse Attacks</a>
        </h3>
<p id="section-7.1-1">Nonces generated by each participant in the first round of signing must be sampled
uniformly at random and cannot be derived from some determinstic function. This
is to avoid replay attacks initiated by other signers, which allows for a complete
key-recovery attack. Coordinates MAY further hedge against nonce reuse attacks by
tracking signer nonce commitments used for a given group key, at the cost of additional
state.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="protocol-failures">
<section id="section-7.2">
        <h3 id="name-protocol-failures">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-protocol-failures" class="section-name selfRef">Protocol Failures</a>
        </h3>
<p id="section-7.2-1">We do not specify what implementations should do when the protocol fails, other than requiring that
the protocol abort. Examples of viable failure include when a verification check returns invalid or
if the underlying transport failed to deliver the required messages.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="no-coordinator">
<section id="section-7.3">
        <h3 id="name-removing-the-coordinator-ro">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-removing-the-coordinator-ro" class="section-name selfRef">Removing the Coordinator Role</a>
        </h3>
<p id="section-7.3-1">In some settings, it may be desirable to omit the role of the coordinator entirely.
Doing so does not change the security implications of FROST, but instead simply
requires each participant to communicate with all other participants. We loosely
describe how to perform FROST signing among signers without this coordinator role.
We assume that every participant receives as input from an external source the
message to be signed prior to performing the protocol.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
<p id="section-7.3-2">Every participant begins by performing <code>frost_commit()</code> as is done in the setting
where a coordinator is used. However, instead of sending the commitment
<code>SigningCommitment</code> to the coordinator, every participant instead will publish
this commitment to every other participant. Then, in the second round, instead of
receiving a <code>SigningPackage</code> from the coordinator, signers will already have
sufficient information to perform signing. They will directly perform <code>frost_sign</code>.
All participants will then publish a <code>SignatureShare</code> to one another. After having
received all signature shares from all other signers, each signer will then perform
<code>frost_verify</code> and then <code>frost_aggregate</code> directly.<a href="#section-7.3-2" class="pilcrow">¶</a></p>
<p id="section-7.3-3">The requirements for the underlying network channel remain the same in the setting
where all participants play the role of the coordinator, in that all messages that
are exchanged are public and so the channel simply must be reliable. However, in
the setting that a player attempts to split the view of all other players by
sending disjoint values to a subset of players, the signing operation will output
an invalid signature. To avoid this denial of service, implementations may wish
to define a mechanism where messages are authenticated, so that cheating players
can be identified and excluded.<a href="#section-7.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="message-validation">
<section id="section-7.4">
        <h3 id="name-input-message-validation">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-input-message-validation" class="section-name selfRef">Input Message Validation</a>
        </h3>
<p id="section-7.4-1">Some applications may require that signers only process messages of a certain
structure. For example, in digital currency applications wherein multiple
signers may collectively sign a transaction, it is reasonable to require that
each signer check the input message to be a syntactically valid transaction.
As another example, use of threshold signatures in TLS <span>[<a href="#TLS" class="xref">TLS</a>]</span> to produce
signatures of transcript hashes might require that signers check that the input
message is a valid TLS transcript from which the corresponding transcript hash
can be derived.<a href="#section-7.4-1" class="pilcrow">¶</a></p>
<p id="section-7.4-2">In general, input message validation is an application-specific consideration
that varies based on the use case and threat model. However, it is RECOMMENDED
that applications take additional precautions and validate inputs so that signers
do not operate as signing oracles for arbitrary messages.<a href="#section-7.4-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="contributors">
<section id="section-8">
      <h2 id="name-contributors-2">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-contributors-2" class="section-name selfRef">Contributors</a>
      </h2>
<ul class="normal">
<li class="normal" id="section-8-1.1">Isis Lovecruft<a href="#section-8-1.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-8-1.2">T. Wilson-Brown<a href="#section-8-1.2" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<section id="section-9">
      <h2 id="name-references-2">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-references-2" class="section-name selfRef">References</a>
      </h2>
<section id="section-9.1">
        <h3 id="name-normative-references-2">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-normative-references-2" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="HASH-TO-CURVE">[HASH-TO-CURVE]</dt>
        <dd>
<span class="refAuthor">Faz-Hernandez, A.</span>, <span class="refAuthor">Scott, S.</span>, <span class="refAuthor">Sullivan, N.</span>, <span class="refAuthor">Wahby, R. S.</span>, and <span class="refAuthor">C. A. Wood</span>, <span class="refTitle">"Hashing to Elliptic Curves"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-irtf-cfrg-hash-to-curve-14</span>, <time datetime="2022-02-18" class="refDate">18 February 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-hash-to-curve-14">https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-hash-to-curve-14</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="KEYAGREEMENT">[KEYAGREEMENT]</dt>
        <dd>
<span class="refAuthor">Barker, E.</span>, <span class="refAuthor">Chen, L.</span>, <span class="refAuthor">Roginsky, A.</span>, <span class="refAuthor">Vassilev, A.</span>, and <span class="refAuthor">R. Davis</span>, <span class="refTitle">"Recommendation for pair-wise key-establishment schemes using discrete logarithm cryptography"</span>, <span class="seriesInfo">National Institute of Standards and Technology report</span>, <span class="seriesInfo">DOI 10.6028/nist.sp.800-56ar3</span>, <time datetime="2018-04" class="refDate">April 2018</time>, <span>&lt;<a href="https://doi.org/10.6028/nist.sp.800-56ar3">https://doi.org/10.6028/nist.sp.800-56ar3</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8032">[RFC8032]</dt>
        <dd>
<span class="refAuthor">Josefsson, S.</span> and <span class="refAuthor">I. Liusvaara</span>, <span class="refTitle">"Edwards-Curve Digital Signature Algorithm (EdDSA)"</span>, <span class="seriesInfo">RFC 8032</span>, <span class="seriesInfo">DOI 10.17487/RFC8032</span>, <time datetime="2017-01" class="refDate">January 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8032">https://www.rfc-editor.org/rfc/rfc8032</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RISTRETTO">[RISTRETTO]</dt>
        <dd>
<span class="refAuthor">Valence, H. D.</span>, <span class="refAuthor">Grigg, J.</span>, <span class="refAuthor">Hamburg, M.</span>, <span class="refAuthor">Lovecruft, I.</span>, <span class="refAuthor">Tankersley, G.</span>, and <span class="refAuthor">F. Valsorda</span>, <span class="refTitle">"The ristretto255 and decaf448 Groups"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-irtf-cfrg-ristretto255-decaf448-03</span>, <time datetime="2022-02-25" class="refDate">25 February 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-ristretto255-decaf448-03">https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-ristretto255-decaf448-03</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SECG">[SECG]</dt>
        <dd>
<span class="refTitle">"Elliptic Curve Cryptography, Standards for Efficient Cryptography Group, ver. 2"</span>, <time datetime="2009" class="refDate">2009</time>, <span>&lt;<a href="https://secg.org/sec1-v2.pdf">https://secg.org/sec1-v2.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="x9.62">[x9.62]</dt>
      <dd>
<span class="refAuthor">ANSI</span>, <span class="refTitle">"Public Key Cryptography for the Financial Services Industry: the Elliptic Curve Digital Signature Algorithm (ECDSA)"</span>, <span class="seriesInfo">ANSI X9.62-1998</span>, <time datetime="1998-09" class="refDate">September 1998</time>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-9.2">
        <h3 id="name-informative-references-2">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-informative-references-2" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="FROST20">[FROST20]</dt>
        <dd>
<span class="refAuthor">Komlo, C.</span> and <span class="refAuthor">I. Goldberg</span>, <span class="refTitle">"Two-Round Threshold Signatures with FROST"</span>, <time datetime="2020-12-22" class="refDate">22 December 2020</time>, <span>&lt;<a href="https://eprint.iacr.org/2020/852.pdf">https://eprint.iacr.org/2020/852.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4086">[RFC4086]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span>, <span class="refAuthor">Schiller, J.</span>, and <span class="refAuthor">S. Crocker</span>, <span class="refTitle">"Randomness Requirements for Security"</span>, <span class="seriesInfo">BCP 106</span>, <span class="seriesInfo">RFC 4086</span>, <span class="seriesInfo">DOI 10.17487/RFC4086</span>, <time datetime="2005-06" class="refDate">June 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4086">https://www.rfc-editor.org/rfc/rfc4086</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Schnorr21">[Schnorr21]</dt>
        <dd>
<span class="refAuthor">Crites, E.</span>, <span class="refAuthor">Komlo, C.</span>, and <span class="refAuthor">M. Maller</span>, <span class="refTitle">"How to Prove Schnorr Assuming Schnorr"</span>, <time datetime="2021-10-11" class="refDate">11 October 2021</time>, <span>&lt;<a href="https://eprint.iacr.org/2021/1375">https://eprint.iacr.org/2021/1375</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TLS">[TLS]</dt>
      <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8446">https://www.rfc-editor.org/rfc/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="acknowledgments">
<section id="appendix-A">
      <h2 id="name-acknowledgments">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-A-1">The Zcash Foundation engineering team designed a serialization format for FROST messages which
we employ a slightly adapted version here.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="dep-dealer">
<section id="appendix-B">
      <h2 id="name-trusted-dealer-key-generati">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-trusted-dealer-key-generati" class="section-name selfRef">Trusted Dealer Key Generation</a>
      </h2>
<p id="appendix-B-1">One possible key generation mechanism is to depend on a trusted dealer, wherein the
dealer generates a group secret <code>s</code> uniformly at random and uses Shamir and Verifiable
Secret Sharing as described in Sections <a href="#dep-shamir" class="xref">Appendix B.1</a> and <a href="#dep-vss" class="xref">Appendix B.2</a> to create secret
shares of <code>s</code> to be sent to all other participants. We highlight at a high level how this
operation can be performed.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B-2">
<pre>
  Inputs:
  - s, a group secret that MUST be derived from at least `Ns` bytes of entropy
  - n, the number of shares to generate, an integer
  - t, the threshold of the secret sharing scheme, an integer

  Outputs: a public key Element, along with `n`shares of the secret key, each a Scalar value.

  def trusted_dealer_keygen(s, n, t):
    secret_key_shares = secret_share_shard(secret_key, n, t)
    public_key = G.ScalarBaseMult(secret_key)
    return public_key, secret_key_shares
</pre><a href="#appendix-B-2" class="pilcrow">¶</a>
</div>
<p id="appendix-B-3">It is assumed the dealer then sends one secret key share to each of the NUM_SIGNERS participants.
The trusted dealer MUST delete the secret_key and secret_key_shares upon completion.<a href="#appendix-B-3" class="pilcrow">¶</a></p>
<p id="appendix-B-4">Use of this method for key generation requires a mutually authenticated secure channel
between the dealer and participants to send secret key shares, wherein the channel provides confidentiality
and integrity. Mutually authenticated TLS is one possible deployment option.<a href="#appendix-B-4" class="pilcrow">¶</a></p>
<div id="dep-shamir">
<section id="appendix-B.1">
        <h3 id="name-shamir-secret-sharing">
<a href="#appendix-B.1" class="section-number selfRef">B.1. </a><a href="#name-shamir-secret-sharing" class="section-name selfRef">Shamir Secret Sharing</a>
        </h3>
<p id="appendix-B.1-1">In Shamir secret sharing, a dealer distributes a secret <code>s</code> to <code>n</code> participants
in such a way that any cooperating subset of <code>t</code> participants can recover the
secret. There are two basic steps in this scheme: (1) splitting a secret into
multiple shares, and (2) combining shares to reveal the resulting secret.<a href="#appendix-B.1-1" class="pilcrow">¶</a></p>
<p id="appendix-B.1-2">This secret sharing scheme works over any field <code>F</code>. In this specification, <code>F</code> is
the scalar field of the prime-order group <code>G</code>.<a href="#appendix-B.1-2" class="pilcrow">¶</a></p>
<p id="appendix-B.1-3">The procedure for splitting a secret into shares is as follows.<a href="#appendix-B.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.1-4">
<pre>
  secret_share_shard(s, n, t):

  Inputs:
  - s, secret to be shared, an element of F
  - n, the number of shares to generate, an integer
  - t, the threshold of the secret sharing scheme, an integer

  Outputs: A list of n secret shares, each of which is an element of F

  Errors:
  - "invalid parameters", if t &gt; n or if t is less than 2

  def secret_share_shard(s, n, t):
    if t &gt; n:
      raise "invalid parameters"
    if t &lt; 2:
      raise "invalid parameters"

    # Generate random coefficients for the polynomial, yielding
    # a polynomial of degree (t - 1)
    coefficients = [s]
    for i in range(t - 1):
      coefficients.append(G.RandomScalar())

    # Evaluate the polynomial for each point x=1,...,n
    points = []
    for x_i in range(1, n + 1):
      y_i = polynomial_evaluate(x_i, coefficients)
      point_i = (x_i, y_i)
      points.append(point_i)
    return points
</pre><a href="#appendix-B.1-4" class="pilcrow">¶</a>
</div>
<p id="appendix-B.1-5">Let <code>points</code> be the output of this function. The i-th element in <code>points</code> is
the share for the i-th participant, which is the randomly generated polynomial
evaluated at coordinate <code>i</code>. We denote a secret share as the tuple <code>(i, points[i])</code>,
and the list of these shares as <code>shares</code>.
<code>i</code> MUST never equal <code>0</code>; recall that <code>f(0) = s</code>, where <code>f</code> is the polynomial defined in a Shamir secret sharing operation.<a href="#appendix-B.1-5" class="pilcrow">¶</a></p>
<p id="appendix-B.1-6">The procedure for combining a <code>shares</code> list of length <code>t</code> to recover the
secret <code>s</code> is as follows.<a href="#appendix-B.1-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.1-7">
<pre>
  secret_share_combine(shares):

  Inputs:
  - shares, a list of t secret shares, each a tuple (i, f(i))

  Outputs: The resulting secret s, that was previously split into shares

  Errors:
  - "invalid parameters", if less than t input shares are provided

  def secret_share_combine(shares):
    if len(shares) &lt; t:
      raise "invalid parameters"
    s = polynomial_interpolation(shares)
    return s
</pre><a href="#appendix-B.1-7" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="dep-vss">
<section id="appendix-B.2">
        <h3 id="name-verifiable-secret-sharing">
<a href="#appendix-B.2" class="section-number selfRef">B.2. </a><a href="#name-verifiable-secret-sharing" class="section-name selfRef">Verifiable Secret Sharing</a>
        </h3>
<p id="appendix-B.2-1">Feldman's Verifiable Secret Sharing (VSS) builds upon Shamir secret sharing,
adding a verification step to demonstrate the consistency of a participant's
share with a public commitment to the polynomial <code>f</code> for which the secret <code>s</code>
is the constant term. This check ensure that all participants have a point
(their share) on the same polynomial, ensuring that they can later reconstruct
the correct secret. If the validation fails, the participant can issue a complaint
against the dealer, and take actions such as broadcasting this complaint to all
other participants. We do not specify the complaint procedure in this draft, as
it will be implementation-specific.<a href="#appendix-B.2-1" class="pilcrow">¶</a></p>
<p id="appendix-B.2-2">The procedure for committing to a polynomial <code>f</code> of degree <code>t-1</code> is as follows.<a href="#appendix-B.2-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.2-3">
<pre>
  vss_commit(coeffs):

  Inputs:
  - coeffs, a vector of the t coefficients which uniquely determine
  a polynomial f.

  Outputs: a commitment C, which is a vector commitment to each of the
  coefficients in coeffs.

  def vss_commit(coeffs):
    C = []
    for coeff in coeffs:
      A_i = ScalarBaseMult(coeff)
      C.append(A_i)
    return C
</pre><a href="#appendix-B.2-3" class="pilcrow">¶</a>
</div>
<p id="appendix-B.2-4">The procedure for verification of a participant's share is as follows.<a href="#appendix-B.2-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.2-5">
<pre>
  vss_verify(sk_i, C):

  Inputs:
  - sk_i: A participant's secret key, the tuple sk_i = (i, s[i]),
  where s[i] is a secret share of the constant term of f.
  - C: A VSS commitment to a secret polynomial f.

  Outputs: 1 if s[i] is valid, and 0 otherwise

  vss_verify(sk_i, commitment)
    S_i = ScalarBaseMult(s[i])
    S_i' = SUM(commitment[0], commitment[t-1]){A_j}: A_j*(i^j)
    if S_i == S_i':
      return 1
    return 0
</pre><a href="#appendix-B.2-5" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="wire-format">
<section id="appendix-C">
      <h2 id="name-wire-format">
<a href="#appendix-C" class="section-number selfRef">Appendix C. </a><a href="#name-wire-format" class="section-name selfRef">Wire Format</a>
      </h2>
<p id="appendix-C-1">Applications are responsible for encoding protocol messages between peers. This section
contains RECOMMENDED encodings for different protocol messages as described in <a href="#frost-spec" class="xref">Section 5</a>.<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<div id="encode-commitment">
<section id="appendix-C.1">
        <h3 id="name-signing-commitment">
<a href="#appendix-C.1" class="section-number selfRef">C.1. </a><a href="#name-signing-commitment" class="section-name selfRef">Signing Commitment</a>
        </h3>
<p id="appendix-C.1-1">A commitment from a signer is a pair of Element values. It can be encoded in the following manner.<a href="#appendix-C.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.1-2">
<pre>
  SignerID uint64;

  struct {
    SignerID id;
    opaque D[Ne];
    opaque E[Ne];
  } SigningCommitment;
</pre><a href="#appendix-C.1-2" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="appendix-C.1-3">
          <dt id="appendix-C.1-3.1">id</dt>
          <dd style="margin-left: 1.5em" id="appendix-C.1-3.2">
            <p id="appendix-C.1-3.2.1">The SignerID.<a href="#appendix-C.1-3.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="appendix-C.1-3.3">D</dt>
          <dd style="margin-left: 1.5em" id="appendix-C.1-3.4">
            <p id="appendix-C.1-3.4.1">The commitment hiding factor encoded as a serialized group element.<a href="#appendix-C.1-3.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="appendix-C.1-3.5">E</dt>
          <dd style="margin-left: 1.5em" id="appendix-C.1-3.6">
            <p id="appendix-C.1-3.6.1">The commitment binding factor encoded as a serialized group element.<a href="#appendix-C.1-3.6.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="encode-package">
<section id="appendix-C.2">
        <h3 id="name-signing-packages">
<a href="#appendix-C.2" class="section-number selfRef">C.2. </a><a href="#name-signing-packages" class="section-name selfRef">Signing Packages</a>
        </h3>
<p id="appendix-C.2-1">The Coordinator sends "signing packages" to each Signer in Round two. Each package
contains the list of signing commitments generated during round one along with the
message to sign. This package can be encoded in the following manner.<a href="#appendix-C.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.2-2">
<pre>
struct {
  SigningCommitment signing_commitments&lt;1..2^16-1&gt;;
  opaque msg&lt;0..2^16-1&gt;;
} SigningPackage;
</pre><a href="#appendix-C.2-2" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="appendix-C.2-3">
          <dt id="appendix-C.2-3.1">signing_commitments</dt>
          <dd style="margin-left: 1.5em" id="appendix-C.2-3.2">
            <p id="appendix-C.2-3.2.1">An list of SIGNING_COUNT SigningCommitment values, where THRESHOLD_LIIMT &lt;= SIGNING_COUNT &lt;= NUM_SIGNERS,
ordered in ascending order by SigningCommitment.id. This list MUST NOT contain more than one
SigningCommitment value corresponding to each signer. Signers MUST ignore SigningPackage values with
duplicate SignerIDs.<a href="#appendix-C.2-3.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="appendix-C.2-3.3">msg</dt>
          <dd style="margin-left: 1.5em" id="appendix-C.2-3.4">
            <p id="appendix-C.2-3.4.1">The message to be signed.<a href="#appendix-C.2-3.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="encode-sig-share">
<section id="appendix-C.3">
        <h3 id="name-signature-share">
<a href="#appendix-C.3" class="section-number selfRef">C.3. </a><a href="#name-signature-share" class="section-name selfRef">Signature Share</a>
        </h3>
<p id="appendix-C.3-1">The output of each signer is a signature share which is sent to the Coordinator. This
can be constructed as follows.<a href="#appendix-C.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.3-2">
<pre>
  struct {
    SignerID id;
    opaque signature_share[Ns];
    opaque commitment_share[Ne];
  } SignatureShare;
</pre><a href="#appendix-C.3-2" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="appendix-C.3-3">
          <dt id="appendix-C.3-3.1">id</dt>
          <dd style="margin-left: 1.5em" id="appendix-C.3-3.2">
            <p id="appendix-C.3-3.2.1">The SignerID.<a href="#appendix-C.3-3.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="appendix-C.3-3.3">signature_share</dt>
          <dd style="margin-left: 1.5em" id="appendix-C.3-3.4">
            <p id="appendix-C.3-3.4.1">The signature share from this signer encoded as a serialized scalar.<a href="#appendix-C.3-3.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="appendix-C.3-3.5">commitment_share</dt>
          <dd style="margin-left: 1.5em" id="appendix-C.3-3.6">
            <p id="appendix-C.3-3.6.1">The signature commitment share from this signer encoded as a serialized element.<a href="#appendix-C.3-3.6.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="test-vectors">
<section id="appendix-D">
      <h2 id="name-test-vectors">
<a href="#appendix-D" class="section-number selfRef">Appendix D. </a><a href="#name-test-vectors" class="section-name selfRef">Test Vectors</a>
      </h2>
<p id="appendix-D-1">This section contains test vectors for all ciphersuites listed in <a href="#ciphersuites" class="xref">Section 6</a>.
All Element and Scalar values are represented in serialized form and encoded in
hexadecimal strings. Signatures are represented as the concatenation of their
constituent parts. The input message to be signed is also encoded as a hexadecimal
string.<a href="#appendix-D-1" class="pilcrow">¶</a></p>
<p id="appendix-D-2">Each test vector consists of the following information.<a href="#appendix-D-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-D-3.1">Configuration: This lists the fixed parameters for the particular instantiation
of FROST, including MAX_SIGNERS, THRESHOLD_LIMIT, and NUM_SIGNERS.<a href="#appendix-D-3.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-D-3.2">Group input parameters: This lists the group secret key and shared public key,
generated by a trusted dealer as described in <a href="#dep-dealer" class="xref">Appendix B</a>, as well as the
input message to be signed. All values are encoded as hexadecimal strings.<a href="#appendix-D-3.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-D-3.3">Signer input parameters: This lists the signing key share for each of the
NUM_SIGNERS signers.<a href="#appendix-D-3.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-D-3.4">Round one parameters and outputs: This lists the NUM_SIGNERS participants engaged
in the protocol, identified by their integer index, the hiding and binding commitment
values produced in <a href="#frost-round-one" class="xref">Section 5.1</a>, as well as the resulting group binding factor input,
computed in part from the group commitment list encoded as described in <a href="#dep-encoding" class="xref">Section 4.3</a>,
and group binding factor as computed in <a href="#frost-round-two" class="xref">Section 5.2</a>).<a href="#appendix-D-3.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-D-3.5">Round two parameters and outputs: This lists the NUM_SIGNERS participants engaged
in the protocol, identified by their integer index, along with their corresponding
output signature share and group commitment share as produced in <a href="#frost-round-two" class="xref">Section 5.2</a>.<a href="#appendix-D-3.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-D-3.6">Final output: This lists the aggregate signature as produced in <a href="#frost-aggregation" class="xref">Section 5.3</a>.<a href="#appendix-D-3.6" class="pilcrow">¶</a>
</li>
      </ul>
<div id="frosted25519-sha-512-1">
<section id="appendix-D.1">
        <h3 id="name-frosted25519-sha-512-2">
<a href="#appendix-D.1" class="section-number selfRef">D.1. </a><a href="#name-frosted25519-sha-512-2" class="section-name selfRef">FROST(Ed25519, SHA-512)</a>
        </h3>
<div class="alignLeft art-text artwork" id="appendix-D.1-1">
<pre>
// Configuration information
MAX_SIGNERS: 3
THRESHOLD_LIMIT: 2
NUM_SIGNERS: 2

// Group input parameters
group_secret_key: 7c1c33d3f5291d85de664833beb1ad469f7fb6025a0ec78b3a7
90c6e13a98304
group_public_key: 377a6acb3b9b5f642c5ce355d23cac0568aad0da63c633d59d4
168bdcbce35af
message: 74657374

// Signer input parameters
S1 signer_share: 949dcc590407aae7d388761cddb0c0db6f5627aea8e217f4a033
f2ec83d93509
S2 signer_share: ac1e66e012e4364ac9aaa405fcafd370402d9859f7b6685c07ee
d76bf409e80d
S3 signer_share: d7cb090a075eb154e82fdb4b3cb507f110040905468bb9c46da8
bdea643a9a02

// Round one parameters
participants: 1,2
group_binding_factor_input: 000178e175d15cb5cec1257e0d84d797ba8c3dd9b
4c7bc50f3fa527c200bcc6c4a954cdad16ae67ac5919159d655b681bd038574383bab
423614f8967396ee12ca62000288a4e6c3d8353dc3f4aca2e10d10a75fb98d9fbea98
981bfb25375996c5767c932bbf10c41feb17d41cc6433e69f16cceccc42a00aedf72f
eb5f44929fdf2e2fee26b0dd4af7e749aa1a8ee3c10ae9923f618980772e473f8819a
5d4940e0db27ac185f8a0e1d5f84f88bc887fd67b143732c304cc5fa9ad8e6f57f500
28a8ff
group_binding_factor: c4d7668d793ff4c6ec424fb493cdab3ef5b625eefffe775
71ff28a345e5f700a

// Signer round one outputs
S1 hiding_nonce: 570f27bfd808ade115a701eeee997a488662bca8c2a073143e66
2318f1ed8308
S1 binding_nonce: 6720f0436bd135fe8dddc3fadd6e0d13dbd58a1981e587d377d
48e0b8f1c3c01
S1 hiding_nonce_commitment: 78e175d15cb5cec1257e0d84d797ba8c3dd9b4c7b
c50f3fa527c200bcc6c4a95
S1 binding_nonce_commitment: 4cdad16ae67ac5919159d655b681bd038574383b
ab423614f8967396ee12ca62
S2 hiding_nonce: 2a67c5e85884d0275a7a740ba8f53617527148418797345071dd
cf1a1bd37206
S2 binding_nonce: a0609158eeb448abe5b0df27f5ece96196df5722c01a999e8a4
5d2d5dfc5620c
S2 hiding_nonce_commitment: 88a4e6c3d8353dc3f4aca2e10d10a75fb98d9fbea
98981bfb25375996c5767c9
S2 binding_nonce_commitment: 32bbf10c41feb17d41cc6433e69f16cceccc42a0
0aedf72feb5f44929fdf2e2f

// Round two parameters
participants: 1,2

// Signer round two outputs
S1 sig_share: f8bbaf924e1c90e11dec1eb679194aade084f92fbf52fdd436ba0a0
7f71ab708
S1 group_commitment_share: 11bb9777aa393b92e814e415039adf62687a0be543
c2322d817e4934bc5a7cf2
S2 sig_share: 80f589405714ca0e6adc87c2c0186a0ae4d6e352f7b248b23149a5d
cd3fe4704
S2 group_commitment_share: 4af85179d17ed031b767ab579e59c7018dac09ae40
0b1700623d0af1129a9c55

sig: ebe7efbb42c4b1c55106b5536fb5e9ac7a6d0803ea4ae9c8c629ca51e05c230e
78b139d3a5305af087c8a6783a32b4b7c45bdd82b60546876803b0e3ca19ff0c
</pre><a href="#appendix-D.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="frosted448-shake256-1">
<section id="appendix-D.2">
        <h3 id="name-frosted448-shake256-2">
<a href="#appendix-D.2" class="section-number selfRef">D.2. </a><a href="#name-frosted448-shake256-2" class="section-name selfRef">FROST(Ed448, SHAKE256)</a>
        </h3>
<div class="alignLeft art-text artwork" id="appendix-D.2-1">
<pre>
// Configuration information
MAX_SIGNERS: 3
THRESHOLD_LIMIT: 2
NUM_SIGNERS: 2

// Group input parameters
group_secret_key: cef4a803a21d82fa90692e86541e08d878c9f688e5d71a2bd35
4a9a3af62b8c7c89753055949cab8fd044c17c94211f167672b053659420b00
group_public_key: 005f23508a78131aee4d6cb027f967d89557ec5f24dc3ebeede
b550466fcc1411283ff5d9c605d9a8b36e6eea36b67ceba047d57968896db80
message: 74657374

// Signer input parameters
S1 signer_share: d408a2f1d9ead0cc4b4b9b2e84a22f8e2aa2ab4ee715febe7a08
175d4298dd6bbe2e1c0b29aaa972c78555ea3b3d7308b248994780219e0800
S2 signer_share: da1c9bdf11b81f9f062d08d7b3265744dc7a6014e953e15222bc
8416d5cd0210b4c5e410f90a892c91065fbdae37d51ffc29078acae9f90500
S3 signer_share: e03094cd49856e71c10e757fe3aa7efa8d5315daea91c4e6c96f
f2cf670328b4a95cad16c96b68e65a87689021323737460b75cc14b2550300

// Round one parameters
participants: 1,2
group_binding_factor_input: 00016d8ef55145bab18c129311f1d07bef2110d0b
6841aae919eb6abf5e523d26f819d3695d78f8aa246c6b6d6fd6c2b8a63dd1cf8e8c8
9a870400a0c29f750605b10c52e347fc538af0d4ebddd23a1e0300482a7d98a39d408
356b9041d5fbaa274c2dc3f248601f21cee912e2f5700c1753a80000242c2fdc11e5f
726d4c897ed118f668a27bfb0d5946b5f513e975638b7c4b0a46cf5184d4a9c1f6310
fd3c10f84d9de704a33aab2af976d60804fa4ecba88458bcf7677a3952f540e20556d
5e90d5aa7e8f226d303ef7b88fb33a63f6cac6a9d638089b1739a5d2564d15fb3e43e
1b0b28a80b54ff7255705a71ee2925e4a3e30e41aed489a579d5595e0df13e32e1e4d
d202a7c7f68b31d6418d9845eb4d757adda6ab189e1bb340db818e5b3bc725d992faf
63e9b0500db10517fe09d3f566fba3a80e46a403e0c7d41548fbf75cf2662b00225b5
02961f98d8c9ff937de0b24c231845
group_binding_factor: 2716e157c3da80b65149b1c2cb546723516272ccf75e111
334533e2840a9bf85f3c71478ade11be26d26d8e4b9a1667af88f7df61670f60a00

// Signer round one outputs
S1 hiding_nonce: 04eccfe12348a5a2e4b30e95efcf4e494ce64b89f6504de46b3d
67a5341baaa931e455c57c6c5c81f4895e333da9d71f7d119fcfbd0d7d2000
S1 binding_nonce: 80bcd1b09e82d7d2ff6dd433b0f81e012cadd4661011c44d929
1269cf24820f5c5086d4363dc67450f24ebe560eb4c2059883545d54aa43a00
S1 hiding_nonce_commitment: 6d8ef55145bab18c129311f1d07bef2110d0b6841
aae919eb6abf5e523d26f819d3695d78f8aa246c6b6d6fd6c2b8a63dd1cf8e8c89a87
0400
S1 binding_nonce_commitment: a0c29f750605b10c52e347fc538af0d4ebddd23a
1e0300482a7d98a39d408356b9041d5fbaa274c2dc3f248601f21cee912e2f5700c17
53a80
S2 hiding_nonce: 3b3bbe82babf2a67ded81b308ba45f73b88f6cf3f6aaa4442256
b7a0354d1567478cfde0a2bba98ba4c3e65645e1b77386eb4063f925e00700
S2 binding_nonce: bcbd112a88bebf463e3509076c5ef280304cb4f1b3a7499cca1
d5e282cc2010a92ff56a3bdcf5ba352e0f4241ba2e54c1431a895c19fff0600
S2 hiding_nonce_commitment: 42c2fdc11e5f726d4c897ed118f668a27bfb0d594
6b5f513e975638b7c4b0a46cf5184d4a9c1f6310fd3c10f84d9de704a33aab2af976d
6080
S2 binding_nonce_commitment: 4fa4ecba88458bcf7677a3952f540e20556d5e90
d5aa7e8f226d303ef7b88fb33a63f6cac6a9d638089b1739a5d2564d15fb3e43e1b0b
28a80

// Round two parameters
participants: 1,2

// Signer round two outputs
S1 sig_share: ad41cd3320c82edd20c344769bd7b250105d9d0516109b7f774c297
faaf8b3b6065b19bbae2afb6c34cce460b40e15655fb8ad0bcc26e21e00
S1 group_commitment_share: 086d4d2ff2555fab65afc8eb473cc708f37cdb9c5d
e74d8e12a1a9d1a086a8914175e4db77e5d281f10441913aa680fedb207c954afdd88
380
S2 sig_share: 5dcc0aec7d0a71eddd5ba2dd0f185ba7990bcd39b6fc0e4b0470c35
6ed0deb736d7f2652e87e932a0c176cc4bc5ba0ef756cc62081e4f51900
S2 group_commitment_share: 7e91f66097b6450c52c89c14400a506ee1d37f5e52
a8d4c3fc9733c23d0b27cd6cfce55a8aee692262e5815be341e8d0b9d240a9630c9f0
600

sig: 4d9883057726b029d042418600abe88ad3fec06d6a48dca289482e9d51c10353
37e4d1aae5fd1c73a55701133238602f423886fc134a3c65800a0ed81f9ed29fcafe1
ee753abef0df8a9686a3fcc0caaca7bbcecd597069f2a74da3f0d97a98e9740e35025
716ab554d524742c4d0bd83800
</pre><a href="#appendix-D.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="frostristretto255-sha-512">
<section id="appendix-D.3">
        <h3 id="name-frostristretto255-sha-512-2">
<a href="#appendix-D.3" class="section-number selfRef">D.3. </a><a href="#name-frostristretto255-sha-512-2" class="section-name selfRef">FROST(ristretto255, SHA-512)</a>
        </h3>
<div class="alignLeft art-text artwork" id="appendix-D.3-1">
<pre>
// Configuration information
MAX_SIGNERS: 3
THRESHOLD_LIMIT: 2
NUM_SIGNERS: 2

// Group input parameters
group_secret_key: b120be204b5e758960458ca9c4675b56b12a8faff2be9c94891
d5e1cd75c880e
group_public_key: 563b80013f337deaa2a282af7b281bd70d2f501928a89c1aa48
b379a5ac4202b
message: 74657374

// Signer input parameters
S1 signer_share: 94ae65bb90030a89507fa00fff08dfed841cf996de5a0c574f1f
4693ddcb6705
S2 signer_share: 641003b3f00bb1e01656ac1818a4419a580e637ecaf67b191521
2e0ae43a470c
S3 signer_share: 479eaa4d36b145e00690c07e5245c5312c00cd65b692ebdbda22
1681eaa92603

// Round one parameters
participants: 1,2
group_binding_factor_input: 0001824e9eddddf02b2a9caf5859825e999d791ca
094f65b814a8bca6013d9cc312774c7e1271d2939a84a9a867e3a06579b4d25659b42
7439ccf0d745b43f75b76600028013834ff4d48e7d6b76c2e732bc611f54720ef8933
c4ca4de7eaaa77ff5cd125e056ecc4f7c4657d3a742354430d768f945db229c335d25
8e9622ad99f3e7582d07b35bd9849ce4af6ad403090d69a7d0eb88bba669a9f985175
d70cd15ad5f1ef5b734c98a32b4aab7b43a57e93fc09281f2e7a207076b31e416ba63
f53d9d
group_binding_factor: f00ae6007f2d74a1507c962cf30006be77596106db28f2d
5443fd66d755e780c

// Signer round one outputs
S1 hiding_nonce: 349b3bb8464a1d87f7d6b56f4559a3f9a6335261a3266089a9b1
2d9d6f6ce209
S1 binding_nonce: ce7406016a854be4291f03e7d24fe30e77994c3465de031515a
4c116f22ca901
S1 hiding_nonce_commitment: 824e9eddddf02b2a9caf5859825e999d791ca094f
65b814a8bca6013d9cc3127
S1 binding_nonce_commitment: 74c7e1271d2939a84a9a867e3a06579b4d25659b
427439ccf0d745b43f75b766
S2 hiding_nonce: 4d66d319f20a728ec3d491cbf260cc6be687bd87cc2b5fdb4d5f
528f65fd650d
S2 binding_nonce: 278b9b1e04632e6af3f1a3c144d07922ffcf5efd3a341b47abc
19c43f48ce306
S2 hiding_nonce_commitment: 8013834ff4d48e7d6b76c2e732bc611f54720ef89
33c4ca4de7eaaa77ff5cd12
S2 binding_nonce_commitment: 5e056ecc4f7c4657d3a742354430d768f945db22
9c335d258e9622ad99f3e758

// Round two parameters
participants: 1,2

// Signer round two outputs
S1 sig_share: ec6b075f17c5670e80b1fda8f6de1cfe3c79db06a852f8d5650fb71
eaad69501
S1 group_commitment_share: bc7e792fce347a15d547935652377c406cc721965c
58d3003dbd947a6dfddc0c
S2 sig_share: 87ceccc477069aa9b751b307f25955daaf943a3abc51f214a114781
de0f58e03
S2 group_commitment_share: 92c4f352ec392ba779271dc2ed09cda37f38d8c283
747d4a85b4c9ce7289cb07

sig: 7e92309bf40993141acd5f2c7680a302cc5aa5dd291a833906da8e35bc39b03e
733ad4238fcb01b83703b1b0e83872d8ec0d164164a4eaea06242f3c8acc2405
</pre><a href="#appendix-D.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="frostp-256-sha-256-1">
<section id="appendix-D.4">
        <h3 id="name-frostp-256-sha-256-2">
<a href="#appendix-D.4" class="section-number selfRef">D.4. </a><a href="#name-frostp-256-sha-256-2" class="section-name selfRef">FROST(P-256, SHA-256)</a>
        </h3>
<div class="alignLeft art-text artwork" id="appendix-D.4-1">
<pre>
// Configuration information
MAX_SIGNERS: 3
THRESHOLD_LIMIT: 2
NUM_SIGNERS: 2

// Group input parameters
group_secret_key: 6f090d1393ff53bbcbba036c00b8830ab4546c251dece199eb0
3a6a51a5a5929
group_public_key: 03db0945167b62e6472ad46373b6cbbca88e2a9a4883071f0b3
fde4b2b6d7b6ba6
message: 74657374

// Signer input parameters
S1 signer_share: 738552e18ea4f2090597aca6c23c1666845c21c676813f9e2678
6f1e410dcecf
S2 signer_share: 780198af894a90563f7555e183bfa9c25463d767cf159da261ed
379767c14475
S3 signer_share: 7c7dde7d83f02ea37952ff1c45433d1e246b8d0927a9fba69d62
00108e74ba1b

// Round one parameters
participants: 1,2
group_binding_factor_input: 000102f34caab210d59324e12ba41f0802d9545f7
f702906930766b86c462bb8ff7f3402b724640ea9e262469f401c9006991ba3247c2c
91b97cdb1f0eeab1a777e24e1e0002037f8a998dfc2e60a7ad63bc987cb27b8abf78a
68bd924ec6adb9f251850cbe711024a4e90422a19dd8463214e997042206c39d3df56
168b458592462090c89dbcf84efca0c54f70a585d6aae28679482b4aed03ae5d38297
b9092ab3376d46fdf55
group_binding_factor: 9df349a9f34bf01627f6b4f8b376e8c8261d55508d1cac2
919cdaf7f9cb20e70

// Signer round one outputs
S1 hiding_nonce: 3da92a503cf7e3f72f62dabedbb3ffcc9f555f1c1e78527940fe
3fed6d45e56f
S1 binding_nonce: ec97c41fc77ae7e795067976b2edd8b679f792abb062e4d0c33
f0f37d2e363eb
S1 hiding_nonce_commitment: 02f34caab210d59324e12ba41f0802d9545f7f702
906930766b86c462bb8ff7f34
S1 binding_nonce_commitment: 02b724640ea9e262469f401c9006991ba3247c2c
91b97cdb1f0eeab1a777e24e1e
S2 hiding_nonce: 06cb4425031e695d1f8ac61320717d63918d3edc7a02fcd3f23a
de47532b1fd9
S2 binding_nonce: 2d965a4ea73115b8065c98c1d95c7085db247168012a834d828
5a7c02f11e3e0
S2 hiding_nonce_commitment: 037f8a998dfc2e60a7ad63bc987cb27b8abf78a68
bd924ec6adb9f251850cbe711
S2 binding_nonce_commitment: 024a4e90422a19dd8463214e997042206c39d3df
56168b458592462090c89dbcf8

// Round two parameters
participants: 1,2

// Signer round two outputs
S1 sig_share: 120a8ef8a5936444d8087cb10df5648629895e94582720760a10c8c
217e3417b
S1 group_commitment_share: 0314cc3c03885953b3a15482d0ef4716eba9aca439
fa541a37489a146dd383d07e
S2 sig_share: 2a7ff42d849f1bcc0e5f75d5810900a3e8f68ab717ff10d7a6da89f
8bb0c16aa
S2 group_commitment_share: 034f4516676fe414883397fc5e150375c9937b3b77
3c9ac57a11b2b6574e6bf452

sig: 035cfbd148da711bbc823455b682ed01a1be3c5415cf692f4a91b7fe22d1dec3
453c8a83262a328010e667f2868efe652a127fe94b7026314db0eb52bad2ef5825
</pre><a href="#appendix-D.4-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-E">
      <h2 id="name-authors-addresses-2">
<a href="#name-authors-addresses-2" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Deirdre Connolly</span></div>
<div dir="auto" class="left"><span class="org">Zcash Foundation</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:durumcrustulum@gmail.com" class="email">durumcrustulum@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Chelsea Komlo</span></div>
<div dir="auto" class="left"><span class="org">University of Waterloo, Zcash Foundation</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:ckomlo@uwaterloo.ca" class="email">ckomlo@uwaterloo.ca</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Ian Goldberg</span></div>
<div dir="auto" class="left"><span class="org">University of Waterloo</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:iang@uwaterloo.ca" class="email">iang@uwaterloo.ca</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Christopher A. Wood</span></div>
<div dir="auto" class="left"><span class="org">Cloudflare</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:caw@heapingbits.net" class="email">caw@heapingbits.net</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
