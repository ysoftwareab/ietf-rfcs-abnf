<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Authentication Failure Reporting using the Abuse Report Format </title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.2" rel="Chapter" title="2 Definitions">
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 Keywords">
<link href="#rfc.section.2.2" rel="Chapter" title="2.2 Imported Definitions">
<link href="#rfc.section.3" rel="Chapter" title="3 Extension ARF Fields for Authentication Failure Reporting">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 New ARF Feedback Type">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 New ARF Header Field Names">
<link href="#rfc.section.3.2.1" rel="Chapter" title="3.2.1 Required For All Reports">
<link href="#rfc.section.3.2.2" rel="Chapter" title="3.2.2 Required For DKIM Reports">
<link href="#rfc.section.3.2.3" rel="Chapter" title="3.2.3 Optional For DKIM Reports">
<link href="#rfc.section.3.2.4" rel="Chapter" title="3.2.4 Required For ADSP Reports">
<link href="#rfc.section.3.2.5" rel="Chapter" title="3.2.5 Required For SPF Reports">
<link href="#rfc.section.3.3" rel="Chapter" title="3.3 Authentication Failure Types">
<link href="#rfc.section.4" rel="Chapter" title="4 Syntax For Added ARF Header Fields">
<link href="#rfc.section.5" rel="Chapter" title="5 Redacting Data">
<link href="#rfc.section.6" rel="Chapter" title="6 IANA Considerations">
<link href="#rfc.section.6.1" rel="Chapter" title="6.1 Updates to ARF Feedback Types">
<link href="#rfc.section.6.2" rel="Chapter" title="6.2 Updates to ARF Header Field Names">
<link href="#rfc.section.7" rel="Chapter" title="7 Security Considerations">
<link href="#rfc.section.7.1" rel="Chapter" title="7.1 Inherited Considerations">
<link href="#rfc.section.7.2" rel="Chapter" title="7.2 Forgeries">
<link href="#rfc.section.7.3" rel="Chapter" title="7.3 Automatic Generation">
<link href="#rfc.section.7.4" rel="Chapter" title="7.4 Envelope Sender Selection">
<link href="#rfc.section.7.5" rel="Chapter" title="7.5 Reporting Multiple Incidents">
<link href="#rfc.section.7.6" rel="Chapter" title="7.6 Redaction of Data in DKIM Reports">
<link href="#rfc.references" rel="Chapter" title="8 References">
<link href="#rfc.references.1" rel="Chapter" title="8.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="8.2 Informative References">
<link href="#rfc.appendix.Appendix%20A" rel="Chapter" title="Appendix A Acknowledgements">
<link href="#rfc.appendix.Appendix%20B" rel="Chapter" title="Appendix B Examples">
<link href="#rfc.appendix.Appendix%20B.1" rel="Chapter" title="Appendix B.1 Example Use of ARF Extension Headers">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="This memo registers an extension report type to ARF for use in reporting messages that fail one or more authentication checks performed on receipt of a message, with the option to include forensic information describing the specifics of the failure." />
  <meta name="description" content="This memo registers an extension report type to ARF for use in reporting messages that fail one or more authentication checks performed on receipt of a message, with the option to include forensic information describing the specifics of the failure." />
  <meta name="keywords" content="Internet-Draft, Standards Track" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">MARF Working Group</td>
<td class="right">H.F. Fontana</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">eCert Inc.</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">October 09, 2011</td>
</tr>
<tr>
<td class="left">Expires: April 11, 2012</td>
<td class="right"></td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Authentication Failure Reporting using the Abuse Report Format <br />
  <span class="filename">draft-ietf-marf-authfailure-report-03</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>This memo registers an extension report type to ARF for use in reporting messages that fail one or more authentication checks performed on receipt of a message, with the option to include forensic information describing the specifics of the failure.</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on April 11, 2012.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>2.   <a href="#rfc.section.2">Definitions</a>
</li>
<li>2.1.   <a href="#rfc.section.2.1">Keywords</a>
</li>
<li>2.2.   <a href="#rfc.section.2.2">Imported Definitions</a>
</li>
<li>3.   <a href="#rfc.section.3">Extension ARF Fields for Authentication Failure Reporting</a>
</li>
<li>3.1.   <a href="#rfc.section.3.1">New ARF Feedback Type</a>
</li>
<li>3.2.   <a href="#rfc.section.3.2">New ARF Header Field Names</a>
</li>
<li>3.2.1.   <a href="#rfc.section.3.2.1">Required For All Reports</a>
</li>
<li>3.2.2.   <a href="#rfc.section.3.2.2">Required For DKIM Reports</a>
</li>
<li>3.2.3.   <a href="#rfc.section.3.2.3">Optional For DKIM Reports</a>
</li>
<li>3.2.4.   <a href="#rfc.section.3.2.4">Required For ADSP Reports</a>
</li>
<li>3.2.5.   <a href="#rfc.section.3.2.5">Required For SPF Reports</a>
</li>
<li>3.3.   <a href="#rfc.section.3.3">Authentication Failure Types</a>
</li>
<li>4.   <a href="#rfc.section.4">Syntax For Added ARF Header Fields</a>
</li>
<li>5.   <a href="#rfc.section.5">Redacting Data</a>
</li>
<li>6.   <a href="#rfc.section.6">IANA Considerations</a>
</li>
<li>6.1.   <a href="#rfc.section.6.1">Updates to ARF Feedback Types</a>
</li>
<li>6.2.   <a href="#rfc.section.6.2">Updates to ARF Header Field Names</a>
</li>
<li>7.   <a href="#rfc.section.7">Security Considerations</a>
</li>
<li>7.1.   <a href="#rfc.section.7.1">Inherited Considerations</a>
</li>
<li>7.2.   <a href="#rfc.section.7.2">Forgeries</a>
</li>
<li>7.3.   <a href="#rfc.section.7.3">Automatic Generation</a>
</li>
<li>7.4.   <a href="#rfc.section.7.4">Envelope Sender Selection</a>
</li>
<li>7.5.   <a href="#rfc.section.7.5">Reporting Multiple Incidents</a>
</li>
<li>7.6.   <a href="#rfc.section.7.6">Redaction of Data in DKIM Reports</a>
</li>
<li>8.   <a href="#rfc.references">References</a>
</li>
<li>8.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>8.2.   <a href="#rfc.references.2">Informative References</a>
</li>
<li>Appendix A.   <a href="#rfc.appendix.Appendix%20A">Acknowledgements</a>
</li>
<li>Appendix B.   <a href="#rfc.appendix.Appendix%20B">Examples</a>
</li>
<li>Appendix B.1.   <a href="#rfc.appendix.Appendix%20B.1">Example Use of ARF Extension Headers</a>
</li>
<li><a href="#rfc.authors">Author's Address</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> <a href="#intro" id="intro">Introduction</a>
</h1>
<p><a href="#ARF">[ARF]</a> defines a message format for sending reports of abuse in the messaging infrastructure, with an eye towards automating both the generation and consumption of those reports.  There is now also a desire to use extend the ARF format to include reporting of messages that fail to authenticate using known authentication methods, as these are sometimes evidence of abuse that can be detected and reported through automated means.  The same mechanism can be used to convey forensic information about the specific reason the authentication method failed.  Thus, this memo presents such extensions to the Abuse Reporting Format to allow for detailed reporting of message authentication failures. </p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> <a href="#definitions" id="definitions">Definitions</a>
</h1>
<h1 id="rfc.section.2.1">
<a href="#rfc.section.2.1">2.1.</a> <a href="#keywords" id="keywords">Keywords</a>
</h1>
<p id="rfc.section.2.1.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#KEYWORDS">[KEYWORDS]</a>. </p>
<h1 id="rfc.section.2.2">
<a href="#rfc.section.2.2">2.2.</a> <a href="#imports" id="imports">Imported Definitions</a>
</h1>
<p id="rfc.section.2.2.p.1">The ABNF token "qp-section" is imported from <a href="#MIME">[MIME]</a>. </p>
<p id="rfc.section.2.2.p.2">base64 is defined in <a href="#MIME">[MIME]</a>. </p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#arf-extend" id="arf-extend">Extension ARF Fields for Authentication Failure Reporting</a>
</h1>
<p id="rfc.section.3.p.1">The current report format defined in <a href="#ARF">[ARF]</a> lacks some specific features required to do effective sender authentication reporting.  This section defines extensions to ARF to accommodate this requirement.  </p>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> <a href="#arf-fields" id="arf-fields">New ARF Feedback Type</a>
</h1>
<p id="rfc.section.3.1.p.1">A new feedback type of "auth-failure" is defined as an extension to Section 8.2 of <a href="#ARF">[ARF]</a>.  See <a href="#auth-failures">Section 3.3</a> for details. </p>
<p id="rfc.section.3.1.p.2">A message that uses this feedback type has the following modified header field requirements for the second (machine-parseable) MIME part of the report: </p>

<dl>
<dt>Authentication-Results:</dt>
<dd style="margin-left: 8">MUST appear at least once, and SHOULD report all methods that were tested by the entity generating the report.  It MUST be formatted according to <a href="#AUTH-RESULTS">[AUTH-RESULTS]</a>.  </dd>
<dt>Original-Envelope-Id:</dt>
<dd style="margin-left: 8">As specified in <a href="#ARF">[ARF]</a>.  This field SHOULD be included exactly once if it available to the entity generating the report.</dd>
<dt>Original-Mail-From:</dt>
<dd style="margin-left: 8">As specified in <a href="#ARF">[ARF]</a>.  This field SHOULD be included exactly once for SPF, or for other methods that evaluate authentication during the SMTP phase.</dd>
<dt>Source-IP:</dt>
<dd style="margin-left: 8">As specified in <a href="#ARF">[ARF]</a>.  This field SHOULD be included exactly once for SPF, or for other methods that evaluate authentication during the SMTP phase. </dd>
<dt>Reported-Domain:</dt>
<dd style="margin-left: 8">As specified in <a href="#ARF">[ARF]</a>.  This field MUST appear at least once. </dd>
<dt>Delivery-Result:</dt>
<dd style="margin-left: 8">As specified in <a href="#arf-headers-1">Section 3.2.1</a> is OPTIONAL, MUST NOT appear more than once.  If present, it SHOULD indicate the outcome of the message in some meaningful way, but might be redacted to &#8217;other&#8217; for local policy reasons.  </dd>
</dl>

<p> </p>
<p id="rfc.section.3.1.p.3">The third MIME part of the message is either of type "message/rfc822" (as defined in <a href="#MIME-TYPES">[MIME-TYPES]</a>) or "text/rfc822-headers" (as defined in <a href="#REPORT">[REPORT]</a>) and contains a copy of the entire header block from the original message.  This part MUST be included (contrary to <a href="#REPORT">[REPORT]</a>). </p>
<p id="rfc.section.3.1.p.4">For privacy reasons, report generators might need to redact portions of a reported message such as the end user whose complaint action resulted in the report.  See <a href="#redacting">Section 5</a> for a discussion of this. </p>
<h1 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> <a href="#arf-headers" id="arf-headers">New ARF Header Field Names</a>
</h1>
<p id="rfc.section.3.2.p.1">The following new ARF field names are defined as extensions to Section 3.1 of <a href="#ARF">[ARF]</a>. </p>
<p id="rfc.section.3.2.p.2">The values that are base64 encodings may contain FWS for formatting purposes as per the usual header field wrapping defined in <a href="#MAIL">[MAIL]</a>.  During decoding, any characters not in the base64 alphabet are ignored so that such line wrapping does not harm the value.  The ABNF token "FWS" is defined in <a href="#DKIM">[DKIM]</a>. </p>
<h1 id="rfc.section.3.2.1">
<a href="#rfc.section.3.2.1">3.2.1.</a> <a href="#arf-headers-1" id="arf-headers-1">Required For All Reports</a>
</h1>
<p></p>

<dl>
<dt>Auth-Failure:</dt>
<dd style="margin-left: 8">Indicates the type of authentication failure that is being reported.  The list of valid values is enumerated below. </dd>
<dt>Delivery-Result:</dt>
<dd style="margin-left: 8">The final message disposition that was enacted by the ADMD generating the report.  Possible values are: <dl>
<dt>delivered:</dt>
<dd style="margin-left: 8">The message was delivered (not specific as to where). </dd>
<dt>spam:</dt>
<dd style="margin-left: 8">The message was delivered to the recipient's spam folder (or equivalent). </dd>
<dt>policy:</dt>
<dd style="margin-left: 8">The message was not delivered to the intended inbox due to authentication failure.  The specific action taken is not specified. </dd>
<dt>reject:</dt>
<dd style="margin-left: 8">The message was rejected. </dd>
<dt>other:</dt>
<dd style="margin-left: 8">The message had a final disposition not covered by one of the above values. </dd>
</dl>
</dd>
</dl>

<p> </p>
<h1 id="rfc.section.3.2.2">
<a href="#rfc.section.3.2.2">3.2.2.</a> <a href="#arf-headers-2" id="arf-headers-2">Required For DKIM Reports</a>
</h1>
<p></p>

<dl>
<dt>DKIM-Domain:</dt>
<dd style="margin-left: 8">The domain that signed the message, taken from the "d=" tag of the signature. </dd>
<dt>DKIM-Identity:</dt>
<dd style="margin-left: 8">The identity of the signature that failed verification, taken from the "i=" tag of the signature.  </dd>
<dt>DKIM-Selector:</dt>
<dd style="margin-left: 8">The selector of the signature that failed verification, taken from the "s=" tag of the signature.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.3.2.3">
<a href="#rfc.section.3.2.3">3.2.3.</a> <a href="#arf-headers-3" id="arf-headers-3">Optional For DKIM Reports</a>
</h1>
<p id="rfc.section.3.2.3.p.1">DKIM-Canonicalized-Header and DKIM-Canonicalized-Body MUST NOT include redacted data.  The data presented there have to be exactly the canonicalized header and body as defined by  <a href="#DKIM">[DKIM]</a> and computed at the verifier. This is because these fields are intended to aid in identifying message alterations that invalidate DKIM signatures in transit.  Including redacted data in them renders the data unusable.  (See also Section 5 and Section 7.6 for further discussion.) </p>
<p></p>

<dl>
<dt>DKIM-Canonicalized-Header:</dt>
<dd style="margin-left: 8">A base64 encoding of the canonicalized header of the message as generated by the verifier.  </dd>
<dt>DKIM-Canonicalized-Body:</dt>
<dd style="margin-left: 8">A base64 encoding of the canonicalized body of the message as generated by the verifier.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.3.2.4">
<a href="#rfc.section.3.2.4">3.2.4.</a> <a href="#arf-headers-4" id="arf-headers-4">Required For ADSP Reports</a>
</h1>
<p id="rfc.section.3.2.4.p.1">DKIM-ADSP-DNS: Includes the ADSP record discovered and applied by the entity generating this report.  </p>
<h1 id="rfc.section.3.2.5">
<a href="#rfc.section.3.2.5">3.2.5.</a> <a href="#arf-headers-5" id="arf-headers-5">Required For SPF Reports</a>
</h1>
<p id="rfc.section.3.2.5.p.1">SPF-DNS MUST appear once for every query to an SPF record that was done, to enable the reporting of included fields and where they came from.  The ABNF in Section 4 changes; see below.  </p>
<h1 id="rfc.section.3.3">
<a href="#rfc.section.3.3">3.3.</a> <a href="#auth-failures" id="auth-failures">Authentication Failure Types</a>
</h1>
<p id="rfc.section.3.3.p.1">The list of defined authentication failure types, used in the "Auth-Failure:" header field (defined above), is as follows: </p>

<dl>
<dt>adsp:</dt>
<dd style="margin-left: 8">The message did not conform to the sender's published <a href="#ADSP">[ADSP]</a> signing practises.  The DKIM-ADSP-DNS field MUST be included in the report. </dd>
<dt>bodyhash:</dt>
<dd style="margin-left: 8">The body hash in the signature and the body hash computed by the verifier did not match.  The DKIM-Canonicalized-Body field SHOULD be included in the report. </dd>
<dt>revoked:</dt>
<dd style="margin-left: 8">The DKIM key referenced by the signature on the message has been revoked.  The DKIM-Domain and DKIM-Selector fields MUST be included in the report. </dd>
<dt>signature:</dt>
<dd style="margin-left: 8">The DKIM signature on the message did not successfully verify against the header hash and public key.  The DKIM-Domain, DKIM-Selector and DKIM-Canonicalized-Header fields MUST be included in the report. </dd>
<dt>spf:</dt>
<dd style="margin-left: 8">The evaluation of the sending domain's SPF record produced a "fail", "softfail", "temperror" or "permerror" result. </dd>
</dl>

<p> </p>
<p id="rfc.section.3.3.p.2">Supplementary data MAY be included in the form of <a href="#MAIL">[MAIL]</a>-compliant comments.  For example, "Auth-Failure: adsp" could be augmented by a comment to indicate that the failed message was rejected because it was not signed when it should have been.  See <a href="#examples">Appendix Appendix B</a> for examples. </p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#abnf_fields" id="abnf_fields">Syntax For Added ARF Header Fields</a>
</h1>
<p id="rfc.section.4.p.1">The ABNF definitions for the new fields are as follows: </p>
<div id="#rfc.figure.1"></div>
<pre>
    auth-failure = "Auth-Failure:" [CFWS] token [CFWS] CRLF
      ; "token" must be a registered authentication failure type
      ; as specified elsewhere in this memo

    delivery-result = "Delivery-Result:" [CFWS]
                      ( "delivered" / "spam" /"policy" /
                        "reject" / "other" ) [CFWS] CRLF

    dkim-header = "DKIM-Canonicalized-Header:" [CFWS]
                  base64string CRLF
      ; "base64string" is imported from [DKIM]

    dkim-domain = "DKIM-Domain:" [CFWS] domain [CFWS] CRLF

    dkim-identity = "DKIM-Identity:" [CFWS] [ local-part ] "@"
                    domain-name [CFWS] CRLF
      ; "local-part" is imported from [MAIL]

    dkim-selector = "DKIM-Selector:" [CFWS] token [CFWS] CRLF

    dkim-adsp-dns = "DKIM-ADSP-DNS:" [CFWS]
                    quoted-string [CFWS] CRLF
      ; "quoted-string" is imported from [MAIL]

    dkim-body = "DKIM-Canonicalized-Body:" [CFWS]
                base64string CRLF

    dkim-selector-dns = "DKIM-Selector-DNS:" [CFWS]
                        quoted-string [CFWS] CRLF

    spf-dns = "SPF-DNS:" : { &#8220;txt&#8221; / &#8220;spf&#8221; } [FWS] &#8220;:&#8221; [FWS] 
               domain [FWS] &#8220;:&#8221; [FWS] quoted-string


		</pre>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#redacting" id="redacting">Redacting Data</a>
</h1>
<p id="rfc.section.5.p.1">For privacy considerations it might be the policy of a report generator to redact, or obscure, portions of the report that might identify an end user that caused the report to be generated.  Precisely how this is done is unspecified in <a href="#ARF">[ARF]</a> as it will generally be a matter of local policy.  That specification does admonish generators against being overly zealous with this practice, as obscuring too much data makes the report inactionable. </p>
<p id="rfc.section.5.p.2">Generally, it is assumed that the recipient fields of a message (i.e. those containing recipient addresses), when copied into a report, are to be obscured to protect the identify of an end user that submitted a complaint about a message.  However, it is also presumed that other data will be left intact, data that could be correlated against logs to determine the source of the message that drew a complaint.  </p>
<p id="rfc.section.5.p.3">See <a href="#I-D.IETF-MARF-REDACTION">[I-D.IETF-MARF-REDACTION]</a> for further details.  </p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#iana" id="iana">IANA Considerations</a>
</h1>
<p id="rfc.section.6.p.1">As required by <a href="#IANA-CONSIDERATIONS">[IANA-CONSIDERATIONS]</a>, this section contains registry information for the new tag, and the extension to <a href="#ARF">[ARF]</a>.  </p>
<h1 id="rfc.section.6.1">
<a href="#rfc.section.6.1">6.1.</a> <a href="#iana-dkim-arf-types" id="iana-dkim-arf-types">Updates to ARF Feedback Types</a>
</h1>
<p id="rfc.section.6.1.p.1">The following feedback type is added to the Feedback Report Feedback Type Registry: </p>
<div id="#rfc.figure.2"></div>
<pre>
    Feedback Type: auth-failure
    Description: sender authentication failure report
    Registration: (this document)
			</pre>
<h1 id="rfc.section.6.2">
<a href="#rfc.section.6.2">6.2.</a> <a href="#iana-dkim-arf-headers" id="iana-dkim-arf-headers">Updates to ARF Header Field Names</a>
</h1>
<p id="rfc.section.6.2.p.1">The following headers are added to the Feedback Report Header Names Registry: </p>
<div id="#rfc.figure.3"></div>
<pre>
    Field Name: Auth-Failure
    Description: Type of authentication failure
    Multiple Appearances: No
    Related "Feedback-Type": auth-failure
			</pre>
<div id="#rfc.figure.4"></div>
<pre>
    Field Name: Delivery-Result
    Description: Final disposition of the subject message
    Multiple Appearances: No
    Related "Feedback-Type": auth-failure
			</pre>
<div id="#rfc.figure.5"></div>
<pre>
    Field Name: DKIM-ADSP-DNS
    Description: Retrieved DKIM ADSP record
    Multiple Appearances: No
    Related "Feedback-Type": auth-failure
			</pre>
<div id="#rfc.figure.6"></div>
<pre>
    Field Name: DKIM-Canonicalized-Body
    Description: Canonicalized body, per DKIM
    Multiple Appearances: No
    Related "Feedback-Type": auth-failure
			</pre>
<div id="#rfc.figure.7"></div>
<pre>
    Field Name: DKIM-Canonicalized-Header
    Description: Canonicalized header, per DKIM
    Multiple Appearances: No
    Related "Feedback-Type": auth-failure
			</pre>
<div id="#rfc.figure.8"></div>
<pre>
    Field Name: DKIM-Domain
    Description: DKIM signing domain from "d=" tag
    Multiple Appearances: No
    Related "Feedback-Type": auth-failure
			</pre>
<div id="#rfc.figure.9"></div>
<pre>
    Field Name: DKIM-Identity
    Description: Identity from DKIM signature
    Multiple Appearances: No
    Related "Feedback-Type": auth-failure
			</pre>
<div id="#rfc.figure.10"></div>
<pre>
    Field Name: DKIM-Selector
    Description: Selector from DKIM signature
    Multiple Appearances: No
    Related "Feedback-Type": auth-failure
			</pre>
<div id="#rfc.figure.11"></div>
<pre>
    Field Name: DKIM-Selector-DNS
    Description: Retrieved DKIM key record
    Multiple Appearances: No
    Related "Feedback-Type": auth-failure
			</pre>
<div id="#rfc.figure.12"></div>
<pre>
    Field Name: SPF-DNS
    Description: Retrieved SPF record
    Multiple Appearances: No
    Related "Feedback-Type": auth-failure
			</pre>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> <a href="#security" id="security">Security Considerations</a>
</h1>
<p id="rfc.section.7.p.1">Security issues with respect to these reports are similar to those found in <a href="#DSN">[DSN]</a>. </p>
<h1 id="rfc.section.7.1">
<a href="#rfc.section.7.1">7.1.</a> <a href="#inherited" id="inherited">Inherited Considerations</a>
</h1>
<p id="rfc.section.7.1.p.1">Implementers are advised to consider the Security Considerations sections of <a href="#DKIM">[DKIM]</a>, <a href="#ADSP">[ADSP]</a> <a href="#SPF">[SPF]</a> and <a href="#ARF">[ARF]</a>. </p>
<h1 id="rfc.section.7.2">
<a href="#rfc.section.7.2">7.2.</a> <a href="#forgeries" id="forgeries">Forgeries</a>
</h1>
<p id="rfc.section.7.2.p.1">These reports may be forged as easily as ordinary Internet electronic mail.  User agents and automatic mail handling facilities (such as mail distribution list exploders) that wish to make automatic use of DSNs of any kind should take appropriate precautions to minimize the potential damage from denial-of-service attacks. </p>
<p id="rfc.section.7.2.p.2">Security threats related to forged DSNs include the sending of: </p>

<ol style="list-style-type: lower-alpha">
<li>A falsified authentication failure notification when the message was in fact delivered to the indicated recipient; </li>
<li>Falsified signature information, such as selector, domain, etc. </li>
</ol>

<p> </p>
<p id="rfc.section.7.2.p.3">Perhaps the simplest means of mitigating this threat is to assert that these reports should themselves be signed with something like DKIM.  On the other hand, if there's a problem with the DKIM infrastructure at the verifier, signing DKIM failure reports may produce reports that aren't trusted or even accepted by their intended recipients. </p>
<h1 id="rfc.section.7.3">
<a href="#rfc.section.7.3">7.3.</a> <a href="#autogen" id="autogen">Automatic Generation</a>
</h1>
<p id="rfc.section.7.3.p.1">Automatic generation of these reports by verifying agents can cause a denial-of-service attack when a large volume of e-mail is sent that causes sender authentication failures for whatever reason. </p>
<p id="rfc.section.7.3.p.2">Limiting the rate of generation of these messages may be appropriate but threatens to inhibit the distribution of important and possibly time-sensitive information. </p>
<p id="rfc.section.7.3.p.3">In general ARF feedback loop terms, it is suggested that report generators only create these (or any) ARF reports after an out-of-band arrangement has been made between two parties.  This mechanism then becomes a way to adjust parameters of an authorized abuse report feedback loop that is configured and activated by private agreement rather than starting to send them automatically based solely on discovered data in the DNS. </p>
<h1 id="rfc.section.7.4">
<a href="#rfc.section.7.4">7.4.</a> <a href="#empty-sender" id="empty-sender">Envelope Sender Selection</a>
</h1>
<p id="rfc.section.7.4.p.1">In the case of transmitted reports in the form of a new message, it is necessary to consider the construction and transmission of the message so as to avoid amplification attacks, deliberate or otherwise.  See Section 5 of <a href="#ARF">[ARF]</a> for further information.  </p>
<h1 id="rfc.section.7.5">
<a href="#rfc.section.7.5">7.5.</a> <a href="#multiple-incidents" id="multiple-incidents">Reporting Multiple Incidents</a>
</h1>
<p id="rfc.section.7.5.p.1">If it is known that a particular host generates abuse reports upon certain incidents, an attacker could forge a high volume of messages that will trigger such a report.  The recipient of the report could then be innundated with reports.  This could easily be extended to a distributed denial-of-service attack by finding a number of report-generating servers. </p>
<p id="rfc.section.7.5.p.2">The incident count referenced in <a href="#ARF">[ARF]</a> provides a limited form of mitigation.  The host generating reports may elect to send reports only periodically, with each report representing a number of identical or near-identical incidents.  One might even do something inverse-exponentially, sending reports for each of the first ten incidents, then every tenth incident up to 100, then every 100th incident up to 1000, etc.  until some period of relative quiet after which the limitation resets. </p>
<p id="rfc.section.7.5.p.3">The use of this for "near-identical" incidents in particular causes a degradation in reporting quality, however.  If for example a large number of pieces of spam arrive from one attacker, a reporting agent may decide only to send a report about a fraction of those messages.  While this averts a flood of reports to a system administrator, the precise details of each incident are similarly not sent. </p>
<h1 id="rfc.section.7.6">
<a href="#rfc.section.7.6">7.6.</a> <a href="#redaction_dkim_reports" id="redaction_dkim_reports">Redaction of Data in DKIM Reports</a>
</h1>
<p id="rfc.section.7.6.p.1">This memo requires that the canonicalized header and body be returned without being subject to redaction when a DKIM failure is being reported.  This is necessary to ensure that the returned canonicalized forms are useful for debugging as they must be compared to the equivalent form at the signer.  If a message is altered in transit, and the returned data are also redacted, the redacted portion and the altered portion may overlap, rendering the comparison results meaningless.  However, unredacted data can leak information the reporting entity considers to be private.  It is for this reason the return of the canonicalized forms is rendered optional.  </p>
<h1 id="rfc.references">
<a href="#rfc.references">8.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">8.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="ADSP">[ADSP]</b></td>
<td class="top">
<a title="Sendmail, Inc.  ">Allman, E.</a>, <a title="Yahoo! Inc.  ">Delany, M.</a>, <a title="Cisco Systems, Inc.  ">Fenton, J.</a> and <a title="Taughannock Networks ">J. Levine</a>, "<a href="http://tools.ietf.org/html/rfc5617">DKIM Sender Signing Practises </a>", RFC 5617, August 2009.</td>
</tr>
<tr>
<td class="reference"><b id="ARF">[ARF]</b></td>
<td class="top">
<a title="SolidMatrix Technologies, Inc.  ">Shafranovich, Y.</a>, <a title="Domain Assurance Council ">Levine, J.</a> and <a title="Cloudmark, Inc.  ">M. Kucherawy</a>, "<a href="http://tools.ietf.org/html/rfc5965">An Extensible Format for Email Feedback Reports </a>", RFC 5965, August 2010.</td>
</tr>
<tr>
<td class="reference"><b id="AUTH-RESULTS">[AUTH-RESULTS]</b></td>
<td class="top">
<a title="Sendmail, Inc.  ">Kucherawy, M.</a>, "<a href="http://tools.ietf.org/html/rfc5451">Message Header Field for Indicating Message Authentication Status </a>", RFC 5451, April 2009.</td>
</tr>
<tr>
<td class="reference"><b id="DKIM">[DKIM]</b></td>
<td class="top">
<a>Crocker, D.</a>, <a>Hansen, T.</a> and <a>M. Kucherawy</a>, "<a href="http://tools.ietf.org/html/rfc6376">DomainKeys Identified Mail (DKIM) Signatures </a>", RFC 6376, September 2011.</td>
</tr>
<tr>
<td class="reference"><b id="IANA-CONSIDERATIONS">[IANA-CONSIDERATIONS]</b></td>
<td class="top">
<a title="Google ">Alvestrand, H.</a> and <a title="IBM ">T. Narten</a>, "<a href="http://tools.ietf.org/html/rfc5226">Guidelines for Writing an IANA Considerations Section in RFCs </a>", RFC 5226, May 2008.</td>
</tr>
<tr>
<td class="reference"><b id="KEYWORDS">[KEYWORDS]</b></td>
<td class="top">
<a title="Harvard University ">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels </a>", RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="MAIL">[MAIL]</b></td>
<td class="top">
<a title="Qualcomm, Inc.  ">Resnick, P.</a>, "<a href="http://tools.ietf.org/html/rfc2822">Internet Message Format </a>", RFC 2822, April 2001.</td>
</tr>
<tr>
<td class="reference"><b id="MIME">[MIME]</b></td>
<td class="top">
<a>Freed, N.</a> and <a>N. Borenstein</a>, "<a href="http://tools.ietf.org/html/rfc2045">Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies </a>", RFC 2045, November 1996.</td>
</tr>
<tr>
<td class="reference"><b id="MIME-TYPES">[MIME-TYPES]</b></td>
<td class="top">
<a>Freed, N.</a> and <a>N. Borenstein</a>, "<a href="http://tools.ietf.org/html/rfc2046">Multipurpose Internet Mail Extensions (MIME) Part Two: Media Types </a>", RFC 2046, November 1996.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.IETF-MARF-REDACTION">[I-D.IETF-MARF-REDACTION]</b></td>
<td class="top">
<a title="Return Path ">Falk, JD</a>, "<a>Redaction of Potentially Sensitive Data from Mail Abuse Reports</a>", I-D draft-ietf-marf-redaction, March 2011.</td>
</tr>
<tr>
<td class="reference"><b id="REPORT">[REPORT]</b></td>
<td class="top">
<a title="Lucent Technologies ">Vaudreuil, G.</a>, "<a href="http://tools.ietf.org/html/rfc3462">The Multipart/Report Content Type for the Reporting of Mail System Administrative Messages </a>", RFC 3462, January 2003.</td>
</tr>
<tr>
<td class="reference"><b id="SMTP">[SMTP]</b></td>
<td class="top">
<a>Klensin, J.</a>, "<a href="http://tools.ietf.org/html/rfc5321">Simple Mail Transfer Protocol </a>", RFC 5321, October 2008.</td>
</tr>
<tr>
<td class="reference"><b id="SPF">[SPF]</b></td>
<td class="top">
<a>Wong, M.</a> and <a>W. Schlitt</a>, "<a href="http://tools.ietf.org/html/rfc4408">Sender Policy Framework (SPF) for Authorizing Use of Domains in E-Mail, Version 1 </a>", RFC 4408, April 2006.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">8.2.</a> Informative References</h1>
<table><tbody><tr>
<td class="reference"><b id="DSN">[DSN]</b></td>
<td class="top">
<a title="University of Tennessee ">Moore, K.</a> and <a title="Lucent Technologies ">G. Vaudreuil</a>, "<a href="http://tools.ietf.org/html/rfc3464">An Extensible Message Format for Delivery Status Notifications </a>", RFC 3464, January 2003.</td>
</tr></tbody></table>
<h1 id="rfc.appendix.Appendix A">
<a href="#rfc.appendix.Appendix%20A">Appendix A.</a> <a href="#thanks" id="thanks">Acknowledgements</a>
</h1>
<p id="rfc.section.Appendix A.p.1">The authors wish to acknowledge the following for their review and constructive criticism of this proposal: Frank Ellerman, J.D. Falk, Scott Kitterman, John Levine, Mike Markley, Kelly Wanser and Murray Kucherawy. </p>
<h1 id="rfc.appendix.Appendix B">
<a href="#rfc.appendix.Appendix%20B">Appendix B.</a> <a href="#examples" id="examples">Examples</a>
</h1>
<p id="rfc.section.Appendix B.p.1">This section contains examples of the use of each the extension defined by this memo. </p>
<h1 id="rfc.appendix.Appendix B.1">
<a href="#rfc.appendix.Appendix%20B.1">Appendix B.1.</a> <a href="#example-report" id="example-report">Example Use of ARF Extension Headers</a>
</h1>
<div id="#rfc.figure.13"></div>
<p>An ARF-formatted report using some of the proposed ARF extension fields: </p>
<pre>
Delivered-To: arf@example.com
Received: by 10.10.10.10 with SMTP id c6cs67945pbm;
        Sat, 8 Oct 2011 13:16:24 +0000 (GMT)
Return-Path: feedback@arf.mail.someisp.com
Received-SPF: pass (someisp.com: domain of feedback@arf.mail.someisp.com 
designates 192.0.2.1 as permitted sender) client-ip=xxx.xxx.xxx.xxx;
Authentication-Results: mx.someisp.com; spf=pass (someisp.com: domain of 
feedback@arf.mail.someisp.com designates 192.0.2.1 as permitted sender) 
smtp.mail=feedback@arf.mail.someisp.com
Message-ID: 433689.81121.example@mta.mail.someisp.com
From: "Someisp Mail Antispam Feedback" feedback@arf.mail.someisp.com
To: arf-failure@example.com
Subject: FW: You have a new bill from your bank
Date: 8 Oct 2011 13:16:24 +0000(GMT)
Content-Type: multipart/report;
  boundary="------------Boundary-00=_3BCR4Y7kX93yP9uUPRhg";
  report-type=feedback-report
Content-Transfer-Encoding: 7bit

--------------Boundary-00=_3BCR4Y7kX93yP9uUPRhg
Content-Type: text/plain; charset="us-ascii"
Content-Disposition: inline
Content-Transfer-Encoding: 7bit

This is an authentication failure report for an email message 
received from anexample.examplebank.com on 8 Oct 2011 13:16:24
+0000(GMT). For more information about this format please see 
http://datatracker.ietf.org/doc/draft-ietf-marf-authfailure-report

--------------Boundary-00=_3BCR4Y7kX93yP9uUPRhg
Content-Type: message/feedback-report
Content-Disposition: inline
Content-Transfer-Encoding: 7bit

Feedback-Type: auth-failure
User-Agent: Someisp!-Mail-Feedback/1.0
Version: 0.1
Original-Mail-From: anexample@anexample.examplebank.com
Arrival-Date: 8 Oct 2011 13:16:24 +0000(GMT)
Source-IP: 192.0.2.1
Reported-Domain: anexample.examplebank.com
Policy-Action: none
Reported-URI:http://www.exampleurl.com/

--------------Boundary-00=_3BCR4Y7kX93yP9uUPRhg
Content-Type: text/rfc822-headers
Content-Disposition: inline
Content-Transfer-Encoding: 7bit

Received-SPF: pass (domain of anexample.examplebank.com designates 
    192.0.2.1 as permitted sender)
Authentication-Results: mta1011.mail.tp2.someisp.com   
    from=anexample.examplebank.com; dkim=fail (bodyhash);spf=pass
DKIM-Signature: v=1; c=relaxed/simple; a=rsa-sha256;
    s=testkey; d=example.net; h=From:To:Subject:Date;
    bh=2jUSOH9NhtVGCQWNr9BrIAPreKQjO6Sn7XIkfJVOzv8=;
    b=AuUoFEfDxTDkHlLXSZEpZj79LICEps6eda7W3deTVFOk4yAUoqOB
    4nujc7YopdG5dWLSdNg6xNAZpOPr+kHxt1IrE+NahM6L/LbvaHut
    KVdkLLkpVaVVQPzeRDI009SO2Il5Lu7rDNH6mZckBdrIx0orEtZV
    4bmp/YzhwvcubU4=
Received: from smtp-out.example.net by mail.example.com
    with SMTP id o3F52gxO029144;
    Sat, 08 Oct 2011 13:15:31 -0700 (PDT)
Received: from internal-client-001.example.com
    by mail.example.com
    with SMTP id o3F3BwdY028431;
    Sat, 08 Oct 2011 13:12:09 -0700 (PDT)
Date: Sat, 8 Oct 2011 13:16:24 -0400 (EDT)
Reply-To: anexample.reply@anexample.examplebank.com
From: anexample@anexample.examplebank.com
Subject: You have a new bill 
Message-ID: 87913910.1318094604546
--------------Boundary-00=_3BCR4Y7kX93yP9uUPRhg--
				</pre>
<p>Example 3: Example ARF report using these extensions </p>
<p id="rfc.section.Appendix B.1.p.1">This example ARF message is making the following assertion: </p>

<ul>
<li>DKIM verification of the signature added within "example.com" failed </li>
<li>The cause for the verification failure was a mismatch between the body contents observed at the verifier and the body hash contained in the signature. </li>
</ul>

<p> </p>
<h1 id="rfc.authors"><a href="#rfc.authors">Author's Address</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Hilda L. Fontana</span> 
	  <span class="n hidden">
		<span class="family-name">Fontana</span>
	  </span>
	</span>
	<span class="org vcardline">eCert Inc.</span>
	<span class="adr">
	  <span>One Market Street Suite 3600</span>

	  <span class="vcardline">
		<span class="locality">San Francisco</span>,  
		<span class="region">CA</span> 
		<span class="code">94107</span>
	  </span>
	  <span class="country-name vcardline">US</span>
	</span>
	<span class="vcardline">Phone: +1 626 676 8852</span>

<span class="vcardline">EMail: <a href="mailto:hfontana@ecertsystems.com">hfontana@ecertsystems.com</a></span>

  </address>
</div>

</body>
</html>