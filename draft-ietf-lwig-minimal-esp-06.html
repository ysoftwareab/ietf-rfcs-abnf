<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Minimal ESP</title>
<meta content="Daniel Migault" name="author">
<meta content="Tobias Guggemos" name="author">
<meta content="
       This document describes a minimal implementation of the IP Encapsulation Security Payload (ESP) defined in RFC 4303. Its purpose is to enable implementation of ESP with a minimal set of options to remain compatible with ESP as described in RFC 4303. 
A minimal version of ESP is not intended to become a replacement of the RFC 4303 ESP. 
Instead, a minimal implementation is expected to be optimized for constrained environment while remaining interoperable with implementations of RFC 4303 ESP.
Some constraints include limiting the number of flash writes, handling frequent wakeup / sleep states, limiting wakeup time, or reducing the use of random generation.  
        This document does not update or modify RFC 4303, but provides a compact description of how to implement the minimal version of the protocol. 
RFC 4303 remains the authoritative description.   
    " name="description">
<meta content="xml2rfc 3.9.1" name="generator">
<meta content="draft-ietf-lwig-minimal-esp-06" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.9.1
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.5.1
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.6.3
    pycountry 20.7.3
    pyflakes 2.3.1
    PyYAML 5.4.1
    requests 2.26.0
    setuptools 57.4.0
    six 1.16.0
-->
<link href="/tmp/draft-ietf-lwig-minimal-esp-ubwga_h3.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Minimal ESP</td>
<td class="right">July 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Migault &amp; Guggemos</td>
<td class="center">Expires 27 January 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Light-Weight Implementation Guidance (lwig)</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-lwig-minimal-esp-06</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2021-07-26" class="published">26 July 2021</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-01-27">27 January 2022</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">D.M. Migault</div>
<div class="org">Ericsson</div>
</div>
<div class="author">
      <div class="author-name">T.G. Guggemos</div>
<div class="org">LMU Munich</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Minimal ESP</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document describes a minimal implementation of the IP Encapsulation Security Payload (ESP) defined in RFC 4303. Its purpose is to enable implementation of ESP with a minimal set of options to remain compatible with ESP as described in RFC 4303. 
A minimal version of ESP is not intended to become a replacement of the RFC 4303 ESP. 
Instead, a minimal implementation is expected to be optimized for constrained environment while remaining interoperable with implementations of RFC 4303 ESP.
Some constraints include limiting the number of flash writes, handling frequent wakeup / sleep states, limiting wakeup time, or reducing the use of random generation.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2"> This document does not update or modify RFC 4303, but provides a compact description of how to implement the minimal version of the protocol. 
RFC 4303 remains the authoritative description.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 27 January 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="ulBare toc ulEmpty compact">
<li class="ulBare toc ulEmpty compact" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
</li>
          <li class="ulBare toc ulEmpty compact" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="xref">2</a>.  <a href="#name-security-parameter-index-sp" class="xref">Security Parameter Index (SPI) (32 bit)</a></p>
<ul class="ulBare toc compact ulEmpty">
<li class="ulBare toc compact ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-considerations-over-spi-gen" class="xref">Considerations over SPI generation</a></p>
</li>
            </ul>
</li>
          <li class="ulBare toc ulEmpty compact" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-sequence-numbersn-32-bit" class="xref">Sequence Number(SN) (32 bit)</a></p>
</li>
          <li class="ulBare toc ulEmpty compact" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-padding" class="xref">Padding</a></p>
</li>
          <li class="ulBare toc ulEmpty compact" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-next-header-8-bit" class="xref">Next Header (8 bit)</a></p>
</li>
          <li class="ulBare toc ulEmpty compact" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-icv" class="xref">ICV</a></p>
</li>
          <li class="ulBare toc ulEmpty compact" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-cryptographic-suites" class="xref">Cryptographic Suites</a></p>
</li>
          <li class="ulBare toc ulEmpty compact" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
</li>
          <li class="ulBare toc ulEmpty compact" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
</li>
          <li class="ulBare toc ulEmpty compact" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-acknowledgment" class="xref">Acknowledgment</a></p>
</li>
          <li class="ulBare toc ulEmpty compact" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>. <a href="#name-references" class="xref">References</a></p>
<ul class="ulBare toc compact ulEmpty">
<li class="ulBare toc compact ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="xref">11.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
              <li class="ulBare toc compact ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="xref">11.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="ulBare toc ulEmpty compact" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-A" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">ESP <span>[<a href="#RFC4303" class="xref">RFC4303</a>]</span>  is part of the IPsec protocol suite <span>[<a href="#RFC4301" class="xref">RFC4301</a>]</span>. 
IPsec is used to provide confidentiality, data origin authentication, connectionless integrity, an anti-replay service (a form of partial sequence integrity) and limited traffic flow confidentiality (TFC) padding.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2"><a href="#fig-esp-description" class="xref">Figure 1</a> describes an ESP Packet.
Currently ESP is implemented in the kernel of major multipurpose Operating Systems (OS). 
The ESP and IPsec suite is usually implemented in a complete way to fit multiple purpose usage of these OS. 
However, completeness of the IPsec suite as well as multipurpose scope of these OS is often performed at the expense of resources, or performance. 
As a result, constrained devices are likely to have their own implementation of ESP optimized and adapted to their specificities such as limiting the number of flash writes (for each packet or across wake time), handling frequent wakeup and sleep state, limiting wakeup time, or reducing the use of random generation.
With the adoption of IPsec by IoT devices with minimal IKEv2 <span>[<a href="#RFC7815" class="xref">RFC7815</a>]</span> and ESP Header Compression (EHC) with <span>[<a href="#I-D.mglt-ipsecme-diet-esp" class="xref">I-D.mglt-ipsecme-diet-esp</a>]</span> or <span>[<a href="#I-D.mglt-ipsecme-ikev2-diet-esp-extension" class="xref">I-D.mglt-ipsecme-ikev2-diet-esp-extension</a>]</span>, it becomes crucial that ESP implementation designed for constrained devices remains inter-operable with the standard ESP implementation to avoid a fragmented usage of ESP. 
This document describes the minimal properties an ESP implementation needs to meet to remain interoperable with <span>[<a href="#RFC4303" class="xref">RFC4303</a>]</span> ESP. 
In addition, this document also provides a set of options to implement these properties under certain constrained environments.
This document does not update or modify RFC 4303, but provides a compact description of how to implement the minimal version of the protocol. 
RFC 4303 remains the authoritative description.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3"> For each field of the ESP packet represented in <a href="#fig-esp-description" class="xref">Figure 1</a> this document provides recommendations and guidance for minimal implementations. 
The primary purpose of Minimal ESP is to remain interoperable with other nodes implementing RFC 4303 ESP, while limiting the standard complexity of the implementation.<a href="#section-1-3" class="pilcrow">¶</a></p>
<span id="name-esp-packet-description"></span><div id="fig-esp-description">
<figure id="figure-1">
        <div class="artwork art-text alignLeft" id="section-1-4.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ----
|               Security Parameters Index (SPI)                 | ^Int.
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ |Cov-
|                      Sequence Number                          | |ered
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | ----
|                    Payload Data* (variable)                   | |   ^
~                                                               ~ |   |
|                                                               | |Conf.
+               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ |Cov-
|               |     Padding (0-255 bytes)                     | |ered*
+-+-+-+-+-+-+-+-+               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ |   |
|                               |  Pad Length   | Next Header   | v   v
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ------
|         Integrity Check Value-ICV   (variable)                |
~                                                               ~
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-esp-packet-description" class="selfRef">ESP Packet Description</a>
        </figcaption></figure>
</div>
</section>
<div id="sec-spi">
<section id="section-2">
      <h2 id="name-security-parameter-index-sp">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-security-parameter-index-sp" class="section-name selfRef">Security Parameter Index (SPI) (32 bit)</a>
      </h2>
<p id="section-2-1"> According to the <span>[<a href="#RFC4303" class="xref">RFC4303</a>]</span>, the SPI is a mandatory 32 bits field and is not allowed to be removed.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2"> The SPI has a local significance to index the Security Association (SA). 
From <span>[<a href="#RFC4301" class="xref">RFC4301</a>]</span> section 4.1, nodes supporting only unicast communications can index their SA only using the SPI. 
On the other hand, nodes supporting multicast communications must also use the IP addresses and thus SA lookup needs to be performed using the longest match.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3"> For nodes supporting only unicast communications, it is recommended to index SA with the SPI only. 
The index may be based on the full 32 bits of SPI or a subset of these bits. 
Some other local constraints on the node may require a combination of the SPI as well as other parameters to index the SA.<a href="#section-2-3" class="pilcrow">¶</a></p>
<p id="section-2-4"> Values 0-255 must not be used. 
As per section 2.1 of <span>[<a href="#RFC4303" class="xref">RFC4303</a>]</span>, values 1-255 are reserved and 0 is only allowed to be used internally and it must not be sent on the wire.<a href="#section-2-4" class="pilcrow">¶</a></p>
<p id="section-2-5"> <span>[<a href="#RFC4303" class="xref">RFC4303</a>]</span> does not require the SPI to be randomly generated over 32 bits.
However, this is the recommended way to generate SPIs as it provides some privacy benefits and avoids, for example, correlation between ESP communications. 
To randomly generate a 32 bit SPI, the node generates a random 32 bit valueand checks it does not fall in the 0-255 range. 
If the SPI has an acceptable value, it is used to index the inbound session, otherwise the SPI is re-generated until an acceptable value is found.<a href="#section-2-5" class="pilcrow">¶</a></p>
<p id="section-2-6">However, some constrained nodes may be less concerned by the privacy properties associated to SPIs randomly generated. 
Examples of such nodes might include sensors looking to reduce their code complexity, in which case the use of a predictive function to generate the SPI might be preferred over the generation and handling of random values. 
An example of such predictable function may consider the combination of a fixed value and the memory address of the SAD structure. 
For every incoming packet, the node will be able to point the SAD structure directly from the SPI value. 
This avoids having a separate and additional binding between SPI and SAD entries that is involved for every incoming packet.<a href="#section-2-6" class="pilcrow">¶</a></p>
<section id="section-2.1">
        <h3 id="name-considerations-over-spi-gen">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-considerations-over-spi-gen" class="section-name selfRef">Considerations over SPI generation</a>
        </h3>
<p id="section-2.1-1">SPI that are not randomly generated over 32 bits may lead to privacy and security concerns. 
As a result, the use of alternative designs requires careful security and privacy reviews. 
This section provides some considerations upon the adoption of alternative designs.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1-2">Note that SPI value is used only for inbound traffic, as such the SPI negotiated with IKEv2 <span>[<a href="#RFC7296" class="xref">RFC7296</a>]</span> or <span>[<a href="#RFC7815" class="xref">RFC7815</a>]</span> by a peer, is the value used by the remote peer when it sends traffic. 
As SPI is only used for inbound traffic by the peer, this allows each peer to manage the set of SPIs used for its inbound traffic. 
Similarly, the privacy concerns associated with the generation of nonrandom SPI is also limited to the incoming traffic.<a href="#section-2.1-2" class="pilcrow">¶</a></p>
<p id="section-2.1-3">When alternate designs are considered, it is likely that the number of possible SPIs will be limited. 
This limit should both consider the number of inbound SAs - possibly per IP addresses - as well as the ability for the node to rekey. 
SPI can typically be used to implement a key update with the SPI indicating the key is being used. 
For example, a SPI might be encoded with the Security Association Database (SAD) entry on a subset of bytes (for example 3 bytes), while the remaining byte indicates the rekey index.<a href="#section-2.1-3" class="pilcrow">¶</a></p>
<p id="section-2.1-4">The use of a smaller number of SPIs across communications comes with privacy and security concerns.
Typically some specific values or subset of SPI values may reveal the models or manufacturer of the node implementing ESP. 
This may raise some privacy issues as an observer is likely to be able to determine the constrained devices of the network. 
In some cases, these nodes may host a very limited number of applications - typically a single application - in which case the SPI would provide some information related to the application of the user. 
In addition, the device or application may be associated with some vulnerabilities, in which case specific SPI values may be used by an attacker to discover vulnerabilities.<a href="#section-2.1-4" class="pilcrow">¶</a></p>
<p id="section-2.1-5">
While the use of randomly generated SPIs may reduce the leakage or privacy of security related information by ESP itself, these information may also be leaked otherwise and a privacy analysis should consider at least the type of information as well the traffic pattern. 
Typically, temperature sensors, wind sensors, used outdoors do not leak privacy sensitive information and mosty of its traffic is expected to be outbound traffic. 
When used indoors, a sensor that reports every minute an encrypted status of the door (closed or opened) leaks truly little privacy sensitive information outside the local network.<a href="#section-2.1-5" class="pilcrow">¶</a></p>
</section>
</section>
</div>
<div id="sec-sn">
<section id="section-3">
      <h2 id="name-sequence-numbersn-32-bit">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-sequence-numbersn-32-bit" class="section-name selfRef">Sequence Number(SN) (32 bit)</a>
      </h2>
<p id="section-3-1"> According to  <span>[<a href="#RFC4303" class="xref">RFC4303</a>]</span>, the Sequence Number (SN) is a mandatory 32 bits field in the packet.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2"> The SN is set by the sender so the receiver can implement anti-replay protection. 
The SN is derived from any strictly increasing function that guarantees: if packet B is sent after packet A, then SN of packet B is strictly greater than the SN of packet A.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">Some constrained devices may establish communication with specific devices, like a specific gateway, or nodes similar to them. 
As a result, the sender may know whereas the receiver implements anti-replay protection or not. 
Even though the sender may know the receiver does not implement anti-replay protection, the sender must implement an always increasing function to generate the SN.<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">Usually, SN is generated by incrementing a counter for each packet sent. 
A constrained device may avoid maintaining this context and use another source that is known to always increase. 
Typically, constrained nodes using 802.15.4 Time Slotted Channel Hopping (TSCH), whose communication is heavily dependent on time, can take advantage of their clock to generate the SN. 
A lot of IoT devices are in a sleep state most of the time wake up and are only awake to perform a specific operation before going back to sleep. 
They do have separate hardware that allows them to wake up after a certain timeout, and most likely also timers that start running when the device was booted up, so they might have a concept of time with certain granularity. 
This requires to store any information in a stable storage - such as flash memory - that can be restored across sleeps.
Storing information associated with the SA such as SN requires some read and writing operation on a stable storage after each packet is sent as opposed to SPI or keys that are only written at the creation of the SA.
Such operations are likely to wear out the flash, and slow down the system greatly, as writing to flash is not as fast as reading.
Their internal clocks/timers might not be very accurate, but they should be enough to know that each time they wake up their time is greater than what it was last time they woke up.
Using time for SN would guarantee a strictly increasing function and avoid storing any additional values or context related to the SN. 
When the use of a clock is considered, one should take care that packets associated with a given SA are not sent with the same time value.
Note however that standard receivers are generally configured with incrementing counters and, if not appropriately configured, the use of a significantly larger SN may result in the packet out of the receiver's windows and that packet being discarded.<a href="#section-3-4" class="pilcrow">¶</a></p>
<p id="section-3-5">For inbound traffic, it is recommended that any receiver provides anti-replay protection, and the size of the window depends on the ability of the network to deliver packets out of order. 
As a result, in an environment where out of order packets is not possible the window size can be set to one. 
However, while recommended, there are no requirements to implement an anti-replay protection mechanism implemented by IPsec. 
Similarly to the SN the implementation of anti replay protection may require the device to write the received SN for every packet, which may in some cases come with the same drawbacks as those exposed for SN. 

As a result, some implementations may drop a non required anti replay protection especially when the necessary resource involved overcomes the benefit of the mechanism. 
These resources need also to balance that absence of anti-replay mechanism, may lead to unnecessary integrity check operations that might be significantly more expensive as well.  
A typical example might consider an IoT device such as a temperature sensor that is sending a temperature every 60 seconds, and that receives an acknowledgment from the receiver. 
In such cases, the ability to spoof and replay an acknowledgement is of limited interest and may not justify the implementation of an anti replay mechanism. 

Receiving peers may also implement their own anti-replay mechanism. 
Typically, when the sending peer is using SN based on time, anti-replay may be implemented by discarding any packets that present a SN whose value is too much in the past. 
Note that such mechanisms may consider clock drifting in various ways in addition to acceptable delay induced by the network to avoid the anti replay windows rejecting legitimate packets.
When a packet is received at a regular time interval, some variant of time based mechanisms may not even use the value of the SN, but instead only consider the receiving time of the packet.<a href="#section-3-5" class="pilcrow">¶</a></p>
<p id="section-3-6">SN can be encoded over 32 bits or 64 bits - known as Extended Sequence Number (ESN). 
As per <span>[<a href="#RFC4303" class="xref">RFC4303</a>]</span>, the support of ESN is not mandatory. 
The determination of the use of ESN is based on the largest possible value a SN can take over a session. 
When SN is incremented for each packet, the number of packets sent over the lifetime of a session may be considered. 
However, when the SN is incremented differently - such as when time is used - the maximum value SN needs to be considered instead.   
Note that the limit of messages being sent is primarily determined by the security associated with the key rather than the SN.
The security of all data protected under a given key decreases slightly with each message and a node must ensure the limit is not reached - even though the SN would permit it. 
Estimation of the maximum number of packets to be sent by a node is always challenging and as such should be considered cautiously as nodes could be online for much more time than expected. 
Even for constrained devices, it is recommended to implement some rekey mechanisms (see <a href="#sec-security-considerations" class="xref">Section 9</a>).<a href="#section-3-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-padding">
<section id="section-4">
      <h2 id="name-padding">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-padding" class="section-name selfRef">Padding</a>
      </h2>
<p id="section-4-1"> The purpose of padding is to respect the 32 bit alignment of ESP or block size expected by an encryption transform - such as AES-CBC for example.
ESP must have at least one padding byte Pad Length that indicates the padding length. 
ESP padding bytes are generated by a succession of unsigned bytes starting with 1, 2, 3 with the last byte set to Pad Length, where Pad Length designates the length of the padding bytes.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2"> Checking the padding structure is not mandatory, so the constrained device may not proceed to such checks, however, in order to interoperate with existing ESP implementations, it must build the padding bytes as recommended by ESP.<a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3"> In some situation the padding bytes may take a fixed value.
This would typically be the case when the Data Payload is of fix size.<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4">ESP <span>[<a href="#RFC4303" class="xref">RFC4303</a>]</span> also provides Traffic Flow Confidentiality (TFC) as a way to perform padding to hide traffic characteristics, which differs from respecting a 32 bit alignment. 
TFC is not mandatory and must be negotiated with the SA management protocol.
TFC has not yet being widely adopted for standard ESP traffic. 
One possible reason is that it requires to shape the traffic according to one traffic pattern that needs to be maintained. 
This is likely to require extra processing as well as providing a "well recognized" traffic shape which could end up being counterproductive. 
As such, it is NOT recommended that minimal ESP implementation supports TFC.<a href="#section-4-4" class="pilcrow">¶</a></p>
<p id="section-4-5">As a result, TFC cannot be enabled with minimal ESP, and communication protection that were relying on TFC will be more sensitive to traffic shaping. 
This could expose the application as well as the devices used to a passive monitoring attacker. 
Such information could be used by the attacker in case a vulnerability is disclosed on the specific device. 
In addition, some application use - such as health applications - may also reveal important privacy oriented information.<a href="#section-4-5" class="pilcrow">¶</a></p>
<p id="section-4-6">Some constrained nodes that have limited battery lifetime may also prefer avoiding sending extra padding bytes. 
However, the same nodes may also be very specific to an application and device. 
As a result, they are also likely to be the main target for traffic shaping. 
In most cases, the payload carried by these nodes is quite small, and the standard padding mechanism may also be used as an alternative to TFC, with a sufficient tradeoff between the require energy to send additional payload and the exposure to traffic shaping attacks. 
In addition, the information leaked by the traffic shaping may also be addressed by the application level. 
For example, it is preferred to have a sensor sending some information at regular time interval, rather than when a specific event is happening. 
Typically, a sensor monitoring the temperature, or a door is expected to send regularly the information - i.e. the temperature of the room or whether the door is closed or open) instead of only sending the information when the temperature has raised or when the door is being opened.<a href="#section-4-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-nh">
<section id="section-5">
      <h2 id="name-next-header-8-bit">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-next-header-8-bit" class="section-name selfRef">Next Header (8 bit)</a>
      </h2>
<p id="section-5-1">According to <span>[<a href="#RFC4303" class="xref">RFC4303</a>]</span>, the Next Header is a mandatory 8 bits field in the packet. 
Next header specifies the data contained in the payload as well as dummy packet, i.e. packets with the Next Header with a value 59 meaning "no next header". 
In addition, the Next Header may also carry an indication on how to process the packet <span>[<a href="#I-D.nikander-esp-beet-mode" class="xref">I-D.nikander-esp-beet-mode</a>]</span>.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2"> The ability to generate and receive dummy packets is required by <span>[<a href="#RFC4303" class="xref">RFC4303</a>]</span>. 
For interoperability, a minimal ESP implementation must discard dummy packets without indicating an error.
Note that such recommendation only applies for nodes receiving packets, and that nodes designed to only send data may not implement this capability.<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3"> As the generation of dummy packets is subject to local management and based on a per-SA basis, a minimal ESP implementation may not generate such dummy packet.
More especially, in constrained environment sending dummy packets may have too much impact on the device lifetime, and so may be avoided. 
On the other hand, constrained nodes may be dedicated to specific applications, in which case, traffic pattern may expose the application or the type of node. 
For these nodes, not sending dummy packet may have some privacy implication that needs to be measured. 
However, for the same reasons exposed in <a href="#sec-padding" class="xref">Section 4</a> traffic shaping at the IPsec layer may also introduce some traffic pattern, and on constrained devices the application is probably the most appropriated layer to limit the risk of leaking information by traffic shaping.<a href="#section-5-3" class="pilcrow">¶</a></p>
<p id="section-5-4"> In some cases, devices are dedicated to a single application or a single transport protocol, in which case, the Next Header has a fixed value.<a href="#section-5-4" class="pilcrow">¶</a></p>
<p id="section-5-5">Specific processing indications have not been standardized yet <span>[<a href="#I-D.nikander-esp-beet-mode" class="xref">I-D.nikander-esp-beet-mode</a>]</span> and is expected to result from an agreement between the peers.
As a result, it should not be part of a minimal implementation of ESP.<a href="#section-5-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-icv">
<section id="section-6">
      <h2 id="name-icv">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-icv" class="section-name selfRef">ICV</a>
      </h2>
<p id="section-6-1">The ICV depends on the cryptographic suite used.
Currently <span>[<a href="#RFC8221" class="xref">RFC8221</a>]</span> only recommends cryptographic suites with an ICV which makes the ICV a mandatory field.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2"> As detailed in <span>[<a href="#RFC8221" class="xref">RFC8221</a>]</span> authentication or authenticated encryption are recommended and as such the ICV field must be present with a size different from zero. 
It length is defined by the security recommendations only.<a href="#section-6-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-encr">
<section id="section-7">
      <h2 id="name-cryptographic-suites">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-cryptographic-suites" class="section-name selfRef">Cryptographic Suites</a>
      </h2>
<p id="section-7-1"> The cryptographic suites implemented are an important component of ESP. 
The recommended algorithms to use are expected to evolve over time and implementers should follow the recommendations provided by <span>[<a href="#RFC8221" class="xref">RFC8221</a>]</span> and updates.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2"> This section lists some of the criteria that may be considered. 
The list is not expected to be exhaustive and may also evolve overtime. 
As a result, the list is provided as informational:<a href="#section-7-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-7-3">
<li id="section-7-3.1"> Security: Security is the criteria that should be considered first for the selection of encryption algorithm transform. 
The security of encryption algorithm transforms is expected to evolve over time, and it is of primary importance to follow up-to-date security guidance and recommendations.  
The chosen encryption algorithm must not be known vulnerable or weak (see <span>[<a href="#RFC8221" class="xref">RFC8221</a>]</span> for outdated ciphers). 
ESP can be used to authenticate only or to encrypt the communication. 
In the latter case, authenticated encryption must always be considered <span>[<a href="#RFC8221" class="xref">RFC8221</a>]</span>.<a href="#section-7-3.1" class="pilcrow">¶</a>
</li>
        <li id="section-7-3.2">Resilience to nonce re-use: Some transforms -including AES-GCM - are very sensitive to nonce collision with a given key. 
While the generation of the nonce may prevent such collision during a session, the mechanisms are unlikely to provide such protection across reboot. 
This causes an issue for devices that are configured with a key. 
When the key is likely to be re-used across reboots, it is recommended to consider algorithms that are nonce misuse resistant such as, for example, AES-SIV <span>[<a href="#RFC5297" class="xref">RFC5297</a>]</span>, AES-GCM-SIV <span>[<a href="#RFC8452" class="xref">RFC8452</a>]</span> or Deoxys-II <span>[<a href="#DeoxysII" class="xref">DeoxysII</a>]</span>. 
Note however that currently none of them has yet been defined for ESP.<a href="#section-7-3.2" class="pilcrow">¶</a>
</li>
        <li id="section-7-3.3"> Interoperability:  Interoperability considers the encryption algorithm transforms shared with the other nodes. 
Note that it is not because an encryption algorithm transform is widely deployed that it is secured. 
As a result, security should not be weakened for interoperability. 
<span>[<a href="#RFC8221" class="xref">RFC8221</a>]</span> and successors consider the life cycle of encryption algorithm transforms sufficiently long to provide interoperability.  
Constrained devices may have limited interoperability requirements which makes possible to reduces the number of encryption algorithm transforms to implement.<a href="#section-7-3.3" class="pilcrow">¶</a>
</li>
        <li id="section-7-3.4"> Power Consumption and Cipher Suite Complexity: Complexity of the encryption algorithm transform or the energy associated with it are especially considered when devices have limited resources or are using some batteries, in which case the battery determines the life of the
device. 
The choice of a cryptographic function may consider re-using specific libraries or to take advantage of hardware acceleration provided by the device. 
For example, if the device benefits from AES hardware modules and uses AES-CTR, it may prefer AUTH_AES-XCBC for its authentication. 
In addition, some devices may also embed radio modules with hardware acceleration for AES-CCM, in which case, this mode may be preferred.<a href="#section-7-3.4" class="pilcrow">¶</a>
</li>
        <li id="section-7-3.5">
          <p id="section-7-3.5.1"> Power Consumption and Bandwidth Consumption: Similarly to the encryption algorithm transform complexity, reducing the payload sent, may significantly reduce the energy consumption of the device. 
As a result, encryption algorithm transforms with low overhead may be considered. 
To reduce the overall payload size one may, for example:<a href="#section-7-3.5.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-7-3.5.2">
<li id="section-7-3.5.2.1"> Use of counter-based ciphers without fixed block length (e.g. AES-CTR, or ChaCha20-Poly1305).<a href="#section-7-3.5.2.1" class="pilcrow">¶</a>
</li>
            <li id="section-7-3.5.2.2">Use of ciphers with capability of using implicit IVs <span>[<a href="#RFC8750" class="xref">RFC8750</a>]</span>.<a href="#section-7-3.5.2.2" class="pilcrow">¶</a>
</li>
            <li id="section-7-3.5.2.3">Use of ciphers recommended for IoT <span>[<a href="#RFC8221" class="xref">RFC8221</a>]</span>.<a href="#section-7-3.5.2.3" class="pilcrow">¶</a>
</li>
            <li id="section-7-3.5.2.4"> Avoid Padding by sending payload data which are aligned to the cipher block length - 2 for the ESP trailer.<a href="#section-7-3.5.2.4" class="pilcrow">¶</a>
</li>
          </ol>
</li>
      </ol>
</section>
</div>
<section id="section-8">
      <h2 id="name-iana-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-8-1">There are no IANA consideration for this document.<a href="#section-8-1" class="pilcrow">¶</a></p>
</section>
<div id="sec-security-considerations">
<section id="section-9">
      <h2 id="name-security-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-9-1"> Security considerations are those of <span>[<a href="#RFC4303" class="xref">RFC4303</a>]</span>. 
In addition, this document provided security recommendations and guidance over the implementation choices for each field.<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">The security of a communication provided by ESP is closely related to the security associated with the management of that key. 
This usually includes mechanisms to prevent a nonce from repeating, for example.
When a node is provisioned with a session key that is used across reboot, the implementer must ensure that the mechanisms put in place remain valid across reboot as well.<a href="#section-9-2" class="pilcrow">¶</a></p>
<p id="section-9-3">It is recommended to use ESP in conjunction with key management protocols such as for example IKEv2 <span>[<a href="#RFC7296" class="xref">RFC7296</a>]</span> or minimal IKEv2 <span>[<a href="#RFC7815" class="xref">RFC7815</a>]</span>.
Such mechanisms are responsible for negotiating fresh session keys as well as prevent a session key being use beyond its lifetime.

When such mechanisms cannot be implemented and the session key is, for example, provisioned, the nodes must ensure that keys are not used beyond their lifetime and that the appropriate use of the key remains across reboots - e.g. conditions on counters and nonces remains valid.<a href="#section-9-3" class="pilcrow">¶</a></p>
<p id="section-9-4">When a node generates its key or when random value such as nonces are generated, the random generation must follow <span>[<a href="#RFC4086" class="xref">RFC4086</a>]</span>. In addition <span>[<a href="#SP-800-90A-Rev-1" class="xref">SP-800-90A-Rev-1</a>]</span> provides appropriated guidance to build random generators based on deterministic random functions.<a href="#section-9-4" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-10">
      <h2 id="name-acknowledgment">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-acknowledgment" class="section-name selfRef">Acknowledgment</a>
      </h2>
<p id="section-10-1"> The authors would like to thank Daniel Palomares, Scott Fluhrer, Tero Kivinen, Valery Smyslov, Yoav Nir, Michael Richardson, Thomas Peyrin and Eric Thormarker for their valuable comments.  
In particular Scott Fluhrer suggested to include the rekey index in the SPI.
Tero Kivinen provided also multiple clarifications and examples of deployment ESP within constrained devices with their associated optimizations. 
Thomas Peyrin Eric Thormarker and Scott Fluhrer suggested and clarified the use of transform resilient to nonce misuse.<a href="#section-10-1" class="pilcrow">¶</a></p>
</section>
<section id="section-11">
      <h2 id="name-references">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-11.1">
        <h3 id="name-normative-references">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4086">[RFC4086]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span>, <span class="refAuthor">Schiller, J.</span>, and <span class="refAuthor">S. Crocker</span>, <span class="refTitle">"Randomness Requirements for Security"</span>, <span class="seriesInfo">BCP 106</span>, <span class="seriesInfo">RFC 4086</span>, <span class="seriesInfo">DOI 10.17487/RFC4086</span>, <time datetime="2005-06" class="refDate">June 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4086">https://www.rfc-editor.org/info/rfc4086</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4301">[RFC4301]</dt>
        <dd>
<span class="refAuthor">Kent, S.</span> and <span class="refAuthor">K. Seo</span>, <span class="refTitle">"Security Architecture for the Internet Protocol"</span>, <span class="seriesInfo">RFC 4301</span>, <span class="seriesInfo">DOI 10.17487/RFC4301</span>, <time datetime="2005-12" class="refDate">December 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4301">https://www.rfc-editor.org/info/rfc4301</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4303">[RFC4303]</dt>
        <dd>
<span class="refAuthor">Kent, S.</span>, <span class="refTitle">"IP Encapsulating Security Payload (ESP)"</span>, <span class="seriesInfo">RFC 4303</span>, <span class="seriesInfo">DOI 10.17487/RFC4303</span>, <time datetime="2005-12" class="refDate">December 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4303">https://www.rfc-editor.org/info/rfc4303</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7296">[RFC7296]</dt>
        <dd>
<span class="refAuthor">Kaufman, C.</span>, <span class="refAuthor">Hoffman, P.</span>, <span class="refAuthor">Nir, Y.</span>, <span class="refAuthor">Eronen, P.</span>, and <span class="refAuthor">T. Kivinen</span>, <span class="refTitle">"Internet Key Exchange Protocol Version 2 (IKEv2)"</span>, <span class="seriesInfo">STD 79</span>, <span class="seriesInfo">RFC 7296</span>, <span class="seriesInfo">DOI 10.17487/RFC7296</span>, <time datetime="2014-10" class="refDate">October 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7296">https://www.rfc-editor.org/info/rfc7296</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7815">[RFC7815]</dt>
        <dd>
<span class="refAuthor">Kivinen, T.</span>, <span class="refTitle">"Minimal Internet Key Exchange Version 2 (IKEv2) Initiator Implementation"</span>, <span class="seriesInfo">RFC 7815</span>, <span class="seriesInfo">DOI 10.17487/RFC7815</span>, <time datetime="2016-03" class="refDate">March 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7815">https://www.rfc-editor.org/info/rfc7815</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8221">[RFC8221]</dt>
        <dd>
<span class="refAuthor">Wouters, P.</span>, <span class="refAuthor">Migault, D.</span>, <span class="refAuthor">Mattsson, J.</span>, <span class="refAuthor">Nir, Y.</span>, and <span class="refAuthor">T. Kivinen</span>, <span class="refTitle">"Cryptographic Algorithm Implementation Requirements and Usage Guidance for Encapsulating Security Payload (ESP) and Authentication Header (AH)"</span>, <span class="seriesInfo">RFC 8221</span>, <span class="seriesInfo">DOI 10.17487/RFC8221</span>, <time datetime="2017-10" class="refDate">October 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8221">https://www.rfc-editor.org/info/rfc8221</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8750">[RFC8750]</dt>
      <dd>
<span class="refAuthor">Migault, D.</span>, <span class="refAuthor">Guggemos, T.</span>, and <span class="refAuthor">Y. Nir</span>, <span class="refTitle">"Implicit Initialization Vector (IV) for Counter-Based Ciphers in Encapsulating Security Payload (ESP)"</span>, <span class="seriesInfo">RFC 8750</span>, <span class="seriesInfo">DOI 10.17487/RFC8750</span>, <time datetime="2020-03" class="refDate">March 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8750">https://www.rfc-editor.org/info/rfc8750</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-11.2">
        <h3 id="name-informative-references">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="DeoxysII">[DeoxysII]</dt>
        <dd>
<span class="refAuthor">Jeremy, J. J.</span>, <span class="refAuthor">Ivica, I. N.</span>, <span class="refAuthor">Thomas, T. P.</span>, and <span class="refAuthor">Y. S. Yannick</span>, <span class="refTitle">"Deoxys v1.41"</span>, <time datetime="2016-10" class="refDate">October 2016</time>, <span>&lt;<a href="https://competitions.cr.yp.to/round3/deoxysv141.pdf">https://competitions.cr.yp.to/round3/deoxysv141.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.mglt-ipsecme-diet-esp">[I-D.mglt-ipsecme-diet-esp]</dt>
        <dd>
<span class="refAuthor">Migault, D.</span>, <span class="refAuthor">Guggemos, T.</span>, <span class="refAuthor">Bormann, C.</span>, and <span class="refAuthor">D. Schinazi</span>, <span class="refTitle">"ESP Header Compression and Diet-ESP"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-mglt-ipsecme-diet-esp-07</span>, <time datetime="2019-03-11" class="refDate">11 March 2019</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-mglt-ipsecme-diet-esp-07.txt">https://www.ietf.org/archive/id/draft-mglt-ipsecme-diet-esp-07.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.mglt-ipsecme-ikev2-diet-esp-extension">[I-D.mglt-ipsecme-ikev2-diet-esp-extension]</dt>
        <dd>
<span class="refAuthor">Migault, D.</span>, <span class="refAuthor">Guggemos, T.</span>, and <span class="refAuthor">D. Schinazi</span>, <span class="refTitle">"Internet Key Exchange version 2 (IKEv2) extension for the ESP Header Compression (EHC) Strategy"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-mglt-ipsecme-ikev2-diet-esp-extension-01</span>, <time datetime="2018-06-26" class="refDate">26 June 2018</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-mglt-ipsecme-ikev2-diet-esp-extension-01.txt">https://www.ietf.org/archive/id/draft-mglt-ipsecme-ikev2-diet-esp-extension-01.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.nikander-esp-beet-mode">[I-D.nikander-esp-beet-mode]</dt>
        <dd>
<span class="refAuthor">Nikander, P.</span> and <span class="refAuthor">J. Melen</span>, <span class="refTitle">"A Bound End-to-End Tunnel (BEET) mode for ESP"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-nikander-esp-beet-mode-09</span>, <time datetime="2008-08-05" class="refDate">5 August 2008</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-nikander-esp-beet-mode-09.txt">https://www.ietf.org/archive/id/draft-nikander-esp-beet-mode-09.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5297">[RFC5297]</dt>
        <dd>
<span class="refAuthor">Harkins, D.</span>, <span class="refTitle">"Synthetic Initialization Vector (SIV) Authenticated Encryption Using the Advanced Encryption Standard (AES)"</span>, <span class="seriesInfo">RFC 5297</span>, <span class="seriesInfo">DOI 10.17487/RFC5297</span>, <time datetime="2008-10" class="refDate">October 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5297">https://www.rfc-editor.org/info/rfc5297</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8452">[RFC8452]</dt>
        <dd>
<span class="refAuthor">Gueron, S.</span>, <span class="refAuthor">Langley, A.</span>, and <span class="refAuthor">Y. Lindell</span>, <span class="refTitle">"AES-GCM-SIV: Nonce Misuse-Resistant Authenticated Encryption"</span>, <span class="seriesInfo">RFC 8452</span>, <span class="seriesInfo">DOI 10.17487/RFC8452</span>, <time datetime="2019-04" class="refDate">April 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8452">https://www.rfc-editor.org/info/rfc8452</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SP-800-90A-Rev-1">[SP-800-90A-Rev-1]</dt>
      <dd>
<span class="refAuthor">Elain, E. B.</span> and <span class="refAuthor">J. K. Kelsey</span>, <span class="refTitle">"Recommendation for Random Number Generation Using Deterministic Random Bit Generators"</span>, <span>&lt;<a href="https://csrc.nist.gov/publications/detail/sp/800-90a/rev-1/final">https://csrc.nist.gov/publications/detail/sp/800-90a/rev-1/final</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="authors-addresses">
<section id="appendix-A">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Daniel Migault</span></div>
<div dir="auto" class="left"><span class="org">Ericsson</span></div>
<div dir="auto" class="left"><span class="street-address">8400 boulevard Decarie</span></div>
<div dir="auto" class="left">
<span class="locality">Montreal, QC H4P 2N2</span>  </div>
<div dir="auto" class="left"><span class="country-name">Canada</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:daniel.migault@ericsson.com" class="email">daniel.migault@ericsson.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Tobias Guggemos</span></div>
<div dir="auto" class="left"><span class="org">LMU Munich</span></div>
<div dir="auto" class="left"><span class="street-address">MNM-Team<br>Oettingenstr. 67</span></div>
<div dir="auto" class="left"><span class="locality">80538 Munich</span></div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:guggemos@mnm-team.org" class="email">guggemos@mnm-team.org</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
