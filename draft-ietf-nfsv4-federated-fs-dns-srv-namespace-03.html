<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Using DNS SRV to Specify a Global File Name Space with NFS version 4</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Using DNS SRV to Specify a Global File Name Space with NFS version 4">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">C. Everhart</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">W. Adamson</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">NetApp</td></tr>
<tr><td class="header">Expires: October 1, 2010</td><td class="header">J. Zhang</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Google</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">March 30, 2010</td></tr>
</table></td></tr></table>
<h1><br />Using DNS SRV to Specify a Global File Name Space with NFS version 4<br />draft-ietf-nfsv4-federated-fs-dns-srv-namespace-03.txt</h1>

<h3>Abstract</h3>

<p>
The NFS version 4 protocol provides a natural way for a collection of NFS file servers to collaborate
in providing an organization-wide file name space.  The DNS SRV RR allows a simple and appropriate 
way for an organization to publish the root of its name space, even to clients that might not be
intimately associated with such an organization.  The DNS SRV RR can be used to join these
organization-wide file name spaces together to allow construction of a global, uniform NFS version 4
file name space.

</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on October 1, 2010.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the BSD License.</p>
<p>
This document may contain material from IETF Documents or IETF
Contributions published or made publicly available before November
10, 2008.  The person(s) controlling the copyright in some of this
material may not have granted the IETF Trust the right to allow
modifications of such material outside the IETF Standards Process.
Without obtaining an adequate license from the person(s) controlling
the copyright in such materials, this document may not be modified
outside the IETF Standards Process, and derivative works of it may
not be created outside the IETF Standards Process, except to format
it for publication as an RFC or to translate it into languages other
than English.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Requirements notation<br />
<a href="#anchor2">2.</a>&nbsp;
Background<br />
<a href="#anchor3">3.</a>&nbsp;
Proposed Use of SRV Resource Record in DNS<br />
<a href="#anchor4">4.</a>&nbsp;
Integration with Use of NFS Version 4<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">4.1.</a>&nbsp;
Globally-useful names: conventional mount point<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">4.2.</a>&nbsp;
Mount options<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">4.3.</a>&nbsp;
Filesystem integration issues<br />
<a href="#anchor8">5.</a>&nbsp;
Where is this integration carried out?<br />
<a href="#anchor9">6.</a>&nbsp;
Relationship to DNS NFS4ID RR<br />
<a href="#anchor10">7.</a>&nbsp;
Security Considerations<br />
<a href="#anchor11">8.</a>&nbsp;
IANA Considerations<br />
<a href="#rfc.references1">9.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">9.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">9.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Requirements notation</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL",
            "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY",
            and "OPTIONAL" in this document are to be interpreted as
            described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Background</h3>

<p>
With the advent of fs_locations attributes in the NFS Version 4 protocol <a class='info' href='#RFC3530'>[RFC3530]<span> (</span><span class='info'>Shepler, S., Callaghan, B., Robinson, D., Thurlow, R., Beame, C., Eisler, M., and D. Noveck, &ldquo;Network File System (NFS) version 4 Protocol,&rdquo; April&nbsp;2003.</span><span>)</span></a>, NFS servers can
cooperate to build a file name space that crosses server boundaries, as detailed in the description
of referrals in <a class='info' href='#NB0510'>[NB0510]<span> (</span><span class='info'>Noveck, D. and R. Burnett, &ldquo;Next Steps for NFSv4 Migration/Replication,&rdquo; October&nbsp;2005.</span><span>)</span></a>.
With NFS Version 4 referrals, a file server may indicate to its client that the file name tree beneath
a given name in the server is not present on itself, but is represented by a filesystem in some other
set of servers.  The mechanism
is general, allowing servers to describe any filesystem as being reachable by requests to any of a
set of servers.
Thus, starting with a single NFS Version 4 server, using these referrals, an NFS Version 4 client
might be able to see a large name space associated with a collection of interrelated NFS Version 4 file servers.  An organization could use this
capability to construct a uniform file name space for itself.

</p>
<p>
An organization might wish to publish the starting point for this name space to its clients.  In many
cases, the organization will want to publish this starting point to a broader set of possible clients.
At the same time, it is useful to require clients to know only the smallest amount
of information in order to locate the appropriate name space.
Simultaneously, that required
information should be constant through the life of an organization if the clients are not to require
reconfiguration as administrative events change, for instance, a server's name or address.
		
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Proposed Use of SRV Resource Record in DNS</h3>

<p>
Providing an organization's published filesystem name space is a service, and it is appropriate
to use the DNS <a class='info' href='#RFC1034'>[RFC1034]<span> (</span><span class='info'>Mockapetris, P., &ldquo;Domain Names - Concepts and Facilities,&rdquo; November&nbsp;1987.</span><span>)</span></a><a class='info' href='#RFC1035'>[RFC1035]<span> (</span><span class='info'>Mockapetris, P., &ldquo;Domain Names - Implementation and Specification,&rdquo; November&nbsp;1987.</span><span>)</span></a> to locate it.  
As with the AFSDB resource record type <a class='info' href='#RFC1183'>[RFC1183]<span> (</span><span class='info'>Everhart, C., Mamakos, L., Ullmann, R., and P. Mockapetris, &ldquo;New DNS RR Definitions,&rdquo; October&nbsp;1990.</span><span>)</span></a>, the client need only utter the
(relatively) constant domain name for an organization in order to locate its filesystem name space service.
Once a client uses the DNS to locate one or more servers for the root of the organization's name space,
it can use the standard NFS Version 4 mechanisms to navigate the remainder of the NFS servers for that
organization.  The use of this proposed mechanism results in a useful cross-organizational name space,
just as in AFS <a class='info' href='#AFS'>[AFS]<span> (</span><span class='info'>Howard, J., &ldquo;An Overview of the Andrew File System&quot;,&rdquo; February&nbsp;1988.</span><span>)</span></a> and DCE/DFS <a class='info' href='#DFS'>[DFS]<span> (</span><span class='info'>Kazar, M., Leverett, B., Anderson, O., Apostolides, V., Bottos, B., Chutani, S., Everhart, C., Mason, W., Tu, S., and E. Zayas, &ldquo;DEcorum File System Architectural Overview,&rdquo; June&nbsp;1990.</span><span>)</span></a> before it.  A client need
know only the name of the organization
in order to locate the filesystem name space published by that organization.

</p>
<p>

<p>
We propose the use of the DNS SRV resource record type [RFC2782] to fulfill this function.  The
format of the DNS SRV record is as follows:

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   _Service._Proto.Name TTL Class SRV Priority Weight Port Target
</pre></div>
<p>
In our case, we use a Service name of "_nfs4._domainroot" and a conventional Protocol of "_tcp".
(In accordance with RFC 2782 <a class='info' href='#RFC2782'>[RFC2782]<span> (</span><span class='info'>Gulbrandsen, A., Vixie, P., and L. Esibov, &ldquo;A DNS RR for specifying the location of services (DNS SRV),&rdquo; February&nbsp;2000.</span><span>)</span></a>, we use "_" prefix characters on the Service and Protocol
names, but we recognize that there is work in progress <a class='info' href='#Gudmundsson'>[Gudmundsson]<span> (</span><span class='info'>Gudmundsson, O. and A. Hoenes, &ldquo;Creation of a Registry for DNS SRV Record Service Prefixes,&rdquo; October&nbsp;2009.</span><span>)</span></a>
to create a registry of these names and to no longer
use the "_" prefix for some names.)
The Target fields
give the domain names of the NFS Version 4 servers that export filesystems for the domain's root.  An NFS Version 4 client
SHOULD interpret any of the exported root filesystems as the filesystem published by the organization
with the given domain name.

</p>


<p>
In order to allow the NFSv4 servers so given to export a variety of filesystems, those file servers
SHOULD export the given domain's root filesystems at "/.domainroot-{Name}" within
their pseudo-filesystems, where the "{Name}" is the name of the organization as used in the SRV RR.

</p>
<p>

<p>
As an example, suppose a client wished to locate the root of the filesystem published by organization example.net.  The
DNS servers for the domain could publish records like

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   $ORIGIN example.net.
   _nfs4._domainroot._tcp IN SRV 0 0 2049 nfs1tr.example.net.
   _nfs4._domainroot._tcp IN SRV 1 0 2049 nfs2ex.example.net.
</pre></div>
<p>
The result domain names nfs1tr.example.net and nfs2ex.example.net indicate NFS Version 4 file servers that
export the root of the published name space for the example.net domain.  In accordance with RFC 2782 <a class='info' href='#RFC2782'>[RFC2782]<span> (</span><span class='info'>Gulbrandsen, A., Vixie, P., and L. Esibov, &ldquo;A DNS RR for specifying the location of services (DNS SRV),&rdquo; February&nbsp;2000.</span><span>)</span></a>,
these records are to be interpreted using the Priority and Weight field values, selecting an appropriate
file server with which to begin a network conversation.  The two file servers would export filesystems
that would be found at "/.domainroot-example.net" in their pseudo-filesystems, which clients would mount.
Clients then carry out subsequent accesses in accordance with the ordinary NFS Version 4 protocol.

</p>


<p>
We use a composite Service name (built from "_nfs4" and "_domainroot") so that other filesystem
protocols could make use of the same "_domainroot" abstraction.

</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Integration with Use of NFS Version 4</h3>

<p>
We expect that NFSv4 clients will implement a special directory, analogous to an Automounter <a class='info' href='#AMD'>[AMD]<span> (</span><span class='info'>Pendry, J. and N. Williams, &ldquo;Amd: The 4.4 BSD Automounter Reference Manual,&rdquo; March&nbsp;1991.</span><span>)</span></a>
directory, the entries in which are domain names that have recently been traversed.  When an application attempts to
traverse a new name in that special directory, the NFSv4 client consults DNS to obtain the SRV data for the given name,
and if successful, it mounts the indicated filesystem(s) in that name in the special directory.
The goal is that NFSv4 applications will be able to lookup an organization's domain name in the special directory,
and the NFSv4 client will be able to discover the filesystem that that organization publishes.
Entries in the special directory will be domain names, and they will each appear to the application as a directory name
pointing to the root directory of the filesystem published by the organization responsible for that domain name.

</p>
<p>
This functionality does not require or use any list of organizations that are known to provide file service,
as AFS did with its "root.afs" functionality.

</p>
<p>
This DNS SRV record evaluation could, in principle, be done either in the NFSv4 client or in an NFSv4 server.  In either
case, the result would appear the same to applications on the NFSv4 client.

</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Globally-useful names: conventional mount point</h3>

<p>

<p>
For the inter-organizational name space to be a global name space, it is useful for its mount point
in local systems to be uniform as well.
On POSIX machines, the name /nfs4/ SHOULD be used so that names on one machine will
be directly usable on any machine.  Thus, the example.net published filesystem would be accessible as

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
	/nfs4/example.net/
</pre></div>
<p>
on any POSIX client.  Using this convention, "/nfs4/" is the name of the special directory that is populated with
domain names, leading to file servers and filesystems that capture the results of SRV record lookups.

</p>


<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Mount options</h3>

<p>
SRV records are necessarily less complete than the information in the existing NFS Version 4 attributes fs_locations
and the proposed fs_locations_info.  For the rootpath field of fs_location, as mentioned,
we use the "/.domainroot-{Name}" string.  Thus,
the servers listed as targets for the SRV resource records should export the root of the organization's published
filesystem as the directory "/.domainroot-{Name}" (for the given organization Name) in its exported namespace.
For example, for organization "example.net", the directory "/.domainroot-example.net" should be used.

</p>
<p>
As for the other attributes in fs_locations_info, the recommended approach is for a client to make its first possible
contact with any of the referred-to servers, obtain the fs_locations_info structure from that server, and use the
information from that obtained structure as the basis for its judgment of whether it would be better to use a
different server representative from the set of servers for that filesystem.

</p>
<p>
The process of mounting an organization's name space should permit the use
of what is likely to impose the lowest cost on the server.  Thus, the NFS client SHOULD NOT insist
on using a writable copy of the filesystem if read-only copies exist, or a zero-age copy rather than a
copy that may be a little older.  We presume that the organization's file name space can be navigated
to provide access to higher-cost properties such as writability or currency as necessary, but that the default
use when navigating to the base information for an organization ought to be as low-overhead as possible.

</p>
<p>
Because of the possible distinction between read-only and read-write versions of a filesystem, 
organizations SHOULD also publish the location of a writable instance of their root filesystems, and that
NFSv4 clients SHOULD mount that filesystem under the organizational domain name preceded by a period (".").
Therefore, when names beginning with a period are looked up under the NFSv4 client's special directory,
the SRV RR looked up in DNS uses a Service name of "_nfs4._write._domainroot", and the indicated server
(or servers) SHOULD export the writable instance at "/.domainroot-write-{Name}" for a domain name Name.

</p>
<p>

<p>
Extending the opening example, suppose a client wished to locate the read-only and read-write roots of
the filesystem published by organization example.net.  Suppose a read-write instance were hosted on
server nfs1tr.example.net, and read-only instances were on that server and also on server
nfs2ex.example.net.  The DNS servers for the domain would publish records like

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   $ORIGIN example.net.
   _nfs4._domainroot._tcp IN SRV 0 0 2049 nfs1tr.example.net.
   _nfs4._domainroot._tcp IN SRV 1 0 2049 nfs2ex.example.net.
   _nfs4._write._domainroot._tcp IN SRV 0 0 2049 nfs1tr.example.net.
</pre></div>
<p>
The nfs1tr.example.net server would export filesystems at both "/.domainroot-example.net" (the read-only instance)
and "/.domainroot-write-example.net" (the read-write instance).  The nfs2ex.example.net server need
export only the "/.domainroot-example.net" name for its read-only instance.

</p>


<p>

<p>
The read-write version of the filesystem would be mounted (upon use) under ".example.net" in the special
directory, and a read-only version would be mounted under "example.net".  Thus,

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
	/nfs4/example.net/users
</pre></div>
might be a directory in a read-only instance of the root filesystem of the organization "example.net", while
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
	/nfs4/.example.net/users
</pre></div>
<p>
would be a writable form of that same directory.  A small benefit of following this convention is that
names with the period prefix are treated as "hidden" in many operating systems, so that the visible name
remains the lowest-overhead name.

</p>


<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
Filesystem integration issues</h3>

<p>
The result of the DNS search SHOULD appear as a (pseudo-)directory in the client name space.
A further refinement is advisable, and SHOULD be deployed: that only fully-qualified domain names appear as directories.  That is, in many
environments, DNS names may be abbreviated from their fully-qualified form.  In such circumstances, multiple names might be given to
filesystem code that all resolve to the same DNS SRV RRs.  The abbreviated form SHOULD be represented in the client's name space cache
as a symbolic link, pointing to the fully-qualified name, case-canonicalized when appropriate.  This will allow pathnames obtained with,
say, getcwd() to include the DNS name that is most likely to be usable
outside the scope of any particular DNS abbreviation convention.

</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Where is this integration carried out?</h3>

<p>
Another consideration is what agent should be responsible for interpreting the SRV records.  It could be done 
just as well by the NFS client or by the NFS server, though we expect that most clients will include this function themselves.  
Using something like Automounter <a class='info' href='#AMD'>[AMD]<span> (</span><span class='info'>Pendry, J. and N. Williams, &ldquo;Amd: The 4.4 BSD Automounter Reference Manual,&rdquo; March&nbsp;1991.</span><span>)</span></a> technology, the client would be responsible
for interpreting names under a particular directory, discovering the appropriate filesystem to mount, and mounting
it in the appropriate place in the client name space before returning control to the application doing a lookup.
Alternatively, one could imagine the existence of an NFS version 4 server that awaited similar domain-name lookups,
then consulted the SRV records in DNS to determine the servers for the indicated published filesystem, and then returned
that information as an NFS Version 4 referral.
In either case, the result of the DNS lookup should be cached (obeying TTL) so
that the result could be returned more quickly the next time.

</p>
<p>
We strongly suggest that this functionality be implemented by NFS clients.  While we recognize that it would be possible to configure clients
so that they relied on a specially-configured server to do their SRV lookups for them, we feel that such a requirement would impose unusual
dependencies and vulnerabilities for the deployers of such clients.  Yet even if it is desirable to deploy this functionality on the NFS client
side, it may be valuable as a transition aid for a site to be able to deploy it on the NFS server side: it may be 
easier for them to install it on special NFS servers rather than install it on all their NFS clients.
Thus, from an implementation standpoint, NFS clients SHOULD implement the functionality, and NFS servers MAY implement it.

</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Relationship to DNS NFS4ID RR</h3>

<p>
This DNS use has no obvious relationship to the NFS4ID RR.  The NFS4ID RR is a mechanism to help
clients and servers configure themselves with respect to the domain strings used in "who" strings
in ACL entries and in owner and group names.
The authentication/authorization domain string of a server need have no
direct relationship to the name of the organization that is publishing a file name space of which
this server's filesystems form a part.  At the same time, it might be seen as straightforward or
normal for such a server to refer to the ownership of most of its files using a domain string with
an evident relationship to that NFS4ID-given domain name, but this document imposes no such requirement.

</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Security Considerations</h3>

<p>
Naive use of the DNS may effectively give clients published server referrals that are intrusive substitutes
for the servers intended by domain administrators.

</p>
<p>
It may be possible to build a trust chain by using DNSSEC <a class='info' href='#RFC4033'>[RFC4033]<span> (</span><span class='info'>Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose, &ldquo;DNS Security Introduction and Requirements,&rdquo; March&nbsp;2005.</span><span>)</span></a> to implement
this function on the client, or by
implementing this function on an NFS Version 4 server that uses DNSSEC and maintaining a trust relationship with that
server.  This trust chain also breaks if the SRV interpreter accepts responses from insecure DNS zones.
Thus, it would likely be prudent also to use domain-based service principal names for the servers for the
root filesystems as indicated as the targets of the SRV records.
The idea here is that one wants to authenticate {nfs, domainname, host.fqdn}, not simply {nfs, host.fqdn}, when the
server is a domain's root file server obtained through an insecure DNS SRV RR lookup.  The domain
administrator can thus ensure that only domain root NFSv4 servers have credentials for such domain-based
service principal names.

</p>
<p>
<p>
Domain-based service principal names are defined in RFCs 5178 <a class='info' href='#RFC5178'>[RFC5178]<span> (</span><span class='info'>Williams, N. and A. Melnikov, &ldquo;Generic Security Service Application Program Interface (GSS-API) Internationalization and Domain-Based Service Names and Name Type,&rdquo; May&nbsp;2008.</span><span>)</span></a> and
5179 <a class='info' href='#RFC5179'>[RFC5179]<span> (</span><span class='info'>Williams, N., &ldquo;Generic Security Service Application Program Interface (GSS-API) Domain-Based Service Names Mapping for the Kerberos V GSS Mechanism,&rdquo; May&nbsp;2008.</span><span>)</span></a>.  To make use of RFC 5178's domain-based names, the syntax for "domain-based-name"
MUST be used with a service of "nfs", a domain matching the name of the organization whose root filesystem
is being sought, and a hostname given in the target of the DNS SRV resource record.  Thus, in the example above,
two file servers (nfs1tr.example.net and nfs2ex.example.net) are located as hosting the root filesystem for
the organization example.net.  To communicate with, for instance, the second of the given file servers,
GSS-API should be used with the name-type of GSS_C_NT_DOMAINBASED_SERVICE
defined in RFC 5178 and with a symbolic name of

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
	nfs@example.net@nfs2ex.example.net
</pre></div>
<p>
in order to verify that the named server (nfs2ex.example.net) is authorized to provide the root filesystem
for the example.net organization.

</p>


<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
IANA Considerations</h3>

<p>
This document does not raise actions for IANA, but it may require cosmetic changes if the in-progress work in
the Gudmundsson/Hoenes draft <a class='info' href='#Gudmundsson'>[Gudmundsson]<span> (</span><span class='info'>Gudmundsson, O. and A. Hoenes, &ldquo;Creation of a Registry for DNS SRV Record Service Prefixes,&rdquo; October&nbsp;2009.</span><span>)</span></a> is adopted.

</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC1034">[RFC1034]</a></td>
<td class="author-text">Mockapetris, P., &ldquo;<a href="http://tools.ietf.org/html/rfc1034">Domain Names - Concepts and Facilities</a>,&rdquo; RFC&nbsp;1034, November&nbsp;1987 (<a href="http://www.ietf.org/rfc/rfc1034.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1035">[RFC1035]</a></td>
<td class="author-text">Mockapetris, P., &ldquo;<a href="http://tools.ietf.org/html/rfc1035">Domain Names - Implementation and Specification</a>,&rdquo; RFC&nbsp;1035, November&nbsp;1987 (<a href="http://www.ietf.org/rfc/rfc1034.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2782">[RFC2782]</a></td>
<td class="author-text">Gulbrandsen, A., Vixie, P., and L. Esibov, &ldquo;<a href="http://tools.ietf.org/html/rfc2782">A DNS RR for specifying the location of services (DNS SRV)</a>,&rdquo; RFC&nbsp;2782, February&nbsp;2000 (<a href="http://www.ietf.org/rfc/rfc2782.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3530">[RFC3530]</a></td>
<td class="author-text">Shepler, S., Callaghan, B., Robinson, D., Thurlow, R., Beame, C., Eisler, M., and D. Noveck, &ldquo;<a href="http://tools.ietf.org/html/rfc3530">Network File System (NFS) version 4 Protocol</a>,&rdquo; RFC&nbsp;3530, April&nbsp;2003 (<a href="ftp://ftp.isi.edu/in-notes/rfc3530.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4033">[RFC4033]</a></td>
<td class="author-text">Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose, &ldquo;<a href="http://tools.ietf.org/html/rfc4033">DNS Security Introduction and Requirements</a>,&rdquo; RFC&nbsp;4033, March&nbsp;2005 (<a href="http://www.ietf.org/rfc/rfc4033.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5178">[RFC5178]</a></td>
<td class="author-text">Williams, N. and A. Melnikov, &ldquo;<a href="http://tools.ietf.org/html/rfc5178">Generic Security Service Application Program Interface (GSS-API) Internationalization and Domain-Based Service Names and Name Type</a>,&rdquo; RFC&nbsp;5178, May&nbsp;2008 (<a href="http://www.ietf.org/rfc/rfc5178.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5179">[RFC5179]</a></td>
<td class="author-text">Williams, N., &ldquo;<a href="http://tools.ietf.org/html/rfc5179">Generic Security Service Application Program Interface (GSS-API) Domain-Based Service Names Mapping for the Kerberos V GSS Mechanism</a>,&rdquo; RFC&nbsp;5179, May&nbsp;2008 (<a href="http://www.ietf.org/rfc/rfc5179.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="AFS">[AFS]</a></td>
<td class="author-text">Howard, J., &ldquo;An Overview of the Andrew File System",&rdquo; Proc. USENIX Winter Tech. Conf.&nbsp;Dallas, February&nbsp;1988.</td></tr>
<tr><td class="author-text" valign="top"><a name="AMD">[AMD]</a></td>
<td class="author-text">Pendry, J. and N. Williams, &ldquo;<a href="http://docs.freebsd.org/info/amdref/amdref.pdf">Amd: The 4.4 BSD Automounter Reference Manual</a>,&rdquo; March&nbsp;1991.</td></tr>
<tr><td class="author-text" valign="top"><a name="DFS">[DFS]</a></td>
<td class="author-text">Kazar, M., Leverett, B., Anderson, O., Apostolides, V., Bottos, B., Chutani, S., Everhart, C., Mason, W., Tu, S., and E. Zayas, &ldquo;DEcorum File System Architectural Overview,&rdquo; Proc. USENIX Summer Conf.&nbsp;Anaheim, Calif., June&nbsp;1990.</td></tr>
<tr><td class="author-text" valign="top"><a name="Gudmundsson">[Gudmundsson]</a></td>
<td class="author-text">Gudmundsson, O. and A. Hoenes, &ldquo;<a href="ftp://ftp.rfc-editor.org/in-notes/internet-drafts/draft-gudmundsson-dns-srv-iana-registry-04.txt">Creation of a Registry for DNS SRV Record Service Prefixes</a>,&rdquo; October&nbsp;2009.</td></tr>
<tr><td class="author-text" valign="top"><a name="NB0510">[NB0510]</a></td>
<td class="author-text">Noveck, D. and R. Burnett, &ldquo;<a href="ftp://www.ietf.org/internet-drafts/draft-noveck-nfsv4-migrep-00.txt">Next Steps for NFSv4 Migration/Replication</a>,&rdquo; October&nbsp;2005.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1183">[RFC1183]</a></td>
<td class="author-text">Everhart, C., Mamakos, L., Ullmann, R., and P. Mockapetris, &ldquo;<a href="http://tools.ietf.org/html/rfc1183">New DNS RR Definitions</a>,&rdquo; RFC&nbsp;1183, October&nbsp;1990 (<a href="http://www.ietf.org/rfc/rfc1183.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Craig Everhart</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">NetApp</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">800 Cranberry Woods Drive, Ste. 300</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cranberry Township, PA  16066</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 724 741 5101</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:everhart@netapp.com">everhart@netapp.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Andy Adamson</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">NetApp</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">495 East Java Drive</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Sunnyvale, CA  94089</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 734 665 1204</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:andros@netapp.com">andros@netapp.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Jiaying Zhang</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Google</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">604 Arizona Avenue</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Santa Monica, CA  90401</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 310 309 6884</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:jiayingz@google.com">jiayingz@google.com</a></td></tr>
</table>
</body></html>
