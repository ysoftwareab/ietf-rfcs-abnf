<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Coding and
    transmission of text in real-time and en-bloc mode based on MSRP</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Coding and
    transmission of text in real-time and en-bloc mode based on MSRP">
<meta name="keywords" content="real-time text; MSRP; sampled; en-bloc, SIP">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">G. Hellstrom</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Omnitor</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">P. Jones</td></tr>
<tr><td class="header">Expires: July 12, 2008</td><td class="header">Cisco Systems, Inc.</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">G. Vanderheiden</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Trace R&amp;D Center, University</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">of
      Wisconsin-Madison</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">January 09, 2008</td></tr>
</table></td></tr></table>
<h1><br />Coding and
    transmission of text in real-time and en-bloc mode based on MSRP<br />draft-hellstrom-simple-text-transmission-00</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on July 12, 2008.</p>

<h3>Abstract</h3>

<p>This memo describes conventions for exchange and presentation of text
      in SIP sessions through the Message Session Relay Protocol MSRP. It
      covers two different methods for taking the initiative to transmit.
      These methods are timer initiated real-time text and user requested
      en-bloc transmission in Messaging. The document gives specific guidance
      on handling of text presentation and presentation control of
      conversational sessions. It specifies how the capability to conduct MSRP
      sessions with real-time text is declared so that session negotiation can
      make decisions on what transport protocol to use and how to route the
      calls to get the desired support for text communication.
</p>
<h3>Requirements Language</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
      "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
      document are to be interpreted as described in <a class='info' href='#RFC2119'>RFC 2119<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a> [RFC2119].
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Consistent view of text communication based on MSRP<br />
<a href="#anchor2">2.</a>&nbsp;
Functional requirements<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">2.1.</a>&nbsp;
Common requirements<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">2.2.</a>&nbsp;
Requirements on real-time text mode<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">2.3.</a>&nbsp;
Requirements on en-bloc mode<br />
<a href="#anchor6">3.</a>&nbsp;
Media type and subtype specification<br />
<a href="#anchor7">4.</a>&nbsp;
Presentation coding<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">4.1.</a>&nbsp;
Text<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">4.2.</a>&nbsp;
Time division<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">4.3.</a>&nbsp;
New Line<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">4.4.</a>&nbsp;
Alert in session<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">4.5.</a>&nbsp;
End of Message<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">4.6.</a>&nbsp;
Erasure<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">4.7.</a>&nbsp;
Other presentation controls<br />
<a href="#anchor15">5.</a>&nbsp;
Indication and negotiation of the real-time text transmission capability<br />
<a href="#anchor16">6.</a>&nbsp;
Time sampled transmission<br />
<a href="#anchor17">7.</a>&nbsp;
Presentation of received text<br />
<a href="#anchor18">8.</a>&nbsp;
Routing of calls to real-time text capable devices.<br />
<a href="#anchor19">9.</a>&nbsp;
Sessions including MSRP based real-time text and other media.<br />
<a href="#anchor20">10.</a>&nbsp;
Security<br />
<a href="#IANA">11.</a>&nbsp;
IANA Considerations<br />
<a href="#Security">12.</a>&nbsp;
Security Considerations<br />
<a href="#Acknowledgements">13.</a>&nbsp;
Acknowledgements<br />
<a href="#anchor21">14.</a>&nbsp;
Temporary section - issues list<br />
<a href="#rfc.references1">15.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">15.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">15.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Consistent view of text communication based on MSRP</h3>

<p>A set of mechanisms must be defined in order to assure consistent
      user experience when using MSRP <a class='info' href='#RFC4975'>RFC 4975<span> (</span><span class='info'>Campbell, B., Mahy, R., and C. Jennings, &ldquo;The Message Session Relay Protocol (MSRP),&rdquo; September&nbsp;2007.</span><span>)</span></a> [RFC4975]
      for text communication in SIP <a class='info' href='#RFC3261'>[RFC3261]<span> (</span><span class='info'>Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;SIP: Session Initiation Protocol,&rdquo; June&nbsp;2002.</span><span>)</span></a> sessions.
      One style of usage of MSRP based text sessions is the real-time text
      conversation that makes use of time sampled transmission. Another style
      is Instant Messaging with user initiated transmission of complete
      messages. MSRP is a general transport method mainly intended for
      messages. The capability for real-time text transmission needs to be
      indicated, so that the users can agree on a common view of the
      conversation. A time sampling of 500 ms or less is required in order to
      achieve the end to end delay of less than 1 second that is needed for
      effective real time text conversation, . Requirements for presentation
      of conversations using real-time text is found in
      [draft-hellstrom-textpreview] <a class='info' href='#I-D.hellstrom-textpreview'>[I&#8209;D.hellstrom&#8209;textpreview]<span> (</span><span class='info'>Hellstrom, G., Williams, N., Wijk, A., and G. Vanderheiden, &ldquo;Presentation of Text Conversation in realtime and en-bloc form,&rdquo; March&nbsp;2010.</span><span>)</span></a>. Traditionally the real-time
      text medium can be transmitted with RTP, as specified in RFC 4103<a class='info' href='#RFC4103'>[RFC4103]<span> (</span><span class='info'>Hellstrom, G. and P. Jones, &ldquo;RTP Payload for Text Conversation,&rdquo; June&nbsp;2005.</span><span>)</span></a>. This specification describes how to implement
      these functions with MSRP.User initiated transmission of MSRP text
      messages also need to follow presentation conventions in order to be
      presented as expected by the sending user. It is specifically the
      following features that need to be defined:
</p>
<p></p>
<blockquote class="text">
<p>Functional requirements.
</p>
<p>Media type and subtype specification and negotiating.
</p>
<p>Presentation coding.
</p>
<p>Text
</p>
<p>Erasure
</p>
<p>New lines
</p>
<p>Other presentation control functions
</p>
<p>Indication and negotiation of the time-sampled transmission
          capability
</p>
<p>Time sampled transmission
</p>
<p>Routing of calls to real-time text capable devices.
</p>
<p>Sessions including MSRP-based real-time text and other media.
</p>
<p>Performance
</p>
<p>Security
</p>
<p>
</p>
</blockquote>

<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Functional requirements</h3>

<p>The procedures defined in this specification are intended to provide
      a text transport mechanism fulfilling the following requirements.
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
Common requirements</h3>

<p></p>
<ul class="text">
<li>Presentation of text shall be possible in one internationally
            useable character set.
</li>
<li>Presentation within messages shall be done contiguously so that
            it is easily read.
</li>
<li>It shall be possible to use the text transport method in a
            session together with other media.
</li>
<li>It shall be possible to use the text transmission in SIP
            sessions.
</li>
<li>A set of characters shall be defined for any specific language
            environment to cause end of message.
</li>
<li>It shall be possible to protect the text contents from reading
            and modification from others than authorised adressees.
</li>
<li>It shall be possible to guide routing of calls who may need
            text to specific devices capable of handling text
            transmission.
</li>
</ul>

<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
Requirements on real-time text mode</h3>

<p>
</p>
<p></p>
<ul class="text">
<li>The real-time transmission and presentation of text shall be done
          in a way so that the users experience a flow of text approximately
          as it is typed.
</li>
<li>The delay from character entry to remote display needs to be less
          than 1 s in order to maintain effective real-time conversation.
          Therefore the maximum delay before transmission of any character
          shall not be longer than 500 ms.
</li>
<li>It shall be possible to erase already transmitted text in the
          current message.[see issues-list]
</li>
<li>It shall be possible to negotiate between MSRP and other
          SIP-based standardised transport methods for real-time text at
          session setup.
</li>
<li>It shall be possible to transmit at least 30 characters per
          second.
</li>
<li>It shall be possible to guide routing of calls who may need
          real-time text to specific devices capable of handling this text
          transmission mode. The main purpose of this requirement comes from
          the requirment to find a text capable gateway to PSTN for text
          telephony.
</li>
<li>It shall be possible to use the real-time text transmission in
          SIP sessions.
</li>
</ul>

<p>
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3"></a><h3>2.3.&nbsp;
Requirements on en-bloc mode</h3>

<p></p>
<ul class="text">
<li>The transmission and presentation of text shall be done so that
            the users experience a transmission of text when a specific
            transmission action is made.
</li>
</ul>

<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Media type and subtype specification</h3>

<p>In SIP<a class='info' href='#RFC3261'>[RFC3261]<span> (</span><span class='info'>Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;SIP: Session Initiation Protocol,&rdquo; June&nbsp;2002.</span><span>)</span></a> sessions, SDP<a class='info' href='#RFC4566'>[RFC4566]<span> (</span><span class='info'>Handley, M., Jacobson, V., and C. Perkins, &ldquo;SDP: Session Description Protocol,&rdquo; July&nbsp;2006.</span><span>)</span></a> MUST indicate the media type 'message'.
</p>
<p>The Content-type is specified in the MSRP header.
</p>
<p>For real-time text, support MUST be provided for content-types
      text/plain and for message/cpim with text/plain content.
</p>
<p>In addition, other content-types MAY be supported in real-time text
      mode.
<p>SDP Examples
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   Endpoint A wishes to invite Endpoint B to an MSRP session.  A offers
   the following session description:

    v=0
    o=usera 2890844526 2890844527 IN IP4 alice.example.com
    s= -
    c=IN IP4 alice.example.com
    t=0 0
    m=message 7394 TCP/MSRP *
    a=accept-types:message/cpim text/plain
    a=real-time-text
    a=path:msrp://alice.example.com:7394/2s93i93idj;tcp

   B responds with its own URI:

    v=0
    o=userb 2890844530 2890844532 IN IP4 bob.example.com
    s= -
    c=IN IP4 bob.example.com
    t=0 0
    m=message 8493 TCP/MSRP *
    a=accept-types:message/cpim text/plain
    a=real-time-text
    a=path:msrp://bob.example.com:8493/si438dsaodes;tcp

</pre></div>
<p>Figure: SDP example for a text-only session
</p>

<p>The MSRP messages and chunks contain headers indicating the media
      type and subtype actually used.
</p>
<p>For the real-time text usage a send request MAY look like this:
</p>
<p>
<p>MSRP Chunk exaMPLE
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>   MSRP a786hjs2 SEND
   To-Path: msrp://biloxi.example.com:12763/kjhd37s2s20w2a;tcp
   From-Path: msrp://atlanta.example.com:7654/jshA7weztas;tcp
   Message-ID: 87652491
   Byte-Range: 1-5/*
   Content-Type: text/plain; charset=utf-8

   Hey B
   -------a786hjs2+
</pre></div>
<p>Example: MSRP chunk
</p>

<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Presentation coding</h3>

<p>
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Text</h3>

<p>Text shall be coded with an internationally applicable character
        set. The text/plain MIME type is defined to be used according to this
        specification. Coding with utf-8 shall be used. <a class='info' href='#RFC3629'>RFC 3629<span> (</span><span class='info'>Yergeau, F., &ldquo;UTF-8, a transformation format of ISO 10646,&rdquo; November&nbsp;2003.</span><span>)</span></a> [RFC3629]
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Time division</h3>

<p>When operating in real-time text mode, text shall be collected for
        transmission during a time interval and then transmitted as an MSRP
        chunk. The maximum delay of any character before transmission MUST be
        500ms. For good flow it SHOULD be 300 ms.
</p>
<p>For en-bloc mode, no timer-initiated tansmissions are required.
        Text MAY be sent in chunks, and recombined in complete messages by the
        receiver.
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
New Line</h3>

<p>It shall be possible to insert a new line in the text. A new line
        serves as message delimiter. Unicode Line Separator (UCS-16 2028) or
        CRLF SHALL be used for transmission. In reception, Line Separator, CR,
        CRLF, LF shall all have the same effect and be regarded as one
        operation.
</p>
<p>
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4"></a><h3>4.4.&nbsp;
Alert in session</h3>

<p>BEL may be sent to cause an external alerting action from the
        receiving terminal, but shall otherwise be treated as a non-printable
        character and have no impact on the display.
</p>
<p>
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5"></a><h3>4.5.&nbsp;
End of Message</h3>

<p>The following actions MAY cause the End of Message condition:
</p>
<p>Pressing Enter, pressing Return and pressing a Send button.
</p>
<p>The actual selection of end of message reasons is a sending
        application decision.
</p>
<p>At the End of Message condition, any unsent characters in the
        session MUST be transmitted with an End of Message indication in
        MSRP.
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.6"></a><h3>4.6.&nbsp;
Erasure</h3>

<p>Erasure of the last character shall be signalled by a 'BS'
        character. Erasure shall have effect on the local and remote
        presentation of text. Locally inserted new lines by presentation logic
        only for layout purposes shall not be transmitted and therefore do not
        require any specific erasing action. New Lines inserted by the sending
        user MUST require one BS to be erased. The complete current message
        MUST be kept available for erasure. Characters that do not occupy a
        position in the display shall not require any BS for erasure, but if
        they have any effect on the presentation, they shall be regarded to be
        erased when the character before it is erased. BEL is one such
        character. Completed messages are not available for erasure.[see
        issues-list]
</p>
<p>[To issues-list: The relation between character position
        indications in MSRP headers and real printable position in a message
        needs to be defined. Possible alternative erasing action by chunk
        position and new character for replacement may be introduced]
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.7"></a><h3>4.7.&nbsp;
Other presentation controls</h3>

<p>When using the media format text/plain, no other presentation
        controls than the ones described above can be conveyed in
        communication. Both users may vary their presentation locally.
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Indication and negotiation of the real-time text transmission capability</h3>

<p>The capability to present and transmit real-time text with MSRP MUST
      be declared by the following means:
</p>
<p>a. An attribute a=real-time-text, in the media description for the
      media=message declaration intended for the real-time text
      conversation.
</p>
<p>b. A Content-disposition=immediate-presentation to be included in the
      MSRP headers in the chunks and messages.
</p>
<p>c. The capability to present and transmit real-time text by any
      transport SHALL be declared by a media feature tag
      sip.real-time-text=&lt;any defined value&gt; in the SIP Contact header.
      This tag is also used by other text transports and may be used to
      determine if there is any real-time text support in the remote
      device.
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Time sampled transmission</h3>

<p>The availability of characters ready for transmission MUST be checked
      at regular time intervals. The interval MUST be set to 300 ms for good
      user experience.
</p>
<p>When there is something to transmit at the end of an interval, the
      text SHALL be transmitted in an MSRP message chunk. No extra character
      SHALL be added to the text before transmission.
</p>
<p>When an End of Message condition is detected, the last characters of
      the message shall be sent immediately, with an End of Message MSRP
      indication.
</p>
<p>[see issues list]The chunk position counter shall be regarded to
      point at a position in a message transmission buffer including all
      characters that have been transmitted for that message. BS and BEL shall
      thus increase the chunk position value as any other characters. The
      Chunk position MUST NOT be used to directly address any presentation
      position on a display of the text.[see issues list]
</p>
<p>Example:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    MSRP dkei38sd SEND
    Message-ID: 4564dpWd
    Byte-Range: 1-2/*
    Content-Type: text/plain; Charset=utf-8

    He
    -------dkei38sd+

    MSRP dkei38ia SEND
    Message-ID: 4564dpWd
    Byte-Range: 3-9/9
    Content-Type: text/plain; Charset=utf-8

    y Bob!

    -------dkei38ia$</pre></div>
<p>Figure: Real-time text chunks.
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Presentation of received text</h3>

<p>Text received from one session participant MUST be presented with
      some indication of the source.
</p>
<p>Text received within one message MUST be presented in one contiguous
      area.
</p>
<p>MSRP Chunks of the same message MUST be presented consecutively as
      soon as possible after reception, with no inserted character or editing
      control between the chunks.
</p>
<p>Characters MAY be added to a display singly so as to smooth
      presentation.
</p>
<p>Local presentation conventions MAY be applied to e.g break lines with
      word-wrapping.
</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Routing of calls to real-time text capable devices.</h3>

<p>A real-time text indicator in the SIP header MAY be used for routing
      of calls to real-time text capable devices, using the principles of
      caller capabilities and callee preferences from RFC 3840 and 3841.
</p>
<p>
</p>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Sessions including MSRP based real-time text and other media.</h3>

<p>Other media MAY be negotiated in the same SIP session setup as the
      MSRP session.
</p>
<p>
</p>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
Security</h3>

<p>
</p>
<a name="IANA"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
IANA Considerations</h3>

<p>This specifications register the following new items:
</p>
<p>MSRP SDP attribute
</p>
<p>a=real-time text Indicates capability to use real-time text.
</p>
<p>[see issues-list] Contents-disposition=immediate indicates that if
      fragments of the complete text message is received, the fragments shall
      be presented without waiting for later fragments.[see issues-list]
</p>
<p>Note to RFC Editor: this section may be removed on publication as an
      RFC.
</p>
<a name="Security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12"></a><h3>12.&nbsp;
Security Considerations</h3>

<p>
</p>
<a name="Acknowledgements"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.13"></a><h3>13.&nbsp;
Acknowledgements</h3>

<p>
</p>
<p>
</p>
<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.14"></a><h3>14.&nbsp;
Temporary section - issues list</h3>

<p>This chapter contains a collection of issues that have been discussed
      and not yet been resolved. The intention is to delete this section after
      resolving the issues.
</p>
<p>1. Erasure 1. A possibility to erase back over message borders may be
      appreciated. One of the tensions appearing in traditional IM is of the
      non-erasable characteristics of sent text. Technically it gets complex
      to allow erasure further back, because MSRP does not have any defined
      way to address earlier messages than the current one. Also in
      interpreting the presentation of a dialogue after modification can cause
      confusion. But, it is a desired feature. A check with users is needed to
      decide on the functionality. A proposed function is to allow erasure
      represented by the earlier completed message being brought back for
      editing, but only erasure is allowed, and shall have te effect of
      replacing characters with xxx. When new text is then typed. The
      partially erased message is closed and a new message begun.
</p>
<p>2. Erasure 2. The use of charater position within chunk and message
      must be explored and defined. It must also be explained how it is
      affected by erasure. Shall BS always be translated into a replacement of
      a previously sent character by its position?
</p>
<p>3.Erasure 3. Is the wording of handling of non-printable characters
      during erasure sufficiently described.
</p>
<p>4. The use of chunks for time sampled transmission of text has been
      questioned. The primary intent of the chunk concept was said to be for
      avoiding congestion situations. It needs to be agreed if the reason to
      get a progressive presentation of a growing message is also an
      appropriate use of chunks.
</p>
<p>
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.15"></a><h3>15.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>15.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.hellstrom-textpreview">[I-D.hellstrom-textpreview]</a></td>
<td class="author-text">Hellstrom, G., Williams, N., Wijk, A., and G. Vanderheiden, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-hellstrom-textpreview-07.txt">Presentation of Text Conversation in realtime and en-bloc form</a>,&rdquo; draft-hellstrom-textpreview-07 (work in progress), March&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-hellstrom-textpreview-07.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3261">[RFC3261]</a></td>
<td class="author-text">Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;<a href="http://tools.ietf.org/html/rfc3261">SIP: Session Initiation Protocol</a>,&rdquo; RFC&nbsp;3261, June&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3261.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3629">[RFC3629]</a></td>
<td class="author-text">Yergeau, F., &ldquo;<a href="http://tools.ietf.org/html/rfc3629">UTF-8, a transformation format of ISO 10646</a>,&rdquo; STD&nbsp;63, RFC&nbsp;3629, November&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3629.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4566">[RFC4566]</a></td>
<td class="author-text">Handley, M., Jacobson, V., and C. Perkins, &ldquo;<a href="http://tools.ietf.org/html/rfc4566">SDP: Session Description Protocol</a>,&rdquo; RFC&nbsp;4566, July&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4566.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4975">[RFC4975]</a></td>
<td class="author-text">Campbell, B., Mahy, R., and C. Jennings, &ldquo;<a href="http://tools.ietf.org/html/rfc4975">The Message Session Relay Protocol (MSRP)</a>,&rdquo; RFC&nbsp;4975, September&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4975.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>15.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC4103">[RFC4103]</a></td>
<td class="author-text">Hellstrom, G. and P. Jones, &ldquo;<a href="http://tools.ietf.org/html/rfc4103">RTP Payload for Text Conversation</a>,&rdquo; RFC&nbsp;4103, June&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4103.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Gunnar Hellstrom</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Omnitor</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Box 92054</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Stockholm,   12006</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Sweden</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+46 8 589 000 56</td></tr>
<tr><td class="author" align="right">Fax:&nbsp;</td>
<td class="author-text">+46 8 589 000 51</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:gunnar.hellstrom@omnitor.se">gunnar.hellstrom@omnitor.se</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Paul Jones</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">7025 Kit Creek Rd.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Research Triangle Park,, NC  27709</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 919 392 6948</td></tr>
<tr><td class="author" align="right">Fax:&nbsp;</td>
<td class="author-text"></td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:paulej@packetizer.com">paulej@packetizer.com</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href=""></a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Gregg Vanderheiden</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Trace R&amp;D Center, University of
      Wisconsin-Madison</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">1550 Engineering Drive</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Madison, Wi  53706</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text"></td></tr>
<tr><td class="author" align="right">Fax:&nbsp;</td>
<td class="author-text"></td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:gv@trace.wisc.edu">gv@trace.wisc.edu</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.engr.wisc.edu/ie/faculty/vanderheiden_gregg.html">http://www.engr.wisc.edu/ie/faculty/vanderheiden_gregg.html</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2008).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
