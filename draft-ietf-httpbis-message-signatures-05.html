<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Signing HTTP Messages</title>
<meta content="Annabelle Backman" name="author">
<meta content="Justin Richer" name="author">
<meta content="Manu Sporny" name="author">
<meta content="
       This document describes a mechanism for creating, encoding, and verifying digital signatures or message authentication codes over content within an HTTP message.  This mechanism supports use cases where the full HTTP message may not be known to the signer, and where the message may be transformed (e.g., by intermediaries) before reaching the verifier. 
    " name="description">
<meta content="xml2rfc 3.8.0" name="generator">
<meta content="PKI" name="keyword">
<meta content="draft-ietf-httpbis-message-signatures-05" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.8.0
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.4.1
    google-i18n-address 2.4.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.6.3
    pycountry 20.7.3
    pyflakes 2.3.1
    PyYAML 5.4.1
    requests 2.25.1
    setuptools 57.0.0
    six 1.16.0
-->
<link href="/tmp/draft-ietf-httpbis-message-signatures-05-bjvo4wmg.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Signing HTTP Messages</td>
<td class="right">June 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Backman, et al.</td>
<td class="center">Expires 10 December 2021</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">HTTP</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-httpbis-message-signatures-05</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2021-06-08" class="published">8 June 2021</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2021-12-10">10 December 2021</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">A. Backman, <span class="editor">Ed.</span>
</div>
<div class="org">Amazon</div>
</div>
<div class="author">
      <div class="author-name">J. Richer</div>
<div class="org">Bespoke Engineering</div>
</div>
<div class="author">
      <div class="author-name">M. Sporny</div>
<div class="org">Digital Bazaar</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Signing HTTP Messages</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document describes a mechanism for creating, encoding, and verifying digital signatures or message authentication codes over content within an HTTP message.  This mechanism supports use cases where the full HTTP message may not be known to the signer, and where the message may be transformed (e.g., by intermediaries) before reaching the verifier.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note" id="section-note.1">
      <h2 id="name-note-to-readers">
<a href="#name-note-to-readers" class="section-name selfRef">Note to Readers</a>
      </h2>
<p id="section-note.1-1"><em>RFC EDITOR: please remove this section before publication</em><a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">Discussion of this draft takes place on the HTTP working group mailing list (ietf-http-wg@w3.org), which is archived at <a href="https://lists.w3.org/Archives/Public/ietf-http-wg/">https://lists.w3.org/Archives/Public/ietf-http-wg/</a>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">Working Group information can be found at <a href="https://httpwg.org/">https://httpwg.org/</a>; source code and issues list for this draft can be found at <a href="https://github.com/httpwg/http-extensions/labels/signatures">https://github.com/httpwg/http-extensions/labels/signatures</a>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 10 December 2021.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-requirements-discussion" class="xref">Requirements Discussion</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="xref">1.2</a>.  <a href="#name-http-message-transformation" class="xref">HTTP Message Transformations</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.1.2.3">
                <p id="section-toc.1-1.1.2.3.1" class="keepWithNext"><a href="#section-1.3" class="xref">1.3</a>.  <a href="#name-safe-transformations" class="xref">Safe Transformations</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.1.2.4">
                <p id="section-toc.1-1.1.2.4.1"><a href="#section-1.4" class="xref">1.4</a>.  <a href="#name-conventions-and-terminology" class="xref">Conventions and Terminology</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.1.2.5">
                <p id="section-toc.1-1.1.2.5.1"><a href="#section-1.5" class="xref">1.5</a>.  <a href="#name-application-of-http-message" class="xref">Application of HTTP Message Signatures</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-http-message-signature-cove" class="xref">HTTP Message Signature Covered Content</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-http-headers" class="xref">HTTP Headers</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.2.2.1.2.1">
                    <p id="section-toc.1-1.2.2.1.2.1.1"><a href="#section-2.1.1" class="xref">2.1.1</a>.  <a href="#name-canonicalized-structured-ht" class="xref">Canonicalized Structured HTTP Headers</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.2.2.1.2.2">
                    <p id="section-toc.1-1.2.2.1.2.2.1"><a href="#section-2.1.2" class="xref">2.1.2</a>.  <a href="#name-canonicalization-examples" class="xref">Canonicalization Examples</a></p>
</li>
                </ul>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-dictionary-structured-field" class="xref">Dictionary Structured Field Members</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.2.2.2.2.1">
                    <p id="section-toc.1-1.2.2.2.2.1.1"><a href="#section-2.2.1" class="xref">2.2.1</a>.  <a href="#name-canonicalization-examples-2" class="xref">Canonicalization Examples</a></p>
</li>
                </ul>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="xref">2.3</a>.  <a href="#name-specialty-content-fields" class="xref">Specialty Content Fields</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.2.2.3.2.1">
                    <p id="section-toc.1-1.2.2.3.2.1.1"><a href="#section-2.3.1" class="xref">2.3.1</a>.  <a href="#name-request-target" class="xref">Request Target</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.2.2.3.2.2">
                    <p id="section-toc.1-1.2.2.3.2.2.1"><a href="#section-2.3.2" class="xref">2.3.2</a>.  <a href="#name-signature-parameters" class="xref">Signature Parameters</a></p>
</li>
                </ul>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a href="#section-2.4" class="xref">2.4</a>.  <a href="#name-creating-the-signature-inpu" class="xref">Creating the Signature Input String</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-http-message-signatures" class="xref">HTTP Message Signatures</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-creating-a-signature" class="xref">Creating a Signature</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-verifying-a-signature" class="xref">Verifying a Signature</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.3.2.2.2.1">
                    <p id="section-toc.1-1.3.2.2.2.1.1"><a href="#section-3.2.1" class="xref">3.2.1</a>.  <a href="#name-enforcing-application-requi" class="xref">Enforcing Application Requirements</a></p>
</li>
                </ul>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-signature-algorithm-methods" class="xref">Signature Algorithm Methods</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.3.2.3.2.1">
                    <p id="section-toc.1-1.3.2.3.2.1.1"><a href="#section-3.3.1" class="xref">3.3.1</a>.  <a href="#name-rsassa-pss-using-sha-512" class="xref">RSASSA-PSS using SHA-512</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.3.2.3.2.2">
                    <p id="section-toc.1-1.3.2.3.2.2.1"><a href="#section-3.3.2" class="xref">3.3.2</a>.  <a href="#name-rsassa-pkcs1-v1_5-using-sha" class="xref">RSASSA-PKCS1-v1_5 using SHA-256</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.3.2.3.2.3">
                    <p id="section-toc.1-1.3.2.3.2.3.1"><a href="#section-3.3.3" class="xref">3.3.3</a>.  <a href="#name-hmac-using-sha-256" class="xref">HMAC using SHA-256</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.3.2.3.2.4">
                    <p id="section-toc.1-1.3.2.3.2.4.1"><a href="#section-3.3.4" class="xref">3.3.4</a>.  <a href="#name-ecdsa-using-curve-p-256-dss" class="xref">ECDSA using curve P-256 DSS and SHA-256</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.3.2.3.2.5">
                    <p id="section-toc.1-1.3.2.3.2.5.1"><a href="#section-3.3.5" class="xref">3.3.5</a>.  <a href="#name-json-web-signature-jws-algo" class="xref">JSON Web Signature (JWS) algorithms</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-including-a-message-signatu" class="xref">Including a Message Signature in a Message</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-the-signature-input-http-he" class="xref">The 'Signature-Input' HTTP Header</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-the-signature-http-header" class="xref">The 'Signature' HTTP Header</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.  <a href="#name-multiple-signatures" class="xref">Multiple Signatures</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-http-signature-algorithms-r" class="xref">HTTP Signature Algorithms Registry</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.5.2.1.2.1">
                    <p id="section-toc.1-1.5.2.1.2.1.1"><a href="#section-5.1.1" class="xref">5.1.1</a>.  <a href="#name-registration-template" class="xref">Registration Template</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.5.2.1.2.2">
                    <p id="section-toc.1-1.5.2.1.2.2.1"><a href="#section-5.1.2" class="xref">5.1.2</a>.  <a href="#name-initial-contents" class="xref">Initial Contents</a></p>
</li>
                </ul>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-http-signature-metadata-par" class="xref">HTTP Signature Metadata Parameters Registry</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.5.2.2.2.1">
                    <p id="section-toc.1-1.5.2.2.2.1.1"><a href="#section-5.2.1" class="xref">5.2.1</a>.  <a href="#name-registration-template-2" class="xref">Registration Template</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.5.2.2.2.2">
                    <p id="section-toc.1-1.5.2.2.2.2.1"><a href="#section-5.2.2" class="xref">5.2.2</a>.  <a href="#name-initial-contents-2" class="xref">Initial Contents</a></p>
</li>
                </ul>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="xref">5.3</a>.  <a href="#name-http-signature-specialty-co" class="xref">HTTP Signature Specialty Content Identifiers Registry</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.5.2.3.2.1">
                    <p id="section-toc.1-1.5.2.3.2.1.1"><a href="#section-5.3.1" class="xref">5.3.1</a>.  <a href="#name-registration-template-3" class="xref">Registration Template</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.5.2.3.2.2">
                    <p id="section-toc.1-1.5.2.3.2.2.1"><a href="#section-5.3.2" class="xref">5.3.2</a>.  <a href="#name-initial-contents-3" class="xref">Initial Contents</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-references" class="xref">References</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="xref">7.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-appendix.a" class="xref">Appendix A</a>.  <a href="#name-detecting-http-message-sign" class="xref">Detecting HTTP Message Signatures</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-appendix.b" class="xref">Appendix B</a>.  <a href="#name-examples" class="xref">Examples</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-b.1" class="xref">B.1</a>.  <a href="#name-example-keys" class="xref">Example Keys</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.9.2.1.2.1">
                    <p id="section-toc.1-1.9.2.1.2.1.1"><a href="#section-b.1.1" class="xref">B.1.1</a>.  <a href="#name-example-key-rsa-test" class="xref">Example Key RSA test</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.9.2.1.2.2">
                    <p id="section-toc.1-1.9.2.1.2.2.1"><a href="#section-b.1.2" class="xref">B.1.2</a>.  <a href="#name-example-rsa-pss-key" class="xref">Example RSA PSS Key</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.9.2.1.2.3">
                    <p id="section-toc.1-1.9.2.1.2.3.1"><a href="#section-b.1.3" class="xref">B.1.3</a>.  <a href="#name-example-ecc-p-256-test-key" class="xref">Example ECC P-256 Test Key</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.9.2.1.2.4">
                    <p id="section-toc.1-1.9.2.1.2.4.1"><a href="#section-b.1.4" class="xref">B.1.4</a>.  <a href="#name-example-shared-secret" class="xref">Example Shared Secret</a></p>
</li>
                </ul>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-b.2" class="xref">B.2</a>.  <a href="#name-test-cases" class="xref">Test Cases</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.9.2.2.2.1">
                    <p id="section-toc.1-1.9.2.2.2.1.1"><a href="#section-b.2.1" class="xref">B.2.1</a>.  <a href="#name-minimal-signature-header-us" class="xref">Minimal Signature Header using rsa-pss-sha512</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.9.2.2.2.2">
                    <p id="section-toc.1-1.9.2.2.2.2.1"><a href="#section-b.2.2" class="xref">B.2.2</a>.  <a href="#name-header-coverage-using-rsa-p" class="xref">Header Coverage using rsa-pss-sha512</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.9.2.2.2.3">
                    <p id="section-toc.1-1.9.2.2.2.3.1"><a href="#section-b.2.3" class="xref">B.2.3</a>.  <a href="#name-full-coverage-using-rsa-pss" class="xref">Full Coverage using rsa-pss-sha512</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.9.2.2.2.4">
                    <p id="section-toc.1-1.9.2.2.2.4.1"><a href="#section-b.2.4" class="xref">B.2.4</a>.  <a href="#name-signing-a-response-using-ec" class="xref">Signing a Response using ecdsa-p256-sha256</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.9.2.2.2.5">
                    <p id="section-toc.1-1.9.2.2.2.5.1"><a href="#section-b.2.5" class="xref">B.2.5</a>.  <a href="#name-signing-a-request-using-hma" class="xref">Signing a Request using hmac-sha256</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-appendix.c" class="xref"></a><a href="#name-acknowledgements" class="xref">Acknowledgements</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-appendix.d" class="xref"></a><a href="#name-document-history" class="xref">Document History</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-appendix.e" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="intro">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Message integrity and authenticity are important security properties that are critical to the secure operation of many HTTP applications.
Application developers typically rely on the transport layer to provide these properties, by operating their application over <span>[<a href="#TLS" class="xref">TLS</a>]</span>.  However, TLS only guarantees these properties over a single TLS connection, and the path between client and application may be composed of multiple independent TLS connections (for example, if the application is hosted behind a TLS-terminating gateway or if the client is behind a TLS Inspection appliance).  In such cases, TLS cannot guarantee end-to-end message integrity or authenticity between the client and application.  Additionally, some operating environments present obstacles that make it impractical to use TLS, or to use features necessary to provide message authenticity.  Furthermore, some applications require the binding of an application-level key to the HTTP message, separate from any TLS certificates in use. Consequently, while TLS can meet message integrity and authenticity needs for many HTTP-based applications, it is not a universal solution.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">This document defines a mechanism for providing end-to-end integrity and authenticity for content within an HTTP message.  The mechanism allows applications to create digital signatures or message authentication codes (MACs) over only that content within the message that is meaningful and appropriate for the application.  Strict canonicalization rules ensure that the verifier can verify the signature even if the message has been transformed in any of the many ways permitted by HTTP.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">The mechanism described in this document consists of three parts:<a href="#section-1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-4.1">A common nomenclature and canonicalization rule set for the different protocol elements and other content within HTTP messages.<a href="#section-1-4.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-4.2">Algorithms for generating and verifying signatures over HTTP message content using this nomenclature and rule set.<a href="#section-1-4.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-4.3">A mechanism for attaching a signature and related metadata to an HTTP message.<a href="#section-1-4.3" class="pilcrow">¶</a>
</li>
      </ul>
<div id="requirements-discussion">
<section id="section-1.1">
        <h3 id="name-requirements-discussion">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-requirements-discussion" class="section-name selfRef">Requirements Discussion</a>
        </h3>
<p id="section-1.1-1">HTTP permits and sometimes requires intermediaries to transform messages in a variety of ways.  This may result in a recipient receiving a message that is not bitwise equivalent to the message that was originally sent.  In such a case, the recipient will be unable to verify a signature over the raw bytes of the sender's HTTP message, as verifying digital signatures or MACs requires both signer and verifier to have the exact same signed content.  Since the raw bytes of the message cannot be relied upon as signed content, the signer and verifier must derive the signed content from their respective versions of the message, via a mechanism that is resilient to safe changes that do not alter the meaning of the message.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">For a variety of reasons, it is impractical to strictly define what constitutes a safe change versus an unsafe one.  Applications use HTTP in a wide variety of ways, and may disagree on whether a particular piece of information in a message (e.g., the body, or the <code>Date</code> header field) is relevant.  Thus a general purpose solution must provide signers with some degree of control over which message content is signed.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
<p id="section-1.1-3">HTTP applications may be running in environments that do not provide complete access to or control over HTTP messages (such as a web browser's JavaScript environment), or may be using libraries that abstract away the details of the protocol (such as <a href="https://openjdk.java.net/groups/net/httpclient/intro.html">the Java HTTPClient library</a>).  These applications need to be able to generate and verify signatures despite incomplete knowledge of the HTTP message.<a href="#section-1.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="transforms">
<section id="section-1.2">
        <h3 id="name-http-message-transformation">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-http-message-transformation" class="section-name selfRef">HTTP Message Transformations</a>
        </h3>
<p id="section-1.2-1">As mentioned earlier, HTTP explicitly permits and in some cases requires implementations to transform messages in a variety of ways.  Implementations are required to tolerate many of these transformations.  What follows is a non-normative and non-exhaustive list of transformations that may occur under HTTP, provided as context:<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.2-2.1">Re-ordering of header fields with different header field names (<span>[<a href="#MESSAGING" class="xref">MESSAGING</a>]</span>, Section 3.2.2).<a href="#section-1.2-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.2-2.2">Combination of header fields with the same field name (<span>[<a href="#MESSAGING" class="xref">MESSAGING</a>]</span>, Section 3.2.2).<a href="#section-1.2-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.2-2.3">Removal of header fields listed in the <code>Connection</code> header field (<span>[<a href="#MESSAGING" class="xref">MESSAGING</a>]</span>, Section 6.1).<a href="#section-1.2-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.2-2.4">Addition of header fields that indicate control options (<span>[<a href="#MESSAGING" class="xref">MESSAGING</a>]</span>, Section 6.1).<a href="#section-1.2-2.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.2-2.5">Addition or removal of a transfer coding (<span>[<a href="#MESSAGING" class="xref">MESSAGING</a>]</span>, Section 5.7.2).<a href="#section-1.2-2.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.2-2.6">Addition of header fields such as <code>Via</code> (<span>[<a href="#MESSAGING" class="xref">MESSAGING</a>]</span>, Section 5.7.1) and <code>Forwarded</code> (<span>[<a href="#RFC7239" class="xref">RFC7239</a>]</span>, Section 4).<a href="#section-1.2-2.6" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="safe-transformations">
<section id="section-1.3">
        <h3 id="name-safe-transformations">
<a href="#section-1.3" class="section-number selfRef">1.3. </a><a href="#name-safe-transformations" class="section-name selfRef">Safe Transformations</a>
        </h3>
<p id="section-1.3-1">Based on the definition of HTTP and the requirements described above, we can identify certain types of transformations that should not prevent signature verification, even when performed on content covered by the signature.  The following list describes those transformations:<a href="#section-1.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.3-2.1">Combination of header fields with the same field name.<a href="#section-1.3-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.3-2.2">Reordering of header fields with different names.<a href="#section-1.3-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.3-2.3">Conversion between different versions of the HTTP protocol (e.g., HTTP/1.x to HTTP/2, or vice-versa).<a href="#section-1.3-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.3-2.4">Changes in casing (e.g., "Origin" to "origin") of any case-insensitive content such as header field names, request URI scheme, or host.<a href="#section-1.3-2.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.3-2.5">Addition or removal of leading or trailing whitespace to a header field value.<a href="#section-1.3-2.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.3-2.6">Addition or removal of <code>obs-folds</code>.<a href="#section-1.3-2.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.3-2.7">Changes to the <code>request-target</code> and <code>Host</code> header field that when applied together do not
result in a change to the message's effective request URI, as defined in Section 5.5 of
<span>[<a href="#MESSAGING" class="xref">MESSAGING</a>]</span>.<a href="#section-1.3-2.7" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-1.3-3">Additionally, all changes to content not covered by the signature are considered safe.<a href="#section-1.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="definitions">
<section id="section-1.4">
        <h3 id="name-conventions-and-terminology">
<a href="#section-1.4" class="section-number selfRef">1.4. </a><a href="#name-conventions-and-terminology" class="section-name selfRef">Conventions and Terminology</a>
        </h3>
<p id="section-1.4-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED",
"MAY", and "OPTIONAL" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-1.4-1" class="pilcrow">¶</a></p>
<p id="section-1.4-2">The terms "HTTP message", "HTTP request", "HTTP response",
<code>absolute-form</code>, <code>absolute-path</code>, "effective request URI",
"gateway", "header field", "intermediary", <code>request-target</code>,
"sender", and "recipient" are used as defined in <span>[<a href="#MESSAGING" class="xref">MESSAGING</a>]</span>.<a href="#section-1.4-2" class="pilcrow">¶</a></p>
<p id="section-1.4-3">The term "method" is to be interpreted as defined in Section 4 of <span>[<a href="#SEMANTICS" class="xref">SEMANTICS</a>]</span>.<a href="#section-1.4-3" class="pilcrow">¶</a></p>
<p id="section-1.4-4">For brevity, the term "signature" on its own is used in this document to refer to both digital signatures and keyed MACs.  Similarly, the verb "sign" refers to the generation of either a digital signature or keyed MAC over a given input string.  The qualified term "digital signature" refers specifically to the output of an asymmetric cryptographic signing operation.<a href="#section-1.4-4" class="pilcrow">¶</a></p>
<p id="section-1.4-5">In addition to those listed above, this document uses the following terms:<a href="#section-1.4-5" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-1.4-6">
          <dt id="section-1.4-6.1">
Signer:  </dt>
          <dd style="margin-left: 1.5em" id="section-1.4-6.2">
            <p id="section-1.4-6.2.1">The entity that is generating or has generated an HTTP Message Signature.<a href="#section-1.4-6.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.4-6.3">
Verifier:  </dt>
          <dd style="margin-left: 1.5em" id="section-1.4-6.4">
            <p id="section-1.4-6.4.1">An entity that is verifying or has verified an HTTP Message Signature against an HTTP Message.  Note that an HTTP Message Signature may be verified multiple times, potentially by different entities.<a href="#section-1.4-6.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.4-6.5">
Covered Content:  </dt>
          <dd style="margin-left: 1.5em" id="section-1.4-6.6">
            <p id="section-1.4-6.6.1">An ordered list of content identifiers for headers (<a href="#http-header" class="xref">Section 2.1</a>) and specialty content (<a href="#specialty-content" class="xref">Section 2.3</a>) that indicates the metadata and message content that is covered by the signature, not including the <code>@signature-params</code> specialty field itself.<a href="#section-1.4-6.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.4-6.7">
HTTP Signature Algorithm:  </dt>
          <dd style="margin-left: 1.5em" id="section-1.4-6.8">
            <p id="section-1.4-6.8.1">A cryptographic algorithm that describes the signing and verification process for the signature. When expressed explicitly, the value maps to a string defined in the HTTP Signature Algorithms Registry defined in this document.<a href="#section-1.4-6.8.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.4-6.9">
Key Material:  </dt>
          <dd style="margin-left: 1.5em" id="section-1.4-6.10">
            <p id="section-1.4-6.10.1">The key material required to create or verify the signature. The key material is often identified with an explicit key identifier, allowing the signer to indicate to the verifier which key was used.<a href="#section-1.4-6.10.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.4-6.11">
Creation Time:  </dt>
          <dd style="margin-left: 1.5em" id="section-1.4-6.12">
            <p id="section-1.4-6.12.1">A timestamp representing the point in time that the signature was generated, as asserted by the signer.<a href="#section-1.4-6.12.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.4-6.13">
Expiration Time:  </dt>
          <dd style="margin-left: 1.5em" id="section-1.4-6.14">
            <p id="section-1.4-6.14.1">A timestamp representing the point in time at which the signature expires, as asserted by the signer. A signature's expiration time could be undefined, indicating that the signature does not expire from the perspective of the signer.<a href="#section-1.4-6.14.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-1.4-7">The term "Unix time" is defined by <span>[<a href="#POSIX.1" class="xref">POSIX.1</a>]</span>, <a href="http://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap04.html#tag_04_16">Section 4.16</a>.<a href="#section-1.4-7" class="pilcrow">¶</a></p>
<p id="section-1.4-8">This document contains non-normative examples of partial and complete HTTP messages. Some examples use a single trailing backslash '' to indicate line wrapping for long values, as per <span>[<a href="#RFC8792" class="xref">RFC8792</a>]</span>. The <code>\</code> character and leading spaces on wrapped lines are not part of the value.<a href="#section-1.4-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="application">
<section id="section-1.5">
        <h3 id="name-application-of-http-message">
<a href="#section-1.5" class="section-number selfRef">1.5. </a><a href="#name-application-of-http-message" class="section-name selfRef">Application of HTTP Message Signatures</a>
        </h3>
<p id="section-1.5-1">HTTP Message Signatures are designed to be a general-purpose security mechanism applicable in a wide variety of circumstances and applications. In order to properly and safely apply HTTP Message Signatures, an application or profile of this specification MUST specify all of the following items:<a href="#section-1.5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.5-2.1">The set of <span><a href="#covered-content" class="xref">content identifiers</a> (<a href="#covered-content" class="xref">Section 2</a>)</span> that are expected and required. For example, an authorization protocol could mandate that the <code>Authorization</code> header be covered to protect the authorization credentials and mandate the signature parameters contain a <code>created</code> parameter, while an API expecting HTTP message bodies could require the <code>Digest</code> header to be present and covered.<a href="#section-1.5-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.5-2.2">A means of retrieving the key material used to verify the signature. An application will usually use the <code>keyid</code> parameter of the signature parameters (<a href="#signature-params" class="xref">Section 2.3.2</a>) and define rules for resolving a key from there, though the appropriate key could be known from other means.<a href="#section-1.5-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.5-2.3">A means of determining the signature algorithm used to verify the signature content is appropriate for the key material. For example, the process could use the <code>alg</code> parameter of the signature parameters (<a href="#signature-params" class="xref">Section 2.3.2</a>) to state the algorithm explicitly, derive the algorithm from the key material, or use some pre-configured algorithm agreed upon by the signer and verifier.<a href="#section-1.5-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.5-2.4">A means of determining that a given key and algorithm presented in the request are appropriate for the request being made. For example, a server expecting only ECDSA signatures should know to reject any RSA signatures, or a server expecting asymmetric cryptography should know to reject any symmetric cryptography.<a href="#section-1.5-2.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-1.5-3">The details of this kind of profiling are the purview of the application and outside the scope of this specification.<a href="#section-1.5-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="covered-content">
<section id="section-2">
      <h2 id="name-http-message-signature-cove">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-http-message-signature-cove" class="section-name selfRef">HTTP Message Signature Covered Content</a>
      </h2>
<p id="section-2-1">In order to allow signers and verifiers to establish which content is covered by a signature, this document defines content identifiers for data items covered by an HTTP Message Signature as well as the means for combining these canonicalized values into a signature input string.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">Some content within HTTP messages can undergo transformations that change the bitwise value without altering meaning of the content (for example, the merging together of header fields with the same name).  Message content must therefore be canonicalized before it is signed, to ensure that a signature can be verified despite such intermediary transformations. This document defines rules for each content identifier that transform the identifier's associated content into such a canonical form.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">Content identifiers are defined using production grammar defined by <span><a href="#RFC8941" class="xref">RFC8941, Section 4</a> [<a href="#RFC8941" class="xref">RFC8941</a>]</span>.
The content identifier is an <code>sf-string</code> value. The content identifier
type MAY define parameters which are included using the <code>parameters</code> rule.<a href="#section-2-3" class="pilcrow">¶</a></p>
<div id="section-2-4">
<pre class="sourcecode lang-abnf">
content-identifier = sf-string parameters
</pre><a href="#section-2-4" class="pilcrow">¶</a>
</div>
<p id="section-2-5">Note that this means the value of the identifier itself is encased in double quotes, with parameters following as a semicolon-separated list, such as <code>"cache-control"</code>, <code>"date"</code>, or <code>"@signature-params"</code>.<a href="#section-2-5" class="pilcrow">¶</a></p>
<p id="section-2-6">The following sections define content identifier types, their parameters, their associated content, and their canonicalization rules. The method for combining content identifiers into the signature input string is defined in <a href="#create-sig-input" class="xref">Section 2.4</a>.<a href="#section-2-6" class="pilcrow">¶</a></p>
<div id="http-header">
<section id="section-2.1">
        <h3 id="name-http-headers">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-http-headers" class="section-name selfRef">HTTP Headers</a>
        </h3>
<p id="section-2.1-1">The content identifier for an HTTP header is the lowercased form of its header field name. While HTTP header field names are case-insensitive, implementations MUST use lowercased field names (e.g., <code>content-type</code>, <code>date</code>, <code>etag</code>) when using them as content identifiers.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1-2">Unless overridden by additional parameters and rules, the HTTP header field value MUST be canonicalized with the following steps:<a href="#section-2.1-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.1-3">
<li id="section-2.1-3.1">Create an ordered list of the field values of each instance of the header field in the message, in the order that they occur (or will occur) in the message.<a href="#section-2.1-3.1" class="pilcrow">¶</a>
</li>
          <li id="section-2.1-3.2">Strip leading and trailing whitespace from each item in the list.<a href="#section-2.1-3.2" class="pilcrow">¶</a>
</li>
          <li id="section-2.1-3.3">Concatenate the list items together, with a comma "," and space " " between each item.<a href="#section-2.1-3.3" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-2.1-4">The resulting string is the canonicalized value.<a href="#section-2.1-4" class="pilcrow">¶</a></p>
<div id="http-header-structured">
<section id="section-2.1.1">
          <h4 id="name-canonicalized-structured-ht">
<a href="#section-2.1.1" class="section-number selfRef">2.1.1. </a><a href="#name-canonicalized-structured-ht" class="section-name selfRef">Canonicalized Structured HTTP Headers</a>
          </h4>
<p id="section-2.1.1-1">If value of the the HTTP header in question is a structured field (<span>[<a href="#RFC8941" class="xref">RFC8941</a>]</span>), the content identifier MAY include the <code>sf</code> parameter. If this
parameter is included, the HTTP header value MUST be canonicalized using the rules specified in <span><a href="#RFC8941" class="xref">Section 4 of RFC8941</a> [<a href="#RFC8941" class="xref">RFC8941</a>]</span>. Note that this process
will replace any optional whitespace with a single space.<a href="#section-2.1.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1.1-2">The resulting string is used as the field value input in <a href="#http-header" class="xref">Section 2.1</a>.<a href="#section-2.1.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="canonicalization-examples">
<section id="section-2.1.2">
          <h4 id="name-canonicalization-examples">
<a href="#section-2.1.2" class="section-number selfRef">2.1.2. </a><a href="#name-canonicalization-examples" class="section-name selfRef">Canonicalization Examples</a>
          </h4>
<p id="section-2.1.2-1">This section contains non-normative examples of canonicalized values for header fields, given the following example HTTP message:<a href="#section-2.1.2-1" class="pilcrow">¶</a></p>
<div id="section-2.1.2-2">
<pre class="sourcecode lang-http-message">
Server: www.example.com
Date: Tue, 07 Jun 2014 20:51:35 GMT
X-OWS-Header:   Leading and trailing whitespace.
X-Obs-Fold-Header: Obsolete
    line folding.
X-Empty-Header:
Cache-Control: max-age=60
Cache-Control:    must-revalidate
</pre><a href="#section-2.1.2-2" class="pilcrow">¶</a>
</div>
<p id="section-2.1.2-3">The following table shows example canonicalized values for header fields, given that message:<a href="#section-2.1.2-3" class="pilcrow">¶</a></p>
<span id="name-non-normative-examples-of-h"></span><table class="center" id="table-1">
            <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-non-normative-examples-of-h" class="selfRef">Non-normative examples of header field canonicalization.</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Header Field</th>
                <th class="text-left" rowspan="1" colspan="1">Canonicalized Value</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>"cache-control"</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">max-age=60, must-revalidate</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>"date"</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Tue, 07 Jun 2014 20:51:35 GMT</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>"server"</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">www.example.com</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>"x-empty-header"</code>
</td>
                <td class="text-left" rowspan="1" colspan="1"> </td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>"x-obs-fold-header"</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Obsolete line folding.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>"x-ows-header"</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Leading and trailing whitespace.</td>
              </tr>
            </tbody>
          </table>
</section>
</div>
</section>
</div>
<div id="dictionary-structured-field-members">
<section id="section-2.2">
        <h3 id="name-dictionary-structured-field">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-dictionary-structured-field" class="section-name selfRef">Dictionary Structured Field Members</a>
        </h3>
<p id="section-2.2-1">An individual member in the value of a Dictionary Structured Field is identified by using the parameter <code>key</code> on the content identifier for the header. The value of this parameter is a the key being identified, without any parameters present on that key in the original dictionary.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<p id="section-2.2-2">An individual member in the value of a Dictionary Structured Field is canonicalized by applying the serialization algorithm described in <span><a href="#RFC8941" class="xref">Section 4.1.2 of RFC8941</a> [<a href="#RFC8941" class="xref">RFC8941</a>]</span> on a Dictionary containing only that member.<a href="#section-2.2-2" class="pilcrow">¶</a></p>
<div id="canonicalization-examples-1">
<section id="section-2.2.1">
          <h4 id="name-canonicalization-examples-2">
<a href="#section-2.2.1" class="section-number selfRef">2.2.1. </a><a href="#name-canonicalization-examples-2" class="section-name selfRef">Canonicalization Examples</a>
          </h4>
<p id="section-2.2.1-1">This section contains non-normative examples of canonicalized values for Dictionary Structured Field Members given the following example header field, whose value is assumed to be a Dictionary:<a href="#section-2.2.1-1" class="pilcrow">¶</a></p>
<div id="section-2.2.1-2">
<pre class="sourcecode lang-http-message">
X-Dictionary:  a=1, b=2;x=1;y=2, c=(a b c)
</pre><a href="#section-2.2.1-2" class="pilcrow">¶</a>
</div>
<p id="section-2.2.1-3">The following table shows example canonicalized values for different content identifiers, given that field:<a href="#section-2.2.1-3" class="pilcrow">¶</a></p>
<span id="name-non-normative-examples-of-d"></span><table class="center" id="table-2">
            <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-non-normative-examples-of-d" class="selfRef">Non-normative examples of Dictionary member canonicalization.</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Content Identifier</th>
                <th class="text-left" rowspan="1" colspan="1">Canonicalized Value</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>"x-dictionary";key=a</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">1</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>"x-dictionary";key=b</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">2;x=1;y=2</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>"x-dictionary";key=c</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">(a, b, c)</td>
              </tr>
            </tbody>
          </table>
</section>
</div>
</section>
</div>
<div id="specialty-content">
<section id="section-2.3">
        <h3 id="name-specialty-content-fields">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-specialty-content-fields" class="section-name selfRef">Specialty Content Fields</a>
        </h3>
<p id="section-2.3-1">Content not found in an HTTP header can be included in the signature base string by defining a content identifier and the canonicalization method for its content.<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<p id="section-2.3-2">To differentiate specialty content identifiers from HTTP headers, specialty content identifiers MUST start with the "at" <code>@</code> character. This specification defines the following specialty content identifiers:<a href="#section-2.3-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2.3-3">
          <dt id="section-2.3-3.1">
@request-target  </dt>
          <dd style="margin-left: 1.5em" id="section-2.3-3.2">
            <p id="section-2.3-3.2.1">The target request endpoint. (<a href="#content-request-target" class="xref">Section 2.3.1</a>)<a href="#section-2.3-3.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-3.3">
@signature-params  </dt>
          <dd style="margin-left: 1.5em" id="section-2.3-3.4">
            <p id="section-2.3-3.4.1">The signature metadata parameters for this signature. (<a href="#signature-params" class="xref">Section 2.3.2</a>)<a href="#section-2.3-3.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-2.3-4">Additional specialty content identifiers MAY be defined and registered in the HTTP Signatures Specialty Content Identifier Registry. (<a href="#content-registry" class="xref">Section 5.3</a>)<a href="#section-2.3-4" class="pilcrow">¶</a></p>
<div id="content-request-target">
<section id="section-2.3.1">
          <h4 id="name-request-target">
<a href="#section-2.3.1" class="section-number selfRef">2.3.1. </a><a href="#name-request-target" class="section-name selfRef">Request Target</a>
          </h4>
<p id="section-2.3.1-1">The request target endpoint, consisting of the request method and the path and query of the effective request URI, is identified by the <code>@request-target</code> identifier.<a href="#section-2.3.1-1" class="pilcrow">¶</a></p>
<p id="section-2.3.1-2">Its value is canonicalized as follows:<a href="#section-2.3.1-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.3.1-3">
<li id="section-2.3.1-3.1">Take the lowercased HTTP method of the message.<a href="#section-2.3.1-3.1" class="pilcrow">¶</a>
</li>
            <li id="section-2.3.1-3.2">Append a space " ".<a href="#section-2.3.1-3.2" class="pilcrow">¶</a>
</li>
            <li id="section-2.3.1-3.3">Append the path and query of the request target of the message, formatted according to the rules defined for the :path pseudo-header in <span>[<a href="#HTTP2" class="xref">HTTP2</a>]</span>, Section 8.1.2.3.  The resulting string is the canonicalized value.<a href="#section-2.3.1-3.3" class="pilcrow">¶</a>
</li>
          </ol>
<div id="canonicalization-examples-2">
<section id="section-2.3.1.1">
            <h5 id="name-canonicalization-examples-3">
<a href="#section-2.3.1.1" class="section-number selfRef">2.3.1.1. </a><a href="#name-canonicalization-examples-3" class="section-name selfRef">Canonicalization Examples</a>
            </h5>
<p id="section-2.3.1.1-1">The following table contains non-normative example HTTP messages and their canonicalized <code>@request-target</code> values.<a href="#section-2.3.1.1-1" class="pilcrow">¶</a></p>
<span id="name-non-normative-examples-of-r"></span><table class="center" id="table-3">
              <caption>
<a href="#table-3" class="selfRef">Table 3</a>:
<a href="#name-non-normative-examples-of-r" class="selfRef">Non-normative examples of     <code>@request-target</code>
 canonicalization.</a>
              </caption>
<thead>
                <tr>
                  <th class="text-left" rowspan="1" colspan="1">HTTP Message</th>
                  <th class="text-left" rowspan="1" colspan="1">@request-target</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">
                    <div id="section-2.3.1.1-2.2.1.1.1">
<pre class="sourcecode lang-http-message">
POST /?param=value HTTP/1.1
Host: www.example.com</pre><a href="#section-2.3.1.1-2.2.1.1.1" class="pilcrow">¶</a>
</div>
</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <code>post /?param=value</code>
                  </td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">
                    <div id="section-2.3.1.1-2.2.2.1.1">
<pre class="sourcecode lang-http-message">
POST /a/b HTTP/1.1
Host: www.example.com</pre><a href="#section-2.3.1.1-2.2.2.1.1" class="pilcrow">¶</a>
</div>
</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <code>post /a/b</code>
                  </td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">
                    <div id="section-2.3.1.1-2.2.3.1.1">
<pre class="sourcecode lang-http-message">
GET http://www.example.com/a/ HTTP/1.1</pre><a href="#section-2.3.1.1-2.2.3.1.1" class="pilcrow">¶</a>
</div>
</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <code>get /a/</code>
                  </td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">
                    <div id="section-2.3.1.1-2.2.4.1.1">
<pre class="sourcecode lang-http-message">
GET http://www.example.com HTTP/1.1</pre><a href="#section-2.3.1.1-2.2.4.1.1" class="pilcrow">¶</a>
</div>
</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <code>get /</code>
                  </td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">
                    <div id="section-2.3.1.1-2.2.5.1.1">
<pre class="sourcecode lang-http-message">
CONNECT server.example.com:80 HTTP/1.1
Host: server.example.com</pre><a href="#section-2.3.1.1-2.2.5.1.1" class="pilcrow">¶</a>
</div>
</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <code>connect /</code>
                  </td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">
                    <div id="section-2.3.1.1-2.2.6.1.1">
<pre class="sourcecode lang-http-message">
OPTIONS * HTTP/1.1
Host: server.example.com</pre><a href="#section-2.3.1.1-2.2.6.1.1" class="pilcrow">¶</a>
</div>
</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <code>options *</code>
                  </td>
                </tr>
              </tbody>
            </table>
</section>
</div>
</section>
</div>
<div id="signature-params">
<section id="section-2.3.2">
          <h4 id="name-signature-parameters">
<a href="#section-2.3.2" class="section-number selfRef">2.3.2. </a><a href="#name-signature-parameters" class="section-name selfRef">Signature Parameters</a>
          </h4>
<p id="section-2.3.2-1">HTTP Message Signatures have metadata properties that provide information regarding the signature's generation and/or verification.<a href="#section-2.3.2-1" class="pilcrow">¶</a></p>
<p id="section-2.3.2-2">The signature parameters specialty content is identified by the <code>@signature-params</code> identifier.<a href="#section-2.3.2-2" class="pilcrow">¶</a></p>
<p id="section-2.3.2-3">Its canonicalized value is the serialization of the signature parameters for this signature, including the covered content list with all associated parameters.<a href="#section-2.3.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.3.2-4.1">
              <code>alg</code>: The HTTP message signature algorithm from the HTTP Message Signature Algorithm Registry, as an <code>sf-string</code> value.<a href="#section-2.3.2-4.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-2.3.2-4.2">
              <code>keyid</code>: The identifier for the key material as an <code>sf-string</code> value.<a href="#section-2.3.2-4.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-2.3.2-4.3">
              <code>created</code>: Creation time as an <code>sf-integer</code> UNIX timestamp value. Sub-second precision is not supported.<a href="#section-2.3.2-4.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-2.3.2-4.4">
              <code>expires</code>: Expiration time as an <code>sf-integer</code> UNIX timestamp value. Sub-second precision is not supported.<a href="#section-2.3.2-4.4" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-2.3.2-4.5">
              <code>nonce</code>: A random unique value generated for this signature.<a href="#section-2.3.2-4.5" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-2.3.2-5">Additional parameters can be defined in the <span><a href="#iana-param-contents" class="xref">HTTP Signature Parameters Registry</a> (<a href="#iana-param-contents" class="xref">Section 5.2.2</a>)</span>.<a href="#section-2.3.2-5" class="pilcrow">¶</a></p>
<p id="section-2.3.2-6">The signature parameters are serialized using the rules in <span><a href="#RFC8941" class="xref">Section 4 of RFC8941</a> [<a href="#RFC8941" class="xref">RFC8941</a>]</span> as follows:<a href="#section-2.3.2-6" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.3.2-7">
<li id="section-2.3.2-7.1">Let the output be an empty string.<a href="#section-2.3.2-7.1" class="pilcrow">¶</a>
</li>
            <li id="section-2.3.2-7.2">Determine an order for the content identifiers of the covered content. Once this order is chosen, it cannot be changed.<a href="#section-2.3.2-7.2" class="pilcrow">¶</a>
</li>
            <li id="section-2.3.2-7.3">Serialize the content identifiers of the covered content, including all parameters, as an ordered <code>inner-list</code> according to <span><a href="#RFC8941" class="xref">Section 4.1.1.1 of RFC8941</a> [<a href="#RFC8941" class="xref">RFC8941</a>]</span> and append this to the output.<a href="#section-2.3.2-7.3" class="pilcrow">¶</a>
</li>
            <li id="section-2.3.2-7.4">Determine an order for any signature parameters. Once this order is chosen, it cannot be changed.<a href="#section-2.3.2-7.4" class="pilcrow">¶</a>
</li>
            <li id="section-2.3.2-7.5">Append the parameters to the <code>inner-list</code> in the chosen order according to <span><a href="#RFC8941" class="xref">Section 4.1.1.2 of RFC8941</a> [<a href="#RFC8941" class="xref">RFC8941</a>]</span>,
 skipping parameters that are not available or not used for this signature.<a href="#section-2.3.2-7.5" class="pilcrow">¶</a>
</li>
            <li id="section-2.3.2-7.6">The output contains the signature parameters value.<a href="#section-2.3.2-7.6" class="pilcrow">¶</a>
</li>
          </ol>
<p id="section-2.3.2-8">Note that the <code>inner-list</code> serialization is used for the covered content value instead of the <code>sf-list</code> serialization 
in order to facilitate this value's additional inclusion in the <code>Signature-Input</code> header's dictionary, 
as discussed in <a href="#signature-input-header" class="xref">Section 4.1</a>.<a href="#section-2.3.2-8" class="pilcrow">¶</a></p>
<p id="section-2.3.2-9">This example shows a canonicalized value for the parameters of a given signature:<a href="#section-2.3.2-9" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-2.3.2-10">
<pre>
("@request-target" "host" "date" "cache-control" "x-empty-header" \
  "x-example");keyid="test-key-rsa-pss";alg="rsa-pss-sha512";\
  created=1618884475;expires=1618884775
</pre><a href="#section-2.3.2-10" class="pilcrow">¶</a>
</div>
<p id="section-2.3.2-11">Note that an HTTP message could contain multiple signatures, but only the signature parameters used for the current signature are included in this field.<a href="#section-2.3.2-11" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="create-sig-input">
<section id="section-2.4">
        <h3 id="name-creating-the-signature-inpu">
<a href="#section-2.4" class="section-number selfRef">2.4. </a><a href="#name-creating-the-signature-inpu" class="section-name selfRef">Creating the Signature Input String</a>
        </h3>
<p id="section-2.4-1">The signature input is a US-ASCII string containing the content that is covered by the signature. To create the signature input string, the signer or verifier concatenates together entries for each identifier in the signature's covered content and parameters using the following algorithm:<a href="#section-2.4-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.4-2">
<li id="section-2.4-2.1">Let the output be an empty string.<a href="#section-2.4-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-2.4-2.2">
            <p id="section-2.4-2.2.1">For each covered content item in the covered content list (in order):<a href="#section-2.4-2.2.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.4-2.2.2">
<li id="section-2.4-2.2.2.1">Append the identifier for the covered content serialized according to the <code>content-identifier</code> rule.<a href="#section-2.4-2.2.2.1" class="pilcrow">¶</a>
</li>
              <li id="section-2.4-2.2.2.2">Append a single colon <code>":"</code><a href="#section-2.4-2.2.2.2" class="pilcrow">¶</a>
</li>
              <li id="section-2.4-2.2.2.3">Append a single space <code>" "</code><a href="#section-2.4-2.2.2.3" class="pilcrow">¶</a>
</li>
              <li id="section-2.4-2.2.2.4">Append the covered content's canonicalized value, as defined by the covered content type. (<a href="#http-header" class="xref">Section 2.1</a> and <a href="#specialty-content" class="xref">Section 2.3</a>)<a href="#section-2.4-2.2.2.4" class="pilcrow">¶</a>
</li>
              <li id="section-2.4-2.2.2.5">Append a single newline <code>"\\n"</code><a href="#section-2.4-2.2.2.5" class="pilcrow">¶</a>
</li>
            </ol>
</li>
          <li id="section-2.4-2.3">
            <p id="section-2.4-2.3.1">Append the signature parameters (<a href="#signature-params" class="xref">Section 2.3.2</a>) as follows:<a href="#section-2.4-2.3.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.4-2.3.2">
<li id="section-2.4-2.3.2.1">Append the identifier for the signature parameters serialized according to the <code>content-identifier</code> rule, <code>"@signature-params"</code><a href="#section-2.4-2.3.2.1" class="pilcrow">¶</a>
</li>
              <li id="section-2.4-2.3.2.2">Append a single colon <code>":"</code><a href="#section-2.4-2.3.2.2" class="pilcrow">¶</a>
</li>
              <li id="section-2.4-2.3.2.3">Append a single space <code>" "</code><a href="#section-2.4-2.3.2.3" class="pilcrow">¶</a>
</li>
              <li id="section-2.4-2.3.2.4">Append the signature parameters' canonicalized value as defined in <a href="#signature-params" class="xref">Section 2.3.2</a><a href="#section-2.4-2.3.2.4" class="pilcrow">¶</a>
</li>
            </ol>
</li>
          <li id="section-2.4-2.4">Return the output string.<a href="#section-2.4-2.4" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-2.4-3">If covered content references an identifier that cannot be resolved to a value in the message, the implementation MUST produce an error. Such situations are included but not limited to:<a href="#section-2.4-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.4-4.1">The signer or verifier does not understand the content identifier.<a href="#section-2.4-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.4-4.2">The identifier identifies a header field that is not present in the message or whose value is malformed.<a href="#section-2.4-4.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.4-4.3">The identifier is a Dictionary member identifier that references a header field that is not present in the message, is not a Dictionary Structured Field, or whose value is malformed.<a href="#section-2.4-4.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.4-4.4">The identifier is a Dictionary member identifier that references a member that is not present in the header field value, or whose value is malformed. E.g., the identifier is <code>"x-dictionary";key="c"</code> and the value of the <code>x-dictionary</code> header field is <code>a=1, b=2</code><a href="#section-2.4-4.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-2.4-5">In the following non-normative example, the HTTP message being signed is the following request:<a href="#section-2.4-5" class="pilcrow">¶</a></p>
<div id="section-2.4-6">
<pre class="sourcecode lang-http-message">
GET /foo HTTP/1.1
Host: example.org
Date: Tue, 20 Apr 2021 02:07:55 GMT
X-Example: Example header
        with some whitespace.
X-Empty-Header:
Cache-Control: max-age=60
Cache-Control: must-revalidate
</pre><a href="#section-2.4-6" class="pilcrow">¶</a>
</div>
<p id="section-2.4-7">The covered content consists of the <code>@request-target</code> specialty content followed by the <code>Host</code>, <code>Date</code>, <code>Cache-Control</code>, <code>X-Empty-Header</code>, <code>X-Example</code> HTTP headers, in order. The signature creation timestamp is <code>1618884475</code> and the key identifier is <code>test-key-rsa-pss</code>.  The signature input string for this message with these parameters is:<a href="#section-2.4-7" class="pilcrow">¶</a></p>
<span id="name-non-normative-example-signa"></span><div id="example-sig-input">
<figure id="figure-1">
          <div class="artwork art-text alignLeft" id="section-2.4-8.1">
<pre>
"@request-target": get /foo
"host": example.org
"date": Tue, 20 Apr 2021 02:07:55 GMT
"cache-control": max-age=60, must-revalidate
"x-empty-header":
"x-example": Example header with some whitespace.
"@signature-params": ("@request-target" "host" "date" "cache-control" \
  "x-empty-header" "x-example");created=1618884475;\
  keyid="test-key-rsa-pss"
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-non-normative-example-signa" class="selfRef">Non-normative example Signature Input</a>
          </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="message-signatures">
<section id="section-3">
      <h2 id="name-http-message-signatures">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-http-message-signatures" class="section-name selfRef">HTTP Message Signatures</a>
      </h2>
<p id="section-3-1">An HTTP Message Signature is a signature over a string generated from a subset of the content in an HTTP message and metadata about the signature itself.  When successfully verified against an HTTP message, it provides cryptographic proof that with respect to the subset of content that was signed, the message is semantically equivalent to the message for which the signature was generated.<a href="#section-3-1" class="pilcrow">¶</a></p>
<div id="sign">
<section id="section-3.1">
        <h3 id="name-creating-a-signature">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-creating-a-signature" class="section-name selfRef">Creating a Signature</a>
        </h3>
<p id="section-3.1-1">In order to create a signature, a signer MUST follow the following algorithm:<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.1-2">
<li id="section-3.1-2.1">The signer chooses an HTTP signature algorithm and key material for signing. The signer MUST choose key material that is appropriate 
 for the signature's algorithm, and that conforms to any requirements defined by the algorithm, such as key size or format. The 
 mechanism by which the signer chooses the algorithm and key material is out of scope for this document.<a href="#section-3.1-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-3.1-2.2">The signer sets the signature's creation time to the current time.<a href="#section-3.1-2.2" class="pilcrow">¶</a>
</li>
          <li id="section-3.1-2.3">If applicable, the signer sets the signature's expiration time property to the time at which the signature is to expire.<a href="#section-3.1-2.3" class="pilcrow">¶</a>
</li>
          <li id="section-3.1-2.4">
            <p id="section-3.1-2.4.1">The signer creates an ordered list of content identifiers representing the message content and signature metadata to be covered by the signature, and assigns this list as the signature's Covered Content.<a href="#section-3.1-2.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-2.4.2.1">Once an order of covered content is chosen, the order MUST NOT change for the life of the signature.<a href="#section-3.1-2.4.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.1-2.4.2.2">Each covered content identifier MUST either reference an HTTP header in the request message <a href="#http-header" class="xref">Section 2.1</a> or reference a specialty content field listed in <a href="#specialty-content" class="xref">Section 2.3</a> or its associated registry.<a href="#section-3.1-2.4.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.1-2.4.2.3">Signers SHOULD include <code>@request-target</code> in the covered content list.<a href="#section-3.1-2.4.2.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.1-2.4.2.4">Signers SHOULD include a date stamp in some form, such as using the <code>date</code> header. Alternatively, the <code>created</code> signature metadata parameter can fulfil this role.<a href="#section-3.1-2.4.2.4" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.1-2.4.2.5">Further guidance on what to include in this list and in what order is out of scope for this document. However, note that the list order is significant and once established for a given signature it MUST be preserved for that signature.<a href="#section-3.1-2.4.2.5" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.1-2.4.2.6">Note that the <code>@signature-params</code> specialty identifier is not explicitly listed in the list of covered content identifiers, because it is required to always be present as the last line in the signature input. This ensures that a signature always covers its own metadata.<a href="#section-3.1-2.4.2.6" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li id="section-3.1-2.5">The signer creates the signature input string. (<a href="#create-sig-input" class="xref">Section 2.4</a>)<a href="#section-3.1-2.5" class="pilcrow">¶</a>
</li>
          <li id="section-3.1-2.6">The signer signs the signature input with the chosen signing algorithm using the key material chosen by the signer. Several signing algorithms are defined in in <a href="#signature-methods" class="xref">Section 3.3</a>.<a href="#section-3.1-2.6" class="pilcrow">¶</a>
</li>
          <li id="section-3.1-2.7">The byte array output of the signature function is the HTTP message signature output value to be included in the <code>Signature</code> header as defined in <a href="#signature-header" class="xref">Section 4.2</a>.<a href="#section-3.1-2.7" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-3.1-3">For example, given the HTTP message and signature parameters in the example in <a href="#create-sig-input" class="xref">Section 2.4</a>, the example signature input string when signed with the <code>test-key-rsa-pss</code> key in <a href="#example-key-rsa-pss-test" class="xref">Appendix B.1.2</a> gives the following message signature output value, encoded in Base64:<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<span id="name-non-normative-example-signat"></span><div id="example-sig-value">
<figure id="figure-2">
          <div class="artwork art-text alignLeft" id="section-3.1-4.1">
<pre>
lPxkxqDEPhgrx1yPaKLO7eJ+oPjSwsQ5NjWNRfYP7Jw0FwnK1k8/GH7g5s2q0VTTKVm\
xyfpUDp/HsDphh5Z7Fa/lvtujHyFe/0EP9z7bnVb7YBZrxV52LGvP8p4APhOYuG4yaH\
z478GsJav9BQYK0B2IOHdLFJe8qwWPJs07J47gPewpNwCt0To/zZ2KPpylGX5UHVgJP\
Uom64KjX43u2OwIvSoPEYk4nuBvLR9yxYAHURaTfLoEDUCtY1FsU1hOfG3jAlcT6ill\
fnyS72PEdSSzw1KsxroMj9IYpFhva77YxmJRk4pCIW0F0Kj0ukl7J4y2aZJHMCYI3g8\
yfqh/wQ==
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-non-normative-example-signat" class="selfRef">Non-normative example signature value</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="verify">
<section id="section-3.2">
        <h3 id="name-verifying-a-signature">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-verifying-a-signature" class="section-name selfRef">Verifying a Signature</a>
        </h3>
<p id="section-3.2-1">A verifier processes a signature and its associated signature input parameters in concert with each other.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">In order to verify a signature, a verifier MUST follow the following algorithm:<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.2-3">
<li id="section-3.2-3.1">
            <p id="section-3.2-3.1.1">Parse the <code>Signature</code> and <code>Signature-Input</code> headers and extract the signatures to be verified.<a href="#section-3.2-3.1.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.2-3.1.2">
<li id="section-3.2-3.1.2.1">If there is more than one signature value present, determine which signature should be processed
 for this request. If an appropriate signature is not found, produce an error.<a href="#section-3.2-3.1.2.1" class="pilcrow">¶</a>
</li>
              <li id="section-3.2-3.1.2.2">If the chosen <code>Signature</code> value does not have a corresponding <code>Signature-Input</code> value,
 produce an error.<a href="#section-3.2-3.1.2.2" class="pilcrow">¶</a>
</li>
            </ol>
</li>
          <li id="section-3.2-3.2">Parse the values of the chosen <code>Signature-Input</code> header field to get the parameters for the
 signature to be verified.<a href="#section-3.2-3.2" class="pilcrow">¶</a>
</li>
          <li id="section-3.2-3.3">Parse the value of the corresponding <code>Signature</code> header field to get the byte array value of the signature
 to be verified.<a href="#section-3.2-3.3" class="pilcrow">¶</a>
</li>
          <li id="section-3.2-3.4">Examine the signature parameters to confirm that the signature meets the requirements described 
 in this document, as well as any additional requirements defined by the application such as which 
 contents are required to be covered by the signature. (<a href="#verify-requirements" class="xref">Section 3.2.1</a>)<a href="#section-3.2-3.4" class="pilcrow">¶</a>
</li>
          <li id="section-3.2-3.5">Determine the verification key material for this signature. If the key material is known through external
 means such as static configuration or external protocol negotiation, the verifier will use that. If the key is
 identified in the signature parameters, the verifier will dereference this to appropriate key material to use 
 with the signature. The verifier has to determine the trustworthiness of the key material for the context
 in which the signature is presented. If a key is identified that the verifier does not know, does
 not trust for this request, or does not match something preconfigured, the verification MUST fail.<a href="#section-3.2-3.5" class="pilcrow">¶</a>
</li>
          <li id="section-3.2-3.6">
            <p id="section-3.2-3.6.1">Determine the algorithm to apply for verification:<a href="#section-3.2-3.6.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.2-3.6.2">
<li id="section-3.2-3.6.2.1">If the algorithm is known through external means such as static configuration or external protocol
 negotiation, the verifier will use this algorithm.<a href="#section-3.2-3.6.2.1" class="pilcrow">¶</a>
</li>
              <li id="section-3.2-3.6.2.2">If the algorithm is explicitly stated in the signature parameters using a value from the
 HTTP Message Signatures registry, the verifier will use the referenced algorithm.<a href="#section-3.2-3.6.2.2" class="pilcrow">¶</a>
</li>
              <li id="section-3.2-3.6.2.3">If the algorithm can be determined from the keying material, such as through an algorithm field
 on the key value itself, the verifier will use this algorithm.<a href="#section-3.2-3.6.2.3" class="pilcrow">¶</a>
</li>
              <li id="section-3.2-3.6.2.4">If the algorithm is specified in more that one location, such as through static configuration
 and the algorithm signature parameter, or the algorithm signature parameter and from
 the key material itself, the resolved algorithms MUST be the same. If the algorithms are
 not the same, the verifier MUST vail the verification.<a href="#section-3.2-3.6.2.4" class="pilcrow">¶</a>
</li>
            </ol>
</li>
          <li id="section-3.2-3.7">Use the received HTTP message and the signature's metadata to recreate the signature input, using 
 the process described in <a href="#create-sig-input" class="xref">Section 2.4</a>. The value of the <code>@signature-params</code> input is
 the value of the SignatureInput header field for this signature serialized according to the rules described
 in <a href="#signature-params" class="xref">Section 2.3.2</a>, not including the signature's label from the <code>Signature-Input</code> header.<a href="#section-3.2-3.7" class="pilcrow">¶</a>
</li>
          <li id="section-3.2-3.8">If the key material is appropriate for the algorithm, apply the verification algorithm to the signature,
 recalculated signature input, signature parameters, key material, and algorithm. Several algorithms are defined in
 <a href="#signature-methods" class="xref">Section 3.3</a>.<a href="#section-3.2-3.8" class="pilcrow">¶</a>
</li>
          <li id="section-3.2-3.9">The results of the verification algorithm function are the final results of the signature verification.<a href="#section-3.2-3.9" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-3.2-4">If any of the above steps fail, the signature validation fails.<a href="#section-3.2-4" class="pilcrow">¶</a></p>
<div id="verify-requirements">
<section id="section-3.2.1">
          <h4 id="name-enforcing-application-requi">
<a href="#section-3.2.1" class="section-number selfRef">3.2.1. </a><a href="#name-enforcing-application-requi" class="section-name selfRef">Enforcing Application Requirements</a>
          </h4>
<p id="section-3.2.1-1">The verification requirements specified in this document are intended as a baseline set of restrictions that are generally applicable to all use cases.  Applications using HTTP Message Signatures MAY impose requirements above and beyond those specified by this document, as appropriate for their use case.<a href="#section-3.2.1-1" class="pilcrow">¶</a></p>
<p id="section-3.2.1-2">Some non-normative examples of additional requirements an application might define are:<a href="#section-3.2.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.1-3.1">Requiring a specific set of header fields to be signed (e.g., Authorization, Digest).<a href="#section-3.2.1-3.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.2.1-3.2">Enforcing a maximum signature age.<a href="#section-3.2.1-3.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.2.1-3.3">Prohibiting the use of certain algorithms, or mandating the use of an algorithm.<a href="#section-3.2.1-3.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.2.1-3.4">Requiring keys to be of a certain size (e.g., 2048 bits vs. 1024 bits).<a href="#section-3.2.1-3.4" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.2.1-3.5">Enforcing uniqueness of a nonce value.<a href="#section-3.2.1-3.5" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-3.2.1-4">Application-specific requirements are expected and encouraged.  When an application defines additional requirements, it MUST enforce them during the signature verification process, and signature verification MUST fail if the signature does not conform to the application's requirements.<a href="#section-3.2.1-4" class="pilcrow">¶</a></p>
<p id="section-3.2.1-5">Applications MUST enforce the requirements defined in this document.  Regardless of use case, applications MUST NOT accept signatures that do not conform to these requirements.<a href="#section-3.2.1-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="signature-methods">
<section id="section-3.3">
        <h3 id="name-signature-algorithm-methods">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-signature-algorithm-methods" class="section-name selfRef">Signature Algorithm Methods</a>
        </h3>
<p id="section-3.3-1">HTTP Message signatures MAY use any cryptographic digital signature or MAC method that is appropriate for the key material,
environment, and needs of the signer and verifier.
All signatures are generated from and verified against the byte values of the signature input string defined in <a href="#create-sig-input" class="xref">Section 2.4</a>.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2">Each signature algorithm method takes as its input the signature input string as a set of byte values (<code>I</code>), the signing key material
(<code>Ks</code>), and outputs the signed content as a set of byte values (<code>S</code>):<a href="#section-3.3-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.3-3">
<pre>
HTTP_SIGN (I, Ks)  -&gt;  S
</pre><a href="#section-3.3-3" class="pilcrow">¶</a>
</div>
<p id="section-3.3-4">Each verification algorithm method takes as its input the recalculated signature input string as a set of byte values (<code>I</code>), the verification key
material (<code>Kv</code>), and the presented signature to be verified as a set of byte values (<code>S</code>) and outputs the verification result (<code>V</code>) as a boolean:<a href="#section-3.3-4" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.3-5">
<pre>
HTTP_VERIFY (I, Kv, S) -&gt; V
</pre><a href="#section-3.3-5" class="pilcrow">¶</a>
</div>
<p id="section-3.3-6">This section contains several common algorithm methods. The method to use can be communicated through the algorithm signature parameter
defined in <a href="#signature-params" class="xref">Section 2.3.2</a>, by reference to the key material, or through mutual agreement between the signer and verifier.<a href="#section-3.3-6" class="pilcrow">¶</a></p>
<div id="method-rsa-pss-sha512">
<section id="section-3.3.1">
          <h4 id="name-rsassa-pss-using-sha-512">
<a href="#section-3.3.1" class="section-number selfRef">3.3.1. </a><a href="#name-rsassa-pss-using-sha-512" class="section-name selfRef">RSASSA-PSS using SHA-512</a>
          </h4>
<p id="section-3.3.1-1">To sign using this algorithm, the signer applies the <code>RSASSA-PSS-SIGN (K, M)</code> function <span>[<a href="#RFC8017" class="xref">RFC8017</a>]</span> with the signer's private signing key (<code>K</code>) and
the signature input string (<code>M</code>) (<a href="#create-sig-input" class="xref">Section 2.4</a>). 
The mask generation function is <code>MGF1</code> as specified in <span>[<a href="#RFC8017" class="xref">RFC8017</a>]</span> with a hash function of SHA-512 <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span>.
The salt length (<code>sLen</code>) is 64 bytes.
The hash function (<code>Hash</code>) SHA-512 <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span> is applied to the signature input string to create
the digest content to which the digital signature is applied. 
The resulting signed content byte array (<code>S</code>) is the HTTP message signature output used in <a href="#sign" class="xref">Section 3.1</a>.<a href="#section-3.3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.3.1-2">To verify using this algorithm, the verifier applies the <code>RSASSA-PSS-VERIFY ((n, e), M, S)</code> function <span>[<a href="#RFC8017" class="xref">RFC8017</a>]</span> using the public key portion of the verification key material (<code>(n, e)</code>) and the signature input string (<code>M</code>) re-created as described in <a href="#verify" class="xref">Section 3.2</a>.
The mask generation function is <code>MGF1</code> as specified in <span>[<a href="#RFC8017" class="xref">RFC8017</a>]</span> with a hash function of SHA-512 <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span>.
The salt length (<code>sLen</code>) is 64 bytes.
The hash function (<code>Hash</code>) SHA-512 <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span> is applied to the signature input string to create the digest content to which the verification function is applied. 
The verifier extracts the HTTP message signature to be verified (<code>S</code>) as described in <a href="#verify" class="xref">Section 3.2</a>.
The results of the verification function are compared to the http message signature to determine if the signature presented is valid.<a href="#section-3.3.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="method-rsa-v1_5-sha256">
<section id="section-3.3.2">
          <h4 id="name-rsassa-pkcs1-v1_5-using-sha">
<a href="#section-3.3.2" class="section-number selfRef">3.3.2. </a><a href="#name-rsassa-pkcs1-v1_5-using-sha" class="section-name selfRef">RSASSA-PKCS1-v1_5 using SHA-256</a>
          </h4>
<p id="section-3.3.2-1">To sign using this algorithm, the signer applies the <code>RSASSA-PKCS1-V1_5-SIGN (K, M)</code> function <span>[<a href="#RFC8017" class="xref">RFC8017</a>]</span> with the signer's private signing key (<code>K</code>) and
the signature input string (<code>M</code>) (<a href="#create-sig-input" class="xref">Section 2.4</a>). 
The hash SHA-256 <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span> is applied to the signature input string to create
the digest content to which the digital signature is applied. 
The resulting signed content byte array (<code>S</code>) is the HTTP message signature output used in <a href="#sign" class="xref">Section 3.1</a>.<a href="#section-3.3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.3.2-2">To verify using this algorithm, the verifier applies the <code>RSASSA-PKCS1-V1_5-VERIFY ((n, e), M, S)</code> function <span>[<a href="#RFC8017" class="xref">RFC8017</a>]</span> using the public key portion of the verification key material (<code>(n, e)</code>) and the signature input string (<code>M</code>) re-created as described in <a href="#verify" class="xref">Section 3.2</a>.
The hash function SHA-256 <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span> is applied to the signature input string to create the digest content to which the verification function is applied. 
The verifier extracts the HTTP message signature to be verified (<code>S</code>) as described in <a href="#verify" class="xref">Section 3.2</a>.
The results of the verification function are compared to the http message signature to determine if the signature presented is valid.<a href="#section-3.3.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="method-hmac-sha256">
<section id="section-3.3.3">
          <h4 id="name-hmac-using-sha-256">
<a href="#section-3.3.3" class="section-number selfRef">3.3.3. </a><a href="#name-hmac-using-sha-256" class="section-name selfRef">HMAC using SHA-256</a>
          </h4>
<p id="section-3.3.3-1">To sign and verify using this algorithm, the signer applies the <code>HMAC</code> function <span>[<a href="#RFC2104" class="xref">RFC2104</a>]</span> with the shared signing key (<code>K</code>) and
the signature input string (<code>text</code>) (<a href="#create-sig-input" class="xref">Section 2.4</a>). 
The hash function SHA-256 <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span> is applied to the signature input string to create the digest content to which the HMAC is applied, giving the signature result.<a href="#section-3.3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3.3-2">For signing, the resulting value is the HTTP message signature output used in <a href="#sign" class="xref">Section 3.1</a>.<a href="#section-3.3.3-2" class="pilcrow">¶</a></p>
<p id="section-3.3.3-3">For verification, the verifier extracts the HTTP message signature to be verified (<code>S</code>) as described in <a href="#verify" class="xref">Section 3.2</a>.
The output of the HMAC function is compared to the value of the HTTP message signature, and the results of the comparison determine the validity of the signature presented.<a href="#section-3.3.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="method-ecdsa-p256-sha256">
<section id="section-3.3.4">
          <h4 id="name-ecdsa-using-curve-p-256-dss">
<a href="#section-3.3.4" class="section-number selfRef">3.3.4. </a><a href="#name-ecdsa-using-curve-p-256-dss" class="section-name selfRef">ECDSA using curve P-256 DSS and SHA-256</a>
          </h4>
<p id="section-3.3.4-1">To sign using this algorithm, the signer applies the <code>ECDSA</code> algorithm <span>[<a href="#FIPS186-4" class="xref">FIPS186-4</a>]</span> using curve P-256 with the signer's private signing key and
the signature input string (<a href="#create-sig-input" class="xref">Section 2.4</a>). 
The hash SHA-256 <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span> is applied to the signature input string to create
the digest content to which the digital signature is applied. 
The resulting signed content byte array is the HTTP message signature output used in <a href="#sign" class="xref">Section 3.1</a>.<a href="#section-3.3.4-1" class="pilcrow">¶</a></p>
<p id="section-3.3.4-2">To verify using this algorithm, the verifier applies the <code>ECDSA</code> algorithm <span>[<a href="#FIPS186-4" class="xref">FIPS186-4</a>]</span>  using the public key portion of the verification key material and the signature input string re-created as described in <a href="#verify" class="xref">Section 3.2</a>.
The hash function SHA-256 <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span> is applied to the signature input string to create the digest content to which the verification function is applied. 
The verifier extracts the HTTP message signature to be verified (<code>S</code>) as described in <a href="#verify" class="xref">Section 3.2</a>.
The results of the verification function are compared to the http message signature to determine if the signature presented is valid.<a href="#section-3.3.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="method-jose">
<section id="section-3.3.5">
          <h4 id="name-json-web-signature-jws-algo">
<a href="#section-3.3.5" class="section-number selfRef">3.3.5. </a><a href="#name-json-web-signature-jws-algo" class="section-name selfRef">JSON Web Signature (JWS) algorithms</a>
          </h4>
<p id="section-3.3.5-1">If the signing algorithm is a JOSE signing algorithm from the JSON Web Signature and Encryption Algorithms Registry established by <span>[<a href="#RFC7518" class="xref">RFC7518</a>]</span>, the 
JWS algorithm definition determines the signature and hashing algorithms to apply for both signing and verification. There is no
use of the explicit <code>alg</code> signature parameter when using JOSE signing algorithms.<a href="#section-3.3.5-1" class="pilcrow">¶</a></p>
<p id="section-3.3.5-2">For both signing and verification, the HTTP messages signature input string (<a href="#create-sig-input" class="xref">Section 2.4</a>) is used as the entire "JWS Signing Input". 
The JOSE Header defined in <span>[<a href="#RFC7517" class="xref">RFC7517</a>]</span> is not used, and the signature input string is not first encoded in Base64 before applying the algorithm. 
The output of the JWS signature is taken as a byte array prior to the Base64url encoding used in JOSE.<a href="#section-3.3.5-2" class="pilcrow">¶</a></p>
<p id="section-3.3.5-3">The JWS algorithm MUST NOT be <code>none</code> and MUST NOT be any algorithm with a JOSE Implementation Requirement of <code>Prohibited</code>.<a href="#section-3.3.5-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="including-a-message-signature-in-a-message">
<section id="section-4">
      <h2 id="name-including-a-message-signatu">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-including-a-message-signatu" class="section-name selfRef">Including a Message Signature in a Message</a>
      </h2>
<p id="section-4-1">Message signatures can be included within an HTTP message via the <code>Signature-Input</code> and <code>Signature</code> HTTP header fields, both defined within this specification.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">An HTTP message signature MUST use both headers:
the <code>Signature</code> HTTP header field contains the signature value, while the <code>Signature-Input</code> HTTP header field identifies the covered content and parameters that describe how the signature was generated. Each header MAY contain multiple labeled values, where the labels determine the correlation between the <code>Signature</code> and <code>Signature-Input</code> fields.<a href="#section-4-2" class="pilcrow">¶</a></p>
<div id="signature-input-header">
<section id="section-4.1">
        <h3 id="name-the-signature-input-http-he">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-the-signature-input-http-he" class="section-name selfRef">The 'Signature-Input' HTTP Header</a>
        </h3>
<p id="section-4.1-1">The <code>Signature-Input</code> HTTP header field is a Dictionary Structured Header <span>[<a href="#RFC8941" class="xref">RFC8941</a>]</span> containing the metadata for one or more message signatures generated from content within the HTTP message. Each member describes a single message signature. The member's name is an identifier that uniquely identifies the message signature within the context of the HTTP message. The member's value is the serialization of the covered content including all signature metadata parameters, using the serialization process defined in <a href="#signature-params" class="xref">Section 2.3.2</a>.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.1-2">
<pre>
Signature-Input: sig1=("@request-target" "host" "date" \
  "cache-control" "x-empty-header" "x-example");created=1618884475\
  ;keyid="test-key-rsa-pss"
</pre><a href="#section-4.1-2" class="pilcrow">¶</a>
</div>
<p id="section-4.1-3">To facilitate signature validation, the <code>Signature-Input</code> header value MUST contain the same serialized value used 
in generating the signature input string's <code>@signature-params</code> value.<a href="#section-4.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="signature-header">
<section id="section-4.2">
        <h3 id="name-the-signature-http-header">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-the-signature-http-header" class="section-name selfRef">The 'Signature' HTTP Header</a>
        </h3>
<p id="section-4.2-1">The <code>Signature</code> HTTP header field is a Dictionary Structured Header <span>[<a href="#RFC8941" class="xref">RFC8941</a>]</span> containing one or more message signatures generated from content within the HTTP message. Each member's name is a signature identifier that is present as a member name in the <code>Signature-Input</code> Structured Header within the HTTP message. Each member's value is a Byte Sequence containing the signature value for the message signature identified by the member name. Any member in the <code>Signature</code> HTTP header field that does not have a corresponding member in the HTTP message's <code>Signature-Input</code> HTTP header field MUST be ignored.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.2-2">
<pre>
Signature: sig1=:lPxkxqDEPhgrx1yPaKLO7eJ+oPjSwsQ5NjWNRfYP7Jw0FwnK1k\
  8/GH7g5s2q0VTTKVmxyfpUDp/HsDphh5Z7Fa/lvtujHyFe/0EP9z7bnVb7YBZrxV5\
  2LGvP8p4APhOYuG4yaHz478GsJav9BQYK0B2IOHdLFJe8qwWPJs07J47gPewpNwCt\
  0To/zZ2KPpylGX5UHVgJPUom64KjX43u2OwIvSoPEYk4nuBvLR9yxYAHURaTfLoED\
  UCtY1FsU1hOfG3jAlcT6illfnyS72PEdSSzw1KsxroMj9IYpFhva77YxmJRk4pCIW\
  0F0Kj0ukl7J4y2aZJHMCYI3g8yfqh/wQ==:
</pre><a href="#section-4.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="multiple-signatures">
<section id="section-4.3">
        <h3 id="name-multiple-signatures">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-multiple-signatures" class="section-name selfRef">Multiple Signatures</a>
        </h3>
<p id="section-4.3-1">Since <code>Signature-Input</code> and <code>Signature</code> are both defined as Dictionary Structured Headers, they can be used to include multiple signatures within the same HTTP message. For example, a signer may include multiple signatures signing the same content with different keys or algorithms to support verifiers with different capabilities, or a reverse proxy may include information about the client in header fields when forwarding the request to a service host, including a signature over those fields and the client's original signature.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">The following is a non-normative example of header fields a reverse proxy sets in addition to the examples in the previous sections. The original signature is included under the identifier <code>sig1</code>, and the reverse proxy's signature is included under <code>proxy_sig</code>. The proxy uses the key <code>rsa-test-key</code> to create its signature using the <code>rsa-v1_5-sha256</code> signature value. This results in a signature input string of:<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.3-3">
<pre>
"signature";key="sig1": \
  :lPxkxqDEPhgrx1yPaKLO7eJ+oPjSwsQ5NjWNRfYP7Jw0FwnK1k8/GH7g5s2q0VTT\
  KVmxyfpUDp/HsDphh5Z7Fa/lvtujHyFe/0EP9z7bnVb7YBZrxV52LGvP8p4APhOYu\
  G4yaHz478GsJav9BQYK0B2IOHdLFJe8qwWPJs07J47gPewpNwCt0To/zZ2KPpylGX\
  5UHVgJPUom64KjX43u2OwIvSoPEYk4nuBvLR9yxYAHURaTfLoEDUCtY1FsU1hOfG3\
  jAlcT6illfnyS72PEdSSzw1KsxroMj9IYpFhva77YxmJRk4pCIW0F0Kj0ukl7J4y2\
  aZJHMCYI3g8yfqh/wQ==:
"x-forwarded-for": 192.0.2.123
"@signature-params": ("signature";key="sig1" "x-forwarded-for")\
  ;created=1618884480;keyid="test-key-rsa";alg="rsa-v1_5-sha256"
</pre><a href="#section-4.3-3" class="pilcrow">¶</a>
</div>
<p id="section-4.3-4">And a signature output value of:<a href="#section-4.3-4" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.3-5">
<pre>
XD1O/vEh772WVpY7jYvReXop2+b7xTIIPKH8/OCYzPn78Wd9jodCwAJPF5TYCn9L6n6\
8j4EjGsqFOMkVLVdSQEZqMLjEbvMEdIe8m1a0CLd5kydeaAwoHoglqod6ijkwhhEtxt\
aD8tDZmihQw2mZEH8u4aMSnRntqy7ExCNld0JLharsHV0iCbRO9jIP+d2ApD7gB+eZp\
n3pIvvVJZlxTwPkahFpxKlQtNMPaSqa1lvejURx+ST8CEuz4sS+G/oLJiX3MZenuUoO\
R8HeOHDnjN/VLzrEN4x44iF7WIL+iY2PtK87LUWRAsJAX9GqHL/upsGh1nxIdoVaoLV\
V5w+fRw==
</pre><a href="#section-4.3-5" class="pilcrow">¶</a>
</div>
<p id="section-4.3-6">These values are added to the HTTP request message by the proxy. The different signature values are wrapped onto separate lines to increase human-readability of the result.<a href="#section-4.3-6" class="pilcrow">¶</a></p>
<div id="section-4.3-7">
<pre class="sourcecode lang-http-message">
X-Forwarded-For: 192.0.2.123
Signature-Input: sig1=("@request-target" "host" "date" \
    "cache-control" "x-empty-header" "x-example")\
    ;created=1618884475;keyid="test-key-rsa-pss", \
  proxy_sig=("signature";key="sig1" "x-forwarded-for")\
    ;created=1618884480;keyid="test-key-rsa";alg="rsa-v1_5-sha256"
Signature: sig1=:lPxkxqDEPhgrx1yPaKLO7eJ+oPjSwsQ5NjWNRfYP7Jw0FwnK1k\
    8/GH7g5s2q0VTTKVmxyfpUDp/HsDphh5Z7Fa/lvtujHyFe/0EP9z7bnVb7YBZrx\
    V52LGvP8p4APhOYuG4yaHz478GsJav9BQYK0B2IOHdLFJe8qwWPJs07J47gPewp\
    NwCt0To/zZ2KPpylGX5UHVgJPUom64KjX43u2OwIvSoPEYk4nuBvLR9yxYAHURa\
    TfLoEDUCtY1FsU1hOfG3jAlcT6illfnyS72PEdSSzw1KsxroMj9IYpFhva77Yxm\
    JRk4pCIW0F0Kj0ukl7J4y2aZJHMCYI3g8yfqh/wQ==:, \
  proxy_sig=:XD1O/vEh772WVpY7jYvReXop2+b7xTIIPKH8/OCYzPn78Wd9jodCwA\
    JPF5TYCn9L6n68j4EjGsqFOMkVLVdSQEZqMLjEbvMEdIe8m1a0CLd5kydeaAwoH\
    oglqod6ijkwhhEtxtaD8tDZmihQw2mZEH8u4aMSnRntqy7ExCNld0JLharsHV0i\
    CbRO9jIP+d2ApD7gB+eZpn3pIvvVJZlxTwPkahFpxKlQtNMPaSqa1lvejURx+ST\
    8CEuz4sS+G/oLJiX3MZenuUoOR8HeOHDnjN/VLzrEN4x44iF7WIL+iY2PtK87LU\
    WRAsJAX9GqHL/upsGh1nxIdoVaoLVV5w+fRw==:
</pre><a href="#section-4.3-7" class="pilcrow">¶</a>
</div>
<p id="section-4.3-8">The proxy's signature and the client's original signature can be verified independently for the same message, depending on the needs of the application.<a href="#section-4.3-8" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana">
<section id="section-5">
      <h2 id="name-iana-considerations">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<div id="hsa-registry">
<section id="section-5.1">
        <h3 id="name-http-signature-algorithms-r">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-http-signature-algorithms-r" class="section-name selfRef">HTTP Signature Algorithms Registry</a>
        </h3>
<p id="section-5.1-1">This document defines HTTP Signature Algorithms, for which IANA is asked to create and maintain a new registry titled "HTTP Signature Algorithms".  Initial values for this registry are given in <a href="#iana-hsa-contents" class="xref">Section 5.1.2</a>.  Future assignments and modifications to existing assignment are to be made through the Expert Review registration policy <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span> and shall follow the template presented in <a href="#iana-hsa-template" class="xref">Section 5.1.1</a>.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">Algorithms referenced by algorithm identifiers have to be fully defined with all parameters fixed. Algorithm identifiers in this registry are to be interpreted as whole string values and not as a combination of parts. That is to say, it is expected that implementors understand <code>rsa-pss-sha512</code> as referring to one specific algorithm with its hash, mask, and salt values set as defined here. Implementors do not parse out the <code>rsa</code>, <code>pss</code>, and <code>sha512</code> portions of the identifier to determine parameters of the signing algorithm from the string.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<div id="iana-hsa-template">
<section id="section-5.1.1">
          <h4 id="name-registration-template">
<a href="#section-5.1.1" class="section-number selfRef">5.1.1. </a><a href="#name-registration-template" class="section-name selfRef">Registration Template</a>
          </h4>
<span class="break"></span><dl class="dlNewline" id="section-5.1.1-1">
            <dt id="section-5.1.1-1.1">
Algorithm Name:  </dt>
            <dd style="margin-left: 1.5em" id="section-5.1.1-1.2">
              <p id="section-5.1.1-1.2.1">An identifier for the HTTP Signature Algorithm. The name MUST be an ASCII string consisting only of lower-case characters (<code>"a"</code> - <code>"z"</code>), digits (<code>"0"</code> - <code>"9"</code>), and hyphens (<code>"-"</code>), and SHOULD NOT exceed 20 characters in length.  The identifier MUST be unique within the context of the registry.<a href="#section-5.1.1-1.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-5.1.1-1.3">
Status:  </dt>
            <dd style="margin-left: 1.5em" id="section-5.1.1-1.4">
              <p id="section-5.1.1-1.4.1">A brief text description of the status of the algorithm.  The description MUST begin with one of "Active" or "Deprecated", and MAY provide further context or explanation as to the reason for the status.<a href="#section-5.1.1-1.4.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-5.1.1-1.5">
Description:  </dt>
            <dd style="margin-left: 1.5em" id="section-5.1.1-1.6">
              <p id="section-5.1.1-1.6.1">A brief description of the algorithm used to sign the signature input string.<a href="#section-5.1.1-1.6.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-5.1.1-1.7">
Specification document(s):  </dt>
            <dd style="margin-left: 1.5em" id="section-5.1.1-1.8">
              <p id="section-5.1.1-1.8.1">Reference to the document(s) that specify the token endpoint
  authorization method, preferably including a URI that can be used
  to retrieve a copy of the document(s).  An indication of the
  relevant sections may also be included but is not required.<a href="#section-5.1.1-1.8.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="iana-hsa-contents">
<section id="section-5.1.2">
          <h4 id="name-initial-contents">
<a href="#section-5.1.2" class="section-number selfRef">5.1.2. </a><a href="#name-initial-contents" class="section-name selfRef">Initial Contents</a>
          </h4>
<div id="rsa-pss-sha512">
<section id="section-5.1.2.1">
            <h5 id="name-rsa-pss-sha512">
<a href="#section-5.1.2.1" class="section-number selfRef">5.1.2.1. </a><a href="#name-rsa-pss-sha512" class="section-name selfRef">rsa-pss-sha512</a>
            </h5>
<span class="break"></span><dl class="dlNewline" id="section-5.1.2.1-1">
              <dt id="section-5.1.2.1-1.1">
Algorithm Name:  </dt>
              <dd style="margin-left: 1.5em" id="section-5.1.2.1-1.2">
                <p id="section-5.1.2.1-1.2.1"><code>rsa-pss-sha512</code><a href="#section-5.1.2.1-1.2.1" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
<dt id="section-5.1.2.1-1.3">
Status:  </dt>
              <dd style="margin-left: 1.5em" id="section-5.1.2.1-1.4">
                <p id="section-5.1.2.1-1.4.1">Active<a href="#section-5.1.2.1-1.4.1" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
<dt id="section-5.1.2.1-1.5">
Definition:  </dt>
              <dd style="margin-left: 1.5em" id="section-5.1.2.1-1.6">
                <p id="section-5.1.2.1-1.6.1">RSASSA-PSS using SHA-256<a href="#section-5.1.2.1-1.6.1" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
<dt id="section-5.1.2.1-1.7">
Specification document(s):  </dt>
              <dd style="margin-left: 1.5em" id="section-5.1.2.1-1.8">
                <p id="section-5.1.2.1-1.8.1">[[This document]], <a href="#method-rsa-pss-sha512" class="xref">Section 3.3.1</a><a href="#section-5.1.2.1-1.8.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
</dl>
</section>
</div>
<div id="rsa-v15-sha256">
<section id="section-5.1.2.2">
            <h5 id="name-rsa-v1_5-sha256">
<a href="#section-5.1.2.2" class="section-number selfRef">5.1.2.2. </a><a href="#name-rsa-v1_5-sha256" class="section-name selfRef">rsa-v1_5-sha256</a>
            </h5>
<span class="break"></span><dl class="dlNewline" id="section-5.1.2.2-1">
              <dt id="section-5.1.2.2-1.1">
Algorithm Name:  </dt>
              <dd style="margin-left: 1.5em" id="section-5.1.2.2-1.2">
                <p id="section-5.1.2.2-1.2.1"><code>rsa-v1_5-sha256</code><a href="#section-5.1.2.2-1.2.1" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
<dt id="section-5.1.2.2-1.3">
Status:  </dt>
              <dd style="margin-left: 1.5em" id="section-5.1.2.2-1.4">
                <p id="section-5.1.2.2-1.4.1">Active<a href="#section-5.1.2.2-1.4.1" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
<dt id="section-5.1.2.2-1.5">
Description:  </dt>
              <dd style="margin-left: 1.5em" id="section-5.1.2.2-1.6">
                <p id="section-5.1.2.2-1.6.1">RSASSA-PKCS1-v1_5 using SHA-256<a href="#section-5.1.2.2-1.6.1" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
<dt id="section-5.1.2.2-1.7">
Specification document(s):  </dt>
              <dd style="margin-left: 1.5em" id="section-5.1.2.2-1.8">
                <p id="section-5.1.2.2-1.8.1">[[This document]], <a href="#method-rsa-v1_5-sha256" class="xref">Section 3.3.2</a><a href="#section-5.1.2.2-1.8.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
</dl>
</section>
</div>
<div id="hmac-sha256">
<section id="section-5.1.2.3">
            <h5 id="name-hmac-sha256">
<a href="#section-5.1.2.3" class="section-number selfRef">5.1.2.3. </a><a href="#name-hmac-sha256" class="section-name selfRef">hmac-sha256</a>
            </h5>
<span class="break"></span><dl class="dlNewline" id="section-5.1.2.3-1">
              <dt id="section-5.1.2.3-1.1">
Algorithm Name:  </dt>
              <dd style="margin-left: 1.5em" id="section-5.1.2.3-1.2">
                <p id="section-5.1.2.3-1.2.1"><code>hmac-sha256</code><a href="#section-5.1.2.3-1.2.1" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
<dt id="section-5.1.2.3-1.3">
Status:  </dt>
              <dd style="margin-left: 1.5em" id="section-5.1.2.3-1.4">
                <p id="section-5.1.2.3-1.4.1">Active<a href="#section-5.1.2.3-1.4.1" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
<dt id="section-5.1.2.3-1.5">
Description:  </dt>
              <dd style="margin-left: 1.5em" id="section-5.1.2.3-1.6">
                <p id="section-5.1.2.3-1.6.1">HMAC using SHA-256<a href="#section-5.1.2.3-1.6.1" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
<dt id="section-5.1.2.3-1.7">
Specification document(s):  </dt>
              <dd style="margin-left: 1.5em" id="section-5.1.2.3-1.8">
                <p id="section-5.1.2.3-1.8.1">[[This document]], <a href="#method-hmac-sha256" class="xref">Section 3.3.3</a><a href="#section-5.1.2.3-1.8.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
</dl>
</section>
</div>
<div id="ecdsa-p256-sha256">
<section id="section-5.1.2.4">
            <h5 id="name-ecdsa-p256-sha256">
<a href="#section-5.1.2.4" class="section-number selfRef">5.1.2.4. </a><a href="#name-ecdsa-p256-sha256" class="section-name selfRef">ecdsa-p256-sha256</a>
            </h5>
<span class="break"></span><dl class="dlNewline" id="section-5.1.2.4-1">
              <dt id="section-5.1.2.4-1.1">
Algorithm Name:  </dt>
              <dd style="margin-left: 1.5em" id="section-5.1.2.4-1.2">
                <p id="section-5.1.2.4-1.2.1"><code>ecdsa-p256-sha256</code><a href="#section-5.1.2.4-1.2.1" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
<dt id="section-5.1.2.4-1.3">
Status:  </dt>
              <dd style="margin-left: 1.5em" id="section-5.1.2.4-1.4">
                <p id="section-5.1.2.4-1.4.1">Active<a href="#section-5.1.2.4-1.4.1" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
<dt id="section-5.1.2.4-1.5">
Description:  </dt>
              <dd style="margin-left: 1.5em" id="section-5.1.2.4-1.6">
                <p id="section-5.1.2.4-1.6.1">ECDSA using curve P-256 DSS and SHA-256<a href="#section-5.1.2.4-1.6.1" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
<dt id="section-5.1.2.4-1.7">
Specification document(s):  </dt>
              <dd style="margin-left: 1.5em" id="section-5.1.2.4-1.8">
                <p id="section-5.1.2.4-1.8.1">[[This document]], <a href="#method-ecdsa-p256-sha256" class="xref">Section 3.3.4</a><a href="#section-5.1.2.4-1.8.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="param-registry">
<section id="section-5.2">
        <h3 id="name-http-signature-metadata-par">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-http-signature-metadata-par" class="section-name selfRef">HTTP Signature Metadata Parameters Registry</a>
        </h3>
<p id="section-5.2-1">This document defines the <code>Signature-Input</code> Structured Header, whose member values may have parameters containing metadata about a message signature. IANA is asked to create and maintain a new registry titled "HTTP Signature Metadata Parameters" to record and maintain the set of parameters defined for use with member values in the <code>Signature-Input</code> Structured Header. Initial values for this registry are given in <a href="#iana-param-contents" class="xref">Section 5.2.2</a>.  Future assignments and modifications to existing assignments are to be made through the Expert Review registration policy <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span> and shall follow the template presented in <a href="#iana-param-template" class="xref">Section 5.2.1</a>.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<div id="iana-param-template">
<section id="section-5.2.1">
          <h4 id="name-registration-template-2">
<a href="#section-5.2.1" class="section-number selfRef">5.2.1. </a><a href="#name-registration-template-2" class="section-name selfRef">Registration Template</a>
        </h4>
</section>
</div>
<div id="iana-param-contents">
<section id="section-5.2.2">
          <h4 id="name-initial-contents-2">
<a href="#section-5.2.2" class="section-number selfRef">5.2.2. </a><a href="#name-initial-contents-2" class="section-name selfRef">Initial Contents</a>
          </h4>
<p id="section-5.2.2-1">The table below contains the initial contents of the HTTP Signature Metadata Parameters Registry.  Each row in the table represents a distinct entry in the registry.<a href="#section-5.2.2-1" class="pilcrow">¶</a></p>
<span id="name-initial-contents-of-the-htt"></span><table class="center" id="table-4">
            <caption>
<a href="#table-4" class="selfRef">Table 4</a>:
<a href="#name-initial-contents-of-the-htt" class="selfRef">Initial contents of the HTTP Signature Metadata Parameters Registry.</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Name</th>
                <th class="text-left" rowspan="1" colspan="1">Status</th>
                <th class="text-left" rowspan="1" colspan="1">Reference(s)</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>alg</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Active</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#signature-params" class="xref">Section 2.3.2</a> of this document</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>created</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Active</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#signature-params" class="xref">Section 2.3.2</a> of this document</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>expires</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Active</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#signature-params" class="xref">Section 2.3.2</a> of this document</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>keyid</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Active</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#signature-params" class="xref">Section 2.3.2</a> of this document</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>nonce</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Active</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#signature-params" class="xref">Section 2.3.2</a> of this document</td>
              </tr>
            </tbody>
          </table>
</section>
</div>
</section>
</div>
<div id="content-registry">
<section id="section-5.3">
        <h3 id="name-http-signature-specialty-co">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-http-signature-specialty-co" class="section-name selfRef">HTTP Signature Specialty Content Identifiers Registry</a>
        </h3>
<p id="section-5.3-1">This document defines a method for canonicalizing HTTP message content, including content that can be generated from the context of the HTTP message outside of the HTTP headers. This content is identified by a unique key.  IANA is asked to create and maintain a new registry typed "HTTP Signature Specialty Content Identifiers" to record and maintain the set of non-header content identifiers and their canonicalization method. Initial values for this registry are given in <a href="#iana-content-contents" class="xref">Section 5.3.2</a>.  Future assignments and modifications to existing assignments are to be made through the Expert Review registration policy <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span> and shall follow the template presented in <a href="#iana-content-template" class="xref">Section 5.3.1</a>.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<div id="iana-content-template">
<section id="section-5.3.1">
          <h4 id="name-registration-template-3">
<a href="#section-5.3.1" class="section-number selfRef">5.3.1. </a><a href="#name-registration-template-3" class="section-name selfRef">Registration Template</a>
        </h4>
</section>
</div>
<div id="iana-content-contents">
<section id="section-5.3.2">
          <h4 id="name-initial-contents-3">
<a href="#section-5.3.2" class="section-number selfRef">5.3.2. </a><a href="#name-initial-contents-3" class="section-name selfRef">Initial Contents</a>
          </h4>
<p id="section-5.3.2-1">The table below contains the initial contents of the HTTP Signature Specialty Content Identifiers Registry.<a href="#section-5.3.2-1" class="pilcrow">¶</a></p>
<span id="name-initial-contents-of-the-http"></span><table class="center" id="table-5">
            <caption>
<a href="#table-5" class="selfRef">Table 5</a>:
<a href="#name-initial-contents-of-the-http" class="selfRef">Initial contents of the HTTP Signature Specialty Content Identifiers Registry.</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Name</th>
                <th class="text-left" rowspan="1" colspan="1">Status</th>
                <th class="text-left" rowspan="1" colspan="1">Reference(s)</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>@request-target</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Active</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#content-request-target" class="xref">Section 2.3.1</a> of this document</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>@signature-params</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Active</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#signature-params" class="xref">Section 2.3.2</a> of this document</td>
              </tr>
            </tbody>
          </table>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="security">
<section id="section-6">
      <h2 id="name-security-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-6-1">(( TODO: need to dive deeper on this section; not sure how much of what's referenced below is actually applicable, or if it covers everything we need to worry about. ))<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">(( TODO: Should provide some recommendations on how to determine what content needs to be signed for a given use case. ))<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">There are a number of security considerations to take into account when implementing or utilizing this specification.  A thorough security analysis of this protocol, including its strengths and weaknesses, can be found in <span>[<a href="#WP-HTTP-Sig-Audit" class="xref">WP-HTTP-Sig-Audit</a>]</span>.<a href="#section-6-3" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-7">
      <h2 id="name-references">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-7.1">
        <h3 id="name-normative-references">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="FIPS186-4">[FIPS186-4]</dt>
        <dd>
<span class="refTitle">"Digital Signature Standard (DSS)"</span>, <time datetime="2013" class="refDate">2013</time>, <span>&lt;<a href="https://csrc.nist.gov/publications/detail/fips/186/4/final">https://csrc.nist.gov/publications/detail/fips/186/4/final</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="HTTP2">[HTTP2]</dt>
        <dd>
<span class="refAuthor">Belshe, M.</span>, <span class="refAuthor">Peon, R.</span>, and <span class="refAuthor">M. Thomson, Ed.</span>, <span class="refTitle">"Hypertext Transfer Protocol Version 2 (HTTP/2)"</span>, <span class="seriesInfo">RFC 7540</span>, <span class="seriesInfo">DOI 10.17487/RFC7540</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7540">https://www.rfc-editor.org/rfc/rfc7540</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="MESSAGING">[MESSAGING]</dt>
        <dd>
<span class="refAuthor">Fielding, R., Ed.</span> and <span class="refAuthor">J. Reschke, Ed.</span>, <span class="refTitle">"Hypertext Transfer Protocol (HTTP/1.1): Message Syntax and Routing"</span>, <span class="seriesInfo">RFC 7230</span>, <span class="seriesInfo">DOI 10.17487/RFC7230</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7230">https://www.rfc-editor.org/rfc/rfc7230</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="POSIX.1">[POSIX.1]</dt>
        <dd>
<span class="refTitle">"The Open Group Base Specifications Issue 7, 2018 edition"</span>, <time datetime="2018" class="refDate">2018</time>, <span>&lt;<a href="https://pubs.opengroup.org/onlinepubs/9699919799/">https://pubs.opengroup.org/onlinepubs/9699919799/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2104">[RFC2104]</dt>
        <dd>
<span class="refAuthor">Krawczyk, H.</span>, <span class="refAuthor">Bellare, M.</span>, and <span class="refAuthor">R. Canetti</span>, <span class="refTitle">"HMAC: Keyed-Hashing for Message Authentication"</span>, <span class="seriesInfo">RFC 2104</span>, <span class="seriesInfo">DOI 10.17487/RFC2104</span>, <time datetime="1997-02" class="refDate">February 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2104">https://www.rfc-editor.org/rfc/rfc2104</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8792">[RFC8792]</dt>
        <dd>
<span class="refAuthor">Watsen, K.</span>, <span class="refAuthor">Auerswald, E.</span>, <span class="refAuthor">Farrel, A.</span>, and <span class="refAuthor">Q. Wu</span>, <span class="refTitle">"Handling Long Lines in Content of Internet-Drafts and RFCs"</span>, <span class="seriesInfo">RFC 8792</span>, <span class="seriesInfo">DOI 10.17487/RFC8792</span>, <time datetime="2020-06" class="refDate">June 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8792">https://www.rfc-editor.org/rfc/rfc8792</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8941">[RFC8941]</dt>
        <dd>
<span class="refAuthor">Nottingham, M.</span> and <span class="refAuthor">P-H. Kamp</span>, <span class="refTitle">"Structured Field Values for HTTP"</span>, <span class="seriesInfo">RFC 8941</span>, <span class="seriesInfo">DOI 10.17487/RFC8941</span>, <time datetime="2021-02" class="refDate">February 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8941">https://www.rfc-editor.org/rfc/rfc8941</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SEMANTICS">[SEMANTICS]</dt>
      <dd>
<span class="refAuthor">Fielding, R., Ed.</span> and <span class="refAuthor">J. Reschke, Ed.</span>, <span class="refTitle">"Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content"</span>, <span class="seriesInfo">RFC 7231</span>, <span class="seriesInfo">DOI 10.17487/RFC7231</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7231">https://www.rfc-editor.org/rfc/rfc7231</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-7.2">
        <h3 id="name-informative-references">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC6234">[RFC6234]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span> and <span class="refAuthor">T. Hansen</span>, <span class="refTitle">"US Secure Hash Algorithms (SHA and SHA-based HMAC and HKDF)"</span>, <span class="seriesInfo">RFC 6234</span>, <span class="seriesInfo">DOI 10.17487/RFC6234</span>, <time datetime="2011-05" class="refDate">May 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6234">https://www.rfc-editor.org/rfc/rfc6234</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7239">[RFC7239]</dt>
        <dd>
<span class="refAuthor">Petersson, A.</span> and <span class="refAuthor">M. Nilsson</span>, <span class="refTitle">"Forwarded HTTP Extension"</span>, <span class="seriesInfo">RFC 7239</span>, <span class="seriesInfo">DOI 10.17487/RFC7239</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7239">https://www.rfc-editor.org/rfc/rfc7239</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7517">[RFC7517]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refTitle">"JSON Web Key (JWK)"</span>, <span class="seriesInfo">RFC 7517</span>, <span class="seriesInfo">DOI 10.17487/RFC7517</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7517">https://www.rfc-editor.org/rfc/rfc7517</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7518">[RFC7518]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refTitle">"JSON Web Algorithms (JWA)"</span>, <span class="seriesInfo">RFC 7518</span>, <span class="seriesInfo">DOI 10.17487/RFC7518</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7518">https://www.rfc-editor.org/rfc/rfc7518</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8017">[RFC8017]</dt>
        <dd>
<span class="refAuthor">Moriarty, K., Ed.</span>, <span class="refAuthor">Kaliski, B.</span>, <span class="refAuthor">Jonsson, J.</span>, and <span class="refAuthor">A. Rusch</span>, <span class="refTitle">"PKCS #1: RSA Cryptography Specifications Version 2.2"</span>, <span class="seriesInfo">RFC 8017</span>, <span class="seriesInfo">DOI 10.17487/RFC8017</span>, <time datetime="2016-11" class="refDate">November 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8017">https://www.rfc-editor.org/rfc/rfc8017</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8126">https://www.rfc-editor.org/rfc/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TLS">[TLS]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8446">https://www.rfc-editor.org/rfc/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="WP-HTTP-Sig-Audit">[WP-HTTP-Sig-Audit]</dt>
      <dd>
<span class="refTitle">"Security Considerations for HTTP Signatures"</span>, <time datetime="2013" class="refDate">2013</time>, <span>&lt;<a href="https://web-payments.org/specs/source/http-signatures-audit/">https://web-payments.org/specs/source/http-signatures-audit/</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="detection">
<section id="section-appendix.a">
      <h2 id="name-detecting-http-message-sign">
<a href="#section-appendix.a" class="section-number selfRef">Appendix A. </a><a href="#name-detecting-http-message-sign" class="section-name selfRef">Detecting HTTP Message Signatures</a>
      </h2>
<p id="section-appendix.a-1">There have been many attempts to create signed HTTP messages in the past, including other non-standard definitions of the <code>Signature</code> header used within this specification. It is recommended that developers wishing to support both this specification and other historical drafts do so carefully and deliberately, as incompatibilities between this specification and various versions of other drafts could lead to unexpected problems.<a href="#section-appendix.a-1" class="pilcrow">¶</a></p>
<p id="section-appendix.a-2">It is recommended that implementers first detect and validate the <code>Signature-Input</code> header defined in this specification to detect that this standard is in use and not an alternative. If the <code>Signature-Input</code> header is present, all <code>Signature</code> headers can be parsed and interpreted in the context of this draft.<a href="#section-appendix.a-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="examples">
<section id="section-appendix.b">
      <h2 id="name-examples">
<a href="#section-appendix.b" class="section-number selfRef">Appendix B. </a><a href="#name-examples" class="section-name selfRef">Examples</a>
      </h2>
<div id="example-keys">
<section id="section-b.1">
        <h2 id="name-example-keys">
<a href="#section-b.1" class="section-number selfRef">B.1. </a><a href="#name-example-keys" class="section-name selfRef">Example Keys</a>
        </h2>
<p id="section-b.1-1">This section provides cryptographic keys that are referenced in example signatures throughout this document.  These keys MUST NOT be used for any purpose other than testing.<a href="#section-b.1-1" class="pilcrow">¶</a></p>
<p id="section-b.1-2">The key identifiers for each key are used throughout the examples in this specification. It is assumed for these examples that the signer and verifier can unambiguously dereference all key identifiers used here, and that the keys and algorithms used are appropriate for the context in which the signature is presented.<a href="#section-b.1-2" class="pilcrow">¶</a></p>
<div id="example-key-rsa-test">
<section id="section-b.1.1">
          <h3 id="name-example-key-rsa-test">
<a href="#section-b.1.1" class="section-number selfRef">B.1.1. </a><a href="#name-example-key-rsa-test" class="section-name selfRef">Example Key RSA test</a>
          </h3>
<p id="section-b.1.1-1">The following key is a 2048-bit RSA public and private key pair, referred to in this document
as <code>test-key-rsa</code>:<a href="#section-b.1.1-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-b.1.1-2">
<pre>
-----BEGIN RSA PUBLIC KEY-----
MIIBCgKCAQEAhAKYdtoeoy8zcAcR874L8cnZxKzAGwd7v36APp7Pv6Q2jdsPBRrw
WEBnez6d0UDKDwGbc6nxfEXAy5mbhgajzrw3MOEt8uA5txSKobBpKDeBLOsdJKFq
MGmXCQvEG7YemcxDTRPxAleIAgYYRjTSd/QBwVW9OwNFhekro3RtlinV0a75jfZg
kne/YiktSvLG34lw2zqXBDTC5NHROUqGTlML4PlNZS5Ri2U4aCNx2rUPRcKIlE0P
uKxI4T+HIaFpv8+rdV6eUgOrB2xeI1dSFFn/nnv5OoZJEIB+VmuKn3DCUcCZSFlQ
PSXSfBDiUGhwOw76WuSSsf1D4b/vLoJ10wIDAQAB
-----END RSA PUBLIC KEY-----

-----BEGIN RSA PRIVATE KEY-----
MIIEqAIBAAKCAQEAhAKYdtoeoy8zcAcR874L8cnZxKzAGwd7v36APp7Pv6Q2jdsP
BRrwWEBnez6d0UDKDwGbc6nxfEXAy5mbhgajzrw3MOEt8uA5txSKobBpKDeBLOsd
JKFqMGmXCQvEG7YemcxDTRPxAleIAgYYRjTSd/QBwVW9OwNFhekro3RtlinV0a75
jfZgkne/YiktSvLG34lw2zqXBDTC5NHROUqGTlML4PlNZS5Ri2U4aCNx2rUPRcKI
lE0PuKxI4T+HIaFpv8+rdV6eUgOrB2xeI1dSFFn/nnv5OoZJEIB+VmuKn3DCUcCZ
SFlQPSXSfBDiUGhwOw76WuSSsf1D4b/vLoJ10wIDAQABAoIBAG/JZuSWdoVHbi56
vjgCgkjg3lkO1KrO3nrdm6nrgA9P9qaPjxuKoWaKO1cBQlE1pSWp/cKncYgD5WxE
CpAnRUXG2pG4zdkzCYzAh1i+c34L6oZoHsirK6oNcEnHveydfzJL5934egm6p8DW
+m1RQ70yUt4uRc0YSor+q1LGJvGQHReF0WmJBZHrhz5e63Pq7lE0gIwuBqL8SMaA
yRXtK+JGxZpImTq+NHvEWWCu09SCq0r838ceQI55SvzmTkwqtC+8AT2zFviMZkKR
Qo6SPsrqItxZWRty2izawTF0Bf5S2VAx7O+6t3wBsQ1sLptoSgX3QblELY5asI0J
YFz7LJECgYkAsqeUJmqXE3LP8tYoIjMIAKiTm9o6psPlc8CrLI9CH0UbuaA2JCOM
cCNq8SyYbTqgnWlB9ZfcAm/cFpA8tYci9m5vYK8HNxQr+8FS3Qo8N9RJ8d0U5Csw
DzMYfRghAfUGwmlWj5hp1pQzAuhwbOXFtxKHVsMPhz1IBtF9Y8jvgqgYHLbmyiu1
mwJ5AL0pYF0G7x81prlARURwHo0Yf52kEw1dxpx+JXER7hQRWQki5/NsUEtv+8RT
qn2m6qte5DXLyn83b1qRscSdnCCwKtKWUug5q2ZbwVOCJCtmRwmnP131lWRYfj67
B/xJ1ZA6X3GEf4sNReNAtaucPEelgR2nsN0gKQKBiGoqHWbK1qYvBxX2X3kbPDkv
9C+celgZd2PW7aGYLCHq7nPbmfDV0yHcWjOhXZ8jRMjmANVR/eLQ2EfsRLdW69bn
f3ZD7JS1fwGnO3exGmHO3HZG+6AvberKYVYNHahNFEw5TsAcQWDLRpkGybBcxqZo
81YCqlqidwfeO5YtlO7etx1xLyqa2NsCeG9A86UjG+aeNnXEIDk1PDK+EuiThIUa
/2IxKzJKWl1BKr2d4xAfR0ZnEYuRrbeDQYgTImOlfW6/GuYIxKYgEKCFHFqJATAG
IxHrq1PDOiSwXd2GmVVYyEmhZnbcp8CxaEMQoevxAta0ssMK3w6UsDtvUvYvF22m
qQKBiD5GwESzsFPy3Ga0MvZpn3D6EJQLgsnrtUPZx+z2Ep2x0xc5orneB5fGyF1P
WtP+fG5Q6Dpdz3LRfm+KwBCWFKQjg7uTxcjerhBWEYPmEMKYwTJF5PBG9/ddvHLQ
EQeNC8fHGg4UXU8mhHnSBt3EA10qQJfRDs15M38eG2cYwB1PZpDHScDnDA0=
-----END RSA PRIVATE KEY-----
</pre><a href="#section-b.1.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="example-key-rsa-pss-test">
<section id="section-b.1.2">
          <h3 id="name-example-rsa-pss-key">
<a href="#section-b.1.2" class="section-number selfRef">B.1.2. </a><a href="#name-example-rsa-pss-key" class="section-name selfRef">Example RSA PSS Key</a>
          </h3>
<p id="section-b.1.2-1">The following key is a 2048-bit RSA public and private key pair, referred to in this document
as <code>test-key-rsa-pss</code>:<a href="#section-b.1.2-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-b.1.2-2">
<pre>
-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAr4tmm3r20Wd/PbqvP1s2
+QEtvpuRaV8Yq40gjUR8y2Rjxa6dpG2GXHbPfvMs8ct+Lh1GH45x28Rw3Ry53mm+
oAXjyQ86OnDkZ5N8lYbggD4O3w6M6pAvLkhk95AndTrifbIFPNU8PPMO7OyrFAHq
gDsznjPFmTOtCEcN2Z1FpWgchwuYLPL+Wokqltd11nqqzi+bJ9cvSKADYdUAAN5W
Utzdpiy6LbTgSxP7ociU4Tn0g5I6aDZJ7A8Lzo0KSyZYoA485mqcO0GVAdVw9lq4
aOT9v6d+nb4bnNkQVklLQ3fVAvJm+xdDOp9LCNCN48V2pnDOkFV6+U9nV5oyc6XI
2wIDAQAB
-----END PUBLIC KEY-----

-----BEGIN PRIVATE KEY-----
MIIEvgIBADALBgkqhkiG9w0BAQoEggSqMIIEpgIBAAKCAQEAr4tmm3r20Wd/Pbqv
P1s2+QEtvpuRaV8Yq40gjUR8y2Rjxa6dpG2GXHbPfvMs8ct+Lh1GH45x28Rw3Ry5
3mm+oAXjyQ86OnDkZ5N8lYbggD4O3w6M6pAvLkhk95AndTrifbIFPNU8PPMO7Oyr
FAHqgDsznjPFmTOtCEcN2Z1FpWgchwuYLPL+Wokqltd11nqqzi+bJ9cvSKADYdUA
AN5WUtzdpiy6LbTgSxP7ociU4Tn0g5I6aDZJ7A8Lzo0KSyZYoA485mqcO0GVAdVw
9lq4aOT9v6d+nb4bnNkQVklLQ3fVAvJm+xdDOp9LCNCN48V2pnDOkFV6+U9nV5oy
c6XI2wIDAQABAoIBAQCUB8ip+kJiiZVKF8AqfB/aUP0jTAqOQewK1kKJ/iQCXBCq
pbo360gvdt05H5VZ/RDVkEgO2k73VSsbulqezKs8RFs2tEmU+JgTI9MeQJPWcP6X
aKy6LIYs0E2cWgp8GADgoBs8llBq0UhX0KffglIeek3n7Z6Gt4YFge2TAcW2WbN4
XfK7lupFyo6HHyWRiYHMMARQXLJeOSdTn5aMBP0PO4bQyk5ORxTUSeOciPJUFktQ
HkvGbym7KryEfwH8Tks0L7WhzyP60PL3xS9FNOJi9m+zztwYIXGDQuKM2GDsITeD
2mI2oHoPMyAD0wdI7BwSVW18p1h+jgfc4dlexKYRAoGBAOVfuiEiOchGghV5vn5N
RDNscAFnpHj1QgMr6/UG05RTgmcLfVsI1I4bSkbrIuVKviGGf7atlkROALOG/xRx
DLadgBEeNyHL5lz6ihQaFJLVQ0u3U4SB67J0YtVO3R6lXcIjBDHuY8SjYJ7Ci6Z6
vuDcoaEujnlrtUhaMxvSfcUJAoGBAMPsCHXte1uWNAqYad2WdLjPDlKtQJK1diCm
rqmB2g8QE99hDOHItjDBEdpyFBKOIP+NpVtM2KLhRajjcL9Ph8jrID6XUqikQuVi
4J9FV2m42jXMuioTT13idAILanYg8D3idvy/3isDVkON0X3UAVKrgMEne0hJpkPL
FYqgetvDAoGBAKLQ6JZMbSe0pPIJkSamQhsehgL5Rs51iX4m1z7+sYFAJfhvN3Q/
OGIHDRp6HjMUcxHpHw7U+S1TETxePwKLnLKj6hw8jnX2/nZRgWHzgVcY+sPsReRx
NJVf+Cfh6yOtznfX00p+JWOXdSY8glSSHJwRAMog+hFGW1AYdt7w80XBAoGBAImR
NUugqapgaEA8TrFxkJmngXYaAqpA0iYRA7kv3S4QavPBUGtFJHBNULzitydkNtVZ
3w6hgce0h9YThTo/nKc+OZDZbgfN9s7cQ75x0PQCAO4fx2P91Q+mDzDUVTeG30mE
t2m3S0dGe47JiJxifV9P3wNBNrZGSIF3mrORBVNDAoGBAI0QKn2Iv7Sgo4T/XjND
dl2kZTXqGAk8dOhpUiw/HdM3OGWbhHj2NdCzBliOmPyQtAr770GITWvbAI+IRYyF
S7Fnk6ZVVVHsxjtaHy1uJGFlaZzKR4AGNaUTOJMs6NadzCmGPAxNQQOCqoUjn4XR
rOjr9w349JooGXhOxbu8nOxX
-----END PRIVATE KEY-----
</pre><a href="#section-b.1.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="example-key-ecc-p256">
<section id="section-b.1.3">
          <h3 id="name-example-ecc-p-256-test-key">
<a href="#section-b.1.3" class="section-number selfRef">B.1.3. </a><a href="#name-example-ecc-p-256-test-key" class="section-name selfRef">Example ECC P-256 Test Key</a>
          </h3>
<p id="section-b.1.3-1">The following key is an elliptical curve key over the curve P-256, referred
to in this document as <code>test-key-ecc-p256</code>.<a href="#section-b.1.3-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-b.1.3-2">
<pre>
-----BEGIN EC PRIVATE KEY-----
MHcCAQEEIFKbhfNZfpDsW43+0+JjUr9K+bTeuxopu653+hBaXGA7oAoGCCqGSM49
AwEHoUQDQgAEqIVYZVLCrPZHGHjP17CTW0/+D9Lfw0EkjqF7xB4FivAxzic30tMM
4GF+hR6Dxh71Z50VGGdldkkDXZCnTNnoXQ==
-----END EC PRIVATE KEY-----
</pre><a href="#section-b.1.3-2" class="pilcrow">¶</a>
</div>
<div class="artwork art-text alignLeft" id="section-b.1.3-3">
<pre>
-----BEGIN PUBLIC KEY-----
MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEqIVYZVLCrPZHGHjP17CTW0/+D9Lf
w0EkjqF7xB4FivAxzic30tMM4GF+hR6Dxh71Z50VGGdldkkDXZCnTNnoXQ==
-----END PUBLIC KEY-----
</pre><a href="#section-b.1.3-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="example-shared-secret">
<section id="section-b.1.4">
          <h3 id="name-example-shared-secret">
<a href="#section-b.1.4" class="section-number selfRef">B.1.4. </a><a href="#name-example-shared-secret" class="section-name selfRef">Example Shared Secret</a>
          </h3>
<p id="section-b.1.4-1">The following shared secret is 64 randomly-generated bytes encoded in Base64,
referred to in this document as <code>test-shared-secret</code>.<a href="#section-b.1.4-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-b.1.4-2">
<pre>
uzvJfB4u3N0Jy4T7NZ75MDVcr8zSTInedJtkgcu46YW4XByzNJjxBdtjUkdJPBt\
  bmHhIDi6pcl8jsasjlTMtDQ==
</pre><a href="#section-b.1.4-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="test-cases">
<section id="section-b.2">
        <h2 id="name-test-cases">
<a href="#section-b.2" class="section-number selfRef">B.2. </a><a href="#name-test-cases" class="section-name selfRef">Test Cases</a>
        </h2>
<p id="section-b.2-1">This section provides non-normative examples that may be used as test cases to validate implementation correctness. These examples are based on the following HTTP messages:<a href="#section-b.2-1" class="pilcrow">¶</a></p>
<p id="section-b.2-2">For requests, this <code>test-request</code> message is used:<a href="#section-b.2-2" class="pilcrow">¶</a></p>
<div id="section-b.2-3">
<pre class="sourcecode lang-http-message">
POST /foo?param=value&amp;pet=dog HTTP/1.1
Host: example.com
Date: Tue, 20 Apr 2021 02:07:55 GMT
Content-Type: application/json
Digest: SHA-256=X48E9qOokqqrvdts8nOJRJN3OWDUoyWxBf7kbu9DBPE=
Content-Length: 18

{"hello": "world"}
</pre><a href="#section-b.2-3" class="pilcrow">¶</a>
</div>
<p id="section-b.2-4">For responses, this <code>test-response</code> message is used:<a href="#section-b.2-4" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-b.2-5">
<pre>
HTTP/1.1 200 OK
Date: Tue, 20 Apr 2021 02:07:56 GMT
Content-Type: application/json
Digest: SHA-256=X48E9qOokqqrvdts8nOJRJN3OWDUoyWxBf7kbu9DBPE=
Content-Length: 18

{"hello": "world"}
</pre><a href="#section-b.2-5" class="pilcrow">¶</a>
</div>
<div id="minimal-signature-header-using-rsa-pss-sha512">
<section id="section-b.2.1">
          <h3 id="name-minimal-signature-header-us">
<a href="#section-b.2.1" class="section-number selfRef">B.2.1. </a><a href="#name-minimal-signature-header-us" class="section-name selfRef">Minimal Signature Header using rsa-pss-sha512</a>
          </h3>
<p id="section-b.2.1-1">This example presents a minimal <code>Signature-Input</code> and <code>Signature</code> header for a signature using the <code>rsa-pss-sha512</code> algorithm over <code>test-request</code>, covering none
of the content of the HTTP message request but providing a timestamped signature proof of possession of the key.<a href="#section-b.2.1-1" class="pilcrow">¶</a></p>
<p id="section-b.2.1-2">The corresponding signature input is:<a href="#section-b.2.1-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-b.2.1-3">
<pre>
"@signature-params": ();created=1618884475\
  ;keyid="test-key-rsa-pss";alg="rsa-pss-sha512"
</pre><a href="#section-b.2.1-3" class="pilcrow">¶</a>
</div>
<p id="section-b.2.1-4">This results in the following <code>Signature-Input</code> and <code>Signature</code> headers being added to the message:<a href="#section-b.2.1-4" class="pilcrow">¶</a></p>
<div id="section-b.2.1-5">
<pre class="sourcecode lang-http-message">
Signature-Input: sig1=();created=1618884475\
  ;keyid="test-key-rsa-pss";alg="rsa-pss-sha512"
Signature: sig1=:VrfdC2KEFFLoGMYTbQz4PSlKat4hAxcr5XkVN7Mm/7OQQJG+uX\
  gOez7kA6n/yTCaR1VL+FmJd2IVFCsUfcc/jO9siZK3siadoK1Dfgp2ieh9eO781ty\
  SS70OwvAkdORuQLWDnaDMRDlQhg5sNP6JaQghFLqD4qgFrM9HMPxLrznhAQugJ0Fd\
  RZLtSpnjECW6qsu2PVRoCYfnwe4gu8TfqH5GDx2SkpCF9BQ8CijuIWlOg7QP73tKt\
  QNp65u14Si9VEVXHWGiLw4blyPLzWz/fqJbdLaq94Ep60Nq8WjYEAInYH6KyV7EAD\
  60LXdspwF50R3dkWXJP/x+gkAHSMsxbg==:
</pre><a href="#section-b.2.1-5" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="header-coverage-using-rsa-pss-sha512">
<section id="section-b.2.2">
          <h3 id="name-header-coverage-using-rsa-p">
<a href="#section-b.2.2" class="section-number selfRef">B.2.2. </a><a href="#name-header-coverage-using-rsa-p" class="section-name selfRef">Header Coverage using rsa-pss-sha512</a>
          </h3>
<p id="section-b.2.2-1">This example covers all the specified headers in <code>test-request</code> except for the body digest header using the <code>rsa-pss-sha512</code> algorithm.<a href="#section-b.2.2-1" class="pilcrow">¶</a></p>
<p id="section-b.2.2-2">The corresponding signature input is:<a href="#section-b.2.2-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-b.2.2-3">
<pre>
"host": example.com
"date": Tue, 20 Apr 2021 02:07:55 GMT
"content-type": application/json
"@signature-params": ("host" "date" "content-type")\
  ;created=1618884475;keyid="test-key-rsa-pss"
</pre><a href="#section-b.2.2-3" class="pilcrow">¶</a>
</div>
<p id="section-b.2.2-4">This results in the following <code>Signature-Input</code> and <code>Signature</code> headers being added to the message:<a href="#section-b.2.2-4" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-b.2.2-5">
<pre>
Signature-Input: sig1=("host" "date" "content-type")\
  ;created=1618884475;keyid="test-key-rsa-pss"
Signature: sig1=:Zu48JBrHlXN+hVj3T5fPQUjMNEEhABM5vNmiWuUUl7BWNid5Rz\
  OH1tEjVi+jObYkYT8p09lZ2hrNuU3xm+JUBT8WNIlopJtt0EzxFnjGlHvkhu3KbJf\
  xNlvCJVlOEdR4AivDLMeK/ZgASpZ7py1UNHJqRyGCYkYpeedinXUertL/ySNp+VbK\
  2O/qCoui2jFgff2kXQd6rjL1Up83Fpr+/KoZ6HQkv3qwBdMBDyHQykfZHhLn4AO1I\
  G+vKhOLJQDfaLsJ/fYfzsgc1s46j3GpPPD/W2nEEtdhNwu7oXq81qVRsENChIu1XI\
  FKR9q7WpyHDKEWTtaNZDS8TFvIQRU22w==:
</pre><a href="#section-b.2.2-5" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="full-coverage-using-rsa-pss-sha512">
<section id="section-b.2.3">
          <h3 id="name-full-coverage-using-rsa-pss">
<a href="#section-b.2.3" class="section-number selfRef">B.2.3. </a><a href="#name-full-coverage-using-rsa-pss" class="section-name selfRef">Full Coverage using rsa-pss-sha512</a>
          </h3>
<p id="section-b.2.3-1">This example covers all headers in <code>test-request</code> plus the request target and message body digest using the <code>rsa-pss-sha512</code> algorithm.<a href="#section-b.2.3-1" class="pilcrow">¶</a></p>
<p id="section-b.2.3-2">The corresponding signature input is:<a href="#section-b.2.3-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-b.2.3-3">
<pre>
"@request-target": post /foo?param=value&amp;pet=dog
"host": example.com
"date": Tue, 20 Apr 2021 02:07:55 GMT
"content-type": application/json
"digest": SHA-256=X48E9qOokqqrvdts8nOJRJN3OWDUoyWxBf7kbu9DBPE=
"content-length": 18
"@signature-params": ("@request-target" "host" "date" \
  "content-type" "digest" "content-length");created=1618884475\
  ;keyid="test-key-rsa-pss"
</pre><a href="#section-b.2.3-3" class="pilcrow">¶</a>
</div>
<p id="section-b.2.3-4">This results in the following <code>Signature-Input</code> and <code>Signature</code> headers being added to the message:<a href="#section-b.2.3-4" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-b.2.3-5">
<pre>
Signature-Input: sig1=("@request-target" "host" "date" \
  "content-type" "digest" "content-length");created=1618884475\
  ;keyid="test-key-rsa-pss"
Signature: \
  sig1=:iD5NhkJoGSuuTpWMzS0BI47DfbWwsGmHHLTwOxT0n+0cQFSC+1c26B7IOfI\
  RTYofqD0sfYYrnSwCvWJfA1zthAEv9J1CxS/CZXe7CQvFpuKuFJxMpkAzVYdE/TA6\
  fELxNZy9RJEWZUPBU4+aJ26d8PC0XhPObXe6JkP6/C7XvG2QinsDde7rduMdhFN/H\
  j2MuX1Ipzvv4EgbHJdKwmWRNamfmKJZC4U5Tn0F58lzGF+WIpU73V67/6aSGvJGM5\
  7U9bRHrBB7ExuQhOX2J2dvJMYkE33pEJA70XBUp9ZvciTI+vjIUgUQ2oRww3huWML\
  mMMqEc95CliwIoL5aBdCnlQ==:
</pre><a href="#section-b.2.3-5" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="signing-a-response-using-ecdsa-p256-sha256">
<section id="section-b.2.4">
          <h3 id="name-signing-a-response-using-ec">
<a href="#section-b.2.4" class="section-number selfRef">B.2.4. </a><a href="#name-signing-a-response-using-ec" class="section-name selfRef">Signing a Response using ecdsa-p256-sha256</a>
          </h3>
<p id="section-b.2.4-1">This example covers portions of the <code>test-response</code> response message using the <code>ecdsa-p256-sha256</code> algorithm
and the key <code>test-key-ecc-p256</code>.<a href="#section-b.2.4-1" class="pilcrow">¶</a></p>
<p id="section-b.2.4-2">The corresponding signature input is:<a href="#section-b.2.4-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-b.2.4-3">
<pre>
"date": Tue, 20 Apr 2021 02:07:56 GMT
"content-type": application/json
"digest": SHA-256=X48E9qOokqqrvdts8nOJRJN3OWDUoyWxBf7kbu9DBPE=
"content-length": 18
"@signature-params": ("date" "content-type" "digest" \
  "content-length");created=1618884475;keyid="test-key-ecc-p256"
</pre><a href="#section-b.2.4-3" class="pilcrow">¶</a>
</div>
<p id="section-b.2.4-4">This results in the following <code>Signature-Input</code> and <code>Signature</code> headers being added to the message:<a href="#section-b.2.4-4" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-b.2.4-5">
<pre>
Signature-Input: sig1=("date" "content-type" "digest" \
  "content-length");created=1618884475;keyid="test-key-ecc-p256"
Signature: \
  sig1=:3zmRDW6r50/RETqqhtx/N5sdd5eTh8xmHdsrYRK9wK4rCNEwLjCOBlcQxTL\
  2oJTCWGRkuqE2r9KyqZFY9jd+NQ==:
</pre><a href="#section-b.2.4-5" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="signing-a-request-using-hmac-sha256">
<section id="section-b.2.5">
          <h3 id="name-signing-a-request-using-hma">
<a href="#section-b.2.5" class="section-number selfRef">B.2.5. </a><a href="#name-signing-a-request-using-hma" class="section-name selfRef">Signing a Request using hmac-sha256</a>
          </h3>
<p id="section-b.2.5-1">This example covers portions of the <code>test-request</code> using the <code>hmac-sha256</code> algorithm and the
secret <code>test-shared-secret</code>.<a href="#section-b.2.5-1" class="pilcrow">¶</a></p>
<p id="section-b.2.5-2">The corresponding signature input is:<a href="#section-b.2.5-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-b.2.5-3">
<pre>
"host": example.com
"date": Tue, 20 Apr 2021 02:07:55 GMT
"content-type": application/json
"@signature-params": ("host" "date" "content-type")\
  ;created=1618884475;keyid="test-shared-secret"
</pre><a href="#section-b.2.5-3" class="pilcrow">¶</a>
</div>
<p id="section-b.2.5-4">This results in the following <code>Signature-Input</code> and <code>Signature</code> headers being added to the message:<a href="#section-b.2.5-4" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-b.2.5-5">
<pre>
Signature-Input: sig1=("host" "date" "content-type")\
  ;created=1618884475;keyid="test-shared-secret"
Signature: sig1=:x54VEvVOb0TMw8fUbsWdUHqqqOre+K7sB/LqHQvnfaQ=:
</pre><a href="#section-b.2.5-5" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="acknowledgements">
<section id="section-appendix.c">
      <h2 id="name-acknowledgements">
<a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="section-appendix.c-1">This specification was initially based on the draft-cavage-http-signatures internet draft.  The editors would like to thank the authors of that draft, Mark Cavage and Manu Sporny, for their work on that draft and their continuing contributions.<a href="#section-appendix.c-1" class="pilcrow">¶</a></p>
<p id="section-appendix.c-2">The editors would also like to thank the following individuals for feedback, insight, and implementation of this draft and its predecessors (in alphabetical order):
Mark Adamcin,
Mark Allen,
Paul Annesley,
Karl Boehlmark,
Stephane Bortzmeyer,
Sarven Capadisli,
Liam Dennehy,
ductm54,
Stephen Farrell,
Phillip Hallam-Baker,
Eric Holmes,
Andrey Kislyuk,
Adam Knight,
Dave Lehn,
Dave Longley,
Ilari Liusvaara,
James H. Manger,
Kathleen Moriarty,
Mark Nottingham,
Yoav Nir,
Adrian Palmer,
Lucas Pardue,
Roberto Polli,
Julian Reschke,
Michael Richardson,
Wojciech Rygielski,
Adam Scarr,
Cory J. Slep,
Dirk Stein,
Henry Story,
Lukasz Szewc,
Chris Webber, and
Jeffrey Yasskin.<a href="#section-appendix.c-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="document-history">
<section id="section-appendix.d">
      <h2 id="name-document-history">
<a href="#name-document-history" class="section-name selfRef">Document History</a>
      </h2>
<p id="section-appendix.d-1"><em>RFC EDITOR: please remove this section before publication</em><a href="#section-appendix.d-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.d-2.1">
          <p id="section-appendix.d-2.1.1">draft-ietf-httpbis-message-signatures<a href="#section-appendix.d-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.d-2.1.2.1">
              <p id="section-appendix.d-2.1.2.1.1">-05<a href="#section-appendix.d-2.1.2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.d-2.1.2.1.2.1">Remove list prefixes.<a href="#section-appendix.d-2.1.2.1.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-appendix.d-2.1.2.1.2.2">Clarify signature algorithm parameters.<a href="#section-appendix.d-2.1.2.1.2.2" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-appendix.d-2.1.2.1.2.3">Update and fix examples.<a href="#section-appendix.d-2.1.2.1.2.3" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-appendix.d-2.1.2.1.2.4">Add examples for ECC and HMAC.<a href="#section-appendix.d-2.1.2.1.2.4" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li class="normal" id="section-appendix.d-2.1.2.2">
              <p id="section-appendix.d-2.1.2.2.1">-04<a href="#section-appendix.d-2.1.2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.d-2.1.2.2.2.1">Moved signature component definitions up to intro.<a href="#section-appendix.d-2.1.2.2.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-appendix.d-2.1.2.2.2.2">Created formal function definitions for algorithms to fulfill.<a href="#section-appendix.d-2.1.2.2.2.2" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-appendix.d-2.1.2.2.2.3">Updated all examples.<a href="#section-appendix.d-2.1.2.2.2.3" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-appendix.d-2.1.2.2.2.4">Added nonce parameter field.<a href="#section-appendix.d-2.1.2.2.2.4" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li class="normal" id="section-appendix.d-2.1.2.3">
              <p id="section-appendix.d-2.1.2.3.1">-03<a href="#section-appendix.d-2.1.2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.d-2.1.2.3.2.1">Clarified signing and verification processes.<a href="#section-appendix.d-2.1.2.3.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-appendix.d-2.1.2.3.2.2">Updated algorithm and key selection method.<a href="#section-appendix.d-2.1.2.3.2.2" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-appendix.d-2.1.2.3.2.3">Clearly defined core algorithm set.<a href="#section-appendix.d-2.1.2.3.2.3" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-appendix.d-2.1.2.3.2.4">Defined JOSE signature mapping process.<a href="#section-appendix.d-2.1.2.3.2.4" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-appendix.d-2.1.2.3.2.5">Removed legacy signature methods.<a href="#section-appendix.d-2.1.2.3.2.5" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-appendix.d-2.1.2.3.2.6">Define signature parameters separately from "signature" object model.<a href="#section-appendix.d-2.1.2.3.2.6" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-appendix.d-2.1.2.3.2.7">Define serialization values for signature-input header based on signature input.<a href="#section-appendix.d-2.1.2.3.2.7" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li class="normal" id="section-appendix.d-2.1.2.4">
              <p id="section-appendix.d-2.1.2.4.1">-02<a href="#section-appendix.d-2.1.2.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.d-2.1.2.4.2.1">Removed editorial comments on document sources.<a href="#section-appendix.d-2.1.2.4.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-appendix.d-2.1.2.4.2.2">Removed in-document issues list in favor of tracked issues.<a href="#section-appendix.d-2.1.2.4.2.2" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-appendix.d-2.1.2.4.2.3">Replaced unstructured <code>Signature</code> header with <code>Signature-Input</code> and <code>Signature</code> Dictionary Structured Header Fields.<a href="#section-appendix.d-2.1.2.4.2.3" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-appendix.d-2.1.2.4.2.4">Defined content identifiers for individual Dictionary members, e.g., <code>"x-dictionary-field";key=member-name</code>.<a href="#section-appendix.d-2.1.2.4.2.4" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-appendix.d-2.1.2.4.2.5">Defined content identifiers for first N members of a List, e.g., <code>"x-list-field":prefix=4</code>.<a href="#section-appendix.d-2.1.2.4.2.5" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-appendix.d-2.1.2.4.2.6">Fixed up examples.<a href="#section-appendix.d-2.1.2.4.2.6" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-appendix.d-2.1.2.4.2.7">Updated introduction now that it's adopted.<a href="#section-appendix.d-2.1.2.4.2.7" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-appendix.d-2.1.2.4.2.8">Defined specialty content identifiers and a means to extend them.<a href="#section-appendix.d-2.1.2.4.2.8" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-appendix.d-2.1.2.4.2.9">Required signature parameters to be included in signature.<a href="#section-appendix.d-2.1.2.4.2.9" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-appendix.d-2.1.2.4.2.10">Added guidance on backwards compatibility, detection, and use of signature methods.<a href="#section-appendix.d-2.1.2.4.2.10" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li class="normal" id="section-appendix.d-2.1.2.5">
              <p id="section-appendix.d-2.1.2.5.1">-01<a href="#section-appendix.d-2.1.2.5.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.d-2.1.2.5.2.1">Strengthened requirement for content identifiers for header fields to be lower-case (changed from SHOULD to MUST).<a href="#section-appendix.d-2.1.2.5.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-appendix.d-2.1.2.5.2.2">Added real example values for Creation Time and Expiration Time.<a href="#section-appendix.d-2.1.2.5.2.2" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-appendix.d-2.1.2.5.2.3">Minor editorial corrections and readability improvements.<a href="#section-appendix.d-2.1.2.5.2.3" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li class="normal" id="section-appendix.d-2.1.2.6">
              <p id="section-appendix.d-2.1.2.6.1">-00<a href="#section-appendix.d-2.1.2.6.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.d-2.1.2.6.2.1">Initialized from draft-richanna-http-message-signatures-00, following adoption by the working group.<a href="#section-appendix.d-2.1.2.6.2.1" class="pilcrow">¶</a>
</li>
              </ul>
</li>
          </ul>
</li>
        <li class="normal" id="section-appendix.d-2.2">
          <p id="section-appendix.d-2.2.1">draft-richanna-http-message-signatures<a href="#section-appendix.d-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.d-2.2.2.1">
              <p id="section-appendix.d-2.2.2.1.1">-00<a href="#section-appendix.d-2.2.2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.d-2.2.2.1.2.1">Converted to xml2rfc v3 and reformatted to comply with RFC style guides.<a href="#section-appendix.d-2.2.2.1.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-appendix.d-2.2.2.1.2.2">Removed Signature auth-scheme definition and related content.<a href="#section-appendix.d-2.2.2.1.2.2" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-appendix.d-2.2.2.1.2.3">Removed conflicting normative requirements for use of algorithm parameter. Now MUST NOT be relied upon.<a href="#section-appendix.d-2.2.2.1.2.3" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-appendix.d-2.2.2.1.2.4">Removed Extensions appendix.<a href="#section-appendix.d-2.2.2.1.2.4" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-appendix.d-2.2.2.1.2.5">Rewrote abstract and introduction to explain context and need, and challenges inherent in signing HTTP messages.<a href="#section-appendix.d-2.2.2.1.2.5" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-appendix.d-2.2.2.1.2.6">Rewrote and heavily expanded algorithm definition, retaining normative requirements.<a href="#section-appendix.d-2.2.2.1.2.6" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-appendix.d-2.2.2.1.2.7">Added definitions for key terms, referenced RFC 7230 for HTTP terms.<a href="#section-appendix.d-2.2.2.1.2.7" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-appendix.d-2.2.2.1.2.8">Added examples for canonicalization and signature generation steps.<a href="#section-appendix.d-2.2.2.1.2.8" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-appendix.d-2.2.2.1.2.9">Rewrote Signature header definition, retaining normative requirements.<a href="#section-appendix.d-2.2.2.1.2.9" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-appendix.d-2.2.2.1.2.10">Added default values for algorithm and expires parameters.<a href="#section-appendix.d-2.2.2.1.2.10" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-appendix.d-2.2.2.1.2.11">Rewrote HTTP Signature Algorithms registry definition. Added change control policy and registry template. Removed suggested URI.<a href="#section-appendix.d-2.2.2.1.2.11" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-appendix.d-2.2.2.1.2.12">Added IANA HTTP Signature Parameter registry.<a href="#section-appendix.d-2.2.2.1.2.12" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-appendix.d-2.2.2.1.2.13">Added additional normative and informative references.<a href="#section-appendix.d-2.2.2.1.2.13" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-appendix.d-2.2.2.1.2.14">Added Topics for Working Group Discussion section, to be removed prior to publication as an RFC.<a href="#section-appendix.d-2.2.2.1.2.14" class="pilcrow">¶</a>
</li>
              </ul>
</li>
          </ul>
</li>
      </ul>
</section>
</div>
<div id="authors-addresses">
<section id="section-appendix.e">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Annabelle Backman (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">Amazon</span></div>
<div dir="auto" class="left"><span class="street-address">P.O. Box 81226</span></div>
<div dir="auto" class="left">
<span class="locality">Seattle</span>, <span class="region">WA</span> <span class="postal-code">98108-1226</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:richanna@amazon.com" class="email">richanna@amazon.com</a>
</div>
<div class="url">
<span>URI:</span>
<a href="https://www.amazon.com/" class="url">https://www.amazon.com/</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Justin Richer</span></div>
<div dir="auto" class="left"><span class="org">Bespoke Engineering</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:ietf@justin.richer.org" class="email">ietf@justin.richer.org</a>
</div>
<div class="url">
<span>URI:</span>
<a href="https://bspk.io/" class="url">https://bspk.io/</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Manu Sporny</span></div>
<div dir="auto" class="left"><span class="org">Digital Bazaar</span></div>
<div dir="auto" class="left"><span class="street-address">203 Roanoke Street W.</span></div>
<div dir="auto" class="left">
<span class="locality">Blacksburg</span>, <span class="region">VA</span> <span class="postal-code">24060</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:msporny@digitalbazaar.com" class="email">msporny@digitalbazaar.com</a>
</div>
<div class="url">
<span>URI:</span>
<a href="https://manu.sporny.org/" class="url">https://manu.sporny.org/</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
