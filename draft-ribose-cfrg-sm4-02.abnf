MK = (MK_0, MK_1, MK_2, MK_3)

FK = (FK_0, FK_1, FK_2, FK_3)

CK = (CK_0, CK_1, ... , CK_31)

A = (a_0, a_1, a_2, a_3)
B = (b_0, b_1, b_2, b_3)

i = 0, 1, ..., 31

MK = (MK_0, MK_1, MK_2, MK_3)

rk_i = K_{i + 4}

FK_0 = A3B1BAC6 FK_1 = 56AA3350 FK_2 = 677D9197 FK_3 = B27022DC

CK_i = (ck_{i, 0}, ck_{i, 1}, ck_{i, 2}, ck_{i, 3})

CK_0  = 00070E15   CK_16 = C0C7CED5
CK_1  = 1C232A31   CK_17 = DCE3EAF1
CK_2  = 383F464D   CK_18 = F8FF060D
CK_3  = 545B6269   CK_19 = 141B2229
CK_4  = 70777E85   CK_20 = 30373E45
CK_5  = 8C939AA1   CK_21 = 4C535A61
CK_6  = A8AFB6BD   CK_22 = 686F767D
CK_7  = C4CBD2D9   CK_23 = 848B9299
CK_8  = E0E7EEF5   CK_24 = A0A7AEB5
CK_9  = FC030A11   CK_25 = BCC3CAD1
CK_10 = 181F262D   CK_26 = D8DFE6ED
CK_11 = 343B4249   CK_27 = F4FB0209
CK_12 = 50575E65   CK_28 = 10171E25
CK_13 = 6C737A81   CK_29 = 2C333A41
CK_14 = 888F969D   CK_30 = 484F565D
CK_15 = A4ABB2B9   CK_31 = 646B7279

n = NBlocks(P, b)

C_i = SM4Encrypt(P_i, K)
C = C_1 || ... || C_n

n = NBlocks(C, b)

P_i = SM4Decrypt(C_i, K)
P = P_1 || ... || P_n

n = NBlocks(P, b)

C_1 = SM4Encrypt(P_1 xor IV, K)

C_i = SM4Encrypt(P_i xor C_{i - 1}, K)
C = C_1 || ... || C_n

n = NBlocks(C, b)

P_1 = SM4Decrypt(C_1, K) xor IV

P_i = SM4Decrypt(C_i, K) xor C_{i - 1}
P = P_1 || ... || P_n
n = NBlocks(P#, s)

I_1 = IV
I_i = LSB(b - s, I_{i - 1}) || C#_{j - 1}
O_j = SM4Encrypt(I_i, K)
n = NBlocks(P#, s)

I_1 = IV
I_i = LSB(b - s, I_{i - 1}) || C#_{j - 1}
O_j = SM4Encrypt(I_i, K)
n = NBlocks(P, b)

I_1 = IV
O_i = SM4Encrypt(I_i)
C_i = P_i xor O_i
C_n = P_n xor MSB(u, O_n)

C = C_1 || ... || C_n

n = NBlocks(C, b)

I_1 = IV
O_i = SM4Encrypt(I_i)
P_i = C_i xor O_i
P_n = C_n xor MSB(u, O_n)

P = P_1 || ... || P_n

n = NBlocks(P, b)

O_i = SM4Encrypt(T_i)
C_i = P_i xor O_i
C_n = P_n xor MSB(u, O_n)

C = C_1 || ... || C_n

n = NBlocks(C, b)

O_i = SM4Encrypt(T_i)
P_i = C_i xor O_i
P_n = C_n xor MSB(u, O_n)

C = C_1 || ... || C_n
rk_0  = F12186F9   X_4  = 27FAD345
rk_1  = 41662B61   X_5  = A18B4CB2
rk_2  = 5A6AB19A   X_6  = 11C1E22A
rk_3  = 7BA92077   X_7  = CC13E2EE
rk_4  = 367360F4   X_8  = F87C5BD5
rk_5  = 776A0C61   X_9  = 33220757
rk_6  = B6BB89B3   X_10 = 77F4C297
rk_7  = 24763151   X_11 = 7A96F2EB
rk_8  = A520307C   X_12 = 27DAC07F
rk_9  = B7584DBD   X_13 = 42DD0F19
rk_10 = C30753ED   X_14 = B8A5DA02
rk_11 = 7EE55B57   X_15 = 907127FA
rk_12 = 6988608C   X_16 = 8B952B83
rk_13 = 30D895B7   X_17 = D42B7C59
rk_14 = 44BA14AF   X_18 = 2FFC5831
rk_15 = 104495A1   X_19 = F69E6888
rk_16 = D120B428   X_20 = AF2432C4
rk_17 = 73B55FA3   X_21 = ED1EC85E
rk_18 = CC874966   X_22 = 55A3BA22
rk_19 = 92244439   X_23 = 124B18AA
rk_20 = E89E641F   X_24 = 6AE7725F
rk_21 = 98CA015A   X_25 = F4CBA1F9
rk_22 = C7159060   X_26 = 1DCDFA10
rk_23 = 99E1FD2E   X_27 = 2FF60603
rk_24 = B79BD80C   X_28 = EFF24FDC
rk_25 = 1D2115B0   X_29 = 6FE46B75
rk_26 = 0E228AEB   X_30 = 893450AD
rk_27 = F1780C81   X_31 = 7B938F4C
rk_28 = 428D3654   X_32 = 536E4246
rk_29 = 62293496   X_33 = 86B3E94F
rk_30 = 01CF72E5   X_34 = D206965E
rk_31 = 9124A012   X_35 = 681EDF34

