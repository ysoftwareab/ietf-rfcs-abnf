<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Common requirements for IP address sharing schemes </title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.2" rel="Chapter" title="2 Terminology">
<link href="#rfc.section.3" rel="Chapter" title="3 Requirements for CGN devices">
<link href="#rfc.section.4" rel="Chapter" title="4 Logging">
<link href="#rfc.section.5" rel="Chapter" title="5 Bulk Port Allocation">
<link href="#rfc.section.6" rel="Chapter" title="6 IANA Considerations">
<link href="#rfc.section.7" rel="Chapter" title="7 Security Considerations">
<link href="#rfc.section.8" rel="Chapter" title="8 Acknowledgements">
<link href="#rfc.references" rel="Chapter" title="9 References">
<link href="#rfc.references.1" rel="Chapter" title="9.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="9.2 Informative Reference">
<link href="#rfc.appendix.Appendix%20A" rel="Chapter" title="Appendix A Change Log (to be removed by RFC Editor prior to      publication)">
<link href="#rfc.appendix.Appendix%20A.1" rel="Chapter" title="Appendix A.1 Changed in -01">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="This document defines common requirements for Carrier-Grade NAT (CGN) devices." />
  <meta name="description" content="This document defines common requirements for Carrier-Grade NAT (CGN) devices." />
  <meta name="keywords" content="CGN, NAT" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Internet Engineering Task Force</td>
<td class="right">S. Perreault, Ed.</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Viag&#233;nie</td>
</tr>
<tr>
<td class="left">Intended status: Best Current Practice</td>
<td class="right">I. Yamagata</td>
</tr>
<tr>
<td class="left">Expires: September 15, 2011</td>
<td class="right">S. Miyakawa</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">NTT Communications</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">A. Nakagawa</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Japan Internet Exchange (JPIX)</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">H. Ashida</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">iTSCOM</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">March 14, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Common requirements for IP address sharing schemes <br />
  <span class="filename">draft-ietf-behave-lsn-requirements-01</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>This document defines common requirements for Carrier-Grade NAT (CGN) devices.</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on September 15, 2011.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>2.   <a href="#rfc.section.2">Terminology</a>
</li>
<li>3.   <a href="#rfc.section.3">Requirements for CGN devices</a>
</li>
<li>4.   <a href="#rfc.section.4">Logging</a>
</li>
<li>5.   <a href="#rfc.section.5">Bulk Port Allocation</a>
</li>
<li>6.   <a href="#rfc.section.6">IANA Considerations</a>
</li>
<li>7.   <a href="#rfc.section.7">Security Considerations</a>
</li>
<li>8.   <a href="#rfc.section.8">Acknowledgements</a>
</li>
<li>9.   <a href="#rfc.references">References</a>
</li>
<li>9.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>9.2.   <a href="#rfc.references.2">Informative Reference</a>
</li>
<li>Appendix A.   <a href="#rfc.appendix.Appendix%20A">Change Log (to be removed by RFC Editor prior to      publication)</a>
</li>
<li>Appendix A.1.   <a href="#rfc.appendix.Appendix%20A.1">Changed in -01</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> Introduction</h1>
<p id="rfc.section.1.p.1">With the shortage of IPv4 addresses, it is expected that more ISPs may want to provide a service where a public IPv4 address would be shared by many subscribers (also known as NAT444 <a href="#I-D.shirasaki-nat444-isp-shared-addr">[I-D.shirasaki-nat444-isp-shared-addr]</a>).  Each subscriber is assigned a private address, and a NAT device situated in the ISPs network translates between private and public addresses.</p>
<p id="rfc.section.1.p.2">This is not to be considered a solution to the shortage of IPv4 addresses. It is a service that can conceivably be offered alongside others, such as IPv6 services or regular, un-NATed IPv4 service. Some ISPs started offering such a service long before there was a shortage of IPv4 addresses, showing that there are driving forces other than the shortage of IPv4 addresses.</p>
<p id="rfc.section.1.p.3">This document describes behavioural requirements that are to be expected of those ISP-controlled NAT devices. Meeting this set of requirements will greatly increase the likelihood that subscribers' applications will function properly.</p>
<p id="rfc.section.1.p.4">Readers should be aware of potential issues that may arise when sharing public address between many subscribers. See <a href="#I-D.ford-shared-addressing-issues">[I-D.ford-shared-addressing-issues]</a> for details.</p>
<p id="rfc.section.1.p.5">This document builds upon previous works describing requirements for generic NAT devices.<a href="#RFC4787">[RFC4787]</a><a href="#RFC5382">[RFC5382]</a><a href="#RFC5508">[RFC5508]</a>. These documents still apply in this context. What follows are additional requirements, to be satisfied on top of previous ones.</p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> Terminology</h1>
<p id="rfc.section.2.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">[RFC2119]</a>.  </p>
<p id="rfc.section.2.p.2">Readers are expected to be familiar with <a href="#RFC4787">[RFC4787]</a> and the terms defined there. The following term is used in this document: </p>

<dl>
<dt>Carrier-Grade NAT (CGN):</dt>
<dd style="margin-left: 8">NAT device placed between a subscriber and the Internet in an ISP's network. A CGN translates IP addresses and transport-protocol port numbers in the packets that it forwards across the border between the internal and external realms.  <ul class="empty"><li>Note that the term "carrier-grade" has nothing to do with the quality of the NAT device; that is left to discretion of implementors. Rather, it is to be understood as a topological qualifier: the NAT device is placed in an ISP's network and translates the traffic of potentially many subscribers. Those have limited or no control over the CGN, whereas they typically have full control over a NAT placed on their premises.</li></ul>
<p> </p>
</dd>
</dl>

<p> </p>
<p><a href="#topology">Figure 1</a> summarises the network topology in which CGN devices operate.</p>
<div id="#rfc.figure.1"></div>
<div id="#topology"></div>
<pre>
                .
                :
                |       Internet     
............... | ...................
                |       ISP network
                |
                |
            ++------++  External realm
........... |  CGN   |...............
            ++------++  Internal realm            
              |    |               
              |    |
              |    |    ISP network
............. | .. | ................
              |    |  Customer premises
      ++------++  ++------++
      |  CPE1  |  |  CPE2  |  etc.
      ++------++  ++------++
</pre>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> Requirements for CGN devices</h1>
<p id="rfc.section.3.p.1">What follows is a list of requirements for CGN devices. They are in addition to those found in other documents such as <a href="#RFC4787">[RFC4787]</a>, <a href="#RFC5382">[RFC5382]</a>, and <a href="#RFC5508">[RFC5508]</a>.</p>
<p></p>

<dl>
<dt>REQ-1:</dt>
<dd style="margin-left: 8">A CGN MUST have an "IP address pooling" behaviour of "Paired".</dd>
<dt>Justification:</dt>
<dd style="margin-left: 8">This is a stronger form of REQ-2 from <a href="#RFC4787">[RFC4787]</a>.</dd>
<dt></dt>
<dd style="margin-left: 8">Note that this requirement applies regardless of the transport protocol. In other words, a CGN must use the same external IP address mapping for all sessions associated with the same internal IP address, be they TCP, UDP, ICMP, something else, or a mix of different protocols.</dd>
</dl>

<p> </p>
<p></p>

<dl>
<dt>REQ-2:</dt>
<dd style="margin-left: 8">A CGN SHOULD limit the number of external ports (or, equivalently, "identifiers" for ICMP) that are assigned per CPE.  <ol style="list-style-type: lower-alpha">
<li>Limits SHOULD be configurable by the CGN administrator.</li>
<li>Limits MAY be configured and applied independently per transport protocol.</li>
<li>Additionally, it SHOULD be possible to limit the rate at which external ports are allocated.</li>
</ol>
<p> </p>
</dd>
<dt>Justification:</dt>
<dd style="margin-left: 8">A CGN can be considered a network resource that is shared by competing subscribers. Limiting the number of external ports assigned to each CPE mitigates the DoS attack that a subscriber could launch against the CGN in order to get a larger share of the resource. It ensures fairness among subscribers. Limiting the rate of allocation is intended to further help mitigate DoS attacks.</dd>
</dl>

<p> </p>
<p></p>

<dl>
<dt>REQ-3:</dt>
<dd style="margin-left: 8">A CGN SHOULD limit the number of TCP sessions per CPE.  <ol style="list-style-type: lower-alpha">
<li>Limits SHOULD be configurable by the CGN administrator.</li>
<li>Additionally, it SHOULD be possible to limit the rate at which TCP sessions are instanciated.</li>
</ol>
<p> </p>
</dd>
<dt>Justification:</dt>
<dd style="margin-left: 8">A NAT needs to keep track of TCP sessions associated to each mapping. This state consumes resources for which, in the case of a CGN, subscribers may compete. It is necessary to ensure that each subscriber has access to a faire share of the CGN's resources.  Limiting TCP sessions per CPE and per time unit is an effective mitigation against inter-subscriber DoS attacks. Limiting the rate of TCP session instanciation is intended to further help mitigate DoS attacks.</dd>
</dl>

<p> </p>
<p></p>

<dl>
<dt>REQ-4:</dt>
<dd style="margin-left: 8">It SHOULD be possible to administratively turn off translation for specific destination addresses and/or ports.</dd>
<dt>Justification:</dt>
<dd style="margin-left: 8">It is common for a CGN administrator to provide access for subscribers to servers installed in the ISP's network, in the external realm. When such a server is able to reach the internal realm via normal routing (which is entirely controlled by the ISP), translation is unneeded. In that case, the CGN may forward packets without modification, thus acting like a plain router.  This may represent an important efficiency gain.</dd>
<dt></dt>
<dd style="margin-left: 8">
<a href="#passthrough">Figure 2</a> illustrates this use-case.</dd>
</dl>

<p> </p>
<div id="#rfc.figure.2"></div>
<div id="#passthrough"></div>
<pre> 
X1:x1            X1':x1'            X2:x2    
+---+from X1:x1  +---+from X1:x1    +---+
|   |  to X2:x2  |   |  to X2:x2    | S |
| C |&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;| C |&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;| e |
| P |            | G |              | r |
| E |&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;| N |&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;| v |
|   |from X2:x2  |   |from X2:x2    | e |
|   |  to X1:x1  |   |  to X1:x1    | r |
+---+            +---+              +---+
</pre>
<p></p>

<dl>
<dt>REQ-5:</dt>
<dd style="margin-left: 8">It is RECOMMENDED that a CGN have an "Endpoint-Independent Filtering" behaviour.</dd>
<dt>Justification:</dt>
<dd style="margin-left: 8">This is a stronger form of REQ-8 from <a href="#RFC4787">[RFC4787]</a>. An "Address-Dependent Filtering" behaviour is NOT RECOMMENDED. This is based on the observation that some games and peer-to-peer applications require EIF for the NAT traversal to work. In the context of a CGN it is important to minimise application breakage.</dd>
</dl>

<p> </p>
<p></p>

<dl>
<dt>REQ-6:</dt>
<dd style="margin-left: 8">When a CGN loses state (due to a crash, reboot, failover to a cold standby, etc.), it MUST start using a different external address pool.</dd>
<dt>Justification:</dt>
<dd style="margin-left: 8">This is necessary in order to prevent collisions between old and new mappings and sessions. It ensures that all established sessions are broken instead of redirected to a different peer. The previous address pool MAY of course be reused after a second loss of state.</dd>
</dl>

<p> </p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> Logging</h1>
<p id="rfc.section.4.p.1">It may be necessary for CGN administrators to be able to identify a subscriber based on external IPv4 address, port, and timestamp in order to deal with abuse and lawful intercept requests. When multiple subscribers share a single external address, the source address and port that are visible at the destination host have been translated from the ones originated by the CPE.</p>
<p id="rfc.section.4.p.2">In order to be able to do this, the CGN needs to log the following information for each mapping created: </p>

<ul>
<li>internal source address</li>
<li>internal source port</li>
<li>external source address</li>
<li>external source port</li>
<li>destination address (but see below)</li>
<li>destination port (but see below)</li>
<li>timestamp</li>
</ul>

<p> </p>
<p id="rfc.section.4.p.3">A disadvantage of this is that CGNs under heavy usage may produce large amounts of logs, which may require large storage volume.</p>
<p id="rfc.section.4.p.4">Readers should be aware of logging recommendations for Internet-facing servers <a href="#I-D.ietf-intarea-server-logging-recommendations">[I-D.ietf-intarea-server-logging-recommendations]</a>.  With compliant servers, the destination address and port do not need to be logged by the CGN. This can help reduce the amount of logging.</p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> Bulk Port Allocation</h1>
<p id="rfc.section.5.p.1">So far we have assumed that a CGN allocates one external port for every outgoing connection. In this section, the impacts of allocating multiple external ports at a time are discussed.</p>
<p id="rfc.section.5.p.2">There is a range of things a CGN can do: </p>

<ol>
<li>For every outgoing connection, allocate one external port.</li>
<li>For an outgoing connection, create a "bin" of several random external ports. Subsequent outgoing connections will use ports from the "bin".  When the "bin" is full, a new connection causes a new bin to be created.  A bin is smaller or equal to the user's maximum port limit.</li>
<li>Same as (2), but the ports allocated to a "bin" are consecutive instead of random.</li>
</ol>

<p> </p>
<p id="rfc.section.5.p.3">Impacts are as follows.  </p>

<dl>
<dt>Port Utilization:</dt>
<dd style="margin-left: 8">The mechanisms at the top of the list are very efficient in their port utilization.  In that sense, they have good scaling properties (nothing is wasted).  The mechanisms at the bottom of the list will waste ports.  The number of wasted ports is proportional to size of the "bin".</dd>
<dt>Logging:</dt>
<dd style="margin-left: 8">Mechanism (1) creates a lot of log entries.  Mechanisms (2) and (3) create the same number of log entries, but (3)'s log entries are smaller because a range can be expressed very compactly by indicating a range (e.g. "12000-12009"). With large "bin" sizes, the logging for mechanisms (2) and (3) can approach the logging frequency of DHCP servers.</dd>
<dt></dt>
<dd style="margin-left: 8">Mechanism (1) can log destinations while mechanisms (2) and (3) cannot.  This means that a CGN implementing one of the latter two will rely on the remote peer to follow the recommendations in <a href="#I-D.ietf-intarea-server-logging-recommendations">[I-D.ietf-intarea-server-logging-recommendations]</a>. If this is not acceptable, mechanisms (2) and (3) cannot be used.</dd>
<dt>Security:</dt>
<dd style="margin-left: 8">Mechanisms (1) and (2) provide very good security in that ports numbers are not easily guessed.  Easily guessed port numbers put subscribers at risk of the attacks described in <a href="#RFC6056">[RFC6056]</a>.  Mechanism (3) provides poor security to subscribers, especially if the "bin" size is small.</dd>
</dl>

<p> </p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#IANA" id="IANA">IANA Considerations</a>
</h1>
<p id="rfc.section.6.p.1">There are no IANA considerations.</p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> <a href="#Security" id="Security">Security Considerations</a>
</h1>
<p id="rfc.section.7.p.1">If a malicious subscriber can spoof another subscriber's CPE, it may cause a DoS to that subscriber by creating mappings up to the allowed limit. Therefore, the CGN administrator SHOULD ensure that spoofing is impossible. This can be accomplished with ingress filtering, as described in <a href="#RFC2827">[RFC2827]</a>.</p>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> Acknowledgements</h1>
<p id="rfc.section.8.p.1">Thanks for the input and review by Tomohiro Nishitani, Yasuhiro Shirasaki, Takeshi Tomochika, Kousuke Shishikura, Dai Kuwabara, Tomoya Yoshida, Takanori Mizuguchi, Arifumi Matsumoto, Tomohiro Fujisaki, Dan Wing, and Dave Thaler.  Dan Wing contributed much of section 5.  </p>
<h1 id="rfc.references">
<a href="#rfc.references">9.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">9.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2827">[RFC2827]</b></td>
<td class="top">
<a>Ferguson, P.</a> and <a>D. Senie</a>, "<a href="http://tools.ietf.org/html/rfc2827">Network Ingress Filtering: Defeating Denial of Service Attacks which employ IP Source Address Spoofing</a>", BCP 38, RFC 2827, May 2000.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4787">[RFC4787]</b></td>
<td class="top">
<a>Audet, F.</a> and <a>C. Jennings</a>, "<a href="http://tools.ietf.org/html/rfc4787">Network Address Translation (NAT) Behavioral Requirements for Unicast UDP</a>", BCP 127, RFC 4787, January 2007.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5382">[RFC5382]</b></td>
<td class="top">
<a>Guha, S.</a>, <a>Biswas, K.</a>, <a>Ford, B.</a>, <a>Sivakumar, S.</a> and <a>P. Srisuresh</a>, "<a href="http://tools.ietf.org/html/rfc5382">NAT Behavioral Requirements for TCP</a>", BCP 142, RFC 5382, October 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5508">[RFC5508]</b></td>
<td class="top">
<a>Srisuresh, P.</a>, <a>Ford, B.</a>, <a>Sivakumar, S.</a> and <a>S. Guha</a>, "<a href="http://tools.ietf.org/html/rfc5508">NAT Behavioral Requirements for ICMP</a>", BCP 148, RFC 5508, April 2009.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6056">[RFC6056]</b></td>
<td class="top">
<a>Larsen, M.</a> and <a>F. Gont</a>, "<a href="http://tools.ietf.org/html/rfc6056">Recommendations for Transport-Protocol Port Randomization</a>", BCP 156, RFC 6056, January 2011.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">9.2.</a> Informative Reference</h1>
<table><tbody>
<tr>
<td class="reference"><b id="I-D.shirasaki-nat444-isp-shared-addr">[I-D.shirasaki-nat444-isp-shared-addr]</b></td>
<td class="top">
<a>Yamaguchi, J</a>, <a>Shirasaki, Y</a>, <a>Miyakawa, S</a>, <a>Nakagawa, A</a> and <a>H Ashida</a>, "<a href="http://tools.ietf.org/html/draft-shirasaki-nat444-isp-shared-addr-06">NAT444 addressing models</a>", Internet-Draft draft-shirasaki-nat444-isp-shared-addr-06, July 2011.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ford-shared-addressing-issues">[I-D.ford-shared-addressing-issues]</b></td>
<td class="top">
<a>Ford, M</a>, <a>Boucadair, M</a>, <a>Durand, A</a>, <a>Levis, P</a> and <a>P Roberts</a>, "<a href="http://tools.ietf.org/html/draft-ford-shared-addressing-issues-02">Issues with IP Address Sharing</a>", Internet-Draft draft-ford-shared-addressing-issues-02, March 2010.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-intarea-server-logging-recommendations">[I-D.ietf-intarea-server-logging-recommendations]</b></td>
<td class="top">
<a>Durand, A</a>, <a>Gashinsky, I</a>, <a>Lee, D</a> and <a>S Sheppard</a>, "<a href="http://tools.ietf.org/html/draft-ietf-intarea-server-logging-recommendations-04">Logging recommendations for Internet facing servers</a>", Internet-Draft draft-ietf-intarea-server-logging-recommendations-04, April 2011.</td>
</tr>
</tbody></table>
<h1 id="rfc.appendix.Appendix A">
<a href="#rfc.appendix.Appendix%20A">Appendix A.</a> Change Log (to be removed by RFC Editor prior to      publication)</h1>
<h1 id="rfc.appendix.Appendix A.1">
<a href="#rfc.appendix.Appendix%20A.1">Appendix A.1.</a> Changed in -01</h1>
<p></p>

<ul>
<li>Terminology: LSN is now CGN.</li>
<li>Imported all requirements from RFCs 4787, 5382, and 5508. This allowed us to eliminate some duplication.</li>
<li>Added references to draft-ietf-intarea-server-logging-recommendations and draft-ford-shared-addressing-issues.</li>
<li>Incorporated a requirement from draft-xu-behave-stateful-nat-standby-06.</li>
</ul>

<p> </p>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Simon Perreault</span> editor
	  <span class="n hidden">
		<span class="family-name">Perreault</span>
	  </span>
	</span>
	<span class="org vcardline">Viagénie</span>
	<span class="adr">
	  <span>2875 boul. Laurier, suite D2-630</span>

	  <span class="vcardline">
		<span class="locality">Québec</span>,  
		<span class="region">QC</span> 
		<span class="code">G1V 2M2</span>
	  </span>
	  <span class="country-name vcardline">Canada</span>
	</span>
	<span class="vcardline">Phone: +1 418 656 9254</span>

<span class="vcardline">EMail: <a href="mailto:simon.perreault@viagenie.ca">simon.perreault@viagenie.ca</a></span>

<span class="vcardline">URI: <a href="http://www.viagenie.ca">http://www.viagenie.ca</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Ikuhei Yamagata</span> 
	  <span class="n hidden">
		<span class="family-name">Yamagata</span>
	  </span>
	</span>
	<span class="org vcardline">NTT Communications Corporation</span>
	<span class="adr">
	  <span>Gran Park Tower 17F, 3-4-1 Shibaura, Minato-ku</span>

	  <span class="vcardline">
		<span class="locality">Tokyo</span>,  
		<span class="region"></span>
		<span class="code">108-8118</span>
	  </span>
	  <span class="country-name vcardline">Japan</span>
	</span>
	<span class="vcardline">Phone: +81 50 3812 4704</span>

<span class="vcardline">EMail: <a href="mailto:ikuhei@nttv6.jp">ikuhei@nttv6.jp</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Shin Miyakawa</span> 
	  <span class="n hidden">
		<span class="family-name">Miyakawa</span>
	  </span>
	</span>
	<span class="org vcardline">NTT Communications Corporation</span>
	<span class="adr">
	  <span>Gran Park Tower 17F, 3-4-1 Shibaura, Minato-ku</span>

	  <span class="vcardline">
		<span class="locality">Tokyo</span>,  
		<span class="region"></span>
		<span class="code">108-8118</span>
	  </span>
	  <span class="country-name vcardline">Japan</span>
	</span>
	<span class="vcardline">Phone: +81 50 3812 4695</span>

<span class="vcardline">EMail: <a href="mailto:miyakawa@nttv6.jp">miyakawa@nttv6.jp</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Akira Nakagawa</span> 
	  <span class="n hidden">
		<span class="family-name">Nakagawa</span>
	  </span>
	</span>
	<span class="org vcardline">Japan Internet Exchange Co., Ltd. (JPIX)</span>
	<span class="adr">
	  <span>Otemachi Building 21F, 1-8-1 Otemachi, Chiyoda-ku</span>

	  <span class="vcardline">
		<span class="locality">Tokyo</span>,  
		<span class="region"></span>
		<span class="code">100-0004</span>
	  </span>
	  <span class="country-name vcardline">Japan</span>
	</span>
	<span class="vcardline">Phone: +81 90 9242 2717</span>

<span class="vcardline">EMail: <a href="mailto:a-nakagawa@jpix.ad.jp">a-nakagawa@jpix.ad.jp</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Hiroyuki Ashida</span> 
	  <span class="n hidden">
		<span class="family-name">Ashida</span>
	  </span>
	</span>
	<span class="org vcardline">its communications Inc.</span>
	<span class="adr">
	  <span>541-1 Ichigao-cho Aoba-ku</span>

	  <span class="vcardline">
		<span class="locality">Yokohama</span>,  
		<span class="region"></span>
		<span class="code">225-0024</span>
	  </span>
	  <span class="country-name vcardline">Japan</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:ashida@itscom.ad.jp">ashida@itscom.ad.jp</a></span>

  </address>
</div>

</body>
</html>