<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Representation and Verification of Application Server Identity in Certificates Used with Transport Layer Security (TLS)</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Representation and Verification of Application Server Identity in Certificates Used with Transport Layer Security (TLS)">
<meta name="keywords" content="Internet-Draft">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">P. Saint-Andre, Ed.</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Cisco</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">J. Hodges, Ed.</td></tr>
<tr><td class="header">Expires: September 9, 2010</td><td class="header">PayPal</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">March 08, 2010</td></tr>
</table></td></tr></table>
<h1><br />Representation and Verification of Application Server Identity in Certificates Used with Transport Layer Security (TLS)<br />draft-saintandre-tls-server-id-check-03</h1>

<h3>Abstract</h3>

<p>Many application technologies enable a secure connection between two entities using certificates in the context of Transport Layer Security (TLS).  This document specifies procedures for representing and verifying the identity of application servers in such interactions.
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on September 9, 2010.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the BSD License.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#intro">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#motivation">1.1.</a>&nbsp;
Motivation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#scope">1.2.</a>&nbsp;
Scope<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#terminology">1.3.</a>&nbsp;
Terminology<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#contributors">1.4.</a>&nbsp;
Contributors<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#acknowledgements">1.5.</a>&nbsp;
Acknowledgements<br />
<a href="#architecture">2.</a>&nbsp;
Architectural Assumptions<br />
<a href="#representation">3.</a>&nbsp;
Representation of Server Identity<br />
<a href="#verification">4.</a>&nbsp;
Verification of Server Identity<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#certs-overview">4.1.</a>&nbsp;
Overview<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#certs-rules">4.2.</a>&nbsp;
Comparison Rules<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#certs-rules-trad">4.2.1.</a>&nbsp;
Traditional Domain Names<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#certs-rules-idn">4.2.2.</a>&nbsp;
Internationalized Domain Names<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#certs-rules-wildcards">4.2.3.</a>&nbsp;
Wildcards<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#certs-rules-cn">4.2.4.</a>&nbsp;
Common Names<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#certs-rules-rdn">4.2.5.</a>&nbsp;
Relative Distinguished Names<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#certs-outcome">4.3.</a>&nbsp;
Outcome<br />
<a href="#security">5.</a>&nbsp;
Security Considerations<br />
<a href="#iana">6.</a>&nbsp;
IANA Considerations<br />
<a href="#rfc.references1">7.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">7.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">7.2.</a>&nbsp;
Informative References<br />
<a href="#prior">Appendix&nbsp;A.</a>&nbsp;
Prior Art<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#prior-imap">A.1.</a>&nbsp;
IMAP, POP3, and ACAP (1999)<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#prior-http">A.2.</a>&nbsp;
HTTP (2000)<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#prior-ldap">A.3.</a>&nbsp;
LDAP (2000/2006)<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#prior-smtp">A.4.</a>&nbsp;
SMTP (2002/2007)<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#prior-xmpp">A.5.</a>&nbsp;
XMPP (2004)<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#prior-nntp">A.6.</a>&nbsp;
NNTP (2006)<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#prior-netconf">A.7.</a>&nbsp;
NETCONF (2006/2009)<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#prior-syslog">A.8.</a>&nbsp;
Syslog (2009)<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#prior-sip">A.9.</a>&nbsp;
SIP (2010)<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="intro"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<a name="motivation"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Motivation</h3>

<p>When a client wishes to establish a secure communication channel with an application server (e.g., "the HTTP server for example.com"), at a minimum the client needs to verify the identity of the server in order to prevent certain passive and active attacks against the connection.  To establish secure connections, many application technologies use Transport Layer Security <a class='info' href='#TLS'>[TLS]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a> with certificates issued by certification authorities that are part of the Internet X.509 Public Key Infrastructure (PKI) as described in <a class='info' href='#X509'>[X509]<span> (</span><span class='info'>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; May&nbsp;2008.</span><span>)</span></a>; such application technologies include but are not limited to the following:
</p>
<p>
          </p>
<ul class="text">
<li>The Hypertext Transfer Protocol <a class='info' href='#HTTP'>[HTTP]<span> (</span><span class='info'>Fielding, R., Gettys, J., Mogul, J., Frystyk, H., Masinter, L., Leach, P., and T. Berners-Lee, &ldquo;Hypertext Transfer Protocol -- HTTP/1.1,&rdquo; June&nbsp;1999.</span><span>)</span></a>, for which see also <a class='info' href='#HTTP-TLS'>[HTTP&#8209;TLS]<span> (</span><span class='info'>Rescorla, E., &ldquo;HTTP Over TLS,&rdquo; May&nbsp;2000.</span><span>)</span></a>
</li>
<li>The Internet Message Access Protocol <a class='info' href='#IMAP'>[IMAP]<span> (</span><span class='info'>Crispin, M., &ldquo;INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1,&rdquo; March&nbsp;2003.</span><span>)</span></a> and the Post Office Protocol <a class='info' href='#POP3'>[POP3]<span> (</span><span class='info'>Myers, J. and M. Rose, &ldquo;Post Office Protocol - Version 3,&rdquo; May&nbsp;1996.</span><span>)</span></a>, for which see also <a class='info' href='#USINGTLS'>[USINGTLS]<span> (</span><span class='info'>Newman, C., &ldquo;Using TLS with IMAP, POP3 and ACAP,&rdquo; June&nbsp;1999.</span><span>)</span></a>
</li>
<li>The Lightweight Directory Access Protocol <a class='info' href='#LDAP'>[LDAP]<span> (</span><span class='info'>Sermersheim, J., &ldquo;Lightweight Directory Access Protocol (LDAP): The Protocol,&rdquo; June&nbsp;2006.</span><span>)</span></a>, for which see also <a class='info' href='#LDAP-AUTH'>[LDAP&#8209;AUTH]<span> (</span><span class='info'>Harrison, R., &ldquo;Lightweight Directory Access Protocol (LDAP): Authentication Methods and Security Mechanisms,&rdquo; June&nbsp;2006.</span><span>)</span></a> and its predecessor <a class='info' href='#LDAP-TLS'>[LDAP&#8209;TLS]<span> (</span><span class='info'>Hodges, J., Morgan, R., and M. Wahl, &ldquo;Lightweight Directory Access Protocol (v3): Extension for Transport Layer Security,&rdquo; May&nbsp;2000.</span><span>)</span></a>
</li>
<li>The NETCONF Configuration Protocol <a class='info' href='#NETCONF'>[NETCONF]<span> (</span><span class='info'>Enns, R., &ldquo;NETCONF Configuration Protocol,&rdquo; December&nbsp;2006.</span><span>)</span></a>, for which see also <a class='info' href='#NETCONF-SSH'>[NETCONF&#8209;SSH]<span> (</span><span class='info'>Wasserman, M. and T. Goddard, &ldquo;Using the NETCONF Configuration Protocol over Secure SHell (SSH),&rdquo; December&nbsp;2006.</span><span>)</span></a> and <a class='info' href='#NETCONF-TLS'>[NETCONF&#8209;TLS]<span> (</span><span class='info'>Badra, M., &ldquo;NETCONF over Transport Layer Security (TLS),&rdquo; May&nbsp;2009.</span><span>)</span></a>
</li>
<li>The Network News Transfer Protocol <a class='info' href='#NNTP'>[NNTP]<span> (</span><span class='info'>Feather, C., &ldquo;Network News Transfer Protocol (NNTP),&rdquo; October&nbsp;2006.</span><span>)</span></a>, for which see also <a class='info' href='#NNTP-TLS'>[NNTP&#8209;TLS]<span> (</span><span class='info'>Murchison, K., Vinocur, J., and C. Newman, &ldquo;Using Transport Layer Security (TLS) with Network News Transfer Protocol (NNTP),&rdquo; October&nbsp;2006.</span><span>)</span></a>
</li>
<li>The Session Initiation Protocol <a class='info' href='#SIP'>[SIP]<span> (</span><span class='info'>Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;SIP: Session Initiation Protocol,&rdquo; June&nbsp;2002.</span><span>)</span></a>, for which see also <a class='info' href='#SIP-CERTS'>[SIP&#8209;CERTS]<span> (</span><span class='info'>Gurbani, V., Lawrence, S., and B. Laboratories, &ldquo;Domain Certificates in the Session Initiation Protocol (SIP),&rdquo; May&nbsp;2009.</span><span>)</span></a>
</li>
<li>The Simple Mail Transfer Protocol <a class='info' href='#SMTP'>[SMTP]<span> (</span><span class='info'>Klensin, J., &ldquo;Simple Mail Transfer Protocol,&rdquo; October&nbsp;2008.</span><span>)</span></a>, for which see also <a class='info' href='#SMTP-AUTH'>[SMTP&#8209;AUTH]<span> (</span><span class='info'>Siemborski, R. and A. Melnikov, &ldquo;SMTP Service Extension for Authentication,&rdquo; July&nbsp;2007.</span><span>)</span></a> and <a class='info' href='#SMTP-TLS'>[SMTP&#8209;TLS]<span> (</span><span class='info'>Hoffman, P., &ldquo;SMTP Service Extension for Secure SMTP over Transport Layer Security,&rdquo; February&nbsp;2002.</span><span>)</span></a>
</li>
<li>The Syslog Protocol <a class='info' href='#SYSLOG'>[SYSLOG]<span> (</span><span class='info'>Gerhards, R., &ldquo;The Syslog Protocol,&rdquo; March&nbsp;2009.</span><span>)</span></a>, for which see also <a class='info' href='#SYSLOG-TLS'>[SYSLOG&#8209;TLS]<span> (</span><span class='info'>Miao, F., Ma, Y., and J. Salowey, &ldquo;Transport Layer Security (TLS) Transport Mapping for Syslog,&rdquo; March&nbsp;2009.</span><span>)</span></a>
</li>
<li>The Extensible Messaging and Presence Protocol <a class='info' href='#XMPP'>[XMPP]<span> (</span><span class='info'>Saint-Andre, P., Ed., &ldquo;Extensible Messaging and Presence Protocol (XMPP): Core,&rdquo; October&nbsp;2004.</span><span>)</span></a>, for which see also <a class='info' href='#XMPPBIS'>[XMPPBIS]<span> (</span><span class='info'>Saint-Andre, P., &ldquo;Extensible Messaging and Presence Protocol (XMPP): Core,&rdquo; November&nbsp;2009.</span><span>)</span></a>
</li>
</ul><p>
        
</p>
<p>Different application protocols have traditionally specified their own rules for representing and verifying server identities.  Unfortunately, this divergence of approaches has caused some confusion among certification authorities, protocol designers, and application developers.
</p>
<p>Futhermore, currently the vast majority of deployed application servers use domain names in their certificates (typically via a subjectAltName extension of dNSName or a subjectName component of Common Name).  Ideally, service operators would use application service identities in their certificates (such as an SRVName <a class='info' href='#SRVNAME'>[SRVNAME]<span> (</span><span class='info'>Santesson, S., &ldquo;Internet X.509 Public Key Infrastructure Subject Alternative Name for Expression of Service Name,&rdquo; August&nbsp;2007.</span><span>)</span></a>, a URI, or an application-specific name form), since this would reduce the possibility of attacks against unrelated services at domain names that provide many different application services.
</p>
<p>To codify secure authentication practices, this document specifies recommended procedures for representing and verifying server identities in certificates intended for use in applications that employ TLS.
</p>
<a name="scope"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.2"></a><h3>1.2.&nbsp;
Scope</h3>

<p>This document applies only to server identities associated with domain names, only to TLS, and only to the PKI.  Similar considerations might apply to client identities (e.g., for mutual authentication), to identities other than domain names (e.g., IP addresses), to security protocols other than TLS (e.g., <a class='info' href='#IPSEC'>[IPSEC]<span> (</span><span class='info'>Kent, S. and K. Seo, &ldquo;Security Architecture for the Internet Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a> and <a class='info' href='#DTLS'>[DTLS]<span> (</span><span class='info'>Rescorla, E. and N. Modadugu, &ldquo;Datagram Transport Layer Security,&rdquo; April&nbsp;2006.</span><span>)</span></a>), and to keys or certificates created outside the context of the PKI (e.g., where a dependency on Certificate Revocation Lists or the Online Certificate Status Protocol might introduce unacceptable latency or denial of service attacks).  Although those scenarios might be able to re-use some aspects of the representation and verification rules provided here, they are outside the scope of this document and need to be addressed by separate specifications.
</p>
<a name="terminology"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.3"></a><h3>1.3.&nbsp;
Terminology</h3>

<p>Most security-related terms in this document are to be understood in the sense defined in <a class='info' href='#SECTERMS'>[SECTERMS]<span> (</span><span class='info'>Shirey, R., &ldquo;Internet Security Glossary, Version 2,&rdquo; August&nbsp;2007.</span><span>)</span></a>; such terms include, but are not limited to, "attack", "authentication", "authorization", "certificate", "credential", "identity", "self-signed certificate", "trust", "trust anchor", "trust chain", "validate", and "verify".
</p>
<p>The following capitalized keywords are to be interpreted as described in <a class='info' href='#TERMS'>[TERMS]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>: "MUST", "SHALL", "REQUIRED"; "MUST NOT", "SHALL NOT"; "SHOULD", "RECOMMENDED"; "SHOULD NOT", "NOT RECOMMENDED"; "MAY", "OPTIONAL".
</p>
<a name="contributors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.4"></a><h3>1.4.&nbsp;
Contributors</h3>

<p>The following individuals made significant contributions to the text of this document: Shumon Huque, RL 'Bob' Morgan, and Kurt Zeilenga.
</p>
<a name="acknowledgements"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.5"></a><h3>1.5.&nbsp;
Acknowledgements</h3>

<p>The editors and contributors wish to thank the following individuals for their feedback and suggestions: Dave Crocker, Cyrus Daboo, Philip Guenther, David Harrington, Paul Hoffman, Scott Lawrence, Alexey Melnikov, Tom Petch, Pete Resnick, Joe Salowey, and Dan Wing.
</p>
<a name="architecture"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Architectural Assumptions</h3>

<p>Internet applications often use a client-server architecture in which a client connects to a server in order to retrieve or upload data, access a broader network of services, or communicate with other entities on the network.  From the security perspective, a client might be a user agent controlled by a human, an automated process such as a bot, or a peer server.  We assume that an application server hosts information, enables a provisioned account to perform authorized services, or provides network access on behalf of a particular organization or service that is canonically identified by a domain name (not, e.g., an IP address).  The specific application provided (e.g., a web site or an instant messaging system) might further restrict the identity type that is represented or verified in a TLS interaction; such an identity type is often informal (e.g., most people expect a service that is provided on port 443 to be a web server) but can be specified more formally through the use of DNS SRV records <a class='info' href='#DNS-SRV'>[DNS&#8209;SRV]<span> (</span><span class='info'>Gulbrandsen, A., Vixie, P., and L. Esibov, &ldquo;A DNS RR for specifying the location of services (DNS SRV),&rdquo; February&nbsp;2000.</span><span>)</span></a>, a Uniform Resource Identifier <a class='info' href='#URI'>[URI]<span> (</span><span class='info'>Berners-Lee, T., Fielding, R., and L. Masinter, &ldquo;Uniform Resource Identifier (URI): Generic Syntax,&rdquo; January&nbsp;2005.</span><span>)</span></a> represented by a subjectAltName of uniformResourceIdentifier, the SRVName certificate extension defined in <a class='info' href='#SRVNAME'>[SRVNAME]<span> (</span><span class='info'>Santesson, S., &ldquo;Internet X.509 Public Key Infrastructure Subject Alternative Name for Expression of Service Name,&rdquo; August&nbsp;2007.</span><span>)</span></a>, or other certificate extensions that have been defined for particular identity types (e.g., the XmppAddr extension for use in <a class='info' href='#XMPP'>[XMPP]<span> (</span><span class='info'>Saint-Andre, P., Ed., &ldquo;Extensible Messaging and Presence Protocol (XMPP): Core,&rdquo; October&nbsp;2004.</span><span>)</span></a>).  The certificate presented by an application server might contain one identity or it might contain multiple identities of different types (e.g., one identity might be a simple dNSName and another might be an SRVName that restricts the certificate to use in the context of the specified service).
</p>
<p>When a client connects to an application server, it has some conception of either the server's identity (e.g., "an XMPP server for example.com") or of the server's location (e.g., "the SMTP server at mail.example.com").  The client expects at least one of the server's presented identities to match this reference identity.  It is important to note that the reference identity is provided by a human user or configured into the client application (e.g., in the domain part of an "Application Unique String" as described in <a class='info' href='#SIP-LOC'>[SIP&#8209;LOC]<span> (</span><span class='info'>Rosenberg, J. and H. Schulzrinne, &ldquo;Session Initiation Protocol (SIP): Locating SIP Servers,&rdquo; June&nbsp;2002.</span><span>)</span></a>), and is not an identity that is derived from the reference identity in an automated fashion (e.g., an IP address discovered through DNS resolution of the reference identity).  Only a match between the reference identity and a presented identity enables the client to be sure that the certificate can legitimately be used to secure the connection.  However, a user-oriented client MAY provide a configuration setting that enables a human user to explicitly specify a particular hostname to be checked for connection purposes, thus explicitly overriding matching rules.
</p>
<p>To summarize, we define the following terms to assist in understanding the process of representing and verifying server identity:
</p>
<p>
        </p>
<blockquote class="text"><dl>
<dt>identity set:</dt>
<dd>The set of identities that are presented by a server to a client (in the form of the server's X.509 certificate) when the client attempts to establish a secure connection with the server.
</dd>
<dt>identity type:</dt>
<dd>The "natural kind" of identity to which a presented identity or reference identity belongs.  For example, the reference identity might be a domain name, an IPv4 or IPv6 address, or a particular service in the sense of <a class='info' href='#DNS-SRV'>[DNS&#8209;SRV]<span> (</span><span class='info'>Gulbrandsen, A., Vixie, P., and L. Esibov, &ldquo;A DNS RR for specifying the location of services (DNS SRV),&rdquo; February&nbsp;2000.</span><span>)</span></a> or <a class='info' href='#SRVNAME'>[SRVNAME]<span> (</span><span class='info'>Santesson, S., &ldquo;Internet X.509 Public Key Infrastructure Subject Alternative Name for Expression of Service Name,&rdquo; August&nbsp;2007.</span><span>)</span></a>.  This specification does not provide a complete taxonomy of identity types but assumes that an application server is identified by a domain name that could be represented in the form of several identity types (e.g., a dNSName and an SRVName).
</dd>
<dt>presented identity:</dt>
<dd>A single member of the identity set.
</dd>
<dt>reference identity:</dt>
<dd>The client's conception of the server's identity before it attempts to establish a secure connection with the server, i.e. the identity that the client expects the server to present and to which the client makes reference when attempting to verify the server's identity.  The reference identity MUST be provided by the human user controlling the client (if any), e.g. when specifying the server portion of the user's account name on the server or when explicitly configuring the client to connect to a particular host.  The reference identity MAY be reflected in the TLS "server_name" extension as specified in <a class='info' href='#TLS'>[TLS]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a>.
</dd>
</dl></blockquote><p>
      
</p>
<a name="representation"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Representation of Server Identity</h3>

<p>The following rules apply to the representation of application server identities in certificates issued by certification authorities, i.e., certificates that are to used for securing connections to application servers such as web sites, email services, and instant messaging services.
</p>
<p>
        </p>
<ol class="text">
<li>The certification authority MUST issue the certificate based on the domain name at which the server will provide the relevant service (not an IP address or host name for a specific machine).
</li>
<li>An identity MAY contain one instance of the wildcard character '*' but only as the left-most label.  An application protocol that re-uses the rules specified in this document MUST specify whether the wildcard character is or is not allowed in certificates issued for use with that protocol.
</li>
<li>If the service at which the certificate will be used deploys a technology that is discovered by means of DNS SRV records <a class='info' href='#DNS-SRV'>[DNS&#8209;SRV]<span> (</span><span class='info'>Gulbrandsen, A., Vixie, P., and L. Esibov, &ldquo;A DNS RR for specifying the location of services (DNS SRV),&rdquo; February&nbsp;2000.</span><span>)</span></a>, then the certificate SHOULD include an identity of type SRVName <a class='info' href='#SRVNAME'>[SRVNAME]<span> (</span><span class='info'>Santesson, S., &ldquo;Internet X.509 Public Key Infrastructure Subject Alternative Name for Expression of Service Name,&rdquo; August&nbsp;2007.</span><span>)</span></a>.
</li>
<li>If the service is associated with a particular URI, then the certificate MAY include an identity of type uniformResourceIdentifier (i.e., a subjectAltName extension that includes a uniformResourceIdentifier name form whose authority component is the domain name of the service).
</li>
<li>Although the certificate MAY include other application-specific identities for types that were defined before specification of the SRVName extension (e.g., XmppAddr for <a class='info' href='#XMPP'>[XMPP]<span> (</span><span class='info'>Saint-Andre, P., Ed., &ldquo;Extensible Messaging and Presence Protocol (XMPP): Core,&rdquo; October&nbsp;2004.</span><span>)</span></a>) or for which service names do not exist, the SRVName extension is preferred.
</li>
<li>If the certificate does not include an SRVName, uniformResourceIdentifier, or other application-specific identity type, then the certificate MUST include an identity of dNSName.
</li>
<li>The certificate SHOULD NOT represent the server's domain name in an identity of Common Name (CN) (see <a class='info' href='#LDAP-SCHEMA'>[LDAP&#8209;SCHEMA]<span> (</span><span class='info'>Sciberras, A., &ldquo;Lightweight Directory Access Protocol (LDAP): Schema for User Applications,&rdquo; June&nbsp;2006.</span><span>)</span></a>) in the leaf Relative Distinguished Name (RDN) of the subjectName, even though it is recognized that many deployed clients still check this legacy identity.  For example, here the CN is the leaf RDN, which is acceptable:
            <div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
        cn=www.example.com, ou=Web Services, c=GB
</pre></div>
          
</li>
<li>The certificate MUST NOT represent the server's domain name in an identity of Common Name (CN) where the CN is in something other than the "leaf" (left-most) position within the Relative Distinguished Names (RDNs) of the subjectName.  For example, here the CN is not the leaf RDN, which is unacceptable:
            <div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
        c=GB, ou=Web Services, cn=www.example.com
</pre></div>
          
</li>
<li>The certificate MUST NOT represent the server's domain name by means of a series of Domain Component (DC) attributes (because the order of Domain Components is not guaranteed, certain attacks are possible if DC attributes are included).
</li>
</ol><p>
      
</p>
<a name="verification"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Verification of Server Identity</h3>

<a name="certs-overview"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Overview</h3>

<p>At a high level, the client verifies the server's identity in accordance with the following rules:
</p>
<p>
          </p>
<ol class="text">
<li>Before connecting to the server, the client determines the possible identity type(s) of the reference identity.
</li>
<li>During the process of attempting to establish a secure connection, the server MUST present its identity set to the client in the form of an X.509 certificate <a class='info' href='#X509'>[X509]<span> (</span><span class='info'>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; May&nbsp;2008.</span><span>)</span></a>.
</li>
<li>Upon being presented with the server's identity set, the client MUST check the reference identity against the presented identities for the purpose of finding a match.  To do so, the client iterates through all of the subjectAltName extensions it recognizes in the server's certificate and compares the value of each extension to the reference identity until it has either produced a match or exhausted the identities in the identity set (comparison rules for matching particular identity types are provided under <a class='info' href='#certs-rules'>Section&nbsp;4.2<span> (</span><span class='info'>Comparison Rules</span><span>)</span></a>, including fallbacks to several subjectName fields).  Even if the application technology does not define an application-specific preference order for checking of identities, the client SHOULD check them in order from most specific (e.g., SRVName) to least specific (e.g., dNSName).
</li>
<li>Before attempting to find a match in relation to a particular presented identity, the client MAY map the reference identity to a different identity type.  Such a mapping MAY be performed for any available subjectAltName type to which the reference identity can be mapped; however, the reference identity SHOULD be mapped only to types for which the mapping is inherently secure (e.g., extracting the domain name from a URI to match against a subjectAltName of type dNSName or SRVName).
</li>
<li>The client MUST NOT attempt to match against an an identity of type SRVName <a class='info' href='#SRVNAME'>[SRVNAME]<span> (</span><span class='info'>Santesson, S., &ldquo;Internet X.509 Public Key Infrastructure Subject Alternative Name for Expression of Service Name,&rdquo; August&nbsp;2007.</span><span>)</span></a> unless the service to which the client has connected deploys a technology that is discovered by means of DNS SRV records <a class='info' href='#DNS-SRV'>[DNS&#8209;SRV]<span> (</span><span class='info'>Gulbrandsen, A., Vixie, P., and L. Esibov, &ldquo;A DNS RR for specifying the location of services (DNS SRV),&rdquo; February&nbsp;2000.</span><span>)</span></a>.
</li>
<li>If the identity set has more than one member, a match with any of the presented identities is acceptable.
</li>
</ol><p>
        
</p>
<p></p>
<blockquote class="text">
<p>Note: A hostname that is resolved via the Domain Name System MUST NOT be used as the reference identity unless an administrator or human user has explicitly configured an application to associate a particular hostname (and potentially port) with the hostname to which the application connects (e.g., to "hardcode" an association between an original hostname of example.net and a configured hostname of connector.example.com:443).
</p>
</blockquote>

<p>In addition to the identity check described in this section, a client might complete further verification to ensure that the server is authorized to provide the service it is requested to provide.  Methods for doing so (which might include consulting local policy information) are out of scope for this document.
</p>
<a name="certs-rules"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Comparison Rules</h3>

<p>This document assumes that the reference identity is a domain name as defined by <a class='info' href='#RFC1034'>[RFC1034]<span> (</span><span class='info'>Mockapetris, P., &ldquo;Domain names - concepts and facilities,&rdquo; November&nbsp;1987.</span><span>)</span></a> and <a class='info' href='#RFC1035'>[RFC1035]<span> (</span><span class='info'>Mockapetris, P., &ldquo;Domain names - implementation and specification,&rdquo; November&nbsp;1987.</span><span>)</span></a> for "traditional" domain names or by <a class='info' href='#IDNA2003'>[IDNA2003]<span> (</span><span class='info'>Faltstrom, P., Hoffman, P., and A. Costello, &ldquo;Internationalizing Domain Names in Applications (IDNA),&rdquo; March&nbsp;2003.</span><span>)</span></a> or <a class='info' href='#IDNA2008'>[IDNA2008]<span> (</span><span class='info'>Klensin, J., &ldquo;Internationalized Domain Names in Applications (IDNA): Protocol,&rdquo; January&nbsp;2010.</span><span>)</span></a> for internationalized domain names.  The client MUST match the reference identity against subjectAltName extensions of type dNSName and SRVName <a class='info' href='#SRVNAME'>[SRVNAME]<span> (</span><span class='info'>Santesson, S., &ldquo;Internet X.509 Public Key Infrastructure Subject Alternative Name for Expression of Service Name,&rdquo; August&nbsp;2007.</span><span>)</span></a> according to the following rules.
</p>
<a name="certs-rules-trad"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.1"></a><h3>4.2.1.&nbsp;
Traditional Domain Names</h3>

<p>If the reference identity is a "traditional" domain name, then matching of reference identity against the presented identity is performed by comparing the set of domain components using a case-insensitive ASCII comparison (as clarified by <a class='info' href='#DNS-CASE'>[DNS&#8209;CASE]<span> (</span><span class='info'>Eastlake, D., &ldquo;Domain Name System (DNS) Case Insensitivity Clarification,&rdquo; January&nbsp;2006.</span><span>)</span></a>).
</p>
<a name="certs-rules-idn"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.2"></a><h3>4.2.2.&nbsp;
Internationalized Domain Names</h3>

<p>Note: This section needs to be updated to reflect <a class='info' href='#IDNA2008'>[IDNA2008]<span> (</span><span class='info'>Klensin, J., &ldquo;Internationalized Domain Names in Applications (IDNA): Protocol,&rdquo; January&nbsp;2010.</span><span>)</span></a>.
</p>
<p>If the reference identity is an internationalized domain name, then an implementation MUST convert the reference identity to the ASCII Compatible Encoding (ACE) format as specified in Section 4 of <a class='info' href='#IDNA2003'>[IDNA2003]<span> (</span><span class='info'>Faltstrom, P., Hoffman, P., and A. Costello, &ldquo;Internationalizing Domain Names in Applications (IDNA),&rdquo; March&nbsp;2003.</span><span>)</span></a> before comparison with subjectAltName values of type dNSName; specifically, the conversion operation specified in Section 4 of <a class='info' href='#IDNA2003'>[IDNA2003]<span> (</span><span class='info'>Faltstrom, P., Hoffman, P., and A. Costello, &ldquo;Internationalizing Domain Names in Applications (IDNA),&rdquo; March&nbsp;2003.</span><span>)</span></a> MUST be performed as follows:
</p>
<p>
            </p>
<ul class="text">
<li>In step 1, the domain name SHALL be considered a "stored string".
</li>
<li>In step 3, set the flag called "UseSTD3ASCIIRules".
</li>
<li>In step 4, process each label with the "ToASCII" operation.
</li>
<li>In step 5, change all label separators to U+002E (full stop).
</li>
</ul><p>
          
</p>
<p>After performing the "to-ASCII" conversion with regard to an internationalized domain name, the DNS labels and names MUST be compared for equality according to the rules specified in Section 3 of <a class='info' href='#IDNA2003'>[IDNA2003]<span> (</span><span class='info'>Faltstrom, P., Hoffman, P., and A. Costello, &ldquo;Internationalizing Domain Names in Applications (IDNA),&rdquo; March&nbsp;2003.</span><span>)</span></a>, i.e. once all label separators are replaced with U+002E (dot) they are compared in a case-insensitive manner.
</p>
<a name="certs-rules-wildcards"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.3"></a><h3>4.2.3.&nbsp;
Wildcards</h3>

<p>Unless otherwise specified by an application protocol that re-uses the rules specified in this document, the client MAY match against an identity that contains one instance of the wildcard character '*' as the left-most label of the domain name.  If it does so, the client MUST match the reference identity against the entire left-most label only (thus *.example.com matches foo.example.com but not bar.foo.example.com or example.com itself).  The client MUST ignore a presented identity in which the wildcard character is contained within a label fragment (e.g., baz*.example.net is not allowed and MUST NOT be taken to match baz1.example.net and baz2.example.net).
</p>
<a name="certs-rules-cn"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.4"></a><h3>4.2.4.&nbsp;
Common Names</h3>

<p>If and only if the identity set does not include subjectAltName extensions of type dNSName, SRVName, uniformResourceIdentifier (or other application-specific subjectAltName extensions), the client MAY as a fallback check the value of the Common Name (CN) if presented as the leaf (left-most) Relative Distinguished Name (RND) in the subjectName component of the server's X.509 certificate.  In existing certificates, the CN is often used for representing a domain name; for example, consider the following subjectName with a leaf RDN of Common Name:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
cn=www.example.com, ou=Web Services, c=GB
</pre></div>
<p>Here the Common Name is "www.example.com" and the client could choose to compare the reference identity against that CN.  When doing so, the client MUST follow the comparison rules described above for subjectAltName extensions of type dNSName and SRVName.
</p>
<p>A client MUST NOT check the Common Name if it is other than the leaf (left-most) Relative Distinguished Name (RDN) in the subjectName.
</p>
<a name="certs-rules-rdn"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.5"></a><h3>4.2.5.&nbsp;
Relative Distinguished Names</h3>

<p>A client MUST NOT check Relative Distinguished Names (RDNs) other than the Common Name; in particular, this means that a series of Domain Component (DC) attributes MUST NOT be checked (because the order of Domain Components is not guaranteed, certain attacks are possible if DC attributes are checked).
</p>
<a name="certs-outcome"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
Outcome</h3>

<p>The outcome of the checking procedure is one of the following:
</p>
<p>
          </p>
<blockquote class="text"><dl>
<dt>Case #1:</dt>
<dd>The client finds at least one presented identity that matches the reference identity; the entity MUST use this as the validated identity of the server.
</dd>
<dt>Case #2:</dt>
<dd>The client finds no subjectAltName or subjectName that matches the reference identity but a human user has permanently accepted the certificate during a previous connection attempt; the client MUST verify that the cached certificate was presented and MUST notify the user if the certificate has changed since the last time that a secure connection was successfully negotiated.
</dd>
<dt>Case #3:</dt>
<dd>The client finds no subjectAltName or subjectName that matches the reference identity and a human user has not permanently accepted the certificate during a previous connection attempt.  The client MUST NOT use the presented identity (if any).  Instead, if the client is a user-oriented application, then it MUST either (1) automatically terminate the connection with a bad certificate error or (2) show the certificate (including the entire certificate chain) to the user and give the user the choice of terminating the connecting or accepting the certificate temporarily (i.e., for this connection attempt only) or permanently (i.e., for all future connection attempts) and then continuing with the connection; if a user permanently accepts a certificate in this way, the client MUST cache the certificate (or some non-forgeable representation such as a hash value) and in future connection MUST attempt behave as in Case #2.  (It is the resposibility of the human user to verify the hash value or fingerprint of the certificate with the server over a trusted communication layer.)  If the client is an automated application, then it SHOULD terminate the connection with a bad certificate error and log the error to an appropriate audit log; an automated application MAY provide a configuration setting that disables this check, but MUST enable the check by default.
</dd>
</dl></blockquote><p>
        
</p>
<a name="security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Security Considerations</h3>

<p>This entire document discusses security.
</p>
<a name="iana"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
IANA Considerations</h3>

<p>This document has no actions for the IANA.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>7.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="IDNA2003">[IDNA2003]</a></td>
<td class="author-text">Faltstrom, P., Hoffman, P., and A. Costello, &ldquo;<a href="http://tools.ietf.org/html/rfc3490">Internationalizing Domain Names in Applications (IDNA)</a>,&rdquo; RFC&nbsp;3490, March&nbsp;2003 (<a href="ftp://ftp.isi.edu/in-notes/rfc3490.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="IDNA2008">[IDNA2008]</a></td>
<td class="author-text">Klensin, J., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-idnabis-protocol-18.txt">Internationalized Domain Names in Applications (IDNA): Protocol</a>,&rdquo; draft-ietf-idnabis-protocol-18 (work in progress), January&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-idnabis-protocol-18.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1034">[RFC1034]</a></td>
<td class="author-text">Mockapetris, P., &ldquo;<a href="http://tools.ietf.org/html/rfc1034">Domain names - concepts and facilities</a>,&rdquo; STD&nbsp;13, RFC&nbsp;1034, November&nbsp;1987 (<a href="ftp://ftp.isi.edu/in-notes/rfc1034.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1035">[RFC1035]</a></td>
<td class="author-text">Mockapetris, P., &ldquo;<a href="http://tools.ietf.org/html/rfc1035">Domain names - implementation and specification</a>,&rdquo; STD&nbsp;13, RFC&nbsp;1035, November&nbsp;1987 (<a href="ftp://ftp.isi.edu/in-notes/rfc1035.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="SRVNAME">[SRVNAME]</a></td>
<td class="author-text">Santesson, S., &ldquo;<a href="http://tools.ietf.org/html/rfc4985">Internet X.509 Public Key Infrastructure Subject Alternative Name for Expression of Service Name</a>,&rdquo; RFC&nbsp;4985, August&nbsp;2007 (<a href="ftp://ftp.isi.edu/in-notes/rfc4985.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="TERMS">[TERMS]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="ftp://ftp.isi.edu/in-notes/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="X509">[X509]</a></td>
<td class="author-text">Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;<a href="http://tools.ietf.org/html/rfc5280">Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>,&rdquo; RFC&nbsp;5280, May&nbsp;2008 (<a href="ftp://ftp.isi.edu/in-notes/rfc5280.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>7.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="DNS-CASE">[DNS-CASE]</a></td>
<td class="author-text">Eastlake, D., &ldquo;<a href="http://tools.ietf.org/html/rfc4343">Domain Name System (DNS) Case Insensitivity Clarification</a>,&rdquo; RFC&nbsp;4343, January&nbsp;2006 (<a href="ftp://ftp.isi.edu/in-notes/rfc4343.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="DNS-SRV">[DNS-SRV]</a></td>
<td class="author-text"><a href="mailto:arnt@troll.no">Gulbrandsen, A.</a>, Vixie, P., and <a href="mailto:levone@microsoft.com">L. Esibov</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2782">A DNS RR for specifying the location of services (DNS SRV)</a>,&rdquo; RFC&nbsp;2782, February&nbsp;2000 (<a href="ftp://ftp.isi.edu/in-notes/rfc2782.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="DNSSEC">[DNSSEC]</a></td>
<td class="author-text">Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose, &ldquo;<a href="http://tools.ietf.org/html/rfc4033">DNS Security Introduction and Requirements</a>,&rdquo; RFC&nbsp;4033, March&nbsp;2005 (<a href="ftp://ftp.isi.edu/in-notes/rfc4033.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="DTLS">[DTLS]</a></td>
<td class="author-text">Rescorla, E. and N. Modadugu, &ldquo;<a href="http://tools.ietf.org/html/rfc4347">Datagram Transport Layer Security</a>,&rdquo; RFC&nbsp;4347, April&nbsp;2006 (<a href="ftp://ftp.isi.edu/in-notes/rfc4347.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="HTTP">[HTTP]</a></td>
<td class="author-text"><a href="mailto:fielding@ics.uci.edu">Fielding, R.</a>, <a href="mailto:jg@w3.org">Gettys, J.</a>, <a href="mailto:mogul@wrl.dec.com">Mogul, J.</a>, <a href="mailto:frystyk@w3.org">Frystyk, H.</a>, <a href="mailto:masinter@parc.xerox.com">Masinter, L.</a>, <a href="mailto:paulle@microsoft.com">Leach, P.</a>, and <a href="mailto:timbl@w3.org">T. Berners-Lee</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2616">Hypertext Transfer Protocol -- HTTP/1.1</a>,&rdquo; RFC&nbsp;2616, June&nbsp;1999 (<a href="ftp://ftp.isi.edu/in-notes/rfc2616.txt">TXT</a>, <a href="ftp://ftp.isi.edu/in-notes/rfc2616.ps">PS</a>, <a href="ftp://ftp.isi.edu/in-notes/rfc2616.pdf">PDF</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2616.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2616.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="HTTP-TLS">[HTTP-TLS]</a></td>
<td class="author-text">Rescorla, E., &ldquo;<a href="http://tools.ietf.org/html/rfc2818">HTTP Over TLS</a>,&rdquo; RFC&nbsp;2818, May&nbsp;2000 (<a href="ftp://ftp.isi.edu/in-notes/rfc2818.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="IMAP">[IMAP]</a></td>
<td class="author-text">Crispin, M., &ldquo;<a href="http://tools.ietf.org/html/rfc3501">INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1</a>,&rdquo; RFC&nbsp;3501, March&nbsp;2003 (<a href="ftp://ftp.isi.edu/in-notes/rfc3501.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="IP">[IP]</a></td>
<td class="author-text">Postel, J., &ldquo;<a href="http://tools.ietf.org/html/rfc791">Internet Protocol</a>,&rdquo; STD&nbsp;5, RFC&nbsp;791, September&nbsp;1981 (<a href="ftp://ftp.isi.edu/in-notes/rfc791.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="IPv6">[IPv6]</a></td>
<td class="author-text"><a href="mailto:deering@cisco.com">Deering, S.</a> and <a href="mailto:hinden@iprg.nokia.com">R. Hinden</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2460">Internet Protocol, Version 6 (IPv6) Specification</a>,&rdquo; RFC&nbsp;2460, December&nbsp;1998 (<a href="ftp://ftp.isi.edu/in-notes/rfc2460.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2460.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2460.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="IPSEC">[IPSEC]</a></td>
<td class="author-text">Kent, S. and K. Seo, &ldquo;<a href="http://tools.ietf.org/html/rfc4301">Security Architecture for the Internet Protocol</a>,&rdquo; RFC&nbsp;4301, December&nbsp;2005 (<a href="ftp://ftp.isi.edu/in-notes/rfc4301.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="LDAP">[LDAP]</a></td>
<td class="author-text">Sermersheim, J., &ldquo;<a href="http://tools.ietf.org/html/rfc4511">Lightweight Directory Access Protocol (LDAP): The Protocol</a>,&rdquo; RFC&nbsp;4511, June&nbsp;2006 (<a href="ftp://ftp.isi.edu/in-notes/rfc4511.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="LDAP-AUTH">[LDAP-AUTH]</a></td>
<td class="author-text">Harrison, R., &ldquo;<a href="http://tools.ietf.org/html/rfc4513">Lightweight Directory Access Protocol (LDAP): Authentication Methods and Security Mechanisms</a>,&rdquo; RFC&nbsp;4513, June&nbsp;2006 (<a href="ftp://ftp.isi.edu/in-notes/rfc4513.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="LDAP-SCHEMA">[LDAP-SCHEMA]</a></td>
<td class="author-text">Sciberras, A., &ldquo;<a href="http://tools.ietf.org/html/rfc4519">Lightweight Directory Access Protocol (LDAP): Schema for User Applications</a>,&rdquo; RFC&nbsp;4519, June&nbsp;2006 (<a href="ftp://ftp.isi.edu/in-notes/rfc4519.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="LDAP-TLS">[LDAP-TLS]</a></td>
<td class="author-text">Hodges, J., Morgan, R., and M. Wahl, &ldquo;<a href="http://tools.ietf.org/html/rfc2830">Lightweight Directory Access Protocol (v3): Extension for Transport Layer Security</a>,&rdquo; RFC&nbsp;2830, May&nbsp;2000 (<a href="ftp://ftp.isi.edu/in-notes/rfc2830.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="NETCONF">[NETCONF]</a></td>
<td class="author-text">Enns, R., &ldquo;<a href="http://tools.ietf.org/html/rfc4741">NETCONF Configuration Protocol</a>,&rdquo; RFC&nbsp;4741, December&nbsp;2006 (<a href="ftp://ftp.isi.edu/in-notes/rfc4741.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="NETCONF-SSH">[NETCONF-SSH]</a></td>
<td class="author-text">Wasserman, M. and T. Goddard, &ldquo;<a href="http://tools.ietf.org/html/rfc4742">Using the NETCONF Configuration Protocol over Secure SHell (SSH)</a>,&rdquo; RFC&nbsp;4742, December&nbsp;2006 (<a href="ftp://ftp.isi.edu/in-notes/rfc4742.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="NETCONF-TLS">[NETCONF-TLS]</a></td>
<td class="author-text">Badra, M., &ldquo;<a href="http://tools.ietf.org/html/rfc5539">NETCONF over Transport Layer Security (TLS)</a>,&rdquo; RFC&nbsp;5539, May&nbsp;2009 (<a href="ftp://ftp.isi.edu/in-notes/rfc5539.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="NNTP">[NNTP]</a></td>
<td class="author-text">Feather, C., &ldquo;<a href="http://tools.ietf.org/html/rfc3977">Network News Transfer Protocol (NNTP)</a>,&rdquo; RFC&nbsp;3977, October&nbsp;2006 (<a href="ftp://ftp.isi.edu/in-notes/rfc3977.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="NNTP-TLS">[NNTP-TLS]</a></td>
<td class="author-text">Murchison, K., Vinocur, J., and C. Newman, &ldquo;<a href="http://tools.ietf.org/html/rfc4642">Using Transport Layer Security (TLS) with Network News Transfer Protocol (NNTP)</a>,&rdquo; RFC&nbsp;4642, October&nbsp;2006 (<a href="ftp://ftp.isi.edu/in-notes/rfc4642.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="POP3">[POP3]</a></td>
<td class="author-text"><a href="mailto:jgm+@cmu.edu">Myers, J.</a> and <a href="mailto:mrose@dbc.mtview.ca.us">M. Rose</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1939">Post Office Protocol - Version 3</a>,&rdquo; STD&nbsp;53, RFC&nbsp;1939, May&nbsp;1996 (<a href="ftp://ftp.isi.edu/in-notes/rfc1939.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2459">[RFC2459]</a></td>
<td class="author-text"><a href="mailto:housley@spyrus.com">Housley, R.</a>, <a href="mailto:wford@verisign.com">Ford, W.</a>, <a href="mailto:wpolk@nist.gov">Polk, T.</a>, and <a href="mailto:david.solo@citicorp.com">D. Solo</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2459">Internet X.509 Public Key Infrastructure Certificate and CRL Profile</a>,&rdquo; RFC&nbsp;2459, January&nbsp;1999 (<a href="ftp://ftp.isi.edu/in-notes/rfc2459.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="SECTERMS">[SECTERMS]</a></td>
<td class="author-text">Shirey, R., &ldquo;<a href="http://tools.ietf.org/html/rfc4949">Internet Security Glossary, Version 2</a>,&rdquo; RFC&nbsp;4949, August&nbsp;2007 (<a href="ftp://ftp.isi.edu/in-notes/rfc4949.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="SIP">[SIP]</a></td>
<td class="author-text">Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;<a href="http://tools.ietf.org/html/rfc3261">SIP: Session Initiation Protocol</a>,&rdquo; RFC&nbsp;3261, June&nbsp;2002 (<a href="ftp://ftp.isi.edu/in-notes/rfc3261.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="SIP-CERTS">[SIP-CERTS]</a></td>
<td class="author-text">Gurbani, V., Lawrence, S., and B. Laboratories, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-sip-domain-certs-04.txt">Domain Certificates in the Session Initiation Protocol (SIP)</a>,&rdquo; draft-ietf-sip-domain-certs-04 (work in progress), May&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-sip-domain-certs-04.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="SIP-LOC">[SIP-LOC]</a></td>
<td class="author-text">Rosenberg, J. and H. Schulzrinne, &ldquo;<a href="http://tools.ietf.org/html/rfc3263">Session Initiation Protocol (SIP): Locating SIP Servers</a>,&rdquo; RFC&nbsp;3263, June&nbsp;2002 (<a href="ftp://ftp.isi.edu/in-notes/rfc3263.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="SMTP">[SMTP]</a></td>
<td class="author-text">Klensin, J., &ldquo;<a href="http://tools.ietf.org/html/rfc5321">Simple Mail Transfer Protocol</a>,&rdquo; RFC&nbsp;5321, October&nbsp;2008 (<a href="ftp://ftp.isi.edu/in-notes/rfc5321.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="SMTP-AUTH">[SMTP-AUTH]</a></td>
<td class="author-text">Siemborski, R. and A. Melnikov, &ldquo;<a href="http://tools.ietf.org/html/rfc4954">SMTP Service Extension for Authentication</a>,&rdquo; RFC&nbsp;4954, July&nbsp;2007 (<a href="ftp://ftp.isi.edu/in-notes/rfc4954.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="SMTP-TLS">[SMTP-TLS]</a></td>
<td class="author-text">Hoffman, P., &ldquo;<a href="http://tools.ietf.org/html/rfc3207">SMTP Service Extension for Secure SMTP over Transport Layer Security</a>,&rdquo; RFC&nbsp;3207, February&nbsp;2002 (<a href="ftp://ftp.isi.edu/in-notes/rfc3207.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="SYSLOG">[SYSLOG]</a></td>
<td class="author-text">Gerhards, R., &ldquo;<a href="http://tools.ietf.org/html/rfc5424">The Syslog Protocol</a>,&rdquo; RFC&nbsp;5424, March&nbsp;2009 (<a href="ftp://ftp.isi.edu/in-notes/rfc5424.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="SYSLOG-TLS">[SYSLOG-TLS]</a></td>
<td class="author-text">Miao, F., Ma, Y., and J. Salowey, &ldquo;<a href="http://tools.ietf.org/html/rfc5425">Transport Layer Security (TLS) Transport Mapping for Syslog</a>,&rdquo; RFC&nbsp;5425, March&nbsp;2009 (<a href="ftp://ftp.isi.edu/in-notes/rfc5425.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="TLS">[TLS]</a></td>
<td class="author-text">Dierks, T. and E. Rescorla, &ldquo;<a href="http://tools.ietf.org/html/rfc5246">The Transport Layer Security (TLS) Protocol Version 1.2</a>,&rdquo; RFC&nbsp;5246, August&nbsp;2008 (<a href="ftp://ftp.isi.edu/in-notes/rfc5246.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="URI">[URI]</a></td>
<td class="author-text"><a href="mailto:timbl@w3.org">Berners-Lee, T.</a>, <a href="mailto:fielding@gbiv.com">Fielding, R.</a>, and <a href="mailto:LMM@acm.org">L. Masinter</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc3986">Uniform Resource Identifier (URI): Generic Syntax</a>,&rdquo; STD&nbsp;66, RFC&nbsp;3986, January&nbsp;2005 (<a href="ftp://ftp.isi.edu/in-notes/rfc3986.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc3986.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc3986.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="USINGTLS">[USINGTLS]</a></td>
<td class="author-text"><a href="mailto:chris.newman@innosoft.com">Newman, C.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2595">Using TLS with IMAP, POP3 and ACAP</a>,&rdquo; RFC&nbsp;2595, June&nbsp;1999 (<a href="ftp://ftp.isi.edu/in-notes/rfc2595.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="XMPP">[XMPP]</a></td>
<td class="author-text"><a href="mailto:stpeter@jabber.org">Saint-Andre, P., Ed.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc3920">Extensible Messaging and Presence Protocol (XMPP): Core</a>,&rdquo; RFC&nbsp;3920, October&nbsp;2004 (<a href="ftp://ftp.isi.edu/in-notes/rfc3920.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc3920.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc3920.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="XMPPBIS">[XMPPBIS]</a></td>
<td class="author-text">Saint-Andre, P., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-xmpp-3920bis-04.txt">Extensible Messaging and Presence Protocol (XMPP): Core</a>,&rdquo; draft-ietf-xmpp-3920bis-04 (work in progress), November&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-xmpp-3920bis-04.txt">TXT</a>).</td></tr>
</table>

<a name="prior"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Prior Art</h3>

<p>This section is non-normative.
</p>
<p>The recommendations in this document are an abstraction from recommendations in specifications for a wide range of application protocols.  For the purpose of comparison and to delineate the history of thinking about server identity verification within the IETF, this informative section gathers together prior art by including the exact text from various RFCs (the only modifications are changes to the names of several references to maintain coherence with the main body of this document, and the elision of irrelevant text as marked by the characters "[...]").
</p>
<a name="prior-imap"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1"></a><h3>A.1.&nbsp;
IMAP, POP3, and ACAP (1999)</h3>

<p>In 1999, <a class='info' href='#USINGTLS'>[USINGTLS]<span> (</span><span class='info'>Newman, C., &ldquo;Using TLS with IMAP, POP3 and ACAP,&rdquo; June&nbsp;1999.</span><span>)</span></a> specified the following text regarding server identity verification in IMAP, POP3, and ACAP:
</p>
<p>######
</p>
<p>2.4. Server Identity Check
</p>
<p>During the TLS negotiation, the client MUST check its understanding of the server hostname against the server's identity as presented in the server Certificate message, in order to prevent man-in-the-middle attacks.  Matching is performed according to these rules:
</p>
<p>
          </p>
<ul class="text">
<li>The client MUST use the server hostname it used to open the connection as the value to compare against the server name as expressed in the server certificate.  The client MUST NOT use any form of the server hostname derived from an insecure remote source (e.g., insecure DNS lookup).  CNAME canonicalization is not done.
</li>
<li>If a subjectAltName extension of type dNSName is present in the certificate, it SHOULD be used as the source of the server's identity.
</li>
<li>Matching is case-insensitive.
</li>
<li>A "*" wildcard character MAY be used as the left-most name component in the certificate.  For example, *.example.com would match a.example.com, foo.example.com, etc. but would not match example.com.
</li>
<li>If the certificate contains multiple names (e.g. more than one dNSName field), then a match with any one of the fields is considered acceptable.
</li>
</ul><p>
        
</p>
<p>If the match fails, the client SHOULD either ask for explicit user confirmation, or terminate the connection and indicate the server's identity is suspect.
</p>
<p>######
</p>
<a name="prior-http"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.2"></a><h3>A.2.&nbsp;
HTTP (2000)</h3>

<p>In 2000, <a class='info' href='#HTTP-TLS'>[HTTP&#8209;TLS]<span> (</span><span class='info'>Rescorla, E., &ldquo;HTTP Over TLS,&rdquo; May&nbsp;2000.</span><span>)</span></a> specified the following text regarding server identity verification in HTTP:
</p>
<p>######
</p>
<p>3.1. Server Identity
</p>
<p>In general, HTTP/TLS requests are generated by dereferencing a URI.  As a consequence, the hostname for the server is known to the client.  If the hostname is available, the client MUST check it against the server's identity as presented in the server's Certificate message, in order to prevent man-in-the-middle attacks.
</p>
<p>If the client has external information as to the expected identity of the server, the hostname check MAY be omitted. (For instance, a client may be connecting to a machine whose address and hostname are dynamic but the client knows the certificate that the server will present.) In such cases, it is important to narrow the scope of acceptable certificates as much as possible in order to prevent man in the middle attacks.  In special cases, it may be appropriate for the client to simply ignore the server's identity, but it must be understood that this leaves the connection open to active attack.
</p>
<p>If a subjectAltName extension of type dNSName is present, that MUST be used as the identity. Otherwise, the (most specific) Common Name field in the Subject field of the certificate MUST be used. Although the use of the Common Name is existing practice, it is deprecated and Certification Authorities are encouraged to use the dNSName instead.
</p>
<p>Matching is performed using the matching rules specified by <a class='info' href='#RFC2459'>[RFC2459]<span> (</span><span class='info'>Housley, R., Ford, W., Polk, T., and D. Solo, &ldquo;Internet X.509 Public Key Infrastructure Certificate and CRL Profile,&rdquo; January&nbsp;1999.</span><span>)</span></a>.  If more than one identity of a given type is present in the certificate (e.g., more than one dNSName name, a match in any one of the set is considered acceptable.) Names may contain the wildcard character * which is considered to match any single domain name component or component fragment. E.g., *.a.com matches foo.a.com but not bar.foo.a.com. f*.com matches foo.com but not bar.com.
</p>
<p>In some cases, the URI is specified as an IP address rather than a hostname. In this case, the iPAddress subjectAltName must be present in the certificate and must exactly match the IP in the URI.
</p>
<p>If the hostname does not match the identity in the certificate, user oriented clients MUST either notify the user (clients MAY give the user the opportunity to continue with the connection in any case) or terminate the connection with a bad certificate error. Automated clients MUST log the error to an appropriate audit log (if available) and SHOULD terminate the connection (with a bad certificate error).  Automated clients MAY provide a configuration setting that disables this check, but MUST provide a setting which enables it.
</p>
<p>Note that in many cases the URI itself comes from an untrusted source. The above-described check provides no protection against attacks where this source is compromised. For example, if the URI was obtained by clicking on an HTML page which was itself obtained without using HTTP/TLS, a man in the middle could have replaced the URI.  In order to prevent this form of attack, users should carefully examine the certificate presented by the server to determine if it meets their expectations.
</p>
<p>######
</p>
<a name="prior-ldap"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.3"></a><h3>A.3.&nbsp;
LDAP (2000/2006)</h3>

<p>In 2000, <a class='info' href='#LDAP-TLS'>[LDAP&#8209;TLS]<span> (</span><span class='info'>Hodges, J., Morgan, R., and M. Wahl, &ldquo;Lightweight Directory Access Protocol (v3): Extension for Transport Layer Security,&rdquo; May&nbsp;2000.</span><span>)</span></a> specified the following text regarding server identity verification in LDAP:
</p>
<p>######
</p>
<p>3.6. Server Identity Check
</p>
<p>The client MUST check its understanding of the server's hostname against the server's identity as presented in the server's Certificate message, in order to prevent man-in-the-middle attacks.
</p>
<p>Matching is performed according to these rules:
</p>
<p>
          </p>
<ul class="text">
<li>The client MUST use the server hostname it used to open the LDAP connection as the value to compare against the server name as expressed in the server's certificate.  The client MUST NOT use the server's canonical DNS name or any other derived form of name.
</li>
<li>If a subjectAltName extension of type dNSName is present in the certificate, it SHOULD be used as the source of the server's identity.
</li>
<li>Matching is case-insensitive.
</li>
<li>The "*" wildcard character is allowed.  If present, it applies only to the left-most name component.
</li>
</ul><p>
        
</p>
<p>E.g. *.bar.com would match a.bar.com, b.bar.com, etc. but not bar.com.  If more than one identity of a given type is present in the certificate (e.g. more than one dNSName name), a match in any one of the set is considered acceptable.
</p>
<p>If the hostname does not match the dNSName-based identity in the certificate per the above check, user-oriented clients SHOULD either notify the user (clients MAY give the user the opportunity to continue with the connection in any case) or terminate the connection and indicate that the server's identity is suspect. Automated clients SHOULD close the connection, returning and/or logging an error indicating that the server's identity is suspect.
</p>
<p>Beyond the server identity checks described in this section, clients SHOULD be prepared to do further checking to ensure that the server is authorized to provide the service it is observed to provide. The client MAY need to make use of local policy information.
</p>
<p>######
</p>
<p>In 2006, <a class='info' href='#LDAP-AUTH'>[LDAP&#8209;AUTH]<span> (</span><span class='info'>Harrison, R., &ldquo;Lightweight Directory Access Protocol (LDAP): Authentication Methods and Security Mechanisms,&rdquo; June&nbsp;2006.</span><span>)</span></a> specified the following text regarding server identity verification in LDAP:
</p>
<p>######
</p>
<p>3.1.3. Server Identity Check
</p>
<p>In order to prevent man-in-the-middle attacks, the client MUST verify the server's identity (as presented in the server's Certificate message).  In this section, the client's understanding of the server's identity (typically the identity used to establish the transport connection) is called the "reference identity".
</p>
<p>The client determines the type (e.g., DNS name or IP address) of the reference identity and performs a comparison between the reference identity and each subjectAltName value of the corresponding type until a match is produced.  Once a match is produced, the server's identity has been verified, and the server identity check is complete.  Different subjectAltName types are matched in different ways.  Sections 3.1.3.1 - 3.1.3.3 explain how to compare values of various subjectAltName types.
</p>
<p>The client may map the reference identity to a different type prior to performing a comparison.  Mappings may be performed for all available subjectAltName types to which the reference identity can be mapped; however, the reference identity should only be mapped to types for which the mapping is either inherently secure (e.g., extracting the DNS name from a URI to compare with a subjectAltName of type dNSName) or for which the mapping is performed in a secure manner (e.g., using <a class='info' href='#DNSSEC'>[DNSSEC]<span> (</span><span class='info'>Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose, &ldquo;DNS Security Introduction and Requirements,&rdquo; March&nbsp;2005.</span><span>)</span></a>, or using user- or admin-configured host-to-address/address-to-host lookup tables).
</p>
<p>The server's identity may also be verified by comparing the reference identity to the Common Name (CN) <a class='info' href='#LDAP-SCHEMA'>[LDAP&#8209;SCHEMA]<span> (</span><span class='info'>Sciberras, A., &ldquo;Lightweight Directory Access Protocol (LDAP): Schema for User Applications,&rdquo; June&nbsp;2006.</span><span>)</span></a> value in the leaf Relative Distinguished Name (RDN) of the subjectName field of the server's certificate.  This comparison is performed using the rules for comparison of DNS names in Section 3.1.3.1, below, with the exception that no wildcard matching is allowed.  Although the use of the Common Name value is existing practice, it is deprecated, and Certification Authorities are encouraged to provide subjectAltName values instead.  Note that the TLS implementation may represent DNs in certificates according to X.500 or other conventions.  For example, some X.500 implementations order the RDNs in a DN using a left-to-right (most significant to least significant) convention instead of LDAP's right-to-left convention.
</p>
<p>If the server identity check fails, user-oriented clients SHOULD either notify the user (clients may give the user the opportunity to continue with the LDAP session in this case) or close the transport connection and indicate that the server's identity is suspect.  Automated clients SHOULD close the transport connection and then return or log an error indicating that the server's identity is suspect or both.
</p>
<p>Beyond the server identity check described in this section, clients should be prepared to do further checking to ensure that the server is authorized to provide the service it is requested to provide.  The client may need to make use of local policy information in making this determination.
</p>
<p>3.1.3.1. Comparison of DNS Names
</p>
<p>If the reference identity is an internationalized domain name, conforming implementations MUST convert it to the ASCII Compatible Encoding (ACE) format as specified in Section 4 of RFC 3490 <a class='info' href='#IDNA2003'>[IDNA2003]<span> (</span><span class='info'>Faltstrom, P., Hoffman, P., and A. Costello, &ldquo;Internationalizing Domain Names in Applications (IDNA),&rdquo; March&nbsp;2003.</span><span>)</span></a> before comparison with subjectAltName values of type dNSName.  Specifically, conforming implementations MUST perform the conversion operation specified in Section 4 of RFC 3490 as follows:
</p>
<p>
          </p>
<ul class="text">
<li>in step 1, the domain name SHALL be considered a "stored string";
</li>
<li>in step 3, set the flag called "UseSTD3ASCIIRules";
</li>
<li>in step 4, process each label with the "ToASCII" operation; and
</li>
<li>in step 5, change all label separators to U+002E (full stop).
</li>
</ul><p>
        
</p>
<p>After performing the "to-ASCII" conversion, the DNS labels and names MUST be compared for equality according to the rules specified in Section 3 of RFC3490.
</p>
<p>The '*' (ASCII 42) wildcard character is allowed in subjectAltName values of type dNSName, and then only as the left-most (least significant) DNS label in that value.  This wildcard matches any left-most DNS label in the server name.  That is, the subject *.example.com matches the server names a.example.com and b.example.com, but does not match example.com or a.b.example.com.
</p>
<p>3.1.3.2. Comparison of IP Addresses
</p>
<p>When the reference identity is an IP address, the identity MUST be converted to the "network byte order" octet string representation <a class='info' href='#IP'>[IP]<span> (</span><span class='info'>Postel, J., &ldquo;Internet Protocol,&rdquo; September&nbsp;1981.</span><span>)</span></a> <a class='info' href='#IPv6'>[IPv6]<span> (</span><span class='info'>Deering, S. and R. Hinden, &ldquo;Internet Protocol, Version 6 (IPv6) Specification,&rdquo; December&nbsp;1998.</span><span>)</span></a>.  For IP Version 4, as specified in RFC 791, the octet string will contain exactly four octets.  For IP Version 6, as specified in RFC 2460, the octet string will contain exactly sixteen octets.  This octet string is then compared against subjectAltName values of type iPAddress.  A match occurs if the reference identity octet string and value octet strings are identical.
</p>
<p>3.1.3.3. Comparison of Other subjectName Types
</p>
<p>Client implementations MAY support matching against subjectAltName values of other types as described in other documents.
</p>
<p>######
</p>
<a name="prior-smtp"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.4"></a><h3>A.4.&nbsp;
SMTP (2002/2007)</h3>

<p>In 2002, <a class='info' href='#SMTP-TLS'>[SMTP&#8209;TLS]<span> (</span><span class='info'>Hoffman, P., &ldquo;SMTP Service Extension for Secure SMTP over Transport Layer Security,&rdquo; February&nbsp;2002.</span><span>)</span></a> specified the following text regarding server identity verification in SMTP:
</p>
<p>######
</p>
<p>4.1 Processing After the STARTTLS Command
</p>
<p>[...]
</p>
<p>The decision of whether or not to believe the authenticity of the other party in a TLS negotiation is a local matter.  However, some general rules for the decisions are:
</p>
<p>
          </p>
<ul class="text">
<li>A SMTP client would probably only want to authenticate an SMTP server whose server certificate has a domain name that is the domain name that the client thought it was connecting to.
</li>
</ul><p>
        
</p>
<p>[...]
</p>
<p>######
</p>
<p>In 2006, <a class='info' href='#SMTP-AUTH'>[SMTP&#8209;AUTH]<span> (</span><span class='info'>Siemborski, R. and A. Melnikov, &ldquo;SMTP Service Extension for Authentication,&rdquo; July&nbsp;2007.</span><span>)</span></a> specified the following text regarding server identity verification in SMTP:
</p>
<p>######
</p>
<p>14. Additional Requirements When Using SASL PLAIN over TLS
</p>
<p>[...]
</p>
<p>After a successful <a class='info' href='#TLS'>[TLS]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a> negotiation, the client MUST check its understanding of the server hostname against the server's identity as presented in the server Certificate message, in order to prevent man-in-the-middle attacks.  If the match fails, the client MUST NOT attempt to authenticate using the SASL PLAIN mechanism.  Matching is performed according to the following rules:
</p>
<p>
          </p>
<blockquote class="text">
<p>The client MUST use the server hostname it used to open the connection as the value to compare against the server name as expressed in the server certificate.  The client MUST NOT use any form of the server hostname derived from an insecure remote source (e.g., insecure DNS lookup).  CNAME canonicalization is not done.
</p>
<p>If a subjectAltName extension of type dNSName is present in the certificate, it SHOULD be used as the source of the server's identity.
</p>
<p>Matching is case-insensitive.
</p>
<p>A "*" wildcard character MAY be used as the leftmost name component in the certificate.  For example, *.example.com would match a.example.com, foo.example.com, etc., but would not match example.com.
</p>
<p>If the certificate contains multiple names (e.g., more than one dNSName field), then a match with any one of the fields is considered acceptable.
</p>
</blockquote><p>
        
</p>
<p>######
</p>
<a name="prior-xmpp"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.5"></a><h3>A.5.&nbsp;
XMPP (2004)</h3>

<p>In 2004, <a class='info' href='#XMPP'>[XMPP]<span> (</span><span class='info'>Saint-Andre, P., Ed., &ldquo;Extensible Messaging and Presence Protocol (XMPP): Core,&rdquo; October&nbsp;2004.</span><span>)</span></a> specified the following text regarding server identity verification in XMPP:
</p>
<p>######
</p>
<p>14.2. Certificate Validation
</p>
<p>When an XMPP peer communicates with another peer securely, it MUST validate the peer's certificate.  There are three possible cases:
</p>
<p>
          </p>
<blockquote class="text"><dl>
<dt>Case #1:</dt>
<dd>The peer contains an End Entity certificate which appears to be certified by a chain of certificates terminating in a trust anchor (as described in Section 6.1 of <a class='info' href='#X509'>[X509]<span> (</span><span class='info'>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; May&nbsp;2008.</span><span>)</span></a>).
</dd>
<dt>Case #2:</dt>
<dd>The peer certificate is certified by a Certificate Authority not known to the validating peer.
</dd>
<dt>Case #3:</dt>
<dd>The peer certificate is self-signed.
</dd>
</dl></blockquote><p>
        
</p>
<p>In Case #1, the validating peer MUST do one of two things:
          </p>
<ol class="text">
<li>Verify the peer certificate according to the rules of <a class='info' href='#X509'>[X509]<span> (</span><span class='info'>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; May&nbsp;2008.</span><span>)</span></a>.  The certificate SHOULD then be checked against the expected identity of the peer following the rules described in <a class='info' href='#HTTP-TLS'>[HTTP&#8209;TLS]<span> (</span><span class='info'>Rescorla, E., &ldquo;HTTP Over TLS,&rdquo; May&nbsp;2000.</span><span>)</span></a>, except that a subjectAltName extension of type "xmpp" MUST be used as the identity if present.  If one of these checks fails, user-oriented clients MUST either notify the user (clients MAY give the user the opportunity to continue with the connection in any case) or terminate the connection with a bad certificate error.  Automated clients SHOULD terminate the connection (with a bad certificate error) and log the error to an appropriate audit log.  Automated clients MAY provide a configuration setting that disables this check, but MUST provide a setting that enables it.
</li>
<li>The peer SHOULD show the certificate to a user for approval, including the entire certificate chain.  The peer MUST cache the certificate (or some non-forgeable representation such as a hash).  In future connections, the peer MUST verify that the same certificate was presented and MUST notify the user if it has changed.
</li>
</ol><p>
        
</p>
<p>In Case #2 and Case #3, implementations SHOULD act as in (2) above.
</p>
<p>######
</p>
<p>At the time of this writing, <a class='info' href='#XMPPBIS'>[XMPPBIS]<span> (</span><span class='info'>Saint-Andre, P., &ldquo;Extensible Messaging and Presence Protocol (XMPP): Core,&rdquo; November&nbsp;2009.</span><span>)</span></a> refers to this document for rules regarding server identity verification in XMPP.
</p>
<a name="prior-nntp"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.6"></a><h3>A.6.&nbsp;
NNTP (2006)</h3>

<p>In 2006, <a class='info' href='#NNTP-TLS'>[NNTP&#8209;TLS]<span> (</span><span class='info'>Murchison, K., Vinocur, J., and C. Newman, &ldquo;Using Transport Layer Security (TLS) with Network News Transfer Protocol (NNTP),&rdquo; October&nbsp;2006.</span><span>)</span></a> specified the following text regarding server identity verification in NNTP:
</p>
<p>######
</p>
<p>5. Security Considerations
</p>
<p>[...]
</p>
<p>During the TLS negotiation, the client MUST check its understanding of the server hostname against the server's identity as presented in the server Certificate message, in order to prevent man-in-the-middle attacks.  Matching is performed according to these rules:
</p>
<p>
          </p>
<ul class="text">
<li>The client MUST use the server hostname it used to open the connection (or the hostname specified in TLS "server_name" extension <a class='info' href='#TLS'>[TLS]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a>) as the value to compare against the server name as expressed in the server certificate.  The client MUST NOT use any form of the server hostname derived from an insecure remote source (e.g., insecure DNS lookup).  CNAME canonicalization is not done.
</li>
<li>If a subjectAltName extension of type dNSName is present in the certificate, it SHOULD be used as the source of the server's identity.
</li>
<li>Matching is case-insensitive.
</li>
<li>A "*" wildcard character MAY be used as the left-most name component in the certificate.  For example, *.example.com would match a.example.com, foo.example.com, etc., but would not match example.com.
</li>
<li>If the certificate contains multiple names (e.g., more than one dNSName field), then a match with any one of the fields is considered acceptable.
</li>
</ul><p>
        
</p>
<p>If the match fails, the client SHOULD either ask for explicit user confirmation or terminate the connection with a QUIT command and indicate the server's identity is suspect.
</p>
<p> Additionally, clients MUST verify the binding between the identity of the servers to which they connect and the public keys presented by those servers.  Clients SHOULD implement the algorithm in Section 6 of <a class='info' href='#X509'>[X509]<span> (</span><span class='info'>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; May&nbsp;2008.</span><span>)</span></a> for general certificate validation, but MAY supplement that algorithm with other validation methods that achieve equivalent levels of verification (such as comparing the server certificate against a local store of already-verified certificates and identity bindings).
</p>
<p>######
</p>
<a name="prior-netconf"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.7"></a><h3>A.7.&nbsp;
NETCONF (2006/2009)</h3>

<p>In 2006, <a class='info' href='#NETCONF-SSH'>[NETCONF&#8209;SSH]<span> (</span><span class='info'>Wasserman, M. and T. Goddard, &ldquo;Using the NETCONF Configuration Protocol over Secure SHell (SSH),&rdquo; December&nbsp;2006.</span><span>)</span></a> specified the following text regarding server identity verification in NETCONF:
</p>
<p>######
</p>
<p>6. Security Considerations
</p>
<p>The identity of the server MUST be verified and authenticated by the client according to local policy before password-based authentication data or any configuration or state data is sent to or received from the server.  The identity of the client MUST also be verified and authenticated by the server according to local policy to ensure that the incoming client request is legitimate before any configuration or state data is sent to or received from the client.  Neither side should establish a NETCONF over SSH connection with an unknown, unexpected, or incorrect identity on the opposite side.
</p>
<p>######
</p>
<p>In 2009, <a class='info' href='#NETCONF-TLS'>[NETCONF&#8209;TLS]<span> (</span><span class='info'>Badra, M., &ldquo;NETCONF over Transport Layer Security (TLS),&rdquo; May&nbsp;2009.</span><span>)</span></a> specified the following text regarding server identity verification in NETCONF:
</p>
<p>######
</p>
<p>3.1. Server Identity
</p>
<p>During the TLS negotiation, the client MUST carefully examine the certificate presented by the server to determine if it meets the client's expectations.  Particularly, the client MUST check its understanding of the server hostname against the server's identity as presented in the server Certificate message, in order to prevent man- in-the-middle attacks.
</p>
<p>Matching is performed according to the rules below (following the example of <a class='info' href='#NNTP-TLS'>[NNTP&#8209;TLS]<span> (</span><span class='info'>Murchison, K., Vinocur, J., and C. Newman, &ldquo;Using Transport Layer Security (TLS) with Network News Transfer Protocol (NNTP),&rdquo; October&nbsp;2006.</span><span>)</span></a>):
</p>
<p>
          </p>
<ul class="text">
<li>The client MUST use the server hostname it used to open the connection (or the hostname specified in the TLS "server_name" extension <a class='info' href='#TLS'>[TLS]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a>) as the value to compare against the server name as expressed in the server certificate.  The client MUST NOT use any form of the server hostname derived from an insecure remote source (e.g., insecure DNS lookup).  CNAME canonicalization is not done.
</li>
<li>If a subjectAltName extension of type dNSName is present in the certificate, it MUST be used as the source of the server's identity.
</li>
<li>Matching is case-insensitive.
</li>
<li>A "*" wildcard character MAY be used as the leftmost name component in the certificate.  For example, *.example.com would match a.example.com, foo.example.com, etc., but would not match example.com.
</li>
<li>If the certificate contains multiple names (e.g., more than one dNSName field), then a match with any one of the fields is considered acceptable.
</li>
</ul><p>
        
</p>
<p>If the match fails, the client MUST either ask for explicit user confirmation or terminate the connection and indicate the server's identity is suspect.
</p>
<p>Additionally, clients MUST verify the binding between the identity of the servers to which they connect and the public keys presented by those servers.  Clients SHOULD implement the algorithm in Section 6 of <a class='info' href='#X509'>[X509]<span> (</span><span class='info'>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; May&nbsp;2008.</span><span>)</span></a> for general certificate validation, but MAY supplement that algorithm with other validation methods that achieve equivalent levels of verification (such as comparing the server certificate against a local store of already-verified certificates and identity bindings).
</p>
<p>If the client has external information as to the expected identity of the server, the hostname check MAY be omitted.
</p>
<p>######
</p>
<a name="prior-syslog"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.8"></a><h3>A.8.&nbsp;
Syslog (2009)</h3>

<p>In 2009, <a class='info' href='#SYSLOG-TLS'>[SYSLOG&#8209;TLS]<span> (</span><span class='info'>Miao, F., Ma, Y., and J. Salowey, &ldquo;Transport Layer Security (TLS) Transport Mapping for Syslog,&rdquo; March&nbsp;2009.</span><span>)</span></a> specified the following text regarding server identity verification in Syslog:
</p>
<p>######
</p>
<p>5.2. Subject Name Authorization
</p>
<p>Implementations MUST support certification path validation <a class='info' href='#X509'>[X509]<span> (</span><span class='info'>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; May&nbsp;2008.</span><span>)</span></a>.  In addition, they MUST support specifying the authorized peers using locally configured host names and matching the name against the certificate as follows.
</p>
<p>
          </p>
<ul class="text">
<li>Implementations MUST support matching the locally configured host name against a dNSName in the subjectAltName extension field and SHOULD support checking the name against the common name portion of the subject distinguished name.
</li>
<li>The '*' (ASCII 42) wildcard character is allowed in the dNSName of the subjectAltName extension (and in common name, if used to store the host name), but only as the left-most (least significant) DNS label in that value.  This wildcard matches any left-most DNS label in the server name.  That is, the subject *.example.com matches the server names a.example.com and b.example.com, but does not match example.com or a.b.example.com.  Implementations MUST support wildcards in certificates as specified above, but MAY provide a configuration option to disable them.
</li>
<li>Locally configured names MAY contain the wildcard character to match a range of values.  The types of wildcards supported MAY be more flexible than those allowed in subject names, making it possible to support various policies for different environments.  For example, a policy could allow for a trust-root-based authorization where all credentials issued by a particular CA trust root are authorized.
</li>
<li>If the locally configured name is an internationalized domain name, conforming implementations MUST convert it to the ASCII Compatible Encoding (ACE) format for performing comparisons, as specified in Section 7 of <a class='info' href='#X509'>[X509]<span> (</span><span class='info'>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; May&nbsp;2008.</span><span>)</span></a>.
</li>
<li>Implementations MAY support matching a locally configured IP address against an iPAddress stored in the subjectAltName extension.  In this case, the locally configured IP address is converted to an octet string as specified in <a class='info' href='#X509'>[X509]<span> (</span><span class='info'>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; May&nbsp;2008.</span><span>)</span></a>, Section 4.2.1.6.  A match occurs if this octet string is equal to the value of iPAddress in the subjectAltName extension.
</li>
</ul><p>
        
</p>
<p>######
</p>
<a name="prior-sip"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.9"></a><h3>A.9.&nbsp;
SIP (2010)</h3>

<p>At the time of this writing, <a class='info' href='#SIP-CERTS'>[SIP&#8209;CERTS]<span> (</span><span class='info'>Gurbani, V., Lawrence, S., and B. Laboratories, &ldquo;Domain Certificates in the Session Initiation Protocol (SIP),&rdquo; May&nbsp;2009.</span><span>)</span></a> specified text regarding server identity verification in the Session Initiation Protocol (SIP).  However, that specification has not yet been approved by the IESG and text cannot be considered final.
</p>
<p>The relevant text follows.
</p>
<p>######
</p>
<p>7.2. Comparing SIP Identities
</p>
<p>When an implementation (either client or server) compares two values as SIP domain identities:

</p>
<blockquote class="text">
<p>Implementations MUST compare only the DNS name component of each SIP domain identifier; 
an implementation MUST NOT use any scheme or parameters in the
comparison.
</p>
<p>Implementations MUST compare the values as DNS names, which means that the
comparison is case insensitive as specified by <a class='info' href='#DNS-CASE'>[DNS&#8209;CASE]<span> (</span><span class='info'>Eastlake, D., &ldquo;Domain Name System (DNS) Case Insensitivity Clarification,&rdquo; January&nbsp;2006.</span><span>)</span></a>.  
Implementations MUST handle Internationalized Domain Names (IDNs)
in accordance with Section 7.2 of <a class='info' href='#X509'>[X509]<span> (</span><span class='info'>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; May&nbsp;2008.</span><span>)</span></a>.
</p>
<p>Implementations MUST match the values in their entirety:
</p>
<blockquote class="text">
<p>Implementations MUST NOT match suffixes.  For example,
"foo.example.com" does not match "example.com".
</p>
<p>Implemenations MUST NOT match any form of wildcard, such as a leading "." or "*." with any other DNS label or sequence of labels.  For example, "*.example.com" matches only "*.example.com" but not "foo.example.com".   Similarly, ".example.com" matches only ".example.com", and does not match "foo.example.com."

 </p>
<blockquote class="text">
<p><a class='info' href='#HTTP-TLS'>[HTTP&#8209;TLS]<span> (</span><span class='info'>Rescorla, E., &ldquo;HTTP Over TLS,&rdquo; May&nbsp;2000.</span><span>)</span></a> allows the dNSName 
  component to contain a wildcard; e.g., "DNS:*.example.com".  
  <a class='info' href='#X509'>[X509]<span> (</span><span class='info'>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; May&nbsp;2008.</span><span>)</span></a>, while not disallowing this 
  explicitly, leaves the interpretation of wildcards to the individual 
  specification.  <a class='info' href='#SIP'>[SIP]<span> (</span><span class='info'>Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;SIP: Session Initiation Protocol,&rdquo; June&nbsp;2002.</span><span>)</span></a> does not provide any 
  guidelines on the presence of wildcards in certificates.  Through the rule above, this document
  prohibits such wildcards in certificates for SIP domains.
</p>
</blockquote>


</blockquote>


</blockquote><p>

</p>
<p>######
</p>
<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Peter Saint-Andre (editor)</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:psaintan@cisco.com">psaintan@cisco.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Jeff Hodges (editor)</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">PayPal</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:Jeff.Hodges@PayPal.com">Jeff.Hodges@PayPal.com</a></td></tr>
</table>
</body></html>
