<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>The Tunneled Extensible Authentication Method (TEAM)</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.2" rel="Chapter" title="2 Requirements Language">
<link href="#rfc.section.3" rel="Chapter" title="3 Terminology">
<link href="#rfc.section.4" rel="Chapter" title="4 Protocol Overview">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 Operational Model">
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 Sequences">
<link href="#rfc.section.4.3" rel="Chapter" title="4.3 TEAM Phase 1">
<link href="#rfc.section.4.3.1" rel="Chapter" title="4.3.1 Initial identity exchange">
<link href="#rfc.section.4.3.2" rel="Chapter" title="4.3.2 TLS Session Establishment">
<link href="#rfc.section.4.3.3" rel="Chapter" title="4.3.3 Session Resumption">
<link href="#rfc.section.4.3.4" rel="Chapter" title="4.3.4 Version Negotiation">
<link href="#rfc.section.4.4" rel="Chapter" title="4.4 TEAM Phase 2">
<link href="#rfc.section.4.4.1" rel="Chapter" title="4.4.1 Protected Conversation">
<link href="#rfc.section.4.4.2" rel="Chapter" title="4.4.2 Protected Termination">
<link href="#rfc.section.4.4.3" rel="Chapter" title="4.4.3 Provisioning of Credentials">
<link href="#rfc.section.4.4.3.1" rel="Chapter" title="4.4.3.1 Provisioning Inside a Server Authenticated TLS Tunnel">
<link href="#rfc.section.4.4.3.2" rel="Chapter" title="4.4.3.2 Provisioning Inside a Server Unauthenticated TLS Tunnel">
<link href="#rfc.section.4.5" rel="Chapter" title="4.5 Error Handling">
<link href="#rfc.section.4.6" rel="Chapter" title="4.6 Fragmentation and Reassembly">
<link href="#rfc.section.4.7" rel="Chapter" title="4.7 Key Derivation">
<link href="#rfc.section.4.7.1" rel="Chapter" title="4.7.1 Compound Session Key Derivation">
<link href="#rfc.section.4.8" rel="Chapter" title="4.8 Ciphersuite Negotiation">
<link href="#rfc.section.5" rel="Chapter" title="5 TEAM Protocol Description">
<link href="#rfc.section.5.1" rel="Chapter" title="5.1 TEAM Protocol Layers">
<link href="#rfc.section.5.2" rel="Chapter" title="5.2 TEAM Packet Format">
<link href="#rfc.section.6" rel="Chapter" title="6 Type-Length-Value Tuples">
<link href="#rfc.section.6.1" rel="Chapter" title="6.1 TLV Format">
<link href="#rfc.section.6.2" rel="Chapter" title="6.2 Result TLV">
<link href="#rfc.section.6.3" rel="Chapter" title="6.3 NAK TLV">
<link href="#rfc.section.6.4" rel="Chapter" title="6.4 Error-Code TLV">
<link href="#rfc.section.6.5" rel="Chapter" title="6.5 Crypto-Binding TLV">
<link href="#rfc.section.6.6" rel="Chapter" title="6.6 Connection-Binding TLV">
<link href="#rfc.section.6.7" rel="Chapter" title="6.7 Vendor-Specific TLV">
<link href="#rfc.section.6.8" rel="Chapter" title="6.8 URI TLV">
<link href="#rfc.section.6.9" rel="Chapter" title="6.9 EAP-Payload TLV">
<link href="#rfc.section.6.10" rel="Chapter" title="6.10 Intermediate-Result TLV">
<link href="#rfc.section.6.11" rel="Chapter" title="6.11 Calling-Station-Id TLV">
<link href="#rfc.section.6.12" rel="Chapter" title="6.12 Called-Station-Id TLV">
<link href="#rfc.section.6.13" rel="Chapter" title="6.13 NAS-Port-Type TLV">
<link href="#rfc.section.6.14" rel="Chapter" title="6.14 Server-Identifier TLV">
<link href="#rfc.section.6.15" rel="Chapter" title="6.15 Identity-Type TLV">
<link href="#rfc.section.6.16" rel="Chapter" title="6.16 Server-Trusted-Root TLV">
<link href="#rfc.section.6.17" rel="Chapter" title="6.17 PKCS#7 TLV">
<link href="#rfc.section.6.18" rel="Chapter" title="6.18 Request-Action-TLV">
<link href="#rfc.section.6.19" rel="Chapter" title="6.19 TLV Rules">
<link href="#rfc.section.6.19.1" rel="Chapter" title="6.19.1 Outer TLVs">
<link href="#rfc.section.6.19.2" rel="Chapter" title="6.19.2 Inner TLVs">
<link href="#rfc.section.6.19.3" rel="Chapter" title="6.19.3 EAP-Payload TLV">
<link href="#rfc.section.6.19.4" rel="Chapter" title="6.19.4 Connection-Binding TLV">
<link href="#rfc.section.6.19.5" rel="Chapter" title="6.19.5 Server-Trusted-Root TLV">
<link href="#rfc.section.7" rel="Chapter" title="7 Security Considerations">
<link href="#rfc.section.7.1" rel="Chapter" title="7.1 Authentication and Integrity Protection">
<link href="#rfc.section.7.2" rel="Chapter" title="7.2 Method Negotiation">
<link href="#rfc.section.7.3" rel="Chapter" title="7.3 TLS Session Cache Handling">
<link href="#rfc.section.7.4" rel="Chapter" title="7.4 Certificate Revocation">
<link href="#rfc.section.7.5" rel="Chapter" title="7.5 Separation of EAP Server and Authenticator">
<link href="#rfc.section.7.6" rel="Chapter" title="7.6 Separation of TEAM Phase 1 and 2 Servers">
<link href="#rfc.section.7.7" rel="Chapter" title="7.7 Identity Verification">
<link href="#rfc.section.7.8" rel="Chapter" title="7.8 Man-in-the-Middle Attack Protection">
<link href="#rfc.section.7.9" rel="Chapter" title="7.9 Cleartext Forgeries">
<link href="#rfc.section.7.10" rel="Chapter" title="7.10 TLS Ciphersuites">
<link href="#rfc.section.7.11" rel="Chapter" title="7.11 Denial of Service Attacks">
<link href="#rfc.section.7.12" rel="Chapter" title="7.12 Server Unauthenticated Tunnel Provisioning Mode">
<link href="#rfc.section.7.13" rel="Chapter" title="7.13 Security Claims">
<link href="#rfc.section.8" rel="Chapter" title="8 IANA Considerations">
<link href="#rfc.section.8.1" rel="Chapter" title="8.1 EAP Type">
<link href="#rfc.section.8.2" rel="Chapter" title="8.2 TLV Types">
<link href="#rfc.section.8.3" rel="Chapter" title="8.3 TLV Values">
<link href="#rfc.section.9" rel="Chapter" title="9 Contributors">
<link href="#rfc.section.10" rel="Chapter" title="10 Acknowledgements">
<link href="#rfc.references" rel="Chapter" title="11 References">
<link href="#rfc.references.1" rel="Chapter" title="11.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="11.2 Informative References">
<link href="#rfc.appendix.Appendix%20A" rel="Chapter" title="Appendix A Compliance with Requirements for a Tunnel Based EAP Method">
<link href="#rfc.appendix.Appendix%20A.1" rel="Chapter" title="Appendix A.1 General Requirements">
<link href="#rfc.appendix.Appendix%20A.2" rel="Chapter" title="Appendix A.2 Tunnel Requirements">
<link href="#rfc.appendix.Appendix%20A.3" rel="Chapter" title="Appendix A.3 Tunnel Payload Requirements">
<link href="#rfc.appendix.Appendix%20A.4" rel="Chapter" title="Appendix A.4 Channel Binding Requirements">
<link href="#rfc.appendix.Appendix%20A.5" rel="Chapter" title="Appendix A.5 Username/Password Requirements">
<link href="#rfc.appendix.Appendix%20A.6" rel="Chapter" title="Appendix A.6 Requirements Around Carriage of EAP Methods">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="The Extensible Authentication Protocol (EAP) provides support for multiple authentication methods. This document defines the Tunneled Extensible Authentication Method (TEAM), which provides an encrypted and authenticated tunnel based on transport layer security (TLS) that encapsulates EAP authentication mechanisms.  TEAM uses TLS to protect against rogue authenticators, protect against various attacks on the confidentiality and integrity of the inner EAP method exchange and provide EAP peer identity privacy.  TEAM also provides support for chaining multiple EAP mechanisms, cryptographic binding between authentications performed by inner EAP mechanisms and the tunnel, exchange of arbitrary parameters (TLVs), and fragmentation and reassembly.  " />
  <meta name="description" content="The Extensible Authentication Protocol (EAP) provides support for multiple authentication methods. This document defines the Tunneled Extensible Authentication Method (TEAM), which provides an encrypted and authenticated tunnel based on transport layer security (TLS) that encapsulates EAP authentication mechanisms.  TEAM uses TLS to protect against rogue authenticators, protect against various attacks on the confidentiality and integrity of the inner EAP method exchange and provide EAP peer identity privacy.  TEAM also provides support for chaining multiple EAP mechanisms, cryptographic binding between authentications performed by inner EAP mechanisms and the tunnel, exchange of arbitrary parameters (TLVs), and fragmentation and reassembly.  " />
  <meta name="keywords" content="" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Network Working Group</td>
<td class="right">G. Zorn</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Network Zen</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">Q. Wu</td>
</tr>
<tr>
<td class="left">Expires: September 08, 2011</td>
<td class="right">Huawei</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">D.H. Harkins</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Aruba Networks</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">March 07, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">The Tunneled Extensible Authentication Method (TEAM)<br />
  <span class="filename">draft-zorn-emu-team-02</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>The Extensible Authentication Protocol (EAP) provides support for multiple authentication methods. This document defines the Tunneled Extensible Authentication Method (TEAM), which provides an encrypted and authenticated tunnel based on transport layer security (TLS) that encapsulates EAP authentication mechanisms.  TEAM uses TLS to protect against rogue authenticators, protect against various attacks on the confidentiality and integrity of the inner EAP method exchange and provide EAP peer identity privacy.  TEAM also provides support for chaining multiple EAP mechanisms, cryptographic binding between authentications performed by inner EAP mechanisms and the tunnel, exchange of arbitrary parameters (TLVs), and fragmentation and reassembly.  </p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on September 08, 2011.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>
<p>This document may not be modified, and derivative works of it may not be created, except to format it for publication as an RFC or to translate it into languages other than English.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>2.   <a href="#rfc.section.2">Requirements Language</a>
</li>
<li>3.   <a href="#rfc.section.3">Terminology</a>
</li>
<li>4.   <a href="#rfc.section.4">Protocol Overview</a>
</li>
<li>4.1.   <a href="#rfc.section.4.1">Operational Model</a>
</li>
<li>4.2.   <a href="#rfc.section.4.2">Sequences</a>
</li>
<li>4.3.   <a href="#rfc.section.4.3">TEAM Phase 1</a>
</li>
<li>4.3.1.   <a href="#rfc.section.4.3.1">Initial identity exchange</a>
</li>
<li>4.3.2.   <a href="#rfc.section.4.3.2">TLS Session Establishment</a>
</li>
<li>4.3.3.   <a href="#rfc.section.4.3.3">Session Resumption</a>
</li>
<li>4.3.4.   <a href="#rfc.section.4.3.4">Version Negotiation</a>
</li>
<li>4.4.   <a href="#rfc.section.4.4">TEAM Phase 2</a>
</li>
<li>4.4.1.   <a href="#rfc.section.4.4.1">Protected Conversation</a>
</li>
<li>4.4.2.   <a href="#rfc.section.4.4.2">Protected Termination</a>
</li>
<li>4.4.3.   <a href="#rfc.section.4.4.3">Provisioning of Credentials</a>
</li>
<li>4.4.3.1.   <a href="#rfc.section.4.4.3.1">Provisioning Inside a Server Authenticated TLS Tunnel</a>
</li>
<li>4.4.3.2.   <a href="#rfc.section.4.4.3.2">Provisioning Inside a Server Unauthenticated TLS Tunnel</a>
</li>
<li>4.5.   <a href="#rfc.section.4.5">Error Handling</a>
</li>
<li>4.6.   <a href="#rfc.section.4.6">Fragmentation and Reassembly</a>
</li>
<li>4.7.   <a href="#rfc.section.4.7">Key Derivation</a>
</li>
<li>4.7.1.   <a href="#rfc.section.4.7.1">Compound Session Key Derivation</a>
</li>
<li>4.8.   <a href="#rfc.section.4.8">Ciphersuite Negotiation</a>
</li>
<li>5.   <a href="#rfc.section.5">TEAM Protocol Description</a>
</li>
<li>5.1.   <a href="#rfc.section.5.1">TEAM Protocol Layers</a>
</li>
<li>5.2.   <a href="#rfc.section.5.2">TEAM Packet Format</a>
</li>
<li>6.   <a href="#rfc.section.6">Type-Length-Value Tuples</a>
</li>
<li>6.1.   <a href="#rfc.section.6.1">TLV Format</a>
</li>
<li>6.2.   <a href="#rfc.section.6.2">Result TLV</a>
</li>
<li>6.3.   <a href="#rfc.section.6.3">NAK TLV</a>
</li>
<li>6.4.   <a href="#rfc.section.6.4">Error-Code TLV</a>
</li>
<li>6.5.   <a href="#rfc.section.6.5">Crypto-Binding TLV</a>
</li>
<li>6.6.   <a href="#rfc.section.6.6">Connection-Binding TLV</a>
</li>
<li>6.7.   <a href="#rfc.section.6.7">Vendor-Specific TLV</a>
</li>
<li>6.8.   <a href="#rfc.section.6.8">URI TLV</a>
</li>
<li>6.9.   <a href="#rfc.section.6.9">EAP-Payload TLV</a>
</li>
<li>6.10.   <a href="#rfc.section.6.10">Intermediate-Result TLV</a>
</li>
<li>6.11.   <a href="#rfc.section.6.11">Calling-Station-Id TLV</a>
</li>
<li>6.12.   <a href="#rfc.section.6.12">Called-Station-Id TLV</a>
</li>
<li>6.13.   <a href="#rfc.section.6.13">NAS-Port-Type TLV</a>
</li>
<li>6.14.   <a href="#rfc.section.6.14">Server-Identifier TLV</a>
</li>
<li>6.15.   <a href="#rfc.section.6.15">Identity-Type TLV</a>
</li>
<li>6.16.   <a href="#rfc.section.6.16">Server-Trusted-Root TLV</a>
</li>
<li>6.17.   <a href="#rfc.section.6.17">PKCS#7 TLV</a>
</li>
<li>6.18.   <a href="#rfc.section.6.18">Request-Action-TLV</a>
</li>
<li>6.19.   <a href="#rfc.section.6.19">TLV Rules</a>
</li>
<li>6.19.1.   <a href="#rfc.section.6.19.1">Outer TLVs</a>
</li>
<li>6.19.2.   <a href="#rfc.section.6.19.2">Inner TLVs</a>
</li>
<li>6.19.3.   <a href="#rfc.section.6.19.3">EAP-Payload TLV</a>
</li>
<li>6.19.4.   <a href="#rfc.section.6.19.4">Connection-Binding TLV</a>
</li>
<li>6.19.5.   <a href="#rfc.section.6.19.5">Server-Trusted-Root TLV</a>
</li>
<li>7.   <a href="#rfc.section.7">Security Considerations</a>
</li>
<li>7.1.   <a href="#rfc.section.7.1">Authentication and Integrity Protection</a>
</li>
<li>7.2.   <a href="#rfc.section.7.2">Method Negotiation</a>
</li>
<li>7.3.   <a href="#rfc.section.7.3">TLS Session Cache Handling</a>
</li>
<li>7.4.   <a href="#rfc.section.7.4">Certificate Revocation</a>
</li>
<li>7.5.   <a href="#rfc.section.7.5">Separation of EAP Server and Authenticator</a>
</li>
<li>7.6.   <a href="#rfc.section.7.6">Separation of TEAM Phase 1 and 2 Servers</a>
</li>
<li>7.7.   <a href="#rfc.section.7.7">Identity Verification</a>
</li>
<li>7.8.   <a href="#rfc.section.7.8">Man-in-the-Middle Attack Protection</a>
</li>
<li>7.9.   <a href="#rfc.section.7.9">Cleartext Forgeries</a>
</li>
<li>7.10.   <a href="#rfc.section.7.10">TLS Ciphersuites</a>
</li>
<li>7.11.   <a href="#rfc.section.7.11">Denial of Service Attacks</a>
</li>
<li>7.12.   <a href="#rfc.section.7.12">Server Unauthenticated Tunnel Provisioning Mode</a>
</li>
<li>7.13.   <a href="#rfc.section.7.13">Security Claims</a>
</li>
<li>8.   <a href="#rfc.section.8">IANA Considerations</a>
</li>
<li>8.1.   <a href="#rfc.section.8.1">EAP Type</a>
</li>
<li>8.2.   <a href="#rfc.section.8.2">TLV Types</a>
</li>
<li>8.3.   <a href="#rfc.section.8.3">TLV Values</a>
</li>
<li>9.   <a href="#rfc.section.9">Contributors</a>
</li>
<li>10.   <a href="#rfc.section.10">Acknowledgements</a>
</li>
<li>11.   <a href="#rfc.references">References</a>
</li>
<li>11.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>11.2.   <a href="#rfc.references.2">Informative References</a>
</li>
<li>Appendix A.   <a href="#rfc.appendix.Appendix%20A">Compliance with Requirements for a Tunnel Based EAP Method</a>
</li>
<li>Appendix A.1.   <a href="#rfc.appendix.Appendix%20A.1">General Requirements</a>
</li>
<li>Appendix A.2.   <a href="#rfc.appendix.Appendix%20A.2">Tunnel Requirements</a>
</li>
<li>Appendix A.3.   <a href="#rfc.appendix.Appendix%20A.3">Tunnel Payload Requirements</a>
</li>
<li>Appendix A.4.   <a href="#rfc.appendix.Appendix%20A.4">Channel Binding Requirements</a>
</li>
<li>Appendix A.5.   <a href="#rfc.appendix.Appendix%20A.5">Username/Password Requirements</a>
</li>
<li>Appendix A.6.   <a href="#rfc.appendix.Appendix%20A.6">Requirements Around Carriage of EAP Methods</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> Introduction</h1>
<p id="rfc.section.1.p.1">The Extensible Authentication Protocol (EAP), defined in <a href="#RFC3748">[RFC3748]</a>, provides support for multiple authentication methods.  EAP over PPP	<a href="#RFC3748">[RFC3748]</a> is typically deployed with leased lines or modem connections.  <a href="#IEEE.802-1X.2004">[IEEE.802-1X.2004]</a> defines EAP over IEEE 802 local area networks (EAPOL).  <br><br> Since its initial development, a number of weaknesses in the EAP framework have become apparent.  These include lack of support for: <br><br> <br><br> In addition, some EAP methods lack the following features: <br><br> <br><br> By wrapping the EAP protocol within TLS, TEAM addresses deficiencies in EAP or EAP methods.  Benefits of TEAM include: <br><br> </p>

<ul class="empty">
<li>Identity protection</li>
<li>Protected method negotiation</li>
<li>Protected notification messages</li>
<li>Protected termination messages</li>
<li>Sequences of EAP methods</li>
<li>Fragmentation and reassembly</li>
<li>Exchange of arbitrary parameters in a secure channel</li>
<li>Optimized re-authentication</li>
</ul>

<p> </p>

<ul class="empty">
<li>Mutual authentication</li>
<li>Resistance to dictionary attacks</li>
<li>Adequate key generation</li>
</ul>

<p> </p>

<dl>
<dt>Identity protection</dt>
<dd style="margin-left: 8">
<br> By encrypting the identity exchange, and allowing client identity to be provided after negotiation of the TLS channel, TEAM provides for identity protection.  <br><br> </dd>
<dt>Dictionary attack resistance</dt>
<dd style="margin-left: 8">
<br> By conducting the EAP conversation within a TLS channel, TEAM protects EAP methods that might be subject to an offline dictionary attack were they to be conducted in the clear.  <br><br> </dd>
<dt>Protected negotiation</dt>
<dd style="margin-left: 8">
<br> Since within TEAM, the EAP conversation is authenticated, integrity and replay protected on a per-packet basis, the EAP method negotiation that occurs within TEAM is protected, as are error messages sent within the TLS channel (TLS alerts or EAP Notification packets).  EAP negotiation outside of TEAM is not protected.  <br><br> </dd>
<dt>Header protection</dt>
<dd style="margin-left: 8">
<br> Within TEAM, TLS provides per-packet encryption, authentication, integrity and replay protection for the EAP conversation. As a result, the Type-Data field within TEAM (including the EAP header of the EAP method within TEAM) is protected against modification.  However, the EAP header of TEAM  itself is not protected against modification, including the Code, Identifier and Type fields.  <br><br> </dd>
<dt>Protected termination</dt>
<dd style="margin-left: 8">
<br> By sending success/failure indications within the TLS channel, TEAM provides support for protected termination of the EAP conversation.  This prevents an attacker from carrying out denial of service attacks by spoofing EAP Failure messages, or fooling the EAP peer into accepting a rogue NAS, by spoofing EAP Success messages.  <br><br> </dd>
<dt>Fragmentation and Reassembly</dt>
<dd style="margin-left: 8">
<br> Since EAP does not include support for fragmentation and reassembly, individual methods need to include this capability.  By including support for fragmentation and reassembly within TEAM, methods leveraging TEAM do not need to support this on their own.  <br><br> </dd>
<dt>Fast reconnect</dt>
<dd style="margin-left: 8">
<br> Where EAP is used for authentication in wireless networks, the authentication latency is a concern.  As a result, it is valuable to be able to do a quick re-authentication on roaming between access points. TEAM supports this capability by leveraging the TLS session resumption facility, and any EAP method running under TEAM can take advantage of it.  <br><br> </dd>
<dt>Standard key establishment</dt>
<dd style="margin-left: 8">
<br> In order to provide keying material for a wide range of link layer ciphersuites, EAP methods need to provide keying material.  Key derivation is complex.  TEAM provides for key establishment by relying on the widely implemented and well-reviewed TLS <a href="#RFC5246">[RFC5246]</a> key derivation mechanism.  TEAM provides keying material for any EAP method running within it.  <br><br> </dd>
<dt>Sequencing of multiple EAP methods</dt>
<dd style="margin-left: 8">
<br> In order to enhance security, TEAM implementations may choose to provide multi-factor authentication that validates different identities (for example user and machine identities) and/or uses different credentials of the same or different identities of the peer (e.g.  user password and machine cert).  TEAM provides a standard way to chain different types of authentication mechanisms supporting different types of credentials.  <br><br> </dd>
<dt>Protected exchange of arbitrary parameters</dt>
<dd style="margin-left: 8">
<br> Type-Length-Value (TLV) tuples provide a way to exchange arbitrary information between peer and EAP server within a secure channel.  This information can include signaling parameters for the EAP protocol, provisioning parameters, media specific and environment specific data, and authorization parameters.  The advantage of using TEAM TLVs is that every EAP method does not have to be modified.  <br><br> </dd>
<dt>Credential provisioning</dt>
<dd style="margin-left: 8">
<br> TEAM supports provisioning of certificate trust anchors by the server using TLVs and can be extended to support provisioning of other peer credentials.  <br><br> </dd>
<dt>Optimized for light weight devices</dt>
<dd style="margin-left: 8">
<br> In order to support peers that may not support certificate ciphersuites, and may not support provisioning of certificate trust anchors, TEAM enables negotiation of other TLS ciphersuites.  <br><br> </dd>
<dt>Server unauthenticated tunnel provisioning mode</dt>
<dd style="margin-left: 8">
<br> In some cases,  the peer may only support password credentials and may not be provisioned with a certificate trust anchor.  <br><br> In server unauthenticated tunnel provisioning mode, a TEAM peer can authenticate using a password, in order to be provisioned with a pre-shared key and other credentials that can be used for subsequent authentication.  In server unauthenticated tunnel provisioning mode the TEAM peer does not authenticate the server.  As a result, it is possible for an attacker to act as a man-in-the-middle during the initial exchange in order to attack the inner exchange. For this reason, when performing server unauthenticated tunnel provisioning mode the inner method MUST be resistant to dictionary attack.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> Requirements Language</h1>
<p id="rfc.section.2.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">[RFC2119]</a>.  </p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> Terminology</h1>
<p id="rfc.section.3.p.1">This document frequently uses the following terms: <br><br> </p>

<dl>
<dt>Access Point</dt>
<dd style="margin-left: 8">
<br> A Network Access Server implementing 802.11.  <br><br> </dd>
<dt>Authenticator</dt>
<dd style="margin-left: 8">
<br> The end of the link initiating EAP authentication.  This term is also used in <a href="#IEEE.802-1X.2004">[IEEE.802-1X.2004]</a>.  and has the same meaning in this document.  <br><br> </dd>
<dt>Backend Authentication Server</dt>
<dd style="margin-left: 8">
<br> A backend authentication server is an entity that provides an authentication service to an Authenticator.  When used, this server typically executes EAP methods for the Authenticator.  This terminology is also used in <a href="#IEEE.802-1X.2004">[IEEE.802-1X.2004]</a>.  <br><br> </dd>
<dt>EAP server</dt>
<dd style="margin-left: 8">
<br> The entity that terminates the EAP authentication method with the peer.  In the case where no backend authentication server is used, the EAP server is part of the Authenticator.  In the case where the authenticator operates in pass-through mode, the EAP server is located on the backend authentication server.  <br><br> </dd>
<dt>Link layer ciphersuite</dt>
<dd style="margin-left: 8">
<br> The ciphersuite negotiated for use at the link layer.  <br><br> </dd>
<dt>NAS</dt>
<dd style="margin-left: 8">
<br> Short for "Network Access Server".  <br><br> </dd>
<dt>Peer</dt>
<dd style="margin-left: 8">
<br> The end of the link that responds to the authenticator.  In <a href="#IEEE.802-1X.2004">[IEEE.802-1X.2004]</a>, this end is known as the Supplicant.  <br><br> </dd>
<dt>TLS Ciphersuite</dt>
<dd style="margin-left: 8">
<br> The ciphersuite negotiated for protection of Phase 2 of the TEAM conversation <a href="#T-P-2">Section 4.4</a>.  <br><br> </dd>
<dt>EAP Master key (MK)</dt>
<dd style="margin-left: 8">
<br> A key derived between the TEAM client and server during the authentication conversation, and that is kept local to TEAM and not exported or made available to a third party.  <br><br> </dd>
<dt>Master Session Key (MSK)</dt>
<dd style="margin-left: 8">
<br> Keying material that is derived between the EAP peer and server and exported by the EAP method.  The MSK is at least 64 octets in length.  In existing implementations, a AAA server acting as an EAP server transports the MSK to the authenticator.  <br><br> </dd>
<dt>Extended Master Session Key (EMSK)</dt>
<dd style="margin-left: 8">
<br> Additional keying material derived between the EAP client and server that is exported by the EAP method.  The EMSK is at least 64 octets in length.  The EMSK is not shared with the authenticator or any other third party.  The EMSK is reserved for future uses that are not defined yet.  <br><br> </dd>
<dt>Type Length Value (TLV)</dt>
<dd style="margin-left: 8">
<br> The TEAM protocol utilizes objects in Type Length Value (TLV) format.  The TLV format is defined in <a href="#TLV-F">Section 6.1</a> of this document.  <br><br> </dd>
</dl>

<p> </p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> Protocol Overview</h1>
<p id="rfc.section.4.p.1">TEAM is comprised of a two-part conversation: <br><br> <br><br> In the following sections, we discuss the TEAM operational model, its support for EAP method sequencing and provide an overview of each of the parts of the TEAM conversation.  </p>

<ol>
<li>In Phase 1 a TLS session is negotiated, with the server authenticating to the client and (optionally) the client to the server.  The negotiated key is then used to protect Phase 2 of the conversation.  <br><br> </li>
<li>In Phase 2, within the TLS session, zero or more EAP methods are carried out.  Phase 2 completes with a success/failure indication protected by the TLS session or a protected error (TLS alert).  </li>
</ol>

<p> </p>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> Operational Model</h1>
<div id="#rfc.figure.1"></div>
<div id="#fig1"></div>
<pre>
+-+-+-+-+-+               +-+-+-+-+-+
|         |               |         |
| Link    |               | Link    |
| Layer   |               | Layer   |
| Cipher- |               | Cipher- |
| Suite   |               | Suite   |
|         |               |         |
+-+-+-+-+-+               +-+-+-+-+-+
    ^                         ^
    |                         |
    |                         |
    |                         |
    V                         V
+-+-+-+-+-+               +-+-+-+-+-+  Trust +-+-+-+-+-+
|         |  EAP          |         |&lt;======&gt;|         |
|         |  Conversation |         |        |         |
| EAP     |&lt;================================&gt;|  EAP    |
| Peer    |  (over PPP,   |   NAS   |        |  Server |
|         |  802.11,etc.) |         |&lt;=======|         |
|         |               |         |  Keys  |         |
|         |               |         |        |         |
+-+-+-+-+-+               +-+-+-+-+-+        +-+-+-+-+-+
    ^                                            ^
    |                                            |
    | EAP API                                    | EAP API
    |                                            |
    V                                            V
+-+-+-+-+-+                                  +-+-+-+-+-+
|         |                                  |         |
|         |                                  |         |
|  EAP    |                                  |  EAP    |
|  Method |                                  |  Method |
|         |                                  |         |
+-+-+-+-+-+                                  +-+-+-+-+-+	
</pre>
<p id="rfc.section.4.1.p.1">In EAP, the EAP server may be implemented either within a Network Access Server (NAS) or on a backend authentication server.  Where the EAP server resides on a NAS, the NAS is required to implement the desired EAP methods, and therefore needs to be upgraded to support each new EAP method.  <br><br> One of the goals of EAP is to enable development of new authentication methods without requiring deployment of new code on the Network Access Server (NAS).  Where a backend authentication server is deployed, the NAS acts as a "passthrough" and need not understand specific EAP methods.  <br><br> This allows new EAP methods to be deployed on the EAP peer and backend authentication server, without the need to upgrade code residing on the NAS.  <br><br> <a href="#fig1">Figure 1</a> illustrates the relationship between the EAP peer, NAS and EAP server.  As shown in the figure, the EAP conversation occurs between the EAP peer and EAP server, "passing through" the NAS.  In order for the conversation to proceed in the case where the NAS and EAP server reside on separate machines, the NAS and EAP server need to establish trust beforehand.  <br><br> As a result, where the NAS acts as a "passthrough" it does not have knowledge of the TLS master secret derived between the peer and the EAP server.  In order to provide keying material for link-layer ciphersuites, the NAS obtains the master session key, which is derived from a one-way function of the TLS master secret as well as keying material provided by EAP methods protected within a TLS channel.  This enables the NAS and EAP peer to subsequently derive transient session keys suitable for encrypting, authenticating and integrity protecting session data.  However, the NAS cannot decrypt the TEAM conversation or spoof session resumption, since this requires knowledge of the TLS master secret.  </p>
<h1 id="rfc.section.4.2">
<a href="#rfc.section.4.2">4.2.</a> Sequences</h1>
<p id="rfc.section.4.2.p.1">EAP <a href="#RFC3748">[RFC3748]</a> prohibits use of multiple authentication methods within a single EAP conversation, except when tunneled methods such as TEAM are used.  This restriction was imposed in order to limit vulnerabilities to man-in-the-middle attacks as well as to ensure compatibility with existing EAP implementations.  <br><br> Within TEAM these concerns are addressed since TEAM includes support for cryptographic binding to address man-in-the-middle attacks, as well as version negotiation so as to enable backward compatibility with future versions of the protocol.  <br><br> Within this document, the term "sequence" refers to a series of EAP authentication methods run in sequence or TLV exchanges before or after EAP methods.  The methods need not be distinct - for example, EAP-TLS could be run initially with machine credentials followed by the same protocol authenticating with user credentials.  <br><br> TEAM supports initiating additional EAP method(s) after a successful or a failed EAP method.  The result of failure of a EAP method does not always imply a failure of the overall authentication.  The overall result of authentication depends on the policy at EAP server and the peer.  For example, successful authentication might require a successful machine authentication followed by a successful user authentication.  Alternatively, if machine authentication fails, then user authentication can be attempted.  TEAM does not support initiating multiple EAP methods simultaneously.  </p>
<h1 id="rfc.section.4.3">
<a href="#rfc.section.4.3">4.3.</a> <a href="#T-P-1" id="T-P-1">TEAM Phase 1</a>
</h1>
<h1 id="rfc.section.4.3.1">
<a href="#rfc.section.4.3.1">4.3.1.</a> <a href="#I-I-E" id="I-I-E">Initial identity exchange</a>
</h1>
<p id="rfc.section.4.3.1.p.1">The TEAM conversation typically begins with an optional identity exchange.  The authenticator will typically send an EAP-Request/Identity packet to the peer, and the peer will respond with an EAP-Response/Identity packet to the authenticator.  <br><br> The initial identity exchange is used primarily to route the EAP conversation to the EAP server.  Since the initial identity exchange is in the clear, the peer MAY decide to place a routing realm instead of its real name in the EAP-Response/Identity.  The real identity of the peer can be established later, during Phase 2.  <br><br> If the EAP server is known in advance (such as when all users authenticate against the same backend server infrastructure and roaming is not supported), or if the identity is otherwise determined (such as from the dialing phone number or client MAC address), then the Identity exchange MAY be omitted.  <br><br> Once the optional initial Identity Request/Response exchange is completed, while nominally the EAP conversation occurs between the authenticator and the peer, the authenticator MAY act as a passthrough device, with the EAP packets received from the peer being encapsulated for transmission to a backend authentication server.  However, TEAM does not require a backend authentication server; if the authenticator implements TEAM, then it can authenticate local users.  <br><br> In the discussion that follows, we will use the term "EAP server" to denote the ultimate endpoint conversing with the peer.  </p>
<h1 id="rfc.section.4.3.2">
<a href="#rfc.section.4.3.2">4.3.2.</a> <a href="#T-S-E" id="T-S-E">TLS Session Establishment</a>
</h1>
<p id="rfc.section.4.3.2.p.1">In this section, the protocol is described.  While this section will often describe negotiation of a certificate-based ciphersuite within TLS, TEAM supports negotiation of other ciphersuites (for example, ciphersuites that do not use certificates) or extensions.  However, the  conversation may slightly differ if other TLS ciphersuites or extensions are used.  <br><br> Once having received the peer's identity, and determined that TEAM authentication is to occur, the EAP server MUST respond with a TEAM/Start packet, which is an EAP-Request packet with EAP-Type=TEAM, the Start (S) bit set, the TEAM version as specified in <a href="#V-N">Section 4.3.4</a>, and optionally, the Server-Identifier TLV (<a href="#S-I-TLV">Section 6.14</a>).  <br><br> Assuming that the peer supports TEAM, the TEAM conversation will then begin, with the peer sending an EAP-Response packet with EAP- Type=TEAM.  The Type-Data field of the EAP-Response Packet will encapsulate one or more TLS records containing the TLS handshake messages.  As defined in <a href="#RFC5246">[RFC5246]</a>, the TLS handshake is used to negotiate parameters and cryptographic keys and may take several roundtrips between the TLS client and server.  <br><br> The version offered by the TLS client and server MUST be TLS v1.0 or later.  TEAM implementations need not necessarily support all TLS ciphersuites listed in <a href="#RFC5246">[RFC5246]</a>.  Not all TLS ciphersuites are supported by available TLS tool kits and licenses may be required in some cases.  <br><br> To ensure interoperability, TEAM peers and servers MUST support the TLS v1.1 <a href="#RFC5246">[RFC5246]</a> mandatory-to-implement ciphersuite: <br><br> <br><br> In addition, TEAM servers SHOULD support and be able to negotiate all of the following TLS ciphersuites: <br><br> <br><br> In addition, TEAM peers SHOULD support at least one of the following TLS ciphersuites: <br><br> <br><br> TLS as described in <a href="#RFC5246">[RFC5246]</a> supports compression as well as ciphersuite negotiation.  Therefore during the TEAM Phase 1 conversation the TEAM endpoints MAY request or negotiate TLS compression.  <br><br> If the full TLS handshake is performed, then the first payload of TEAM Phase 2 MAY be sent along with finished handshake message to reduce number of round trips.  <br><br> Since after the TLS session is established, another complete EAP negotiation will occur and the peer will authenticate using a secondary mechanism, with TEAM the client need not authenticate as part of TLS session establishment.  <br><br> Note that since TLS client certificates are sent in the clear, if identity protection is required, then it is possible for the TLS authentication to be re-negotiated after the first server authentication.  Alternatively, if identity protection is required, then it is possible to perform certificate authentication using a EAP method (for example: EAP-TLS <a href="#RFC5216">[RFC5216]</a>) within the TLS session during TEAM Phase 2.  <br><br> To accomplish this, the server will typically not request a certificate in the server_hello, then after the server_finished message is sent, and before TEAM Phase 2 begins, the server MAY send a TLS hello_request.  This allows the client to perform client authentication by sending a client_hello if it wants to, or send a no_renegotiation alert to the server indicating that it wants to continue with TEAM Phase 2 instead.  Assuming that the client permits renegotiation by sending a client_hello, then the server will respond with server_hello, a certificate and certificate_request messages.  The client replies with certificate, client_key_exchange and certificate_verify messages.  Since this re-negotiation occurs within the encrypted TLS channel, it does not reveal client certificate details.  </p>

<ul class="empty"><li>TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA</li></ul>

<p> </p>

<ul class="empty">
<li>TLS_RSA_WITH_3DES_EDE_CBC_SHA</li>
<li>TLS_RSA_WITH_RC4_128_MD5</li>
<li>TLS_RSA_WITH_RC4_128_SHA</li>
<li>TLS_RSA_WITH_AES_128_CBC_SHA</li>
</ul>

<p> </p>

<ul class="empty">
<li>TLS_RSA_WITH_3DES_EDE_CBC_SHA</li>
<li>TLS_RSA_WITH_RC4_128_MD5</li>
<li>TLS_RSA_WITH_RC4_128_SHA</li>
<li>TLS_RSA_WITH_AES_128_CBC_SHA</li>
</ul>

<p> </p>
<h1 id="rfc.section.4.3.3">
<a href="#rfc.section.4.3.3">4.3.3.</a> <a href="#S-R" id="S-R">Session Resumption</a>
</h1>
<p id="rfc.section.4.3.3.p.1">The purpose of the sessionId within the TLS protocol and the Server- Identifier TLV in TEAM is to allow for improved efficiency in the case where a client repeatedly attempts to authenticate to an EAP server within a short period of time.  This capability is particularly useful for support of wireless roaming.  <br><br> In order to help the peer choose a sessionID that belongs to the specific server, the EAP server MAY send an identifier (Server- Identifier TLV) that the peer can use as a hint.  The Server- Identifier TLV MAY be sent in the first TEAM packet from the EAP server to the peer.  In order to detect modification of the Server- Identifier TLV, the Server-Identifier TLV is included in calculation of the compound MAC.  <br><br> It is left up to the peer whether to attempt to continue a previous session, thus shortening the TEAM Phase 1 conversation.  Typically the peer's decision will be made based on the time elapsed since the previous authentication attempt to that EAP server.  <br><br> Based on the sessionId chosen by the peer, and the time elapsed since the previous authentication, the EAP server will decide whether to allow the continuation, or whether to choose a new session.  <br><br> If the EAP server is resuming a previously established session, then it MUST include only a TLS change_cipher_spec message and a TLS finished handshake message after the server_hello message.  The finished message contains the EAP server's authentication response to the peer.  <br><br> If the preceding server_hello message sent by the EAP server in the preceding EAP-Request packet indicated the resumption of a previous session, then the peer MUST send only the change_cipher_spec and finished handshake messages.  The finished message contains the peer's authentication response to the EAP server. The latter contains the EAP server's authentication response to the peer. The peer will verify the hash in order to authenticate the EAP server.  <br><br> If authentication fails, then the peer and EAP server MUST follow the error handling behavior specified in <a href="#E-H">Section 4.5</a> <br><br> Even if the session is successfully resumed with the same EAP server, the peer and EAP server MUST NOT assume that either will skip inner EAP methods.  The peer may have roamed to a network which may use the same EAP server, but may require conformance with a different authentication policy, and therefore may require inner EAP authentication methods.  </p>
<h1 id="rfc.section.4.3.4">
<a href="#rfc.section.4.3.4">4.3.4.</a> <a href="#V-N" id="V-N">Version Negotiation</a>
</h1>
<p id="rfc.section.4.3.4.p.1">TEAM packets contain a three bit version field, which enables TEAM implementations to be backward compatible with previous versions of the protocol.  This specification documents version1 of the TEAM protocol; implementations of this specification MUST use a version field set to 1.  Version negotiation proceeds as follows: <br><br> <br><br> The TEAM version field is not protected by TLS and therefore can be modified in transit.  In order to detect modification of the TEAM version which could occur as part of a "downgrade" attack,  the peer and EAP server check if the version it sent during negotiation is same as the version claimed to be received by the other party.  Each party uses the Crypto-Binding TLV (<a href="#Cryp-B-TLV">Section 6.5</a>) to inform the other party of the version number it received during the TEAM version negotiation.  The receiver of the Crypto-Binding TLV must verify that the version in the Crypto-Binding TLV matches the version it sent during TEAM version negotiation.  </p>

<ol>
<li>In the first EAP-Request sent with EAP-Type=TEAM, the EAP server MUST set the version field to the highest supported version number.  <br><br> </li>
<li>If the EAP peer supports that version of the protocol, it MUST respond with an EAP-Response of EAP-Type=TEAM, and the version number proposed by the EAP server.  <br><br> </li>
<li>If the EAP peer does not support that version, it responds with an EAP-Response of EAP-Type=TEAM and the highest supported version number.  <br><br> </li>
<li>If the TEAM server does not support the version number proposed by the TEAM peer, it either starts a different EAP type or terminates the conversation by sending an EAP-Failure, depending on the server policy.  <br><br> </li>
</ol>

<p> The version negotiation procedure guarantees that the EAP peer and server will agree to the latest version supported by both parties.  If version negotiation fails, then use of TEAM will not be possible, and another mutually acceptable EAP method will need to be negotiated if authentication is to proceed.  </p>
<h1 id="rfc.section.4.4">
<a href="#rfc.section.4.4">4.4.</a> <a href="#T-P-2" id="T-P-2">TEAM Phase 2</a>
</h1>
<p id="rfc.section.4.4.p.1">The second part of the TEAM conversation typically consists of a complete EAP conversation occurring within the TLS session negotiated in TEAM Phase 1, ending with protected termination using the Result TLV.  TEAM Phase 2 will occur only if establishment of a new TLS session in Phase 1 is successful or a TLS session is successfully resumed in Phase 1.  In cases where a new TLS session is established in TEAM Phase 1, the first payload of the Phase 2 conversation MAY be sent by the EAP server along with the finished message to save a round-trip.  <br><br> Phase 2 SHOULD NOT occur if the EAP Server authenticates unsuccessfully, and MUST NOT occur if establishment of the TLS session in Phase 1 was not successful or a TLS fatal error has been sent terminating the conversation.  <br><br> Since all packets sent within the TEAM Phase 2 conversation occur after TLS session establishment, they are protected using the negotiated TLS ciphersuite.  All EAP packets of the EAP conversation in Phase 2 including the EAP header of the inner EAP method are protected using the negotiated TLS ciphersuite.  <br><br> Phase 2 may not always include a EAP conversation within the TLS session, referred to in this document as inner EAP methods.  However, Phase 2 MUST always end with either protected termination or protected error termination (e.g. TLS alert).  <br><br> Within Phase 2, protected EAP conversation and protected termination packets are always carried within TLVs.  There are TLVs defined for specific purposes such as carrying EAP-authentication messages and carrying cryptographic binding information.  New TLVs may be developed for other purposes.  </p>
<h1 id="rfc.section.4.4.1">
<a href="#rfc.section.4.4.1">4.4.1.</a> <a href="#P-C" id="P-C">Protected Conversation</a>
</h1>
<p id="rfc.section.4.4.1.p.1">Phase 2 of the TEAM conversation typically begins with the EAP server sending an optional EAP-Request/Identity packet to the peer, protected by the TLS ciphersuite negotiated in Phase 1 of TEAM.  The peer responds with an EAP-Response/Identity packet to the EAP server, containing the peer's userId.  Since this Identity Request/Response exchange is protected by the ciphersuite negotiated in TLS, it is not vulnerable to snooping or packet modification attacks.  <br><br> After the TLS session-protected Identity exchange, the EAP server will then select authentication method(s) for the peer, and will send an EAP-Request with the Type field set to the initial method.  As described in <a href="#RFC3748">[RFC3748]</a>, the peer can NAK the suggested EAP method, suggesting an alternative.  Since the NAK will be sent within the TLS channel, it is protected from snooping or packet modification.  As a result, an attacker snooping on the exchange will be unable to inject NAKs in order to "negotiate down" the authentication method.  An attacker will also not be able to determine which EAP method was negotiated.  <br><br> The EAP conversation within the TLS protected session may involve a sequence of zero or more EAP authentication methods; it completes with the protected termination described in <a href="#P-T">Section 4.4.2</a> Several TLVs may be included in each Request and Response.  EAP packets are always encapsulated within EAP Payload TLVs.  <br><br> In a typical EAP conversation, the result of the conversation is communicated by sending EAP Success or EAP Failure packets after the EAP method is complete.  The EAP Success or Failure packet is considered the last packet of the EAP conversation; and therefore cannot be used when sequences need to be supported.  Hence, instead of using the EAP Success or EAP Failure packet, both peer and EAP server MUST use the Intermediate-Result TLV (<a href="#I-R-TLV">Section 6.10</a>) to communicate the result.  <br><br> In a typical EAP conversation, the EAP Success or EAP Failure is considered the last packet of the EAP conversation.  Within TEAM, the EAP server can start another EAP method after success or failure of the previous EAP method inside the protected session.  <br><br> In a sequence of more than one EAP authentication method, to make sure the same parties are involved in tunnel establishment and successful completion of previous inner EAP methods, before completing negotiation of the next EAP method, both peer and EAP server MUST use cryptographic binding (Crypto-Binding TLV <a href="#Cryp-B-TLV">Section 6.5</a>).  <br><br> The Intermediate-Result TLV is used to indicate the result of a individual successful EAP method, and the Result TLV (<a href="#R-TLV">Section 6.2</a>) is used to indicate result of the entire TEAM conversation.  <br><br> The Intermediate-Result and Crypto-Binding TLVs MUST be sent after each EAP method that was successful.  If the EAP method failed, or if the EAP method negotiation did not complete, then an Intermediate- Result TLV MAY be included, and the Crypto-Binding TLV MUST NOT be included.  An exception is that the Crypto-Binding TLV MUST be sent along with a protected success/failure indication (see <a href="#P-T">Section 4.4.2</a>).  <br><br> If these TLVs are not sent after a successful EAP method, it should be considered a tunnel compromise error by peer and EAP server, resulting in the termination of the conversation (as described in <a href="#E-H">Section 4.5</a>).  <br><br> A subsequent EAP conversation can be started after both TLVs are exchanged in a TLV packet.  Alternatively, if a subsequent EAP conversation is being attempted, then in order to reduce round trips, both TLVs SHOULD be sent with the EAP-Payload of the first EAP packet of the next EAP conversation (for example, EAP-Identity or EAP packet of the EAP method).  Alternatively, if the next packet is the protected success/failure packet, then in order to reduce round trips, both TLVs MUST be sent with the protected success/failure packet.  <br><br> If the EAP server sends a valid Crypto-Binding TLV to the peer, the peer MUST respond with a Crypto-Binding TLV.  If the Crypto-Binding TLV is invalid, it should be considered a tunnel compromise error by the peer.  If the peer does not respond with a TLV packet containing the Crypto-Binding TLV, it MUST be considered a tunnel compromise error by the EAP server.  <br><br> Within a TEAM part 2 conversation, a peer MAY request the trusted root of  a server certificate using a Server-Trusted-Root TLV (<a href="#S-T-R-TLV">Section 6.16</a>), and the EAP server MAY respond with a Server-Trusted-Root TLV to the peer.  The Server-Trusted-Root TLV can be exchanged in regular authentication mode or server unauthenticated tunnel provisioning mode.  <br><br> After the peer has determined that it has successfully authenticated the EAP server and determined that the tunnel and inner EAP methods were between the same peer and EAP server by validating the Crypto-Binding TLV, it MAY send one or more Server-Trusted-Root TLVs (marked as optional) to request the trusted root of server certificate from the EAP server. The peer may receive a response, but is not required to use the trusted root received from the EAP server.  <br><br> If the EAP server has determined that it has successfully authenticated the peer and determined that the tunnel and inner EAP methods were between the same peer and EAP server by validating the Crypto-Binding TLV, then it MAY respond with the the server-trusted- root containing the PCKS#7 TLV (<a href="#PKCS-TLV">Section 6.17</a>).  </p>
<h1 id="rfc.section.4.4.2">
<a href="#rfc.section.4.4.2">4.4.2.</a> <a href="#P-T" id="P-T">Protected Termination</a>
</h1>
<p id="rfc.section.4.4.2.p.1">Phase 2 of the TEAM conversation is completed by the exchange of success/failure indications (Result TLV) within a TLV packet protected by the TLS session.  <br><br> Even if Crypto-Binding TLVs have been exchanged in previous conversations, the Crypto-Binding TLV MUST be included in both protected success/failure (Result TLV) indications.  If the TLVs are not included, or if the TLVs are invalid, it should be considered a tunnel compromise error, and the peer and EAP server MUST follow the rules described in <a href="#E-H">Section 4.5</a> to abort the conversation.  <br><br> The Result TLV is sent within the TLS channel.  The TEAM client then replies with a Result TLV.  The conversation concludes with the TEAM server sending a cleartext success/failure indication.  <br><br> The only outcome which should be considered as successful authentication is when a Result TLV of Status=Success is answered by the peer with a Result TLV of Status=Success.  <br><br> The combinations (Result TLV=Failure, Result TLV=Success), (Result TLV=Failure, Result TLV=Failure), (no TLVs exchange or no protected success or failure) should be considered an authentication failure by both the peer and EAP server.  Once the peer and EAP server consider that authentiation has failed, these are the last packets inside the protected tunnel.  These combinations are considered an authentication failure regardless of whether a cleartext EAP Success or EAP Failure packet is subsequently sent.  <br><br> If the EAP server wants authentication to fail, it sends the TLV response with Result TLV=Failure.  If the EAP server sends a failure, the peer MUST respond with Result TLV=Failure and the Crypto-Binding TLV, without any other mandatory TLVs.  The Crypto-Binding TLV is calculated using the key derivation formula in Section 2.5; if for some reason one or more inner EAP method MSKs were not derived, then these MSKs are assumed to be null.  <br><br> If the EAP server has sent the success indication (Result TLV=Success), the peer is allowed to refuse to accept a Success message from the EAP server since the client's policy may require completion of certain EAP methods or the client may require credentials.  <br><br> If the EAP server has sent a success indication (Result TLV=success), and the peer wants authentication to fail, it sends the TLV response with Result TLV=Failure and Crypto-Binding TLV.  <br><br> After the EAP server returns success, if the peer wants to request the EAP server to continue conversation, it sends a Result TLV=Success along with a Request-Action TLV with the appropriate action (e.g. Negotiate-EAP, or Process-TLV).  If the Request-Action TLV is set to mandatory, then the EAP server MUST process the action, or return status=failure, closing the conversation inside the tunnel.  If the Request-Action TLV is set to optional, then the EAP server can ignore the TLV and return Result TLV=Success again, closing the conversation inside the tunnel.  </p>
<h1 id="rfc.section.4.4.3">
<a href="#rfc.section.4.4.3">4.4.3.</a> <a href="#P-O-C" id="P-O-C">Provisioning of Credentials</a>
</h1>
<p id="rfc.section.4.4.3.p.1">TEAM supports built-in provisioning of certificate trust anchors and can be extended to provisioning of other types of credentials.  The following two provisioning modes are suported: <br><br> </p>

<ol>
<li>Provisioning inside a server authenticated TLS tunnel</li>
<li>Provisioning inside a server unauthenticated TLS tunnel</li>
</ol>

<p> </p>
<h1 id="rfc.section.4.4.3.1">
<a href="#rfc.section.4.4.3.1">4.4.3.1.</a> <a href="#P-I-S-A-T" id="P-I-S-A-T">Provisioning Inside a Server Authenticated TLS Tunnel</a>
</h1>
<p id="rfc.section.4.4.3.1.p.1">After regular authentication in TEAM Phase 2, the peer and EAP server can use the Server-Trusted-Root TLV to request and provision peer credentials.  The provisioning payload is exchanged after the peer and EAP server have determined that both have successfully authenticated each other (either thru TLS handshake and/or inner EAP method), and the tunnel and inner EAP methods are between the same peers.  <br><br> After the peer has determined that it has successfully authenticated the EAP server and determined that the tunnel and inner EAP methods were between the same peer and EAP server by validating the Crypto-Binding TLV, it MAY send one or more Server- Trusted-Root TLVs (marked as optional) to request credentials from the EAP server.  The EAP server will send corresponding credentials in the Server-Trusted-Root TLVs if its internal policy has been satisfied.  It may ignore the credential provisioning request or request additional authentication methods if its policy so dictates.  The peer may receive a credential, but is not required to use the credentials received from the EAP server.  </p>
<h1 id="rfc.section.4.4.3.2">
<a href="#rfc.section.4.4.3.2">4.4.3.2.</a> <a href="#P-I-S-U-T" id="P-I-S-U-T">Provisioning Inside a Server Unauthenticated TLS Tunnel</a>
</h1>
<p id="rfc.section.4.4.3.2.p.1">In some cases, the peer may lack the credentials necessary to authenticate the server in the TLS handshake.  At the same time, bootstrapping the information to the peer out of band may be prohibitive from a deployment cost perspective.  It can rely on the inner EAP method using existing credentials to authenticate the server.  <br><br> In this provisioning mode, as part of TEAM Phase 1, if the peer does not authenticate, or does not successfully authenticate the EAP server during TLS negotiation, it can decide to go into server unauthenticated tunnel provisioning mode. In a certificate-based TLS handshake, the peer verifies that the EAP server possesses the private key corresponding to the public key contained in the certificate presented by the EAP server.  However, the peer does not verify whether the certificate presented by the server chains to a provisioned trust anchor, as the peer may not be configured with a certificate trust anchor required to validate the server certificate.  If the peer cannot verify that the server possesses the corresponding private key, or if the certificate presented by the server is unacceptable for any reason other than the lack of an appropriate trust anchor, the peer MUST NOT use this provisioning mode.  Assuming that the server demonstrates possession of the private key, the peer continues with establishment of the tunnel (TEAM Phase 2). In a certificate-less TLS handshake the peer and server perform an anonymous exchange. There is no attempt by the peer to verify the server's identity. In both the certificate-based and certificate-less TEAM Phase 1 exchange for the Server Unauthenticated mode, it is possible that the TLS channel (TEAM Phase 2) may be terminated by an attacker. For this reason the TEAM Phase 2 exchange MUST be resistant to dictionary attack.  <br><br> The TEAM Phase 2 conversation is unchanged in this mode, except that the peer will only accept an EAP method supporting mutual authentication, key derivation and resistance to dictionary attack that is compatible with its initial credentials (such as EAP-pwd <a href="#RFC5931">[RFC5931]</a>). The peer then uses the Crypto-Binding TLV to validate that the same server terminates both the TLS channel and the successfully completed EAP method, thereby verifying that the exchange was not	subject to a man-in-the-middle attack.  Assuming that the Crypto- Binding TLV exchange is successful, the peer will request and the server will subsequently provide a trusted root, using the Server-Trusted-Root TLV.  <br><br> Once the initial provisioning exchange completes, the peer is expected to use the provisioned credentials in subsequent TEAM authentications, and SHOULD NOT continue to use this provisioning mode.  <br><br> TEAM servers and peers implementing this provisioning mode MUST support EAP-pwd <a href="#RFC5931">[RFC5931]</a> as a TEAM Phase 2 conversation.  <br><br> TEAM servers implementing this provisioning mode MUST support the following additional ciphersuites, beyond those specified in <a href="#T-S-E">Section 4.3.2</a>: <br><br> <br><br> TEAM peers implementing this provisioning mode MAY support the following additional ciphersuites, beyond those specified in <a href="#T-S-E">Section 4.3.2</a>: <br><br> </p>

<ul class="empty"><li>TLS_DH_anon_WITH_AES_128_CBC_SHA</li></ul>

<p> </p>

<ul class="empty"><li>TLS_DH_anon_WITH_AES_128_CBC_SHA</li></ul>

<p> </p>
<h1 id="rfc.section.4.5">
<a href="#rfc.section.4.5">4.5.</a> <a href="#E-H" id="E-H">Error Handling</a>
</h1>
<p id="rfc.section.4.5.p.1">TEAM does not have its own error message capabilities since: <br><br> <br><br> If an error occurs at any point in the TLS layer, the EAP server SHOULD send a TLS alert message instead of the next EAP-request packet to the peer.  The EAP server SHOULD send an EAP-Request packet with EAP-Type=TEAM, encapsulating a TLS record containing the appropriate TLS alert message.  The EAP server SHOULD send a TLS alert message rather than immediately terminating the conversation so as to allow the peer to inform the user of the cause of the failure and possibly allow for a restart of the conversation.  To ensure that the peer receives the TLS alert message, the EAP server MUST wait for the peer to reply with an EAP-Response packet.  <br><br> The EAP-Response packet sent by the peer MAY encapsulate a TLS client_hello handshake message, in which case the EAP server MAY allow the TEAM conversation to be restarted, or it MAY contain an EAP-Response packet with EAP-Type=TEAM and no data, in which case the TEAM server MUST send an EAP-Failure packet, and terminate the conversation.  <br><br> It is up to the EAP server whether to allow restarts, and if so, how many times the conversation can be restarted.  An EAP server implementing restart capability SHOULD impose a limit on the number of restarts, so as to protect against denial of service attacks.  <br><br> If an error occurs at any point in the TLS layer, the peer SHOULD send a TLS alert message instead of the next EAP-response packet to the EAP server.  The peer SHOULD send an EAP-Response packet with EAP-Type=TEAM, encapsulating a TLS record containing the appropriate TLS alert message. The EAP server may restart the conversation by sending a EAP-Request packet encapsulating the TLS hello_request_handshake message, in which case the peer MAY allow the TEAM conversation to be restarted; or the EAP server can response with EAP Failure.  <br><br> Any time the peer or the EAP server finds an error when processing the sequence of exchanges, such as a violation of the TLV rules <a href="#TLV-R">Section 6.19</a>, it should send a Result TLV of failure and Error-Code TLV=Unexpected_TLVs_Exchanged (a Fatal error), and terminate the tunnel.  This is usually due to an implementation problem and is considered an fatal error. The party that receives the Error-Code TLV=Unexpected_TLVs_Exchanged should terminate the tunnel.  <br><br> If a tunnel compromise error (<a href="#T-P-2">see</a> <cite title="NONE">[T-P-2]</cite>) is detected by the Peer or EAP server, the party SHOULD send a Result TLV of failure without a Crypto-Binding TLV, and Error-Code TLV=Tunnel-compromise- error (a Fatal error), and terminate the tunnel. The party that receives the Error-Code TLV=Tunnel-compromise error should terminate the tunnel.  </p>

<ol>
<li>TLS errors are communicated via TLS alert messages.</li>
<li>Errors within the EAP conversation in TEAM Phase 2 are expected to be handled by individual EAP methods.  </li>
<li>Violation of the TLV rules (<a href="#TLV-R">Section 6.19</a>) for inner-TLVs are handled using Result-TLVs together with the Error-Code TLV.  </li>
</ol>

<p> </p>
<h1 id="rfc.section.4.6">
<a href="#rfc.section.4.6">4.6.</a> <a href="#F-R" id="F-R">Fragmentation and Reassembly</a>
</h1>
<p id="rfc.section.4.6.p.1">A single TLS record may be up to 16384 octets in length, but a TLS message may span multiple TLS records, and a TLS certificate message may in principle be as long as 16MB.  <br><br> The group of TEAM messages sent in a single round may thus be larger than the PPP MTU size, the maximum RADIUS packet size of 4096 octets, or even the Multilink Maximum Received Reconstructed Unit (MRRU).  <br><br> As described in <a href="#RFC1990">[RFC1990]</a>, the multilink MRRU is negotiated via the Multilink MRRU LCP option, which includes an MRRU length field of two octets, and thus can support MRRUs as large as 64 KB.  <br><br> However, note that in order to protect against reassembly lockup and denial of service attacks, it may be desirable for an implementation to set a maximum size for one such group of TLS messages.  Since a typical certificate chain is rarely longer than a few thousand octets, and no other field is likely to be anywhere near as long, a reasonable choice of maximum acceptable message length might be 64 KB.  <br><br> If this value is chosen, then fragmentation can be handled via the multilink PPP fragmentation mechanisms described in <a href="#RFC1990">[RFC1990]</a>.  this is desirable, EAP methods are used in other applications such as <a href="#IEEE.802-11.2007">[IEEE.802-11.2007]</a> and there may be cases in which multilink or the MRRU LCP option cannot be negotiated.  As a result, a TEAM implementation MUST provide its own support for fragmentation and reassembly.  <br><br> Since EAP is an ACK-NAK protocol, fragmentation support can be added in a simple manner.  In EAP, fragments that are lost or damaged in transit will be retransmitted, and since sequencing information is provided by the Identifier field in EAP, there is no need for a fragment offset field as is provided in IPv4.  <br><br> TEAM fragmentation support is provided through addition of flag bits within the EAP-Response and EAP-Request packets, as well as a TLV Message Length field of four octets.  Flags include the Length included (L), More fragments (M), and TEAM Start (S) bits.  The L flag is set to indicate the presence of the four octet TLV Message Length field, and MUST be set only for the first fragment of a fragmented TLV message or set of messages.  <br><br> The TLV Message Length field in the TEAM header is not protected, and hence can be modified by a attacker.  The TLS record length in the TLS data is protected.  Hence, if the TLV Message length received in the first packet (with L bit set) is greater or less than the total size of TLS messages received including multiple fragments, then the TLV message length should be ignored.  <br><br> In order to protect against reassembly lockup and denial of service attacks, it may be desirable for an implementation to set a maximum size for a single group of Outer-TLV messages.  Since a typical certificate chain is rarely longer than a few thousand octets, and no other field is likely to be anywhere near as long, a reasonable choice of maximum acceptable message length for all the Outer-TLVs in a group of messages might be 64 KB.  <br><br> The M flag is set on all but the last fragment.  The S flag is set only within the TEAM start message sent from the EAP server to the peer.  The TLV Message Length field is four octets, and provides the total length of the TLV message or set of messages that is being fragmented; this simplifies buffer allocation.  <br><br> When a peer receives an EAP-Request packet with the M bit set, it MUST respond with an EAP-Response with EAP-Type=TEAM and no data.  This serves as a fragment ACK.  The EAP server MUST wait until it receives the EAP-Response before sending another fragment.  In order to prevent errors in processing of fragments, the EAP server MUST increment the Identifier field for each fragment contained within an EAP-Request, and the peer MUST include this Identifier value in the fragment ACK contained within the EAP-Response.  Retransmitted fragments will contain the same Identifier value.  <br><br> Similarly, when the EAP server receives an EAP-Response with the M bit set, it MUST respond with an EAP-Request with EAP-Type=TEAM and no TLS data. This serves as a fragment ACK.  The EAP peer MUST wait until it receives the EAP-Request before sending another fragment.  In order to prevent errors in the processing of fragments, the EAP server MUST increment the Identifier value for each fragment ACK contained within an EAP-Request, and the peer MUST include this Identifier value in the subsequent fragment contained within an EAP- Response.  </p>
<h1 id="rfc.section.4.7">
<a href="#rfc.section.4.7">4.7.</a> <a href="#K-D" id="K-D">Key Derivation</a>
</h1>
<div id="#rfc.figure.2"></div>
<pre>

  IPMK0 = HKDF-Extract(salt, TK)
  for j = 1 to n do
    IPMKj | CMKj = HKDF-Expand(IPMK(j-1),
                               "Inner Methods Compound Keys" | ISKj,
                               60)
  done

						</pre>
<p id="rfc.section.4.7.p.1">Since the normal TLS keys are used in the handshake, and therefore should not be used in a different context, new keys must be derived from the TLS master secret to protect the conversation within the TEAM tunnel.  <br><br> Instead of deriving keys specific to link layer ciphersuites, EAP methods provide a Master Session Key (MSK) used to derive keys in a link layer specific manner.  The method used to extract ciphering keys from the MSK is beyond the scope of this document.  <br><br> TEAM also derives an Extended Master Session Key (EMSK) which is reserved for use in deriving keys in other ciphering applications.  This draft also does not discuss the format of the attributes used to communicate the master session keys from the backend authentication server to the NAS; examples of such attributes are provided in <a href="#RFC2548">[RFC2548]</a>.  <br><br> TEAM combines key material from the TLS exchange with key material from inner key generating EAP methods to provide stronger keys and to bind inner authentication mechanisms to the TLS tunnel.  Both the peer and EAP server MUST derive compound MAC and compound session keys using the procedure described below.  <br><br> The input for the cryptographic binding includes the following: <br><br> <br><br> The key derivation process is based on "extract-then-expand" technique of HKDF <a href="#RFC5869">[RFC5869]</a>. Entropy from the TEAM Tunnel Key, TK, is first extracted into a pseudo-random key and then expanded into a series of intermediate combined keys, IPMK1..IPMKn, and Compound MAC keys, CMK1..CMKn.  </p>

<ol>
<li>The TEAM tunnel key (TK) is calculated using the first 40 octets of the (secret) key material generated as described in the EAP-TLS algorithm (<a href="#RFC5216">see Section 2.3 of</a> <cite title="NONE">[RFC5216]</cite>) More explicitly, the TK is the first 40 octets of the PRF as defined in RFC 5216: <br><br> <dl>
<dt>Key_Material = TLS-PRF-128(</dt>
<dd style="margin-left: 29">master_secret, "client EAP encryption", client.random || server.random  ) </dd>
</dl>
<p> </p>
<br><br> </li>
<li>The first 32 octets of the MSK provided by each successful inner EAP method for each successful EAP method completed within the tunnel.  <br><br> ISK1..ISKn are the MSK portion of the EAP keying material obtained from methods 1 to n. The ISKj SHALL be the first 32 octets of the generated MSK of the jth EAP method. If the MSK length is less than 32 octets, it SHALL be padded with 0x00's to ensure the MSK is 32 octets. Similarly, if no keying material is provided for the EAP method, then ISKj SHALL be set to zero (e.g. 32 octets of 0x00).  </li>
</ol>

<p> </p>

<ul>
<li>salt is 32 octets of 0x00</li>
<li>IPMKj are 40 octets in length</li>
<li>CMKj are 20 octets in length used to generate the intermediate Compound MACs </li>
</ul>

<p> and </p>

<ul><li>n = the last successful EAP method inside the tunnel at the point where the Compound Session Key is derived </li></ul>

<p> </p>
<h1 id="rfc.section.4.7.1">
<a href="#rfc.section.4.7.1">4.7.1.</a> <a href="#C-S-K-D" id="C-S-K-D">Compound Session Key Derivation</a>
</h1>
<p id="rfc.section.4.7.1.p.1">The compound session key (CSK) is derived on both the peer and EAP server: <br><br> <br><br> The length of the CSK MUST be 128 octets. The first 64 octets SHALL be taken as the MSK and the second 64 octets SHALL be taken as the EMSK. The MSK and EMSK are described in <a href="#RFC3748">[RFC3748]</a>.  </p>

<ul class="empty"><li>CSK = HKDF-Expand(IPMKn, "Session Key Generating Function", 128)</li></ul>

<p> </p>
<h1 id="rfc.section.4.8">
<a href="#rfc.section.4.8">4.8.</a> <a href="#C-N" id="C-N">Ciphersuite Negotiation</a>
</h1>
<p id="rfc.section.4.8.p.1">Since TLS supports TLS ciphersuite negotiation, peers completing the TLS negotiation will also have selected a TLS ciphersuite, which includes key strength, encryption and hashing methods.  However, unlike in <a href="#RFC5216">[RFC5216]</a>, within TEAM, the negotiated TLS ciphersuite relates only to the mechanism by which the TEAM Phase 2 conversation will be protected, and has no relationship to link layer security mechanisms negotiated within the PPP Encryption Control Protocol (ECP) <a href="#RFC1968">[RFC1968]</a> or within IEEE 802.11 <a href="#IEEE.802-11.2007">[IEEE.802-11.2007]</a>.  <br><br> As a result, this specification currently does not support secure negotiation of link layer ciphersuites.  </p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#T-P-D" id="T-P-D">TEAM Protocol Description</a>
</h1>
<h1 id="rfc.section.5.1">
<a href="#rfc.section.5.1">5.1.</a> <a href="#T-P-L" id="T-P-L">TEAM Protocol Layers</a>
</h1>
<div id="#rfc.figure.3"></div>
<pre>
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |            TLS        |  Optional Outer TLVs    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                    TEAM                         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                     EAP                         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
<div id="#rfc.figure.4"></div>
<pre>
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                     EAP                         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |          Inner-TLVs (EAP-Payload TLV)           |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                     TLS                         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                    TEAM                         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                     EAP                         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
<p id="rfc.section.5.1.p.1">TEAM packets may include TLVs both inside and outside the TLS tunnel.  The term "Outer TLVs" is used to refer to optional TLVs outside the TLS tunnel, which are only allowed in the first two messages in the TEAM protocol, i.e., the first EAP server to peer message and first peer to EAP server message.  If the message is fragmented, the whole set of messages is counted as one message. The term "Inner TLVs" is used to refer to TLVs sent within the TLS tunnel.  <br><br> In TEAM Phase 1, Outer TLVs are used to help establishing the TLS tunnel, but no Inner TLVs are used.  Therefore the layering of TEAM Phase 1 is as follows: </p>
<h1 id="rfc.section.5.2">
<a href="#rfc.section.5.2">5.2.</a> <a href="#T-P-F" id="T-P-F">TEAM Packet Format</a>
</h1>
<div id="#rfc.figure.5"></div>
<pre>
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Code      |   Identifier  |            Length             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Type      |   Flags | Ver |    Fragment Message Length
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   Fragment Message Length     |    TLS Message Length
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     TLS Message Length        |      TLS Data...
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |             Outer TLVs...
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
<div id="#rfc.figure.6"></div>
<pre>
    0 1 2 3 4
   +-+-+-+-+-+
   |L M S T R|
   +-+-+-+-+-+
</pre>
<div id="#rfc.figure.7"></div>
<pre>
    0 1 2
   +-+-+-+
   |R|0|1|
   +-+-+-+
</pre>
<p id="rfc.section.5.2.p.1">A summary of the TEAM packet format is shown below.  The fields are transmitted from left to right.  </p>

<dl>
<dt>Code</dt>
<dd style="margin-left: 8">
<br><br> <dl>
<dt>1 -</dt>
<dd style="margin-left: 8">Request</dd>
<dt>2 -</dt>
<dd style="margin-left: 8">Response</dd>
</dl>
<p> </p>
<br><br> </dd>
<dt>Identifier</dt>
<dd style="margin-left: 8">
<br><br> The Identifier field is one octet and aids in matching responses with requests.  The Identifier field MUST be changed on each Request packet.  The Identifier field in a Response packet MUST match the Identifier field from the corresponding Request.  <br><br> </dd>
<dt>Length</dt>
<dd style="margin-left: 8">
<br><br> The Length field is two octets and indicates the length of the EAP packet including the Code, Identifier, Length, Type, Flags, Version, Fragmented Length, TLS Message Length, TLS Data, and Outer-TLV fields.  Octets outside the range of the Length field should be treated as Data Link Layer padding and should be ignored on reception.  <br><br> </dd>
<dt>Type</dt>
<dd style="margin-left: 8">
<br><br> &lt;TBD&gt; - TEAM <br><br> </dd>
<dt>Flags</dt>
<dd style="margin-left: 8">
<dl>
<dt>L =</dt>
<dd style="margin-left: 8">Length included</dd>
<dt>M =</dt>
<dd style="margin-left: 8">More fragments</dd>
<dt>S =</dt>
<dd style="margin-left: 8">TEAM start</dd>
<dt>T =</dt>
<dd style="margin-left: 8">TLS length included</dd>
<dt>R =</dt>
<dd style="margin-left: 8">Reserved (must be zero)</dd>
</dl>
<p> </p>
<br><br> The L bit (Fragmented Message Length included) is set to indicate the presence  of the four octet Fragmented Message Length field, and MUST be set for the first fragment of a fragmented TEAM message or set of messages.  The M bit (more fragments) is set on all but the last fragment.  The S bit (TEAM start) is set in a TEAM Start message.  This differentiates the TEAM Start message from a fragment acknowledgment.  The T bit (TLS Message Length included) is set to indicate  the presence of the four octet TLS Message Length field, and MUST only be set for packet that contains Outer-TLVs.  It can be used to calculate the start of the Outer-TLVs.  <br><br> </dd>
<dt>Version</dt>
<dd style="margin-left: 8">
<br><br> </dd>
<dt>Fragmented Message Length</dt>
<dd style="margin-left: 8">
<br><br> The Fragmented Message Length field is four octets, and is present only if the L bit is set.  This field provides the total length of the data after the Fragmented Message Length field in the TEAM message or set of messages that is being fragmented.  <br><br> </dd>
<dt>TLS Message Length</dt>
<dd style="margin-left: 8">
<br><br> The TLS Message Length field is four octets, and is present only if the T bit is set.  This field provides the total length of the TLS Data in the TEAM message.  Data after this length of TLS data are the Outer TLVs.  <br><br> </dd>
<dt>TLS Data</dt>
<dd style="margin-left: 8">
<br><br> The TLS data consists of the encapsulated packet in TLS record format.  <br><br> </dd>
<dt>Outer TLVs</dt>
<dd style="margin-left: 8">
<br><br> The Outer TLVs consist of the optional data used to help establishing the TLS tunnel in TLV format.  The start of the Outer-TLVs can be derived from the EAP Length field and TLS Length field.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#TLV-T" id="TLV-T">Type-Length-Value Tuples</a>
</h1>
<p id="rfc.section.6.p.1">The TLVs used within TEAM are standard Type-Length-Value (TLV) objects.  The TLV objects could be used to carry arbitrary parameters between EAP peer and EAP server.  Possible uses for TLV objects include: language and character set for Notification messages and cryptographic binding.  <br><br> The EAP peer may not necessarily implement all the TLVs supported by the EAP server; and hence to allow for interoperability, TLVs allow an EAP server to discover if a TLV is supported by the EAP peer, using the NAK TLV.  The TEAM packet does not have to contain any TLVs, nor need it contain any mandatory TLVs.  <br><br> The mandatory bit in a TLV indicates whether support of the TLV is required.  If the peer or server does not support the TLV, it MUST send a NAK TLV in response, and all the other TLVs in the message MUST be ignored.  If an EAP peer or server finds an unsupported TLV which is marked as optional, it can ignore the unsupported TLV. It MUST NOT send an NAK TLV.  <br><br> Note that a peer or server may support a TLV with the mandatory bit set, but may not understand the contents.  The appropriate response to a supported TLV with content that is not understood is defined by the TLV specification.  <br><br> Outer-TLVs SHOULD NOT be included in messages after the first two Outer-TLV messages sent by the peer and EAP server respectively.  A single Outer-TLV message may be fragmented in multiple TEAM packets.  <br><br> All Outer-TLVs MUST NOT have the mandatory bit set.  If an Outer-TLV has the mandatory bit set, then the packet MUST be ignored.  <br><br> TEAM implementations MUST support TLVs, as well as processing of mandatory/optional settings on the TLV.  </p>
<h1 id="rfc.section.6.1">
<a href="#rfc.section.6.1">6.1.</a> <a href="#TLV-F" id="TLV-F">TLV Format</a>
</h1>
<div id="#rfc.figure.8"></div>
<pre>
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |M|R|            TLV Type       |            Length             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                              Value...
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
<p id="rfc.section.6.1.p.1">TLVs are defined as described below.  The fields are transmitted from left to right.  </p>

<dl>
<dt>M</dt>
<dd style="margin-left: 8">
<br><br> <dl>
<dt>0 -</dt>
<dd style="margin-left: 8">Optional TLV</dd>
<dt>1 -</dt>
<dd style="margin-left: 8">Mandatory TLV</dd>
</dl>
<p> </p>
<br><br> </dd>
<dt>R</dt>
<dd style="margin-left: 8">
<br><br> Reserved, set to zero (0) <br><br> </dd>
<dt>TLV Type</dt>
<dd style="margin-left: 8">
<br><br> A 14-bit field, denoting the TLV type. Allocated types include: <br><br> <dl>
<dt>1  -</dt>
<dd style="margin-left: 8">Result</dd>
<dt>2  -</dt>
<dd style="margin-left: 8">NAK</dd>
<dt>3  -</dt>
<dd style="margin-left: 8">Error-Code</dd>
<dt>4  -</dt>
<dd style="margin-left: 8">Connection-Binding</dd>
<dt>5  -</dt>
<dd style="margin-left: 8">Vendor-Specific</dd>
<dt>6  -</dt>
<dd style="margin-left: 8">URI</dd>
<dt>7  -</dt>
<dd style="margin-left: 8">EAP-Payload</dd>
<dt>8  -</dt>
<dd style="margin-left: 8">Intermediate-Result</dd>
<dt>9  -</dt>
<dd style="margin-left: 8">Crypto-Binding</dd>
<dt>10 -</dt>
<dd style="margin-left: 8">Calling-Station-Id</dd>
<dt>11 -</dt>
<dd style="margin-left: 8">Called-Station-Id </dd>
<dt>12 -</dt>
<dd style="margin-left: 8">NAS-Port-Type</dd>
<dt>13 -</dt>
<dd style="margin-left: 8">Server-Identifier</dd>
<dt>14 -</dt>
<dd style="margin-left: 8">Identity-Type</dd>
<dt>15 -</dt>
<dd style="margin-left: 8">Server-Trusted-Root</dd>
<dt>16 -</dt>
<dd style="margin-left: 8">Request-Action</dd>
<dt>17 -</dt>
<dd style="margin-left: 8">PKCS#7</dd>
</dl>
<p> </p>
<br><br> </dd>
<dt>Length</dt>
<dd style="margin-left: 8">
<br><br> The length of the Value field in octets <br><br> </dd>
<dt>Value</dt>
<dd style="margin-left: 8">
<br><br> The value of the TLV <br><br> </dd>
</dl>

<p> </p>
<h1 id="rfc.section.6.2">
<a href="#rfc.section.6.2">6.2.</a> <a href="#R-TLV" id="R-TLV">Result TLV</a>
</h1>
<div id="#rfc.figure.9"></div>
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|M|R|         TLV Type          |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|             Status            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
<p id="rfc.section.6.2.p.1">The Result TLV provides support for acknowledged success and failure messages within TEAM.  TEAM implementations MUST support this TLV, which cannot be responded to with a NAK TLV.  If the Status field does not contain one of the known values, then the peer or EAP server MUST drop the connection.  The Result TLV is defined as follows: <br><br> </p>

<dl>
<dt>M</dt>
<dd style="margin-left: 8">
<br><br> 1 (Mandatory) <br><br> </dd>
<dt>R</dt>
<dd style="margin-left: 8">
<br><br> 0 <br><br> </dd>
<dt>TLV Type</dt>
<dd style="margin-left: 8">
<br><br> 1 for Result <br><br> </dd>
<dt>Length</dt>
<dd style="margin-left: 8">
<br><br> 2 <br><br> </dd>
<dt>Status</dt>
<dd style="margin-left: 8">
<br><br> The Status field is two octets.  Values include: <br><br> <ul class="empty">
<li>Success</li>
<li>Failure</li>
</ul>
<p> </p>
<br><br> </dd>
</dl>

<p> </p>
<h1 id="rfc.section.6.3">
<a href="#rfc.section.6.3">6.3.</a> <a href="#N-TLV" id="N-TLV">NAK TLV</a>
</h1>
<div id="#rfc.figure.10"></div>
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|M|R|         TLV Type          |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          Vendor-Id                            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|            NAK-Type           |           TLVs....
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
<p id="rfc.section.6.3.p.1">The NAK TLV allows a peer to detect TLVs that are not supported by the other peer.  A TLV packet can contain 0 or more NAK TLVs.  TEAM implementations MUST support the NAK TLV, which cannot be responded to with a NAK TLV.  The NAK TLV is defined as follows: </p>

<dl>
<dt>M</dt>
<dd style="margin-left: 8">
<br><br> 1 (Mandatory) <br><br> </dd>
<dt>R</dt>
<dd style="margin-left: 8">
<br><br> 0 <br><br> </dd>
<dt>TLV Type</dt>
<dd style="margin-left: 8">
<br><br> 2 for NAK <br><br> </dd>
<dt>Length</dt>
<dd style="margin-left: 8">
<br><br> &gt;= 6 <br><br> </dd>
<dt>Vendor-ID</dt>
<dd style="margin-left: 8">
<br><br> The Vendor-Id field is four octets, and contains the Vendor-Id of the TLV that was not supported.  The high-order octet is 0 and the low-order 3 octets are the SMI Network Management Private Enterprise Code of the Vendor in network byte order.  The Vendor- Id field MUST be zero for TLVs that are not Vendor-Specific TLVs.  For Vendor-Specific TLVs, the Vendor-ID MUST be set to the SMI code.  <br><br> </dd>
<dt>NAK-Type</dt>
<dd style="margin-left: 8">
<br><br> The NAK-Type field is two octets.  The field contains the Type of the TLV that was not supported.  A TLV of this Type MUST have been included in the previous packet.  <br><br> </dd>
<dt>TLVs</dt>
<dd style="margin-left: 8">
<br><br> This field contains a list of TLVs, each of which MUST NOT have the mandatory bit set.  These optional TLVs can be used in the future to communicate why the offending TLV was determined to be unsupported.  <br><br> </dd>
</dl>

<p> </p>
<h1 id="rfc.section.6.4">
<a href="#rfc.section.6.4">6.4.</a> <a href="#E-C-TLV" id="E-C-TLV">Error-Code TLV</a>
</h1>
<div id="#rfc.figure.11"></div>
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|M|R|         TLV Type          |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           Error-Code                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
<p id="rfc.section.6.4.p.1">The Error-Code TLV allows a TEAM peer or server to indicate errors to the other party.  A TLV packet can contain 0 or more Error TLVs.  Error-Code TLVs MUST be marked as Mandatory.  TEAM implementations MUST support the Error-Code TLV, which cannot be responded to with a NAK TLV.  The Error-Code TLV is defined as follows: </p>

<dl>
<dt>M</dt>
<dd style="margin-left: 8">
<br><br> 1 (Mandatory) <br><br> </dd>
<dt>R</dt>
<dd style="margin-left: 8">
<br><br> 0 <br><br> </dd>
<dt>TLV Type</dt>
<dd style="margin-left: 8">
<br><br> 3 for Error-Code <br><br> </dd>
<dt>Length</dt>
<dd style="margin-left: 8">
<br><br> 4 <br><br> </dd>
<dt>Error-Code</dt>
<dd style="margin-left: 8">
<br><br> The Error-Code field is four octets. Error Codes 1-999 represent successful outcomes (informative messages), 1000-1999 represent warnings, and codes 2000-2999 represent fatal errors. If an Error- Code TLV with a fatal error has been sent, then the conversation must be terminated.  <br><br> Currently defined values for Error-Code include: <br><br> <ul class="empty">
<li>Tunnel_Compromise_Error</li>
<li>Unexpected_TLVs_Exchanged</li>
</ul>
<p> </p>
<br><br> </dd>
</dl>

<p> </p>
<h1 id="rfc.section.6.5">
<a href="#rfc.section.6.5">6.5.</a> <a href="#Cryp-B-TLV" id="Cryp-B-TLV">Crypto-Binding TLV</a>
</h1>
<div id="#rfc.figure.12"></div>
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|M|R|         TLV Type          |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|    Reserved   |    Version    |  Received Ver.    | Sub-Type  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
~                             Nonce                             ~
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
~                          Compound MAC                         ~
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
<p id="rfc.section.6.5.p.1">The Crypto-Binding TLV is used prove that both peers participated in the sequence of authentications (specifically the TLS session and inner EAP methods that generate keys).  <br><br> Both the Binding Request (B1) and Binding Response (B2) use the same packet format.  However the Sub-Type indicates whether it is B1 or B2.  <br><br> The Crypto-Binding TLV MUST be used to perform Cryptographic Binding after each successful EAP method in a sequence of EAP methods is complete in TEAM Phase 2.  The Crypto-Binding TLV can also be used during Protected Termination.  <br><br> The Crypto-Binding TLV must have the version number received during the TEAM version negotiation.  The receiver of the Crypto-Binding TLV must verify that the version in the Crypto-Binding TLV matches the version it sent during the TEAM version negotiation.  If this check fails then the TLV is invalid.  <br><br> The receiver of the Crypto-Binding TLV must verify that the subtype is not set to any value other than the ones allowed.  If this check fails then the TLV is invalid.  <br><br> This message format is used for the Binding Request (B1) and also the Binding Response. This uses TLV type CRYPTO_BINDING_TLV.  TEAM implementations MUST support this TLV and this TLV cannot be responded to with a NAK TLV.  The Crypto-Binding TLV is defined as follows: <br><br> </p>

<dl>
<dt>M</dt>
<dd style="margin-left: 8">
<br><br> 1 (Mandatory) <br><br> </dd>
<dt>R</dt>
<dd style="margin-left: 8">
<br><br> 0 <br><br> </dd>
<dt>TLV Type</dt>
<dd style="margin-left: 8">
<br><br> 9 for Crypto-Binding <br><br> </dd>
<dt>Length</dt>
<dd style="margin-left: 8">
<br><br> 56 <br><br> </dd>
<dt>Reserved</dt>
<dd style="margin-left: 8">
<br><br> Reserved, set to zero (0) <br><br> </dd>
<dt>Version</dt>
<dd style="margin-left: 8">
<br><br> The Version field is a single octet, which is set to the version of Crypto-Binding TLV.  For the Crypto-Binding TLV defined in this specification, it is set to one (1).  <br><br> </dd>
<dt>Sub-Type</dt>
<dd style="margin-left: 8">
<br><br> The Sub-Type field is two octets.  Possible values include: <br><br> <dl>
<dt>0 -</dt>
<dd style="margin-left: 8">Binding Request</dd>
<dt>1 -</dt>
<dd style="margin-left: 8">Binding Response</dd>
</dl>
<p> </p>
<br><br> </dd>
<dt>Nonce</dt>
<dd style="margin-left: 8">
<br><br> The Nonce field is 32 octets.  It contains a 256 bit nonce that is temporally unique, used for compound MAC key derivation at each end.  This is the S_NONCE for the B1 message and a C_NONCE for the B2 message.  <br><br> </dd>
<dt>Compound MAC</dt>
<dd style="margin-left: 8">
<br><br> The Compound MAC field is 20 octets.  This can be the Server MAC (B1_MAC) or the Client MAC (B2_MAC).  It is computed using the HMAC-SHA1-160 keyed MAC that provides 160 bits of output using the CMK key.  The MAC is computed over the buffer created after concatenating these fields in the following order: <br><br> <ol>
<li>The entire Crypto-Binding TLV attribute with the MAC field zeroed out </li>
<li>The EAP Type sent by the other party in the first TEAM message </li>
<li>All the Outer-TLVs from the first TEAM message sent by EAP server to peer.  If a single TEAM message is fragmented into multiple TEAM packets; then the Outer-TLVs in all the fragments of that message MUST be included.  </li>
<li>All the Outer-TLVs from the first TEAM message sent by the peer to the EAP server.  If a single TEAM message is fragmented into multiple TEAM packets, then the Outer-TLVs in all the fragments of that message MUST be included.  </li>
</ol>
<p> </p>
</dd>
</dl>

<p> </p>
<h1 id="rfc.section.6.6">
<a href="#rfc.section.6.6">6.6.</a> <a href="#Conn-B-TLV" id="Conn-B-TLV">Connection-Binding TLV</a>
</h1>
<div id="#rfc.figure.13"></div>
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|M|R|         TLV Type          |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           TLVs...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
<p id="rfc.section.6.6.p.1">The Connection-Binding TLV allows for connection specific information to be sent by the peer to the AAA server.  This TLV should be logged by the EAP or AAA server.  The AAA or EAP server should not deny access if there is a mismatch between the value sent through the AAA protocol and this TLV.  <br><br> The format of this TLV is defined for the layer that defines the parameters.  The format of the value sent by the peer to the EAP server may be different from the format of the corresponding value sent through the AAA protocol.  For example, the connection binding TLV may contain the 802.11 MAC Address or SSID <a href="#IEEE.802-11.2007">[IEEE.802-11.2007]</a>.  <br><br> TEAM implementations MAY support this TLV and this TLV MUST NOT be responded to with a NAK TLV.  The Connection-Binding TLV is defined as follows: <br><br> </p>

<dl>
<dt>M</dt>
<dd style="margin-left: 8">
<br><br> 0 (Optional) <br><br> </dd>
<dt>R</dt>
<dd style="margin-left: 8">
<br><br> 0 <br><br> </dd>
<dt>TLV Type</dt>
<dd style="margin-left: 8">
<br><br> 4 for Connection-Binding <br><br> </dd>
<dt>Length</dt>
<dd style="margin-left: 8">
<br><br> &gt;= 0 <br><br> </dd>
<dt>TLVs</dt>
<dd style="margin-left: 8">
<br><br> The field contains a list of TLVs, each in the same format defined in <a href="#TLV-F">Section 6.1</a>, with the Mandatory flag bit cleared (0).  These TLVs contain information on the identity of the peer and authenticator (layer 2 or IP addresses); the media used to connect the peer and authenticator (NAS-Port-Type); and/or the service the client is trying to access on the gateway (SSID).  See <a href="#C-B-T-R">Section 6.19.4</a> for further information.  <br><br> </dd>
</dl>

<p> </p>
<h1 id="rfc.section.6.7">
<a href="#rfc.section.6.7">6.7.</a> <a href="#V-S-TLV" id="V-S-TLV">Vendor-Specific TLV</a>
</h1>
<div id="#rfc.figure.14"></div>
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|M|R|         TLV Type          |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          Vendor-Id                            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                         Vendor TLVs....
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
<p id="rfc.section.6.7.p.1">The Vendor-Specific TLV is available to allow vendors to support their own extended attributes not suitable for general usage.  <br><br> A Vendor-Specific-TLV can contain one or more TLVs, referred to as Vendor TLVs.  The TLV-type of the Vendor-TLV will be defined by the vendor.  All the Vendor TLVs inside a single Vendor- Specific TLV belong to the same vendor.  <br><br> TEAM implementations MUST support the Vendor-Specific TLV, and this TLV MUST NOT be responded to with a NAK TLV.  If a TEAM implementation does not support one or more of the Vendor TLVs inside in the Vendor-Specific TLV it SHOULD respond to the Vendor TLV(s) with NAK TLV(s) containing the appropriate Vendor-ID and Vendor-TLV type.  <br><br> Vendor TLVs may be optional or mandatory.  Vendor TLVs sent in the protected success and failure packets MUST be marked as optional.  If Vendor TLVs sent in protected success/failure packets are marked as Mandatory, then the peer or EAP server MUST drop the connection.  <br><br> The Vendor-Specific TLV is defined as follows: <br><br> </p>

<dl>
<dt>M</dt>
<dd style="margin-left: 8">
<br><br> 1 (Mandatory) <br><br> </dd>
<dt>R</dt>
<dd style="margin-left: 8">
<br><br> 0 <br><br> </dd>
<dt>TLV Type</dt>
<dd style="margin-left: 8">
<br><br> 5 for Vendor-Specific <br><br> </dd>
<dt>Length</dt>
<dd style="margin-left: 8">
<br><br> &gt;= 4 <br><br> </dd>
<dt>Vendor-ID</dt>
<dd style="margin-left: 8">
<br><br> The Vendor-Id field is four octets, and contains the Vendor-Id of the TLV that was not supported.  The high-order octet is 0 and the low-order 3 octets are the SMI Network Management Private Enterprise Code of the Vendor in network byte order.  The Vendor- Id field MUST be zero for TLVs that are not Vendor-Specific TLVs.  For Vendor-Specific TLVs, the Vendor-ID MUST be set to the SMI code.  <br><br> </dd>
<dt>Vendor TLVs</dt>
<dd style="margin-left: 8">
<br><br> This field is of indefinite length.  It contains vendor-specificTLVs, in a format defined by the vendor.  <br><br> </dd>
</dl>

<p> </p>
<h1 id="rfc.section.6.8">
<a href="#rfc.section.6.8">6.8.</a> <a href="#U-TLV" id="U-TLV">URI TLV</a>
</h1>
<div id="#rfc.figure.15"></div>
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|M|R|         TLV Type          |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                              URI
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
<p id="rfc.section.6.8.p.1">The URI TLV allows a server to send a URI to the client to refer it to a resource.  The TLV contains a URI in the format specified in RFC 3986 <a href="#RFC3986">[RFC3986]</a> with UTF-8 encoding.  Interpretation of the value of the URI is outside the scope of this document.  <br><br> If a packet contains multiple URI TLVs, then the client SHOULD select the first TLV it can implement, and ignore the others.  If the client is unable to implement any of the URI TLVs, then it MAY ignore the error.  TEAM implementations MAY support this TLV; and this TLV cannot be responded to with a NAK TLV.  The URI TLV is defined as follows: </p>

<dl>
<dt>M</dt>
<dd style="margin-left: 8">
<br><br> 0 (Optional) <br><br> </dd>
<dt>R</dt>
<dd style="margin-left: 8">
<br><br> 0 <br><br> </dd>
<dt>TLV Type</dt>
<dd style="margin-left: 8">
<br><br> 6 for URI <br><br> </dd>
<dt>Length</dt>
<dd style="margin-left: 8">
<br><br> &gt;= 0 <br><br> </dd>
<dt>URI</dt>
<dd style="margin-left: 8">
<br><br> This field is of indefinite length, and conforms to the format specified in RFC 3986.  <br><br> </dd>
</dl>

<p> </p>
<h1 id="rfc.section.6.9">
<a href="#rfc.section.6.9">6.9.</a> <a href="#E-P-TLV" id="E-P-TLV">EAP-Payload TLV</a>
</h1>
<div id="#rfc.figure.16"></div>
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|M|R|         TLV Type          |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          EAP-Packet...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                             TLVs...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
<p id="rfc.section.6.9.p.1">To allow piggybacking EAP request and response with other TLVs, the EAP Payload TLV is defined, which includes an encapsulated EAP packet and 0 or more TLVs.  TEAM implementations MUST support this TLV, which cannot be responded to with a NAK TLV.  The EAP-Payload TLV is defined as follows: </p>

<dl>
<dt>M</dt>
<dd style="margin-left: 8">
<br><br> 1 (Mandatory) <br><br> </dd>
<dt>R</dt>
<dd style="margin-left: 8">
<br><br> 0 <br><br> </dd>
<dt>TLV Type</dt>
<dd style="margin-left: 8">
<br><br> 7 for EAP-Payload <br><br> </dd>
<dt>Length</dt>
<dd style="margin-left: 8">
<br><br> &gt;= 0 <br><br> </dd>
<dt>EAP-Packet</dt>
<dd style="margin-left: 8">
<br><br> This field contains a complete EAP packet, including the EAP header (Code, Identifier, Length, Type) fields.  The length of this field is determined by the Length field of the encapsulated EAP packet.  <br><br> </dd>
<dt>TLVs</dt>
<dd style="margin-left: 8">
<br><br> This (optional) field contains a list of TLVs associated with the EAP-Packet field (see <a href="#E-P-T-R">Section 6.19.3</a>).  The TLVs utilize the same format described <a href="#TLV-F">Section 6.1</a>, and MUST NOT have the mandatory bit set.  The total length of this field is equal to the Length field of the EAP- Payload-TLV, minus the Length field in the EAP header of the EAP packet field.  <br><br> </dd>
</dl>

<p> </p>
<h1 id="rfc.section.6.10">
<a href="#rfc.section.6.10">6.10.</a> <a href="#I-R-TLV" id="I-R-TLV">Intermediate-Result TLV</a>
</h1>
<div id="#rfc.figure.17"></div>
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|M|R|         TLV Type          |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|             Status            |        TLVs...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
<p id="rfc.section.6.10.p.1">The Intermediate-Result TLV provides support for acknowledged intermediate Success and Failure messages within EAP.  TEAM implementations MUST support this TLV, which cannot be responded to with a NAK TLV.  The Intermediate-Result TLV is defined as follows: </p>

<dl>
<dt>M</dt>
<dd style="margin-left: 8">
<br><br> 1 (Mandatory) <br><br> </dd>
<dt>R</dt>
<dd style="margin-left: 8">
<br><br> 0 <br><br> </dd>
<dt>TLV Type</dt>
<dd style="margin-left: 8">
<br><br> 8 for Intermediate-Result <br><br> </dd>
<dt>Length</dt>
<dd style="margin-left: 8">
<br><br> &gt;= 2 <br><br> </dd>
<dt>Status</dt>
<dd style="margin-left: 8">
<br><br> The Status field is two octets.  Values include: <br><br> <ul class="empty">
<li>1 - Success</li>
<li>2 - Failure</li>
</ul>
<p> </p>
<br><br> </dd>
<dt>TLVs</dt>
<dd style="margin-left: 8">
<br><br> This (optional) field contains a list of TLVs associated with the Intermediate-Result TLV.  The TLVs utilize the same format described <a href="#TLV-F">Section 6.1</a>, and MUST NOT have the mandatory bit set.  <br><br> </dd>
</dl>

<p> </p>
<h1 id="rfc.section.6.11">
<a href="#rfc.section.6.11">6.11.</a> <a href="#Cg-S-TLV" id="Cg-S-TLV">Calling-Station-Id TLV</a>
</h1>
<div id="#rfc.figure.18"></div>
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|M|R|         TLV Type          |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           String...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
<p id="rfc.section.6.11.p.1">This TLV allows a peer to send information to EAP server about the call originator. This TLV MAY be included in the Connection-Binding- TLV.  <br><br> For dial-up, the Called-Station-ID TLV contains the phone number of the peer.  For use with IEEE 802.1X, the MAC address of the peer is included <a href="#RFC3580">[RFC3580]</a>.  <br><br> For VPN, this attribute is used to send the IPv4 or IPV6 address of the interface of the peer used to initiate the VPN in ASCII format.  Where the Fully Qualified Domain Name (FQDN) of the VPN client is known, it SHOULD be appended, separated from the address with a " " (space).  Example: "12.20.2.3 vpnserver.example.com".  <br><br> As described in <a href="#RFC3748">Section 7.15 of</a> <cite title="NONE">[RFC3748]</cite>, this TLV SHOULD be logged by the EAP or AAA server, and MAY be used for comparison with information gathered by other means.  <br><br> However, since the format of this TLV may not match the format of the information gathered by other means, if an EAP server or AAA server supports the capability to deny access based on a mismatch, spurious authentication failures may occur.  As a result, implementations SHOULD allow the administrator to disable this check.  <br><br> TEAM implementations MAY support this TLV and this TLV MUST NOT be responded to with a NAK TLV.  The Calling-Station-ID TLV is defined as follows: <br><br> </p>

<dl>
<dt>M</dt>
<dd style="margin-left: 8">
<br><br> 0 (Optional) <br><br> </dd>
<dt>R</dt>
<dd style="margin-left: 8">
<br><br> 0 <br><br> </dd>
<dt>TLV Type</dt>
<dd style="margin-left: 8">
<br><br> 10 for Calling-Station-Id <br><br> </dd>
<dt>Length</dt>
<dd style="margin-left: 8">
<br><br> &gt;= 0 <br><br> </dd>
<dt>String</dt>
<dd style="margin-left: 8">
<br><br> The field should be the same as the value of the Calling-Station-ID attribute in <a href="#RFC2865">[RFC2865]</a>.  <br><br> </dd>
</dl>

<p> </p>
<h1 id="rfc.section.6.12">
<a href="#rfc.section.6.12">6.12.</a> <a href="#Cd-S-TLV" id="Cd-S-TLV">Called-Station-Id TLV</a>
</h1>
<div id="#rfc.figure.19"></div>
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|M|R|         TLV Type          |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                     String...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
<p id="rfc.section.6.12.p.1">This TLV allows a peer to send information to EAP server about the NAS it called.  This TLV MAY be included in the Connection-Binding TLV.  <br><br> For dial-up, the Calling-Station-ID TLV contains the phone number called by the peer.  For use with IEEE 802.1X, the MAC address of the NAS is included, as specified in <a href="#RFC3580">[RFC3580]</a>.  <br><br> For VPN, this attribute is used to send the IPv4 or IPv6 address of VPN server in ASCII format.  Where the Fully Qualified Domain Name (FQDN) of the VPN server is known, it SHOULD be appended, separated from the address with a " " (space).  Example: "12.20.2.3 vpnserver.example.com".  <br><br> This TLV SHOULD be logged by the EAP or AAA server, and MAY be used for comparison with information gathered by other means.  However, since the format of this TLV may not match the format of the information gathered by other means, if an EAP server or AAA server supports the capability to deny access based on a mismatch, spurious authentication failures may occur.  As a result, implementations SHOULD allow the administrator to disable this check.  <br><br> TEAM implementations MAY support this TLV, and this TLV MUST NOT be responded to with a NAK TLV.  The Called-Station-ID TLV is defined as follows: <br><br> </p>

<dl>
<dt>M</dt>
<dd style="margin-left: 8">
<br><br> 0 (Optional) <br><br> </dd>
<dt>R</dt>
<dd style="margin-left: 8">
<br><br> 0 <br><br> </dd>
<dt>TLV Type</dt>
<dd style="margin-left: 8">
<br><br> 11 for Called-Station-Id <br><br> </dd>
<dt>Length</dt>
<dd style="margin-left: 8">
<br><br> &gt;= 0 <br><br> </dd>
<dt>String</dt>
<dd style="margin-left: 8">
<br><br> The field should be the same as the value of the Called-Station-ID attribute in <a href="#RFC2865">[RFC2865]</a>.  <br><br> </dd>
</dl>

<p> </p>
<h1 id="rfc.section.6.13">
<a href="#rfc.section.6.13">6.13.</a> <a href="#N-P-T-TLV" id="N-P-T-TLV">NAS-Port-Type TLV</a>
</h1>
<div id="#rfc.figure.20"></div>
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|M|R|         TLV Type          |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                            Value                              |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
<p id="rfc.section.6.13.p.1">This TLV allows a peer to send information to EAP server about the type of physical connection used by the peer to connect to NAS.  This TLV MAY be included in the Connection-Binding-TLV.  <br><br> The value of this field is the same as the value of NAS-Port-Type attribute in <a href="#RFC2865">[RFC2865]</a>.  <br><br> This TLV SHOULD be logged by the EAP or AAA server and MAY be used for comparison with information gathered by other means.  However, since the format of this TLV may not match the format of the information gathered by other means, if an EAP server or AAA server supports the capability to deny access based on a mismatch, spurious authentication failures may occur.  As a result, implementations SHOULD allow the administrator to disable this check.  <br><br> TEAM implementations MAY support this TLV; and this TLV MUST NOT be responded to with a NAK TLV.  The NAS-Port-Type TLV is defined as follows: <br><br> </p>

<dl>
<dt>M</dt>
<dd style="margin-left: 8">
<br><br> 0 (Optional) <br><br> </dd>
<dt>R</dt>
<dd style="margin-left: 8">
<br><br> 0 <br><br> </dd>
<dt>TLV Type</dt>
<dd style="margin-left: 8">
<br><br> 12 for NAS-Port-Type <br><br> </dd>
<dt>Length</dt>
<dd style="margin-left: 8">
<br><br> 4 <br><br> </dd>
<dt>String</dt>
<dd style="margin-left: 8">
<br><br> The String field is four octets.  Values are the same as for the NAS-Port-Type attribute defined in <a href="#RFC2865">[RFC2865]</a>.  <br><br> </dd>
</dl>

<p> </p>
<h1 id="rfc.section.6.14">
<a href="#rfc.section.6.14">6.14.</a> <a href="#S-I-TLV" id="S-I-TLV">Server-Identifier TLV</a>
</h1>
<div id="#rfc.figure.21"></div>
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|M|R|         TLV Type          |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                            String...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
<p id="rfc.section.6.14.p.1">This TLV allows a EAP server to send a hint to the EAP peer to help the EAP peer select the appropriate sessionID for session resumption.  The field is a string sent by the EAP server, and the field should be treated as a opaque string by the peer.  During a full-tls-handshake, the EAP peer MAY keep track of this field and the corresponding sessionID, and use it as a hint to select the appropriate sessionID during session resumption.  <br><br> TEAM implementations MAY support this TLV and this TLV MUST NOT be responded to with a NAK TLV.  The Server-Identifier TLV is defined as follows: <br><br> </p>

<dl>
<dt>M</dt>
<dd style="margin-left: 8">
<br><br> 0 (Optional) <br><br> </dd>
<dt>R</dt>
<dd style="margin-left: 8">
<br><br> 0 <br><br> </dd>
<dt>TLV Type</dt>
<dd style="margin-left: 8">
<br><br> 13 for Server-Identifier <br><br> </dd>
<dt>Length</dt>
<dd style="margin-left: 8">
<br><br> &#8805; 0 <br><br> </dd>
<dt>String</dt>
<dd style="margin-left: 8">
<br><br> Contains an identifier sent by the EAP server.  <br><br> </dd>
</dl>

<p> </p>
<h1 id="rfc.section.6.15">
<a href="#rfc.section.6.15">6.15.</a> <a href="#I-T-TLV" id="I-T-TLV">Identity-Type TLV</a>
</h1>
<div id="#rfc.figure.22"></div>
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|M|R|         TLV Type          |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|             Identity Type     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
<p id="rfc.section.6.15.p.1">The Identity-Type TLV allows an EAP server to send a hint to help the EAP-peer select the right type of identity; for example; user or machine.  <br><br> TEAM implementations MAY support this TLV, which cannot be responded to with a NAK TLV.  <br><br> If the Identity Type field does not contain one of the known values or if the EAP peer does not have an identity corresponding to the identity-type, then the peer MUST ignore the value.  The Identity- Type TLV is defined as follows: <br><br> </p>

<dl>
<dt>M</dt>
<dd style="margin-left: 8">
<br><br> 0 (Optional) <br><br> </dd>
<dt>R</dt>
<dd style="margin-left: 8">
<br><br> 0 <br><br> </dd>
<dt>TLV Type</dt>
<dd style="margin-left: 8">
<br><br> 14 for Identity-Type <br><br> </dd>
<dt>Length</dt>
<dd style="margin-left: 8">
<br><br> 2 <br><br> </dd>
<dt>Identity Type</dt>
<dd style="margin-left: 8">
<br><br> The Identity Type field is two octets.  Values include: <ul class="empty">
<li>1 - Human</li>
<li>2 - Machine</li>
</ul>
<p> </p>
<br><br> </dd>
</dl>

<p> </p>
<h1 id="rfc.section.6.16">
<a href="#rfc.section.6.16">6.16.</a> <a href="#S-T-R-TLV" id="S-T-R-TLV">Server-Trusted-Root TLV</a>
</h1>
<div id="#rfc.figure.23"></div>
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|M|R|         TLV Type          |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|         Credential Type       |     TLVs...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-++-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-
</pre>
<p id="rfc.section.6.16.p.1">The Server-Trusted-Root TLV allows the peer to send a request to the EAP server for a trusted root in PKCS #7 format.  <br><br> The Server-Trusted-Root TLV is always marked as optional, and cannot be responded to with a NAK TLV.  TEAM server implementations that claim to support provisioning MUST support Server-Trusted-Root TLV, PKCS#7 TLV, and the PKCS#7-Server-Certificate-Root credential format defined in this TLV.  TEAM peer implementations may not support this TLV.  <br><br> The Server-Trusted-Root TLV can only be sent as an inner TLV (inside the TEAM Phase 2 conversation), in both server unauthenticated tunnel provisioning mode, and the regular authentication process.  <br><br> The peer MUST NOT request, or accept the trusted root sent inside the Server-Root credential TLV by the EAP server until it has completed authentication of the EAP server, and validated the Crypto-Binding TLV.  The peer may receive a trusted root, but is not required to use the trusted root received from the EAP server.  <br><br> If the EAP server sets credential-format to PKCS#7-Server- Certificate-Root, then the Server-Trusted-Root TLV MUST contain the root of the certificate chain of the certificate issued to the EAP server packages in a PKCS#7 TLV.  If the Server certificate is a self-signed certificate, then the root is the self-signed certificate. In this case, the EAP server does not have to sign the certificate inside the PCKS#7 TLV since it does not necessarily have access to the private key for it.  <br><br> If the Server-Trusted-Root TLV credential format does not contain one of the known values, then the EAP server MUST ignore the value.  <br><br> The Server-Trusted-Root TLV is defined as follows: <br><br> </p>

<dl>
<dt>M</dt>
<dd style="margin-left: 8">
<br><br> 0 (Optional) <br><br> </dd>
<dt>R</dt>
<dd style="margin-left: 8">
<br><br> 0 <br><br> </dd>
<dt>TLV Type</dt>
<dd style="margin-left: 8">
<br><br> 15 for Server-Trusted-Root <br><br> </dd>
<dt>Length</dt>
<dd style="margin-left: 8">
<br><br> &#8805; 2 <br><br> </dd>
<dt>Credential Type</dt>
<dd style="margin-left: 8">
<br><br> The Credential Type field is two octets.  Values include: <ul class="empty"><li>1 - PKCS#7-Server-Certificate-Root</li></ul>
<p> </p>
<br><br> </dd>
<dt>TLVs</dt>
<dd style="margin-left: 8">
<br><br> This (optional) field contains a list of TLVs associated with the Server-Trusted-Root TLV.  The TLVs utilize the same format described <a href="#TLV-F">Section 6.1</a> and MUST NOT have the mandatory bit set.  See <a href="#S-T-R-T-R">Section 6.19.5</a> for further information.  <br><br> </dd>
</dl>

<p> </p>
<h1 id="rfc.section.6.17">
<a href="#rfc.section.6.17">6.17.</a> <a href="#PKCS-TLV" id="PKCS-TLV">PKCS#7 TLV</a>
</h1>
<div id="#rfc.figure.24"></div>
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|M|R|         TLV Type          |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|           PKCS#7 data...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
<p id="rfc.section.6.17.p.1">This TLV contains a certificate or certificate chain requested by the peer in PKCS#7 format <a href="#RFC2315">[RFC2315]</a>.  <br><br> The PKCS#7 TLV is always marked as optional, and cannot be responded to with a NAK TLV.  TEAM server implementations that claim to support provisioning MUST support this TLV.  TEAM peer implementations may not support this TLV.  <br><br> If the PKCS#7 TLV contains a certificate or certificate chain that is not acceptable to the peer, then peer MUST ignore the value.  <br><br> The PKCS#7 TLV is defined as follows: <br><br> </p>

<dl>
<dt>M</dt>
<dd style="margin-left: 8">
<br><br> 0 (Optional) <br><br> </dd>
<dt>R</dt>
<dd style="margin-left: 8">
<br><br> 0 <br><br> </dd>
<dt>TLV Type</dt>
<dd style="margin-left: 8">
<br><br> 17 for PKCS#7 <br><br> </dd>
<dt>Length</dt>
<dd style="margin-left: 8">
<br><br> &#8805; 0 <br><br> </dd>
<dt>PKCS#7 Data</dt>
<dd style="margin-left: 8">
<br><br> This field contains a certificate or certificate chain in PKCS#7 format.  <br><br> </dd>
</dl>

<p> </p>
<h1 id="rfc.section.6.18">
<a href="#rfc.section.6.18">6.18.</a> <a href="#R-A-TLV" id="R-A-TLV">Request-Action-TLV</a>
</h1>
<div id="#rfc.figure.25"></div>
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|M|R|         TLV Type          |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|             Action            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
<p id="rfc.section.6.18.p.1">The Request-Action TLV MAY be sent by the peer along with acknowledged failure.  It allows the peer to request the EAP server to negotiate EAP methods or process TLVs specified in the failure packet.  The server MAY ignore this TLV.  <br><br> TEAM implementations MUST support this TLV, which cannot be responded to with a NAK TLV.  <br><br> The Request-Action TLV is defined as follows: <br><br> </p>

<dl>
<dt>M</dt>
<dd style="margin-left: 8">
<br><br> 1 (Mandatory) <br><br> </dd>
<dt>R</dt>
<dd style="margin-left: 8">
<br><br> 0 <br><br> </dd>
<dt>TLV Type</dt>
<dd style="margin-left: 8">
<br><br> 16 for Request-Action <br><br> </dd>
<dt>Length</dt>
<dd style="margin-left: 8">
<br><br> 2 <br><br> </dd>
<dt>Action</dt>
<dd style="margin-left: 8">
<br><br> The Action field is two octets.  Values include: <br><br> <ul class="empty">
<li>0 - Reserved</li>
<li>1 - Process-TLV</li>
<li>2 - Negotiate-EAP</li>
</ul>
<p> </p>
<br><br> </dd>
</dl>

<p> </p>
<h1 id="rfc.section.6.19">
<a href="#rfc.section.6.19">6.19.</a> <a href="#TLV-R" id="TLV-R">TLV Rules</a>
</h1>
<p id="rfc.section.6.19.p.1">To save round trips, multiple TLVs can be sent in the single TEAM packet.  However, the encapsulation of multiple EAP Payload TLVs within a single TEAM packet is not supported in this version and MUST NOT be sent.  If the peer or EAP server receives multiple EAP Payload TLVs, then it MUST drop the connection.  <br><br> <br><br> </p>

<dl>
<dt>0</dt>
<dd style="margin-left: 5">This TLV MUST NOT be present in the packet</dd>
<dt>0+</dt>
<dd style="margin-left: 5">Zero or more instances of this TLV MAY be present in packet</dd>
<dt>0-1</dt>
<dd style="margin-left: 5">Zero or one instances of this TLV MAY be present in packet</dd>
<dt>1</dt>
<dd style="margin-left: 5">Exactly one instance of this TLV MUST be present in packet</dd>
</dl>

<p> </p>
<h1 id="rfc.section.6.19.1">
<a href="#rfc.section.6.19.1">6.19.1.</a> Outer TLVs</h1>
<div id="#rfc.table.1"></div>
<p>The following table provides a guide to which TLVs may be included in the TEAM packet outside the TLS channel, which kind of packets, and in what quantity: </p>
<table cellpadding="3" cellspacing="0" class="tt full left">
<thead><tr>
<th class="left">Request</th>
<th class="left">Response</th>
<th class="left">Success</th>
<th class="left">Failure</th>
<th class="left">TLV in unencrypted-TLVs field</th>
</tr></thead>
<tbody>
<tr>
<td class="left">0-1</td>
<td class="left">0</td>
<td class="left">0</td>
<td class="left">0</td>
<td class="left">Server-Identifier TLV</td>
</tr>
<tr>
<td class="left">0+</td>
<td class="left">0+</td>
<td class="left">0</td>
<td class="left">0</td>
<td class="left">Vendor-Specific TLV</td>
</tr>
</tbody>
</table>
<p id="rfc.section.6.19.1.p.1">Outer-TLVs MUST be marked as optional.  Vendor-TLVs inside a Vendor-Specific TLV MUST be marked as optional when included in Outer TLVs.  Outer-TLVs MUST NOT be included in messages after the first two TEAM messages sent by peer and EAP server respectively, i.e., the first EAP server to peer message and first peer to EAP server message. If a message is fragmented, the whole set of fragments is counted as one message.  If Outer-TLVs are included in messages after the first two TEAM messages, they MUST be ignored.  </p>
<h1 id="rfc.section.6.19.2">
<a href="#rfc.section.6.19.2">6.19.2.</a> Inner TLVs</h1>
<div id="#rfc.table.2"></div>
<p>The following table provides a guide to which Inner TLVs may be encapsulated in TLS in TEAM Phase 2, in which kind of packets, and in what quantity: </p>
<table cellpadding="3" cellspacing="0" class="tt full left">
<thead><tr>
<th class="left">Request</th>
<th class="left">Response</th>
<th class="left">Success</th>
<th class="left">Failure</th>
<th class="left">Inner TLV</th>
</tr></thead>
<tbody>
<tr>
<td class="left">0-1</td>
<td class="left">0-1</td>
<td class="left">0-1</td>
<td class="left">0-1</td>
<td class="left">Intermediate-Result</td>
</tr>
<tr>
<td class="left">0-1</td>
<td class="left">0-1</td>
<td class="left">0</td>
<td class="left">0</td>
<td class="left">EAP-Payload</td>
</tr>
<tr>
<td class="left">0-1</td>
<td class="left">0-1</td>
<td class="left">1</td>
<td class="left">1</td>
<td class="left">Result</td>
</tr>
<tr>
<td class="left">0-1</td>
<td class="left">0-1</td>
<td class="left">1</td>
<td class="left">1</td>
<td class="left">Crypto-Binding</td>
</tr>
<tr>
<td class="left">0+</td>
<td class="left">0+</td>
<td class="left">0+</td>
<td class="left">0+</td>
<td class="left">Error</td>
</tr>
<tr>
<td class="left">0+</td>
<td class="left">0+</td>
<td class="left">0</td>
<td class="left">0</td>
<td class="left">NAK</td>
</tr>
<tr>
<td class="left">0-1</td>
<td class="left">0-1</td>
<td class="left">0-1</td>
<td class="left">0-1</td>
<td class="left">Connection-Binding</td>
</tr>
<tr>
<td class="left">0+</td>
<td class="left">0+</td>
<td class="left">0+</td>
<td class="left">0+</td>
<td class="left">Vendor-Specific</td>
</tr>
<tr>
<td class="left">0+</td>
<td class="left">0</td>
<td class="left">0+</td>
<td class="left">0-1</td>
<td class="left">URI</td>
</tr>
<tr>
<td class="left">0+</td>
<td class="left">0</td>
<td class="left">0</td>
<td class="left">0</td>
<td class="left">Identity-Type</td>
</tr>
<tr>
<td class="left">0+</td>
<td class="left">0+</td>
<td class="left">0+</td>
<td class="left">0+</td>
<td class="left">Server-Trusted-Root</td>
</tr>
<tr>
<td class="left">0</td>
<td class="left">0-1</td>
<td class="left">0</td>
<td class="left">0-1</td>
<td class="left">Request-Action</td>
</tr>
</tbody>
</table>
<p>Vendor TLVs (included in Vendor-Specific TLVs) sent in the protected success and failure packets MUST be marked as optional.  If Vendor TLVs sent in protected success/failure packets are marked as Mandatory, then the peer or EAP server MUST drop the connection.  </p>
<div id="#rfc.table.3"></div>
<table cellpadding="3" cellspacing="0" class="tt full left">
<thead><tr>
<th class="left">Packet Type</th>
<th class="left">Description</th>
</tr></thead>
<tbody>
<tr>
<td class="left">Request</td>
<td class="left">TLS packet sent by the EAP server to the peer</td>
</tr>
<tr>
<td class="left">Response</td>
<td class="left">TLS packet sent by the peer to the EAP server</td>
</tr>
<tr>
<td class="left">Success</td>
<td class="left">TLS packet sent by the peer or EAP server as a protected success indication</td>
</tr>
<tr>
<td class="left">Failure</td>
<td class="left">TLS packet sent by the peer or EAP server as a protected failure indication</td>
</tr>
</tbody>
</table>
<h1 id="rfc.section.6.19.3">
<a href="#rfc.section.6.19.3">6.19.3.</a> <a href="#E-P-T-R" id="E-P-T-R">EAP-Payload TLV</a>
</h1>
<div id="#rfc.table.4"></div>
<p>The EAP-Payload TLV can contain other TLVs.  The table below defines which TLVs can be contained inside the EAP-Payload TLV and how many such TLVs can be included.  </p>
<table cellpadding="3" cellspacing="0" class="tt full left">
<thead><tr>
<th class="left">Request</th>
<th class="left">Response</th>
<th class="left">TLV</th>
</tr></thead>
<tbody>
<tr>
<td class="left">0+</td>
<td class="left">0+</td>
<td class="left">Vendor-Specific</td>
</tr>
<tr>
<td class="left">0+</td>
<td class="left">0+</td>
<td class="left">Identity-Type</td>
</tr>
</tbody>
</table>
<p>Vendor TLVs encapsulated in a Vendor-Specific TLV MUST be marked as optional when included in an EAP-Payload TLV.  </p>
<h1 id="rfc.section.6.19.4">
<a href="#rfc.section.6.19.4">6.19.4.</a> <a href="#C-B-T-R" id="C-B-T-R">Connection-Binding TLV</a>
</h1>
<div id="#rfc.table.5"></div>
<p>The Connection-Binding TLV can contain other TLVs.  The table below defines which TLVs can be contained inside the Connection-Binding TLV and how many such TLVs can be included.  </p>
<table cellpadding="3" cellspacing="0" class="tt full left">
<thead><tr>
<th class="left">Request</th>
<th class="left">Response</th>
<th class="left">TLV</th>
</tr></thead>
<tbody>
<tr>
<td class="left">0-1</td>
<td class="left">0</td>
<td class="left">Calling-Station-ID</td>
</tr>
<tr>
<td class="left">0-1</td>
<td class="left">0</td>
<td class="left">Called-Station-ID</td>
</tr>
<tr>
<td class="left">0-1</td>
<td class="left">0</td>
<td class="left">NAS-Port-Type</td>
</tr>
<tr>
<td class="left">0+</td>
<td class="left">0+</td>
<td class="left">Vendor-Specific</td>
</tr>
</tbody>
</table>
<p>Vendor TLVs encapsulated in a Vendor-Specific TLV MUST be marked as optional when included in a Connection-Binding TLV.  </p>
<h1 id="rfc.section.6.19.5">
<a href="#rfc.section.6.19.5">6.19.5.</a> <a href="#S-T-R-T-R" id="S-T-R-T-R">Server-Trusted-Root TLV</a>
</h1>
<div id="#rfc.table.6"></div>
<p>The Server-Trusted-Root TLV can contain other TLVs.  The table below defines which TLVs can be contained inside the Server-Trusted-Root TLV and how many such TLVs can be included.  </p>
<table cellpadding="3" cellspacing="0" class="tt full left">
<thead><tr>
<th class="left">Request</th>
<th class="left">Response</th>
<th class="left">TLV</th>
</tr></thead>
<tbody><tr>
<td class="left">0-1</td>
<td class="left">0</td>
<td class="left">PKCS#7</td>
</tr></tbody>
</table>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> <a href="#Security" id="Security">Security Considerations</a>
</h1>
<h1 id="rfc.section.7.1">
<a href="#rfc.section.7.1">7.1.</a> <a href="#A-I-P" id="A-I-P">Authentication and Integrity Protection</a>
</h1>
<p id="rfc.section.7.1.p.1">TEAM provides a server authenticated, encrypted and integrity protected tunnel.  All data within the tunnel has these properties.  Data outside the tunnel such as EAP Success and Failure, Outer-TLVs, authentication methods negotiated outside of TEAM and the TEAM headers themselves (including the EAP-Type in the header) are not protected by this tunnel.  <br><br> In addition, the Crypto-Binding TLV can reveal a man-in-the-middle attack described in <a href="#MITM-A-P">Section 7.8</a>, below.  Hence, the server should not reveal any sensitive data to the client until after the Crypto-Binding TLV has been properly verified.  <br><br> In order to detect the modification of Outer TLVs, the first two Outer TLV messages sent by both peer and EAP server are included in the calculation of the Crypto-Binding TLV.  Outer-TLVs SHOULD NOT be included in other TEAM packets since there is no mechanism to detect modification.  <br><br> In order to detect modification of EAP-Type sent in the clear (EAP-Type should be set to TEAM), the EAP-Type sent in the first two messages by both peer and EAP server is included in the calculation of Crypto-Binding TLV.  The EAP-Type in the clear could be modified in other TEAM packets and will likely result in failure, hence it is not included in the Crypto-Binding calculation.  </p>
<h1 id="rfc.section.7.2">
<a href="#rfc.section.7.2">7.2.</a> <a href="#M-N" id="M-N">Method Negotiation</a>
</h1>
<p id="rfc.section.7.2.p.1">If the peer does not support TEAM, or does not wish to utilize TEAM authentication, it MUST respond to the initial EAP- Request/TEAM-Start with a NAK, suggesting an alternate authentication method. Since the NAK is sent in cleartext with no integrity protection or authentication, it is subject to spoofing.  Inauthentic NAK packets can be used to trick the peer and authenticator into "negotiating down" to a weaker form of authentication, such as EAP- MD5 (which only provides one way authentication and does not derive a key).  <br><br> Since a subsequent protected EAP conversation can take place within the TLS session, selection of TEAM as an authentication method does not limit the potential secondary authentication methods.  As a result, the only legitimate reason for a peer to NAK TEAM as an authentication method is that it does not support it.  Where the additional security of TEAM is required, server implementations SHOULD respond to a NAK with an EAP-Failure, terminating the authentication conversation.  <br><br> Since method negotiation outside of TEAM is not protected, if the peer is configured to allow TEAM and other EAP methods at the same time, the negotiation is subject to downgrade attacks.  Since method negotiation outside of TEAM is not protected, if the peer is configured to allow TEAM and previous TEAM versions at the same time, the negotiation is subject to negotiation downgrade attacks.  However, peers configured to allow TEAM and later TEAM versions may not be subject to downgrade negotiation attack since the highest version supported by both peers is checked within the protected tunnel.  <br><br> If peer implementations select incorrect methods or credentials with EAP servers, then attacks are possible on the credentials. Hence, a TEAM peer implementation should preferably be configured with a set of credentials and methods that may be used with a specific TEAM server. The peer implementation may be configured to use different methods and/or credentials based on the TEAM server.  </p>
<h1 id="rfc.section.7.3">
<a href="#rfc.section.7.3">7.3.</a> <a href="#T-S-C-H" id="T-S-C-H">TLS Session Cache Handling</a>
</h1>
<p id="rfc.section.7.3.p.1">In cases where a TLS session has been successfully resumed, in some circumstances, it is possible for the EAP server  to skip TEAM Phase 2, and successfully conclude the conversation with a protected termination.  <br><br> TEAM "fast reconnect" is desirable in applications such as wireless roaming, since it minimizes interruptions in connectivity.  It is also desirable when the "inner" EAP mechanism used is such that it requires user interaction.  The user should not be required to re- authenticate herself, using biometrics, token cards or similar, every time the radio connectivity is handed over between access points in wireless environments.  <br><br> However, there are issues that need to be understood in order to avoid introducing security vulnerabilities.  <br><br> Since Phase 1 of TEAM may not provide client authentication, establishment of a TLS session (and an entry in the TLS session cache) does not by itself provide an indication of the peer's authenticity.  <br><br> Some TEAM implementations may not be capable of removing TLS session cache entries established in TEAM Phase 1 after an unsuccessful Phase 2 authentication. In such implementations, the existence of a TLS session cache entry provides no indication that the peer has previously been authenticated. As a result, implementations that do not remove TLS session cache entries after a TEAM Phase 2 authentication or failed protected termination MUST use other means than successful TLS resumption as the indicator of whether the client is authenticated or not.  The implementation MUST determine that the client is authenticated only after the completion of protected termination.  Failing to do this would enable a peer to gain access by completing TEAM Phase 1, tearing down the connection, re-connecting and resuming TEAM Phase 2, thereby proving herself authenticated.  Thus, TLS resumption MUST only be enabled if the implementation supports TLS session cache removal.  If an EAP server implementing TEAM removes TLS session cache entries of peers failing TEAM Phase 2 authentication, then it MAY skip the TEAM Phase 2 conversation entirely after a successful session resumption, successfully terminating the TEAM conversation as described in <a href="#P-T">Section 4.4.2</a>.  </p>
<h1 id="rfc.section.7.4">
<a href="#rfc.section.7.4">7.4.</a> <a href="#C-R" id="C-R">Certificate Revocation</a>
</h1>
<p id="rfc.section.7.4.p.1">Since the EAP server usually has network connectivity during the EAP conversation, the server is capable of following a certificate chain or verifying whether the peer's certificate has been revoked. In contrast, the peer may or may not have network connectivity, and thus while it can validate the EAP server's certificate based on a pre- configured set of CAs, it may not be able to follow a certificate chain or verify whether the EAP server's certificate has been revoked.  <br><br> In the case where the peer is initiating a voluntary Layer 2 channel using PPTP <a href="#RFC2637">[RFC2637]</a> or L2TP <a href="#RFC3931">[RFC3931]</a>, the peer will typically already have network connectivity established at the time of channel initiation.  As a result, during the EAP conversation it is capable of checking for certificate revocation.  <br><br> As part of the TLS negotiation, the server presents a certificate to the peer.  The peer SHOULD verify the validity of the EAP server certificate, and SHOULD also examine the EAP server name presented in the certificate, in order to determine whether the EAP server can be trusted. Please note that in the case where the EAP authentication is remoted, the EAP server will not reside on the same machine as the authenticator, and therefore the name in the EAP server's certificate cannot be expected to match that of the intended destination.  In this case, a more appropriate test might be whether the EAP server's certificate is signed by a CA controlling the intended destination and whether the EAP server exists within a target sub-domain.  <br><br> In the case where the peer is attempting to obtain network access, it will not have network connectivity.  The TLS Extensions <a href="#RFC5246">[RFC5246]</a> support piggybacking of an Online Certificate Status Protocol <a href="#RFC2560">[RFC2560]</a> or a Server-based Certificate Validation Protocol <a href="#RFC5055">[RFC5055]</a> response within TLS, therefore can be utilized by the peer in order to verify the validity of server certificate.  However, since not all TLS implementations implement the TLS extensions, it may be necessary for the peer to wait to check for certificate revocation until after network access has been obtained.  In this case, the peer SHOULD conduct the certificate status check immediately upon going online and SHOULD NOT send data until it has received a positive response to the status request.  If the server certificate is found to be invalid as per client policy, then the peer SHOULD disconnect.  <br><br> If the client has a policy to require checking certificate revocation and it cannot obtain revocation information then it may need to disallow the use of all or some of the inner methods since some methods may reveal some sensitive information.  </p>
<h1 id="rfc.section.7.5">
<a href="#rfc.section.7.5">7.5.</a> <a href="#S-E-S-A" id="S-E-S-A">Separation of EAP Server and Authenticator</a>
</h1>
<p id="rfc.section.7.5.p.1">As a result of a complete TEAM conversation, the EAP endpoints will mutually authenticate, and derive a session key for subsequent use in link layer security. Since the peer and EAP client reside on the same machine, it is necessary for the EAP client module to pass the session key to the link layer encryption module.  <br><br> The situation may be more complex on the Authenticator, which may or may not reside on the same machine as the EAP server. In the case where the EAP server and the Authenticator reside on different machines, there are several implications for security. Firstly, the mutual authentication defined in TEAM will occur between the peer and the EAP server, not between the peer and the authenticator. This means that as a result of the TEAM conversation, it is not possible for the peer to validate the identity of the NAS or channel server that it is speaking to.  <br><br> The second issue is that the session key negotiated between the peer and EAP server will need to be transmitted to the authenticator.  Therefore a secure mechanism needs to be provided to transmit the session key from the EAP server to the authenticator or channel server that needs to use the key. The specification of this transit mechanism is outside the scope of this document.  </p>
<h1 id="rfc.section.7.6">
<a href="#rfc.section.7.6">7.6.</a> <a href="#S-T-P-1-2" id="S-T-P-1-2">Separation of TEAM Phase 1 and 2 Servers</a>
</h1>
<p id="rfc.section.7.6.p.1">The EAP server involved in TEAM Phase 2 need not necessarily be the same as the EAP server involved in Phase 1.  For example, a local authentication server or proxy might serve as the endpoint for the Phase 1 conversation, establishing the TLS channel.  Subsequently, once the EAP-Response/Identity has been received within the TLS channel, it can be decrypted and forwarded in cleartext to the destination realm EAP server.  The rest of the conversation will therefore occur between the destination realm EAP server and the peer, with the local authentication server or proxy acting as an encrypting/decrypting gateway. This permits a non-TLS capable EAP server to participate in the TEAM conversation.  <br><br> Note however that such an approach introduces security vulnerabilities.  Since the EAP Response/Identity is sent in the clear between the proxy and the EAP server, this enables an attacker to snoop the user's identity.  It also enables a remote environments, which may be public hot spots or Internet coffee shops, to gain knowledge of the identity of their users.  Since one of the potential benefits of TEAM is identity protection, this is undesirable.  <br><br> If the EAP method negotiated during TEAM Phase 2 does not support mutual authentication, then if the Phase 2 conversation is proxied to another destination, the TEAM peer will not have the opportunity to verify the secondary EAP server's identity. Only the initial EAP server's identity will have been verified as part of TLS session establishment.  <br><br> Similarly, if the EAP method negotiated during TEAM Phase 2 is vulnerable to dictionary attack, then an attacker capturing the cleartext exchange will be able to mount an offline dictionary attack on the password.  <br><br> Finally, when a Phase 2 conversation is terminated at a different location than the Phase 1 conversation, the Phase 2 destination is unaware that the EAP client has negotiated TEAM. As a result, it is unable to enforce policies requiring TEAM. Since some EAP methods require TEAM in order to generate keys or lessen security vulnerabilities, where such methods are in use, such a configuration may be unacceptable.  <br><br> In summary, TEAM encrypting/decrypting gateway configurations are vulnerable to attack and SHOULD NOT be used.  Instead, the entire TEAM connection SHOULD be proxied to the final destination, and the subsequently derived master session keys need to be transmitted back.  This provides end-to-end protection of TEAM.  The specification of this transit mechanism is outside the scope of this document, but mechanisms similar to those described in <a href="#RFC2548">[RFC2548]</a> can be used.  These steps protect the client from revealing her identity to the remote environment.  <br><br> In order to find the proper TEAM destination, the EAP client SHOULD place a Network Access Identifier (NAI) <a href="#RFC4282">[RFC4282]</a> in the Identity Response.  <br><br> There may be cases where a natural trust relationship exists between the (foreign) authentication server and final EAP server, such as on a campus or between two offices within the same company, where there is no danger in revealing the identity of the station to the authentication server.  In these cases, a proxy solution without end to end protection of TEAM MAY be used. If RADIUS <a href="#RFC2865">[RFC2865]</a> is used to communicate between gateway and EAP server, then the TEAM encrypting/decrypting gateway SHOULD provide support for IPsec protection of RADIUS in order to provide confidentiality for the portion of the conversation between the gateway and the EAP server, as described in <a href="#RFC3579">[RFC3579]</a>.  </p>
<h1 id="rfc.section.7.7">
<a href="#rfc.section.7.7">7.7.</a> <a href="#I-V" id="I-V">Identity Verification</a>
</h1>
<p id="rfc.section.7.7.p.1">Since the TLS session has not yet been negotiated, the initial Identity request/response occurs in the clear without integrity protection or authentication. It is therefore subject to snooping and packet modification.  <br><br> In configurations where all users are required to authenticate with TEAM and the first portion of the TEAM conversation is terminated at a local backend authentication server, without routing by proxies, the initial cleartext Identity Request/Response exchange is not needed in order to determine the required authentication method(s) or route the authentication conversation to its destination. As a result, the initial Identity and  Request/Response exchange may not be present, and a subsequent Identity Request/Response exchange MAY occur after the TLS session is established.  <br><br> If the initial cleartext Identity Request/Response has been tampered with, after the TLS session is established, it is conceivable that the EAP Server will discover that it cannot verify the peer's claim of identity. For example, the peer's userID may not be valid or may not be within a realm handled by the EAP server. Rather than attempting to proxy the authentication to the server within the correct realm, the EAP server SHOULD terminate the conversation.  <br><br> The TEAM peer can present the server with multiple identities. This includes the claim of identity within the initial EAP- Response/Identity (MyID) packet, which is typically used to route the EAP conversation to the appropriate home backend authentication server. There may also be subsequent EAP-Response/Identity packets sent by the peer once the TLS channel has been established.  <br><br> Note that since the TEAM peer may not present a certificate, it is not always possible to check the initial EAP-Response/Identity against the identity presented in the certificate, as is done in <a href="#RFC5216">[RFC5216]</a>.  <br><br> Moreover, it cannot be assumed that the peer identities presented within multiple EAP-Response/Identity packets will be the same. For example, the initial EAP-Response/Identity might correspond to a machine identity, while subsequent identities might be those of the user. Thus, TEAM implementations SHOULD NOT abort the authentication just because the identities do not match.  However, since the initial EAP-Response/Identity will determine the EAP server handling the authentication, if this or any other identity is inappropriate for use with the destination EAP server, there is no alternative but to terminate the TEAM conversation.  <br><br> The protected identity or identities presented by the peer within TEAM Phase 2 may not be identical to the cleartext identity presented in TEAM Phase 1, for legitimate reasons. In order to shield the userID from snooping, the cleartext Identity may only provide enough information to enable routing of the authentication request to the correct realm. For example, the peer may initially claim the identity of "nouser@bigco.com" in order to route the authentication request to the bigco.com EAP server. Subsequently, once the TLS session has been negotiated, in TEAM Phase 2, the peer may claim the identity of "fred@bigco.com".  Thus, TEAM can provide protection for the user's identity, though not necessarily the destination realm, unless the TEAM Phase 1 conversation terminates at the local authentication server.  <br><br> As a result, TEAM implementations SHOULD NOT attempt to compare the Identities claimed with Phases 1 and 2 of the TEAM conversation.  Similarly, if multiple Identities are claimed within TEAM  Phase 2, these SHOULD NOT be compared. An EAP conversation may involve more than one EAP authentication method, and the identities claimed for each of these authentications could be different (e.g. a machine authentication, followed by a user authentication).  </p>
<h1 id="rfc.section.7.8">
<a href="#rfc.section.7.8">7.8.</a> <a href="#MITM-A-P" id="MITM-A-P">Man-in-the-Middle Attack Protection</a>
</h1>
<p id="rfc.section.7.8.p.1">TLS protection can address a number of weaknesses in the EAP method; as well as EAP protocol weaknesses listed in the abstract and introduction sections in this document.  <br><br> Hence, the recommended solution is to always deploy authentication methods with protection of TEAM.  <br><br> If a deployment chooses to allow a EAP method protected by TEAM without protection of TEAM or IPsec at the same time, then this opens up a possibility of a man-in-the-middle attack.  <br><br> A man-in-the-middle can spoof the client to authenticate to it instead of the real EAP server; and forward the authentication to the real server over a protected tunnel. Since the attacker has access to the keys derived from the tunnel, it can gain access to the network.  <br><br> TEAM prevents this attack by using the keys generated by the inner EAP method in the crypto-binding exchange described in protected termination section. This attack is not prevented if the inner EAP method does not generate keys or if the keys generated by the inner EAP method can be compromised.  Hence, in cases where the inner EAP method does not generate keys, the recommended solution is to always deploy authentication methods protected by TEAM.  <br><br> Alternatively, the attack can also be thwarted if the inner EAP method can signal to the peer that the packets are being sent within the tunnel.  In most cases this may require modification to the inner EAP method.  In order to allow for these implementations, TEAM implementations should inform inner EAP methods that the EAP method is being protected by a TEAM tunnel.  <br><br> Since all sequence negotiations and exchanges are protected by TLS channel, they are immune to snooping and MITM attacks with the use of Crypto-Binding TLV. To make sure the same parties are involved tunnel establishment and previous inner method, before engaging the next method to sent more sensitive information, both peer and server MUST use the Crypto-Binding TLV between methods to check the tunnel integrity. If the Crypto-Binding TLV failed validation, they SHOULD stop the sequence and terminate the tunnel connection, to prevent more sensitive information being sent in subsequent methods.  </p>
<h1 id="rfc.section.7.9">
<a href="#rfc.section.7.9">7.9.</a> <a href="#C-F" id="C-F">Cleartext Forgeries</a>
</h1>
<p><a href="#RFC3748">As described in</a> <cite title="NONE">[RFC3748]</cite>, EAP Success and Failure packets are not authenticated, so that they may be forged by an attacker without fear of detection. Forged EAP Failure packets can be used to convince an EAP peer to disconnect.  Forged EAP Success and Failure packets may be used to convince a peer to disconnect; or convince a peer to access the network even before authentication is complete, resulting in denial of service for the peer.  <br><br> By supporting encrypted, authenticated and integrity protected success/failure indications, TEAM provides protection against these attacks.  <br><br> Once the peer responds with the first TEAM packet; and the EAP server receives the first TEAM packet from the peer, both MUST silently discard all clear text EAP messages unless both the TEAM peer and server have indicated success or failure or error using a protected error or protected termination mechanism.  The success/failure decisions sent by a protected mechanism indicate the final decision of the EAP authentication conversation.  After success/failure has been indicated by a protected mechanism, the TEAM client can process unprotected EAP success and EAP failure message; however MUST ignore any unprotected EAP success or failure messages where the decision does not match the decision of the protected mechanism.  <br><br> After a Fatal alert is received or after protected termination is complete, the peer or EAP server should accept clear text EAP messages.  If the TEAM tunnel is nested inside another tunnel, then the clear text EAP messages should only be accepted after protected termination of outer tunnels.  <br><br> RFC 3748 states that an EAP Success or EAP Failure packet terminates the EAP conversation, so that no response is possible.  Since EAP Success and EAP Failure packets are not retransmitted, if the final packet is lost, then authentication will fail.  As a result, where packet loss is expected to be non-negligible, unacknowledged success/failure indications lack robustness.  <br><br> As a result, a EAP server SHOULD send a clear text EAP Success or Failure packet after the protected success or failure packet or TLS alert. The peer MUST NOT require the clear text EAP Success or EAP Failure if it has received the protected success or failure or TLS alert. For more details, refer to Section 4.2 of RFC 3748.  </p>
<h1 id="rfc.section.7.10">
<a href="#rfc.section.7.10">7.10.</a> <a href="#TLS-C" id="TLS-C">TLS Ciphersuites</a>
</h1>
<p id="rfc.section.7.10.p.1">Anonymous ciphersuites are vulnerable to man-in-the-middle attacks, and SHOULD NOT be used with TEAM, unless the EAP methods inside TEAM can address the man-in-the-middle attack or unless the man-in- the-middle attack can be addressed by mechanisms external to TEAM.  </p>
<h1 id="rfc.section.7.11">
<a href="#rfc.section.7.11">7.11.</a> <a href="#DoS-A" id="DoS-A">Denial of Service Attacks</a>
</h1>
<p id="rfc.section.7.11.p.1">Denial of service attacks are possible if the attacker can insert or modify packets in the authentication channel.  The attacker can modify unprotected fields in the TEAM packet such as the EAP protocol or TEAM version number.  This can result in a denial of service attack.  It is also possible for the attacker to modify protected fields in a packet to cause decode errors resulting in a denial of service.  In these ways the attacker can prevent access for peers connecting to the network.  <br><br> Denial of service attacks with multiplier impacts are more interesting than the ones above.  It is possible to multiply the impact by creating a large number of TLS sessions with the EAP server.  </p>
<h1 id="rfc.section.7.12">
<a href="#rfc.section.7.12">7.12.</a> <a href="#S-U-T-P-M" id="S-U-T-P-M">Server Unauthenticated Tunnel Provisioning Mode</a>
</h1>
<p id="rfc.section.7.12.p.1">This section describes the rationale and security risks behind server unauthenticated tunnel provisioning mode.  Server unauthenticated tunnel provisioning mode can result in potential security vulnerabilities.  Hence, this mode is optional in TEAM implementations.  <br><br> In order to achieve strong mutual authentication, it is best to use an out of band mechanism to pre-provision the device with strong symmetric or asymmetric keys.  In addition, if the device is not physically secure (mobile or devices at public places), then it is important to ensure that the device has secure storage.  <br><br> Server unauthenticated tunnel provisioning mode is not recommended for use in devices which already support secure provisioning and secure credential storage capabilities.  <br><br> If the provisioned credential is a shared key or asymmetric key issued to the peer, then the credential should only be issued to devices that can protect the provisioned credentials using secure storage, or use physical security.  <br><br> If the credentials are not protected, the attacker can compromise the provisioned credentials, and use them to get access to the network.  Mobile light weight devices are typically not physically secure.  Another concern is that credentials provisioned to a light weight mobile device that does not use secure storage could be transferred to a general operating system and used to get access to the network.  <br><br> If the provisioned credential is a certificate trusted root of the EAP server, this is public information and hence not susceptible to the same attacks as a shared key or asymmetric key.  <br><br> In server unauthenticated tunnel provisioning mode, an attacker may terminate the tunnel instead of the real server.  The attacker can be detected after the Crypto-Binding TLV is exchanged and validated.  However, the EAP packets exchanged inside the tunnel until Crypto- Binding TLV is validated are available in unencrypted form to the attacker.  It is difficult to completely negate the security risk unless the EAP methods inside the tunnel are secure; or unless physical wire security is assumed.  <br><br> The standard credential request/response capability is designed to be independent of the server unauthenticated tunnel provisioning mode, and can be used in regular authentication mode to provision other credentials to the peer that can be used for authentication to the network, or for potentially authentications to other services.  <br><br> The security risks vary depending on the type of credential exchanged, the scope of use of the credential, and the implementation of the device.  <br><br> These are a few guidelines to reduce the security risk: <br><br> </p>

<ol>
<li>Minimize the use of this mode only during initial authentication to the network to reduce the risk of attack <br><br> </li>
<li>The password-based EAP method used in provisioned mode MUST be resistant to dictionary attacks <br><br> </li>
<li>Disable this mode by default and require users to initiate provisioning mode explicitly rather than being prompted during initiation of regular authentication process <br><br> </li>
<li>Provide appropriate policy capabilities to allow administrators to lockdown the device and prevent regular users from enabling the mode <br><br> </li>
<li>Ensure that the EAP methods used support mutual authentication, key derivation and resistance to dictionary attack <br><br> </li>
<li>Ensure that the keys generated by EAP methods are of sufficient strength to prevent compounding binding from being compromised <br><br> </li>
<li>Minimize the information disclosed to the EAP server <br><br> </li>
</ol>

<p> </p>
<h1 id="rfc.section.7.13">
<a href="#rfc.section.7.13">7.13.</a> <a href="#S-C" id="S-C">Security Claims</a>
</h1>
<p><a href="#RFC4017">[RFC4017]</a>.  <br><br> TEAM derives keys by combining keys from TLS and the inner EAP methods. It should be noted that the use of TLS ciphersuites with a particular key lengths does not guarantee that the key strength of the keys will be equivalent to the length.  The key exchange mechanisms (e.g., RSA or Diffie-Hellman) used must provide sufficient security or they will be the weakest link.  For example, RSA key sizes with a modulus of 1024 bits provides less than 128 bits of security; this may provide sufficient key strength for some applications and not for others.  See <a href="#RFC3766">BCP 86</a> <cite title="NONE">[RFC3766]</cite> for a detailed analysis of the strength requirements on the public keys used to exchange symmetric keys.  </p>

<dl>
<dt>Intended use:</dt>
<dd style="margin-left: 26">Wireless or Wired networks, and over the Internet, where physical security cannot be assumed <br><br> </dd>
<dt>Authentication mechanism:</dt>
<dd style="margin-left: 26">Uses arbitrary EAP and TLS authentication mechanisms for authentication of the client and server.  <br><br> </dd>
<dt>Ciphersuite negotiation: </dt>
<dd style="margin-left: 26">Yes <br><br> </dd>
<dt>Mutual authentication:</dt>
<dd style="margin-left: 26">Yes (depends on the type of EAP method used within the tunnel and the type of authentication used within TLS) <br><br> </dd>
<dt>Integrity protection:</dt>
<dd style="margin-left: 26">Yes <br><br> </dd>
<dt>Replay protection:</dt>
<dd style="margin-left: 26">Yes <br><br> </dd>
<dt>Confidentiality:</dt>
<dd style="margin-left: 26">Yes <br><br> </dd>
<dt>Key derivation:</dt>
<dd style="margin-left: 26">Yes <br><br> </dd>
<dt>Key strength:</dt>
<dd style="margin-left: 26">Variable <br><br> </dd>
<dt>Dict. attack protection:</dt>
<dd style="margin-left: 26">Yes <br><br> </dd>
<dt>Fast reconnect:</dt>
<dd style="margin-left: 26">Yes <br><br> </dd>
<dt>Cryptographic binding:</dt>
<dd style="margin-left: 26">Yes <br><br> </dd>
<dt>Acknowledged S/F:</dt>
<dd style="margin-left: 26">Yes <br><br> </dd>
<dt>Session independence:</dt>
<dd style="margin-left: 26">Yes <br><br> </dd>
<dt>Fragmentation:</dt>
<dd style="margin-left: 26">Yes<br><br> </dd>
<dt>State synchronization:</dt>
<dd style="margin-left: 26">Yes <br><br> </dd>
</dl>

<p> The TEAM protocol is unconditionally compliant with the requirements for WLAN authentication mechanisms, as specified in </p>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> IANA Considerations</h1>
<p id="rfc.section.8.p.1">This memo specifies new values and registries to be created and managed by IANA. The policies used to allocate numbers are described in <a href="#RFC5226">[RFC5226]</a>.  </p>
<h1 id="rfc.section.8.1">
<a href="#rfc.section.8.1">8.1.</a> EAP Type</h1>
<p id="rfc.section.8.1.p.1">This memo requires IANA to allocate a new EAP method type for TEAM.  The placeholder indicated by &lt;TBD&gt; in section <a href="#T-P-F">Section 5.2</a> above shall be replaced by the new EAP method type upon assignment by IANA.  </p>
<h1 id="rfc.section.8.2">
<a href="#rfc.section.8.2">8.2.</a> TLV Types</h1>
<p id="rfc.section.8.2.p.1">IANA is requested to create a registry for TEAM TLV Types.  <br><br> TLV Types may assume a value between 0 and 16383 of which 0-20 are allocated in this document <a href="#TLV-T">Section 6</a>.  Additional TLV type codes may be allocated following the "Specification Required" policy <a href="#RFC5226">[RFC5226]</a>.  </p>
<h1 id="rfc.section.8.3">
<a href="#rfc.section.8.3">8.3.</a> TLV Values</h1>
<p id="rfc.section.8.3.p.1">IANA is requested to create a registry for TEAM TLV Values, populated initially with entries for the Identity-Type, Credential Type and Action fields.  <br><br> The Identity-Type field may assume a value between 0 and 65535, of which 0-2 are allocated in this document <a href="#I-T-TLV">Section 6.15</a>, Additional Identity-Type values may be allocated following the "Specification Required" policy <a href="#RFC5226">[RFC5226]</a>.  <br><br> The Credential Type field of the Server-Trusted-Root TLV <a href="#S-T-R-TLV">Section 6.16</a> may assume a value between 0 and 65535, of which 1 is allocated in this document.  Additional Credential Type values may be allocated following the "Specification Required" policy <a href="#RFC5226">[RFC5226]</a>.  <br><br> The Action field field of the Request-Action TLV may assume a value between 0 and 65535, of which 0-2 have already been allocated.  Additional Action values may be allocated following the "Specification Required" policy <a href="#RFC5226">[RFC5226]</a>.  </p>
<h1 id="rfc.section.9">
<a href="#rfc.section.9">9.</a> Contributors</h1>
<p id="rfc.section.9.p.1">A great deal of the text in the first draft of this note was taken from a document by Ashwin Palekar, Dan Simon, Glen Zorn, Simon Josefsson, Hao Zhou and Joe Salowey; the authors gratefully acknowledge their contribution.  <br><br> TEAM is a direct descendent of the Protected Extensible Authentication Protocol (PEAP), which was created by Glen Zorn while employed by Cisco Systems.  </p>
<h1 id="rfc.section.10">
<a href="#rfc.section.10">10.</a> Acknowledgements</h1>
<p id="rfc.section.10.p.1">Hakan Andersson, Jan-Ove Larsson, Magnus Nystrom, Bernard Aboba, Vivek Kamath, Stephen Bensley, Narendra Gidwani, Ilan Frenkel, Nancy Cam-Winget, Victor Lortz, Ashwin Palekar, Dan Simon, Glen Zorn, Simon Josefsson, Hao Zhou, Joe Salowey, Bernard Aboba, Paul Funk and Jose Puthenkulam all contributed at various stages to the development of this protocol.  </p>
<h1 id="rfc.references">
<a href="#rfc.references">11.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">11.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3748">[RFC3748]</b></td>
<td class="top">
<a>Aboba, B.</a>, <a>Blunk, L.</a>, <a>Vollbrecht, J.</a>, <a>Carlson, J.</a> and <a>H. Levkowetz</a>, "<a href="http://tools.ietf.org/html/rfc3748">Extensible Authentication Protocol (EAP)</a>", RFC 3748, June 2004.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5246">[RFC5246]</b></td>
<td class="top">
<a>Dierks, T.</a> and <a>E. Rescorla</a>, "<a href="http://tools.ietf.org/html/rfc5246">The Transport Layer Security (TLS) Protocol Version 1.2</a>", RFC 5246, August 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3986">[RFC3986]</b></td>
<td class="top">
<a href="mailto:timbl@w3.org" title="World Wide Web Consortium">Berners-Lee, T.</a>, <a href="mailto:fielding@gbiv.com" title="Day Software">Fielding, R.</a> and <a href="mailto:LMM@acm.org" title="Adobe Systems Incorporated">L. Masinter</a>, "<a href="http://tools.ietf.org/html/rfc3986">Uniform Resource Identifier (URI): Generic Syntax</a>", STD 66, RFC 3986, January 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5226">[RFC5226]</b></td>
<td class="top">
<a>Narten, T.</a> and <a>H. Alvestrand</a>, "<a href="http://tools.ietf.org/html/rfc5226">Guidelines for Writing an IANA Considerations Section in RFCs</a>", BCP 26, RFC 5226, May 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4282">[RFC4282]</b></td>
<td class="top">
<a>Aboba, B.</a>, <a>Beadles, M.</a>, <a>Arkko, J.</a> and <a>P. Eronen</a>, "<a href="http://tools.ietf.org/html/rfc4282">The Network Access Identifier</a>", RFC 4282, December 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4013">[RFC4013]</b></td>
<td class="top">
<a>Zeilenga, K.</a>, "<a href="http://tools.ietf.org/html/rfc4013">SASLprep: Stringprep Profile for User Names and Passwords</a>", RFC 4013, February 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3454">[RFC3454]</b></td>
<td class="top">
<a>Hoffman, P.</a> and <a>M. Blanchet</a>, "<a href="http://tools.ietf.org/html/rfc3454">Preparation of Internationalized Strings ("stringprep")</a>", RFC 3454, December 2002.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.zorn-emu-eap-pwc">[I-D.zorn-emu-eap-pwc]</b></td>
<td class="top">
<a title="Network Zen">Zorn, G</a>, "<a>A Method for Changing Cleartext Passwords in the Extensible Authentication Protocol</a>", March 2011.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">11.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="IEEE.802-1X.2004">[IEEE.802-1X.2004]</b></td>
<td class="top">
<a>IEEE Computer Society</a>, "<a>IEEE Standard for Local and metropolitan area networks: Port-Based Network Access Control</a>", IEEE Standard 802.1X, December 2004.</td>
</tr>
<tr>
<td class="reference"><b id="IEEE.802-11.2007">[IEEE.802-11.2007]</b></td>
<td class="top">
<a>IEEE Computer Society</a>, "<a>Information technology - Telecommunications and information exchange between systems - Local and metropolitan area networks - Specific requirements - Part 11: Wireless LAN Medium Access Control (MAC) and Physical Layer (PHY) specifications </a>", IEEE Standard 802.11, June 2007.</td>
</tr>
<tr>
<td class="reference"><b id="RFC1968">[RFC1968]</b></td>
<td class="top">
<a href="mailto:gerry@spider.co.uk" title="Spider Systems">Meyer, G.</a> and <a href="mailto:karl@ascend.com" title="Ascend Communications">K. Fox</a>, "<a href="http://tools.ietf.org/html/rfc1968">The PPP Encryption Control Protocol (ECP)</a>", RFC 1968, June 1996.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4017">[RFC4017]</b></td>
<td class="top">
<a>Stanley, D.</a>, <a>Walker, J.</a> and <a>B. Aboba</a>, "<a href="http://tools.ietf.org/html/rfc4017">Extensible Authentication Protocol (EAP) Method Requirements for Wireless LANs</a>", RFC 4017, March 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2315">[RFC2315]</b></td>
<td class="top">
<a href="mailto:burt@rsa.com" title="RSA Laboratories East">Kaliski, B.</a>, "<a href="http://tools.ietf.org/html/rfc2315">PKCS #7: Cryptographic Message Syntax Version 1.5</a>", RFC 2315, March 1998.</td>
</tr>
<tr>
<td class="reference"><b id="RFC1990">[RFC1990]</b></td>
<td class="top">
<a href="mailto:sklower@CS.Berkeley.EDU" title="University of California,  Berkeley, Computer Science Department">Sklower, K.</a>, <a href="mailto:brian@lloyd.com" title="Lloyd Internetworking">Lloyd, B.</a>, <a href="mailto:glenn@lloyd.com" title="Lloyd Internetworking">McGregor, G.</a>, <a href="mailto:dcarr@Newbridge.COM" title="Newbridge Networks Corporation">Carr, D.</a> and <a href="mailto:70761.1664@compuserve.com" title="Sidewalk Software">T. Coradetti</a>, "<a href="http://tools.ietf.org/html/rfc1990">The PPP Multilink Protocol (MP)</a>", RFC 1990, August 1996.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2548">[RFC2548]</b></td>
<td class="top">
<a href="mailto:glennz@microsoft.com" title="Microsoft Corporation">Zorn, G.</a>, "<a href="http://tools.ietf.org/html/rfc2548">Microsoft Vendor-specific RADIUS Attributes</a>", RFC 2548, March 1999.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2865">[RFC2865]</b></td>
<td class="top">
<a>Rigney, C.</a>, <a>Willens, S.</a>, <a>Rubens, A.</a> and <a>W. Simpson</a>, "<a href="http://tools.ietf.org/html/rfc2865">Remote Authentication Dial In User Service (RADIUS)</a>", RFC 2865, June 2000.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5216">[RFC5216]</b></td>
<td class="top">
<a>Simon, D.</a>, <a>Aboba, B.</a> and <a>R. Hurst</a>, "<a href="http://tools.ietf.org/html/rfc5216">The EAP-TLS Authentication Protocol</a>", RFC 5216, March 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3579">[RFC3579]</b></td>
<td class="top">
<a>Aboba, B.</a> and <a>P. Calhoun</a>, "<a href="http://tools.ietf.org/html/rfc3579">RADIUS (Remote Authentication Dial In User Service) Support For Extensible Authentication Protocol (EAP)</a>", RFC 3579, September 2003.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3580">[RFC3580]</b></td>
<td class="top">
<a>Congdon, P.</a>, <a>Aboba, B.</a>, <a>Smith, A.</a>, <a>Zorn, G.</a> and <a>J. Roese</a>, "<a href="http://tools.ietf.org/html/rfc3580">IEEE 802.1X Remote Authentication Dial In User Service (RADIUS) Usage Guidelines</a>", RFC 3580, September 2003.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3766">[RFC3766]</b></td>
<td class="top">
<a>Orman, H.</a> and <a>P. Hoffman</a>, "<a href="http://tools.ietf.org/html/rfc3766">Determining Strengths For Public Keys Used For Exchanging Symmetric Keys</a>", BCP 86, RFC 3766, April 2004.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5931">[RFC5931]</b></td>
<td class="top">
<a>Harkins, D.</a> and <a>G. Zorn</a>, "<a href="http://tools.ietf.org/html/rfc5931">Extensible Authentication Protocol (EAP) Authentication Using Only a Password</a>", RFC 5931, August 2010.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2637">[RFC2637]</b></td>
<td class="top">
<a href="mailto:kory@ascend.com" title="Ascend Communications">Hamzeh, K.</a>, <a href="mailto:gurdeep@microsoft.com" title="Microsoft Corporation">Pall, G.</a>, <a title="U.S. Robotics/3Com">Verthein, W.</a>, <a title="Copper Mountain Networks">Taarud, J.</a>, <a title="ECI Telematics">Little, W.</a> and <a href="mailto:glennz@microsoft.com" title="Microsoft Corporation">G. Zorn</a>, "<a href="http://tools.ietf.org/html/rfc2637">Point-to-Point Tunneling Protocol</a>", RFC 2637, July 1999.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3931">[RFC3931]</b></td>
<td class="top">
<a>Lau, J.</a>, <a>Townsley, M.</a> and <a>I. Goyret</a>, "<a href="http://tools.ietf.org/html/rfc3931">Layer Two Tunneling Protocol - Version 3 (L2TPv3)</a>", RFC 3931, March 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2560">[RFC2560]</b></td>
<td class="top">
<a href="mailto:mmyers@verisign.com" title="VeriSign, Inc.">Myers, M.</a>, <a href="mailto:rankney@erols.com" title="CertCo, LLC">Ankney, R.</a>, <a href="mailto:ambarish@valicert.com" title="ValiCert, Inc.">Malpani, A.</a>, <a href="mailto:galperin@mycfo.com" title="My CFO, Inc.">Galperin, S.</a> and <a href="mailto:cadams@entrust.com" title="Entrust Technologies">C. Adams</a>, "<a href="http://tools.ietf.org/html/rfc2560">X.509 Internet Public Key Infrastructure Online Certificate Status Protocol - OCSP</a>", RFC 2560, June 1999.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5247">[RFC5247]</b></td>
<td class="top">
<a>Aboba, B.</a>, <a>Simon, D.</a> and <a>P. Eronen</a>, "<a href="http://tools.ietf.org/html/rfc5247">Extensible Authentication Protocol (EAP) Key Management Framework</a>", RFC 5247, August 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5055">[RFC5055]</b></td>
<td class="top">
<a>Freeman, T.</a>, <a>Housley, R.</a>, <a>Malpani, A.</a>, <a>Cooper, D.</a> and <a>W. Polk</a>, "<a href="http://tools.ietf.org/html/rfc5055">Server-Based Certificate Validation Protocol (SCVP)</a>", RFC 5055, December 2007.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5869">[RFC5869]</b></td>
<td class="top">
<a>Krawczyk, H.</a> and <a>P. Eronen</a>, "<a href="http://tools.ietf.org/html/rfc5869">HMAC-based Extract-and-Expand Key Derivation Function (HKDF)</a>", RFC 5869, May 2010.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4962">[RFC4962]</b></td>
<td class="top">
<a>Housley, R.</a> and <a>B. Aboba</a>, "<a href="http://tools.ietf.org/html/rfc4962">Guidance for Authentication, Authorization, and Accounting (AAA) Key Management</a>", BCP 132, RFC 4962, July 2007.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-emu-eaptunnel-req">[I-D.ietf-emu-eaptunnel-req]</b></td>
<td class="top">
<a>Hoeper, K</a>, <a>Hanna, S</a>, <a>Zhou, H</a> and <a>J Salowey</a>, "<a href="http://tools.ietf.org/html/draft-ietf-emu-eaptunnel-req-09">Requirements for a Tunnel Based EAP Method</a>", Internet-Draft draft-ietf-emu-eaptunnel-req-09, December 2010.</td>
</tr>
</tbody></table>
<h1 id="rfc.appendix.Appendix A">
<a href="#rfc.appendix.Appendix%20A">Appendix A.</a> Compliance with Requirements for a Tunnel Based EAP Method</h1>
<p id="rfc.section.Appendix A.p.1">The following subsections describe the TEAM protocol's compliance with the requirements given in <a href="#I-D.ietf-emu-eaptunnel-req">[I-D.ietf-emu-eaptunnel-req]</a>.  </p>
<h1 id="rfc.appendix.Appendix A.1">
<a href="#rfc.appendix.Appendix%20A.1">Appendix A.1.</a> General Requirements</h1>
<p></p>

<ul>
<li>TEAM includes a Security Claims section and satisfies all mandatory requirements listed in section 2.2 of <a href="#RFC4017">[RFC4017]</a>.  </li>
<li>TEAM meets the MUST and SHOULD requirements of <a href="#RFC5247">[RFC5247]</a>, including generation of the MSK, ESMK, Peer-Id, Server-Id, and Session-Id.  </li>
<li>TEAM is not tied to any single cryptographic algorithm.  A variety of ciphersuites can be negotiated in TEAM phase 1 which include a plethora of cryptographic algorithms. Numerous phase 2 authentication methods are supported which, likewise, constitute a plethora of cryptographic algorithms.  </li>
<li>TEAM meets all the MUST and SHOULD requirements in section 3 of <a href="#RFC4962">[RFC4962]</a> to the extent that they apply to an EAP method (and not to the use of a key derived from TEAM). In particular TEAM keys are vine-ripened and very fresh.  </li>
</ul>

<p> </p>
<h1 id="rfc.appendix.Appendix A.2">
<a href="#rfc.appendix.Appendix%20A.2">Appendix A.2.</a> Tunnel Requirements</h1>
<p></p>

<ul>
<li>TEAM uses TLS version 1.2 in phase 1 and satisfies all of the mandatory TLS requirements of section 4.2.1 <a href="#I-D.ietf-emu-eaptunnel-req">[I-D.ietf-emu-eaptunnel-req]</a>.  </li>
<li>TEAM supports fragmentation and reassembly per section 4.2.2 of <a href="#I-D.ietf-emu-eaptunnel-req">[I-D.ietf-emu-eaptunnel-req]</a>.  </li>
<li>Modification of data outside the tunnel is not protected but any such modification does not cause an exploitable vulnerability and can be detected <a href="#A-I-P">Section 7.1</a>.  </li>
</ul>

<p> </p>
<h1 id="rfc.appendix.Appendix A.3">
<a href="#rfc.appendix.Appendix%20A.3">Appendix A.3.</a> Tunnel Payload Requirements</h1>
<p></p>

<ul>
<li>TEAM AVPs are extensible.  </li>
<li>TEAM is an EAP method and supports challenge/response operations that are typical of EAP methods.  </li>
<li>It is possible to indicate whether a TLV is mandatory or not.  </li>
<li>TEAM supports Vendor Specific extensions.  </li>
<li>TEAM supports indication of result after each changed inner method.  </li>
</ul>

<p> </p>
<h1 id="rfc.appendix.Appendix A.4">
<a href="#rfc.appendix.Appendix%20A.4">Appendix A.4.</a> Channel Binding Requirements</h1>
<p></p>

<ul><li>To the extent that it is appropriate to rely on adherence to a "work-in-progress", TEAM supports Channel Binding requirements.  Furthermore, as that "work-in-progress" proceeds in its work there is no reason why TEAM could not continue to meet requirements.  </li></ul>

<p> </p>
<h1 id="rfc.appendix.Appendix A.5">
<a href="#rfc.appendix.Appendix%20A.5">Appendix A.5.</a> Username/Password Requirements</h1>
<p></p>

<ul>
<li>TEAM supports the required use of usernames and passwords in section 4.5 of <a href="#I-D.ietf-emu-eaptunnel-req">[I-D.ietf-emu-eaptunnel-req]</a> through the use of the EAP/Identity exchange and GTC <a href="#RFC3748">[RFC3748]</a>, and EAP-PWC <a href="#I-D.zorn-emu-eap-pwc">[I-D.zorn-emu-eap-pwc]</a>.  Note, however, that in order to comply with the requirements of <a href="#I-D.ietf-emu-eaptunnel-req">[I-D.ietf-emu-eaptunnel-req]</a> the user name contained in the EAP/Identity/Response and the password contined in the EAP-GTC/Response messages MUST be processed according to the rules of the <a href="#RFC4013">[RFC4013]</a> profile of <a href="#RFC3454">[RFC3454]</a>.  Furthermore, the strings in question SHALL be considered to be "stored strings" (per <a href="#RFC3454">[RFC3454]</a>), and unassigned code points are therefore prohibited.  The output SHALL be the binary representation of the processed UTF-8 character string.  Prohibited output and unassigned codepoints encountered during SASLprep pre-processing SHALL cause a failure of pre-processing, and the output MUST NOT be used.  </li>
<li>In addition, TEAM supports the use of username/password authentication that allows for an EAP peer and EAP server to authenticate each other based on knowledge of a password without that password being sent in any format between the peer and server.  </li>
<li>The TEAM server is authenticated before any possible transmission of a password and a peer can check whether the certificate of a TEAM server has been revoked or not using OCSP.  </li>
</ul>

<p> </p>
<h1 id="rfc.appendix.Appendix A.6">
<a href="#rfc.appendix.Appendix%20A.6">Appendix A.6.</a> Requirements Around Carriage of EAP Methods</h1>
<p></p>

<ul>
<li>TEAM supports carrying inner EAP methods without modification. These methods are negotiated and can be chained.  </li>
<li>TEAM supports cryptographic binding of keys derived from EAP methods.  </li>
</ul>

<p> </p>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Glen Zorn</span> 
	  <span class="n hidden">
		<span class="family-name">Zorn</span>
	  </span>
	</span>
	<span class="org vcardline">Network Zen</span>
	<span class="adr">
	  <span>227/358 Thanon Sanphawut</span>

	  <span class="vcardline">
		<span class="locality">Bang Na</span>,  
		<span class="region">Bangkok</span> 
		<span class="code">10260</span>
	  </span>
	  <span class="country-name vcardline">Thailand</span>
	</span>
	<span class="vcardline">Phone: +66 (0) 87-040-4617</span>

<span class="vcardline">EMail: <a href="mailto:gwz@net-zen.net">gwz@net-zen.net</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Qin Wu</span> 
	  <span class="n hidden">
		<span class="family-name">Wu</span>
	  </span>
	</span>
	<span class="org vcardline">Huawei Technologies Co., Ltd.</span>
	<span class="adr">
	  <span>101 Software Avenue, Yuhua District</span>

	  <span class="vcardline">
		<span class="locality">Nanjing</span>,  
		<span class="region">Jiangsu</span> 
		<span class="code">21001</span>
	  </span>
	  <span class="country-name vcardline">China</span>
	</span>
	<span class="vcardline">Phone: +86-25-84565892</span>

<span class="vcardline">EMail: <a href="mailto:sunseawq@huawei.com">sunseawq@huawei.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Dan Harkins</span> 
	  <span class="n hidden">
		<span class="family-name">Harkins</span>
	  </span>
	</span>
	<span class="org vcardline">Aruba Networks</span>
	<span class="adr">
	  <span>1322 Crossman Avenue</span>

	  <span class="vcardline">
		<span class="locality">Sunnyvale</span>,  
		<span class="region">CA</span> 
		<span class="code">94089-1113</span>
	  </span>
	  <span class="country-name vcardline">United States of America</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:dharkins@arubanetworks.com">dharkins@arubanetworks.com</a></span>

  </address>
</div>

</body>
</html>