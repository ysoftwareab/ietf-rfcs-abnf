<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Cookies: HTTP State Management Mechanism</title>
<meta content="Lily Chen" name="author">
<meta content="Steven Englehardt" name="author">
<meta content="Mike West" name="author">
<meta content="John Wilander" name="author">
<meta content="
       This document defines the HTTP Cookie and Set-Cookie header fields. These
header fields can be used by HTTP servers to store state (called cookies) at
HTTP user agents, letting the servers maintain a stateful session over the
mostly stateless HTTP protocol. Although cookies have many historical
infelicities that degrade their security and privacy, the Cookie and Set-Cookie
header fields are widely used on the Internet. This document obsoletes RFC
6265. 
    " name="description">
<meta content="xml2rfc 3.8.0" name="generator">
<meta content="draft-ietf-httpbis-rfc6265bis-08" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.8.0
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.4.1
    google-i18n-address 2.4.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.6.3
    pycountry 20.7.3
    pyflakes 2.3.1
    PyYAML 5.4.1
    requests 2.25.1
    setuptools 56.2.0
    six 1.16.0
-->
<link href="/tmp/draft-ietf-httpbis-rfc6265bis-08-yatpu1cu.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Cookies: HTTP State Management Mechanism</td>
<td class="right">June 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Chen, et al.</td>
<td class="center">Expires 4 December 2021</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">HTTP</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-httpbis-rfc6265bis-08</dd>
<dt class="label-obsoletes">Obsoletes:</dt>
<dd class="obsoletes">
<a href="https://www.rfc-editor.org/rfc/rfc6265" class="eref">6265</a> (if approved)</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2021-06-02" class="published">2 June 2021</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2021-12-04">4 December 2021</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">L. Chen, <span class="editor">Ed.</span>
</div>
<div class="org">Google LLC</div>
</div>
<div class="author">
      <div class="author-name">S. Englehardt, <span class="editor">Ed.</span>
</div>
<div class="org">Mozilla</div>
</div>
<div class="author">
      <div class="author-name">M. West, <span class="editor">Ed.</span>
</div>
<div class="org">Google LLC</div>
</div>
<div class="author">
      <div class="author-name">J. Wilander, <span class="editor">Ed.</span>
</div>
<div class="org">Apple, Inc</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Cookies: HTTP State Management Mechanism</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document defines the HTTP Cookie and Set-Cookie header fields. These
header fields can be used by HTTP servers to store state (called cookies) at
HTTP user agents, letting the servers maintain a stateful session over the
mostly stateless HTTP protocol. Although cookies have many historical
infelicities that degrade their security and privacy, the Cookie and Set-Cookie
header fields are widely used on the Internet. This document obsoletes RFC
6265.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note" id="section-note.1">
      <h2 id="name-note-to-readers">
<a href="#name-note-to-readers" class="section-name selfRef">Note to Readers</a>
      </h2>
<p id="section-note.1-1">Discussion of this draft takes place on the HTTP working group mailing list
(ietf-http-wg@w3.org), which is archived at <a href="https://lists.w3.org/Archives/Public/ietf-http-wg/">https://lists.w3.org/Archives/Public/ietf-http-wg/</a>.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">Working Group information can be found at <a href="http://httpwg.github.io/">http://httpwg.github.io/</a>; source
code and issues list for this draft can be found at <a href="https://github.com/httpwg/http-extensions/labels/6265bis">https://github.com/httpwg/http-extensions/labels/6265bis</a>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 4 December 2021.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-3">
            This document may contain material from IETF Documents or IETF
            Contributions published or made publicly available before November
            10, 2008. The person(s) controlling the copyright in some of this
            material may not have granted the IETF Trust the right to allow
            modifications of such material outside the IETF Standards Process.
            Without obtaining an adequate license from the person(s)
            controlling the copyright in such materials, this document may not
            be modified outside the IETF Standards Process, and derivative
            works of it may not be created outside the IETF Standards Process,
            except to format it for publication as an RFC or to translate it
            into languages other than English.<a href="#section-boilerplate.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-conventions" class="xref">Conventions</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-conformance-criteria" class="xref">Conformance Criteria</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1" class="keepWithNext"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-syntax-notation" class="xref">Syntax Notation</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="xref">2.3</a>.  <a href="#name-terminology" class="xref">Terminology</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-overview" class="xref">Overview</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-examples" class="xref">Examples</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-server-requirements" class="xref">Server Requirements</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-set-cookie" class="xref">Set-Cookie</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.4.2.1.2.1">
                    <p id="section-toc.1-1.4.2.1.2.1.1"><a href="#section-4.1.1" class="xref">4.1.1</a>.  <a href="#name-syntax" class="xref">Syntax</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.4.2.1.2.2">
                    <p id="section-toc.1-1.4.2.1.2.2.1"><a href="#section-4.1.2" class="xref">4.1.2</a>.  <a href="#name-semantics-non-normative" class="xref">Semantics (Non-Normative)</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.4.2.1.2.3">
                    <p id="section-toc.1-1.4.2.1.2.3.1"><a href="#section-4.1.3" class="xref">4.1.3</a>.  <a href="#name-cookie-name-prefixes" class="xref">Cookie Name Prefixes</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-cookie" class="xref">Cookie</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a href="#section-4.2.1" class="xref">4.2.1</a>.  <a href="#name-syntax-2" class="xref">Syntax</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.4.2.2.2.2">
                    <p id="section-toc.1-1.4.2.2.2.2.1"><a href="#section-4.2.2" class="xref">4.2.2</a>.  <a href="#name-semantics" class="xref">Semantics</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-user-agent-requirements" class="xref">User Agent Requirements</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-subcomponent-algorithms" class="xref">Subcomponent Algorithms</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.5.2.1.2.1">
                    <p id="section-toc.1-1.5.2.1.2.1.1"><a href="#section-5.1.1" class="xref">5.1.1</a>.  <a href="#name-dates" class="xref">Dates</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.5.2.1.2.2">
                    <p id="section-toc.1-1.5.2.1.2.2.1"><a href="#section-5.1.2" class="xref">5.1.2</a>.  <a href="#name-canonicalized-host-names" class="xref">Canonicalized Host Names</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.5.2.1.2.3">
                    <p id="section-toc.1-1.5.2.1.2.3.1"><a href="#section-5.1.3" class="xref">5.1.3</a>.  <a href="#name-domain-matching" class="xref">Domain Matching</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.5.2.1.2.4">
                    <p id="section-toc.1-1.5.2.1.2.4.1"><a href="#section-5.1.4" class="xref">5.1.4</a>.  <a href="#name-paths-and-path-match" class="xref">Paths and Path-Match</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-same-site-and-cross-site-re" class="xref">"Same-site" and "cross-site" Requests</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.5.2.2.2.1">
                    <p id="section-toc.1-1.5.2.2.2.1.1"><a href="#section-5.2.1" class="xref">5.2.1</a>.  <a href="#name-document-based-requests" class="xref">Document-based requests</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.5.2.2.2.2">
                    <p id="section-toc.1-1.5.2.2.2.2.1"><a href="#section-5.2.2" class="xref">5.2.2</a>.  <a href="#name-worker-based-requests" class="xref">Worker-based requests</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="xref">5.3</a>.  <a href="#name-ignoring-set-cookie-header-" class="xref">Ignoring Set-Cookie Header Fields</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="xref">5.4</a>.  <a href="#name-the-set-cookie-header-field" class="xref">The Set-Cookie Header Field</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.5.2.4.2.1">
                    <p id="section-toc.1-1.5.2.4.2.1.1"><a href="#section-5.4.1" class="xref">5.4.1</a>.  <a href="#name-the-expires-attribute-2" class="xref">The Expires Attribute</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.5.2.4.2.2">
                    <p id="section-toc.1-1.5.2.4.2.2.1"><a href="#section-5.4.2" class="xref">5.4.2</a>.  <a href="#name-the-max-age-attribute-2" class="xref">The Max-Age Attribute</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.5.2.4.2.3">
                    <p id="section-toc.1-1.5.2.4.2.3.1"><a href="#section-5.4.3" class="xref">5.4.3</a>.  <a href="#name-the-domain-attribute-2" class="xref">The Domain Attribute</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.5.2.4.2.4">
                    <p id="section-toc.1-1.5.2.4.2.4.1"><a href="#section-5.4.4" class="xref">5.4.4</a>.  <a href="#name-the-path-attribute-2" class="xref">The Path Attribute</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.5.2.4.2.5">
                    <p id="section-toc.1-1.5.2.4.2.5.1"><a href="#section-5.4.5" class="xref">5.4.5</a>.  <a href="#name-the-secure-attribute-2" class="xref">The Secure Attribute</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.5.2.4.2.6">
                    <p id="section-toc.1-1.5.2.4.2.6.1"><a href="#section-5.4.6" class="xref">5.4.6</a>.  <a href="#name-the-httponly-attribute-2" class="xref">The HttpOnly Attribute</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.5.2.4.2.7">
                    <p id="section-toc.1-1.5.2.4.2.7.1"><a href="#section-5.4.7" class="xref">5.4.7</a>.  <a href="#name-the-samesite-attribute-2" class="xref">The SameSite Attribute</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.5.2.5">
                <p id="section-toc.1-1.5.2.5.1"><a href="#section-5.5" class="xref">5.5</a>.  <a href="#name-storage-model" class="xref">Storage Model</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.5.2.6">
                <p id="section-toc.1-1.5.2.6.1"><a href="#section-5.6" class="xref">5.6</a>.  <a href="#name-retrieval-model" class="xref">Retrieval Model</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.5.2.6.2.1">
                    <p id="section-toc.1-1.5.2.6.2.1.1"><a href="#section-5.6.1" class="xref">5.6.1</a>.  <a href="#name-the-cookie-header-field" class="xref">The Cookie Header Field</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.5.2.6.2.2">
                    <p id="section-toc.1-1.5.2.6.2.2.1"><a href="#section-5.6.2" class="xref">5.6.2</a>.  <a href="#name-non-http-apis" class="xref">Non-HTTP APIs</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.5.2.6.2.3">
                    <p id="section-toc.1-1.5.2.6.2.3.1"><a href="#section-5.6.3" class="xref">5.6.3</a>.  <a href="#name-retrieval-algorithm" class="xref">Retrieval Algorithm</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-implementation-consideratio" class="xref">Implementation Considerations</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-limits" class="xref">Limits</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-application-programming-int" class="xref">Application Programming Interfaces</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="xref">6.3</a>.  <a href="#name-idna-dependency-and-migrati" class="xref">IDNA Dependency and Migration</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-privacy-considerations" class="xref">Privacy Considerations</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.  <a href="#name-third-party-cookies" class="xref">Third-Party Cookies</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="xref">7.2</a>.  <a href="#name-cookie-policy" class="xref">Cookie policy</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="xref">7.3</a>.  <a href="#name-user-controls" class="xref">User Controls</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="xref">7.4</a>.  <a href="#name-expiration-dates" class="xref">Expiration Dates</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="xref">8.1</a>.  <a href="#name-overview-2" class="xref">Overview</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="xref">8.2</a>.  <a href="#name-ambient-authority" class="xref">Ambient Authority</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="xref">8.3</a>.  <a href="#name-clear-text" class="xref">Clear Text</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.8.2.4">
                <p id="section-toc.1-1.8.2.4.1"><a href="#section-8.4" class="xref">8.4</a>.  <a href="#name-session-identifiers" class="xref">Session Identifiers</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.8.2.5">
                <p id="section-toc.1-1.8.2.5.1"><a href="#section-8.5" class="xref">8.5</a>.  <a href="#name-weak-confidentiality" class="xref">Weak Confidentiality</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.8.2.6">
                <p id="section-toc.1-1.8.2.6.1"><a href="#section-8.6" class="xref">8.6</a>.  <a href="#name-weak-integrity" class="xref">Weak Integrity</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.8.2.7">
                <p id="section-toc.1-1.8.2.7.1"><a href="#section-8.7" class="xref">8.7</a>.  <a href="#name-reliance-on-dns" class="xref">Reliance on DNS</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.8.2.8">
                <p id="section-toc.1-1.8.2.8.1"><a href="#section-8.8" class="xref">8.8</a>.  <a href="#name-samesite-cookies" class="xref">SameSite Cookies</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.8.2.8.2.1">
                    <p id="section-toc.1-1.8.2.8.2.1.1"><a href="#section-8.8.1" class="xref">8.8.1</a>.  <a href="#name-defense-in-depth" class="xref">Defense in depth</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.8.2.8.2.2">
                    <p id="section-toc.1-1.8.2.8.2.2.1"><a href="#section-8.8.2" class="xref">8.8.2</a>.  <a href="#name-top-level-navigations" class="xref">Top-level Navigations</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.8.2.8.2.3">
                    <p id="section-toc.1-1.8.2.8.2.3.1"><a href="#section-8.8.3" class="xref">8.8.3</a>.  <a href="#name-mashups-and-widgets" class="xref">Mashups and Widgets</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.8.2.8.2.4">
                    <p id="section-toc.1-1.8.2.8.2.4.1"><a href="#section-8.8.4" class="xref">8.8.4</a>.  <a href="#name-server-controlled" class="xref">Server-controlled</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.8.2.8.2.5">
                    <p id="section-toc.1-1.8.2.8.2.5.1"><a href="#section-8.8.5" class="xref">8.8.5</a>.  <a href="#name-reload-navigations" class="xref">Reload navigations</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.8.2.8.2.6">
                    <p id="section-toc.1-1.8.2.8.2.6.1"><a href="#section-8.8.6" class="xref">8.8.6</a>.  <a href="#name-top-level-requests-with-uns" class="xref">Top-level requests with "unsafe" methods</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="xref">9.1</a>.  <a href="#name-cookie-2" class="xref">Cookie</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="xref">9.2</a>.  <a href="#name-set-cookie-2" class="xref">Set-Cookie</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a href="#section-9.3" class="xref">9.3</a>.  <a href="#name-cookie-attribute-registry" class="xref">Cookie Attribute Registry</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.9.2.3.2.1">
                    <p id="section-toc.1-1.9.2.3.2.1.1"><a href="#section-9.3.1" class="xref">9.3.1</a>.  <a href="#name-procedure" class="xref">Procedure</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.9.2.3.2.2">
                    <p id="section-toc.1-1.9.2.3.2.2.1"><a href="#section-9.3.2" class="xref">9.3.2</a>.  <a href="#name-registration" class="xref">Registration</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-references" class="xref">References</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="xref">10.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="xref">10.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-appendix.a" class="xref">Appendix A</a>.  <a href="#name-changes" class="xref">Changes</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-a.1" class="xref">A.1</a>.  <a href="#name-draft-ietf-httpbis-rfc6265b" class="xref">draft-ietf-httpbis-rfc6265bis-00</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-a.2" class="xref">A.2</a>.  <a href="#name-draft-ietf-httpbis-rfc6265bi" class="xref">draft-ietf-httpbis-rfc6265bis-01</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.11.2.3">
                <p id="section-toc.1-1.11.2.3.1"><a href="#section-a.3" class="xref">A.3</a>.  <a href="#name-draft-ietf-httpbis-rfc6265bis" class="xref">draft-ietf-httpbis-rfc6265bis-02</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.11.2.4">
                <p id="section-toc.1-1.11.2.4.1"><a href="#section-a.4" class="xref">A.4</a>.  <a href="#name-draft-ietf-httpbis-rfc6265bis-" class="xref">draft-ietf-httpbis-rfc6265bis-03</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.11.2.5">
                <p id="section-toc.1-1.11.2.5.1"><a href="#section-a.5" class="xref">A.5</a>.  <a href="#name-draft-ietf-httpbis-rfc6265bis-0" class="xref">draft-ietf-httpbis-rfc6265bis-04</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.11.2.6">
                <p id="section-toc.1-1.11.2.6.1"><a href="#section-a.6" class="xref">A.6</a>.  <a href="#name-draft-ietf-httpbis-rfc6265bis-05" class="xref">draft-ietf-httpbis-rfc6265bis-05</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.11.2.7">
                <p id="section-toc.1-1.11.2.7.1"><a href="#section-a.7" class="xref">A.7</a>.  <a href="#name-draft-ietf-httpbis-rfc6265bis-06" class="xref">draft-ietf-httpbis-rfc6265bis-06</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.11.2.8">
                <p id="section-toc.1-1.11.2.8.1"><a href="#section-a.8" class="xref">A.8</a>.  <a href="#name-draft-ietf-httpbis-rfc6265bis-07" class="xref">draft-ietf-httpbis-rfc6265bis-07</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.11.2.9">
                <p id="section-toc.1-1.11.2.9.1"><a href="#section-a.9" class="xref">A.9</a>.  <a href="#name-draft-ietf-httpbis-rfc6265bis-08" class="xref">draft-ietf-httpbis-rfc6265bis-08</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-appendix.b" class="xref"></a><a href="#name-acknowledgements" class="xref">Acknowledgements</a></p>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-appendix.c" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">This document defines the HTTP Cookie and Set-Cookie header fields. Using
the Set-Cookie header field, an HTTP server can pass name/value pairs and
associated metadata (called cookies) to a user agent. When the user agent makes
subsequent requests to the server, the user agent uses the metadata and other
information to determine whether to return the name/value pairs in the Cookie
header field.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">Although simple on their surface, cookies have a number of complexities. For
example, the server indicates a scope for each cookie when sending it to the
user agent. The scope indicates the maximum amount of time in which the user
agent should return the cookie, the servers to which the user agent should
return the cookie, and the URI schemes for which the cookie is applicable.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">For historical reasons, cookies contain a number of security and privacy
infelicities. For example, a server can indicate that a given cookie is
intended for "secure" connections, but the Secure attribute does not provide
integrity in the presence of an active network attacker. Similarly, cookies
for a given host are shared across all the ports on that host, even though the
usual "same-origin policy" used by web browsers isolates content retrieved via
different ports.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">There are two audiences for this specification: developers of cookie-generating
servers and developers of cookie-consuming user agents.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">To maximize interoperability with user agents, servers SHOULD limit themselves
to the well-behaved profile defined in <a href="#sane-profile" class="xref">Section 4</a> when generating cookies.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">User agents MUST implement the more liberal processing rules defined in <a href="#ua-requirements" class="xref">Section 5</a>, in order to maximize interoperability with existing servers that do not
conform to the well-behaved profile defined in <a href="#sane-profile" class="xref">Section 4</a>.<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7">This document specifies the syntax and semantics of these header fields as they are
actually used on the Internet. In particular, this document does not create
new syntax or semantics beyond those in use today. The recommendations for
cookie generation provided in <a href="#sane-profile" class="xref">Section 4</a> represent a preferred subset of current
server behavior, and even the more liberal cookie processing algorithm provided
in <a href="#ua-requirements" class="xref">Section 5</a> does not recommend all of the syntactic and semantic variations in
use today. Where some existing software differs from the recommended protocol
in significant ways, the document contains a note explaining the difference.<a href="#section-1-7" class="pilcrow">¶</a></p>
<p id="section-1-8">This document obsoletes <span>[<a href="#RFC6265" class="xref">RFC6265</a>]</span>.<a href="#section-1-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="conventions">
<section id="section-2">
      <h2 id="name-conventions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions" class="section-name selfRef">Conventions</a>
      </h2>
<div id="conformance-criteria">
<section id="section-2.1">
        <h3 id="name-conformance-criteria">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-conformance-criteria" class="section-name selfRef">Conformance Criteria</a>
        </h3>
<p id="section-2.1-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD",
"SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be
interpreted as described in <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span>.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1-2">Requirements phrased in the imperative as part of algorithms (such as "strip any
leading space characters" or "return false and abort these steps") are to be
interpreted with the meaning of the key word ("MUST", "SHOULD", "MAY", etc.)
used in introducing the algorithm.<a href="#section-2.1-2" class="pilcrow">¶</a></p>
<p id="section-2.1-3">Conformance requirements phrased as algorithms or specific steps can be
implemented in any manner, so long as the end result is equivalent. In
particular, the algorithms defined in this specification are intended to be
easy to understand and are not intended to be performant.<a href="#section-2.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="syntax-notation">
<section id="section-2.2">
        <h3 id="name-syntax-notation">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-syntax-notation" class="section-name selfRef">Syntax Notation</a>
        </h3>
<p id="section-2.2-1">This specification uses the Augmented Backus-Naur Form (ABNF) notation of
<span>[<a href="#RFC5234" class="xref">RFC5234</a>]</span>.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<p id="section-2.2-2">The following core rules are included by reference, as defined in <span>[<a href="#RFC5234" class="xref">RFC5234</a>]</span>,
Appendix B.1: ALPHA (letters), CR (carriage return), CRLF (CR LF), CTLs
(controls), DIGIT (decimal 0-9), DQUOTE (double quote), HEXDIG
(hexadecimal 0-9/A-F/a-f), LF (line feed), NUL (null octet), OCTET (any
8-bit sequence of data except NUL), SP (space), HTAB (horizontal tab),
CHAR (any <span>[<a href="#USASCII" class="xref">USASCII</a>]</span> character), VCHAR (any visible <span>[<a href="#USASCII" class="xref">USASCII</a>]</span> character),
and WSP (whitespace).<a href="#section-2.2-2" class="pilcrow">¶</a></p>
<p id="section-2.2-3">The OWS (optional whitespace) and BWS (bad whitespace) rules are defined in
Section 5.6.3 of <span>[<a href="#HTTPSEM" class="xref">HTTPSEM</a>]</span>.<a href="#section-2.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="terminology">
<section id="section-2.3">
        <h3 id="name-terminology">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-2.3-1">The terms "user agent", "client", "server", "proxy", and "origin server" have
the same meaning as in the HTTP/1.1 specification (<span>[<a href="#HTTPSEM" class="xref">HTTPSEM</a>]</span>, Section 3).<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<p id="section-2.3-2">The request-host is the name of the host, as known by the user agent, to which
the user agent is sending an HTTP request or from which it is receiving an HTTP
response (i.e., the name of the host to which it sent the corresponding HTTP
request).<a href="#section-2.3-2" class="pilcrow">¶</a></p>
<p id="section-2.3-3">The term request-uri refers to "target URI" as defined in Section 7.1 of
<span>[<a href="#HTTPSEM" class="xref">HTTPSEM</a>]</span>.<a href="#section-2.3-3" class="pilcrow">¶</a></p>
<p id="section-2.3-4">Two sequences of octets are said to case-insensitively match each other if and
only if they are equivalent under the i;ascii-casemap collation defined in
<span>[<a href="#RFC4790" class="xref">RFC4790</a>]</span>.<a href="#section-2.3-4" class="pilcrow">¶</a></p>
<p id="section-2.3-5">The term string means a sequence of non-NUL octets.<a href="#section-2.3-5" class="pilcrow">¶</a></p>
<p id="section-2.3-6">The terms "active document", "ancestor browsing context", "browsing context",
"dedicated worker", "Document", "nested browsing context", "opaque origin",
"parent browsing context", "sandboxed origin browsing context flag", "shared
worker", "the worker's Documents", "top-level browsing context", and
"WorkerGlobalScope" are defined in <span>[<a href="#HTML" class="xref">HTML</a>]</span>.<a href="#section-2.3-6" class="pilcrow">¶</a></p>
<p id="section-2.3-7">"Service Workers" are defined in the Service Workers specification
<span>[<a href="#SERVICE-WORKERS" class="xref">SERVICE-WORKERS</a>]</span>.<a href="#section-2.3-7" class="pilcrow">¶</a></p>
<p id="section-2.3-8">The term "origin", the mechanism of deriving an origin from a URI, and the "the
same" matching algorithm for origins are defined in <span>[<a href="#RFC6454" class="xref">RFC6454</a>]</span>.<a href="#section-2.3-8" class="pilcrow">¶</a></p>
<p id="section-2.3-9">"Safe" HTTP methods include <code>GET</code>, <code>HEAD</code>, <code>OPTIONS</code>, and <code>TRACE</code>, as defined
in Section 9.2.1 of <span>[<a href="#HTTPSEM" class="xref">HTTPSEM</a>]</span>.<a href="#section-2.3-9" class="pilcrow">¶</a></p>
<p id="section-2.3-10">A domain's "public suffix" is the portion of a domain that is controlled by a
public registry, such as "com", "co.uk", and "pvt.k12.wy.us". A domain's
"registrable domain" is the domain's public suffix plus the label to its left.
That is, for <code>https://www.site.example</code>, the public suffix is <code>example</code>, and the
registrable domain is <code>site.example</code>. Whenever possible, user agents SHOULD
use an up-to-date public suffix list, such as the one maintained by the Mozilla
project at <span>[<a href="#PSL" class="xref">PSL</a>]</span>.<a href="#section-2.3-10" class="pilcrow">¶</a></p>
<p id="section-2.3-11">The term "request", as well as a request's "client", "current url", "method",
"target browsing context", and "url list", are defined in <span>[<a href="#FETCH" class="xref">FETCH</a>]</span>.<a href="#section-2.3-11" class="pilcrow">¶</a></p>
<p id="section-2.3-12">The term "non-HTTP APIs" refers to non-HTTP mechanisms used to set and retrieve
cookies, such as a web browser API that exposes cookies to scripts.<a href="#section-2.3-12" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="overview">
<section id="section-3">
      <h2 id="name-overview">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-overview" class="section-name selfRef">Overview</a>
      </h2>
<p id="section-3-1">This section outlines a way for an origin server to send state information to a
user agent and for the user agent to return the state information to the origin
server.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">To store state, the origin server includes a Set-Cookie header field in an HTTP
response. In subsequent requests, the user agent returns a Cookie request
header field to the origin server. The Cookie header field contains cookies the user agent
received in previous Set-Cookie header fields. The origin server is free to ignore
the Cookie header field or use its contents for an application-defined purpose.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">Origin servers MAY send a Set-Cookie response header field with any response. An
origin server can include multiple Set-Cookie header fields in a single response.
The presence of a Cookie or a Set-Cookie header field does not preclude HTTP
caches from storing and reusing a response.<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">Origin servers SHOULD NOT fold multiple Set-Cookie header fields into a single
header field. The usual mechanism for folding HTTP headers fields (i.e., as
defined in Section 5.3 of <span>[<a href="#HTTPSEM" class="xref">HTTPSEM</a>]</span>) might change the semantics of the Set-Cookie header
field because the %x2C (",") character is used by Set-Cookie in a way that
conflicts with such folding.<a href="#section-3-4" class="pilcrow">¶</a></p>
<p id="section-3-5">User agents MAY ignore Set-Cookie header fieldss based on response status codes or
the user agent's cookie policy (see <a href="#ignoring-cookies" class="xref">Section 5.3</a>).<a href="#section-3-5" class="pilcrow">¶</a></p>
<div id="examples">
<section id="section-3.1">
        <h3 id="name-examples">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-examples" class="section-name selfRef">Examples</a>
        </h3>
<p id="section-3.1-1">Using the Set-Cookie header field, a server can send the user agent a short string
in an HTTP response that the user agent will return in future HTTP requests that
are within the scope of the cookie. For example, the server can send the user
agent a "session identifier" named SID with the value 31d4d96e407aad42. The
user agent then returns the session identifier in subsequent requests.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<div id="section-3.1-2">
<pre class="sourcecode lang-example">
== Server -&gt; User Agent ==

Set-Cookie: SID=31d4d96e407aad42

== User Agent -&gt; Server ==

Cookie: SID=31d4d96e407aad42
</pre><a href="#section-3.1-2" class="pilcrow">¶</a>
</div>
<p id="section-3.1-3">The server can alter the default scope of the cookie using the Path and
Domain attributes. For example, the server can instruct the user agent to
return the cookie to every path and every subdomain of site.example.<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<div id="section-3.1-4">
<pre class="sourcecode lang-example">
== Server -&gt; User Agent ==

Set-Cookie: SID=31d4d96e407aad42; Path=/; Domain=site.example

== User Agent -&gt; Server ==

Cookie: SID=31d4d96e407aad42
</pre><a href="#section-3.1-4" class="pilcrow">¶</a>
</div>
<p id="section-3.1-5">As shown in the next example, the server can store multiple cookies at the user
agent. For example, the server can store a session identifier as well as the
user's preferred language by returning two Set-Cookie header fields. Notice
that the server uses the Secure and HttpOnly attributes to provide
additional security protections for the more sensitive session identifier (see
<a href="#sane-set-cookie-semantics" class="xref">Section 4.1.2</a>).<a href="#section-3.1-5" class="pilcrow">¶</a></p>
<div id="section-3.1-6">
<pre class="sourcecode lang-example">
== Server -&gt; User Agent ==

Set-Cookie: SID=31d4d96e407aad42; Path=/; Secure; HttpOnly
Set-Cookie: lang=en-US; Path=/; Domain=site.example

== User Agent -&gt; Server ==

Cookie: SID=31d4d96e407aad42; lang=en-US
</pre><a href="#section-3.1-6" class="pilcrow">¶</a>
</div>
<p id="section-3.1-7">Notice that the Cookie header field above contains two cookies, one named SID and
one named lang. If the server wishes the user agent to persist the cookie over
multiple "sessions" (e.g., user agent restarts), the server can specify an
expiration date in the Expires attribute. Note that the user agent might
delete the cookie before the expiration date if the user agent's cookie store
exceeds its quota or if the user manually deletes the server's cookie.<a href="#section-3.1-7" class="pilcrow">¶</a></p>
<div id="section-3.1-8">
<pre class="sourcecode lang-example">
== Server -&gt; User Agent ==

Set-Cookie: lang=en-US; Expires=Wed, 09 Jun 2021 10:18:14 GMT

== User Agent -&gt; Server ==

Cookie: SID=31d4d96e407aad42; lang=en-US
</pre><a href="#section-3.1-8" class="pilcrow">¶</a>
</div>
<p id="section-3.1-9">Finally, to remove a cookie, the server returns a Set-Cookie header field with an
expiration date in the past. The server will be successful in removing the
cookie only if the Path and the Domain attribute in the Set-Cookie header field
match the values used when the cookie was created.<a href="#section-3.1-9" class="pilcrow">¶</a></p>
<div id="section-3.1-10">
<pre class="sourcecode lang-example">
== Server -&gt; User Agent ==

Set-Cookie: lang=; Expires=Sun, 06 Nov 1994 08:49:37 GMT

== User Agent -&gt; Server ==

Cookie: SID=31d4d96e407aad42
</pre><a href="#section-3.1-10" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="sane-profile">
<section id="section-4">
      <h2 id="name-server-requirements">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-server-requirements" class="section-name selfRef">Server Requirements</a>
      </h2>
<p id="section-4-1">This section describes the syntax and semantics of a well-behaved profile of the
Cookie and Set-Cookie header fields.<a href="#section-4-1" class="pilcrow">¶</a></p>
<div id="sane-set-cookie">
<section id="section-4.1">
        <h3 id="name-set-cookie">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-set-cookie" class="section-name selfRef">Set-Cookie</a>
        </h3>
<p id="section-4.1-1">The Set-Cookie HTTP response header field is used to send cookies from the server to
the user agent.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<div id="abnf-syntax">
<section id="section-4.1.1">
          <h4 id="name-syntax">
<a href="#section-4.1.1" class="section-number selfRef">4.1.1. </a><a href="#name-syntax" class="section-name selfRef">Syntax</a>
          </h4>
<p id="section-4.1.1-1">Informally, the Set-Cookie response header field contains a cookie, which begins with a
name-value-pair, followed by zero or more attribute-value pairs. Servers
SHOULD NOT send Set-Cookie header fields that fail to conform to the following
grammar:<a href="#section-4.1.1-1" class="pilcrow">¶</a></p>
<div id="section-4.1.1-2">
<pre class="sourcecode lang-abnf">
set-cookie        = set-cookie-string
set-cookie-string = BWS cookie-pair *( BWS ";" OWS cookie-av )
cookie-pair       = cookie-name BWS "=" BWS cookie-value
cookie-name       = 1*cookie-octet
cookie-value      = *cookie-octet / ( DQUOTE *cookie-octet DQUOTE )
cookie-octet      = %x21 / %x23-2B / %x2D-3A / %x3C-5B / %x5D-7E
                    / %x80-FF
                      ; octets excluding CTLs,
                      ; whitespace DQUOTE, comma, semicolon,
                      ; and backslash

cookie-av         = expires-av / max-age-av / domain-av /
                    path-av / secure-av / httponly-av /
                    samesite-av / extension-av
expires-av        = "Expires" BWS "=" BWS sane-cookie-date
sane-cookie-date  =
    &lt;IMF-fixdate, defined in [HTTPSEM], Section 5.6.7&gt;
max-age-av        = "Max-Age" BWS "=" BWS non-zero-digit *DIGIT
                      ; In practice, both expires-av and max-age-av
                      ; are limited to dates representable by the
                      ; user agent.
non-zero-digit    = %x31-39
                      ; digits 1 through 9
domain-av         = "Domain" BWS "=" BWS domain-value
domain-value      = &lt;subdomain&gt;
                      ; defined in [RFC1034], Section 3.5, as
                      ; enhanced by [RFC1123], Section 2.1
path-av           = "Path" BWS "=" BWS path-value
path-value        = *av-octet
secure-av         = "Secure"
httponly-av       = "HttpOnly"
samesite-av       = "SameSite" BWS "=" BWS samesite-value
samesite-value    = "Strict" / "Lax" / "None"
extension-av      = *av-octet
av-octet          = %x20-3A / %x3C-7E
                      ; any CHAR except CTLs or ";"
</pre><a href="#section-4.1.1-2" class="pilcrow">¶</a>
</div>
<p id="section-4.1.1-3">Note that some of the grammatical terms above reference documents that use
different grammatical notations than this document (which uses ABNF from
<span>[<a href="#RFC5234" class="xref">RFC5234</a>]</span>).<a href="#section-4.1.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1.1-4">The semantics of the cookie-value are not defined by this document.<a href="#section-4.1.1-4" class="pilcrow">¶</a></p>
<p id="section-4.1.1-5">To maximize compatibility with user agents, servers that wish to store arbitrary
data in a cookie-value SHOULD encode that data, for example, using Base64
<span>[<a href="#RFC4648" class="xref">RFC4648</a>]</span>.<a href="#section-4.1.1-5" class="pilcrow">¶</a></p>
<p id="section-4.1.1-6">Per the grammar above, the cookie-value MAY be wrapped in DQUOTE characters.
Note that in this case, the initial and trailing DQUOTE characters are not
stripped. They are part of the cookie-value, and will be included in Cookie
header fields sent to the server.<a href="#section-4.1.1-6" class="pilcrow">¶</a></p>
<p id="section-4.1.1-7">The portions of the set-cookie-string produced by the cookie-av term are
known as attributes. To maximize compatibility with user agents, servers SHOULD
NOT produce two attributes with the same name in the same set-cookie-string.
(See <a href="#storage-model" class="xref">Section 5.5</a> for how user agents handle this case.)<a href="#section-4.1.1-7" class="pilcrow">¶</a></p>
<p id="section-4.1.1-8">Servers SHOULD NOT include more than one Set-Cookie header field in the same
response with the same cookie-name. (See <a href="#set-cookie" class="xref">Section 5.4</a> for how user agents
handle this case.)<a href="#section-4.1.1-8" class="pilcrow">¶</a></p>
<p id="section-4.1.1-9">If a server sends multiple responses containing Set-Cookie header fields
concurrently to the user agent (e.g., when communicating with the user agent
over multiple sockets), these responses create a "race condition" that can lead
to unpredictable behavior.<a href="#section-4.1.1-9" class="pilcrow">¶</a></p>
<p id="section-4.1.1-10">NOTE: Some existing user agents differ in their interpretation of two-digit
years. To avoid compatibility issues, servers SHOULD use the rfc1123-date
format, which requires a four-digit year.<a href="#section-4.1.1-10" class="pilcrow">¶</a></p>
<p id="section-4.1.1-11">NOTE: Some user agents store and process dates in cookies as 32-bit UNIX time_t
values. Implementation bugs in the libraries supporting time_t processing on
some systems might cause such user agents to process dates after the year 2038
incorrectly.<a href="#section-4.1.1-11" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sane-set-cookie-semantics">
<section id="section-4.1.2">
          <h4 id="name-semantics-non-normative">
<a href="#section-4.1.2" class="section-number selfRef">4.1.2. </a><a href="#name-semantics-non-normative" class="section-name selfRef">Semantics (Non-Normative)</a>
          </h4>
<p id="section-4.1.2-1">This section describes simplified semantics of the Set-Cookie header field. These
semantics are detailed enough to be useful for understanding the most common
uses of cookies by servers. The full semantics are described in <a href="#ua-requirements" class="xref">Section 5</a>.<a href="#section-4.1.2-1" class="pilcrow">¶</a></p>
<p id="section-4.1.2-2">When the user agent receives a Set-Cookie header field, the user agent stores the
cookie together with its attributes. Subsequently, when the user agent makes
an HTTP request, the user agent includes the applicable, non-expired cookies
in the Cookie header field.<a href="#section-4.1.2-2" class="pilcrow">¶</a></p>
<p id="section-4.1.2-3">If the user agent receives a new cookie with the same cookie-name,
domain-value, and path-value as a cookie that it has already stored, the
existing cookie is evicted and replaced with the new cookie. Notice that
servers can delete cookies by sending the user agent a new cookie with an
Expires attribute with a value in the past.<a href="#section-4.1.2-3" class="pilcrow">¶</a></p>
<p id="section-4.1.2-4">Unless the cookie's attributes indicate otherwise, the cookie is returned only
to the origin server (and not, for example, to any subdomains), and it expires
at the end of the current session (as defined by the user agent). User agents
ignore unrecognized cookie attributes (but not the entire cookie).<a href="#section-4.1.2-4" class="pilcrow">¶</a></p>
<div id="attribute-expires">
<section id="section-4.1.2.1">
            <h5 id="name-the-expires-attribute">
<a href="#section-4.1.2.1" class="section-number selfRef">4.1.2.1. </a><a href="#name-the-expires-attribute" class="section-name selfRef">The Expires Attribute</a>
            </h5>
<p id="section-4.1.2.1-1">The Expires attribute indicates the maximum lifetime of the cookie,
represented as the date and time at which the cookie expires. The user agent is
not required to retain the cookie until the specified date has passed. In fact,
user agents often evict cookies due to memory pressure or privacy concerns.<a href="#section-4.1.2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="attribute-max-age">
<section id="section-4.1.2.2">
            <h5 id="name-the-max-age-attribute">
<a href="#section-4.1.2.2" class="section-number selfRef">4.1.2.2. </a><a href="#name-the-max-age-attribute" class="section-name selfRef">The Max-Age Attribute</a>
            </h5>
<p id="section-4.1.2.2-1">The Max-Age attribute indicates the maximum lifetime of the cookie,
represented as the number of seconds until the cookie expires. The user agent is
not required to retain the cookie for the specified duration. In fact, user
agents often evict cookies due to memory pressure or privacy concerns.<a href="#section-4.1.2.2-1" class="pilcrow">¶</a></p>
<p id="section-4.1.2.2-2">NOTE: Some existing user agents do not support the Max-Age attribute. User
agents that do not support the Max-Age attribute ignore the attribute.<a href="#section-4.1.2.2-2" class="pilcrow">¶</a></p>
<p id="section-4.1.2.2-3">If a cookie has both the Max-Age and the Expires attribute, the Max-Age
attribute has precedence and controls the expiration date of the cookie. If a
cookie has neither the Max-Age nor the Expires attribute, the user agent
will retain the cookie until "the current session is over" (as defined by the
user agent).<a href="#section-4.1.2.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="attribute-domain">
<section id="section-4.1.2.3">
            <h5 id="name-the-domain-attribute">
<a href="#section-4.1.2.3" class="section-number selfRef">4.1.2.3. </a><a href="#name-the-domain-attribute" class="section-name selfRef">The Domain Attribute</a>
            </h5>
<p id="section-4.1.2.3-1">The Domain attribute specifies those hosts to which the cookie will be sent.
For example, if the value of the Domain attribute is "site.example", the user
agent will include the cookie in the Cookie header field when making HTTP requests to
site.example, www.site.example, and www.corp.site.example. (Note that a
leading %x2E ("."), if present, is ignored even though that character is not
permitted, but a trailing %x2E ("."), if present, will cause the user agent to
ignore the attribute.)  If the server omits the Domain attribute, the user
agent will return the cookie only to the origin server.<a href="#section-4.1.2.3-1" class="pilcrow">¶</a></p>
<p id="section-4.1.2.3-2">WARNING: Some existing user agents treat an absent Domain attribute as if the
Domain attribute were present and contained the current host name. For
example, if site.example returns a Set-Cookie header field without a Domain
attribute, these user agents will erroneously send the cookie to
www.site.example as well.<a href="#section-4.1.2.3-2" class="pilcrow">¶</a></p>
<p id="section-4.1.2.3-3">The user agent will reject cookies unless the Domain attribute specifies a
scope for the cookie that would include the origin server. For example, the
user agent will accept a cookie with a Domain attribute of "site.example" or
of "foo.site.example" from foo.site.example, but the user agent will not accept
a cookie with a Domain attribute of "bar.site.example" or of
"baz.foo.site.example".<a href="#section-4.1.2.3-3" class="pilcrow">¶</a></p>
<p id="section-4.1.2.3-4">NOTE: For security reasons, many user agents are configured to reject Domain
attributes that correspond to "public suffixes". For example, some user
agents will reject Domain attributes of "com" or "co.uk". (See <a href="#storage-model" class="xref">Section 5.5</a> for
more information.)<a href="#section-4.1.2.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="attribute-path">
<section id="section-4.1.2.4">
            <h5 id="name-the-path-attribute">
<a href="#section-4.1.2.4" class="section-number selfRef">4.1.2.4. </a><a href="#name-the-path-attribute" class="section-name selfRef">The Path Attribute</a>
            </h5>
<p id="section-4.1.2.4-1">The scope of each cookie is limited to a set of paths, controlled by the
Path attribute. If the server omits the Path attribute, the user agent will
use the "directory" of the request-uri's path component as the default value.
(See <a href="#cookie-path" class="xref">Section 5.1.4</a> for more details.)<a href="#section-4.1.2.4-1" class="pilcrow">¶</a></p>
<p id="section-4.1.2.4-2">The user agent will include the cookie in an HTTP request only if the path
portion of the request-uri matches (or is a subdirectory of) the cookie's
Path attribute, where the %x2F ("/") character is interpreted as a directory
separator.<a href="#section-4.1.2.4-2" class="pilcrow">¶</a></p>
<p id="section-4.1.2.4-3">Although seemingly useful for isolating cookies between different paths within
a given host, the Path attribute cannot be relied upon for security (see
<a href="#security-considerations" class="xref">Section 8</a>).<a href="#section-4.1.2.4-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="attribute-secure">
<section id="section-4.1.2.5">
            <h5 id="name-the-secure-attribute">
<a href="#section-4.1.2.5" class="section-number selfRef">4.1.2.5. </a><a href="#name-the-secure-attribute" class="section-name selfRef">The Secure Attribute</a>
            </h5>
<p id="section-4.1.2.5-1">The Secure attribute limits the scope of the cookie to "secure" channels
(where "secure" is defined by the user agent). When a cookie has the Secure
attribute, the user agent will include the cookie in an HTTP request only if
the request is transmitted over a secure channel (typically HTTP over Transport
Layer Security (TLS) <span>[<a href="#RFC2818" class="xref">RFC2818</a>]</span>).<a href="#section-4.1.2.5-1" class="pilcrow">¶</a></p>
<p id="section-4.1.2.5-2">Although seemingly useful for protecting cookies from active network attackers,
the Secure attribute protects only the cookie's confidentiality. An active
network attacker can overwrite Secure cookies from an insecure channel,
disrupting their integrity (see <a href="#weak-integrity" class="xref">Section 8.6</a> for more details).<a href="#section-4.1.2.5-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="attribute-httponly">
<section id="section-4.1.2.6">
            <h5 id="name-the-httponly-attribute">
<a href="#section-4.1.2.6" class="section-number selfRef">4.1.2.6. </a><a href="#name-the-httponly-attribute" class="section-name selfRef">The HttpOnly Attribute</a>
            </h5>
<p id="section-4.1.2.6-1">The HttpOnly attribute limits the scope of the cookie to HTTP requests. In
particular, the attribute instructs the user agent to omit the cookie when
providing access to cookies via non-HTTP APIs.<a href="#section-4.1.2.6-1" class="pilcrow">¶</a></p>
<p id="section-4.1.2.6-2">Note that the HttpOnly attribute is independent of the Secure attribute: a
cookie can have both the HttpOnly and the Secure attribute.<a href="#section-4.1.2.6-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="attribute-samesite">
<section id="section-4.1.2.7">
            <h5 id="name-the-samesite-attribute">
<a href="#section-4.1.2.7" class="section-number selfRef">4.1.2.7. </a><a href="#name-the-samesite-attribute" class="section-name selfRef">The SameSite Attribute</a>
            </h5>
<p id="section-4.1.2.7-1">The "SameSite" attribute limits the scope of the cookie such that it will only
be attached to requests if those requests are same-site, as defined by the
algorithm in <a href="#same-site-requests" class="xref">Section 5.2</a>. For example, requests for
<code>https://site.example/sekrit-image</code> will attach same-site cookies if and only if
initiated from a context whose "site for cookies" is an origin with a scheme and
registered domain of "https" and "site.example" respectively.<a href="#section-4.1.2.7-1" class="pilcrow">¶</a></p>
<p id="section-4.1.2.7-2">If the "SameSite" attribute's value is "Strict", the cookie will only be sent
along with "same-site" requests. If the value is "Lax", the cookie will be sent
with same-site requests, and with "cross-site" top-level navigations, as
described in <a href="#strict-lax" class="xref">Section 5.4.7.1</a>. If the value is "None", the cookie will be sent
with same-site and cross-site requests. If the "SameSite" attribute's value is
something other than these three known keywords, the attribute's value will be
subject to a default enforcement mode that is equivalent to "Lax".<a href="#section-4.1.2.7-2" class="pilcrow">¶</a></p>
<p id="section-4.1.2.7-3">The "SameSite" attribute affects cookie creation as well as delivery. Cookies
which assert "SameSite=Lax" or "SameSite=Strict" cannot be set in responses to
cross-site subresource requests, or cross-site nested navigations. They can be
set along with any top-level navigation, cross-site or otherwise.<a href="#section-4.1.2.7-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="cookie-name-prefixes">
<section id="section-4.1.3">
          <h4 id="name-cookie-name-prefixes">
<a href="#section-4.1.3" class="section-number selfRef">4.1.3. </a><a href="#name-cookie-name-prefixes" class="section-name selfRef">Cookie Name Prefixes</a>
          </h4>
<p id="section-4.1.3-1"><a href="#weak-confidentiality" class="xref">Section 8.5</a> and <a href="#weak-integrity" class="xref">Section 8.6</a> of this document spell out some of the drawbacks of cookies'
historical implementation. In particular, it is impossible for a server to have
confidence that a given cookie was set with a particular set of attributes. In
order to provide such confidence in a backwards-compatible way, two common sets
of requirements can be inferred from the first few characters of the cookie's
name.<a href="#section-4.1.3-1" class="pilcrow">¶</a></p>
<p id="section-4.1.3-2">The normative requirements for the prefixes described below are detailed in the
storage model algorithm defined in <a href="#storage-model" class="xref">Section 5.5</a>.<a href="#section-4.1.3-2" class="pilcrow">¶</a></p>
<div id="the-secure-prefix">
<section id="section-4.1.3.1">
            <h5 id="name-the-__secure-prefix">
<a href="#section-4.1.3.1" class="section-number selfRef">4.1.3.1. </a><a href="#name-the-__secure-prefix" class="section-name selfRef">The "__Secure-" Prefix</a>
            </h5>
<p id="section-4.1.3.1-1">If a cookie's name begins with a case-sensitive match for the string
<code>__Secure-</code>, then the cookie will have been set with a <code>Secure</code> attribute.<a href="#section-4.1.3.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1.3.1-2">For example, the following <code>Set-Cookie</code> header field would be rejected by a conformant
user agent, as it does not have a <code>Secure</code> attribute.<a href="#section-4.1.3.1-2" class="pilcrow">¶</a></p>
<div id="section-4.1.3.1-3">
<pre class="sourcecode lang-example">
Set-Cookie: __Secure-SID=12345; Domain=site.example
</pre><a href="#section-4.1.3.1-3" class="pilcrow">¶</a>
</div>
<p id="section-4.1.3.1-4">Whereas the following <code>Set-Cookie</code> header field would be accepted:<a href="#section-4.1.3.1-4" class="pilcrow">¶</a></p>
<div id="section-4.1.3.1-5">
<pre class="sourcecode lang-example">
Set-Cookie: __Secure-SID=12345; Domain=site.example; Secure
</pre><a href="#section-4.1.3.1-5" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="the-host-prefix">
<section id="section-4.1.3.2">
            <h5 id="name-the-__host-prefix">
<a href="#section-4.1.3.2" class="section-number selfRef">4.1.3.2. </a><a href="#name-the-__host-prefix" class="section-name selfRef">The "__Host-" Prefix</a>
            </h5>
<p id="section-4.1.3.2-1">If a cookie's name begins with a case-sensitive match for the string
<code>__Host-</code>, then the cookie will have been set with a <code>Secure</code> attribute, a
<code>Path</code> attribute with a value of <code>/</code>, and no <code>Domain</code> attribute.<a href="#section-4.1.3.2-1" class="pilcrow">¶</a></p>
<p id="section-4.1.3.2-2">This combination yields a cookie that hews as closely as a cookie can to
treating the origin as a security boundary. The lack of a <code>Domain</code> attribute
ensures that the cookie's <code>host-only-flag</code> is true, locking the cookie to a
particular host, rather than allowing it to span subdomains. Setting the <code>Path</code>
to <code>/</code> means that the cookie is effective for the entire host, and won't be
overridden for specific paths. The <code>Secure</code> attribute ensures that the cookie
is unaltered by non-secure origins, and won't span protocols.<a href="#section-4.1.3.2-2" class="pilcrow">¶</a></p>
<p id="section-4.1.3.2-3">Ports are the only piece of the origin model that <code>__Host-</code> cookies continue
to ignore.<a href="#section-4.1.3.2-3" class="pilcrow">¶</a></p>
<p id="section-4.1.3.2-4">For example, the following cookies would always be rejected:<a href="#section-4.1.3.2-4" class="pilcrow">¶</a></p>
<div id="section-4.1.3.2-5">
<pre class="sourcecode lang-example">
Set-Cookie: __Host-SID=12345
Set-Cookie: __Host-SID=12345; Secure
Set-Cookie: __Host-SID=12345; Domain=site.example
Set-Cookie: __Host-SID=12345; Domain=site.example; Path=/
Set-Cookie: __Host-SID=12345; Secure; Domain=site.example; Path=/
</pre><a href="#section-4.1.3.2-5" class="pilcrow">¶</a>
</div>
<p id="section-4.1.3.2-6">While the following would be accepted if set from a secure origin (e.g.
"https://site.example/"), and rejected otherwise:<a href="#section-4.1.3.2-6" class="pilcrow">¶</a></p>
<div id="section-4.1.3.2-7">
<pre class="sourcecode lang-example">
Set-Cookie: __Host-SID=12345; Secure; Path=/
</pre><a href="#section-4.1.3.2-7" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="sane-cookie">
<section id="section-4.2">
        <h3 id="name-cookie">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-cookie" class="section-name selfRef">Cookie</a>
        </h3>
<div id="syntax">
<section id="section-4.2.1">
          <h4 id="name-syntax-2">
<a href="#section-4.2.1" class="section-number selfRef">4.2.1. </a><a href="#name-syntax-2" class="section-name selfRef">Syntax</a>
          </h4>
<p id="section-4.2.1-1">The user agent sends stored cookies to the origin server in the Cookie header field.
If the server conforms to the requirements in <a href="#sane-set-cookie" class="xref">Section 4.1</a> (and the user agent
conforms to the requirements in <a href="#ua-requirements" class="xref">Section 5</a>), the user agent will send a Cookie
header field that conforms to the following grammar:<a href="#section-4.2.1-1" class="pilcrow">¶</a></p>
<div id="section-4.2.1-2">
<pre class="sourcecode lang-abnf">
cookie        = cookie-string
cookie-string = cookie-pair *( ";" SP cookie-pair )
</pre><a href="#section-4.2.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="semantics">
<section id="section-4.2.2">
          <h4 id="name-semantics">
<a href="#section-4.2.2" class="section-number selfRef">4.2.2. </a><a href="#name-semantics" class="section-name selfRef">Semantics</a>
          </h4>
<p id="section-4.2.2-1">Each cookie-pair represents a cookie stored by the user agent. The
cookie-pair contains the cookie-name and cookie-value the user agent
received in the Set-Cookie header field.<a href="#section-4.2.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2.2-2">Notice that the cookie attributes are not returned. In particular, the server
cannot determine from the Cookie  field alone when a cookie will expire, for
which hosts the cookie is valid, for which paths the cookie is valid, or
whether the cookie was set with the Secure or HttpOnly attributes.<a href="#section-4.2.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2.2-3">The semantics of individual cookies in the Cookie header field are not defined by
this document. Servers are expected to imbue these cookies with
application-specific semantics.<a href="#section-4.2.2-3" class="pilcrow">¶</a></p>
<p id="section-4.2.2-4">Although cookies are serialized linearly in the Cookie header field, servers SHOULD
NOT rely upon the serialization order. In particular, if the Cookie header field
contains two cookies with the same name (e.g., that were set with different
Path or Domain attributes), servers SHOULD NOT rely upon the order in which
these cookies appear in the header field.<a href="#section-4.2.2-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="ua-requirements">
<section id="section-5">
      <h2 id="name-user-agent-requirements">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-user-agent-requirements" class="section-name selfRef">User Agent Requirements</a>
      </h2>
<p id="section-5-1">This section specifies the Cookie and Set-Cookie header fields in sufficient
detail that a user agent implementing these requirements precisely can
interoperate with existing servers (even those that do not conform to the
well-behaved profile described in <a href="#sane-profile" class="xref">Section 4</a>).<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">A user agent could enforce more restrictions than those specified herein (e.g.,
restrictions specified by its cookie policy, described in <a href="#cookie-policy" class="xref">Section 7.2</a>).
However, such additional restrictions may reduce the likelihood that a user
agent will be able to interoperate with existing servers.<a href="#section-5-2" class="pilcrow">¶</a></p>
<div id="subcomponent-algorithms">
<section id="section-5.1">
        <h3 id="name-subcomponent-algorithms">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-subcomponent-algorithms" class="section-name selfRef">Subcomponent Algorithms</a>
        </h3>
<p id="section-5.1-1">This section defines some algorithms used by user agents to process specific
subcomponents of the Cookie and Set-Cookie header fields.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<div id="cookie-date">
<section id="section-5.1.1">
          <h4 id="name-dates">
<a href="#section-5.1.1" class="section-number selfRef">5.1.1. </a><a href="#name-dates" class="section-name selfRef">Dates</a>
          </h4>
<p id="section-5.1.1-1">The user agent MUST use an algorithm equivalent to the following algorithm to
parse a cookie-date. Note that the various boolean flags defined as a part
of the algorithm (i.e., found-time, found-day-of-month, found-month,
found-year) are initially "not set".<a href="#section-5.1.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.1.1-2">
<li id="section-5.1.1-2.1">
              <p id="section-5.1.1-2.1.1">Using the grammar below, divide the cookie-date into date-tokens.<a href="#section-5.1.1-2.1.1" class="pilcrow">¶</a></p>
<div id="section-5.1.1-2.1.2">
<pre class="sourcecode lang-abnf">
cookie-date     = *delimiter date-token-list *delimiter
date-token-list = date-token *( 1*delimiter date-token )
date-token      = 1*non-delimiter

delimiter       = %x09 / %x20-2F / %x3B-40 / %x5B-60 / %x7B-7E
non-delimiter   = %x00-08 / %x0A-1F / DIGIT / ":" / ALPHA / %x7F-FF
non-digit       = %x00-2F / %x3A-FF

day-of-month    = 1*2DIGIT [ non-digit *OCTET ]
month           = ( "jan" / "feb" / "mar" / "apr" /
                    "may" / "jun" / "jul" / "aug" /
                    "sep" / "oct" / "nov" / "dec" ) *OCTET
year            = 2*4DIGIT [ non-digit *OCTET ]
time            = hms-time [ non-digit *OCTET ]
hms-time        = time-field ":" time-field ":" time-field
time-field      = 1*2DIGIT
</pre><a href="#section-5.1.1-2.1.2" class="pilcrow">¶</a>
</div>
</li>
            <li id="section-5.1.1-2.2">
              <p id="section-5.1.1-2.2.1">Process each date-token sequentially in the order the date-tokens
appear in the cookie-date:<a href="#section-5.1.1-2.2.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.1.1-2.2.2">
<li id="section-5.1.1-2.2.2.1">If the found-time flag is not set and the token matches the
 time production, set the found-time flag and set the hour-value,
 minute-value, and second-value to the numbers denoted by the digits
 in the date-token, respectively. Skip the remaining sub-steps and
 continue to the next date-token.<a href="#section-5.1.1-2.2.2.1" class="pilcrow">¶</a>
</li>
                <li id="section-5.1.1-2.2.2.2">If the found-day-of-month flag is not set and the date-token matches
 the day-of-month production, set the found-day-of-month flag and set
 the day-of-month-value to the number denoted by the date-token. Skip
 the remaining sub-steps and continue to the next date-token.<a href="#section-5.1.1-2.2.2.2" class="pilcrow">¶</a>
</li>
                <li id="section-5.1.1-2.2.2.3">If the found-month flag is not set and the date-token matches the
 month production, set the found-month flag and set the month-value
 to the month denoted by the date-token. Skip the remaining sub-steps
 and continue to the next date-token.<a href="#section-5.1.1-2.2.2.3" class="pilcrow">¶</a>
</li>
                <li id="section-5.1.1-2.2.2.4">If the found-year flag is not set and the date-token matches the
 year production, set the found-year flag and set the year-value to
 the number denoted by the date-token. Skip the remaining sub-steps
 and continue to the next date-token.<a href="#section-5.1.1-2.2.2.4" class="pilcrow">¶</a>
</li>
              </ol>
</li>
            <li id="section-5.1.1-2.3">If the year-value is greater than or equal to 70 and less than or equal to
99, increment the year-value by 1900.<a href="#section-5.1.1-2.3" class="pilcrow">¶</a>
</li>
            <li id="section-5.1.1-2.4">
              <p id="section-5.1.1-2.4.1">If the year-value is greater than or equal to 0 and less than or equal to
69, increment the year-value by 2000.<a href="#section-5.1.1-2.4.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.1.1-2.4.2">
<li id="section-5.1.1-2.4.2.1">NOTE: Some existing user agents interpret two-digit years differently.<a href="#section-5.1.1-2.4.2.1" class="pilcrow">¶</a>
</li>
              </ol>
</li>
            <li id="section-5.1.1-2.5">
              <p id="section-5.1.1-2.5.1">Abort these steps and fail to parse the cookie-date if:<a href="#section-5.1.1-2.5.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1.1-2.5.2.1">at least one of the found-day-of-month, found-month, found-year, or
found-time flags is not set,<a href="#section-5.1.1-2.5.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-5.1.1-2.5.2.2">the day-of-month-value is less than 1 or greater than 31,<a href="#section-5.1.1-2.5.2.2" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-5.1.1-2.5.2.3">the year-value is less than 1601,<a href="#section-5.1.1-2.5.2.3" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-5.1.1-2.5.2.4">the hour-value is greater than 23,<a href="#section-5.1.1-2.5.2.4" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-5.1.1-2.5.2.5">the minute-value is greater than 59, or<a href="#section-5.1.1-2.5.2.5" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-5.1.1-2.5.2.6">the second-value is greater than 59.<a href="#section-5.1.1-2.5.2.6" class="pilcrow">¶</a>
</li>
              </ul>
<p id="section-5.1.1-2.5.3">
(Note that leap seconds cannot be represented in this syntax.)<a href="#section-5.1.1-2.5.3" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.1.1-2.6">Let the parsed-cookie-date be the date whose day-of-month, month,
year, hour, minute, and second (in UTC) are the
day-of-month-value, the month-value, the year-value, the hour-value,
the minute-value, and the second-value, respectively. If no such date
exists, abort these steps and fail to parse the cookie-date.<a href="#section-5.1.1-2.6" class="pilcrow">¶</a>
</li>
            <li id="section-5.1.1-2.7">Return the parsed-cookie-date as the result of this algorithm.<a href="#section-5.1.1-2.7" class="pilcrow">¶</a>
</li>
          </ol>
</section>
</div>
<div id="canonicalized-host-names">
<section id="section-5.1.2">
          <h4 id="name-canonicalized-host-names">
<a href="#section-5.1.2" class="section-number selfRef">5.1.2. </a><a href="#name-canonicalized-host-names" class="section-name selfRef">Canonicalized Host Names</a>
          </h4>
<p id="section-5.1.2-1">A canonicalized host name is the string generated by the following algorithm:<a href="#section-5.1.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.1.2-2">
<li id="section-5.1.2-2.1">Convert the host name to a sequence of individual domain name labels.<a href="#section-5.1.2-2.1" class="pilcrow">¶</a>
</li>
            <li id="section-5.1.2-2.2">Convert each label that is not a Non-Reserved LDH (NR-LDH) label, to an
A-label (see Section 2.3.2.1 of <span>[<a href="#RFC5890" class="xref">RFC5890</a>]</span> for the former and latter), or
to a "punycode label" (a label resulting from the "ToASCII" conversion in
Section 4 of <span>[<a href="#RFC3490" class="xref">RFC3490</a>]</span>), as appropriate (see <a href="#idna-migration" class="xref">Section 6.3</a> of this
specification).<a href="#section-5.1.2-2.2" class="pilcrow">¶</a>
</li>
            <li id="section-5.1.2-2.3">Concatenate the resulting labels, separated by a %x2E (".") character.<a href="#section-5.1.2-2.3" class="pilcrow">¶</a>
</li>
          </ol>
</section>
</div>
<div id="domain-matching">
<section id="section-5.1.3">
          <h4 id="name-domain-matching">
<a href="#section-5.1.3" class="section-number selfRef">5.1.3. </a><a href="#name-domain-matching" class="section-name selfRef">Domain Matching</a>
          </h4>
<p id="section-5.1.3-1">A string domain-matches a given domain string if at least one of the following
conditions hold:<a href="#section-5.1.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1.3-2.1">The domain string and the string are identical. (Note that both the domain
string and the string will have been canonicalized to lower case at this
point.)<a href="#section-5.1.3-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.1.3-2.2">
              <p id="section-5.1.3-2.2.1">All of the following conditions hold:<a href="#section-5.1.3-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1.3-2.2.2.1">The domain string is a suffix of the string.<a href="#section-5.1.3-2.2.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-5.1.3-2.2.2.2">The last character of the string that is not included in the domain
string is a %x2E (".") character.<a href="#section-5.1.3-2.2.2.2" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-5.1.3-2.2.2.3">The string is a host name (i.e., not an IP address).<a href="#section-5.1.3-2.2.2.3" class="pilcrow">¶</a>
</li>
              </ul>
</li>
          </ul>
</section>
</div>
<div id="cookie-path">
<section id="section-5.1.4">
          <h4 id="name-paths-and-path-match">
<a href="#section-5.1.4" class="section-number selfRef">5.1.4. </a><a href="#name-paths-and-path-match" class="section-name selfRef">Paths and Path-Match</a>
          </h4>
<p id="section-5.1.4-1">The user agent MUST use an algorithm equivalent to the following algorithm to
compute the default-path of a cookie:<a href="#section-5.1.4-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.1.4-2">
<li id="section-5.1.4-2.1">Let uri-path be the path portion of the request-uri if such a portion
exists (and empty otherwise).<a href="#section-5.1.4-2.1" class="pilcrow">¶</a>
</li>
            <li id="section-5.1.4-2.2">If the uri-path is empty or if the first character of the uri-path is
not a %x2F ("/") character, output %x2F ("/") and skip the remaining steps.<a href="#section-5.1.4-2.2" class="pilcrow">¶</a>
</li>
            <li id="section-5.1.4-2.3">If the uri-path contains no more than one %x2F ("/") character, output
%x2F ("/") and skip the remaining step.<a href="#section-5.1.4-2.3" class="pilcrow">¶</a>
</li>
            <li id="section-5.1.4-2.4">Output the characters of the uri-path from the first character up to, but
not including, the right-most %x2F ("/").<a href="#section-5.1.4-2.4" class="pilcrow">¶</a>
</li>
          </ol>
<p id="section-5.1.4-3">A request-path path-matches a given cookie-path if at least one of the
following conditions holds:<a href="#section-5.1.4-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1.4-4.1">
              <p id="section-5.1.4-4.1.1">The cookie-path and the request-path are identical.<a href="#section-5.1.4-4.1.1" class="pilcrow">¶</a></p>
<p id="section-5.1.4-4.1.2">
Note that this differs from the rules in <span>[<a href="#RFC3986" class="xref">RFC3986</a>]</span> for equivalence of the
path component, and hence two equivalent paths can have different cookies.<a href="#section-5.1.4-4.1.2" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.1.4-4.2">The cookie-path is a prefix of the request-path, and the last character
of the cookie-path is %x2F ("/").<a href="#section-5.1.4-4.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.1.4-4.3">The cookie-path is a prefix of the request-path, and the first character
of the request-path that is not included in the cookie-path is a %x2F
("/") character.<a href="#section-5.1.4-4.3" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="same-site-requests">
<section id="section-5.2">
        <h3 id="name-same-site-and-cross-site-re">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-same-site-and-cross-site-re" class="section-name selfRef">"Same-site" and "cross-site" Requests</a>
        </h3>
<p id="section-5.2-1">Two origins are same-site if they satisfy the "same site" criteria defined in
<span>[<a href="#SAMESITE" class="xref">SAMESITE</a>]</span>. A request is "same-site" if the following criteria are true:<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.2-2">
<li id="section-5.2-2.1">The request is not the result of a cross-site redirect. That is,
the origin of every url in the request's url list is same-site with the
request's current url's origin.<a href="#section-5.2-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-5.2-2.2">The request is not the result of a reload navigation triggered through a
user interface element (as defined by the user agent; e.g., a request
triggered by the user clicking a refresh button on a toolbar).<a href="#section-5.2-2.2" class="pilcrow">¶</a>
</li>
          <li id="section-5.2-2.3">The request's current url's origin is same-site with the request's
client's "site for cookies" (which is an origin), or if the request has no
client or the request's client is null.<a href="#section-5.2-2.3" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-5.2-3">Requests which are the result of a reload navigation triggered through a user
interface element are same-site if the reloaded document was originally
navigated to via a same-site request. A request that is not "same-site" is
instead "cross-site".<a href="#section-5.2-3" class="pilcrow">¶</a></p>
<p id="section-5.2-4">The request's client's "site for cookies" is calculated depending upon its
client's type, as described in the following subsections:<a href="#section-5.2-4" class="pilcrow">¶</a></p>
<div id="document-requests">
<section id="section-5.2.1">
          <h4 id="name-document-based-requests">
<a href="#section-5.2.1" class="section-number selfRef">5.2.1. </a><a href="#name-document-based-requests" class="section-name selfRef">Document-based requests</a>
          </h4>
<p id="section-5.2.1-1">The URI displayed in a user agent's address bar is the only security context
directly exposed to users, and therefore the only signal users can reasonably
rely upon to determine whether or not they trust a particular website. The
origin of that URI represents the context in which a user most likely believes
themselves to be interacting. We'll define this origin, the top-level browsing
context's active document's origin, as the "top-level origin".<a href="#section-5.2.1-1" class="pilcrow">¶</a></p>
<p id="section-5.2.1-2">For a document displayed in a top-level browsing context, we can stop here: the
document's "site for cookies" is the top-level origin.<a href="#section-5.2.1-2" class="pilcrow">¶</a></p>
<p id="section-5.2.1-3">For documents which are displayed in nested browsing contexts, we need to audit
the origins of each of a document's ancestor browsing contexts' active documents
in order to account for the "multiple-nested scenarios" described in Section 4
of <span>[<a href="#RFC7034" class="xref">RFC7034</a>]</span>. A document's "site for cookies" is the top-level origin if and
only if the top-level origin is same-site with the document's origin, and with
each of the document's ancestor documents' origins. Otherwise its "site for
cookies" is an origin set to an opaque origin.<a href="#section-5.2.1-3" class="pilcrow">¶</a></p>
<p id="section-5.2.1-4">Given a Document (<code>document</code>), the following algorithm returns its "site for
cookies":<a href="#section-5.2.1-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.2.1-5">
<li id="section-5.2.1-5.1">Let <code>top-document</code> be the active document in <code>document</code>'s browsing context's
top-level browsing context.<a href="#section-5.2.1-5.1" class="pilcrow">¶</a>
</li>
            <li id="section-5.2.1-5.2">Let <code>top-origin</code> be the origin of <code>top-document</code>'s URI if <code>top-document</code>'s
sandboxed origin browsing context flag is set, and <code>top-document</code>'s origin
otherwise.<a href="#section-5.2.1-5.2" class="pilcrow">¶</a>
</li>
            <li id="section-5.2.1-5.3">Let <code>documents</code> be a list containing <code>document</code> and each of <code>document</code>'s
ancestor browsing contexts' active documents.<a href="#section-5.2.1-5.3" class="pilcrow">¶</a>
</li>
            <li id="section-5.2.1-5.4">
              <p id="section-5.2.1-5.4.1">For each <code>item</code> in <code>documents</code>:<a href="#section-5.2.1-5.4.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.2.1-5.4.2">
<li id="section-5.2.1-5.4.2.1">Let <code>origin</code> be the origin of <code>item</code>'s URI if <code>item</code>'s sandboxed origin
browsing context flag is set, and <code>item</code>'s origin otherwise.<a href="#section-5.2.1-5.4.2.1" class="pilcrow">¶</a>
</li>
                <li id="section-5.2.1-5.4.2.2">If <code>origin</code> is not same-site with <code>top-origin</code>, return an origin set to
an opaque origin.<a href="#section-5.2.1-5.4.2.2" class="pilcrow">¶</a>
</li>
              </ol>
</li>
            <li id="section-5.2.1-5.5">Return <code>top-origin</code>.<a href="#section-5.2.1-5.5" class="pilcrow">¶</a>
</li>
          </ol>
</section>
</div>
<div id="worker-requests">
<section id="section-5.2.2">
          <h4 id="name-worker-based-requests">
<a href="#section-5.2.2" class="section-number selfRef">5.2.2. </a><a href="#name-worker-based-requests" class="section-name selfRef">Worker-based requests</a>
          </h4>
<p id="section-5.2.2-1">Worker-driven requests aren't as clear-cut as document-driven requests, as
there isn't a clear link between a top-level browsing context and a worker.
This is especially true for Service Workers <span>[<a href="#SERVICE-WORKERS" class="xref">SERVICE-WORKERS</a>]</span>, which may
execute code in the background, without any document visible at all.<a href="#section-5.2.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2.2-2">Note: The descriptions below assume that workers must be same-origin with
the documents that instantiate them. If this invariant changes, we'll need to
take the worker's script's URI into account when determining their status.<a href="#section-5.2.2-2" class="pilcrow">¶</a></p>
<div id="dedicated-and-shared-requests">
<section id="section-5.2.2.1">
            <h5 id="name-dedicated-and-shared-worker">
<a href="#section-5.2.2.1" class="section-number selfRef">5.2.2.1. </a><a href="#name-dedicated-and-shared-worker" class="section-name selfRef">Dedicated and Shared Workers</a>
            </h5>
<p id="section-5.2.2.1-1">Dedicated workers are simple, as each dedicated worker is bound to one and only
one document. Requests generated from a dedicated worker (via <code>importScripts</code>,
<code>XMLHttpRequest</code>, <code>fetch()</code>, etc) define their "site for cookies" as that
document's "site for cookies".<a href="#section-5.2.2.1-1" class="pilcrow">¶</a></p>
<p id="section-5.2.2.1-2">Shared workers may be bound to multiple documents at once. As it is quite
possible for those documents to have distinct "site for cookies" values, the
worker's "site for cookies" will be an origin set to an opaque origin in cases
where the values are not all same-site with the worker's origin, and the
worker's origin in cases where the values agree.<a href="#section-5.2.2.1-2" class="pilcrow">¶</a></p>
<p id="section-5.2.2.1-3">Given a WorkerGlobalScope (<code>worker</code>), the following algorithm returns its "site
for cookies":<a href="#section-5.2.2.1-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.2.2.1-4">
<li id="section-5.2.2.1-4.1">Let <code>site</code> be <code>worker</code>'s origin.<a href="#section-5.2.2.1-4.1" class="pilcrow">¶</a>
</li>
              <li id="section-5.2.2.1-4.2">
                <p id="section-5.2.2.1-4.2.1">For each <code>document</code> in <code>worker</code>'s Documents:<a href="#section-5.2.2.1-4.2.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.2.2.1-4.2.2">
<li id="section-5.2.2.1-4.2.2.1">Let <code>document-site</code> be <code>document</code>'s "site for cookies" (as defined
in <a href="#document-requests" class="xref">Section 5.2.1</a>).<a href="#section-5.2.2.1-4.2.2.1" class="pilcrow">¶</a>
</li>
                  <li id="section-5.2.2.1-4.2.2.2">If <code>document-site</code> is not same-site with <code>site</code>, return an origin
set to an opaque origin.<a href="#section-5.2.2.1-4.2.2.2" class="pilcrow">¶</a>
</li>
                </ol>
</li>
              <li id="section-5.2.2.1-4.3">Return <code>site</code>.<a href="#section-5.2.2.1-4.3" class="pilcrow">¶</a>
</li>
            </ol>
</section>
</div>
<div id="service-workers">
<section id="section-5.2.2.2">
            <h5 id="name-service-workers">
<a href="#section-5.2.2.2" class="section-number selfRef">5.2.2.2. </a><a href="#name-service-workers" class="section-name selfRef">Service Workers</a>
            </h5>
<p id="section-5.2.2.2-1">Service Workers are more complicated, as they act as a completely separate
execution context with only tangential relationship to the Document which
registered them.<a href="#section-5.2.2.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2.2.2-2">Requests which simply pass through a Service Worker will be handled as described
above: the request's client will be the Document or Worker which initiated the
request, and its "site for cookies" will be those defined in
<a href="#document-requests" class="xref">Section 5.2.1</a> and <a href="#dedicated-and-shared-requests" class="xref">Section 5.2.2.1</a><a href="#section-5.2.2.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2.2.2-3">Requests which are initiated by the Service Worker itself (via a direct call to
<code>fetch()</code>, for instance), on the other hand, will have a client which is a
ServiceWorkerGlobalScope. Its "site for cookies" will be the Service Worker's
URI's origin.<a href="#section-5.2.2.2-3" class="pilcrow">¶</a></p>
<p id="section-5.2.2.2-4">Given a ServiceWorkerGlobalScope (<code>worker</code>), the following algorithm returns its
"site for cookies":<a href="#section-5.2.2.2-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.2.2.2-5">
<li id="section-5.2.2.2-5.1">Return <code>worker</code>'s origin.<a href="#section-5.2.2.2-5.1" class="pilcrow">¶</a>
</li>
            </ol>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="ignoring-cookies">
<section id="section-5.3">
        <h3 id="name-ignoring-set-cookie-header-">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-ignoring-set-cookie-header-" class="section-name selfRef">Ignoring Set-Cookie Header Fields</a>
        </h3>
<p id="section-5.3-1">User agents MAY ignore Set-Cookie header fields contained in responses with 100-level
status codes or based on its cookie policy (see <a href="#cookie-policy" class="xref">Section 7.2</a>).<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3-2">All other Set-Cookie header fields SHOULD be processed according to <a href="#set-cookie" class="xref">Section 5.4</a>.
That is, Set-Cookie header fields contained in responses with non-100-level status
codes (including those in responses with 400- and 500-level status codes)
SHOULD be processed unless ignored according to the user agent's cookie policy.<a href="#section-5.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="set-cookie">
<section id="section-5.4">
        <h3 id="name-the-set-cookie-header-field">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-the-set-cookie-header-field" class="section-name selfRef">The Set-Cookie Header Field</a>
        </h3>
<p id="section-5.4-1">When a user agent receives a Set-Cookie header field in an HTTP response, the
user agent MAY ignore the Set-Cookie header field in its entirety
(see <a href="#ignoring-cookies" class="xref">Section 5.3</a>).<a href="#section-5.4-1" class="pilcrow">¶</a></p>
<p id="section-5.4-2">If the user agent does not ignore the Set-Cookie header field in its entirety,
the user agent MUST parse the field-value of the Set-Cookie header field as a
set-cookie-string (defined below).<a href="#section-5.4-2" class="pilcrow">¶</a></p>
<p id="section-5.4-3">NOTE: The algorithm below is more permissive than the grammar in <a href="#sane-set-cookie" class="xref">Section 4.1</a>.
For example, the algorithm strips leading and trailing whitespace from the
cookie name and value (but maintains internal whitespace), whereas the grammar
in <a href="#sane-set-cookie" class="xref">Section 4.1</a> forbids whitespace in these positions. In addition, the
algorithm below accommodates some characters that are not cookie-octets
according to the grammar in <a href="#sane-set-cookie" class="xref">Section 4.1</a>. User agents use this algorithm
so as to interoperate with servers that do not follow the recommendations in
<a href="#sane-profile" class="xref">Section 4</a>.<a href="#section-5.4-3" class="pilcrow">¶</a></p>
<p id="section-5.4-4">NOTE: As set-cookie-string may originate from a non-HTTP API, it is not
guaranteed to be free of CTL characters, so this algorithm handles them
explicitly.<a href="#section-5.4-4" class="pilcrow">¶</a></p>
<p id="section-5.4-5">A user agent MUST use an algorithm equivalent to the following algorithm to
parse a set-cookie-string:<a href="#section-5.4-5" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.4-6">
<li id="section-5.4-6.1">If the set-cookie-string contains a %x0D (CR), %x0A (LF), or %x00 (NUL)
octet, then set the set-cookie-string equal to all the characters of
set-cookie-string up to, but not including, the first such octet.<a href="#section-5.4-6.1" class="pilcrow">¶</a>
</li>
          <li id="section-5.4-6.2">If the set-cookie-string contains a %x00-1F / %x7F (CTL) character:
Abort these steps and ignore the set-cookie-string entirely.<a href="#section-5.4-6.2" class="pilcrow">¶</a>
</li>
          <li id="section-5.4-6.3">
            <p id="section-5.4-6.3.1">If the set-cookie-string contains a %x3B (";") character:<a href="#section-5.4-6.3.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.4-6.3.2">
<li id="section-5.4-6.3.2.1">The name-value-pair string consists of the characters up to, but not
including, the first %x3B (";"), and the unparsed-attributes consist of
the remainder of the set-cookie-string (including the %x3B (";") in
question).<a href="#section-5.4-6.3.2.1" class="pilcrow">¶</a>
</li>
            </ol>
<p id="section-5.4-6.3.3">
Otherwise:<a href="#section-5.4-6.3.3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.4-6.3.4">
<li id="section-5.4-6.3.4.1">The name-value-pair string consists of all the characters contained in
the set-cookie-string, and the unparsed-attributes is the empty
string.<a href="#section-5.4-6.3.4.1" class="pilcrow">¶</a>
</li>
            </ol>
</li>
          <li id="section-5.4-6.4">
            <p id="section-5.4-6.4.1">If the name-value-pair string lacks a %x3D ("=") character, then the name
string is empty, and the value string is the value of name-value-pair.<a href="#section-5.4-6.4.1" class="pilcrow">¶</a></p>
<p id="section-5.4-6.4.2">
Otherwise, the name string consists of the characters up to, but not
including, the first %x3D ("=") character, and the (possibly empty) value
string consists of the characters after the first %x3D ("=") character.<a href="#section-5.4-6.4.2" class="pilcrow">¶</a></p>
</li>
          <li id="section-5.4-6.5">Remove any leading or trailing WSP characters from the name string and the
value string.<a href="#section-5.4-6.5" class="pilcrow">¶</a>
</li>
          <li id="section-5.4-6.6">The cookie-name is the name string, and the cookie-value is the value string.<a href="#section-5.4-6.6" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-5.4-7">The user agent MUST use an algorithm equivalent to the following algorithm to
parse the unparsed-attributes:<a href="#section-5.4-7" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.4-8">
<li id="section-5.4-8.1">If the unparsed-attributes string is empty, skip the rest of these steps.<a href="#section-5.4-8.1" class="pilcrow">¶</a>
</li>
          <li id="section-5.4-8.2">Discard the first character of the unparsed-attributes (which will be a
%x3B (";") character).<a href="#section-5.4-8.2" class="pilcrow">¶</a>
</li>
          <li id="section-5.4-8.3">
            <p id="section-5.4-8.3.1">If the remaining unparsed-attributes contains a %x3B (";") character:<a href="#section-5.4-8.3.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.4-8.3.2">
<li id="section-5.4-8.3.2.1">Consume the characters of the unparsed-attributes up to, but not
including, the first %x3B (";") character.<a href="#section-5.4-8.3.2.1" class="pilcrow">¶</a>
</li>
            </ol>
<p id="section-5.4-8.3.3">
Otherwise:<a href="#section-5.4-8.3.3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.4-8.3.4">
<li id="section-5.4-8.3.4.1">Consume the remainder of the unparsed-attributes.<a href="#section-5.4-8.3.4.1" class="pilcrow">¶</a>
</li>
            </ol>
<p id="section-5.4-8.3.5">
Let the cookie-av string be the characters consumed in this step.<a href="#section-5.4-8.3.5" class="pilcrow">¶</a></p>
</li>
          <li id="section-5.4-8.4">
            <p id="section-5.4-8.4.1">If the cookie-av string contains a %x3D ("=") character:<a href="#section-5.4-8.4.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.4-8.4.2">
<li id="section-5.4-8.4.2.1">The (possibly empty) attribute-name string consists of the characters
up to, but not including, the first %x3D ("=") character, and the
(possibly empty) attribute-value string consists of the characters
after the first %x3D ("=") character.<a href="#section-5.4-8.4.2.1" class="pilcrow">¶</a>
</li>
            </ol>
<p id="section-5.4-8.4.3">
Otherwise:<a href="#section-5.4-8.4.3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.4-8.4.4">
<li id="section-5.4-8.4.4.1">The attribute-name string consists of the entire cookie-av string,
and the attribute-value string is empty.<a href="#section-5.4-8.4.4.1" class="pilcrow">¶</a>
</li>
            </ol>
</li>
          <li id="section-5.4-8.5">Remove any leading or trailing WSP characters from the attribute-name
string and the attribute-value string.<a href="#section-5.4-8.5" class="pilcrow">¶</a>
</li>
          <li id="section-5.4-8.6">Process the attribute-name and attribute-value according to the
requirements in the following subsections. (Notice that attributes with
unrecognized attribute-names are ignored.)<a href="#section-5.4-8.6" class="pilcrow">¶</a>
</li>
          <li id="section-5.4-8.7">Return to Step 1 of this algorithm.<a href="#section-5.4-8.7" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-5.4-9">When the user agent finishes parsing the set-cookie-string, the user agent is
said to "receive a cookie" from the request-uri with name cookie-name,
value cookie-value, and attributes cookie-attribute-list. (See <a href="#storage-model" class="xref">Section 5.5</a>
for additional requirements triggered by receiving a cookie.)<a href="#section-5.4-9" class="pilcrow">¶</a></p>
<div id="the-expires-attribute">
<section id="section-5.4.1">
          <h4 id="name-the-expires-attribute-2">
<a href="#section-5.4.1" class="section-number selfRef">5.4.1. </a><a href="#name-the-expires-attribute-2" class="section-name selfRef">The Expires Attribute</a>
          </h4>
<p id="section-5.4.1-1">If the attribute-name case-insensitively matches the string "Expires", the
user agent MUST process the cookie-av as follows.<a href="#section-5.4.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.4.1-2">
<li id="section-5.4.1-2.1">Let the expiry-time be the result of parsing the attribute-value as
cookie-date (see <a href="#cookie-date" class="xref">Section 5.1.1</a>).<a href="#section-5.4.1-2.1" class="pilcrow">¶</a>
</li>
            <li id="section-5.4.1-2.2">If the attribute-value failed to parse as a cookie date, ignore the
cookie-av.<a href="#section-5.4.1-2.2" class="pilcrow">¶</a>
</li>
            <li id="section-5.4.1-2.3">If the expiry-time is later than the last date the user agent can
represent, the user agent MAY replace the expiry-time with the last
representable date.<a href="#section-5.4.1-2.3" class="pilcrow">¶</a>
</li>
            <li id="section-5.4.1-2.4">If the expiry-time is earlier than the earliest date the user agent can
represent, the user agent MAY replace the expiry-time with the earliest
representable date.<a href="#section-5.4.1-2.4" class="pilcrow">¶</a>
</li>
            <li id="section-5.4.1-2.5">Append an attribute to the cookie-attribute-list with an attribute-name
of Expires and an attribute-value of expiry-time.<a href="#section-5.4.1-2.5" class="pilcrow">¶</a>
</li>
          </ol>
</section>
</div>
<div id="the-max-age-attribute">
<section id="section-5.4.2">
          <h4 id="name-the-max-age-attribute-2">
<a href="#section-5.4.2" class="section-number selfRef">5.4.2. </a><a href="#name-the-max-age-attribute-2" class="section-name selfRef">The Max-Age Attribute</a>
          </h4>
<p id="section-5.4.2-1">If the attribute-name case-insensitively matches the string "Max-Age", the
user agent MUST process the cookie-av as follows.<a href="#section-5.4.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.4.2-2">
<li id="section-5.4.2-2.1">If the first character of the attribute-value is not a DIGIT or a "-"
character, ignore the cookie-av.<a href="#section-5.4.2-2.1" class="pilcrow">¶</a>
</li>
            <li id="section-5.4.2-2.2">If the remainder of attribute-value contains a non-DIGIT character, ignore
the cookie-av.<a href="#section-5.4.2-2.2" class="pilcrow">¶</a>
</li>
            <li id="section-5.4.2-2.3">Let delta-seconds be the attribute-value converted to an integer.<a href="#section-5.4.2-2.3" class="pilcrow">¶</a>
</li>
            <li id="section-5.4.2-2.4">If delta-seconds is less than or equal to zero (0), let expiry-time be
the earliest representable date and time. Otherwise, let the expiry-time
be the current date and time plus delta-seconds seconds.<a href="#section-5.4.2-2.4" class="pilcrow">¶</a>
</li>
            <li id="section-5.4.2-2.5">Append an attribute to the cookie-attribute-list with an attribute-name
of Max-Age and an attribute-value of expiry-time.<a href="#section-5.4.2-2.5" class="pilcrow">¶</a>
</li>
          </ol>
</section>
</div>
<div id="the-domain-attribute">
<section id="section-5.4.3">
          <h4 id="name-the-domain-attribute-2">
<a href="#section-5.4.3" class="section-number selfRef">5.4.3. </a><a href="#name-the-domain-attribute-2" class="section-name selfRef">The Domain Attribute</a>
          </h4>
<p id="section-5.4.3-1">If the attribute-name case-insensitively matches the string "Domain", the user
agent MUST process the cookie-av as follows.<a href="#section-5.4.3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.4.3-2">
<li id="section-5.4.3-2.1">If the attribute-value is empty, the behavior is undefined. However, the
user agent SHOULD ignore the cookie-av entirely.<a href="#section-5.4.3-2.1" class="pilcrow">¶</a>
</li>
            <li id="section-5.4.3-2.2">
              <p id="section-5.4.3-2.2.1">If the first character of the attribute-value string is %x2E ("."):<a href="#section-5.4.3-2.2.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.4.3-2.2.2">
<li id="section-5.4.3-2.2.2.1">Let cookie-domain be the attribute-value without the leading %x2E
(".") character.<a href="#section-5.4.3-2.2.2.1" class="pilcrow">¶</a>
</li>
              </ol>
<p id="section-5.4.3-2.2.3">
Otherwise:<a href="#section-5.4.3-2.2.3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.4.3-2.2.4">
<li id="section-5.4.3-2.2.4.1">Let cookie-domain be the entire attribute-value.<a href="#section-5.4.3-2.2.4.1" class="pilcrow">¶</a>
</li>
              </ol>
</li>
            <li id="section-5.4.3-2.3">Convert the cookie-domain to lower case.<a href="#section-5.4.3-2.3" class="pilcrow">¶</a>
</li>
            <li id="section-5.4.3-2.4">Append an attribute to the cookie-attribute-list with an attribute-name
of Domain and an attribute-value of cookie-domain.<a href="#section-5.4.3-2.4" class="pilcrow">¶</a>
</li>
          </ol>
</section>
</div>
<div id="the-path-attribute">
<section id="section-5.4.4">
          <h4 id="name-the-path-attribute-2">
<a href="#section-5.4.4" class="section-number selfRef">5.4.4. </a><a href="#name-the-path-attribute-2" class="section-name selfRef">The Path Attribute</a>
          </h4>
<p id="section-5.4.4-1">If the attribute-name case-insensitively matches the string "Path", the user
agent MUST process the cookie-av as follows.<a href="#section-5.4.4-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.4.4-2">
<li id="section-5.4.4-2.1">
              <p id="section-5.4.4-2.1.1">If the attribute-value is empty or if the first character of the
attribute-value is not %x2F ("/"):<a href="#section-5.4.4-2.1.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.4.4-2.1.2">
<li id="section-5.4.4-2.1.2.1">Let cookie-path be the default-path.<a href="#section-5.4.4-2.1.2.1" class="pilcrow">¶</a>
</li>
              </ol>
<p id="section-5.4.4-2.1.3">
Otherwise:<a href="#section-5.4.4-2.1.3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.4.4-2.1.4">
<li id="section-5.4.4-2.1.4.1">Let cookie-path be the attribute-value.<a href="#section-5.4.4-2.1.4.1" class="pilcrow">¶</a>
</li>
              </ol>
</li>
            <li id="section-5.4.4-2.2">Append an attribute to the cookie-attribute-list with an attribute-name
of Path and an attribute-value of cookie-path.<a href="#section-5.4.4-2.2" class="pilcrow">¶</a>
</li>
          </ol>
</section>
</div>
<div id="the-secure-attribute">
<section id="section-5.4.5">
          <h4 id="name-the-secure-attribute-2">
<a href="#section-5.4.5" class="section-number selfRef">5.4.5. </a><a href="#name-the-secure-attribute-2" class="section-name selfRef">The Secure Attribute</a>
          </h4>
<p id="section-5.4.5-1">If the attribute-name case-insensitively matches the string "Secure", the
user agent MUST append an attribute to the cookie-attribute-list with an
attribute-name of Secure and an empty attribute-value.<a href="#section-5.4.5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="the-httponly-attribute">
<section id="section-5.4.6">
          <h4 id="name-the-httponly-attribute-2">
<a href="#section-5.4.6" class="section-number selfRef">5.4.6. </a><a href="#name-the-httponly-attribute-2" class="section-name selfRef">The HttpOnly Attribute</a>
          </h4>
<p id="section-5.4.6-1">If the attribute-name case-insensitively matches the string "HttpOnly", the
user agent MUST append an attribute to the cookie-attribute-list with an
attribute-name of HttpOnly and an empty attribute-value.<a href="#section-5.4.6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="the-samesite-attribute">
<section id="section-5.4.7">
          <h4 id="name-the-samesite-attribute-2">
<a href="#section-5.4.7" class="section-number selfRef">5.4.7. </a><a href="#name-the-samesite-attribute-2" class="section-name selfRef">The SameSite Attribute</a>
          </h4>
<p id="section-5.4.7-1">If the attribute-name case-insensitively matches the string "SameSite", the
user agent MUST process the cookie-av as follows:<a href="#section-5.4.7-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.4.7-2">
<li id="section-5.4.7-2.1">Let <code>enforcement</code> be "Default".<a href="#section-5.4.7-2.1" class="pilcrow">¶</a>
</li>
            <li id="section-5.4.7-2.2">If cookie-av's attribute-value is a case-insensitive match for "None",
set <code>enforcement</code> to "None".<a href="#section-5.4.7-2.2" class="pilcrow">¶</a>
</li>
            <li id="section-5.4.7-2.3">If cookie-av's attribute-value is a case-insensitive match for "Strict",
set <code>enforcement</code> to "Strict".<a href="#section-5.4.7-2.3" class="pilcrow">¶</a>
</li>
            <li id="section-5.4.7-2.4">If cookie-av's attribute-value is a case-insensitive match for "Lax", set
<code>enforcement</code> to "Lax".<a href="#section-5.4.7-2.4" class="pilcrow">¶</a>
</li>
            <li id="section-5.4.7-2.5">Append an attribute to the cookie-attribute-list with an attribute-name
of "SameSite" and an attribute-value of <code>enforcement</code>.<a href="#section-5.4.7-2.5" class="pilcrow">¶</a>
</li>
          </ol>
<div id="strict-lax">
<section id="section-5.4.7.1">
            <h5 id="name-strict-and-lax-enforcement">
<a href="#section-5.4.7.1" class="section-number selfRef">5.4.7.1. </a><a href="#name-strict-and-lax-enforcement" class="section-name selfRef">"Strict" and "Lax" enforcement</a>
            </h5>
<p id="section-5.4.7.1-1">Same-site cookies in "Strict" enforcement mode will not be sent along with
top-level navigations which are triggered from a cross-site document context.
As discussed in <a href="#top-level-navigations" class="xref">Section 8.8.2</a>, this might or might not be compatible
with existing session management systems. In the interests of providing a
drop-in mechanism that mitigates the risk of CSRF attacks, developers may set
the <code>SameSite</code> attribute in a "Lax" enforcement mode that carves out an
exception which sends same-site cookies along with cross-site requests if and
only if they are top-level navigations which use a "safe" (in the <span>[<a href="#HTTPSEM" class="xref">HTTPSEM</a>]</span>
sense) HTTP method. (Note that a request's method may be changed from POST
to GET for some redirects (see Sections 15.4.2 and 15.4.3 of <span>[<a href="#HTTPSEM" class="xref">HTTPSEM</a>]</span>); in
these cases, a request's "safe"ness is determined based on the method of the
current redirect hop.)<a href="#section-5.4.7.1-1" class="pilcrow">¶</a></p>
<p id="section-5.4.7.1-2">Lax enforcement provides reasonable defense in depth against CSRF attacks that
rely on unsafe HTTP methods (like <code>POST</code>), but does not offer a robust defense
against CSRF as a general category of attack:<a href="#section-5.4.7.1-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.4.7.1-3">
<li id="section-5.4.7.1-3.1">Attackers can still pop up new windows or trigger top-level navigations in
order to create a "same-site" request (as described in <a href="#document-requests" class="xref">Section 5.2.1</a>), which
is only a speedbump along the road to exploitation.<a href="#section-5.4.7.1-3.1" class="pilcrow">¶</a>
</li>
              <li id="section-5.4.7.1-3.2">Features like <code>&lt;link rel='prerender'&gt;</code> <span>[<a href="#prerendering" class="xref">prerendering</a>]</span> can be exploited
to create "same-site" requests without the risk of user detection.<a href="#section-5.4.7.1-3.2" class="pilcrow">¶</a>
</li>
            </ol>
<p id="section-5.4.7.1-4">When possible, developers should use a session management mechanism such as
that described in <a href="#top-level-navigations" class="xref">Section 8.8.2</a> to mitigate the risk of CSRF more
completely.<a href="#section-5.4.7.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="lax-allowing-unsafe">
<section id="section-5.4.7.2">
            <h5 id="name-lax-allowing-unsafe-enforce">
<a href="#section-5.4.7.2" class="section-number selfRef">5.4.7.2. </a><a href="#name-lax-allowing-unsafe-enforce" class="section-name selfRef">"Lax-Allowing-Unsafe" enforcement</a>
            </h5>
<p id="section-5.4.7.2-1">As discussed in <a href="#unsafe-top-level-requests" class="xref">Section 8.8.6</a>, compatibility concerns may
necessitate the use of a "Lax-allowing-unsafe" enforcement mode that allows
cookies to be sent with a cross-site HTTP request if and only if it is a
top-level request, regardless of request method. That is, the
"Lax-allowing-unsafe" enforcement mode waives the requirement for the HTTP
request's method to be "safe" in the <code>SameSite</code> enforcement step of the
retrieval algorithm in <a href="#retrieval-algorithm" class="xref">Section 5.6.3</a>. (All cookies, regardless of
<code>SameSite</code> enforcement mode, may be set for top-level navigations, regardless of
HTTP request method, as specified in <a href="#storage-model" class="xref">Section 5.5</a>.)<a href="#section-5.4.7.2-1" class="pilcrow">¶</a></p>
<p id="section-5.4.7.2-2">"Lax-allowing-unsafe" is not a distinct value of the <code>SameSite</code> attribute.
Rather, user agents MAY apply "Lax-allowing-unsafe" enforcement only to cookies
that did not explicitly specify a <code>SameSite</code> attribute (i.e., those whose
same-site-flag was set to "Default" by default). To limit the scope of this
compatibility mode, user agents which apply "Lax-allowing-unsafe" enforcement
SHOULD restrict the enforcement to cookies which were created recently.
Deployment experience has shown a cookie age of 2 minutes or less to be a
reasonable limit.<a href="#section-5.4.7.2-2" class="pilcrow">¶</a></p>
<p id="section-5.4.7.2-3">If the user agent uses "Lax-allowing-unsafe" enforcement, it MUST apply the
following modification to the retrieval algorithm defined in
<a href="#retrieval-algorithm" class="xref">Section 5.6.3</a>:<a href="#section-5.4.7.2-3" class="pilcrow">¶</a></p>
<p id="section-5.4.7.2-4">Replace the condition in the penultimate bullet point of step 1 of the retrieval
algorithm reading<a href="#section-5.4.7.2-4" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-5.4.7.2-5">
<pre>
 * The HTTP request associated with the retrieval uses a "safe" method.
</pre><a href="#section-5.4.7.2-5" class="pilcrow">¶</a>
</div>
<p id="section-5.4.7.2-6">with<a href="#section-5.4.7.2-6" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-5.4.7.2-7">
<pre>
 * At least one of the following is true:

   1.  The HTTP request associated with the retrieval uses a "safe" method.

   2.  The cookie's same-site-flag is "Default" and the amount of time
       elapsed since the cookie's creation-time is at most a duration of the
       user agent's choosing.
</pre><a href="#section-5.4.7.2-7" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="storage-model">
<section id="section-5.5">
        <h3 id="name-storage-model">
<a href="#section-5.5" class="section-number selfRef">5.5. </a><a href="#name-storage-model" class="section-name selfRef">Storage Model</a>
        </h3>
<p id="section-5.5-1">The user agent stores the following fields about each cookie: name, value,
expiry-time, domain, path, creation-time, last-access-time,
persistent-flag, host-only-flag, secure-only-flag, http-only-flag,
and same-site-flag.<a href="#section-5.5-1" class="pilcrow">¶</a></p>
<p id="section-5.5-2">When the user agent "receives a cookie" from a request-uri with name
cookie-name, value cookie-value, and attributes cookie-attribute-list, the
user agent MUST process the cookie as follows:<a href="#section-5.5-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.5-3">
<li id="section-5.5-3.1">A user agent MAY ignore a received cookie in its entirety. See
<a href="#ignoring-cookies" class="xref">Section 5.3</a>.<a href="#section-5.5-3.1" class="pilcrow">¶</a>
</li>
          <li id="section-5.5-3.2">If cookie-name is empty and cookie-value is empty, abort these steps and
ignore the cookie entirely.<a href="#section-5.5-3.2" class="pilcrow">¶</a>
</li>
          <li id="section-5.5-3.3">If the cookie-name or the cookie-value contains a %x00-1F / %x7F (CTL)
character, abort these steps and ignore the cookie entirely.<a href="#section-5.5-3.3" class="pilcrow">¶</a>
</li>
          <li id="section-5.5-3.4">Create a new cookie with name cookie-name, value cookie-value. Set the
creation-time and the last-access-time to the current date and time.<a href="#section-5.5-3.4" class="pilcrow">¶</a>
</li>
          <li id="section-5.5-3.5">
            <p id="section-5.5-3.5.1">If the cookie-attribute-list contains an attribute with an attribute-name
of "Max-Age":<a href="#section-5.5-3.5.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.5-3.5.2">
<li id="section-5.5-3.5.2.1">Set the cookie's persistent-flag to true.<a href="#section-5.5-3.5.2.1" class="pilcrow">¶</a>
</li>
              <li id="section-5.5-3.5.2.2">Set the cookie's expiry-time to attribute-value of the last
attribute in the cookie-attribute-list with an attribute-name of
"Max-Age".<a href="#section-5.5-3.5.2.2" class="pilcrow">¶</a>
</li>
            </ol>
<p id="section-5.5-3.5.3">
Otherwise, if the cookie-attribute-list contains an attribute with an
attribute-name of "Expires" (and does not contain an attribute with an
attribute-name of "Max-Age"):<a href="#section-5.5-3.5.3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.5-3.5.4">
<li id="section-5.5-3.5.4.1">Set the cookie's persistent-flag to true.<a href="#section-5.5-3.5.4.1" class="pilcrow">¶</a>
</li>
              <li id="section-5.5-3.5.4.2">Set the cookie's expiry-time to attribute-value of the last
attribute in the cookie-attribute-list with an attribute-name of
"Expires".<a href="#section-5.5-3.5.4.2" class="pilcrow">¶</a>
</li>
            </ol>
<p id="section-5.5-3.5.5">
Otherwise:<a href="#section-5.5-3.5.5" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.5-3.5.6">
<li id="section-5.5-3.5.6.1">Set the cookie's persistent-flag to false.<a href="#section-5.5-3.5.6.1" class="pilcrow">¶</a>
</li>
              <li id="section-5.5-3.5.6.2">Set the cookie's expiry-time to the latest representable date.<a href="#section-5.5-3.5.6.2" class="pilcrow">¶</a>
</li>
            </ol>
</li>
          <li id="section-5.5-3.6">
            <p id="section-5.5-3.6.1">If the cookie-attribute-list contains an attribute with an
attribute-name of "Domain":<a href="#section-5.5-3.6.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.5-3.6.2">
<li id="section-5.5-3.6.2.1">Let the domain-attribute be the attribute-value of the last
attribute in the cookie-attribute-list with an attribute-name of
"Domain".<a href="#section-5.5-3.6.2.1" class="pilcrow">¶</a>
</li>
            </ol>
<p id="section-5.5-3.6.3">
Otherwise:<a href="#section-5.5-3.6.3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.5-3.6.4">
<li id="section-5.5-3.6.4.1">Let the domain-attribute be the empty string.<a href="#section-5.5-3.6.4.1" class="pilcrow">¶</a>
</li>
            </ol>
</li>
          <li id="section-5.5-3.7">
            <p id="section-5.5-3.7.1">If the user agent is configured to reject "public suffixes" and the
domain-attribute is a public suffix:<a href="#section-5.5-3.7.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.5-3.7.2">
<li id="section-5.5-3.7.2.1">
                <p id="section-5.5-3.7.2.1.1">If the domain-attribute is identical to the canonicalized
request-host:<a href="#section-5.5-3.7.2.1.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.5-3.7.2.1.2">
<li id="section-5.5-3.7.2.1.2.1">Let the domain-attribute be the empty string.<a href="#section-5.5-3.7.2.1.2.1" class="pilcrow">¶</a>
</li>
                </ol>
<p id="section-5.5-3.7.2.1.3">
Otherwise:<a href="#section-5.5-3.7.2.1.3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.5-3.7.2.1.4">
<li id="section-5.5-3.7.2.1.4.1">Ignore the cookie entirely and abort these steps.<a href="#section-5.5-3.7.2.1.4.1" class="pilcrow">¶</a>
</li>
                </ol>
</li>
            </ol>
<p id="section-5.5-3.7.3">
NOTE: This step prevents <code>attacker.example</code> from disrupting the integrity of
<code>site.example</code> by setting a cookie with a Domain attribute of "example".<a href="#section-5.5-3.7.3" class="pilcrow">¶</a></p>
</li>
          <li id="section-5.5-3.8">
            <p id="section-5.5-3.8.1">If the domain-attribute is non-empty:<a href="#section-5.5-3.8.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.5-3.8.2">
<li id="section-5.5-3.8.2.1">
                <p id="section-5.5-3.8.2.1.1">If the canonicalized request-host does not domain-match the
domain-attribute:<a href="#section-5.5-3.8.2.1.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.5-3.8.2.1.2">
<li id="section-5.5-3.8.2.1.2.1">Ignore the cookie entirely and abort these steps.<a href="#section-5.5-3.8.2.1.2.1" class="pilcrow">¶</a>
</li>
                </ol>
<p id="section-5.5-3.8.2.1.3">
Otherwise:<a href="#section-5.5-3.8.2.1.3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.5-3.8.2.1.4">
<li id="section-5.5-3.8.2.1.4.1">Set the cookie's host-only-flag to false.<a href="#section-5.5-3.8.2.1.4.1" class="pilcrow">¶</a>
</li>
                  <li id="section-5.5-3.8.2.1.4.2">Set the cookie's domain to the domain-attribute.<a href="#section-5.5-3.8.2.1.4.2" class="pilcrow">¶</a>
</li>
                </ol>
</li>
            </ol>
<p id="section-5.5-3.8.3">
Otherwise:<a href="#section-5.5-3.8.3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.5-3.8.4">
<li id="section-5.5-3.8.4.1">Set the cookie's host-only-flag to true.<a href="#section-5.5-3.8.4.1" class="pilcrow">¶</a>
</li>
              <li id="section-5.5-3.8.4.2">Set the cookie's domain to the canonicalized request-host.<a href="#section-5.5-3.8.4.2" class="pilcrow">¶</a>
</li>
            </ol>
</li>
          <li id="section-5.5-3.9">If the cookie-attribute-list contains an attribute with an
attribute-name of "Path", set the cookie's path to attribute-value of
the last attribute in the cookie-attribute-list with an attribute-name
of "Path". Otherwise, set the cookie's path to the default-path of the
request-uri.<a href="#section-5.5-3.9" class="pilcrow">¶</a>
</li>
          <li id="section-5.5-3.10">If the cookie-attribute-list contains an attribute with an
attribute-name of "Secure", set the cookie's secure-only-flag to true.
Otherwise, set the cookie's secure-only-flag to false.<a href="#section-5.5-3.10" class="pilcrow">¶</a>
</li>
          <li id="section-5.5-3.11">If the scheme component of the request-uri does not denote a "secure"
    protocol (as defined by the user agent), and the cookie's secure-only-flag
    is true, then abort these steps and ignore the cookie entirely.<a href="#section-5.5-3.11" class="pilcrow">¶</a>
</li>
          <li id="section-5.5-3.12">If the cookie-attribute-list contains an attribute with an
attribute-name of "HttpOnly", set the cookie's http-only-flag to true.
Otherwise, set the cookie's http-only-flag to false.<a href="#section-5.5-3.12" class="pilcrow">¶</a>
</li>
          <li id="section-5.5-3.13">If the cookie was received from a "non-HTTP" API and the cookie's
http-only-flag is true, abort these steps and ignore the cookie entirely.<a href="#section-5.5-3.13" class="pilcrow">¶</a>
</li>
          <li id="section-5.5-3.14">
            <p id="section-5.5-3.14.1">If the cookie's secure-only-flag is false, and the scheme component of
request-uri does not denote a "secure" protocol, then abort these steps and
ignore the cookie entirely if the cookie store contains one or more cookies
that meet all of the following criteria:<a href="#section-5.5-3.14.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.5-3.14.2">
<li id="section-5.5-3.14.2.1">Their name matches the name of the newly-created cookie.<a href="#section-5.5-3.14.2.1" class="pilcrow">¶</a>
</li>
              <li id="section-5.5-3.14.2.2">Their secure-only-flag is true.<a href="#section-5.5-3.14.2.2" class="pilcrow">¶</a>
</li>
              <li id="section-5.5-3.14.2.3">Their domain domain-matches the domain of the newly-created cookie, or
vice-versa.<a href="#section-5.5-3.14.2.3" class="pilcrow">¶</a>
</li>
              <li id="section-5.5-3.14.2.4">The path of the newly-created cookie path-matches the path of the
existing cookie.<a href="#section-5.5-3.14.2.4" class="pilcrow">¶</a>
</li>
            </ol>
<p id="section-5.5-3.14.3">
Note: The path comparison is not symmetric, ensuring only that a
newly-created, non-secure cookie does not overlay an existing secure
cookie, providing some mitigation against cookie-fixing attacks. That is,
given an existing secure cookie named 'a' with a path of '/login', a
non-secure cookie named 'a' could be set for a path of '/' or '/foo', but
not for a path of '/login' or '/login/en'.<a href="#section-5.5-3.14.3" class="pilcrow">¶</a></p>
</li>
          <li id="section-5.5-3.15">If the cookie-attribute-list contains an attribute with an
attribute-name of "SameSite", and an attribute-value of "Strict", "Lax", or
"None", set the cookie's same-site-flag to the attribute-value of the last
attribute in the cookie-attribute-list with an attribute-name of "SameSite".
Otherwise, set the cookie's same-site-flag to "Default".<a href="#section-5.5-3.15" class="pilcrow">¶</a>
</li>
          <li id="section-5.5-3.16">
            <p id="section-5.5-3.16.1">If the cookie's <code>same-site-flag</code> is not "None":<a href="#section-5.5-3.16.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.5-3.16.2">
<li id="section-5.5-3.16.2.1">If the cookie was received from a "non-HTTP" API, and the API was called
from a browsing context's active document whose "site for cookies" is
not same-site with the top-level origin, then abort these steps and
ignore the newly created cookie entirely.<a href="#section-5.5-3.16.2.1" class="pilcrow">¶</a>
</li>
              <li id="section-5.5-3.16.2.2">If the cookie was received from a "same-site" request (as defined in
<a href="#same-site-requests" class="xref">Section 5.2</a>), skip the remaining substeps and continue
processing the cookie.<a href="#section-5.5-3.16.2.2" class="pilcrow">¶</a>
</li>
              <li id="section-5.5-3.16.2.3">
                <p id="section-5.5-3.16.2.3.1">If the cookie was received from a request which is navigating a
top-level browsing context <span>[<a href="#HTML" class="xref">HTML</a>]</span> (e.g. if the request's "reserved
client" is either <code>null</code> or an environment whose "target browsing
context" is a top-level browing context), skip the remaining substeps
and continue processing the cookie.<a href="#section-5.5-3.16.2.3.1" class="pilcrow">¶</a></p>
<p id="section-5.5-3.16.2.3.2">
Note: Top-level navigations can create a cookie with any <code>SameSite</code>
value, even if the new cookie wouldn't have been sent along with
the request had it already existed prior to the navigation.<a href="#section-5.5-3.16.2.3.2" class="pilcrow">¶</a></p>
</li>
              <li id="section-5.5-3.16.2.4">Abort these steps and ignore the newly created cookie entirely.<a href="#section-5.5-3.16.2.4" class="pilcrow">¶</a>
</li>
            </ol>
</li>
          <li id="section-5.5-3.17">If the cookie's "same-site-flag" is "None", abort these steps and ignore the
cookie entirely unless the cookie's secure-only-flag is true.<a href="#section-5.5-3.17" class="pilcrow">¶</a>
</li>
          <li id="section-5.5-3.18">If the cookie-name begins with a case-sensitive match for the string
"__Secure-", abort these steps and ignore the cookie entirely unless the
cookie's secure-only-flag is true.<a href="#section-5.5-3.18" class="pilcrow">¶</a>
</li>
          <li id="section-5.5-3.19">
            <p id="section-5.5-3.19.1">If the cookie-name begins with a case-sensitive match for the string
"__Host-", abort these steps and ignore the cookie entirely unless the
cookie meets all the following criteria:<a href="#section-5.5-3.19.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.5-3.19.2">
<li id="section-5.5-3.19.2.1">The cookie's secure-only-flag is true.<a href="#section-5.5-3.19.2.1" class="pilcrow">¶</a>
</li>
              <li id="section-5.5-3.19.2.2">The cookie's host-only-flag is true.<a href="#section-5.5-3.19.2.2" class="pilcrow">¶</a>
</li>
              <li id="section-5.5-3.19.2.3">The cookie-attribute-list contains an attribute with an attribute-name
of "Path", and the cookie's path is <code>/</code>.<a href="#section-5.5-3.19.2.3" class="pilcrow">¶</a>
</li>
            </ol>
</li>
          <li id="section-5.5-3.20">
            <p id="section-5.5-3.20.1">If the cookie store contains a cookie with the same name, domain,
host-only-flag, and path as the newly-created cookie:<a href="#section-5.5-3.20.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.5-3.20.2">
<li id="section-5.5-3.20.2.1">Let old-cookie be the existing cookie with the same name, domain,
host-only-flag, and path as the newly-created cookie. (Notice that this
algorithm maintains the invariant that there is at most one such
cookie.)<a href="#section-5.5-3.20.2.1" class="pilcrow">¶</a>
</li>
              <li id="section-5.5-3.20.2.2">If the newly-created cookie was received from a "non-HTTP" API and the
old-cookie's http-only-flag is true, abort these steps and ignore the
newly created cookie entirely.<a href="#section-5.5-3.20.2.2" class="pilcrow">¶</a>
</li>
              <li id="section-5.5-3.20.2.3">Update the creation-time of the newly-created cookie to match the
creation-time of the old-cookie.<a href="#section-5.5-3.20.2.3" class="pilcrow">¶</a>
</li>
              <li id="section-5.5-3.20.2.4">Remove the old-cookie from the cookie store.<a href="#section-5.5-3.20.2.4" class="pilcrow">¶</a>
</li>
            </ol>
</li>
          <li id="section-5.5-3.21">Insert the newly-created cookie into the cookie store.<a href="#section-5.5-3.21" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-5.5-4">A cookie is "expired" if the cookie has an expiry date in the past.<a href="#section-5.5-4" class="pilcrow">¶</a></p>
<p id="section-5.5-5">The user agent MUST evict all expired cookies from the cookie store if, at any
time, an expired cookie exists in the cookie store.<a href="#section-5.5-5" class="pilcrow">¶</a></p>
<p id="section-5.5-6">At any time, the user agent MAY "remove excess cookies" from the cookie store
if the number of cookies sharing a domain field exceeds some
implementation-defined upper bound (such as 50 cookies).<a href="#section-5.5-6" class="pilcrow">¶</a></p>
<p id="section-5.5-7">At any time, the user agent MAY "remove excess cookies" from the cookie store
if the cookie store exceeds some predetermined upper bound (such as 3000
cookies).<a href="#section-5.5-7" class="pilcrow">¶</a></p>
<p id="section-5.5-8">When the user agent removes excess cookies from the cookie store, the user
agent MUST evict cookies in the following priority order:<a href="#section-5.5-8" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.5-9">
<li id="section-5.5-9.1">Expired cookies.<a href="#section-5.5-9.1" class="pilcrow">¶</a>
</li>
          <li id="section-5.5-9.2">Cookies whose secure-only-flag is false, and which share a domain field
with more than a predetermined number of other cookies.<a href="#section-5.5-9.2" class="pilcrow">¶</a>
</li>
          <li id="section-5.5-9.3">Cookies that share a domain field with more than a predetermined number of
other cookies.<a href="#section-5.5-9.3" class="pilcrow">¶</a>
</li>
          <li id="section-5.5-9.4">All cookies.<a href="#section-5.5-9.4" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-5.5-10">If two cookies have the same removal priority, the user agent MUST evict the
cookie with the earliest last-access-time first.<a href="#section-5.5-10" class="pilcrow">¶</a></p>
<p id="section-5.5-11">When "the current session is over" (as defined by the user agent), the user
agent MUST remove from the cookie store all cookies with the persistent-flag
set to false.<a href="#section-5.5-11" class="pilcrow">¶</a></p>
</section>
</div>
<div id="retrieval-model">
<section id="section-5.6">
        <h3 id="name-retrieval-model">
<a href="#section-5.6" class="section-number selfRef">5.6. </a><a href="#name-retrieval-model" class="section-name selfRef">Retrieval Model</a>
        </h3>
<p id="section-5.6-1">This section defines how cookies are retrieved from a cookie store in the form
of a cookie-string. A "retrieval" is any event which requires generating a
cookie-string. For example, a retrieval may occur in order to build a Cookie
header field for an HTTP request, or may be required in order to return a
cookie-string from a call to a "non-HTTP" API that provides access to cookies. A
retrieval has an associated URI, same-site status, and type, which
are defined below depending on the type of retrieval.<a href="#section-5.6-1" class="pilcrow">¶</a></p>
<div id="cookie">
<section id="section-5.6.1">
          <h4 id="name-the-cookie-header-field">
<a href="#section-5.6.1" class="section-number selfRef">5.6.1. </a><a href="#name-the-cookie-header-field" class="section-name selfRef">The Cookie Header Field</a>
          </h4>
<p id="section-5.6.1-1">The user agent includes stored cookies in the Cookie HTTP request header field.<a href="#section-5.6.1-1" class="pilcrow">¶</a></p>
<p id="section-5.6.1-2">When the user agent generates an HTTP request, the user agent MUST NOT attach
more than one Cookie header field.<a href="#section-5.6.1-2" class="pilcrow">¶</a></p>
<p id="section-5.6.1-3">A user agent MAY omit the Cookie header field in its entirety.  For example, the
user agent might wish to block sending cookies during "third-party" requests
from setting cookies (see <a href="#third-party-cookies" class="xref">Section 7.1</a>).<a href="#section-5.6.1-3" class="pilcrow">¶</a></p>
<p id="section-5.6.1-4">If the user agent does attach a Cookie header field to an HTTP request, the
user agent MUST compute the cookie-string following the algorithm defined in
<a href="#retrieval-algorithm" class="xref">Section 5.6.3</a>, where the retrieval's URI is the request-uri, the
retrieval's same-site status is computed for the HTTP request as defined in
<a href="#same-site-requests" class="xref">Section 5.2</a>, and the retrieval's type is "HTTP".<a href="#section-5.6.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="non-http">
<section id="section-5.6.2">
          <h4 id="name-non-http-apis">
<a href="#section-5.6.2" class="section-number selfRef">5.6.2. </a><a href="#name-non-http-apis" class="section-name selfRef">Non-HTTP APIs</a>
          </h4>
<p id="section-5.6.2-1">The user agent MAY implement "non-HTTP" APIs that can be used to access
stored cookies.<a href="#section-5.6.2-1" class="pilcrow">¶</a></p>
<p id="section-5.6.2-2">A user agent MAY return an empty cookie-string in certain contexts, such as
when a retrieval occurs within a third-party context (see
<a href="#third-party-cookies" class="xref">Section 7.1</a>).<a href="#section-5.6.2-2" class="pilcrow">¶</a></p>
<p id="section-5.6.2-3">If a user agent does return cookies for a given call to a "non-HTTP" API with
an associated Document, then the user agent MUST compute the cookie-string
following the algorithm defined in <a href="#retrieval-algorithm" class="xref">Section 5.6.3</a>, where the
retrieval's URI is defined by the caller (see <span>[<a href="#DOM-DOCUMENT-COOKIE" class="xref">DOM-DOCUMENT-COOKIE</a>]</span>), the
retrieval's same-site status is "same-site" if the Document's "site for
cookies" is same-site with the top-level origin as defined in
<a href="#document-requests" class="xref">Section 5.2.1</a> (otherwise it is "cross-site"), and the retrieval's type
is "non-HTTP".<a href="#section-5.6.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="retrieval-algorithm">
<section id="section-5.6.3">
          <h4 id="name-retrieval-algorithm">
<a href="#section-5.6.3" class="section-number selfRef">5.6.3. </a><a href="#name-retrieval-algorithm" class="section-name selfRef">Retrieval Algorithm</a>
          </h4>
<p id="section-5.6.3-1">Given a cookie store and a retrieval, the following algorithm returns a
cookie-string from a given cookie store.<a href="#section-5.6.3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.6.3-2">
<li id="section-5.6.3-2.1">
              <p id="section-5.6.3-2.1.1">Let cookie-list be the set of cookies from the cookie store that meets all
of the following requirements:<a href="#section-5.6.3-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.6.3-2.1.2.1">
                  <p id="section-5.6.3-2.1.2.1.1">Either:<a href="#section-5.6.3-2.1.2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.6.3-2.1.2.1.2.1">The cookie's host-only-flag is true and the canonicalized
host of the retrieval's URI is identical to the cookie's domain.<a href="#section-5.6.3-2.1.2.1.2.1" class="pilcrow">¶</a>
</li>
                  </ul>
<p id="section-5.6.3-2.1.2.1.3">
Or:<a href="#section-5.6.3-2.1.2.1.3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.6.3-2.1.2.1.4.1">The cookie's host-only-flag is false and the canonicalized
host of the retrieval's URI domain-matches the cookie's domain.<a href="#section-5.6.3-2.1.2.1.4.1" class="pilcrow">¶</a>
</li>
                  </ul>
</li>
                <li class="normal" id="section-5.6.3-2.1.2.2">The retrieval's URI's path path-matches the cookie's path.<a href="#section-5.6.3-2.1.2.2" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-5.6.3-2.1.2.3">
                  <p id="section-5.6.3-2.1.2.3.1">If the cookie's secure-only-flag is true, then the retrieval's URI's
scheme must denote a "secure" protocol (as defined by the user agent).<a href="#section-5.6.3-2.1.2.3.1" class="pilcrow">¶</a></p>
<p id="section-5.6.3-2.1.2.3.2">
NOTE: The notion of a "secure" protocol is not defined by this document.
Typically, user agents consider a protocol secure if the protocol makes
use of transport-layer security, such as SSL or TLS. For example, most
user agents consider "https" to be a scheme that denotes a secure
protocol.<a href="#section-5.6.3-2.1.2.3.2" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-5.6.3-2.1.2.4">If the cookie's http-only-flag is true, then exclude the cookie if the
retrieval's type is "non-HTTP".<a href="#section-5.6.3-2.1.2.4" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-5.6.3-2.1.2.5">
                  <p id="section-5.6.3-2.1.2.5.1">If the cookie's same-site-flag is not "None" and the retrieval's same-site
status is "cross-site", then exclude the cookie unless all of the
following conditions are met:<a href="#section-5.6.3-2.1.2.5.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.6.3-2.1.2.5.2.1">The retrieval's type is "HTTP".<a href="#section-5.6.3-2.1.2.5.2.1" class="pilcrow">¶</a>
</li>
                    <li class="normal" id="section-5.6.3-2.1.2.5.2.2">The same-site-flag is "Lax" or "Default".<a href="#section-5.6.3-2.1.2.5.2.2" class="pilcrow">¶</a>
</li>
                    <li class="normal" id="section-5.6.3-2.1.2.5.2.3">The HTTP request associated with the retrieval uses a "safe" method.<a href="#section-5.6.3-2.1.2.5.2.3" class="pilcrow">¶</a>
</li>
                    <li class="normal" id="section-5.6.3-2.1.2.5.2.4">The target browsing context of the HTTP request associated with the
retrieval is a top-level browsing context.<a href="#section-5.6.3-2.1.2.5.2.4" class="pilcrow">¶</a>
</li>
                  </ul>
</li>
              </ul>
</li>
            <li id="section-5.6.3-2.2">
              <p id="section-5.6.3-2.2.1">The user agent SHOULD sort the cookie-list in the following order:<a href="#section-5.6.3-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.6.3-2.2.2.1">Cookies with longer paths are listed before cookies with shorter
paths.<a href="#section-5.6.3-2.2.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-5.6.3-2.2.2.2">Among cookies that have equal-length path fields, cookies with earlier
creation-times are listed before cookies with later creation-times.<a href="#section-5.6.3-2.2.2.2" class="pilcrow">¶</a>
</li>
              </ul>
<p id="section-5.6.3-2.2.3">
NOTE: Not all user agents sort the cookie-list in this order, but this order
reflects common practice when this document was written, and, historically,
there have been servers that (erroneously) depended on this order.<a href="#section-5.6.3-2.2.3" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.6.3-2.3">Update the last-access-time of each cookie in the cookie-list to the
current date and time.<a href="#section-5.6.3-2.3" class="pilcrow">¶</a>
</li>
            <li id="section-5.6.3-2.4">
              <p id="section-5.6.3-2.4.1">Serialize the cookie-list into a cookie-string by processing each cookie
in the cookie-list in order:<a href="#section-5.6.3-2.4.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.6.3-2.4.2">
<li id="section-5.6.3-2.4.2.1">If the cookies' name is not empty, output the cookie's name followed by
the %x3D ("=") character.<a href="#section-5.6.3-2.4.2.1" class="pilcrow">¶</a>
</li>
                <li id="section-5.6.3-2.4.2.2">If the cookies' value is not empty, output the cookie's value.<a href="#section-5.6.3-2.4.2.2" class="pilcrow">¶</a>
</li>
                <li id="section-5.6.3-2.4.2.3">If there is an unprocessed cookie in the cookie-list, output the
characters %x3B and %x20 ("; ").<a href="#section-5.6.3-2.4.2.3" class="pilcrow">¶</a>
</li>
              </ol>
</li>
          </ol>
<p id="section-5.6.3-3">NOTE: Despite its name, the cookie-string is actually a sequence of octets, not
a sequence of characters.  To convert the cookie-string (or components
thereof) into a sequence of characters (e.g., for presentation to the user),
the user agent might wish to try using the UTF-8 character encoding <span>[<a href="#RFC3629" class="xref">RFC3629</a>]</span>
to decode the octet sequence. This decoding might fail, however, because not
every sequence of octets is valid UTF-8.<a href="#section-5.6.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="implementation-considerations">
<section id="section-6">
      <h2 id="name-implementation-consideratio">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-implementation-consideratio" class="section-name selfRef">Implementation Considerations</a>
      </h2>
<div id="limits">
<section id="section-6.1">
        <h3 id="name-limits">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-limits" class="section-name selfRef">Limits</a>
        </h3>
<p id="section-6.1-1">Practical user agent implementations have limits on the number and size of
cookies that they can store. General-use user agents SHOULD provide each of the
following minimum capabilities:<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-2.1">At least 4096 bytes per cookie (as measured by the sum of the length of the
cookie's name, value, and attributes).<a href="#section-6.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.1-2.2">At least 50 cookies per domain.<a href="#section-6.1-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.1-2.3">At least 3000 cookies total.<a href="#section-6.1-2.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-6.1-3">Servers SHOULD use as few and as small cookies as possible to avoid reaching
these implementation limits and to minimize network bandwidth due to the
Cookie header field being included in every request.<a href="#section-6.1-3" class="pilcrow">¶</a></p>
<p id="section-6.1-4">Servers SHOULD gracefully degrade if the user agent fails to return one or more
cookies in the Cookie header field because the user agent might evict any cookie at
any time on orders from the user.<a href="#section-6.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="application-programming-interfaces">
<section id="section-6.2">
        <h3 id="name-application-programming-int">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-application-programming-int" class="section-name selfRef">Application Programming Interfaces</a>
        </h3>
<p id="section-6.2-1">One reason the Cookie and Set-Cookie header fields use such esoteric syntax is
that many platforms (both in servers and user agents) provide a string-based
application programming interface (API) to cookies, requiring
application-layer programmers to generate and parse the syntax used by the
Cookie and Set-Cookie header fields, which many programmers have done incorrectly,
resulting in interoperability problems.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">Instead of providing string-based APIs to cookies, platforms would be
well-served by providing more semantic APIs. It is beyond the scope of this
document to recommend specific API designs, but there are clear benefits to
accepting an abstract "Date" object instead of a serialized date string.<a href="#section-6.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="idna-migration">
<section id="section-6.3">
        <h3 id="name-idna-dependency-and-migrati">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-idna-dependency-and-migrati" class="section-name selfRef">IDNA Dependency and Migration</a>
        </h3>
<p id="section-6.3-1">IDNA2008 <span>[<a href="#RFC5890" class="xref">RFC5890</a>]</span> supersedes IDNA2003 <span>[<a href="#RFC3490" class="xref">RFC3490</a>]</span>. However, there are
differences between the two specifications, and thus there can be differences
in processing (e.g., converting) domain name labels that have been registered
under one from those registered under the other. There will be a transition
period of some time during which IDNA2003-based domain name labels will exist
in the wild. User agents SHOULD implement IDNA2008 <span>[<a href="#RFC5890" class="xref">RFC5890</a>]</span> and MAY
implement <span>[<a href="#UTS46" class="xref">UTS46</a>]</span> or <span>[<a href="#RFC5895" class="xref">RFC5895</a>]</span> in order to facilitate their IDNA transition.
If a user agent does not implement IDNA2008, the user agent MUST implement
IDNA2003 <span>[<a href="#RFC3490" class="xref">RFC3490</a>]</span>.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="privacy-considerations">
<section id="section-7">
      <h2 id="name-privacy-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-privacy-considerations" class="section-name selfRef">Privacy Considerations</a>
      </h2>
<p id="section-7-1">Cookies are often criticized for letting servers track users. For example, a
number of "web analytics" companies use cookies to recognize when a user returns
to a web site or visits another web site. Although cookies are not the only
mechanism servers can use to track users across HTTP requests, cookies
facilitate tracking because they are persistent across user agent sessions and
can be shared between hosts.<a href="#section-7-1" class="pilcrow">¶</a></p>
<div id="third-party-cookies">
<section id="section-7.1">
        <h3 id="name-third-party-cookies">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-third-party-cookies" class="section-name selfRef">Third-Party Cookies</a>
        </h3>
<p id="section-7.1-1">Particularly worrisome are so-called "third-party" cookies. In rendering an HTML
document, a user agent often requests resources from other servers (such as
advertising networks). These third-party servers can use cookies to track the
user even if the user never visits the server directly. For example, if a user
visits a site that contains content from a third party and then later visits
another site that contains content from the same third party, the third party
can track the user between the two sites.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">Given this risk to user privacy, some user agents restrict how third-party
cookies behave, and those restrictions vary widly. For instance, user agents
might block third-party cookies entirely by refusing to send Cookie header fields or
process Set-Cookie header fields during third-party requests. They might take a less
draconian approach by partitioning cookies based on the first-party context,
sending one set of cookies to a given third party in one first-party context,
and another to the same third party in another.<a href="#section-7.1-2" class="pilcrow">¶</a></p>
<p id="section-7.1-3">This document grants user agents wide latitude to experiment with third-party
cookie policies that balance the privacy and compatibility needs of their users.
However, this document does not endorse any particular third-party cookie
policy.<a href="#section-7.1-3" class="pilcrow">¶</a></p>
<p id="section-7.1-4">Third-party cookie blocking policies are often ineffective at achieving their
privacy goals if servers attempt to work around their restrictions to track
users. In particular, two collaborating servers can often track users without
using cookies at all by injecting identifying information into dynamic URLs.<a href="#section-7.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="cookie-policy">
<section id="section-7.2">
        <h3 id="name-cookie-policy">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-cookie-policy" class="section-name selfRef">Cookie policy</a>
        </h3>
<p id="section-7.2-1">User agents MAY enforce a cookie policy consisting of restrictions on how
cookies may be used or ignored (see <a href="#ignoring-cookies" class="xref">Section 5.3</a>).<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<p id="section-7.2-2">A cookie policy may govern which domains or parties, as in first and third parties
(see <a href="#third-party-cookies" class="xref">Section 7.1</a>), for which the user agent will allow cookie access.
The policy can also define limits on cookie size, cookie expiry, and the number
of cookies per domain or in total.<a href="#section-7.2-2" class="pilcrow">¶</a></p>
<p id="section-7.2-3">The goal of a restrictive cookie policy is often to improve security or privacy.
User agents often allow users to change the cookie policy (see <a href="#user-controls" class="xref">Section 7.3</a>).<a href="#section-7.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="user-controls">
<section id="section-7.3">
        <h3 id="name-user-controls">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-user-controls" class="section-name selfRef">User Controls</a>
        </h3>
<p id="section-7.3-1">User agents SHOULD provide users with a mechanism for managing the cookies
stored in the cookie store. For example, a user agent might let users delete
all cookies received during a specified time period or all the cookies related
to a particular domain. In addition, many user agents include a user interface
element that lets users examine the cookies stored in their cookie store.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
<p id="section-7.3-2">User agents SHOULD provide users with a mechanism for disabling cookies. When
cookies are disabled, the user agent MUST NOT include a Cookie header field in
outbound HTTP requests and the user agent MUST NOT process Set-Cookie header fields
in inbound HTTP responses.<a href="#section-7.3-2" class="pilcrow">¶</a></p>
<p id="section-7.3-3">User agents MAY offer a way to change the cookie policy (see
<a href="#cookie-policy" class="xref">Section 7.2</a>).<a href="#section-7.3-3" class="pilcrow">¶</a></p>
<p id="section-7.3-4">User agents MAY provide users the option of preventing persistent storage of
cookies across sessions. When configured thusly, user agents MUST treat all
received cookies as if the persistent-flag were set to false. Some popular
user agents expose this functionality via "private browsing" mode
<span>[<a href="#Aggarwal2010" class="xref">Aggarwal2010</a>]</span>.<a href="#section-7.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="expiration-dates">
<section id="section-7.4">
        <h3 id="name-expiration-dates">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-expiration-dates" class="section-name selfRef">Expiration Dates</a>
        </h3>
<p id="section-7.4-1">Although servers can set the expiration date for cookies to the distant future,
most user agents do not actually retain cookies for multiple decades. Rather
than choosing gratuitously long expiration periods, servers SHOULD promote user
privacy by selecting reasonable cookie expiration periods based on the purpose
of the cookie. For example, a typical session identifier might reasonably be
set to expire in two weeks.<a href="#section-7.4-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-8">
      <h2 id="name-security-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<div id="overview-1">
<section id="section-8.1">
        <h3 id="name-overview-2">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-overview-2" class="section-name selfRef">Overview</a>
        </h3>
<p id="section-8.1-1">Cookies have a number of security pitfalls. This section overviews a few of the
more salient issues.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<p id="section-8.1-2">In particular, cookies encourage developers to rely on ambient authority for
authentication, often becoming vulnerable to attacks such as cross-site request
forgery <span>[<a href="#CSRF" class="xref">CSRF</a>]</span>. Also, when storing session identifiers in cookies, developers
often create session fixation vulnerabilities.<a href="#section-8.1-2" class="pilcrow">¶</a></p>
<p id="section-8.1-3">Transport-layer encryption, such as that employed in HTTPS, is insufficient to
prevent a network attacker from obtaining or altering a victim's cookies because
the cookie protocol itself has various vulnerabilities (see "Weak Confidentiality"
and "Weak Integrity", below). In addition, by default, cookies do not provide
confidentiality or integrity from network attackers, even when used in conjunction
with HTTPS.<a href="#section-8.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ambient-authority">
<section id="section-8.2">
        <h3 id="name-ambient-authority">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-ambient-authority" class="section-name selfRef">Ambient Authority</a>
        </h3>
<p id="section-8.2-1">A server that uses cookies to authenticate users can suffer security
vulnerabilities because some user agents let remote parties issue HTTP requests
from the user agent (e.g., via HTTP redirects or HTML forms). When issuing
those requests, user agents attach cookies even if the remote party does not
know the contents of the cookies, potentially letting the remote party exercise
authority at an unwary server.<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<p id="section-8.2-2">Although this security concern goes by a number of names (e.g., cross-site
request forgery, confused deputy), the issue stems from cookies being a form of
ambient authority. Cookies encourage server operators to separate designation
(in the form of URLs) from authorization (in the form of cookies).
Consequently, the user agent might supply the authorization for a resource
designated by the attacker, possibly causing the server or its clients to
undertake actions designated by the attacker as though they were authorized by
the user.<a href="#section-8.2-2" class="pilcrow">¶</a></p>
<p id="section-8.2-3">Instead of using cookies for authorization, server operators might wish to
consider entangling designation and authorization by treating URLs as
capabilities. Instead of storing secrets in cookies, this approach stores
secrets in URLs, requiring the remote entity to supply the secret itself.
Although this approach is not a panacea, judicious application of these
principles can lead to more robust security.<a href="#section-8.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="clear-text">
<section id="section-8.3">
        <h3 id="name-clear-text">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-clear-text" class="section-name selfRef">Clear Text</a>
        </h3>
<p id="section-8.3-1">Unless sent over a secure channel (such as TLS), the information in the Cookie
and Set-Cookie header fields is transmitted in the clear.<a href="#section-8.3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-8.3-2">
<li id="section-8.3-2.1">All sensitive information conveyed in these header fields is exposed to an
eavesdropper.<a href="#section-8.3-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-8.3-2.2">A malicious intermediary could alter the header fields as they travel in either
direction, with unpredictable results.<a href="#section-8.3-2.2" class="pilcrow">¶</a>
</li>
          <li id="section-8.3-2.3">A malicious client could alter the Cookie header fields before transmission,
with unpredictable results.<a href="#section-8.3-2.3" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-8.3-3">Servers SHOULD encrypt and sign the contents of cookies (using whatever format
the server desires) when transmitting them to the user agent (even when sending
the cookies over a secure channel). However, encrypting and signing cookie
contents does not prevent an attacker from transplanting a cookie from one user
agent to another or from replaying the cookie at a later time.<a href="#section-8.3-3" class="pilcrow">¶</a></p>
<p id="section-8.3-4">In addition to encrypting and signing the contents of every cookie, servers that
require a higher level of security SHOULD use the Cookie and Set-Cookie
header fields only over a secure channel. When using cookies over a secure channel,
servers SHOULD set the Secure attribute (see <a href="#attribute-secure" class="xref">Section 4.1.2.5</a>) for every
cookie. If a server does not set the Secure attribute, the protection
provided by the secure channel will be largely moot.<a href="#section-8.3-4" class="pilcrow">¶</a></p>
<p id="section-8.3-5">For example, consider a webmail server that stores a session identifier in a
cookie and is typically accessed over HTTPS. If the server does not set the
Secure attribute on its cookies, an active network attacker can intercept any
outbound HTTP request from the user agent and redirect that request to the
webmail server over HTTP. Even if the webmail server is not listening for HTTP
connections, the user agent will still include cookies in the request. The
active network attacker can intercept these cookies, replay them against the
server, and learn the contents of the user's email. If, instead, the server had
set the Secure attribute on its cookies, the user agent would not have
included the cookies in the clear-text request.<a href="#section-8.3-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="session-identifiers">
<section id="section-8.4">
        <h3 id="name-session-identifiers">
<a href="#section-8.4" class="section-number selfRef">8.4. </a><a href="#name-session-identifiers" class="section-name selfRef">Session Identifiers</a>
        </h3>
<p id="section-8.4-1">Instead of storing session information directly in a cookie (where it might be
exposed to or replayed by an attacker), servers commonly store a nonce (or
"session identifier") in a cookie. When the server receives an HTTP request
with a nonce, the server can look up state information associated with the
cookie using the nonce as a key.<a href="#section-8.4-1" class="pilcrow">¶</a></p>
<p id="section-8.4-2">Using session identifier cookies limits the damage an attacker can cause if the
attacker learns the contents of a cookie because the nonce is useful only for
interacting with the server (unlike non-nonce cookie content, which might itself
be sensitive). Furthermore, using a single nonce prevents an attacker from
"splicing" together cookie content from two interactions with the server, which
could cause the server to behave unexpectedly.<a href="#section-8.4-2" class="pilcrow">¶</a></p>
<p id="section-8.4-3">Using session identifiers is not without risk. For example, the server SHOULD
take care to avoid "session fixation" vulnerabilities. A session fixation attack
proceeds in three steps. First, the attacker transplants a session identifier
from his or her user agent to the victim's user agent. Second, the victim uses
that session identifier to interact with the server, possibly imbuing the
session identifier with the user's credentials or confidential information.
Third, the attacker uses the session identifier to interact with server
directly, possibly obtaining the user's authority or confidential information.<a href="#section-8.4-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="weak-confidentiality">
<section id="section-8.5">
        <h3 id="name-weak-confidentiality">
<a href="#section-8.5" class="section-number selfRef">8.5. </a><a href="#name-weak-confidentiality" class="section-name selfRef">Weak Confidentiality</a>
        </h3>
<p id="section-8.5-1">Cookies do not provide isolation by port. If a cookie is readable by a service
running on one port, the cookie is also readable by a service running on another
port of the same server. If a cookie is writable by a service on one port, the
cookie is also writable by a service running on another port of the same server.
For this reason, servers SHOULD NOT both run mutually distrusting services on
different ports of the same host and use cookies to store security-sensitive
information.<a href="#section-8.5-1" class="pilcrow">¶</a></p>
<p id="section-8.5-2">Cookies do not provide isolation by scheme. Although most commonly used with
the http and https schemes, the cookies for a given host might also be
available to other schemes, such as ftp and gopher. Although this lack of
isolation by scheme is most apparent in non-HTTP APIs that permit access to
cookies (e.g., HTML's document.cookie API), the lack of isolation by scheme
is actually present in requirements for processing cookies themselves (e.g.,
consider retrieving a URI with the gopher scheme via HTTP).<a href="#section-8.5-2" class="pilcrow">¶</a></p>
<p id="section-8.5-3">Cookies do not always provide isolation by path. Although the network-level
protocol does not send cookies stored for one path to another, some user
agents expose cookies via non-HTTP APIs, such as HTML's document.cookie API.
Because some of these user agents (e.g., web browsers) do not isolate resources
received from different paths, a resource retrieved from one path might be able
to access cookies stored for another path.<a href="#section-8.5-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="weak-integrity">
<section id="section-8.6">
        <h3 id="name-weak-integrity">
<a href="#section-8.6" class="section-number selfRef">8.6. </a><a href="#name-weak-integrity" class="section-name selfRef">Weak Integrity</a>
        </h3>
<p id="section-8.6-1">Cookies do not provide integrity guarantees for sibling domains (and their
subdomains). For example, consider foo.site.example and bar.site.example. The
foo.site.example server can set a cookie with a Domain attribute of
"site.example" (possibly overwriting an existing "site.example" cookie set by
bar.site.example), and the user agent will include that cookie in HTTP requests
to bar.site.example. In the worst case, bar.site.example will be unable to
distinguish this cookie from a cookie it set itself. The foo.site.example
server might be able to leverage this ability to mount an attack against
bar.site.example.<a href="#section-8.6-1" class="pilcrow">¶</a></p>
<p id="section-8.6-2">Even though the Set-Cookie header field supports the Path attribute, the Path
attribute does not provide any integrity protection because the user agent
will accept an arbitrary Path attribute in a Set-Cookie header field. For
example, an HTTP response to a request for http://site.example/foo/bar can set
a cookie with a Path attribute of "/qux". Consequently, servers SHOULD NOT
both run mutually distrusting services on different paths of the same host and
use cookies to store security-sensitive information.<a href="#section-8.6-2" class="pilcrow">¶</a></p>
<p id="section-8.6-3">An active network attacker can also inject cookies into the Cookie header field
sent to https://site.example/ by impersonating a response from
http://site.example/ and injecting a Set-Cookie header field. The HTTPS server
at site.example will be unable to distinguish these cookies from cookies that
it set itself in an HTTPS response. An active network attacker might be able
to leverage this ability to mount an attack against site.example even if
site.example uses HTTPS exclusively.<a href="#section-8.6-3" class="pilcrow">¶</a></p>
<p id="section-8.6-4">Servers can partially mitigate these attacks by encrypting and signing the
contents of their cookies. However, using cryptography does not mitigate the
issue completely because an attacker can replay a cookie he or she received from
the authentic site.example server in the user's session, with unpredictable
results.<a href="#section-8.6-4" class="pilcrow">¶</a></p>
<p id="section-8.6-5">Finally, an attacker might be able to force the user agent to delete cookies by
storing a large number of cookies. Once the user agent reaches its storage
limit, the user agent will be forced to evict some cookies. Servers SHOULD NOT
rely upon user agents retaining cookies.<a href="#section-8.6-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="reliance-on-dns">
<section id="section-8.7">
        <h3 id="name-reliance-on-dns">
<a href="#section-8.7" class="section-number selfRef">8.7. </a><a href="#name-reliance-on-dns" class="section-name selfRef">Reliance on DNS</a>
        </h3>
<p id="section-8.7-1">Cookies rely upon the Domain Name System (DNS) for security. If the DNS is
partially or fully compromised, the cookie protocol might fail to provide the
security properties required by applications.<a href="#section-8.7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="samesite-cookies">
<section id="section-8.8">
        <h3 id="name-samesite-cookies">
<a href="#section-8.8" class="section-number selfRef">8.8. </a><a href="#name-samesite-cookies" class="section-name selfRef">SameSite Cookies</a>
        </h3>
<div id="defense-in-depth">
<section id="section-8.8.1">
          <h4 id="name-defense-in-depth">
<a href="#section-8.8.1" class="section-number selfRef">8.8.1. </a><a href="#name-defense-in-depth" class="section-name selfRef">Defense in depth</a>
          </h4>
<p id="section-8.8.1-1">"SameSite" cookies offer a robust defense against CSRF attack when deployed in
strict mode, and when supported by the client. It is, however, prudent to ensure
that this designation is not the extent of a site's defense against CSRF, as
same-site navigations and submissions can certainly be executed in conjunction
with other attack vectors such as cross-site scripting.<a href="#section-8.8.1-1" class="pilcrow">¶</a></p>
<p id="section-8.8.1-2">Developers are strongly encouraged to deploy the usual server-side defenses
(CSRF tokens, ensuring that "safe" HTTP methods are idempotent, etc) to mitigate
the risk more fully.<a href="#section-8.8.1-2" class="pilcrow">¶</a></p>
<p id="section-8.8.1-3">Additionally, client-side techniques such as those described in
<span>[<a href="#app-isolation" class="xref">app-isolation</a>]</span> may also prove effective against CSRF, and are certainly worth
exploring in combination with "SameSite" cookies.<a href="#section-8.8.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="top-level-navigations">
<section id="section-8.8.2">
          <h4 id="name-top-level-navigations">
<a href="#section-8.8.2" class="section-number selfRef">8.8.2. </a><a href="#name-top-level-navigations" class="section-name selfRef">Top-level Navigations</a>
          </h4>
<p id="section-8.8.2-1">Setting the <code>SameSite</code> attribute in "strict" mode provides robust defense in
depth against CSRF attacks, but has the potential to confuse users unless sites'
developers carefully ensure that their cookie-based session management systems
deal reasonably well with top-level navigations.<a href="#section-8.8.2-1" class="pilcrow">¶</a></p>
<p id="section-8.8.2-2">Consider the scenario in which a user reads their email at MegaCorp Inc's
webmail provider <code>https://site.example/</code>. They might expect that clicking on an
emailed link to <code>https://projects.example/secret/project</code> would show them the
secret project that they're authorized to see, but if <code>https://projects.example</code>
has marked their session cookies as <code>SameSite=Strict</code>, then this cross-site
navigation won't send them along with the request. <code>https://projects.example</code>
will render a 404 error to avoid leaking secret information, and the user will
be quite confused.<a href="#section-8.8.2-2" class="pilcrow">¶</a></p>
<p id="section-8.8.2-3">Developers can avoid this confusion by adopting a session management system that
relies on not one, but two cookies: one conceptually granting "read" access,
another granting "write" access. The latter could be marked as <code>SameSite=Strict</code>,
and its absence would prompt a reauthentication step before executing any
non-idempotent action. The former could be marked as <code>SameSite=Lax</code>, in
order to allow users access to data via top-level navigation, or
<code>SameSite=None</code>, to permit access in all contexts (including cross-site
embedded contexts).<a href="#section-8.8.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="mashups-and-widgets">
<section id="section-8.8.3">
          <h4 id="name-mashups-and-widgets">
<a href="#section-8.8.3" class="section-number selfRef">8.8.3. </a><a href="#name-mashups-and-widgets" class="section-name selfRef">Mashups and Widgets</a>
          </h4>
<p id="section-8.8.3-1">The <code>Lax</code> and <code>Strict</code> values for the <code>SameSite</code> attribute are inappropriate
for some important use-cases. In particular, note that content intended for
embedding in cross-site contexts (social networking widgets or commenting
services, for instance) will not have access to same-site cookies. Cookies
which are required in these situations should be marked with <code>SameSite=None</code>
to allow access in cross-site contexts.<a href="#section-8.8.3-1" class="pilcrow">¶</a></p>
<p id="section-8.8.3-2">Likewise, some forms of Single-Sign-On might require cookie-based authentication
in a cross-site context; these mechanisms will not function as intended with
same-site cookies and will also require <code>SameSite=None</code>.<a href="#section-8.8.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="server-controlled">
<section id="section-8.8.4">
          <h4 id="name-server-controlled">
<a href="#section-8.8.4" class="section-number selfRef">8.8.4. </a><a href="#name-server-controlled" class="section-name selfRef">Server-controlled</a>
          </h4>
<p id="section-8.8.4-1">SameSite cookies in and of themselves don't do anything to address the
general privacy concerns outlined in Section 7.1 of <span>[<a href="#RFC6265" class="xref">RFC6265</a>]</span>. The "SameSite"
attribute is set by the server, and serves to mitigate the risk of certain kinds
of attacks that the server is worried about. The user is not involved in this
decision. Moreover, a number of side-channels exist which could allow a server
to link distinct requests even in the absence of cookies (for example, connection
and/or socket pooling between same-site and cross-site requests).<a href="#section-8.8.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="reload-navigations">
<section id="section-8.8.5">
          <h4 id="name-reload-navigations">
<a href="#section-8.8.5" class="section-number selfRef">8.8.5. </a><a href="#name-reload-navigations" class="section-name selfRef">Reload navigations</a>
          </h4>
<p id="section-8.8.5-1">Requests issued for reloads triggered through user interface elements (such as a
refresh button on a toolbar) are same-site only if the reloaded document was
originally navigated to via a same-site request. This differs from the handling
of other reload navigations, which are always same-site if top-level, since the
source browsing context's active document is precisely the document being
reloaded.<a href="#section-8.8.5-1" class="pilcrow">¶</a></p>
<p id="section-8.8.5-2">This special handling of reloads triggered through a user interface element
avoids sending <code>SameSite</code> cookies on user-initiated reloads if they were
withheld on the original navigation (i.e., if the initial navigation were
cross-site). If the reload navigation were instead considered same-site, and
sent all the initially withheld <code>SameSite</code> cookies, the security benefits of
withholding the cookies in the first place would be nullified. This is
especially important given that the absence of <code>SameSite</code> cookies withheld on a
cross-site navigation request may lead to visible site breakage, prompting the
user to trigger a reload.<a href="#section-8.8.5-2" class="pilcrow">¶</a></p>
<p id="section-8.8.5-3">For example, suppose the user clicks on a link from <code>https://attacker.example/</code>
to <code>https://victim.example/</code>. This is a cross-site request, so <code>SameSite=Strict</code>
cookies are withheld. Suppose this causes <code>https://victim.example/</code> to appear
broken, because the site only displays its sensitive content if a particular
<code>SameSite</code> cookie is present in the request. The user, frustrated by the
unexpectedly broken site, presses refresh on their browser's toolbar. To now
consider the reload request same-site and send the initially withheld <code>SameSite</code>
cookie would defeat the purpose of withholding it in the first place, as the
reload navigation triggered through the user interface may replay the original
(potentially malicious) request. Thus, the reload request should be considered
cross-site, like the request that initially navigated to the page.<a href="#section-8.8.5-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="unsafe-top-level-requests">
<section id="section-8.8.6">
          <h4 id="name-top-level-requests-with-uns">
<a href="#section-8.8.6" class="section-number selfRef">8.8.6. </a><a href="#name-top-level-requests-with-uns" class="section-name selfRef">Top-level requests with "unsafe" methods</a>
          </h4>
<p id="section-8.8.6-1">The "Lax" enforcement mode described in <a href="#strict-lax" class="xref">Section 5.4.7.1</a> allows a cookie to be
sent with a cross-site HTTP request if and only if it is a top-level navigation
with a "safe" HTTP method. Implementation experience shows that this is
difficult to apply as the default behavior, as some sites may rely on cookies
not explicitly specifying a <code>SameSite</code> attribute being included on top-level
cross-site requests with "unsafe" HTTP methods (as was the case prior to the
introduction of the <code>SameSite</code> attribute).<a href="#section-8.8.6-1" class="pilcrow">¶</a></p>
<p id="section-8.8.6-2">For example, a login flow may involve a cross-site top-level <code>POST</code> request to
an endpoint which expects a cookie with login information. For such a cookie,
"Lax" enforcement is not appropriate, as it would cause the cookie to be
excluded due to the unsafe HTTP request method. On the other hand, "None"
enforcement would allow the cookie to be sent with all cross-site requests,
which may not be desirable due to the cookie's sensitive contents.<a href="#section-8.8.6-2" class="pilcrow">¶</a></p>
<p id="section-8.8.6-3">The "Lax-allowing-unsafe" enforcement mode described in <a href="#lax-allowing-unsafe" class="xref">Section 5.4.7.2</a>
retains some of the protections of "Lax" enforcement (as compared to "None")
while still allowing cookies to be sent cross-site with unsafe top-level
requests.<a href="#section-8.8.6-3" class="pilcrow">¶</a></p>
<p id="section-8.8.6-4">As a more permissive variant of "Lax" mode, "Lax-allowing-unsafe" mode
necessarily provides fewer protections against CSRF. Ultimately, the provision
of such an enforcement mode should be seen as a temporary, transitional measure
to ease adoption of "Lax" enforcement by default.<a href="#section-8.8.6-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-9">
      <h2 id="name-iana-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<div id="iana-cookie">
<section id="section-9.1">
        <h3 id="name-cookie-2">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-cookie-2" class="section-name selfRef">Cookie</a>
        </h3>
<p id="section-9.1-1">The permanent message header field registry (see <span>[<a href="#RFC3864" class="xref">RFC3864</a>]</span>) needs to be
updated with the following registration:<a href="#section-9.1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-9.1-2">
          <dt id="section-9.1-2.1">
Header field name:  </dt>
          <dd style="margin-left: 1.5em" id="section-9.1-2.2">
            <p id="section-9.1-2.2.1">Cookie<a href="#section-9.1-2.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-9.1-2.3">
Applicable protocol:  </dt>
          <dd style="margin-left: 1.5em" id="section-9.1-2.4">
            <p id="section-9.1-2.4.1">http<a href="#section-9.1-2.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-9.1-2.5">
Status:  </dt>
          <dd style="margin-left: 1.5em" id="section-9.1-2.6">
            <p id="section-9.1-2.6.1">standard<a href="#section-9.1-2.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-9.1-2.7">
Author/Change controller:  </dt>
          <dd style="margin-left: 1.5em" id="section-9.1-2.8">
            <p id="section-9.1-2.8.1">IETF<a href="#section-9.1-2.8.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-9.1-2.9">
Specification document:  </dt>
          <dd style="margin-left: 1.5em" id="section-9.1-2.10">
            <p id="section-9.1-2.10.1">this specification (<a href="#cookie" class="xref">Section 5.6.1</a>)<a href="#section-9.1-2.10.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="iana-set-cookie">
<section id="section-9.2">
        <h3 id="name-set-cookie-2">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-set-cookie-2" class="section-name selfRef">Set-Cookie</a>
        </h3>
<p id="section-9.2-1">The permanent message header field registry (see <span>[<a href="#RFC3864" class="xref">RFC3864</a>]</span>) needs to be
updated with the following registration:<a href="#section-9.2-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-9.2-2">
          <dt id="section-9.2-2.1">
Header field name:  </dt>
          <dd style="margin-left: 1.5em" id="section-9.2-2.2">
            <p id="section-9.2-2.2.1">Set-Cookie<a href="#section-9.2-2.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-9.2-2.3">
Applicable protocol:  </dt>
          <dd style="margin-left: 1.5em" id="section-9.2-2.4">
            <p id="section-9.2-2.4.1">http<a href="#section-9.2-2.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-9.2-2.5">
Status:  </dt>
          <dd style="margin-left: 1.5em" id="section-9.2-2.6">
            <p id="section-9.2-2.6.1">standard<a href="#section-9.2-2.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-9.2-2.7">
Author/Change controller:  </dt>
          <dd style="margin-left: 1.5em" id="section-9.2-2.8">
            <p id="section-9.2-2.8.1">IETF<a href="#section-9.2-2.8.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-9.2-2.9">
Specification document:  </dt>
          <dd style="margin-left: 1.5em" id="section-9.2-2.10">
            <p id="section-9.2-2.10.1">this specification (<a href="#set-cookie" class="xref">Section 5.4</a>)<a href="#section-9.2-2.10.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="cookie-attribute-registry">
<section id="section-9.3">
        <h3 id="name-cookie-attribute-registry">
<a href="#section-9.3" class="section-number selfRef">9.3. </a><a href="#name-cookie-attribute-registry" class="section-name selfRef">Cookie Attribute Registry</a>
        </h3>
<p id="section-9.3-1">IANA is requested to create the "Cookie Attribute Registry", defining the
name space of attribute used to control cookies' behavior.
The registry should be maintained at
<a href="https://www.iana.org/assignments/cookie-attribute-names">https://www.iana.org/assignments/cookie-attribute-names</a>.<a href="#section-9.3-1" class="pilcrow">¶</a></p>
<div id="procedure">
<section id="section-9.3.1">
          <h4 id="name-procedure">
<a href="#section-9.3.1" class="section-number selfRef">9.3.1. </a><a href="#name-procedure" class="section-name selfRef">Procedure</a>
          </h4>
<p id="section-9.3.1-1">Each registered attribute name is associated with a description, and a
reference detailing how the attribute is to be processed and stored.<a href="#section-9.3.1-1" class="pilcrow">¶</a></p>
<p id="section-9.3.1-2">New registrations happen on a "RFC Required" basis (see Section 4.7 of
<span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>). The attribute to be registered MUST match the <code>extension-av</code>
syntax defined in <a href="#abnf-syntax" class="xref">Section 4.1.1</a>. Note that attribute names are generally
defined in CamelCase, but technically accepted case-insensitively.<a href="#section-9.3.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="registration">
<section id="section-9.3.2">
          <h4 id="name-registration">
<a href="#section-9.3.2" class="section-number selfRef">9.3.2. </a><a href="#name-registration" class="section-name selfRef">Registration</a>
          </h4>
<p id="section-9.3.2-1">The "Cookie Attribute Registry" should be created with the registrations below:<a href="#section-9.3.2-1" class="pilcrow">¶</a></p>
<table class="center" id="table-1">
            <caption><a href="#table-1" class="selfRef">Table 1</a></caption>
<thead>
              <tr>
                <th class="text-right" rowspan="1" colspan="1">Name</th>
                <th class="text-left" rowspan="1" colspan="1">Reference</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-right" rowspan="1" colspan="1">Domain</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#attribute-domain" class="xref">Section 4.1.2.3</a> of this document</td>
              </tr>
              <tr>
                <td class="text-right" rowspan="1" colspan="1">Expires</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#attribute-expires" class="xref">Section 4.1.2.1</a> of this document</td>
              </tr>
              <tr>
                <td class="text-right" rowspan="1" colspan="1">HttpOnly</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#attribute-httponly" class="xref">Section 4.1.2.6</a> of this document</td>
              </tr>
              <tr>
                <td class="text-right" rowspan="1" colspan="1">Max-Age</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#attribute-max-age" class="xref">Section 4.1.2.2</a> of this document</td>
              </tr>
              <tr>
                <td class="text-right" rowspan="1" colspan="1">Path</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#attribute-path" class="xref">Section 4.1.2.4</a> of this document</td>
              </tr>
              <tr>
                <td class="text-right" rowspan="1" colspan="1">SameSite</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#attribute-samesite" class="xref">Section 4.1.2.7</a> of this document</td>
              </tr>
              <tr>
                <td class="text-right" rowspan="1" colspan="1">Secure</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#attribute-secure" class="xref">Section 4.1.2.5</a> of this document</td>
              </tr>
            </tbody>
          </table>
</section>
</div>
</section>
</div>
</section>
</div>
<section id="section-10">
      <h2 id="name-references">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-10.1">
        <h3 id="name-normative-references">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="DOM-DOCUMENT-COOKIE">[DOM-DOCUMENT-COOKIE]</dt>
        <dd>
<span class="refAuthor">WHATWG</span>, <span class="refTitle">"HTML - Living Standard"</span>, <time datetime="2021-05-18" class="refDate">18 May 2021</time>, <span>&lt;<a href="https://html.spec.whatwg.org/#dom-document-cookie">https://html.spec.whatwg.org/#dom-document-cookie</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="FETCH">[FETCH]</dt>
        <dd>
<span class="refAuthor">van Kesteren, A.</span>, <span class="refTitle">"Fetch"</span>, <span>n.d.</span>, <span>&lt;<a href="https://fetch.spec.whatwg.org/">https://fetch.spec.whatwg.org/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="HTML">[HTML]</dt>
        <dd>
<span class="refAuthor">Hickson, I.</span>, <span class="refAuthor">Pieters, S.</span>, <span class="refAuthor">van Kesteren, A.</span>, <span class="refAuthor">Jägenstedt, P.</span>, and <span class="refAuthor">D. Denicola</span>, <span class="refTitle">"HTML"</span>, <span>n.d.</span>, <span>&lt;<a href="https://html.spec.whatwg.org/">https://html.spec.whatwg.org/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="HTTPSEM">[HTTPSEM]</dt>
        <dd>
<span class="refAuthor">Fielding, R. T.</span>, <span class="refAuthor">Nottingham, M.</span>, and <span class="refAuthor">J. Reschke</span>, <span class="refTitle">"HTTP Semantics"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-httpbis-semantics-16</span>, <time datetime="2021-05-27" class="refDate">27 May 2021</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-httpbis-semantics-16">https://tools.ietf.org/html/draft-ietf-httpbis-semantics-16</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1034">[RFC1034]</dt>
        <dd>
<span class="refAuthor">Mockapetris, P.</span>, <span class="refTitle">"Domain names - concepts and facilities"</span>, <span class="seriesInfo">STD 13</span>, <span class="seriesInfo">RFC 1034</span>, <span class="seriesInfo">DOI 10.17487/RFC1034</span>, <time datetime="1987-11" class="refDate">November 1987</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc1034">https://www.rfc-editor.org/rfc/rfc1034</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1123">[RFC1123]</dt>
        <dd>
<span class="refAuthor">Braden, R., Ed.</span>, <span class="refTitle">"Requirements for Internet Hosts - Application and Support"</span>, <span class="seriesInfo">STD 3</span>, <span class="seriesInfo">RFC 1123</span>, <span class="seriesInfo">DOI 10.17487/RFC1123</span>, <time datetime="1989-10" class="refDate">October 1989</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc1123">https://www.rfc-editor.org/rfc/rfc1123</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3490">[RFC3490]</dt>
        <dd>
<span class="refAuthor">Costello, A.</span>, <span class="refTitle">"Internationalizing Domain Names in Applications (IDNA)"</span>, <span class="seriesInfo">RFC 3490</span>, <time datetime="2003-03" class="refDate">March 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc3490">https://www.rfc-editor.org/rfc/rfc3490</a>&gt;</span>. <span class="annotation">See <a href="#idna-migration" class="xref">Section 6.3</a> for an explanation why the normative reference to an obsoleted specification is needed.</span>
        </dd>
<dd class="break"></dd>
<dt id="RFC4790">[RFC4790]</dt>
        <dd>
<span class="refAuthor">Newman, C.</span>, <span class="refAuthor">Duerst, M.</span>, and <span class="refAuthor">A. Gulbrandsen</span>, <span class="refTitle">"Internet Application Protocol Collation Registry"</span>, <span class="seriesInfo">RFC 4790</span>, <span class="seriesInfo">DOI 10.17487/RFC4790</span>, <time datetime="2007-03" class="refDate">March 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4790">https://www.rfc-editor.org/rfc/rfc4790</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5234">[RFC5234]</dt>
        <dd>
<span class="refAuthor">Crocker, D., Ed.</span> and <span class="refAuthor">P. Overell</span>, <span class="refTitle">"Augmented BNF for Syntax Specifications: ABNF"</span>, <span class="seriesInfo">STD 68</span>, <span class="seriesInfo">RFC 5234</span>, <span class="seriesInfo">DOI 10.17487/RFC5234</span>, <time datetime="2008-01" class="refDate">January 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5234">https://www.rfc-editor.org/rfc/rfc5234</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5890">[RFC5890]</dt>
        <dd>
<span class="refAuthor">Klensin, J.</span>, <span class="refTitle">"Internationalized Domain Names for Applications (IDNA): Definitions and Document Framework"</span>, <span class="seriesInfo">RFC 5890</span>, <span class="seriesInfo">DOI 10.17487/RFC5890</span>, <time datetime="2010-08" class="refDate">August 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5890">https://www.rfc-editor.org/rfc/rfc5890</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6454">[RFC6454]</dt>
        <dd>
<span class="refAuthor">Barth, A.</span>, <span class="refTitle">"The Web Origin Concept"</span>, <span class="seriesInfo">RFC 6454</span>, <span class="seriesInfo">DOI 10.17487/RFC6454</span>, <time datetime="2011-12" class="refDate">December 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6454">https://www.rfc-editor.org/rfc/rfc6454</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8126">https://www.rfc-editor.org/rfc/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SAMESITE">[SAMESITE]</dt>
        <dd>
<span class="refAuthor">WHATWG</span>, <span class="refTitle">"HTML - Living Standard"</span>, <time datetime="2021-01-26" class="refDate">26 January 2021</time>, <span>&lt;<a href="https://html.spec.whatwg.org/#same-site">https://html.spec.whatwg.org/#same-site</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SERVICE-WORKERS">[SERVICE-WORKERS]</dt>
        <dd>
<span class="refAuthor">Russell, A.</span>, <span class="refAuthor">Song, J.</span>, and <span class="refAuthor">J. Archibald</span>, <span class="refTitle">"Service Workers"</span>, <span>n.d.</span>, <span>&lt;<a href="http://www.w3.org/TR/service-workers/">http://www.w3.org/TR/service-workers/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="USASCII">[USASCII]</dt>
      <dd>
<span class="refAuthor">American National Standards Institute</span>, <span class="refTitle">"Coded Character Set -- 7-bit American Standard Code for Information Interchange"</span>, <span class="seriesInfo">ANSI X3.4</span>, <time datetime="1986" class="refDate">1986</time>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-10.2">
        <h3 id="name-informative-references">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="Aggarwal2010">[Aggarwal2010]</dt>
        <dd>
<span class="refAuthor">Aggarwal, G.</span>, <span class="refAuthor">Burzstein, E.</span>, <span class="refAuthor">Jackson, C.</span>, and <span class="refAuthor">D. Boneh</span>, <span class="refTitle">"An Analysis of Private Browsing Modes in Modern Browsers"</span>, <time datetime="2010" class="refDate">2010</time>, <span>&lt;<a href="http://www.usenix.org/events/sec10/tech/full_papers/Aggarwal.pdf">http://www.usenix.org/events/sec10/tech/full_papers/Aggarwal.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="app-isolation">[app-isolation]</dt>
        <dd>
<span class="refAuthor">Chen, E.</span>, <span class="refAuthor">Bau, J.</span>, <span class="refAuthor">Reis, C.</span>, <span class="refAuthor">Barth, A.</span>, and <span class="refAuthor">C. Jackson</span>, <span class="refTitle">"App Isolation - Get the Security of Multiple Browsers with Just One"</span>, <time datetime="2011" class="refDate">2011</time>, <span>&lt;<a href="http://www.collinjackson.com/research/papers/appisolation.pdf">http://www.collinjackson.com/research/papers/appisolation.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="CSRF">[CSRF]</dt>
        <dd>
<span class="refAuthor">Barth, A.</span>, <span class="refAuthor">Jackson, C.</span>, and <span class="refAuthor">J. Mitchell</span>, <span class="refTitle">"Robust Defenses for Cross-Site Request Forgery"</span>, <span class="seriesInfo">DOI 10.1145/1455770.1455782</span>, <span class="seriesInfo">ISBN 978-1-59593-810-7</span>, <span class="seriesInfo">ACM CCS '08: Proceedings of the 15th ACM conference on Computer and communications security (pages 75-88)</span>, <time datetime="2008-10" class="refDate">October 2008</time>, <span>&lt;<a href="http://portal.acm.org/citation.cfm?id=1455770.1455782">http://portal.acm.org/citation.cfm?id=1455770.1455782</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-httpbis-cookie-alone">[I-D.ietf-httpbis-cookie-alone]</dt>
        <dd>
<span class="refAuthor">West, M.</span>, <span class="refTitle">"Deprecate modification of 'secure' cookies from non-secure origins"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-httpbis-cookie-alone-01</span>, <time datetime="2016-09-05" class="refDate">5 September 2016</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-httpbis-cookie-alone-01">https://tools.ietf.org/html/draft-ietf-httpbis-cookie-alone-01</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-httpbis-cookie-prefixes">[I-D.ietf-httpbis-cookie-prefixes]</dt>
        <dd>
<span class="refAuthor">West, M.</span>, <span class="refTitle">"Cookie Prefixes"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-httpbis-cookie-prefixes-00</span>, <time datetime="2016-02-23" class="refDate">23 February 2016</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-httpbis-cookie-prefixes-00">https://tools.ietf.org/html/draft-ietf-httpbis-cookie-prefixes-00</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-httpbis-cookie-same-site">[I-D.ietf-httpbis-cookie-same-site]</dt>
        <dd>
<span class="refAuthor">West, M.</span> and <span class="refAuthor">M. Goodwin</span>, <span class="refTitle">"Same-Site Cookies"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-httpbis-cookie-same-site-00</span>, <time datetime="2016-06-20" class="refDate">20 June 2016</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-httpbis-cookie-same-site-00">https://tools.ietf.org/html/draft-ietf-httpbis-cookie-same-site-00</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="prerendering">[prerendering]</dt>
        <dd>
<span class="refAuthor">Bentzel, C.</span>, <span class="refTitle">"Chrome Prerendering"</span>, <span>n.d.</span>, <span>&lt;<a href="https://www.chromium.org/developers/design-documents/prerender">https://www.chromium.org/developers/design-documents/prerender</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="PSL">[PSL]</dt>
        <dd>
<span class="refTitle">"Public Suffix List"</span>, <span>n.d.</span>, <span>&lt;<a href="https://publicsuffix.org/list/">https://publicsuffix.org/list/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2818">[RFC2818]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"HTTP Over TLS"</span>, <span class="seriesInfo">RFC 2818</span>, <span class="seriesInfo">DOI 10.17487/RFC2818</span>, <time datetime="2000-05" class="refDate">May 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2818">https://www.rfc-editor.org/rfc/rfc2818</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3629">[RFC3629]</dt>
        <dd>
<span class="refAuthor">Yergeau, F.</span>, <span class="refTitle">"UTF-8, a transformation format of ISO 10646"</span>, <span class="seriesInfo">STD 63</span>, <span class="seriesInfo">RFC 3629</span>, <span class="seriesInfo">DOI 10.17487/RFC3629</span>, <time datetime="2003-11" class="refDate">November 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc3629">https://www.rfc-editor.org/rfc/rfc3629</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3864">[RFC3864]</dt>
        <dd>
<span class="refAuthor">Klyne, G.</span>, <span class="refAuthor">Nottingham, M.</span>, and <span class="refAuthor">J. Mogul</span>, <span class="refTitle">"Registration Procedures for Message Header Fields"</span>, <span class="seriesInfo">BCP 90</span>, <span class="seriesInfo">RFC 3864</span>, <span class="seriesInfo">DOI 10.17487/RFC3864</span>, <time datetime="2004-09" class="refDate">September 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc3864">https://www.rfc-editor.org/rfc/rfc3864</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3986">[RFC3986]</dt>
        <dd>
<span class="refAuthor">Berners-Lee, T.</span>, <span class="refAuthor">Fielding, R.</span>, and <span class="refAuthor">L. Masinter</span>, <span class="refTitle">"Uniform Resource Identifier (URI): Generic Syntax"</span>, <span class="seriesInfo">STD 66</span>, <span class="seriesInfo">RFC 3986</span>, <span class="seriesInfo">DOI 10.17487/RFC3986</span>, <time datetime="2005-01" class="refDate">January 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc3986">https://www.rfc-editor.org/rfc/rfc3986</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4648">[RFC4648]</dt>
        <dd>
<span class="refAuthor">Josefsson, S.</span>, <span class="refTitle">"The Base16, Base32, and Base64 Data Encodings"</span>, <span class="seriesInfo">RFC 4648</span>, <span class="seriesInfo">DOI 10.17487/RFC4648</span>, <time datetime="2006-10" class="refDate">October 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4648">https://www.rfc-editor.org/rfc/rfc4648</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5895">[RFC5895]</dt>
        <dd>
<span class="refAuthor">Resnick, P.</span> and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Mapping Characters for Internationalized Domain Names in Applications (IDNA) 2008"</span>, <span class="seriesInfo">RFC 5895</span>, <span class="seriesInfo">DOI 10.17487/RFC5895</span>, <time datetime="2010-09" class="refDate">September 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5895">https://www.rfc-editor.org/rfc/rfc5895</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6265">[RFC6265]</dt>
        <dd>
<span class="refAuthor">Barth, A.</span>, <span class="refTitle">"HTTP State Management Mechanism"</span>, <span class="seriesInfo">RFC 6265</span>, <span class="seriesInfo">DOI 10.17487/RFC6265</span>, <time datetime="2011-04" class="refDate">April 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6265">https://www.rfc-editor.org/rfc/rfc6265</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7034">[RFC7034]</dt>
        <dd>
<span class="refAuthor">Ross, D.</span> and <span class="refAuthor">T. Gondrom</span>, <span class="refTitle">"HTTP Header Field X-Frame-Options"</span>, <span class="seriesInfo">RFC 7034</span>, <span class="seriesInfo">DOI 10.17487/RFC7034</span>, <time datetime="2013-10" class="refDate">October 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7034">https://www.rfc-editor.org/rfc/rfc7034</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="UTS46">[UTS46]</dt>
      <dd>
<span class="refAuthor">Davis, M.</span> and <span class="refAuthor">M. Suignard</span>, <span class="refTitle">"Unicode IDNA Compatibility Processing"</span>, <span class="seriesInfo">UNICODE Unicode Technical Standards # 46</span>, <time datetime="2016-06" class="refDate">June 2016</time>, <span>&lt;<a href="http://unicode.org/reports/tr46/">http://unicode.org/reports/tr46/</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="changes">
<section id="section-appendix.a">
      <h2 id="name-changes">
<a href="#section-appendix.a" class="section-number selfRef">Appendix A. </a><a href="#name-changes" class="section-name selfRef">Changes</a>
      </h2>
<div id="draft-ietf-httpbis-rfc6265bis-00">
<section id="section-a.1">
        <h2 id="name-draft-ietf-httpbis-rfc6265b">
<a href="#section-a.1" class="section-number selfRef">A.1. </a><a href="#name-draft-ietf-httpbis-rfc6265b" class="section-name selfRef">draft-ietf-httpbis-rfc6265bis-00</a>
        </h2>
<ul class="normal">
<li class="normal" id="section-a.1-1.1">Port <span>[<a href="#RFC6265" class="xref">RFC6265</a>]</span> to Markdown. No (intentional) normative changes.<a href="#section-a.1-1.1" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="draft-ietf-httpbis-rfc6265bis-01">
<section id="section-a.2">
        <h2 id="name-draft-ietf-httpbis-rfc6265bi">
<a href="#section-a.2" class="section-number selfRef">A.2. </a><a href="#name-draft-ietf-httpbis-rfc6265bi" class="section-name selfRef">draft-ietf-httpbis-rfc6265bis-01</a>
        </h2>
<ul class="normal">
<li class="normal" id="section-a.2-1.1">
            <p id="section-a.2-1.1.1">Fixes to formatting caused by mistakes in the initial port to Markdown:<a href="#section-a.2-1.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-a.2-1.1.2.1">
                <a href="https://github.com/httpwg/http-extensions/issues/243">https://github.com/httpwg/http-extensions/issues/243</a><a href="#section-a.2-1.1.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-a.2-1.1.2.2">
                <a href="https://github.com/httpwg/http-extensions/issues/246">https://github.com/httpwg/http-extensions/issues/246</a><a href="#section-a.2-1.1.2.2" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-a.2-1.2">Addresses errata 3444 by updating the <code>path-value</code> and <code>extension-av</code>
grammar, errata 4148 by updating the <code>day-of-month</code>, <code>year</code>, and <code>time</code>
grammar, and errata 3663 by adding the requested note.
<a href="https://www.rfc-editor.org/errata_search.php?rfc=6265">https://www.rfc-editor.org/errata_search.php?rfc=6265</a><a href="#section-a.2-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.2-1.3">Dropped <code>Cookie2</code> and <code>Set-Cookie2</code> from the IANA Considerations section:
<a href="https://github.com/httpwg/http-extensions/issues/247">https://github.com/httpwg/http-extensions/issues/247</a><a href="#section-a.2-1.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.2-1.4">Merged the recommendations from <span>[<a href="#I-D.ietf-httpbis-cookie-alone" class="xref">I-D.ietf-httpbis-cookie-alone</a>]</span>, removing
the ability for a non-secure origin to set cookies with a 'secure' flag, and
to overwrite cookies whose 'secure' flag is true.<a href="#section-a.2-1.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.2-1.5">Merged the recommendations from <span>[<a href="#I-D.ietf-httpbis-cookie-prefixes" class="xref">I-D.ietf-httpbis-cookie-prefixes</a>]</span>, adding
<code>__Secure-</code> and <code>__Host-</code> cookie name prefix processing instructions.<a href="#section-a.2-1.5" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="draft-ietf-httpbis-rfc6265bis-02">
<section id="section-a.3">
        <h2 id="name-draft-ietf-httpbis-rfc6265bis">
<a href="#section-a.3" class="section-number selfRef">A.3. </a><a href="#name-draft-ietf-httpbis-rfc6265bis" class="section-name selfRef">draft-ietf-httpbis-rfc6265bis-02</a>
        </h2>
<ul class="normal">
<li class="normal" id="section-a.3-1.1">Merged the recommendations from <span>[<a href="#I-D.ietf-httpbis-cookie-same-site" class="xref">I-D.ietf-httpbis-cookie-same-site</a>]</span>, adding
support for the <code>SameSite</code> attribute.<a href="#section-a.3-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.3-1.2">
            <p id="section-a.3-1.2.1">Closed a number of editorial bugs:<a href="#section-a.3-1.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-a.3-1.2.2.1">Clarified address bar behavior for SameSite cookies:
<a href="https://github.com/httpwg/http-extensions/issues/201">https://github.com/httpwg/http-extensions/issues/201</a><a href="#section-a.3-1.2.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-a.3-1.2.2.2">Added the word "Cookies" to the document's name:
<a href="https://github.com/httpwg/http-extensions/issues/204">https://github.com/httpwg/http-extensions/issues/204</a><a href="#section-a.3-1.2.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-a.3-1.2.2.3">Clarified that the <code>__Host-</code> prefix requires an explicit <code>Path</code> attribute:
<a href="https://github.com/httpwg/http-extensions/issues/222">https://github.com/httpwg/http-extensions/issues/222</a><a href="#section-a.3-1.2.2.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-a.3-1.2.2.4">Expanded the options for dealing with third-party cookies to include a
brief mention of partitioning based on first-party:
<a href="https://github.com/httpwg/http-extensions/issues/248">https://github.com/httpwg/http-extensions/issues/248</a><a href="#section-a.3-1.2.2.4" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-a.3-1.2.2.5">Noted that double-quotes in cookie values are part of the value, and are
not stripped: <a href="https://github.com/httpwg/http-extensions/issues/295">https://github.com/httpwg/http-extensions/issues/295</a><a href="#section-a.3-1.2.2.5" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-a.3-1.2.2.6">Fixed the "site for cookies" algorithm to return something that makes
sense: <a href="https://github.com/httpwg/http-extensions/issues/302">https://github.com/httpwg/http-extensions/issues/302</a><a href="#section-a.3-1.2.2.6" class="pilcrow">¶</a>
</li>
            </ul>
</li>
        </ul>
</section>
</div>
<div id="draft-ietf-httpbis-rfc6265bis-03">
<section id="section-a.4">
        <h2 id="name-draft-ietf-httpbis-rfc6265bis-">
<a href="#section-a.4" class="section-number selfRef">A.4. </a><a href="#name-draft-ietf-httpbis-rfc6265bis-" class="section-name selfRef">draft-ietf-httpbis-rfc6265bis-03</a>
        </h2>
<ul class="normal">
<li class="normal" id="section-a.4-1.1">Clarified handling of invalid SameSite values:
<a href="https://github.com/httpwg/http-extensions/issues/389">https://github.com/httpwg/http-extensions/issues/389</a><a href="#section-a.4-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.4-1.2">Reflect widespread implementation practice of including a cookie's
<code>host-only-flag</code> when calculating its uniqueness:
<a href="https://github.com/httpwg/http-extensions/issues/199">https://github.com/httpwg/http-extensions/issues/199</a><a href="#section-a.4-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.4-1.3">Introduced an explicit "None" value for the SameSite attribute:
<a href="https://github.com/httpwg/http-extensions/issues/788">https://github.com/httpwg/http-extensions/issues/788</a><a href="#section-a.4-1.3" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="draft-ietf-httpbis-rfc6265bis-04">
<section id="section-a.5">
        <h2 id="name-draft-ietf-httpbis-rfc6265bis-0">
<a href="#section-a.5" class="section-number selfRef">A.5. </a><a href="#name-draft-ietf-httpbis-rfc6265bis-0" class="section-name selfRef">draft-ietf-httpbis-rfc6265bis-04</a>
        </h2>
<ul class="normal">
<li class="normal" id="section-a.5-1.1">Allow <code>SameSite</code> cookies to be set for all top-level navigations.
<a href="https://github.com/httpwg/http-extensions/issues/594">https://github.com/httpwg/http-extensions/issues/594</a><a href="#section-a.5-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.5-1.2">Treat <code>Set-Cookie: token</code> as creating the cookie <code>("", "token")</code>:
<a href="https://github.com/httpwg/http-extensions/issues/159">https://github.com/httpwg/http-extensions/issues/159</a><a href="#section-a.5-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.5-1.3">Reject cookies with neither name nor value (e.g. <code>Set-Cookie: =</code> and
<code>Set-Cookie:</code>:  <a href="https://github.com/httpwg/http-extensions/issues/159">https://github.com/httpwg/http-extensions/issues/159</a><a href="#section-a.5-1.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.5-1.4">Clarified behavior of multiple <code>SameSite</code> attributes in a cookie string:
<a href="https://github.com/httpwg/http-extensions/issues/901">https://github.com/httpwg/http-extensions/issues/901</a><a href="#section-a.5-1.4" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="draft-ietf-httpbis-rfc6265bis-05">
<section id="section-a.6">
        <h2 id="name-draft-ietf-httpbis-rfc6265bis-05">
<a href="#section-a.6" class="section-number selfRef">A.6. </a><a href="#name-draft-ietf-httpbis-rfc6265bis-05" class="section-name selfRef">draft-ietf-httpbis-rfc6265bis-05</a>
        </h2>
<ul class="normal">
<li class="normal" id="section-a.6-1.1">Typos and editorial fixes:
<a href="https://github.com/httpwg/http-extensions/pull/1035">https://github.com/httpwg/http-extensions/pull/1035</a>,
<a href="https://github.com/httpwg/http-extensions/pull/1038">https://github.com/httpwg/http-extensions/pull/1038</a>,
<a href="https://github.com/httpwg/http-extensions/pull/1040">https://github.com/httpwg/http-extensions/pull/1040</a>,
<a href="https://github.com/httpwg/http-extensions/pull/1047">https://github.com/httpwg/http-extensions/pull/1047</a>.<a href="#section-a.6-1.1" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="draft-ietf-httpbis-rfc6265bis-06">
<section id="section-a.7">
        <h2 id="name-draft-ietf-httpbis-rfc6265bis-06">
<a href="#section-a.7" class="section-number selfRef">A.7. </a><a href="#name-draft-ietf-httpbis-rfc6265bis-06" class="section-name selfRef">draft-ietf-httpbis-rfc6265bis-06</a>
        </h2>
<ul class="normal">
<li class="normal" id="section-a.7-1.1">Editorial fixes: <a href="https://github.com/httpwg/http-extensions/issues/1059">https://github.com/httpwg/http-extensions/issues/1059</a>,
<a href="https://github.com/httpwg/http-extensions/issues/1158">https://github.com/httpwg/http-extensions/issues/1158</a>.<a href="#section-a.7-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.7-1.2">Created a registry for cookie attribute names:
<a href="https://github.com/httpwg/http-extensions/pull/1060">https://github.com/httpwg/http-extensions/pull/1060</a>.<a href="#section-a.7-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.7-1.3">Tweaks to ABNF for <code>cookie-pair</code> and the <code>Cookie</code> header
production: <a href="https://github.com/httpwg/http-extensions/issues/1074">https://github.com/httpwg/http-extensions/issues/1074</a>,
<a href="https://github.com/httpwg/http-extensions/issues/1119">https://github.com/httpwg/http-extensions/issues/1119</a>.<a href="#section-a.7-1.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.7-1.4">Fixed serialization for nameless/valueless cookies:
<a href="https://github.com/httpwg/http-extensions/pull/1143">https://github.com/httpwg/http-extensions/pull/1143</a>.<a href="#section-a.7-1.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.7-1.5">Converted a normative reference to Mozilla's Public Suffix List <span>[<a href="#PSL" class="xref">PSL</a>]</span> into
an informative reference:
<a href="https://github.com/httpwg/http-extensions/issues/1159">https://github.com/httpwg/http-extensions/issues/1159</a>.<a href="#section-a.7-1.5" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="draft-ietf-httpbis-rfc6265bis-07">
<section id="section-a.8">
        <h2 id="name-draft-ietf-httpbis-rfc6265bis-07">
<a href="#section-a.8" class="section-number selfRef">A.8. </a><a href="#name-draft-ietf-httpbis-rfc6265bis-07" class="section-name selfRef">draft-ietf-httpbis-rfc6265bis-07</a>
        </h2>
<ul class="normal">
<li class="normal" id="section-a.8-1.1">Moved instruction to ignore cookies with empty cookie-name and cookie-value
from <a href="#set-cookie" class="xref">Section 5.4</a> to <a href="#storage-model" class="xref">Section 5.5</a> to ensure that they apply to cookies
created without parsing a cookie string:
<a href="https://github.com/httpwg/http-extensions/issues/1234">https://github.com/httpwg/http-extensions/issues/1234</a>.<a href="#section-a.8-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.8-1.2">Add a default enforcement value to the <code>same-site-flag</code>, equivalent to
"SameSite=Lax":
<a href="https://github.com/httpwg/http-extensions/pull/1325">https://github.com/httpwg/http-extensions/pull/1325</a>.<a href="#section-a.8-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.8-1.3">Require a Secure attribute for "SameSite=None":
<a href="https://github.com/httpwg/http-extensions/pull/1323">https://github.com/httpwg/http-extensions/pull/1323</a>.<a href="#section-a.8-1.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.8-1.4">Consider scheme when running the same-site algorithm:
 <a href="https://github.com/httpwg/http-extensions/pull/1324">https://github.com/httpwg/http-extensions/pull/1324</a>.<a href="#section-a.8-1.4" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="draft-ietf-httpbis-rfc6265bis-08">
<section id="section-a.9">
        <h2 id="name-draft-ietf-httpbis-rfc6265bis-08">
<a href="#section-a.9" class="section-number selfRef">A.9. </a><a href="#name-draft-ietf-httpbis-rfc6265bis-08" class="section-name selfRef">draft-ietf-httpbis-rfc6265bis-08</a>
        </h2>
<ul class="normal">
<li class="normal" id="section-a.9-1.1">Define "same-site" for reload navigation requests, e.g. those triggered via
user interface elements:
<a href="https://github.com/httpwg/http-extensions/pull/1384">https://github.com/httpwg/http-extensions/pull/1384</a><a href="#section-a.9-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.9-1.2">Consider redirects when defining same-site:
<a href="https://github.com/httpwg/http-extensions/pull/1348">https://github.com/httpwg/http-extensions/pull/1348</a><a href="#section-a.9-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.9-1.3">Align on using HTML terminology for origins:
<a href="https://github.com/httpwg/http-extensions/pull/1416">https://github.com/httpwg/http-extensions/pull/1416</a><a href="#section-a.9-1.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.9-1.4">Modify cookie parsing and creation algorithms in <a href="#set-cookie" class="xref">Section 5.4</a> and
<a href="#storage-model" class="xref">Section 5.5</a> to explicitly handle control characters:
<a href="https://github.com/httpwg/http-extensions/pull/1420">https://github.com/httpwg/http-extensions/pull/1420</a><a href="#section-a.9-1.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.9-1.5">Refactor cookie retrieval algorithm to support non-HTTP APIs:
<a href="https://github.com/httpwg/http-extensions/pull/1428">https://github.com/httpwg/http-extensions/pull/1428</a><a href="#section-a.9-1.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.9-1.6">Define "Lax-allowing-unsafe" SameSite enforcement mode:
<a href="https://github.com/httpwg/http-extensions/pull/1435">https://github.com/httpwg/http-extensions/pull/1435</a><a href="#section-a.9-1.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.9-1.7">Consistently use "header field" (vs 'header"):
<a href="https://github.com/httpwg/http-extensions/pull/1527">https://github.com/httpwg/http-extensions/pull/1527</a><a href="#section-a.9-1.7" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="acknowledgements">
<section id="section-appendix.b">
      <h2 id="name-acknowledgements">
<a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="section-appendix.b-1">RFC 6265 was written by Adam Barth. This document is an update of RFC 6265,
adding features and aligning the specification with the reality of today's
deployments. Here, we're standing upon the shoulders of a giant since the
majority of the text is still Adam's.<a href="#section-appendix.b-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="section-appendix.c">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Lily Chen (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">Google LLC</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:chlily@google.com" class="email">chlily@google.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Steven Englehardt (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">Mozilla</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:senglehardt@mozilla.com" class="email">senglehardt@mozilla.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Mike West (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">Google LLC</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:mkwst@google.com" class="email">mkwst@google.com</a>
</div>
<div class="url">
<span>URI:</span>
<a href="https://mikewest.org/" class="url">https://mikewest.org/</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">John Wilander (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">Apple, Inc</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:wilander@apple.com" class="email">wilander@apple.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
