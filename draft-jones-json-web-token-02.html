<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>JSON Web Token (JWT)</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.2" rel="Chapter" title="2 Terminology">
<link href="#rfc.section.3" rel="Chapter" title="3 JSON Web Token (JWT) Overview">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 Example JWT">
<link href="#rfc.section.4" rel="Chapter" title="4 JWT Claims">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 Reserved Claim Names">
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 Public Claim Names">
<link href="#rfc.section.4.3" rel="Chapter" title="4.3 Private Claim Names">
<link href="#rfc.section.5" rel="Chapter" title="5 JWT Header">
<link href="#rfc.section.6" rel="Chapter" title="6 Rules for Creating and Validating a JWT">
<link href="#rfc.section.7" rel="Chapter" title="7 Base64url encoding as used by JWTs">
<link href="#rfc.section.8" rel="Chapter" title="8 Signing JWTs with Cryptographic Algorithms">
<link href="#rfc.section.9" rel="Chapter" title="9 IANA Considerations">
<link href="#rfc.section.10" rel="Chapter" title="10 Security Considerations">
<link href="#rfc.section.10.1" rel="Chapter" title="10.1 Unicode Comparison Security Issues">
<link href="#rfc.section.11" rel="Chapter" title="11 Open Issues and Things To Be Done (TBD)">
<link href="#rfc.references" rel="Chapter" title="12 References">
<link href="#rfc.references.1" rel="Chapter" title="12.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="12.2 Informative References">
<link href="#rfc.appendix.Appendix%20A" rel="Chapter" title="Appendix A JWT Examples">
<link href="#rfc.appendix.Appendix%20A.1" rel="Chapter" title="Appendix A.1 JWT using HMAC SHA-256">
<link href="#rfc.appendix.Appendix%20A.2" rel="Chapter" title="Appendix A.2 JWT using RSA SHA-256">
<link href="#rfc.appendix.Appendix%20A.3" rel="Chapter" title="Appendix A.3 JWT using ECDSA P-256 SHA-256">
<link href="#rfc.appendix.Appendix%20B" rel="Chapter" title="Appendix B Notes on implementing base64url encoding without padding">
<link href="#rfc.appendix.Appendix%20C" rel="Chapter" title="Appendix C Relationship of JWTs to SAML Tokens">
<link href="#rfc.appendix.Appendix%20D" rel="Chapter" title="Appendix D Relationship of JWTs to Simple Web Tokens (SWTs)">
<link href="#rfc.appendix.Appendix%20E" rel="Chapter" title="Appendix E Acknowledgements">
<link href="#rfc.appendix.Appendix%20F" rel="Chapter" title="Appendix F Document History">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="JSON Web Token (JWT) is a means of representing claims to be transferred between two parties.  The claims in a JWT are encoded as a JSON object that is digitally signed using a JSON Web Signature (JWS) and optionally encrypted using JSON Web Encryption (JWE).  " />
  <meta name="description" content="JSON Web Token (JWT) is a means of representing claims to be transferred between two parties.  The claims in a JWT are encoded as a JSON object that is digitally signed using a JSON Web Signature (JWS) and optionally encrypted using JSON Web Encryption (JWE).  " />
  <meta name="keywords" content="RFC, Request for Comments, I-D, Internet-Draft, Assertion, Claim, Simple Web Token, Security Token, SWT, JavaScript Object Notation, JSON, JSON Web Token, JWT, JSON Web Signature, JWS, JSON Web Encryption, JWE" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Network Working Group</td>
<td class="right">M.B. Jones</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Microsoft</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">D. Balfanz</td>
</tr>
<tr>
<td class="left">Expires: September 29, 2011</td>
<td class="right">Google</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">J. Bradley</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">independent</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Y.Y. Goland</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Microsoft</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">J. Panzer</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Google</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">N. Sakimura</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Nomura Research Institute</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">P. Tarjan</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Facebook</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">March 28, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">JSON Web Token (JWT)<br />
  <span class="filename">draft-jones-json-web-token-02</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>JSON Web Token (JWT) is a means of representing claims to be transferred between two parties.  The claims in a JWT are encoded as a JSON object that is digitally signed using a JSON Web Signature (JWS) and optionally encrypted using JSON Web Encryption (JWE).  </p>
<p>The suggested pronunciation of JWT is the same as the English word "jot".  </p>
<h1><a>Requirements Language</a></h1>
<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">RFC 2119</a> <cite title="NONE">[RFC2119]</cite>.  </p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on September 29, 2011.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>2.   <a href="#rfc.section.2">Terminology</a>
</li>
<li>3.   <a href="#rfc.section.3">JSON Web Token (JWT) Overview</a>
</li>
<li>3.1.   <a href="#rfc.section.3.1">Example JWT</a>
</li>
<li>4.   <a href="#rfc.section.4">JWT Claims</a>
</li>
<li>4.1.   <a href="#rfc.section.4.1">Reserved Claim Names</a>
</li>
<li>4.2.   <a href="#rfc.section.4.2">Public Claim Names</a>
</li>
<li>4.3.   <a href="#rfc.section.4.3">Private Claim Names</a>
</li>
<li>5.   <a href="#rfc.section.5">JWT Header</a>
</li>
<li>6.   <a href="#rfc.section.6">Rules for Creating and Validating a JWT</a>
</li>
<li>7.   <a href="#rfc.section.7">Base64url encoding as used by JWTs</a>
</li>
<li>8.   <a href="#rfc.section.8">Signing JWTs with Cryptographic Algorithms</a>
</li>
<li>9.   <a href="#rfc.section.9">IANA Considerations</a>
</li>
<li>10.   <a href="#rfc.section.10">Security Considerations</a>
</li>
<li>10.1.   <a href="#rfc.section.10.1">Unicode Comparison Security Issues</a>
</li>
<li>11.   <a href="#rfc.section.11">Open Issues and Things To Be Done (TBD)</a>
</li>
<li>12.   <a href="#rfc.references">References</a>
</li>
<li>12.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>12.2.   <a href="#rfc.references.2">Informative References</a>
</li>
<li>Appendix A.   <a href="#rfc.appendix.Appendix%20A">JWT Examples</a>
</li>
<li>Appendix A.1.   <a href="#rfc.appendix.Appendix%20A.1">JWT using HMAC SHA-256</a>
</li>
<li>Appendix A.2.   <a href="#rfc.appendix.Appendix%20A.2">JWT using RSA SHA-256</a>
</li>
<li>Appendix A.3.   <a href="#rfc.appendix.Appendix%20A.3">JWT using ECDSA P-256 SHA-256</a>
</li>
<li>Appendix B.   <a href="#rfc.appendix.Appendix%20B">Notes on implementing base64url encoding without padding</a>
</li>
<li>Appendix C.   <a href="#rfc.appendix.Appendix%20C">Relationship of JWTs to SAML Tokens</a>
</li>
<li>Appendix D.   <a href="#rfc.appendix.Appendix%20D">Relationship of JWTs to Simple Web Tokens (SWTs)</a>
</li>
<li>Appendix E.   <a href="#rfc.appendix.Appendix%20E">Acknowledgements</a>
</li>
<li>Appendix F.   <a href="#rfc.appendix.Appendix%20F">Document History</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> Introduction</h1>
<p id="rfc.section.1.p.1">JSON Web Token (JWT) is a compact token format intended for space constrained environments such as HTTP Authorization headers and URI query parameters. JWTs encode claims to be transmitted as a JSON object (as defined in <a href="#RFC4627">RFC 4627</a> <cite title="NONE">[RFC4627]</cite>) that is base64url encoded and digitally signed.  Signing is accomplished using a JSON Web Signature (JWS) <a href="#JWS">[JWS]</a>.  JWTs may also be optionally encrypted using JSON Web Encryption (JWE) <a href="#JWE">[JWE]</a>.  </p>
<p id="rfc.section.1.p.2">The suggested pronunciation of JWT is the same as the English word "jot".  </p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> Terminology</h1>
<p></p>

<dl>
<dt>JSON Web Token (JWT)</dt>
<dd style="margin-left: 8">A string consisting of three JWT Token Segments: the JWT Header Segment, the JWT Claim Segment, and the JWT Crypto Segment, in that order, with the segments being separated by period ('.') characters.  </dd>
<dt>JWT Token Segment</dt>
<dd style="margin-left: 8">One of the three parts that make up a JSON Web Token (JWT).  JWT Token Segments are always base64url encoded values.  </dd>
<dt>JWT Header Segment</dt>
<dd style="margin-left: 8">A JWT Token Segment containing a base64url encoded JSON object that describes the cryptographic operations applied to the JWT Header Segment and the JWT Claim Segment.  The JWT Header Segment is the JWS Header Input for creating a JSON Web Signature (JWS) <a href="#JWS">[JWS]</a> for the JWT.  </dd>
<dt>JWT Claim Segment</dt>
<dd style="margin-left: 8">A JWT Token Segment containing a base64url encoded JSON object that encodes the claims contained in the JWT.  The JWT Claim Segment is the JWS Payload Input for creating a JSON Web Signature (JWS) <a href="#JWS">[JWS]</a> for the JWT.  </dd>
<dt>JWT Crypto Segment</dt>
<dd style="margin-left: 8">A JWT Token Segment containing base64url encoded cryptographic material that secures the contents of the JWT Header Segment and the JWT Claim Segment.  The JWT Crypto Segment is the JWS Crypto Output for a JSON Web Signature (JWS) <a href="#JWS">[JWS]</a> created for the JWT.  </dd>
<dt>Decoded JWT Header Segment</dt>
<dd style="margin-left: 8">A JWT Header Segment that has been base64url decoded back into a JSON object.  </dd>
<dt>Decoded JWT Claim Segment</dt>
<dd style="margin-left: 8">A JWT Claim Segment that has been base64url decoded back into a JSON object.  </dd>
<dt>Decoded JWT Crypto Segment</dt>
<dd style="margin-left: 8">A JWT Crypto Segment that has been base64url decoded back into cryptographic material.  </dd>
<dt>Claim Names</dt>
<dd style="margin-left: 8">The names of the members of the JSON object represented in a JWT Claim Segment.  </dd>
<dt>Claim Values</dt>
<dd style="margin-left: 8">The values of the members of the JSON object represented in a JWT Claim Segment.  </dd>
<dt>Base64url Encoding</dt>
<dd style="margin-left: 8">For the purposes of this specification, this term always refers to the he URL- and filename-safe Base64 encoding described in <a href="#RFC4648">RFC 4648</a> <cite title="NONE">[RFC4648]</cite>, Section 5, with the '=' padding characters omitted, as permitted by Section 3.2.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> JSON Web Token (JWT) Overview</h1>
<p id="rfc.section.3.p.1">JWTs represent a set of claims as a JSON object that is base64url encoded and digitally signed and optionally encrypted.  As per <a href="#RFC4627">RFC 4627</a> <cite title="NONE">[RFC4627]</cite> Section 2.2, the JSON object consists of zero or more name/value pairs (or members), where the names are strings and the values are arbitrary JSON values.  These members are the claims represented by the JWT.  The JSON object is base64url encoded to produce the JWT Claim Segment.  </p>
<p id="rfc.section.3.p.2">The names within the JSON object MUST be unique.  These names are referred to as Claim Names.  The corresponding values are referred to as Claim Values.  </p>
<p id="rfc.section.3.p.3">The JWT Claim Object is signed in the manner described in JSON Web Signature (JWS) <a href="#JWS">[JWS]</a> and optionally encrypted in the manner described in JSON Web Encryption (JWE) <a href="#JWE">[JWE]</a>.  The JWT Claim Object is the JWS Payload Input.  The JWT Header Object is the JWS Header Input.  The JWT Crypto Segment is the corresponding JWS Crypto Output.  </p>
<p id="rfc.section.3.p.4">A JWT is represented as the concatenation of the JWT Header Segment, the JWT Claim Segment, and the JWT Crypto Segment, in that order, with the segments being separated by period ('.') characters.  </p>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> <a href="#ExampleJWT" id="ExampleJWT">Example JWT</a>
</h1>
<p id="rfc.section.3.1.p.1">The following is an example of a JSON object that can be encoded to produce a JWT Claim Segment: </p>
<p id="rfc.section.3.1.p.2">Base64url encoding the UTF-8 representation of the JSON object yields this JWT Claim Segment: </p>
<p id="rfc.section.3.1.p.3">The following example JSON header object declares that the encoded object is a JSON Web Token (JWT) and the JWT Header Segment and the JWT Claim Segment are signed using the HMAC SHA-256 algorithm: </p>
<p id="rfc.section.3.1.p.4">Base64url encoding the UTF-8 representation of the JSON header object yields this JWT Header Segment value: </p>
<p id="rfc.section.3.1.p.5">Signing the UTF-8 representation of the JWT Header Segment and JWT Claim Segment with the HMAC SHA-256 algorithm and base64url encoding the result, as per <a href="#HMACSHA256Example">Appendix Appendix A.1</a>, in the manner specified in <a href="#JWS">[JWS]</a>, yields this JWT Crypto Segment value: </p>
<p id="rfc.section.3.1.p.6">Concatenating these segments in the order Header.Claims.Signature with period characters between the segments yields this complete JWT (with line breaks for display purposes only): </p>
<p id="rfc.section.3.1.p.7">This computation is illustrated in more detail in <a href="#HMACSHA256Example">Appendix Appendix A.1</a>.  </p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> JWT Claims</h1>
<p id="rfc.section.4.p.1">A JWT contains a set of claims represented as a base64url encoded JSON object. Note however, that the set of claims a JWT must contain to be considered valid is context-dependent and is outside the scope of this specification.  When used in a security-related context, implementations MUST understand and support all of the claims present; otherwise, the JWT MUST be rejected for processing.  </p>
<p id="rfc.section.4.p.2">There are three classes of JWT Claim Names: Reserved Claim Names, Public Claim Names, and Private Claim Names.  </p>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> <a href="#ReservedClaimName" id="ReservedClaimName">Reserved Claim Names</a>
</h1>
<p id="rfc.section.4.1.p.1">The following claim names are reserved. None of the claims defined in the table below are intended to be mandatory, but rather, provide a starting point for a set of useful, interoperable claims.  All the names are short because a core goal of JWTs is for the tokens to be compact.  </p>
<div id="#rfc.table.1"></div>
<div id="#ClaimTable"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<caption>Reserved Claim Definitions</caption>
<thead><tr>
<th class="left">Claim Name</th>
<th class="left">JSON Value Type</th>
<th class="left">Claim Syntax</th>
<th class="left">Claim Semantics</th>
</tr></thead>
<tbody>
<tr>
<td class="left">exp</td>
<td class="left">integer</td>
<td class="left">IntDate</td>
<td class="left">The <samp>exp</samp> (expiration time) claim identifies the expiration time on or after which the token MUST NOT be accepted for processing.  The processing of the <samp>exp</samp> claim requires that the current date/time MUST be before the expiration date/time listed in the <samp>exp</samp> claim. Implementers MAY provide for some small leeway, usually no more than a few minutes, to account for clock skew.  This claim is OPTIONAL.  </td>
</tr>
<tr>
<td class="left">iss</td>
<td class="left">string</td>
<td class="left">StringAndURI</td>
<td class="left">The <samp>iss</samp> (issuer) claim identifies the principal that issued the JWT.  The processing of this claim is generally application specific.  This claim is OPTIONAL.  </td>
</tr>
<tr>
<td class="left">aud</td>
<td class="left">string</td>
<td class="left">StringAndURI</td>
<td class="left">The <samp>aud</samp> (audience) claim identifies the audience that the JWT is intended for.  The principal intended to process the JWT MUST be identified by the value of the audience claim. If the principal processing the claim does not identify itself with the identifier in the <samp>aud</samp> claim value then the JWT MUST be rejected.  The interpretation of the contents of the audience value is generally application specific.  This claim is OPTIONAL.  </td>
</tr>
<tr>
<td class="left">typ</td>
<td class="left">string</td>
<td class="left">String</td>
<td class="left">The <samp>typ</samp> (type) claim is used to declare a type for the contents of this JWT.  This claim is OPTIONAL.  </td>
</tr>
</tbody>
</table>
<p id="rfc.section.4.1.p.2">Additional reserved claim names MAY be defined via the IANA JSON Web Token Claims registry, as per <a href="#IANA">Section 9</a>.  The syntax values used above are defined as follows: </p>
<div id="#rfc.table.2"></div>
<div id="#SyntaxDefinitions"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<caption>Claim Syntax Definitions</caption>
<thead><tr>
<th class="left">Syntax Name</th>
<th class="left">Syntax Definition</th>
</tr></thead>
<tbody>
<tr>
<td class="left">IntDate</td>
<td class="left">The number of seconds from 1970-01-01T0:0:0Z as measured in UTC until the desired date/time. See <a href="#RFC3339">RFC 3339</a> <cite title="NONE">[RFC3339]</cite> for details regarding date/times in general and UTC in particular.  </td>
</tr>
<tr>
<td class="left">String</td>
<td class="left">Any string value MAY be used.  </td>
</tr>
<tr>
<td class="left">StringAndURI</td>
<td class="left">Any string value MAY be used but a value containing a ":" character MUST be a URI as defined in <a href="#RFC3986">RFC 3986</a> <cite title="NONE">[RFC3986]</cite>.  </td>
</tr>
</tbody>
</table>
<h1 id="rfc.section.4.2">
<a href="#rfc.section.4.2">4.2.</a> <a href="#PublicClaimName" id="PublicClaimName">Public Claim Names</a>
</h1>
<p id="rfc.section.4.2.p.1">Claim names can be defined at will by those using JWTs. However, in order to prevent collisions, any new claim name SHOULD either be defined in the IANA JSON Web Token Claims registry or be defined as a URI that contains a collision resistant namespace. Examples of collision resistant namespaces include: </p>

<ul>
<li>Domain Names, </li>
<li>Object Identifiers (OIDs) as defined in the ITU-T X 660 and X 670 Recommendation series or </li>
<li>Universally Unique IDentifier (UUID) as defined in <a href="#RFC4122">RFC 4122</a> <cite title="NONE">[RFC4122]</cite>.  </li>
</ul>

<p> In each case, the definer of the name or value MUST take reasonable precautions to make sure they are in control of the part of the namespace they use to define the claim name.</p>
<h1 id="rfc.section.4.3">
<a href="#rfc.section.4.3">4.3.</a> <a href="#PrivateClaimName" id="PrivateClaimName">Private Claim Names</a>
</h1>
<p id="rfc.section.4.3.p.1">A producer and consumer of a JWT may agree to any claim name that is not a Reserved Name <a href="#ReservedClaimName">Section 4.1</a> or a Public Name <a href="#PublicClaimName">Section 4.2</a>. Unlike Public Names, these private names are subject to collision and should be used with caution.  </p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> JWT Header</h1>
<p id="rfc.section.5.p.1">The members of the JSON object represented by the Decoded JWT Header Segment describe the cryptographic operations applied to the JWT Header Segment and the JWT Claim Segment and optionally, additional properties of the JWT.  The JWT Header Segment is used as the JWS Header Input for signing.  The format of the header and the cryptographic operations applied MUST be as specified in JSON Web Signature (JWS) <a href="#JWS">[JWS]</a> and JSON Web Encryption (JWE) <a href="#JWE">[JWE]</a>.  </p>
<p id="rfc.section.5.p.2">Implementations MUST understand the entire contents of the header; otherwise, the JWT MUST be rejected for processing.  </p>
<p id="rfc.section.5.p.3">JWS Header Parameters are defined by <a href="#JWS">[JWS]</a>.  This specification further specifies the use of the following header parameters when the JWS Header Input is a JWT Header Segment.  </p>
<div id="#rfc.table.3"></div>
<div id="#HeaderParameterTable"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<caption>Reserved Header Parameter Usage</caption>
<thead><tr>
<th class="left">Header Parameter Name</th>
<th class="left">JSON Value Type</th>
<th class="left">Header Parameter Syntax</th>
<th class="left">Header Parameter Semantics</th>
</tr></thead>
<tbody><tr>
<td class="left">typ</td>
<td class="left">string</td>
<td class="left">String</td>
<td class="left">The <samp>typ</samp> (type) header parameter MAY be used to declare that this data structure is a JWT.  If a <samp>typ</samp> parameter is present, it is RECOMMENDED that its value be "JWT".  Use of this header parameter is OPTIONAL.  </td>
</tr></tbody>
</table>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> Rules for Creating and Validating a JWT</h1>
<p id="rfc.section.6.p.1">To create a JWT, one MUST follow these steps: </p>

<ol>
<li>Create a JSON object containing the desired claims.  Note that white space is explicitly allowed in the representation and no canonicalization is performed before encoding.  </li>
<li>Translate this JSON object's Unicode code points into UTF-8, as defined in <a href="#RFC3629">RFC 3629</a> <cite title="NONE">[RFC3629]</cite>.  This is the Decoded JWT Claim Segment.  </li>
<li>Base64url encode the Decoded JWT Claim Segment. This encoding becomes the JWT Claim Segment.  </li>
<li>Create a JSON object containing a set of desired header parameters that conform to the <a href="#JWS">[JWS]</a> and <a href="#JWE">[JWE]</a> specifications.  Note that white space is explicitly allowed in the representation and no canonicalization is performed before encoding.  </li>
<li>Translate this JSON object's Unicode code points into UTF-8, as defined in <a href="#RFC3629">RFC 3629</a> <cite title="NONE">[RFC3629]</cite>.  This is the Decoded JWT Header Segment.  </li>
<li>Base64url encode the UTF-8 representation of this JSON object as defined in this specification (without padding). This encoding becomes a JWT Header Segment.  </li>
<li>Sign and optionally encrypt the JWT Header Segment and JWT Claim Segment values in the manner described in the <a href="#JWS">[JWS]</a> and <a href="#JWE">[JWE]</a> specifications; the JWT Header Segment is used as the JWS Header Input and the JWT Claim Segment is used as the JWS Payload Input; the resulting JWS Crypto Output is used as the JWT Claim Segment.  </li>
<li>Concatenate the JWT Header Segment, the JWT Claim Segment, and the JWT Crypto Segment in that order, separating each by period characters, to create the JWT.  </li>
</ol>

<p> </p>
<p id="rfc.section.6.p.2">When validating a JWT the following steps MUST be taken. If any of the listed steps fails then the token MUST be rejected for processing.  </p>
<p></p>

<ol>
<li>The JWT MUST contain two period characters.  </li>
<li>The JWT MUST be split on the two period characters resulting in three non-empty segments.  The first segment is the JWT Header Segment; the second is the JWT Claim Segment; the third is the JWT Crypto Segment.  </li>
<li>The JWT Claim Segment MUST be successfully base64url decoded following the restriction given in this specification that no padding characters have been used.  </li>
<li>The Decoded JWT Claim Segment MUST be completely valid JSON syntax conforming to <a href="#RFC4627">RFC 4627</a> <cite title="NONE">[RFC4627]</cite>.  </li>
<li>When used in a security-related context, the Decoded JWT Claim Segment MUST be validated to only include claims whose syntax and semantics are both understood and supported.  </li>
<li>The JWT Header Segment MUST be successfully base64url decoded following the restriction given in this specification that no padding characters have been used.  </li>
<li>The Decoded JWT Header Segment MUST be completely valid JSON syntax conforming to <a href="#RFC4627">RFC 4627</a> <cite title="NONE">[RFC4627]</cite>.  </li>
<li>The JWT Crypto Segment MUST be successfully base64url decoded following the restriction given in this specification that no padding characters have been used.  </li>
<li>The JWT Header Segment MUST be validated to only include parameters and values whose syntax and semantics are both understood and supported.  </li>
<li>The JWT Crypto Segment MUST be successfully validated against the JWT Header Segment and JWT Claim Segment in the manner defined by the <a href="#JWS">[JWS]</a> and <a href="#JWE">[JWE]</a> specifications.  </li>
</ol>

<p> </p>
<p id="rfc.section.6.p.4">Processing a JWT inevitably requires comparing known strings to values in the token. For example, in checking what the algorithm is, the Unicode string encoding <samp>alg</samp> will be checked against the member names in the Decoded JWT Header Segment to see if there is a matching header parameter name. A similar process occurs when determining if the value of the <samp>alg</samp> header parameter represents a supported algorithm. Comparing Unicode strings, however, has significant security implications, as per <a href="#Security">Section 10</a>.  </p>
<p id="rfc.section.6.p.5">Comparisons between JSON strings and other Unicode strings MUST be performed as specified below: </p>
<p></p>

<ol>
<li>Remove any JSON applied escaping to produce an array of Unicode code points.  </li>
<li>
<a href="#USA15">Unicode Normalization</a> <cite title="NONE">[USA15]</cite> MUST NOT be applied at any point to either the JSON string or to the string it is to be compared against.  </li>
<li>Comparisons between the two strings MUST be performed as a Unicode code point to code point equality comparison.  </li>
</ol>

<p> </p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> <a href="#base64urllogic" id="base64urllogic">Base64url encoding as used by JWTs</a>
</h1>
<p id="rfc.section.7.p.1">JWTs make use of the base64url encoding as defined in <a href="#RFC4648">RFC 4648</a> <cite title="NONE">[RFC4648]</cite>. As allowed by Section 3.2 of the RFC, this specification mandates that base64url encoding when used with JWTs MUST NOT use padding. The reason for this restriction is that the padding character ('=') is not URL safe.  </p>
<p id="rfc.section.7.p.2">For notes on implementing base64url encoding without padding, see <a href="#base64urlnotes">Appendix Appendix B</a>.  </p>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> <a href="#Signing" id="Signing">Signing JWTs with Cryptographic Algorithms</a>
</h1>
<p id="rfc.section.8.p.1">JWTs use JSON Web Signatures (JWSs) <a href="#JWS">[JWS]</a> and JSON Web Encryption (JWE) <a href="#JWE">[JWE]</a> to sign and optionally encrypt the contents of the JWT Header Segment and the JWT Claim Segment to produce the JWT Crypto Segment Value.  </p>
<p id="rfc.section.8.p.2">Of the JWS signing algorithms, only HMAC SHA-256 and RSA SHA-256 MUST be implemented by conforming JWT implementations.  It is RECOMMENDED that implementations also support the ECDSA P-256 SHA-256 algorithm.  Support for other algorithms is OPTIONAL.  </p>
<h1 id="rfc.section.9">
<a href="#rfc.section.9">9.</a> <a href="#IANA" id="IANA">IANA Considerations</a>
</h1>
<p id="rfc.section.9.p.1">This specification calls for: </p>

<ul><li>A new IANA registry entitled "JSON Web Token Claims" for reserved claim names is defined in <a href="#ReservedClaimName">Section 4.1</a>. Inclusion in the registry is RFC Required in the <a href="#RFC5226">RFC 5226</a> <cite title="NONE">[RFC5226]</cite> sense for reserved JWT claim names that are intended to be interoperable between implementations.  The registry will just record the reserved claim name and a pointer to the RFC that defines it. This specification defines inclusion of the claim names defined in <a href="#ClaimTable">Table 1</a>.  </li></ul>

<p> </p>
<h1 id="rfc.section.10">
<a href="#rfc.section.10">10.</a> <a href="#Security" id="Security">Security Considerations</a>
</h1>
<p id="rfc.section.10.p.1">TBD: Lots of work to do here. We need to remember to look into any issues relating to security and JSON parsing. One wonders just how secure most JSON parsing libraries are. Were they ever hardened for security scenarios? If not, what kind of holes does that open up? Also, we need to walk through the JSON standard and see what kind of issues we have especially around comparison of names.  For instance, comparisons of claim names and other parameters must occur after they are unescaped. Need to also put in text about: Importance of keeping secrets secret. Rotating keys. Strengths and weaknesses of the different algorithms.  </p>
<p id="rfc.section.10.p.2">TBD: Need to put in text about why strict JSON validation is necessary.  Basically, that if malformed JSON is received then the intent of the sender is impossible to reliably discern. While in non-security contexts it's o.k. to be generous in what one accepts, in security contexts this can lead to serious security holes. For example, malformed JSON might indicate that someone has managed to find a security hole in the issuer's code and is leveraging it to get the issuer to issue "bad" tokens whose content the attacker can control.  </p>
<h1 id="rfc.section.10.1">
<a href="#rfc.section.10.1">10.1.</a> Unicode Comparison Security Issues</h1>
<p id="rfc.section.10.1.p.1">Claim names in JWTs are Unicode strings.  For security reasons, the representations of these names must be compared verbatim after performing any escape processing (as per <a href="#RFC4627">RFC 4627</a> <cite title="NONE">[RFC4627]</cite>, Section 2.5).  </p>
<p id="rfc.section.10.1.p.2">This means, for instance, that these JSON strings must compare as being equal ("JWT", "\u004aWT"), whereas these must all compare as being not equal to the first set or to each other ("jwt", "Jwt", "JW\u0074").  </p>
<p id="rfc.section.10.1.p.3">JSON strings MAY contain characters outside the Unicode Basic Multilingual Plane.  For instance, the G clef character (U+1D11E) may be represented in a JSON string as "\uD834\uDD1E".  Ideally, JWT implementations SHOULD ensure that characters outside the Basic Multilingual Plane are preserved and compared correctly; alternatively, if this is not possible due to these characters exercising limitations present in the underlying JSON implementation, then input containing them MUST be rejected.  </p>
<h1 id="rfc.section.11">
<a href="#rfc.section.11">11.</a> <a href="#TBD" id="TBD">Open Issues and Things To Be Done (TBD)</a>
</h1>
<p id="rfc.section.11.p.1">The following items remain to be done in this draft (and related drafts): </p>
<h1 id="rfc.references">
<a href="#rfc.references">12.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">12.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2045">[RFC2045]</b></td>
<td class="top">
<a href="mailto:ned@innosoft.com" title="Innosoft International, Inc.">Freed, N.</a> and <a href="mailto:nsb@nsb.fv.com" title="First Virtual Holdings">N.S. Borenstein</a>, "<a href="http://tools.ietf.org/html/rfc2045">Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies</a>", RFC 2045, November 1996.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3339">[RFC3339]</b></td>
<td class="top">
<a href="mailto:GK@ACM.ORG" title="Clearswift Corporation">Klyne, G.</a> and <a href="mailto:chris.newman@sun.com" title="Sun Microsystems">C. Newman</a>, "<a href="http://tools.ietf.org/html/rfc3339">Date and Time on the Internet: Timestamps</a>", RFC 3339, July 2002.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3629">[RFC3629]</b></td>
<td class="top">
<a>Yergeau, F.</a>, "<a href="http://tools.ietf.org/html/rfc3629">UTF-8, a transformation format of ISO 10646</a>", STD 63, RFC 3629, November 2003.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3986">[RFC3986]</b></td>
<td class="top">
<a href="mailto:timbl@w3.org" title="World Wide Web Consortium">Berners-Lee, T.</a>, <a href="mailto:fielding@gbiv.com" title="Day Software">Fielding, R.</a> and <a href="mailto:LMM@acm.org" title="Adobe Systems Incorporated">L. Masinter</a>, "<a href="http://tools.ietf.org/html/rfc3986">Uniform Resource Identifier (URI): Generic Syntax</a>", STD 66, RFC 3986, January 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4627">[RFC4627]</b></td>
<td class="top">
<a>Crockford, D.</a>, "<a href="http://tools.ietf.org/html/rfc4627">The application/json Media Type for JavaScript Object Notation (JSON)</a>", RFC 4627, July 2006.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4648">[RFC4648]</b></td>
<td class="top">
<a>Josefsson, S.</a>, "<a href="http://tools.ietf.org/html/rfc4648">The Base16, Base32, and Base64 Data Encodings</a>", RFC 4648, October 2006.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5226">[RFC5226]</b></td>
<td class="top">
<a>Narten, T.</a> and <a>H. Alvestrand</a>, "<a href="http://tools.ietf.org/html/rfc5226">Guidelines for Writing an IANA Considerations Section in RFCs</a>", BCP 26, RFC 5226, May 2008.</td>
</tr>
<tr>
<td class="reference"><b id="USA15">[USA15]</b></td>
<td class="top">
<a href="mailto:markdavis@google.com">Davis, M.</a>, <a href="mailto:ken@unicode.org">Whistler, K.</a> and <a>M. D&#252;rst</a>, "<a>Unicode Normalization Forms</a>", Unicode Standard Annex 15, 09 2009.</td>
</tr>
<tr>
<td class="reference"><b id="JWS">[JWS]</b></td>
<td class="top">
<a href="mailto:mbj@microsoft.com" title="Microsoft">Jones, M.B.</a>, <a href="mailto:balfanz@google.com" title="Google">Balfanz, D.</a>, <a href="mailto:ve7jtb@ve7jtb.com" title="independent">Bradley, J.</a>, <a href="mailto:yarong@microsoft.com" title="Microsoft">Goland, Y.Y.</a>, <a href="mailto:jpanzer@google.com" title="Google">Panzer, J.</a>, <a href="mailto:n-sakimura@nri.co.jp" title="Nomura Research Institute">Sakimura, N.</a> and <a href="mailto:pt@fb.com" title="Facebook">P. Tarjan</a>, "<a>JSON Web Signature (JWS)</a>", March 2011.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">12.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="OASIS.saml-core-2.0-os">[OASIS.saml-core-2.0-os]</b></td>
<td class="top">
<a href="mailto:cantor.2@osu.edu" title="Internet2">Cantor, S.</a>, <a href="mailto:John.Kemp@nokia.com" title="Nokia">Kemp, J.</a>, <a href="mailto:rphilpott@rsasecurity.com" title="RSA Security">Philpott, R.</a> and <a href="mailto:eve.maler@sun.com" title="Sun Microsystems">E. Maler</a>, "<a>Assertions and Protocol for the OASIS Security Assertion Markup Language (SAML) V2.0</a>", OASIS Standard saml-core-2.0-os, March 2005.</td>
</tr>
<tr>
<td class="reference"><b id="W3C.CR-xml11-20021015">[W3C.CR-xml11-20021015]</b></td>
<td class="top">
<a>Cowan, J</a>, "<a>Extensible Markup Language (XML) 1.1</a>", W3C CR CR-xml11-20021015, October 2002.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3275">[RFC3275]</b></td>
<td class="top">
<a>Eastlake, D.</a>, <a>Reagle, J.</a> and <a>D. Solo</a>, "<a href="http://tools.ietf.org/html/rfc3275">(Extensible Markup Language) XML-Signature Syntax and Processing</a>", RFC 3275, March 2002.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4122">[RFC4122]</b></td>
<td class="top">
<a href="mailto:paulle@microsoft.com" title="Microsoft">Leach, P.</a>, <a href="mailto:michael@refactored-networks.com" title="Refactored Networks, LLC">Mealling, M.</a> and <a href="mailto:rsalz@datapower.com" title="DataPower Technology, Inc.">R. Salz</a>, "<a href="http://tools.ietf.org/html/rfc4122">A Universally Unique IDentifier (UUID) URN Namespace</a>", RFC 4122, July 2005.</td>
</tr>
<tr>
<td class="reference"><b id="SWT">[SWT]</b></td>
<td class="top">
<a>Hardt, D.</a> and <a>Y.Y. Goland</a>, "<a>Simple Web Token (SWT)</a>", Version 0.9.5.1, November 2009.</td>
</tr>
<tr>
<td class="reference"><b id="MagicSignatures">[MagicSignatures]</b></td>
<td class="top">
<a>Panzer (editor), J.</a>, <a>Laurie, B.</a> and <a>D. Balfanz</a>, "<a>Magic Signatures</a>", August 2010.</td>
</tr>
<tr>
<td class="reference"><b id="JSS">[JSS]</b></td>
<td class="top">
<a title="independent">Bradley, J.</a> and <a title="Nomura Research Institute">N.  Sakimura (editor)</a>, "<a>JSON Simple Sign</a>", September 2010.</td>
</tr>
<tr>
<td class="reference"><b id="CanvasApp">[CanvasApp]</b></td>
<td class="top">
<a>Facebook, </a>, "<a>Canvas Applications</a>", 2010.</td>
</tr>
<tr>
<td class="reference"><b id="JWE">[JWE]</b></td>
<td class="top">
<a href="mailto:mbj@microsoft.com" title="Microsoft">Jones, M.B.</a>, <a href="mailto:ve7jtb@ve7jtb.com" title="independent">Bradley, J.</a> and <a href="mailto:n-sakimura@nri.co.jp" title="Nomura Research Institute">N. Sakimura</a>, "<a>JSON Web Encryption (JWE)</a>", March 2011.</td>
</tr>
</tbody></table>
<h1 id="rfc.appendix.Appendix A">
<a href="#rfc.appendix.Appendix%20A">Appendix A.</a> <a href="#JWTExamples" id="JWTExamples">JWT Examples</a>
</h1>
<p id="rfc.section.Appendix A.p.1">This section provides several examples of JWTs.  The cryptographic operations for these examples are detailed in the JSON Web Signature (JWS) <a href="#JWS">[JWS]</a> specification.  </p>
<h1 id="rfc.appendix.Appendix A.1">
<a href="#rfc.appendix.Appendix%20A.1">Appendix A.1.</a> <a href="#HMACSHA256Example" id="HMACSHA256Example">JWT using HMAC SHA-256</a>
</h1>
<p id="rfc.section.Appendix A.1.p.1">The Decoded JWT Claim Segment used in this example is: </p>
<p id="rfc.section.Appendix A.1.p.2">Note that white space is explicitly allowed in Decoded JWT Claim Segments and no canonicalization is performed before encoding. The following byte array contains the UTF-8 characters for the Decoded JWT Claim Segment: </p>
<p id="rfc.section.Appendix A.1.p.3">[123, 34, 105, 115, 115, 34, 58, 34, 106, 111, 101, 34, 44, 13, 10, 32, 34, 101, 120, 112, 34, 58, 49, 51, 48, 48, 56, 49, 57, 51, 56, 48, 44, 13, 10, 32, 34, 104, 116, 116, 112, 58, 47, 47, 101, 120, 97, 109, 112, 108, 101, 46, 99, 111, 109, 47, 105, 115, 95, 114, 111, 111, 116, 34, 58, 116, 114, 117, 101, 125] </p>
<p id="rfc.section.Appendix A.1.p.4">Base64url encoding the above yields the JWT Claim Segment value: </p>
<p id="rfc.section.Appendix A.1.p.5">The following example JSON header object declares that the data structure is a JSON Web Token (JWT) and the JWT Header Segment and JWT Crypto Segment are signed using the HMAC SHA-256 algorithm: </p>
<p id="rfc.section.Appendix A.1.p.6">The following byte array contains the UTF-8 characters for the Decoded JWT Header Segment: </p>
<p id="rfc.section.Appendix A.1.p.7">[123, 34, 116, 121, 112, 34, 58, 34, 74, 87, 84, 34, 44, 13, 10, 32, 34, 97, 108, 103, 34, 58, 34, 72, 83, 50, 53, 54, 34, 125] </p>
<p id="rfc.section.Appendix A.1.p.8">Base64url encoding this UTF-8 representation yields this JWT Header Segment value: </p>
<p id="rfc.section.Appendix A.1.p.9">This example uses the key represented by the following byte array: </p>
<p id="rfc.section.Appendix A.1.p.10">[3, 35, 53, 75, 43, 15, 165, 188, 131, 126, 6, 101, 119, 123, 166, 143, 90, 179, 40, 230, 240, 84, 201, 40, 169, 15, 132, 178, 210, 80, 46, 191, 211, 251, 90, 146, 210, 6, 71, 239, 150, 138, 180, 195, 119, 98, 61, 34, 61, 46, 33, 114, 5, 46, 79, 8, 192, 205, 154, 245, 103, 208, 128, 163] </p>
<p id="rfc.section.Appendix A.1.p.11">Signing the JWT Header Segment and JWT Claim Segment with this key in the manner specified by <a href="#JWS">[JWS]</a> yields this JWT Crypto Segment value: </p>
<p id="rfc.section.Appendix A.1.p.12">Combining these segments in the order Header.Claims.Signature with period characters between the segments yields this complete JWT (with line breaks for display purposes only): </p>
<h1 id="rfc.appendix.Appendix A.2">
<a href="#rfc.appendix.Appendix%20A.2">Appendix A.2.</a> <a href="#RSASHA256Example" id="RSASHA256Example">JWT using RSA SHA-256</a>
</h1>
<p id="rfc.section.Appendix A.2.p.1">The Decoded JWT Claim Segment used in this example is the same as in the previous example: </p>
<p id="rfc.section.Appendix A.2.p.2">Since the JWT Claim Segment will therefore be the same, its computation is not repeated here.  However, the Decoded JWT Header Segment is different in two ways: First, because a different algorithm is being used, the "alg" value is different.  Second, for illustration purposes only, the optional "typ" parameter is not used.  (This difference is not related to the signature algorithm employed.)  The Decoded JWT Header Segment used is: </p>
<p id="rfc.section.Appendix A.2.p.3">The following byte array contains the UTF-8 characters for the Decoded JWT Header Segment: </p>
<p id="rfc.section.Appendix A.2.p.4">[123, 34, 97, 108, 103, 34, 58, 34, 82, 83, 50, 53, 54, 34, 125] </p>
<p id="rfc.section.Appendix A.2.p.5">Base64url encoding this UTF-8 representation yields this JWT Header Segment value: </p>
<p id="rfc.section.Appendix A.2.p.6">The RSA key consists of a public part (n, e), and a private exponent d.  The values of the RSA key used in this example, presented as the byte arrays representing big endian integers are: </p>
<div id="#rfc.table.4"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<thead><tr>
<th class="left">Parameter Name</th>
<th class="left">Value</th>
</tr></thead>
<tbody>
<tr>
<td class="left">n</td>
<td class="left">[161, 248, 22, 10, 226, 227, 201, 180, 101, 206, 141, 45, 101, 98, 99, 54, 43, 146, 125, 190, 41, 225, 240, 36, 119, 252, 22, 37, 204, 144, 161, 54, 227, 139, 217, 52, 151, 197, 182, 234, 99, 221, 119, 17, 230, 124, 116, 41, 249, 86, 176, 251, 138, 143, 8, 154, 220, 75, 105, 137, 60, 193, 51, 63, 83, 237, 208, 25, 184, 119, 132, 37, 47, 236, 145, 79, 228, 133, 119, 105, 89, 75, 234, 66, 128, 211, 44, 15, 85, 191, 98, 148, 79, 19, 3, 150, 188, 110, 155, 223, 110, 189, 210, 189, 163, 103, 142, 236, 160, 198, 104, 247, 1, 179, 141, 191, 251, 56, 200, 52, 44, 226, 254, 109, 39, 250, 222, 74, 90, 72, 116, 151, 157, 212, 185, 207, 154, 222, 196, 199, 91, 5, 133, 44, 44, 15, 94, 248, 165, 193, 117, 3, 146, 249, 68, 232, 237, 100, 193, 16, 198, 182, 71, 96, 154, 164, 120, 58, 235, 156, 108, 154, 215, 85, 49, 48, 80, 99, 139, 131, 102, 92, 111, 111, 122, 130, 163, 150, 112, 42, 31, 100, 27, 130, 211, 235, 242, 57, 34, 25, 73, 31, 182, 134, 135, 44, 87, 22, 245, 10, 248, 53, 141, 154, 139, 157, 23, 195, 64, 114, 143, 127, 135, 216, 154, 24, 216, 252, 171, 103, 173, 132, 89, 12, 46, 207, 117, 147, 57, 54, 60, 7, 3, 77, 111, 96, 111, 158, 33, 224, 84, 86, 202, 229, 233, 161] </td>
</tr>
<tr>
<td class="left">e</td>
<td class="left">[1, 0, 1] </td>
</tr>
<tr>
<td class="left">d</td>
<td class="left">[18, 174, 113, 164, 105, 205, 10, 43, 195, 126, 82, 108, 69, 0, 87, 31, 29, 97, 117, 29, 100, 233, 73, 112, 123, 98, 89, 15, 157, 11, 165, 124, 150, 60, 64, 30, 63, 207, 47, 44, 211, 189, 236, 136, 229, 3, 191, 198, 67, 155, 11, 40, 200, 47, 125, 55, 151, 103, 31, 82, 19, 238, 216, 193, 90, 37, 216, 213, 206, 160, 2, 94, 227, 171, 46, 139, 127, 121, 33, 111, 198, 59, 234, 86, 39, 83, 180, 6, 68, 198, 161, 81, 39, 217, 178, 149, 69, 64, 160, 187, 225, 163, 5, 86, 152, 45, 78, 159, 222, 95, 100, 37, 241, 77, 75, 113, 52, 65, 181, 93, 199, 59, 155, 74, 237, 204, 146, 172, 227, 146, 126, 55, 245, 125, 12, 253, 94, 117, 129, 250, 81, 44, 143, 73, 97, 169, 235, 11, 128, 248, 168, 7, 70, 114, 138, 85, 255, 70, 71, 31, 52, 37, 6, 59, 157, 83, 100, 47, 94, 222, 30, 132, 214, 19, 8, 26, 250, 92, 34, 208, 81, 40, 91, 214, 59, 148, 59, 86, 93, 137, 138, 5, 104, 84, 19, 229, 60, 60, 108, 101, 37, 255, 31, 227, 78, 61, 220, 112, 240, 213, 100, 80, 253, 164, 139, 161, 46, 16, 78, 157, 235, 159, 184, 24, 129, 225, 196, 189, 242, 93, 146, 71, 244, 80, 200, 101, 146, 121, 104, 231, 115, 52, 244, 65, 79, 117, 167, 80, 225, 57, 84, 110, 58, 138, 115, 157] </td>
</tr>
</tbody>
</table>
<p id="rfc.section.Appendix A.2.p.7">Signing the JWT Header Segment and JWT Claim Segment with this key in the manner specified by <a href="#JWS">[JWS]</a> yields this JWT Crypto Segment value: </p>
<p id="rfc.section.Appendix A.2.p.8">Combining these segments in the order Header.Claims.Signature with period characters between the segments yields this complete JWT (with line breaks for display purposes only): </p>
<h1 id="rfc.appendix.Appendix A.3">
<a href="#rfc.appendix.Appendix%20A.3">Appendix A.3.</a> <a href="#ECDSASHA256Example" id="ECDSASHA256Example">JWT using ECDSA P-256 SHA-256</a>
</h1>
<p id="rfc.section.Appendix A.3.p.1">The Decoded JWT Claim Segment used in this example is the same as in the previous examples: </p>
<p id="rfc.section.Appendix A.3.p.2">Since the JWT Claim Segment will therefore be the same, its computation is not repeated here.  However, the Decoded JWT Header Segment is differs from the previous example because a different algorithm is being used.  The Decoded JWT Header Segment used is: </p>
<p id="rfc.section.Appendix A.3.p.3">The following byte array contains the UTF-8 characters for the Decoded JWT Header Segment: </p>
<p id="rfc.section.Appendix A.3.p.4">[123, 34, 97, 108, 103, 34, 58, 34, 69, 83, 50, 53, 54, 34, 125] </p>
<p id="rfc.section.Appendix A.3.p.5">Base64url encoding this UTF-8 representation yields this JWT Header Segment value: </p>
<p id="rfc.section.Appendix A.3.p.6">The ECDSA key consists of a public part, the EC point (x, y), and a private part d.  The values of the ECDSA key used in this example, presented as the byte arrays representing big endian integers are: </p>
<div id="#rfc.table.5"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<thead><tr>
<th class="left">Parameter Name</th>
<th class="left">Value</th>
</tr></thead>
<tbody>
<tr>
<td class="left">x</td>
<td class="left">[127, 205, 206, 39, 112, 246, 196, 93, 65, 131, 203, 238, 111, 219, 75, 123, 88, 7, 51, 53, 123, 233, 239, 19, 186, 207, 110, 60, 123, 209, 84, 69] </td>
</tr>
<tr>
<td class="left">y</td>
<td class="left">[199, 241, 68, 205, 27, 189, 155, 126, 135, 44, 223, 237, 185, 238, 185, 244, 179, 105, 93, 110, 169, 11, 36, 173, 138, 70, 35, 40, 133, 136, 229, 173] </td>
</tr>
<tr>
<td class="left">d</td>
<td class="left">[142, 155, 16, 158, 113, 144, 152, 191, 152, 4, 135, 223, 31, 93, 119, 233, 203, 41, 96, 110, 190, 210, 38, 59, 95, 87, 194, 19, 223, 132, 244, 178] </td>
</tr>
</tbody>
</table>
<p id="rfc.section.Appendix A.3.p.7">Signing the JWT Header Segment and JWT Claim Segment with this key in the manner specified by <a href="#JWS">[JWS]</a> yields this JWT Crypto Segment value: </p>
<p id="rfc.section.Appendix A.3.p.8">Combining these segments in the order Header.Claims.Signature with period characters between the segments yields this complete JWT (with line breaks for display purposes only): </p>
<h1 id="rfc.appendix.Appendix B">
<a href="#rfc.appendix.Appendix%20B">Appendix B.</a> <a href="#base64urlnotes" id="base64urlnotes">Notes on implementing base64url encoding without padding</a>
</h1>
<p id="rfc.section.Appendix B.p.1">This appendix describes how to implement base64url encoding and decoding functions without padding based upon standard base64 encoding and decoding functions that do use padding.  </p>
<p id="rfc.section.Appendix B.p.2">To be concrete, example C# code implementing these functions is shown below.  Similar code could be used in other languages.  </p>
<p id="rfc.section.Appendix B.p.3">As per the example code above, the number of '=' padding characters that needs to be added to the end of a base64url encoded string without padding to turn it into one with padding is a deterministic function of the length of the encoded string.  Specifically, if the length mod 4 is 0, no padding is added; if the length mod 4 is 2, two '=' padding characters are added; if the length mod 4 is 3, one '=' padding character is added; if the length mod 4 is 1, the input is malformed.  </p>
<p id="rfc.section.Appendix B.p.4">An example correspondence between unencoded and encoded values follows.  The byte sequence below encodes into the string below, which when decoded, reproduces the byte sequence.  </p>
<h1 id="rfc.appendix.Appendix C">
<a href="#rfc.appendix.Appendix%20C">Appendix C.</a> Relationship of JWTs to SAML Tokens</h1>
<p><a href="#OASIS.saml-core-2.0-os">SAML 2.0</a> <cite title="NONE">[OASIS.saml-core-2.0-os]</cite> provides a standard for creating tokens with much greater expressivity and more security options than supported by JWTs. However, the cost of this flexibility and expressiveness is both size and complexity. In addition, SAML's use of <a href="#W3C.CR-xml11-20021015">XML</a> <cite title="NONE">[W3C.CR-xml11-20021015]</cite> and <a href="#RFC3275">XML DSIG</a> <cite title="NONE">[RFC3275]</cite> only contributes to the size of SAML tokens.  </p>
<p id="rfc.section.Appendix C.p.2">JWTs are intended to provide a simple token format that is small enough to fit into HTTP headers and query arguments in URIs. It does this by supporting a much simpler token model than SAML and using the <a href="#RFC4627">JSON</a> <cite title="NONE">[RFC4627]</cite> object encoding syntax. It also supports securing tokens using Hash-based Message Authentication Codes (HMACs) and digital signatures using a smaller (and less flexible) format than XML DSIG.  </p>
<p id="rfc.section.Appendix C.p.3">Therefore, while JWTs can do some of the things SAML tokens do, JWTs are not intended as a full replacement for SAML tokens, but rather as a compromise token format to be used when space is at a premium.  </p>
<h1 id="rfc.appendix.Appendix D">
<a href="#rfc.appendix.Appendix%20D">Appendix D.</a> Relationship of JWTs to Simple Web Tokens (SWTs)</h1>
<p id="rfc.section.Appendix D.p.1">Both JWTs and Simple Web Tokens <a href="#SWT">SWT</a> <cite title="NONE">[SWT]</cite>, at their core, enable sets of claims to be communicated between applications.  For SWTs, both the claim names and claim values are strings.  For JWTs, while claim names are strings, claim values can be any JSON type.  Both token types offer cryptographic protection of their content: SWTs with HMAC SHA-256 and JWTs with a choice of algorithms, including HMAC SHA-256, RSA SHA-256, and ECDSA P-256 SHA-256.  </p>
<h1 id="rfc.appendix.Appendix E">
<a href="#rfc.appendix.Appendix%20E">Appendix E.</a> <a href="#Acknowledgements" id="Acknowledgements">Acknowledgements</a>
</h1>
<p id="rfc.section.Appendix E.p.1">The authors acknowledge that the design of JWTs was intentionally influenced by the design and simplicity of <a href="#SWT">Simple Web Tokens</a> <cite title="NONE">[SWT]</cite> and ideas for JSON tokens that Dick Hardt discussed within the OpenID community.  </p>
<p id="rfc.section.Appendix E.p.2">Solutions for signing JSON content were previously explored by <a href="#MagicSignatures">Magic Signatures</a> <cite title="NONE">[MagicSignatures]</cite>, <a href="#JSS">JSON Simple Sign</a> <cite title="NONE">[JSS]</cite>, and <a href="#CanvasApp">Canvas Applications</a> <cite title="NONE">[CanvasApp]</cite>, all of which influenced this draft.  </p>
<h1 id="rfc.appendix.Appendix F">
<a href="#rfc.appendix.Appendix%20F">Appendix F.</a> Document History</h1>
<p id="rfc.section.Appendix F.p.1">-02 </p>

<ul>
<li>Split signature specification out into separate draft-jones-json-web-signature-00.  This split introduced no semantic changes.  </li>
<li>The JWT Compact Serialization is now the only token serialization format specified in this draft.  The JWT JSON Serialization can continue to be defined in a companion specification.  </li>
</ul>

<p> </p>
<p id="rfc.section.Appendix F.p.2">-01 </p>

<ul><li>Draft incorporating consensus decisions reached at IIW.  </li></ul>

<p> </p>
<p id="rfc.section.Appendix F.p.3">-00 </p>

<ul><li>Public draft published before November 2010 IIW based upon the JSON token convergence proposal incorporating input from several implementers of related specifications.  </li></ul>

<p> </p>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Michael B. Jones</span> 
	  <span class="n hidden">
		<span class="family-name">Jones</span>
	  </span>
	</span>
	<span class="org vcardline">Microsoft</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:mbj@microsoft.com">mbj@microsoft.com</a></span>

<span class="vcardline">URI: <a href="http://self-issued.info/">http://self-issued.info/</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Dirk Balfanz</span> 
	  <span class="n hidden">
		<span class="family-name">Balfanz</span>
	  </span>
	</span>
	<span class="org vcardline">Google</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:balfanz@google.com">balfanz@google.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">John Bradley</span> 
	  <span class="n hidden">
		<span class="family-name">Bradley</span>
	  </span>
	</span>
	<span class="org vcardline">independent</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:ve7jtb@ve7jtb.com">ve7jtb@ve7jtb.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Yaron Y. Goland</span> 
	  <span class="n hidden">
		<span class="family-name">Goland</span>
	  </span>
	</span>
	<span class="org vcardline">Microsoft</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:yarong@microsoft.com">yarong@microsoft.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">John Panzer</span> 
	  <span class="n hidden">
		<span class="family-name">Panzer</span>
	  </span>
	</span>
	<span class="org vcardline">Google</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:jpanzer@google.com">jpanzer@google.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Nat Sakimura</span> 
	  <span class="n hidden">
		<span class="family-name">Sakimura</span>
	  </span>
	</span>
	<span class="org vcardline">Nomura Research Institute</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:n-sakimura@nri.co.jp">n-sakimura@nri.co.jp</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Paul Tarjan</span> 
	  <span class="n hidden">
		<span class="family-name">Tarjan</span>
	  </span>
	</span>
	<span class="org vcardline">Facebook</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:pt@fb.com">pt@fb.com</a></span>

  </address>
</div>

</body>
</html>