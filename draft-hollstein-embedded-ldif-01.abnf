changerecord = "changetype:" FILL
                   (change-add / change-delete /
                    change-modify / change-moddn /
                    operation-bind / operation-unbind /
                    operation-compare / operation-search /
                    operation-extended / operation-abandon)



changerecord = "changetype:" FILL
                   (change-add / change-delete /
                    change-modify / change-moddn /
                    operation-bind / operation-unbind /
                    operation-compare / operation-search /
                    operation-extended / operation-abandon /
                    operation-conncet / operation-disconnect /
                    operation-response)


CONNECT         = "dn:" SEP operation-connect

operation-connect  = "connect"  SEP
                        "connection:" FILL 1*restricted-url SEP

restricted-url     = scheme "://" ([hostport] / filename)

scheme             = ("ldap" / "ldaps" / "file")

DISCONNECT        = "dn:" SEP "disconnect" SEP


RESPONSE           = "dn:" SEP operation-response

operation-response = "response" SEP
                        "responses:" FILL 1*DIGIT SEP

REFERENCE = FILE ":" CLASS ":" METHOD ":" RECORD ":" THREAD ":"
               INSTANCE

connection-identifier  = "connectionId(" REFERENCE ")"

transaction-identifier = "transactionId(" REFERENCE ")"

trans-oid = ( "1.3.6.1.1.21.2" / propriatary-oid ) 

message-identifier     = "messageId(" REFERENCE ")"

changeline = "changetype:" FILL
                              changetype
                              0*1(1*SPACE DELAY)
                              0*1(1*SPACE CONNID)
                              0*1(1*SPACE RESULT) SEP

changetype = ("add"      / "delete"  / "modify"  / "moddn"      /
                 "bind"     / "unbind"  / "compare" / "search"     /
                 "extended" / "abandon" / "conncet" / "disconnect" /
                 "response"
                )
                   Embedded LDIF                           November 2013


DELAY = 1*DIGIT

CONNID = connection-identifier


RESULT = "result(" result-variable ":" result-count ":"
                      result-objects ")"


result-count     = 1*DIGIT

                      This is an integer giving the maximum number of
                      record invocations for which a result will be
                      stored.


result-objects   = 1*DIGIT

                      This is an integer giving the maximum number of
                      objects that will be stored as response to a
                      search request per invocation of the record.


var-name =  1*( ALPHA / DIGIT / "-" / "_" )


envvar   = ( "${" var-name "}" / "$" var-name )



dynvar = "%" *DIGIT ( "d" / "s" / "f" ) "_" var-name "%"

