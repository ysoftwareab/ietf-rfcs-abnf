<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Hypertext Transfer Protocol (HTTP) Timeouts</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Hypertext Transfer Protocol (HTTP) Timeouts">
<meta name="keywords" content="HTTP, Timeout, Connection">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 60em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 60em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">HYBI</td><td class="header">S. Loreto</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Ericsson</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">M. Thomson</td></tr>
<tr><td class="header">Expires: December 11, 2010</td><td class="header">Andrew Corporation</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">G. Wilkins</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Webtide</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">June 9, 2010</td></tr>
</table></td></tr></table>
<h1><br />Hypertext Transfer Protocol (HTTP) Timeouts<br />draft-loreto-http-timeout-00</h1>

<h3>Abstract</h3>

<p>A Timeout header is defined for Hypertext Transfer Protocol (HTTP).  This end-to-end header informs an origin server and any intermediaries of the maximum time that a client will await a response to its request.  A server can use this header to ensure that a timely response is generated.  This also identifies requests as being potentially long-lived, and allows for better resource allocation for these requests.
      
</p>
<p>A Connection-Timeout header is defined for HTTP.  This hop-by-hop header informs the entity at the other end of a connection of the maximum time that an idle connection is kept open.  This header improves reliability by providing better information about the idle connection management policy of HTTP hosts.
      
</p>
<p>Comments and feedback for this draft should be directed to the authors and the Apps Discuss list (discuss@apps.ietf.org).
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted  in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF).  Note that other groups may also distribute
working documents as Internet-Drafts.  The list of current
Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
This Internet-Draft will expire on December 11, 2010.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the Simplified BSD License.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">1.1.</a>&nbsp;
Request Timeouts<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">1.2.</a>&nbsp;
Idle Connection Timeouts<br />
<a href="#anchor4">2.</a>&nbsp;
Terminology<br />
<a href="#timeout">3.</a>&nbsp;
Timeout Header<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#intermediary">3.1.</a>&nbsp;
Existing Intermediaries<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">3.2.</a>&nbsp;
Examples<br />
<a href="#conn-timeout">4.</a>&nbsp;
Connection-Timeout Header<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#conn-intermediary">4.1.</a>&nbsp;
Existing Intermediaries<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">4.2.</a>&nbsp;
Example<br />
<a href="#security">5.</a>&nbsp;
Security Considerations<br />
<a href="#anchor7">6.</a>&nbsp;
IANA Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">6.1.</a>&nbsp;
Timeout HTTP header Registration<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">6.2.</a>&nbsp;
Connection-Timeout HTTP header Registration<br />
<a href="#rfc.references1">7.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">7.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">7.2.</a>&nbsp;
Normative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>This document describes two headers that provide <a class='info' href='#RFC2616'>Hypertext Transfer Protocol (HTTP)<span> (</span><span class='info'>Fielding, R., Gettys, J., Mogul, J., Frystyk, H., Masinter, L., Leach, P., and T. Berners-Lee, &ldquo;Hypertext Transfer Protocol -- HTTP/1.1,&rdquo; June&nbsp;1999.</span><span>)</span></a> [RFC2616] hosts with timing information.
      
</p>
<p>The <tt>Timeout</tt> header describes the time available for a single HTTP request.
      
</p>
<p>The <tt>Connection-Timeout</tt> header describes the time that an idle connection is retained.
      
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Request Timeouts</h3>

<p>HTTP is a client-driven protocol.  As such, a server is only able to provide information to a client when that client requests it.  To address the need for servers to provide low-latency notifications to clients, a practice of <a class='info' href='#I-D.loreto-http-bidirectional'>long-polling<span> (</span><span class='info'>Loreto, S., Saint-Andre, P., Salsano, S., and G. Wilkins, &ldquo;Best Practices for the Use of Long Polling and Streaming in Bidirectional HTTP,&rdquo; February&nbsp;2010.</span><span>)</span></a> [I&#8209;D.loreto&#8209;http&#8209;bidirectional] is commonplace.
        
</p>
<p>Long-polling requires that a client maintain an open request to a server.  The server withholds responses to this request until the event of interest occurs.  The open request provides the server with a way to send a message immediately after the event occurs.  After the response containing the notification is received, the client immediately opens another open request.
        
</p>
<p>Long-polling differs significantly to many HTTP requests, which do not have significant delay between request and response.  Long-polling requests monopolize a connection for the time that they are outstanding.  For this reason, it is useful for a server or intermediary to identify a long-polling request.  Identifying a long-polling request would enable specialized resource management for long-polling requests; for instance, separate connection allocations and management, longer timeout periods and long-poll optimizations.
        
</p>
<p>A connection that is used for long-polling also appears to be idle for a significant period.  Management of idle connections can interfere with the operation of a long-poll.  Many intermediaries legitimately use timeouts to avoid clients from monopolizing the use of outgoing connections.  If an intermediary times out a request, the server is unable to send a response.
        
</p>
<p>Knowing the time available to provide a response can avoid problems with timeouts.  Current implementations select times between 30 and 120 seconds, times that have been empirically determined to be safe.  A server provides a null response before this time to ensure that the connection appears to be active to intermediaries.  Such low values are potentially wasteful, since each null response and subsequent request generates traffic.  A null response can also increase the latency of notifications, since the response removes the channel that the server would use for notifications.
        
</p>
<p>The Timeout header defined in <a class='info' href='#timeout'>Section&nbsp;3<span> (</span><span class='info'>Timeout Header</span><span>)</span></a> describes the maximum time available to a server in providing a response to any particular request.
        
</p>
<p>For the Timeout header, <a class='info' href='#intermediary'>Section&nbsp;3.1<span> (</span><span class='info'>Existing Intermediaries</span><span>)</span></a> includes a discussion of the interaction with existing HTTP intermediaries and other intermediaries like network address translation (NAT) device.
        
</p>
<p>[[Open: Any value in echoing the actual value back to a client?  MT: inclined to say no: we need a _use_, other than pure information, there's already a mechanism for ensuring that server gets the right value, having the client update its value is of no great benefit, especially since that encourages use of dodgy heuristics (i.e., is this request going to the same place?)]]
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.2"></a><h3>1.2.&nbsp;
Idle Connection Timeouts</h3>

<p>Management of idle HTTP connections has an impact on long-lived communications between hosts.  Hosts are able to close idle connections in order to reduce resource consumption.
        
</p>
<p>Many clients choose not to send non-idempotent requests on idle connections.  If the intermediary or server holding the other end of the connection chooses to close the connection while a non-idempotent request is in transit, the client has no way to tell if the request has succeeded.  For this reason, many clients establish a new connection for every non-idempotent request.  This is inefficient if the existing connection is usable connection: establishing a new connection adds significantly to the latency of the request.
        
</p>
<p>Polling of resource state can more efficiently use connection resources when an idle connection timeout is known.  A client that polls on an interval that is close to the connection timeout can ensure that polling requests are made before the idle connection is closed, avoiding any need to retry a request due to the aforementioned problem.  Alternatively, a client that knows that the connection timeout is less than the polling interval can close the connection immediately after a poll, releasing resources.
        
</p>
<p>A Connection-Timeout header is defined in <a class='info' href='#conn-timeout'>Section&nbsp;4<span> (</span><span class='info'>Connection-Timeout Header</span><span>)</span></a>.  This hop-by-hop header informs hosts of the minumum time that a connection remains idle before it is closed.  Indicating this time explicitly gives a client the knowledge necessary to reuse an idle connection with a greater assurance that the connection is usable.
        
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Terminology</h3>

<p>In this document, the key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" are to be interpreted as described in BCP 14, <a class='info' href='#RFC2119'>RFC 2119<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a> [RFC2119] and indicate requirement levels for compliant implementations.
      
</p>
<a name="timeout"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Timeout Header</h3>

<p>The <tt>Timeout</tt> header is a end-to-end request header that indicates the maximum time that a client is prepared to await a response.
      
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
<dfn>Timeout</dfn>            = "<span class='str'>Timeout</span>" "<span class='str'>:</span>" <cite class='id'>timeout-value</cite>
<dfn>timeout-value</dfn>      = <span class='rep'>1*</span><cite class='key'>DIGIT</cite>
</pre></div>
<p>A client adds a Timeout header to any request for which they are prepared to await a response.  The client sets the header to the maximum time that they are prepared to wait.
      
</p>
<p>The value of the Timeout header is a single integer value in seconds.
      
</p>
<p>An origin server interprets this header as the time between receipt of a complete request and the time that it generates and begins sending the response.  A client will observe a longer time interval between request and response, as network transit and processing by intermediaries add delays.  If this time is critical, a client SHOULD allow for delays in setting a value for the header.
      
</p>
<p>An origin server MAY apply a lower value to the timeout based on local policy.  An origin server MAY choose to take longer to produce a response, at the risk that the client is no longer able to use the response.
      
</p>
<p>An HTTP intermediary MAY reduce the value of a Timeout header based on local policy.  An intermediary MAY add a Timeout header if none is present.  The value in the Timeout header MUST NOT be increased or removed.
      
</p>
<p>The client MUST NOT set the value of the Timeout header greater than the value of the Connection-Timeout header.
      
</p>
<a name="intermediary"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Existing Intermediaries</h3>

<p>The exact impact of an intermediary on an HTTP request with a Timeout header depends on the type of intermediary.
        
</p>
<p>An intermediary that is compliant with HTTP/1.1 passes this header, but unaware of the header semantics, passes the header on to the origin server without altering it.  For an intermediary that does not time out requests, or an intermediary that has a timeout period that is longer than the one specified in the header, this has no impact.
        
</p>
<p>An existing intermediary that has a shorter timeout period than the indicated time will time out a request before the server generates a response.  The intermediary could send the client a 504 (Gateway Timeout) response when it times out.
        
</p>
<p>An intermediary that forwards requests without altering them (a transparent intermediary) is similar to an HTTP/1.1 compliant intermediary.
        
</p>
<p>A non-compliant intermediary might remove a Timeout header.  This means that the server is unaware of the timeliness requirements of the client.  A server that expects a Timeout header can attempt to guess an appropriate value.
        
</p>
<p>A network address translation (NAT) device might interact with timeouts.  These devices maintain state about TCP connections that are established through them.  This state can be discarded or lost if the connection remains idle.  A NAT device failure can also cause state loss.  Further attempts to use the connection either fail without error, or result in the NAT device sending a TCP <tt>RST</tt> to the entity that attempts to use the connection.
        
</p>
<p>A client MAY revise the Timeout header that it sends in subsequent requests to the same resource or origin server if it detects intermediaries or NAT devices that have shorter timeout periods.  However, two requests are not guaranteed to follow the same path through a network, especially for different resources.  A client that employs a heuristic for setting the Timeout header SHOULD ensure that any knowledge it obtains about timeouts is not retained indefinitely.
        
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Examples</h3>

<p>The following example shows how a Timeout header could be used.  In this case, both intermediaries - proxy and gateway - both reduce the timeout based on their policy.
        
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
Client              Proxy              Gateway             Server
  |                   |                   |                   |
  +-- Timeout: 300 --&gt;|                   |                   |
  |                   +-- Timeout: 250 --&gt;|                   |
  |                   |                   +-- Timeout: 240 --&gt;|
  |                   |                   |                ^  |
  .                   .                   .                |  .
  .                   .                   .     up to 240 seconds
  .                   .                   .                |  .
  |                   |                   |                V  |
  |                   |                   |&lt;----- 200 OK -----+
  |                   |&lt;----- 200 OK -----+                   |
  |&lt;----- 200 OK -----+                   |                   |
  |                   |                   |                   |
</pre></div>
<a name="conn-timeout"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Connection-Timeout Header</h3>

<p>The <tt>Connection-Timeout</tt> header is a hop-by-hop header that indicates the minimum time that an idle connection will be maintained.
      
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
<dfn>Connection-Timeout</dfn> = "<span class='str'>Connection-Timeout</span>" "<span class='str'>:</span>" <cite class='id'>timeout-value</cite>
                     <em>; timeout-value from Timeout header</em>
</pre></div>
<p>This header is sent by either host participating in a persistent connection.  A host sets the value to the minimum time that local policy at that host allows for an idle connection to remain open.  A connection is idle if no data is sent or received by a host.
      
</p>
<p>The value of the Connection-Timeout header is a single integer in seconds.
      
</p>
<p>As a hop-by-hop header, this header only applies to a single transport-level connection.  If a Connection-Timeout header is added to a request or response, the Connection header MUST include the tag <tt>Connection-Timeout</tt>.  This ensures that intermediaries that do not recognize this header remove it before forwarding a request.
      
</p>
<p>A host MAY keep an idle connection open for longer than the time that it indicates, but it SHOULD attempt to retain a connection for at least as long as indicated.
      
</p>
<p>Network transit and processing by intermediaries add additional delays that can skew the subjective perception of whether a connection is idle.  A client SHOULD make allowances for any delays in determining whether to reuse an idle connection.
      
</p>
<p>An intermediary that provides a Connection-Timeout header value, MUST set the value of the Timeout header in any requests that it forwards to be less than or equal to the Connection-Timeout that it provides.
      
</p>
<a name="conn-intermediary"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Existing Intermediaries</h3>

<p>The exact impact of an intermediary on an HTTP request with a Connection-Timeout header depends on the type of intermediary.
        
</p>
<p>An intermediary that is compliant with HTTP/1.1 ignores and discards this header before forwarding a request.  Since it is unaware of the semantics of the header it could drop an idle connection at any time (see Section 7.1.4 of <a class='info' href='#I-D.ietf-httpbis-p1-messaging'>[I&#8209;D.ietf&#8209;httpbis&#8209;p1&#8209;messaging]<span> (</span><span class='info'>Fielding, R., Gettys, J., Mogul, J., Nielsen, H., Masinter, L., Leach, P., Berners-Lee, T., and J. Reschke, &ldquo;HTTP/1.1, part 1: URIs, Connections, and Message Parsing,&rdquo; March&nbsp;2010.</span><span>)</span></a>).
        
</p>
<p>A non-compliant or otherwise transparent intermediary might pass this header on to the next hop.  This results in same types of errors that the Keep-Alive header causes, as described in Section 19.7.1 of <a class='info' href='#RFC2068'>[RFC2068]<span> (</span><span class='info'>Fielding, R., Gettys, J., Mogul, J., Nielsen, H., and T. Berners-Lee, &ldquo;Hypertext Transfer Protocol -- HTTP/1.1,&rdquo; January&nbsp;1997.</span><span>)</span></a>.
        
</p>
<p>A network address translation (NAT) device might cause a connection to become unavailable prior to the advertised timeout.
        
</p>
<p>A host MAY revise the Connection-Timeout header that it sends in subsequent requests to the same resource or origin server if it detects intermediaries or NAT devices that have shorter timeout periods.
        
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Example</h3>

<p>The following example shows how a Connection-Timeout header could be used.  All connections are independently negotiated.  In this example, the client indicates a timeout of 600 seconds (10 minutes), but the proxy is only prepared to retain the connection for at least 120 seconds (2 minutes).  On the link between proxy and server, the proxy requests a timeout of 1200 seconds and the server reduces this to 300 seconds.
       
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
Client                        Proxy                         Server
  |                             |                              |
  +- Connection-Timeout: 600 --&gt;|                              |
  |  Connection:                |                              |
  |    Connection-Timeout       |                              |
  |                             +- Connection-Timeout: 1200 --&gt;|
  |                             |  Connection:                 |
  |                             |    Connection-Timeout        |
  |                             |                              |
  |                             |&lt;-- Connection-Timeout: 300 --+
  |                             |    Connection:               |
  |                             |      Connection-Timeout      |
  |&lt;-- Connection-Timeout: 120 -+                              |
  |    Connection:              |                              |
  |      Connection-Timeout     |                              |
  |                             |                              |
</pre></div>
<a name="security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Security Considerations</h3>

<p>Establishing a persistent connection requires a commitment of resources at a host.  The Timeout and Connection-Timeout headers are used to express host policy that could alter the way that a host allocates connection resources.
      
</p>
<p>A host that alters its policies based on the receipt of either header could be exploited by a malicious host to either benefit from increased access to resources or to consume resources in the hopes of depriving another host.
      
</p>
<p>An attacker might attempt to keep a connection from becoming idle, to keep the connection open.  A client could legitimately do this to benefit from a reduced latency for later requests, but an attacker might exploit this to monopolize server resources.  A host that has indicated a Connection-Timeout MAY close a non-idle connection sooner than the indicated time if necessary or dictated by local policy (see Section 7.1.4 of <a class='info' href='#I-D.ietf-httpbis-p1-messaging'>[I&#8209;D.ietf&#8209;httpbis&#8209;p1&#8209;messaging]<span> (</span><span class='info'>Fielding, R., Gettys, J., Mogul, J., Nielsen, H., Masinter, L., Leach, P., Berners-Lee, T., and J. Reschke, &ldquo;HTTP/1.1, part 1: URIs, Connections, and Message Parsing,&rdquo; March&nbsp;2010.</span><span>)</span></a>).
      
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
IANA Considerations</h3>

<p>This section registers the two HTTP headers in the "Permanent Message Header Fields" registry established by <a class='info' href='#RFC3864'>[RFC3864]<span> (</span><span class='info'>Klyne, G., Nottingham, M., and J. Mogul, &ldquo;Registration Procedures for Message Header Fields,&rdquo; September&nbsp;2004.</span><span>)</span></a>.
      
</p>
<p>[[Note to IANA/RFC Editor: Please replace instance of RFCXXXX with the number of the published RFC and remove this note.]]
      
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
Timeout HTTP header Registration</h3>

<p>This document registers the HTTP <tt>Timeout</tt> header in the "Permanent Message Header Fields" registry established by <a class='info' href='#RFC3864'>[RFC3864]<span> (</span><span class='info'>Klyne, G., Nottingham, M., and J. Mogul, &ldquo;Registration Procedures for Message Header Fields,&rdquo; September&nbsp;2004.</span><span>)</span></a>
        </p>
<blockquote class="text"><dl>
<dt>Header field:</dt>
<dd>Timeout
</dd>
<dt>Applicable protocol:</dt>
<dd>HTTP
</dd>
<dt>Status:</dt>
<dd>standard
</dd>
<dt>Author/change controller:</dt>
<dd>Internet Engineering Task Force, IETF (iesg@ietf.org)
</dd>
<dt>Specification document(s):</dt>
<dd>RFCXXXX (this document)
</dd>
</dl></blockquote><p>
        
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
Connection-Timeout HTTP header Registration</h3>

<p>This document registers the HTTP <tt>Connection-Timeout</tt> header in the "Permanent Message Header Fields" registry established by <a class='info' href='#RFC3864'>[RFC3864]<span> (</span><span class='info'>Klyne, G., Nottingham, M., and J. Mogul, &ldquo;Registration Procedures for Message Header Fields,&rdquo; September&nbsp;2004.</span><span>)</span></a>
        </p>
<blockquote class="text"><dl>
<dt>Header field:</dt>
<dd>Connection-Timeout
</dd>
<dt>Applicable protocol:</dt>
<dd>HTTP
</dd>
<dt>Status:</dt>
<dd>standard
</dd>
<dt>Author/change controller:</dt>
<dd>Internet Engineering Task Force, IETF (iesg@ietf.org)
</dd>
<dt>Specification document(s):</dt>
<dd>RFCXXXX (this document)
</dd>
</dl></blockquote><p>
        
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>7.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2616">[RFC2616]</a></td>
<td class="author-text"><a href="mailto:fielding@ics.uci.edu">Fielding, R.</a>, <a href="mailto:jg@w3.org">Gettys, J.</a>, <a href="mailto:mogul@wrl.dec.com">Mogul, J.</a>, <a href="mailto:frystyk@w3.org">Frystyk, H.</a>, <a href="mailto:masinter@parc.xerox.com">Masinter, L.</a>, <a href="mailto:paulle@microsoft.com">Leach, P.</a>, and <a href="mailto:timbl@w3.org">T. Berners-Lee</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2616">Hypertext Transfer Protocol -- HTTP/1.1</a>,&rdquo; RFC&nbsp;2616, June&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2616.txt">TXT</a>, <a href="http://www.rfc-editor.org/rfc/rfc2616.ps">PS</a>, <a href="http://www.rfc-editor.org/rfc/rfc2616.pdf">PDF</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2616.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2616.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3864">[RFC3864]</a></td>
<td class="author-text">Klyne, G., Nottingham, M., and J. Mogul, &ldquo;<a href="http://tools.ietf.org/html/rfc3864">Registration Procedures for Message Header Fields</a>,&rdquo; BCP&nbsp;90, RFC&nbsp;3864, September&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3864.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>7.2.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.ietf-httpbis-p1-messaging">[I-D.ietf-httpbis-p1-messaging]</a></td>
<td class="author-text">Fielding, R., Gettys, J., Mogul, J., Nielsen, H., Masinter, L., Leach, P., Berners-Lee, T., and J. Reschke, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-httpbis-p1-messaging-09.txt">HTTP/1.1, part 1: URIs, Connections, and Message Parsing</a>,&rdquo; draft-ietf-httpbis-p1-messaging-09 (work in progress), March&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-httpbis-p1-messaging-09.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.loreto-http-bidirectional">[I-D.loreto-http-bidirectional]</a></td>
<td class="author-text">Loreto, S., Saint-Andre, P., Salsano, S., and G. Wilkins, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-loreto-http-bidirectional-02.txt">Best Practices for the Use of Long Polling and Streaming in Bidirectional HTTP</a>,&rdquo; draft-loreto-http-bidirectional-02 (work in progress), February&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-loreto-http-bidirectional-02.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2068">[RFC2068]</a></td>
<td class="author-text"><a href="mailto:fielding@ics.uci.edu">Fielding, R.</a>, <a href="mailto:jg@w3.org">Gettys, J.</a>, <a href="mailto:mogul@wrl.dec.com">Mogul, J.</a>, <a href="mailto:frystyk@w3.org">Nielsen, H.</a>, and <a href="mailto:timbl@w3.org">T. Berners-Lee</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2068">Hypertext Transfer Protocol -- HTTP/1.1</a>,&rdquo; RFC&nbsp;2068, January&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2068.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Salvatore Loreto</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Ericsson</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Hirsalantie 11</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Jorvas  02420</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Finland</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:salvatore.loreto@ericsson.com">salvatore.loreto@ericsson.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Martin Thomson</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Andrew Corporation</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Andrew Building (39)</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Wollongong University Campus</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Northfields Avenue</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Wollongong, NSW  2522</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">AU</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+61 2 4221 2915</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:martin.thomson@andrew.com">martin.thomson@andrew.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Greg Wilkins</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Webtide</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text"></td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:gregw@webtide.com">gregw@webtide.com</a></td></tr>
</table>
</body></html>
