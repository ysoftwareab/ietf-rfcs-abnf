<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Datagram Transport Layer Security (DTLS) Transport Mapping for Syslog</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Datagram Transport Layer Security (DTLS) Transport Mapping for Syslog">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">J. Salowey</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Cisco Systems, Inc.</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">T. Petch</td></tr>
<tr><td class="header">Expires: November 1, 2010</td><td class="header">Engineering Networks Ltd</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">R. Gerhards</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Adiscon GmbH</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">H. Feng</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Huaweisymantec, Inc.</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">April 30, 2010</td></tr>
</table></td></tr></table>
<h1><br />Datagram Transport Layer Security (DTLS) Transport Mapping for Syslog<br />draft-ietf-syslog-dtls-02.txt</h1>

<h3>Abstract</h3>

<p>This document describes the transport of syslog messages over DTLS
   (Datagram Transport Level Security).  It provides a secure transport for syslog messages in cases where a connection-less transport is
   desired.

</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted  in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF).  Note that other groups may also distribute
working documents as Internet-Drafts.  The list of current
Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
This Internet-Draft will expire on November 1, 2010.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the Simplified BSD License.</p>
<p>
This document may contain material from IETF Documents or IETF
Contributions published or made publicly available before November
10, 2008.  The person(s) controlling the copyright in some of this
material may not have granted the IETF Trust the right to allow
modifications of such material outside the IETF Standards Process.
Without obtaining an adequate license from the person(s) controlling
the copyright in such materials, this document may not be modified
outside the IETF Standards Process, and derivative works of it may
not be created outside the IETF Standards Process, except to format
it for publication as an RFC or to translate it into languages other
than English.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<br />
<a href="#anchor2">2.</a>&nbsp;
Terminology<br />
<br />
<a href="#anchor3">3.</a>&nbsp;
Security Requirements for Syslog<br />
<br />
<a href="#anchor4">4.</a>&nbsp;
Using DTLS to Secure Syslog<br />
<br />
<a href="#anchor5">5.</a>&nbsp;
Protocol Elements<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">5.1.</a>&nbsp;
Transport<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">5.2.</a>&nbsp;
Port Assignment<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">5.3.</a>&nbsp;
Initiation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">5.3.1.</a>&nbsp;
Certificate-Based Authentication<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">5.4.</a>&nbsp;
Sending data<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">5.4.1.</a>&nbsp;
Message Size<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">5.5.</a>&nbsp;
Closure<br />
<br />
<a href="#anchor13">6.</a>&nbsp;
Security Policies<br />
<br />
<a href="#anchor14">7.</a>&nbsp;
IANA Consideration<br />
<br />
<a href="#anchor15">8.</a>&nbsp;
Security Considerations<br />
<br />
<a href="#anchor16">9.</a>&nbsp;
Acknowledgements<br />
<br />
<a href="#rfc.references1">10.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">10.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">10.2.</a>&nbsp;
Informative References<br />
<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>The syslog protocol <a class='info' href='#RFC5424'>[RFC5424]<span> (</span><span class='info'>Gerhards, R., &ldquo;The Syslog Protocol,&rdquo; March&nbsp;2009.</span><span>)</span></a> is designed to run
      over different transports for different environments. Syslog over TLS 
      <a class='info' href='#RFC5425'>[RFC5425]<span> (</span><span class='info'>Miao, F., Ma, Y., and J. Salowey, &ldquo;Transport Layer Security (TLS) Transport Mapping for Syslog,&rdquo; March&nbsp;2009.</span><span>)</span></a> provides a combination of TCP transport
      reliability with TLS security <a class='info' href='#RFC5246'>[RFC5246]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a> and is the 
     RECOMMENDED transport.  In some
    circumstances, an operator might prefer using UDP to TCP
    as the transport.  Transmission of syslog Messages over UDP
     <a class='info' href='#RFC5426'>[RFC5426]<span> (</span><span class='info'>Okmianski, A., &ldquo;Transmission of Syslog Messages over UDP,&rdquo; March&nbsp;2009.</span><span>)</span></a> defines how to provide unreliable, 
    non-secure datagram
    transport for syslog.  This transport is NOT RECOMMENDED.
</p>
<p>The datagram transport layer security protocol (DTLS)  
   <a class='info' href='#RFC4347'>[RFC4347]<span> (</span><span class='info'>Rescorla, E. and N. Modadugu, &ldquo;Datagram Transport Layer Security,&rdquo; April&nbsp;2006.</span><span>)</span></a> is
    designed to meet the requirements of applications that need secure
    datagram transport by combining UDP transport with TLS security.
    DTLS has been mapped onto different transports (i.e.  UDP  <a class='info' href='#RFC0768'>[RFC0768]<span> (</span><span class='info'>Postel, J., &ldquo;User Datagram Protocol,&rdquo; August&nbsp;1980.</span><span>)</span></a>
    and DCCP  <a class='info' href='#RFC4340'>[RFC4340]<span> (</span><span class='info'>Kohler, E., Handley, M., and S. Floyd, &ldquo;Datagram Congestion Control Protocol (DCCP),&rdquo; March&nbsp;2006.</span><span>)</span></a> ).  Syslog over DTLS is another transport mapping
    that may be used to secure syslog in deployments where the operators
    feel that this best meets their requirements.
</p>
<p>     As the Internet best runs on the basis of appropriate resource
    sharing, both syslog over DTLS over DCCP <a class='info' href='#RFC5238'>[RFC5238]<span> (</span><span class='info'>Phelan, T., &ldquo;Datagram Transport Layer Security (DTLS) over the Datagram Congestion Control Protocol (DCCP),&rdquo; May&nbsp;2008.</span><span>)</span></a>
    and syslog over
    DTLS over UDP are defined in this specification.  If an operator
    has the choice of the two, it is recommended to use syslog over
    DTLS over DCCP. 
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Terminology</h3>

<p>The following definitions from <a class='info' href='#RFC5424'>[RFC5424]<span> (</span><span class='info'>Gerhards, R., &ldquo;The Syslog Protocol,&rdquo; March&nbsp;2009.</span><span>)</span></a> 
    are used in this document:</p>
<ul class="text">
<li>An "originator" generates syslog content to be carried in a
            message.
</li>
<li>A "collector" gathers syslog content for further analysis.
</li>
<li>A "relay" forwards messages, accepting messages from
            originators or other relays, and sending them to collectors or
            other relays.
</li>
<li>A "transport sender" passes syslog messages to a specific
      transport protocol.
</li>
<li>A "transport receiver" takes syslog messages from a specific
      transport protocol.
</li>
</ul>

<p>This document adds the following definitions:</p>
<ul class="text">
<li>A "DTLS client" is an application that can initiate a DTLS
      Client Hello to a server.
</li>
<li>A "DTLS server" is an application that can receive a Client Hello
      from a client and reply with a Server Hello.
</li>
</ul>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
      "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
      document are to be interpreted as described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Security Requirements for Syslog</h3>

<p>The security requirements for the transport of syslog messages
    are discussed in Section 2 of <a class='info' href='#RFC5425'>[RFC5425]<span> (</span><span class='info'>Miao, F., Ma, Y., and J. Salowey, &ldquo;Transport Layer Security (TLS) Transport Mapping for Syslog,&rdquo; March&nbsp;2009.</span><span>)</span></a>. These also apply to this specification.

</p>
<p>The following secondary threat is also considered in this document:</p>
<ul class="text">
<li>Denial of Service. 
       Denial of service is discussed in <a class='info' href='#RFC5424'>[RFC5424]<span> (</span><span class='info'>Gerhards, R., &ldquo;The Syslog Protocol,&rdquo; March&nbsp;2009.</span><span>)</span></a>, 
       which states that an attacker may send more
       messages to a transport receiver than the transport receiver could handle.
       When using a secure transport protocol handshake, an attacker may use a spoofed IP source to engage the server in a cryptographic handshake to deliberately consume the server's resources.
</li>
</ul>

<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Using DTLS to Secure Syslog</h3>

<p>DTLS can be used as a secure transport to counter all the primary
    threats to syslog described in <a class='info' href='#RFC5425'>[RFC5425]<span> (</span><span class='info'>Miao, F., Ma, Y., and J. Salowey, &ldquo;Transport Layer Security (TLS) Transport Mapping for Syslog,&rdquo; March&nbsp;2009.</span><span>)</span></a>:</p>
<ul class="text">
<li>Confidentiality to counter disclosure of the message contents.
</li>
<li>Integrity checking to counter modifications to a message on a hop-
      by-hop basis.
</li>
<li>Server or mutual authentication to counter masquerade.
</li>
</ul>

<p>In addition DTLS also provides: </p>
<ul class="text">
<li>A cookie exchange mechanism during handshake to counter Denial of
   Service attacks
</li>
<li>A sequence number in the header to counter replay attacks.
</li>
</ul>

<p>Note: This secure transport (i.e., DTLS) only secures syslog
   transport in a hop-by-hop manner, and is not concerned with the
   contents of syslog messages.  In particular, the authenticated
   identity of the transport sender (e.g., subject name in the 
   certificate) is not necessarily related to the HOSTNAME field 
   of the syslog message. When authentication of syslog
   message origin is required, <a class='info' href='#I-D.ietf-syslog-sign'>[I&#8209;D.ietf&#8209;syslog&#8209;sign]<span> (</span><span class='info'>Kelsey, J., Callas, J., and A. Clemm, &ldquo;Signed syslog Messages,&rdquo; December&nbsp;2009.</span><span>)</span></a> can be used.
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Protocol Elements</h3>

<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Transport</h3>

<p>DTLS can run over multiple transports.  Implementations of this specification MUST support DTLS over UDP and SHOULD support DTLS over DCCP  <a class='info' href='#RFC5238'>[RFC5238]<span> (</span><span class='info'>Phelan, T., &ldquo;Datagram Transport Layer Security (DTLS) over the Datagram Congestion Control Protocol (DCCP),&rdquo; May&nbsp;2008.</span><span>)</span></a>.  Transports, such as UDP or DCCP do not provide session multiplexing and session-demultiplexing.  In such cases, the application implementer provides this functionality by mapping a unique combination of the remote address, remote port number, local address and local port number to a session.
</p>
<p>Each syslog message is delivered by the DTLS record protocol, which assigns a sequence number 
    to each DTLS record. Although the DTLS implementer may adopt a queue mechanism to resolve reordering, it may not assure that all the messages are delivered in order when mapping on the UDP transport.
</p>
<p>When DTLS runs over an unreliable transport, such as UDP, reliability is not provided.  With DTLS, an originator or relay may not realize that a collector has gone down or lost its DTLS connection state so messages may be lost. 
</p>
<p>Syslog over DTLS over TCP MUST NOT be used. If a secure transport is required with TCP then the appropriate security mechanism is syslog over TLS as described in <a class='info' href='#RFC5425'>[RFC5425]<span> (</span><span class='info'>Miao, F., Ma, Y., and J. Salowey, &ldquo;Transport Layer Security (TLS) Transport Mapping for Syslog,&rdquo; March&nbsp;2009.</span><span>)</span></a>.  
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Port Assignment</h3>

<p>A syslog transport sender is always a DTLS client and a transport receiver is always a DTLS server.
</p>
<p>
    The UDP and DCCP port [TBD] has been allocated as the default port for syslog over DTLS as defined in this document.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3"></a><h3>5.3.&nbsp;
Initiation</h3>

<p>The transport sender initiates a DTLS connection by sending a DTLS Client Hello to the transport receiver.  Implementations MUST support the denial of service countermeasures defined by DTLS.  When these countermeasures are enabled, the transport receiver responds with a DTLS Hello Verify Request containing a cookie.  The transport sender responds with a DTLS Client Hello containing the received cookie which initiates the DTLS handshake.  When the DTLS handshake has finished, the transport sender MAY then send the first syslog message.
</p>
<p>Implementations MUST support  <a class='info' href='#RFC4347'>DTLS 1.1<span> (</span><span class='info'>Rescorla, E. and N. Modadugu, &ldquo;Datagram Transport Layer Security,&rdquo; April&nbsp;2006.</span><span>)</span></a> [RFC4347]  and MUST
   support the mandatory to implement cipher suite, which is
   TLS_RSA_WITH_AES_128_CBC_SHA. 
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.1"></a><h3>5.3.1.&nbsp;
Certificate-Based Authentication</h3>

<p>The mandatory to implement ciphersuites for DTLS use certificates <a class='info' href='#RFC5280'>[RFC5280]<span> (</span><span class='info'>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; May&nbsp;2008.</span><span>)</span></a> to authenticate peers. Both syslog transport sender (DTLS client) and syslog transport
   receiver (DTLS server) MUST implement certificate-based
   authentication.  This consists of validating the certificate and
   verifying that the peer has the corresponding private key.  The
   latter part is performed by DTLS.  To ensure interoperability between
   clients and servers, the methods for certificate validation defined in <a class='info' href='#RFC5425'>[RFC5425]<span> (</span><span class='info'>Miao, F., Ma, Y., and J. Salowey, &ldquo;Transport Layer Security (TLS) Transport Mapping for Syslog,&rdquo; March&nbsp;2009.</span><span>)</span></a> 
   SHALL be implemented. 
</p>
<p> Both transport receiver and transport sender implementations MUST
   provide means to generate a key pair and self-signed certificate in
   the case that a key pair and certificate are not available through
   another mechanism.
</p>
<p>The transport receiver and transport sender SHOULD provide mechanisms
   to record the end entity certificate or certificate fingerprint for the purpose of correlating an identity with the sent or received data.
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.4"></a><h3>5.4.&nbsp;
Sending data</h3>

<p>All syslog messages MUST be sent as DTLS "application data". It is
        possible that multiple syslog messages be contained in one DTLS record,
        or that a syslog message be transferred in multiple DTLS records. The
        application data is defined with the following <a class='info' href='#RFC5234'>ABNF<span> (</span><span class='info'>Crocker, D. and P. Overell, &ldquo;Augmented BNF for Syntax Specifications: ABNF,&rdquo; January&nbsp;2008.</span><span>)</span></a> [RFC5234] expression:
</p>
<p>APPLICATION-DATA = 1*SYSLOG-FRAME
</p>
<p>SYSLOG-FRAME = MSG-LEN SP SYSLOG-MSG
</p>
<p>MSG-LEN = NONZERO-DIGIT *DIGIT
</p>
<p>SP = %d32
</p>
<p>NONZERO-DIGIT = %d49-57
</p>
<p>DIGIT = %d48 / NONZERO-DIGIT
</p>
<p>SYSLOG-MSG is defined in <a class='info' href='#RFC5424'>syslog<span> (</span><span class='info'>Gerhards, R., &ldquo;The Syslog Protocol,&rdquo; March&nbsp;2009.</span><span>)</span></a> [RFC5424] protocol.
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.4.1"></a><h3>5.4.1.&nbsp;
Message Size</h3>

<p>The message length is the octet count of the SYSLOG-MSG in the
    SYSLOG-FRAME.  A transport receiver MUST use the message length to
    delimit a syslog message.  There is no upper limit for a message
    length per se.  As stated in <a class='info' href='#RFC4347'>[RFC4347]<span> (</span><span class='info'>Rescorla, E. and N. Modadugu, &ldquo;Datagram Transport Layer Security,&rdquo; April&nbsp;2006.</span><span>)</span></a>,
    each DTLS record must fit
    within a single DTLS datagram.  When mapping onto different
    transports, DTLS has different record size limitations.  The
    application implementer SHOULD determine the maximum record size
    allowed by DTLS protocol running over the transport in use.  The
    message size SHOULD NOT exceed the DTLS maximum record size
    limitation of 2^14 bytes.  To be consistent with RFC 5425, in
    establishing a baseline for interoperability, this specification
    requires that a transport receiver MUST be able to process messages
    with a length up to and including 2048 octets.  Transport receivers
    SHOULD be able to process messages with lengths up to and including
    8192 octets.
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.5"></a><h3>5.5.&nbsp;
Closure</h3>

<p>
       A transport sender MUST close the associated DTLS connection if the
   connection is not expected to deliver any syslog messages later.  It
   MUST send a DTLS close_notify alert before closing the connection.  A
   transport sender (DTLS client) MAY choose to not wait for the
   transport receiver's close_notify alert and simply close the
   DTLS connection.  Once the transport receiver gets a
   close_notify from the transport sender, it MUST reply with a
   close_notify.
</p>
<p>   When no data is received from a DTLS connection for a long time (where the
   application decides what "long" means), a transport receiver MAY
   close the connection.  The transport receiver (DTLS server) MUST
   attempt to initiate an exchange of close_notify alerts with the
   transport sender before closing the connection.  Transport receivers
   that are unprepared to receive any more data MAY close the connection
   after sending the close_notify alert. 
</p>
<p>   Although closure alerts form part of DTLS, they, like all alerts, are
   not retransmitted by DTLS and so may be lost over an unreliable
   network.
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Security Policies</h3>

<p>Syslog transport over DTLS has been designed to minimize the security and operational differences 
    for environments where both <a class='info' href='#RFC5425'>[RFC5425]<span> (</span><span class='info'>Miao, F., Ma, Y., and J. Salowey, &ldquo;Transport Layer Security (TLS) Transport Mapping for Syslog,&rdquo; March&nbsp;2009.</span><span>)</span></a> and syslog over DTLS are supported. 
    The security policies for syslog over DTLS are the same as those described in <a class='info' href='#RFC5425'>[RFC5425]<span> (</span><span class='info'>Miao, F., Ma, Y., and J. Salowey, &ldquo;Transport Layer Security (TLS) Transport Mapping for Syslog,&rdquo; March&nbsp;2009.</span><span>)</span></a>.
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
IANA Consideration</h3>

<p>IANA is requested to assign a registered UDP and DCCP port number for syslog over DTLS.  The same value as for syslog over TLS (6514) is requested.
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Security Considerations</h3>

<p>The security considerations in  <a class='info' href='#RFC5425'>[RFC5425]<span> (</span><span class='info'>Miao, F., Ma, Y., and J. Salowey, &ldquo;Transport Layer Security (TLS) Transport Mapping for Syslog,&rdquo; March&nbsp;2009.</span><span>)</span></a>,  <a class='info' href='#RFC5246'>[RFC5246]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a> and  <a class='info' href='#RFC4347'>[RFC4347]<span> (</span><span class='info'>Rescorla, E. and N. Modadugu, &ldquo;Datagram Transport Layer Security,&rdquo; April&nbsp;2006.</span><span>)</span></a> apply to this document.  
</p>
<p> 
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Acknowledgements</h3>

<p>The authors would like to thank Wes Hardaker  for his review on this proposal and contributing his valuable suggestions on the use of DTLS. Thanks also to Pasi Eronen, David Harrington, Chris Lonvick, Eliot Lear, Anton Okmyanskiy, Juergen Schoenwaelder, Richard Graveman and members of the syslog working group for their comments, suggestions and review.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>10.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC0768">[RFC0768]</a></td>
<td class="author-text">Postel, J., &ldquo;<a href="http://tools.ietf.org/html/rfc768">User Datagram Protocol</a>,&rdquo; STD&nbsp;6, RFC&nbsp;768, August&nbsp;1980 (<a href="http://www.rfc-editor.org/rfc/rfc768.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4340">[RFC4340]</a></td>
<td class="author-text">Kohler, E., Handley, M., and S. Floyd, &ldquo;<a href="http://tools.ietf.org/html/rfc4340">Datagram Congestion Control Protocol (DCCP)</a>,&rdquo; RFC&nbsp;4340, March&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4340.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4347">[RFC4347]</a></td>
<td class="author-text">Rescorla, E. and N. Modadugu, &ldquo;<a href="http://tools.ietf.org/html/rfc4347">Datagram Transport Layer Security</a>,&rdquo; RFC&nbsp;4347, April&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4347.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5234">[RFC5234]</a></td>
<td class="author-text">Crocker, D. and P. Overell, &ldquo;<a href="http://tools.ietf.org/html/rfc5234">Augmented BNF for Syntax Specifications: ABNF</a>,&rdquo; STD&nbsp;68, RFC&nbsp;5234, January&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5234.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5238">[RFC5238]</a></td>
<td class="author-text">Phelan, T., &ldquo;<a href="http://tools.ietf.org/html/rfc5238">Datagram Transport Layer Security (DTLS) over the Datagram Congestion Control Protocol (DCCP)</a>,&rdquo; RFC&nbsp;5238, May&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5238.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5246">[RFC5246]</a></td>
<td class="author-text">Dierks, T. and E. Rescorla, &ldquo;<a href="http://tools.ietf.org/html/rfc5246">The Transport Layer Security (TLS) Protocol Version 1.2</a>,&rdquo; RFC&nbsp;5246, August&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5246.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5280">[RFC5280]</a></td>
<td class="author-text">Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;<a href="http://tools.ietf.org/html/rfc5280">Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>,&rdquo; RFC&nbsp;5280, May&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5280.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5424">[RFC5424]</a></td>
<td class="author-text">Gerhards, R., &ldquo;<a href="http://tools.ietf.org/html/rfc5424">The Syslog Protocol</a>,&rdquo; RFC&nbsp;5424, March&nbsp;2009 (<a href="http://www.rfc-editor.org/rfc/rfc5424.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5425">[RFC5425]</a></td>
<td class="author-text">Miao, F., Ma, Y., and J. Salowey, &ldquo;<a href="http://tools.ietf.org/html/rfc5425">Transport Layer Security (TLS) Transport Mapping for Syslog</a>,&rdquo; RFC&nbsp;5425, March&nbsp;2009 (<a href="http://www.rfc-editor.org/rfc/rfc5425.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5426">[RFC5426]</a></td>
<td class="author-text">Okmianski, A., &ldquo;<a href="http://tools.ietf.org/html/rfc5426">Transmission of Syslog Messages over UDP</a>,&rdquo; RFC&nbsp;5426, March&nbsp;2009 (<a href="http://www.rfc-editor.org/rfc/rfc5426.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>10.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.ietf-syslog-sign">[I-D.ietf-syslog-sign]</a></td>
<td class="author-text">Kelsey, J., Callas, J., and A. Clemm, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-syslog-sign-29.txt">Signed syslog Messages</a>,&rdquo; draft-ietf-syslog-sign-29 (work in progress), December&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-syslog-sign-29.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2914">[RFC2914]</a></td>
<td class="author-text">Floyd, S., &ldquo;<a href="http://tools.ietf.org/html/rfc2914">Congestion Control Principles</a>,&rdquo; BCP&nbsp;41, RFC&nbsp;2914, September&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2914.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5405">[RFC5405]</a></td>
<td class="author-text">Eggert, L. and G. Fairhurst, &ldquo;<a href="http://tools.ietf.org/html/rfc5405">Unicast UDP Usage Guidelines for Application Designers</a>,&rdquo; BCP&nbsp;145, RFC&nbsp;5405, November&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5405.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Joseph Salowey</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">2901 3rd. Ave</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Seattle, WA  98121</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:jsalowey@cisco.com">jsalowey@cisco.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Tom Petch</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Engineering Networks Ltd</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">18 Parkwood Close</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Lymm, Cheshire  WA13 0NQ</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">UK</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:tomSecurity@network-engineer.co.uk">tomSecurity@network-engineer.co.uk</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Rainer Gerhards</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Adiscon GmbH</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Mozartstrasse 21</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Grossrinderfeld, BW  97950</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Germany</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:rgerhards@adiscon.com">rgerhards@adiscon.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Hongyan. Feng</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Huaweisymantec, Inc.</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:fhyfeng@gmail.com">fhyfeng@gmail.com</a></td></tr>
</table>
</body></html>
