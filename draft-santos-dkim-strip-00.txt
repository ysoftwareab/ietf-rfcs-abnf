



DKIM Working Group                                             H. Santos
Internet-Draft                                 Santronics Software, Inc.
Intended status: Experimental                              July 26, 2006
Expires: January 27, 2007


                  DKIM Canonicalization Method: STRIP
                       draft-santos-dkim-strip-00

Status of this Memo

   By submitting this Internet-Draft, each author represents that any
   applicable patent or other IPR claims of which he or she is aware
   have been or will be disclosed, and any of which he or she becomes
   aware will be disclosed, in accordance with Section 6 of BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups.  Note that
   other groups may also distribute working documents as Internet-
   Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt.

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html.

   This Internet-Draft will expire on January 27, 2007.

Copyright Notice

   Copyright (C) The Internet Society (2006).

Abstract

   The DKIM base protocol has offers two digital signature
   canonicalization (cl4n) methods called "relaxed" and "simple" with
   low reliability and survivability during in-transient operations.
   This proposal describes a new STRIP canonicalization algorithm and
   method to increase the reliability and survivability of the digital
   signature.  In additional, the proposal describe new original body
   hashing requirements to help secure STRIP c14n security concerns
   found in a similar but deprecated NOFWS c14n method.



Santos                  Expires January 27, 2007                [Page 1]

Internet-Draft                    DSAP                         July 2006


To be Done List

   1.  Get Examples of security issues for NOFWS.
   2.  Complete Security Section.


Table of Contents

   1.  Nomemclature and Definitions  . . . . . . . . . . . . . . . . . 3
     1.1.  Requirements Language . . . . . . . . . . . . . . . . . . . 3
   2.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . . . 3
   3.  STRIP Canonicalization  . . . . . . . . . . . . . . . . . . . . 4
   4.  Signing Logic . . . . . . . . . . . . . . . . . . . . . . . . . 4
   5.  IANA Considerations . . . . . . . . . . . . . . . . . . . . . . 5
   6.  Security Considerations . . . . . . . . . . . . . . . . . . . . 5
     6.1.  Replays . . . . . . . . . . . . . . . . . . . . . . . . . . 5
     6.2.  Denial-of-Service Attacks . . . . . . . . . . . . . . . . . 5
   7.  Acknowledgements  . . . . . . . . . . . . . . . . . . . . . . . 5
   8.  References  . . . . . . . . . . . . . . . . . . . . . . . . . . 5
     8.1.  Normative References  . . . . . . . . . . . . . . . . . . . 5
     8.2.  Informative References  . . . . . . . . . . . . . . . . . . 6
   Appendix A.  Appendix . . . . . . . . . . . . . . . . . . . . . . . 6
   Author's Address  . . . . . . . . . . . . . . . . . . . . . . . . . 6
   Intellectual Property and Copyright Statements  . . . . . . . . . . 7



























Santos                  Expires January 27, 2007                [Page 2]

Internet-Draft                    DSAP                         July 2006


1.  Nomemclature and Definitions

1.1.  Requirements Language

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in RFC 2119 [RFC2119].


2.  Introduction

   The DKIM [DKIM-BASE] protocol implements message canonicalization
   (c14n) as part its Digital Signature model.  Two c14n methods are
   currently defined:

      SIMPLE
      RELAXED

   SIMPLE is the the strongest of the two to maintain the originality of
   the message integrity during the mail delivery process Any slight
   change to the message header or body content at any point during the
   transport will cause the verification of the signature to fail.
   RELAXED provides a method which canonicalizing the header and body
   content to a disembodied digital form with the goal to increase the
   survivability of the signature.

   Due to the nature of the current infrastructure with a high degree of
   unknown, the stronger SIMPLE c14n has a low survival rate.  Although
   RELAXED improves the chances of survival of the signature, there
   still exist legacy CR/LF mutations that can fail the verification
   process.

   This documents introduces the new STRIP c14n which is similar to
   RELAXED but with the added logic to remove all CR and LF characters
   from the hashing engine.  The STRIP c14n is very similar to the NOFWS
   c14n method used by Yahoo's experimental DomainKeys protocol and was
   once considered for usage for the DKIM protocol.  However, since it
   was determined the NOFWS c14n exhibited some replay security threats,
   it is expected for STRIP c14n to also inherent the same security
   concerns.

   To address this issue and to protect the STRIP c14n, a new original
   body hashing signature tag is introduced to eliminate the mail
   integrity security concerns.

   The goals of this proposal are:





Santos                  Expires January 27, 2007                [Page 3]

Internet-Draft                    DSAP                         July 2006


   1.  help increase the validation of the signature that are now
       affected due to current and/or legacy infrastructure CR/LR
       related mutations.
   2.  by introducing cl4n method called STRIP, and
   3.  by augmented it with a original body hash security layer that
       will help eliminate the security concerns related to a STRIP cl4n
       method.


3.  STRIP Canonicalization

   The STRIP c14n method is similar to the RELAXED c14n with the added
   step of removing the trailing white spaces in the hashing engine
   feed:

   (preamble)
   <CR> (OCTET 13) Carriage Return
   <LF> (OCTET 10) Line Feed
   <TSP> (OCTET 32) Trailing Space
   (postamble)


4.  Signing Logic

   If the signer wishes to use the STRIP cl4n method, follow the DKIM-
   BASE [DKIM-BASE] specs for signing by also incorporating the
   following steps:

   1.  Add the required tags to the DKIM-SIG header.

   2.  Add the "bc=strip" tag to the DKIM-SIG header.

   3.  Calculate the body hash (bh=) based on STRIP cl4n method.

   4.  Add the bh=body-hash tag to the DKIM-SIG header.

   5.  Calculate the signature hash (b=).

   6.  Add the b=sign-hash to the DKIM-SIG header.

   7.  Calculate the original body hash (oh=) based on SIMPLE cl4n
       method.

   8.  Add the oh=body-hash tag to the DKIM-SIG header.







Santos                  Expires January 27, 2007                [Page 4]

Internet-Draft                    DSAP                         July 2006


   The following an example DKIM-Signature with STRIP c14n support:

   DKIM-Signature: a=rsa-sha256; s=brisbane; d=example.com;
     c=simple; bc=strip; q=dns/txt; i=joe@football.example.com;
     h=Received : From : To : Subject : Date : Message-ID;
     bh=ZSVEYuq4ri3LR9S+qjlzCP+LxvJrIfrOI2g5hxp5+MI=;
     b=dzdVyOfAKCdLXdJOc9G2q8LoXSlEniSbav+yuU4zGeeruD00lszZVoG4ZHRNiYzR;
     oh=ADasdadaasdada-adsad123-2n123d+232x1ahddlld=;



5.  IANA Considerations

   This document makes no request of IANA.

   Note to RFC Editor: this section may be removed on publication as an
   RFC.


6.  Security Considerations

6.1.  Replays

   TBD

6.2.  Denial-of-Service Attacks

   TBD


7.  Acknowledgements

   Discussions related to canonicalization in the IETF-DKIM Working
   Group among many participants lead to the development of this
   proposed draft.


8.  References

8.1.  Normative References

   [DKIM-BASE]
              Allman, E., "DomainKeys Identified Mail Signatures",
              April 2006, <http://mipassoc.org/dkim/specs/
              draft-allman-dkim-base-04.html>.

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119, March 1997.



Santos                  Expires January 27, 2007                [Page 5]

Internet-Draft                    DSAP                         July 2006


   [RFC2821]  Klensin, J., "Simple Mail Transfer Protocol", RFC 2821,
              April 2001.

   [RFC2822]  Resnick, P., "Internet Message Format", RFC 2822,
              April 2001.

8.2.  Informative References

   [LYNCH]  Lynch, C., "Canonicalization: A Fundamental Tool to
            Facilitate Preservation and Management of Digital
            Information", 1999,
            <http://www.dlib.org/dlib/september99/09lynch.html>.


Appendix A.  Appendix


Author's Address

   Hector Santos
   Santronics Software, Inc.
   15600 SW 158 ST Suite #306
   Homestead, Florida, FL  33033
   United States of America

   Email: hsantos@isdg.net
   URI:   http://www.isdg.net
























Santos                  Expires January 27, 2007                [Page 6]

Internet-Draft                    DSAP                         July 2006


Full Copyright Statement

   Copyright (C) The Internet Society (2006).

   This document is subject to the rights, licenses and restrictions
   contained in BCP 78, and except as set forth therein, the authors
   retain all their rights.

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY AND THE INTERNET
   ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS OR IMPLIED,
   INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE
   INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.


Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in BCP 78 and BCP 79.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   http://www.ietf.org/ipr.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.


Acknowledgment

   Funding for the RFC Editor function is provided by the IETF
   Administrative Support Activity (IASA).





Santos                  Expires January 27, 2007                [Page 7]


