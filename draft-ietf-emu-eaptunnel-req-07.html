<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Requirements for a Tunnel Based EAP Method</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Requirements for a Tunnel Based EAP Method">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 60em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 60em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">EMU Working Group</td><td class="header">K. Hoeper</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Motorola, Inc.</td></tr>
<tr><td class="header">Intended status: Informational</td><td class="header">S. Hanna</td></tr>
<tr><td class="header">Expires: December 26, 2010</td><td class="header">Juniper Networks</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">H. Zhou</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">J. Salowey, Ed.</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Cisco Systems, Inc.</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">June 24, 2010</td></tr>
</table></td></tr></table>
<h1><br />Requirements for a Tunnel Based EAP Method<br />draft-ietf-emu-eaptunnel-req-07.txt</h1>

<h3>Abstract</h3>

<p> This memo defines the requirements for a tunnel-based Extensible Authentication Protocol (EAP) Method.   This method will use Transport Layer Security (TLS) to establish a secure tunnel.  The tunnel will provide support for password authentication, EAP authentication and the transport of additional data for other purposes.  
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted  in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF).  Note that other groups may also distribute
working documents as Internet-Drafts.  The list of current
Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
This Internet-Draft will expire on December 26, 2010.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the Simplified BSD License.</p>
<p>
This document may contain material from IETF Documents or IETF
Contributions published or made publicly available before November
10, 2008.  The person(s) controlling the copyright in some of this
material may not have granted the IETF Trust the right to allow
modifications of such material outside the IETF Standards Process.
Without obtaining an adequate license from the person(s) controlling
the copyright in such materials, this document may not be modified
outside the IETF Standards Process, and derivative works of it may
not be created outside the IETF Standards Process, except to format
it for publication as an RFC or to translate it into languages other
than English.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<br />
<a href="#anchor2">2.</a>&nbsp;
Conventions Used In This Document<br />
<br />
<a href="#anchor3">3.</a>&nbsp;
Use Cases<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">3.1.</a>&nbsp;
Password Authentication<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">3.2.</a>&nbsp;
Protection of Weak EAP Methods<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">3.3.</a>&nbsp;
Chained EAP Methods<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">3.4.</a>&nbsp;
Identity Protection<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">3.5.</a>&nbsp;
Anonymous Service Access<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">3.6.</a>&nbsp;
Network Endpoint Assessment<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">3.7.</a>&nbsp;
Client Authentication During Tunnel Establishment<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">3.8.</a>&nbsp;
Extensibility<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">3.9.</a>&nbsp;
Certificate-less Authentication and Generic EAP Method Extension<br />
<br />
<a href="#reqs">4.</a>&nbsp;
Requirements<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">4.1.</a>&nbsp;
General Requirements<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">4.1.1.</a>&nbsp;
RFC Compliance<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">4.2.</a>&nbsp;
Tunnel Requirements<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor16">4.2.1.</a>&nbsp;
TLS Requirements<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor17">4.2.1.1.</a>&nbsp;
Cipher Suites<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">4.2.1.1.1.</a>&nbsp;
Cipher Suite Negotiation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor19">4.2.1.1.2.</a>&nbsp;
Tunnel Data Protection Algorithms<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#keyest">4.2.1.1.3.</a>&nbsp;
Tunnel Authentication and Key Establishment<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor20">4.2.1.2.</a>&nbsp;
Tunnel Replay Protection<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor21">4.2.1.3.</a>&nbsp;
TLS Extensions<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor22">4.2.1.4.</a>&nbsp;
Peer Identity Privacy<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor23">4.2.1.5.</a>&nbsp;
Session Resumption<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor24">4.2.2.</a>&nbsp;
Fragmentation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor25">4.2.3.</a>&nbsp;
Protection of Data External to Tunnel<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor26">4.3.</a>&nbsp;
Tunnel Payload Requirements<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor27">4.3.1.</a>&nbsp;
Extensible Attribute Types<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor28">4.3.2.</a>&nbsp;
Request/Challenge Response Operation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor29">4.3.3.</a>&nbsp;
Indicating Criticality of Attributes<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor30">4.3.4.</a>&nbsp;
Vendor Specific Support<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor31">4.3.5.</a>&nbsp;
Result Indication<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor32">4.3.6.</a>&nbsp;
Internationalization of Display Strings<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor33">4.4.</a>&nbsp;
EAP Channel Binding Requirements<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor34">4.5.</a>&nbsp;
Requirements Associated with Carrying Username and Passwords<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor35">4.5.1.</a>&nbsp;
Security<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor36">4.5.1.1.</a>&nbsp;
Confidentiality and Integrity<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor37">4.5.1.2.</a>&nbsp;
Authentication of Server<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#revocation">4.5.1.3.</a>&nbsp;
Server Certificate Revocation Checking<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor38">4.5.2.</a>&nbsp;
Internationalization<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor39">4.5.3.</a>&nbsp;
Meta-data<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor40">4.5.4.</a>&nbsp;
Password Change<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor41">4.6.</a>&nbsp;
Requirements Associated with Carrying EAP Methods<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor42">4.6.1.</a>&nbsp;
Method Negotiation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor43">4.6.2.</a>&nbsp;
Chained Methods<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#cryptobind">4.6.3.</a>&nbsp;
Cryptographic Binding with the TLS Tunnel<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor44">4.6.4.</a>&nbsp;
Peer Initiated<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor45">4.6.5.</a>&nbsp;
Method Meta-data<br />
<br />
<a href="#anchor46">5.</a>&nbsp;
IANA Considerations<br />
<br />
<a href="#Security">6.</a>&nbsp;
Security Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#secciph">6.1.</a>&nbsp;
Cipher Suite Selection<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor47">6.2.</a>&nbsp;
Tunneled Authentication<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor48">6.3.</a>&nbsp;
Data External to Tunnel<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor49">6.4.</a>&nbsp;
Separation of TLS Tunnel and Inner Authentication Termination<br />
<br />
<a href="#rfc.references1">7.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">7.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">7.2.</a>&nbsp;
Informative References<br />
<br />
<a href="#anchor52">Appendix&nbsp;A.</a>&nbsp;
Changes from -01<br />
<br />
<a href="#anchor53">Appendix&nbsp;B.</a>&nbsp;
Changes from -02<br />
<br />
<a href="#anchor54">Appendix&nbsp;C.</a>&nbsp;
changes from -03<br />
<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>Running EAP methods within a TLS protected tunnel has been deployed in several different solutions.  EAP methods supporting this include <a class='info' href='#PEAP'>PEAP<span> (</span><span class='info'>Microsoft Corporation, &ldquo;[MS-PEAP]: Protected Extensible Authentication Protocol (PEAP) Specification,&rdquo; August&nbsp;2009.</span><span>)</span></a> [PEAP], <a class='info' href='#RFC5281'>TTLS<span> (</span><span class='info'>Funk, P. and S. Blake-Wilson, &ldquo;Extensible Authentication Protocol Tunneled Transport Layer Security Authenticated Protocol Version 0 (EAP-TTLSv0),&rdquo; August&nbsp;2008.</span><span>)</span></a> [RFC5281] and <a class='info' href='#RFC4851'>EAP-FAST<span> (</span><span class='info'>Cam-Winget, N., McGrew, D., Salowey, J., and H. Zhou, &ldquo;The Flexible Authentication via Secure Tunneling Extensible Authentication Protocol Method (EAP-FAST),&rdquo; May&nbsp;2007.</span><span>)</span></a> [RFC4851]. In general this has worked well so there is consensus to continue to use TLS as the basis for a tunnel method. There have been various reasons for employing a protected tunnel for EAP processes.  They include protecting weak authentication exchanges, such as username and password.  In addition a protected tunnel can provide means to provide peer identity protection and EAP method chaining.  Finally, systems have found it useful to transport additional types of data within the protected tunnel.
</p>
<p>This document describes the requirements for an EAP  tunnel method as well as for a password protocol supporting legacy password verification within the tunnel method.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Conventions Used In This Document</h3>

<p>Use of each capitalized word within a sentence  
    or phrase carries the following meaning during the EMU WG's  
    method selection process:
</p>
<blockquote class="text">
<p><br />
MUST - indicates an absolute requirement 
</p>
<p><br />
MUST NOT - indicates something absolutely prohibited 
</p>
<p><br />
SHOULD - indicates a strong recommendation of a desired result
</p>
<p><br />
SHOULD NOT - indicates a strong recommendation against a result
</p>
<p><br />
MAY - indicates a willingness to allow an optional outcome
</p>
</blockquote>
<p>Lower case uses of "MUST", "MUST NOT", "SHOULD", "SHOULD NOT" and  
    "MAY" carry their normal meaning and are not subject to these  
    definitions.  
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Use Cases</h3>

<p>To motivate and explain the requirements in this document, a representative set of use cases for the EAP tunnel method are supplied here. The candidate tunnel method needs to support all of the use cases that are marked below as "MUST".
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Password Authentication</h3>

<p>Many legacy systems only support user authentication with passwords.  Some of these systems require transport of the actual username and password to the authentication server.  This is true for systems where the authentication server does not have access to the cleartext password or a consistent transform of the cleartext password.  Example of such systems are one time password (OTP) systems and other systems where the username and password are submitted to an external party for validation.  The tunnel method MUST support transporting cleartext username and password to the EAP server.  It MUST NOT reveal information about the username and password to parties in the communication path between the peer and the EAP Server. The advantage any attacker gains against the tunneled method when employing a username and password for authentication MUST be through interaction and not computation.  The tunnel MUST provide protection from man-in-the-middle attacks. The combination of the tunnel authentication and password authentication MUST enable mutual authentication.
</p>
<p>Since EAP authentication occurs before network access is granted the tunnel method SHOULD enable an inner exchange to provide support for minimal password management tasks including password change, "new PIN mode", and "next token mode" required by some systems.
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Protection of Weak EAP Methods</h3>

<p>Some existing EAP methods have vulnerabilities that could be eliminated or reduced by running them inside a protected tunnel.  For example, a EAP-MD5 does not provide mutual authentication or protection from dictionary attacks.  Without extra protection, tunnel-based EAP methods are vulnerable to a special type of tunnel man-in-the-middle attack <a class='info' href='#TUNNEL-MITM'>[TUNNEL&#8209;MITM]<span> (</span><span class='info'>Asokan, N., Niemi, V., and K. Nyberg, &ldquo;Man-in-the-Middle in Tunnelled Authentication Protocols,&rdquo; November&nbsp;2002.</span><span>)</span></a>. This attack is referred to as "tunnel MitM attack" in the remainder of this document. The additional protection needed to thwart tunnel MitM attacks depends on the inner method executed within the tunnel. When weak methods are used, these attacks can be mitigated via security policies that require the method to be used only within a tunnel. On the other hand, a technical solution (so-called cryptographic bindings) can be used whenever the inner method derives key material and is not susceptible to attacks outside a tunnel. Only the latter mitigation technique can be made an actual requirement for tunnel-based EAP methods (see <a class='info' href='#cryptobind'>Section&nbsp;4.6.3<span> (</span><span class='info'>Cryptographic Binding with the TLS Tunnel</span><span>)</span></a>), while security policies are outside the scope of this requirement draft. Please refer to the NIST Recommendation for EAP Methods Used in Wireless Network Access Authentication <a class='info' href='#NIST SP 800-120'>[NIST SP 800&#8209;120]<span> (</span><span class='info'>Hoeper, K. and L. Chen, &ldquo;Recommendation for EAP Methods Used in Wireless Network Access Authentication,&rdquo; September&nbsp;2009.</span><span>)</span></a> for a discussion on security policies and complete solutions for thwarting tunnel MitM attacks. 
</p>
<p>The tunnel method MUST support protection of weak EAP methods. Cryptographic protection from tunnel MitM attacks MUST be provided for all key generating methods. In combination with an appropriate security policy this will thwart MitM attacks against inner methods. 
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
Chained EAP Methods</h3>

<p>Several circumstances are best addressed by using chained EAP methods.
For example, it may be desirable to authenticate the user and also authenticate the device being used. However, chained EAP methods from different conversations can be re-directed into the same conversation by an attacker giving the authenticator the impression that both conversations terminate at the same end-point.  Cryptographic binding can be used to bind the results of chained key generating methods together or to an encompassing tunnel.
</p>
<p>The tunnel method MUST support chained EAP methods while including protection against attacks on method chaining.
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4"></a><h3>3.4.&nbsp;
Identity Protection</h3>

<p>When performing an EAP authentication, the peer may want to protect its identity and only disclose it to a trusted EAP server.  This helps to maintain peer privacy.
</p>
<p>The tunnel method MUST support identity protection, therefore the identity of the peer
    used for authentication purposes MUST NOT be obtainable by any
    entity other than the EAP server terminating the tunnel method.
 Peer identity protection provided by the tunnel method applies to tunnel method and inner method specific identities. Note that the peer may need to expose the realm portion of the EAP outer identity in the NAI <a class='info' href='#RFC4282'>[RFC4282]<span> (</span><span class='info'>Aboba, B., Beadles, M., Arkko, J., and P. Eronen, &ldquo;The Network Access Identifier,&rdquo; December&nbsp;2005.</span><span>)</span></a> in a roaming scenario in order to reach the appropriate authentication server.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.5"></a><h3>3.5.&nbsp;
Anonymous Service Access</h3>

<p>When network service is provided, it is sometimes desirable for a user to gain network access in order to access limited services for emergency communication or troubleshooting information. To avoid eavesdropping, it's best to negotiate link layer security as with any other authentication.
</p>
<p>Therefore, the tunnel method SHOULD allow anonymous peers or server-
   only authentication, while still deriving keys that can be used for
   link layer security.  The tunnel method MAY also allow for the bypass
   of server authentication processing on the client.
</p>
<p>   Forgoing user or server authentication increases the chance of
   man-in-the-middle and other types of attacks that can compromise the
   derived keys used for link  layer security.  Therefore, passwords and
   other sensitive information MUST NOT be disclosed to an
   unauthenticated server, or to a server that is not authorized to
   authenticate the user.
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.6"></a><h3>3.6.&nbsp;
Network Endpoint Assessment</h3>

<p>The Network Endpoint Assessment (NEA) protocols and reference model described in <a class='info' href='#RFC5209'>[RFC5209]<span> (</span><span class='info'>Sangster, P., Khosravi, H., Mani, M., Narayan, K., and J. Tardo, &ldquo;Network Endpoint Assessment (NEA): Overview and Requirements,&rdquo; June&nbsp;2008.</span><span>)</span></a> provide a standard way to check the health ("posture") of a device at or after the time it connects to a network. If the device does not comply with the network's requirements, it can be denied access to the network or granted limited access to remediate itself. EAP is a convenient place for conducting an NEA exchange.
</p>
<p>The tunnel method SHOULD support carrying NEA protocols such as PB-TNC <a class='info' href='#RFC5793'>[RFC5793]<span> (</span><span class='info'>Sahita, R., Hanna, S., Hurst, R., and K. Narayan, &ldquo;PB-TNC: A Posture Broker (PB) Protocol Compatible with Trusted Network Connect (TNC),&rdquo; March&nbsp;2010.</span><span>)</span></a>.
Depending on the specifics of the tunnel method, these protocols may be required to be carried in an EAP method.
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.7"></a><h3>3.7.&nbsp;
Client Authentication During Tunnel Establishment</h3>

<p>In some cases the peer will have credentials that allow it to authenticate 
 during tunnel establishment.  These credentials may only partially 
 authenticate the identity of the peer and additional authentication may be 
 required inside the tunnel. For example, a communication device may be authenticated during tunnel establishment, in addition user authentication may be required to satisfy authentication policy. The tunnel method MUST be capable of providing client side authentication during tunnel establishment.  

</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.8"></a><h3>3.8.&nbsp;
Extensibility</h3>

<p> The tunnel method MUST provide extensibility so that additional data related to authentication, authorization and network 
 access can be carried inside the tunnel in the future. This removes the need to develop new tunneling methods for specific purposes. 
</p>
<p>An application for extensibility is credential provisioning.  When a peer has authenticated with EAP, this is a convenient time to distribute credentials to that peer that may be used for later authentication exchanges. For example, the authentication server can provide a private key or shared key to the peer that can be used by the peer to perform rapid re-authentication or roaming. In addition there have been proposals to perform enrollment within EAP, such as <a class='info' href='#I-D.mahy-eap-enrollment'>[I&#8209;D.mahy&#8209;eap&#8209;enrollment]<span> (</span><span class='info'>Mahy, R., &ldquo;An Extensible Authentication Protocol (EAP) Enrollment Method,&rdquo; March&nbsp;2006.</span><span>)</span></a>.  Another use for extensibility is support for alternate authentication frameworks within the tunnel. 
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.9"></a><h3>3.9.&nbsp;
Certificate-less Authentication and Generic EAP Method Extension</h3>

<p>In some cases the peer will not have a way to verify a server
   certificate and in some cases a server might not have a certificate
   to verify. Therefore, it is desirable to support certificate-less
   authentication. An application for this is credential provisioning
   where the peer and server authenticate each other with a shared
   password and credentials for subsequent authentication (e.g. a key
   pair and certificate or a shared key) can be passed inside the
tunnel.
   Another application is to extend existing EAP methods with
   new features such as channel bindings.  

</p>
<p>  Great care must be taken when attempting to perform certificate-less
   authentication. One way of doing it is to establish the tunnel
   without full server or client verification 
   and inside the tunnel use an EAP method that performs
   mutual authentication and key derivation. If this technique is used
   the inner EAP method MUST provide resistance to dictionary attack
   and a cryptographic binding between the inner method and the
   tunnel method MUST be established.  In addition the cipher suite used
to 
   establish the tunnel MUST derive the master key using contribution
from
   both client and server, as in ephemeral Diffie-Hellman cipher suites.

</p>
<p> The tunnel method MAY allow for certificate-less authentication.
</p>
<a name="reqs"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Requirements</h3>

<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
General Requirements</h3>

<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1.1"></a><h3>4.1.1.&nbsp;
RFC Compliance</h3>

<p>The tunnel method MUST include a Security Claims section with all security claims specified in Section 7.2 in <a class='info' href='#RFC3748'>RFC 3748<span> (</span><span class='info'>Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H. Levkowetz, &ldquo;Extensible Authentication Protocol (EAP),&rdquo; June&nbsp;2004.</span><span>)</span></a> [RFC3748]. In addition, it MUST meet the requirement in Sections 2.1 and 7.4 of RFC 3748 that tunnel methods MUST support protection against man-in-the-middle attacks. Furthermore, the tunnel method MUST support identity protection as specified in Section 7.3 in RFC 3748.
</p>
<p>The tunnel method MUST be unconditionally compliant with <a class='info' href='#RFC4017'>RFC 4017<span> (</span><span class='info'>Stanley, D., Walker, J., and B. Aboba, &ldquo;Extensible Authentication Protocol (EAP) Method Requirements for Wireless LANs,&rdquo; March&nbsp;2005.</span><span>)</span></a> [RFC4017] (using the definition of "unconditionally compliant" contained in section 1.1 of RFC 4017). This means that the method MUST satisfy all the MUST, MUST NOT, SHOULD, and SHOULD NOT requirements in RFC 4017.
</p>
<p>The tunnel method MUST meet all the MUST and SHOULD requirements relevant to EAP methods contained in the EAP Key Management Framework <a class='info' href='#RFC5247'>[RFC5247]<span> (</span><span class='info'>Aboba, B., Simon, D., and P. Eronen, &ldquo;Extensible Authentication Protocol (EAP) Key Management Framework,&rdquo; August&nbsp;2008.</span><span>)</span></a> or any successor. This includes the generation of the MSK, EMSK, Peer-Id, Server-Id and Session-Id. These requirements will enable the tunnel method to properly fit into the EAP key management framework, maintaining all of the security properties and guarantees of that framework.
</p>
<p>The tunnel method MUST NOT be tied to any single cryptographic algorithm.
Instead, it MUST support run-time negotiation to select among an extensible set of cryptographic algorithms, such as algorithms used with certificates presented during tunnel establishment. This "cryptographic algorithm agility"
provides several advantages. Most important, when a weakness in an algorithm is discovered or increased processing power overtakes an algorithm, users can easily transition to a new algorithm. Also, users can choose the algorithm that best meets their needs.
</p>
<p>The tunnel method MUST meet the SHOULD and MUST requirements pertinent to EAP method contained in Section 3 of <a class='info' href='#RFC4962'>RFC 4962<span> (</span><span class='info'>Housley, R. and B. Aboba, &ldquo;Guidance for Authentication, Authorization, and Accounting (AAA) Key Management,&rdquo; July&nbsp;2007.</span><span>)</span></a> [RFC4962].  This includes: cryptographic algorithm independence; strong, fresh session keys; replay detection; keying material confidentiality and integrity; and confirmation of cipher suite selection.
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Tunnel Requirements</h3>

<p> The following section discusses requirements for TLS Tunnel Establishment.
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.1"></a><h3>4.2.1.&nbsp;
TLS Requirements</h3>

<p>The tunnel based method MUST support TLS version 1.2 <a class='info' href='#RFC5246'>[RFC5246]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a> and may support earlier versions to
   enable the possibility of backwards compatibility. 
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.1.1"></a><h3>4.2.1.1.&nbsp;
Cipher Suites</h3>

<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.1.1.1"></a><h3>4.2.1.1.1.&nbsp;
Cipher Suite Negotiation</h3>

<p>Cipher suite negotiations always suffer from downgrading attacks when they are not secured by any kind of integrity protection. A common practice is a post integrity check in which, as soon as available, the established keys (here the tunnel key) are used to derive integrity keys. These integrity keys are then used by peer and authentication server to verify whether the cipher suite negotiation has been maliciously altered by another party.
</p>
<p>Integrity checks prevent downgrading attacks only if the derived integrity keys and the employed integrity algorithms cannot be broken in real-time.  See <a class='info' href='#secciph'>Section&nbsp;6.1<span> (</span><span class='info'>Cipher Suite Selection</span><span>)</span></a> or <a class='info' href='#KHLC07'>[KHLC07]<span> (</span><span class='info'>Hoeper, K. and L. Chen, &ldquo;Where EAP Security Claims Fail,&rdquo; August&nbsp;2007.</span><span>)</span></a> for more information on this.  Hence, the tunnel method MUST provide integrity protected cipher suite negotiation with secure integrity algorithms and integrity keys. 
</p>
<p> TLS provides protected cipher suite negotiation as long as all the cipher suites supported provide authentication, key establishment and data integrity protection as discussed in <a class='info' href='#secciph'>Section&nbsp;6.1<span> (</span><span class='info'>Cipher Suite Selection</span><span>)</span></a>.

</p>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.1.1.2"></a><h3>4.2.1.1.2.&nbsp;
Tunnel Data Protection Algorithms</h3>

<p>In order to prevent attacks on the cryptographic algorithms employed by inner authentication methods, a tunnel protocol's protection needs to provide a basic level of algorithm strength.  The tunnel method MUST provide at least one mandatory to implement cipher suite that provides the equivalent security of 128-bit AES for encryption and message authentication. See Part 1 of the NIST Recommendation for Key Management <a class='info' href='#NIST SP 800-57'>[NIST SP 800&#8209;57]<span> (</span><span class='info'>Barker, E., Barker, W., Burr, W., Polk, W., and M. Smid, &ldquo;Recommendation for Key Management - Part 1: General (Revised),&rdquo; March&nbsp;2007.</span><span>)</span></a> for a discussion of the relative strengths of common algorithms.

</p>
<a name="keyest"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.1.1.3"></a><h3>4.2.1.1.3.&nbsp;
Tunnel Authentication and Key Establishment</h3>

<p>A tunnel method MUST provide unidirectional authentication from authentication server to EAP peer and mutual authentication between authentication server and EAP peer.  The tunnel method MUST provide at least one mandatory to implement cipher suite that provides certificate-based authentication of the server and provides optional certificate-based authentication of the client. Other types of authentication MAY be supported.
</p>
<p>At least one mandatory to implement cipher suite MUST be approved by NIST DRAFT Recommendation for Key Management, Part 3 <a class='info' href='#NIST SP 800-57p3'>[NIST SP 800&#8209;57p3]<span> (</span><span class='info'>Barker, E., Burr, W., Jones, A., Polk, W., , S., and M. Smid, &ldquo;Recommendation for Key Management, Part 3 Application-Specific Key Management Guidance,&rdquo; October&nbsp;2008.</span><span>)</span></a>, i.e., the ciphersuite MUST be listed in Table 4-1, 4-2 or 4-3 in that document.
</p>
<p>The mandatory to implement cipher suites MUST NOT include "export strength" cipher suites, cipher suites providing mutually anonymous authentication or static Diffie-Hellman cipher suites. 
</p>
<p>Other ciphersuites MAY be selected following the security requirements for tunnel protocols in NIST DRAFT Recommendation for EAP Methods Used in Wireless Network Access Authentication <a class='info' href='#NIST SP 800-120'>[NIST SP 800&#8209;120]<span> (</span><span class='info'>Hoeper, K. and L. Chen, &ldquo;Recommendation for EAP Methods Used in Wireless Network Access Authentication,&rdquo; September&nbsp;2009.</span><span>)</span></a>.
</p>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.1.2"></a><h3>4.2.1.2.&nbsp;
Tunnel Replay Protection</h3>

<p>In order to prevent replay attacks on a tunnel protocol, the message authentication MUST be generated using a time-variant input such as timestamps, sequence numbers, nonces, or a combination of these so that any re-use of the authentication data can be detected as invalid.  TLS provides sufficient replay protection to meet this requirements as long as weak cipher suites discussed in <a class='info' href='#secciph'>Section&nbsp;6.1<span> (</span><span class='info'>Cipher Suite Selection</span><span>)</span></a> are avoided. 
</p>
<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.1.3"></a><h3>4.2.1.3.&nbsp;
TLS Extensions</h3>

<p>In order to meet the requirements in this document TLS extensions MAY be used.  For example, TLS extensions may be useful in providing certificate revocation information via the TLS OCSP extension (thus meeting the requirement in <a class='info' href='#revocation'>Section&nbsp;4.5.1.3<span> (</span><span class='info'>Server Certificate Revocation Checking</span><span>)</span></a>).
</p>
<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.1.4"></a><h3>4.2.1.4.&nbsp;
Peer Identity Privacy</h3>

<p>A tunnel protocol MUST support peer privacy. This requires that the username and other attributes associated with the peer are not transmitted in the clear or to an unauthenticated, unauthorized party. Peer identity protection provided by the tunnel method applies to establishment of the tunnel and protection of inner method specific identities. If applicable, the peer certificate is sent confidentially (i.e. encrypted). 
</p>
<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.1.5"></a><h3>4.2.1.5.&nbsp;
Session Resumption</h3>

<p>The tunnel method MUST support TLS session resumption as defined in <a class='info' href='#RFC5246'>[RFC5246]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a>.  The tunnel method MAY support other methods of session resumption such as those defined in <a class='info' href='#RFC5077'>[RFC5077]<span> (</span><span class='info'>Salowey, J., Zhou, H., Eronen, P., and H. Tschofenig, &ldquo;Transport Layer Security (TLS) Session Resumption without Server-Side State,&rdquo; January&nbsp;2008.</span><span>)</span></a>. 
</p>
<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.2"></a><h3>4.2.2.&nbsp;
Fragmentation</h3>

<p>Tunnel establishment sometimes requires the exchange of information that exceeds what can be carried in a single EAP message.  In addition information carried within the tunnel may also exceed this limit.  Therefore a tunnel method MUST support fragmentation and reassembly. 
</p>
<a name="anchor25"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.3"></a><h3>4.2.3.&nbsp;
Protection of Data External to Tunnel</h3>

<p> A man-in-the-middle attacker can modify clear text values such as protocol version and type code information communicated outside the TLS tunnel. The tunnel method MUST provide implicit or explicit protection of the protocol version and type code.  If modification of other information external to the tunnel can cause exploitable vulnerabilities, the tunnel method MUST provide protection against modification of this additional data.
</p>
<a name="anchor26"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
Tunnel Payload Requirements</h3>

<p>This section describes the payload requirements inside the tunnel. These requirements frequently express features that a candidate protocol must be capable of offering so that a  deployer can decide whether to make use of that feature.  This  section does not state requirements about what features of each protocol must be used during a deployment.  
</p>
<a name="anchor27"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.1"></a><h3>4.3.1.&nbsp;
Extensible Attribute Types</h3>

<p> The payload MUST be extensible. Some standard payload attribute types will be defined to meet known requirements listed below, such as password authentication, inner EAP method, vendor specific attributes, and result indication. Additional payload attributes MAY be defined in the future to support additional features and data types.
</p>
<a name="anchor28"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.2"></a><h3>4.3.2.&nbsp;
Request/Challenge Response Operation</h3>

<p>The payload MUST support request and response type of half-duplex operation typical of EAP. Multiple attributes may be sent in a single payload. The payload MAY support carrying on multiple authentications in a single payload packet.
</p>
<a name="anchor29"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.3"></a><h3>4.3.3.&nbsp;
Indicating Criticality of Attributes</h3>

<p>It is expected that new attributes will be defined to be carried within
the tunnel method.  In some cases it is necessary for the sender to know
if the receiver did not understand the attribute.  To support this,
there MUST be a way for the sender to mark attributes such that the
receiver will indicate if an attribute is not understood.
</p>
<a name="anchor30"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.4"></a><h3>4.3.4.&nbsp;
Vendor Specific Support</h3>

<p>The payload MUST support communication of an extensible set of vendor-specific attributes.  These attributes will be segmented into uniquely identified vendor specific name spaces. They can be used for experiments or vendor specific features.
</p>
<a name="anchor31"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.5"></a><h3>4.3.5.&nbsp;
Result Indication</h3>

<p>The payload MUST support result indication and its acknowledgement, so both the EAP peer and server will end up with a synchronized state. The result indication is needed after each chained inner authentication method and at the end of the authentication, so separate result indication for intermediate and final result MUST be supported.
</p>
<a name="anchor32"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.6"></a><h3>4.3.6.&nbsp;
Internationalization of Display Strings</h3>

<p>The payload MAY provide a standard attribute format that supports international strings.  This attribute format MUST support encoding strings in UTF-8  <a class='info' href='#RFC3629'>[RFC3629]<span> (</span><span class='info'>Yergeau, F., &ldquo;UTF-8, a transformation format of ISO 10646,&rdquo; November&nbsp;2003.</span><span>)</span></a> format.  Any strings sent by the server intended for display to the user MUST be sent in UTF-8 format and SHOULD be able to be marked with language information and adapted to the user's language preference as indicated by RFC 5646 <a class='info' href='#RFC5646'>[RFC5646]<span> (</span><span class='info'>Phillips, A. and M. Davis, &ldquo;Tags for Identifying Languages,&rdquo; September&nbsp;2009.</span><span>)</span></a>.  Note that in some cases, such as when transmitting error codes, it is acceptable to exchange numeric codes that can be translated by the client to support the particular local language.  These numeric codes are not subject internationalization during transmission.
</p>
<a name="anchor33"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4"></a><h3>4.4.&nbsp;
EAP Channel Binding Requirements</h3>

<p>The tunnel method MUST be capable of meeting EAP channel binding requirements described in <a class='info' href='#I-D.clancy-emu-chbind'>[I&#8209;D.clancy&#8209;emu&#8209;chbind]<span> (</span><span class='info'>Clancy, C. and K. Hoeper, &ldquo;Channel Binding Support for EAP Methods,&rdquo; November&nbsp;2008.</span><span>)</span></a>.
</p>
<a name="anchor34"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5"></a><h3>4.5.&nbsp;
Requirements Associated with Carrying Username and Passwords</h3>

<p>This section describes the requirements associated with tunneled password authentication. The password authentication mentioned here refers to user or machine authentication using a legacy password database or verifier, such as LDAP, OTP, etc. These  typically require the password in its original text form in order to authenticate the peer, hence they require the peer to send the clear text user name and password to the EAP server.
</p>
<a name="anchor35"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5.1"></a><h3>4.5.1.&nbsp;
Security</h3>

<p>Many internal EAP methods have the peer send its password in the clear to the EAP server. Other methods (e.g. challenge-response methods) are vulnerable to attacks if an eavesdropper can intercept the traffic. For any such methods, the security measures in the following sections MUST be met.
</p>
<a name="anchor36"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5.1.1"></a><h3>4.5.1.1.&nbsp;
Confidentiality and Integrity</h3>

<p>The clear text password exchange MUST be integrity and confidentiality protected. As long as the password exchange occurs inside an authenticated and encrypted tunnel, this requirement is met.

</p>
<a name="anchor37"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5.1.2"></a><h3>4.5.1.2.&nbsp;
Authentication of Server</h3>

<p>The EAP server MUST be authenticated before the peer sends the clear text password to the server. 
</p>
<a name="revocation"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5.1.3"></a><h3>4.5.1.3.&nbsp;
Server Certificate Revocation Checking</h3>

<p>When certificate authentication is used during tunnel establishment  the EAP peer may need to present its password to the server before it has network access to check the revocation status of the server's credentials.  Therefore,  the tunnel method MUST support mechanisms to check the revocation status of a credential. The tunnel method SHOULD make use of Online Certificate Status Protocol (OCSP) <a class='info' href='#RFC2560'>[RFC2560]<span> (</span><span class='info'>Myers, M., Ankney, R., Malpani, A., Galperin, S., and C. Adams, &ldquo;X.509 Internet Public Key Infrastructure Online Certificate Status Protocol - OCSP,&rdquo; June&nbsp;1999.</span><span>)</span></a> or  Server-based Certificate Validation Protocol (SCVP) <a class='info' href='#RFC5055'>[RFC5055]<span> (</span><span class='info'>Freeman, T., Housley, R., Malpani, A., Cooper, D., and W. Polk, &ldquo;Server-Based Certificate Validation Protocol (SCVP),&rdquo; December&nbsp;2007.</span><span>)</span></a> to obtain the revocation status of the EAP server certificate.
</p>
<a name="anchor38"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5.2"></a><h3>4.5.2.&nbsp;
Internationalization</h3>

<p>The password authentication exchange MUST support user names and passwords in international languages. It MUST support encoding of user name and password strings in UTF-8 <a class='info' href='#RFC3629'>[RFC3629]<span> (</span><span class='info'>Yergeau, F., &ldquo;UTF-8, a transformation format of ISO 10646,&rdquo; November&nbsp;2003.</span><span>)</span></a> format. The method 
   MUST specify how username and password normalizations and/or comparisons is performed in 
   reference to SASLPrep <a class='info' href='#RFC4013'>[RFC4013]<span> (</span><span class='info'>Zeilenga, K., &ldquo;SASLprep: Stringprep Profile for User Names and Passwords,&rdquo; February&nbsp;2005.</span><span>)</span></a> or Net-UTF-8 <a class='info' href='#RFC5198'>[RFC5198]<span> (</span><span class='info'>Klensin, J. and M. Padlipsky, &ldquo;Unicode Format for Network Interchange,&rdquo; March&nbsp;2008.</span><span>)</span></a>. 
</p>
<p> Any strings sent by the server intended for display to the user MUST be sent in UTF-8 format and SHOULD be able to be marked with language information and adapted to the user's language preference as indicated by RFC 5646 <a class='info' href='#RFC5646'>[RFC5646]<span> (</span><span class='info'>Phillips, A. and M. Davis, &ldquo;Tags for Identifying Languages,&rdquo; September&nbsp;2009.</span><span>)</span></a>.  Note that in some cases, such as when transmitting error codes, it is acceptable to exchange numeric codes that can be translated by the client to support the particular local language.  These numeric codes are not subject internationalization during transmission.
</p>
<a name="anchor39"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5.3"></a><h3>4.5.3.&nbsp;
Meta-data</h3>

<p>The password authentication exchange SHOULD support additional associated meta-data which can be used to indicate whether the authentication is for a user or a machine. This allows the EAP server and peer to request and negotiate authentication  specifically for a user or machine. This is useful in the case of multiple inner authentications where the user and machine both need to be authenticated.

</p>
<a name="anchor40"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5.4"></a><h3>4.5.4.&nbsp;
Password Change</h3>

<p>The password authentication exchange MUST support password change. The exchange SHOULD be extensible to support other "housekeeping" functions, such as the management of PINs or other data, required by some systems.
</p>
<a name="anchor41"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.6"></a><h3>4.6.&nbsp;
Requirements Associated with Carrying EAP Methods</h3>

<p>The tunnel method MUST be able to carry inner EAP methods without modifying them. EAP methods MUST NOT be redefined inside the tunnel.
</p>
<a name="anchor42"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.6.1"></a><h3>4.6.1.&nbsp;
Method Negotiation</h3>

<p> The tunnel method MUST support the protected negotiation of the inner EAP method. It MUST NOT allow the inner EAP method negotiation to be manipulated by intermediaries.
</p>
<a name="anchor43"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.6.2"></a><h3>4.6.2.&nbsp;
Chained Methods</h3>

<p>The tunnel method SHOULD support the chaining of multiple EAP methods.  The tunnel method MUST allow for the communication of intermediate result and verification of compound binding between executed inner methods when chained methods are employed.
</p>
<a name="cryptobind"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.6.3"></a><h3>4.6.3.&nbsp;
Cryptographic Binding with the TLS Tunnel</h3>

<p>The tunnel method MUST provide a mechanism to bind the tunnel protocol and 
the inner EAP method. This property is referred to as cryptographic binding. Such bindings are an important tool for mitigating the tunnel MitM attacks on tunnel methods <a class='info' href='#TUNNEL-MITM'>[TUNNEL&#8209;MITM]<span> (</span><span class='info'>Asokan, N., Niemi, V., and K. Nyberg, &ldquo;Man-in-the-Middle in Tunnelled Authentication Protocols,&rdquo; November&nbsp;2002.</span><span>)</span></a>. Cryptographic bindings enable the complete prevention of tunnel MitM attacks without the need of additional security policies as long as the inner method derives keys and is not vulnerable to attacks outside a protected tunnel <a class='info' href='#KHLC07'>[KHLC07]<span> (</span><span class='info'>Hoeper, K. and L. Chen, &ldquo;Where EAP Security Claims Fail,&rdquo; August&nbsp;2007.</span><span>)</span></a>. Even though weak or non-key deriving inner methods may be permitted, and thus security policies preventing tunnel MitM attacks are still necessary, the tunnel method MUST provide cryptographic bindings, because only this allows migrating to more secure, policy-independent implementations. 
</p>
<p>Cryptographic bindings are typically achieved by securely mixing the
   established keying material (say tunnel key TK) from the tunnel
   protocol with the established keying material (say method key MK)
   from the inner authentication method(s) in order to derive fresh keying
   material.  If chained EAP methods are executed in the tunnel, all derived inner keys are combined with the tunnel key to create a new compound tunnel key (CTK).  In particular, CTK is used to derive the EAP MSK, EMSK and other
   transient keys (TEK), such as transient encryption keys and integrity
   protection keys.  The key hierarchy for tunnel methods executions that derive compound keys for the purpose of cryptographic binding is depicted in
   Figure 1.
</p>
<p>In the case of the sequential executions of n inner methods, a chained compound key CTK_i MUST be computed upon the completion of each inner method i such that it contains the compound key of all previous inner methods, i.e. CTK_i=f(CTK_i-1, MK_i) with 0 &lt; i &lt;= n and CTK_0=TK, where f() is a key derivation function, such as one that complies with NIST Recommendation for Key Derivation Using Pseudorandom Functions <a class='info' href='#NIST SP 800-108'>[NIST SP 800&#8209;108]<span> (</span><span class='info'>Chen, L., &ldquo;Recommendation for Key Derivation Using Pseudorandom Functions,&rdquo; April&nbsp;2008.</span><span>)</span></a>. CTK_n SHOULD serve as the key to derive further keys.  Figure 1 depicts the key hierarchy in the case of a single inner method. Transient keys derived from the  compound key CTK are used in a cryptographic protocol to verify the integrity of the tunnel and the inner authentication method. 
</p><br /><hr class="insert" />
<a name="compoundkeys"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
                            -----------
                            | TK | MK |
                            -----------
                               |   |
                               v   v
                             --------
                             | CTK  |
                             --------
                                 |
                                 v
                          ----------------
                          |      |       |
                          v      v       v
                      -------  ------  -------
                      | TEK | | MSK | | EMSK |
                      ------- ------- --------
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: Compound Keys&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>Furthermore, all compound keys CTK_i and all keys derived from it
SHOULD be derived in accordance to the guidelines for key derivations and key 
hierarchies as specified in <a class='info' href='#keyest'>Section&nbsp;4.2.1.1.3<span> (</span><span class='info'>Tunnel Authentication and Key Establishment</span><span>)</span></a>. In particular, all derived keys 
MUST have a lifetime assigned that does not exceed the lifetime of any key 
higher in the key hierarchy.  The derivation MUST prevent a compromise in one part of the system from leading to compromises in other parts of the system that relay on keys at the same or higher level in the hierarchy.
</p>
<a name="anchor44"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.6.4"></a><h3>4.6.4.&nbsp;
Peer Initiated</h3>

<p>The tunnel method SHOULD allow for the peer to initiate an inner EAP authentication in order to meet its policy requirements for authenticating the server. 
</p>
<a name="anchor45"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.6.5"></a><h3>4.6.5.&nbsp;
Method Meta-data</h3>

<p>The tunnel method SHOULD allow for the communication of additional data associated with an EAP method. This can be used to indicate whether the authentication is for a user or a machine. This allows the EAP server and peer to request and negotiate authentication  specifically for a user or machine. This is useful in the case of multiple inner EAP authentications where the user and machine both need to be authenticated. 
</p>
<a name="anchor46"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
IANA Considerations</h3>

<p>This document has no IANA considerations.
</p>
<a name="Security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Security Considerations</h3>

<p>A tunnel method is often deployed to provide mutual authentication between EAP Peer and EAP Server and to generate key material for use in protecting lower layer protocols.  In addition the tunnel is used to protect the communication of additional data, including peer identity between the EAP Peer and EAP Server from disclosure to or modification by an attacker.  These sections cover considerations that affect the ability for a method to achieve these goals.  

</p>
<a name="secciph"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
Cipher Suite Selection</h3>

<p>TLS supports a wide variety of cipher suites providing a variety of
   security properties.  The selection of cipher suites is
   critical to the security of the tunnel method.  Selection of a cipher
   suite with weak or no authentication, such as an anonymous Diffie-
   Hellman based cipher suite will greatly increase the risk of system
   compromise.  Since a tunnel method uses the TLS tunnel to transport
   data, the selection of a ciphersuite with weak data encryption and
   integrity algorithms will also increase the vulnerability of the
   method to attacks. 
</p>
<p>A tunnel protocol is prone to downgrading attacks if the tunnel
   protocol supports any key establishment algorithm that can be broken
   on-line.  In a successful downgrading attack, an adversary breaks the
   selected "weak" key establishment algorithm and optionally the "weak"
   authentication algorithm without being detected.  Here, "weak" refers
   to a key establishment algorithm that can be broken in real-time, and
   an authentication scheme that can be broken off-line, respectively. See <a class='info' href='#KHLC07'>[KHLC07]<span> (</span><span class='info'>Hoeper, K. and L. Chen, &ldquo;Where EAP Security Claims Fail,&rdquo; August&nbsp;2007.</span><span>)</span></a> for more details.  The
   requirements in this document disapprove the use of key establishment
   algorithms that can be broken on-line. 
</p>
<p>Mutually anonymous tunnel protocols are prone to man-in-the-middle attacks described in <a class='info' href='#KHLC07'>[KHLC07]<span> (</span><span class='info'>Hoeper, K. and L. Chen, &ldquo;Where EAP Security Claims Fail,&rdquo; August&nbsp;2007.</span><span>)</span></a>.
   During such an attack, an adversary establishes a tunnel with each the peer and the
   authentication server, while peer and server believe that they established a tunnel with each other.  Once both tunnels have been
   established, the adversary can eavesdrop on all communications within
   the tunnels, i.e. the execution of the inner authentication method(s).
   Consequently, the adversary can eavesdrop on the identifiers that are
   exchanged as part of the EAP method and thus, the privacy of peer
   and/or authentication server is compromised along with any other data
   transmitted within the tunnels. This document requires server authentication to avoid the risks associated with anonymous cipher suites.

</p>
<a name="anchor47"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
Tunneled Authentication</h3>

<p>In many cases a tunnel method provides mutual authentication by
   authenticating the server during tunnel establishment and
   authenticating the peer within the tunnel using an EAP method.  As
   described in <a class='info' href='#TUNNEL-MITM'>[TUNNEL&#8209;MITM]<span> (</span><span class='info'>Asokan, N., Niemi, V., and K. Nyberg, &ldquo;Man-in-the-Middle in Tunnelled Authentication Protocols,&rdquo; November&nbsp;2002.</span><span>)</span></a>, this mode of operation can allow tunnel man-in-the-middle attackers to authenticate to the server as the peer by tunneling
   the inner EAP protocol messages to and from a peer executing the
   method outside a tunnel or with an untrustworthy server.
   Cryptographic binding between the established keying material from the inner authentication
   method(s) and the tunnel protocol verifies that the endpoints of the tunnel
   and the inner authentication method(s) are the same. This can thwart the
   attack if the inner method derived keys of sufficient strength that
   they cannot be broken in real-time. 
</p>
<p>In cases where the inner authentication method does not generate any or
   only weak key material, security policies must be enforced such that the peer cannot execute the inner method with the same credentials outside a protective tunnel or with an untrustworthy server.

</p>
<a name="anchor48"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.3"></a><h3>6.3.&nbsp;
Data External to Tunnel</h3>

<p>The tunnel method will use data that is outside the TLS tunnel
  such as the EAP type code or version numbers.  If an attacker
  can compromise the protocol by modifying these values the tunnel
  method MUST protect this data from modification.  In some cases external data may not need additional protection because it is implicitly verified during the protocol operation. 
</p>
<a name="anchor49"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.4"></a><h3>6.4.&nbsp;
Separation of TLS Tunnel and Inner Authentication Termination</h3>

<p>Terminating the inner method at a different location than the outer tunnel needs careful consideration. The inner method data may be vulnerable to modification and eavesdropping between the server that terminates the tunnel and the server that terminates the inner method. For example if a clear text password is used then it may be sent to the inner method server in a RADIUS password attribute which uses weak encryption that may not be suitable protection for many environments.
</p>
<p>In some cases terminating the tunnel at a different location may make it difficult for a peer to authenticate the server and trust it for further communication. For example, if the TLS tunnel is terminated by a different organization the peer needs to be able to authenticate and authorize the tunnel server to handle secret credentials that it shares with the home server that terminates the inner method. This may not meet the security policy of many environments. 
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>7.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.clancy-emu-chbind">[I-D.clancy-emu-chbind]</a></td>
<td class="author-text">Clancy, C. and K. Hoeper, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-clancy-emu-chbind-04.txt">Channel Binding Support for EAP Methods</a>,&rdquo; draft-clancy-emu-chbind-04 (work in progress), November&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-clancy-emu-chbind-04.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2560">[RFC2560]</a></td>
<td class="author-text"><a href="mailto:mmyers@verisign.com">Myers, M.</a>, <a href="mailto:rankney@erols.com">Ankney, R.</a>, <a href="mailto:ambarish@valicert.com">Malpani, A.</a>, <a href="mailto:galperin@mycfo.com">Galperin, S.</a>, and <a href="mailto:cadams@entrust.com">C. Adams</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2560">X.509 Internet Public Key Infrastructure Online Certificate Status Protocol - OCSP</a>,&rdquo; RFC&nbsp;2560, June&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2560.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3629">[RFC3629]</a></td>
<td class="author-text">Yergeau, F., &ldquo;<a href="http://tools.ietf.org/html/rfc3629">UTF-8, a transformation format of ISO 10646</a>,&rdquo; STD&nbsp;63, RFC&nbsp;3629, November&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3629.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3748">[RFC3748]</a></td>
<td class="author-text">Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H. Levkowetz, &ldquo;<a href="http://tools.ietf.org/html/rfc3748">Extensible Authentication Protocol (EAP)</a>,&rdquo; RFC&nbsp;3748, June&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3748.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4017">[RFC4017]</a></td>
<td class="author-text">Stanley, D., Walker, J., and B. Aboba, &ldquo;<a href="http://tools.ietf.org/html/rfc4017">Extensible Authentication Protocol (EAP) Method Requirements for Wireless LANs</a>,&rdquo; RFC&nbsp;4017, March&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4017.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4962">[RFC4962]</a></td>
<td class="author-text">Housley, R. and B. Aboba, &ldquo;<a href="http://tools.ietf.org/html/rfc4962">Guidance for Authentication, Authorization, and Accounting (AAA) Key Management</a>,&rdquo; BCP&nbsp;132, RFC&nbsp;4962, July&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4962.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5055">[RFC5055]</a></td>
<td class="author-text">Freeman, T., Housley, R., Malpani, A., Cooper, D., and W. Polk, &ldquo;<a href="http://tools.ietf.org/html/rfc5055">Server-Based Certificate Validation Protocol (SCVP)</a>,&rdquo; RFC&nbsp;5055, December&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc5055.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5246">[RFC5246]</a></td>
<td class="author-text">Dierks, T. and E. Rescorla, &ldquo;<a href="http://tools.ietf.org/html/rfc5246">The Transport Layer Security (TLS) Protocol Version 1.2</a>,&rdquo; RFC&nbsp;5246, August&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5246.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5247">[RFC5247]</a></td>
<td class="author-text">Aboba, B., Simon, D., and P. Eronen, &ldquo;<a href="http://tools.ietf.org/html/rfc5247">Extensible Authentication Protocol (EAP) Key Management Framework</a>,&rdquo; RFC&nbsp;5247, August&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5247.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>7.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.mahy-eap-enrollment">[I-D.mahy-eap-enrollment]</a></td>
<td class="author-text">Mahy, R., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-mahy-eap-enrollment-01.txt">An Extensible Authentication Protocol (EAP) Enrollment Method</a>,&rdquo; draft-mahy-eap-enrollment-01 (work in progress), March&nbsp;2006 (<a href="http://www.ietf.org/internet-drafts/draft-mahy-eap-enrollment-01.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="KHLC07">[KHLC07]</a></td>
<td class="author-text">Hoeper, K. and L. Chen, &ldquo;Where EAP Security Claims Fail,&rdquo; ICST QShine&nbsp;, August&nbsp;2007.</td></tr>
<tr><td class="author-text" valign="top"><a name="NIST SP 800-108">[NIST SP 800-108]</a></td>
<td class="author-text">Chen, L., &ldquo;Recommendation for Key Derivation Using Pseudorandom Functions,&rdquo; Draft NIST Special Publication&nbsp;800-108, April&nbsp;2008.</td></tr>
<tr><td class="author-text" valign="top"><a name="NIST SP 800-120">[NIST SP 800-120]</a></td>
<td class="author-text">Hoeper, K. and L. Chen, &ldquo;Recommendation for EAP Methods Used in Wireless Network Access Authentication,&rdquo; NIST Special Publication&nbsp;800-120, September&nbsp;2009.</td></tr>
<tr><td class="author-text" valign="top"><a name="NIST SP 800-57">[NIST SP 800-57]</a></td>
<td class="author-text">Barker, E., Barker, W., Burr, W., Polk, W., and M. Smid, &ldquo;Recommendation for Key Management - Part 1: General (Revised),&rdquo; NIST Special Publication&nbsp;800-57, part 1, March&nbsp;2007.</td></tr>
<tr><td class="author-text" valign="top"><a name="NIST SP 800-57p3">[NIST SP 800-57p3]</a></td>
<td class="author-text">Barker, E., Burr, W., Jones, A., Polk, W., , S., and M. Smid, &ldquo;Recommendation for Key Management, Part 3 Application-Specific Key Management Guidance,&rdquo; Draft NIST Special Publication&nbsp;800-57,part 3, October&nbsp;2008.</td></tr>
<tr><td class="author-text" valign="top"><a name="PEAP">[PEAP]</a></td>
<td class="author-text">Microsoft Corporation, &ldquo;<a href="http://download.microsoft.com/download/9/5/E/95EF66AF-9026-4BB0-A41D-A4F81802D92C/%5BMS-PEAP%5D.pdf">[MS-PEAP]: Protected Extensible Authentication Protocol (PEAP) Specification</a>,&rdquo; August&nbsp;2009.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4013">[RFC4013]</a></td>
<td class="author-text">Zeilenga, K., &ldquo;<a href="http://tools.ietf.org/html/rfc4013">SASLprep: Stringprep Profile for User Names and Passwords</a>,&rdquo; RFC&nbsp;4013, February&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4013.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4282">[RFC4282]</a></td>
<td class="author-text">Aboba, B., Beadles, M., Arkko, J., and P. Eronen, &ldquo;<a href="http://tools.ietf.org/html/rfc4282">The Network Access Identifier</a>,&rdquo; RFC&nbsp;4282, December&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4282.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4851">[RFC4851]</a></td>
<td class="author-text">Cam-Winget, N., McGrew, D., Salowey, J., and H. Zhou, &ldquo;<a href="http://tools.ietf.org/html/rfc4851">The Flexible Authentication via Secure Tunneling Extensible Authentication Protocol Method (EAP-FAST)</a>,&rdquo; RFC&nbsp;4851, May&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4851.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5077">[RFC5077]</a></td>
<td class="author-text">Salowey, J., Zhou, H., Eronen, P., and H. Tschofenig, &ldquo;<a href="http://tools.ietf.org/html/rfc5077">Transport Layer Security (TLS) Session Resumption without Server-Side State</a>,&rdquo; RFC&nbsp;5077, January&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5077.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5198">[RFC5198]</a></td>
<td class="author-text">Klensin, J. and M. Padlipsky, &ldquo;<a href="http://tools.ietf.org/html/rfc5198">Unicode Format for Network Interchange</a>,&rdquo; RFC&nbsp;5198, March&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5198.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5209">[RFC5209]</a></td>
<td class="author-text">Sangster, P., Khosravi, H., Mani, M., Narayan, K., and J. Tardo, &ldquo;<a href="http://tools.ietf.org/html/rfc5209">Network Endpoint Assessment (NEA): Overview and Requirements</a>,&rdquo; RFC&nbsp;5209, June&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5209.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5281">[RFC5281]</a></td>
<td class="author-text">Funk, P. and S. Blake-Wilson, &ldquo;<a href="http://tools.ietf.org/html/rfc5281">Extensible Authentication Protocol Tunneled Transport Layer Security Authenticated Protocol Version 0 (EAP-TTLSv0)</a>,&rdquo; RFC&nbsp;5281, August&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5281.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5646">[RFC5646]</a></td>
<td class="author-text">Phillips, A. and M. Davis, &ldquo;<a href="http://tools.ietf.org/html/rfc5646">Tags for Identifying Languages</a>,&rdquo; BCP&nbsp;47, RFC&nbsp;5646, September&nbsp;2009 (<a href="http://www.rfc-editor.org/rfc/rfc5646.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5793">[RFC5793]</a></td>
<td class="author-text">Sahita, R., Hanna, S., Hurst, R., and K. Narayan, &ldquo;<a href="http://tools.ietf.org/html/rfc5793">PB-TNC: A Posture Broker (PB) Protocol Compatible with Trusted Network Connect (TNC)</a>,&rdquo; RFC&nbsp;5793, March&nbsp;2010 (<a href="http://www.rfc-editor.org/rfc/rfc5793.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="TUNNEL-MITM">[TUNNEL-MITM]</a></td>
<td class="author-text">Asokan, N., Niemi, V., and K. Nyberg, &ldquo;Man-in-the-Middle in Tunnelled Authentication Protocols,&rdquo; Cryptology ePrint Archive: &nbsp;Report 2002/163, November&nbsp;2002.</td></tr>
</table>

<a name="anchor52"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Changes from -01</h3>

<ul class="text">
<li>Added combined mutual authentication in section 3.1
</li>
<li>Changed reference from SP 800-52 to SP 800-57,part 3
</li>
<li>In section 6.2 changed terminology to tunnel MitM and security policy enforcement
</li>
<li>Reworded text in section 3.2 to clarify MITM protection
</li>
<li>Added more specific text about derivation of the CTK
</li>
<li>Removed resource constrained section
</li>
<li>Added support for Non EAP authentication as a use for extensibility
</li>
<li>Added text to emergency services section to emphasize that sensitive information should not be sent if the server is unauthenticated.
</li>
<li>Reworded TLS requirements
</li>
<li>Reworded external data protection requirements
</li>
<li>Added text to section 4.6 that states method must not be re-defined inside the tunnel. 
</li>
<li>Editorial fixes
</li>
</ul>
<a name="anchor53"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B"></a><h3>Appendix B.&nbsp;
Changes from -02</h3>

<ul class="text">
<li>Editorial Fixes
</li>
<li>Clarified client authentication during tunnel establishment
</li>
<li>Changed text so that the tunnel method MUST meet all MUST and SHOULD requirements relevant to EAP methods in RFCs 4962 and 5247
</li>
</ul>
<a name="anchor54"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C"></a><h3>Appendix C.&nbsp;
changes from -03</h3>

<ul class="text">
<li>Resolution of open issues: http://trac.tools.ietf.org/wg/emu/trac/report/9
</li>
<li>Revised section 2 to match other similar RFC(Issue 6)
</li>
<li>Cleaned up section 3.2 (issue 8)
</li>
<li>Clarified identity protection scope in section 3.4 and 4.2.1.4(issue 9)
</li>
<li>Changed Emergency Services to anonymous authentication(section 3.5)(issue 10)
</li>
<li>Clarified section 4.1.1 (issue 15)
</li>
<li>Cleaned up TLS requirements in section 4.2.1(issue 11)
</li>
<li>Replaced text in 4.2.1.1.3 with suitable reference
</li>
<li>Improved wording in 4.2.3 and 6.3 (issue 13)
</li>
<li>Update internationalization requirements in 4.3.6 and 4.5.2 (Issues 25,18)
</li>
<li>Updated text in 4.5.1 (issue 16)
</li>
<li>Changed meta-data to SHOULD in 4.5.3 and 4.6.5(Issue 20)
</li>
<li>Changed chained methods to SHOULD in 4.6.2(issue 19)
</li>
<li>Added security consideration for inner method termination(issue 24)
</li>
<li>Updated references
</li>
<li>Editorial changes(issues 7,22,17)
</li>
</ul>
<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Katrin Hoeper</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Motorola, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">1301 E Algonquin Rd</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Schaumburg, IL  60196</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:khoeper@motorola.com">khoeper@motorola.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Stephen Hanna</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Juniper Networks</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">3 Beverly Road</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Bedford, MA  01730</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:shanna@juniper.net">shanna@juniper.net</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Hao Zhou</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">4125 Highlander Parkway</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Richfield, OH  44286</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:hzhou@cisco.com">hzhou@cisco.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Joseph Salowey (editor)</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">2901 3rd. Ave</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Seattle, WA  98121</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:jsalowey@cisco.com">jsalowey@cisco.com</a></td></tr>
</table>
</body></html>
