<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>JSON Web Token (JWT) Bearer Token Profiles for OAuth 2.0</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Notational Conventions">
<link href="#rfc.section.1.2" rel="Chapter" title="1.2 Terminology">
<link href="#rfc.section.2" rel="Chapter" title="2 HTTP Parameter Bindings for Transporting Assertions">
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 Using JWTs as Authorization Grants">
<link href="#rfc.section.2.2" rel="Chapter" title="2.2 Using JWTs for Client Authentication">
<link href="#rfc.section.3" rel="Chapter" title="3 JWT Format and Processing Requirements">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 Authorization Grant Processing">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 Client Authentication Processing">
<link href="#rfc.section.4" rel="Chapter" title="4 Authorization Grant Example">
<link href="#rfc.section.5" rel="Chapter" title="5 Security Considerations">
<link href="#rfc.section.6" rel="Chapter" title="6 IANA Considerations">
<link href="#rfc.section.6.1" rel="Chapter" title="6.1 Sub-Namespace Registration of urn:ietf:params:oauth:grant-type:jwt-bearer">
<link href="#rfc.section.6.2" rel="Chapter" title="6.2 Sub-Namespace Registration of urn:ietf:params:oauth:client-assertion-type:jwt-bearer">
<link href="#rfc.references" rel="Chapter" title="7 References">
<link href="#rfc.references.1" rel="Chapter" title="7.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="7.2 Informative References">
<link href="#rfc.appendix.Appendix%20A" rel="Chapter" title="Appendix A Acknowledgements">
<link href="#rfc.appendix.Appendix%20B" rel="Chapter" title="Appendix B Document History">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="This specification defines the use of a JSON Web Token (JWT) Bearer Token as means for requesting an OAuth 2.0 access token as well as for use as a means of client authentication.  " />
  <meta name="description" content="This specification defines the use of a JSON Web Token (JWT) Bearer Token as means for requesting an OAuth 2.0 access token as well as for use as a means of client authentication.  " />
  <meta name="keywords" content="OAuth, JWT, Assertion, Token, Security Token" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Network Working Group</td>
<td class="right">M.B. Jones</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Microsoft</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">B. Campbell</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Ping Identity Corp.</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">C. Mortimore</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Salesforce.com</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Oct 31, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">JSON Web Token (JWT) Bearer Token Profiles for OAuth 2.0<br />
  <span class="filename">draft-jones-oauth-jwt-bearer-01</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>This specification defines the use of a JSON Web Token (JWT) Bearer Token as means for requesting an OAuth 2.0 access token as well as for use as a means of client authentication.  </p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>1.1.   <a href="#rfc.section.1.1">Notational Conventions</a>
</li>
<li>1.2.   <a href="#rfc.section.1.2">Terminology</a>
</li>
<li>2.   <a href="#rfc.section.2">HTTP Parameter Bindings for Transporting Assertions</a>
</li>
<li>2.1.   <a href="#rfc.section.2.1">Using JWTs as Authorization Grants</a>
</li>
<li>2.2.   <a href="#rfc.section.2.2">Using JWTs for Client Authentication</a>
</li>
<li>3.   <a href="#rfc.section.3">JWT Format and Processing Requirements</a>
</li>
<li>3.1.   <a href="#rfc.section.3.1">Authorization Grant Processing</a>
</li>
<li>3.2.   <a href="#rfc.section.3.2">Client Authentication Processing</a>
</li>
<li>4.   <a href="#rfc.section.4">Authorization Grant Example</a>
</li>
<li>5.   <a href="#rfc.section.5">Security Considerations</a>
</li>
<li>6.   <a href="#rfc.section.6">IANA Considerations</a>
</li>
<li>6.1.   <a href="#rfc.section.6.1">Sub-Namespace Registration of urn:ietf:params:oauth:grant-type:jwt-bearer</a>
</li>
<li>6.2.   <a href="#rfc.section.6.2">Sub-Namespace Registration of urn:ietf:params:oauth:client-assertion-type:jwt-bearer</a>
</li>
<li>7.   <a href="#rfc.references">References</a>
</li>
<li>7.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>7.2.   <a href="#rfc.references.2">Informative References</a>
</li>
<li>Appendix A.   <a href="#rfc.appendix.Appendix%20A">Acknowledgements</a>
</li>
<li>Appendix B.   <a href="#rfc.appendix.Appendix%20B">Document History</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> Introduction</h1>
<p id="rfc.section.1.p.1">JSON Web Token (JWT) <a href="#JWT">[JWT]</a> is a JSON-based security token encoding that enables identity and security information to be shared across security domains.  JWTs utilize JSON data structures, as defined in <a href="#RFC4627">RFC 4627</a> <cite title="NONE">[RFC4627]</cite>.  A security token is generally issued by an identity provider and consumed by a relying party that relies on its content to identify the token's subject for security related purposes.  </p>
<p><a href="#I-D.ietf.oauth-v2">The OAuth 2.0 Authorization Protocol</a> <cite title="NONE">[I-D.ietf.oauth-v2]</cite> provides a method for making authenticated HTTP requests to a resource using an access token.  Access tokens are issued to third-party clients by an authorization server (AS) with the (sometimes implicit) approval of the resource owner.  In OAuth, an authorization grant is an abstract term used to describe intermediate credentials that represent the resource owner authorization.  An authorization grant is used by the client to obtain an access token.  Several authorization grant types are defined to support a wide range of client types and user experiences.  OAuth also allows for the definition of new extension grant types to support additional clients or to provide a bridge between OAuth and other trust frameworks.  Finally, OAuth allows the definition of additional authentication mechanisms to be used by clients when interacting with the authorization server.  </p>
<p id="rfc.section.1.p.3">The <a href="#I-D.ietf.oauth-assertions">OAuth 2.0 Assertion Profile</a> <cite title="NONE">[I-D.ietf.oauth-assertions]</cite> is an abstract extension to OAuth 2.0 that provides a general framework for the use of Assertions (a.k.a. Security Tokens) as client credentials and/or authorization grants with OAuth 2.0.  This specification profiles the <a href="#I-D.ietf.oauth-assertions">OAuth 2.0 Assertion Profile</a> <cite title="NONE">[I-D.ietf.oauth-assertions]</cite> to define an extension grant type that uses a JSON Web Token (JWT) Bearer Token to request an OAuth 2.0 access token as well as for use as client credentials.  The format and processing rules for the JWT defined in this specification are intentionally similar, though not identical, to those in the closely related SAML 2.0 Bearer Assertion Profiles for OAuth 2.0 <a href="#I-D.ietf-oauth-saml2-bearer">[I-D.ietf-oauth-saml2-bearer]</a>.  </p>
<p id="rfc.section.1.p.4">This document defines how a JSON Web Token (JWT) Bearer Token can be used to request an access token when a client wishes to utilize an existing trust relationship, expressed through the semantics of (and digital signature calculated over) the JWT, without a direct user approval step at the authorization server.  It also defines how a JWT can be used as a client authentication mechanism.  The use of a security token for client authentication is orthogonal and separable from using a security token as an authorization grant and the two can be used either in combination or in isolation.  </p>
<p id="rfc.section.1.p.5">The process by which the client obtains the JWT, prior to exchanging it with the authorization server or using it for client authentication, is out of scope.</p>
<h1 id="rfc.section.1.1">
<a href="#rfc.section.1.1">1.1.</a> Notational Conventions</h1>
<p id="rfc.section.1.1.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">RFC 2119</a> <cite title="NONE">[RFC2119]</cite>.  </p>
<p id="rfc.section.1.1.p.2">Unless otherwise noted, all the protocol parameter names and values are case sensitive.  </p>
<h1 id="rfc.section.1.2">
<a href="#rfc.section.1.2">1.2.</a> Terminology</h1>
<p id="rfc.section.1.2.p.1">All terms are as defined in <a href="#I-D.ietf.oauth-v2">[I-D.ietf.oauth-v2]</a>, <a href="#I-D.ietf.oauth-assertions">[I-D.ietf.oauth-assertions]</a>, and <a href="#JWT">[JWT]</a>.  </p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> HTTP Parameter Bindings for Transporting Assertions</h1>
<p id="rfc.section.2.p.1">The <a href="#I-D.ietf.oauth-assertions">OAuth 2.0 Assertion Profile</a> <cite title="NONE">[I-D.ietf.oauth-assertions]</cite> defines generic HTTP parameters for transporting Assertions (a.k.a. Security Tokens) during interactions with a token endpoint.  This section defines the values of those parameters for use with JWT Bearer Tokens.  </p>
<h1 id="rfc.section.2.1">
<a href="#rfc.section.2.1">2.1.</a> Using JWTs as Authorization Grants</h1>
<p id="rfc.section.2.1.p.1">To use a JWT Bearer Token as an authorization grant, use the following parameter values and encodings.</p>
<p id="rfc.section.2.1.p.2">The value of "grant_type" parameter MUST be "urn:ietf:params:oauth:grant-type:jwt-bearer"</p>
<p id="rfc.section.2.1.p.3">The value of the "assertion" parameter MUST contain a single JWT.  The SAML Assertion XML data MUST be encoded using base64url, where the encoding adheres to the definition in Section 5 of <a href="#RFC4648">RFC4648</a> <cite title="NONE">[RFC4648]</cite> and where the padding bits are set to zero.  To avoid the need for subsequent encoding steps (by <a href="#W3C.REC-html401-19991224">"application/x-www-form-urlencoded"</a> <cite title="NONE">[W3C.REC-html401-19991224]</cite>, for example), the base64url encoded data SHOULD NOT be line wrapped and pad characters ("=") SHOULD NOT be included.  </p>
<h1 id="rfc.section.2.2">
<a href="#rfc.section.2.2">2.2.</a> Using JWTs for Client Authentication</h1>
<p id="rfc.section.2.2.p.1">To use a JWT Bearer Token for client authentication grant, use the following parameter values and encodings.</p>
<p id="rfc.section.2.2.p.2">The value of "client_assertion_type" parameter MUST be "urn:ietf:params:oauth:client-assertion-type:jwt-bearer"</p>
<p id="rfc.section.2.2.p.3">The value of the "client_assertion" parameter MUST contain a single JWT.  The SAML Assertion XML data MUST be encoded using base64url, where the encoding adheres to the definition in Section 5 of <a href="#RFC4648">RFC4648</a> <cite title="NONE">[RFC4648]</cite> and where the padding bits are set to zero.  To avoid the need for subsequent encoding steps (by <a href="#W3C.REC-html401-19991224">"application/x-www-form-urlencoded"</a> <cite title="NONE">[W3C.REC-html401-19991224]</cite>, for example), the base64url encoded data SHOULD NOT be line wrapped and pad characters ("=") SHOULD NOT be included.  </p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#JWT_reqs" id="JWT_reqs">JWT Format and Processing Requirements</a>
</h1>
<p id="rfc.section.3.p.1">In order to issue an access token response as described in <a href="#I-D.ietf.oauth-v2">The OAuth 2.0 Authorization Protocol</a> <cite title="NONE">[I-D.ietf.oauth-v2]</cite> or to rely on a JWT for client authentication, the authorization server MUST validate the JWT according to the criteria below.  Application of additional restrictions and policy are at the discretion of the authorization server.  </p>
<p></p>

<ul>
<li>The JWT MUST contain an <samp>iss</samp> (issuer) claim that contains a unique identifier for the entity that issued the JWT.  </li>
<li>The JWT MUST contain a <samp>prn</samp> (principal) claim identifying the subject of the transaction.  The principal MAY identify the resource owner for whom the access token is being requested.  For client authentication, the principal MUST be the client_id of the OAuth client.  When using JWTs as an authorization grant, the principal SHOULD identify an authorized accessor for whom the access token is being requested (typically the resource owner, or an authorized delegate).  </li>
<li>The JWT MUST contain an <samp>aud</samp> (audience) claim containing a URI reference that identifies the authorization server, or the service provider principal entity of its controlling domain, as an intended audience.  The token endpoint URL of the authorization server MAY be used as an acceptable value for an <samp>aud</samp> element.  The authorization server MUST verify that it is an intended audience for the JWT.  </li>
<li>The JWT MUST contain an <samp>exp</samp> (expiration) claim that limits the time window during which the JWT can be used.  The authorization server MUST verify that the expiration time has not passed, subject to allowable clock skew between systems.  The authorization server MAY reject JWTs with an <samp>exp</samp> claim value that is unreasonably far in the future.  </li>
<li>The JWT MAY contain an <samp>nbf</samp> (not before) claim that identifies the time before which the token MUST NOT be accepted for processing.  </li>
<li>The JWT MAY contain other claims.  </li>
<li>The JWT MUST be digitally signed by the issuer and the authorization server MUST verify the signature.  </li>
<li>The authorization server MUST verify that the JWT is valid in all other respects per <a href="#JWT">[JWT]</a>.  </li>
</ul>

<p> </p>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> Authorization Grant Processing</h1>
<p id="rfc.section.3.1.p.1">If present, the authorization server MUST also validate the client credentials.</p>
<p id="rfc.section.3.1.p.2">Authorization servers SHOULD issue access tokens with a limited lifetime and require clients to refresh them by requesting a new access token using the same JWT, if it is still valid, or with a new JWT.  The authorization server SHOULD NOT issue a refresh token.</p>
<div id="#rfc.figure.1"></div>
<p id="rfc.section.3.1.p.3">If the JWT is not valid, or the current time is not within the token's valid time window for use, the authorization server MUST construct an error response as defined in <a href="#I-D.ietf.oauth-v2">[I-D.ietf.oauth-v2]</a>.  The value of the error parameter MUST be the "invalid_grant" error code.  The authorization server MAY include additional information regarding the reasons the JWT was considered invalid using the error_description or error_uri parameters.  </p>

<p>For example:</p>
<pre>HTTP/1.1 400 Bad Request
Content-Type: application/json
Cache-Control: no-store

{
 "error":"invalid_grant",
 "error_description":"Audience validation failed"
}</pre>
<h1 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> Client Authentication Processing</h1>
<p id="rfc.section.3.2.p.1">If the client JWT is not valid, or its subject confirmation requirements cannot be met, the authorization server MUST construct an error response as defined in <a href="#I-D.ietf.oauth-v2">[I-D.ietf.oauth-v2]</a>.  The value of the error parameter MUST be the "invalid_client" error code.  The authorization server MAY include additional information regarding the reasons the JWT was considered invalid using the error_description or error_uri parameters.  </p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#example" id="example">Authorization Grant Example</a>
</h1>
<p id="rfc.section.4.p.1">Though non-normative, the following examples illustrate what a conforming JWT and access token request would look like.  </p>
<div id="#rfc.figure.2"></div>
<p>Below is an example JSON object that could be encoded to produce the JWT Claims Object for a JWT: </p>
<pre>{"iss":"https://jwt-idp.example.com",
 "prn":"mailto:mike@example.com",
 "aud":"https://jwt-rp.example.net",
 "nbf":1300815780,
 "exp":1300819380,
 "http://claims.example.com/member":true}</pre>
<div id="#rfc.figure.3"></div>
<p>The following example JSON object, used as the header of a JWT, declares that the JWT is signed with the ECDSA P-256 SHA-256 algorithm.  </p>
<pre>{"alg":"ES256"}</pre>
<div id="#rfc.figure.4"></div>
<p>To present the JWT with the claims and header shown in the previous example as part of an access token request, for example, the client might make the following HTTPS request (line breaks are for display purposes only): </p>
<pre>POST /token.oauth2 HTTP/1.1
Host: authz.example.net
Content-Type: application/x-www-form-urlencoded

grant_type=urn%3Aietf%3Aparams%3Aoauth%3Agrant-type%3Ajwt-
bearer&amp;assertion=eyJhbGciOiJFUzI1NiJ9.
eyJpc3Mi[...omitted for brevity...].
J9l-ZhwP_2n[...omitted for brevity...]</pre>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#Security" id="Security">Security Considerations</a>
</h1>
<p id="rfc.section.5.p.1">No additional security considerations apply beyond those described within <a href="#I-D.ietf.oauth-v2">[I-D.ietf.oauth-v2]</a>, <a href="#I-D.ietf.oauth-assertions">[I-D.ietf.oauth-assertions]</a>, and <a href="#JWT">[JWT]</a>.  </p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> IANA Considerations</h1>
<h1 id="rfc.section.6.1">
<a href="#rfc.section.6.1">6.1.</a> Sub-Namespace Registration of urn:ietf:params:oauth:grant-type:jwt-bearer</h1>
<p id="rfc.section.6.1.p.1">This is a request to IANA to please register the value grant-type:jwt-bearer in the registry urn:ietf:params:oauth established in <a href="#I-D.ietf.oauth-urn-sub-ns">[I-D.ietf.oauth-urn-sub-ns]</a>.  </p>

<ul>
<li>URN: urn:ietf:params:oauth:grant-type:jwt-bearer</li>
<li>Common Name: JWT Bearer Token Grant Type Profile for OAuth 2.0</li>
<li>Change controller: IETF</li>
<li>Description: [[this document]]</li>
</ul>

<p> </p>
<h1 id="rfc.section.6.2">
<a href="#rfc.section.6.2">6.2.</a> Sub-Namespace Registration of urn:ietf:params:oauth:client-assertion-type:jwt-bearer</h1>
<p id="rfc.section.6.2.p.1">This is a request to IANA to please register the value client-assertion-type:jwt-bearer in the registry urn:ietf:params:oauth established in <a href="#I-D.ietf.oauth-urn-sub-ns">[I-D.ietf.oauth-urn-sub-ns]</a>.  </p>

<ul>
<li>URN: urn:ietf:params:oauth:client-assertion-type:jwt-bearer</li>
<li>Common Name: JWT Bearer Token Profile for OAuth 2.0 Client Authentication </li>
<li>Change controller: IETF</li>
<li>Description: [[this document]]</li>
</ul>

<p> </p>
<h1 id="rfc.references">
<a href="#rfc.references">7.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">7.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4627">[RFC4627]</b></td>
<td class="top">
<a>Crockford, D.</a>, "<a href="http://tools.ietf.org/html/rfc4627">The application/json Media Type for JavaScript Object Notation (JSON)</a>", RFC 4627, July 2006.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4648">[RFC4648]</b></td>
<td class="top">
<a>Josefsson, S.</a>, "<a href="http://tools.ietf.org/html/rfc4648">The Base16, Base32, and Base64 Data Encodings</a>", RFC 4648, October 2006.</td>
</tr>
<tr>
<td class="reference"><b id="JWT">[JWT]</b></td>
<td class="top">
<a href="mailto:mbj@microsoft.com" title="Microsoft">Jones, M.B.</a>, <a href="mailto:balfanz@google.com" title="Google">Balfanz, D.</a>, <a href="mailto:ve7jtb@ve7jtb.com" title="independent">Bradley, J.</a>, <a href="mailto:yarong@microsoft.com" title="Microsoft">Goland, Y.Y.</a>, <a href="mailto:jpanzer@google.com" title="Google">Panzer, J.</a>, <a href="mailto:n-sakimura@nri.co.jp" title="Nomura Research Institute">Sakimura, N.</a> and <a href="mailto:pt@fb.com" title="Facebook">P. Tarjan</a>, "<a>JSON Web Token (JWT)</a>", October 2011.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf.oauth-assertions">[I-D.ietf.oauth-assertions]</b></td>
<td class="top">
<a>Mortimore, C.</a>, <a>Campbell, B.</a>, <a>Jones, M.B.</a> and <a>Y.Y. Goland</a>, "<a>OAuth 2.0 Assertion Profile</a>", ID draft-ietf-oauth-assertions-01 (work in progress), October 2011.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf.oauth-urn-sub-ns">[I-D.ietf.oauth-urn-sub-ns]</b></td>
<td class="top">
<a>Campbell, B.</a> and <a>H. Tschofenig</a>, "<a>An IETF URN Sub-Namespace for OAuth</a>", ID draft-ietf-oauth-urn-sub-ns-00 (work in progress), Aug 2011.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf.oauth-v2">[I-D.ietf.oauth-v2]</b></td>
<td class="top">
<a>Hammer-Lahav, E.</a>, <a>Recordon, D.</a> and <a>D. Hardt</a>, "<a>The OAuth 2.0 Authorization Protocol</a>", ID draft-ietf-oauth-v2-22 (work in progress), September 2011.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">7.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="I-D.ietf-oauth-saml2-bearer">[I-D.ietf-oauth-saml2-bearer]</b></td>
<td class="top">
<a>Mortimore, C</a>, "<a href="http://tools.ietf.org/html/draft-ietf-oauth-saml2-bearer-09">SAML 2.0 Bearer Assertion Profiles for OAuth 2.0</a>", Internet-Draft draft-ietf-oauth-saml2-bearer-09, October 2011.</td>
</tr>
<tr>
<td class="reference"><b id="W3C.REC-html401-19991224">[W3C.REC-html401-19991224]</b></td>
<td class="top">
<a>Raggett, D.</a>, <a>Hors, A.</a> and <a>I. Jacobs</a>, "<a>HTML 4.01 Specification</a>", World Wide Web Consortium Recommendation REC-html401-19991224, December 1999.</td>
</tr>
</tbody></table>
<h1 id="rfc.appendix.Appendix A">
<a href="#rfc.appendix.Appendix%20A">Appendix A.</a> Acknowledgements</h1>
<p id="rfc.section.Appendix A.p.1">This profile was derived from the SAML 2.0 Bearer Assertion Profiles for OAuth 2.0 <a href="#I-D.ietf-oauth-saml2-bearer">[I-D.ietf-oauth-saml2-bearer]</a> by Brian Campbell and Chuck Mortimore.  </p>
<h1 id="rfc.appendix.Appendix B">
<a href="#rfc.appendix.Appendix%20B">Appendix B.</a> Document History</h1>
<p id="rfc.section.Appendix B.p.1">[[ to be removed by RFC editor before publication as an RFC ]] </p>
<p id="rfc.section.Appendix B.p.2">-01 </p>

<ul><li>Merged in changes from draft-ietf-oauth-saml2-bearer-09.  In particular, this draft now uses draft-ietf-oauth-assertions, rather than being standalone.  It also now defines how to use JWT bearer tokens both for Authorization Grants and for Client Authentication.  </li></ul>

<p> </p>
<p id="rfc.section.Appendix B.p.3">-00 </p>

<ul><li>Initial draft.  </li></ul>

<p> </p>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Michael B. Jones</span> 
	  <span class="n hidden">
		<span class="family-name">Jones</span>
	  </span>
	</span>
	<span class="org vcardline">Microsoft</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:mbj@microsoft.com">mbj@microsoft.com</a></span>

<span class="vcardline">URI: <a href="http://self-issued.info/">http://self-issued.info/</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Brian Campbell</span> 
	  <span class="n hidden">
		<span class="family-name">Campbell</span>
	  </span>
	</span>
	<span class="org vcardline">Ping Identity Corp.</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:brian.d.campbell@gmail.com">brian.d.campbell@gmail.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Chuck Mortimore</span> 
	  <span class="n hidden">
		<span class="family-name">Mortimore</span>
	  </span>
	</span>
	<span class="org vcardline">Salesforce.com</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:cmortimore@salesforce.com">cmortimore@salesforce.com</a></span>

  </address>
</div>

</body>
</html>