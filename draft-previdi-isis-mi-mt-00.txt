Network Working Group                                        S. Previdi
Internet Draft                                                  D. Ward
                                                            L. Ginsberg
Expires: February, 2006                                          A. Roy
                                                     Cisco Systems, Inc
                                                           August, 2005


                  IS-IS Multi-instance Multi-topology
                     draft-previdi-isis-mi-mt-00.txt


Status of this Memo

   By submitting this Internet-Draft, each author represents that any
   applicable patent or other IPR claims of which he or she is aware
   have been or will be disclosed, and any of which he or she becomes
   aware will be disclosed, in accordance with Section 6 of BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups. Note that 
   other groups may also distribute working documents as Internet-
   Drafts.

   Internet-Drafts are draft documents valid for a maximum of six 
   months and may be updated, replaced, or obsoleted by other 
   documents at any time. It is inappropriate to use Internet-Drafts 
   as reference material or to cite them other than as "work in 
   progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/1id-abstracts.html

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html





















Previdi, et al                                                 [Page 1]


Internet Draft         Multi-Instance IS-IS                August, 2005



Abstract

   This draft describes a mechanism that allows a single router to 
   share one or more links among multiple IS-IS routing protocol 
   instances.
   Multiple instances allow the deployment of multiple address-families
   as well as multiple instances of the same address-family and it is 
   an alternative to Multi-Topology IS-IS. Routers supporting the same
   instance will form adjacencies, exchange routing updates and compute
   paths. Each PDU will contain a new TLV identifying the instance to
   which the PDU belongs. This allows a network operator to deploy
   multiple IS-IS topologies in parallel, using the same set of links
   when required and still have the capability of computing topology
   specific paths. This draft does not address the forwarding paradigm
   that needs to be used in order to ensure data PDUs are forwarded
   according to the topology to which they belong.

1. Conventions used in this document

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED",  "MAY", and "OPTIONAL" in 
   this document are to be interpreted as described in RFC-2119 
   [KEYWORDS].

2. Introduction

   IS-IS has been already extended in order to support multiple
   topologies [MT-ISIS] through the use of additional TLVs in IIH/LSP
   PDUs. MT-ISIS specifies that a single adjacency, single flooding
   scheme, and single LSDB are to be shared across all topologies to
   which a router belongs. This draft describes an alternative approach
   where multiple topologies are supported by the use of multiple
   instances of the IS-IS protocol. Routers which support this
   extension are referred to as "multi-instance capable routers"
   (MI-RTR).

3. Proposed Solution

   The solution is based on a new TLV called the Instance Identifier
   (IID) that is used to mark each routing PDU originated by the 
   router. Routers form adjacencies and exchange routing updates only 
   if their IIDs correspond. Each topology is therefore processed 
   within a separate instance of the IS-IS   protocol.

   This also implies an instance specific flooding scheme, instance
   specific LSDBs and Instance specific routing calculations. It MAY 
   also imply instance specific routing and forwarding tables. However, 


Previdi, et al                                                 [Page 2]


Internet Draft         Multi-Instance IS-IS                August, 2005




   this aspect is outside the scope of this specification. When 
   multiple instances share the same link each instance will have a 
   separate set of adjacencies. Each IS-IS PDU is associated with 
   only one IS-IS instance.

   How multiple instances are implemented is outside the scope of 
   this specification.

3.1. Instance Identifier (IID)

   A new TLV is defined in order to convey an instance identifier 
   (IID). The scope of the IID is to mark each IS-IS instance running 
   on a router with a unique 16-bit number. The IID TLV is carried in 
   all IS-IS PDUs (IIH, SNP, LSP) originated by the router. Routers 
   have to exchange and agree on instance numbers so that IIDs can be 
   understood consistently across adjacencies and flooding domain. The 
   following format is used for the IID:

   TLV:
      Type:   TBD
      Length: 2
      Value:  <16-bit number IID>

3.2 Instance Membership

   Each router can be configured as part of one or more instances of 
   IS-IS. Each instance the router belongs to will correspond to the 
   value advertised in the IID TLV of IS-IS PDUs originated by that 
   instance. Only one IID can be advertised in an IIH, LSP, or SNP 
   PDU. PDUs with multiple IID TLVs MUST be ignored.

3.3 Adjacency Establishment

   In order to establish adjacencies, IS-IS routers exchange IIH PDUs.
   Two types of adjacencies exist in IS-IS: point-to-point and 
   broadcast. The following sub-sections describe the additional rules
   an MI-RTR MUST follow in order to establish adjacencies.

3.3.1 Point-to-Point Adjacencies

   A new IID TLV is inserted into the p2p hello PDUs originated by an 
   MI-RTR. Upon reception of an IIH, an MI-RTR inspects the received 
   IID TLV and if it matches any of the IIDs configured on that link, 
   normal adjacency establishment procedures are used to establish an 
   instance specific adjacency.
 


Previdi, et al                                                 [Page 3]


Internet Draft         Multi-Instance IS-IS                August, 2005



   This extension allows an MI-RTR to establish multiple adjacencies to
   the same neighbor over a p2p link. This differs from the generic
   behavior of p2p links where only one adjacency is formed. However, 
   in this case IS-IS instances are "ships-in-the-night" and from a 
   logical perspective only one adjacency per instance is formed on 
   p2p links.

3.3.2 Multi-Access Adjacencies

   Multi-Access (broadcast) networks behave differently than p2p in the
   sense that a DIS is elected. MI-RTRs will establish adjacencies and
   elect a DIS per IS-IS instance. Upon reception of an IIH each MI-RTR
   will form adjacencies only with routers advertising the same IID in
   their IIH PDUs. Since an MI-RTR is not required to participate in 
   all IIDs on a LAN, it's possible to elect a different DIS for 
   different instances.

3.3.3 Interoperability Considerations

   It is assumed that any TLV that is not understood is silently 
   ignored without compromising the processing of the whole IS-IS PDU 
   (IIH, LSP, SNP).

   To a router not implementing this extension, all IS-IS PDUs received
   will appear to be associated with the standard topology regardless 
   of any IID TLVs which may be contained in those PDUs. This can cause
   interoperability issues, not all of which can be resolved. Therefore
   deployment/configuration of MI-RTRs must be done prudently. MI-RTRs
   may be configured to accept or not to form an adjacency with a 
   router not supporting this extension. In any case, only the IID zero 
   instance can seamlessly interoperate with routers not supporting 
   this extension.

3.3.3.1 Interoperability using p2p networks

   MI-RTRs supporting IID #0 may interoperate over a p2p link with a
   router which does NOT support this extension. To do so, an MI-RTR 
   must refrain from sending LSPs and SNPs for instances other than 
   IID  #0 over the p2p link. It MUST also refrain from sending IIHs 
   for instance IDs other than zero as these IIHs may affect the state 
   of the adjacency for IID #0 in the neighbor.
  
   The presence/absence of the IID TLV in an IIH indicates that the
   neighbor does/does not support this extension. Once it is determined
   that the neighbor does not support this extension, an MI-RTR MUST 
   NOT send PDUs (including IIHs) for instances other than IID #0. 
  


Previdi, et al                                                 [Page 4]


Internet Draft         Multi-Instance IS-IS                August, 2005


   Until such time as the capability of the neighbor are known, an 
   implementation MAY send IIHs for any IID on a p2p link.

3.3.3.2 Interoperability using Multi-Access networks
  
   The presence on a multi-access network of one or more MI-RTRs
   supporting one or more non-zero IIDs is incompatible with the 
   presence of any routers which do not support this extension. This is 
   because the necessary transmission of IS-IS PDUs associated with 
   non-zero IIDs will be interpreted as being associated with IID #0 by 
   the routers not supporting this extension. Therefore, use of this 
   extension on a multi-access network requires that all routers are 
   upgraded to a software version supporting this extension. This 
   restriction MAY be applied independently for each level of routing 
   supported on the network.

4. IANA considerations

   IANA will assign a new codepoint for the MI-MT IID defined in this
   document and carried within the IIH PDU. Suggest value is XX (to be
   assigned by IANA).

5. Acknowledgments    

   The authors would like to thank Mike Shand for his valuable input.

6. Normative References

   [RFC] Bradner, S., "Key words for use in RFCs to Indicate 
   Requirement Levels," RFC 2119.
    
   [IS-IS] "Intermediate System to Intermediate System Intra-Domain
   Routeing Exchange Protocol for use in Conjunction with the Protocol
   for Providing the Connectionless-mode Network Service (ISO 8473)", 
   ISO 10589.
    
   [IS-IS-IP] Callon, R., RFC 1195, "Use of OSI IS-IS for routing in
   TCP/IP and dual environments", RFC 1195, December 1990.

   [HMAC-MD5] Li, T. and R. Atkinson, "Intermediate System to
   Intermediate System (IS-IS) Cryptographic Authentication", RFC 3567,
   July 2003.

   [MT-IS-IS] Przygienda, T., Shen, N., and N. Sheth, "M-ISIS:  Multi
   Topology (MT) Routing in IS-IS", draft-ietf-isis-wg-multi-topology-
   10.txt, May 2005.




Previdi, et al                                                 [Page 5]


Internet Draft         Multi-Instance IS-IS                August, 2005



7. Security Considerations

   Security concerns for IS-IS are addressed in the IS-IS specification
   [IS-IS], and accompanying specifications on [HMAC-MD5]. No 
   additional considerations need to be made for the extension.

8. Authors' Addresses

   Stefano Previdi
   Cisco Systems
   Via Del Serafico, 200
   00142 Rome, Italy
   sprevidi@cisco.com

   Dave Ward
   Cisco Systems
   170 W. Tasman Dr.
   San Jose, CA 95134 USA
   dward@cisco.com

   Les Ginsberg
   Cisco Systems
   170 W. Tasman Dr.
   San Jose, CA 95134 USA
   ginsberg@cisco.com

   Abhay Roy
   Cisco Systems
   170 W. Tasman Dr.
   San Jose, CA 95134 USA
   akr@cisco.com

9. IPR Disclaimer

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed 
   to pertain to the implementation or use of the technology described 
   in this document or the extent to which any license under such 
   rights might or might not be available; nor does it represent that 
   it has made any independent effort to identify any such rights.  
   Information on the procedures with respect to rights in RFC 
   documents can be found in BCP 78 and BCP 79.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use 
   


Previdi, et al                                                 [Page 6]


Internet Draft         Multi-Instance IS-IS                August, 2005


   of such proprietary rights by implementers or users of this 
   specification can be obtained from the IETF on-line IPR repository
   at http://www.ietf.org/ipr.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at ietf-
   ipr@ietf.org.

10. Full Copyright Statement

   Copyright (C) The Internet Society (2005).

   This document is subject to the rights, licenses and restrictions
   contained in BCP 78, and except as set forth therein, the authors
   retain all their rights.

   This document and the information contained herein are provided on
   an "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE 
   REPRESENTS OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY AND THE 
   INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS OR
   IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF 
   THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED 
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

11. Acknowledgement

   Funding for the RFC Editor function is currently provided by the
   Internet Society.

   This document expires in February, 2006.


















Previdi, et al                                                 [Page 7]
