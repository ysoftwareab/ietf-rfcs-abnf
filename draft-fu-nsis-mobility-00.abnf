flow_id = (nCoA, CN, ...);
next_hop = discovery(dest); /* if the node is a tunnel entry or inside
     a tunnel, dest is the tunnel exit; otherwise dest is normal dest */
branch_id = (branch_id + 1) % MAX_VAL;
mesg = new_msg (''refresh'', branch_id, flow_id, session_id,...);
branch_oid = branch_id(state);
mesg=new_msg(``teardown'', branch_oid, flow_id, session_id,...);
