S = ENC(ENC_KEY, P)

T = MAC(MAC_KEY, N || A || S || len(N) || len(A))

C = S || T

L = 16 * ( floor(M / 16) + 2)

