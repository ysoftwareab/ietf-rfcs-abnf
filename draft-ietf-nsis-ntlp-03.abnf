uuuuuuuuuuuuuu = upstream datagram mode messages
dddddddddddddd = downstream datagram mode messages
xxxxxxxxxxxxxx = connection mode messages
RAO = Router Alert Option
GIMPS-message = D-message / C-message

D-message = D-upstream-message / D-downstream-message

C-message = C-upstream-message / C-downstream-message

D-downstream-message = Common-Header
                              Message-Routing-Information
                              Node-Addressing
                              Session-Identification
                              [ Stack-Proposal ]
                              [ Query-Cookie / Responder-Cookie ]
                              [ Routing-State-Lifetime ]
                              [ NSLP-Data ]
D-upstream-message   = Common-Header
                              Message-Routing-Information
                              Node-Addressing
                              Session-Identification
                              [ Stack-Proposal ]
                              [ Query-Cookie [ Responder-Cookie ] ]
                              [ Routing-State-Lifetime ]
                              [ NSLP-Data ]

C-downstream-message = Common-Header
                              Message-Routing-Information
                              Session-Identification
                              [ Responder-Cookie ]
                              [ Routing-State-Lifetime ]
                              [ NSLP-Data ]

C-upstream-message   = Common-Header
                              Message-Routing-Information
                              Session-Identification
                              [ Stack-Proposal ]
                              [ Query-Cookie [ Responder-Cookie ] ]
                              [ Routing-State-Lifetime ]
                              [ NSLP-Data ]


Message-Routing-Information = message-routing-method
                                     method-specific-information

Flow-Identifier = network-layer-version
                         source-address prefix-length
                         destination-address prefix-length
                         IP-protocol
                         traffic-class
                         [ flow-label ]
                         [ ipsec-SPI / L4-ports]

Node-Addressing = peer-identity
                         interface-address
                         *higher-layer-addressing

Stack-Proposal = *stack-profile

stack-profile = *protocol-layer

PI-Length = the byte length of the Peer-Identity field
               (this is padded to a whole number of words)
HL-Count  = the number of higher-layer-information fields
               (these are assumed to be of fixed length)
IP-Ver    = the IP version for the Interface-Address field


Prof-Number = The number of profiles in the proposal

MRI-Length = the word length of the included MRI payload
Type-Count = the number of GIMPS payloads translated by the
                NAT; the Type numbers are included as a list
                (padded with 2 null bytes if necessary)
NAT-Count  = the number of NATs traversed by the message, and the
                number of opaque NAO-related payloads at the end
                of the object


