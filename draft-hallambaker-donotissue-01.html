<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>DNS Certification Authority Authorization (CAA) Resource Record</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="DNS Certification Authority Authorization (CAA) Resource Record">
<meta name="keywords" content="DNS, DNSSEC, PKIX">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 60em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 60em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Internet Engineering Task Force</td><td class="header">P. Hallam-Baker</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Comodo Group Inc.</td></tr>
<tr><td class="header">Intended status: Experimental</td><td class="header">R. Stradling</td></tr>
<tr><td class="header">Expires: June 5, 2011</td><td class="header">Comodo CA Ltd.</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">B. Laurie</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Google Inc.</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">December 2, 2010</td></tr>
</table></td></tr></table>
<h1><br />DNS Certification Authority Authorization (CAA) Resource Record<br />draft-hallambaker-donotissue-01</h1>

<h3>Abstract</h3>

<p>
                The Certification Authority Authorization (CAA) DNS Resource Record allows a
                DNS domain name holder to specify the certificate signing certificate(s)
                authorized to issue certificates for that domain.
                CAA resource records allow a public Certification Authority to implement additional
                controls to reduce the risk of unintended certificate mis-issue. 
            
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted  in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.
This document may not be modified, and derivative works of it may
not be created, except to format it for publication as an RFC or
to translate it into languages other than English.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF).  Note that other groups may also distribute
working documents as Internet-Drafts.  The list of current
Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
This Internet-Draft will expire on June 5, 2011.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the Simplified BSD License.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Definitions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">1.1.</a>&nbsp;
Requirements Language<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">1.2.</a>&nbsp;
Defined Terms<br />
<a href="#anchor4">2.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">2.1.</a>&nbsp;
The CAA RR type<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">2.1.1.</a>&nbsp;
Examples of Use.<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">2.2.</a>&nbsp;
Certification Authority Processing<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">2.2.1.</a>&nbsp;
Canonical Domain Name<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">2.2.2.</a>&nbsp;
Use of DNS Security<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">2.2.3.</a>&nbsp;
Archive<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">2.3.</a>&nbsp;
Relying Party Application Processing<br />
<a href="#anchor12">3.</a>&nbsp;
Mechanism<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">3.1.</a>&nbsp;
Syntax<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#zoneformat">3.1.1.</a>&nbsp;
Suggested Presentation Format<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">3.1.1.1.</a>&nbsp;
Policy OID Encoding Options<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">3.1.2.</a>&nbsp;
policy Property value<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor16">3.1.3.</a>&nbsp;
path Property value<br />
<a href="#anchor17">4.</a>&nbsp;
Security Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">4.1.</a>&nbsp;
Mis-Issue by Authorized Certification Authority<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor19">4.2.</a>&nbsp;
Suppression or spoofing of CAA records<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor20">4.2.1.</a>&nbsp;
Applications<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor21">4.2.2.</a>&nbsp;
Certification Authorities<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor22">4.3.</a>&nbsp;
Denial of Service<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor23">4.4.</a>&nbsp;
Anticompetitive Use of the Critical Flag<br />
<a href="#anchor24">5.</a>&nbsp;
IANA Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor25">5.1.</a>&nbsp;
Registration of the CAA Resource Record Type<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor26">5.2.</a>&nbsp;
Certification Authority Authorization Properties<br />
<a href="#rfc.references1">6.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">6.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">6.2.</a>&nbsp;
Non Normative References<br />
<a href="#anchor29">Appendix&nbsp;A.</a>&nbsp;
Object Digest Identifier Calculation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor30">A.1.</a>&nbsp;
Example: CA Certificate A<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor31">A.2.</a>&nbsp;
Example: CA Certificate A<br />
<a href="#anchor32">Appendix&nbsp;B.</a>&nbsp;
Example Certificates<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor33">B.1.</a>&nbsp;
CA Certificate A<br />
<a href="#anchor34">Appendix&nbsp;C.</a>&nbsp;
ASN.1 Values (Non-Normative)<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor35">C.1.</a>&nbsp;
DER Sequence Encoding<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor36">C.2.</a>&nbsp;
Object Identifiers for Certificate Types<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor37">C.3.</a>&nbsp;
Object Identifiers for Digest Algorithms<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor38">C.4.</a>&nbsp;
DER Data Encoding Prefixes<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Definitions</h3>

<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Requirements Language</h3>

<p>
                    The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
                    "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
                    document are to be interpreted as described in <a class='info' href='#RFC2119'>RFC 2119<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a> [RFC2119].
                
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.2"></a><h3>1.2.&nbsp;
Defined Terms</h3>

<p>The following terms are used in this document:
</p>
<p>
                    </p>
<blockquote class="text"><dl>
<dt>Abstract Syntax Notation One (ASN.1)</dt>
<dd>
                            A notation for describing abstract types and values,
                            as specified in <a class='info' href='#X.680'>X.680<span> (</span><span class='info'>International Telecommunication Union, &ldquo;ITU-T Recommendation X.680 (11/2008): Information                         technology - Abstract Syntax Notation One (ASN.1):                         Specification of basic notation,&rdquo; November&nbsp;2008.</span><span>)</span></a> [X.680].
</dd>
<dt>Authorization Entry</dt>
<dd>
                            An authorization assertion that grants or denies a specific set of permissions 
                            to a specific group of entities.
</dd>
<dt>Canonical Domain Name</dt>
<dd>
                            A Domain Name that is not an alias.
                            
</dd>
<dt>Canonical Domain Name Value</dt>
<dd>
                            The value of a Canonical Domain Name. The value resulting from applying alias
                            transformations to a Domain Name that is not canonical.
                        
</dd>
<dt>Certificate</dt>
<dd>
                            An X.509 Certificate, as specified in <a class='info' href='#RFC5280'>RFC 5280<span> (</span><span class='info'>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; May&nbsp;2008.</span><span>)</span></a> [RFC5280].
                    
</dd>
<dt>Certification Policy (CP)</dt>
<dd>
                            Specifies the criteria that a Certification Authority undertakes to meet
                            in its issue of certificates.
</dd>
<dt>Certification Practices Statement (CPS)</dt>
<dd>
                            Specifies the means by which the criteria of the Certification Policy
                            are met. In most cases this will be the document against which the
                            operations of the Certification Authority are audited.
</dd>
<dt>Certification Authority (CA)</dt>
<dd>
                            An entity that issues Certificates in accordance with a specified 
                            Certification Policy.
</dd>
<dt>Distinguished Encoding Rules (DER)</dt>
<dd>
                            A set of rules for encoding ASN.1 objects, as specified in
                            <a class='info' href='#X.690'>X.690<span> (</span><span class='info'>International Telecommunication Union, &ldquo;ITU-T Recommendation X.690 (11/2008): Information                         technology - Abstract Syntax Notation One (ASN.1):                         Specification of Basic Encoding Rules (BER),                         Canonical Encoding Rules (CER) and Distinguished                         Encoding Rules (DER),&rdquo; November&nbsp;2008.</span><span>)</span></a> [X.690].
</dd>
<dt>Domain</dt>
<dd>
                            The set of resources associated with a DNS Domain Name.
</dd>
<dt>Domain Name</dt>
<dd>
                            A DNS Domain name as specified in <a class='info' href='#RFC1035'>RFC 1035<span> (</span><span class='info'>Mockapetris, P., &ldquo;Domain names - implementation and specification,&rdquo; November&nbsp;1987.</span><span>)</span></a> [RFC1035]
                        and revisions.
                    
</dd>
<dt>Domain Name System (DNS)</dt>
<dd>
                            The Internet naming system specified in <a class='info' href='#RFC1035'>RFC 1035<span> (</span><span class='info'>Mockapetris, P., &ldquo;Domain names - implementation and specification,&rdquo; November&nbsp;1987.</span><span>)</span></a> [RFC1035]
                            and revisions.
                        
</dd>
<dt>DNS Security (DNSSEC)</dt>
<dd>
                            Extensions to the DNS that provide authentication services as specified in 
                            <a class='info' href='#RFC4033'>RFC 4033<span> (</span><span class='info'>Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose, &ldquo;DNS Security Introduction and Requirements,&rdquo; March&nbsp;2005.</span><span>)</span></a> [RFC4033]
                        and revisions.
                    
</dd>
<dt>Extended Issuer Authorization Set</dt>
<dd>
                            The most specific Issuer Authorization Set that is active for a domain.
                            This is either the Issuer Authorization Set for the domain itself, or
                            if that is empty, the Issuer Authorization Set for the corresponding 
                            Public Delegation Point.
                        
</dd>
<dt>Issuer Authorization Set</dt>
<dd>
                            The set of Authorization Entries for a domain name that are flagged
                            for use by Issuers. Analogous to an Access
                            Control List but with no ordering specified.
</dd>
<dt>Public Delegation Point</dt>
<dd>
                            A Domain Name that is obtained from a public DNS registry as defined by a
                            Certification Policy. 
                            
</dd>
<dt>Public Key Infrastructure X.509 (PKIX)</dt>
<dd>
                            Standards and specifications issued by the IETF that apply the
                            <a class='info' href='#X.509'>X.509<span> (</span><span class='info'>International Telecommunication Union, &ldquo;ITU-T Recommendation X.509 (11/2008): Information                         technology - Open systems interconnection - The                         Directory: Public-key and attribute certificate                         frameworks,&rdquo; November&nbsp;2008.</span><span>)</span></a> [X.509] certificate standards specified
                            by the ITU to Internet applications as specified in
                            <a class='info' href='#RFC5280'>RFC 5280<span> (</span><span class='info'>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; May&nbsp;2008.</span><span>)</span></a> [RFC5280] and related documents.
                        
</dd>
<dt>Resource Record (RR)</dt>
<dd>
                            A set of attributes bound to a Domain Name.
</dd>
<dt>Relying Party</dt>
<dd>
                            A party that makes use of an application whose operation depends on
                            use of a Certificate for making a security decision.
</dd>
<dt>Relying Application</dt>
<dd>
                            An application whose operation depends on
                            use of a Certificate for making a security decision.
                        
</dd>
<dt>Relying Party Authorization Set</dt>
<dd>
                            The set of Authorization Entries for a domain name that are flagged for use by
                            Relying Party Applications. Analogous to an Access
                            Control List but with no ordering specified.
                        
</dd>
</dl></blockquote><p>
                
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Introduction</h3>

<p>
                The Certification Authority Authorization (CAA) DNS Resource Record allows a
                DNS domain name holder to specify the Certification Authorities authorized 
                to issue certificates for that domain. Publication of CAA resource records 
                allow a public Certification Authority (CA) to implement additional
                controls to reduce the risk of unintended certificate mis-issue.
            
</p>
<p>
                Conformance with a published CAA record is a necessary but not sufficient
                condition for issue of a certificate.
                Before issuing a certificate, a PKIX CA is required to validate the 
                request according to the policies set out in its Certificate Policy 
                Statement. In the case of a public CA that validates certificate requests
                as a third party, the certificate will be typically issued under 
                a public root certificate embedded in one or more relevant reliant applications.
            
</p>
<p>
                Criteria for inclusion of embedded root certificates in applications 
                are outside the scope of this document but typically require the CA to publish a 
                Certificate Practices Statement (CPS) that specifies how the requirements
                of the Certificate Policy (CP) are achieved and provide an annual
                audit statement of their performance against their CPS performed by
                an independent third party auditor.
            
</p>
<p>
                It is the intention of the authors to propose the CAA record defined
                in this document as the basis for CA validation requirements to be
                proposed in organizations that publish validation requirements. 
            
</p>
<p>
                CAA records only describe the current state of Certification Authority
                certificate issue authority. Since a certificate is typically valid 
                for at least a year, it is possible that a certificate that is not
                conformant with the CAA records currently published was conformant
                with the CAA records published at the time that it was issued. Thus 
                Relying Applications MUST NOT use failure to conform to currently 
                published CAA records as a rejection criteria for certificates
                unless the published records are flagged as being intended for that use.
            
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
The CAA RR type</h3>

<p>
                    A CAA RR consists of a sequence of property entries. Each property 
                    entry MAY be tagged with one or more of the following flag values:

                
</p>
<p>
                    </p>
<blockquote class="text"><dl>
<dt>Critical</dt>
<dd>
                            If set, indicates that the corresponding property entry
                            tag MUST be understood if the semantics of the CAA 
                            record are to be correctly understood by the specified
                            audience.
</dd>
<dt></dt>
<dd>Issuers MUST NOT issue certificates for a domain if
                        the Extended Issuer Authorization Set contains unknown
                        property entry tags that are flagged as critical.
                        
</dd>
<dt></dt>
<dd>
                            Relying Parties MUST NOT attempt to enforce CAA records if
                            the Relying Party Authorization Set contains unknown
                            property entry tags that are flagged as critical
                        
</dd>
<dt>Must be Zero</dt>
<dd>
                            This bit is reserved for future use.
                        
</dd>
<dt></dt>
<dd>
                            Issuers MUST NOT issue certificates for a domain if
                            the Extended Issuer Authorization Set contains 
                            property entries with the Must Be Zero Tag Set.
                        
</dd>
<dt></dt>
<dd>Relying Parties MUST
                            NOT attempt to enforce CAA records if
                            the Relying Party Authorization Set contains
                            property entries with the Must Be Zero Tag Set.
                        
</dd>
<dt>Relying Party</dt>
<dd>
                        Specifies that the corresponding Property Entry is
                        to be used by Relying Party Applications and forms 
                        part of the Relying Party Authorization Set for the
                        domain.
                        
</dd>
<dt>Issuer</dt>
<dd>
                            Specifies that the corresponding Property Entry is
                            to be used by Issuers and forms part of the 
                            Issuer Authorization Set for the domain.
                        
</dd>
</dl></blockquote><p>
                
</p>
<p>
                    The following
                    properties are defined:
                    
                
</p>
<p>
                    </p>
<blockquote class="text"><dl>
<dt>policy &lt;Certificate Policy OID&gt;</dt>
<dd>
                            The policy property entry declares an authorization entry
                            granting authorization to issue under the specified 
                            Certificate Policy.
                        
</dd>
<dt>path &lt;Object Digest Identifier&gt;</dt>
<dd>
                            The path property entry declares an authorization entry
                            granting authorization to issue end entity certificates
                            under a trust path that includes the specified signing
                            credential.
                        
</dd>
</dl></blockquote><p>
                
</p>
<p>

            An Object Digest Identifier (ODI) is a means of specifying a reference to an
            object instance by means of a cryptographic digest function. A CAA path
            property may use an ODI to specify a certificate trust path by means of:

                
</p>
<p>
                    </p>
<blockquote class="text"><dl>
<dt>A Certificate Signing Certificate</dt>
<dd> 
                        
</dd>
<dt>A Public Signing Key</dt>
<dd> 
                        
</dd>
</dl></blockquote><p>
                
</p>
<p>
                In either case a path Authorization Entry authorizes an issuer to issue 
                an End Entity certificate to the corresponding domain if and only if it 
                is possible to form a valid certificate path to it from the referenced 
                certificate or key.
                
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1.1"></a><h3>2.1.1.&nbsp;
Examples of Use.</h3>

<p>
                    For convenience the examples are presented in the text format 
                    suggested in section <a class='info' href='#zoneformat'>Section&nbsp;3.1.1<span> (</span><span class='info'>Suggested Presentation Format</span><span>)</span></a>
                    
</p>
<p>
                    The following example informs CAs that certificates must not be issued
                    except under the Default Deny Security 'Example 1' Certificate Policy 
                    (1.3.6.1.4.1.35405.666.1). Since the policy is published
                    at the Public Delegation Point, the policy applies to all subordinate
                    domains under example.com.
                
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
$ORIGIN example.com
.       CAA 1 policy 1.3.6.1.4.1.35405.666.1
</pre></div>
<p>
                    The following example informs CAs that certificates must not be 
                    issued except under the Certificate Authority Root certificate 
                    specified in Appendix B. 
                
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
$ORIGIN example.com
.       CAA 1 path MDIGA1UEJQYJYIZIAWUDBAIBBCAXzJgPaoT7Fe
                 XaPzKv6mI2D0yilif+7WhzmhMGLe/oBA==
</pre></div>
<p>
                    A domain MAY authorize multiple CAs to issue certificates at 
                    the same time. The following example allows issue under the
                    Default Deny Security certification policy 'Example 1' or 
                    'Example 2':
                    
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
$ORIGIN example.com
.       CAA 1 policy 1.3.6.1.4.1.35405.666.1
.       CAA 1 policy 1.3.6.1.4.1.35405.666.2
</pre></div>
<p>
                    If Authorization Entries using the path and policy properties
                    are present at a given Domain, compatibility with either is 
                    sufficient to authorize the request.
                    
</p>
<p>
                    Future versions of this specification MAY use the critical
                    flag to introduce new semantics that MUST be understood for
                    correct processing of the record, preventing Certification
                    Authorities that do not recognize the record from issuing 
                    certificates.
                    
</p>
<p>
                    In the following example, the property 'tbs' is flagged as
                    critical. The Default Deny Security CA is not authorized to 
                    issue under either policy unless the processing rules for the 
                    'tbs' property tag are understood.
                    
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
$ORIGIN example.com
.       CAA 1 policy 1.3.6.1.4.1.35405.666.1
.       CAA 1 policy 1.3.6.1.4.1.35405.666.2
.       CAA 9 tbs MDIGA1UEJQYJYIZIAWUDBAIBBCAXzJgPaoT7Fe
                 XaPzKv6mI2D0yilif+7WhzmhMGLe/oBA==
</pre></div>
<p>
                    Enforcement by Relying Party Applications follows the same general 
                    principles. A Relying Party Application MUST NOT enforce
                    CAA records unless at least one Property Entry has the 
                    Relying Party flag set, that is the Relyin Party Authorization 
                    Set is not empty.
                    
</p>
<p>
                        In the following example, certificates must not be issued
                        except under the Default Deny Security 'Example 1' 
                        Certificate Policy and Relying Party Applications MAY 
                        reject certificates presented that do not comply with this requirement:
                    
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
$ORIGIN example.com
.       CAA 3 policy 1.3.6.1.4.1.35405.666.1
</pre></div>
<p>
                    In the ordinary course of business a Domain administrator 
                    may withdraw authorization for issue of new certificates 
                    before the previously issued certificates expire.
                    
</p>
<p>
                        In the following example, Relying Party Applications are
                        informed that certificates issued under either the policy are
                        to be considered to be authorized but new certificates can
                        only be issued under the first.
                    
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
$ORIGIN example.com
.       CAA 3 policy 1.3.6.1.4.1.35405.666.1
.       CAA 2 policy 1.3.6.1.4.1.35405.666.2
</pre></div>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
Certification Authority Processing</h3>

<p>
                    Before issue of a certificate a compliant CA MUST check for publication
                    of a relevant CAA Resource Record(s) and if such record(s) are published, that
                    the certificate requested is consistent with them. If the certificate
                    requested is not consistent with the relevant CAA RRs, the CA MUST
                    NOT issue the certificate.
                
</p>
<p>
                    The Issuer Authorization Set for a domain name consists of the set of
                    all CAA Authorization Entries declared for the canonical form
                    of the specified domain.
                
</p>
<p>
                    The Extended Issuer Authorization Set for a domain name consists of
                    the Issuer Authorization Set for that domain name if it is non-empty.
                    Otherwise the Extended Issuer Authorization Set for a domain name 
                    consists of the Issuer Authorization Set for the corresponding 
                    Public Delegation Point for that domain name.
                
</p>
<p>
                    If the Extended Issuer Authorization Set for a domain name is not empty, a
                    Certification Authority MUST NOT issue a certificate unless it conforms
                    to at least one authorization entry in the Extended Issuer Authorization Set.
                
</p>
<p>
                    Note that while it MUST be possible to form a certificate validation path
                    that contains at least one certificate that is so specified, it MAY also be 
                    possible to form valid certificate paths that are not.
                
</p>
<p>
                    For example, a CA that has updated its root certificate to extend the
                    expiry date is entitled to issue certificates for domains where the
                    CAA record only specifies the older root certificate provided that the 
                    older root certificate has not actually expired and it is thus possible 
                    to form a valid certificate path.
                
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2.1"></a><h3>2.2.1.&nbsp;
Canonical Domain Name</h3>

<p>
                        The DNS defines the CNAME and DNAME mechanisms for specifying 
                        domain name aliases. The canonical name of a DNS name is the
                        name that results from performing all DNS alias operations.
                    
</p>
<p>
                        A Certification Authority MUST perform CNAME and DNAME
                        processing as defined in the DNS specifications <a class='info' href='#RFC1035'>1035<span> (</span><span class='info'>Mockapetris, P., &ldquo;Domain names - implementation and specification,&rdquo; November&nbsp;1987.</span><span>)</span></a> [RFC1035].
                    
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2.2"></a><h3>2.2.2.&nbsp;
Use of DNS Security</h3>

<p>
                        Use of DNSSEC to authenticate CAA RRs is strongly recommended but
                        not required. A CA MUST NOT issue certificates if doing so would
                        conflict with the corresponding extended issuer authorization set
                        whether the corresponding DNS records are signed or not.
                    
</p>
<p>
                        Use of DNSSEC allows a CA to acquire and archive a non-repudiable
                        proof that they were authorized to issue certificates for the domain.
                    
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2.3"></a><h3>2.2.3.&nbsp;
Archive</h3>

<p>
                        A compliant CA SHOULD maintain an archive of the DNS transactions
                        used to verify CAA eligibility.
                    
</p>
<p>
                        In particular a CA SHOULD ensure that where DNSSEC data is
                        available that the corresponding signature and NSEC/NSEC3 records
                        are preserved so as to enable later compliance audits.
                    
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3"></a><h3>2.3.&nbsp;
Relying Party Application Processing</h3>

<p>
                Relying Party Applications MAY enforce CAA issue restrictions
                at their option, provided that the Relying Party Authorization 
                set is not empty.
                
</p>
<p>
                The consequences of determining that a certificate is not
                compatible with the specified CAA relying party restrictions 
                are outside the scope of this document.
                
</p>
<p>
                Domains that opt to flag records for use by Relying Party Applications
                SHOULD be aware that the Property Entries supported in this version of the
                specification are only designed to support the requirements of enforcing 
                issuer restrictions. While these Property Entries MAY be sufficient to
                enable enforcement by Relying Party Applications in some circumstances,
                they are not intended to provide complete requirements coverage for
                this purpose.
                
</p>
<p>
                Domains containing CAA issue restrictions intended for 
                use by Relying Party Applications SHOULD be authenticated using
                DNSSEC or other equivalent means.
                
</p>
<p>
                If DNSSEC is deployed in a domain Relying Party Applications MUST treat 
                failure to authenticate signatures of CAA records or absence of CAA 
                records whose presence is indicated as being equivalent to an inconsistent
                CAA record.
                
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Mechanism</h3>

<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Syntax</h3>

<p>
                    A CAA RR contains a sequence of tag value pairs. Each tag represents
                    a property of the CAA record. The value of a CAA property is that
                    specified in the corresponding value field.
                
</p>
<p>
                    A domain name MAY have multiple CAA RRs associated with it and
                    each CAA RR MAY have multiple properties and a given property MAY
                    be specified more than once. 
                
</p>
<p>
                    This version of the specification makes no distinction as to 
                    whether properties are expressed as one record or many, nor are 
                    the properties defined sensitive with respect to order.
                
</p>
<p> 
                    The CAA data field consists of a sequence of at least one property 
                    entry. Each property entry consists of a sequence of:
                
</p>
<p>
                    </p>
<blockquote class="text"><dl>
<dt>Flags</dt>
<dd>One octet containing the following fields:

                        
                        
<blockquote class="text"><dl>
<dt>Bits 0-3: Tag Length</dt>
<dd>
                                An unsigned integer
                                specifying the tag length
                                in octets. The tag length MUST be at least 1 and
                                no more than 15.
                            
</dd>
<dt>Bit 4: Critical Flag</dt>
<dd>
                                If the value is set (1), the critical flag is asserted and the
                                property
                                MUST be understood if the CAA record is to be correctly processed.
                            
</dd>
<dt></dt>
<dd>
                                A Certification Authority MUST NOT issue certificates for any
                                Domain that contains a CAA critical property for an unknown
                                or unsupported property type.
                            
</dd>
<dt>Bit 5: Must Be Zero</dt>
<dd>
                                Bit 5 is reserved and MUST be set to zero. Processors that
                                encounter a CAA record containing a property with this
                                bit set MUST treat the record set as if the critical property 
                                was asserted for an unknown record.
                            
</dd>
<dt>Bit 6: Relying Application Use</dt>
<dd>
                                If set, the property entry contains an Authorization Entry
                                that forms part of the Relying Application Authorization Set
                                for the corresponding domain.
                            
</dd>
<dt>Bit 7:</dt>
<dd>
                                If set, the property entry contains an Authorization Entry
                                that forms part of the Issuer Application Authorization Set
                                for the corresponding domain.
                            
</dd>
</dl></blockquote>
                        
</dd>
<dt></dt>
<dd>
                            Note that according to the conventions set out in  <a class='info' href='#RFC1035'>RFC 1035<span> (</span><span class='info'>Mockapetris, P., &ldquo;Domain names - implementation and specification,&rdquo; November&nbsp;1987.</span><span>)</span></a> [RFC1035]
                            Bit 0 is the Most Significant Bit and Bit 7 is the Least Significant. 
                            Thus a flags value of 0x51 indicates a tag length of 5 octets and that
                            the property entry is not critical and is not to be used for relying
                            party processing.
                            
</dd>
<dt>Tag</dt>
<dd>The property identifier, a sequence of ASCII characters.
</dd>
<dt></dt>
<dd>
                            Tag values MAY contain ASCII characters a through z
                            and the numbers 0 through 9. Tag values MUST NOT contain
                            any other characters. Matching of tag values is case
                            insensitive.
                        
</dd>
<dt>Value Length</dt>
<dd>
                            Two octets containing an unsigned integer in network byte order 
                            specifying the
                            length of the value field in octets.
</dd>
<dt>Value</dt>
<dd>A sequence of octets representing the property
                        value. Property values are encoded as binary values and MAY employ
                        sub-formats.
</dd>
</dl></blockquote><p>
                    
                
</p>
<a name="zoneformat"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.1"></a><h3>3.1.1.&nbsp;
Suggested Presentation Format</h3>

<p>
                    The canonical presentation format of the CAA record is as follows:
                
</p>
<p>
                        CAA &lt;flags> &lt;tag> &lt;data>
                    
</p>
<p>
                    Where:
                    
</p>
<p>
                        </p>
<blockquote class="text"><dl>
<dt>flags</dt>
<dd>Is an unsigned integer between 0 and 15.
</dd>
<dt>tag</dt>
<dd>
                                Is a non-zero sequence of ASCII letter and
                                numbers in lower case.
                            
</dd>
<dt>data</dt>
<dd>
                                Is the Base64 Encoding <a class='info' href='#RFC4648'>[RFC4648]<span> (</span><span class='info'>Josefsson, S., &ldquo;The Base16, Base32, and Base64 Data Encodings,&rdquo; October&nbsp;2006.</span><span>)</span></a>
                            of the value field.
                            
</dd>
</dl></blockquote><p>
                    
</p>
<p>
                    Implementations SHOULD calculate the tag length bits of the 
                    flags field from the specified tag. Implementations MUST NOT
                    specify a tag length field in the flags octet that is 
                    inconsistent with the specified tag.
                    
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.1.1"></a><h3>3.1.1.1.&nbsp;
Policy OID Encoding Options</h3>

<p>
                        For convenience of administration, implementations MAY support
                        ASN.1 Policy OID encoding at their option.
                    
</p>
<p>

                                The Base64 encoding of data never 
                                contains the period character '.', while the 
                                encoding of ASN.1 OID values specified in IETF GSER encoding
                                <a class='info' href='#RFC3642'>[RFC3642]<span> (</span><span class='info'>Legg, S., &ldquo;Common Elements of Generic String Encoding Rules (GSER) Encodings,&rdquo; October&nbsp;2003.</span><span>)</span></a> will always incorporate
                                at least one period character.
                            
</p>
<p>
                            It follows that a data decoder MAY unambiguously interpret 
                            data specified in the Base64 or GSER format without the 
                            need for additional disambiguation.
                            
</p>
<p>
                            Implementations MAY choose to allow use of both formats in
                            both file and presentation formats.
                        
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.2"></a><h3>3.1.2.&nbsp;
policy Property value</h3>

<p>
                        The policy property value specifies an Authorization Entry by means
                        of an ASN.1 OID specifying a Certification Policy. A Certification
                        Authority is authorized to issue Certificates under a policy 
                        Authorization Entry if and only if
                    
</p>
<p>
                        </p>
<blockquote class="text">
<p>
                          To be honest      The Certification Authority has the right to issue
                                certificates under the specified policy, AND
                            
</p>
<p>
                                The certificate request is compliant with the 
                                requirements of the specified policy, AND
                            
</p>
<p>
                                The certificate request meets all the criteria under the 
                                Certification Policy under which the certificate is to be issued.
                            
</p>
</blockquote><p>
                    
</p>
<p>
                        Each policy property specifies a single ASN.1 OID value consisting
                        of the ASN.1 type, length specifier and OID data.
                    
</p>
<p>
                        The policy property applies to the specified policy OID and all
                        policy OIDs that fall within the same OID arc. If the OID arc
                        1.3.6.1.4.1.35405.666 is specified, then the policy OIDs
                        1.3.6.1.4.1.35405.666, 1.3.6.1.4.1.35405.666.1,
                        1.3.6.1.4.1.35405.666.2 etc. are all authorized.
                    
</p>
<p>
                        The Certificate that is issued MAY incorporate the specified
                        policy OID itself but is not required to provided that the issue
                        of the certificate is consistent with the requirements of the
                        specified policy.
                    
</p>
<p>
                        For example, a CA that offers two levels of Certification Policy
                        such that the higher level of assurance included all the requirements
                        of the lower one MAY rely on a policy property specifying the lower
                        assurance policy as authorization for issue under the higher assurance
                        policy but not vice-versa.
                    
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.3"></a><h3>3.1.3.&nbsp;
path Property value</h3>

<p>
                        The path property value specifies an Authorization Entry by means
                        of a Certificate Signer Certificate or a Certificate Signing key.
                        A Certification
                        Authority is authorized to issue Certificates under a path
                        Authorization Entry if and only if
                    
</p>
<p>
                        </p>
<blockquote class="text">
<p>
                                A valid PKIX trust path can be formed from the specified
                                Certificate Signer Certificate or a Certificate Signing key
                                to the certificate that is to be issued, AND
                            
</p>
<p>
                                The certificate request meets all the criteria under the
                                Certification Policy under which the certificate is to be issued.
                            
</p>
</blockquote><p>
                    
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Security Considerations</h3>

<p>CAA Records provide an accountability control. They are intended to
            mitigate undesired behavior rather than preventing it.
            
</p>
<p>
            While a Certification Authority can choose to ignore published CAA 
            records, doing so increases the both the probability that they will 
            mis-issue a certificate and the consequences of doing so. Once it is
            known that a CA observes CAA records, malicious registration requests 
            will target disproportionately target the negligent CAs that do not,
            and so the mis-issue rate amongst the negligent CAs will increase.
            Since the CA could clearly have avoided the mis-issue by performing
            CAA processing, the likelihood of sanctions against the negligent CA
            is increased. Failure to observe CAA issue restrictions provides an
            objective criteria for excluding issuers from embedded roots of trust.
            
</p>
<p>
            In contrast, a Certification Authority that processes CAA records
            correctly can reasonably claim that any residual 
            mis-issue event could have been avoided had the Domain Name holder
            published appropriate CAA records.
            
</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Mis-Issue by Authorized Certification Authority</h3>

<p>
                    Use of CAA records does not provide protection against mis-issue
                    by an authorized Certification Authority. 
                
</p>
<p>
                    Domain name holders SHOULD ensure that the CAs they authorize to issue
                    certificates for their domains employ appropriate controls to ensure
                    that certificates are only issued to authorized parties within their
                    organization.
                
</p>
<p>
                    Such controls are most appropriately determined by the domain name
                    holder and the authorized CA(s) directly and are thus out of scope 
                    of this document.
                
</p>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Suppression or spoofing of CAA records</h3>

<p>
                    Suppression of the CAA record or insertion of a bogus CAA record could
                    enable an attacker to obtain a certificate from a CA that was not 
                    authorized to issue for that domain name.
                
</p>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.1"></a><h3>4.2.1.&nbsp;
Applications</h3>

<p>
                        Applications performing CAA checking SHOULD mitigate the risk of 
                        suppresion or spoofing of CAA records by means of DNSSEC validation
                        where present. In cases where DNSSEC validation is not available,
                        CAA checking is of limited security value.
                    
</p>
<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.2"></a><h3>4.2.2.&nbsp;
Certification Authorities</h3>

<p>
                        Since a certificate issued by a CA can be valid for several years,
                        the consequences of a spoofing or suppression attack are much
                        greater for Certification Authorities and so additional countermeasures
                        are justified.
                    
</p>
<p>
                    A CA MUST mitigate this risk by employing DNSSEC verification whenever
                    possible and rejecting certificate requests in any case where it is
                    not possible to verify the non-existence or contents of a relevant
                    CAA record.
                
</p>
<p>
                    In cases where DNSSEC is not deployed in a corresponding domain, a 
                    CA SHOULD attempt to mitigate this risk by employing appropriate
                    DNS security controls. For example all portions of the DNS lookup
                    process SHOULD be performed against the authoritative name server.
                    Cached data MUST NOT be relied on but MAY be used to support additional
                    anti-spoofing or anti-suppression controls.
                
</p>
<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
Denial of Service</h3>

<p>
                    Introduction of a malformed or malicious CAA RR could in theory
                    enable a Denial of Service attack.
                
</p>
<p>
                    This specific threat is not considered to add significantly to 
                    the risk of running an insecure DNS service.
                
</p>
<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4"></a><h3>4.4.&nbsp;
Anticompetitive Use of the Critical Flag</h3>

<p>
                    A Certification Authority could make use of the critical flag
                    to trick customers into publishing records which prevent 
                    competing Certification Authorities from issuing certificates
                    even though the customer intends to authorize multiple 
                    providers.
                
</p>
<p>
                    In practice, such an attack would be of minimal effect since 
                    any competent competitor that found itself unable to issue certificates 
                    due to lack of support for a property marked critical is going
                    to investigate the cause and report the reason to the customer
                    who was deceived. It is thus unlikely that the attack would 
                    succeed and the attempt might lay the perpetrator open to 
                    civil or criminal sanctions.
                
</p>
<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
IANA Considerations</h3>

<a name="anchor25"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Registration of the CAA Resource Record Type</h3>

<p>
                    IANA has assigned Resource Record Type TBD1 for the CAA Resource
                    Record Type and added the line depicted below to the registry named
                    Resource Record (RR) TYPEs and QTYPEs as defined in BCP 42 RFC 5395
                    [RFC5395] and located at
                    http://www.iana.org/assignments/dns-parameters.
                
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
             Value and meaning                              Reference
-----------  ---------------------------------------------  ---------
CAA          TBD1 Certification Authority Restriction         [RFCXXXX]
</pre></div>
<a name="anchor26"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Certification Authority Authorization Properties</h3>

<p>
                    IANA has created the Certification Authority Authorization Properties
                    registry with the following initial values:
                
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

             Meaning                                          Reference
-----------  -----------------------------------------------  ---------
path         Authorization Entry by Signature Path            [RFCXXXX]
policy       Authorization Entry by Certificate Policy        [RFCXXXX]
</pre></div>
<p>
                    Addition of tag identifiers requires a public specification 
                    and expert review as set out in <a class='info' href='#RFC5395'>RFC5395<span> (</span><span class='info'>Eastlake, D., &ldquo;Domain Name System (DNS) IANA Considerations,&rdquo; November&nbsp;2008.</span><span>)</span></a> [RFC5395]
                
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>6.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC1035">[RFC1035]</a></td>
<td class="author-text">Mockapetris, P., &ldquo;<a href="http://tools.ietf.org/html/rfc1035">Domain names - implementation and specification</a>,&rdquo; STD&nbsp;13, RFC&nbsp;1035, November&nbsp;1987 (<a href="http://www.rfc-editor.org/rfc/rfc1035.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4033">[RFC4033]</a></td>
<td class="author-text">Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose, &ldquo;<a href="http://tools.ietf.org/html/rfc4033">DNS Security Introduction and Requirements</a>,&rdquo; RFC&nbsp;4033, March&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4033.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4055">[RFC4055]</a></td>
<td class="author-text">Schaad, J., Kaliski, B., and R. Housley, &ldquo;<a href="http://tools.ietf.org/html/rfc4055">Additional Algorithms and Identifiers for RSA Cryptography for use in the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>,&rdquo; RFC&nbsp;4055, June&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4055.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5280">[RFC5280]</a></td>
<td class="author-text">Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;<a href="http://tools.ietf.org/html/rfc5280">Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>,&rdquo; RFC&nbsp;5280, May&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5280.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5395">[RFC5395]</a></td>
<td class="author-text">Eastlake, D., &ldquo;<a href="http://tools.ietf.org/html/rfc5395">Domain Name System (DNS) IANA Considerations</a>,&rdquo; BCP&nbsp;42, RFC&nbsp;5395, November&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5395.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="X.509">[X.509]</a></td>
<td class="author-text">International Telecommunication Union, &ldquo;<a href="http://www.itu.int/itu-t/recommendations/rec.aspx?rec=X.509">ITU-T Recommendation X.509 (11/2008): Information
                        technology - Open systems interconnection - The
                        Directory: Public-key and attribute certificate
                        frameworks</a>,&rdquo; ITU-T Recommendation&nbsp;X.509, November&nbsp;2008.</td></tr>
<tr><td class="author-text" valign="top"><a name="X.680">[X.680]</a></td>
<td class="author-text">International Telecommunication Union, &ldquo;<a href="http://www.itu.int/itu-t/recommendations/rec.aspx?rec=X.680">ITU-T Recommendation X.680 (11/2008): Information
                        technology - Abstract Syntax Notation One (ASN.1):
                        Specification of basic notation</a>,&rdquo; ITU-T Recommendation&nbsp;X.680, November&nbsp;2008.</td></tr>
<tr><td class="author-text" valign="top"><a name="X.690">[X.690]</a></td>
<td class="author-text">International Telecommunication Union, &ldquo;<a href="http://www.itu.int/itu-t/recommendations/rec.aspx?rec=X.690">ITU-T Recommendation X.690 (11/2008): Information
                        technology - Abstract Syntax Notation One (ASN.1):
                        Specification of Basic Encoding Rules (BER),
                        Canonical Encoding Rules (CER) and Distinguished
                        Encoding Rules (DER)</a>,&rdquo; ITU-T Recommendation&nbsp;X.690, November&nbsp;2008.</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>6.2.&nbsp;Non Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="NIST-ALGS">[NIST-ALGS]</a></td>
<td class="author-text">National Institute of Standards and Technology, &ldquo;<a href="http://csrc.nist.gov/groups/ST/crypto_apps_infra/csor/algorithms.html">Cryptographic Algorithm Registration</a>,&rdquo; March&nbsp;2009.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3642">[RFC3642]</a></td>
<td class="author-text">Legg, S., &ldquo;<a href="http://tools.ietf.org/html/rfc3642">Common Elements of Generic String Encoding Rules (GSER) Encodings</a>,&rdquo; RFC&nbsp;3642, October&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3642.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4648">[RFC4648]</a></td>
<td class="author-text">Josefsson, S., &ldquo;<a href="http://tools.ietf.org/html/rfc4648">The Base16, Base32, and Base64 Data Encodings</a>,&rdquo; RFC&nbsp;4648, October&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4648.txt">TXT</a>).</td></tr>
</table>

<a name="anchor29"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Object Digest Identifier Calculation</h3>

<p>
                An Object Digest is an ASN.1 structure with three components:
            
</p>
<p>
                </p>
<blockquote class="text">
<p>An ASN.1 Object Identifier specifying the object type of the referenced object
</p>
<p>An ASN.1 Object Identifier specifying the digest algorithm
</p>
<p>
                        An ASN.1 <a class='info' href='#X.690'>DER<span> (</span><span class='info'>International Telecommunication Union, &ldquo;ITU-T Recommendation X.690 (11/2008): Information                         technology - Abstract Syntax Notation One (ASN.1):                         Specification of Basic Encoding Rules (BER),                         Canonical Encoding Rules (CER) and Distinguished                         Encoding Rules (DER),&rdquo; November&nbsp;2008.</span><span>)</span></a> [X.690] encoded data
                        field containing the digest value of the referenced
                        object processed using the specified digest algorithm.
                    
</p>
</blockquote><p>
            
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

DNSCAA DEFINITIONS ::=

BEGIN

 ObjectDigestIdentifier ::= SEQUENCE {
   type             OBJECT IDENTIFIER,
   digestAlgorithm  OBJECT IDENTIFIER,
   digest           OCTET STRING
 }

END
</pre></div>
<p>
                The Object Digest Identifier construction is designed to facilitate
                implementation in applications that already require ASN.1 handling
                mechanisms (i.e. most cryptographic applications) without causing an
                undue coding burden in cases where ASN.1 code is not already supported.
                Appendix C provides all the necessary information to create a fully
                compliant Object Digest Identifier implementation.
            
</p>
<a name="anchor30"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1"></a><h3>A.1.&nbsp;
Example: CA Certificate A</h3>

<p>
                    The ODI of CA Certificate A (specified in Appendix B.1)
                    is calculated as follows:
                
</p>
<p>
                    </p>
<blockquote class="text">
<p>
                            ASN.1 Sequence tag: <tt>3032</tt>
                        
</p>
<p>
                            ASN.1 OID id-at-cACertificate (2.5.4.37): <tt>0603550425</tt>
                        
</p>
<p>
                            ASN.1 OID sha256 (2.16.840.1.101.3.4.2.1): <tt>0609608648016503040201</tt>
                        
</p>
<p>
                            SHA-256 Digest Value: <tt>042017cc980f6a84fb15e5da3f32afea62360f4ca29627feed68739a13062defe804</tt>
                        
</p>
</blockquote><p>
                
</p>
<p>
                    The ODI in BASE64 format is MDIGA1UEJQYJYIZIAWUDBAIBBCAXzJgPaoT7FeXaPzKv6mI2D0yilif+7WhzmhMGLe/oBA==.
                
</p>
<a name="anchor31"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.2"></a><h3>A.2.&nbsp;
Example: CA Certificate A</h3>

<p>
                    The ODI of the signing key of CA Certificate A 
                    (specified in Appendix B.1) is calculated as follows:
                
</p>
<p>
                    </p>
<blockquote class="text">
<p>
                            ASN.1 Sequence tag
                        
</p>
<p>
                            ASN.1 OID 'CA Signing Key'
                        
</p>
<p>
                            ASN.1 OID 'SHA-256'
                        
</p>
<p>
                            SHA-256 Digest Value
                        
</p>
</blockquote><p>
                
</p>
<a name="anchor32"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B"></a><h3>Appendix B.&nbsp;
Example Certificates</h3>

<p>
            The following certificates are used in the examples.
            
</p>
<a name="anchor33"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B.1"></a><h3>B.1.&nbsp;
CA Certificate A</h3>

<p>
                CA Certificate A is a self signed certificate signed with a 2048 
                bit RSA key:
                
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
-----BEGIN CERTIFICATE-----
MIIDATCCAeugAwIBAgIBATALBgkqhkiG9w0BAQUwKDERMA8GA1UEChMIQWNtZSBJ
bmMxEzARBgNVBAMTCkV4YW1wbGUgQ0EwHhcNMTAxMTExMTgxMjAzWhcNMjAxMTA4
MTgxMjAzWjAoMREwDwYDVQQKEwhBY21lIEluYzETMBEGA1UEAxMKRXhhbXBsZSBD
QTCCAR8wCwYJKoZIhvcNAQEBA4IBDgAwggEJAoIBALHvos3yEe0ugR6Ae2rPATXA
pBYGK6BMzGTLkXCg6MZaG9CZpfleZTZ/EgIKBwRJlIXvWdKwjMZ7GBByT+fdMDZp
7zkx64UZ4+CJm98NRjdugxovl8HhscIBXnhCHERgamp0U/f8Ho5W8eAxYLZ1XcIG
mB7mVknvolaN9EqlEmYn+qHexGJPlpWFmR4NKhVAATE6B1a9z5PCmoOgW9p0Vqic
SJ6CdAHKaa7JZS+sqNQDx57H8Q6R9lh52XXmJVVficxBp2K7C+Wvht45t68FG6f1
sXWuWDRYc6iUmOxZbzDDvIoFU0pAXESTdMOWvXKI8ZUaYBoZ7/YnSSTaseiW86sC
AwEAAaM9MDswDgYDVR0PAQEBBAQDAgAEMA8GA1UdEwEBAQQFMAMBAQEwGAYDVR0g
BBEwDzANBgsrBgEEAYKUTYUaATALBgkqhkiG9w0BAQUDggEBAGcNiaQXdyiI9Y5e
Ps+XEYdKiWYvmSnRIfbUZuQWaQpPcj5cHzMe91CUZipGDNJYXwqWhIUtQAAGmtrq
ZGa4F9Yh0cPFAHBXPHXKGeM1hMtAR7Mv9kHu4DFIhb822O0n4DdBIit8FNas5t/5
CbM6crDpWB5hjAsD37U+GZGvTJmag059VWjnjv90NcfCQ6YJ6AA5VKnmrV695VnL
dSPaN9VS5RN6heJqU9tcbqPkAEP3MuJtd1QxB8Q34f9e1kTYXxc/dBJK1RQ0F4nc
Jc4NbJzakvFq+QcbzEqkhDMiXvjDV0JJt+GkFZrsREi6IgQY4DQHPv65OIvbr3uW
329dd+g=
-----END CERTIFICATE-----
</pre></div>
<p>
                In binary form, the certificate data is:
                
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
0000  30 82 03 01 30 82 01 eb  a0 03 02 01 02 02 01 01
0010  30 0b 06 09 2a 86 48 86  f7 0d 01 01 05 30 28 31
0020  11 30 0f 06 03 55 04 0a  13 08 41 63 6d 65 20 49
0030  6e 63 31 13 30 11 06 03  55 04 03 13 0a 45 78 61
0040  6d 70 6c 65 20 43 41 30  1e 17 0d 31 30 31 31 31
0050  31 31 38 31 32 30 33 5a  17 0d 32 30 31 31 30 38
0060  31 38 31 32 30 33 5a 30  28 31 11 30 0f 06 03 55
0070  04 0a 13 08 41 63 6d 65  20 49 6e 63 31 13 30 11
0080  06 03 55 04 03 13 0a 45  78 61 6d 70 6c 65 20 43
0090  41 30 82 01 1f 30 0b 06  09 2a 86 48 86 f7 0d 01
00a0  01 01 03 82 01 0e 00 30  82 01 09 02 82 01 00 b1
00b0  ef a2 cd f2 11 ed 2e 81  1e 80 7b 6a cf 01 35 c0
00c0  a4 16 06 2b a0 4c cc 64  cb 91 70 a0 e8 c6 5a 1b
00d0  d0 99 a5 f9 5e 65 36 7f  12 02 0a 07 04 49 94 85
00e0  ef 59 d2 b0 8c c6 7b 18  10 72 4f e7 dd 30 36 69
00f0  ef 39 31 eb 85 19 e3 e0  89 9b df 0d 46 37 6e 83
0100  1a 2f 97 c1 e1 b1 c2 01  5e 78 42 1c 44 60 6a 6a
0110  74 53 f7 fc 1e 8e 56 f1  e0 31 60 b6 75 5d c2 06
0120  98 1e e6 56 49 ef a2 56  8d f4 4a a5 12 66 27 fa
0130  a1 de c4 62 4f 96 95 85  99 1e 0d 2a 15 40 01 31
0140  3a 07 56 bd cf 93 c2 9a  83 a0 5b da 74 56 a8 9c
0150  48 9e 82 74 01 ca 69 ae  c9 65 2f ac a8 d4 03 c7
0160  9e c7 f1 0e 91 f6 58 79  d9 75 e6 25 55 5f 89 cc
0170  41 a7 62 bb 0b e5 af 86  de 39 b7 af 05 1b a7 f5
0180  b1 75 ae 58 34 58 73 a8  94 98 ec 59 6f 30 c3 bc
0190  8a 05 53 4a 40 5c 44 93  74 c3 96 bd 72 88 f1 95
01a0  1a 60 1a 19 ef f6 27 49  24 da b1 e8 96 f3 ab 02
01b0  03 01 00 01 a3 3d 30 3b  30 0e 06 03 55 1d 0f 01
01c0  01 01 04 04 03 02 00 04  30 0f 06 03 55 1d 13 01
01d0  01 01 04 05 30 03 01 01  01 30 18 06 03 55 1d 20
01e0  04 11 30 0f 30 0d 06 0b  2b 06 01 04 01 82 94 4d
01f0  85 1a 01 30 0b 06 09 2a  86 48 86 f7 0d 01 01 05
0200  03 82 01 01 00 67 0d 89  a4 17 77 28 88 f5 8e 5e
0210  3e cf 97 11 87 4a 89 66  2f 99 29 d1 21 f6 d4 66
0220  e4 16 69 0a 4f 72 3e 5c  1f 33 1e f7 50 94 66 2a
0230  46 0c d2 58 5f 0a 96 84  85 2d 40 00 06 9a da ea
0240  64 66 b8 17 d6 21 d1 c3  c5 00 70 57 3c 75 ca 19
0250  e3 35 84 cb 40 47 b3 2f  f6 41 ee e0 31 48 85 bf
0260  36 d8 ed 27 e0 37 41 22  2b 7c 14 d6 ac e6 df f9
0270  09 b3 3a 72 b0 e9 58 1e  61 8c 0b 03 df b5 3e 19
0280  91 af 4c 99 9a 83 4e 7d  55 68 e7 8e ff 74 35 c7
0290  c2 43 a6 09 e8 00 39 54  a9 e6 ad 5e bd e5 59 cb
02a0  75 23 da 37 d5 52 e5 13  7a 85 e2 6a 53 db 5c 6e
02b0  a3 e4 00 43 f7 32 e2 6d  77 54 31 07 c4 37 e1 ff
02c0  5e d6 44 d8 5f 17 3f 74  12 4a d5 14 34 17 89 dc
02d0  25 ce 0d 6c 9c da 92 f1  6a f9 07 1b cc 4a a4 84
02e0  33 22 5e f8 c3 57 42 49  b7 e1 a4 15 9a ec 44 48
02f0  ba 22 04 18 e0 34 07 3e  fe b9 38 8b db af 7b 96
0300  df 6f 5d 77 e8
</pre></div>
<p>
                The SHA-256 digest of the certificate data is:
                
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
17cc980f6a84fb15e5da3f32afea62360f4ca29627feed68739a13062defe804
</pre></div>
<a name="anchor34"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C"></a><h3>Appendix C.&nbsp;
ASN.1 Values (Non-Normative)</h3>

<p>
                Although the Object Digest Identifier form employs ASN.1 DER encoding
                only a small subset of ASN.1 features are used and a full ASN.1 stack
                is not necessary.
            
</p>
<p>
                This appendix provides sufficient information to implement an Object 
                Digest Identifier constructor or parser.
            
</p>
<a name="anchor35"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C.1"></a><h3>C.1.&nbsp;
DER Sequence Encoding</h3>

<p>
                    In DER encoding, the enclosing SEQUENCE will always be 
                    represented by the type identifier x30 followed by the length
                    specifier. Since the total length of the following data fields 
                    will almost certainly be less than 127 bytes, the single byte 
                    encoding mechanism in which bit 7 is clear and the length
                    value is encoded in the lower 7 bits will be required. 
                
</p>
<a name="anchor36"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C.2"></a><h3>C.2.&nbsp;
Object Identifiers for Certificate Types</h3>

<p>
                    OIDs have been defined in connection with the X.500 directory for
                    user certificates, certification authority certificates, revocations
                    of certification authority, and revocations of user certificates.
                    The following table lists the OIDs, their DER encoding, and their
                    type identifier and length-prefixed hex format for use in Object
                    Digest Identifiers.
                
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
id-at  OBJECT IDENTIFIER  ::=  { joint-iso-itu-t(2) ds(5) 4 }

id-at-userCertificate  OBJECT IDENTIFIER  ::=  { id-at 36 }
                                                 -- 06 03 55 04 24
  id-at-cACertificate  OBJECT IDENTIFIER  ::=  { id-at 37 }
                                                 -- 06 03 55 04 25
 TBS-PUBLIC-KEY-VALUE  OBJECT IDENTIFIER  ::=  { ??? }
                                                 -- 06 xx xx xx xx
</pre></div>
<a name="anchor37"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C.3"></a><h3>C.3.&nbsp;
Object Identifiers for Digest Algorithms</h3>

<p>
                    OIDs have been assigned by NIST for the SHA-2 digest algorithms
                    <a class='info' href='#NIST-ALGS'>[NIST&#8209;ALGS]<span> (</span><span class='info'>National Institute of Standards and Technology, &ldquo;Cryptographic Algorithm Registration,&rdquo; March&nbsp;2009.</span><span>)</span></a> <a class='info' href='#RFC4055'>[RFC4055]<span> (</span><span class='info'>Schaad, J., Kaliski, B., and R. Housley, &ldquo;Additional Algorithms and Identifiers for RSA Cryptography for use in the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; June&nbsp;2005.</span><span>)</span></a>
                    Use of the SHA-1 digest algorithm is not recommended due to
                    concerns for the security of the algorithm.
                
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
hashAlgs  OBJECT IDENTIFIER  ::=  { joint-iso-itu-t(2)
              country(16) us(840) organization(1) gov(101) csor(3)
              nistAlgorithm(4) 2 }

id-sha256  OBJECT IDENTIFIER  ::=  { hashAlgs 1 }
                                     -- 06 09 60 86 48 01 65 03 04 02 01
id-sha384  OBJECT IDENTIFIER  ::=  { hashAlgs 2 }
                                     -- 06 09 60 86 48 01 65 03 04 02 02
id-sha512  OBJECT IDENTIFIER  ::=  { hashAlgs 3 }
                                     -- 06 09 60 86 48 01 65 03 04 02 03
id-sha224  OBJECT IDENTIFIER  ::=  { hashAlgs 4 }
                                     -- 06 09 60 86 48 01 65 03 04 02 04
</pre></div>
<a name="anchor38"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C.4"></a><h3>C.4.&nbsp;
DER Data Encoding Prefixes</h3>

<p>
                    The rules of ASN.1 encoding state that every data value is preceded
                    by a data type identifier and a length identifier. In the case of 
                    an Object Digest Identifier the data type identifier is always
                    OCTET STRING (04) and the length for all currently defined digest algorithms 
                    will be less than 128 bytes (1024 bits) and thus use the single
                    byte encoding form in which bit 7 is set to 0 and the lower 7 bits 
                    specify the length.
                
</p>
<p>
                    The length prefixes for commonly used digest lengths in
                    hexadecimal notation are thus:
                
</p>
<p>
                    </p>
<blockquote class="text"><dl>
<dt>160 bits</dt>
<dd>04 14
</dd>
<dt>224 bits</dt>
<dd>04 1C
</dd>
<dt>256 bits</dt>
<dd>04 20
</dd>
<dt>384 bits</dt>
<dd>04 30
</dd>
<dt>512 bits</dt>
<dd>04 40
</dd>
</dl></blockquote><p>
                
</p>
<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Phillip Hallam-Baker</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Comodo Group Inc.</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:philliph@comodo.com">philliph@comodo.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Rob Stradling</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Comodo CA Ltd.</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:rob.stradling@comodo.com">rob.stradling@comodo.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Ben Laurie</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Google Inc.</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:benl@google.com">benl@google.com</a></td></tr>
</table>
</body></html>
