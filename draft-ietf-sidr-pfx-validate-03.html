<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>BGP Prefix Origin Validation</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Requirements Language">
<link href="#rfc.section.2" rel="Chapter" title="2 Prefix-to-AS Mapping Database">
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 Pseudo-Code">
<link href="#rfc.section.3" rel="Chapter" title="3 Policy Control">
<link href="#rfc.section.4" rel="Chapter" title="4 Interaction with Local Cache">
<link href="#rfc.section.5" rel="Chapter" title="5 Deployment Considerations">
<link href="#rfc.section.6" rel="Chapter" title="6 Contributors">
<link href="#rfc.section.7" rel="Chapter" title="7 Acknowledgements">
<link href="#rfc.section.8" rel="Chapter" title="8 IANA Considerations">
<link href="#rfc.section.9" rel="Chapter" title="9 Security Considerations">
<link href="#rfc.references" rel="Chapter" title="10 References">
<link href="#rfc.references.1" rel="Chapter" title="10.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="10.2 Informational References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="To help reduce well-known threats against BGP including prefix mis-announcing and monkey-in-the-middle attacks, one of the security requirements is the ability to validate the origination AS of BGP routes. More specifically, one  needs to validate that the AS number claiming to originate an address prefix (as derived from the AS_PATH attribute of the BGP route) is in fact authorized by the prefix holder to do so. This document describes a simple validation mechanism to partially satisfy this requirement.  " />
  <meta name="description" content="To help reduce well-known threats against BGP including prefix mis-announcing and monkey-in-the-middle attacks, one of the security requirements is the ability to validate the origination AS of BGP routes. More specifically, one  needs to validate that the AS number claiming to originate an address prefix (as derived from the AS_PATH attribute of the BGP route) is in fact authorized by the prefix holder to do so. This document describes a simple validation mechanism to partially satisfy this requirement.  " />
  <meta name="keywords" content="IDR" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Network Working Group</td>
<td class="right">P.M. Mohapatra, Ed.</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Cisco Systems</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">J.S. Scudder, Ed.</td>
</tr>
<tr>
<td class="left">Expires: May 03, 2012</td>
<td class="right">D.W. Ward, Ed.</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Juniper Networks</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">R.B. Bush, Ed.</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Internet Initiative Japan, Inc.</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">R.A. Austein, Ed.</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Internet Systems Consortium</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">October 31, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">BGP Prefix Origin Validation<br />
  <span class="filename">draft-ietf-sidr-pfx-validate-03</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>To help reduce well-known threats against BGP including prefix mis-announcing and monkey-in-the-middle attacks, one of the security requirements is the ability to validate the origination AS of BGP routes. More specifically, one  needs to validate that the AS number claiming to originate an address prefix (as derived from the AS_PATH attribute of the BGP route) is in fact authorized by the prefix holder to do so. This document describes a simple validation mechanism to partially satisfy this requirement.  </p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on May 03, 2012.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>
<p>This document may contain material from IETF Documents or IETF Contributions published or made publicly available before November 10, 2008.  The person(s) controlling the copyright in some of this material may not have granted the IETF Trust the right to allow modifications of such material outside the IETF Standards Process. Without obtaining an adequate license from the person(s) controlling the copyright in such materials, this document may not be modified outside the IETF Standards Process, and derivative works of it may not be created outside the IETF Standards Process, except to format it for publication as an RFC or to translate it into languages other than English.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>1.1.   <a href="#rfc.section.1.1">Requirements Language</a>
</li>
<li>2.   <a href="#rfc.section.2">Prefix-to-AS Mapping Database</a>
</li>
<li>2.1.   <a href="#rfc.section.2.1">Pseudo-Code</a>
</li>
<li>3.   <a href="#rfc.section.3">Policy Control</a>
</li>
<li>4.   <a href="#rfc.section.4">Interaction with Local Cache</a>
</li>
<li>5.   <a href="#rfc.section.5">Deployment Considerations</a>
</li>
<li>6.   <a href="#rfc.section.6">Contributors</a>
</li>
<li>7.   <a href="#rfc.section.7">Acknowledgements</a>
</li>
<li>8.   <a href="#rfc.section.8">IANA Considerations</a>
</li>
<li>9.   <a href="#rfc.section.9">Security Considerations</a>
</li>
<li>10.   <a href="#rfc.references">References</a>
</li>
<li>10.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>10.2.   <a href="#rfc.references.2">Informational References</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> <a href="#introduction" id="introduction">Introduction</a>
</h1>
<p id="rfc.section.1.p.1">A BGP route associates an address prefix with a set of autonomous systems (AS) that identify the interdomain path the prefix has traversed in the form of BGP announcements. This set is represented as the AS_PATH attribute in BGP <a href="#RFC4271">[RFC4271]</a> and starts with the AS that originated the prefix. To help reduce well-known threats against BGP including prefix mis-announcing and monkey-in-the-middle attacks, one of the security requirements is the ability to validate the origination AS of BGP routes. More specifically, one  needs to validate that the AS number claiming to originate an address prefix (as derived from the AS_PATH attribute of the BGP route) is in fact authorized by the prefix holder to do so. This document describes a simple validation mechanism to partially satisfy this requirement.  </p>
<p id="rfc.section.1.p.2">The Resource Public Key Infrastructure (RPKI) describes an approach to build a formally verifyable database of IP addresses and AS numbers as resources.  The overall architecture of RPKI as defined in <a href="#I-D.ietf-sidr-arch">[I-D.ietf-sidr-arch]</a> consists of three main components: </p>

<ul>
<li>A public key infrastructure (PKI) with the necessary certificate objects, </li>
<li>Digitally signed routing objects, </li>
<li>A distributed repository system to hold the objects that would also support periodic retrieval.  </li>
</ul>

<p> </p>
<p id="rfc.section.1.p.3">The RPKI system is based on resource certificates that define extensions to X.509 to represent IP addresses and AS identifiers <a href="#RFC3779">[RFC3779]</a>, thus the name RPKI.  Route Origin Authorizations (ROA) <a href="#I-D.ietf-sidr-roa-format">[I-D.ietf-sidr-roa-format]</a> are separate digitally signed objects that define associations between ASes and IP address blocks. Finally the repository system is operated in a distributed fashion through the IANA, RIR hierarchy, and ISPs.  </p>
<p id="rfc.section.1.p.4">In order to benefit from the RPKI system, it is envisioned that relying parties either at AS or organization level obtain a local copy of the signed object collection, verify the signatures, and process them. The cache must also be refreshed periodically. The exact access mechanism used to retrieve the local cache is beyond the scope of this document.  </p>
<p id="rfc.section.1.p.5">Individual BGP speakers can utilize the processed data contained in the local cache to validate BGP announcements. The protocol details to retrieve the processed data from the local cache to the BGP speakers is beyond the scope of this document (refer to <a href="#I-D.ietf-sidr-rpki-rtr">[I-D.ietf-sidr-rpki-rtr]</a> for such a mechanism).  This document proposes a means by which a BGP speaker can make use of the processed data in order to assign a "validity state" to each prefix in a received BGP UPDATE message.  </p>
<p id="rfc.section.1.p.6">Note that the complete path attestation against the AS_PATH attribute of a route is outside the scope of this document.  </p>
<p id="rfc.section.1.p.7">Although RPKI provides the context for this draft, it is equally possible to use any other database which is able to map prefixes to their authorized origin ASes. Each distinct database will have its own particular operational and security characteristics; such characteristics are beyond the scope of this document.  </p>
<h1 id="rfc.section.1.1">
<a href="#rfc.section.1.1">1.1.</a> Requirements Language</h1>
<p id="rfc.section.1.1.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">RFC 2119</a> <cite title="NONE">[RFC2119]</cite>.</p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> <a href="#mapping_database" id="mapping_database">Prefix-to-AS Mapping Database</a>
</h1>
<p id="rfc.section.2.p.1">The BGP speaker loads validated objects from the cache into local storage. The objects loaded have the content (IP address, prefix length, maximum length, origin AS number).  We refer to such a locally stored object colloquially as a "ROA" in the discussion below although we note that this is not a strictly accurate use of the term.  </p>
<p id="rfc.section.2.p.2">We define several terms in addition to "ROA".  Where these terms are used, they are capitalized: </p>
<p></p>

<ul>
<li>Prefix: (IP address, prefix length), interpreted as is customary (see <a href="#RFC4632">[RFC4632]</a>).  </li>
<li>Route: Data derived from a received BGP UPDATE, as defined in <a href="#RFC4271">[RFC4271]</a>, Section 1.1. The Route includes one Prefix and an AS_PATH, among other things.  </li>
<li>ROA Prefix: The Prefix from a ROA.  </li>
<li>ROA ASN: The origin ASN from a ROA.  </li>
<li>Route Prefix: A Prefix derived from a route.  </li>
<li>Route Origin ASN: The origin AS number derived from a Route.  The origin AS number is the rightmost AS in the final segment of the AS_PATH attribute in the Route if that segment is of type AS_SEQUENCE, or NONE if the final segment of the AS_PATH attribute is of any type other than AS_SEQUENCE. No ROA can match an origin AS number of "NONE".  No Route can match a ROA whose origin AS number is zero.  </li>
<li>Covered: A Route Prefix is said to be Covered by a ROA when the ROA prefix length is less than or equal to the Route prefix length and the ROA prefix address matches the Route prefix address for all bits specified by the ROA prefix length. (This is simply a statement of the well-known concept of determining a prefix match.) </li>
<li>Matched: A Route Prefix is said to be Matched by a ROA when the Route Prefix is Covered by that ROA and in addition, the Route prefix length is less than or equal to the ROA maximum length and the Route Origin ASN is equal to the ROA ASN, keeping in mind that a ROA ASN of zero can never be matched, nor can a route origin AS number of "NONE".  </li>
</ul>
<p id="rfc.section.2.p.4">Given these definitions, any given BGP Route learned from an EBGP peer will be found to have one of the following "validation states": </p>
<p></p>

<ul>
<li>Not found: No ROA Covers the Route Prefix.  </li>
<li>Valid: At least one ROA Matches the Route Prefix.  </li>
<li>Invalid: At least one ROA Covers the Route Prefix, but no ROA Matches it.  </li>
</ul>
<p id="rfc.section.2.p.6">When a BGP speaker receives an UPDATE from one of its EBGP peers, it SHOULD perform a lookup as described above for each of the Routes in the UPDATE message. The "validation state" of the Route SHOULD be set to reflect the result of the lookup. Note that the validation state of the Route does not determine whether the Route is stored in the local BGP speaker's Adj-RIB-In.  This procedure SHOULD NOT be performed for Routes learned from peers of types other than EBGP.  (Any of these MAY be overridden by configuration.) </p>
<p id="rfc.section.2.p.7">Use of the validation state is discussed in <a href="#policy_control">Section 3</a> and <a href="#deployment_consideration">Section 5</a>.  </p>
<p id="rfc.section.2.p.8">We observe that a Route can be Matched or Covered by more than one ROA.  This procedure does not mandate an order in which ROAs must be visited; however, the "validation state" output is fully determined.  </p>
<h1 id="rfc.section.2.1">
<a href="#rfc.section.2.1">2.1.</a> Pseudo-Code</h1>
<div id="#rfc.figure.1"></div>
<pre>

//Input are the variables derived from a BGP UPDATE message
//that need to be validated.
//
//The input prefix is comprised of prefix.address and 
//prefix.length.
//
//origin_as is the rightmost AS in the final segment of the
//AS_PATH attribute in the UPDATE message if that segment is 
//AS_SEQUENCE.  If the final segment of AS_PATH is not an 
//AS_SEQUENCE, origin_as is NONE.
//
//Collectively, the prefix and origin_as correspond to the
//Route defined in the preceding section.
input = {prefix, origin_as};

//Initialize result to "not found" state
result = BGP_PFXV_STATE_NOT_FOUND;

//pfx_validate_table organizes all the ROA entries retrieved
//from the RPKI cache based on the IP address and the prefix 
//length field. There can be multiple such entries that match 
//the input. Iterate through all of them.
entry = next_lookup_result(pfx_validate_table, input.prefix);

while (entry != NULL) {
    prefix_exists = TRUE;

    if (input.prefix.length &lt;= entry-&gt;max_length) {
        if (input.origin_as != NONE
            &amp;&amp; entry-&gt;origin_as != 0
            &amp;&amp; input.origin_as == entry-&gt;origin_as) {
            result = BGP_PFXV_STATE_VALID;
            return (result);
        }
    }
    entry = next_lookup_result(pfx_validate_table, input.prefix);
}

//If pfx_validate_table contains one or more prefixes that
//match the input, but none of them resulted in a "valid"
//outcome since the origin_as did not match, return the
//result state as "invalid". Else the initialized state of
//"not found" applies to this validation operation.
if (prefix_exists == TRUE) {
    result = BGP_PFXV_STATE_INVALID;
}

return (result);

            </pre>
<p id="rfc.section.2.1.p.1">The following pseudo-code illustrates the procedure above.  In case of ambiguity, the procedure above, rather than the pseudo-code, should be taken as authoritative.  </p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#policy_control" id="policy_control">Policy Control</a>
</h1>
<p id="rfc.section.3.p.1">An implementation MUST provide the ability to match and set the validation state of routes as part of its route policy filtering function.  Use of validation state in route policy is elaborated in <a href="#deployment_consideration">Section 5</a>. For more details on operational policy considerations, see <a href="#I-D.ietf-sidr-origin-ops">[I-D.ietf-sidr-origin-ops]</a>.  </p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#local_cache" id="local_cache">Interaction with Local Cache</a>
</h1>
<p id="rfc.section.4.p.1">Each BGP speaker supporting prefix validation as described in this document is expected to communicate with one or multiple local caches that store a database of RPKI signed objects. The protocol mechanisms used to fetch the data and store them locally at the BGP speaker is beyond the scope of this document (please refer <a href="#I-D.ietf-sidr-rpki-rtr">[I-D.ietf-sidr-rpki-rtr]</a>). Irrespective of the protocol, the prefix validation algorithm as outlined in this document is expected to function correctly in the event of failures and other timing conditions that may result in an empty and/or partial prefix-to-AS mapping database. Indeed, if the (in-PoP) cache is not available and the mapping database is empty on the BGP speaker, all the lookups will result in "not found" state and the prefixes will be advertised to rest of the network (unless restricted by policy configuration). Similarly, if BGP UPDATEs arrive at the speaker while the fetch operation from the cache is in progress, some prefix lookups will also result in "not found" state. The implementation is expected to handle these timing conditions and MUST re-validate affected prefixes once the fetch operation is complete. The same applies during any subsequent incremental updates of the validation database.  </p>
<p id="rfc.section.4.p.2">In the event that connectivity to the cache is lost, the router should make a reasonable effort to fetch a new validation database (either from the same, or a different cache), and SHOULD wait until the new validation database has been fetched before purging the previous one.  A configurable timer MUST be provided to bound the length of time the router will wait before purging the previous validation database.  </p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#deployment_consideration" id="deployment_consideration">Deployment Considerations</a>
</h1>
<p id="rfc.section.5.p.1">Once a route is received from an EBGP peer it is categorized according the procedure given in <a href="#mapping_database">Section 2</a>.  Subsequently, routing policy as discussed in <a href="#policy_control">Section 3</a> can be used to take action based on the validation state.  </p>
<p id="rfc.section.5.p.2">Policies which could be implemented include filtering routes based on validation state (for example, rejecting all "invalid" routes) or adjusting a route's degree of preference in the selection algorithm based on its validation state.  The latter could be accomplished by adjusting the value of such attributes as LOCAL_PREF. Considering invalid routes for BGP decision process is a pure local policy matter and should be done with utmost care.  </p>
<p id="rfc.section.5.p.3">In some cases (particularly when the selection algorithm is influenced by the adjustment of a route property that is not propagated into IBGP) it could be necessary for routing correctness to propagate the validation state to the IBGP peer.  This can be accomplished on the sending side by setting a community or extended community based on the validation state, and on the receiving side by matching the (extended) community and setting the validation state.  </p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> Contributors</h1>
<p></p>
<p></p>

<ul class="empty">
<li>Rex Fernando  rex@cisco.com </li>
<li>Keyur Patel   keyupate@cisco.com </li>
<li>Cisco Systems </li>
</ul>

<p> </p>
<p></p>

<ul class="empty">
<li>Miya Kohno    mkohno@juniper.net </li>
<li>Juniper Networks </li>
</ul>

<p> </p>
<p></p>

<ul class="empty">
<li>Shin Miyakawa  miyakawa@nttv6.jp </li>
<li>Taka Mizuguchi </li>
<li>Tomoya Yoshida </li>
<li>NTT Communications </li>
</ul>

<p> </p>
<p></p>

<ul class="empty">
<li>Russ Housley housley@vigilsec.com </li>
<li>Vigil Security </li>
</ul>

<p> </p>
<p></p>

<ul class="empty">
<li>Junaid Israr  jisra052@uottawa.ca </li>
<li>Mouhcine Guennoun  mguennou@uottawa.ca </li>
<li>Hussein Mouftah  mouftah@site.uottawa.ca </li>
<li>University of Ottawa School of Information Technology and Engineering(SITE) 800 King Edward Avenue, Ottawa, Ontario, Canada, K1N 6N5 </li>
</ul>

<p> </p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> <a href="#Acknowledgements" id="Acknowledgements">Acknowledgements</a>
</h1>
<p id="rfc.section.7.p.1">Junaid Israr's contribution to this specification is part of his PhD research work and thesis at University of Ottawa, Canada.  Hannes Gredler provided valuable feedback.  </p>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> <a href="#IANA" id="IANA">IANA Considerations</a>
</h1>
<p></p>
<h1 id="rfc.section.9">
<a href="#rfc.section.9">9.</a> <a href="#Security" id="Security">Security Considerations</a>
</h1>
<p id="rfc.section.9.p.1">Although this specification discusses one portion of a system to validate BGP routes, it should be noted that it relies on a database (RPKI or other) to provide validation information.  As such, the security properties of that database must be considered in order to determine the security provided by the overall solution.  If "invalid" routes are blocked as this specification suggests, the overall system provides a possible denial-of-service vector, for example if an attacker is able to inject one or more spoofed records into the validation database which lead a good route to be declared invalid.  In addition, this system is only able to provide limited protection against a determined attacker -- the attacker need only prepend the "valid" source AS to a forged BGP route announcement in order to defeat the protection provided by this system.  This mechanism does not protect against "AS in the middle attacks" or provide any path validation. It only attempts to verify the origin.  In general, this system should be thought of more as a protection against misconfiguration than as true "security" in the strong sense.  </p>
<h1 id="rfc.references">
<a href="#rfc.references">10.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">10.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3779">[RFC3779]</b></td>
<td class="top">
<a>Lynn, C.</a>, <a>Kent, S.</a> and <a>K. Seo</a>, "<a href="http://tools.ietf.org/html/rfc3779">X.509 Extensions for IP Addresses and AS Identifiers</a>", RFC 3779, June 2004.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4271">[RFC4271]</b></td>
<td class="top">
<a>Rekhter, Y.</a>, <a>Li, T.</a> and <a>S. Hares</a>, "<a href="http://tools.ietf.org/html/rfc4271">A Border Gateway Protocol 4 (BGP-4)</a>", RFC 4271, January 2006.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4632">[RFC4632]</b></td>
<td class="top">
<a>Fuller, V.</a> and <a>T. Li</a>, "<a href="http://tools.ietf.org/html/rfc4632">Classless Inter-domain Routing (CIDR): The Internet Address Assignment and Aggregation Plan</a>", BCP 122, RFC 4632, August 2006.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-sidr-roa-format">[I-D.ietf-sidr-roa-format]</b></td>
<td class="top">
<a>Lepinski, M</a>, <a>Kent, S</a> and <a>D Kong</a>, "<a href="http://tools.ietf.org/html/draft-ietf-sidr-roa-format-12">A Profile for Route Origin Authorizations (ROAs)</a>", Internet-Draft draft-ietf-sidr-roa-format-12, May 2011.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">10.2.</a> Informational References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="I-D.ietf-sidr-arch">[I-D.ietf-sidr-arch]</b></td>
<td class="top">
<a>Lepinski, M</a> and <a>S Kent</a>, "<a href="http://tools.ietf.org/html/draft-ietf-sidr-arch-13">An Infrastructure to Support Secure Internet Routing</a>", Internet-Draft draft-ietf-sidr-arch-13, May 2011.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-sidr-rpki-rtr">[I-D.ietf-sidr-rpki-rtr]</b></td>
<td class="top">
<a>Bush, R</a> and <a>R Austein</a>, "<a href="http://tools.ietf.org/html/draft-ietf-sidr-rpki-rtr-19">The RPKI/Router Protocol</a>", Internet-Draft draft-ietf-sidr-rpki-rtr-19, October 2011.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-sidr-origin-ops">[I-D.ietf-sidr-origin-ops]</b></td>
<td class="top">
<a>Bush, R</a>, "<a href="http://tools.ietf.org/html/draft-ietf-sidr-origin-ops-12">RPKI-Based Origin Validation Operation</a>", Internet-Draft draft-ietf-sidr-origin-ops-12, October 2011.</td>
</tr>
</tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Pradosh Mohapatra</span> editor
	  <span class="n hidden">
		<span class="family-name">Mohapatra</span>
	  </span>
	</span>
	<span class="org vcardline">Cisco Systems</span>
	<span class="adr">
	  <span>170 W. Tasman Drive</span>

	  <span class="vcardline">
		<span class="locality">San Jose</span>,  
		<span class="region">CA</span> 
		<span class="code">95134</span>
	  </span>
	  <span class="country-name vcardline">USA</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:pmohapat@cisco.com">pmohapat@cisco.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">John Scudder</span> editor
	  <span class="n hidden">
		<span class="family-name">Scudder</span>
	  </span>
	</span>
	<span class="org vcardline">Juniper Networks</span>
	<span class="adr">
	  <span>1194 N. Mathilda Ave</span>

	  <span class="vcardline">
		<span class="locality">Sunnyvale</span>,  
		<span class="region">CA</span> 
		<span class="code">94089</span>
	  </span>
	  <span class="country-name vcardline">USA</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:jgs@juniper.net">jgs@juniper.net</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">David Ward</span> editor
	  <span class="n hidden">
		<span class="family-name">Ward</span>
	  </span>
	</span>
	<span class="org vcardline">Juniper Networks</span>
	<span class="adr">
	  <span>1194 N. Mathilda Ave</span>

	  <span class="vcardline">
		<span class="locality">Sunnyvale</span>,  
		<span class="region">CA</span> 
		<span class="code">94089</span>
	  </span>
	  <span class="country-name vcardline">USA</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:dward@juniper.net">dward@juniper.net</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Randy Bush</span> editor
	  <span class="n hidden">
		<span class="family-name">Bush</span>
	  </span>
	</span>
	<span class="org vcardline">Internet Initiative Japan, Inc.</span>
	<span class="adr">
	  <span>5147 Crystral Springs</span>

	  <span class="vcardline">
		<span class="locality">Bainbridge Island</span>,  
		<span class="region">Washington</span> 
		<span class="code">98110</span>
	  </span>
	  <span class="country-name vcardline">USA</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:randy@psg.com">randy@psg.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Rob Austein</span> editor
	  <span class="n hidden">
		<span class="family-name">Austein</span>
	  </span>
	</span>
	<span class="org vcardline">Internet Systems Consortium</span>
	<span class="adr">
	  <span>950 Charter Street</span>

	  <span class="vcardline">
		<span class="locality">Redwood City</span>,  
		<span class="region">CA</span> 
		<span class="code">94063</span>
	  </span>
	  <span class="country-name vcardline">USA</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:sra@isc.org">sra@isc.org</a></span>

  </address>
</div>

</body>
</html>