Internet Engineering Task Force                   Roy Spitzer(Editor)
INTERNET DRAFT                                                Telogy
<draft-ietf-megaco-fmtdeterm-00.txt>       Zacharias Bilalis (Editor)
Category: Standards Track (?)                                Siemens
Expires: August 1, 2000

Contributions from:
                                             Gunnar Hellstrom Omnitor
                                 James Rafferty Brooktrout Technology
                                        Glenn Parsons Nortel Networks


      Fax, Modem, Text Telephone Determination using Megaco/H.248


STATUS OF THIS MEMO

This document is an Internet-Draft and is in full conformance with all
provisions of Section 10 of  RFC2026.

Internet-Drafts are working documents of the Internet Engineering Task
Force (IETF), its areas, and its working groups.  Note that other groups
may also distribute working documents as Internet- Drafts.

Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any
time.  It is inappropriate to use Internet- Drafts as reference material
or to cite them other than as "work in progress."

The list of current Internet-Drafts can be accessed at
http://www.ietf.org/ietf/1id-abstracts.txt

The list of Internet-Draft Shadow Directories can be accessed at
http://www.ietf.org/shadow.html.



ABSTRACT

This document discusses the dynamic determination of
Voice/Modem/FAX/Text Telephone over a single port using Megaco and
refers to the packages described for Megaco. The document aims to become
an Appendix to Megaco and to be the base for the "application guide".



                           TABLE OF CONTENTS




Spitzer, Bilalis                                                [Page 1]





Internet draft           F, M, T Determination          February 1, 2000




        1. Introduction   .. .. .. .. .. .. .. .. .. .. .. .. .. ..  2
        2. Relay Ports supporting V.8 .. .. .. .. .. .. .. .. .. ..  2
        3. Relay Ports for V.21 .. .. .. .. .. .. .. .. .. .. .. .. 10
        4. References  .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. 10



1. Introduction

This document discusses the dynamic determination of
Voice/Modem/FAX/Text Telephone over a single port using Megaco and
refers to the packages described for Megaco. The document aims to become
an Appendix to Megaco and to be the base for the "application guide".



2 Relay Ports supporting V.8
































Spitzer, Bilalis                                                [Page 2]





Internet draft           F, M, T Determination          February 1, 2000



        Termination T1                    MGC                  Termination T2

              |<-ctx=NULL,MODify(T1)-------|                            |
              |--Resp--------------------->|                            |
              |<-Audit(capabilities)-------|                            |
              |--Resp(codecs)------------->|                            |
        off-  |                            |                            |
        hook  |--Notify(offhook)---------->|                            |
              |<-Resp----------------------|                            |
        Accumulate                         |                            |
        Digits|--Notify(number)----------->|                            |
              |                            |--Audit(capabilities)------>|
              |<-Resp----------------------|                            |
              |                            |<--Resp(codecs)-------------|
              |<-ADD CTX(T1,selectCODEC)---|                            |
              |                            |--ADD CTX(T2,select CODEC)->|
              |--Resp--------------------->|                            |
              |                            |<--Resp---------------------|
              |                            |--MOD CTX(T2,Sig=ring)----->|
              |<-MOD CTX(T1,Sig=ringback)--|                            |RING
        Ringback                           |<-Resp----------------------|
        Tone  |--Resp--------------------->|                            |off-
              |                            |<-Notify(offhook)-----------|hook
              |<-MOD CTX(T1,Mode=sendrecv)-|                            |
              |                            |--Resp--------------------->|
              |--Resp--------------------->|                            |
        +------------------------------------------------------------------+
        |           Voice may be transferred between T1 and T2             |
        +------------------------------------------------------------------+
          CNG |                            |                            |
              |--Notify(dtone=CNG)-------->|                            |
              |                            |--MOD CTX(T2,Sig=CNG)------>|
              |<-Resp----------------------|                            |CNG
              |                            |<-Resp----------------------|
              |                            |                            |CED
              |                            |<-Notify(dtone=CED)---------|
              |<-MOD CTX(T1,Sig=CED)-------|                            |
          CED |                            |--Resp--------------------->|
              |--Resp--------------------->|                            |
              |                            |-MOD CTX(T2,selectFAXCODEC)>|
              |                            |                            |load
              |                            |<-Resp----------------------|CODEC
              |<MOD CTX(T1,selectFAXCODEC)-|                            |
         load |                            |                            |
         CODEC|--Resp--------------------->|                            |
              |                            |                            |V.21
              |                            |<-Notify(dtone=V21flag)-----|flags



Spitzer, Bilalis                                                [Page 3]





Internet draft           F, M, T Determination          February 1, 2000


              |<-MOD CTX(T1,Sig=V21flag)---|                            |
              |                            |--Resp--------------------->|
              |--Resp--------------------->|                            |
              |                            |                            |V.21
              |                            |                            |flags
        +------------------------------------------------------------------+
        |           Start FAX Communications                               |
        +------------------------------------------------------------------+

        Voice to FAX Call with modem or Text Telephone Call possible
        (Termination on Media Gateway) - Switchover based on CED/ANS detection

        Figure 1. Switch to FAX based on CNG and CED



If CNG and CED are detected, the MGC should switch to the FAX codec. If
the CNG is not used for switching, a flow similar to Figure 2 can be
used.
































Spitzer, Bilalis                                                [Page 4]





Internet draft           F, M, T Determination          February 1, 2000



        Termination T1                    MGC                  Termination T2

              |<-ctx=NULL,MODify(T1)-------|                            |
              |--Resp--------------------->|                            |
              |<-Audit(capabilities)-------|                            |
              |--Resp(codecs)------------->|                            |
        off-  |                            |                            |
        hook  |--Notify(offhook)---------->|                            |
              |<-Resp----------------------|                            |
        Accumulate                         |                            |
        Digits|--Notify(number)----------->|                            |
              |                            |--Audit(capabilities)------>|
              |<-Resp----------------------|                            |
              |                            |<--Resp(codecs)-------------|
              |<-ADD CTX(T1,selectCODEC)---|                            |
              |                            |--ADD CTX(T2,select CODEC)->|
              |--Resp--------------------->|                            |
              |                            |<--Resp---------------------|
              |                            |--MOD CTX(T2,Sig=ring)----->|
              |<-MOD CTX(T1,Sig=ringback)--|                            |RING
        Ringback                           |<-Resp----------------------|
        Tone  |--Resp--------------------->|                            |off-
              |                            |<-Notify(offhook)-----------|hook
              |<-MOD CTX(T1,Mode=sendrecv)-|                            |
              |                            |--Resp--------------------->|
              |--Resp--------------------->|                            |
        +------------------------------------------------------------------+
        |           Voice may be transferred between T1 and T2             |
        +------------------------------------------------------------------+
          CNG not seen or not sent         |                            |
              |                            |                            |
              |                            |                            |
              |                            |                            |
              |                            |                            |CED/
              |                            |<-Notify(dtone=CED/ANS)-----|ANS
              |<-MOD CTX(T1,Sig=CED/ANS)---|                            |
          CED |                            |--Resp--------------------->|
              |--Resp--------------------->|                            |
              |                            |-MOD CTX(T2,selTextTelCODEC>|
              |                            |                            |load
              |                            |<-Resp----------------------|CODEC
              |<MOD CTX(T1,selTextTelCODEC-|                           |
         load |                            |                            |
         CODEC|--Resp--------------------->|                            |
              |                            |                            |V.21
              |                            |<-Notify(dtone=V21flag)-----|flags
              |<-MOD CTX(T1,Sig=V21flag)---|                            |



Spitzer, Bilalis                                                [Page 5]





Internet draft           F, M, T Determination          February 1, 2000


              |                            |--Resp--------------------->|
              |--Resp--------------------->|                            |
              |                            |-MOD CTX(T2,selectFAXCODEC)>|
              |<-MOD CTX(T1,selFAXCODEC)---|                            |load
              |                            |<-Resp----------------------|CODEC
         load |                            |                            |
         CODEC|--Resp--------------------->|                            |
              |                            |                            |V.21
              |                            |<-Notify(dtone=V21flag)-----|flags
              |<-MOD CTX(T1,Sig=V21flag)---|                            |
              |                            |--Resp--------------------->|
              |--Resp--------------------->|                            |
        +------------------------------------------------------------------+
        |           Start FAX Communications                               |
        +------------------------------------------------------------------+

        Voice to FAX Call with modem or Text Telephone Call possible
        (Termination on Media Gateway) - Switchover based on CED/ANS detection,
        FAX switchover based on V.21 flag detection

        Figure 2. Switch to FAX based on V.21 Flags


A CI tone may be sent prior to the CED/ANS tone.



























Spitzer, Bilalis                                                [Page 6]





Internet draft           F, M, T Determination          February 1, 2000



        Termination T1                    MGC                  Termination T2

              |<-ctx=NULL,MODify(T1)-------|                            |
              |--Resp--------------------->|                            |
              |<-Audit(capabilities)-------|                            |
              |--Resp(codecs)------------->|                            |
        off-  |                            |                            |
        hook  |--Notify(offhook)---------->|                            |
              |<-Resp----------------------|                            |
        Accumulate                         |                            |
        Digits|--Notify(number)----------->|                            |
              |                            |--Audit(capabilities)------>|
              |<-Resp----------------------|                            |
              |                            |<--Resp(codecs)-------------|
              |<-ADD CTX(T1,selectCODEC)---|                            |
              |                            |--ADD CTX(T2,select CODEC)->|
              |--Resp--------------------->|                            |
              |                            |<--Resp---------------------|
              |                            |--MOD CTX(T2,Sig=ring)----->|
              |<-MOD CTX(T1,Sig=ringback)--|                            |RING
        Ringback                           |<-Resp----------------------|
        Tone  |--Resp------------------->--|                            |off-
              |                            |<-Notify(offhook)-----------|hook
              |<-MOD CTX(T1,Mode=sendrecv)-|                            |
              |                            |--Resp--------------------->|
              |--Resp--------------------->|                            |
        +------------------------------------------------------------------+
        |           Voice may be transferred between T1 and T2             |
        +------------------------------------------------------------------+
          CI  |                            |                            |
              |-Notify(MdmToneEvent=CI)--->|                            |
              |                            |--MOD CTX(T2, Sig=CI)------>|
              |<-Resp----------------------|                            | CI
              |                            |<-Resp----------------------|
              |                            |                            |CED/
              |                            |<-Notify(dtone=ANS)---------|ANS
              |<-MOD CTX(T1,Sig=ANS)------>|
          ANS |                            |--Resp--------------------->|
              |--Resp--------------------->|                            |
              |                            |-MOD CTX(T1,selTextTelCODEC>|
              |                            |                            |load
              |                            |<-Resp----------------------|CODEC
              |<MOD CTX(T1,selTextTelCODEC-|                            |
         load |                            |                            |
         CODEC|--Resp--------------------->|                            |
              |                            |                            |CM
              |                            |<-Notify(MdmToneEvent=CM)---|



Spitzer, Bilalis                                                [Page 7]





Internet draft           F, M, T Determination          February 1, 2000


              |<-MOD CTX(T1,Sig=CM)--------|                            |
          CM  |                            |--Resp--------------------->|
              |--Resp--------------------->|                            |
              |                            |-MOD CTX(T2,selModemCODEC)->|
              |<-MOD CTX(T1,selModemCODEC)-|                            |load
              |                            |<-Resp----------------------|CODEC
         load |                            |                            |
         CODEC|--Resp--------------------->|                            |
              |                            |                            |CM
              |                            |<-Notify(MdmToneEvent=CM)---|
              |<-MOD CTX(T1,Sig=CM)--------|                            |
           CM |                            |--Resp--------------------->|
              |--Resp--------------------->|                            |
        +------------------------------------------------------------------+
        |           Start Modem Communications                             |
        +------------------------------------------------------------------+

        Voice to Modem Call with FAX or Text Telephone Call possible
        (Termination on Media Gateway) - Switchover based on CED/ANS detection
        Figure 3.  Modem Determination Based on ANS and CM































Spitzer, Bilalis                                                [Page 8]





Internet draft           F, M, T Determination          February 1, 2000



        Termination T1                    MGC                  Termination T2

              |<-ctx=NULL,MODify(T1)-------|                            |
              |--Resp--------------------->|                            |
              |<-Audit(capabilities)-------|                            |
              |--Resp(codecs)------------->|                            |
        off-  |                            |                            |
        hook  |--Notify(offhook)---------->|                            |
              |<-Resp----------------------|                            |
        Accumulate                         |                            |
        Digits|--Notify(number)----------->|                            |
              |                            |--Audit(capabilities)------>|
              |<-Resp----------------------|                            |
              |                            |<--Resp(codecs)-------------|
              |<-ADD CTX(T1,selectCODEC)---|                            |
              |                            |--ADD CTX(T2,select CODEC)->|
              |--Resp--------------------->|                            |
              |                            |<--Resp---------------------|
              |                            |--MOD CTX(T2,Sig=ring)----->|
              |<-MOD CTX(T1,Sig=ringback)--|                            |RING
        Ringback                           |<-Resp----------------------|
        Tone  |--Resp------------------->--|                            |off-
              |                            |<-Notify(offhook)-----------|hook
              |<-MOD CTX(T1,Mode=sendrecv)-|                            |
              |                            |--Resp--------------------->|
              |--Resp--------------------->|                            |
        +------------------------------------------------------------------+
        |           Voice may be transferred between T1 and T2             |
        +------------------------------------------------------------------+
          CI  |                            |                            |
              |-Notify(TextPhoneSig=CIV18)>|                            |
              |                            |--MOD CTX(T2, Sig=CIV18)--->|
              |<-Resp----------------------|                            | CI
              |                            |<-Resp----------------------|
              |                            |                            |ANS
              |                            |<-Notify(dtone=ANS)---------|
              |<-MOD CTX(T1,Sig=ANS)------>|
         ANS  |                            |--Resp--------------------->|
              |--Resp--------------------->|                            |
              |                            |-MOD CTX(T2,selTextTelCODEC>|
              |                            |                            |load
              |                            |<-Resp----------------------|CODEC
              |<MOD CTX(T1,selTextTelCODEC-|                            |
         load |                            |                            |
         CODEC|--Resp--------------------->|                            |
              |                            |                            |
          TXP |                            |                            |



Spitzer, Bilalis                                                [Page 9]





Internet draft           F, M, T Determination          February 1, 2000


              |--Notify(TextPhoneSig=TXP)->|                            |
              |                            |-MOD CTX(T2,Sig=TXP)------->|
              |                            |<-Resp----------------------|
              |<-Resp----------------------|                            |
        +------------------------------------------------------------------+
        |           Start Text Telephone Communications                    |
        +------------------------------------------------------------------+

        Voice to Text Telephone Call with FAX or Modem Call possible
        (Termination on Media Gateway) - Switchover based on CED/ANS detection
        Figure 4. Text Telephone Determination



3 Relay Ports for V.21

TBD

4 References

[1]  ITU-T Recommendation T.30 (7/96) Procedures for document facsimile
     transmission in the general switched telephone network.

[2]  ITU-T Recommendation V.8 Procedures for starting sessions of data
     transmission over the public switched telephone network

[3]  ITU-T Recommendation V.8 bis Procedures for the identification and
     selection of common modes of operation between data circuit-
     termination equipment (DCEs).

[4]  ITU-T Recommendation V.18 Operational and interworking requirements
     for DCES operating in the text telephone mode.

[5]  ITU-T Recommendation V.25 Automatic answering equipment and/or
     parallel automatic calling equipment on the general switched tele-
     phone network.

[6]  ITU-T Recommendation V.21 (11/88) - 300 bits per second duplex
     modem standardized for use in the general switched telephone net-
     work

     tbl *.txt | nroff -ms | col -bx | f.pl > out









Spitzer, Bilalis                                               [Page 10]


