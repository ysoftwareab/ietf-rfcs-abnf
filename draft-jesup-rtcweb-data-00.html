<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>RTCWeb Datagram Connection </title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.2" rel="Chapter" title="2 Requirements">
<link href="#rfc.section.3" rel="Chapter" title="3 Use cases.">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 Use cases for unreliable datagram based channel">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 Use cases for reliable channels (datagram or stream).">
<link href="#rfc.section.4" rel="Chapter" title="4 Protocol alternatives">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 Datagrams over DTLS over DCCP over UDP.">
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 Datagrams over SCTP over DTLS over UDP.">
<link href="#rfc.section.4.3" rel="Chapter" title="4.3 A new protocol on top of UDP.">
<link href="#rfc.section.4.4" rel="Chapter" title="4.4 A RTP compatible protocol.">
<link href="#rfc.section.5" rel="Chapter" title="5 Datagrams over SCTP over DTLS over UDP.">
<link href="#rfc.section.5.1" rel="Chapter" title="5.1 User Space vs Kernel implementation.">
<link href="#rfc.section.5.2" rel="Chapter" title="5.2 The envisioned usage of SCTP in the RTCWeb context">
<link href="#rfc.section.5.3" rel="Chapter" title="5.3 SCTP/DTLS/UDP vs DTLS/SCTP/UDP">
<link href="#rfc.section.6" rel="Chapter" title="6 Message Format.">
<link href="#rfc.section.7" rel="Chapter" title="7 Security Considerations">
<link href="#rfc.section.8" rel="Chapter" title="8 IANA Considerations">
<link href="#rfc.section.9" rel="Chapter" title="9 Acknowledgments">
<link href="#rfc.references" rel="Chapter" title="10 References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="This document investigates the possibilities for designing a generic transport service that allows Web Browser to exchange generic data in a peer to peer way.  Different transport protocols and their properties are investigated in order to identify the most appropriate one.  " />
  <meta name="description" content="This document investigates the possibilities for designing a generic transport service that allows Web Browser to exchange generic data in a peer to peer way.  Different transport protocols and their properties are investigated in order to identify the most appropriate one.  " />
  <meta name="keywords" content="" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">RTCWeb Working Group</td>
<td class="right">R. Jesup</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Mozilla</td>
</tr>
<tr>
<td class="left">Intended status: Informational</td>
<td class="right">S. Loreto</td>
</tr>
<tr>
<td class="left">Expires: April 27, 2012</td>
<td class="right">Ericsson</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">M. Tuexen</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Muenster University of Applied Sciences</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">October 25, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">RTCWeb Datagram Connection <br />
  <span class="filename">draft-jesup-rtcweb-data-00.txt</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>This document investigates the possibilities for designing a generic transport service that allows Web Browser to exchange generic data in a peer to peer way.  Different transport protocols and their properties are investigated in order to identify the most appropriate one.  </p>
<p></p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on April 27, 2012.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>2.   <a href="#rfc.section.2">Requirements</a>
</li>
<li>3.   <a href="#rfc.section.3">Use cases.</a>
</li>
<li>3.1.   <a href="#rfc.section.3.1">Use cases for unreliable datagram based channel</a>
</li>
<li>3.2.   <a href="#rfc.section.3.2">Use cases for reliable channels (datagram or stream).</a>
</li>
<li>4.   <a href="#rfc.section.4">Protocol alternatives</a>
</li>
<li>4.1.   <a href="#rfc.section.4.1">Datagrams over DTLS over DCCP over UDP.</a>
</li>
<li>4.2.   <a href="#rfc.section.4.2">Datagrams over SCTP over DTLS over UDP.</a>
</li>
<li>4.3.   <a href="#rfc.section.4.3">A new protocol on top of UDP.</a>
</li>
<li>4.4.   <a href="#rfc.section.4.4">A RTP compatible protocol.</a>
</li>
<li>5.   <a href="#rfc.section.5">Datagrams over SCTP over DTLS over UDP.</a>
</li>
<li>5.1.   <a href="#rfc.section.5.1">User Space vs Kernel implementation.</a>
</li>
<li>5.2.   <a href="#rfc.section.5.2">The envisioned usage of SCTP in the RTCWeb context</a>
</li>
<li>5.3.   <a href="#rfc.section.5.3">SCTP/DTLS/UDP vs DTLS/SCTP/UDP</a>
</li>
<li>6.   <a href="#rfc.section.6">Message Format.</a>
</li>
<li>7.   <a href="#rfc.section.7">Security Considerations</a>
</li>
<li>8.   <a href="#rfc.section.8">IANA Considerations</a>
</li>
<li>9.   <a href="#rfc.section.9">Acknowledgments</a>
</li>
<li>10.   <a href="#rfc.references">References</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> Introduction</h1>
<p id="rfc.section.1.p.1">The issue of how best to handle non-media data types in the context of RTCWEB is still under discussion in the mailing list; there have been several proposal on how to address this problem, but there is not yet a clear consensus on the actual solution.</p>
<p id="rfc.section.1.p.2">However it seems to be a general agreement that for NAT traversal purpose it has to be:</p>
<p id="rfc.section.1.p.3">FOO/UDP/IP</p>
<p id="rfc.section.1.p.4">or most likely:</p>
<p id="rfc.section.1.p.5">FOO/DTLS/UDP/IP (for confidentiality, source authenticated, integrity protected transfers)</p>
<p id="rfc.section.1.p.6">where FOO is a protocol that is supposed to provide congestion control and possible some type of framing or stream concept.</p>
<p id="rfc.section.1.p.7">Moreover there has been a clear interest for both an unreliable and a reliable peer to peer datagram based channel.</p>
<p id="rfc.section.1.p.8">This document provides Requirement and use cases for both unreliable and reliable peer to peer datagram base channel, provide an overview of the pro and cons of the different proposed solutions, and finally analyze in more detail the SCTP based solution.</p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> Requirements</h1>
<p id="rfc.section.2.p.1">This section lists the requirements for P2P data connections between two browsers.  </p>
<p></p>

<dl>
<dt>Req. 1</dt>
<dd style="margin-left: 8">Multiple simultaneous datagram streams must be supported.  Note that there may 0 or more media streams in parallel with the data streams, and the number and state (active/inactive) of the media streams may change at any time.</dd>
<dt></dt>
<dd style="margin-left: 8"></dd>
<dt>Req. 2</dt>
<dd style="margin-left: 8">Both reliable and unreliable datagram streams must be supported.</dd>
<dt></dt>
<dd style="margin-left: 8"></dd>
<dt>Req. 3</dt>
<dd style="margin-left: 8">Data streams must be congestion controlled; either individually, as a class, or in conjunction with the media streams, to ensure that datagram exchanges don't cause congestion problems for the media streams, and that the rtcweb PeerConnection as a whole is fair with competing streams such as TCP.</dd>
<dt></dt>
<dd style="margin-left: 8"></dd>
<dt>Req. 4</dt>
<dd style="margin-left: 8">The application should be able to provide guidance as to the relative priority of each datagram stream relative to each other, and relative to the media streams. [ TBD: how this is encoded and what the impact of this is. ]  This will interact with the congestion control.</dd>
<dt></dt>
<dd style="margin-left: 8"></dd>
<dt>Req. 5</dt>
<dd style="margin-left: 8">Datagram streams must be encrypted; allowing for confidentiality, integrity and source authentication. See the security spec [xxx] for detailed info.</dd>
<dt></dt>
<dd style="margin-left: 8"></dd>
<dt>Req. 6</dt>
<dd style="margin-left: 8">Consent and NAT traversal mechanism:  These are handled by the PeerConnection's ICE <a href="#RFC5245">[RFC5245]</a> connectivity checks and optional TURN servers.</dd>
<dt></dt>
<dd style="margin-left: 8"></dd>
</dl>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#sec-use-cases" id="sec-use-cases">Use cases.</a>
</h1>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> <a href="#sec-use-cases-unreliable" id="sec-use-cases-unreliable">Use cases for unreliable datagram based channel</a>
</h1>
<p></p>

<dl>
<dt>U-C 1</dt>
<dd style="margin-left: 8">A real-time game where position and object state information is sent via one or more unreliable data channels.  Note that at any time there may be no media channels, or all media channels may be inactive.</dd>
<dt></dt>
<dd style="margin-left: 8"></dd>
<dt>U-C 2</dt>
<dd style="margin-left: 8">Non-critical state updates about a user in a video chat or conference, such as Mute state.</dd>
<dt></dt>
<dd style="margin-left: 8"></dd>
</dl>
<h1 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> <a href="#sec-use-cases-reliable" id="sec-use-cases-reliable">Use cases for reliable channels (datagram or stream).</a>
</h1>
<p id="rfc.section.3.2.p.1">Note that either reliable datagrams or streams are possible; reliable streams would be fairly simple to layer on top of SCTP reliable datagrams with in-order delivery.</p>
<p></p>
<p></p>

<dl>
<dt>U-C 3</dt>
<dd style="margin-left: 8">A real-time game where critical state information needs to be transferred, such as control information.  Typically this would be datagrams.</dd>
<dt></dt>
<dd style="margin-left: 8"></dd>
<dt>U-C 4</dt>
<dd style="margin-left: 8">Non-realtime file transfers between people chatting.  This could be datagrams or streaming; streaming might be an easier fit</dd>
<dt></dt>
<dd style="margin-left: 8"></dd>
<dt>U-C 5</dt>
<dd style="margin-left: 8">Realtime text chat while talking with multiple people in a conference.  Typically this would be datagrams.</dd>
<dt></dt>
<dd style="margin-left: 8"></dd>
<dt>U-C 6</dt>
<dd style="margin-left: 8">Renegotiation of the set of media streams in the PeerConnection.  Typically this would be datagrams</dd>
<dt></dt>
<dd style="margin-left: 8"></dd>
</dl>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#sec-p-a" id="sec-p-a">Protocol alternatives</a>
</h1>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> <a href="#sec-p-a-1" id="sec-p-a-1">Datagrams over DTLS over DCCP over UDP.</a>
</h1>
<div id="#rfc.figure.1"></div>
<div id="#fig-1"></div>
<pre>
    
                 +------+
                 |WEBAPP|
                 +------+
                 | DTLS |
          +-------------+
          | STUN | DCCP |
          +-------------+
          |    UDP      |
          +-------------+              
    
        </pre>
<p id="rfc.section.4.1.p.1">DCCP <a href="#RFC4340">[RFC4340]</a> adds to a UDP-like foundation the minimum mechanisms necessary to support congestion control.  It is a unicast, connection-oriented protocol with bidirectional data flow.</p>
<p id="rfc.section.4.1.p.2">The main downside of DCCP is the uncertainty of the DCCP implementations. Moreover DCCP only meets the requirements for the unreliable data channel, so in order to satisfy the reliable data channel requirements there is a need to build a new mechanism on top of DCCP or use a different protocol for it.</p>
<p id="rfc.section.4.1.p.3">The main advantage of DCCP is that the Congestion Control (CC) methods are modularly separated from its core, that allows each application to choose a method it prefers.</p>
<h1 id="rfc.section.4.2">
<a href="#rfc.section.4.2">4.2.</a> <a href="#sec-p-a-2" id="sec-p-a-2">Datagrams over SCTP over DTLS over UDP.</a>
</h1>
<div id="#rfc.figure.2"></div>
<div id="#fig-2"></div>
<pre>
    
                 +------+
                 |WEBAPP|
                 +------+
                 | SCTP |
          +-------------+
          | STUN | DTLS |
          +-------------+
          |    UDP      |
          +-------------+              
    
        </pre>
<p id="rfc.section.4.2.p.1">An SCTP <a href="#RFC4960">[RFC4960]</a> based solution will provide several interesting features among the others: Multistreaming, Ordered and Unordered delivery, Reliability and partial-Reliability <a href="#RFC3758">[RFC3758]</a>, and Dynamic Address Reconfiguration <a href="#RFC5061">[RFC5061]</a>. The SCTP feature so seems to satisfy all the requirements for both the unreliable and the reliable scenario.</p>
<p id="rfc.section.4.2.p.2">TBD: any downside for SCTP??? </p>
<p id="rfc.section.4.2.p.3">There are SCTP implementations for all the different OS: Linux (mainline kernel 2.6.36), FreeBSD (release kernel 8.2), Mac OS X, Windows (SctpDrv4) and Solaris (OpenSolaris 2009.06), as well as a user-land SCTP implementation based on the FreeBSD implementation).</p>
<p id="rfc.section.4.2.p.4">The SCTP solution is analyzed in more detail in <a href="#sec-sctp">Section 5</a>.</p>
<h1 id="rfc.section.4.3">
<a href="#rfc.section.4.3">4.3.</a> <a href="#sec-p-a-3" id="sec-p-a-3">A new protocol on top of UDP.</a>
</h1>
<p id="rfc.section.4.3.p.1">This option requires to at least build a congestion control (CC) mechanism on top of the plain UDP.</p>
<p id="rfc.section.4.3.p.2">In designing it we have to follow carefully the guidelines provided in <a href="#RFC5405">[RFC5405]</a>.</p>
<div id="#rfc.figure.3"></div>
<div id="#fig-3"></div>
<pre>
    
                 +------+
                 |WEBAPP|
                 +------+
                 |  CC  |
          +-------------+
          | STUN | DTLS |
          +-------------+
          |    UDP      |
          +-------------+              
    
        </pre>
<p id="rfc.section.4.3.p.3">TBD: describe here the proposal to implement in the userspace TCP/DTLS/UDP for reliable data channels, and UDP-with-TFRC/DTLS/UDP for unreliable data channels (e.g.  libjingle).</p>
<h1 id="rfc.section.4.4">
<a href="#rfc.section.4.4">4.4.</a> <a href="#sec-p-a-4" id="sec-p-a-4">A RTP compatible protocol.</a>
</h1>
<p id="rfc.section.4.4.p.1">TBD </p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#sec-sctp" id="sec-sctp">Datagrams over SCTP over DTLS over UDP.</a>
</h1>
<h1 id="rfc.section.5.1">
<a href="#rfc.section.5.1">5.1.</a> <a href="#sec-sctp-1" id="sec-sctp-1">User Space vs Kernel implementation.</a>
</h1>
<p id="rfc.section.5.1.p.1">Even kernel implementation of SCTP are already available for all the different platforms (see <a href="#sec-p-a-2">Section 4.2</a> ), there are compelling reasons that incline towards for a SCTP stack that works well in user land.</p>
<p id="rfc.section.5.1.p.2">The main reason is deployability.</p>
<p id="rfc.section.5.1.p.3">TBD..</p>
<h1 id="rfc.section.5.2">
<a href="#rfc.section.5.2">5.2.</a> <a href="#sec-sctp-2" id="sec-sctp-2">The envisioned usage of SCTP in the RTCWeb context</a>
</h1>
<p id="rfc.section.5.2.p.1">The appealing features of SCTP in the RTCWeb context are:</p>
<p></p>

<dl>
<dt>-</dt>
<dd style="margin-left: 8">the congestion control which is TCP friendly.</dd>
<dt>-</dt>
<dd style="margin-left: 8">the congestion control is modifiable for integration with media stream congestion control.</dd>
<dt>-</dt>
<dd style="margin-left: 8">support for multiple channels with different characteristics.</dd>
<dt>-</dt>
<dd style="margin-left: 8">support for out-of-order delivery.</dd>
<dt>-</dt>
<dd style="margin-left: 8">support for large datagrams and PMTU-discovery and fragmentation.</dd>
<dt>-</dt>
<dd style="margin-left: 8">the reliable or partial reliability support.</dd>
</dl>
<p id="rfc.section.5.2.p.3">Multi streaming is probably also of interest.</p>
<p id="rfc.section.5.2.p.4">Multihoming will not be used in this scenario. The SCTP layer would simply act as if it were running on a single-homed host, since that is the abstraction that the lower layers (e.g. UDP) would expose.</p>
<h1 id="rfc.section.5.3">
<a href="#rfc.section.5.3">5.3.</a> <a href="#sec-sctp-3" id="sec-sctp-3">SCTP/DTLS/UDP vs DTLS/SCTP/UDP</a>
</h1>
<p id="rfc.section.5.3.p.1">The two alternatives being discussed in this subsection are shown in the following <a href="#fig-sctp-layering">Figure 4</a>.</p>
<div id="#rfc.figure.4"></div>
<div id="#fig-sctp-layering"></div>
<pre>
                    +------+                    +------+
                    |WEBAPP|                    |WEBAPP|
                    +------+                    +------+
                    | DTLS |                    | SCTP |
             +-------------+             +-------------+
             | STUN | SCTP |             | STUN | DTLS |
             +-------------+             +-------------+
             |    UDP      |             |    UDP      |
             +-------------+             +-------------+
</pre>
<p id="rfc.section.5.3.p.2">The UDP encapsulation of SCTP used in the protocol stack shown on the left hand side of <a href="#fig-sctp-layering">Figure 4</a> is specified in <a href="#I-D.ietf-tsvwg-sctp-udp-encaps">[I-D.ietf-tsvwg-sctp-udp-encaps]</a> and the usage of DTLS over SCTP is specified in <a href="#RFC6083">[RFC6083]</a>.  Using the UDP encapsulation of SCTP allows SCTP implementations to run in user-land without any special privileges, but still allows the support of SCTP kernel implementations.  This also requires no SCTP specific support in middleboxes like firewalls and NATs. However, if multihoming is required, SCTP needs to setup the associations iteratively, which requires support at the SCTP implementations.  If WEBAPP does not use multihoming, the support of the iterative association setup procedure is not required. The SCTP payload is protected by DTLS, which provides confidentiality, integrity and source authentication. SCTP-AUTH as specified in <a href="#RFC4895">[RFC4895]</a> is used to provide integrity of SCTP control information related to the user messages like the SCTP stream identifier. Please note that the SCTP control information (like the SCTP stream identifier) is sent unencrypted.</p>
<p id="rfc.section.5.3.p.3">Considering the protocol stack on the right hand side of <a href="#fig-sctp-layering">Figure 4</a>, the usage of DTLS over UDP is specified in <a href="#I-D.ietf-tls-rfc4347-bis">[I-D.ietf-tls-rfc4347-bis]</a>. Using SCTP on top of DTLS is currently unspecified. Since DTLS is typically implemented in user-land, an SCTP user-land implementation has also to be used. Kernel SCTP implementations can't be used. When using DTLS as the lower layer, only single homed SCTP associations can be used, since DTLS does not expose any any address management to its upper layer. DTLS implementations used for this stack must support controlling fields of the IP layer like the DF-bit in case of IPv4 and the DSCP field. This is required for performing path MTU discovery.  The DTLS implementation must also support sending user messages exceeding the path MTU. When supporting multiple SCTP associations over a single DTLS connection, incoming ICMP or ICMPv6 messages can't be processed by the SCTP layer, since there is no way to identify the corresponding association.  Therefore the number of SCTP associations should be limited to one or ICMP and ICMPv6 messages should be ignored.  In general, the lower layer interface of an SCTP implementation has to be adopted to address the differences between IPv4 or IPv6 (being connection-less) or DTLS (being connection-oriented).  When this stack is used, DTLS protects the complete SCTP packet, so it provides confidentiality, integrity and source authentication of the complete SCTP packet.</p>
<p id="rfc.section.5.3.p.4">It should be noted that both stack alternatives support the usage of multiple SCTP streams. A user message can be sent ordered or unordered and, if the SCTP implementations support <a href="#RFC3758">[RFC3758]</a>, with partial reliability. When using partial reliability, it might make sense to use a policy limiting the number of retransmissions. Limiting the number of retransmissions to zero provides a UDP like service where each user messages is sent exactly once.</p>
<p id="rfc.section.5.3.p.5">SCTP provides congestion control on a per-association base. This means that all SCTP streams within a single SCTP association share the same congestion window. Traffic not being sent over SCTP is not covered by the SCTP congestion control.</p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#sec-mes-format" id="sec-mes-format">Message Format.</a>
</h1>
<p id="rfc.section.6.p.1">TBD if we need also to design a framing or not.</p>
<p id="rfc.section.6.p.2">At time of writing nobody has identified a real need for masking of UDP, and DTLS is a much-preferred solution for encryption/authentication.</p>
<p id="rfc.section.6.p.3">More SCTP already provides sequence number information (e.g. stream sequence numbers).  However there could be a need to support different kind of message (link in WebSocket where there is support to distinguish between Unicode text and binary frames), since for SCTP they are all user message.  In the case there is this need a possibility is to map types to streams.</p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> <a href="#sec-security" id="sec-security">Security Considerations</a>
</h1>
<p id="rfc.section.7.p.1">To be done.  </p>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> <a href="#sec-IANA" id="sec-IANA">IANA Considerations</a>
</h1>
<p id="rfc.section.8.p.1">This document does not require any actions by the IANA.  </p>
<h1 id="rfc.section.9">
<a href="#rfc.section.9">9.</a> Acknowledgments</h1>
<p id="rfc.section.9.p.1">Many thanks for comments, ideas, and text from Cullen Jennings, Eric Rescorla, Randall Stewart and Justin Uberti.</p>
<h1 id="rfc.references">
<a href="#rfc.references">10.</a> References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC3758">[RFC3758]</b></td>
<td class="top">
<a>Stewart, R.</a>, <a>Ramalho, M.</a>, <a>Xie, Q.</a>, <a>Tuexen, M.</a> and <a>P. Conrad</a>, "<a href="http://tools.ietf.org/html/rfc3758">Stream Control Transmission Protocol (SCTP) Partial Reliability Extension</a>", RFC 3758, May 2004.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4340">[RFC4340]</b></td>
<td class="top">
<a>Kohler, E.</a>, <a>Handley, M.</a> and <a>S. Floyd</a>, "<a href="http://tools.ietf.org/html/rfc4340">Datagram Congestion Control Protocol (DCCP)</a>", RFC 4340, March 2006.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4895">[RFC4895]</b></td>
<td class="top">
<a>Tuexen, M.</a>, <a>Stewart, R.</a>, <a>Lei, P.</a> and <a>E. Rescorla</a>, "<a href="http://tools.ietf.org/html/rfc4895">Authenticated Chunks for the Stream Control Transmission Protocol (SCTP)</a>", RFC 4895, August 2007.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4960">[RFC4960]</b></td>
<td class="top">
<a>Stewart, R.</a>, "<a href="http://tools.ietf.org/html/rfc4960">Stream Control Transmission Protocol</a>", RFC 4960, September 2007.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5061">[RFC5061]</b></td>
<td class="top">
<a>Stewart, R.</a>, <a>Xie, Q.</a>, <a>Tuexen, M.</a>, <a>Maruyama, S.</a> and <a>M. Kozuka</a>, "<a href="http://tools.ietf.org/html/rfc5061">Stream Control Transmission Protocol (SCTP) Dynamic Address Reconfiguration</a>", RFC 5061, September 2007.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5245">[RFC5245]</b></td>
<td class="top">
<a>Rosenberg, J.</a>, "<a href="http://tools.ietf.org/html/rfc5245">Interactive Connectivity Establishment (ICE): A Protocol for Network Address Translator (NAT) Traversal for Offer/Answer Protocols</a>", RFC 5245, April 2010.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5389">[RFC5389]</b></td>
<td class="top">
<a>Rosenberg, J.</a>, <a>Mahy, R.</a>, <a>Matthews, P.</a> and <a>D. Wing</a>, "<a href="http://tools.ietf.org/html/rfc5389">Session Traversal Utilities for NAT (STUN)</a>", RFC 5389, October 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5405">[RFC5405]</b></td>
<td class="top">
<a>Eggert, L.</a> and <a>G. Fairhurst</a>, "<a href="http://tools.ietf.org/html/rfc5405">Unicast UDP Usage Guidelines for Application Designers</a>", BCP 145, RFC 5405, November 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6083">[RFC6083]</b></td>
<td class="top">
<a>Tuexen, M.</a>, <a>Seggelmann, R.</a> and <a>E. Rescorla</a>, "<a href="http://tools.ietf.org/html/rfc6083">Datagram Transport Layer Security (DTLS) for Stream Control Transmission Protocol (SCTP)</a>", RFC 6083, January 2011.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-tls-rfc4347-bis">[I-D.ietf-tls-rfc4347-bis]</b></td>
<td class="top">
<a>Rescorla, E</a> and <a>N Modadugu</a>, "<a href="http://tools.ietf.org/html/draft-ietf-tls-rfc4347-bis-06">Datagram Transport Layer Security version 1.2</a>", Internet-Draft draft-ietf-tls-rfc4347-bis-06, July 2011.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-tsvwg-sctp-udp-encaps">[I-D.ietf-tsvwg-sctp-udp-encaps]</b></td>
<td class="top">
<a>Tuexen, M</a> and <a>R Stewart</a>, "<a href="http://tools.ietf.org/html/draft-ietf-tsvwg-sctp-udp-encaps-01">UDP Encapsulation of SCTP Packets</a>", Internet-Draft draft-ietf-tsvwg-sctp-udp-encaps-01, October 2011.</td>
</tr>
</tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Randell Jesup</span> 
	  <span class="n hidden">
		<span class="family-name">Jesup</span>
	  </span>
	</span>
	<span class="org vcardline">Mozilla</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:randell-ietf@jesup.org">randell-ietf@jesup.org</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Salvatore Loreto</span> 
	  <span class="n hidden">
		<span class="family-name">Loreto</span>
	  </span>
	</span>
	<span class="org vcardline">Ericsson</span>
	<span class="adr">
	  <span>Hirsalantie 11</span>

	  <span class="vcardline">
		<span class="locality">Jorvas</span>,  
		<span class="region"></span>
		<span class="code">02420</span>
	  </span>
	  <span class="country-name vcardline">Finland</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:salvatore.loreto@ericsson.com">salvatore.loreto@ericsson.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Michael Tuexen</span> 
	  <span class="n hidden">
		<span class="family-name">Tuexen</span>
	  </span>
	</span>
	<span class="org vcardline">Muenster University of Applied Sciences</span>
	<span class="adr">
	  <span>Stegerwaldstrasse 39</span>

	  <span class="vcardline">
		<span class="locality">Steinfurt</span>,  
		<span class="region"></span>
		<span class="code">48565</span>
	  </span>
	  <span class="country-name vcardline">Germany</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:tuexen@fh-muenster.de">tuexen@fh-muenster.de</a></span>

  </address>
</div>

</body>
</html>