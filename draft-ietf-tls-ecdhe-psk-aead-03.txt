



Network Working Group                                        J. Mattsson
Internet-Draft                                                D. Migault
Intended status: Standards Track                                Ericsson
Expires: November 4, 2017                                    May 3, 2017


  ECDHE_PSK with AES-GCM and AES-CCM Cipher Suites for Transport Layer
                             Security (TLS)
                    draft-ietf-tls-ecdhe-psk-aead-03

Abstract

   This document defines several new cipher suites for the Transport
   Layer Security (TLS) protocol.  The cipher suites are all based on
   the Ephemeral Elliptic Curve Diffie-Hellman with Pre-Shared Key
   (ECDHE_PSK) key exchange together with the Authenticated Encryption
   with Associated Data (AEAD) algorithms AES-GCM and AES-CCM.  PSK
   provides light and efficient authentication, ECDHE provides perfect
   forward secrecy, and AES-GCM and AES-CCM provides encryption and
   integrity protection.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at http://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on November 4, 2017.

Copyright Notice

   Copyright (c) 2017 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (http://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect



Mattsson & Migault      Expires November 4, 2017                [Page 1]

Internet-Draft               ECDHE_PSK_AEAD                     May 2017


   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   1.  Requirements notation . . . . . . . . . . . . . . . . . . . .   2
   2.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
   3.  ECDHE_PSK with AES-GCM and AES-CCM Cipher Suites  . . . . . .   3
   4.  Applicable TLS Versions . . . . . . . . . . . . . . . . . . .   3
   5.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .   4
   6.  Security Considerations . . . . . . . . . . . . . . . . . . .   4
   7.  Acknowledgements  . . . . . . . . . . . . . . . . . . . . . .   5
   8.  References  . . . . . . . . . . . . . . . . . . . . . . . . .   5
     8.1.  Normative References  . . . . . . . . . . . . . . . . . .   5
     8.2.  Informative References  . . . . . . . . . . . . . . . . .   6
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .   6

1.  Requirements notation

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [RFC2119].

2.  Introduction

   This document defines new cipher suites that provide Pre-Shared Key
   (PSK) authentication, Perfect Forward Secrecy (PFS), and
   Authenticated Encryption with Associated Data (AEAD).  The cipher
   suites are defined for version 1.2 of the Transport Layer Security
   (TLS) [RFC5246] protocol, version 1.2 of the Datagram Transport Layer
   Security (DTLS) protocol [RFC6347], as well as version 1.3 of TLS
   [I-D.ietf-tls-tls13].

   Pre-Shared Key (PSK) Authentication is widely used in many scenarios.
   One deployment is 3GPP networks where pre-shared keys are used to
   authenticate both subscriber and network.  Another deployment is
   Internet of Things where PSK authentication is often preferred for
   performance and energy efficiency reasons.  In both scenarios the
   endpoints are owned/controlled by a party that provisions the pre-
   shared keys and makes sure that they provide a high level of entropy.

   Perfect Forward Secrecy (PFS) is a strongly recommended feature in
   security protocol design and can be accomplished by using an
   ephemeral Diffie-Hellman key exchange method.  Ephemeral Elliptic
   Curve Diffie-Hellman (ECDHE) provides PFS with excellent performance




Mattsson & Migault      Expires November 4, 2017                [Page 2]

Internet-Draft               ECDHE_PSK_AEAD                     May 2017


   and small key sizes.  ECDHE is mandatory to implement in both HTTP/2
   [RFC7540] and CoAP [RFC7252].

   AEAD algorithms that combine encryption and integrity protection are
   strongly recommended [RFC7525] and non-AEAD algorithms are forbidden
   to use in TLS 1.3 [I-D.ietf-tls-tls13].  The AEAD algorithms
   considered in this document are AES-GCM and AES-CCM.  The use of AES-
   GCM in TLS is defined in [RFC5288] and the use of AES-CCM is defined
   in [RFC6655].

   [RFC4279] defines Pre-Shared Key (PSK) cipher suites for TLS but does
   not consider Elliptic Curve Cryptography.  [RFC4492] introduces
   Elliptic Curve Cryptography for TLS but does not consider PSK
   authentication.  [RFC5487] describes the use of AES-GCM in
   combination with PSK authentication, but does not consider ECDHE.
   [RFC5489] describes the use of PSK in combination with ECDHE but does
   not consider AES-GCM or AES-CCM.

3.  ECDHE_PSK with AES-GCM and AES-CCM Cipher Suites

   The cipher suites defined in this document are based on the AES-GCM
   and AES-CCM Authenticated Encryption with Associated Data (AEAD)
   algorithms AEAD_AES_128_GCM, AEAD_AES_256_GCM and AEAD_AES_128_CCM
   defined in [RFC5116], and AEAD_AES_128_CCM_8 defined in [RFC6655].

   Messages and pre-master secret construction in this document are
   based on [RFC4279].  The elliptic curve parameters used in in the
   Diffie-Hellman parameters are negotiated using extensions defined in
   [I-D.ietf-tls-rfc4492bis].

   For TLS1.2, the following cipher suites are defined:

   TLS_ECDHE_PSK_WITH_AES_128_GCM_SHA256   = {0xTBD,0xTBD};
   TLS_ECDHE_PSK_WITH_AES_256_GCM_SHA384   = {0xTBD,0xTBD};
   TLS_ECDHE_PSK_WITH_AES_128_CCM_8_SHA256 = {0xTBD,0xTBD};
   TLS_ECDHE_PSK_WITH_AES_128_CCM_SHA256   = {0xTBD,0xTBD};

   The assigned code points can only be used for TLS 1.2.

4.  Applicable TLS Versions

   The cipher suites defined in this document make use of the
   authenticated encryption with additional data (AEAD) defined in TLS
   1.2 [RFC5246] and DTLS 1.2 [RFC6347].  Earlier versions of TLS do not
   have support for AEAD and consequently, these cipher suites MUST NOT
   be negotiated in TLS versions prior to 1.2.  Clients MUST NOT offer
   these cipher suites if they do not offer TLS 1.2 or later.  Servers,
   which select an earlier version of TLS MUST NOT select one of these



Mattsson & Migault      Expires November 4, 2017                [Page 3]

Internet-Draft               ECDHE_PSK_AEAD                     May 2017


   cipher suites.  A client MUST treat the selection of these cipher
   suites in combination with a version of TLS that does not support
   AEAD (i.e., TLS 1.1 or earlier) as an error and generate a fatal
   'illegal_parameter' TLS alert.

   TLS 1.3 and above version, negotiate and support these cipher suites
   in a different way.

5.  IANA Considerations

   This document defines the following new cipher suites, whose values
   have been assigned in the TLS Cipher Suite Registry defined by
   [RFC5246].

   TLS_ECDHE_PSK_WITH_AES_128_GCM_SHA256   = {0xTBD; 0xTBD} {0xD0,0x01};
   TLS_ECDHE_PSK_WITH_AES_256_GCM_SHA384   = {0xTBD; 0xTBD} {0xD0,0x02};
   TLS_ECDHE_PSK_WITH_AES_128_CCM_8_SHA256 = {0xTBD; 0xTBD} {0xD0,0x03};
   TLS_ECDHE_PSK_WITH_AES_128_CCM_SHA256   = {0xTBD; 0xTBD} {0xD0,0x05};

   The cipher suite numbers listed in the last column are numbers used
   for cipher suite interoperability testing and it's suggested that
   IANA use these values for assignment.

6.  Security Considerations

   The security considerations in TLS 1.2 [RFC5246], DTLS 1.2 [RFC6347],
   TLS 1.3 [I-D.ietf-tls-tls13], ECDHE_PSK [RFC5489], AES-GCM [RFC5288],
   and AES-CCM [RFC6655] apply to this document as well.

   All the cipher suites defined in this document provide
   confidentiality, mutual authentication, and perfect forward secrecy.
   The AES-128 cipher suites provide 128-bit security and the AES-256
   cipher suites provide at least 192-bit security.  However,
   AES_128_CCM_8 only provides 64-bit security against message forgery.

   Use of Pre-Shared Keys of limited entropy may allow an active
   attacker attempts to connect to the server and try different keys.
   For example, limited entropy may be provided by using short PSK in
   which case an attacker may perform a brute-force attack.  Another
   example includes the use of a PSK chosen by a human and thus may be
   exposed to dictionary attacks.

   The Pre-Shared Keys used for authentication MUST have a security
   level equal or higher than the cipher suite used, i.e. at least
   128-bit for the AES-128 cipher suites and at least 192-bit for the
   AES-256 cipher suites.





Mattsson & Migault      Expires November 4, 2017                [Page 4]

Internet-Draft               ECDHE_PSK_AEAD                     May 2017


7.  Acknowledgements

   The authors would like to thank Ilari Liusvaara, Eric Rescorla, Dan
   Harkins, Russ Housley, Dan Harkins, Martin Thomson, Nikos
   Mavrogiannopoulos, Peter Dettman, Xiaoyin Liu, Joseph Salowey, Sean
   Turner and Kathleen Moriarty for their valuable comments and
   feedback.

8.  References

8.1.  Normative References

   [I-D.ietf-tls-rfc4492bis]
              Nir, Y., Josefsson, S., and M. Pegourie-Gonnard, "Elliptic
              Curve Cryptography (ECC) Cipher Suites for Transport Layer
              Security (TLS) Versions 1.2 and Earlier", draft-ietf-tls-
              rfc4492bis-16 (work in progress), March 2017.

   [I-D.ietf-tls-tls13]
              Rescorla, E., "The Transport Layer Security (TLS) Protocol
              Version 1.3", draft-ietf-tls-tls13-20 (work in progress),
              April 2017.

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <http://www.rfc-editor.org/info/rfc2119>.

   [RFC4279]  Eronen, P., Ed. and H. Tschofenig, Ed., "Pre-Shared Key
              Ciphersuites for Transport Layer Security (TLS)",
              RFC 4279, DOI 10.17487/RFC4279, December 2005,
              <http://www.rfc-editor.org/info/rfc4279>.

   [RFC5116]  McGrew, D., "An Interface and Algorithms for Authenticated
              Encryption", RFC 5116, DOI 10.17487/RFC5116, January 2008,
              <http://www.rfc-editor.org/info/rfc5116>.

   [RFC5246]  Dierks, T. and E. Rescorla, "The Transport Layer Security
              (TLS) Protocol Version 1.2", RFC 5246,
              DOI 10.17487/RFC5246, August 2008,
              <http://www.rfc-editor.org/info/rfc5246>.

   [RFC5288]  Salowey, J., Choudhury, A., and D. McGrew, "AES Galois
              Counter Mode (GCM) Cipher Suites for TLS", RFC 5288,
              DOI 10.17487/RFC5288, August 2008,
              <http://www.rfc-editor.org/info/rfc5288>.





Mattsson & Migault      Expires November 4, 2017                [Page 5]

Internet-Draft               ECDHE_PSK_AEAD                     May 2017


   [RFC6347]  Rescorla, E. and N. Modadugu, "Datagram Transport Layer
              Security Version 1.2", RFC 6347, DOI 10.17487/RFC6347,
              January 2012, <http://www.rfc-editor.org/info/rfc6347>.

   [RFC6655]  McGrew, D. and D. Bailey, "AES-CCM Cipher Suites for
              Transport Layer Security (TLS)", RFC 6655,
              DOI 10.17487/RFC6655, July 2012,
              <http://www.rfc-editor.org/info/rfc6655>.

8.2.  Informative References

   [RFC4492]  Blake-Wilson, S., Bolyard, N., Gupta, V., Hawk, C., and B.
              Moeller, "Elliptic Curve Cryptography (ECC) Cipher Suites
              for Transport Layer Security (TLS)", RFC 4492,
              DOI 10.17487/RFC4492, May 2006,
              <http://www.rfc-editor.org/info/rfc4492>.

   [RFC5487]  Badra, M., "Pre-Shared Key Cipher Suites for TLS with SHA-
              256/384 and AES Galois Counter Mode", RFC 5487,
              DOI 10.17487/RFC5487, March 2009,
              <http://www.rfc-editor.org/info/rfc5487>.

   [RFC5489]  Badra, M. and I. Hajjeh, "ECDHE_PSK Cipher Suites for
              Transport Layer Security (TLS)", RFC 5489,
              DOI 10.17487/RFC5489, March 2009,
              <http://www.rfc-editor.org/info/rfc5489>.

   [RFC7252]  Shelby, Z., Hartke, K., and C. Bormann, "The Constrained
              Application Protocol (CoAP)", RFC 7252,
              DOI 10.17487/RFC7252, June 2014,
              <http://www.rfc-editor.org/info/rfc7252>.

   [RFC7525]  Sheffer, Y., Holz, R., and P. Saint-Andre,
              "Recommendations for Secure Use of Transport Layer
              Security (TLS) and Datagram Transport Layer Security
              (DTLS)", BCP 195, RFC 7525, DOI 10.17487/RFC7525, May
              2015, <http://www.rfc-editor.org/info/rfc7525>.

   [RFC7540]  Belshe, M., Peon, R., and M. Thomson, Ed., "Hypertext
              Transfer Protocol Version 2 (HTTP/2)", RFC 7540,
              DOI 10.17487/RFC7540, May 2015,
              <http://www.rfc-editor.org/info/rfc7540>.

Authors' Addresses







Mattsson & Migault      Expires November 4, 2017                [Page 6]

Internet-Draft               ECDHE_PSK_AEAD                     May 2017


   John Mattsson
   Ericsson AB
   SE-164 80 Stockholm
   Sweden

   Phone: +46 76 115 35 01
   Email: john.mattsson@ericsson.com


   Daniel Migault
   Ericsson
   8400 boulevard Decarie
   Montreal, QC   H4P 2N2
   Canada

   Phone: +1 514-452-2160
   Email: daniel.migault@ericsson.com


































Mattsson & Migault      Expires November 4, 2017                [Page 7]
