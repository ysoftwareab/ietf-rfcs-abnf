<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>IPv6-only and Dual Stack Hosts on the Same Network with DNS64</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.2" rel="Chapter" title="2 Terminology">
<link href="#rfc.section.3" rel="Chapter" title="3 Mechanism">
<link href="#rfc.section.4" rel="Chapter" title="4 Security Considerations">
<link href="#rfc.section.5" rel="Chapter" title="5 Acknowledgements">
<link href="#rfc.section.6" rel="Chapter" title="6 IANA Considerations">
<link href="#rfc.references" rel="Chapter" title="7 References">
<link href="#rfc.references.1" rel="Chapter" title="7.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="7.2 Informative References">
<link href="#rfc.appendix.Appendix%20A" rel="Chapter" title="Appendix A Other Techniques">
<link href="#rfc.appendix.Appendix%20A.1" rel="Chapter" title="Appendix A.1 New DHCP option for 'normal' DNS server">
<link href="#rfc.appendix.Appendix%20A.1.1" rel="Chapter" title="Appendix A.1.1 Host Transition">
<link href="#rfc.appendix.Appendix%20A.1.2" rel="Chapter" title="Appendix A.1.2 Advantages and Disadvantages">
<link href="#rfc.appendix.Appendix%20A.2" rel="Chapter" title="Appendix A.2 Modify Host's Address Selection Rules">
<link href="#rfc.appendix.Appendix%20A.2.1" rel="Chapter" title="Appendix A.2.1 Host Transition">
<link href="#rfc.appendix.Appendix%20A.2.2" rel="Chapter" title="Appendix A.2.2 Limitations and Advantages">
<link href="#rfc.appendix.Appendix%20A.2.3" rel="Chapter" title="Appendix A.2.3 Examples">
<link href="#rfc.appendix.Appendix%20A.3" rel="Chapter" title="Appendix A.3 Indicating AAAA synthesis using DNS response flag">
<link href="#rfc.appendix.Appendix%20A.4" rel="Chapter" title="Appendix A.4 New A64 record">
<link href="#rfc.appendix.Appendix%20A.5" rel="Chapter" title="Appendix A.5 Use DHCP to Assign Appropriate DNS Server">
<link href="#rfc.appendix.Appendix%20A.5.1" rel="Chapter" title="Appendix A.5.1 Host Requirements">
<link href="#rfc.appendix.Appendix%20A.5.2" rel="Chapter" title="Appendix A.5.2 DHCPv4 and DHCPv6 Server Requirements">
<link href="#rfc.appendix.Appendix%20A.5.3" rel="Chapter" title="Appendix A.5.3 DHCP Server Operation">
<link href="#rfc.appendix.Appendix%20A.5.4" rel="Chapter" title="Appendix A.5.4 Host Transition">
<link href="#rfc.appendix.Appendix%20A.5.5" rel="Chapter" title="Appendix A.5.5 Advantages and Disadvantages">
<link href="#rfc.appendix.Appendix%20A.6" rel="Chapter" title="Appendix A.6 New DHCP option for DNS64 server">
<link href="#rfc.appendix.Appendix%20A.6.1" rel="Chapter" title="Appendix A.6.1 Advantages and Disadvantages">
<link href="#rfc.appendix.Appendix%20A.7" rel="Chapter" title="Appendix A.7 New DHCP option to identify dual-stack host">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="Some networks are expected to support IPv4-only, dual-stack, and IPv6-only hosts at the same time. Such networks also want to IPv6/IPv4 translation for the IPv6-only host so it can access servers on the IPv4 Internet. On such a network, the synthesized AAAA responses from a DNS64 can cause traffic to be translated. This document describes a solution to avoid that translation when the application uses DNS." />
  <meta name="description" content="Some networks are expected to support IPv4-only, dual-stack, and IPv6-only hosts at the same time. Such networks also want to IPv6/IPv4 translation for the IPv6-only host so it can access servers on the IPv4 Internet. On such a network, the synthesized AAAA responses from a DNS64 can cause traffic to be translated. This document describes a solution to avoid that translation when the application uses DNS." />
  <meta name="keywords" content="" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">BEHAVE Working Group</td>
<td class="right">D. Wing</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Cisco</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">February 15, 2011</td>
</tr>
<tr>
<td class="left">Expires: August 19, 2011</td>
<td class="right"></td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">IPv6-only and Dual Stack Hosts on the Same Network with DNS64<br />
  <span class="filename">draft-wing-behave-dns64-config-03</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>Some networks are expected to support IPv4-only, dual-stack, and IPv6-only hosts at the same time. Such networks also want to IPv6/IPv4 translation for the IPv6-only host so it can access servers on the IPv4 Internet. On such a network, the synthesized AAAA responses from a DNS64 can cause traffic to be translated. This document describes a solution to avoid that translation when the application uses DNS.</p>
<p>The IETF has been notified of intellectual property rights claimed in regard to some or all of the specification contained in this document.  For more information consult the online list of claimed rights.</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on August 19, 2011.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>2.   <a href="#rfc.section.2">Terminology</a>
</li>
<li>3.   <a href="#rfc.section.3">Mechanism</a>
</li>
<li>4.   <a href="#rfc.section.4">Security Considerations</a>
</li>
<li>5.   <a href="#rfc.section.5">Acknowledgements</a>
</li>
<li>6.   <a href="#rfc.section.6">IANA Considerations</a>
</li>
<li>7.   <a href="#rfc.references">References</a>
</li>
<li>7.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>7.2.   <a href="#rfc.references.2">Informative References</a>
</li>
<li>Appendix A.   <a href="#rfc.appendix.Appendix%20A">Other Techniques</a>
</li>
<li>Appendix A.1.   <a href="#rfc.appendix.Appendix%20A.1">New DHCP option for 'normal' DNS server</a>
</li>
<li>Appendix A.1.1.   <a href="#rfc.appendix.Appendix%20A.1.1">Host Transition</a>
</li>
<li>Appendix A.1.2.   <a href="#rfc.appendix.Appendix%20A.1.2">Advantages and Disadvantages</a>
</li>
<li>Appendix A.2.   <a href="#rfc.appendix.Appendix%20A.2">Modify Host's Address Selection Rules</a>
</li>
<li>Appendix A.2.1.   <a href="#rfc.appendix.Appendix%20A.2.1">Host Transition</a>
</li>
<li>Appendix A.2.2.   <a href="#rfc.appendix.Appendix%20A.2.2">Limitations and Advantages</a>
</li>
<li>Appendix A.2.3.   <a href="#rfc.appendix.Appendix%20A.2.3">Examples</a>
</li>
<li>Appendix A.3.   <a href="#rfc.appendix.Appendix%20A.3">Indicating AAAA synthesis using DNS response flag</a>
</li>
<li>Appendix A.4.   <a href="#rfc.appendix.Appendix%20A.4">New A64 record</a>
</li>
<li>Appendix A.5.   <a href="#rfc.appendix.Appendix%20A.5">Use DHCP to Assign Appropriate DNS Server</a>
</li>
<li>Appendix A.5.1.   <a href="#rfc.appendix.Appendix%20A.5.1">Host Requirements</a>
</li>
<li>Appendix A.5.2.   <a href="#rfc.appendix.Appendix%20A.5.2">DHCPv4 and DHCPv6 Server Requirements</a>
</li>
<li>Appendix A.5.3.   <a href="#rfc.appendix.Appendix%20A.5.3">DHCP Server Operation</a>
</li>
<li>Appendix A.5.4.   <a href="#rfc.appendix.Appendix%20A.5.4">Host Transition</a>
</li>
<li>Appendix A.5.5.   <a href="#rfc.appendix.Appendix%20A.5.5">Advantages and Disadvantages</a>
</li>
<li>Appendix A.6.   <a href="#rfc.appendix.Appendix%20A.6">New DHCP option for DNS64 server</a>
</li>
<li>Appendix A.6.1.   <a href="#rfc.appendix.Appendix%20A.6.1">Advantages and Disadvantages</a>
</li>
<li>Appendix A.7.   <a href="#rfc.appendix.Appendix%20A.7">New DHCP option to identify dual-stack host</a>
</li>
<li><a href="#rfc.authors">Author's Address</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> <a href="#introduction" id="introduction">Introduction</a>
</h1>
<p id="rfc.section.1.p.1">In order to access IPv4 servers, an IPv6-only host needs to use an IPv6/IPv4 translator. Typically, the IPv6-only host performs a DNS query to a DNS64 recursive resolver, which synthesizes an AAAA when necessary.  However, if a dual-stack host uses that same DNS64 recursive resolver and normal <a href="#RFC3484">address selection rules</a> <cite title="NONE">[RFC3484]</cite>, the dual-stack host will send traffic through the IPv6/IPv4 translator when such traffic could have been sent using IPv4. Thus, as an optimization, it is desirable that a dual-stack host avoid IPv6/IPv4 translation.</p>
<p id="rfc.section.1.p.2">Note: If the dual-stack host's IPv4 traffic is being NATted the difference is NAT44 versus NAT64, so the performance and saleability concern is nearly identical. However, at least one application breaks when translated between IP address families unless special measures are taken <a href="#I-D.ietf-behave-ftp64">[I-D.ietf-behave-ftp64]</a>. The IETF should decide if it is worthwhile to avoid NAT64 for dual-stack hosts that are connected to a network operating a DNS64.</p>
<p></p>

<ul class="empty"><li>Note: Windows XP can only be configured with IPv4 DNS servers <a href="#XP-DNS">[XP-DNS]</a>. This means a Windows XP host is always dual-stack and requires an IPv4 address in order to send its DNS queries. While it is possible to work around this issue by running BIND on the Windows XP device itself, this is complex. Thus, Windows XP should not be considered a viable operating system to join an IPv6-only network.</li></ul>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> Terminology</h1>
<p id="rfc.section.2.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">[RFC2119]</a>.</p>
<p id="rfc.section.2.p.2">"IPv4-only" means a host that has only IPv4 address(es) assigned to its interface(s). "Dual-stack" means a host that has an IPv4 address and an IPv6 address assigned to its interface(es). "IPv6-only" means a host that has only IPv6 address(es) assigned to its interface(s).</p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> Mechanism</h1>
<p id="rfc.section.3.p.1">It has been observed that some common operating systems, when configured as dual-stack, will successfully use an IPv4-mapped address (and send an IPv4 packet). But when configured as IPv6-only, they will not successfully use an IPv4-mapped address (because they lack an IPv4 address) <a href="#experiment">[experiment]</a>.</p>
<p id="rfc.section.3.p.2">We take advantage of this by configuring the 'normal' DNS server using an IPv4-mapped IPv6 address (that is, an IPv6 address starting with ::ffff:/96), and configuring the DNS64 server using a normal IPv6 address.</p>
<p id="rfc.section.3.p.3">DNS servers are used in the order listed <a href="#RFC3646">[RFC3646]</a>, so a dual-stack host will use the 'normal' DNS server (which is accessible over IPv4) and an IPv6-only host will be unable to use that 'normal' DNS server and will use the next server on its list.</p>

<ul class="empty"><li>Note: Non-compliant IPv6 stacks might send a packet to the IPv4-mapped IPv6 address (::ffff:c000:0201, using the example below). To deal with such non-compliant IPv6 implementations the network can filter (drop) traffic to that IPv6 address, which will force those stacks to timeout when attempting to contact the first DNS server and fall back to using the second DNS server.</li></ul>
<div id="#rfc.figure.1"></div>
<p>For example, a dual-stack host and an IPv6-only host would be configured with the following DNS servers, in this order, where the first one is the normal DNS server (192.0.2.1) and the second one is the DNS64 server (2001:db8:dddd::1234)</p>
<pre>
::ffff:192.0.2.1       # 'normal' DNS server
2001:db8:dddd::1234    # DNS64 server
</pre>
<p></p>
<p id="rfc.section.3.p.4">This technique requires no change to host operating systems or host applications.</p>
<p id="rfc.section.3.p.5">When transitioning from dual-stack to IPv6-only, nothing needs to occur - the higher-priority DNS server (with the IPv4-mapped IPv6 address) will become inaccessible and the DNS client will fail over to the next-higher priority DNS server (which is the DNS64 server). This does mean the host will take a few extra sections to fully initialize, as it will have to timeout its attempts to communicate with the first DNS server.</p>
<p id="rfc.section.3.p.6">When transitioning from IPv6-only to dual-stack, nothing automatically causes the host to start querying the 'normal' DNS server.  Thus, a host that transitions from IPv6-only to dual-stack will continue to query the DNS64 until the host's stack re-initializes.</p>
<p></p>

<ul class="empty"><li>Operating System Note: On Linux systems, this technique is not effective if the sysctl net.ipv6.bindv6only is set, as setting this parameter causes dual-stack systems to not send packets to IPv4-mapped IPv6 addresses.</li></ul>
<p id="rfc.section.3.p.8">If the first DNS server is unavailable (e.g., link failure or DNS server failure) and the host's resolver times out, it will try the second DNS server, which is a DNS64 server. This is unavoidable with this technique. Thus, it is important that a robust infrastructure be used for the DNS servers, especially the first DNS server.</p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#securityconsiderations" id="securityconsiderations">Security Considerations</a>
</h1>
<p id="rfc.section.4.p.1">TBD.</p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> Acknowledgements</h1>
<p id="rfc.section.5.p.1">Thanks to Mohamed Boucadair, Marcelo Braun, Ralph Droms, Dave Thaler, Bernie Volz, and Andrew Yourtchenko for their review comments.</p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#iana" id="iana">IANA Considerations</a>
</h1>
<p id="rfc.section.6.p.1">This document has no actions for IANA.</p>
<h1 id="rfc.references">
<a href="#rfc.references">7.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">7.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3315">[RFC3315]</b></td>
<td class="top">
<a>Droms, R.</a>, <a>Bound, J.</a>, <a>Volz, B.</a>, <a>Lemon, T.</a>, <a>Perkins, C.</a> and <a>M. Carney</a>, "<a href="http://tools.ietf.org/html/rfc3315">Dynamic Host Configuration Protocol for IPv6 (DHCPv6)</a>", RFC 3315, July 2003.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2131">[RFC2131]</b></td>
<td class="top">
<a href="mailto:droms@bucknell.edu" title="Computer Science Department">Droms, R.</a>, "<a href="http://tools.ietf.org/html/rfc2131">Dynamic Host Configuration Protocol</a>", RFC 2131, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4361">[RFC4361]</b></td>
<td class="top">
<a>Lemon, T.</a> and <a>B. Sommerfeld</a>, "<a href="http://tools.ietf.org/html/rfc4361">Node-specific Client Identifiers for Dynamic Host Configuration Protocol Version Four (DHCPv4)</a>", RFC 4361, February 2006.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-behave-dns64">[I-D.ietf-behave-dns64]</b></td>
<td class="top">
<a>Bagnulo, M</a>, <a>Sullivan, A</a>, <a>Matthews, P</a> and <a>I Beijnum</a>, "<a href="http://tools.ietf.org/html/draft-ietf-behave-dns64-11">DNS64: DNS extensions for Network Address Translation from IPv6 Clients to IPv4 Servers</a>", Internet-Draft draft-ietf-behave-dns64-11, October 2010.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4242">[RFC4242]</b></td>
<td class="top">
<a>Venaas, S.</a>, <a>Chown, T.</a> and <a>B. Volz</a>, "<a href="http://tools.ietf.org/html/rfc4242">Information Refresh Time Option for Dynamic Host Configuration Protocol for IPv6 (DHCPv6)</a>", RFC 4242, November 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3646">[RFC3646]</b></td>
<td class="top">
<a>Droms, R.</a>, "<a href="http://tools.ietf.org/html/rfc3646">DNS Configuration options for Dynamic Host Configuration Protocol for IPv6 (DHCPv6)</a>", RFC 3646, December 2003.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3484">[RFC3484]</b></td>
<td class="top">
<a>Draves, R.</a>, "<a href="http://tools.ietf.org/html/rfc3484">Default Address Selection for Internet Protocol version 6 (IPv6)</a>", RFC 3484, February 2003.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">7.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC6052">[RFC6052]</b></td>
<td class="top">
<a>Bao, C.</a>, <a>Huitema, C.</a>, <a>Bagnulo, M.</a>, <a>Boucadair, M.</a> and <a>X. Li</a>, "<a href="http://tools.ietf.org/html/rfc6052">IPv6 Addressing of IPv4/IPv6 Translators</a>", RFC 6052, October 2010.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-behave-ftp64">[I-D.ietf-behave-ftp64]</b></td>
<td class="top">
<a>Beijnum, I</a>, "<a href="http://tools.ietf.org/html/draft-ietf-behave-ftp64-12">An FTP ALG for IPv6-to-IPv4 translation</a>", Internet-Draft draft-ietf-behave-ftp64-12, July 2011.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.wing-behave-learn-prefix">[I-D.wing-behave-learn-prefix]</b></td>
<td class="top">
<a>Wing, D</a>, "<a href="http://tools.ietf.org/html/draft-wing-behave-learn-prefix-04">Learning the IPv6 Prefix of a Network's IPv6/IPv4 Translator</a>", Internet-Draft draft-wing-behave-learn-prefix-04, October 2009.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.savolainen-mif-dns-server-selection">[I-D.savolainen-mif-dns-server-selection]</b></td>
<td class="top">
<a>Savolainen, T</a> and <a>J Kato</a>, "<a href="http://tools.ietf.org/html/draft-savolainen-mif-dns-server-selection-06">Improved DNS Server Selection for Multi-Homed Nodes</a>", Internet-Draft draft-savolainen-mif-dns-server-selection-06, January 2011.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3513">[RFC3513]</b></td>
<td class="top">
<a>Hinden, R.</a> and <a>S. Deering</a>, "<a href="http://tools.ietf.org/html/rfc3513">Internet Protocol Version 6 (IPv6) Addressing Architecture</a>", RFC 3513, April 2003.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.arifumi-6man-rfc3484-revise">[I-D.arifumi-6man-rfc3484-revise]</b></td>
<td class="top">
<a>Matsumoto, A</a>, <a>Fujisaki, T</a> and <a>R Hiromi</a>, "<a href="http://tools.ietf.org/html/draft-arifumi-6man-rfc3484-revise-03">Things To Be Considered for RFC 3484 Revision</a>", Internet-Draft draft-arifumi-6man-rfc3484-revise-03, July 2010.</td>
</tr>
<tr>
<td class="reference"><b id="mif">[mif]</b></td>
<td class="top">
<a>IETF, </a>, "<a>Multiple Interfaces Working Group</a>", 2009.</td>
</tr>
<tr>
<td class="reference"><b id="6man">[6man]</b></td>
<td class="top">
<a>IETF, </a>, "<a>IPv6 Maintenance Working Group</a>", 2009.</td>
</tr>
<tr>
<td class="reference"><b id="XP-DNS">[XP-DNS]</b></td>
<td class="top">
<a>Microsoft, </a>, "<a>Windows XP: IPv6 configuration items</a>", 5 2005.</td>
</tr>
<tr>
<td class="reference"><b id="experiment">[experiment]</b></td>
<td class="top">
<a>Braun, </a>, "<a>practical issues with using v4-mapped addresses for nat64</a>", Jul 2008.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.boucadair-behave-dns-a64">[I-D.boucadair-behave-dns-a64]</b></td>
<td class="top">
<a>Boucadair, M</a> and <a>E Burgey</a>, "<a href="http://tools.ietf.org/html/draft-boucadair-behave-dns-a64-02">A64: DNS Resource Record for IPv4-Embedded IPv6 Address</a>", Internet-Draft draft-boucadair-behave-dns-a64-02, September 2010.</td>
</tr>
</tbody></table>
<h1 id="rfc.appendix.Appendix A">
<a href="#rfc.appendix.Appendix%20A">Appendix A.</a> Other Techniques</h1>
<p></p>

<ul class="empty"><li>[Editor's Note: This section will be removed in a later version of this document. It is kept, in this appendix, for reference.]</li></ul>
<p id="rfc.section.Appendix A.p.2">This section discusses other techniques which had been considered to avoid DNS64/NAT64 by dual-stack hosts.</p>
<h1 id="rfc.appendix.Appendix A.1">
<a href="#rfc.appendix.Appendix%20A.1">Appendix A.1.</a> New DHCP option for 'normal' DNS server</h1>
<p id="rfc.section.Appendix A.1.p.1">Another approach, which requires modification of dual-stack hosts which want to avoid the DNS64, is to introduce a new DHCP option.</p>
<p id="rfc.section.Appendix A.1.p.2">This approach feels a little backwards at first. The idea is to support unmodified hosts (which might be dual-stack but might be IPv6-only) by placing DNS64 servers into the normal <a href="#RFC3646">DHCPv6 option for DNS servers</a> <cite title="NONE">[RFC3646]</cite>. Then, place the 'normal' DNS servers into a *new* DHCPv6 option.</p>
<h1 id="rfc.appendix.Appendix A.1.1">
<a href="#rfc.appendix.Appendix%20A.1.1">Appendix A.1.1.</a> Host Transition</h1>
<p id="rfc.section.Appendix A.1.1.p.1">TBD.</p>
<h1 id="rfc.appendix.Appendix A.1.2">
<a href="#rfc.appendix.Appendix%20A.1.2">Appendix A.1.2.</a> Advantages and Disadvantages</h1>
<p id="rfc.section.Appendix A.1.2.p.1">Disadvantages:</p>

<ul><li>If dual-stack hosts want to avoid NAT64, they need to be modified to understand this new DHCP option. If they aren't modified, they will use NAT64.</li></ul>
<h1 id="rfc.appendix.Appendix A.2">
<a href="#rfc.appendix.Appendix%20A.2">Appendix A.2.</a> Modify Host's Address Selection Rules</h1>
<p id="rfc.section.Appendix A.2.p.1">The <a href="#RFC3484">default address selection rules</a> <cite title="NONE">[RFC3484]</cite> prefer IPv6 over IPv4. This means, for a dual-stack host, that IPv6 will be preferred (if available) over IPv4. If a dual-stack host is configured to use a DNS64 server, that DNS64 server will synthesize an AAAA response if there is an A record. Thus, the dual-stack host will always use IPv6 if a DNS lookup was involved, even if IPv4 could have been used more optimally. </p>

<ul class="empty"><li>Note: If both a NAT44 and NAT64 are deployed on the same network, roughly the same inefficiency occurs (that is, NAT state is created). However, it is generally considered better to perform NAT44 than NAT64, because NAT64 translates between IP address families which can have side effects (e.g., FTP).</li></ul>
<p id="rfc.section.Appendix A.2.p.2">To avoid this, the host's <a href="#RFC3484">default address selection rules</a> <cite title="NONE">[RFC3484]</cite> can be modified so that IPv4 is preferred over the IPv6/IPv4 translator's prefix. At the same time, native IPv6 can still be preferred over IPv4. This is accomplished by adding the network's IPv6/IPv4 translator's prefix as the lowest Precedence in the address selection rules.</p>
<p id="rfc.section.Appendix A.2.p.3">If the IPv6/IPv4 translator's prefix is the IANA-assigned well-known prefix (64:FF9B::/96, as assigned in <a href="#RFC6052">[RFC6052]</a>), this can be hard-coded or easily scripted into the system startup. However, if the IPv6/IPv4 translator's prefix is a network-specific prefix (NSP, as described in <a href="#RFC6052">[RFC6052]</a>), the default address selection rules can be modified only after the host learns its currently-connected network's IPv6/IPv4 translator's prefix (e.g., using <a href="#I-D.wing-behave-learn-prefix">[I-D.wing-behave-learn-prefix]</a>).</p>
<p id="rfc.section.Appendix A.2.p.4">On some operating systems, the address selection rules can be configured using a command line utility (e.g., Windows, FreeBSD), without new software in the host's IP stack. Other operating systems are not as accommodating of this solution (see <a href="#address-limitations">Appendix Appendix A.2.2</a>).</p>
<p></p>

<ul class="empty"><li>Note: it may be desirable to create a standard to adjust a host's address selection rules based on the translator's prefix.  This is a topic for the <a href="#6man">IPv6 maintenance working group</a> <cite title="NONE">[6man]</cite>. This automatic mechanism may involve modifications to the host's IP stack, depending on how the IETF chooses to standardize such a mechanism. FOR EXAMPLE, it may be useful to consider <a href="#I-D.wing-behave-learn-prefix">[I-D.wing-behave-learn-prefix]</a> (which proposes using either DNS or DHCPv6) in conjunction with adjusting the host's address selection rules.</li></ul>
<h1 id="rfc.appendix.Appendix A.2.1">
<a href="#rfc.appendix.Appendix%20A.2.1">Appendix A.2.1.</a> Host Transition</h1>
<p id="rfc.section.Appendix A.2.1.p.1">An IPv6-only and a dual-stack host can both be configured with the same address selection rules (namely, both can add the network's translator as the lowest Precedence). This is because the IPv6-only host will never use IPv4 (because it lacks an IPv4 address) and will thus fall through and use the IPv6 address synthesized by the DNS64 containing the IPv6/IPv4 translator's prefix (that is, as shown in the examples, the IPv6-only host will use the Precedence 3 entry in the default policy table). The dual-stack host, if it receives an AAAA response, will prefer use IPv6; if it receives only an A response, it will prefer to use IPv4 (using Precedence 10 for IPv4-mapped addresses defined in Section 2.5.4 of <a href="#RFC3513">[RFC3513]</a>).</p>
<h1 id="rfc.appendix.Appendix A.2.2">
<a href="#rfc.appendix.Appendix%20A.2.2">Appendix A.2.2.</a> <a href="#address-limitations" id="address-limitations">Limitations and Advantages</a>
</h1>
<p id="rfc.section.Appendix A.2.2.p.1">The following limitations are observed: </p>

<ul>
<li>OSX does not implement a <a href="#RFC3484">[RFC3484]</a> or <a href="#RFC3484">[RFC3484]</a>-like policy table.</li>
<li>Some applications implement their own address selection rules, effectively ignoring the OS's address selection rules.</li>
</ul>
<p id="rfc.section.Appendix A.2.2.p.2">The following advantages are observed: </p>

<ul><li>Causes IPv4 to be preferred over IPv6/IPv4 translator addresses, even if DNS was not used to obtain the IPv4 or IPv6 address (e.g., applications which do not use DNS).</li></ul>
<h1 id="rfc.appendix.Appendix A.2.3">
<a href="#rfc.appendix.Appendix%20A.2.3">Appendix A.2.3.</a> Examples</h1>
<div id="#rfc.figure.2"></div>
<p>For example, if a network is using the WKP 64:FF9B::/96 <a href="#RFC6052">[RFC6052]</a> and a host is using the new default policy table from <a href="#I-D.arifumi-6man-rfc3484-revise">[I-D.arifumi-6man-rfc3484-revise]</a> (which added Precedence 5 for Teredo), the host's new policy table would contain one new entry with Precedence 3, as shown below:</p>
<pre>
Prefix        Precedence Label
::1/128               50     0     # localhost
::/0                  30     2     # IPv6 native
2002::/16             20     3     # 6to4 
::ffff:0:0/96         10     4     # IPv4-mapped 
2001::/32              5     5     # Teredo 
64:FF9B::/96           3     6     # 6/4 translator's prefix
</pre>
<p></p>
<div id="#rfc.figure.3"></div>
<p>As another example, if a network has the prefix 2001:0DB8::/32 and the NAT64 is using the Network-Specific Prefix (NSP) 2001:0DB8:AAAA::/96, and the host is using the new default policy table from <a href="#I-D.arifumi-6man-rfc3484-revise">[I-D.arifumi-6man-rfc3484-revise]</a> (which added Precedence 5 for Teredo), the host's new policy table would contain one new entry with Precedence 3, as shown below:</p>
<pre>
Prefix        Precedence Label
::1/128               50     0     # localhost
::/0                  30     2     # IPv6 native
2002::/16             20     3     # 6to4 
::ffff:0:0/96         10     4     # IPv4-mapped 
2001::/32              5     5     # Teredo 
2001:0DB8:AAAA::/96    3     6     # 6/4 translator's prefix
</pre>
<p></p>
<h1 id="rfc.appendix.Appendix A.3">
<a href="#rfc.appendix.Appendix%20A.3">Appendix A.3.</a> Indicating AAAA synthesis using DNS response flag</h1>
<p id="rfc.section.Appendix A.3.p.1">Dacheng Zhang's idea.</p>
<h1 id="rfc.appendix.Appendix A.4">
<a href="#rfc.appendix.Appendix%20A.4">Appendix A.4.</a> New A64 record</h1>
<p><a href="#I-D.boucadair-behave-dns-a64">[I-D.boucadair-behave-dns-a64]</a></p>
<h1 id="rfc.appendix.Appendix A.5">
<a href="#rfc.appendix.Appendix%20A.5">Appendix A.5.</a> Use DHCP to Assign Appropriate DNS Server</h1>
<p></p>

<ul class="empty"><li>Note: due to the limitations of this solution (see <a href="#dhcp_limitations">Appendix Appendix A.5.5</a>), it may have little or no value.</li></ul>

<p>To avoid unnecessary traffic through a translator, it is desirable to configure IPv4-only and dual-stack hosts with a 'normal' DNS recursive resolver.</p>
<p id="rfc.section.Appendix A.5.p.2">However, it is necessary to configure IPv6-only hosts with a <a href="#I-D.ietf-behave-dns64">DNS64</a> <cite title="NONE">[I-D.ietf-behave-dns64]</cite> recursive resolver so those hosts can use an IPv6/IPv4 translator and access servers on the IPv4 Internet.</p>
<p id="rfc.section.Appendix A.5.p.3">It is difficult to provide different DNS servers to those types of hosts, because there is no existing protocol that declares a host is IPv4-only, dual-stack, or IPv6-only.</p>
<p id="rfc.section.Appendix A.5.p.4">This document describes how a network's DHCPv4 and DHCPv6 servers, combined with a <a href="#RFC4361">client-identifiers</a> <cite title="NONE">[RFC4361]</cite> chosen by the host, can determine if a host is IPv4-only, dual-stack, or IPv6-only, and assign the correct DNS server according to that determination.</p>
<p></p>

<ul class="empty"><li>Note: the DHCP mechanism described in this section have some overlap with the <a href="#mif">Multiple Interfaces Working Group</a> <cite title="NONE">[mif]</cite> and with <a href="#I-D.savolainen-mif-dns-server-selection">split-zone DNS</a> <cite title="NONE">[I-D.savolainen-mif-dns-server-selection]</cite>.</li></ul>
<p id="rfc.section.Appendix A.5.p.6">Both an IPv4-only host and a dual-stack host obtain an IPv4 network address. Today, hosts most commonly obtain an IPv4 address using <a href="#RFC2131">DHCPv4</a> <cite title="NONE">[RFC2131]</cite>. An IPv6-only host does not obtain an IPv4 address; however, it may be using DHCPv6 to obtain other information (e.g., NTP servers). The following procedure takes advantage of that difference to determine if a host is IPv4-only, dual-stack, or IPv6-only.</p>
<h1 id="rfc.appendix.Appendix A.5.1">
<a href="#rfc.appendix.Appendix%20A.5.1">Appendix A.5.1.</a> Host Requirements</h1>
<p id="rfc.section.Appendix A.5.1.p.1">The host has the following requirements:</p>

<ol>
<li>if the host uses IPv4, it MUST use DHCPv4 to learn its IPv4 address and its DNS server address(es); and,</li>
<li>if the host uses IPv6, it MUST use DHCPv6 to learn its IPv6 DNS resolver, using the Information-Request message described in Section 18.1.5 of <a href="#RFC3315">[RFC3315]</a> and using <a href="#RFC3646">[RFC3646]</a>; and,</li>
<li>the host MUST use <a href="#RFC4361">client-identifiers</a> <cite title="NONE">[RFC4361]</cite> to identify itself to its DHCP server(s), and MUST use the same client-identifier for both DHCPv4 and DHCPv6<ul class="empty"><li>Note: This last requirement is stronger than the SHOULD in Section 6.2 of <a href="#RFC4361">[RFC4361]</a>
</li></ul>
<p>If the host does not support DHCP authentication, and acquires/releases its IPv4 address while keeping its IPv6 address, it MUST support the procedure described in </p>
<a href="#host_transition">Appendix Appendix A.5.4</a>; and,</li>
<li>the host MUST support the <a href="#RFC4242">DHCP Information Refresh Time Option</a> <cite title="NONE">[RFC4242]</cite>.</li>
</ol>
<h1 id="rfc.appendix.Appendix A.5.2">
<a href="#rfc.appendix.Appendix%20A.5.2">Appendix A.5.2.</a> <a href="#server-req" id="server-req">DHCPv4 and DHCPv6 Server Requirements</a>
</h1>
<p id="rfc.section.Appendix A.5.2.p.1">The DHCPv4 and DHCPv6 servers have the following requirements: </p>

<ol>
<li>the DHCPv4 and DHCPv6 servers MUST be able to communicate with each other both <a href="#RFC4361">client-identifiers</a> <cite title="NONE">[RFC4361]</cite> and if an IPv4 address is assigned to that client-identifier; and,</li>
<li>If the DHCP server and the host support DHCP authentication, the DHCP server MUST support the procedure described in <a href="#host_transition">Appendix Appendix A.5.4</a>.</li>
<li>MUST support the <a href="#RFC4242">DHCP Information Refresh Time Option</a> <cite title="NONE">[RFC4242]</cite>.</li>
</ol>
<h1 id="rfc.appendix.Appendix A.5.3">
<a href="#rfc.appendix.Appendix%20A.5.3">Appendix A.5.3.</a> DHCP Server Operation</h1>
<p id="rfc.section.Appendix A.5.3.p.1">If the DHCP server first receives a DHCPv4 request for a particular client-identifier, it responds with the 'normal' DNS resolver. The DHCPv6 server remembers that RFC4361 client identity and if the DHCPv6 server sees a DHCPv6 request from that same client identity, it responds to the DHCPv6 request with a 'normal' DNS resolver.</p>
<p id="rfc.section.Appendix A.5.3.p.2">If the DHCP server first receives a DHCPv6 request for a particular client-identifier, it responds with a short <a href="#RFC4242">information refresh time</a> <cite title="NONE">[RFC4242]</cite> (e.g., 30 seconds) and a DNS64 recursive resolver. </p>

<ul class="empty">
<li>Note-1: This means that during the short information refresh time, both a dual-stack host and an IPv6-only will have their DNS queries processed by the DNS64 recursive resolver. During that time, both the dual-stack host and the IPv6-only host will get connectivity to IPv4 servers, but the dual-stack host will use the IPv6/IPv4 translator until the information refresh time expires.</li>
<li>Note-2: for discussion: Consider have DHCP server slightly delay (e.g., 100ms) responding to a DHCPv6 request. This gives a chance for the DHCPv4 request to be received, thus avoiding the issue described in Note-1.</li>
</ul>
<p id="rfc.section.Appendix A.5.3.p.3">After the short information refresh time, the DHCPv6 client will send a new request. By that time, the DHCPv6 server will have either: </p>

<ol style="list-style-type: lower-alpha">
<li>have seen a DHCPv4 request from the same RFC4361 host. This indicates the host supports dual-stack. The DHCP server should extend the DHCPv6 lease, and provide a 'normal' DNS server (instead of the DNS64 server).</li>
<li>have not seen a DHCPv4 request from the same RFC4361 host.  This indicates the host is IPv6-only. The DHCP server should extend the DHCPv6 lease and continue providing the same DNS64 server.</li>
</ol>
<h1 id="rfc.appendix.Appendix A.5.4">
<a href="#rfc.appendix.Appendix%20A.5.4">Appendix A.5.4.</a> <a href="#host_transition" id="host_transition">Host Transition</a>
</h1>
<p id="rfc.section.Appendix A.5.4.p.1">During natural evolution of a network or because of debugging/troubleshooting, a host might transition between IPv4-only, dual-stack, or IPv6-only. When the host acquires or releases its IPv4 address it transitions to needing a different DNS server; if the host has an IPv4 address, it needs a 'normal' DNS server and if it does not have an IPv4 address it needs a DNS64 server.</p>
<p id="rfc.section.Appendix A.5.4.p.2">There are two transitions considered, where the host transitions:</p>

<ol>
<li>from IPv6-only to IPv4-supporting (that is, IPv4-only or dual-stack),</li>
<li>from IPv4-supporting (that is, IPv4-only or dual-stack) to IPv6-only.</li>
</ol>
<p id="rfc.section.Appendix A.5.4.p.3">When doing (1), the DHCPv4 server will provide a 'normal' DNS server (because the DHCPv4 server sees the same client-identifier as seen by the DHCPv6 server). So case (1) is solved.</p>
<p id="rfc.section.Appendix A.5.4.p.4">However, when doing (2), the host is giving up its IPv4 address and is currently using a normal DNS server, but needs to be told to use a DNS64 server instead. There are two mechanisms to provide that function, based on the network and host's support of DHCP authentication (Section 19.1.1 of <a href="#RFC3315">[RFC3315]</a>) <a href="#server-req">Appendix Appendix A.5.2</a>.</p>

<ol>
<li>with DHCP authentication: When a certain client identifier loses or acquires its IPv4 address and also has an IPv6 address, the DHCPv6 server MUST send a <a href="#RFC3315">DHCP RECONFIGURE message</a> <cite title="NONE">[RFC3315]</cite> to the host and SHOULD include the Option Request option indicating the DNS server information has changed. The RECONFIGURE message triggers the host to send a new Information-Request message to the DHCPv6 server.</li>
<li>without DHCP authentication: the host, when keeping its IPv6 address and releasing its IPv4 address, MUST also issue a new DHCPv6 Information-Request message to the DHCPv6 server.</li>
</ol>

<p>In both cases, the Information-Request message causes the DHCPv6 server to reply with a DNS64 recursive resolver, as discussed in </p>
<h1 id="rfc.appendix.Appendix A.5.5">
<a href="#rfc.appendix.Appendix%20A.5.5">Appendix A.5.5.</a> <a href="#dhcp_limitations" id="dhcp_limitations">Advantages and Disadvantages</a>
</h1>
<p id="rfc.section.Appendix A.5.5.p.1">Advantages: </p>

<ul><li>Dual-stack applications, which perform DNS lookups, will effectively avoid NAT64 when using the 'normal' DNS server.</li></ul>
<p id="rfc.section.Appendix A.5.5.p.2">Disadvantages: </p>

<ul>
<li>A network with mixed IPv4-only/dual-stack hosts and IPv6-only hosts needs to have a mix of DNS configurations for those hosts.  Thus, mechanisms that advertise the same DNS servers to all hosts cannot be used on such networks (e.g., IPv6 router advertisements).</li>
<li>If separate networks operate DHCPv4 and DHCPv6 (e.g., as with Dual-Stack Lite where the ISP operates DHCPv4 and the customer premise router operates DHCPv6), it is likely impossible for the DHCPv4 and DHCPv6 servers to communicate necessary information with each other.</li>
<li>Windows does not support <a href="#RFC4361">[RFC4361]</a>.</li>
<li>OSX does not support DHCPv6.</li>
</ul>
<h1 id="rfc.appendix.Appendix A.6">
<a href="#rfc.appendix.Appendix%20A.6">Appendix A.6.</a> New DHCP option for DNS64 server</h1>
<p id="rfc.section.Appendix A.6.p.1">Another approach, which requires modification of IPv6-only hosts which need to use the DNS64, is to introduce a new DHCP option.</p>
<p id="rfc.section.Appendix A.6.p.2">The idea is to support unmodified dual-stack hosts (which use the normal DNS server provided via <a href="#RFC3646">[RFC3646]</a>), but to modify IPv6-only hosts to look for the DNS64 server in a newly-defined DHCPv6 option.</p>
<h1 id="rfc.appendix.Appendix A.6.1">
<a href="#rfc.appendix.Appendix%20A.6.1">Appendix A.6.1.</a> Advantages and Disadvantages</h1>
<p id="rfc.section.Appendix A.6.1.p.1">Disadvantages:</p>

<ul><li>Requires modifying IPv6-only hosts, and without this modification they won't work at all with a DNS64.</li></ul>
<h1 id="rfc.appendix.Appendix A.7">
<a href="#rfc.appendix.Appendix%20A.7">Appendix A.7.</a> New DHCP option to identify dual-stack host</h1>
<p id="rfc.section.Appendix A.7.p.1">Dacheng Zhang's idea.</p>
<h1 id="rfc.authors"><a href="#rfc.authors">Author's Address</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Dan Wing</span> 
	  <span class="n hidden">
		<span class="family-name">Wing</span>
	  </span>
	</span>
	<span class="org vcardline">Cisco Systems, Inc.</span>
	<span class="adr">
	  <span>170 West Tasman Drive</span>

	  <span class="vcardline">
		<span class="locality">San Jose</span>,  
		<span class="region">CA</span> 
		<span class="code">95134</span>
	  </span>
	  <span class="country-name vcardline">USA</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:dwing@cisco.com">dwing@cisco.com</a></span>

  </address>
</div>

</body>
</html>