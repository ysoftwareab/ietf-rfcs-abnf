Network Working Group                                    Praveen Muley 
Internet Draft                                       Mustapha Aissaoui 
Expires: March 2007                                      Matthew Bocci 
                                                                Alcatel 
 
                                                        Jonathan Newton 
                                                       Cable & Wireless 
 
                                   
                                                     September 22, 2006 
                                      
                        Pseudowire (PW) Redundancy 
                    draft-muley-pwe3-redundancy-00.txt 


Status of this Memo 

   By submitting this Internet-Draft, each author represents that       
   any applicable patent or other IPR claims of which he or she is       
   aware have been or will be disclosed, and any of which he or she       
   becomes aware will be disclosed, in accordance with Section 6 of       
   BCP 79. 

   This document may only be posted in an Internet-Draft. 

   Internet-Drafts are working documents of the Internet Engineering 
   Task Force (IETF), its areas, and its working groups.  Note that 
   other groups may also distribute working documents as Internet-
   Drafts. 

   Internet-Drafts are draft documents valid for a maximum of six months 
   and may be updated, replaced, or obsoleted by other documents at any 
   time.  It is inappropriate to use Internet-Drafts as reference 
   material or to cite them other than as "work in progress." 

   The list of current Internet-Drafts can be accessed at 
        http://www.ietf.org/ietf/1id-abstracts.txt 

   The list of Internet-Draft Shadow Directories can be accessed at 
        http://www.ietf.org/shadow.html 

   This Internet-Draft will expire on March 22, 2007. 

Abstract 

   This document describes a few scenarios where PW redundancy is   
   needed. A set of redundant PWs is configured between PE nodes in SS-   
   PW applications, or between T-PE nodes in MS-PW applications. In   
   order for the PE/T-PE nodes to indicate the preferred PW path to   
   forward to one another, a new status bit is needed to indicate the   
 
 
 
Muley et al.           Expires March 22, 2007                 [Page 1] 

Internet-Draft       Pseudowire (PW) Redundancy)        September 2006 
    

   preferential forwarding status of active or standby for each PW in   
   the redundancy set. This draft specifies a new PW status bit for this 
   purpose. 

    

Conventions used in this document 

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", 
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this 
   document are to be interpreted as described in RFC-2119 [1]. 

Table of Contents 

    
   1. Terminology.................................................2 
   2. Introduction................................................3 
   3. Multi-homing Single SS-PW redundancy applications............4 
      3.1. One Multi-homed CE with Single SS-PW redundancy..........4 
      3.2. Multiple Multi-homed CEs with single SS-PW redundancy....5 
   4. Multi-homing MS-PW redundancy applications...................6 
      4.1. Multi-homed CE with MS-PW redundancy....................6 
      4.2. Single Homed CE with MS-PW redundancy...................7 
   5. Design considerations........................................8 
   6. Security Considerations......................................9 
   7. IANA Considerations.........................................9 
      7.1. Status Code for PW Preferential Forwarding Status........9 
   8. Acknowledgments.............................................9 
   9. References..................................................9 
   Author's Addresses............................................10 
   Intellectual Property Statement................................10 
   Disclaimer of Validity........................................11 
   Copyright Statement...........................................11 
   Acknowledgment................................................11 
    
1. Terminology  

   o PW Terminating Provider Edge (T-PE). A PE where the customer-   
      facing attachment circuits (ACs) are bound to a PW forwarder. A   
      Terminating PE is present in the first and last segments of a MS-
      PW. This incorporates the functionality of a PE as defined in 
      RFC3985 [4]. 

   o Single-Segment Pseudo Wire (SS-PW). A PW setup directly between 
      two T-PE devices. Each PW in one direction of a SS-PW traverses 
      one PSN tunnel that connects the two T-PEs.  

 
 
Muley et al.           Expires March 22, 2007                 [Page 2] 

Internet-Draft       Pseudowire (PW) Redundancy)        September 2006 
    

   o Multi-Segment Pseudo Wire (MS-PW). A static or dynamically 
      configured set of two or more contiguous PW segments that behave 
      and function as a single point-to-point PW. Each end of a MS-PW by 
      definition MUST terminate on a T-PE. 

   o PW Segment. A part of a single-segment or multi-segment PW, which 
      is set up between two PE devices, T-PEs and/or S-PEs. 

   o PW Switching Provider Edge (S-PE). A PE capable of switching the 
      control and data planes of the preceding and succeeding PW 
      segments in a MS-PW. The S-PE terminates the PSN tunnels of the 
      preceding and succeeding segments of the MS-PW. 

   o PW switching point for a MS-PW. A PW Switching Point is never the 
      S-PE and the T-PE for the same MS-PW. A PW switching point runs 
      necessary protocols to setup and manage PW segments with other PW 
      switching points and terminating PEs 

   o Active PW.  A PW whose preferential status is set to Active and 
      Operational status is UP.  

   o Standby PW. A PW whose preferential status is set to Standby.  

2. Introduction 

   In single-segment PW (SS-PW) applications, protection for the PW is 
   provided by the PSN layer. This may be an RSVP LSP with a FRR backup 
   and/or an end-to-end backup LSP. There are however applications where 
   the backup PW terminates on a different target PE node. PSN 
   protection mechanisms cannot protect against failure of the target PE 
   node or the failure of the remote AC.  

   In multi-segment PW (MS-PW) applications, a primary and multiple 
   secondary PWs in standby mode are configured in the network. The 
   paths of these PWs are diverse and are switched at different S-PE 
   nodes. In these applications, PW redundancy is important for the 
   service resilience.  

   This document describes these applications and specifies a new PW 
   status bit to indicate the preferential forwarding status of the PW 
   for the purpose of notifying the remote T-PE of the active/standby 
   state of each PW in the redundancy set. This status bit is different 
   from the operational status bits already defined in the PWE3 control 
   protocol [2]. The PW with both local and remote operational UP status 
   and local and remote preferential active status is selected to 
   forward traffic. 

 
 
Muley et al.           Expires March 22, 2007                 [Page 3] 

Internet-Draft       Pseudowire (PW) Redundancy)        September 2006 
    

3. Multi-homing Single SS-PW redundancy applications 

3.1. One Multi-homed CE with single SS-PW redundancy 

   The following figure illustrates an application of single segment 
   pseudo-wire redundancy. 

         |<-------------- Emulated Service ---------------->|  
         |                                                  |  
         |          |<------- Pseudo Wire ------>|          |  
         |          |                            |          |  
         |          |    |<-- PSN Tunnels-->|    |          |  
         |          V    V                  V    V          |  
         V    AC    +----+                  +----+     AC   V  
   +-----+    |     | PE1|==================|    |     |    +-----+ 
   |     |----------|....|...PW1.(active)...|....|----------|     | 
   |     |          |    |==================|    |          | CE2 | 
   | CE1 |          +----+                  |PE2 |          |     | 
   |     |          +----+                  |    |          +-----+ 
   |     |          |    |==================|    |        
   |     |----------|....|...PW2.(standby)..|    |        
   +-----+    |     | PE3|==================|    |        
              AC    +----+                  +----+        
     
    

            Figure 1 Multi-homed CE with single SS-PW redundancy 

   In Figure 1, CE1 is dual homed to PE1 and to PE3 by attachment 
   circuits. The method for dual-homing of CE1 to PE1 and PE3 nodes and 
   the used protocols are outside the scope of this document. PE2 has an 
   attachment circuit from CE2. Two pseudo-wires pw1 and pw2 are 
   established, one connects PE1 to PE2 and the other one connects PE3 
   to PE2. On PE2, PW1 has a higher priority than PW2 by local 
   configuration. 

   In normal operation, PE1 and PE3 will advertise "Active" and 
   "Standby" preferential forwarding status (apart from operational 
   status) respectively to PE2. This status reflects the forwarding 
   state of the two AC's to CE1. PE2 advertises preferential status of 
   "Active" on both PW1 and PW2. As both the local and remote 
   operational and administrative status for PW1 are UP and Active, 
   traffic is forwarded over PW1 in both directions. 

   On failure of AC to PE1, PE1 sends a PW status notification to PE2 
   indicating that the AC operational status changed to DOWN. It will 
   also set the forwarding status of PW1 to "standby". PE3 AC will 
 
 
Muley et al.           Expires March 22, 2007                 [Page 4] 

Internet-Draft       Pseudowire (PW) Redundancy)        September 2006 
    

   change preferential status to active and this status is also 
   communicated to PE2 using the newly proposed forwarding status bit in 
   the PW status TLV notification message. The changing of preferential 
   status on PE3 due to failure of AC at PE1 is achieved by various 
   methods depending of the used dual-homing protocol and is outside the 
   scope of this draft. On receipt of the status notifications, PE2 
   switches the path to the standby pseudo-wire PW2 as the newly changed 
   status turns PW2 as Active PW. Note in this example, the receipt of 
   the operational status of the AC on the CE1-PE1 link is normally 
   sufficient to have PE2 switch the path to PW2. However, the operator 
   may want to trigger the switchover of the path of the PW for 
   administrative reasons, i.e., maintenance, and thus the proposed PW 
   forwarding active/standby bit is required to notify PE2 to trigger 
   the switchover. 

3.2. Multiple Multi-homed CEs with single SS-PW redundancy 

             |<-------------- Emulated Service ---------------->|  
             |                                                  |  
             |          |<------- Pseudo Wire ------>|          |  
             |          |                            |          |  
             |          |    |<-- PSN Tunnels-->|    |          |  
             |          V    V                  V    V          |  
             V    AC    +----+                  +----+     AC   V  
       +-----+    |     |....|.......PW1........|....|     |    +-----+  
       |     |----------| PE1|......   .........| PE3|----------|     |  
       | CE1 |          +----+      \ /  PW3    +----+          | CE2 |  
       |     |          +----+       X          +----+          |     | 
       |     |          |    |....../ \..PW4....|    |          |     |  
       |     |----------| PE2|                  | PE4|--------- |     |  
       +-----+    |     |....|.....PW2..........|....|     |    +-----+  
                  AC    +----+                  +----+    AC       
     
    
     Figure 2 Multiple Multi-homed CEs with single SS-PW redundancy  

   In the figure illustrated above the both CEs CE1 and CE2 are dual- 
   homed with PEs, PE1, PE2 and PE3, PE4 respectively. The method for 
   dual-homing and the used protocols are outside the scope of this 
   document. Note that the PSN tunnels are not shown in this figure for 
   clarity. However, it can be assumed that each of the PWs shown is 
   encapsulated in a separate PSN tunnel. 

   PE1 advertises the preferential status "active" and operational 
   status "UP" for pseudo-wires PW1 and PW4 connected to PE3 and PE4. 
   This status reflects the forwarding state of the AC attached to PE1. 
   PE2 advertise preferential status "standby" where as operational 
 
 
Muley et al.           Expires March 22, 2007                 [Page 5] 

Internet-Draft       Pseudowire (PW) Redundancy)        September 2006 
    

   status "UP" for pseudo-wires PW2 and PW3 to PE3 and PE4. PE3 
   advertises preferential status "standby" where as operational status 
   "UP" for pseudo-wires PW1 and PW3 to PE1 and PE2. PE4 advertise the 
   preferential status "active" and operational status "UP" for pseudo-
   wires PW2 and PW4 to PE2 and PE1 respectively. Thus by matching the 
   local and remote preferential status "active" and operational status 
   "Up" of pseudo-wire the active pseudo-wire is selected. In this case 
   it is the PW4 that will be selected. On failure of AC between the CE1 
   and PE1 the preferential status on PE2 is changed. Different 
   mechanisms/protocols can be used to achieve this and these are beyond 
   the scope of this document. PE2 then announces the newly changed 
   preferential status "active" to PE3 and PE4. PE1 will advertise a PW 
   status notification message indicating that the AC between CE1 and 
   PE1 is operationally down. PE2 and PE4 checks the local and remote 
   preferential status "active" and operational status "Up" and selects 
   PW2 as the new active pseudo-wire to send traffic. 

   In this application, because each dual-homing algorithm running on 
   the two node sets, i.e., {CE1, PE1, PE2} and {CE2, PE3, PE4}, selects 
   the active AC independently, there is a need to signal the active 
   status of the AC such that the PE nodes can select a common active PW 
   path for end-to-end forwarding between CE1 and CE2. 

4. Multi-homing MS-PW redundancy applications 

4.1. Multi-homed CE with MS-PW redundancy 

   The following figure illustrates an application of multi-segment 
   pseudo-wire redundancy. 

           Native   |<-----------Pseudo Wire----------->|  Native   
           Service  |                                   |  Service   
            (AC)    |    |<-PSN1-->|     |<-PSN2-->|    |   (AC)   
              |     V    V         V     V         V    V     |   
              |     +-----+         +-----+         +-----+        
       +----+ |     |T-PE1|=========|S-PE1|=========|T-PE2|   |   +----+ 
       |    |-------|......PW1-Seg1.......|PW1-Seg2.......|-------|    | 
       |    |       |     |=========|     |=========|     |       |    | 
       | CE1|       +-----+         +-----+         +-----+       |    | 
       |    |         |.|           +-----+         +-----+       | CE2| 
       |    |         |.|===========|     |=========|     |       |    | 
       |    |         |.....PW2-Seg1......|.PW2-Seg2......|-------|    | 
       +----+         |=============|S-PE2|=========|T-PE4|   |   +----+ 
                                    +-----+         +-----+   AC        
     
    

 
 
Muley et al.           Expires March 22, 2007                 [Page 6] 

Internet-Draft       Pseudowire (PW) Redundancy)        September 2006 
    

             Figure 3 Multi-homed CE with MS-PW redundancy 

   In Figure 3, the PEs that provide PWE3 to CE1 and CE2 are 
   Terminating-PE1 (T-PE1) and Terminating-PE2 (T-PE2) respectively. A 
   PSN tunnel extends from T-PE1 to switching-PE1 (S-PE1) across PSN1, 
   and a second PSN tunnel extends from S-PE1 to T-PE2 across PSN2. PW1 
   and PW2 are used to connect the attachment circuits (ACs) between T-
   PE1 and T-PE2. Each PW segment on the tunnel across PSN1 is switched 
   to a PW segment in the tunnel across PSN2 at S-PE1 to complete the 
   multi-segment PW (MS-PW) between T-PE1 and T-PE2. S-PE1 is therefore 
   the PW switching point. PW1 has two segments and is active pseudo-
   wire while PW2 has two segments and is a standby pseudo-wire. This 
   application requires support for MS-PW with segments of the same type 
   as described in [3]. The operation in this case is the same as in the 
   case of SS-PW. The only difference is that the S-PW nodes need to 
   relay the PW status notification containing both the operational and 
   forwarding status to the T-PE nodes. 

4.2. Single Homed CE with MS-PW redundancy 

   This is the main application of interest and the network setup is 
   shown in Figure 3 

           Native   |<------------Pseudo Wire------------>|  Native   
           Service  |                                     |  Service   
            (AC)    |     |<-PSN1-->|     |<-PSN2-->|     |  (AC)   
              |     V     V         V     V         V     V   |   
              |     +-----+         +-----+         +-----+   |   
       +----+ |     |T-PE1|=========|S-PE1|=========|T-PE2|   |   +----+   
       |    |-------|......PW1-Seg1.......|.PW1-Seg2......|-------|    |   
       | CE1|       |     |=========|     |=========|     |       | CE2| 
       |    |       +-----+         +-----+         +-----+       |    |   
       +----+        |.||.|                          |.||.|       +----+  
                     |.||.|         +-----+          |.||.|              
                     |.||.|=========|     |========== .||.| 
                     |.||...PW2-Seg1......|.PW2-Seg2...||.|              
                     |.| ===========|S-PE2|============ |.|        
                     |.|            +-----+             |.|              
                     |.|============+-----+============= .|             
                     |.....PW3-Seg1.|     | PW3-Seg2......|              
                      ==============|S-PE3|===============              
                                    |     |                              
                                    +-----+                             
    
     Figure 4 Single homed CE with multi-segment pseudo-wire redundancy 


 
 
Muley et al.           Expires March 22, 2007                 [Page 7] 

Internet-Draft       Pseudowire (PW) Redundancy)        September 2006 
    

   In Figure 4, CE1 is connected to PE1 in provider Edge 1 and CE2 to 
   PE2 in provider edge 2 respectively. There are three segmented PWs. A 
   primary PW, PW1, is switched at S-PE1. A standby PW, PW2, which is 
   switched at S-PE2 and has a priority of 1. Finally, another standby 
   PW, PW3, is switched at S-PE3 and has a priority of 2. This means T-
   PE1 and T-PE2 will select PW1 over PW2, and PW2 over PW3 if all of 
   them are in the UP state. Moreover, a T-PE node will revert back to 
   the primary PW, PW1, whenever it comes back up. 

   The intent of this application is to have T-PE1 and T-PE2 synchronize 
   the transmit and receive paths of the PW over the network. In other 
   words, both T-PE nodes will transmit over the PW segment which is 
   switched by the same S-PE. This is desirable for ease of operation 
   and troubleshooting. 

   Since there is no multi-homing running on the AC, the T-PE nodes 
   would advertise 'Active" for the forwarding status. However, this 
   does not guarantee that the paths of the PW are synchronized because 
   for example of mismatch of the configuration of the PW priority in 
   each T-PE. Thus, there is a need to devise an augmented mechanism to 
   achieve the desirable synchronization of the PW paths and to add the 
   ability to have a T-PE instruct the remote T-PE to perform a 
   coordinated switchover to a common Active path. 

   The solution required for this specific scenario is left for further 
   study. 

5. Design considerations  

   While using the pseudo-wire redundancy application, the T-LDP peers 
   MUST negotiate the usage of PW status TLV. The status code defined 
   below carries the active/standby preferential forwarding status of 
   the pseudo-wire. The pseudo-wire is only considered active pseudo-
   wire only when both the local PW status and the remote PW status 
   indicate preferential status "active" and operational status as Up. 
   Any other status combination keeps the pseudo-wire in standby mode. 
   The pseudo-wires are given different preference level. In case of 
   network failure, the PE/T-PE will first switch to the standby PW with 
   a higher preference. Although the configuration of the pseudo-wire 
   preference is matter of local policy matter and is outside the scope 
   of this, it is desirable to have the preferences configured on both 
   end points be similar. In mis-configuration, a method to force the 
   synchronization of the PW paths is required is for further study. 
   While in standby status, a pseudo-wire can still receive packets in 
   order to avoid black holing of the in-flight packets during 
   switchover. 

 
 
Muley et al.           Expires March 22, 2007                 [Page 8] 

Internet-Draft       Pseudowire (PW) Redundancy)        September 2006 
    

6. Security Considerations  

   This document specifies the LDP extensions that are needed for 
   protecting pseudo-wires. It will have the same security properties as 
   in LDP [5] and the PW control protocol [2]. 

7. IANA Considerations  

   We have defined the following codes for the pseudo-wire redundancy 
   application. 

7.1. Status Code for PW Preferential Forwarding Status 

   The T-PE nodes need to indicate to each other the preferential 
   forwarding status of active/inactive of the pseudo-wire. 

   0x00000020 When the bit is set it represents "PW forwarding 
               standby". 

           When the bit is cleared, it represents "PW forwarding 
               "active". 

8. Acknowledgments  

   The authors would like to thank Vach Kompella, Kendall Harvey, 
   Tiberiu Grigoriu, Neil Hart, Kajal Saha, and Philippe Niger for their 
   valuable comments and suggestions. 

9. References  

   [1]  Bradner, S., "Key words for use in RFCs to Indicate Requirement 
         Levels", BCP 14, RFC 2119, March 1997. 

   [2]  Martini, L., et al., "Pseudowire Setup and Maintenance using 
         LDP", RFC 4447, April 2006.  

   [3]  Martini, L., et al., "Segmented Pseudo Wire", draft-ietf-pwe3-
         segmented-pw-02.txt, March 2006. 

   [4]  Bryant, S., et al., " Pseudo Wire Emulation Edge-to-Edge (PWE3) 
         Architecture", March 2005 

   [5]  Andersson, L., Doolan, P., Feldman, N., Fredette, A., and B. 
         Thomas, "LDP Specification", RFC 3036, January 2001 

    

 
 
Muley et al.           Expires March 22, 2007                 [Page 9] 

Internet-Draft       Pseudowire (PW) Redundancy)        September 2006 
    

Author's Addresses 

   Praveen Muley 
   Alcatel 
   701 E. Middlefiled Road  
   Mountain View, CA, USA  
   Email: Praveen.muley@alcatel.com 
    

   Mustapha Aissaoui   
   Alcatel   
   600 March Rd   
   Kanata, ON, Canada K2K 2E6   
   Email: mustapha.aissaoui@alcatel.com   
    

   Matthew Bocci 
   Alcatel 
   Voyager Place, Shoppenhangers Rd 
   Maidenhead, Berks, UK SL6 2PJ 
   Email: matthew.bocci@alcatel.co.uk 
    
   Jonathan Newton 
   Cable & Wireless 
   Email: Jonathan.Newton@cwmsg.cwplc.com 
    
Intellectual Property Statement 

   The IETF takes no position regarding the validity or scope of any 
   Intellectual Property Rights or other rights that might be claimed to 
   pertain to the implementation or use of the technology described in 
   this document or the extent to which any license under such rights 
   might or might not be available; nor does it represent that it has 
   made any independent effort to identify any such rights.  Information 
   on the procedures with respect to rights in RFC documents can be 
   found in BCP 78 and BCP 79. 

   Copies of IPR disclosures made to the IETF Secretariat and any 
   assurances of licenses to be made available, or the result of an 
   attempt made to obtain a general license or permission for the use of 
   such proprietary rights by implementers or users of this 
   specification can be obtained from the IETF on-line IPR repository at 
   http://www.ietf.org/ipr. 

   The IETF invites any interested party to bring to its attention any 
   copyrights, patents or patent applications, or other proprietary 
   rights that may cover technology that may be required to implement 
 
 
Muley et al.           Expires March 22, 2007                [Page 10] 

Internet-Draft       Pseudowire (PW) Redundancy)        September 2006 
    

   this standard.  Please address the information to the IETF at 
   ietf-ipr@ietf.org. 

Disclaimer of Validity 

   This document and the information contained herein are provided on an 
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS 
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY AND THE INTERNET 
   ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS OR IMPLIED, 
   INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE 
   INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED 
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. 

Copyright Statement 

   Copyright (C) The Internet Society (2006). 

   This document is subject to the rights, licenses and restrictions 
   contained in BCP 78, and except as set forth therein, the authors 
   retain all their rights. 

Acknowledgment 

   Funding for the RFC Editor function is currently provided by the 
   Internet Society. 

    



















 
 
Muley et al.           Expires March 22, 2007                [Page 11] 

