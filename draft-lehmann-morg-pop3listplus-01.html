<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>The Post Office Protocol (POP3) LIST+ Extension</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Overview">
<link href="#rfc.section.1.2" rel="Chapter" title="1.2 Conventions used in this document">
<link href="#rfc.section.2" rel="Chapter" title="2 The LIST+ Capability">
<link href="#rfc.section.3" rel="Chapter" title="3 The LIST Command">
<link href="#rfc.section.4" rel="Chapter" title="4 Initial Set of LIST+ Flags">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 The +AGE Flag">
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 The +ID Flag">
<link href="#rfc.section.4.2.1" rel="Chapter" title="4.2.1 Purpose">
<link href="#rfc.section.4.2.2" rel="Chapter" title="4.2.2 The ID-Identifier">
<link href="#rfc.section.4.2.3" rel="Chapter" title="4.2.3 Actions at server's side">
<link href="#rfc.section.4.2.4" rel="Chapter" title="4.2.4 Actions at client's side">
<link href="#rfc.section.4.2.5" rel="Chapter" title="4.2.5 Examples">
<link href="#rfc.section.4.3" rel="Chapter" title="4.3 The +UIDL Flag">
<link href="#rfc.section.5" rel="Chapter" title="5  Parameter and Response Length ">
<link href="#rfc.section.6" rel="Chapter" title="6 Future Extensions to LIST+">
<link href="#rfc.section.7" rel="Chapter" title="7 Security Considerations">
<link href="#rfc.section.8" rel="Chapter" title="8 IANA Considerations">
<link href="#rfc.section.8.1" rel="Chapter" title="8.1 'LIST+ Flags' Registry ">
<link href="#rfc.section.8.2" rel="Chapter" title="8.2 LIST+ Registration in 'POP3 Capabilities' Registry ">
<link href="#rfc.section.9" rel="Chapter" title="9 Conclusions">
<link href="#rfc.references" rel="Chapter" title="10 References">
<link href="#rfc.appendix.Appendix%20A" rel="Chapter" title="Appendix A Message flow examples">
<link href="#rfc.appendix.Appendix%20A.1" rel="Chapter" title="Appendix A.1 Typical message flow without LIST+ Extension">
<link href="#rfc.appendix.Appendix%20A.2" rel="Chapter" title="Appendix A.2 Message Flow using the LIST+ Extension">
<link href="#rfc.appendix.Appendix%20A.2.1" rel="Chapter" title="Appendix A.2.1 LIST+ for all messages">
<link href="#rfc.appendix.Appendix%20A.2.2" rel="Chapter" title="Appendix A.2.2 LIST+ for a single message">
<link href="#rfc.appendix.Appendix%20A.2.3" rel="Chapter" title="Appendix A.2.3 LIST+ for all messages using all possible LIST+ Flags, one new message arrived">
<link href="#rfc.appendix.Appendix%20B" rel="Chapter" title="Appendix B Augmented BNF">
<link href="#rfc.appendix.Appendix%20C" rel="Chapter" title="Appendix C Acknowledgements">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="The Post Office Protocol - Version 3 (POP3) LIST+ Extension allows a POP3 client to instruct a POP3 server to send additional information with the LIST command response. It also can instruct a POP3 server to send only information about newly arrived messages, when polling for new messages. This will help save message round trips and network bandwidth, especially on large mailboxes containing several messages. On public POP3 servers, serving thousands of mailboxes, and being polled frequently, LIST+ will help reduce server load as well as network bandwith." />
  <meta name="description" content="The Post Office Protocol - Version 3 (POP3) LIST+ Extension allows a POP3 client to instruct a POP3 server to send additional information with the LIST command response. It also can instruct a POP3 server to send only information about newly arrived messages, when polling for new messages. This will help save message round trips and network bandwidth, especially on large mailboxes containing several messages. On public POP3 servers, serving thousands of mailboxes, and being polled frequently, LIST+ will help reduce server load as well as network bandwith." />
  <meta name="keywords" content="POP3, LIST, email" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Network Working Group</td>
<td class="right">S. Lehmann</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Strato AG</td>
</tr>
<tr>
<td class="left">Updates: 1939 (if approved)</td>
<td class="right">Aug 2011</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right"></td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">The Post Office Protocol (POP3) LIST+ Extension<br />
  <span class="filename">draft-lehmann-morg-pop3listplus-01</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>The Post Office Protocol - Version 3 (POP3) LIST+ Extension allows a POP3 client to instruct a POP3 server to send additional information with the LIST command response. It also can instruct a POP3 server to send only information about newly arrived messages, when polling for new messages. This will help save message round trips and network bandwidth, especially on large mailboxes containing several messages. On public POP3 servers, serving thousands of mailboxes, and being polled frequently, LIST+ will help reduce server load as well as network bandwith.</p>
<h1><a>Note</a></h1>
<p>This document defines an extension to POP3, and updates RFC 1939.</p>
<p>Technical comments are solicited and should be addressed to Message Organizations Working Group's mailing list at morg@ietf.org and/or to the author. You can subscribe to that list at <a href="https://www.ietf.org/mailman/listinfo/morg">https://www.ietf.org/mailman/listinfo/morg</a>.</p>
<p>Editorial comments should be addressed directly to the author.</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>1.1.   <a href="#rfc.section.1.1">Overview</a>
</li>
<li>1.2.   <a href="#rfc.section.1.2">Conventions used in this document</a>
</li>
<li>2.   <a href="#rfc.section.2">The LIST+ Capability</a>
</li>
<li>3.   <a href="#rfc.section.3">The LIST Command</a>
</li>
<li>4.   <a href="#rfc.section.4">Initial Set of LIST+ Flags</a>
</li>
<li>4.1.   <a href="#rfc.section.4.1">The +AGE Flag</a>
</li>
<li>4.2.   <a href="#rfc.section.4.2">The +ID Flag</a>
</li>
<li>4.2.1.   <a href="#rfc.section.4.2.1">Purpose</a>
</li>
<li>4.2.2.   <a href="#rfc.section.4.2.2">The ID-Identifier</a>
</li>
<li>4.2.3.   <a href="#rfc.section.4.2.3">Actions at server's side</a>
</li>
<li>4.2.4.   <a href="#rfc.section.4.2.4">Actions at client's side</a>
</li>
<li>4.2.5.   <a href="#rfc.section.4.2.5">Examples</a>
</li>
<li>4.3.   <a href="#rfc.section.4.3">The +UIDL Flag</a>
</li>
<li>5.   <a href="#rfc.section.5"> Parameter and Response Length </a>
</li>
<li>6.   <a href="#rfc.section.6">Future Extensions to LIST+</a>
</li>
<li>7.   <a href="#rfc.section.7">Security Considerations</a>
</li>
<li>8.   <a href="#rfc.section.8">IANA Considerations</a>
</li>
<li>8.1.   <a href="#rfc.section.8.1">'LIST+ Flags' Registry </a>
</li>
<li>8.2.   <a href="#rfc.section.8.2">LIST+ Registration in 'POP3 Capabilities' Registry </a>
</li>
<li>9.   <a href="#rfc.section.9">Conclusions</a>
</li>
<li>10.   <a href="#rfc.references">References</a>
</li>
<li>Appendix A.   <a href="#rfc.appendix.Appendix%20A">Message flow examples</a>
</li>
<li>Appendix A.1.   <a href="#rfc.appendix.Appendix%20A.1">Typical message flow without LIST+ Extension</a>
</li>
<li>Appendix A.2.   <a href="#rfc.appendix.Appendix%20A.2">Message Flow using the LIST+ Extension</a>
</li>
<li>Appendix A.2.1.   <a href="#rfc.appendix.Appendix%20A.2.1">LIST+ for all messages</a>
</li>
<li>Appendix A.2.2.   <a href="#rfc.appendix.Appendix%20A.2.2">LIST+ for a single message</a>
</li>
<li>Appendix A.2.3.   <a href="#rfc.appendix.Appendix%20A.2.3">LIST+ for all messages using all possible LIST+ Flags, one new message arrived</a>
</li>
<li>Appendix B.   <a href="#rfc.appendix.Appendix%20B">Augmented BNF</a>
</li>
<li>Appendix C.   <a href="#rfc.appendix.Appendix%20C">Acknowledgements</a>
</li>
<li><a href="#rfc.authors">Author's Address</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> <a href="#intro" id="intro">Introduction</a>
</h1>
<h1 id="rfc.section.1.1">
<a href="#rfc.section.1.1">1.1.</a> <a href="#overview" id="overview">Overview</a>
</h1>
<p id="rfc.section.1.1.p.1">Although POP3 is intended as a download-and-delete protocol, clients can decide to leave messages on the server. If this happens on a mailbox having "unlimited" mail space, such a mailbox will grow continously in size, so mailboxes having thousands of mails are not uncommon. The POP3 protocol has no means to poll for only new arrived messages. Observations on a public POP3 server have shown several POP3 clients using the LIST command, and, immediately followed, the UIDL command to get the Message Number, Message Size and Unique-ID, of all messages of a mailbox, to see if new messages have arrived. Both commands, LIST and UIDL, always respond with a list of all messages.  On large mailboxes, this will waste network bandwith, and will prolong the duration a mailbox is hold in locked state. This situation is even stressed by the fact that POP3 clients will usually poll a mailbox for new messages periodically in short intervals.</p>
<p id="rfc.section.1.1.p.2">The LIST command, on the server, has to scan through all messages of a mailbox to provide the Message Number and the Message Size. The subsequent UIDL command has to scan again through all messages of a mailbox to provide the Message Number and the Unique-ID. The Message Number sent with the UIDL command, in this scenario, is already known to the client, and therefore, is a redundant information (as in example shown in <a href="#legacy_example">Appendix Appendix A.1</a>).  All the lines with Message Numbers the client already knows, are of no interest by client, and therefore, sent by server in vain. Using the LIST+ Extension, a server has to scan through the mailbox only for a single time, and can send the Message Number, Message Size and Unique-ID in a more compact form to the client (as shown in <a href="#example_listplus_all_msgs">Appendix Appendix A.2.1</a>).</p>
<p id="rfc.section.1.1.p.3">Another major benefit of the LIST+ Extension is that the client can instruct the server to send only information about newly arrived messages. This avoids sending of information by server, which the client already knows.</p>
<p id="rfc.section.1.1.p.4">The LIST+ Extension also offers the possibility to fetch other useful information with the LIST command quasi "on the fly", like the age of a message. This may be helpful for clients to decide if a message has to be deleted automatically due to clients' message deleting policies. There is no need to read the mail headers to make this decision in this case.</p>
<p id="rfc.section.1.1.p.5">Although it would be better to access large mailboxes by IMAP, there might be reasons for customers to use POP3.</p>
<h1 id="rfc.section.1.2">
<a href="#rfc.section.1.2">1.2.</a> <a href="#conventions" id="conventions">Conventions used in this document</a>
</h1>
<p id="rfc.section.1.2.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">[RFC2119]</a>.</p>
<p id="rfc.section.1.2.p.2">In this document, these words will appear with that interpretation only when in ALL CAPS. Lower case uses of these words are not to be interpreted as carrying RFC-2119 significance.</p>
<p id="rfc.section.1.2.p.3">In this document, the term "client" refers to a host making use of the POP3 service, while the term "server" refers to a host which offers the POP3 service.</p>
<p id="rfc.section.1.2.p.4">In examples, "C:" and "S:" indicate lines sent by the client and server respectively.</p>
<p id="rfc.section.1.2.p.5">In this document, the term "scan listing" refer to the output of a POP3 LIST command, containing one line for every message in a mailbox, as described in <a href="#RFC1939">[RFC1939]</a>, Section 5.</p>
<p id="rfc.section.1.2.p.6">In this document, the terms "extended scan listing" and "full scan listing" refer to a "POP3 scan listing", which can hold additional information, controlled by the means of the POP3 LIST+ command, as described in this document.</p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> <a href="#capa" id="capa">The LIST+ Capability</a>
</h1>
<p id="rfc.section.2.p.1">This section defines the LIST+ Capability according to Section 9 of <a href="#RFC2449">[RFC2449]</a>.</p>
<p></p>

<dl>
<dt>CAPA tag:</dt>
<dd style="margin-left: 3">
<br> LIST+</dd>
<dt>Arguments:</dt>
<dd style="margin-left: 3">
<br> Supported LIST+ Flags</dd>
<dt>Added commands:</dt>
<dd style="margin-left: 3">
<br> none</dd>
<dt>Standard commands affected:</dt>
<dd style="margin-left: 3">
<br> LIST</dd>
<dt>Announces states / possible differences:</dt>
<dd style="margin-left: 3">
<br> both / no</dd>
<dt>Commands valid in states:</dt>
<dd style="margin-left: 3">
<br> n/a</dd>
<dt>Specification reference:</dt>
<dd style="margin-left: 3">
<br> This document and <a href="#RFC1939">[RFC1939]</a>
</dd>
<dt>Discussion:</dt>
<dd style="margin-left: 3">
<br> The LIST+ capability enables the use of the indicated LIST+ Flags as additional parameters of the LIST command.</dd>
</dl>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#listcommand" id="listcommand">The LIST Command</a>
</h1>
<p id="rfc.section.3.p.1">This section updates the syntax of the LIST command as well as the definition of the scan listing, both as defined in Section 5 of <a href="#RFC1939">[RFC1939]</a>.</p>
<p id="rfc.section.3.p.2">Formal syntax: LIST [msg] [flaglist]</p>
<p id="rfc.section.3.p.3">The flaglist is a list of LIST+ Flags, separated by a single space. A LIST+ Flag always starts with "+" (it means "add the following information"), followed by the name of the flag. A flag name MUST start with a letter ("A-Z" or "a-z"), and MUST NOT be longer than 20 characters.</p>
<p id="rfc.section.3.p.4">A server, supporting LIST+, has to decide whether the first argument of the LIST command (if any) is a message number or a LIST+ Flag. If an argument starts with "+", and its second character is a letter, this parameter is to be considered as a LIST+ flag.</p>
<p id="rfc.section.3.p.5">If the server receives a LIST+ flag which is not supported, the server MUST issue a "-ERR" response.</p>
<p id="rfc.section.3.p.6">After the server has accepted a flaglist, it sends an extended scan listing for each requested message back to the client. The extended scan listing consists of: <a href="#ABNF">Appendix Appendix B</a> for a formal syntax using ABNF.</p>

<ul>
<li>The message-number of the message, followed by a single space</li>
<li>The exact size of the message in octets, followed by a single space</li>
<li>The value(s) as requested by the flaglist, separated each by a single space, in the same order as given in the flaglist. A value MUST consist of only ASCII characters in the range of 33-126 (hex 21-7E). Otherwise, it is RECOMMENDED to use BASE64 encoding according to <a href="#RFC4648">[RFC4648]</a>.</li>
</ul>

<p>See </p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> Initial Set of LIST+ Flags</h1>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> The +AGE Flag</h1>
<p id="rfc.section.4.1.p.1">The +AGE Flag requests to add the age of a message to the extended scan listing. The age is expressed in units of whole days since the message was delivered into the mailbox.</p>
<p id="rfc.section.4.1.p.2">A message delivered yesterday (regardless of the time) has an age of one. A message delivered today has an age of zero. The value is presented as a decimal integer.</p>
<p id="rfc.section.4.1.p.3">Servers which are unable to determine the age of a message in this way MUST NOT advertise the +AGE Flag in the LIST+ capability list.</p>
<p id="rfc.section.4.1.p.4">The +AGE Flag has no Parameter.</p>
<h1 id="rfc.section.4.2">
<a href="#rfc.section.4.2">4.2.</a> The +ID Flag</h1>
<h1 id="rfc.section.4.2.1">
<a href="#rfc.section.4.2.1">4.2.1.</a> Purpose</h1>
<p id="rfc.section.4.2.1.p.1">The +ID Flag instructs the server to </p>

<ul>
<li>suppress all scan lines the server has already issued (except the last one),</li>
<li>send an ID-Identifier as first item in the "OK" response line.</li>
</ul>
<p id="rfc.section.4.2.1.p.2">The +ID Flag, when sent by client, always has a parameter. This parameter can be:</p>

<ul>
<li>The ID-Identifier as received from server in a response of a previous LIST+ command.</li>
<li>An empty string.</li>
</ul>
<h1 id="rfc.section.4.2.2">
<a href="#rfc.section.4.2.2">4.2.2.</a> The ID-Identifier</h1>
<p id="rfc.section.4.2.2.p.1">The ID-Identifier, if not empty, MUST consist of characters all in the range of 33-126 (hex 21-7E). Its length should be kept as short as possible, but MUST NOT exceed 255 bytes. The ID-Identifier is generated by the server. The server has to put all information into the ID-Identifier which it needs to find out the last issued message of a mailbox. A newly created ID-Indentifier MUST be unique with respect to former created ID-Identifiers.</p>
<p id="rfc.section.4.2.2.p.2">The server stores the last issued ID-Indentifier in the meta-data store of a mailbox. A volatile memory MAY be used. It is not allowed to store more than one ID-Identifier per mailbox. The server MAY delete a stored ID-Identifier at any time.</p>
<p id="rfc.section.4.2.2.p.3">The client retains a received ID-Identifier, and MAY send it as a +ID Flag parameter in the very next LIST+ command. After the client has sent a LIST command or LIST+ command (with or without +ID Flag), a stored ID-Identifier MUST be deleted by client.</p>
<h1 id="rfc.section.4.2.3">
<a href="#rfc.section.4.2.3">4.2.3.</a> Actions at server's side</h1>
<p></p>

<dl>
<dt>The server deletes one or more messages from the mailbox:</dt>
<dd style="margin-left: 4">
<br> If there is a stored ID-Identifier, delete it.</dd>
<dt>The server appends one or more messages to the mailbox:</dt>
<dd style="margin-left: 4">
<br> If there is a stored ID-Identifier, leave it intact.</dd>
<dt>The server receives a LIST command or LIST+ command without +ID Flag:</dt>
<dd style="margin-left: 4">
<br> Send a full scan listing. If there is a stored ID-Identifier, leave it intact. Send no ID-Identifier to the client.</dd>
<dt>The server receives a LIST+ command with an empty ID-Identifier:</dt>
<dd style="margin-left: 4">
<br> Send a full scan listing. If there is a stored ID-Identifier, leave it intact and sent it to the client. If there is no stored ID-Identifier, create one and send it to the client.</dd>
<dt>The server receives a LIST+ command with a non-empty ID-Identifier equal to the stored one:</dt>
<dd style="margin-left: 4">
<br> If the mailbox ist empty: Send an empty scan listing, leave the ID-Identifier intact and send it to the client. If the message, as referenced by the ID-identifier, is still the last message in the mailbox: Send a partial scan listing which constist of only the last message in the mailbox, leave the ID-Identifier intact and send it to the client. If the message, as referenced by the ID-Identifier, is not the last message in the mailbox: Send a partial scan listing which constist of all messages with message numbers above the message number as referenced by the ID-Identifier, create and store a new ID-Identifier and send it to the client.</dd>
<dt>The server receives a LIST+ command with a non-empty ID-Identifier not equal to the stored one:</dt>
<dd style="margin-left: 4">
<br> Send a full scan listing. If there is a stored ID-Identifier, leave it intact and send it to the client. If there is no stored ID-Identifier, create one and send it to the client.</dd>
</dl>
<h1 id="rfc.section.4.2.4">
<a href="#rfc.section.4.2.4">4.2.4.</a> Actions at client's side</h1>
<p></p>

<dl>
<dt>The client receives an empty scan listing:</dt>
<dd style="margin-left: 4">
<br> Consider the mailbox as empty. Store the new ID-Identifier.</dd>
<dt>The client receives a scan listing with first message number equal to one:</dt>
<dd style="margin-left: 4">
<br> Handle the scan listing as a full scan listing. Store the new ID-Identifier.</dd>
<dt>The client receives a scan listing with first message number greater than one:</dt>
<dd style="margin-left: 4">
<br> Handle the scan listing as a partial scan listing. Store the new ID-Identifier. Note: The client could already know the message as indicated in the very first scan line. In this case, the clients MAY skip processing of this scan line.</dd>
</dl>
<h1 id="rfc.section.4.2.5">
<a href="#rfc.section.4.2.5">4.2.5.</a> Examples</h1>
<p id="rfc.section.4.2.5.p.1">The client has just started up. For this reason, it has no ID-Identifier yet, and sends an empty ID-Identifier to request one.  The servers issues all messages and an ID-Identifier "Az-Df~701", which is retained by client:</p>
<div id="#rfc.figure.1"></div>
<pre>
S: +OK POP3 server ready
C: CAPA
S: +OK Capability list follows:
S: LIST+ +AGE +ID +UIDL
S: .
C: LIST +ID= +UIDL
S: +OK Az-Df~701 10299 messages, listing follows:
S: 1 4536 7abcb6f4da22080e121f2824aef2be9a
S: 2 4422 577151e65ea4e62bb9b1c5830a818fe7
S: 3 1134 6374234adfg58cda7b4ccdf34bccacc6
S: ... (10295 more lines)
S: 10299 3828 2fe542ac6d1c29bb6a5161558f527e2e
S: .
C: QUIT
S: +OK Closing connection</pre>
<p id="rfc.section.4.2.5.p.2">Client connecting the second time when there are no changes. The server issues the ID-Identifier "Az-Df~701" again, which is retained by client, and sends only the the last message in a partial scan listing:</p>
<div id="#rfc.figure.2"></div>
<pre>
S: +OK POP3 server ready
C: CAPA
S: +OK Capability list follows:
S: LIST+ +AGE +ID +UIDL
S: .
C: LIST +ID=Az-Df~701 +UIDL
S: +OK Az-Df~701 No changes
S: 10299 3828 2fe542ac6d1c29bb6a5161558f527e2e
S: .
C: QUIT
S: +OK Closing connection</pre>
<p id="rfc.section.4.2.5.p.3">Client connecting the 3rd time when there are two new messages.  The server issues the ID-Identifier "Az-Df~702", which is retained by client. Only the two new messages are sent in a partial scan listing:</p>
<div id="#rfc.figure.3"></div>
<pre>
S: +OK POP3 server ready
C: CAPA
S: +OK Capability list follows:
S: LIST+ +AGE +ID +UIDL
S: .
C: LIST +ID=Az-Df~701 +UIDL
S: +OK Az-Df~702 2 more messages, listing follows:
S: 10300 258 4c2674df036aba49035134701bc47401
S: 10301 496 764fd5a52324c683c6b33a9c4c50abe2
S: .
C: QUIT
S: +OK Closing connection</pre>
<p id="rfc.section.4.2.5.p.4">Client connecting the 4th time when message #2 was deleted. The server issues a complete scan listing, because of message deletetion. The new ID-Identifier is "Az-Df~703".</p>
<div id="#rfc.figure.4"></div>
<pre>
S: +OK POP3 server ready
C: CAPA
S: +OK Capability list follows:
S: LIST+ +AGE +ID +UIDL
S: .
C: LIST +ID=Az-Df~702 +UIDL
S: +OK Az-Df~703 10300 messages, listing follows:
S: 1 4536 7abcb6f4da22080e121f2824aef2be9a
S: 2 1134 6374234adfg58cda7b4ccdf34bccacc6
S: ... (10297 more lines)
S: 10300 496 764fd5a52324c683c6b33a9c4c50abe2
S: .
C: QUIT
S: +OK Closing connection</pre>
<h1 id="rfc.section.4.3">
<a href="#rfc.section.4.3">4.3.</a> The +UIDL Flag</h1>
<p id="rfc.section.4.3.p.1">The +UIDL Flag requests to add the Unique-ID of a message to the extended scan listing. The Unique-ID for a message is the same value as it would be sent by the UIDL command for this message. See <a href="#RFC1939">[RFC1939]</a>, Section 7, "UIDL Command".</p>
<p id="rfc.section.4.3.p.2">Servers not supporting the UIDL command MUST NOT advertise the +UIDL Flag in the LIST+ capability list.</p>
<p id="rfc.section.4.3.p.3">The +UIDL Flag has no Parameter.</p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a>  Parameter and Response Length </h1>
<p id="rfc.section.5.p.1">The Parameter and Response Lengths, as defined in Section 4 of <a href="#RFC2449">[RFC2449]</a>, are not affected by the LIST+ Extension Flags as defined in this document.</p>
<p id="rfc.section.5.p.2">The already defined Parameter and Response Lengths are sufficient to hold complete LIST+ command and response lines as defined in this document, even if all possible flags are given together.</p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> Future Extensions to LIST+</h1>
<p id="rfc.section.6.p.1">The LIST+ Extension itself is expandable. New LIST+ flags may be defined by future documents. If such a document defines a LIST+ flag whose value contains characters outside the range as defined in <a href="#listcommand">Section 3</a>, it MUST declare how to encode the value, so it fulfills the requirements of this document.</p>
<p id="rfc.section.6.p.2">Future documents defining new LIST+ flags MUST contain a statement whether the Parameter and Response Length, as defined in Section 4 of [RFC2449], are sufficient to hold lines with all possible flags/values, or not. If not, new values for parameter and response length MUST be defined.</p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> <a href="#security" id="security">Security Considerations</a>
</h1>
<p id="rfc.section.7.p.1">The LIST+ Extension, if not proper implemented by client or server, could prevent mails to be fetched from server.  Firewalls or other network devices, when monitoring POP3 sessions, could be worried by the protocol changes made by LIST+.</p>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> <a href="#iana" id="iana">IANA Considerations</a>
</h1>
<h1 id="rfc.section.8.1">
<a href="#rfc.section.8.1">8.1.</a> 'LIST+ Flags' Registry </h1>
<p id="rfc.section.8.1.p.1">IANA is asked to create and maintain the 'LIST+ Flags' registry following the guidelines below.</p>
<p id="rfc.section.8.1.p.2">The registry consists of two values: LIST+ flag and Reference. They are described below. </p>

<dl>
<dt>1 )</dt>
<dd>LIST+ flag - the text string, whose syntax is defined in Section 3.</dd>
<dt>2 )</dt>
<dd>Reference - the reference to the document that described the LIST+ flag.</dd>
</dl>
<p id="rfc.section.8.1.p.3">Initial values are given below; new assignments are to be made following the 'IETF Consensus' policies <a href="#RFC5226">[RFC5226]</a>.</p>
<div id="#rfc.table.1"></div>
<div id="#iana_init_values"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<caption>Initial IANA Values</caption>
<thead><tr>
<th class="left">LIST+ Flag</th>
<th class="left">Reference</th>
</tr></thead>
<tbody>
<tr>
<td class="left">+UIDL</td>
<td class="left">this document</td>
</tr>
<tr>
<td class="left">+AGE</td>
<td class="left">this document</td>
</tr>
<tr>
<td class="left">+ID</td>
<td class="left">this document</td>
</tr>
</tbody>
</table>
<h1 id="rfc.section.8.2">
<a href="#rfc.section.8.2">8.2.</a> LIST+ Registration in 'POP3 Capabilities' Registry </h1>
<p id="rfc.section.8.2.p.1">&gt; IANA is asked a new keyword "LIST+" in the "POP3 Capabilities" registry <a href="#RFC1939">[RFC1939]</a> using the template in Section <a href="#capa">Section 2</a> of this document.</p>
<h1 id="rfc.section.9">
<a href="#rfc.section.9">9.</a> Conclusions</h1>
<p id="rfc.section.9.p.1">All mail program/server developers are encouraged to implement LIST+.</p>
<p id="rfc.section.9.p.2">All carriers of POP3 servers holding mailboxes of many, frequently polling clients are encouraged to support LIST+.</p>
<h1 id="rfc.references">
<a href="#rfc.references">10.</a> References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC1939">[RFC1939]</b></td>
<td class="top">
<a href="mailto:jgm+@cmu.edu" title="Carnegie-Mellon University">Myers, J.G.</a> and <a href="mailto:mrose@dbc.mtview.ca.us" title="Dover Beach Consulting, Inc.">M.T. Rose</a>, "<a href="http://tools.ietf.org/html/rfc1939">Post Office Protocol - Version 3</a>", STD 53, RFC 1939, May 1996.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2449">[RFC2449]</b></td>
<td class="top">
<a href="mailto:randy@qualcomm.com" title="QUALCOMM Incorporated">Gellens, R.</a>, <a href="mailto:chris.newman@innosoft.com" title="Innosoft International, Inc.">Newman, C.</a> and <a href="mailto:lgl@qualcomm.com" title="QUALCOMM Incorporated">L. Lundblade</a>, "<a href="http://tools.ietf.org/html/rfc2449">POP3 Extension Mechanism</a>", RFC 2449, November 1998.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5234">[RFC5234]</b></td>
<td class="top">
<a>Crocker, D.</a> and <a>P. Overell</a>, "<a href="http://tools.ietf.org/html/rfc5234">Augmented BNF for Syntax Specifications: ABNF</a>", STD 68, RFC 5234, January 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4648">[RFC4648]</b></td>
<td class="top">
<a>Josefsson, S.</a>, "<a href="http://tools.ietf.org/html/rfc4648">The Base16, Base32, and Base64 Data Encodings</a>", RFC 4648, October 2006.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5226">[RFC5226]</b></td>
<td class="top">
<a>Narten, T.</a> and <a>H. Alvestrand</a>, "<a href="http://tools.ietf.org/html/rfc5226">Guidelines for Writing an IANA Considerations Section in RFCs</a>", BCP 26, RFC 5226, May 2008.</td>
</tr>
</tbody></table>
<h1 id="rfc.appendix.Appendix A">
<a href="#rfc.appendix.Appendix%20A">Appendix A.</a> Message flow examples</h1>
<h1 id="rfc.appendix.Appendix A.1">
<a href="#rfc.appendix.Appendix%20A.1">Appendix A.1.</a> <a href="#legacy_example" id="legacy_example">Typical message flow without LIST+ Extension</a>
</h1>
<div id="#rfc.figure.5"></div>
<pre>S: +OK POP3 server ready
C: CAPA
S: +OK Capability list follows:
S: UIDL
S: .
C: LIST
S: +OK 3 messages, listing follows:
S: 1 4536
S: 2 4422
S: ... (10296 more lines)
S: 10299 3828
S: .
C: UIDL
S: +OK 10299 messages, listing follows:
S: 1 7abcb6f4da22080e121f2824aef2be9a
S: 2 577151e65ea4e62bb9b1c5830a818fe7
S: ... (10296 more lines)
S: 10299 2fe542ac6d1c29bb6a5161558f527e2e
S: .
C: QUIT
S: +OK Closing connection</pre>
<h1 id="rfc.appendix.Appendix A.2">
<a href="#rfc.appendix.Appendix%20A.2">Appendix A.2.</a> Message Flow using the LIST+ Extension</h1>
<h1 id="rfc.appendix.Appendix A.2.1">
<a href="#rfc.appendix.Appendix%20A.2.1">Appendix A.2.1.</a> <a href="#example_listplus_all_msgs" id="example_listplus_all_msgs">LIST+ for all messages</a>
</h1>
<div id="#rfc.figure.6"></div>
<pre>S: +OK POP3 server ready
C: CAPA
S: +OK Capability list follows:
S: UIDL
S: LIST+ +UIDL +AGE
S: .
C: LIST +UIDL
S: +OK 10299 messages, listing follows:
S: 1 4536 7abcb6f4da22080e121f2824aef2be9a
S: 2 4422 577151e65ea4e62bb9b1c5830a818fe7
S: ... (10296 more lines)
S: 10299 3828 2fe542ac6d1c29bb6a5161558f527e2e
S: .
C: QUIT
S: +OK Closing connection</pre>
<h1 id="rfc.appendix.Appendix A.2.2">
<a href="#rfc.appendix.Appendix%20A.2.2">Appendix A.2.2.</a> <a href="#example_listplus_single_msg" id="example_listplus_single_msg">LIST+ for a single message</a>
</h1>
<div id="#rfc.figure.7"></div>
<pre>S: +OK POP3 server ready
C: CAPA
S: +OK Capability list follows:
S: UIDL
S: LIST+ +UIDL +AGE
S: .
C: LIST 2 +UIDL
S: +OK 2 4422 577151e65ea4e62bb9b1c5830a818fe7
C: QUIT
S: +OK Closing connection</pre>
<h1 id="rfc.appendix.Appendix A.2.3">
<a href="#rfc.appendix.Appendix%20A.2.3">Appendix A.2.3.</a> <a href="#example_listplus_all_flags" id="example_listplus_all_flags">LIST+ for all messages using all possible LIST+ Flags, one new message arrived</a>
</h1>
<div id="#rfc.figure.8"></div>
<pre>S: +OK POP3 server ready
C: CAPA
S: +OK Capability list follows:
S: UIDL
S: LIST+ +UIDL +AGE
S: .
C: LIST +UIDL +AGE +ID=Az-Df~701
S: +OK Az-Df~702 1 new message, listing follows:
S: 10300 4536 ead6763cdc00080f36172429ac13c1cb 0
S: .
C: QUIT
S: +OK Closing connection</pre>
<h1 id="rfc.appendix.Appendix B">
<a href="#rfc.appendix.Appendix%20B">Appendix B.</a> <a href="#ABNF" id="ABNF">Augmented BNF</a>
</h1>
<p id="rfc.section.Appendix B.p.1">This section defines the LIST+ syntax using Augmented BNF (see <a href="#RFC5234">[RFC5234]</a> for details). The following rules are for clarification only, and are not intended to supersede the definition of the LIST command, as defined in <a href="#RFC1939">[RFC1939]</a>.</p>
<div id="#rfc.figure.9"></div>
<pre>
listplus-req      = "LIST" [SP msg-num] [SP listplus-flaglist] CRLF
listplus-rsp      = listplus-rsp-ok / listplus-rsp-err
listplus-rsp-ok   = "+OK" [SP listplus-id] [SP *comment] CRLF
                        *listplus-scanline
			"." CRLF
listplus-rsp-err  = "-ERR" [SP *comment] CRLF
listplus-scanline = msg-num SP msg-size [*(SP listplus-value)] CRLF
listplus-flaglist = listplus-flag [*(SP listplus-flag)]
listplus-flag     = "+" ALPHA [*listplus-char] ["=" listplus-value]
listplus-value    = 1*listplus-char
listplus-id       = 1*255listplus-char
listplus-char     = %x21-7E
msg-num           = 1*DIGIT
msg-size          = 1*DIGIT
comment           = *(WSP / VCHAR)
	</pre>
<h1 id="rfc.appendix.Appendix C">
<a href="#rfc.appendix.Appendix%20C">Appendix C.</a> Acknowledgements</h1>
<p id="rfc.section.Appendix C.p.1">Timo Sirainen contibuted an invaluable suggestion with the +ID flag.  Also, thanks to Mykyta Yevstifeyev, and many others.</p>
<h1 id="rfc.authors"><a href="#rfc.authors">Author's Address</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Steffen Lehmann</span> 
	  <span class="n hidden">
		<span class="family-name">Lehmann</span>
	  </span>
	</span>
	<span class="org vcardline">Strato AG</span>
	<span class="adr">
	  <span>Pascalstr. 10</span>

	  <span class="vcardline">
		<span class="locality">Berlin</span>,  
		<span class="region"></span>
		<span class="code">D-10587</span>
	  </span>
	  <span class="country-name vcardline">GERMANY</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:lehmann@strato-rz.de">lehmann@strato-rz.de</a></span>

<span class="vcardline">URI: <a href="http://www.strato.de/">http://www.strato.de/</a></span>

  </address>
</div>

</body>
</html>