<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>GSS-API Naming
    Extensions</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="GSS-API Naming
    Extensions">
<meta name="keywords" content="Internet-Draft">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 60em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 60em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">KITTEN WORKING GROUP</td><td class="header">N. Williams</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Sun</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">L. Johansson</td></tr>
<tr><td class="header">Expires: December 26, 2010</td><td class="header">SUNET</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">June 24, 2010</td></tr>
</table></td></tr></table>
<h1><br />GSS-API Naming
    Extensions<br />draft-ietf-kitten-gssapi-naming-exts-08.txt</h1>

<h3>Abstract</h3>

<p>The Generic Security Services API (GSS-API) provides a simple naming
      architecture that supports name-based authorization. This document
      introduces new APIs that extend the GSS-API naming model to support name
      attribute transfer between GSS-API peers.
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted  in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF).  Note that other groups may also distribute
working documents as Internet-Drafts.  The list of current
Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
This Internet-Draft will expire on December 26, 2010.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the Simplified BSD License.</p>
<p>
This document may contain material from IETF Documents or IETF
Contributions published or made publicly available before November
10, 2008.  The person(s) controlling the copyright in some of this
material may not have granted the IETF Trust the right to allow
modifications of such material outside the IETF Standards Process.
Without obtaining an adequate license from the person(s) controlling
the copyright in such materials, this document may not be modified
outside the IETF Standards Process, and derivative works of it may
not be created outside the IETF Standards Process, except to format
it for publication as an RFC or to translate it into languages other
than English.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Conventions used in this document<br />
<a href="#anchor2">2.</a>&nbsp;
Introduction<br />
<a href="#anchor3">3.</a>&nbsp;
Name Attribute Authenticity<br />
<a href="#anchor4">4.</a>&nbsp;
Name Attributes/Values as ACL Subjects<br />
<a href="#anchor5">5.</a>&nbsp;
Attribute Name Syntax<br />
<a href="#anchor6">6.</a>&nbsp;
Mapping Mechanism Facilities to Name Attributes<br />
<a href="#anchor7">6.1.</a>&nbsp;
Kerberos V and SPKM Authorization-Data<br />
<a href="#anchor8">6.2.</a>&nbsp;
PKIX<br />
<a href="#anchor9">6.2.1.</a>&nbsp;
Standard PKIX Certificate Extensions<br />
<a href="#anchor10">6.2.2.</a>&nbsp;
Other PKIX Certificate Extensions and Attributes<br />
<a href="#anchor11">6.3.</a>&nbsp;
SAML attribute assertions<br />
<a href="#anchor12">7.</a>&nbsp;
API<br />
<a href="#anchor13">7.1.</a>&nbsp;
GSS_Display_name_ext()<br />
<a href="#anchor14">7.1.1.</a>&nbsp;
C-Bindings<br />
<a href="#anchor15">7.2.</a>&nbsp;
GSS_Inquire_name()<br />
<a href="#anchor16">7.2.1.</a>&nbsp;
C-Bindings<br />
<a href="#anchor17">7.3.</a>&nbsp;
GSS_Get_name_attribute()<br />
<a href="#anchor18">7.3.1.</a>&nbsp;
C-Bindings<br />
<a href="#anchor19">7.4.</a>&nbsp;
GSS_Set_name_attribute()<br />
<a href="#anchor20">7.4.1.</a>&nbsp;
C-Bindings<br />
<a href="#anchor21">7.5.</a>&nbsp;
GSS_Delete_name_attribute()<br />
<a href="#anchor22">7.5.1.</a>&nbsp;
C-Bindings<br />
<a href="#anchor23">7.6.</a>&nbsp;
GSS_Export_name_composite()<br />
<a href="#anchor24">7.6.1.</a>&nbsp;
C-Bindings<br />
<a href="#anchor25">8.</a>&nbsp;
IANA Considerations<br />
<a href="#anchor26">9.</a>&nbsp;
Security Considerations<br />
<a href="#rfc.references1">10.</a>&nbsp;
References<br />
<a href="#rfc.references1">10.1.</a>&nbsp;
Normative References<br />
<a href="#rfc.references2">10.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Conventions used in this document</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
      "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
      document are to be interpreted as described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a> .
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Introduction</h3>

<p>As described in <a class='info' href='#RFC4768'>[RFC4768]<span> (</span><span class='info'>Hartman, S., &ldquo;Desired Enhancements to Generic Security Services Application Program Interface (GSS-API) Version 3 Naming,&rdquo; December&nbsp;2006.</span><span>)</span></a> the GSS-API's
      naming architecture suffers from certain limitations. This document
      proposes concrete GSS-API extensions.
</p>
<p>A number of extensions to the GSS-API <a class='info' href='#RFC2743'>[RFC2743]<span> (</span><span class='info'>Linn, J., &ldquo;Generic Security Service Application Program Interface Version 2, Update 1,&rdquo; January&nbsp;2000.</span><span>)</span></a>
      and its C Bindings <a class='info' href='#RFC2744'>[RFC2744]<span> (</span><span class='info'>Wray, J., &ldquo;Generic Security Service API Version 2 : C-bindings,&rdquo; January&nbsp;2000.</span><span>)</span></a> are described herein.
      The goal is to make information modeled as "name attributes" available
      to applications. Such information MAY for instance be used by
      applications to make authorization-decisions. For example, Kerberos V
      authorization data elements, both in their raw forms, as well as mapped
      to more useful value types, can be made available to GSS-API
      applications through these interfaces.
</p>
<p>The model is that GSS names have attributes. The attributes of a name
      may be authenticated (eg an X509 attribute certificate or signed SAML
      attribute assertion), or may have been set on a GSS name for the purpose
      of locally "asserting" the attribute during credential acquisition or
      security context exchange. Name attributes' values are network
      representations thereof (e.g., the actual value octets of the contents
      of an X.509 certificate extension, for example) and are intended to be
      useful for constructing portable access control facilities. Applications
      may often require language- or platform-specific data types, rather than
      network representations of name attributes, so a function is provided to
      obtain objects of such types associated with names and name
      attributes.
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Name Attribute Authenticity</h3>

<p>An attribute is 'authenticated' iff there is a secure association
      between the attribute (and its values) and the trusted source of the
      peer credential. Examples of authenticated attributes are (any part of)
      the signed portion of an X.509 certificate or AD-KDCIssued
      authorization-data elements in Kerberos V Tickets provided of course
      that the authenticity of the respective security associations (eg
      signatures) have been verified.
</p>
<p>Note that the fact that an attribute is authenticated does not imply
      anything about the semantics of the attribute nor that the trusted
      credential source was authorized to assert the attribute. Such
      interpretations SHOULD be the result of applying local policy to the
      attribute.
</p>
<p>An un-authentciated attribute is called <em>asserted</em>
      in what follows.This is not to be confused with other uses of the word
      asserted or assertion eg "SAML attribute assertion", the attributes of
      which may be authenticated in the sense of this document for instance if
      the SAML attribute assertion was signed by a key trusted by the
      peer.
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Name Attributes/Values as ACL Subjects</h3>

<p>To facilitate the development of portable applications that make use
      of name attributes to construct and evaluate portable ACLs the GSS-API
      makes name attribute values available in canonical network encodings
      thereof.
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Attribute Name Syntax</h3>

<p>Attribute names are represented as opaque STRING elements in the API
      described below. These attribute names have syntax and semantics that
      are understood by the application and by the lower-layer implementations
      (some of which are described below). In order to present a consistent
      namespace to the application and at the same time impose as few
      transformation requirements as possible to lower-layer implementations
      attribute names SHOULD be URIs.
</p>
<p>Technologies used in lower-layer protocols may of course use
      attribute naming that are not based on URIs. Notably X.509 certificates
      will use OIDs for most naming purposes. In this case OIDs MUST be mapped
      into URIs as described in <a class='info' href='#RFC3061'>[RFC3061]<span> (</span><span class='info'>Mealling, M., &ldquo;A URN Namespace of Object Identifiers,&rdquo; February&nbsp;2001.</span><span>)</span></a> MUST be used.
      If for example the OID 1.2.3 denotes an Extended Key Usage (cf below),
      the corresponding GSS-API attribute name MUST be represented as
      urn:oid:1.2.3.
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Mapping Mechanism Facilities to Name Attributes</h3>

<p>In this section we describe two important examples of lower-layer
      implementations of this API. These examples are not mandatory to
      implement and are only provided for reference. The use of <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>-terms in this section is limited to those
      implementations of the GSS-API naming extensions that choose to
      implement these lower-layer technologies. Future mappings SHOULD be
      documented as RFCs.
</p>
<p>Kerberos V <a class='info' href='#RFC4120'>[RFC4120]<span> (</span><span class='info'>Neuman, C., Yu, T., Hartman, S., and K. Raeburn, &ldquo;The Kerberos Network Authentication Service (V5),&rdquo; July&nbsp;2005.</span><span>)</span></a> and the Simple Public-Key
      GSS-API Mechanism, SPKM described in <a class='info' href='#RFC2025'>[RFC2025]<span> (</span><span class='info'>Adams, C., &ldquo;The Simple Public-Key GSS-API Mechanism (SPKM),&rdquo; October&nbsp;1996.</span><span>)</span></a>,
      both support the concept and encoding of containers of
      "authorization-data" as described in <a class='info' href='#RFC4120'>[RFC4120]<span> (</span><span class='info'>Neuman, C., Yu, T., Hartman, S., and K. Raeburn, &ldquo;The Kerberos Network Authentication Service (V5),&rdquo; July&nbsp;2005.</span><span>)</span></a>.
</p>
<p>PKIX <a class='info' href='#RFC5280'>[RFC5280]<span> (</span><span class='info'>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; May&nbsp;2008.</span><span>)</span></a> supports a number of
      attribute-like features, like Extended Key Usage values (EKUs) and
      certificate extensions.
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
Kerberos V and SPKM Authorization-Data</h3>

<p>Authorization-data non-container elements asserted in Kerberos V
        AP-REQ Authenticators MUST be mapped into <strong>asserted</strong>
        GSS-API name attributes.
</p>
<p>Authorization-data included in Kerberos V Tickets that is not
        contained in AD-KDCIssued (with valid signature) MUST be mapped into
        <strong>asserted</strong> GSS-API name attributes.
        Conversely, authorization-data elements in Kerberos V Tickets
        contained by AD-KDCIssued MUST be mapped into <strong>authenticated</strong>
        GSS-API name attributes.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
PKIX</h3>

<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2.1"></a><h3>6.2.1.&nbsp;
Standard PKIX Certificate Extensions</h3>

<p>PKIX certificate extensions MAY/SHOULD/MUST (see comment above)
          be represented as <strong>authenticated</strong>
          GSS-API name attributes named using the <em>same</em>
          OID mapped to a URN.
</p>
<p>SubjectAltNames and Extended Key Usage OIDs, specifically, MUST
          be represented as <strong>authenticated</strong>
          GSS-API name attributes; see below. Certificate extensions MUST be
          represented as GSS-API name attributes named using the OIDs used for
          the extensions (represented as URNs). The value associated with
          Extended Key Usage attributes MUST have NULL value represented as a
          zero-length OCTET STRING.
</p>
<p>The standard PKIX certificate key usage (KUs, but not EKUs), MUST
          NOT be represented as GSS-API name attributes.
</p>
<p>PKIX certificate subjectAltNames MUST be mapped as <strong>authenticated</strong> GSS-API name attributes. The
          values SHOULD be the values of the subjectAltName represented as
          OCTET STRINGs if the type of the subjectAltName supports a unique
          loss-less representation as string values. Specifically dnsName,
          ipAddress, uniformResourceLocator and emailAddress MUST be returned
          using the corresponding string representation of those data
          types.
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2.2"></a><h3>6.2.2.&nbsp;
Other PKIX Certificate Extensions and Attributes</h3>

<p>Any X.509 certificate extension not covered above SHOULD be
          represented as GSS-API name attributes with the OID of the X.509
          extension and with OCTET STRING values containing the encoded value
          of the extension.
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.3"></a><h3>6.3.&nbsp;
SAML attribute assertions</h3>

<p>Attributes contained in SAML attribute assertions MUST be mapped to
        GSS-API name attributes with the same URIs as used in the SAML
        attribute name.
</p>
<p>SAML attributes found in SAML attribute assertions MUST NOT be
        mapped as authenticated unless the SAML attribute assertion was signed
        by a key trusted by the peer or otherwise protected from unauthorized
        modification.
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
API</h3>

<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.1"></a><h3>7.1.&nbsp;
GSS_Display_name_ext()</h3>

<p>Inputs: <br />
<br />
 </p>
<ul class="text">
<li>name NAME,
</li>
<li>display_as_name_type OBJECT IDENTIFIER
</li>
</ul>

<p>Outputs: <br />
<br />
 </p>
<ul class="text">
<li>major_status INTEGER,
</li>
<li>minor_status INTEGER,
</li>
<li>display_name STRING
</li>
</ul>

<p>Return major_status codes: </p>
<ul class="text">
<li>GSS_S_COMPLETE indicates no error.
</li>
<li>GSS_S_UNAVAILABLE indicates that the given name could not be
            displayed using the syntax of the given name type.
</li>
<li>GSS_S_FAILURE indicates a general error.
</li>
</ul>

<p>This function displays a given name using the given name syntax, if
        possible. This operation may require mapping MNs to generic name
        syntaxes or generic name syntaxes to mechanism-specific name syntaxes;
        such mappings may not always be feasible and MAY be inexact or lossy,
        therefore this function may fail.
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.1.1"></a><h3>7.1.1.&nbsp;
C-Bindings</h3>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
OM_uint32 GSS_Display_name_ext(
  OM_uint32                     *minor_status,
  gss_name_t                    name,
  gss_OID                       display_as_name_type,
  gss_buffer_t                  display_name
);
</pre></div>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.2"></a><h3>7.2.&nbsp;
GSS_Inquire_name()</h3>

<p>Inputs: <br />
<br />
 </p>
<ul class="text">
<li>name NAME
</li>
</ul>

<p>Outputs: <br />
<br />
 </p>
<ul class="text">
<li>major_status INTEGER,
</li>
<li>minor_status INTEGER,
</li>
<li>name_is_MN BOOLEAN,
</li>
<li>mn_mech OBJECT IDENTIFIER,
</li>
<li>attrs SET OF OCTET STRING
</li>
</ul>

<p>Return major_status codes: </p>
<ul class="text">
<li>GSS_S_COMPLETE indicates no error.
</li>
<li>GSS_S_FAILURE indicates a general error.
</li>
</ul>

<p>This function outputs the set (represented as a NULL terminated
        array of gss_buffer_t) of attributes of a name. It also indicates if a
        given NAME is an MN or not and, if it is, what mechanism it's an MN
        of. The gss_buffer_set_t type and associated API is defined in <a class='info' href='#GFD.024'>[GFD.024]<span> (</span><span class='info'>Argonne National Laboratory, National Center for Supercomputing             Applications, Argonne National Laboratory, and Argonne National Laboratory, &ldquo;GSS-API Extensions,&rdquo; June&nbsp;2004.</span><span>)</span></a>
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.2.1"></a><h3>7.2.1.&nbsp;
C-Bindings</h3>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
OM_uint32 gss_inquire_name(
  OM_uint32                     *minor_status,
  gss_name_t                    name,
  int                           name_is_MN,
  gss_OID                       *MN_mech,
  gss_buffer_set_t              *attrs
);
</pre></div>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.3"></a><h3>7.3.&nbsp;
GSS_Get_name_attribute()</h3>

<p>Inputs: <br />
<br />
 </p>
<ul class="text">
<li>name NAME,
</li>
<li>attr STRING
</li>
</ul>

<p>Outputs: <br />
<br />
 </p>
<ul class="text">
<li>major_status INTEGER,
</li>
<li>minor_status INTEGER,
</li>
<li>authenticated BOOLEAN, -- TRUE iff authenticated by the trusted
            peer credential source.
</li>
<li>complete BOOLEAN -- TRUE iff this represents a complete set of
            values for the name.
</li>
<li>values SET OF OCTET STRING,
</li>
<li>display_values SET OF STRING
</li>
</ul>

<p>Return major_status codes: </p>
<ul class="text">
<li>GSS_S_COMPLETE indicates no error.
</li>
<li>GSS_S_UNAVAILABLE indicates that the given attribute OID is not
            known or set.
</li>
<li>GSS_S_FAILURE indicates a general error.
</li>
</ul>

<p>This function outputs the value(s) associated with a given GSS name
        object for a given name attribute.
</p>
<p>The complete flag denotes that (if TRUE) the set of values
        represents a complete set of values for this name. The peer being an
        authoritative source of information for this attribute is a sufficient
        condition for the complete flag to be set by the peer.
</p>
<p>In the federated case when several peers may hold some of the
        attributes about a name this flag may be highly dangerous and SHOULD
        NOT be used.
</p>
<p>NOTE: This function relies on the GSS-API notion of "SET OF"
        allowing for order preservation; this has been discussed on the KITTEN
        WG mailing list and the consensus seems to be that, indeed, that was
        always the intention. It should be noted however that the order
        presented does not always reflect an underlying order of the mechanism
        specific source of the attribute values.
</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.3.1"></a><h3>7.3.1.&nbsp;
C-Bindings</h3>

<p>The C-bindings of GSS_Get_name_attribute() requires one function
          call per-attribute value, for multi-valued name attributes. This is
          done by using a single gss_buffer_t for each value and an
          input/output integer parameter to distinguish initial and subsequent
          calls and to indicate when all values have been obtained.
</p>
<p>The 'more' input/output parameter should point to an integer
          variable whose value, on first call to gss_name_attribute_get() MUST
          be -1, and whose value upon function call return will be non-zero to
          indicate that additional values remain, or zero to indicate that no
          values remain. The caller should not modify this parameter after the
          initial call. The status of the complete and authenticated flags
          MUST NOT change between multiple calls to iterate over values for an
          attribute.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
OM_uint32 gss_get_name_attribute(
  OM_uint32                     *minor_status,
  gss_name_t                    name,
  gss_buffer_t                  attr,
  int                           *authenticated,
  int                           *complete,
  gss_buffer_t                  value,
  gss_buffer_t                  display_value,
  int                           *more
);
</pre></div>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.4"></a><h3>7.4.&nbsp;
GSS_Set_name_attribute()</h3>

<p>Inputs: <br />
<br />
 </p>
<ul class="text">
<li>name NAME,
</li>
<li>complete BOOLEAN, -- TRUE iff this represents a complete set of
            values for the name.
</li>
<li>attr STRING,
</li>
<li>values SET OF OCTET STRING
</li>
</ul>

<p>Outputs: <br />
<br />
 </p>
<ul class="text">
<li>major_status INTEGER,
</li>
<li>minor_status INTEGER
</li>
</ul>

<p>Return major_status codes: </p>
<ul class="text">
<li>GSS_S_COMPLETE indicates no error.
</li>
<li>GSS_S_UNAVAILABLE indicates that the given attribute OID is not
            known or could not be set.
</li>
<li>GSS_S_FAILURE indicates a general error.
</li>
</ul>

<p>The complete flag denotes that (if TRUE) the set of values
        represents a complete set of values for this name. The peer being an
        authoritative source of information for this attribute is a sufficient
        condition for the complete flag to be set by the peer.
</p>
<p>In the federated case when several peers may hold some of the
        attributes about a name this flag may be highly dangerous and SHOULD
        NOT be used.
</p>
<p>NOTE: This function relies on the GSS-API notion of "SET OF"
        allowing for order preservation; this has been discussed on the KITTEN
        WG mailing list and the consensus seems to be that, indeed, that was
        always the intention. It should be noted that underlying mechanisms
        may not respect the given order.
</p>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.4.1"></a><h3>7.4.1.&nbsp;
C-Bindings</h3>

<p>The C-bindings of GSS_Set_name_attribute() requires one function
          call per-attribute value, for multi-valued name attributes -- each
          call adds one value. To replace an attribute's every value delete
          the attribute's values first with GSS_Delete_name_attribute().
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
OM_uint32 gss_set_name_attribute(
  OM_uint32                     *minor_status,
  gss_name_t                    name,
  int                           complete,
  gss_buffer_t                  attr,
  gss_buffer_t                  value
);
</pre></div>
<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.5"></a><h3>7.5.&nbsp;
GSS_Delete_name_attribute()</h3>

<p>Inputs: <br />
<br />
 </p>
<ul class="text">
<li>name NAME,
</li>
<li>attr STRING,
</li>
</ul>

<p>Outputs: <br />
<br />
 </p>
<ul class="text">
<li>major_status INTEGER,
</li>
<li>minor_status INTEGER
</li>
</ul>

<p>Return major_status codes: </p>
<ul class="text">
<li>GSS_S_COMPLETE indicates no error.
</li>
<li>GSS_S_UNAVAILABLE indicates that the given attribute OID is not
            known.
</li>
<li>GSS_S_UNAUTHORIZED indicates that a forbidden delete operation
            was attempted eg deleting a negative attribute.
</li>
<li>GSS_S_FAILURE indicates a general error.
</li>
</ul>

<p>Deletion of negative authenticated attributes from NAME objects
        MUST NOT be allowed and must result in a GSS_S_UNAUTHORIZED.
</p>
<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.5.1"></a><h3>7.5.1.&nbsp;
C-Bindings</h3>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
OM_uint32 gss_delete_name_attribute(
  OM_uint32                     *minor_status,
  gss_name_t                    name,
  gss_buffer_t                  attr
);
</pre></div>
<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.6"></a><h3>7.6.&nbsp;
GSS_Export_name_composite()</h3>

<p>Inputs: <br />
<br />
 </p>
<ul class="text">
<li>name NAME
</li>
</ul>

<p>Outputs: <br />
<br />
 </p>
<ul class="text">
<li>major_status INTEGER,
</li>
<li>minor_status INTEGER,
</li>
<li>exp_composite_name OCTET STRING
</li>
</ul>

<p>Return major_status codes: </p>
<ul class="text">
<li>GSS_S_COMPLETE indicates no error.
</li>
<li>GSS_S_FAILURE indicates a general error.
</li>
</ul>

<p>This function outputs a token which can be imported with
        GSS_Import_name(), using GSS_C_NT_COMPOSITE_EXPORT as the name type
        and which preserves any name attribute information associated with the
        input name (which GSS_Export_name() may well not). The token format is
        no specified here as this facility is intended for inter-process
        communication only; however, all such tokens MUST start with a
        two-octet token ID, hex 04 02, in network byte order.
</p>
<p>The OID for GSS_C_NT_COMPOSITE_EXPORT is &lt;TBD&gt;.
</p>
<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.6.1"></a><h3>7.6.1.&nbsp;
C-Bindings</h3>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
OM_uint32 gss_export_name_composite(
  OM_uint32                     *minor_status,
  gss_name_t                    name,
  gss_buffer_t                  exp_composite_name
);
</pre></div>
<a name="anchor25"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
IANA Considerations</h3>

<p>This document creates a namespace of GSS-API name attributes.
      Attributes are named by URIs, so no single authority is technically
      needed for allocation. However future deployment experience may indicate
      the need for an IANA registry for URIs used to reference names specified
      by IETF standards. It is expected that this will be a registry of URNs
      but this document provides no further guidance on this registry.
</p>
<a name="anchor26"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Security Considerations</h3>

<p>This document extends the GSS-API naming model to include support for
      name attributes. The intention is that name attributes are to be used as
      a basis for (among other things) authorization decisions or
      personalization for applications relying on GSS-API security
      contexts.
</p>
<p>The security of the application may be critically dependent on the
      security of the attributes. This document classifies attributes as
      asserted or authenticated. Asserted (non-authenticated) attributes MUST
      NOT be used if the attribute has security implications for the
      application (eg authorization decisions) since asserted attributes may
      easily be controlled by the peer directly.
</p>
<p>It is important to understand the meaning of 'authenticated' in this
      setting. Authenticated does not imply that any semantic of the attribute
      is claimed to be true. The only implication is that a trusted third
      party has asserted the attribute as opposed to the attribute being
      asserte by the peer itself. Any additional semantics is always the
      result of applying policy. For instance in a given deployment the mail
      attribute of the subject may be authenticated and sourced from an email
      system where 'authoritive' values are kept. In another situations users
      may be allowed to modify their mail addresses freely. In both cases the
      'mail' attribute may be authenticated by virtue of being included in
      signed SAML attribute assertions or by other means authenticated by the
      underlying mechanism.
</p>
<p>When the underlying security mechanism does not provide a permanent
      unique identity (eg anonymous kerberos) the GSS-API naming extensions
      may be used to provide a replacement permanent unique identity attribute
      which in this case may be unique for each peer party. This is analogous
      to the SAML permanentIdentifier attribute and has comparable security
      and privacy properties and implications.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>10.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="GFD.024">[GFD.024]</a></td>
<td class="author-text">Argonne National Laboratory, <a href="mailto:">National Center for Supercomputing
            Applications</a>, <a href="mailto:">Argonne National Laboratory</a>, and <a href="mailto:">Argonne National Laboratory</a>, &ldquo;<a href="http://www.ggf.org/documents/GFD.24.pdf">GSS-API Extensions</a>,&rdquo; GFD&nbsp;GFD.024, June&nbsp;2004.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2025">[RFC2025]</a></td>
<td class="author-text"><a href="mailto:cadams@bnr.ca">Adams, C.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2025">The Simple Public-Key GSS-API Mechanism (SPKM)</a>,&rdquo; RFC&nbsp;2025, October&nbsp;1996 (<a href="http://www.rfc-editor.org/rfc/rfc2025.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2743">[RFC2743]</a></td>
<td class="author-text"><a href="mailto:jlinn@rsasecurity.com">Linn, J.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2743">Generic Security Service Application Program Interface Version 2, Update 1</a>,&rdquo; RFC&nbsp;2743, January&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2743.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2744">[RFC2744]</a></td>
<td class="author-text"><a href="mailto:John_Wray@Iris.com">Wray, J.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2744">Generic Security Service API Version 2 : C-bindings</a>,&rdquo; RFC&nbsp;2744, January&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2744.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4120">[RFC4120]</a></td>
<td class="author-text">Neuman, C., Yu, T., Hartman, S., and K. Raeburn, &ldquo;<a href="http://tools.ietf.org/html/rfc4120">The Kerberos Network Authentication Service (V5)</a>,&rdquo; RFC&nbsp;4120, July&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4120.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5280">[RFC5280]</a></td>
<td class="author-text">Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;<a href="http://tools.ietf.org/html/rfc5280">Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>,&rdquo; RFC&nbsp;5280, May&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5280.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>10.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC3061">[RFC3061]</a></td>
<td class="author-text">Mealling, M., &ldquo;<a href="http://tools.ietf.org/html/rfc3061">A URN Namespace of Object Identifiers</a>,&rdquo; RFC&nbsp;3061, February&nbsp;2001 (<a href="http://www.rfc-editor.org/rfc/rfc3061.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4768">[RFC4768]</a></td>
<td class="author-text">Hartman, S., &ldquo;<a href="http://tools.ietf.org/html/rfc4768">Desired Enhancements to Generic Security Services Application Program Interface (GSS-API) Version 3 Naming</a>,&rdquo; RFC&nbsp;4768, December&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4768.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Nicolas      Williams</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Sun Microsystems</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">5300 Riata Trace Ct</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Austin, TX  78727</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:Nicolas.Williams@sun.com">Nicolas.Williams@sun.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Leif Johansson</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Swedish University Network</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Thulegatan 11</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Stockholm</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Sweden</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:leifj@sunet.se">leifj@sunet.se</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.sunet.se">http://www.sunet.se</a></td></tr>
</table>
</body></html>
