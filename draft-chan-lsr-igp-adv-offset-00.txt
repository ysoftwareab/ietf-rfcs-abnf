 
LSR Working Group                                               Louis Chan 
INTERNET-DRAFT                                                  Krzysztof Szarkowicz 
Intended status: Standard Track                                 Juniper Networks 
Expires: Sep 6, 2022                                            Mar 6, 2022 
                                    
 
              IGP extensions for Advertising Offset for Flex-Algorithm 
                      draft-chan-lsr-igp-adv-offset-00.txt 


Abstract 

   This document describes the IGP extensions to provide predictable Adjacency-SIDs 
   per Flex-Algorithm [FLEXALGO] in segment routing. 

   We propose some methods to allow the advertisement of additional TLV in IGP so that 
   the Flex-Algorithm specific Adjacency-SIDs could be automatically derived. 

   With the proposed method, the size of advertisement on per node per link basis is 
   greatly reduced. Each participating router would derive the required labels 
   automatically. 

   Extensions for offset to derive Flex-Algorithm Prefix-SID is also included in the 
   document. 

Status of this Memo 

   This Internet-Draft is submitted in full conformance with the provisions of BCP 78 
   and BCP 79. 

   Internet-Drafts are working documents of the Internet Engineering Task Force 
   (IETF).  Note that other groups may also distribute working documents as Internet-
   Drafts.  The list of current Internet-Drafts is at 
   http://datatracker.ietf.org/drafts/current/. 

   Internet-Drafts are draft documents valid for a maximum of six months and may be 
   updated, replaced, or obsoleted by other documents at any time.  It is 
   inappropriate to use Internet-Drafts as reference material or to cite them other 
   than as "work in progress." 

   This Internet-Draft will expire on Sep 6, 2022. 

Copyright Notice 

   Copyright (c) 2017 IETF Trust and the persons identified as the document authors.  
   All rights reserved. 

 

   This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating 
   to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of 
   publication of this document.  Please review these documents carefully, as they 
   describe your rights and restrictions with respect to this document.  Code 
   Components extracted from this document must include Simplified BSD License text as 
 
 
Chan                       Expires Sep 6, 2022                     [Page 1] 

                                             
											 
Internet-Draft          draft-chan-lsr-igp-adv-offset-00               March 2022 
 
   described in Section 4.e of the Trust Legal Provisions and are provided without 
   warranty as described in the Simplified BSD License. 

 

Table of Contents 

    
   1. Introduction...................................................2 
   2. Conventions used in this document..............................2 
   3. ISIS extension.................................................2 
      3.1. Algorithm Offset for Adj-SID..............................3 
      3.2. Algorithm Offset for LAN based Adj-SID....................4 
      3.3. Algorithm Offset for Prefix SID...........................5 
   4. Compatibility..................................................6 
   5. OSPF extension.................................................6 
   6. Security Consideration.........................................6 
   7. References.....................................................7 
      7.1. Normative References......................................7 
      7.2. Informative References....................................7 
   8. Acknowledgments................................................7 
    
1. Introduction 

    
   The draft proposes methods for routers to announce Flex-Algorithm specific 
   Adjacency-SID with minimal advertisement in IGP. When the other routers need a SR 
   policy (aka SR-TE) or TI-LFA path, the Flex-Algorithm specific Adjacency-SID would 
   be taken into the path label construction. 

   Hence, the top most label, either node or link related, in a SR policy stack would 
   be used to identify a certain Flex-Algo with full identification. 

    

2. Conventions used in this document 

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", 
   "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be 
   interpreted as described in RFC 2119 [RFC2119].  

   In this document, these words will appear with that interpretation only when in ALL 
   CAPS. Lower case uses of these words are not to be interpreted as carrying 
   significance described in RFC 2119. 

 

    

3. ISIS extension 

   With reference to RFC8667, the information could be advertised in SR-Capabilities 
   sub-TLV in Section 3. 
Chan                       Expires Sep 6, 2022                     [Page 2] 
   

                                             
											 											 
Internet-Draft          draft-chan-lsr-igp-adv-offset-00               March 2022 
 
3.1. Algorithm Offset for Adj-SID 

    

    0                   1                   2                   3          
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
   |   Type        |     Length    |   Flags       |    Algorithm  | 
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
   |   SID/Label   |      Base offset/Index offset (variable)      ~           
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
    
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
   ~           Flags/ Algo/ Base offset/ Index offset             ~         
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
    

   where: 
    
   Type:                TDB 
    
   Length:              variable; multiple advertisements  
    
   Flags:               1 octet field of the following flags: 
    
                         0 1 2 3 4 5 6 7 
                        +-+-+-+-+-+-+-+-+ 
                        | |B|V|L|       | 
                        +-+-+-+-+-+-+-+-+ 
    
                  where: 
    
                  B-Flag:  Backup Flag.  If set, the Adj-SID is eligible 
                           for protection (e.g., using IP Fast Reroute 
                           (IPFRR) or MPLS Fast Reroute (MPLS-FRR)) as 
                           described in [RFC8402]. 
    
    
                  V-Flag:  Value Flag.  If set, then it carries 
                           a label value. If not set, it is an index value. 
    
                  L-Flag:  Local Flag.  Always set to 1 
    
     
   Algorithm:              1 octet 
                           Flex-Algo value is between 128 and 255.                    
    
   Base Offset:            3 octets 
                           Local label base for Adjacency-SIDs for given Flex- 
                           Algorithm. The derived Adjacency-SID is the sum of the base  
                           offset and the Algo 0 label 
    
   Index Offset:           4 octets 
                           If Adjacency-SID is advertised as index, this provides an  

Chan                       Expires Sep 6, 2022                     [Page 3] 
    

                                             
											 
Internet-Draft          draft-chan-lsr-igp-adv-offset-00               March 2022 
 
                           offset index value. The new label is sum of (SRGB base +  
                           index + index offset) 
    
   The format of Base Offset and Index Offset is the same as RFC8667. The choice of 
   advertising Base Offset or Index Offset must match the advertisement of original 
   Adjacency-SID method from the same router. 
    
3.2. Algorithm Offset for LAN based Adj-SID 

    
       0                   1                   2                   3 
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
      |   Type        |     Length    |      Flags    |   Algorithm   | 
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
      |                  Neighbor System-ID (ID length octets)        | 
      +                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
      |                               | 
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
      |        SID/Label Base Offset/Index Offset (variable)          ~ 
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
      ~    Flags/ Algo/NB Sys-ID/ SID/Label/Index Offset (variable)   ~ 
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
    

   where: 
    
   Type:                TDB 
    
   Length:              variable; multiple advertisements  
    
   Flags:               1 octet field of the following flags: 
    
                         0 1 2 3 4 5 6 7 
                        +-+-+-+-+-+-+-+-+ 
                        | |B|V|L|       | 
                        +-+-+-+-+-+-+-+-+ 
    
                  where: 
    
                  B-Flag:  Backup Flag.  If set, the Adj-SID is eligible 
                           for protection (e.g., using IP Fast Reroute 
                           (IPFRR) or MPLS Fast Reroute (MPLS-FRR)) as 
                           described in [RFC8402]. 
    
                  V-Flag:  Value Flag.  If set, then it carries 
                           a label value. If not set, it is an index value. 
    
                  L-Flag:  Local Flag.  Always set to 1 
     
   Algorithm:              1 octet. Same as Section 5.1 

Chan                       Expires Sep 6, 2022                     [Page 4] 
    

                                             
											 
Internet-Draft          draft-chan-lsr-igp-adv-offset-00               March 2022 
 
    
   Neighbor System-ID:     IS-IS System-ID of length "ID Length" as 
                           defined in [ISO10589]. 
    

   Base Offset:            3 octets. Same as Section 5.1 
    
   Index Offset:           4 octets. Same as Section 5.1 
    
    
3.3. Algorithm Offset for Prefix SID  

   Prefix-SID for Algorithm could also be generated by adding an index offset value or 
   a base offset for label. 
    
   This advertisement is an sub-TLV in RFC8667 Section 2. 
    
   0                   1                   2                   3          
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
   |   Type        |     Length    |   Flags       |    Algorithm  | 
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
   |        SID/Label Base offset/ Index offset                    ~  
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+      
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
   ~      Flags/ Algorithm/ Base Offset/ Index offset             ~         
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
    
    
    
   Type:                TDB 
    
   Length:              variable  
    
   Flags:               1 octet field of the following flags: 
    
                         0 1 2 3 4 5 6 7 
                        +-+-+-+-+-+-+-+-+ 
                        |R|N|   |V|L|   | 
                        +-+-+-+-+-+-+-+-+ 
    
                  where: 
    
                  R-Flag:  Re-advertisement Flag.  If set, then the prefix 
                           to which this Prefix-SID is attached has been 
                           propagated by the router from either another 
                           level (i.e., from Level-1 to Level-2 or the 
                           opposite) or redistribution (e.g., from another 
                           protocol). 
    
                  N-Flag:  Node-SID Flag.  If set, then the Prefix-SID 
                           refers to the router identified by the prefix. 
                           Typically, the N-Flag is set on Prefix-SIDs that 
                           are attached to a router loopback address.  The 

Chan                       Expires Sep 6, 2022                     [Page 5] 
    
                                             
											 
Internet-Draft          draft-chan-lsr-igp-adv-offset-00               March 2022 
 
                           N-Flag is set when the Prefix-SID is a Node-SID 
                           as described in [RFC8402]. 
    
    
                  V-Flag:  Value Flag.  If set, then it carries 
                           a label value. If not set, it is an index value. 
    
                  L-Flag:  Local Flag.  Always set to 0 
    
   Algorithm:              1 octet 
                           Flex-Algo value is between 128 and 255 
     
    
   Base offset:            3 octets 
                           Label base for Prefix-SIDs for given Algorithm 
                           The derived Prefix-SID is the sum of the base  
                           Offset and the Algo 0 label 
    
   Index Offset:           4 octets 
                           Index offset counting from Algo 0 
                           The new label for Prefix is sum of (SRGB base +  
                           index + index offset) 
    
   The format of Base offset and Index Offset is the same as RFC8667. The choice of 
   advertising Base Offset or Index Offset MUST match the advertisement of original 
   Prefix-SID method from the same router. 
    
4. Compatibility 

   For nodes that do not support Algorithm Offset for Adj-SID extension, the label 
   stack could use normal Adj-SID, providing that the node still supports Flex-Algo 
   Prefix SID. 

   For TI-LFA, there would be two modes of operation - loose or strict. For strict 
   mode, all Adj-SID involved in TI-LFA candidate path must be derived with offset 
   method. 

   For loose mode, Adj-SID in the TI-LFA candidate path could be a mix of Adj-SID's 
   with and without offset. This allows backward compatibility with routers which only 
   support Flex-Algo. 

    
    
5. OSPF extension 

   TBD 

    

    

6. Security Consideration 

   TBD 

Chan                       Expires Sep 6, 2022                     [Page 6] 
    

                                             
											 
Internet-Draft          draft-chan-lsr-igp-adv-offset-00               March 2022 
 
7. References 

7.1. Normative References 

   [RFC2119]     Bradner, S., "Key words for use in RFCs to Indicate Requirement Levels", 
                 BCP 14, RFC 2119, March 1997. 

7.2. Informative References 

   [RFC8667]     Previdi, S., Ed., Ginsberg, L., Ed., Filsfils, C., 
                 Bashandy, A., Gredler, H., and B. Decraene, "IS-IS 
                 Extensions for Segment Routing", RFC 8667, 
                 DOI 10.17487/RFC8667, December 2019, 
                 <https://www.rfc-editor.org/info/rfc8667>. 
               
          
   [TI-LFA]      Litkowski, S., Bashandy, A., Filsfils, C., Francois, P., 
                 Decraene, B., and D. Voyer, "Topology Independent Fast 
                 Reroute using Segment Routing",  
                 <https://datatracker.ietf.org/doc/html/draft-ietf-rtgwg-segment- 
                 routing-ti-lfa> 
    
   [FLEXAGLO]    S. Hegde, P. Psenak and etc, IGP Flexible Algorithm 
                 https://datatracker.ietf.org/doc/draft-ietf-lsr-flex-algo 
    
    
   [ISO10589]    International Organization for Standardization, 
                 "Information technology -- Telecommunications and 
                 information exchange between systems -- Intermediate 
                 system to Intermediate system intra-domain routeing 
                 information exchange protocol for use in conjunction with 
                 the protocol for providing the connectionless-mode network 
                 service (ISO 8473)", ISO/IEC 10589:2002, Second Edition, 
                 November 2002. 
    
             

8. Acknowledgments 

      
        The following people have contributed to this document: 
               Shraddha Hegde, Juniper Networks 
         
      
      
     Author Address 
      
     Louis Chan  
        Juniper Networks 
        2604, Cityplaza One, 1111 King's Road 
        Taikoo Shing 
        Hong Kong 
      
        Phone: +852-25876659 
Chan                       Expires Sep 6, 2022                     [Page 7] 
   

                                             
											 
Internet-Draft          draft-chan-lsr-igp-adv-offset-00               March 2022 
 
        Email: louisc@juniper.net 
      
      
     Krzysztof Grzegorz Szarkowicz 
        Juniper Networks 
        Parkring 10 
        A-1010 Wien 
        Austria 
      
        Phone: +49 89 203012127 
        Email: kszarkowicz@juniper.net 

    









































Chan                       Expires Sep 6, 2022                     [Page 8] 
 