



Network Working Group                                          A. Morton
Internet-Draft                                                 AT&T Labs
Updates: 2544 (if approved)                             October 30, 2017
Intended status: Informational
Expires: May 3, 2018


        Updates for the Back-to-back Frame Benchmark in RFC 2544
                     draft-morton-bmwg-b2b-frame-00

Abstract

   Fundamental Benchmarking Methodologies for Network Interconnect
   Devices of interest to the IETF are defined in RFC 2544.  This memo
   updates the provisions of the test to measure the Back-to-back frames
   Benchmark of RFC 2544, based on further experience.

   This memo updates Section 26.4 of RFC 2544.

Requirements Language

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in RFC 2119 [RFC2119].

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on May 3, 2018.

Copyright Notice

   Copyright (c) 2017 IETF Trust and the persons identified as the
   document authors.  All rights reserved.





Morton                     Expires May 3, 2018                  [Page 1]

Internet-Draft              B2B Frame Update                October 2017


   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (https://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
   2.  Scope and Goals . . . . . . . . . . . . . . . . . . . . . . .   3
   3.  Motivation  . . . . . . . . . . . . . . . . . . . . . . . . .   3
   4.  Pre-Requisites  . . . . . . . . . . . . . . . . . . . . . . .   4
   5.  Back-to-back Frames . . . . . . . . . . . . . . . . . . . . .   5
     5.1.  Preparing the list of Frame sizes . . . . . . . . . . . .   5
     5.2.  Test for a Single Frame Size  . . . . . . . . . . . . . .   5
     5.3.  Test Repetition . . . . . . . . . . . . . . . . . . . . .   6
     5.4.  Benchmark Calculations  . . . . . . . . . . . . . . . . .   6
   6.  Reporting . . . . . . . . . . . . . . . . . . . . . . . . . .   6
   7.  Security Considerations . . . . . . . . . . . . . . . . . . .   7
   8.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .   8
   9.  Acknowledgements  . . . . . . . . . . . . . . . . . . . . . .   8
   10. References  . . . . . . . . . . . . . . . . . . . . . . . . .   8
     10.1.  Normative References . . . . . . . . . . . . . . . . . .   8
     10.2.  Informative References . . . . . . . . . . . . . . . . .   9
   Author's Address  . . . . . . . . . . . . . . . . . . . . . . . .   9

1.  Introduction

   The IETF's fundamental Benchmarking Methodologies are defined
   in[RFC2544], supported by the terms and definitions in [RFC1242], and
   [RFC2544] actually obsoletes an earlier specification, [RFC1944].
   Over time, the benchmarking community has updated [RFC2544] several
   times, including the Device Reset Benchmark [RFC6201], and the
   important Applicability Statement [RFC6815] concerning use outside
   the Isolated Test Environment (ITE) required for accurate
   benchmarking.  Other specifications implicitly update [RFC2544], such
   as the IPv6 Benchmarking Methodologies in [RFC5180].

   Recent testing experience with the Back-to-back Frame test and
   Benchmark in Section 26.4 of [RFC2544] indicates that an update is
   warranted [OPNFV-2017] [VSPERF-b2b].  This memo describes the
   rationale and provides the updated method.





Morton                     Expires May 3, 2018                  [Page 2]

Internet-Draft              B2B Frame Update                October 2017


   [RFC2544] provides its own Requirements Language consistent with
   [RFC2119], since [RFC1944] predates [RFC2119].  Thus, the
   requirements presented in this memo are expressed in [RFC2119] terms,
   and intended for those performing/reporting laboratory tests to
   improve clarity and repeatability, and for those designing devices
   that facilitate these tests.

2.  Scope and Goals

   The scope of this memo is to define an updated method to
   unambiguously perform tests, measure the benchmark(s), and report the
   results for Back-to-back Frames (presently described Section 26.4 of
   [RFC2544]).

   The goal is to provide more efficient test procedures where possible,
   and to expand reporting with additional interpretation of the
   results.

   [RFC2544] Benchmarks rely on test conditions with constant frame
   sizes, with the goal of understanding what network device capability
   has been tested.  Tests with the smallest size stress the header
   processing capacity, and tests with the largest size stress the
   overall bit processing capacity.  Tests with sizes in-between may
   determine the transition between these two capacities.  However,
   conditions simultaneously sending multiple frame sizes, such as those
   described in [RFC6985], MUST NOT be used in Back-to-back Frame
   testing.

3.  Motivation

   Section 3.1 of [RFC1242] describes the rationale for the Back-to-back
   Frames Benchmark.  To summarize, there are several reasons that
   devices on a network produce bursts of frames at the minimum allowed
   spacing, and it is therefore worthwhile to understand the Device
   Under Test (DUT) limit on the length of such bursts in practice.
   Also, [RFC1242] states:

          "Tests of this parameter are intended to determine the extent
          of data buffering in the device."

   After this test was defined, there have been occasional discussions
   of the stability and repeatability of the results, both over time and
   across labs.  Fortunately, the Open Platform for Network Function
   Virtualization (OPNFV) VSPERF project's Continuous Integration (CI)
   testing routinely repeats Back-to-back Frame tests to verify that
   test functionality has been maintained through development of the
   test control programs.  These tests were used as a basis to evaluate




Morton                     Expires May 3, 2018                  [Page 3]

Internet-Draft              B2B Frame Update                October 2017


   stability and repeatability, even across lab set-ups when the test
   platform was migrated to new DUT hardware at the end of 2016.

   When the VSPERF CI results were examined [VSPERF-b2b], several
   aspects of the results were considered notable:

   1.  Back-to-back Frame Benchmark was very consistent for some fixed
       frame sizes, and somewhat variable for others.

   2.  The Back-to-back Frame length reported for large frame sizes was
       unexpectedly long, and no explanation or measurement limit
       condition was indicated.

   3.  Calculation of the extent of buffer time in the DUT helped
       explain the results with all frame sizes (some frame sizes cannot
       exceed the frame header processing rate of the DUT, and therefore
       no buffering occurs).

   4.  It was observed that the actual buffer time in the DUT could be
       estimated using results from the Throughput tests conducted
       according to Section 26.1 of [RFC2544].

   Further, if the Throughput tests of Section 26.1 of [RFC2544] are
   conducted as a pre-requiste test, the number of frame sizes required
   for Back-to-back Frame Benchmarking can be reduced to one or more of
   the small frame sizes, or results for large frame sizes can be noted
   as invalid in the results.

   [VSPERF-b2b] provides the details of the calculation to estimate the
   actual buffer time available in the DUT, using results from the
   Throughput tests for each frame size, and the maximum theoretical
   frame rate for the DUT links (which constrain the minimum frame
   spacing).

4.  Pre-Requisites

   The Test Setup MUST be consistent with Figure 1 of [RFC2544], or
   Figure 2 when the tester's sender and reciver are different devices.
   Other mandatory testing aspects described in [RFC2544] MUST be
   included, unless explicitly modified in the next section.

   The ingress and egress link speeds and link layer protocols MUST be
   specified and used to compute the maximum theoretical frame rate when
   respecting the minimum inter-frame gap.

   The test results for the Throughput Benchmark conducted according to
   Section 26.1 of [RFC2544] for all [RFC2544]-RECOMMENDED frame sizes
   MUST be available to reduce the tested frame size list, or to note



Morton                     Expires May 3, 2018                  [Page 4]

Internet-Draft              B2B Frame Update                October 2017


   invalid results for individual frame sizes (because the burst length
   may be infinite for large frame sizes).

   Note that:

   o  the Throughput and the Back-to-back Frame measurement
      configuration traffic characteristics (unidirectional or bi-
      directional) MUST match.

   o  the Throughput measurement MUST be under zero-loss conditions,
      according to Section 26.1 of [RFC2544].

   The Back-to-back Benchmark described in Section 3.1 of [RFC1242] MUST
   be measured directly by the tester.  Additional measurement
   reuirements are described below in Section 5.

5.  Back-to-back Frames

   Objective: To characterize the ability of a DUT to process back-to-
   back frames as defined in [RFC1242].

   The Procedure follows.

5.1.  Preparing the list of Frame sizes

   From the list of RECOMMENDED Frame sizes (Section 9 of [RFC2544]),
   select the subset of Frame sizes whose measured Throughput was less
   than the maximum theoretical Frame Rate.  Only these Frame sizes make
   it possible to produce a burst of frames that cause the DUT buffers
   to fill and eventually overflow, producing one or more discarded
   frames.

5.2.  Test for a Single Frame Size

   Each trial in the test requires the tester to send a burst of frames
   (after idle time) with the minimum inter-frame gap, and to count the
   frames forwarded by the DUT.

   The duration of the trial MUST be at least 2 seconds, to allow DUT
   buffers to deplete.

   If all frames have been received, the tester increases the length of
   the burst and performs another trial.

   If the received frame count is less than the number of frames in the
   burst, then the limit of DUT processing and buffering may have been
   exceeded, and the burst length is reduced for the next trial.




Morton                     Expires May 3, 2018                  [Page 5]

Internet-Draft              B2B Frame Update                October 2017


   @@@@ Should a particular search algorithm be included?

   The Back-to-back Frame value is the longest burst of frames that the
   DUT can successfully process and buffer without frame loss, as
   determined from the series of trials.  The tester may impose a
   (configurable) minimum step size for burst length, and the step size
   MUST be reported with the results (as this influences the accuracy
   and variation of test results).

5.3.  Test Repetition

   The test MUST be repeated N times for each frame size in the subset
   list, and each Back-to-back Frame value made available for further
   processing (below).

5.4.  Benchmark Calculations

   For each Frame size, calculate the following summary statistics for
   Back-to-back Frame values over the N tests:

   o  Average (Benchmark)

   o  Minimum

   o  Maximum

   o  Standard Deviation

   Further, calculate the Implied DUT Buffer Time and the Corrected DUT
   Buffer Time in seconds, as follows:

   Implied DUT Buffer Time =

      Average Back-to-back Frames / Max Theoretical Frame Rate

   Corrected DUT Buffer Time =

                                  Measured Throughput
      Implied DUT Buffer Time * --------------------------
                                Max Theoretical Frame Rate

6.  Reporting

   The back-to-back results SHOULD be reported in the format of a table
   with a row for each of the tested frame sizes.  There SHOULD be
   columns for the frame size and for the resultant average frame count
   for each type of data stream tested.




Morton                     Expires May 3, 2018                  [Page 6]

Internet-Draft              B2B Frame Update                October 2017


   The number of tests Averaged for the Benchmark, N, MUST be reported.

   The Minimum, Maximum, and Standard Deviation across all complete
   tests SHOULD also be reported.

   The Corrected DUT Buffer Time SHOULD also be reported.

   If the tester operates using a maximum burst length in frames, then
   this maximum length SHOULD be reported.

   +--------------+----------------+----------------+------------------+
   | Frame Size,  | Ave B2B        | Min,Max,StdDev | Corrected Buff   |
   | octets       | Length, frames |                | Time, Sec        |
   +--------------+----------------+----------------+------------------+
   | 64           | 26000          | 25500,27000,20 | 0.00004          |
   +--------------+----------------+----------------+------------------+

                        Back-to-Back Frame Results

   Static and configuration parameters:

   Number of test repetitions, N

   Minimum Step Size (during searches), in frames.

7.  Security Considerations

   Benchmarking activities as described in this memo are limited to
   technology characterization using controlled stimuli in a laboratory
   environment, with dedicated address space and the other constraints
   [RFC2544].

   The benchmarking network topology will be an independent test setup
   and MUST NOT be connected to devices that may forward the test
   traffic into a production network, or misroute traffic to the test
   management network.

   Further, benchmarking is performed on a "black-box" basis, relying
   solely on measurements observable external to the DUT/SUT.

   Special capabilities SHOULD NOT exist in the DUT/SUT specifically for
   benchmarking purposes.  Any implications for network security arising
   from the DUT/SUT SHOULD be identical in the lab and in production
   networks.







Morton                     Expires May 3, 2018                  [Page 7]

Internet-Draft              B2B Frame Update                October 2017


8.  IANA Considerations

   This memo makes no requests of IANA.

9.  Acknowledgements

   Thanks to Trevor Cooper, Sridhar Rao, and Martin Klozik of the VSPERF
   project for many contributions to the testing [VSPERF-b2b].

10.  References

10.1.  Normative References

   [RFC1242]  Bradner, S., "Benchmarking Terminology for Network
              Interconnection Devices", RFC 1242, DOI 10.17487/RFC1242,
              July 1991, <https://www.rfc-editor.org/info/rfc1242>.

   [RFC1944]  Bradner, S. and J. McQuaid, "Benchmarking Methodology for
              Network Interconnect Devices", RFC 1944,
              DOI 10.17487/RFC1944, May 1996,
              <https://www.rfc-editor.org/info/rfc1944>.

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <https://www.rfc-editor.org/info/rfc2119>.

   [RFC2544]  Bradner, S. and J. McQuaid, "Benchmarking Methodology for
              Network Interconnect Devices", RFC 2544,
              DOI 10.17487/RFC2544, March 1999,
              <https://www.rfc-editor.org/info/rfc2544>.

   [RFC5180]  Popoviciu, C., Hamza, A., Van de Velde, G., and D.
              Dugatkin, "IPv6 Benchmarking Methodology for Network
              Interconnect Devices", RFC 5180, DOI 10.17487/RFC5180, May
              2008, <https://www.rfc-editor.org/info/rfc5180>.

   [RFC6201]  Asati, R., Pignataro, C., Calabria, F., and C. Olvera,
              "Device Reset Characterization", RFC 6201,
              DOI 10.17487/RFC6201, March 2011,
              <https://www.rfc-editor.org/info/rfc6201>.

   [RFC6815]  Bradner, S., Dubray, K., McQuaid, J., and A. Morton,
              "Applicability Statement for RFC 2544: Use on Production
              Networks Considered Harmful", RFC 6815,
              DOI 10.17487/RFC6815, November 2012,
              <https://www.rfc-editor.org/info/rfc6815>.




Morton                     Expires May 3, 2018                  [Page 8]

Internet-Draft              B2B Frame Update                October 2017


   [RFC6985]  Morton, A., "IMIX Genome: Specification of Variable Packet
              Sizes for Additional Testing", RFC 6985,
              DOI 10.17487/RFC6985, July 2013,
              <https://www.rfc-editor.org/info/rfc6985>.

10.2.  Informative References

   [OPNFV-2017]
              Cooper, T., "Dataplane Performance, Capacity, and
              Benchmarking in OPNFV", June 2017.

   [VSPERF-b2b]
              Morton, A., "Back2Back Testing Time Series (from CI)",
              June 2017.

Author's Address

   Al Morton
   AT&T Labs
   200 Laurel Avenue South
   Middletown,, NJ  07748
   USA

   Phone: +1 732 420 1571
   Fax:   +1 732 368 1192
   Email: acmorton@att.com

























Morton                     Expires May 3, 2018                  [Page 9]
