<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Lightweight Certificate Management Protocol (CMP) Profile</title>
<meta content="Hendrik Brockhaus" name="author">
<meta content="David von Oheimb" name="author">
<meta content="Steffen Fries" name="author">
<meta content="
       This document aims at simple, interoperable, and automated PKI management operations covering typical use cases of industrial and IoT scenarios.  This is achieved by profiling the Certificate Management Protocol (CMP), the related Certificate Request Message Format (CRMF), and HTTP-based or CoAP-based transfer in a succinct but sufficiently detailed and self-contained way.  To make secure certificate management for simple scenarios and constrained devices as lightweight as possible, only the most crucial types of operations and options are specified as mandatory.  More special and complex use cases are supported as well, by features specified as recommended or optional. 
    " name="description">
<meta content="xml2rfc 3.12.0" name="generator">
<meta content="CMP" name="keyword">
<meta content="draft-ietf-lamps-lightweight-cmp-profile-10" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.12.0
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.7.1
    pycountry 22.1.10
    pyflakes 2.4.0
    PyYAML 6.0
    requests 2.27.1
    setuptools 59.6.0
    six 1.16.0
    WeasyPrint 52.5
-->
<link href="/tmp/draft-ietf-lamps-lightweight-cmp-profile-10-vdrrwgiq.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Lightweight CMP Profile</td>
<td class="right">February 2022</td>
</tr></thead>
<tfoot><tr>
<td class="left">Brockhaus, et al.</td>
<td class="center">Expires 5 August 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">LAMPS Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-lamps-lightweight-cmp-profile-10</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2022-02-01" class="published">1 February 2022</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-08-05">5 August 2022</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">H. Brockhaus, <span class="editor">Ed.</span>
</div>
<div class="org">Siemens</div>
</div>
<div class="author">
      <div class="author-name">D. von Oheimb</div>
<div class="org">Siemens</div>
</div>
<div class="author">
      <div class="author-name">S. Fries</div>
<div class="org">Siemens</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Lightweight Certificate Management Protocol (CMP) Profile</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document aims at simple, interoperable, and automated PKI management operations covering typical use cases of industrial and IoT scenarios.  This is achieved by profiling the Certificate Management Protocol (CMP), the related Certificate Request Message Format (CRMF), and HTTP-based or CoAP-based transfer in a succinct but sufficiently detailed and self-contained way.  To make secure certificate management for simple scenarios and constrained devices as lightweight as possible, only the most crucial types of operations and options are specified as mandatory.  More special and complex use cases are supported as well, by features specified as recommended or optional.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 5 August 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2022 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-how-to-read-this-document" class="xref">How to Read This Document</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="xref">1.2</a>.  <a href="#name-motivation-for-a-lightweigh" class="xref">Motivation for a lightweight profile of CMP</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.3">
                <p id="section-toc.1-1.1.2.3.1" class="keepWithNext"><a href="#section-1.3" class="xref">1.3</a>.  <a href="#name-special-requirements-of-ind" class="xref">Special requirements of industrial and IoT scenarios</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.4">
                <p id="section-toc.1-1.1.2.4.1"><a href="#section-1.4" class="xref">1.4</a>.  <a href="#name-existing-cmp-profiles" class="xref">Existing CMP profiles</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.5">
                <p id="section-toc.1-1.1.2.5.1"><a href="#section-1.5" class="xref">1.5</a>.  <a href="#name-use-of-cmp-in-sztp-and-brsk" class="xref">Use of CMP in SZTP and BRSKI environments</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.6">
                <p id="section-toc.1-1.1.2.6.1"><a href="#section-1.6" class="xref">1.6</a>.  <a href="#name-compatibility-with-existing" class="xref">Compatibility with existing CMP profiles</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.7">
                <p id="section-toc.1-1.1.2.7.1"><a href="#section-1.7" class="xref">1.7</a>.  <a href="#name-scope-of-this-document" class="xref">Scope of this document</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.8">
                <p id="section-toc.1-1.1.2.8.1"><a href="#section-1.8" class="xref">1.8</a>.  <a href="#name-structure-of-this-document" class="xref">Structure of this document</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.9">
                <p id="section-toc.1-1.1.2.9.1"><a href="#section-1.9" class="xref">1.9</a>.  <a href="#name-convention-and-terminology" class="xref">Convention and Terminology</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-solution-architecture" class="xref">Solution architecture</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-generic-aspects-of-the-pki-" class="xref">Generic aspects of the PKI message</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-general-description-of-the-" class="xref">General description of the CMP message header</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-general-description-of-the-c" class="xref">General description of the CMP message protection</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-general-description-of-cmp-" class="xref">General description of CMP message extraCerts</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="xref">3.4</a>.  <a href="#name-generic-pki-management-oper" class="xref">Generic PKI management operation prerequisites</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="xref">3.5</a>.  <a href="#name-generic-validation-of-a-pki" class="xref">Generic validation of a PKI message</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6">
                <p id="section-toc.1-1.3.2.6.1"><a href="#section-3.6" class="xref">3.6</a>.  <a href="#name-error-handling" class="xref">Error handling</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6.2.1">
                    <p id="section-toc.1-1.3.2.6.2.1.1"><a href="#section-3.6.1" class="xref">3.6.1</a>.  <a href="#name-reporting-error-conditions-" class="xref">Reporting error conditions upstream</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6.2.2">
                    <p id="section-toc.1-1.3.2.6.2.2.1"><a href="#section-3.6.2" class="xref">3.6.2</a>.  <a href="#name-reporting-error-conditions-d" class="xref">Reporting error conditions downstream</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6.2.3">
                    <p id="section-toc.1-1.3.2.6.2.3.1"><a href="#section-3.6.3" class="xref">3.6.3</a>.  <a href="#name-handling-error-conditions-o" class="xref">Handling error conditions on nested messages used for batching</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6.2.4">
                    <p id="section-toc.1-1.3.2.6.2.4.1"><a href="#section-3.6.4" class="xref">3.6.4</a>.  <a href="#name-reporting-error-conditions" class="xref">Reporting error conditions</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-end-entity-pki-management-o" class="xref">End Entity PKI management operations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-requesting-a-new-certificat" class="xref">Requesting a new certificate from a PKI</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.1">
                    <p id="section-toc.1-1.4.2.1.2.1.1"><a href="#section-4.1.1" class="xref">4.1.1</a>.  <a href="#name-requesting-a-certificate-fr" class="xref">Requesting a certificate from a new PKI with signature-based protection</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.2">
                    <p id="section-toc.1-1.4.2.1.2.2.1"><a href="#section-4.1.2" class="xref">4.1.2</a>.  <a href="#name-requesting-an-additional-ce" class="xref">Requesting an additional certificate with signature-based protection</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.3">
                    <p id="section-toc.1-1.4.2.1.2.3.1"><a href="#section-4.1.3" class="xref">4.1.3</a>.  <a href="#name-updating-an-existing-certif" class="xref">Updating an existing certificate with signature protection</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.4">
                    <p id="section-toc.1-1.4.2.1.2.4.1"><a href="#section-4.1.4" class="xref">4.1.4</a>.  <a href="#name-requesting-a-certificate-fro" class="xref">Requesting a certificate from a legacy PKI using a PKCS#10 request</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.5">
                    <p id="section-toc.1-1.4.2.1.2.5.1"><a href="#section-4.1.5" class="xref">4.1.5</a>.  <a href="#name-requesting-a-certificate-from" class="xref">Requesting a certificate from a PKI with MAC-based protection</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.6">
                    <p id="section-toc.1-1.4.2.1.2.6.1"><a href="#section-4.1.6" class="xref">4.1.6</a>.  <a href="#name-adding-central-key-pair-gen" class="xref">Adding central key pair generation to a certificate request</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.6.2.1">
                        <p id="section-toc.1-1.4.2.1.2.6.2.1.1"><a href="#section-4.1.6.1" class="xref">4.1.6.1</a>.  <a href="#name-using-key-agreement-key-man" class="xref">Using key agreement key management technique</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.6.2.2">
                        <p id="section-toc.1-1.4.2.1.2.6.2.2.1"><a href="#section-4.1.6.2" class="xref">4.1.6.2</a>.  <a href="#name-using-key-transport-key-man" class="xref">Using key transport key management technique</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.6.2.3">
                        <p id="section-toc.1-1.4.2.1.2.6.2.3.1"><a href="#section-4.1.6.3" class="xref">4.1.6.3</a>.  <a href="#name-using-password-based-key-ma" class="xref">Using password-based key management technique</a></p>
</li>
                    </ul>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-revoking-a-certificate" class="xref">Revoking a certificate</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.  <a href="#name-support-messages" class="xref">Support messages</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.1">
                    <p id="section-toc.1-1.4.2.3.2.1.1"><a href="#section-4.3.1" class="xref">4.3.1</a>.  <a href="#name-get-ca-certificates" class="xref">Get CA certificates</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.2">
                    <p id="section-toc.1-1.4.2.3.2.2.1"><a href="#section-4.3.2" class="xref">4.3.2</a>.  <a href="#name-get-root-ca-certificate-upd" class="xref">Get root CA certificate update</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.3">
                    <p id="section-toc.1-1.4.2.3.2.3.1"><a href="#section-4.3.3" class="xref">4.3.3</a>.  <a href="#name-get-certificate-request-tem" class="xref">Get certificate request template</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.4">
                    <p id="section-toc.1-1.4.2.3.2.4.1"><a href="#section-4.3.4" class="xref">4.3.4</a>.  <a href="#name-crl-update-retrieval" class="xref">CRL update retrieval</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="xref">4.4</a>.  <a href="#name-handling-delayed-delivery" class="xref">Handling delayed delivery</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-pki-management-entity-opera" class="xref">PKI management entity operations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-responding-to-requests" class="xref">Responding to requests</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.1">
                    <p id="section-toc.1-1.5.2.1.2.1.1"><a href="#section-5.1.1" class="xref">5.1.1</a>.  <a href="#name-responding-to-a-certificate" class="xref">Responding to a certificate request</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.2">
                    <p id="section-toc.1-1.5.2.1.2.2.1"><a href="#section-5.1.2" class="xref">5.1.2</a>.  <a href="#name-initiating-delayed-delivery" class="xref">Initiating delayed delivery</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.3">
                    <p id="section-toc.1-1.5.2.1.2.3.1"><a href="#section-5.1.3" class="xref">5.1.3</a>.  <a href="#name-responding-to-a-confirmatio" class="xref">Responding to a confirmation message</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.4">
                    <p id="section-toc.1-1.5.2.1.2.4.1"><a href="#section-5.1.4" class="xref">5.1.4</a>.  <a href="#name-responding-to-a-revocation-" class="xref">Responding to a revocation request</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.5">
                    <p id="section-toc.1-1.5.2.1.2.5.1"><a href="#section-5.1.5" class="xref">5.1.5</a>.  <a href="#name-responding-to-a-support-mes" class="xref">Responding to a support message</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-forwarding-messages" class="xref">Forwarding messages</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.1">
                    <p id="section-toc.1-1.5.2.2.2.1.1"><a href="#section-5.2.1" class="xref">5.2.1</a>.  <a href="#name-not-changing-protection" class="xref">Not changing protection</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.2">
                    <p id="section-toc.1-1.5.2.2.2.2.1"><a href="#section-5.2.2" class="xref">5.2.2</a>.  <a href="#name-adding-protection-and-batch" class="xref">Adding protection and batching of messages</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.2.2.1">
                        <p id="section-toc.1-1.5.2.2.2.2.2.1.1"><a href="#section-5.2.2.1" class="xref">5.2.2.1</a>.  <a href="#name-adding-protection-to-a-requ" class="xref">Adding protection to a request message</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.2.2.2">
                        <p id="section-toc.1-1.5.2.2.2.2.2.2.1"><a href="#section-5.2.2.2" class="xref">5.2.2.2</a>.  <a href="#name-batching-messages" class="xref">Batching messages</a></p>
</li>
                    </ul>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3">
                    <p id="section-toc.1-1.5.2.2.2.3.1"><a href="#section-5.2.3" class="xref">5.2.3</a>.  <a href="#name-replacing-protection" class="xref">Replacing protection</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.1">
                        <p id="section-toc.1-1.5.2.2.2.3.2.1.1"><a href="#section-5.2.3.1" class="xref">5.2.3.1</a>.  <a href="#name-not-changing-any-included-p" class="xref">Not changing any included proof-of-possession</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.2">
                        <p id="section-toc.1-1.5.2.2.2.3.2.2.1"><a href="#section-5.2.3.2" class="xref">5.2.3.2</a>.  <a href="#name-breaking-proof-of-possessio" class="xref">Breaking proof-of-possession</a></p>
</li>
                    </ul>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="xref">5.3</a>.  <a href="#name-acting-on-behalf-of-other-p" class="xref">Acting on behalf of other PKI entities</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.1">
                    <p id="section-toc.1-1.5.2.3.2.1.1"><a href="#section-5.3.1" class="xref">5.3.1</a>.  <a href="#name-requesting-certificates" class="xref">Requesting certificates</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.2">
                    <p id="section-toc.1-1.5.2.3.2.2.1"><a href="#section-5.3.2" class="xref">5.3.2</a>.  <a href="#name-revoking-a-certificate-2" class="xref">Revoking a certificate</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-cmp-message-transfer-mechan" class="xref">CMP message transfer mechanisms</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-http-transfer" class="xref">HTTP transfer</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-coap-transfer" class="xref">CoAP transfer</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="xref">6.3</a>.  <a href="#name-piggybacking-on-other-relia" class="xref">Piggybacking on other reliable transfer</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="xref">6.4</a>.  <a href="#name-offline-transfer" class="xref">Offline transfer</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4.2.1">
                    <p id="section-toc.1-1.6.2.4.2.1.1"><a href="#section-6.4.1" class="xref">6.4.1</a>.  <a href="#name-file-based-transfer" class="xref">File-based transfer</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4.2.2">
                    <p id="section-toc.1-1.6.2.4.2.2.1"><a href="#section-6.4.2" class="xref">6.4.2</a>.  <a href="#name-other-asynchronous-transfer" class="xref">Other asynchronous transfer protocols</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-conformance-requirements" class="xref">Conformance requirements</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.  <a href="#name-pki-management-operations" class="xref">PKI management operations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="xref">7.2</a>.  <a href="#name-message-transfer" class="xref">Message transfer</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-acknowledgements" class="xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>. <a href="#name-references" class="xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="xref">11.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="xref">11.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-A" class="xref">Appendix A</a>.  <a href="#name-example-certreqtemplate" class="xref">Example CertReqTemplate</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-B" class="xref">Appendix B</a>.  <a href="#name-history-of-changes" class="xref">History of changes</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-C" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="Introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">[RFC Editor: please delete]: The labels "RFC-CMP-Updates" and "RFC-CMP-Alg" in ASN.1 Syntax need to be replaced with the RFC numbers of <span><a href="#I-D.ietf-lamps-cmp-updates" class="xref">CMP Updates</a> [<a href="#I-D.ietf-lamps-cmp-updates" class="xref">I-D.ietf-lamps-cmp-updates</a>]</span> and <span><a href="#I-D.ietf-lamps-cmp-algorithms" class="xref">CMP Algorithms</a> [<a href="#I-D.ietf-lamps-cmp-algorithms" class="xref">I-D.ietf-lamps-cmp-algorithms</a>]</span>, when available.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">This document specifies PKI management operations supporting machine-to-machine and IoT use cases. Its focus is to maximize automation and interoperability between all involved PKI entities, ranging from end entities (EE) over any number of intermediate PKI management entities such as Registration Authorities (RA) to the CMP endpoints of Certification Authority (CA) systems.  This profile makes use of the concepts and syntax specified in <span><a href="#RFC4210" class="xref">CMP</a> [<a href="#RFC4210" class="xref">RFC4210</a>]</span>, <span>[<a href="#I-D.ietf-lamps-cmp-updates" class="xref">I-D.ietf-lamps-cmp-updates</a>]</span>, and <span>[<a href="#I-D.ietf-lamps-cmp-algorithms" class="xref">I-D.ietf-lamps-cmp-algorithms</a>]</span>, <span><a href="#RFC4211" class="xref">CRMF</a> [<a href="#RFC4211" class="xref">RFC4211</a>]</span> and <span>[<a href="#RFC9045" class="xref">RFC9045</a>]</span>, <span><a href="#RFC5652" class="xref">CMS</a> [<a href="#RFC5652" class="xref">RFC5652</a>]</span> and <span>[<a href="#RFC8933" class="xref">RFC8933</a>]</span>, <span><a href="#RFC6712" class="xref">HTTP transfer for CMP</a> [<a href="#RFC6712" class="xref">RFC6712</a>]</span>, and <span><a href="#I-D.ietf-ace-cmpv2-coap-transport" class="xref">CoAP transfer for CMP</a> [<a href="#I-D.ietf-ace-cmpv2-coap-transport" class="xref">I-D.ietf-ace-cmpv2-coap-transport</a>]</span>. Especially CMP, CRMF, and CMS are very feature-rich standards, while in most application scenarios only a limited subset of the specified functionality is needed. Additionally, the standards are not always precise enough on how to interpret and implement the described concepts.  Therefore, this document aims at tailoring the available options and specifying at an adequate detail how to use them to make the implementation of interoperable automated certificate management as straightforward and lightweight as possible.<a href="#section-1-2" class="pilcrow">¶</a></p>
<div id="How_to_read">
<section id="section-1.1">
        <h3 id="name-how-to-read-this-document">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-how-to-read-this-document" class="section-name selfRef">How to Read This Document</a>
        </h3>
<p id="section-1.1-1">This document has become longer than the authors would have liked it to be.  Yet apart from studying <a href="#GenericParts" class="xref">Section 3</a>, which contains general requirements, the reader does not have to work through the whole document.  The guidance in <a href="#Structure" class="xref">Section 1.8</a> and <a href="#Conformity" class="xref">Section 7</a> should be used to figure out which parts of <a href="#EE_UseCases" class="xref">Section 4</a> to <a href="#Transfer_types" class="xref">Section 6</a> are relevant for the target certificate management solution depending on the PKI management operations, their variants, and types of message transfer needed.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">Since conformity to this document can be achieved by implementing only the functionality declared mandatory in <a href="#Conformity" class="xref">Section 7</a>, the profile can still be called lightweight because in particular for end entities the mandatory-to-implement set of features is rather limited.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Motivation">
<section id="section-1.2">
        <h3 id="name-motivation-for-a-lightweigh">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-motivation-for-a-lightweigh" class="section-name selfRef">Motivation for a lightweight profile of CMP</a>
        </h3>
<p id="section-1.2-1">CMP was standardized in 1999 and is implemented in several PKI products. In 2005, a completely reworked and enhanced version 2 of <span><a href="#RFC4210" class="xref">CMP</a> [<a href="#RFC4210" class="xref">RFC4210</a>]</span> and <span><a href="#RFC4211" class="xref">CRMF</a> [<a href="#RFC4211" class="xref">RFC4211</a>]</span> has been published, followed by a document specifying a transfer mechanism for CMP messages using HTTP <span>[<a href="#RFC6712" class="xref">RFC6712</a>]</span> in 2012.<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<p id="section-1.2-2">Though CMP is a solid and very capable protocol it is so far not used very widely.  The most important reason appears to be that the protocol offers a too large set of features and options.  On the one hand, this makes CMP applicable to a very wide range of scenarios, but on the other hand, a full implementation supporting all options is not realistic because this would take undue effort.<a href="#section-1.2-2" class="pilcrow">¶</a></p>
<p id="section-1.2-3">In order to reduce complexity, the set of mandatory PKI management operations and variants required by this specification has been kept lean.  This limits development effort and minimizes resource needs, which is particularly important for memory-constrained devices.  To this end, when there was a choice to have necessary complexity more on the EE or PKI management entity side, it has been pushed towards PKI management entities, where typically more computational resources are available and the development can be consolidated better.  Additional recommended PKI management operations and variants support some more complex scenarios that are considered beneficial for environments with more specific demands or boundary conditions.  The optional PKI management operations support less common scenarios and requirements.<a href="#section-1.2-3" class="pilcrow">¶</a></p>
<p id="section-1.2-4">Moreover, many details of the CMP protocol have been left open or have not been specified in full preciseness. The profiles specified in Appendix D and E of <span>[<a href="#RFC4210" class="xref">RFC4210</a>]</span> define some more detailed PKI management operations. Yet, the specific needs of highly automated scenarios for a machine-to-machine communication are not covered sufficiently.<a href="#section-1.2-4" class="pilcrow">¶</a></p>
<p id="section-1.2-5">As also 3GPP and UNISIG already put across, profiling is a way of coping with the challenges mentioned above. To profile means to take advantage of the strengths of the given protocol, while explicitly narrowing down the options it provides to those needed for the purpose(s) at hand and eliminating all identified ambiguities. In this way all the general and applicable aspects of the general protocol are taken over and only the peculiarities of the target scenarios need to be dealt with specifically.<a href="#section-1.2-5" class="pilcrow">¶</a></p>
<p id="section-1.2-6">Defining a profile for a new target environment takes high effort because the range of available options needs to be well understood and the selected options need to be consistent with each other and suitably cover the intended application scenario.  Since most industrial PKI management use cases typically have much in common it is worth sharing this effort, which is the aim of this document.  Other standardization bodies can reference this document and do not need to come up with individual profiles from scratch.<a href="#section-1.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Lightweight_profile">
<section id="section-1.3">
        <h3 id="name-special-requirements-of-ind">
<a href="#section-1.3" class="section-number selfRef">1.3. </a><a href="#name-special-requirements-of-ind" class="section-name selfRef">Special requirements of industrial and IoT scenarios</a>
        </h3>
<p id="section-1.3-1">The profiles specified in <span><a href="#RFC4210" class="xref">Appendix D and E of RFC 4210</a> [<a href="#RFC4210" class="xref">RFC4210</a>]</span> have been developed particularly for managing certificates of human end entities. With the evolution of distributed systems and client-server architectures, certificates for machines and applications on them have become widely used. This trend has strengthened even more in emerging industrial and IoT scenarios. CMP is sufficiently flexible to support them well.<a href="#section-1.3-1" class="pilcrow">¶</a></p>
<p id="section-1.3-2">Today's IT security architectures for industrial solutions typically use certificates for endpoint authentication within protocols like IPsec, TLS, or SSH. Therefore, the security of these architectures highly relies upon the security and availability of the implemented certificate management operations.<a href="#section-1.3-2" class="pilcrow">¶</a></p>
<p id="section-1.3-3">Due to increasing security needs in operational networks as well as availability requirements, especially on critical infrastructures and systems with a high number of certificates, a state-of-the-art certificate management system must be constantly available and cost-efficient, which calls for high automation and reliability. Consequently, the <span><a href="#NIST.CSWP.04162018" class="xref">NIST Framework for Improving Critical Infrastructure Cybersecurity</a> [<a href="#NIST.CSWP.04162018" class="xref">NIST.CSWP.04162018</a>]</span> refers to proper processes for issuance, management, verification, revocation, and audit for authorized devices, users, and processes involving identity and credential management. Such PKI management operations according to commonly accepted best practices are also required in <span><a href="#IEC.62443-3-3" class="xref">IEC 62443-3-3</a> [<a href="#IEC.62443-3-3" class="xref">IEC.62443-3-3</a>]</span> for security level 2 and higher.<a href="#section-1.3-3" class="pilcrow">¶</a></p>
<p id="section-1.3-4">Further challenges in many industrial systems are network segmentation and asynchronous communication, while PKI management entities like Certification Authorities (CA) typically are not deployed on-site but in a more protected environment of a data center or trust center. Certificate management must be able to cope with such network architectures. CMP offers the required flexibility and functionality, namely self-contained messages, efficient polling, and support for asynchronous message transfer while retaining end-to-end security.<a href="#section-1.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Existing_profiles">
<section id="section-1.4">
        <h3 id="name-existing-cmp-profiles">
<a href="#section-1.4" class="section-number selfRef">1.4. </a><a href="#name-existing-cmp-profiles" class="section-name selfRef">Existing CMP profiles</a>
        </h3>
<p id="section-1.4-1">As already stated, <span><a href="#RFC4210" class="xref">RFC 4210</a> [<a href="#RFC4210" class="xref">RFC4210</a>]</span> contains profiles with mandatory and optional PKI management operations in Appendix D and E. Those profiles focus on management of human user certificates and only partly address the specific needs of certificate management automation for unattended devices or machine-to-machine application scenarios.<a href="#section-1.4-1" class="pilcrow">¶</a></p>
<p id="section-1.4-2">Both Appendixes D and E focus on EE-to-RA/CA PKI management operations and do not address further profiling of RA-to-CA communication as typically needed for full backend automation.  All requirements regarding algorithm support for <span><a href="#RFC4210" class="xref">RFC 4210 Appendix D and E</a> [<a href="#RFC4210" class="xref">RFC4210</a>]</span> have been updated by <span><a href="#I-D.ietf-lamps-cmp-algorithms" class="xref">CMP Algorithms Section 7.1</a> [<a href="#I-D.ietf-lamps-cmp-algorithms" class="xref">I-D.ietf-lamps-cmp-algorithms</a>]</span>.<a href="#section-1.4-2" class="pilcrow">¶</a></p>
<p id="section-1.4-3">3GPP makes use of <span><a href="#RFC4210" class="xref">CMP</a> [<a href="#RFC4210" class="xref">RFC4210</a>]</span> in its <span><a href="#ETSI-3GPP.33.310" class="xref">Technical Specification 33.310</a> [<a href="#ETSI-3GPP.33.310" class="xref">ETSI-3GPP.33.310</a>]</span> for automatic management of IPsec certificates in 3G, LTE, and 5G backbone networks. Since 2010, a dedicated CMP profile for initial certificate enrollment and certificate update operations between EE and RA/CA is specified in that document.<a href="#section-1.4-3" class="pilcrow">¶</a></p>
<p id="section-1.4-4">UNISIG has included a CMP profile for enrollment of TLS certificates in the Subset-137 specifying the <span><a href="#UNISIG.Subset-137" class="xref">ETRAM/ETCS on-line key management for train control systems</a> [<a href="#UNISIG.Subset-137" class="xref">UNISIG.Subset-137</a>]</span> in 2015.<a href="#section-1.4-4" class="pilcrow">¶</a></p>
<p id="section-1.4-5">Both standardization bodies tailor <span><a href="#RFC4210" class="xref">CMP</a> [<a href="#RFC4210" class="xref">RFC4210</a>]</span>, <span><a href="#RFC4211" class="xref">CRMF</a> [<a href="#RFC4211" class="xref">RFC4211</a>]</span>, and <span><a href="#RFC6712" class="xref">HTTP transfer for CMP</a> [<a href="#RFC6712" class="xref">RFC6712</a>]</span> for highly automated and reliable PKI management operations for unattended devices and services.<a href="#section-1.4-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ZTO">
<section id="section-1.5">
        <h3 id="name-use-of-cmp-in-sztp-and-brsk">
<a href="#section-1.5" class="section-number selfRef">1.5. </a><a href="#name-use-of-cmp-in-sztp-and-brsk" class="section-name selfRef">Use of CMP in SZTP and BRSKI environments</a>
        </h3>
<p id="section-1.5-1">In <span><a href="#RFC8572" class="xref">Secure Zero Touch Provisioning (SZTP)</a> [<a href="#RFC8572" class="xref">RFC8572</a>]</span> and other environments using NETCONF/YANG modules, <span><a href="#I-D.ietf-netconf-sztp-csr" class="xref">SZTP-CSR</a> [<a href="#I-D.ietf-netconf-sztp-csr" class="xref">I-D.ietf-netconf-sztp-csr</a>]</span> offers a YANG module that includes different types of certificate requests to obtain a public-key certificate for a locally generated key pair.  One option is using a CMP p10cr message.  Such a message is of the form ietf-ztp-types:cmp-csr from module ietf-ztp-csr and offers both proof-of-possession and proof-of-identity.  To allow PKI management entities to also comply with this profile, the p10cr message must be formatted by the EE as described in <a href="#EE_P10" class="xref">Section 4.1.4</a> of this profile, and it may be forwarded as specified in <a href="#RA_forwarde_messages" class="xref">Section 5.2</a>.<a href="#section-1.5-1" class="pilcrow">¶</a></p>
<p id="section-1.5-2">In <span><a href="#RFC8995" class="xref">Bootstrapping Remote Secure Key Infrastructure (BRSKI)</a> [<a href="#RFC8995" class="xref">RFC8995</a>]</span> environments, BRSKI Asynchronous Enrollment <span><a href="#I-D.ietf-anima-brski-async-enroll" class="xref">BRSKI Asynchronous Enrollment</a> [<a href="#I-D.ietf-anima-brski-async-enroll" class="xref">I-D.ietf-anima-brski-async-enroll</a>]</span> describes a generalization regarding the employed enrollment protocols to allow alternatives to <span><a href="#RFC7030" class="xref">EST</a> [<a href="#RFC7030" class="xref">RFC7030</a>]</span>. For the use of CMP, it requires adherence to this profile.<a href="#section-1.5-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Compatibility">
<section id="section-1.6">
        <h3 id="name-compatibility-with-existing">
<a href="#section-1.6" class="section-number selfRef">1.6. </a><a href="#name-compatibility-with-existing" class="section-name selfRef">Compatibility with existing CMP profiles</a>
        </h3>
<p id="section-1.6-1" class="keepWithNext">The profile specified in this document is compatible with <span><a href="#RFC4210" class="xref">RFC 4210 Appendixes D and E (PKI Management Message Profiles)</a> [<a href="#RFC4210" class="xref">RFC4210</a>]</span>, with the following exceptions:<a href="#section-1.6-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.6-2.1">signature-based protection is the default protection; an initial PKI management operation may also use MAC-based protection,<a href="#section-1.6-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.6-2.2">certification of a second key pair within the same PKI management operation is not supported,<a href="#section-1.6-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.6-2.3">proof-of-possession (POPO) with self-signature of the certTemplate according to <span><a href="#RFC4211" class="xref">RFC 4211 Section 4.1</a> [<a href="#RFC4211" class="xref">RFC4211</a>]</span> clause 3 is the recommended default POPO method (deviations are possible for EEs when requesting central key generation, for RAs when using raVerified, and if the newly generated keypair is technically not capable to generate digital signatures),<a href="#section-1.6-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.6-2.4">confirmation of newly enrolled certificates may be omitted, and<a href="#section-1.6-2.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.6-2.5">all PKI management operations consist of request-response message pairs originating at the EE, i.e., announcement messages (requiring a push model, a CMP server on the EE) are excluded in favor of a lightweight implementation on the EE.<a href="#section-1.6-2.5" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-1.6-3" class="keepWithNext">The profile specified in this document is compatible with the CMP profile for 3G, LTE, and 5G network domain security and authentication framework <span>[<a href="#ETSI-3GPP.33.310" class="xref">ETSI-3GPP.33.310</a>]</span>, except that:<a href="#section-1.6-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.6-4.1">protection of initial PKI management operations may be MAC-based,<a href="#section-1.6-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.6-4.2">the subject field is mandatory in certificate templates, and<a href="#section-1.6-4.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.6-4.3">confirmation of newly enrolled certificates may be omitted.<a href="#section-1.6-4.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-1.6-5" class="keepWithNext">The profile specified in this document is compatible with the CMP profile for on-line key management in rail networks as specified in <span><a href="#UNISIG.Subset-137" class="xref">UNISIG Subset-137</a> [<a href="#UNISIG.Subset-137" class="xref">UNISIG.Subset-137</a>]</span>, except that:<a href="#section-1.6-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.6-6.1">A certificate enrollment request message consists of only one  certificate request (CertReqMsg).<a href="#section-1.6-6.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.6-6.2">
            <p id="section-1.6-6.2.1"><span><a href="#RFC4210" class="xref">RFC 4210</a> [<a href="#RFC4210" class="xref">RFC4210</a>]</span> requires that the messageTime is Greenwich Mean Time coded as generalizedTime.<a href="#section-1.6-6.2.1" class="pilcrow">¶</a></p>
<p id="section-1.6-6.2.2">Note: As <span><a href="#UNISIG.Subset-137" class="xref">UNISIG Subset-137 Table 5</a> [<a href="#UNISIG.Subset-137" class="xref">UNISIG.Subset-137</a>]</span> explicitly states that the messageTime in required to be "UTC time", it is not clear if this means a coding as UTCTime or generalizedTime and if other time zones than Greenwich Mean Time shall be allowed. Both time formats are described in <span><a href="#RFC5280" class="xref">RFC 5280 Section 4.1.2.5</a> [<a href="#RFC5280" class="xref">RFC5280</a>]</span>.<a href="#section-1.6-6.2.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.6-6.3">The same type of protection is required to be used for all messages of one PKI management operation. This means, in case the request message protection is MAC-based, also the response, certConf, and pkiConf messages must have a MAC-based protection.<a href="#section-1.6-6.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.6-6.4">
            <p id="section-1.6-6.4.1">Use of caPubs is not required but typically allowed in combination with MAC-based protected PKI management operations.  On the other hand <span><a href="#UNISIG.Subset-137" class="xref">UNISIG Subset-137 Table 12</a> [<a href="#UNISIG.Subset-137" class="xref">UNISIG.Subset-137</a>]</span> requires using caPubs.<a href="#section-1.6-6.4.1" class="pilcrow">¶</a></p>
<p id="section-1.6-6.4.2">Note: It remains unclear from UNISIG Subset-137 for which certificate(s) the caPubs field should be used. For security reasons, it cannot be used for delivering the root CA certificate needed for validating the signature-based protection of the given response message (as stated indirectly also in its <span><a href="#UNISIG.Subset-137" class="xref">UNISIG Subset-137 Section 6.3.1.5.2 b</a> [<a href="#UNISIG.Subset-137" class="xref">UNISIG.Subset-137</a>]</span>).<a href="#section-1.6-6.4.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.6-6.5">
            <p id="section-1.6-6.5.1">This profile requires that the certConf message has one CertStatus element where the statusInfo field is recommended.<a href="#section-1.6-6.5.1" class="pilcrow">¶</a></p>
<p id="section-1.6-6.5.2">Note: In contrast, <span><a href="#UNISIG.Subset-137" class="xref">UNISIG Subset-137 Table 18</a> [<a href="#UNISIG.Subset-137" class="xref">UNISIG.Subset-137</a>]</span> requires that the certConf message has one CertStatus element where the statusInfo field must be absent. This precludes sending a negative certConf message in case the EE rejects the newly enrolled certificate. This results in violating the general rule that a certificate request transaction must include a certConf message (since moreover, using implicitConfirm is not allowed there, neither).<a href="#section-1.6-6.5.2" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="Scope">
<section id="section-1.7">
        <h3 id="name-scope-of-this-document">
<a href="#section-1.7" class="section-number selfRef">1.7. </a><a href="#name-scope-of-this-document" class="section-name selfRef">Scope of this document</a>
        </h3>
<p id="section-1.7-1">To minimize ambiguity and complexity through needless variety, this document specifies exhaustive requirements on generating PKI management messages on the sender side.  On the other hand, it gives only minimal requirements on checks by the receiving side and how to handle error cases.<a href="#section-1.7-1" class="pilcrow">¶</a></p>
<p id="section-1.7-2">Especially on the EE side this profile aims at a lightweight implementation. This means that the number of PKI management operations implementations are reduced to a reasonable minimum to support typical certificate management use cases in industrial machine-to-machine environments. On the EE side only limited resources are expected, while on the side of the PKI management entities the profile accepts higher requirements.<a href="#section-1.7-2" class="pilcrow">¶</a></p>
<p id="section-1.7-3">For the sake of interoperability and robustness, implementations should, as far as security is not affected, adhere to Postel's law: "Be conservative in what you do, be liberal in what you accept from others" (often reworded as: "Be conservative in what you send, be liberal in what you receive").<a href="#section-1.7-3" class="pilcrow">¶</a></p>
<p id="section-1.7-4">When in <a href="#GenericParts" class="xref">Section 3</a>, <a href="#EE_UseCases" class="xref">Section 4</a>, and <a href="#RA_UseCases" class="xref">Section 5</a> a field of the ASN.1 syntax as defined in <span><a href="#RFC4210" class="xref">CMP</a> [<a href="#RFC4210" class="xref">RFC4210</a>]</span> and <span>[<a href="#I-D.ietf-lamps-cmp-updates" class="xref">I-D.ietf-lamps-cmp-updates</a>]</span>, <span><a href="#RFC4211" class="xref">CRMF</a> [<a href="#RFC4211" class="xref">RFC4211</a>]</span>, and <span><a href="#RFC5652" class="xref">CMS</a> [<a href="#RFC5652" class="xref">RFC5652</a>]</span> and <span>[<a href="#RFC8933" class="xref">RFC8933</a>]</span> is not explicitly specified, it SHOULD NOT be used by the sending entity. The receiving entity MUST NOT require its absence and if present MUST gracefully handle its presence.<a href="#section-1.7-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Structure">
<section id="section-1.8">
        <h3 id="name-structure-of-this-document">
<a href="#section-1.8" class="section-number selfRef">1.8. </a><a href="#name-structure-of-this-document" class="section-name selfRef">Structure of this document</a>
        </h3>
<p id="section-1.8-1"><a href="#Architecture" class="xref">Section 2</a> introduces the general PKI architecture and approach to certificate management that is assumed in this document. Then it lists the PKI management operations specified in this document, partitioning them into mandatory, recommended, and optional ones.<a href="#section-1.8-1" class="pilcrow">¶</a></p>
<p id="section-1.8-2"><a href="#GenericParts" class="xref">Section 3</a> profiles the generic aspects of the PKI management operations specified in detail in <a href="#EE_UseCases" class="xref">Section 4</a> and <a href="#RA_UseCases" class="xref">Section 5</a> to minimize redundancy in the description and to ease implementation. This covers the general structure and protection of messages, as well as generic prerequisites, validation, and error handling.<a href="#section-1.8-2" class="pilcrow">¶</a></p>
<p id="section-1.8-3"><a href="#EE_UseCases" class="xref">Section 4</a> profiles the exchange of CMP messages between an EE and the PKI management entity. There are various flavors of certificate enrollment requests, optionally with polling, central key generation, revocation, and general support PKI management operations.<a href="#section-1.8-3" class="pilcrow">¶</a></p>
<p id="section-1.8-4"><a href="#RA_UseCases" class="xref">Section 5</a> profiles responding to requests, exchange between PKI management entities, and operations on behalf of other PKI entities.  This may include delayed delivery of messages, which involves polling for responses, and nesting of messages.<a href="#section-1.8-4" class="pilcrow">¶</a></p>
<p id="section-1.8-5"><a href="#Transfer_types" class="xref">Section 6</a> outlines several mechanisms for CMP message transfer, including HTTP-based <span>[<a href="#RFC6712" class="xref">RFC6712</a>]</span> transfer optionally using TLS, and  <span>[<a href="#I-D.ietf-ace-cmpv2-coap-transport" class="xref">I-D.ietf-ace-cmpv2-coap-transport</a>]</span> transfer optionally using DTLS, and offline file-based transport.<a href="#section-1.8-5" class="pilcrow">¶</a></p>
<p id="section-1.8-6"><a href="#Conformity" class="xref">Section 7</a> defines which parts of the profile are mandatory, recommended, optional, or not relevant to implement for which type of entity.<a href="#section-1.8-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Convention_Terminology">
<section id="section-1.9">
        <h3 id="name-convention-and-terminology">
<a href="#section-1.9" class="section-number selfRef">1.9. </a><a href="#name-convention-and-terminology" class="section-name selfRef">Convention and Terminology</a>
        </h3>
<p id="section-1.9-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they appear in all capitals, as shown here.<a href="#section-1.9-1" class="pilcrow">¶</a></p>
<p id="section-1.9-2" class="keepWithNext">Technical terminology is used in conformance with <span><a href="#RFC4210" class="xref">RFC 4210</a> [<a href="#RFC4210" class="xref">RFC4210</a>]</span>, <span><a href="#RFC4211" class="xref">RFC 4211</a> [<a href="#RFC4211" class="xref">RFC4211</a>]</span>, <span><a href="#RFC5280" class="xref">RFC 5280</a> [<a href="#RFC5280" class="xref">RFC5280</a>]</span>, and <span><a href="#IEEE.802.1AR_2018" class="xref">IEEE 802.1AR</a> [<a href="#IEEE.802.1AR_2018" class="xref">IEEE.802.1AR_2018</a>]</span>. The following key words are used:<a href="#section-1.9-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-1.9-3">
          <dt id="section-1.9-3.1">CA:</dt>
          <dd style="margin-left: 3.0em" id="section-1.9-3.2">Certification authority, which issues certificates.<a href="#section-1.9-3.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.9-3.3">RA:</dt>
          <dd style="margin-left: 3.0em" id="section-1.9-3.4">Registration authority, an optional PKI component to which a CA delegates certificate management functions such as end entity authentication and authorization checks for incoming requests. An RA can also provide conversion between various certificate management protocols and other protocols providing some operations related to certificate management.<a href="#section-1.9-3.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.9-3.5">LRA:</dt>
          <dd style="margin-left: 3.0em" id="section-1.9-3.6">
            <p id="section-1.9-3.6.1">Local registration authority, a specific form of RA with proximity to the end entities.<a href="#section-1.9-3.6.1" class="pilcrow">¶</a></p>
<p id="section-1.9-3.6.2">Note: For ease of reading, this document uses the term "RA" also for LRAs in all cases where the difference is not relevant.<a href="#section-1.9-3.6.2" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.9-3.7">KGA:</dt>
          <dd style="margin-left: 3.0em" id="section-1.9-3.8">Key generation authority, an optional system component, typically co-located with an RA or CA, that offers key generation services to end entities.<a href="#section-1.9-3.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.9-3.9">EE:</dt>
          <dd style="margin-left: 3.0em" id="section-1.9-3.10">End entity, typically a device or service that holds a public-private key pair for which it manages a public-key certificate. An identifier for the EE is given as the subject of its certificate.<a href="#section-1.9-3.10" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-1.9-4" class="keepWithNext">The following terminology is reused from <span><a href="#RFC4210" class="xref">RFC 4210</a> [<a href="#RFC4210" class="xref">RFC4210</a>]</span>, as follows:<a href="#section-1.9-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-1.9-5">
          <dt id="section-1.9-5.1">PKI management operation:</dt>
          <dd style="margin-left: 13.5em" id="section-1.9-5.2">All CMP messages belonging to a single transaction.  The transaction is identified by the transactionID field of the message headers.<a href="#section-1.9-5.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.9-5.3">PKI management entity:</dt>
          <dd style="margin-left: 13.5em" id="section-1.9-5.4">A non-EE PKI entity, i.e., RA or CA.<a href="#section-1.9-5.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.9-5.5">PKI entity:</dt>
          <dd style="margin-left: 13.5em" id="section-1.9-5.6">An EE or PKI management entity.<a href="#section-1.9-5.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="Architecture">
<section id="section-2">
      <h2 id="name-solution-architecture">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-solution-architecture" class="section-name selfRef">Solution architecture</a>
      </h2>
<p id="section-2-1">To facilitate secure automatic certificate enrollment, the device hosting an EE is typically equipped with a manufacturer-issued device certificate.  Such a certificate is typically installed during production and is meant to identify the device throughout its lifetime.  This certificate can be used to protect the initial enrollment of operational certificates after installation of the EE in its operational environment.  In contrast to the manufacturer-issued device certificate, operational certificates are issued by the owner or operator of the device to identify the device or one of its components for operational use, e.g., in a security protocol like IPsec, TLS, or SSH.  In <span><a href="#IEEE.802.1AR_2018" class="xref">IEEE 802.1AR</a> [<a href="#IEEE.802.1AR_2018" class="xref">IEEE.802.1AR_2018</a>]</span> a manufacturer-issued device certificate is called IDevID certificate and an operational certificate is called LDevID certificate.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">Note: According to <span><a href="#IEEE.802.1AR_2018" class="xref">IEEE 802.1AR</a> [<a href="#IEEE.802.1AR_2018" class="xref">IEEE.802.1AR_2018</a>]</span> a DevID comprises the triple of the certificate, the corresponding private key, and the certificate chain.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">All certificate management operations specified in this document follow the pull model, i.e., are initiated by an EE (or by an RA acting as an EE).  The EE creates a CMP request message, protects it using some asymmetric credential or shared secret information and sends it to its locally reachable PKI management entity.  This PKI management entity may be a CA or more typically an RA, which checks the request, responds to it itself, or forwards the request upstream to the next PKI management entity.  In case an RA changes the CMP request message header or body or wants to demonstrate successful verification or authorization, it can apply a protection of its own.  Especially the communication between an LRA and RA can be performed synchronously or asynchronously.  Synchronous communication describes a timely uninterrupted communication between two communication partners, while asynchronous communication is not performed in a timely consistent manner, e.g., because of a delayed message delivery.<a href="#section-2-3" class="pilcrow">¶</a></p>
<span id="name-certificate-management-arch"></span><div id="CertManUseCasesFigure">
<figure id="figure-1">
        <div class="alignCenter art-text artwork" id="section-2-4.1">
<pre>
+-----+            +-----+                +-----+            +-----+
|     |            |     |                |     |            |     |
| EE  |&lt;----------&gt;| LRA |&lt;--------------&gt;| RA  |&lt;----------&gt;| CA  |
|     |            |     |                |     |            |     |
+-----+            +-----+                +-----+            +-----+

        synchronous        (a)synchronous       (a)synchronous
   +----connection----+------connection------+----connection----+

                                  operators          service partner
+---------on site--------+----back-end services-----+-trust center-+
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-certificate-management-arch" class="selfRef">Certificate management architecture example</a>
        </figcaption></figure>
</div>
<p id="section-2-5">In operational environments the certificate management architecture can have multiple LRAs bundling requests from multiple EEs at dedicated locations and one (or more than one) central RA aggregating the requests from the LRAs.  Every LRA in this scenario has shared secret information (one per EE) for MAC-based protection or a CMP protection key and certificate allowing it to (re-)protect CMP messages it processes.  The figure above shows an architecture example with at least one LRA, RA, and CA.  It is also possible not to have an RA or LRA or that there is no CA with a CMP interface.  Depending on the network infrastructure, the message transfer between PKI management entities may be based on synchronous online connections, asynchronous connections, or even offline (e.g., file-based) transfer.<a href="#section-2-5" class="pilcrow">¶</a></p>
<p id="section-2-6">Note: CMP response messages could also be used proactively to implement the push model towards the EE.  In this case the EE acts as receiver, not initiating the interaction with the PKI. Also, when using a commissioning tool or a registrar agent as described in <span><a href="#I-D.ietf-anima-brski-prm" class="xref">BRSKI with Pledge in Responder Mode (BRSKI-PRM)</a> [<a href="#I-D.ietf-anima-brski-prm" class="xref">I-D.ietf-anima-brski-prm</a>]</span>, certificate enrollment in a push model is needed. CMP in general and the messages specified in this profile offer all required capabilities, but the message flow and state machine as described in <a href="#EE_State_Machine" class="xref">Section 4</a> must be adapted to implement a push model.<a href="#section-2-6" class="pilcrow">¶</a></p>
<p id="section-2-7">Third-party CAs may implement other variants of CMP, different standardized protocols, or even proprietary interfaces for certificate management.  Therefore, the RA may need to adapt the exchanged CMP messages to the flavor of certificate management interaction required by the CA.<a href="#section-2-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="GenericParts">
<section id="section-3">
      <h2 id="name-generic-aspects-of-the-pki-">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-generic-aspects-of-the-pki-" class="section-name selfRef">Generic aspects of the PKI message</a>
      </h2>
<p id="section-3-1">This section covers the generic aspects of the PKI management operations specified in <a href="#EE_UseCases" class="xref">Section 4</a> and <a href="#RA_UseCases" class="xref">Section 5</a> as upfront general requirements to minimize redundancy in the description and to ease implementation.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2" class="keepWithNext">As described in <span><a href="#RFC4210" class="xref">Section 5.1 of RFC 4210</a> [<a href="#RFC4210" class="xref">RFC4210</a>]</span>, all CMP messages have the following general structure:<a href="#section-3-2" class="pilcrow">¶</a></p>
<span id="name-cmp-message-structure"></span><div id="CMP_messageStructure">
<figure id="figure-2">
        <div class="alignCenter art-text artwork" id="section-3-3.1">
<pre>
+--------------------------------------------+
| PKIMessage                                 |
| +----------------------------------------+ |
| | header                                 | |
| +----------------------------------------+ |
| +----------------------------------------+ |
| | body                                   | |
| +----------------------------------------+ |
| +----------------------------------------+ |
| | protection (OPTIONAL)                  | |
| +----------------------------------------+ |
| +----------------------------------------+ |
| | extraCerts (OPTIONAL)                  | |
| +----------------------------------------+ |
+--------------------------------------------+
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-cmp-message-structure" class="selfRef">CMP message structure</a>
        </figcaption></figure>
</div>
<p id="section-3-4">The general contents of the message header, protection, and extraCerts fields are specified in the following three subsections.<a href="#section-3-4" class="pilcrow">¶</a></p>
<p id="section-3-5">In case a specific PKI management operation needs different contents in the header, protection, or extraCerts fields, the differences are described in the respective subsections.<a href="#section-3-5" class="pilcrow">¶</a></p>
<p id="section-3-6">The CMP message body contains the PKI management operation-specific information. It is described in <a href="#EE_UseCases" class="xref">Section 4</a> and <a href="#RA_UseCases" class="xref">Section 5</a>.<a href="#section-3-6" class="pilcrow">¶</a></p>
<p id="section-3-7">The generic prerequisites needed by the PKI entities in order to be able to perform PKI management operations are described in <a href="#Prereq" class="xref">Section 3.4</a>.<a href="#section-3-7" class="pilcrow">¶</a></p>
<p id="section-3-8">The generic validation steps to be performed by PKI entities on receiving a CMP message are described in <a href="#Validation" class="xref">Section 3.5</a>.<a href="#section-3-8" class="pilcrow">¶</a></p>
<p id="section-3-9">The generic aspects of handling and reporting errors are described in <a href="#Error" class="xref">Section 3.6</a>.<a href="#section-3-9" class="pilcrow">¶</a></p>
<div id="Header">
<section id="section-3.1">
        <h3 id="name-general-description-of-the-">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-general-description-of-the-" class="section-name selfRef">General description of the CMP message header</a>
        </h3>
<p id="section-3.1-1">This section describes the generic header fields of all CMP messages with signature-based protection.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">In case a message has MAC-based protection the changes are described in <a href="#EE_MAC" class="xref">Section 4.1.5</a>.  The variations will affect the fields sender, protectionAlg, and senderKID.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<p id="section-3.1-3">Any PKI management operation-specific fields or variations are described in <a href="#EE_UseCases" class="xref">Section 4</a> and <a href="#RA_UseCases" class="xref">5</a>.<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.1-4">
<pre>
header
  pvno                        REQUIRED
    -- MUST be 3 to indicate CMP v3 in all cases where EnvelopedData
    -- is supported and expected to be used in the current
    -- PKI management operation
    -- MUST be 3 to indicate CMP v3 in certConf messages when using
    -- the hashAlg field
    -- MUST be 2 to indicate CMP v2 in all other cases
    -- For details on version negotiation see RFC-CMP-Updates
  sender                      REQUIRED
    -- SHOULD contain a name representing the originator of the
    -- message; otherwise, the NULL-DN (a zero-length
    -- SEQUENCE OF RelativeDistinguishedNames) MUST be used
    -- SHOULD be the subject of the CMP protection certificate, i.e.,
    -- the certificate corresponding to the private key used to sign
    -- the message
    -- In a multi-hop scenario, the receiving entity SHOULD NOT rely
    -- on the correctness of the sender field.
  recipient                   REQUIRED
    -- SHOULD be the name of the intended recipient; otherwise, the
    -- NULL-DN MUST be used
    -- In the first message of a PKI management operation:
    -- SHOULD be the subject DN of the CA the PKI management
    -- operation is requested from
    -- In all other messages:
    -- SHOULD contain the value of the sender field of the previous
    -- message in the same PKI management operation
    -- The recipient field SHALL be handled gracefully by the
    -- receiving entity, because in a multi-hop scenario its
    -- correctness cannot be guaranteed.
  messageTime                 RECOMMENDED
    -- MUST be the time at which the message was produced, if present
  protectionAlg               REQUIRED
    -- MUST be an algorithm identifier indicating the algorithm
    -- used for calculating the protection bits
    -- If it is a signature algorithm its type MUST be a
    -- MSG_SIG_ALG as specified in [RFC-CMP-Alg] Section 3 and
    -- MUST be consistent with the subjectPublicKeyInfo field of
    -- the protection certificate
    -- If it is a MAC algorithm its type MUST be a MSG_MAC_ALG as
    -- specified in [RFC-CMP-Alg] Section 6.1
  senderKID                   RECOMMENDED
    -- MUST be the SubjectKeyIdentifier of the CMP protection
    -- certificate in case of signature-based protection
  transactionID               REQUIRED
    -- In the first message of a PKI management operation:
    -- MUST be 128 bits of random data, to minimize the probability
    -- of having the transactionID already in use at the server
    -- In all other messages:
    -- MUST be the value from the previous message in the same
    -- PKI management operation
  senderNonce                 REQUIRED
    -- MUST be cryptographically secure and fresh 128 random bits
  recipNonce                  RECOMMENDED
    -- If this is the first message of a transaction: SHOULD be
    -- absent
    -- If this is a delayed response message: MUST be present and
    -- contain the value of the senderNonce of the respective request
    -- message in the same transaction
    -- In all other messages: MUST be present and contain the value
    -- of the senderNonce of the previous message in the same
    -- transaction
  generalInfo                 OPTIONAL
    implicitConfirm           OPTIONAL
    -- RECOMENDED in ir/cr/kur/p10cr messages,
    -- OPTIONAL in ip/cp/kup response messages, and
    -- PROHIBITED in other types of messages
    -- Added to request messages to request omission of the certConf
    -- message
    -- Added to response messages to grant omission of the certConf
    -- message
    -- See [RFC4210] Section 5.1.1.1.
     ImplicitConfirmValue    REQUIRED
    -- ImplicitConfirmValue MUST be NULL
    certProfile               OPTIONAL
    -- MAY be present in ir/cr/kur/p10cr and in genm messages of type
    -- id-it-certReqTemplate
    -- MUST be omitted in all other messages
    -- See [RFC-CMP-Updates]
      CertProfileValue        REQUIRED
    -- MUST contain exactly one UTF8String element
    -- MUST contain the name of a certificate profile
</pre><a href="#section-3.1-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="Protection">
<section id="section-3.2">
        <h3 id="name-general-description-of-the-c">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-general-description-of-the-c" class="section-name selfRef">General description of the CMP message protection</a>
        </h3>
<p id="section-3.2-1">This section describes the generic protection field contents of all CMP messages with signature-based protection. The private key used to sign a CMP message is called "protection key" and the related certificate is called "protection certificate". Any included keyUsage extension SHOULD allow digitalSignature.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2-2">
<pre>
protection                    RECOMMENDED
    -- MUST contain the signature calculated using the private key
    -- of the entity protecting the message. The signature
    -- algorithm used MUST be given in the protectionAlg field.
</pre><a href="#section-3.2-2" class="pilcrow">¶</a>
</div>
<p id="section-3.2-3">Generally, CMP message protection is required for CMP messages, but there are cases where protection of error messages specified in <a href="#Error" class="xref">Section 3.6</a> is not possible and therefore MAY be omitted.<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<p id="section-3.2-4">For MAC-based protection as specified in <a href="#EE_MAC" class="xref">Section 4.1.5</a> major differences apply as described there.<a href="#section-3.2-4" class="pilcrow">¶</a></p>
<p id="section-3.2-5">The CMP message protection provides, if available, message origin authentication and integrity protection for the header and body. The CMP message extraCerts field is not covered by this protection.<a href="#section-3.2-5" class="pilcrow">¶</a></p>
<p id="section-3.2-6">Note: The extended key usages described in <span><a href="#I-D.ietf-lamps-cmp-updates" class="xref">CMP Updates Section 2.2</a> [<a href="#I-D.ietf-lamps-cmp-updates" class="xref">I-D.ietf-lamps-cmp-updates</a>]</span> can be used for authorization of a sending PKI management entity.<a href="#section-3.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="extraCerts">
<section id="section-3.3">
        <h3 id="name-general-description-of-cmp-">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-general-description-of-cmp-" class="section-name selfRef">General description of CMP message extraCerts</a>
        </h3>
<p id="section-3.3-1">This section describes the generic extraCerts field of all CMP messages with signature-based protection.  Any specific requirements on the extraCerts are specified in the respective PKI management operation.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.3-2">
<pre>
extraCerts
    -- SHOULD contain the CMP protection certificate together with
    -- its chain, if needed
    -- If present, the first certificate in this field MUST be
    -- the CMP protection certificate followed by its chain
    -- where each element SHOULD directly certify the one
    -- immediately preceding it.
    -- Self-signed certificates SHOULD be omitted from extraCerts,
    -- unless they are the same as the protection certificate and
    -- MUST NOT be trusted based on their inclusion in any case
</pre><a href="#section-3.3-2" class="pilcrow">¶</a>
</div>
<p id="section-3.3-3">Note: For maximum compatibility, all implementations SHOULD be prepared to handle potentially additional certificates and arbitrary orderings of the certificates.<a href="#section-3.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Prereq">
<section id="section-3.4">
        <h3 id="name-generic-pki-management-oper">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-generic-pki-management-oper" class="section-name selfRef">Generic PKI management operation prerequisites</a>
        </h3>
<p id="section-3.4-1">This subsection describes what is generally needed by the PKI entities to be able to perform PKI management operations.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<p id="section-3.4-2" class="keepWithNext">Identification of PKI entities:<a href="#section-3.4-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4-3.1">Each EE SHOULD know its own identity to fill the sender field.<a href="#section-3.4-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.4-3.2">
            <p id="section-3.4-3.2.1">Each EE SHOULD know the intended recipient of its requests to fill the recipient field, e.g., the name of the addressed CA.<a href="#section-3.4-3.2.1" class="pilcrow">¶</a></p>
<p id="section-3.4-3.2.2">Note: This name may be established using an enrollment voucher, e.g., <span>[<a href="#RFC8366" class="xref">RFC8366</a>]</span>, the issuer field from a CertReqTemplate response message content, or by other configuration means.<a href="#section-3.4-3.2.2" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.4-4" class="keepWithNext">Routing of CMP messages:<a href="#section-3.4-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4-5.1">
            <p id="section-3.4-5.1.1">Each PKI entity sending messages upstream MUST know the address needed for transferring messages to the next PKI management entity.<a href="#section-3.4-5.1.1" class="pilcrow">¶</a></p>
<p id="section-3.4-5.1.2">Note: This address may depend on the recipient, the certificate profile, and on the used transfer mechanism.<a href="#section-3.4-5.1.2" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.4-6" class="keepWithNext">Authentication of PKI entities:<a href="#section-3.4-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4-7.1">Each PKI entity MUST have credentials to authenticate itself. For signature-based protection it MUST have a private key and the corresponding certificate along with its chain.<a href="#section-3.4-7.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.4-7.2">
            <p id="section-3.4-7.2.1">Each PKI entity MUST be able to establish trust in PKI it receives responses from. When signature-based protection is used, it MUST have the trust anchor(s) and any certificate status information needed to perform path validation of CMP protection certificates used for signature-based protection.<a href="#section-3.4-7.2.1" class="pilcrow">¶</a></p>
<p id="section-3.4-7.2.2">Note: A trust anchor usually is a root certificate of the PKI addressed by the requesting EE. It may be established by configuration or in an out-of-band manner.  For an EE it may be established using an enrollment voucher <span>[<a href="#RFC8366" class="xref">RFC8366</a>]</span> or in-band of CMP by the caPubs field in a certificate response message.<a href="#section-3.4-7.2.2" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.4-8" class="keepWithNext">Authorization of PKI management operations:<a href="#section-3.4-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4-9.1">
            <p id="section-3.4-9.1.1">Each EE or RA MUST have sufficient information to be able to authorize the PKI management entity for performing the upstream PKI management operation.<a href="#section-3.4-9.1.1" class="pilcrow">¶</a></p>
<p id="section-3.4-9.1.2">Note: This may be achieved for example by using the cmcRA extended key usage in server certificates, by local configuration such as specific name patterns for subject DN or SAN portions that may identify an RA, and/or by having a dedicated root CA usable only for authenticating PKI management entities.<a href="#section-3.4-9.1.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-9.2">
            <p id="section-3.4-9.2.1">Each PKI management entity MUST have sufficient information to be able to authorize the downstream PKI entity requesting the PKI management operation.<a href="#section-3.4-9.2.1" class="pilcrow">¶</a></p>
<p id="section-3.4-9.2.2">Note: For authorizing an RA the same examples apply as above. The authorization of EEs can be very specific to the application domain based on local PKI policy.<a href="#section-3.4-9.2.2" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="Validation">
<section id="section-3.5">
        <h3 id="name-generic-validation-of-a-pki">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-generic-validation-of-a-pki" class="section-name selfRef">Generic validation of a PKI message</a>
        </h3>
<p id="section-3.5-1">This section describes generic validation steps of each PKI entity receiving a PKI request or response message before any further processing or forwarding.  If a PKI management entity decides to terminate a PKI management operation because a check failed, it MUST send a negative response or an error message as described in <a href="#Error" class="xref">Section 3.6</a>. The PKIFailureInfo bits given below in parentheses MAY be used in the failInfo field of the PKIStatusInfo as described in <a href="#Error_reporting" class="xref">Section 3.6.4</a>, see also <span><a href="#RFC4210" class="xref">RFC 4210 Appendix F</a> [<a href="#RFC4210" class="xref">RFC4210</a>]</span>.<a href="#section-3.5-1" class="pilcrow">¶</a></p>
<p id="section-3.5-2">All PKI message header fields not mentioned in this section like the recipient and generalInfo fields SHOULD be handled gracefully on reception.<a href="#section-3.5-2" class="pilcrow">¶</a></p>
<p id="section-3.5-3" class="keepWithNext">The following list describes the basic set of message input validation steps. Without these checks the protocol becomes dysfunctional.<a href="#section-3.5-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5-4.1">The formal ASN.1 syntax of the whole message MUST be compliant with the definitions given in <span><a href="#RFC4210" class="xref">CMP</a> [<a href="#RFC4210" class="xref">RFC4210</a>]</span> and <span>[<a href="#I-D.ietf-lamps-cmp-updates" class="xref">I-D.ietf-lamps-cmp-updates</a>]</span>, <span><a href="#RFC4211" class="xref">CRMF</a> [<a href="#RFC4211" class="xref">RFC4211</a>]</span>, and <span><a href="#RFC5652" class="xref">CMS</a> [<a href="#RFC5652" class="xref">RFC5652</a>]</span> and <span>[<a href="#RFC8933" class="xref">RFC8933</a>]</span>. (failInfo: badDataFormat)<a href="#section-3.5-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.5-4.2">The pvno MUST be cmp2000(2) or cmp2021(3). (failInfo bit: unsupportedVersion)<a href="#section-3.5-4.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.5-4.3">The transactionID MUST be present. (failInfo bit: badDataFormat)<a href="#section-3.5-4.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.5-4.4">The PKI message body type MUST be one of the message types supported by the receiving PKI entity and MUST be allowed in the current state of the PKI management operation identified by the given transactionID. (failInfo bit: badRequest)<a href="#section-3.5-4.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.5-5" class="keepWithNext">The following list describes the set of message input validation steps required to ensure secure protocol operation:<a href="#section-3.5-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5-6.1">The senderNonce MUST be present and MUST contain at least 128 bits of data. (failInfo bit: badSenderNonce)<a href="#section-3.5-6.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.5-6.2">
            <p id="section-3.5-6.2.1">Unless the PKI message is the first message of a PKI management operation,<a href="#section-3.5-6.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5-6.2.2.1">the recipNonce MUST be present and MUST equal the senderNonce of the previous message or equal the senderNonce of the most recent request message for which the response was delayed, in case of delayed delivery as specified in <a href="#EE_Polling" class="xref">Section 4.4</a>. (failInfo bit: badRecipientNonce)<a href="#section-3.5-6.2.2.1" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-3.5-6.3">
            <p id="section-3.5-6.3.1">The message protection MUST be validated:<a href="#section-3.5-6.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5-6.3.2.1">The protection MUST be signature-based except if MAC-based protection is used as described in <a href="#EE_MAC" class="xref">Section 4.1.5</a> and for some error messages as described in <a href="#Error_reporting" class="xref">Section 3.6.4</a>. (failInfo bit: wrongIntegrity)<a href="#section-3.5-6.3.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.5-6.3.2.2">The senderKID SHOULD identify the key material used for verifying the message protection. (failInfo bit: badMessageCheck)<a href="#section-3.5-6.3.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.5-6.3.2.3">The protection, if present, MUST be validated successfully. If signature-based protection is used, the CMP protection certificate MUST be successfully validated including path validation using a trust anchor and MUST be authorized according to local policies. If the keyUsage extension is present in the CMP protection certificate the digitalSignature bit SHOULD be set. (failInfo bit: badAlg, badMessageCheck, or signerNotTrusted)<a href="#section-3.5-6.3.2.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.5-6.3.2.4">The sender of a request message MUST be authorized for requesting the operation according to PKI policies. (failInfo bit: notAuthorized)<a href="#section-3.5-6.3.2.4" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-3.5-6.4">
        </ul>
<p id="section-3.5-7">Note: The requirements for checking certificates given in <span><a href="#RFC5280" class="xref">RFC 5280</a> [<a href="#RFC5280" class="xref">RFC5280</a>]</span> MUST be followed for signature-based CMP message protection.  Unless the message is a positive ip/cp/kup where the issuing CA certificate of the newly enrolled certificate is the same as the CMP protection certificate of that message, certificate status checking SHOULD be performed on the CMP protection certificates.<a href="#section-3.5-7" class="pilcrow">¶</a></p>
<p id="section-3.5-8" class="keepWithNext">Depending on local policies, one or more of the input validation checks described below need to be implemented:<a href="#section-3.5-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5-9.1">If signature-based protection is used, the sender field SHOULD match the subject of the CMP protection certificate. (failInfo bit: badMessageCheck)<a href="#section-3.5-9.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.5-9.2">If the messageTime is present, it SHOULD be close to the current time. (failInfo bit: badTime)<a href="#section-3.5-9.2" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="Error">
<section id="section-3.6">
        <h3 id="name-error-handling">
<a href="#section-3.6" class="section-number selfRef">3.6. </a><a href="#name-error-handling" class="section-name selfRef">Error handling</a>
        </h3>
<p id="section-3.6-1">This section describes how a PKI entity handles error conditions on messages it receives. Each error condition SHOULD be logged appropriately.<a href="#section-3.6-1" class="pilcrow">¶</a></p>
<div id="Error_upstream">
<section id="section-3.6.1">
          <h4 id="name-reporting-error-conditions-">
<a href="#section-3.6.1" class="section-number selfRef">3.6.1. </a><a href="#name-reporting-error-conditions-" class="section-name selfRef">Reporting error conditions upstream</a>
          </h4>
<p id="section-3.6.1-1">An EE SHALL NOT send error messages.  PKI management entities SHALL NOT send error messages in upstream direction, either.<a href="#section-3.6.1-1" class="pilcrow">¶</a></p>
<p id="section-3.6.1-2">In case an EE rejects a newly issued certificate contained in an ip, cp, or kup message and implicit confirmation has not been granted, the EE MUST report this using a certConf message with "rejection" status and await the pkiConf response as described in <a href="#EE_newPKI" class="xref">Section 4.1.1</a>.<a href="#section-3.6.1-2" class="pilcrow">¶</a></p>
<p id="section-3.6.1-3">On all other error conditions regarding response messages, the EE or PKI management entity MUST regard the current PKI management operation as terminated with failure. The error conditions include<a href="#section-3.6.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.6.1-4.1">invalid response message header, body type, protection, or extraCerts according to the checks described in <a href="#Validation" class="xref">Section 3.5</a>,<a href="#section-3.6.1-4.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.6.1-4.2">any issue detected with response message contents,<a href="#section-3.6.1-4.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.6.1-4.3">receipt of an error message from upstream,<a href="#section-3.6.1-4.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.6.1-4.4">timeout occurred while waiting for a response,<a href="#section-3.6.1-4.4" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.6.1-4.5">rejection of a newly issued certificate while implicit confirmation has been granted.<a href="#section-3.6.1-4.5" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-3.6.1-5">Upstream PKI management entities will not receive any CMP message to learn that the PKI management operation has been terminated. In case they expect a further message from the EE, a connection interruption or timeout will occur. Then they also MUST regard the current PKI management operation as terminated with failure and MUST NOT attempt to send an error message downstream.<a href="#section-3.6.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Error_downstream">
<section id="section-3.6.2">
          <h4 id="name-reporting-error-conditions-d">
<a href="#section-3.6.2" class="section-number selfRef">3.6.2. </a><a href="#name-reporting-error-conditions-d" class="section-name selfRef">Reporting error conditions downstream</a>
          </h4>
<p id="section-3.6.2-1">In case the PKI management entity detects an error condition, e.g., rejecting the request due to policy decision, in the body of an ir, cr, p10cr, kur, or rr message received from downstream, it SHOULD report the error in the specific response message, i.e., an ip, cp, kup, or rp with "rejection" status, as described in <a href="#EE_newPKI" class="xref">Section 4.1.1</a> and <a href="#EE_Revoke" class="xref">Section 4.2</a>. This can also happen in case of polling.<a href="#section-3.6.2-1" class="pilcrow">¶</a></p>
<p id="section-3.6.2-2">In case the PKI management entity detects any other error condition on requests, including pollReq, certConf, genm, and nested messages, received from downstream and on responses received from upstream, such as invalid message header, body type, protection, or extraCerts according to the checks described in <a href="#Validation" class="xref">Section 3.5</a> it MUST report them downstream in the form of an error message as described in <a href="#Error_reporting" class="xref">Section 3.6.4</a>.<a href="#section-3.6.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Error_nested">
<section id="section-3.6.3">
          <h4 id="name-handling-error-conditions-o">
<a href="#section-3.6.3" class="section-number selfRef">3.6.3. </a><a href="#name-handling-error-conditions-o" class="section-name selfRef">Handling error conditions on nested messages used for batching</a>
          </h4>
<p id="section-3.6.3-1">Batching of messages using nested messages as described in <a href="#RA_AddBatch" class="xref">Section 5.2.2.2</a> requires special error handling.<a href="#section-3.6.3-1" class="pilcrow">¶</a></p>
<p id="section-3.6.3-2">If the error condition is on an upstream nested message containing batched requests, it MUST NOT attempt to respond to the individual requests included in it.<a href="#section-3.6.3-2" class="pilcrow">¶</a></p>
<p id="section-3.6.3-3">In case a PKI management entity receives an error message in response to a nested message, it must propagate the error by responding with an error message to each of the request messages contained in the nested message.<a href="#section-3.6.3-3" class="pilcrow">¶</a></p>
<p id="section-3.6.3-4">In case a PKI management entity detects an error condition on the downstream nested message received in response to a nested message sent before, it MAY ignore this error condition and handle the response as described in <a href="#RA_AddBatch" class="xref">Section 5.2.2.2</a>. Otherwise, it MUST propagate the error by responding with an error message to each of the requests contained in the nested message it sent originally.<a href="#section-3.6.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Error_reporting">
<section id="section-3.6.4">
          <h4 id="name-reporting-error-conditions">
<a href="#section-3.6.4" class="section-number selfRef">3.6.4. </a><a href="#name-reporting-error-conditions" class="section-name selfRef">Reporting error conditions</a>
          </h4>
<p id="section-3.6.4-1">When sending any kind of negative response, including error messages, a PKI entity MUST indicate the error condition in the PKIStatusInfo structure of the respective message as described below.  It then MUST regard the current PKI management operation as terminated with failure.<a href="#section-3.6.4-1" class="pilcrow">¶</a></p>
<p id="section-3.6.4-2" class="keepWithNext">The PKIStatusInfo structure is used to report errors.  It may be part of various message types, in particular: certConf, ip, cp, kup, and error. The PKIStatusInfo structure consists of the following fields:<a href="#section-3.6.4-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.6.4-3.1">
              <p id="section-3.6.4-3.1.1">status: Here the PKIStatus value "rejection" MUST be used.<a href="#section-3.6.4-3.1.1" class="pilcrow">¶</a></p>
<p id="section-3.6.4-3.1.2">Note: When a PKI management entity indicates delayed delivery of a CMP response message to the EE with an error message as described in <a href="#EE_Polling" class="xref">Section 4.4</a>, the status "waiting" is used there.<a href="#section-3.6.4-3.1.2" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.6.4-3.2">statusString: Here any human-readable valid value for logging or to display via a user interface SHOULD be added.<a href="#section-3.6.4-3.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.6.4-3.3">
              <p id="section-3.6.4-3.3.1">failInfo: Here the PKIFailureInfo bits MAY be used in the way explained in <span><a href="#RFC4210" class="xref">Appendix F of RFC 4210</a> [<a href="#RFC4210" class="xref">RFC4210</a>]</span>.  PKIFailureInfo bits regarding the validation described in <a href="#Validation" class="xref">Section 3.5</a> are referenced there. The PKIFailureInfo bits referenced in <a href="#RA_response" class="xref">Section 5.1</a> and <a href="#Transfer_types" class="xref">Section 6</a> are described here:<a href="#section-3.6.4-3.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.6.4-3.3.2.1">badCertId: A kur, certConf, or rr message references an unknown certificate<a href="#section-3.6.4-3.3.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-3.6.4-3.3.2.2">badPOP: An ir/cr/p10cr/kur contains an invalid proof-of-possession<a href="#section-3.6.4-3.3.2.2" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-3.6.4-3.3.2.3">certRevoked: Revocation requested for a certificate already revoked<a href="#section-3.6.4-3.3.2.3" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-3.6.4-3.3.2.4">badCertTemplate: The contents of a certificate request are not accepted, e.g., a field is missing or has a non-acceptable value or the given public key is already in use in some other certificate (depending on policy).<a href="#section-3.6.4-3.3.2.4" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-3.6.4-3.3.2.5">transactionIdInUse: This is sent by a PKI management entity in case the received request contains a transactionID that has already been used for another transaction.  An EE receiving such error message SHOULD resend the request in a new transaction using a different transactionID.<a href="#section-3.6.4-3.3.2.5" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-3.6.4-3.3.2.6">notAuthorized: The sender of a request message is not authorized for requesting the operation.<a href="#section-3.6.4-3.3.2.6" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-3.6.4-3.3.2.7">systemUnavail: This is sent by a PKI management entity in case a back-end system is not available.<a href="#section-3.6.4-3.3.2.7" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-3.6.4-3.3.2.8">systemFailure: This is sent by a PKI management entity in case a back-end system is currently not functioning correctly.<a href="#section-3.6.4-3.3.2.8" class="pilcrow">¶</a>
</li>
              </ul>
</li>
          </ul>
<p id="section-3.6.4-4">An EE receiving a systemUnavail or systemFailure failInfo SHOULD resend the request in a new transaction after some time.<a href="#section-3.6.4-4" class="pilcrow">¶</a></p>
<p id="section-3.6.4-5" class="keepWithNext">Detailed error message description:<a href="#section-3.6.4-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.6.4-6">
<pre>
Error Message -- error

Field                         Value

header
    -- As described in Section 3.1

body
    -- The message indicating the error that occurred
  error                       REQUIRED
    pKIStatusInfo             REQUIRED
      status                  REQUIRED
    -- MUST have the value "rejection"
      statusString            RECOMMENDED
    -- SHOULD be any human-readable text for debugging, logging
    -- or to display in a GUI
      failInfo                OPTIONAL
    -- MAY be present and contain the relevant PKIFailureInfo bits

protection                    REQUIRED
    -- As described in Section 3.2

extraCerts                    OPTIONAL
    -- As described in Section 3.3
</pre><a href="#section-3.6.4-6" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="EE_UseCases">
<section id="section-4">
      <h2 id="name-end-entity-pki-management-o">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-end-entity-pki-management-o" class="section-name selfRef">End Entity PKI management operations</a>
      </h2>
<p id="section-4-1">This chapter focuses on the communication of an EE with the PKI management entity it directly talks to.  Depending on the network and PKI solution, this can be an RA or directly a CA. Handling of a message by a PKI management entity is described in <a href="#RA_UseCases" class="xref">Section 5</a>.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2" class="keepWithNext">The PKI management operations specified in this section cover the following:<a href="#section-4-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-3.1">Requesting a certificate with variations like initial enrollment, certificate updates, central key generation, and MAC-based protection<a href="#section-4-3.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-3.2">Revoking a certificate<a href="#section-4-3.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-3.3">Support messages<a href="#section-4-3.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-4-4">These operations mainly specify the message body of the CMP messages and utilize the specification of the message header, protection and extraCerts as specified in <a href="#GenericParts" class="xref">Section 3</a>. The messages are named by the respective field names in PKIBody like ir, ip, cr, cp, etc., see <span><a href="#RFC4210" class="xref">RFC 4210 Section 5.1.2</a> [<a href="#RFC4210" class="xref">RFC4210</a>]</span>.<a href="#section-4-4" class="pilcrow">¶</a></p>
<p id="section-4-5">The following diagram shows the EE state machine covering all PKI management operations described in this section, including negative responses, error messages described in <a href="#Error_reporting" class="xref">Section 3.6.4</a>, as well as ip/cp/kup/error messages with status "waiting", pollReq, and pollRep messages described in <a href="#EE_Polling" class="xref">Section 4.4</a>.<a href="#section-4-5" class="pilcrow">¶</a></p>
<p id="section-4-6">On receiving messages from upstream, the EE MUST perform the general validation checks described in <a href="#Validation" class="xref">Section 3.5</a>. The behavior in case an error occurs is described in <a href="#Error" class="xref">Section 3.6</a>.<a href="#section-4-6" class="pilcrow">¶</a></p>
<div id="EE_State_Machine">
<div class="alignLeft art-text artwork" id="section-4-7">
<pre>
State machine:
                         start
                           |
                           | send ir/cr/p10cr/kur/rr/genm
                           v
                 waiting for response
                           |
+--------------------------+--------------------------+
|                          |                          |
| receives ip/cp/kup with  | received ip/cp/kup/error | received
| status "accepted" or     | with status "waiting"    | rp/genp or
| "grantedWithMods"        |                          | ip/cp/kup/
|                          v                          | error
|             +-------&gt; polling                       | with status
|             |            |                          | "rejection"
|             | received   | send                     |
|             | pollRep    | pollReq                  |
|             |            v                          |
|             |   waiting for response                |
|             |            |                          |
|             +------------+--------+                 |
|                          |        |                 |
|       received ip/cp/kup |        | received        |
|   with status "accepted" |        | rp/genp or      |
|     or "grantedWithMods" |        | ip/cp/kup/error |
|                          |        | with status     |
+----------&gt;+&lt;-------------+        | "rejection"     |
            |                       |                 |
+-----------+-----+                 |                 |
|                 |                 |                 |
| implicitConfirm | implicitConfirm |                 |
| granted         | not granted     |                 |
|                 |                 |                 |
|                 | send certConf   |                 |
|                 v                 |                 |
|        waiting for pkiConf*)      |                 |
|                 |                 |                 |
|                 | received        |                 |
|                 | pkiConf         |                 |
+-----------------+-------&gt;+&lt;-------+-----------------+
                           |
                           v
                          end

*) in case of a delayed delivery of pkiConf responses the same
   polling mechanism is initiated as for rp or genp messages, by
   sending an error message with status "waiting".
</pre><a href="#section-4-7" class="pilcrow">¶</a>
</div>
</div>
<p id="section-4-8">Note: All CMP messages belonging to the same PKI management operation MUST have the same transactionID because the message receiver identifies the elements of the operation in this way.<a href="#section-4-8" class="pilcrow">¶</a></p>
<p id="section-4-9">This section is aligned with <span><a href="#RFC4210" class="xref">CMP</a> [<a href="#RFC4210" class="xref">RFC4210</a>]</span>, <span><a href="#I-D.ietf-lamps-cmp-updates" class="xref">CMP Updates</a> [<a href="#I-D.ietf-lamps-cmp-updates" class="xref">I-D.ietf-lamps-cmp-updates</a>]</span>, and <span><a href="#I-D.ietf-lamps-cmp-algorithms" class="xref">CMP Algorithms</a> [<a href="#I-D.ietf-lamps-cmp-algorithms" class="xref">I-D.ietf-lamps-cmp-algorithms</a>]</span>.<a href="#section-4-9" class="pilcrow">¶</a></p>
<p id="section-4-10">Guidelines as well as an algorithm use profile for this document are available in <span><a href="#I-D.ietf-lamps-cmp-algorithms" class="xref">CMP Algorithms</a> [<a href="#I-D.ietf-lamps-cmp-algorithms" class="xref">I-D.ietf-lamps-cmp-algorithms</a>]</span>.<a href="#section-4-10" class="pilcrow">¶</a></p>
<div id="EE_request">
<section id="section-4.1">
        <h3 id="name-requesting-a-new-certificat">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-requesting-a-new-certificat" class="section-name selfRef">Requesting a new certificate from a PKI</a>
        </h3>
<p id="section-4.1-1">There are various approaches for requesting a certificate from a PKI.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2" class="keepWithNext">These approaches differ in the way the EE authenticates itself to the PKI, in the form of the request being used, and how the key pair to be certified is generated. The authentication mechanisms may be as follows:<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-3.1">Using a certificate from an external PKI, e.g., a manufacturer-issued device certificate, and the corresponding private key<a href="#section-4.1-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.1-3.2">Using a private key and certificate issued from the same PKI that is addressed for requesting a certificate<a href="#section-4.1-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.1-3.3">Using the certificate to be updated and the corresponding private key<a href="#section-4.1-3.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.1-3.4">Using shared secret information known to the EE and the PKI management entity<a href="#section-4.1-3.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.1-4">An EE requests a certificate indirectly or directly from a CA.  When the PKI management entity handles the request as described in <a href="#RA_response_enrollment" class="xref">Section 5.1.1</a> and responds with a message containing the requested certificate, the EE MUST reply with a confirmation message unless implicitConfirm was granted. The PKI management entity then MUST handle it as described in <a href="#RA_response_confirmation" class="xref">Section 5.1.3</a> and respond with a confirmation, closing the PKI management operation.<a href="#section-4.1-4" class="pilcrow">¶</a></p>
<p id="section-4.1-5">The message sequences described in this section allow the EE to request certification of a locally or centrally generated public-private key pair. Typically, the EE  provides a signature-based proof-of-possession of the private key associated with the public key contained in the certificate request as defined by <span><a href="#RFC4211" class="xref">RFC 4211 Section 4.1</a> [<a href="#RFC4211" class="xref">RFC4211</a>]</span> case 3. To this end it is assumed that the private key can technically be used for signing.  This is the case for the most common algorithms RSA and ECDSA, regardless of potentially intended restrictions of the key usage.<a href="#section-4.1-5" class="pilcrow">¶</a></p>
<p id="section-4.1-6">Note: In conformance with <span><a href="#NIST.SP.800-57p1r5" class="xref">NIST SP 800-57 Part 1 Section 8.1.5.1.1.2</a> [<a href="#NIST.SP.800-57p1r5" class="xref">NIST.SP.800-57p1r5</a>]</span> the newly generated private key MAY be used for self-signature, if technically possible, even if the keyUsage extension requested in the certificate request prohibits generation of digital signatures.<a href="#section-4.1-6" class="pilcrow">¶</a></p>
<p id="section-4.1-7">The requesting EE provides the binding of the proof-of-possession to its identity by signature-based or MAC-based protection of the CMP request message containing that POP. An upstream PKI management entity should verify whether this EE is authorized to obtain a certificate with the requested subject and other fields and extensions.<a href="#section-4.1-7" class="pilcrow">¶</a></p>
<p id="section-4.1-8">The EE MAY indicate the certificate profile to use in the certProfile extension of the generalInfo field in the PKIHeader of the certificate request message as described in <a href="#Header" class="xref">Section 3.1</a>.<a href="#section-4.1-8" class="pilcrow">¶</a></p>
<p id="section-4.1-9">In case the EE receives a CA certificate in the caPubs field for installation as a new trust anchor, it MUST properly authenticate the message and authorize the sender as trusted source of the new trust anchor.  This authorization is typically indicated using shared secret information for protecting an initialization response (ir) message. Authorization can also be signature-based using a certificate issued by another PKI that is explicitly authorized for this purpose.  A certificate received in caPubs MUST NOT be accepted as a trust anchor if it is the root CA certificate of the certificate used for protecting the message.<a href="#section-4.1-9" class="pilcrow">¶</a></p>
<div id="EE_newPKI">
<section id="section-4.1.1">
          <h4 id="name-requesting-a-certificate-fr">
<a href="#section-4.1.1" class="section-number selfRef">4.1.1. </a><a href="#name-requesting-a-certificate-fr" class="section-name selfRef">Requesting a certificate from a new PKI with signature-based protection</a>
          </h4>
<p id="section-4.1.1-1">This PKI management operation should be used by an EE to request a certificate from a new PKI using an existing certificate from an external PKI, e.g., a manufacturer-issued IDevID certificate <span>[<a href="#IEEE.802.1AR_2018" class="xref">IEEE.802.1AR_2018</a>]</span>, to authenticate itself to the new PKI.<a href="#section-4.1.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1.1-2">Note: In <span><a href="#RFC8995" class="xref">Bootstrapping Remote Secure Key Infrastructure (BRSKI)</a> [<a href="#RFC8995" class="xref">RFC8995</a>]</span> environments, <span><a href="#I-D.ietf-anima-brski-async-enroll" class="xref">BRSKI Asynchronous Enrollment (BRSKI-AE)</a> [<a href="#I-D.ietf-anima-brski-async-enroll" class="xref">I-D.ietf-anima-brski-async-enroll</a>]</span> describes a generalization regarding enrollment protocols alternative to <span><a href="#RFC7030" class="xref">EST</a> [<a href="#RFC7030" class="xref">RFC7030</a>]</span>.  As replacement of EST simpleenroll, BRSKI-AE uses this PKI management operation for bootstrapping LDevID certificates.<a href="#section-4.1.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1.1-3" class="keepWithNext">Specific prerequisites augmenting the prerequisites in <a href="#Prereq" class="xref">Section 3.4</a>:<a href="#section-4.1.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1.1-4.1">The certificate of the EE MUST have been enrolled by an external PKI, e.g., a manufacturer-issued device certificate.<a href="#section-4.1.1-4.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.1.1-4.2">The PKI management entity MUST have the trust anchor of the external PKI.<a href="#section-4.1.1-4.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.1.1-4.3">When using the generalInfo field certProfile, the EE MUST know the identifier needed to indicate the requested certificate profile.<a href="#section-4.1.1-4.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.1.1-5" class="keepWithNext">Message flow:<a href="#section-4.1.1-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1.1-6">
<pre>
Step# EE                                  PKI management entity
  1   format ir
  2                      -&gt;   ir      -&gt;
  3                                        handle or
                                             forward ir
  4                                        format or receive ip
  5                                        possibly grant
                                             implicitConfirm
  6                      &lt;-   ip      &lt;-
  7   handle ip

-----------------  if implicitConfirm not granted  -----------------

  8   format certConf
  9                      -&gt;   certConf -&gt;
 10                                        handle or
                                             forward certConf
 11                                        format or receive pkiConf
 12                      &lt;-   pkiConf  &lt;-
 13   handle pkiConf
</pre><a href="#section-4.1.1-6" class="pilcrow">¶</a>
</div>
<p id="section-4.1.1-7">For this PKI management operation, the EE MUST include exactly one CertReqMsg in the ir.  If more certificates are required, further requests MUST be sent using separate PKI management operation.<a href="#section-4.1.1-7" class="pilcrow">¶</a></p>
<p id="section-4.1.1-8">The EE SHOULD include the implicitConfirm extension in the header of the ir message as described in <a href="#Header" class="xref">Section 3.1</a>, unless it knows that certificate confirmation is needed.  This leaves the choice to the PKI management entities whether the EE must send a certConf message on receiving a new certificate.  Depending on the PKI policy and requirements for managing EE certificates, it can be important for PKI management entities to learn if the EE accepted the new certificate.  In such cases, when responding with an ip message, the PKI management entity MUST NOT include the implicitConfirm extension.  In case the PKI management entity does not need any explicit confirmation from the EE, it MUST include the extension as described in <a href="#Header" class="xref">Section 3.1</a>. This prevents explicit certificate confirmation and saves the overhead of a further message round-trip.<a href="#section-4.1.1-8" class="pilcrow">¶</a></p>
<p id="section-4.1.1-9">If the EE did not request implicit confirmation or implicit confirmation was not granted by the PKI management entity, certificate confirmation MUST be performed as follows.  If the EE successfully received the certificate, it MUST send a certConf message in due time. On receiving a valid certConf message, the PKI management entity MUST respond with a pkiConf message. If the PKI management entity does not receive the expected certConf message in time it MUST handle this like a rejection by the EE.  In case of rejection, depending on its policy the PKI management entity MAY revoke the newly issued certificate, notify a monitoring system, or log the event internally.<a href="#section-4.1.1-9" class="pilcrow">¶</a></p>
<p id="section-4.1.1-10">Note: Depending on PKI policy, a new certificate may be published by a PKI management entity, and explicit confirmation may be required. In this case it is advisable not to do the publication until a positive certificate confirmation has been received.  This way the need to revoke the certificate on negative confirmation is avoided.<a href="#section-4.1.1-10" class="pilcrow">¶</a></p>
<p id="section-4.1.1-11">If the certificate request was rejected by the CA, the PKI management entity must return an ip message containing the status code "rejection" as described in <a href="#Error" class="xref">Section 3.6</a> and no certifiedKeyPair field.  The EE MUST NOT react to such an ip message with a certConf message and the PKI management operation MUST be terminated.<a href="#section-4.1.1-11" class="pilcrow">¶</a></p>
<p id="section-4.1.1-12" class="keepWithNext">Detailed message description:<a href="#section-4.1.1-12" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1.1-13">
<pre>
Initialization Request -- ir

Field                         Value

header
    -- As described in Section 3.1

body
    -- The request of the EE for a new certificate
  ir                          REQUIRED
    -- MUST contain exactly one CertReqMsg
    -- If more certificates are required, further PKI management
    -- operations MUST be initiated
    certReq                   REQUIRED
      certReqId               REQUIRED
    -- MUST be 0
      certTemplate            REQUIRED
        version               OPTIONAL
    -- MUST be 2 if supplied
        subject               REQUIRED
    -- The EE subject name MUST be carried in the subject field
    -- and/or the subjectAltName extension.
    -- If subject name is present only in the subjectAltName
    -- extension, then the subject field MUST be a NULL-DN
        publicKey             REQUIRED
          algorithm           REQUIRED
    -- MUST include the subject public key algorithm identifier
          subjectPublicKey    REQUIRED
    -- MUST contain the public key to be certified in case of local
    -- key generation
        extensions            OPTIONAL
    -- MAY include end-entity-specific X.509 extensions of the
    -- requested certificate like subject alternative name, key
    -- usage, and extended key usage
    -- The subjectAltName extension MUST be present if the EE subject
    -- name includes a subject alternative name.
    popo                      OPTIONAL
    -- MUST be present if local key generation is used
    -- MUST be absent if central key generation is requested
      signature               RECOMMENDED
    -- MUST be used by an EE if the key can be used for signing and
    -- has the type POPOSigningKey
        poposkInput           PROHIBITED
    -- MUST NOT be used; it is not needed because subject and
    -- publicKey are both present in the certTemplate
        algorithmIdentifier   REQUIRED
    -- The signature algorithm MUST be consistent with the publicKey
    -- algorithm field of the certTemplate
        signature             REQUIRED
    -- MUST contain the signature value computed over the DER-encoded
    -- certTemplate
      raVerified              OPTIONAL
    -- MAY be used by an RA after verifying the proof-of-possession
    -- provided by the EE

protection                    REQUIRED
    -- As described in Section 3.2

extraCerts                    REQUIRED
    -- As described in Section 3.3


Initialization Response -- ip

Field                         Value

header
    -- As described in Section 3.1

body
    -- The response of the CA to the request as appropriate
  ip                          REQUIRED
    caPubs                    OPTIONAL
    -- MAY be used if the certifiedKeyPair field is present
    -- If used it MUST contain only a trust anchor, e.g. root
    -- certificate, of the certificate contained in certOrEncCert
    response                  REQUIRED
    -- MUST contain exactly one CertResponse
      certReqId               REQUIRED
    -- MUST be 0
      status                  REQUIRED
    -- PKIStatusInfo structure MUST be present
        status                REQUIRED
    -- positive values allowed: "accepted", "grantedWithMods"
    -- negative values allowed: "rejection"
    -- "waiting" only allowed with polling use case as described in
    -- Section 4.4
        statusString          OPTIONAL
    -- MAY be any human-readable text for debugging, logging or to
    -- display in a GUI
        failInfo              OPTIONAL
    -- MAY be present if status is "rejection"
    -- MUST be absent if status is "accepted" or "grantedWithMods"
      certifiedKeyPair        OPTIONAL
    -- MUST be present if status is "accepted" or "grantedWithMods"
    -- MUST be absent if status is "rejection"
        certOrEncCert         REQUIRED
    -- MUST be present if status is "accepted" or "grantedWithMods"
          certificate         REQUIRED
    -- MUST be present when certifiedKeyPair is present
    -- MUST contain the newly enrolled X.509 certificate
        privateKey            OPTIONAL
    -- MUST be absent in case of local key generation or "rejection"
    -- MUST contain the encrypted private key in an EnvelopedData
    -- structure as specified in Section 4.1.6 in case the private
    -- key was generated centrally

protection                    REQUIRED
    -- As described in Section 3.2

extraCerts                    REQUIRED
    -- As described in Section 3.3
    -- MUST contain the chain of the certificate present in
    -- certOrEncCert
    -- Self-signed certificates SHOULD be omitted
    -- Duplicate certificates MAY be omitted


Certificate Confirmation -- certConf

Field                         Value

header
    -- As described in Section 3.1

body
    -- The message of the EE sends as confirmation to the PKI
    -- management entity to accept or reject the issued certificates
  certConf                    REQUIRED
    -- MUST contain exactly one CertStatus
    CertStatus                REQUIRED
      certHash                REQUIRED
    -- MUST be the hash of the certificate, using the hash algorithm
    -- indicated in hashAlg, see below, or the same one as used to
    -- create the certificate signature
      certReqId               REQUIRED
    -- MUST be 0
      statusInfo              RECOMMENDED
    -- PKIStatusInfo structure SHOULD be present
    -- Omission indicates acceptance of the indicated certificate
        status                REQUIRED
    -- positive values allowed: "accepted"
    -- negative values allowed: "rejection"
        statusString          OPTIONAL
    -- MAY be any human-readable text for debugging, logging, or to
    -- display in a GUI
        failInfo              OPTIONAL
    -- MAY be present if status is "rejection"
    -- MUST be absent if status is "accepted"
      hashAlg                 OPTIONAL
    -- The hash algorithm to use for calculating certHash
    -- SHOULD NOT be used in all cases where the AlgorithmIdentifier
    -- of the certificate signature specifies a hash algorithm
    -- If used, the pvno field in the header MUST be cmp2021 (3)

protection                    REQUIRED
    -- As described in Section 3.2
    -- MUST use the same credentials as in the first request message
    -- of this PKI management operation

extraCerts                    RECOMMENDED
    -- As described in Section 3.3
    -- MAY be omitted if the message size is critical and
    -- the PKI management entity caches the extraCerts from the
    -- first request message of this PKI management operation


PKI Confirmation -- pkiConf

Field                         Value

header
    -- As described in Section 3.1

body
  pkiconf                     REQUIRED
    -- The content of this field MUST be NULL

protection                    REQUIRED
    -- As described in Section 3.2
    -- MUST use the same credentials as in the first response
    -- message of this PKI management operation

extraCerts                    RECOMMENDED
    -- As described in Section 3.3
    -- MAY be omitted if the message size is critical and the EE has
    -- cached the extraCerts from the first response message of
    -- this PKI management operation
</pre><a href="#section-4.1.1-13" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="EE_trustedPKI">
<section id="section-4.1.2">
          <h4 id="name-requesting-an-additional-ce">
<a href="#section-4.1.2" class="section-number selfRef">4.1.2. </a><a href="#name-requesting-an-additional-ce" class="section-name selfRef">Requesting an additional certificate with signature-based protection</a>
          </h4>
<p id="section-4.1.2-1">This PKI management operation should be used by an EE to request an additional certificate of the same PKI it already has certificates from.  The EE uses one of these existing certificates to authenticate itself by signing its request messages using the respective private key.<a href="#section-4.1.2-1" class="pilcrow">¶</a></p>
<p id="section-4.1.2-2" class="keepWithNext">Specific prerequisites augmenting the prerequisites in <a href="#Prereq" class="xref">Section 3.4</a>:<a href="#section-4.1.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1.2-3.1">The certificate used by the EE MUST have been enrolled by the PKI it requests another certificate from.<a href="#section-4.1.2-3.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.1.2-3.2">When using the generalInfo field certProfile, the EE MUST know the identifier needed to indicate the requested certificate profile.<a href="#section-4.1.2-3.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.1.2-4" class="keepWithNext">The message sequence for this PKI management operation is identical to that given in <a href="#EE_newPKI" class="xref">Section 4.1.1</a>, with the following changes:<a href="#section-4.1.2-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-4.1.2-5">
     <dt>1</dt>
<dd id="section-4.1.2-5.1">
              <p id="section-4.1.2-5.1.1">The body of the first request and response SHOULD be cr and cp, respectively.<a href="#section-4.1.2-5.1.1" class="pilcrow">¶</a></p>
<p id="section-4.1.2-5.1.2">Note: Since the difference between ir/ip and cr/cp is syntactically not essential, an ir/ip MAY be used in this PKI management operation.<a href="#section-4.1.2-5.1.2" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt>2</dt>
<dd id="section-4.1.2-5.2">The caPubs field in the certificate response message SHOULD be absent.<a href="#section-4.1.2-5.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="EE_Update">
<section id="section-4.1.3">
          <h4 id="name-updating-an-existing-certif">
<a href="#section-4.1.3" class="section-number selfRef">4.1.3. </a><a href="#name-updating-an-existing-certif" class="section-name selfRef">Updating an existing certificate with signature protection</a>
          </h4>
<p id="section-4.1.3-1">This PKI management operation should be used by an EE to request an update for one of its certificates that is still valid.  The EE uses the certificate it wishes to update as the protection certificate. Both for authenticating itself and for proving ownership of the certificate to be updated, it signs the request messages with the corresponding private key.<a href="#section-4.1.3-1" class="pilcrow">¶</a></p>
<p id="section-4.1.3-2" class="keepWithNext">Specific prerequisites augmenting the prerequisites in <a href="#Prereq" class="xref">Section 3.4</a>:<a href="#section-4.1.3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1.3-3.1">The certificate the EE wishes to update MUST NOT be expired or revoked and MUST have been issued by the addressed CA.<a href="#section-4.1.3-3.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.1.3-3.2">A new public-private key pair SHOULD be used.<a href="#section-4.1.3-3.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.1.3-3.3">When using the generalInfo field certProfile, the EE MUST know the identifier needed to indicate the requested certificate profile.<a href="#section-4.1.3-3.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.1.3-4" class="keepWithNext">The message sequence for this PKI management operation is identical to that given in <a href="#EE_newPKI" class="xref">Section 4.1.1</a>, with the following changes:<a href="#section-4.1.3-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-4.1.3-5">
     <dt>1</dt>
<dd id="section-4.1.3-5.1">The body of the first request and response MUST be kur and kup, respectively.<a href="#section-4.1.3-5.1" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt>2</dt>
<dd id="section-4.1.3-5.2">Protection of the kur MUST be performed using the certificate to be updated.<a href="#section-4.1.3-5.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt>3</dt>
<dd id="section-4.1.3-5.3">The subject field and/or the subjectAltName extension of the certTemplate MUST contain the EE subject name of the existing certificate to be updated, without modifications.<a href="#section-4.1.3-5.3" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt>4</dt>
<dd id="section-4.1.3-5.4">The certTemplate SHOULD contain the subject and/or subjectAltName extension and publicKey of the EE only.<a href="#section-4.1.3-5.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt>5</dt>
<dd id="section-4.1.3-5.5">The oldCertId control MAY be used to make clear which certificate is to be updated.<a href="#section-4.1.3-5.5" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt>6</dt>
<dd id="section-4.1.3-5.6">The caPubs field in the kup message MUST be absent.<a href="#section-4.1.3-5.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-4.1.3-6" class="keepWithNext">As part of the certReq structure of the kur the oldCertId control is added after the certTemplate field.<a href="#section-4.1.3-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1.3-7">
<pre>
    controls
      type                    RECOMMENDED
    -- MUST be the value id-regCtrl-oldCertID, if present
      value
        issuer                REQUIRED
        serialNumber          REQUIRED
    -- MUST contain the issuer and serialNumber of the certificate
    -- to be updated
</pre><a href="#section-4.1.3-7" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="EE_P10">
<section id="section-4.1.4">
          <h4 id="name-requesting-a-certificate-fro">
<a href="#section-4.1.4" class="section-number selfRef">4.1.4. </a><a href="#name-requesting-a-certificate-fro" class="section-name selfRef">Requesting a certificate from a legacy PKI using a PKCS#10 request</a>
          </h4>
<p id="section-4.1.4-1">This PKI management operation can be used by an EE to request a certificate using a legacy <span><a href="#RFC2986" class="xref">PKCS#10</a> [<a href="#RFC2986" class="xref">RFC2986</a>]</span> request instead of <span><a href="#RFC4211" class="xref">CRMF</a> [<a href="#RFC4211" class="xref">RFC4211</a>]</span>. This offers a variation of the PKI management operations specified in <a href="#EE_trustedPKI" class="xref">Section 4.1.2</a>.<a href="#section-4.1.4-1" class="pilcrow">¶</a></p>
<p id="section-4.1.4-2">In <span><a href="#RFC8572" class="xref">Secure Zero Touch Provisioning (SZTP)</a> [<a href="#RFC8572" class="xref">RFC8572</a>]</span> environments, <span><a href="#I-D.ietf-netconf-sztp-csr" class="xref">SZTP-CSR</a> [<a href="#I-D.ietf-netconf-sztp-csr" class="xref">I-D.ietf-netconf-sztp-csr</a>]</span> describes the use of a CMP p10cr message as a form of certificate signing request (CSR) to optionally include in device bootstrapping to obtain an identity certificate as part of the onboarding information.  Such a CSR is of form ietf-sztp-types:cmp-csr from module ietf-sztp-csr.  The requirements given below on p10cr message MUST be adhered to.<a href="#section-4.1.4-2" class="pilcrow">¶</a></p>
<p id="section-4.1.4-3">In this PKI management operation, the public key and all further certificate template data MUST be contained in the subjectPKInfo and other certificationRequestInfo fields of the PKCS#10 structure.<a href="#section-4.1.4-3" class="pilcrow">¶</a></p>
<p id="section-4.1.4-4">The prerequisites are the same as given in <a href="#EE_trustedPKI" class="xref">Section 4.1.2</a>.<a href="#section-4.1.4-4" class="pilcrow">¶</a></p>
<p id="section-4.1.4-5" class="keepWithNext">The message sequence for this PKI management operation is identical to that given in <a href="#EE_trustedPKI" class="xref">Section 4.1.2</a>, with the following changes:<a href="#section-4.1.4-5" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-4.1.4-6">
<dt>1</dt>
<dd id="section-4.1.4-6.1">The body of the first request and response MUST be p10cr and cp, respectively.<a href="#section-4.1.4-6.1" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt>2</dt>
<dd id="section-4.1.4-6.2">The certReqId in the cp message MUST be -1.<a href="#section-4.1.4-6.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt>3</dt>
<dd id="section-4.1.4-6.3">The caPubs field in the cp message SHOULD be absent.<a href="#section-4.1.4-6.3" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-4.1.4-7" class="keepWithNext">Detailed description of the p10cr message:<a href="#section-4.1.4-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1.4-8">
<pre>
Certification Request -- p10cr

Field                         Value

header
    -- As described in Section 3.1

body
    -- The request of the EE for a new certificate using a PKCS#10
    -- certificate request
  p10cr                       REQUIRED
    certificationRequestInfo  REQUIRED
      version                 REQUIRED
    -- MUST be 0 to indicate PKCS#10 V1.7
      subject                 REQUIRED
    -- The EE subject name MUST be carried in the subject field
    -- and/or the subjectAltName extension.
    -- If subject name is present only in the subjectAltName
    -- extension, then the subject field MUST be a NULL-DN
      subjectPKInfo           REQUIRED
        algorithm             REQUIRED
    -- MUST include the subject public key algorithm identifier
        subjectPublicKey      REQUIRED
    -- MUST include the public key to be certified
      attributes              OPTIONAL
    -- MAY include end-entity-specific X.509 extensions of the
    -- requested certificate like subject alternative name,
    -- key usage, and extended key usage
    -- The subjectAltName extension MUST be present if the EE
    -- subject name includes a subject alternative name.
    signatureAlgorithm        REQUIRED
    -- The signature algorithm MUST be consistent with the
    -- subjectPKInfo field.
    signature                 REQUIRED
    -- MUST contain the self-signature for proof-of-possession

protection                    REQUIRED
    -- As described for the underlying PKI management operation

extraCerts                    REQUIRED
    -- As described for the underlying PKI management operation
</pre><a href="#section-4.1.4-8" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="EE_MAC">
<section id="section-4.1.5">
          <h4 id="name-requesting-a-certificate-from">
<a href="#section-4.1.5" class="section-number selfRef">4.1.5. </a><a href="#name-requesting-a-certificate-from" class="section-name selfRef">Requesting a certificate from a PKI with MAC-based protection</a>
          </h4>
<p id="section-4.1.5-1">This is a variant of the PKI management operations described in <a href="#EE_newPKI" class="xref">Section 4.1.1</a> to <a href="#EE_P10" class="xref">Section 4.1.4</a>.  It should be used by an EE to request a certificate of a new PKI in case it does not have a certificate to prove its identity to the target PKI, but has some secret information shared with the PKI management entity.  Therefore, the request and response messages are MAC-protected using this shared secret information.  The distribution of this shared secret is out of scope for this document. The PKI management entity checking the MAC-based protection SHOULD replace this protection according to <a href="#RA_Replace" class="xref">Section 5.2.3</a> in case the next hop does not know the shared secret information.<a href="#section-4.1.5-1" class="pilcrow">¶</a></p>
<p id="section-4.1.5-2">Note: The entropy of the shared secret information is crucial for the level of protection when using MAC-based protection.  Further guidance is available in the security considerations of CMP updated by <span>[<a href="#I-D.ietf-lamps-cmp-updates" class="xref">I-D.ietf-lamps-cmp-updates</a>]</span>.<a href="#section-4.1.5-2" class="pilcrow">¶</a></p>
<p id="section-4.1.5-3" class="keepWithNext">Specific prerequisites augmenting the prerequisites in <a href="#Prereq" class="xref">Section 3.4</a>:<a href="#section-4.1.5-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1.5-4.1">
              <p id="section-4.1.5-4.1.1">Rather than using private keys, certificates, and trust anchors, the EE and the PKI management entity MUST share secret information.<a href="#section-4.1.5-4.1.1" class="pilcrow">¶</a></p>
<p id="section-4.1.5-4.1.2">Note: The shared secret information MUST be established out-of-band, e.g., by a service technician during initial local configuration.<a href="#section-4.1.5-4.1.2" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.1.5-4.2">When using the generalInfo field certProfile, the EE MUST know the identifier needed to indicate the requested certificate profile.<a href="#section-4.1.5-4.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.1.5-5" class="keepWithNext">The message sequence for this PKI management operation is identical to that given in <a href="#EE_newPKI" class="xref">Section 4.1.1</a>, with the following changes:<a href="#section-4.1.5-5" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-4.1.5-6">
     <dt>1</dt>
<dd id="section-4.1.5-6.1">The protection of all messages MUST be MAC-based.<a href="#section-4.1.5-6.1" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt>2</dt>
<dd id="section-4.1.5-6.2">The senderKID MUST contain a reference the recipient can use to identify the shared secret information used for the protection, e.g., the username of the EE.<a href="#section-4.1.5-6.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt>3</dt>
<dd id="section-4.1.5-6.3">The extraCerts of all messages   does not contain CMP protection certs and associated chains.<a href="#section-4.1.5-6.3" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-4.1.5-7">See <a href="#Transfer_types" class="xref">Section 6</a> of <span><a href="#I-D.ietf-lamps-cmp-algorithms" class="xref">CMP Algorithms</a> [<a href="#I-D.ietf-lamps-cmp-algorithms" class="xref">I-D.ietf-lamps-cmp-algorithms</a>]</span> for details on message authentication code algorithms (MSG_MAC_ALG) to use. Typically, parameters are part of the protectionAlg field, e.g., used for key derivation, like a salt and an iteration count.  Such fields SHOULD remain constant for message protection throughout this PKI management operation to reduce the computational overhead.<a href="#section-4.1.5-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="EE_centralKeyGeneration">
<section id="section-4.1.6">
          <h4 id="name-adding-central-key-pair-gen">
<a href="#section-4.1.6" class="section-number selfRef">4.1.6. </a><a href="#name-adding-central-key-pair-gen" class="section-name selfRef">Adding central key pair generation to a certificate request</a>
          </h4>
<p id="section-4.1.6-1">This is a variant of the PKI management operations described in <a href="#EE_newPKI" class="xref">Section 4.1.1</a> to <a href="#EE_P10" class="xref">Section 4.1.4</a> and the variant described in <a href="#EE_MAC" class="xref">Section 4.1.5</a>. It needs to be used in case an EE is not able to generate its new public-private key pair itself or central generation of the EE key material is preferred.  It is a matter of the local implementation which PKI management entity will act as Key Generation Authority (KGA) and perform the key generation.  This PKI management entity MUST use a certificate containing the additional extended key usage extension id-kp-cmKGA in order to be accepted by the EE as a legitimate key generation authority.<a href="#section-4.1.6-1" class="pilcrow">¶</a></p>
<p id="section-4.1.6-2">As described in <a href="#RA_on-behalf_request" class="xref">Section 5.3.1</a>, the KGA can use one of the PKI management operations described in the sections above to request the certificate for this key pair on behalf of the EE.<a href="#section-4.1.6-2" class="pilcrow">¶</a></p>
<p id="section-4.1.6-3">Generally speaking, in machine-to-machine scenarios it is strongly preferable to generate public-private key pairs locally at the EE.  Together with proof-of-possession of the private key in the certificate request, this is advisable to make sure that the entity identified in the newly issued certificate is the only entity that knows the private key.<a href="#section-4.1.6-3" class="pilcrow">¶</a></p>
<p id="section-4.1.6-4" class="keepWithNext">Reasons for central key generation may include the following:<a href="#section-4.1.6-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1.6-5.1">
              <p id="section-4.1.6-5.1.1">Lack of sufficient initial entropy.<a href="#section-4.1.6-5.1.1" class="pilcrow">¶</a></p>
<p id="section-4.1.6-5.1.2">Note: Good random numbers are needed not only for key generation but also for session keys and nonces in any security protocol. Therefore, a decent security architecture should anyways support good random number generation on the EE side or provide enough initial entropy for the RNG seed to guarantee good pseudo-random number generation.  Yet maybe this is not the case at the time of requesting an initial certificate during manufacturing.<a href="#section-4.1.6-5.1.2" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.1.6-5.2">
              <p id="section-4.1.6-5.2.1">Lack of computational resources, in particular for RSA key generation.<a href="#section-4.1.6-5.2.1" class="pilcrow">¶</a></p>
<p id="section-4.1.6-5.2.2">Note: Since key generation could be performed in advance to the certificate enrollment communication, it is often not time critical.<a href="#section-4.1.6-5.2.2" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.1.6-6">Note: As mentioned in <a href="#Architecture" class="xref">Section 2</a>, central key generation may be required in a push model, where the certificate response message is transferred by the PKI management entity to the EE without a previous request message.<a href="#section-4.1.6-6" class="pilcrow">¶</a></p>
<p id="section-4.1.6-7">The EE requesting central key generation MUST omit the publicKey field from the certTemplate or, in case it has a preference on the key type to be generated, provide it in the algorithm sub-field and fill the subjectPublicKey sub-field with a zero-length BIT STRING.  Both variants indicate to the PKI management entity that a new key pair shall be generated centrally on behalf of the EE.<a href="#section-4.1.6-7" class="pilcrow">¶</a></p>
<p id="section-4.1.6-8">Note: As the protection of centrally generated keys in the response message has been extended to EncryptedKey by <span><a href="#I-D.ietf-lamps-cmp-updates" class="xref">CMP Updates Section 2.7</a> [<a href="#I-D.ietf-lamps-cmp-updates" class="xref">I-D.ietf-lamps-cmp-updates</a>]</span>, EnvelopedData is the preferred alternative to EncryptedValue.  In <span><a href="#RFC4211" class="xref">CRMF Section 2.1.9</a> [<a href="#RFC4211" class="xref">RFC4211</a>]</span> the use of EncryptedValue has been deprecated in favor of the EnvelopedData structure.  Therefore, this profile requires using EnvelopedData as specified in <span><a href="#RFC5652" class="xref">CMS Section 6</a> [<a href="#RFC5652" class="xref">RFC5652</a>]</span>.  When EnvelopedData is to be used in a PKI management operation, CMP v3 MUST be indicated in the message header already for the initial request message, see <span><a href="#I-D.ietf-lamps-cmp-updates" class="xref">CMP Updates Section 2.19 and Section 2.20</a> [<a href="#I-D.ietf-lamps-cmp-updates" class="xref">I-D.ietf-lamps-cmp-updates</a>]</span>.<a href="#section-4.1.6-8" class="pilcrow">¶</a></p>
<span id="name-encrypted-private-key-conta"></span><div id="CMP_envelop">
<figure id="figure-3">
            <div class="alignCenter art-text artwork" id="section-4.1.6-9.1">
<pre>
+----------------------------------+
| EnvelopedData                    |
| [RFC5652] section 6              |
| +------------------------------+ |
| | SignedData                   | |
| | [RFC5652] section 5          | |
| | +--------------------------+ | |
| | | AsymmetricKeyPackage     | | |
| | | [RFC5958]                | | |
| | | +----------------------+ | | |
| | | | privateKey           | | | |
| | | | OCTET STRING         | | | |
| | | +----------------------+ | | |
| | +--------------------------+ | |
| +------------------------------+ |
+----------------------------------+
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-encrypted-private-key-conta" class="selfRef">Encrypted private key container</a>
            </figcaption></figure>
</div>
<p id="section-4.1.6-10">The PKI management entity delivers the private key in the privateKey field in the certifiedKeyPair structure of the response message also containing the newly issued certificate.<a href="#section-4.1.6-10" class="pilcrow">¶</a></p>
<p id="section-4.1.6-11">The private key MUST be provided as an AsymmetricKeyPackage structure as defined in <span><a href="#RFC5958" class="xref">RFC 5958</a> [<a href="#RFC5958" class="xref">RFC5958</a>]</span>.<a href="#section-4.1.6-11" class="pilcrow">¶</a></p>
<p id="section-4.1.6-12">This AsymmetricKeyPackage structure MUST be wrapped in a SignedData structure, as specified in <span><a href="#RFC5652" class="xref">CMS Section 5</a> [<a href="#RFC5652" class="xref">RFC5652</a>]</span> and <span>[<a href="#RFC8933" class="xref">RFC8933</a>]</span>, signed by the KGA generating the key pair. The signature MUST be performed using a private key related to a certificate asserting the extended key usage id-kp-cmKGA as described in <span><a href="#I-D.ietf-lamps-cmp-updates" class="xref">CMP Updates  Section 2.2</a> [<a href="#I-D.ietf-lamps-cmp-updates" class="xref">I-D.ietf-lamps-cmp-updates</a>]</span> to demonstrate authorization to generate key pairs on behalf of an EE.  The EE SHOULD validate the signer certificate contained in the SignedData structure and verify the presence of this extended key usage in the signer certificate.<a href="#section-4.1.6-12" class="pilcrow">¶</a></p>
<p id="section-4.1.6-13">Note: When using password-based key management technique as described in <a href="#EE_KGPB" class="xref">Section 4.1.6.3</a> it may not be possible or meaningful to the EE to validate the KGA signature and the related certificate in the SignedData structure since shared secret information is used for initial authentication. In this case the EE MAY omit this validation.<a href="#section-4.1.6-13" class="pilcrow">¶</a></p>
<p id="section-4.1.6-14">The SignedData structure MUST be wrapped in an EnvelopedData structure, as specified in <span><a href="#RFC5652" class="xref">CMS Section 6</a> [<a href="#RFC5652" class="xref">RFC5652</a>]</span>, encrypting it using a newly generated symmetric content-encryption key.<a href="#section-4.1.6-14" class="pilcrow">¶</a></p>
<p id="section-4.1.6-15">This content-encryption key MUST be securely provided as part of the EnvelopedData structure to the EE using one of three key management techniques. The choice of the key management technique to be used by the PKI management entity depends on the authentication mechanism the EE chose to protect the request message. See <span><a href="#I-D.ietf-lamps-cmp-updates" class="xref">CMP Updates Section 2.7</a> [<a href="#I-D.ietf-lamps-cmp-updates" class="xref">I-D.ietf-lamps-cmp-updates</a>]</span> for more details on which key management technique to use.<a href="#section-4.1.6-15" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1.6-16.1">
              <p id="section-4.1.6-16.1.1">Signature-based protection of the request message:<a href="#section-4.1.6-16.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1.6-16.1.2.1">The content-encryption key SHALL be protected using the key agreement key management technique, see <a href="#EE_KGAgree" class="xref">Section 4.1.6.1</a>, if the certificate used by the EE for protecting the request message allows the key usage keyAgreement.  If the certificate also allows the key usage keyEncipherment, the key transport key management technique SHALL NOT be used.<a href="#section-4.1.6-16.1.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-4.1.6-16.1.2.2">The content-encryption key SHALL be protected using the key transport key management technique, see <a href="#EE_KGTrans" class="xref">Section 4.1.6.2</a>, if the certificate used by the EE for protecting the respective request message allows the key usage keyEncipherment but not keyAgreement.<a href="#section-4.1.6-16.1.2.2" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li class="normal" id="section-4.1.6-16.2">
              <p id="section-4.1.6-16.2.1">MAC-based protected of the request message:<a href="#section-4.1.6-16.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1.6-16.2.2.1">The content-encryption key SHALL be protected using the password-based key management technique, see <a href="#EE_KGPB" class="xref">Section 4.1.6.3</a>, if and only if the EE used MAC-based protection for the request message.<a href="#section-4.1.6-16.2.2.1" class="pilcrow">¶</a>
</li>
              </ul>
</li>
          </ul>
<p id="section-4.1.6-17">If central key generation is supported, support of the key agreement key management technique is REQUIRED and support of key transport and password-based key management techniques are OPTION, for two reasons: The key agreement key management technique is supported by most asymmetric algorithms, while the key transport key management technique is supported only by a very few of them.  The password-based key management technique shall only be used in combination with MAC-based protection, which is a sideline in this document.<a href="#section-4.1.6-17" class="pilcrow">¶</a></p>
<p id="section-4.1.6-18" class="keepWithNext">Specific prerequisites augmenting those of the respective certificate enrollment PKI management operations:<a href="#section-4.1.6-18" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1.6-19.1">If signature-based protection is used, the EE MUST be able to authenticate and authorize the KGA, using suitable information, which includes a trust anchor.<a href="#section-4.1.6-19.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.1.6-19.2">If MAC-based protection is used, the KGA MUST also know the shared secret information to protect the encrypted transport of the newly generated key pair. Consequently, the EE can also authorize the KGA.<a href="#section-4.1.6-19.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.1.6-19.3">The PKI management entity MUST have a certificate containing the additional extended key usage extension id-kp-cmKGA for signing the SignedData structure containing the private key package.<a href="#section-4.1.6-19.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.1.6-19.4">
              <p id="section-4.1.6-19.4.1">For encrypting the SignedData structure a fresh content-encryption key to be used by the symmetric encryption algorithm MUST be generated with sufficient entropy.<a href="#section-4.1.6-19.4.1" class="pilcrow">¶</a></p>
<p id="section-4.1.6-19.4.2">Note: The security strength of the protection of the generated private key should be similar or higher than the security strength of the generated private key.<a href="#section-4.1.6-19.4.2" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.1.6-20" class="keepWithNext">The detailed description of the privateKey field as follows:<a href="#section-4.1.6-20" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1.6-21">
<pre>
        privateKey            OPTIONAL
    -- MUST be an EnvelopedData structure as specified in CMS
    -- Section 6 [RFC5652]
          version             REQUIRED
    -- MUST be 2 for recipientInfo type KeyAgreeRecipientInfo and
    -- KeyTransRecipientInfo
    -- MUST be 0 for recipientInfo type PasswordRecipientInfo
          recipientInfos      REQUIRED
    -- MUST contain exactly one RecipientInfo, which MUST be
    -- kari of type KeyAgreeRecipientInfo (see section 4.1.6.1),
    -- ktri of type KeyTransRecipientInfo (see section 4.1.6.2), or
    -- pwri of type PasswordRecipientInfo (see section 4.1.6.3)
          encryptedContentInfo
                              REQUIRED
            contentType       REQUIRED
    -- MUST be id-signedData
            contentEncryptionAlgorithm
                              REQUIRED
    -- MUST be the algorithm identifier of the algorithm used for
    -- content encryption
    -- The algorithm type MUST be a PROT_SYM_ALG as specified in
    -- RFC-CMP-Alg Section 5
            encryptedContent  REQUIRED
    -- MUST be the SignedData structure as specified in CMS
    -- Section 5 [RFC5652] and [RFC8933] in encrypted form
              version         REQUIRED
    -- MUST be 3
              digestAlgorithms
                              REQUIRED
    -- MUST contain exactly one AlgorithmIdentifier element
    -- MUST be the algorithm identifier of the digest algorithm
    -- used for generating the signature and match the signature
    -- algorithm specified in signatureAlgorithm, see and [RFC8933]
              encapContentInfo
                              REQUIRED
    -- MUST contain the content that is to be signed
                eContentType  REQUIRED
    -- MUST be id-ct-KP-aKeyPackage as specified in [RFC5958]
                eContent      REQUIRED
    -- MUST be of type AsymmetricKeyPackage and
    -- MUST contain exactly one OneAsymmetricKey element
                      version REQUIRED
    -- MUST be 1 (indicating v2)
                      privateKeyAlgorithm
                              REQUIRED
    -- The privateKeyAlgorithm field MUST contain the algorithm
    -- identifier of the asymmetric key pair algorithm
                      privateKey
                              REQUIRED
                      publicKey
                              REQUIRED
    -- MUST contain the public key corresponding to the private key
    -- for simplicity and consistency with v2 of OneAsymmetricKey
              certificates    REQUIRED
    -- MUST contain the certificate for the private key used to sign
    -- the signedData content, together with its chain
    -- The first certificate in this field MUST be the KGA
    -- certificate used for protecting this content
    -- Self-signed certificates SHOULD NOT be included and MUST NOT
    -- be trusted based on their inclusion in any case
                signerInfos   REQUIRED
    -- MUST contain exactly one SignerInfo element
                version       REQUIRED
    -- MUST be 3
                sid           REQUIRED
                  subjectKeyIdentifier
                              REQUIRED
    -- MUST be the subjectKeyIdentifier of the KGA certificate
                digestAlgorithm
                              REQUIRED
    -- MUST be the same as in digestAlgorithms
                signedAttrs   REQUIRED
    -- MUST contain an id-contentType attribute containing the value
    -- id-ct-KP-aKeyPackage
    -- MUST contain an id-messageDigest attribute containing the
    -- message digest of eContent
    -- MAY contain an id-signingTime attribute containing the time
    -- of signature
    -- For details on the signed attributes see CMS Section 5.3 and
    -- Section 11 [RFC5652] and [RFC8933]
                signatureAlgorithm
                              REQUIRED
    -- MUST be the algorithm identifier of the signature algorithm
    -- used for calculation of the signature bits
    -- The signature algorithm type MUST be a MSG_SIG_ALG as
    -- specified in RFC-CMP-Alg Section 3 and MUST be consistent
    -- with the subjectPublicKeyInfo field of the KGA certificate
                signature     REQUIRED
    -- MUST be the digital signature of the encapContentInfo
</pre><a href="#section-4.1.6-21" class="pilcrow">¶</a>
</div>
<p id="section-4.1.6-22">NOTE: As stated in Section 1.5, all fields of the ASN.1 syntax that are defined in RFC 5652 [RFC5652] but are not explicitly specified here SHOULD NOT be used.<a href="#section-4.1.6-22" class="pilcrow">¶</a></p>
<div id="EE_KGAgree">
<section id="section-4.1.6.1">
            <h5 id="name-using-key-agreement-key-man">
<a href="#section-4.1.6.1" class="section-number selfRef">4.1.6.1. </a><a href="#name-using-key-agreement-key-man" class="section-name selfRef">Using key agreement key management technique</a>
            </h5>
<p id="section-4.1.6.1-1">This variant can be applied in combination with the PKI management operations specified in <a href="#EE_newPKI" class="xref">Section 4.1.1</a> to <a href="#EE_Update" class="xref">Section 4.1.3</a> using signature-based protection of CMP messages.  The EE certificate used for the signature-based protection of the request message MUST allow for the key usage "keyAgreement" and therefore, the related key pair MUST be used for establishment of the content-encryption key.  For this key management technique the KeyAgreeRecipientInfo structure MUST be used in the contentInfo field.<a href="#section-4.1.6.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1.6.1-2">The KeyAgreeRecipientInfo structure included into the EnvelopedData structure is specified in <span><a href="#RFC5652" class="xref">CMS Section 6.2.2</a> [<a href="#RFC5652" class="xref">RFC5652</a>]</span>.<a href="#section-4.1.6.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1.6.1-3" class="keepWithNext">The detailed description of the KeyAgreeRecipientInfo structure looks like this:<a href="#section-4.1.6.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1.6.1-4">
<pre>
            kari              REQUIRED
    -- MUST be a KeyAgreeRecipientInfo as specified in CMS Section
    -- 6.2.2 [RFC5652]
              version         REQUIRED
    -- MUST be 3
              originator      REQUIRED
    -- MUST contain the subjectKeyIdentifier of the certificate,
    -- and thereby identifies the sender's public key.
    -- MUST contain the same value as the senderKID in the
    -- message header
              ukm             RECOMMENDED
    -- MUST be used when 1-pass ECMQV is used
    -- SHOULD be present to ensure uniqueness of the key
    -- encryption key
              keyEncryptionAlgorithm
                              REQUIRED
    -- MUST be the algorithm identifier of the key agreement
    -- algorithm
    -- The algorithm type MUST be a KM_KA_ALG as specified in
    -- RFC-CMP-Alg Section 4.1
    -- The parameters field of the key agreement algorithm MUST
    -- contains the key wrap algorithm
    -- The algorithm type MUST be a KM_KW_ALG as specified in
    -- RFC-CMP-Alg Section 4.3
              recipientEncryptedKeys
                              REQUIRED
    -- MUST contain exactly one RecipientEncryptedKey element
                rid           REQUIRED
    -- MUST contain the rKeyId choice
                  rKeyId      REQUIRED
                    subjectKeyIdentifier
                              REQUIRED
    -- MUST contain the same value as the senderKID in the
    -- respective request message header
                  encryptedKey
                              REQUIRED
    -- MUST be the encrypted content-encryption key
</pre><a href="#section-4.1.6.1-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="EE_KGTrans">
<section id="section-4.1.6.2">
            <h5 id="name-using-key-transport-key-man">
<a href="#section-4.1.6.2" class="section-number selfRef">4.1.6.2. </a><a href="#name-using-key-transport-key-man" class="section-name selfRef">Using key transport key management technique</a>
            </h5>
<p id="section-4.1.6.2-1">This variant can be applied in combination with the PKI management operations specified in <a href="#EE_newPKI" class="xref">Section 4.1.1</a> to <a href="#EE_Update" class="xref">Section 4.1.3</a> using signature-based protection of CMP messages.  The EE certificate used for the signature-based protection of the request message MUST allow for the key usage "keyEncipherment" and not for "keyAgreement". Therefore, the related key pair MUST be used for encipherment of the content-encryption key.  For this key management technique, the KeyTransRecipientInfo structure MUST be used in the contentInfo field.<a href="#section-4.1.6.2-1" class="pilcrow">¶</a></p>
<p id="section-4.1.6.2-2">The KeyTransRecipientInfo structure included into the EnvelopedData structure is specified in <span><a href="#RFC5652" class="xref">CMS Section 6.2.1</a> [<a href="#RFC5652" class="xref">RFC5652</a>]</span>.<a href="#section-4.1.6.2-2" class="pilcrow">¶</a></p>
<p id="section-4.1.6.2-3" class="keepWithNext">The detailed description of the KeyTransRecipientInfo structure looks like this:<a href="#section-4.1.6.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1.6.2-4">
<pre>
            ktri              REQUIRED
    -- MUST be a KeyTransRecipientInfo as specified in CMS
    -- Section 6.2.1 [RFC5652]
              version         REQUIRED
    -- MUST be 2
              rid             REQUIRED
    -- MUST contain the subjectKeyIdentifier choice
                subjectKeyIdentifier
                              REQUIRED
    -- MUST contain the same value as the senderKID in the
    -- respective request message header
              keyEncryptionAlgorithm
                              REQUIRED
    -- MUST be the algorithm identifier of the key transport
    -- algorithm
    -- The algorithm type MUST be a KM_KT_ALG as specified in
    -- RFC-CMP-Alg Section 4.2
              encryptedKey    REQUIRED
    -- MUST be the encrypted content-encryption key
</pre><a href="#section-4.1.6.2-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="EE_KGPB">
<section id="section-4.1.6.3">
            <h5 id="name-using-password-based-key-ma">
<a href="#section-4.1.6.3" class="section-number selfRef">4.1.6.3. </a><a href="#name-using-password-based-key-ma" class="section-name selfRef">Using password-based key management technique</a>
            </h5>
<p id="section-4.1.6.3-1">This variant can be applied in combination with the PKI management operation specified in <a href="#EE_MAC" class="xref">Section 4.1.5</a> using MAC-based protection of CMP messages.  The shared secret information used for the MAC-based protection MUST also be used for the encryption of the content-encryption key but with a different salt value applied in the key derivation algorithm.  For this key management technique, the PasswordRecipientInfo structure MUST be used in the contentInfo field.<a href="#section-4.1.6.3-1" class="pilcrow">¶</a></p>
<p id="section-4.1.6.3-2">Note: The entropy of the shared secret information is crucial for the level of protection when using a password-based key management technique.  For centrally generated key pairs, the entropy of the shared secret information SHALL NOT be less than the security strength of the centrally generated key pair.  Further guidance is available in <a href="#Security" class="xref">Section 9</a>.<a href="#section-4.1.6.3-2" class="pilcrow">¶</a></p>
<p id="section-4.1.6.3-3">The PasswordRecipientInfo structure included into the EnvelopedData structure is specified in <span><a href="#RFC5652" class="xref">CMS Section 6.2.4</a> [<a href="#RFC5652" class="xref">RFC5652</a>]</span>.<a href="#section-4.1.6.3-3" class="pilcrow">¶</a></p>
<p id="section-4.1.6.3-4" class="keepWithNext">The detailed description of the PasswordRecipientInfo structure looks like this:<a href="#section-4.1.6.3-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1.6.3-5">
<pre>
            pwri              REQUIRED
    -- MUST be a PasswordRecipientInfo as specified in CMS
    -- Section 6.2.4 [RFC5652]
              version         REQUIRED
    -- MUST be 0
              keyDerivationAlgorithm
                              REQUIRED
    -- MUST be the algorithm identifier of the key derivation
    -- algorithm
    -- The algorithm type MUST be a KM_KD_ALG as specified in
    -- RFC-CMP-Alg Section 4.4
              keyEncryptionAlgorithm
                              REQUIRED
    -- MUST be the algorithm identifier of the key wrap algorithm
    -- The algorithm type MUST be a KM_KW_ALG as specified in
    -- RFC-CMP-Alg Section 4.3
              encryptedKey    REQUIRED
    -- MUST be the encrypted content-encryption key
</pre><a href="#section-4.1.6.3-5" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="EE_Revoke">
<section id="section-4.2">
        <h3 id="name-revoking-a-certificate">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-revoking-a-certificate" class="section-name selfRef">Revoking a certificate</a>
        </h3>
<p id="section-4.2-1">This PKI management operation should be used by an entity to request revocation of a certificate. Here the revocation request is used by an EE to revoke one of its own certificates.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">The revocation request message MUST be signed using the certificate that is to be revoked to prove the authorization to revoke. The revocation request message is signature-protected using this certificate. This requires, that the EE still possesses the private key. If this is not the case the revocation has to be initiated by other means, e.g., revocation by the RA as specified in <a href="#RA_on-behalf_revoke" class="xref">Section 5.3.2</a>.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2-3">An EE requests the revocation of an own certificate at the CA that issued this certificate. The PKI management entity handles the request as described in <a href="#RA_response_revocation" class="xref">Section 5.1.4</a> and responds with a message that contains the status of the revocation from the CA.<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<p id="section-4.2-4" class="keepWithNext">Specific prerequisites augmenting the prerequisites in <a href="#Prereq" class="xref">Section 3.4</a>:<a href="#section-4.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-5.1">The certificate the EE wishes to revoke is not yet expired or revoked.<a href="#section-4.2-5.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.2-6" class="keepWithNext">Message flow:<a href="#section-4.2-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2-7">
<pre>
Step# EE                                  PKI management entity
 1   format rr
 2                      -&gt;   rr      -&gt;
 3                                        handle or forward rr
 4                                        format or receive rp
 5                      &lt;-   rp      &lt;-
 6   handle rp
</pre><a href="#section-4.2-7" class="pilcrow">¶</a>
</div>
<p id="section-4.2-8">For this PKI management operation, the EE MUST include exactly one RevDetails structure in the rr message body. In case no generic error occurred the response to the rr MUST be an rp message containing a single status field.<a href="#section-4.2-8" class="pilcrow">¶</a></p>
<p id="section-4.2-9" class="keepWithNext">Detailed message description:<a href="#section-4.2-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2-10">
<pre>
Revocation Request -- rr

Field                         Value

header
    -- As described in Section 3.1

body
    -- The request of the EE to revoke its certificate
  rr                          REQUIRED
    -- MUST contain exactly one element of type RevDetails
    -- If more revocations are desired, further PKI management
    -- operations MUST be initiated
    certDetails               REQUIRED
    -- MUST be present and is of type CertTemplate
      serialNumber            REQUIRED
    -- MUST contain the certificate serialNumber attribute of the
    -- certificate to be revoked
      issuer                  REQUIRED
    -- MUST contain the issuer attribute of the certificate to be
    -- revoked
    crlEntryDetails           REQUIRED
    -- MUST contain exactly one reasonCode of type CRLReason (see
    -- [RFC5280] section 5.3.1)
    -- If the reason for this revocation is not known or shall not
    -- be published the reasonCode MUST be 0 = unspecified

protection                    REQUIRED
    -- As described in Section 3.2 and using the private key related
    -- to the certificate to be revoked

extraCerts                    REQUIRED
    -- As described in Section 3.3


Revocation Response -- rp

Field                         Value

header
    -- As described in Section 3.1

body
    -- The responds of the PKI management entity to the request as
    -- appropriate
  rp                          REQUIRED
    status                    REQUIRED
    -- MUST contain exactly one element of type PKIStatusInfo
      status                  REQUIRED
    -- positive value allowed: "accepted"
    -- negative value allowed: "rejection"
      statusString            OPTIONAL
    -- MAY be any human-readable text for debugging, logging or to
    -- display in a GUI
      failInfo                OPTIONAL
    -- MAY be present if status is "rejection"
    -- MUST be absent if the status is "accepted"

protection                    REQUIRED
    -- As described in section 3.2

extraCerts                    REQUIRED
    -- As described in section 3.3
</pre><a href="#section-4.2-10" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="EE_GeneralMessage">
<section id="section-4.3">
        <h3 id="name-support-messages">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-support-messages" class="section-name selfRef">Support messages</a>
        </h3>
<p id="section-4.3-1">The following support messages offer on demand in-band delivery of content relevant to the EE provided by a PKI management entity.  CMP general messages and general response are used for this purpose.  Depending on the environment, these requests may be answered by an RA or CA (see also <a href="#RA_response_support" class="xref">Section 5.1.5</a>).<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">The general messages and general response messages contain InfoTypeAndValue structures. In addition to those infoType values defined in <span><a href="#RFC4210" class="xref">RFC 4210</a> [<a href="#RFC4210" class="xref">RFC4210</a>]</span> and <span><a href="#I-D.ietf-lamps-cmp-updates" class="xref">CMP Updates</a> [<a href="#I-D.ietf-lamps-cmp-updates" class="xref">I-D.ietf-lamps-cmp-updates</a>]</span> further OIDs MAY be used to define new PKI management operations or new general-purpose support messages as needed in specific environments.<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<p id="section-4.3-3" class="keepWithNext">The following contents are specified in this document:<a href="#section-4.3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3-4.1">Get CA certificates<a href="#section-4.3-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.3-4.2">Get root CA certificate update<a href="#section-4.3-4.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.3-4.3">Get certificate request template<a href="#section-4.3-4.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.3-4.4">Get new CRLs<a href="#section-4.3-4.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.3-5">In the following the aspects common to all general messages (genm) and general response (genp) messages are described.<a href="#section-4.3-5" class="pilcrow">¶</a></p>
<p id="section-4.3-6" class="keepWithNext">Message flow:<a href="#section-4.3-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.3-7">
<pre>
Step# EE                                   PKI management entity
 1   format genm
 2                      -&gt;   genm    -&gt;
 3                                        handle or forward genm
 4                                        format or receive genp
 5                      &lt;-   genp    &lt;-
 6   handle genp
</pre><a href="#section-4.3-7" class="pilcrow">¶</a>
</div>
<p id="section-4.3-8" class="keepWithNext">Detailed message description:<a href="#section-4.3-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.3-9">
<pre>
General Message -- genm

Field                         Value

header
    -- As described in Section 3.1

body
    -- A request by the EE for information
  genm                        REQUIRED
    -- MUST contain exactly one element of type InfoTypeAndValue
    infoType                  REQUIRED
    -- MUST be the OID identifying one of the specific PKI
    -- management operations described below
    infoValue                 OPTIONAL
    -- MUST be as specified for the specific PKI management operation

protection                    REQUIRED
    -- As described in Section 3.2

extraCerts                    REQUIRED
    -- As described in Section 3.3


General Response -- genp

Field                         Value

header
    -- As described in Section 3.1

body
    -- The response of the PKI management entity providing
    -- information
  genp                        REQUIRED
    -- MUST contain exactly one element of type InfoTypeAndValue
    infoType                  REQUIRED
    -- MUST be the OID identifying the specific PKI management
    -- operation described below
    infoValue                 OPTIONAL
    -- MUST be as specified for the specific PKI management operation

protection                    REQUIRED
    -- As described in Section 3.2

extraCerts                    REQUIRED
    -- As described in Section 3.3
</pre><a href="#section-4.3-9" class="pilcrow">¶</a>
</div>
<div id="EE_CACerts">
<section id="section-4.3.1">
          <h4 id="name-get-ca-certificates">
<a href="#section-4.3.1" class="section-number selfRef">4.3.1. </a><a href="#name-get-ca-certificates" class="section-name selfRef">Get CA certificates</a>
          </h4>
<p id="section-4.3.1-1">This PKI management operation can be used by an EE to request CA certificates from the PKI management entity.<a href="#section-4.3.1-1" class="pilcrow">¶</a></p>
<p id="section-4.3.1-2">An EE requests CA certificates, e.g., for chain construction, from an PKI management entity by sending a general message with OID id-it-caCerts as specified in <span><a href="#I-D.ietf-lamps-cmp-updates" class="xref">CMP Updates Section 2.13</a> [<a href="#I-D.ietf-lamps-cmp-updates" class="xref">I-D.ietf-lamps-cmp-updates</a>]</span>. The PKI management entity responds with a general response with the same OID that either contains a SEQUENCE of certificates populated with the available intermediate and issuing CA certificates or with no content in case no CA certificate is available.<a href="#section-4.3.1-2" class="pilcrow">¶</a></p>
<p id="section-4.3.1-3">No specific prerequisites apply in addition to those specified in <a href="#Prereq" class="xref">Section 3.4</a>.<a href="#section-4.3.1-3" class="pilcrow">¶</a></p>
<p id="section-4.3.1-4" class="keepWithNext">The message sequence for this PKI management operation is as given above, with the following specific content:<a href="#section-4.3.1-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-4.3.1-5">
     <dt>1</dt>
<dd id="section-4.3.1-5.1">the infoType OID to use is id-it-caCerts<a href="#section-4.3.1-5.1" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt>2</dt>
<dd id="section-4.3.1-5.2">the infoValue of the request MUST be absent<a href="#section-4.3.1-5.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt>3</dt>
<dd id="section-4.3.1-5.3">if present, the infoValue of the response MUST contain a sequence of certificates<a href="#section-4.3.1-5.3" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-4.3.1-6" class="keepWithNext">The infoValue field of the general response containing the id-it-caCerts OID looks like this:<a href="#section-4.3.1-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.3.1-7">
<pre>
      infoValue               OPTIONAL
    -- MUST be absent if no CA certificate is available
    -- MUST be present if CA certificates are available
    -- MUST be a sequence of CMPCertificate
</pre><a href="#section-4.3.1-7" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="EE_RootCAUpdate">
<section id="section-4.3.2">
          <h4 id="name-get-root-ca-certificate-upd">
<a href="#section-4.3.2" class="section-number selfRef">4.3.2. </a><a href="#name-get-root-ca-certificate-upd" class="section-name selfRef">Get root CA certificate update</a>
          </h4>
<p id="section-4.3.2-1">This PKI management operation can be used by an EE to request an updated root CA Certificate as described in <span><a href="#RFC4210" class="xref">Section 4.4 of RFC 4210</a> [<a href="#RFC4210" class="xref">RFC4210</a>]</span>.<a href="#section-4.3.2-1" class="pilcrow">¶</a></p>
<p id="section-4.3.2-2">An EE requests an update of a root CA certificate from the PKI management entity by sending a general message with OID id-it-rootCaCert, which SHOULD include the old root CA certificate in the message body, as specified in <span><a href="#I-D.ietf-lamps-cmp-updates" class="xref">CMP Updates Section 2.14</a> [<a href="#I-D.ietf-lamps-cmp-updates" class="xref">I-D.ietf-lamps-cmp-updates</a>]</span>.  The PKI management entity responds with a general response with OID id-it-rootCaKeyUpdate that either contains the update of the root CA certificate consisting of up to three certificates, or with no content in case no update is available.<a href="#section-4.3.2-2" class="pilcrow">¶</a></p>
<p id="section-4.3.2-3">Note: This mechanism may also be used to update trusted non-root certificates, i.e., trusted intermediate CA or issuing CA certificates.<a href="#section-4.3.2-3" class="pilcrow">¶</a></p>
<p id="section-4.3.2-4">The newWithNew certificate is the new root CA certificate and is REQUIRED to be present if available.  The newWithOld certificate is REQUIRED to be present in the response message because it is needed for the receiving entity trusting the old root CA certificate to gain trust in the new root CA certificate.  The oldWithNew certificate is OPTIONAL because it is only needed in rare scenarios where entities do not already trust the old root CA.<a href="#section-4.3.2-4" class="pilcrow">¶</a></p>
<p id="section-4.3.2-5">No specific prerequisites apply in addition to those specified in <a href="#Prereq" class="xref">Section 3.4</a>.<a href="#section-4.3.2-5" class="pilcrow">¶</a></p>
<p id="section-4.3.2-6" class="keepWithNext">The message sequence for this PKI management operation is as given above, with the following specific content:<a href="#section-4.3.2-6" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-4.3.2-7">
     <dt>1</dt>
<dd id="section-4.3.2-7.1">the infoType OID to use is id-it-rootCaCert in the request and id-it-rootCaKeyUpdate in the response<a href="#section-4.3.2-7.1" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt>2</dt>
<dd id="section-4.3.2-7.2">the infoValue of the request SHOULD contain the root CA certificate the update is requested for<a href="#section-4.3.2-7.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt>3</dt>
<dd id="section-4.3.2-7.3">if present, the infoValue of the response MUST be a RootCaKeyUpdateContent structure<a href="#section-4.3.2-7.3" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-4.3.2-8" class="keepWithNext">The infoValue field of the general request containing the id-it-rootCaCert OID looks like this:<a href="#section-4.3.2-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.3.2-9">
<pre>
      infoValue               RECOMMENDED
    -- MUST contain the root CA certificate to be updated, if
    -- available
</pre><a href="#section-4.3.2-9" class="pilcrow">¶</a>
</div>
<p id="section-4.3.2-10" class="keepWithNext">The infoValue field of the general response containing the id-it-rootCaKeyUpdate OID looks like this:<a href="#section-4.3.2-10" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.3.2-11">
<pre>
      infoValue               OPTIONAL
    -- MUST be absent if no update of the root CA certificate is
    -- available
    -- MUST be present if an update of the root CA certificate
    -- is available and MUST be of type RootCaKeyUpdateContent
        newWithNew            REQUIRED
    -- MUST be present if infoValue is present
    -- MUST contain the new root CA certificate
        newWithOld            REQUIRED
    -- MUST be present if infoValue is present
    -- MUST contain a certificate containing the new public
    -- root CA key signed with the old private root CA key
        oldWithNew            OPTIONAL
    -- MAY be present if infoValue is present
    -- MUST contain a certificate containing the old public
    -- root CA key signed with the new private root CA key
</pre><a href="#section-4.3.2-11" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="EE_Temp">
<section id="section-4.3.3">
          <h4 id="name-get-certificate-request-tem">
<a href="#section-4.3.3" class="section-number selfRef">4.3.3. </a><a href="#name-get-certificate-request-tem" class="section-name selfRef">Get certificate request template</a>
          </h4>
<p id="section-4.3.3-1">This PKI management operation can be used by an EE to request a template with parameters for future certificate requests.<a href="#section-4.3.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3.3-2">An EE requests certificate request parameters from the PKI management entity by sending a general message with OID id-it-certReqTemplate as specified in <span><a href="#I-D.ietf-lamps-cmp-updates" class="xref">CMP Updates Section 2.15</a> [<a href="#I-D.ietf-lamps-cmp-updates" class="xref">I-D.ietf-lamps-cmp-updates</a>]</span>.  The EE MAY indicate the certificate profile to use in the id-it-certProfile extension of the generalInfo field in the PKIHeader of the general message as described in <a href="#Header" class="xref">Section 3.1</a>.  The PKI management entity responds with a general response with the same OID that either contains requirements on the certificate request template, or with no content in case no specific requirements are imposed by the PKI. The CertReqTemplateValue contains requirements on certificate fields and extensions in a certTemplate. Optionally it contains a keySpec field containing requirements on algorithms acceptable for key pair generation.<a href="#section-4.3.3-2" class="pilcrow">¶</a></p>
<p id="section-4.3.3-3">The EE SHOULD follow the requirements from the received CertTemplate, by including in the certificate requests all the fields requested, taking over all the field values provided and filling in any remaining fields values. The EE SHOULD NOT add further fields, name components, and extensions or their (sub-)components.<a href="#section-4.3.3-3" class="pilcrow">¶</a></p>
<p id="section-4.3.3-4">Note: We deliberately do not use "MUST" or "MUST NOT" here in order to allow more flexibility in case the rules given here are not sufficient for specific scenarios. The EE can populate the certificate request as wanted and ignore any of the requirements contained in the CertReqTemplateValue. On the other hand, a PKI management entity is free to ignore or replace any parts of the content of the certificate request provided by the EE. The CertReqTemplate PKI management operation offers means to ease a joint understanding which fields and/or which field values should be used. An example is provided in <a href="#Param_Example" class="xref">Appendix A</a>.<a href="#section-4.3.3-4" class="pilcrow">¶</a></p>
<p id="section-4.3.3-5">In case a field of type Name, e.g., subject, is present in the CertTemplate but has the value NULL-DN (i.e., has an empty list of RDN components), the field SHOULD be included in the certificate request and filled with content provided by the EE. Similarly, in case an X.509v3 extension is present but its extnValue is empty, this means that the extension SHOULD be included and filled with content provided by the EE. In case a Name component, for instance a common name or serial number, is given but has an empty string value, the EE SHOULD fill in a value. Similarly, in case an extension has sub-components (e.g., an IP address in a SubjectAltName field) with empty value, the EE SHOULD fill in a value.<a href="#section-4.3.3-5" class="pilcrow">¶</a></p>
<p id="section-4.3.3-6">The EE MUST ignore (i.e., not include and fill in) empty fields, extensions, and sub-components that it does not understand or does not know suitable values to be filled in.<a href="#section-4.3.3-6" class="pilcrow">¶</a></p>
<p id="section-4.3.3-7">The publicKey field of type SubjectPublicKeyInfo in the CertTemplate of the CertReqTemplateValue MUST be omitted. In case the PKI management entity wishes to make stipulation on algorithms the EE may use for key generation, this MUST be specified using the keySpec field as specified in <span><a href="#I-D.ietf-lamps-cmp-updates" class="xref">CMP Updates Section 2.15</a> [<a href="#I-D.ietf-lamps-cmp-updates" class="xref">I-D.ietf-lamps-cmp-updates</a>]</span>.<a href="#section-4.3.3-7" class="pilcrow">¶</a></p>
<p id="section-4.3.3-8">The keySpec field, if present, specifies the public key types optionally with parameters, and/or RSA key lengths for which a certificate may be requested.<a href="#section-4.3.3-8" class="pilcrow">¶</a></p>
<p id="section-4.3.3-9">The value of a keySpec element with the OID id-regCtrl-algId, as specified in <span><a href="#I-D.ietf-lamps-cmp-updates" class="xref">CMP Updates Section 2.15</a> [<a href="#I-D.ietf-lamps-cmp-updates" class="xref">I-D.ietf-lamps-cmp-updates</a>]</span>, MUST be of type AlgorithmIdentifier and give an algorithm other than RSA.  For EC keys the curve information MUST be specified as described in the respective standard documents.<a href="#section-4.3.3-9" class="pilcrow">¶</a></p>
<p id="section-4.3.3-10">The value of a keySpec element with the OID id-regCtrl-rsaKeyLen, as specified in <span><a href="#I-D.ietf-lamps-cmp-updates" class="xref">CMP Updates Section 2.15</a> [<a href="#I-D.ietf-lamps-cmp-updates" class="xref">I-D.ietf-lamps-cmp-updates</a>]</span>, MUST be a positive integer value and give an RSA key length.<a href="#section-4.3.3-10" class="pilcrow">¶</a></p>
<p id="section-4.3.3-11">In the CertTemplate of the CertReqTemplateValue the serialNumber, signingAlg, issuerUID, and subjectUID fields MUST be omitted.<a href="#section-4.3.3-11" class="pilcrow">¶</a></p>
<p id="section-4.3.3-12" class="keepWithNext">Specific prerequisites augmenting the prerequisites in <a href="#Prereq" class="xref">Section 3.4</a>:<a href="#section-4.3.3-12" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.3-13.1">When using the generalInfo field certProfile, the EE MUST know the identifier needed to indicate the requested certificate profile.<a href="#section-4.3.3-13.1" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.3.3-14" class="keepWithNext">The message sequence for this PKI management operation is as given above, with the following specific content:<a href="#section-4.3.3-14" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-4.3.3-15">
     <dt>1</dt>
<dd id="section-4.3.3-15.1">the infoType OID to use is id-it-certReqTemplate<a href="#section-4.3.3-15.1" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt>2</dt>
<dd id="section-4.3.3-15.2">the id-it-certProfile generalInfo field in the header of the request MAY contain the name of the requested certificate request template<a href="#section-4.3.3-15.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt>3</dt>
<dd id="section-4.3.3-15.3">the infoValue of the request MUST be absent<a href="#section-4.3.3-15.3" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt>4</dt>
<dd id="section-4.3.3-15.4">if present, the infoValue of the response MUST be a CertReqTemplateValue containing a CertTemplate structure and an optional keySpec field<a href="#section-4.3.3-15.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-4.3.3-16" class="keepWithNext">The infoValue field of the general response containing the id-it-certReqTemplate OID looks like this:<a href="#section-4.3.3-16" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.3.3-17">
<pre>
      InfoValue               OPTIONAL
    -- MUST be absent if no requirements are available
    -- MUST be present if the PKI management entity has any
    -- requirements on the contents of the certificate template
        certTemplate          REQUIRED
    -- MUST be present if infoValue is present
    -- MUST contain the required CertTemplate structure elements
    -- The SubjectPublicKeyInfo field MUST be absent
        keySpec               OPTIONAL
    -- MUST be absent if no requirements on the public key are
    -- available
    -- MUST be present if the PKI management entity has any
    -- requirements on the keys generated
    -- MUST contain one AttributeTypeAndValue per supported
    -- algorithm with attribute id-regCtrl-algId or
    -- id-regCtrl-rsaKeyLen
</pre><a href="#section-4.3.3-17" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="EE_CRLs">
<section id="section-4.3.4">
          <h4 id="name-crl-update-retrieval">
<a href="#section-4.3.4" class="section-number selfRef">4.3.4. </a><a href="#name-crl-update-retrieval" class="section-name selfRef">CRL update retrieval</a>
          </h4>
<p id="section-4.3.4-1">This PKI management operation can be used by an EE to request a new CRL.  If a CA offers methods to access a CRL, it may include CRL distribution points or authority information access extensions as specified in <span><a href="#RFC5280" class="xref">RFC 5280</a> [<a href="#RFC5280" class="xref">RFC5280</a>]</span> into the issued certificates.  In addition, CMP offers CRL provisioning functionality as part of the PKI management operation.<a href="#section-4.3.4-1" class="pilcrow">¶</a></p>
<p id="section-4.3.4-2">An EE requests a CRL update from the PKI management entity by sending a general message with OID id-it-crlStatusList.  The EE MUST include the CRL source identifying the requested CRL and, if available, the thisUpdate time of the most current CRL instance it already has, as specified in <span><a href="#I-D.ietf-lamps-cmp-updates" class="xref">CMP Updates Section 2.16</a> [<a href="#I-D.ietf-lamps-cmp-updates" class="xref">I-D.ietf-lamps-cmp-updates</a>]</span>.  The PKI management entity MUST respond with a general response with OID id-it-crls.  If no thisUpdate value was given by the EE, the PKI management entity MUST return the latest CRL available.  If a thisUpdate value was given, the PKI management entity MUST return the latest available CRL in case this CRL is more recent, otherwise the infoValue in the response message MUST be absent.<a href="#section-4.3.4-2" class="pilcrow">¶</a></p>
<p id="section-4.3.4-3">The EE MUST identify the requested CRL either by its CRL distribution point name or issuer name. The CRL distribution point name can either be provided form the CRL distribution points extension of the certificate to be validated or from the issuing distribution point extension from the CRL to be updated. If no CRL distribution name is available to identify the CRL, the EE can use the issuer name either from the certificate to be validated or from the CRL to be updated.<a href="#section-4.3.4-3" class="pilcrow">¶</a></p>
<p id="section-4.3.4-4">The PKI management entity SHOULD treat a CRL distribution point name as an internal pointer to identify a CRL for which is available at the PKI management entity directly. It is not intended as a way to fetch an arbitrary CRL from an external location.<a href="#section-4.3.4-4" class="pilcrow">¶</a></p>
<p id="section-4.3.4-5">In addition to the prerequisites specified in <a href="#Prereq" class="xref">Section 3.4</a>, the EE MUST know which CRL to request.<a href="#section-4.3.4-5" class="pilcrow">¶</a></p>
<p id="section-4.3.4-6">Note: If the EE does not want to request a specific CRL it MAY use instead a general message with OID id-it-currentCrl as specified in <span><a href="#RFC4210" class="xref">RFC 4210 Section 5.3.19.6</a> [<a href="#RFC4210" class="xref">RFC4210</a>]</span>.<a href="#section-4.3.4-6" class="pilcrow">¶</a></p>
<p id="section-4.3.4-7" class="keepWithNext">The message sequence for this PKI management operation is as given above, with the following specific content:<a href="#section-4.3.4-7" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-4.3.4-8">
     <dt>1</dt>
<dd id="section-4.3.4-8.1">the infoType OID to use is id-it-crlStatusList in the request and id-it-crls in the response<a href="#section-4.3.4-8.1" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt>2</dt>
<dd id="section-4.3.4-8.2">the infoValue of the request MUST be present and contain a  CRLStatus structure<a href="#section-4.3.4-8.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt>3</dt>
<dd id="section-4.3.4-8.3">if present, the infoValue of the response MUST contain a CRL<a href="#section-4.3.4-8.3" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-4.3.4-9" class="keepWithNext">The infoValue field of the general request containing the id-it-crlStatusList OID looks like this:<a href="#section-4.3.4-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.3.4-10">
<pre>
      CRLSource               REQUIRED
    -- MUST contain exactly one CRLSource structure
    -- MUST contain the dpn choice of type DistributionPointName if
    -- the CRL distribution point name is available
    -- Otherwise, MUST contain the issuer choice identifying the CA
    -- that issues the CRL. It MUST contain the issuer DN in the
    -- directoryName field of a GeneralName element.
      thisUpdate              OPTIONAL
    -- SHOULD contain the thisUpdate field of the latest CRL form
    -- the issuer specified in the given dpn or issuer field,
    -- in case such a CRL is already known by the EE
</pre><a href="#section-4.3.4-10" class="pilcrow">¶</a>
</div>
<p id="section-4.3.4-11" class="keepWithNext">The infoValue field of the general response containing the id-it-crls OID looks like this:<a href="#section-4.3.4-11" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.3.4-12">
<pre>
      infoValue               OPTIONAL
    -- MUST be absent if no CRL to be returned is available
    -- MUST contain one CRL update from the referenced source, if a
    -- thisUpdate value was not given or a more recent CRL is
    -- available
</pre><a href="#section-4.3.4-12" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="EE_Polling">
<section id="section-4.4">
        <h3 id="name-handling-delayed-delivery">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-handling-delayed-delivery" class="section-name selfRef">Handling delayed delivery</a>
        </h3>
<p id="section-4.4-1">This is a variant of all PKI management operations described in this document.  It is initiated in case a PKI management entity cannot respond to a request message in a timely manner, typically due to offline or asynchronous upstream communication, or due to delays in handling the request. The polling mechanism has been specified in <span><a href="#RFC4210" class="xref">RFC 4210 Section 5.3.22</a> [<a href="#RFC4210" class="xref">RFC4210</a>]</span> and updated by <span>[<a href="#I-D.ietf-lamps-cmp-updates" class="xref">I-D.ietf-lamps-cmp-updates</a>]</span>.<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<p id="section-4.4-2">Depending on the PKI architecture, the entity initiating delayed delivery is not necessarily the PKI management entity directly addressed by the EE.<a href="#section-4.4-2" class="pilcrow">¶</a></p>
<p id="section-4.4-3">When initiating delayed delivery of a message received from an EE, the PKI management entity MUST respond with an ip/cp/kup/error message including the status "waiting".  On receiving this response, the EE MUST store in its transaction context the senderNonce of the preceding request message because this value will be needed for checking the recipNonce of the final response to be received after polling. It sends a poll request with certReqId 0 if referring to the CertResponse element contained in the ip/cp/kup message, else -1 to refer to the whole message.  In case the final response is not yet available, the PKI management entity that initiated the delayed delivery MUST answer with a poll response, with the same certReqId. The included checkAfter time value indicates the minimum number of seconds that SHOULD elapse before the EE sends a new pollReq message to the PKI management entity.  This is repeated until a final response is available or any party involved gives up on the current PKI management operation, i.e., a timeout occurs.<a href="#section-4.4-3" class="pilcrow">¶</a></p>
<p id="section-4.4-4">When the PKI management entity that initiated delayed delivery can provide the final response for the original request message of the EE, it MUST send this response to the EE.  Using this response, the EE can continue the current PKI management operation as usual.<a href="#section-4.4-4" class="pilcrow">¶</a></p>
<p id="section-4.4-5">No specific prerequisites apply in addition to those of the respective PKI management operation.<a href="#section-4.4-5" class="pilcrow">¶</a></p>
<p id="section-4.4-6" class="keepWithNext">Message flow:<a href="#section-4.4-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.4-7">
<pre>
Step# EE                                  PKI management entity
 1   format request
       message
 2                  -&gt;     request     -&gt;
 3                                        handle or forward
                                            request
 4                                        format ip/cp/kup/error
                                            with status "waiting"
                                            response in case no
                                            immediate final response
                                            is available,
 5                   &lt;- ip/cp/kup/error &lt;-
 6   handle
       ip/cp/kup/error
       with status
       "waiting"

--------------------------  start polling  --------------------------

 7   format pollReq
 8                     -&gt;    pollReq   -&gt;
 9                                        handle or forward pollReq
10                                        in case the final response
                                            for the original request
                                            is available, continue
                                            with step 14
                                          otherwise, format or
                                            receive pollRep with
                                            checkAfter value
11                     &lt;-    pollRep   &lt;-
12   handle pollRep
13   let checkAfter
       time elapse and
       continue with
       step 7

-----------------  end polling, continue as usual  ------------------

14                                        format or receive
                                            final response on
                                            original request
15                     &lt;-   response   &lt;-
16   handle final
       response
</pre><a href="#section-4.4-7" class="pilcrow">¶</a>
</div>
<p id="section-4.4-8" class="keepWithNext">Detailed description of the ip/cp/kup/error response, pollReq, and pollRep:<a href="#section-4.4-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.4-9">
<pre>
Response with status "waiting" -- ip/cp/kup/error

Field                         Value

header
    -- As described in Section 3.1

body
    -- as described for the respective PKI management operation, with
    -- the following adaptations:
      status                  REQUIRED -- in case of ip/cp/kup
      pKIStatusInfo           REQUIRED -- in case of error response
    -- PKIStatusInfo structure MUST be present
        status                REQUIRED
    -- MUST be status "waiting"
        statusString          OPTIONAL
    -- MAY be any human-readable text for debugging, logging or to
    -- display in a GUI
        failInfo              PROHIBITED

protection                    REQUIRED
    -- As described in Section 3.2

extraCerts                    OPTIONAL
    -- As described in Section 3.3


Polling Request -- pollReq

Field                         Value

header
    -- As described in Section 3.1

body
    -- The message of the EE asking for the final response or for a
    -- time to check again
  pollReq                     REQUIRED
    certReqId                 REQUIRED
 -- MUST be 0 if referring to a CertResponse element, else -1

protection                    REQUIRED
    -- As described in Section 3.2
    -- MUST use the same credentials as in the first request message
    -- of the PKI management operation

extraCerts                    RECOMMENDED
    -- As described in Section 3.3
    -- MAY be omitted if the message size is critical and
    -- the PKI management entity caches the extraCerts from the
    -- first request message of the PKI management operation


Polling Response -- pollRep

Field                         Value

header
    -- As described in Section 3.1

body
    -- The message indicates the delay after which the EE SHOULD
    -- send another pollReq message for this transaction
  pollRep                     REQUIRED
    certReqId                 REQUIRED
 -- MUST be 0 if referring to a CertResponse element, else -1
    checkAfter                REQUIRED
    -- time in seconds to elapse before a new pollReq SHOULD be sent
    reason                    OPTIONAL
    -- MAY be any human-readable text for debugging, logging or to
    -- display in a GUI

protection                    REQUIRED
    -- As described in Section 3.2
    -- MUST use the same credentials as in the first response
    -- message of the PKI management operation

extraCerts                    RECOMMENDED
    -- As described in Section 3.3
    -- MAY be omitted if the message size is critical and the EE has
    -- cached the extraCerts from the first response message of
    -- the PKI management operation


Final response - any type of response message

Field                         Value

header

    -- MUST be the header as described for the response message
    -- of the respective PKI management operation

body
    -- The response of the PKI management entity to the initial
    -- request as described in the respective PKI management
    -- operation

protection                    REQUIRED
    -- MUST be as described for the response message of the
    -- respective PKI management operation

extraCerts                    REQUIRED
    -- MUST be as described for the response message of the
    -- respective PKI management operation
</pre><a href="#section-4.4-9" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="RA_UseCases">
<section id="section-5">
      <h2 id="name-pki-management-entity-opera">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-pki-management-entity-opera" class="section-name selfRef">PKI management entity operations</a>
      </h2>
<p id="section-5-1">This section focuses on request processing by a PKI management entity.  Depending on the network and PKI solution design, this can be an RA or CA, any of which may include protocol conversion or central key generation (i.e., acting as a KGA).<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">A PKI management entity may directly respond to request messages from downstream and report errors. In case the PKI management entity is an RA it typically forwards the received request messages upstream after checking them and forwards respective response messages downstream.  Besides responding to messages or forwarding them, a PKI management entity may request or revoke certificates on behalf of EEs. A PKI management entity may also need to manage its own certificates and thus act as an EE using the PKI management operations specified in <a href="#EE_UseCases" class="xref">Section 4</a>.<a href="#section-5-2" class="pilcrow">¶</a></p>
<div id="RA_response">
<section id="section-5.1">
        <h3 id="name-responding-to-requests">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-responding-to-requests" class="section-name selfRef">Responding to requests</a>
        </h3>
<p id="section-5.1-1">The PKI management entity terminating the PKI management operation at CMP level MUST respond to all received requests by returning a related CMP response message or an error. Any intermediate PKI management entity MAY respond depending on the PKI configuration and policy.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">In addition to the checks described in <a href="#Validation" class="xref">Section 3.5</a>, the responding PKI management entity SHOULD check that a request that initiates a new PKI management operation does not use a transactionID that is currently in use.  The failInfo bit value to use on reporting failure as described in <a href="#Error_reporting" class="xref">Section 3.6.4</a> is transactionIdInUse.  If any of these verification steps or any of the essential checks described in the following subsections fails, the PKI management entity MUST proceed as described in <a href="#Error" class="xref">Section 3.6</a>.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1-3">The responding PKI management entity SHOULD copy the sender field of the request to the recipient field of the response, MUST copy the senderNonce of the request to the recipNonce of the response, and MUST use the same transactionID for the response.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
<div id="RA_response_enrollment">
<section id="section-5.1.1">
          <h4 id="name-responding-to-a-certificate">
<a href="#section-5.1.1" class="section-number selfRef">5.1.1. </a><a href="#name-responding-to-a-certificate" class="section-name selfRef">Responding to a certificate request</a>
          </h4>
<p id="section-5.1.1-1">An ir/cr/p10cr/kur message is used to request a certificate as described in <a href="#EE_request" class="xref">Section 4.1</a>. The responding PKI management entity MUST proceed as follows unless it initiates delayed delivery as described in <a href="#RA_response_polling" class="xref">Section 5.1.2</a>.<a href="#section-5.1.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1.1-2">The PKI management entity SHOULD check the message body according to the applicable requirements from <a href="#EE_request" class="xref">Section 4.1</a>. Possible failInfo bit values used for error reporting in case a check failed include badCertId and badCertTemplate. It MUST verify the presence and value of the proof-of-possession (failInfo bit: badPOP), unless central key generation is requested. In case the special POP value "raVerified" is given, it SHOULD check that the request message was signed using a certificate containing the cmcRA extended key usage (failInfo bit: notAuthorized). The PKI management entity SHOULD perform also any further checks on the certTemplate contents (failInfo: badCertTemplate) according to any applicable PKI policy and certificate profile.<a href="#section-5.1.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1.1-3">If the requested certificate is available, the PKI management entity MUST respond with a positive ip/cp/kup message as described in <a href="#EE_request" class="xref">Section 4.1</a>.<a href="#section-5.1.1-3" class="pilcrow">¶</a></p>
<p id="section-5.1.1-4">Note: If central key generation is performed by the responding PKI management entity, the responding PKI management entity MUST include in the response the privateKey field as specified in <a href="#EE_centralKeyGeneration" class="xref">Section 4.1.6</a>.  It may have issued the certificate for the newly generated key pair itself if it is a CA, or have requested the certificate on behalf of the EE as described in <a href="#RA_on-behalf_request" class="xref">Section 5.3.1</a>, or have received it by other means from a CA.<a href="#section-5.1.1-4" class="pilcrow">¶</a></p>
<p id="section-5.1.1-5" class="keepWithNext">The prerequisites of the respective PKI management operation as specified in <a href="#EE_request" class="xref">Section 4.1</a> apply.<a href="#section-5.1.1-5" class="pilcrow">¶</a></p>
<p id="section-5.1.1-6">Note: If the EE requested omission of the certConf message, the PKI management entity SHOULD handle it as described in <a href="#EE_newPKI" class="xref">Section 4.1.1</a> and therefore MAY grant this by including the implicitConfirm extension in the response header.<a href="#section-5.1.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="RA_response_polling">
<section id="section-5.1.2">
          <h4 id="name-initiating-delayed-delivery">
<a href="#section-5.1.2" class="section-number selfRef">5.1.2. </a><a href="#name-initiating-delayed-delivery" class="section-name selfRef">Initiating delayed delivery</a>
          </h4>
<p id="section-5.1.2-1">This functional extension can be used by a PKI management entity in case the response to a request takes longer than usual.  In this case the PKI management entity MUST completely validate the request as usual and then start preparing the response or forward the request further upstream as soon as possible.  In the meantime, it MUST respond with an ip/cp/kup/error message including the status "waiting" and handle subsequent polling as described in <a href="#EE_Polling" class="xref">Section 4.4</a>.<a href="#section-5.1.2-1" class="pilcrow">¶</a></p>
<p id="section-5.1.2-2">Note: Typically, as stated in <a href="#RA_Replace" class="xref">Section 5.2.3</a>, an intermediate PKI management entity should not change the sender and recipient nonces even in case it modifies a request or a response message.  In the special case of delayed delivery initiated by an intermediate PKI management entity, there is an exception.  Between the EE and this PKI management entity, pollReq and pollRep messages are exchanged handling the nonces as usual.  Yet when the final response from upstream has arrived at the PKI management entity, this response contains the recipNonce copied (as usual) from the senderNonce in the original request message.  The PKI management entity that initiated the delayed delivery may replace the recipNonce in the response message with the senderNonce of the last received pollReq because the downstream entities, including the EE, might expect it in this way.  Yet the check specified in Section 3.5 allows to alternatively use the senderNonce of the original request.<a href="#section-5.1.2-2" class="pilcrow">¶</a></p>
<p id="section-5.1.2-3">No specific prerequisites apply in addition to those of the respective PKI management operation.<a href="#section-5.1.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="RA_response_confirmation">
<section id="section-5.1.3">
          <h4 id="name-responding-to-a-confirmatio">
<a href="#section-5.1.3" class="section-number selfRef">5.1.3. </a><a href="#name-responding-to-a-confirmatio" class="section-name selfRef">Responding to a confirmation message</a>
          </h4>
<p id="section-5.1.3-1">A PKI management entity MUST handle a certConf message if it has responded before with a positive ip/cp/kup message not granting implicit confirmation.  It SHOULD check the message body according to the requirements given in <a href="#EE_newPKI" class="xref">Section 4.1.1</a> (failInfo bit: badCertId) and react as described there.<a href="#section-5.1.3-1" class="pilcrow">¶</a></p>
<p id="section-5.1.3-2">The prerequisites of the respective PKI management operation as specified in <a href="#EE_request" class="xref">Section 4.1</a> apply.<a href="#section-5.1.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="RA_response_revocation">
<section id="section-5.1.4">
          <h4 id="name-responding-to-a-revocation-">
<a href="#section-5.1.4" class="section-number selfRef">5.1.4. </a><a href="#name-responding-to-a-revocation-" class="section-name selfRef">Responding to a revocation request</a>
          </h4>
<p id="section-5.1.4-1">An rr message is used to request revocation of a certificate. The responding PKI management entity SHOULD check the message body according to the requirements in <a href="#EE_Revoke" class="xref">Section 4.2</a>. It MUST make sure that the referenced certificate exists (failInfo bit: badCertId), has been issued by the addressed CA, and is not already expired or revoked (failInfo bit: certRevoked).  On success it MUST respond with a positive rp message as described in <a href="#EE_Revoke" class="xref">Section 4.2</a>.<a href="#section-5.1.4-1" class="pilcrow">¶</a></p>
<p id="section-5.1.4-2">No specific prerequisites apply in addition to those specified in <a href="#Prereq" class="xref">Section 3.4</a>.<a href="#section-5.1.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="RA_response_support">
<section id="section-5.1.5">
          <h4 id="name-responding-to-a-support-mes">
<a href="#section-5.1.5" class="section-number selfRef">5.1.5. </a><a href="#name-responding-to-a-support-mes" class="section-name selfRef">Responding to a support message</a>
          </h4>
<p id="section-5.1.5-1">A genm message is used to retrieve extra content. The responding PKI management entity SHOULD check the message body according to the applicable requirements in <a href="#EE_GeneralMessage" class="xref">Section 4.3</a> and perform any further checks depending on the PKI policy.  On success it MUST respond with a genp message as described there.<a href="#section-5.1.5-1" class="pilcrow">¶</a></p>
<p id="section-5.1.5-2">Note: The responding PKI management entity may generate the response from scratch or reuse the contents of previous responses.  Therefore, it may be worth caching the body of the response message as long as the contained information is still valid, such that further requests for the same contents can be answered immediately.<a href="#section-5.1.5-2" class="pilcrow">¶</a></p>
<p id="section-5.1.5-3">No specific prerequisites apply in addition to those specified in <a href="#Prereq" class="xref">Section 3.4</a>.<a href="#section-5.1.5-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="RA_forwarde_messages">
<section id="section-5.2">
        <h3 id="name-forwarding-messages">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-forwarding-messages" class="section-name selfRef">Forwarding messages</a>
        </h3>
<p id="section-5.2-1">In case the PKI solution consists of intermediate PKI management entities (i.e., LRA or RA), each CMP request message coming from an EE or any other downstream PKI management entity SHOULD be forwarded to the next (upstream) PKI management entity as described in this section and otherwise MUST be answered as described in <a href="#RA_response" class="xref">Section 5.1</a>. Any received response message or error message MUST be forwarded to the next (downstream) PKI entity.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">In addition to the checks described in <a href="#Validation" class="xref">Section 3.5</a>, the forwarding PKI management entity MAY verify the proof-of-possession for ir/cr/p10cr/kur messages.  If one of these verification procedures fails, the RA proceeds as described in <a href="#Error" class="xref">Section 3.6</a>.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2-3">A PKI management entity SHOULD NOT change the received message unless necessary. The PKI management entity SHOULD only update the message protection and the certificate template in a certificate request message if this is technically necessary. Concrete PKI system specifications may define in more detail when to do so.<a href="#section-5.2-3" class="pilcrow">¶</a></p>
<p id="section-5.2-4">This is particularly relevant in the upstream communication of a request message.<a href="#section-5.2-4" class="pilcrow">¶</a></p>
<p id="section-5.2-5" class="keepWithNext">Each forwarding PKI management entity has one or more functionalities. It may<a href="#section-5.2-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2-6.1">verify the identities of EEs and make authorization decisions for certification request processing based on local PKI policy,<a href="#section-5.2-6.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-6.2">add or modify fields of certificate request messages,<a href="#section-5.2-6.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-6.3">store data from a message in a database for later usage or audit purposes,<a href="#section-5.2-6.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-6.4">provide traversal of a network boundary,<a href="#section-5.2-6.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-6.5">replace a MAC-based protection by a signature-based protection that can be verified also further upstream,<a href="#section-5.2-6.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-6.6">double-check if the messages transferred back and forth are properly protected and well-formed,<a href="#section-5.2-6.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-6.7">provide an authentic indication that it has performed all required checks,<a href="#section-5.2-6.7" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-6.8">initiate a delayed delivery due to delays transferring messages or handling requests, or<a href="#section-5.2-6.8" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-6.9">collect messages from multiple RAs and forward them jointly.<a href="#section-5.2-6.9" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.2-7" class="keepWithNext">The decision if a message should be forwarded<a href="#section-5.2-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2-8.1">unchanged with the original protection,<a href="#section-5.2-8.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-8.2">unchanged with a new protection, or<a href="#section-5.2-8.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-8.3">changed with a new protection<a href="#section-5.2-8.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.2-9">depends on the PKI solution design and the associated security policy (<span><a href="#RFC3647" class="xref">CP/CPS</a> [<a href="#RFC3647" class="xref">RFC3647</a>]</span>).<a href="#section-5.2-9" class="pilcrow">¶</a></p>
<p id="section-5.2-10" class="keepWithNext">A PKI management entity MUST replace or add a protection of a message if it<a href="#section-5.2-10" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2-11.1">needs to securely indicate that it has done checks or validations on the message to one of the next (upstream) PKI management entity or<a href="#section-5.2-11.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-11.2">needs to protect the message using a key and certificate from a different PKI.<a href="#section-5.2-11.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.2-12" class="keepWithNext">A PKI management entity MUST replace a protection of a message if it<a href="#section-5.2-12" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2-13.1">performs changes to the header or the body of the message or<a href="#section-5.2-13.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-13.2">needs to convert from or to a MAC-based protection.<a href="#section-5.2-13.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.2-14">This is particularly relevant in the upstream communication of certificate request messages.<a href="#section-5.2-14" class="pilcrow">¶</a></p>
<p id="section-5.2-15">Note that the message protection covers only the header and the body and not the extraCerts.  The PKI management entity MAY change the extraCerts in any of the following message adaptations, e.g., to sort, add, or delete certificates to support subsequent PKI entities.  This may be particularly helpful to augment upstream messages with additional certificates or to reduce the number of certificates in downstream messages when forwarding to constrained devices.<a href="#section-5.2-15" class="pilcrow">¶</a></p>
<div id="RA_noChange">
<section id="section-5.2.1">
          <h4 id="name-not-changing-protection">
<a href="#section-5.2.1" class="section-number selfRef">5.2.1. </a><a href="#name-not-changing-protection" class="section-name selfRef">Not changing protection</a>
          </h4>
<p id="section-5.2.1-1">This variant means that a PKI management entity forwards a CMP message without changing the header, body, or protection.  In this case the PKI management entity acts more like a proxy, e.g., on a network boundary, implementing no specific RA-like security functionality that requires an authentic indication to the PKI. Still the PKI management entity might implement checks that result in refusing to forward the request message and instead responding as specified in <a href="#Error" class="xref">Section 3.6</a>.<a href="#section-5.2.1-1" class="pilcrow">¶</a></p>
<p id="section-5.2.1-2">This variant of forwarding a message or the one described in <a href="#RA_AddSingel" class="xref">Section 5.2.2.1</a> SHOULD be used for kur messages and for central key generation.<a href="#section-5.2.1-2" class="pilcrow">¶</a></p>
<p id="section-5.2.1-3">No specific prerequisites apply in addition to those specified in <a href="#Prereq" class="xref">Section 3.4</a>.<a href="#section-5.2.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="RA_Add">
<section id="section-5.2.2">
          <h4 id="name-adding-protection-and-batch">
<a href="#section-5.2.2" class="section-number selfRef">5.2.2. </a><a href="#name-adding-protection-and-batch" class="section-name selfRef">Adding protection and batching of messages</a>
          </h4>
<p id="section-5.2.2-1">This variant of forwarding a message means that a PKI management entity adds another protection to PKI management messages before forwarding them.<a href="#section-5.2.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2.2-2">The nested message is a PKI management message containing a PKIMessages sequence as its body containing one or more CMP messages.<a href="#section-5.2.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2.2-3">As specified in the updated <span><a href="#RFC4210" class="xref">Section 5.1.3.4 of RFC 4210</a> [<a href="#RFC4210" class="xref">RFC4210</a>]</span> (see also <span><a href="#I-D.ietf-lamps-cmp-updates" class="xref">CMP Updates Section 2.6</a> [<a href="#I-D.ietf-lamps-cmp-updates" class="xref">I-D.ietf-lamps-cmp-updates</a>]</span>) there are various use cases for adding another protection by a PKI management entity. Specific procedures are described in more detail in the following sections.<a href="#section-5.2.2-3" class="pilcrow">¶</a></p>
<p id="section-5.2.2-4" class="keepWithNext">Detailed message description:<a href="#section-5.2.2-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2.2-5">
<pre>
Nested Message - nested

Field                         Value

header
    -- As described in Section 3.1

body
    -- Container to provide additional protection to original
    -- messages and to bundle request messages or alternatively
    -- response messages
  PKIMessages                 REQUIRED
    -- MUST be a sequence of one or more CMP messages

protection                    REQUIRED
    -- As described in Section 3.2 using the CMP protection key of
    -- the PKI management entity

extraCerts                    REQUIRED
    -- As described in Section 3.3
</pre><a href="#section-5.2.2-5" class="pilcrow">¶</a>
</div>
<div id="RA_AddSingel">
<section id="section-5.2.2.1">
            <h5 id="name-adding-protection-to-a-requ">
<a href="#section-5.2.2.1" class="section-number selfRef">5.2.2.1. </a><a href="#name-adding-protection-to-a-requ" class="section-name selfRef">Adding protection to a request message</a>
            </h5>
<p id="section-5.2.2.1-1">A PKI management entity may authentically indicate successful validation and approval of a request message by adding an extra signature to the original message.<a href="#section-5.2.2.1-1" class="pilcrow">¶</a></p>
<p id="section-5.2.2.1-2">By adding a protection using its own CMP protecting key the PKI management entity provides a proof of verifying and approving the message as described above. Thus, the PKI management entity acts as an actual Registration Authority (RA), which implements important security functionality of the PKI. Applying an additional protection is specifically relevant when forwarding a message that requests a certificate update or central key generation.  This is because the original protection of the EE must be preserved while adding an indication of approval by the PKI management entity.<a href="#section-5.2.2.1-2" class="pilcrow">¶</a></p>
<p id="section-5.2.2.1-3">The PKI management entity wrapping the original request message in a nested message structure MUST take over the recipient, recipNonce, and transactionID of the original message to the nested message and apply signature-based protection.  The additional signature serves as proof of verification and authorization by this PKI management entity.<a href="#section-5.2.2.1-3" class="pilcrow">¶</a></p>
<p id="section-5.2.2.1-4">The PKI management entity receiving such a nested message that contains a single request message MUST validate the additional protection signature on the nested message and check the authorization for the approval it implies.<a href="#section-5.2.2.1-4" class="pilcrow">¶</a></p>
<p id="section-5.2.2.1-5">The PKI management entity responding to the request contained in the nested message sends the response message as described in <a href="#RA_response" class="xref">Section 5.1</a>, without wrapping it in a nested message.<a href="#section-5.2.2.1-5" class="pilcrow">¶</a></p>
<p id="section-5.2.2.1-6">Note: This form of nesting messages is characterized by the fact that the transactionID in the header of the nested message is the same as the one used in the included message.<a href="#section-5.2.2.1-6" class="pilcrow">¶</a></p>
<p id="section-5.2.2.1-7" class="keepWithNext">Specific prerequisites augmenting the prerequisites in <a href="#Prereq" class="xref">Section 3.4</a>:<a href="#section-5.2.2.1-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.2.1-8.1">The PKI management entity MUST be able to validate the respective request and have the authorization to perform approval of the request according to the PKI policies.<a href="#section-5.2.2.1-8.1" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-5.2.2.1-9" class="keepWithNext">Message flow:<a href="#section-5.2.2.1-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2.2.1-10">
<pre>
Step# PKI management entity               PKI management entity
 1   format nested
 2                      -&gt;  nested   -&gt;
 3                                        handle or forward nested
 4                                        format or receive response
 5                      &lt;-  response &lt;-
 6   forward response
</pre><a href="#section-5.2.2.1-10" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="RA_AddBatch">
<section id="section-5.2.2.2">
            <h5 id="name-batching-messages">
<a href="#section-5.2.2.2" class="section-number selfRef">5.2.2.2. </a><a href="#name-batching-messages" class="section-name selfRef">Batching messages</a>
            </h5>
<p id="section-5.2.2.2-1">A PKI management entity MAY bundle any number of PKI management messages for batch processing or to transfer a bulk of PKI management messages using the nested message structure. In this use case, nested messages are used both on the upstream interface towards the next PKI management entity and on the downstream interface from the PKI management entity towards the EE.<a href="#section-5.2.2.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2.2.2-2">This PKI management operation is typically used on the interface between an LRA and an RA to bundle several messages for offline delivery.  In this case the LRA needs to initiate delayed delivery as described in <a href="#RA_response_polling" class="xref">Section 5.1.2</a>. If the RA needs different routing information per nested PKI management message a suitable mechanism may need to be implemented. Since this mechanism strongly depends on the requirements of the target architecture, it is out of scope of this document.<a href="#section-5.2.2.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2.2.2-3">A nested message containing requests is generated locally at the PKI management entity.  For the upstream nested message, the PKI management entity acts as a protocol end point and therefore a fresh transactionID and a fresh senderNonce MUST be used in the header of the nested message. An upstream nested message may contain request messages, e.g., ir, cr, p10cr, kur, pollReq, certConf, rr, or genm.  While building the upstream nested message the PKI management entity SHOULD store the sender, transactionID, and senderNonce fields of all bundled messages together with the transactionID of the upstream nested message.<a href="#section-5.2.2.2-3" class="pilcrow">¶</a></p>
<p id="section-5.2.2.2-4">Such an upstream nested message is sent to the next PKI management entity. The upstream PKI management entity that unbundles it MUST handle each of the included request messages as usual.  It MUST answer with a downstream nested message.  This downstream nested message MUST use the transactionID of the upstream nested message and return the senderNonce of the upstream nested message as the recipNonce of the downstream nested message.  The downstream nested message SHOULD bundle the individual response messages (e.g., ip, cp, kup, pollRep, pkiConf, rp, genp, error) for all original request messages of the upstream nested message.  While unbundling the downstream nested message, the former PKI management entity can determine lost and unexpected responses based on the previously stored transactionIDs.  When it forwards the unbundled responses, any extra messages SHOULD be dropped, and any missing response message (failInfo bit: systemUnavail) MUST be answered with an error message to inform the respective requester about the failed certificate management operation.<a href="#section-5.2.2.2-4" class="pilcrow">¶</a></p>
<p id="section-5.2.2.2-5">Note: This form of nesting messages is characterized by the fact that the transactionID in the header of the nested message is different to those used in the included messages.<a href="#section-5.2.2.2-5" class="pilcrow">¶</a></p>
<p id="section-5.2.2.2-6">The protection of the nested messages SHOULD NOT be regarded as an indication of verification or approval of the bundled PKI request messages.<a href="#section-5.2.2.2-6" class="pilcrow">¶</a></p>
<p id="section-5.2.2.2-7">No specific prerequisites apply in addition to those specified in <a href="#Prereq" class="xref">Section 3.4</a>.<a href="#section-5.2.2.2-7" class="pilcrow">¶</a></p>
<p id="section-5.2.2.2-8" class="keepWithNext">Message flow:<a href="#section-5.2.2.2-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2.2.2-9">
<pre>
Step# PKI management entity               PKI management entity
 1   format nested
 2                      -&gt;  nested   -&gt;
 3                                        handle or forward nested
 4                                        format or receive nested
 5                      &lt;-  nested   &lt;-
 6   handle nested
</pre><a href="#section-5.2.2.2-9" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="RA_Replace">
<section id="section-5.2.3">
          <h4 id="name-replacing-protection">
<a href="#section-5.2.3" class="section-number selfRef">5.2.3. </a><a href="#name-replacing-protection" class="section-name selfRef">Replacing protection</a>
          </h4>
<p id="section-5.2.3-1">The following two alternatives can be used by any PKI management entity forwarding a CMP message with or without changes while providing its own protection and in this way asserting approval of the message.<a href="#section-5.2.3-1" class="pilcrow">¶</a></p>
<p id="section-5.2.3-2">By replacing the existing protection using its own CMP protecting key the PKI management entity provides a proof of verifying and approving the message as described above. Thus, the PKI management entity acts as an actual Registration Authority (RA), which implements important security functionality of the PKI.<a href="#section-5.2.3-2" class="pilcrow">¶</a></p>
<p id="section-5.2.3-3">Before replacing the existing protection by a new protection, the PKI management entity MUST verify the protection provided and approve its content, including any modifications that it may perform.  It MUST also check that the sender, as authenticated by the message protection, is authorized for the given operation.<a href="#section-5.2.3-3" class="pilcrow">¶</a></p>
<p id="section-5.2.3-4">These message adaptations MUST NOT be applied to kur messages described in <a href="#EE_Update" class="xref">Section 4.1.3</a> since their original protection using the key and certificate to be updated needs to be preserved, unless the regCtrl OldCertId is used to strongly identify the certificate to be updated.<a href="#section-5.2.3-4" class="pilcrow">¶</a></p>
<p id="section-5.2.3-5">These message adaptations MUST NOT be applied to certificate request messages described in for central key generation <a href="#EE_centralKeyGeneration" class="xref">Section 4.1.6</a> since their original protection needs to be preserved up to the Key Generation Authority, which needs to use it for encrypting the new private key for the EE.<a href="#section-5.2.3-5" class="pilcrow">¶</a></p>
<p id="section-5.2.3-6">In both the kur and central key generation cases, if a PKI management entity needs to state its approval of the original request message it MUST provide this using a nested message as specified in <a href="#RA_AddSingel" class="xref">Section 5.2.2.1</a>.<a href="#section-5.2.3-6" class="pilcrow">¶</a></p>
<p id="section-5.2.3-7">When an intermediate PKI management entity modifies a message, it SHOULD NOT change the transactionID nor the sender and recipient nonces.<a href="#section-5.2.3-7" class="pilcrow">¶</a></p>
<div id="RA_keepPOPO">
<section id="section-5.2.3.1">
            <h5 id="name-not-changing-any-included-p">
<a href="#section-5.2.3.1" class="section-number selfRef">5.2.3.1. </a><a href="#name-not-changing-any-included-p" class="section-name selfRef">Not changing any included proof-of-possession</a>
            </h5>
<p id="section-5.2.3.1-1">This variant of forwarding a message means that a PKI management entity forwards a CMP message with or without modifying the message header or body while preserving any included proof-of-possession.<a href="#section-5.2.3.1-1" class="pilcrow">¶</a></p>
<p id="section-5.2.3.1-2">In case the PKI management entity breaks an existing proof-of-possession, the message adaptation described in <a href="#RA_breakPOPO" class="xref">Section 5.2.3.2</a> needs to be applied instead.<a href="#section-5.2.3.1-2" class="pilcrow">¶</a></p>
<p id="section-5.2.3.1-3" class="keepWithNext">Specific prerequisites augmenting the prerequisites in <a href="#Prereq" class="xref">Section 3.4</a>:<a href="#section-5.2.3.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.3.1-4.1">The PKI management entity MUST be able to validate the respective request and have the authorization to perform approval of the request according to the PKI policies.<a href="#section-5.2.3.1-4.1" class="pilcrow">¶</a>
</li>
            </ul>
</section>
</div>
<div id="RA_breakPOPO">
<section id="section-5.2.3.2">
            <h5 id="name-breaking-proof-of-possessio">
<a href="#section-5.2.3.2" class="section-number selfRef">5.2.3.2. </a><a href="#name-breaking-proof-of-possessio" class="section-name selfRef">Breaking proof-of-possession</a>
            </h5>
<p id="section-5.2.3.2-1">This variant of forwarding a message needs to be used if a PKI management entity breaks a signature-based proof-of-possession in a certificate request message, for instance because it forwards an ir or cr message with modifications of the certTemplate, i.e., modification, addition, or removal of fields.<a href="#section-5.2.3.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2.3.2-2">The PKI management entity MUST verify the proof-of-possession contained in the original message using the included public key.  If successful, the PKI management entity MUST change the popo field value to raVerified.<a href="#section-5.2.3.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2.3.2-3" class="keepWithNext">Specific prerequisites augmenting the prerequisites in <a href="#Prereq" class="xref">Section 3.4</a>:<a href="#section-5.2.3.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.3.2-4.1">The PKI management entity MUST be authorized to replace the proof-of-possession (after verifying it) with raVerified.<a href="#section-5.2.3.2-4.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.2.3.2-4.2">The PKI management entity MUST be able to validate the respective request and have the authorization to perform approval of the request according to the PKI policies.<a href="#section-5.2.3.2-4.2" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-5.2.3.2-5" class="keepWithNext">The new popo field MUST contain the raVerified choice in the certReq structure of the modified message as follows:<a href="#section-5.2.3.2-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2.3.2-6">
<pre>
    popo
      raVerified              REQUIRED
    -- MUST have the value NULL and indicates that the PKI
    -- management entity verified the popo of the original message
</pre><a href="#section-5.2.3.2-6" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="RA_on-behalf">
<section id="section-5.3">
        <h3 id="name-acting-on-behalf-of-other-p">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-acting-on-behalf-of-other-p" class="section-name selfRef">Acting on behalf of other PKI entities</a>
        </h3>
<p id="section-5.3-1">A PKI management entity may need to request a PKI management operation on behalf of another PKI entity.  In this case the PKI management entity initiates the respective PKI management operation as described in <a href="#EE_UseCases" class="xref">Section 4</a> acting in the role of the EE.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<div id="RA_on-behalf_request">
<section id="section-5.3.1">
          <h4 id="name-requesting-certificates">
<a href="#section-5.3.1" class="section-number selfRef">5.3.1. </a><a href="#name-requesting-certificates" class="section-name selfRef">Requesting certificates</a>
          </h4>
<p id="section-5.3.1-1">A PKI management entity may use on of the PKI management operations described in Section 4.1 to request a certificate on behalf of another PKI entity.  It either generates the key pair itself and inserts the new public key in the subjectPublicKey field of the request certTemplate, or it uses a certificate request received from downstream, e.g., by means of a different protocol. In the latter case it SHOULD verify the received proof-of-possession.<a href="#section-5.3.1-1" class="pilcrow">¶</a></p>
<p id="section-5.3.1-2">No specific prerequisites apply in addition to those specified in <a href="#EE_request" class="xref">Section 4.1</a>.<a href="#section-5.3.1-2" class="pilcrow">¶</a></p>
<p id="section-5.3.1-3">Note: An upstream PKI management entity will not be able to differentiate this PKI management operation from the one described in <a href="#RA_Replace" class="xref">Section 5.2.3</a> because in both cases the message is protected by the PKI management entity.<a href="#section-5.3.1-3" class="pilcrow">¶</a></p>
<p id="section-5.3.1-4" class="keepWithNext">The message sequence for this PKI management operation is identical to the respective PKI management operation given in <a href="#EE_request" class="xref">Section 4.1</a>, with the following changes:<a href="#section-5.3.1-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-5.3.1-5">
 <dt>1</dt>
<dd id="section-5.3.1-5.1">The request messages MUST be signed using the CMP protection key of the PKI management entity taking the role of the EE in this operation.<a href="#section-5.3.1-5.1" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt>2</dt>
<dd id="section-5.3.1-5.2">If inclusion of a proper proof-of-possession is not possible the PKI management entity MUST verify the POP provided from downstream and use "raVerified" in its upstream request.<a href="#section-5.3.1-5.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="RA_on-behalf_revoke">
<section id="section-5.3.2">
          <h4 id="name-revoking-a-certificate-2">
<a href="#section-5.3.2" class="section-number selfRef">5.3.2. </a><a href="#name-revoking-a-certificate-2" class="section-name selfRef">Revoking a certificate</a>
          </h4>
<p id="section-5.3.2-1">A PKI management entity may use the PKI management operation described in <a href="#EE_Revoke" class="xref">Section 4.2</a> to revoke a certificate of another PKI entity.  This revocation request message MUST be signed by the PKI management entity using its own CMP protection key to prove to the PKI authorization to revoke the certificate on behalf of that PKI entity.<a href="#section-5.3.2-1" class="pilcrow">¶</a></p>
<p id="section-5.3.2-2">No specific prerequisites apply in addition to those specified in <a href="#EE_Revoke" class="xref">Section 4.2</a>.<a href="#section-5.3.2-2" class="pilcrow">¶</a></p>
<p id="section-5.3.2-3">Note: An upstream PKI management entity will not be able to differentiate this PKI management operation from the ones described in <a href="#RA_Replace" class="xref">Section 5.2.3</a>.<a href="#section-5.3.2-3" class="pilcrow">¶</a></p>
<p id="section-5.3.2-4" class="keepWithNext">The message sequence for this PKI management operation is identical to that given in <a href="#EE_Revoke" class="xref">Section 4.2</a>, with the following changes:<a href="#section-5.3.2-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-5.3.2-5">
 <dt>1</dt>
<dd id="section-5.3.2-5.1">The rr message MUST be signed using the CMP protection key of the PKI management entity taking the role of the EE in this operation.<a href="#section-5.3.2-5.1" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="Transfer_types">
<section id="section-6">
      <h2 id="name-cmp-message-transfer-mechan">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-cmp-message-transfer-mechan" class="section-name selfRef">CMP message transfer mechanisms</a>
      </h2>
<p id="section-6-1">CMP messages are designed to be self-contained, such that in principle any reliable transfer mechanism can be used.  HTTP SHOULD and CoAP MAY be used for online transfer. CMP messages MAY also be piggybacked on any other reliable transfer protocol. File-based transfer MAY be used in case offline transfer is required.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">Independently of the means of transfer, it can happen that messages are lost or that a communication partner does not respond.  To prevent waiting indefinitely, each CMP client component SHOULD use a configurable per-request timeout, and each CMP server component SHOULD use a configurable per-response timeout in case a further Request message is to be expected from the client side within the same transaction.  In this way a hanging transaction can be closed cleanly with an error as described in <a href="#Error" class="xref">Section 3.6</a> (failInfo bit: systemUnavail) and related resources (for instance, any cached extraCerts) can be freed.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">Moreover, there are various situations where the delivery of messages gets delayed.  For instance, a serving PKI management entity might take longer than expected to form a response due to administrative processes, resource constraints, or upstream message delivery delays.  The transport layer itself may cause delays, for instance due to offline transport, network segmentation, or intermittent network connectivity.  Part of these issues can be detected and handled at CMP level using pollReq and pollRep messages as described in <a href="#EE_Polling" class="xref">Section 4.4</a>, while others are better handled at transfer level.  Depending on the transfer protocol and system architecture, solutions for handling delays at transfer level may be present and can be used for CMP connections, for instance connection re-establishment and message retransmission.<a href="#section-6-3" class="pilcrow">¶</a></p>
<p id="section-6-4">Note: Long timeout periods are helpful to minimize the need for polling and maximize chances to handle transfer issues at lower levels.<a href="#section-6-4" class="pilcrow">¶</a></p>
<p id="section-6-5">Note: When using TCP and similar reliable connection-oriented transport protocols, which is typical in conjunction with HTTP, there is the option to keep the connection alive over multiple request-response message pairs.  This may improve efficiency, though is not required from a security point of view.<a href="#section-6-5" class="pilcrow">¶</a></p>
<p id="section-6-6">When conveying CMP messages in HTTP, CoAP, or MIME-based transfer protocols, the internet media type "application/pkixcmp" MUST be set for transfer encoding as specified in <span><a href="#RFC2510" class="xref">Section 5.3 of RFC 2510</a> [<a href="#RFC2510" class="xref">RFC2510</a>]</span>, <span><a href="#I-D.ietf-ace-cmpv2-coap-transport" class="xref">Section 2.4 of CMP over CoAP</a> [<a href="#I-D.ietf-ace-cmpv2-coap-transport" class="xref">I-D.ietf-ace-cmpv2-coap-transport</a>]</span>, and <span><a href="#RFC6712" class="xref">Section 3.4 of CMP over HTTP</a> [<a href="#RFC6712" class="xref">RFC6712</a>]</span>.<a href="#section-6-6" class="pilcrow">¶</a></p>
<div id="HTTP">
<section id="section-6.1">
        <h3 id="name-http-transfer">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-http-transfer" class="section-name selfRef">HTTP transfer</a>
        </h3>
<p id="section-6.1-1">This transfer mechanism can be used by a PKI entity to transfer CMP messages over HTTP.  If HTTP transfer is used the specifications as described in <span>[<a href="#RFC6712" class="xref">RFC6712</a>]</span> and updated by <span><a href="#I-D.ietf-lamps-cmp-updates" class="xref">CMP Updates</a> [<a href="#I-D.ietf-lamps-cmp-updates" class="xref">I-D.ietf-lamps-cmp-updates</a>]</span> MUST be followed.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">PKI management operations SHOULD use URI paths consisting of '/.well-known/cmp/' followed by an operation label depending on the type of PKI management operation.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<span id="name-http-endpoints"></span><div id="http_endpoints">
<table class="left" id="table-1">
          <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-http-endpoints" class="selfRef">HTTP endpoints</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">PKI management operation</th>
              <th class="text-center" rowspan="1" colspan="1">operation label</th>
              <th class="text-left" rowspan="1" colspan="1">Details</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Enroll client to new PKI</td>
              <td class="text-center" rowspan="1" colspan="1">/initialization</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#EE_newPKI" class="xref">Section 4.1.1</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Enroll client to existing PKI</td>
              <td class="text-center" rowspan="1" colspan="1">/certification</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#EE_trustedPKI" class="xref">Section 4.1.2</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Update client certificate</td>
              <td class="text-center" rowspan="1" colspan="1">/keyupdate</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#EE_Update" class="xref">Section 4.1.3</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Enroll client using PKCS#10</td>
              <td class="text-center" rowspan="1" colspan="1">/p10</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#EE_P10" class="xref">Section 4.1.4</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Revoke client certificate</td>
              <td class="text-center" rowspan="1" colspan="1">/revocation</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#EE_Revoke" class="xref">Section 4.2</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Get CA certificates</td>
              <td class="text-center" rowspan="1" colspan="1">/getcacerts</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#EE_CACerts" class="xref">Section 4.3.1</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Get root CA certificate update</td>
              <td class="text-center" rowspan="1" colspan="1">/getrootupdate</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#EE_RootCAUpdate" class="xref">Section 4.3.2</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Get certificate request template</td>
              <td class="text-center" rowspan="1" colspan="1">/getcertreqtemplate</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#EE_CACerts" class="xref">Section 4.3.1</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Get CRL updates</td>
              <td class="text-center" rowspan="1" colspan="1">/getcrls</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#EE_CRLs" class="xref">Section 4.3.4</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <p id="section-6.1-3.2.10.1.1">Batching messages<a href="#section-6.1-3.2.10.1.1" class="pilcrow">¶</a></p>
<p id="section-6.1-3.2.10.1.2">Note: This path element is applicable only between PKI management entities.<a href="#section-6.1-3.2.10.1.2" class="pilcrow">¶</a></p>
</td>
              <td class="text-center" rowspan="1" colspan="1">/nested</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#RA_AddBatch" class="xref">Section 5.2.2.2</a>
</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-6.1-4">Independently of any variants used (see <a href="#EE_MAC" class="xref">Section 4.1.5</a>, <a href="#EE_centralKeyGeneration" class="xref">Section 4.1.6</a>, and <a href="#EE_Polling" class="xref">Section 4.4</a>) the operation label corresponding to the PKI management operation SHALL be used.<a href="#section-6.1-4" class="pilcrow">¶</a></p>
<p id="section-6.1-5">Any certConf or pollReq messages are sent to the same endpoint as determined by the PKI management operation.<a href="#section-6.1-5" class="pilcrow">¶</a></p>
<p id="section-6.1-6">When a single request message is nested as described in <a href="#RA_AddSingel" class="xref">Section 5.2.2.1</a>, the label to use is the same as for the underlying PKI management operation.<a href="#section-6.1-6" class="pilcrow">¶</a></p>
<p id="section-6.1-7">By sending a request to its preferred endpoint, the PKI entity will recognize via the HTTP response status code whether a configured URI is supported by the PKI management entity.<a href="#section-6.1-7" class="pilcrow">¶</a></p>
<p id="section-6.1-8">In case a PKI management entity receives an unexpected HTTP status code from upstream, it MUST respond downstream with an error message as described in <a href="#Error" class="xref">Section 3.6</a> using a failInfo bit corresponding to the status code, e.g., systemFailure.<a href="#section-6.1-8" class="pilcrow">¶</a></p>
<p id="section-6.1-9">For certificate management the major security goal is integrity and data origin authentication. For delivery of centrally generated keys, also confidentiality is a must. These goals are sufficiently achieved by CMP itself, also in an end-to-end fashion. If a second line of defense is required or general privacy concerns exist, TLS can be used to provide confidentiality on a hop-by-hop basis.<a href="#section-6.1-9" class="pilcrow">¶</a></p>
<p id="section-6.1-10">TLS SHOULD be used with certificate-based authentication to further protect the HTTP transfer as described in <span>[<a href="#RFC2818" class="xref">RFC2818</a>]</span>.  The CMP transfer via HTTPS MUST use TLS server authentication and SHOULD use TLS client authentication.<a href="#section-6.1-10" class="pilcrow">¶</a></p>
<p id="section-6.1-11">Note: The requirements for checking certificates given in <span>[<a href="#RFC5280" class="xref">RFC5280</a>]</span> and either <span>[<a href="#RFC5246" class="xref">RFC5246</a>]</span> or <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span> MUST be followed for the TLS layer. Certificate status checking SHOULD be used for the TLS certificates of all communication partners.<a href="#section-6.1-11" class="pilcrow">¶</a></p>
<p id="section-6.1-12">TLS with mutual authentication based on shared secret information MAY be used in case no suitable certificates for certificate-based authentication are available, e.g., a PKI management operation with MAC-based protection is used.<a href="#section-6.1-12" class="pilcrow">¶</a></p>
<p id="section-6.1-13">Note: The entropy of the shared secret information is crucial for the level of protection available using shard secret information-based TLS authentication. A pre-shared key (PSK) mechanism is acceptable using shared secret information with an entropy of at least 128 bits. Otherwise, a password-authenticated key exchange (PAKE) protocol is RECOMMENDED.<a href="#section-6.1-13" class="pilcrow">¶</a></p>
</section>
</div>
<div id="CoAP">
<section id="section-6.2">
        <h3 id="name-coap-transfer">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-coap-transfer" class="section-name selfRef">CoAP transfer</a>
        </h3>
<p id="section-6.2-1">This transfer  mechanism can be used by a PKI entity to transfer CMP messages over <span><a href="#RFC7252" class="xref">CoAP</a> [<a href="#RFC7252" class="xref">RFC7252</a>]</span>, e.g., in constrained environments.  If CoAP transfer  is used the specifications as described in <span><a href="#I-D.ietf-ace-cmpv2-coap-transport" class="xref">CMP over CoAP</a> [<a href="#I-D.ietf-ace-cmpv2-coap-transport" class="xref">I-D.ietf-ace-cmpv2-coap-transport</a>]</span> MUST be followed.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">PKI management operations SHOULD use URI paths consisting of '/.well-known/cmp/' followed by an operation label depending on the type of PKI management operation.<a href="#section-6.2-2" class="pilcrow">¶</a></p>
<span id="name-coap-endpoints"></span><div id="coap_endpoints">
<table class="left" id="table-2">
          <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-coap-endpoints" class="selfRef">CoAP endpoints</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">PKI management operation</th>
              <th class="text-center" rowspan="1" colspan="1">operation label</th>
              <th class="text-left" rowspan="1" colspan="1">Details</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Enroll client to new PKI</td>
              <td class="text-center" rowspan="1" colspan="1">/ir</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#EE_newPKI" class="xref">Section 4.1.1</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Enroll client to existing PKI</td>
              <td class="text-center" rowspan="1" colspan="1">/cr</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#EE_trustedPKI" class="xref">Section 4.1.2</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Update client certificate</td>
              <td class="text-center" rowspan="1" colspan="1">/kur</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#EE_Update" class="xref">Section 4.1.3</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Enroll client using PKCS#10</td>
              <td class="text-center" rowspan="1" colspan="1">/p10</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#EE_P10" class="xref">Section 4.1.4</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Revoke client certificate</td>
              <td class="text-center" rowspan="1" colspan="1">/rr</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#EE_Revoke" class="xref">Section 4.2</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Get CA certificates</td>
              <td class="text-center" rowspan="1" colspan="1">/crts</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#EE_CACerts" class="xref">Section 4.3.1</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Get root CA certificate update</td>
              <td class="text-center" rowspan="1" colspan="1">/rcu</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#EE_RootCAUpdate" class="xref">Section 4.3.2</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Get certificate request template</td>
              <td class="text-center" rowspan="1" colspan="1">/att</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#EE_Temp" class="xref">Section 4.3.3</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Get CRL updates</td>
              <td class="text-center" rowspan="1" colspan="1">/crls</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#EE_CRLs" class="xref">Section 4.3.4</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <p id="section-6.2-3.2.10.1.1">Batching messages<a href="#section-6.2-3.2.10.1.1" class="pilcrow">¶</a></p>
<p id="section-6.2-3.2.10.1.2">Note: This path element is applicable only between PKI management entities.<a href="#section-6.2-3.2.10.1.2" class="pilcrow">¶</a></p>
</td>
              <td class="text-center" rowspan="1" colspan="1">/nest</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#RA_AddBatch" class="xref">Section 5.2.2.2</a>
</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-6.2-4">Independently of any variants used (see <a href="#EE_MAC" class="xref">Section 4.1.5</a>, <a href="#EE_centralKeyGeneration" class="xref">Section 4.1.6</a>, and <a href="#EE_Polling" class="xref">Section 4.4</a>) the operation label corresponding to the PKI management operation SHALL be used.<a href="#section-6.2-4" class="pilcrow">¶</a></p>
<p id="section-6.2-5">Any certConf or pollReq messages are sent to the same endpoint as determined by the PKI management operation.<a href="#section-6.2-5" class="pilcrow">¶</a></p>
<p id="section-6.2-6">When a single request message is nested as described in <a href="#RA_AddSingel" class="xref">Section 5.2.2.1</a>, the label to use is the same as for the underlying PKI management operation.<a href="#section-6.2-6" class="pilcrow">¶</a></p>
<p id="section-6.2-7">By sending a request to its preferred endpoint, the PKI entity will recognize via the CoAP response status code whether a configured URI is supported by the PKI management entity.  The CoAP-inherent discovery mechanisms MAY also be used.<a href="#section-6.2-7" class="pilcrow">¶</a></p>
<p id="section-6.2-8">In case a PKI management entity receives an unexpected CoAP status code from upstream, it MUST respond downstream with an error message as described in <a href="#Error" class="xref">Section 3.6</a> using a failInfo bit corresponding to the status code, e.g., systemFailure.<a href="#section-6.2-8" class="pilcrow">¶</a></p>
<p id="section-6.2-9">Like for HTTP transfer , to offer a second line of defense or to provide hop-by-hop privacy protection, DTLS MAY be utilized as described in <span><a href="#I-D.ietf-ace-cmpv2-coap-transport" class="xref">CMP over CoAP</a> [<a href="#I-D.ietf-ace-cmpv2-coap-transport" class="xref">I-D.ietf-ace-cmpv2-coap-transport</a>]</span>.<a href="#section-6.2-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Piggybacking">
<section id="section-6.3">
        <h3 id="name-piggybacking-on-other-relia">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-piggybacking-on-other-relia" class="section-name selfRef">Piggybacking on other reliable transfer</a>
        </h3>
<p id="section-6.3-1">CMP messages MAY also be transfer on some other reliable protocol. Connection, delay, and error handling mechanisms similar to those specified for HTTP in <a href="#HTTP" class="xref">Section 6.1</a> need to be implemented.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<p id="section-6.3-2">A more detailed specification is out of scope of this document and would need to be given for instance in the scope of the transfer protocol used.<a href="#section-6.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Offline">
<section id="section-6.4">
        <h3 id="name-offline-transfer">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-offline-transfer" class="section-name selfRef">Offline transfer</a>
        </h3>
<p id="section-6.4-1">For transferring CMP messages between PKI entities, any mechanism can be used that is able to store and forward binary objects of sufficient length and with sufficient reliability while preserving the order of messages for each transaction.<a href="#section-6.4-1" class="pilcrow">¶</a></p>
<p id="section-6.4-2">The transfer mechanism SHOULD be able to indicate message loss, excessive delay, and possibly other transmission errors. In such cases the PKI entities SHOULD report an error as specified in <a href="#Error" class="xref">Section 3.6</a> as far as possible.<a href="#section-6.4-2" class="pilcrow">¶</a></p>
<div id="File-based">
<section id="section-6.4.1">
          <h4 id="name-file-based-transfer">
<a href="#section-6.4.1" class="section-number selfRef">6.4.1. </a><a href="#name-file-based-transfer" class="section-name selfRef">File-based transfer</a>
          </h4>
<p id="section-6.4.1-1">CMP messages MAY be transferred between PKI entities using file-based mechanisms, for instance when an offline EE or a PKI management entity performs delayed delivery.  Each file MUST contain the ASN.1 DER encoding of one CMP message only, where the message may be nested.  There MUST be no extraneous header or trailer information in the file.  The file name extension ".pki" MUST be used.<a href="#section-6.4.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Other_trans">
<section id="section-6.4.2">
          <h4 id="name-other-asynchronous-transfer">
<a href="#section-6.4.2" class="section-number selfRef">6.4.2. </a><a href="#name-other-asynchronous-transfer" class="section-name selfRef">Other asynchronous transfer protocols</a>
          </h4>
<p id="section-6.4.2-1">Other asynchronous transfer protocols, e.g., email or website up-/download, MAY transfer CMP messages between PKI entities. A MIME wrapping is defined for those environments that are MIME-native. The MIME wrapping in this section is specified in <span><a href="#RFC8551" class="xref">RFC 8551 Section 3.1</a> [<a href="#RFC8551" class="xref">RFC8551</a>]</span>.<a href="#section-6.4.2-1" class="pilcrow">¶</a></p>
<p id="section-6.4.2-2">The ASN.1 DER encoding of the CMP messages MUST be transferred using the "application/pkixcmp" content type and base64-encoded content transfer encoding as specified in <span>[<a href="#RFC2510" class="xref">RFC2510</a>]</span>, section 5.3. A filename MUST be included either in a "content-type" or a "content-disposition" statement. The file name extension ".pki" MUST be used.<a href="#section-6.4.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="Conformity">
<section id="section-7">
      <h2 id="name-conformance-requirements">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-conformance-requirements" class="section-name selfRef">Conformance requirements</a>
      </h2>
<p id="section-7-1">This section defines which level of support for the various features specified in this profile is required for which type of PKI entity.<a href="#section-7-1" class="pilcrow">¶</a></p>
<div id="UseCases">
<section id="section-7.1">
        <h3 id="name-pki-management-operations">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-pki-management-operations" class="section-name selfRef">PKI management operations</a>
        </h3>
<p id="section-7.1-1">The following table provides an overview of the PKI management operations specified in <a href="#EE_UseCases" class="xref">Section 4</a> and <a href="#RA_UseCases" class="xref">Section 5</a> and states whether support by conforming EE, RA, and CA implementations is mandatory, recommended, optional, or not applicable.  Variants amend or change behavior of base PKI management operations and are therefore also included.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2" class="keepWithNext"></p>
<span id="name-level-of-support-for-pki-ma"></span><div id="PKIManOp_support">
<table class="left" id="table-3">
          <caption>
<a href="#table-3" class="selfRef">Table 3</a>:
<a href="#name-level-of-support-for-pki-ma" class="selfRef">Level of support for PKI management operations and variants</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">ID</th>
              <th class="text-left" rowspan="1" colspan="1">PKI management operations and variants</th>
              <th class="text-left" rowspan="1" colspan="1">EE</th>
              <th class="text-left" rowspan="1" colspan="1">RA</th>
              <th class="text-left" rowspan="1" colspan="1">CA</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Generic</td>
              <td class="text-left" rowspan="1" colspan="1">generic aspects of PKI management operations, <a href="#GenericParts" class="xref">Section 3</a>
</td>
              <td class="text-left" rowspan="1" colspan="1">MUST</td>
              <td class="text-left" rowspan="1" colspan="1">MUST</td>
              <td class="text-left" rowspan="1" colspan="1">MUST</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">IR</td>
              <td class="text-left" rowspan="1" colspan="1">Requesting a certificate from a new PKI with signature-based protection, <a href="#EE_newPKI" class="xref">Section 4.1.1</a>
</td>
              <td class="text-left" rowspan="1" colspan="1">MUST</td>
              <td class="text-left" rowspan="1" colspan="1">MUST</td>
              <td class="text-left" rowspan="1" colspan="1">MUST</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">CR</td>
              <td class="text-left" rowspan="1" colspan="1">Requesting an additional certificate with signature-based protection, <a href="#EE_trustedPKI" class="xref">Section 4.1.2</a>
</td>
              <td class="text-left" rowspan="1" colspan="1">MAY</td>
              <td class="text-left" rowspan="1" colspan="1">MAY</td>
              <td class="text-left" rowspan="1" colspan="1">MAY</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">KUR</td>
              <td class="text-left" rowspan="1" colspan="1">Updating an existing certificate with signature-based protection, <a href="#EE_Update" class="xref">Section 4.1.3</a>
</td>
              <td class="text-left" rowspan="1" colspan="1">MUST</td>
              <td class="text-left" rowspan="1" colspan="1">MUST</td>
              <td class="text-left" rowspan="1" colspan="1">MUST</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">P10CR</td>
              <td class="text-left" rowspan="1" colspan="1">Requesting a certificate from a legacy PKI using a PKCS#10 request, <a href="#EE_P10" class="xref">Section 4.1.4</a>
</td>
              <td class="text-left" rowspan="1" colspan="1">MAY</td>
              <td class="text-left" rowspan="1" colspan="1">MAY</td>
              <td class="text-left" rowspan="1" colspan="1">MAY</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">MAC</td>
              <td class="text-left" rowspan="1" colspan="1">Requesting a certificate from a PKI with MAC-based protection (IR, CR, KUR, and P10CR if supported), <a href="#EE_MAC" class="xref">Section 4.1.5</a>
</td>
              <td class="text-left" rowspan="1" colspan="1">SHOULD</td>
              <td class="text-left" rowspan="1" colspan="1">SHOULD</td>
              <td class="text-left" rowspan="1" colspan="1">SHOULD</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">CKeyGen</td>
              <td class="text-left" rowspan="1" colspan="1">Adding central key generation to a certificate request (IR, CR, KUR, and P10CR if supported). (If supported, key agreement key management technique is REQUIRED, and key transport and password-based key management techniques are OPTIONAL.), <a href="#EE_centralKeyGeneration" class="xref">Section 4.1.6</a>
</td>
              <td class="text-left" rowspan="1" colspan="1">MAY</td>
              <td class="text-left" rowspan="1" colspan="1">MAY</td>
              <td class="text-left" rowspan="1" colspan="1">MAY</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">RR</td>
              <td class="text-left" rowspan="1" colspan="1">Revoking a certificate, <a href="#EE_Revoke" class="xref">Section 4.2</a>
</td>
              <td class="text-left" rowspan="1" colspan="1">SHOULD</td>
              <td class="text-left" rowspan="1" colspan="1">SHOULD</td>
              <td class="text-left" rowspan="1" colspan="1">SHOULD</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">CACerts</td>
              <td class="text-left" rowspan="1" colspan="1">Get CA certificates, <a href="#EE_CACerts" class="xref">Section 4.3.1</a>
</td>
              <td class="text-left" rowspan="1" colspan="1">MAY</td>
              <td class="text-left" rowspan="1" colspan="1">MAY</td>
              <td class="text-left" rowspan="1" colspan="1">MAY</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">RootUpd</td>
              <td class="text-left" rowspan="1" colspan="1">Get root CA certificate update, <a href="#EE_RootCAUpdate" class="xref">Section 4.3.2</a>
</td>
              <td class="text-left" rowspan="1" colspan="1">MAY</td>
              <td class="text-left" rowspan="1" colspan="1">MAY</td>
              <td class="text-left" rowspan="1" colspan="1">MAY</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">ReqTempl</td>
              <td class="text-left" rowspan="1" colspan="1">Get certificate request template, <a href="#EE_Temp" class="xref">Section 4.3.3</a>
</td>
              <td class="text-left" rowspan="1" colspan="1">MAY</td>
              <td class="text-left" rowspan="1" colspan="1">MAY</td>
              <td class="text-left" rowspan="1" colspan="1">MAY</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">CRLUpd</td>
              <td class="text-left" rowspan="1" colspan="1">CRL update retrieval, <a href="#EE_CRLs" class="xref">Section 4.3.4</a>
</td>
              <td class="text-left" rowspan="1" colspan="1">MAY</td>
              <td class="text-left" rowspan="1" colspan="1">MAY</td>
              <td class="text-left" rowspan="1" colspan="1">MAY</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Polling</td>
              <td class="text-left" rowspan="1" colspan="1">Handling delayed delivery, <a href="#EE_Polling" class="xref">Section 4.4</a>
</td>
              <td class="text-left" rowspan="1" colspan="1">MAY</td>
              <td class="text-left" rowspan="1" colspan="1">MAY</td>
              <td class="text-left" rowspan="1" colspan="1">MAY</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">CertResp</td>
              <td class="text-left" rowspan="1" colspan="1">Responding to a certificate request (IR, CR, KUR, and P10CR if supported), <a href="#RA_response_enrollment" class="xref">Section 5.1.1</a>
</td>
              <td class="text-left" rowspan="1" colspan="1">N/A</td>
              <td class="text-left" rowspan="1" colspan="1">MAY</td>
              <td class="text-left" rowspan="1" colspan="1">MUST</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">InitPoll</td>
              <td class="text-left" rowspan="1" colspan="1">Initiating delayed delivery, <a href="#RA_response_polling" class="xref">Section 5.1.2</a>
</td>
              <td class="text-left" rowspan="1" colspan="1">N/A</td>
              <td class="text-left" rowspan="1" colspan="1">MAY</td>
              <td class="text-left" rowspan="1" colspan="1">MAY</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">CertConf</td>
              <td class="text-left" rowspan="1" colspan="1">Responding to a confirmation message, <a href="#RA_response_confirmation" class="xref">Section 5.1.3</a>
</td>
              <td class="text-left" rowspan="1" colspan="1">MUST</td>
              <td class="text-left" rowspan="1" colspan="1">MAY</td>
              <td class="text-left" rowspan="1" colspan="1">MUST</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">RevResp</td>
              <td class="text-left" rowspan="1" colspan="1">Responding to a revocation request, <a href="#RA_response_revocation" class="xref">Section 5.1.4</a>
</td>
              <td class="text-left" rowspan="1" colspan="1">N/A</td>
              <td class="text-left" rowspan="1" colspan="1">MAY</td>
              <td class="text-left" rowspan="1" colspan="1">SHOULD</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">GenResp</td>
              <td class="text-left" rowspan="1" colspan="1">Responding to a support message (CACerts, RootUpd, ReqTempl, CRLUpd if supported), <a href="#RA_response_support" class="xref">Section 5.1.5</a>
</td>
              <td class="text-left" rowspan="1" colspan="1">N/A</td>
              <td class="text-left" rowspan="1" colspan="1">MAY</td>
              <td class="text-left" rowspan="1" colspan="1">MAY</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">FwdKeep</td>
              <td class="text-left" rowspan="1" colspan="1">Forwarding messages - not changing protection, <a href="#RA_noChange" class="xref">Section 5.2.1</a>
</td>
              <td class="text-left" rowspan="1" colspan="1">N/A</td>
              <td class="text-left" rowspan="1" colspan="1">MUST</td>
              <td class="text-left" rowspan="1" colspan="1">N/A</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">FwdAddS</td>
              <td class="text-left" rowspan="1" colspan="1">Adding protection to a request message, <a href="#RA_AddSingel" class="xref">Section 5.2.2.1</a>
</td>
              <td class="text-left" rowspan="1" colspan="1">N/A</td>
              <td class="text-left" rowspan="1" colspan="1">MUST</td>
              <td class="text-left" rowspan="1" colspan="1">MUST</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">FwdAddB</td>
              <td class="text-left" rowspan="1" colspan="1">Batching messages, <a href="#RA_AddBatch" class="xref">Section 5.2.2.2</a>
</td>
              <td class="text-left" rowspan="1" colspan="1">N/A</td>
              <td class="text-left" rowspan="1" colspan="1">MAY</td>
              <td class="text-left" rowspan="1" colspan="1">MAY</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">FwdRepKP</td>
              <td class="text-left" rowspan="1" colspan="1">Forwarding messages - replacing protection, not changing any included proof-of-possession, <a href="#RA_keepPOPO" class="xref">Section 5.2.3.1</a>
</td>
              <td class="text-left" rowspan="1" colspan="1">N/A</td>
              <td class="text-left" rowspan="1" colspan="1">MAY</td>
              <td class="text-left" rowspan="1" colspan="1">N/A</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">FwdRepBP</td>
              <td class="text-left" rowspan="1" colspan="1">Forwarding messages - replacing protection, breaking proof-of-possession, <a href="#RA_breakPOPO" class="xref">Section 5.2.3.2</a>
</td>
              <td class="text-left" rowspan="1" colspan="1">N/A</td>
              <td class="text-left" rowspan="1" colspan="1">MAY</td>
              <td class="text-left" rowspan="1" colspan="1">MAY</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">CertOnB</td>
              <td class="text-left" rowspan="1" colspan="1">Acting on behalf of other PKI entities - requesting certificates, <a href="#RA_on-behalf_request" class="xref">Section 5.3.1</a>
</td>
              <td class="text-left" rowspan="1" colspan="1">N/A</td>
              <td class="text-left" rowspan="1" colspan="1">MAY</td>
              <td class="text-left" rowspan="1" colspan="1">N/A</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">RevROnB</td>
              <td class="text-left" rowspan="1" colspan="1">Acting on behalf of other PKI entities - revoking a certificate, <a href="#RA_on-behalf_revoke" class="xref">Section 5.3.2</a>
</td>
              <td class="text-left" rowspan="1" colspan="1">N/A</td>
              <td class="text-left" rowspan="1" colspan="1">SHOULD</td>
              <td class="text-left" rowspan="1" colspan="1">SHOULD</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="Transport">
<section id="section-7.2">
        <h3 id="name-message-transfer">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-message-transfer" class="section-name selfRef">Message transfer</a>
        </h3>
<p id="section-7.2-1">CMP does not have specific needs regarding message transfer, except that for each request message sent, eventually exactly one response message should be received.  Therefore, virtually any reliable transfer mechanism can be used, such as HTTP, CoAP, and file-based offline transfer.  Thus, this document does not require any specific transfer protocol to be supported by conforming implementations.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<p id="section-7.2-2">On different links between PKI entities, e.g., EE-RA and RA-CA, different transfer mechanisms as specified in <a href="#Transfer_types" class="xref">Section 6</a> may be used.<a href="#section-7.2-2" class="pilcrow">¶</a></p>
<p id="section-7.2-3">HTTP transfer is RECOMMENDED to use for all PKI entities for maximizing general interoperability at transfer level, yet full flexibility is retained to choose whatever transfer mechanism is suitable, for instance for devices and system architectures with specific constraints.<a href="#section-7.2-3" class="pilcrow">¶</a></p>
<p id="section-7.2-4">The following table lists the name and level of support specified for each transfer mechanism.<a href="#section-7.2-4" class="pilcrow">¶</a></p>
<span id="name-level-of-support-for-messag"></span><div id="Trans_Support">
<table class="left" id="table-4">
          <caption>
<a href="#table-4" class="selfRef">Table 4</a>:
<a href="#name-level-of-support-for-messag" class="selfRef">Level of support for message transfer types</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">ID</th>
              <th class="text-left" rowspan="1" colspan="1">Message transfer type</th>
              <th class="text-left" rowspan="1" colspan="1">EE</th>
              <th class="text-left" rowspan="1" colspan="1">RA</th>
              <th class="text-left" rowspan="1" colspan="1">CA</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">HTTP</td>
              <td class="text-left" rowspan="1" colspan="1">HTTP transfer, <a href="#HTTP" class="xref">Section 6.1</a>
</td>
              <td class="text-left" rowspan="1" colspan="1">SHOULD</td>
              <td class="text-left" rowspan="1" colspan="1">SHOULD</td>
              <td class="text-left" rowspan="1" colspan="1">SHOULD</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">CoAP</td>
              <td class="text-left" rowspan="1" colspan="1">CoAP transfer, <a href="#CoAP" class="xref">Section 6.2</a>
</td>
              <td class="text-left" rowspan="1" colspan="1">MAY</td>
              <td class="text-left" rowspan="1" colspan="1">MAY</td>
              <td class="text-left" rowspan="1" colspan="1">MAY</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Piggyb</td>
              <td class="text-left" rowspan="1" colspan="1">Piggybacking on other reliable transfer, <a href="#Piggybacking" class="xref">Section 6.3</a>
</td>
              <td class="text-left" rowspan="1" colspan="1">MAY</td>
              <td class="text-left" rowspan="1" colspan="1">MAY</td>
              <td class="text-left" rowspan="1" colspan="1">MAY</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Offline</td>
              <td class="text-left" rowspan="1" colspan="1">Offline transfer, <a href="#Offline" class="xref">Section 6.4</a>
</td>
              <td class="text-left" rowspan="1" colspan="1">MAY</td>
              <td class="text-left" rowspan="1" colspan="1">MAY</td>
              <td class="text-left" rowspan="1" colspan="1">MAY</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
</section>
</div>
<div id="IANA">
<section id="section-8">
      <h2 id="name-iana-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-8-1">This document does not request changes to the IANA registry.<a href="#section-8-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Security">
<section id="section-9">
      <h2 id="name-security-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-9-1">The security considerations as laid out in <span><a href="#RFC4210" class="xref">CMP</a> [<a href="#RFC4210" class="xref">RFC4210</a>]</span> updated by <span><a href="#I-D.ietf-lamps-cmp-updates" class="xref">CMP Updates</a> [<a href="#I-D.ietf-lamps-cmp-updates" class="xref">I-D.ietf-lamps-cmp-updates</a>]</span> and <span><a href="#I-D.ietf-lamps-cmp-algorithms" class="xref">CMP Algorithms</a> [<a href="#I-D.ietf-lamps-cmp-algorithms" class="xref">I-D.ietf-lamps-cmp-algorithms</a>]</span>, <span><a href="#RFC4211" class="xref">CRMF</a> [<a href="#RFC4211" class="xref">RFC4211</a>]</span> updated by <span><a href="#RFC9045" class="xref">Algorithm Requirements Update</a> [<a href="#RFC9045" class="xref">RFC9045</a>]</span>, <span><a href="#RFC6712" class="xref">CMP over HTTP</a> [<a href="#RFC6712" class="xref">RFC6712</a>]</span>, and <span><a href="#I-D.ietf-ace-cmpv2-coap-transport" class="xref">CMP over CoAP</a> [<a href="#I-D.ietf-ace-cmpv2-coap-transport" class="xref">I-D.ietf-ace-cmpv2-coap-transport</a>]</span> apply.<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">For TLS using shared secret information-based authentication, both PSK and PAKE provide the same amount of protection against a real-time authentication attack which is directly the amount of entropy in the shared secret. The difference between a pre-shared key (PSK) and a password-authenticated key exchange (PAKE) protocol is in the level of long-term confidentiality of the TLS messages against brute-force decryption, where a PSK-based cipher suite only provides security according to the entropy of the shared secret, while a PAKE-based cipher suite provides full security independent of the entropy of the shared secret.<a href="#section-9-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Acknowledgements">
<section id="section-10">
      <h2 id="name-acknowledgements">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="section-10-1">We thank the various reviewers of this document.<a href="#section-10-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-11">
      <h2 id="name-references">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-11.1">
        <h3 id="name-normative-references">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-ace-cmpv2-coap-transport">[I-D.ietf-ace-cmpv2-coap-transport]</dt>
        <dd>
<span class="refAuthor">Sahni, M.</span> and <span class="refAuthor">S. Tripathi</span>, <span class="refTitle">"CoAP Transfer for the Certificate Management Protocol"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-ace-cmpv2-coap-transport-04</span>, <time datetime="2021-11-08" class="refDate">8 November 2021</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-cmpv2-coap-transport-04">https://datatracker.ietf.org/doc/html/draft-ietf-ace-cmpv2-coap-transport-04</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-lamps-cmp-algorithms">[I-D.ietf-lamps-cmp-algorithms]</dt>
        <dd>
<span class="refAuthor">Brockhaus, H.</span>, <span class="refAuthor">Aschauer, H.</span>, <span class="refAuthor">Ounsworth, M.</span>, and <span class="refAuthor">J. Gray</span>, <span class="refTitle">"Certificate Management Protocol (CMP) Algorithms"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-lamps-cmp-algorithms-09</span>, <time datetime="2021-12-22" class="refDate">22 December 2021</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-lamps-cmp-algorithms-09">https://datatracker.ietf.org/doc/html/draft-ietf-lamps-cmp-algorithms-09</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-lamps-cmp-updates">[I-D.ietf-lamps-cmp-updates]</dt>
        <dd>
<span class="refAuthor">Brockhaus, H.</span>, <span class="refAuthor">Oheimb, D. V.</span>, and <span class="refAuthor">J. Gray</span>, <span class="refTitle">"Certificate Management Protocol (CMP) Updates"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-lamps-cmp-updates-17</span>, <time datetime="2022-01-12" class="refDate">12 January 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-lamps-cmp-updates-17">https://datatracker.ietf.org/doc/html/draft-ietf-lamps-cmp-updates-17</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2986">[RFC2986]</dt>
        <dd>
<span class="refAuthor">Nystrom, M.</span> and <span class="refAuthor">B. Kaliski</span>, <span class="refTitle">"PKCS #10: Certification Request Syntax Specification Version 1.7"</span>, <span class="seriesInfo">RFC 2986</span>, <span class="seriesInfo">DOI 10.17487/RFC2986</span>, <time datetime="2000-11" class="refDate">November 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2986">https://www.rfc-editor.org/info/rfc2986</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4210">[RFC4210]</dt>
        <dd>
<span class="refAuthor">Adams, C.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Kause, T.</span>, and <span class="refAuthor">T. Mononen</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate Management Protocol (CMP)"</span>, <span class="seriesInfo">RFC 4210</span>, <span class="seriesInfo">DOI 10.17487/RFC4210</span>, <time datetime="2005-09" class="refDate">September 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4210">https://www.rfc-editor.org/info/rfc4210</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4211">[RFC4211]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate Request Message Format (CRMF)"</span>, <span class="seriesInfo">RFC 4211</span>, <span class="seriesInfo">DOI 10.17487/RFC4211</span>, <time datetime="2005-09" class="refDate">September 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4211">https://www.rfc-editor.org/info/rfc4211</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
        <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time datetime="2008-05" class="refDate">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5280">https://www.rfc-editor.org/info/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5652">[RFC5652]</dt>
        <dd>
<span class="refAuthor">Housley, R.</span>, <span class="refTitle">"Cryptographic Message Syntax (CMS)"</span>, <span class="seriesInfo">STD 70</span>, <span class="seriesInfo">RFC 5652</span>, <span class="seriesInfo">DOI 10.17487/RFC5652</span>, <time datetime="2009-09" class="refDate">September 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5652">https://www.rfc-editor.org/info/rfc5652</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5958">[RFC5958]</dt>
        <dd>
<span class="refAuthor">Turner, S.</span>, <span class="refTitle">"Asymmetric Key Packages"</span>, <span class="seriesInfo">RFC 5958</span>, <span class="seriesInfo">DOI 10.17487/RFC5958</span>, <time datetime="2010-08" class="refDate">August 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5958">https://www.rfc-editor.org/info/rfc5958</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6712">[RFC6712]</dt>
        <dd>
<span class="refAuthor">Kause, T.</span> and <span class="refAuthor">M. Peylo</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure -- HTTP Transfer for the Certificate Management Protocol (CMP)"</span>, <span class="seriesInfo">RFC 6712</span>, <span class="seriesInfo">DOI 10.17487/RFC6712</span>, <time datetime="2012-09" class="refDate">September 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6712">https://www.rfc-editor.org/info/rfc6712</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8933">[RFC8933]</dt>
        <dd>
<span class="refAuthor">Housley, R.</span>, <span class="refTitle">"Update to the Cryptographic Message Syntax (CMS) for Algorithm Identifier Protection"</span>, <span class="seriesInfo">RFC 8933</span>, <span class="seriesInfo">DOI 10.17487/RFC8933</span>, <time datetime="2020-10" class="refDate">October 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8933">https://www.rfc-editor.org/info/rfc8933</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9045">[RFC9045]</dt>
      <dd>
<span class="refAuthor">Housley, R.</span>, <span class="refTitle">"Algorithm Requirements Update to the Internet X.509 Public Key Infrastructure Certificate Request Message Format (CRMF)"</span>, <span class="seriesInfo">RFC 9045</span>, <span class="seriesInfo">DOI 10.17487/RFC9045</span>, <time datetime="2021-06" class="refDate">June 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9045">https://www.rfc-editor.org/info/rfc9045</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-11.2">
        <h3 id="name-informative-references">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="ETSI-3GPP.33.310">[ETSI-3GPP.33.310]</dt>
        <dd>
<span class="refAuthor">3GPP</span>, <span class="refTitle">"Network Domain Security (NDS); Authentication Framework (AF)"</span>, <span class="seriesInfo">3GPP TS 33.310 16.6.0</span>, <time datetime="2020-12-16" class="refDate">16 December 2020</time>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-anima-brski-async-enroll">[I-D.ietf-anima-brski-async-enroll]</dt>
        <dd>
<span class="refAuthor">Fries, S.</span>, <span class="refAuthor">Brockhaus, H.</span>, <span class="refAuthor">Oheimb, D. V.</span>, and <span class="refAuthor">E. Lear</span>, <span class="refTitle">"Support of Asynchronous Enrollment in BRSKI (BRSKI-AE)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-anima-brski-async-enroll-04</span>, <time datetime="2021-10-25" class="refDate">25 October 2021</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-anima-brski-async-enroll-04">https://datatracker.ietf.org/doc/html/draft-ietf-anima-brski-async-enroll-04</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-anima-brski-prm">[I-D.ietf-anima-brski-prm]</dt>
        <dd>
<span class="refAuthor">Fries, S.</span>, <span class="refAuthor">Werner, T.</span>, <span class="refAuthor">Lear, E.</span>, and <span class="refAuthor">M. Richardson</span>, <span class="refTitle">"BRSKI with Pledge in Responder Mode (BRSKI-PRM)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-anima-brski-prm-00</span>, <time datetime="2021-10-25" class="refDate">25 October 2021</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-anima-brski-prm-00">https://datatracker.ietf.org/doc/html/draft-ietf-anima-brski-prm-00</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-netconf-sztp-csr">[I-D.ietf-netconf-sztp-csr]</dt>
        <dd>
<span class="refAuthor">Watsen, K.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">S. Turner</span>, <span class="refTitle">"Conveying a Certificate Signing Request (CSR) in a Secure Zero Touch Provisioning (SZTP) Bootstrapping Request"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-netconf-sztp-csr-13</span>, <time datetime="2022-01-31" class="refDate">31 January 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-netconf-sztp-csr-13">https://datatracker.ietf.org/doc/html/draft-ietf-netconf-sztp-csr-13</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IEC.62443-3-3">[IEC.62443-3-3]</dt>
        <dd>
<span class="refAuthor">IEC</span>, <span class="refTitle">"Industrial communication networks - Network and system security - Part 3-3: System security requirements and security levels"</span>, <span class="seriesInfo">IEC 62443-3-3</span>, <time datetime="2013-08" class="refDate">August 2013</time>, <span>&lt;<a href="https://webstore.iec.ch/publication/7033">https://webstore.iec.ch/publication/7033</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IEEE.802.1AR_2018">[IEEE.802.1AR_2018]</dt>
        <dd>
<span class="refAuthor">IEEE</span>, <span class="refTitle">"IEEE Standard for Local and metropolitan area networks - Secure Device Identity"</span>, <span class="seriesInfo">IEEE 802.1AR-2018</span>, <span class="seriesInfo">DOI 10.1109/IEEESTD.2018.8423794</span>, <time datetime="2018-08-02" class="refDate">2 August 2018</time>, <span>&lt;<a href="https://ieeexplore.ieee.org/document/8423794">https://ieeexplore.ieee.org/document/8423794</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="NIST.CSWP.04162018">[NIST.CSWP.04162018]</dt>
        <dd>
<span class="refAuthor">National Institute of Standards and Technology (NIST)</span>, <span class="refTitle">"Framework for Improving Critical Infrastructure Cybersecurity, Version 1.1"</span>, <span class="seriesInfo">NIST NIST.CSWP.04162018</span>, <span class="seriesInfo">DOI 10.6028/NIST.CSWP.04162018</span>, <time datetime="2018-04" class="refDate">April 2018</time>, <span>&lt;<a href="http://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf">http://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="NIST.SP.800-57p1r5">[NIST.SP.800-57p1r5]</dt>
        <dd>
<span class="refAuthor">Barker, E B.</span>, <span class="refTitle">"Recommendation for key management, part 1 :general"</span>, <span class="seriesInfo">NIST NIST.SP.800-57pt1r5</span>, <span class="seriesInfo">DOI 10.6028/NIST.SP.800-57pt1r5</span>, <time datetime="2020" class="refDate">2020</time>, <span>&lt;<a href="https://doi.org/10.6028/NIST.SP.800-57pt1r5">https://doi.org/10.6028/NIST.SP.800-57pt1r5</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2510">[RFC2510]</dt>
        <dd>
<span class="refAuthor">Adams, C.</span> and <span class="refAuthor">S. Farrell</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate Management Protocols"</span>, <span class="seriesInfo">RFC 2510</span>, <span class="seriesInfo">DOI 10.17487/RFC2510</span>, <time datetime="1999-03" class="refDate">March 1999</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2510">https://www.rfc-editor.org/info/rfc2510</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2818">[RFC2818]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"HTTP Over TLS"</span>, <span class="seriesInfo">RFC 2818</span>, <span class="seriesInfo">DOI 10.17487/RFC2818</span>, <time datetime="2000-05" class="refDate">May 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2818">https://www.rfc-editor.org/info/rfc2818</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3647">[RFC3647]</dt>
        <dd>
<span class="refAuthor">Chokhani, S.</span>, <span class="refAuthor">Ford, W.</span>, <span class="refAuthor">Sabett, R.</span>, <span class="refAuthor">Merrill, C.</span>, and <span class="refAuthor">S. Wu</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate Policy and Certification Practices Framework"</span>, <span class="seriesInfo">RFC 3647</span>, <span class="seriesInfo">DOI 10.17487/RFC3647</span>, <time datetime="2003-11" class="refDate">November 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3647">https://www.rfc-editor.org/info/rfc3647</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5246">[RFC5246]</dt>
        <dd>
<span class="refAuthor">Dierks, T.</span> and <span class="refAuthor">E. Rescorla</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.2"</span>, <span class="seriesInfo">RFC 5246</span>, <span class="seriesInfo">DOI 10.17487/RFC5246</span>, <time datetime="2008-08" class="refDate">August 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5246">https://www.rfc-editor.org/info/rfc5246</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7030">[RFC7030]</dt>
        <dd>
<span class="refAuthor">Pritikin, M., Ed.</span>, <span class="refAuthor">Yee, P., Ed.</span>, and <span class="refAuthor">D. Harkins, Ed.</span>, <span class="refTitle">"Enrollment over Secure Transport"</span>, <span class="seriesInfo">RFC 7030</span>, <span class="seriesInfo">DOI 10.17487/RFC7030</span>, <time datetime="2013-10" class="refDate">October 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7030">https://www.rfc-editor.org/info/rfc7030</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7252">[RFC7252]</dt>
        <dd>
<span class="refAuthor">Shelby, Z.</span>, <span class="refAuthor">Hartke, K.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"The Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 7252</span>, <span class="seriesInfo">DOI 10.17487/RFC7252</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7252">https://www.rfc-editor.org/info/rfc7252</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8366">[RFC8366]</dt>
        <dd>
<span class="refAuthor">Watsen, K.</span>, <span class="refAuthor">Richardson, M.</span>, <span class="refAuthor">Pritikin, M.</span>, and <span class="refAuthor">T. Eckert</span>, <span class="refTitle">"A Voucher Artifact for Bootstrapping Protocols"</span>, <span class="seriesInfo">RFC 8366</span>, <span class="seriesInfo">DOI 10.17487/RFC8366</span>, <time datetime="2018-05" class="refDate">May 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8366">https://www.rfc-editor.org/info/rfc8366</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8551">[RFC8551]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refAuthor">Ramsdell, B.</span>, and <span class="refAuthor">S. Turner</span>, <span class="refTitle">"Secure/Multipurpose Internet Mail Extensions (S/MIME) Version 4.0 Message Specification"</span>, <span class="seriesInfo">RFC 8551</span>, <span class="seriesInfo">DOI 10.17487/RFC8551</span>, <time datetime="2019-04" class="refDate">April 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8551">https://www.rfc-editor.org/info/rfc8551</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8572">[RFC8572]</dt>
        <dd>
<span class="refAuthor">Watsen, K.</span>, <span class="refAuthor">Farrer, I.</span>, and <span class="refAuthor">M. Abrahamsson</span>, <span class="refTitle">"Secure Zero Touch Provisioning (SZTP)"</span>, <span class="seriesInfo">RFC 8572</span>, <span class="seriesInfo">DOI 10.17487/RFC8572</span>, <time datetime="2019-04" class="refDate">April 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8572">https://www.rfc-editor.org/info/rfc8572</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8995">[RFC8995]</dt>
        <dd>
<span class="refAuthor">Pritikin, M.</span>, <span class="refAuthor">Richardson, M.</span>, <span class="refAuthor">Eckert, T.</span>, <span class="refAuthor">Behringer, M.</span>, and <span class="refAuthor">K. Watsen</span>, <span class="refTitle">"Bootstrapping Remote Secure Key Infrastructure (BRSKI)"</span>, <span class="seriesInfo">RFC 8995</span>, <span class="seriesInfo">DOI 10.17487/RFC8995</span>, <time datetime="2021-05" class="refDate">May 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8995">https://www.rfc-editor.org/info/rfc8995</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="UNISIG.Subset-137">[UNISIG.Subset-137]</dt>
      <dd>
<span class="refAuthor">UNISIG</span>, <span class="refTitle">"Subset-137; ERTMS/ETCS On-line Key Management FFFIS; V1.0.0"</span>, <time datetime="2015-12" class="refDate">December 2015</time>, <span>&lt;<a href="https://www.era.europa.eu/filebrowser/download/542_en">https://www.era.europa.eu/filebrowser/download/542_en</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="Param_Example">
<section id="appendix-A">
      <h2 id="name-example-certreqtemplate">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-example-certreqtemplate" class="section-name selfRef">Example CertReqTemplate</a>
      </h2>
<p id="appendix-A-1" class="keepWithNext">Suppose the server requires that the certTemplate contains<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A-2.1">the issuer field with a value to be filled in by the EE,<a href="#appendix-A-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-A-2.2">the subject field with a common name to be filled in by the EE and two organizational unit fields with given values "myDept" and "myGroup",<a href="#appendix-A-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-A-2.3">the publicKey field contains an ECC key on curve secp256r1 or an RSA public key of length 2048,<a href="#appendix-A-2.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-A-2.4">the subjectAltName extension with DNS name "www.myServer.com" and an IP address to be filled in,<a href="#appendix-A-2.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-A-2.5">the keyUsage extension marked critical with the value digitalSignature and keyAgreement, and<a href="#appendix-A-2.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-A-2.6">the extKeyUsage extension with values to be filled in by the EE.<a href="#appendix-A-2.6" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-A-3" class="keepWithNext">Then the infoValue with certTemplate and keySpec fields returned to the EE will be encoded as follows:<a href="#appendix-A-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A-4">
<pre>
SEQUENCE {
  SEQUENCE {
    [3] {
      SEQUENCE {}
      }
    [5] {
      SEQUENCE {
        SET {
          SEQUENCE {
            OBJECT IDENTIFIER commonName (2 5 4 3)
            UTF8String ""
            }
          }
        SET {
          SEQUENCE {
            OBJECT IDENTIFIER organizationalUnitName (2 5 4 11)
            UTF8String "myDept"
            }
          }
        SET {
          SEQUENCE {
            OBJECT IDENTIFIER organizationalUnitName (2 5 4 11)
            UTF8String "myGroup"
            }
          }
        }
      }
    [9] {
      SEQUENCE {
        OBJECT IDENTIFIER subjectAltName (2 5 29 17)
        OCTET STRING, encapsulates {
          SEQUENCE {
            [2] "www.myServer.com"
            [7] ""
            }
          }
        }
      SEQUENCE {
        OBJECT IDENTIFIER keyUsage (2 5 29 15)
        BOOLEAN TRUE
        OCTET STRING, encapsulates {
          BIT STRING 3 unused bits
            "10001"B
          }
        }
      SEQUENCE {
        OBJECT IDENTIFIER extKeyUsage (2 5 29 37)
        OCTET STRING, encapsulates {
          SEQUENCE {}
          }
        }
      }
    }
  SEQUENCE {
    SEQUENCE {
      OBJECT IDENTIFIER algId (1 3 6 1 5 5 7 5 1 11)
        SEQUENCE {
          OBJECT IDENTIFIER ecPublicKey (1 2 840 10045 2 1)
          OBJECT IDENTIFIER secp256r1 (1 2 840 10045 3 1 7)
          }
      }
    SEQUENCE {
      OBJECT IDENTIFIER rsaKeyLen (1 3 6 1 5 5 7 5 1 12)
      INTEGER 2048
      }
    }
  }
</pre><a href="#appendix-A-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="History">
<section id="appendix-B">
      <h2 id="name-history-of-changes">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-history-of-changes" class="section-name selfRef">History of changes</a>
      </h2>
<p id="appendix-B-1">Note: This appendix will be deleted in the final version of the document.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<p id="appendix-B-2" class="keepWithNext">From version 09 -&gt; 10:<a href="#appendix-B-2" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-B-3.1">Resolved some nits reported by I-D nit checker tool<a href="#appendix-B-3.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-3.2">Resolve some wording issues<a href="#appendix-B-3.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-B-4" class="keepWithNext">From version 08 -&gt; 09:<a href="#appendix-B-4" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-B-5.1">Updated Section 1.1 and 1.2 and converted Section 2.2 and 2.3 into more detailed tables in Section 7 (see thread "WG Last Call for draft-ietf-lamps-cmp-updates-14 and draft-ietf-lamps-lightweight-cmp-profile-08")<a href="#appendix-B-5.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-5.2">Updated Section 3.1 and 4.1.1 making implicitConfirm recommended for ir/cr/p10cr/kur and providing further recommendations on its use (see thread "certConf - WG Last Call for draft-ietf-lamps-cmp-updates-14 and draft-ietf-lamps-lightweight-cmp-profile-08")<a href="#appendix-B-5.2" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-5.3">Updated Section 4.1.6 adding some clarifications regarding validating the authorization of centrally generated keys<a href="#appendix-B-5.3" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-5.4">Updated Section 4.3.4 adding some clarifications on CRL update retrieval (see thread "CRL update retrieval - WG Last Call for draft-ietf-lamps-cmp-updates-14 and draft-ietf-lamps-lightweight-cmp-profile-08")<a href="#appendix-B-5.4" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-5.5">Updated references to CMP Updates pointing to concrete sections (see thread "CRL update retrieval - WG Last Call for draft-ietf-lamps-cmp-updates-14 and draft-ietf-lamps-lightweight-cmp-profile-08"))<a href="#appendix-B-5.5" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-5.6">Corrected a couple of nits elsewhere<a href="#appendix-B-5.6" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-B-6" class="keepWithNext">From version 07 -&gt; 08:<a href="#appendix-B-6" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-B-7.1">Updates Section 4.1.6.1. regarding content of the originator and keyEncryptionAlgorithm fields (see thread "AD review of draft-ietf-lamps-cmp-algorithms-07")<a href="#appendix-B-7.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-7.2">Rolled back part of the changes on root CA certificate updates in Section 4.3.2 (see thread "Allocation of OIDs for CRL update retrieval (draft-ietf-lamps-cmp-updates-13)")<a href="#appendix-B-7.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-B-8" class="keepWithNext">From version 06 -&gt; 07:<a href="#appendix-B-8" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-B-9.1">Added references to [draft-ietf-netconf-sztp-csr] in new Section 1.5 and Section 4.1.4<a href="#appendix-B-9.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-9.2">Added reference to [I-D.ietf-anima-brski-async-enroll] in new Section 1.5 and Section 4.1.1<a href="#appendix-B-9.2" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-9.3">Changed reference in Section 2 to [I-D.ietf-anima-brski-prm] as the PUSH use case is continued to be discussed in this draft after the split of BRSKI-AE<a href="#appendix-B-9.3" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-9.4">Improved note regarding UNISIG Subset-137 in Section 1.6<a href="#appendix-B-9.4" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-9.5">Removed "rootCaCert" in Section 3.1 and updated the structure of the genm request for root CA certificate updates in Section 4.3.2.<a href="#appendix-B-9.5" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-9.6">Simplified handling of sender and recipient nonces in case of delayed delivery in Sections 3.1, 3.5, 4.4, and 5.1.2<a href="#appendix-B-9.6" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-9.7">Changed the order of Sections 4.1.4 and 4.1.5<a href="#appendix-B-9.7" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-9.8">Added reference on RFC 8933 regarding CMS signedAttrs to Section 4.1.6<a href="#appendix-B-9.8" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-9.9">Added Section 4.3.4 on CRL update retrieval<a href="#appendix-B-9.9" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-9.10">Generalized delayed enrollment to delayed delivery in Section 4.4 and 5.1.2, updated the state machine in the introduction of Section 4<a href="#appendix-B-9.10" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-9.11">Updated Section 6 regarding delayed message transfer<a href="#appendix-B-9.11" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-9.12">Changed file name extension from ".PKI" to ".pki", deleted operational path for central key generation, and added an operational path for CRL update retrieval in Sections 6.1 and 6.2<a href="#appendix-B-9.12" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-9.13">Shifted many security considerations to CMP Updates<a href="#appendix-B-9.13" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-9.14">Replaced the term "transport" by "transfer" where appropriate to prevent confusion regarding TCP vs. HTTP and CoAP<a href="#appendix-B-9.14" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-9.15">Various editorial changes and language corrections<a href="#appendix-B-9.15" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-B-10" class="keepWithNext">From version 05 -&gt; 06:<a href="#appendix-B-10" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-B-11.1">Changed in Section 2.3 the normative requirement in of adding protection to a single message to mandatory and replacing protection to optional<a href="#appendix-B-11.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-11.2">Added Section 3.4 specifying generic prerequisites to PKI management operations<a href="#appendix-B-11.2" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-11.3">Added Section 3.5 specifying generic message validation<a href="#appendix-B-11.3" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-11.4">Added Section 3.6 on generic error reporting. This section replaces the former error handling section from Section 4 and 5.<a href="#appendix-B-11.4" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-11.5">Added reference to using hashAlg<a href="#appendix-B-11.5" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-11.6">Updates Section 4.3.2 and Section 4.3.3 to align with CMP Updates<a href="#appendix-B-11.6" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-11.7">Added Section 5.1 specifying the behavior of PKI management entities when responding to requests<a href="#appendix-B-11.7" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-11.8">Reworked Section 5.2.3. on usage of nested messages<a href="#appendix-B-11.8" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-11.9">Updates Section 5.3 on performing PKI management operation on behalf of another entity<a href="#appendix-B-11.9" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-11.10">Updates Section 6.2 on HTTPS transport of CMP messages as discusses at IETF 110 and email thread "I-D Action: draft-ietf-lamps-lightweight-cmp-profile-05.txt"<a href="#appendix-B-11.10" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-11.11">Added CoAP endpoints to Section 6.4<a href="#appendix-B-11.11" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-11.12">Added security considerations on usage of shared secret information<a href="#appendix-B-11.12" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-11.13">Updated the example in Appendix A<a href="#appendix-B-11.13" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-11.14">Added newly registered OIDs to the example in Appendix A<a href="#appendix-B-11.14" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-11.15">Updated new RFC numbers for I-D.ietf-lamps-crmf-update-algs<a href="#appendix-B-11.15" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-11.16">Multiple language corrections, clarifications, and changes in wording<a href="#appendix-B-11.16" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-B-12" class="keepWithNext">From version 04 -&gt; 05:<a href="#appendix-B-12" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-B-13.1">Changed to XML V3<a href="#appendix-B-13.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-13.2">Added algorithm names introduced in CMP Algorithms Section 7.3 to Section 4 of this document<a href="#appendix-B-13.2" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-13.3">Updates Syntax in Section 4.4.3 due to changes made in CMP Updates<a href="#appendix-B-13.3" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-13.4">Deleted the text on HTTP-based discovery as discussed in Section 6.1<a href="#appendix-B-13.4" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-13.5">Updates Appendix A due to change syntax in Section 4.4.3<a href="#appendix-B-13.5" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-13.6">Many clarifications and changes in wording thanks to David's extensive review<a href="#appendix-B-13.6" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-B-14" class="keepWithNext">From version 03 -&gt; 04:<a href="#appendix-B-14" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-B-15.1">Deleted normative text sections on algorithms and refer to CMP Algorithms and CRMF Algorithm Requirements Update instead<a href="#appendix-B-15.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-15.2">Some clarifications and changes in wording<a href="#appendix-B-15.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-B-16" class="keepWithNext">From version 02 -&gt; 03:<a href="#appendix-B-16" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-B-17.1">Updated the interoperability with [UNISIG.Subset-137] in Section 1.4.<a href="#appendix-B-17.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-17.2">Changed Section 2.3 to a tabular layout to enhanced readability<a href="#appendix-B-17.2" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-17.3">Added a ToDo to section 3.1 on aligning with the CMP Algorithms draft that will be set up as decided in IETF 108<a href="#appendix-B-17.3" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-17.4">Updated section 4.1.6 to add the AsymmetricKey Package structure to transport a newly generated private key as decided in IETF 108<a href="#appendix-B-17.4" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-17.5">Added a ToDo to section 4.1.7 on required review of the nonce handling in case an offline LRA responds and not forwards the pollReq messages<a href="#appendix-B-17.5" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-17.6">Updated Section 4 due to the definition of the new ITAV OIDs in CMP Updates<a href="#appendix-B-17.6" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-17.7">Updated Section 4.4.4 to utilize controls instead of rsaKeyLen (see thread "dtaft-ietf-lamps-cmp-updates and rsaKeyLen")<a href="#appendix-B-17.7" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-17.8">Deleted the section on definition and discovery of HTTP URIs and copied the text to the HTTP transport section and to CMP Updates section 3.2<a href="#appendix-B-17.8" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-17.9">Added some explanation to Section 5.1.2 and Section 5.1.3 on using nested messages when a protection by the RA is required.<a href="#appendix-B-17.9" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-17.10">Deleted the section on HTTP URI definition and discovery as some content was moved to CMP Updates. The rest of the content was moved back to the HTTP transport section<a href="#appendix-B-17.10" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-17.11">Deleted the ASN.1 module after moving the new OIDs id-it-caCerts, id-it-rootCaKeyUpdate, and id-it-certReqTemplate to CMP Updates<a href="#appendix-B-17.11" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-17.12">Minor changes in wording and addition of some open ToDos<a href="#appendix-B-17.12" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-B-18" class="keepWithNext">From version 01 -&gt; 02:<a href="#appendix-B-18" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-B-19.1">Extend <a href="#Compatibility" class="xref">Section 1.6</a> with regard to conflicts with UNISIG Subset-137.<a href="#appendix-B-19.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-19.2">Minor clarifications on extraCerts in <a href="#extraCerts" class="xref">Section 3.3</a> and <a href="#EE_newPKI" class="xref">Section 4.1.1</a>.<a href="#appendix-B-19.2" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-19.3">Complete specification of requesting a certificate from a trusted PKI with signature protection in <a href="#EE_trustedPKI" class="xref">Section 4.1.2</a>.<a href="#appendix-B-19.3" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-19.4">Changed from symmetric key-encryption to password-based key management technique in  <a href="#EE_KGPB" class="xref">Section 4.1.6.3</a> as discussed on the mailing list (see thread "draft-ietf-lamps-lightweight-cmp-profile-01, section 5.1.6.1")<a href="#appendix-B-19.4" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-19.5">Changed delayed enrollment described in <a href="#EE_Polling" class="xref">Section 4.4</a> from recommended to optional as decided at IETF 107<a href="#appendix-B-19.5" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-19.6">Introduced the new RootCAKeyUpdate structure for root CA certificate update in <a href="#EE_RootCAUpdate" class="xref">Section 4.3.2</a> as decided at IETF 107 (also see email thread "draft-ietf-lamps-lightweight-cmp-profile-01, section 5.4.3")<a href="#appendix-B-19.6" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-19.7">Extend the description of the CertReqTemplate PKI management operation, including an example added in the Appendix.  Keep rsaKeyLen as a single integer value in <a href="#EE_Temp" class="xref">Section 4.3.3</a> as discussed on the mailing list (see thread "draft-ietf-lamps-lightweight-cmp-profile-01, section 5.4.4")<a href="#appendix-B-19.7" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-19.8">Deleted Sections "Get certificate management configuration" and "Get enrollment voucher" as decided at IETF 107<a href="#appendix-B-19.8" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-19.9">Complete specification of adding an additional protection by an PKI management entity in <a href="#RA_Add" class="xref">Section 5.2.2</a>.<a href="#appendix-B-19.9" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-19.10">Added a section on HTTP URI definition and discovery and extended <a href="#HTTP" class="xref">Section 6.1</a> on definition and discovery of supported HTTP URIs and content types, add a path for nested messages as specified in <a href="#RA_Add" class="xref">Section 5.2.2</a> and delete the paths for /getCertMgtConfig and /getVoucher<a href="#appendix-B-19.10" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-19.11">Changed <a href="#Offline" class="xref">Section 6.4</a> to address offline transport and added more detailed specification file-based transport of CMP<a href="#appendix-B-19.11" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-19.12">Added a reference to the new I-D of Mohit Sahni on "CoAP Transport for CMPV2" in <a href="#CoAP" class="xref">Section 6.2</a>; thanks to Mohit supporting the effort to ease utilization of CMP<a href="#appendix-B-19.12" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-19.13">Moved the change history to the Appendix<a href="#appendix-B-19.13" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-19.14">Minor changes in wording<a href="#appendix-B-19.14" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-B-20" class="keepWithNext">From version 00 -&gt; 01:<a href="#appendix-B-20" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-B-21.1">
          <p id="appendix-B-21.1.1">Harmonize terminology with <span><a href="#RFC4210" class="xref">CMP</a> [<a href="#RFC4210" class="xref">RFC4210</a>]</span>, e.g.,<a href="#appendix-B-21.1.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-B-21.1.2.1">transaction, message sequence, exchange, use case -&gt; PKI management operation<a href="#appendix-B-21.1.2.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-B-21.1.2.2">PKI component, (L)RA/CA -&gt; PKI management entity<a href="#appendix-B-21.1.2.2" class="pilcrow">¶</a>
</li>
          </ul>
</li>
        <li class="compact" id="appendix-B-21.2">Minor changes in wording<a href="#appendix-B-21.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-B-22" class="keepWithNext">From draft-brockhaus-lamps-lightweight-cmp-profile-03 -&gt; draft-ietf-lamps-lightweight-cmp-profile-00:<a href="#appendix-B-22" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-B-23.1">Changes required to reflect WG adoption<a href="#appendix-B-23.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-23.2">Minor changes in wording<a href="#appendix-B-23.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-B-24" class="keepWithNext">From version 02 -&gt; 03:<a href="#appendix-B-24" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-B-25.1">Added a short summary of <span>[<a href="#RFC4210" class="xref">RFC4210</a>]</span> Appendix D and E in <a href="#Existing_profiles" class="xref">Section 1.4</a>.<a href="#appendix-B-25.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-25.2">Clarified some references to different sections and added some clarification in response to feedback from Michael Richardson and Tomas Gustavsson.<a href="#appendix-B-25.2" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-25.3">Added an additional label to the operational path to address multiple CAs or certificate profiles in <a href="#HTTP" class="xref">Section 6.1</a>.<a href="#appendix-B-25.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-B-26" class="keepWithNext">From version 01 -&gt; 02:<a href="#appendix-B-26" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-B-27.1">Added some clarification on the key management techniques for protection of centrally generated keys in <a href="#EE_centralKeyGeneration" class="xref">Section 4.1.6</a>.<a href="#appendix-B-27.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-27.2">Added some clarifications on the certificates for root CA certificate update in <a href="#EE_RootCAUpdate" class="xref">Section 4.3.2</a>.<a href="#appendix-B-27.2" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-27.3">Added a section to specify the usage of nested messages for RAs to add an additional protection for further discussion, see <a href="#RA_Add" class="xref">Section 5.2.2</a>.<a href="#appendix-B-27.3" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-27.4">Added a table containing endpoints for HTTP transport in <a href="#HTTP" class="xref">Section 6.1</a> to simplify addressing PKI management entities.<a href="#appendix-B-27.4" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-27.5">Added some ToDos resulting from discussion with Tomas Gustavsson.<a href="#appendix-B-27.5" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-27.6">Minor clarifications and changes in wording.<a href="#appendix-B-27.6" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-B-28" class="keepWithNext">From version 00 -&gt; 01:<a href="#appendix-B-28" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-B-29.1">Added a section to specify the enrollment with an already trusted PKI for further discussion, see <a href="#EE_trustedPKI" class="xref">Section 4.1.2</a>.<a href="#appendix-B-29.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-29.2">Complete specification of requesting a certificate from a legacy PKI using a <span><a href="#RFC2986" class="xref">PKCS#10</a> [<a href="#RFC2986" class="xref">RFC2986</a>]</span> request in <a href="#EE_P10" class="xref">Section 4.1.4</a>.<a href="#appendix-B-29.2" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-29.3">Complete specification of adding central generation of a key pair on behalf of an end entity in <a href="#EE_centralKeyGeneration" class="xref">Section 4.1.6</a>.<a href="#appendix-B-29.3" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-29.4">Complete specification of handling delayed enrollment due to asynchronous message delivery in <a href="#EE_Polling" class="xref">Section 4.4</a>.<a href="#appendix-B-29.4" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-29.5">Complete specification of additional support messages, e.g., to update a Root CA certificate or to request an <span><a href="#RFC8366" class="xref">RFC 8366</a> [<a href="#RFC8366" class="xref">RFC8366</a>]</span> voucher, in <a href="#EE_GeneralMessage" class="xref">Section 4.3</a>.<a href="#appendix-B-29.5" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-29.6">Minor changes in wording.<a href="#appendix-B-29.6" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-B-30" class="keepWithNext">From draft-brockhaus-lamps-industrial-cmp-profile-00 -&gt; draft-brockhaus-lamps-lightweight-cmp-profile-00:<a href="#appendix-B-30" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-B-31.1">Change focus from industrial to more multi-purpose use cases and lightweight CMP profile.<a href="#appendix-B-31.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-31.2">Incorporate the omitted confirmation into the header specified in <a href="#Header" class="xref">Section 3.1</a> and described in the standard enrollment use case in <a href="#EE_newPKI" class="xref">Section 4.1.1</a> due to discussion with Tomas Gustavsson.<a href="#appendix-B-31.2" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-31.3">Change from OPTIONAL to RECOMMENDED for use case 'Revoke another's entities certificate' in <a href="#RA_on-behalf_revoke" class="xref">Section 5.3.2</a>, because it is regarded as important functionality in many environments to enable the management station to revoke EE certificates.<a href="#appendix-B-31.3" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-31.4">Complete the specification of the revocation message flow in <a href="#EE_Revoke" class="xref">Section 4.2</a> and <a href="#RA_on-behalf_revoke" class="xref">Section 5.3.2</a>.<a href="#appendix-B-31.4" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-31.5">The CoAP based transport mechanism and piggybacking of CMP messages on top of other reliable transport protocols is out of scope of this document and would need to be specified in another document.<a href="#appendix-B-31.5" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-B-31.6">Further minor changes in wording.<a href="#appendix-B-31.6" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Hendrik Brockhaus (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">Siemens AG</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:hendrik.brockhaus@siemens.com" class="email">hendrik.brockhaus@siemens.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">David von Oheimb</span></div>
<div dir="auto" class="left"><span class="org">Siemens AG</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:david.von.oheimb@siemens.com" class="email">david.von.oheimb@siemens.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Steffen Fries</span></div>
<div dir="auto" class="left"><span class="org">Siemens AG</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:steffen.fries@siemens.com" class="email">steffen.fries@siemens.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
