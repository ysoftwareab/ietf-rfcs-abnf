


Mobile Ad hoc Networking (MANET)                              T. Clausen
Internet-Draft                          LIX, Ecole Polytechnique, France
Intended status: Standards Track                             C. Dearlove
Expires: December 22, 2007               BAE Systems Advanced Technology
                                                                  Centre
                                                                 J. Dean
                                               Naval Research Laboratory
                                                                C. Adjih
                                                      INRIA Rocquencourt
                                                           June 20, 2007


                Generalized MANET Packet/Message Format
                      draft-ietf-manet-packetbb-06

Status of this Memo

   By submitting this Internet-Draft, each author represents that any
   applicable patent or other IPR claims of which he or she is aware
   have been or will be disclosed, and any of which he or she becomes
   aware will be disclosed, in accordance with Section 6 of BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups.  Note that
   other groups may also distribute working documents as Internet-
   Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt.

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html.

   This Internet-Draft will expire on December 22, 2007.

Copyright Notice

   Copyright (C) The IETF Trust (2007).








Clausen, et al.         Expires December 22, 2007               [Page 1]

Internet-Draft             MANET packet format                 June 2007


Abstract

   This document specifies a multi-message packet format that may be
   used by mobile ad hoc network routing and other protocols.


Table of Contents

   1.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . .  3
   2.  Terminology  . . . . . . . . . . . . . . . . . . . . . . . . .  5
   3.  Applicability Statement  . . . . . . . . . . . . . . . . . . .  6
   4.  Protocol Overview and Functioning  . . . . . . . . . . . . . .  7
   5.  Signaling Framework  . . . . . . . . . . . . . . . . . . . . .  8
     5.1.  Packets  . . . . . . . . . . . . . . . . . . . . . . . . .  8
     5.2.  Messages . . . . . . . . . . . . . . . . . . . . . . . . .  9
       5.2.1.  Address Blocks . . . . . . . . . . . . . . . . . . . . 11
     5.3.  TLVs and TLV Blocks  . . . . . . . . . . . . . . . . . . . 13
       5.3.1.  TLVs . . . . . . . . . . . . . . . . . . . . . . . . . 13
       5.3.2.  Constraints  . . . . . . . . . . . . . . . . . . . . . 16
     5.4.  Padding  . . . . . . . . . . . . . . . . . . . . . . . . . 16
   6.  TLV specification  . . . . . . . . . . . . . . . . . . . . . . 17
     6.1.  Address Block TLV Specification  . . . . . . . . . . . . . 17
   7.  IANA Considerations  . . . . . . . . . . . . . . . . . . . . . 18
   8.  Security Considerations  . . . . . . . . . . . . . . . . . . . 19
   9.  References . . . . . . . . . . . . . . . . . . . . . . . . . . 20
     9.1.  Normative References . . . . . . . . . . . . . . . . . . . 20
     9.2.  Informative References . . . . . . . . . . . . . . . . . . 20
   Appendix A.   Examples . . . . . . . . . . . . . . . . . . . . . . 21
     A.1.  Address Block Examples . . . . . . . . . . . . . . . . . . 21
     A.2.  TLV Examples . . . . . . . . . . . . . . . . . . . . . . . 22
   Appendix B.   Illustrations  . . . . . . . . . . . . . . . . . . . 25
   Appendix B.1. Packet . . . . . . . . . . . . . . . . . . . . . . . 25
   Appendix B.2. Message and Padding  . . . . . . . . . . . . . . . . 27
   Appendix B.3. Message Body . . . . . . . . . . . . . . . . . . . . 33
   Appendix B.4. Address Block  . . . . . . . . . . . . . . . . . . . 34
   Appendix B.5. TLV Block  . . . . . . . . . . . . . . . . . . . . . 36
   Appendix B.6. TLV  . . . . . . . . . . . . . . . . . . . . . . . . 36
   Appendix C.   Complete Example . . . . . . . . . . . . . . . . . . 39
   Appendix D.   Contributors . . . . . . . . . . . . . . . . . . . . 41
   Appendix E.   Acknowledgements . . . . . . . . . . . . . . . . . . 42
   Authors' Addresses . . . . . . . . . . . . . . . . . . . . . . . . 43
   Intellectual Property and Copyright Statements . . . . . . . . . . 44









Clausen, et al.         Expires December 22, 2007               [Page 2]

Internet-Draft             MANET packet format                 June 2007


1.  Introduction

   This document specifies the syntax of a general purpose multi-message
   packet format for information exchange between MANET routers.
   Messages consist of a message header, which is designed for control
   of message dissemination, and a message body, which contains protocol
   information.  Only the syntax of the message body is specified.  All
   syntactical entities, including messages and packets, are specified
   using regular expressions.

   This document specifies:

   o  A packet format, allowing zero or more messages to be contained
      within a single transmission, and optionally including a packet
      header.  A packet with zero messages may be sent in case the only
      information to exchange is contained in the packet header (such as
      a "keep alive" sequence number).

   o  A message format, where a message is composed of a message header
      and a message body.

   o  A message header format which allows a node to make forwarding
      decisions based on the node's present state and the message
      header, without inspecting and processing the message body, and
      independently of the TTL or hop limit information in the IP
      header.  Message header information permits single- and multi-hop
      message diffusion.

   o  A message body format, containing attributes associated with the
      message or the originator of the message, as well as blocks of
      addresses with associated attributes.

   o  An address block format, where an address block represents sets of
      addresses in a compact (compressed) form.

   o  A generalized type-length-value (TLV) format representing
      attributes.  Multiple TLVs can be included and associated with a
      packet, a message, an address, or a set of addresses.

   The specification has been explicitly designed with the following
   properties, listed in no particular order, in mind:

   Parsing logic  - the regular expression specification facilitates
      generic, protocol independent, parsing logic.







Clausen, et al.         Expires December 22, 2007               [Page 3]

Internet-Draft             MANET packet format                 June 2007


   Extensibility  - packets and messages defined by a protocol using
      this specification are extensible through defining new message
      types and new TLVs.  Existing protocol specifications using this
      specification will be able to correctly identify and skip such new
      message types and TLVs, while correctly parsing the remainder of
      the packet and message.

   Efficiency  - when reported addresses share common bit sequences
      (e.g. prefixes or IPv6 interface identifiers) the address block
      representation allows for a compact representation.  Compact
      message headers are ensured through permitting inclusion of only
      required message header elements.

   Separation of forwarding and processing  - duplicate detection and
      controlled scope message forwarding decisions can be made using
      information contained in the message header, without processing
      the message body.


































Clausen, et al.         Expires December 22, 2007               [Page 4]

Internet-Draft             MANET packet format                 June 2007


2.  Terminology

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in RFC 2119. [1].

   Additionally, this document uses the following terminology:

   Packet  - the top level entity in this specification.  Packets are
      transmitted over a single logical hop and are not forwarded.  A
      packet contains zero or more messages, and may contain a packet
      header.

   Message  - the fundamental entity carrying protocol information, in
      the form of addresses and TLVs.  Messages are transmitted in
      packets, and may be forwarded based on their header information.

   Address  - an address of the same length as the source IP address in
      the IP datagram carrying the packet.

   TLV  - a Type-Length-Value structure.  This is a generic way in which
      an attribute can be represented and correctly parsed, without the
      parser having to understand the attribute.

   element  - a syntactic entity defined in the regular expression
      specification, represented using the notation <foo>.

   <foo>  - if <foo> is an 8 or 16 bit field then <foo> is also used to
      represent the value of that field.

   ?  - zero or one occurrences of the preceding element.

   *  - zero or more occurrences of the preceding element.

   bar  - a variable, usually obtained through calculations based on the
      value(s) of field(s).  Variables are introduced into the
      specification solely as a means to clarify the description.

   address-length  - a variable whose value is the length of an address
      in octets, it is 4 if using IPv4, 16 if using IPv6.











Clausen, et al.         Expires December 22, 2007               [Page 5]

Internet-Draft             MANET packet format                 June 2007


3.  Applicability Statement

   This specification describes a generic multi-message packet format,
   for carrying MANET routing protocol signals.  The specification has
   been developed from that used by OLSR (The Optimized Link State
   Routing Protocol) [4].

   The specification is designed specifically with IP (IPv4/IPv6) in
   mind.  All addresses within a control message are assumed to be of
   the same size, deduced from IP.  In the case of mixed IPv6 and IPv4
   addresses, IPv4 addresses are represented as IPv4-mapped IPv6
   addresses as specified in [2].

   The messages defined by this specification are designed to carry
   routing protocol signals between MANET routers, and to support scope
   limited diffusion, as well as point to point signaling in a multi-hop
   network.

   The packets defined by this specification are designed to carry a
   number of messages between in a single transmission.  The packets may
   be unicast or multicast and may use any transport protocol (TCP, UDP,
   ...) appropriate to the protocol using this specification and may
   travel over a single logical hop which might consist of one or more
   IP hops.  When the diffusion mechanism enabled by this specification
   is employed, UDP may be most appropriate.

   This specification is particularly appropriate for extensible
   protocols.  It offers external extensibility in the form of new
   message types.  It offers internal extensibility in the form of TLVs,
   which may be added to existing message types.

   A protocol using the multi-message packet format defined by this
   specification may constrain the syntax (for example requiring a full
   message header) and features (for example specifying the suggested
   diffusion mechanism) that the protocol will employ.
















Clausen, et al.         Expires December 22, 2007               [Page 6]

Internet-Draft             MANET packet format                 June 2007


4.  Protocol Overview and Functioning

   This specification does not describe a protocol.  It describes a
   packet format, which may be used by any mobile ad hoc network routing
   or other protocol.














































Clausen, et al.         Expires December 22, 2007               [Page 7]

Internet-Draft             MANET packet format                 June 2007


5.  Signaling Framework

   This section provides syntactical specification of a packet,
   represented by the element <packet> and the elements from which it is
   composed.  The specification is given in the form of regular
   expressions.  Illustrations of specified elements are given in
   Appendix B.

   The length of a <packet> is obtained as the size of the payload of
   the transport protocol employed.

5.1.  Packets

   <packet> is defined by:

       <packet> = {<packet-header><pad-octet>*}?
                  {<message><pad-octet>*}*

   where <message> is defined in Section 5.2, and <pad-octet> is defined
   in Section 5.4.  Successful parsing is terminated when all octets are
   used.

   <packet-header> is defined by:

       <packet-header> = <zero>
                         <packet-semantics>
                         <packet-seq-number>?
                         <tlv-block>?

   where:

   <zero>  is an 8 bit field with all bits cleared ('0').  This field
      serves to identify that the packet starts with a packet header.

   <packet-semantics>  is an 8 bit field, specifying the composition of
      the packet header:

      bit 0 (pnoseqnum):  if cleared ('0'), then the packet header
         contains a <packet-seq-number>.  If set ('1'), then the packet
         header does not include a <packet-seq-number>.

      bit 1 (ptlv):  if cleared ('0'), then the packet header does not
         include a TLV block.  If set ('1'), then the packet header
         includes a TLV block.







Clausen, et al.         Expires December 22, 2007               [Page 8]

Internet-Draft             MANET packet format                 June 2007


      bits 2-7:  are RESERVED, and MUST each be cleared ('0') to be in
         conformance with this version of the specification.

   <packet-seq-number>  is omitted if the pnoseqnum bit is set ('1'),
      otherwise is a 16 bit field, specifying a packet sequence number.

   <tlv-block>  is omitted if the ptlv bit is cleared ('0'), and is
      otherwise defined in Section 5.3.

   Note that since the message type zero is reserved (see Section 7),
   the presence or absence of a packet header can be determined by
   inspecting the first octet of the packet.

5.2.  Messages

   Information is carried through messages.  Messages contain:

   o  A message header.

   o  A message TLV block that contains zero or more TLVs, associated
      with the whole message.

   o  Zero or more address blocks, each containing one or more
      addresses.

   o  A TLV block, containing zero or more TLVs, following each address
      block.

   <message> is defined by:

       <message>         = <msg-header>
                           <tlv-block>
                           {<addr-block><tlv-block>}*

       <msg-header>      = <msg-type>
                           <msg-semantics>
                           <msg-size>
                           <msg-header-info>

       <msg-header-info> = <originator-address>?
                           <hop-limit>?
                           <hop-count>?
                           <msg-seq-number>?

   where:






Clausen, et al.         Expires December 22, 2007               [Page 9]

Internet-Draft             MANET packet format                 June 2007


   <tlv-block>  is defined in Section 5.3.

   <addr-block>  is defined in Section 5.2.1.

   <msg-type>  is an 8 bit field, specifying the type of message.  A
      type with all bits cleared ('0') MUST NOT be used.

   <msg-semantics>  is an 8 bit field, specifying the interpretation of
      the remainder of the message header:

      bit 0 (noorig):  If cleared ('0'), then <originator-address> is
         included in the <msg-header-info>.  If set ('1'), then
         <originator-address> is not included in the <msg-header-info>.

      bit 1 (nohoplimit):  If cleared ('0'), then <hop-limit> is
         included in the <msg-header-info>.  If set ('1'), then <hop-
         limit> is not included in the <msg-header-info>.

      bit 2 (nohopcount):  If cleared ('0'), then <hop-count> is
         included in the <msg-header-info>.  If set ('1'), then <hop-
         count> is not included in the <msg-header-info>

      bit 3 (noseqnum):  If cleared ('0'), then <msg-seq-number> is
         included in the <msg-header-info>.  If set ('1'), then <msg-
         seq-number> is not included in the <msg-header-info>.

      bit 4 (typedep):  If cleared ('0'), then the message sequence
         number in the message is type-independent.  If set ('1'), then
         the message sequence number contained in the message is type
         dependent (the message originator maintains a sequence number
         specific to <msg-type>).  This bit MUST be cleared ('0') if the
         noorig bit is set ('1').

      bits 5-7:  are RESERVED and MUST each be cleared ('0') to be in
         conformance with this version of the specification.

      If bit 0 (noorig) and bit 3 (noseqnum) are both cleared, then the
      message header provides for duplicate suppression.

      If bit 1 (nohoplimit) and bit 2 (nohopcount) are both cleared,
      then the message header provides for scope-delimited forwarding.

   <msg-size>  is a 16 bit field, specifying the size of the <message>,
      counted in octets.







Clausen, et al.         Expires December 22, 2007              [Page 10]

Internet-Draft             MANET packet format                 June 2007


   <originator-address>  is an identifier of length equal to address-
      length, which serves to uniquely identify the node that originated
      the message.

   <hop-limit>  is an 8 bit field, which contains the maximum number of
      logical hops a message should be further transmitted.

   <hop-count>  is an 8 bit field, which contains the number of logical
      hops a message has traveled.

   <msg-seq-number>  is a 16 bit field, which contains a unique number,
      generated by the originator node.  The <originator-address>, <msg-
      seq-number>, and, if the typedep bit in the <msg-semantics> field
      is set, the <msg-type> of a message serves to uniquely identify
      the message in the network.

5.2.1.  Address Blocks

   An address is specified as a sequence of address-length octets of the
   form head:mid:tail.  An address block is an ordered set of addresses
   sharing the same head and tail, and having individual mids.  Network
   addresses may be represented using the PREFIX_LENGTH TLV defined in
   Section 6.

   <address block> is defined by:

       <address-block> = <num-addr>
                         <addr-semantics>
                         <head-length>?
                         <head>?
                         <tail-length>?
                         <tail>?
                         <mid>*

   where:

   <num-addr>  is an 8 bit field containing the number of addresses
      represented in the address block, which MUST NOT be zero.

   <addr-semantics>  is an 8 bit field specifying the interpretation of
      the remainder of the address block:

      bit 0 (nohead):  if cleared ('0'), then <head-length> is included
         in <address-block>, and <head> may be included in <address-
         block>.  If set ('1'), then <head-length> and <head> are not
         included in <address-block>.





Clausen, et al.         Expires December 22, 2007              [Page 11]

Internet-Draft             MANET packet format                 June 2007


      bit 1 (notail) and bit 2 (zerotail):  MUST NOT both be set ('1').
         Otherwise, they are interpreted according to Table 1.

          +--------+----------+---------------+-----------------+
          | notail | zerotail | <tail-length> |      <tail>     |
          +--------+----------+---------------+-----------------+
          |    0   |     0    |    included   | may be included |
          |        |          |               |                 |
          |    0   |     1    |    included   |   not included  |
          |        |          |               |                 |
          |    1   |     0    |  not included |   not included  |
          +--------+----------+---------------+-----------------+

                                     Table 1

      bits 3-7:  are RESERVED and MUST each be cleared ('0') to be in
         accordance with this version of the specification.

   <head-length>  if present is an 8 bit field, which contains the total
      length (in octets) of the head of all of the addresses.

   head-length  is a variable, defined to equal <head-length> if
      present, or 0 otherwise.

   <head>  is omitted if head-length == 0, otherwise it is a field of
      the head-length leftmost octets of all the addresses.

   <tail-length>  if present is an 8 bit field, which contains the total
      length (in octets) of the tail of all of the addresses.

   tail-length  is a variable, defined to equal <tail-length> if
      present, or 0 otherwise.

   <tail>  is omitted if tail-length == 0 or if the zerotail bit is set
      ('1'), otherwise it is a field of the tail-length rightmost octets
      of all the addresses.  If the zerotail bit is set ('1') then the
      tail-length rightmost octets of all the addresses are all 0.

   mid-length  is a variable, which MUST be non-negative, defined by:

      *  mid-length = address-length - head-length - tail-length

   <mid>  is omitted if mid-length == 0, otherwise each <mid> is a field
      of length mid-length octets, representing the mid of the
      corresponding address in the address block.






Clausen, et al.         Expires December 22, 2007              [Page 12]

Internet-Draft             MANET packet format                 June 2007


5.3.  TLVs and TLV Blocks

   A TLV block is defined by:

       <tlv-block> = <tlv-length>
                     <tlv>*

   where:

   <tlv-length>  is a 16 bit field, which contains the total length (in
      octets) of all of the immediately following <tlv> elements.

   <tlv>  is defined in Section 5.3.1.

5.3.1.  TLVs

   There are three kinds of TLV, each represented by an element <tlv>:

   o  A packet TLV, included in a packet header.

   o  A message TLV, included in a message before all address blocks.

   o  An address block TLV, included in a TLV block following an address
      block.  An address block TLV applies to:

      *  all addresses in the address block; OR

      *  any continuous sequence of addresses in the address block; OR

      *  a single address in the address block.

   <tlv> is defined by:

       <tlv> = <tlv-type>
               <tlv-semantics>
               <index-start>?
               <index-stop>?
               <length>?
               <value>?

   where:

   <tlv-type>  is an 8 bit field, specifying the type of the TLV,
      specific to the TLV kind (i.e. packet, message, or address block
      TLV).






Clausen, et al.         Expires December 22, 2007              [Page 13]

Internet-Draft             MANET packet format                 June 2007


   <tlv-semantics>  is an 8 bit field specifying the interpretation of
      the remainder of the TLV:

      bit 0 (extended) and bit 1 (novalue):  MUST NOT both be set ('1').
         Otherwise, they are interpreted according to Table 2.

           +----------+---------+--------------+--------------+
           | extended | novalue |   <length>   |    <value>   |
           +----------+---------+--------------+--------------+
           |     0    |    0    |    8 bits    |   included   |
           |          |         |              |              |
           |     0    |    1    | not included | not included |
           |          |         |              |              |
           |     1    |    0    |    16 bits   |   included   |
           +----------+---------+--------------+--------------+

                                     Table 2

      bit 2 (noindex) and bit 3 (singleindex):  MUST NOT both be set
         ('1').  The former MUST be set ('1') and the latter MUST be
         cleared ('0') for packet or message TLVs.  They are interpreted
         according to Table 3.

         +---------+-------------+---------------+--------------+
         | noindex | singleindex | <index-start> | <index-stop> |
         +---------+-------------+---------------+--------------+
         |    0    |      0      |    included   |   included   |
         |         |             |               |              |
         |    0    |      1      |    included   | not included |
         |         |             |               |              |
         |    1    |      0      |  not included | not included |
         +---------+-------------+---------------+--------------+

                                     Table 3

      bit 4 (multivalue):  this bit serves to specify how the <value>
         field is interpreted, as specified below.  This bit MUST be
         cleared ('0') for packet or message TLVs, if the singleindex
         bit is set ('1'), or if the novalue bit is set ('1').

      bits 5-7:  are RESERVED and MUST each be cleared ('0') to be in
         accordance with this version of the specification.

   <index-start> and <index-stop>  when present are each an 8 bit field,
      interpreted as follows:






Clausen, et al.         Expires December 22, 2007              [Page 14]

Internet-Draft             MANET packet format                 June 2007


      index-start and index-stop  are variables, defined according to
         Table 4.  The variable end-index is defined as follows:

         +  For message and packet TLVs:

            -  end-index = 0

         +  For address block TLVs:

            -  end-index = <num-addr> - 1

         +---------+-------------+---------------+---------------+
         | noindex | singleindex | index-start = |  index-stop = |
         +---------+-------------+---------------+---------------+
         |    0    |      0      | <index-start> |  <index-stop> |
         |         |             |               |               |
         |    0    |      1      | <index-start> | <index-start> |
         |         |             |               |               |
         |    1    |      0      |       0       |   end-index   |
         +---------+-------------+---------------+---------------+

                                     Table 4

         For an address block TLV, the TLV applies to the addresses from
         position index-start to position index-stop (inclusive) in the
         address block, where the first address has position zero.

      number-values  is a variable, defined by:

         +  number-values = index-stop - index-start + 1

   <length>  is omitted or is a 8 or 16 bit field according to Table 2.
      If present it MUST NOT be zero.  If the multivalue bit is set
      ('1') then <length> MUST be an integral multiple of number-values,
      and the variable single-length is defined by:

      *  single-length = <length> / number-values

      If the multivalue bit is cleared ('0'), then the variable single-
      length is defined by:

      *  single-length = <length>

   <value>  if present (see Table 2) is a field of length <length>
      octets.  In an address block TLV, <value> is associated with the
      addresses from index-start to index-stop, inclusive.  If the
      multivalue bit is cleared ('0') then the whole of this field is
      associated with each of the indicated addresses.  If the



Clausen, et al.         Expires December 22, 2007              [Page 15]

Internet-Draft             MANET packet format                 June 2007


      multivalue bit is set ('1') then this field is divided equally
      into number-values fields, each of length single-length octets and
      these are associated, in order, with the indicated addresses.

5.3.2.  Constraints

   TLVs in the same TLV block MUST be sorted in ascending TLV type
   order.

   Two or more TLVs of the same type associated with the same address
   block MUST NOT both cover any address.

   TLVs of the same type associated with the same address block MUST be
   sorted in ascending index-start order.

5.4.  Padding

   Packet headers and messages MAY be padded to ensure 32 bit alignment
   of each message contained within the packet and of the overall packet
   length.

   All elements are an integer multiple of octets, hence padding can be
   accomplished by inserting an integer number of <pad-octet> elements
   after the element that is to be 32 bit aligned.

   The number of <pad-octet> elements required to achieve this 32 bit
   alignment is the smallest number (0 to 3) that, when added to the
   size of the preceding elements, produces an integer multiple of 4.

   <pad-octet>  is an 8 bit field with all bits cleared ('0').

   There is no need to indicate if padding is included, since a <pad-
   octet> will always precede either a message or the end of the packet.
   In the former case, the start of a message is indicated by the next
   non-zero octet parsed.

   The padding after a message may be freely changed when a message is
   forwarded without affecting the message.













Clausen, et al.         Expires December 22, 2007              [Page 16]

Internet-Draft             MANET packet format                 June 2007


6.  TLV specification

   This document specifies one address block TLV, which is included to
   allow a standardized way of representing network addresses.

6.1.  Address Block TLV Specification

   +----------------------+------+--------+----------------------------+
   |         Name         | Type | Length | Value                      |
   +----------------------+------+--------+----------------------------+
   |     PREFIX_LENGTH    |   0  | 8 bits | Indicates that the address |
   |                      |      |        | is a network address,      |
   |                      |      |        | rather than a host         |
   |                      |      |        | address.  The value is the |
   |                      |      |        | length of the              |
   |                      |      |        | prefix/netmask, in bits.   |
   +----------------------+------+--------+----------------------------+

                                  Table 5

   An address in an address block without an associated PREFIX_LENGTH
   TLV may be considered to have a prefix length equal to the address
   length in bits (i.e. address-length times 8).




























Clausen, et al.         Expires December 22, 2007              [Page 17]

Internet-Draft             MANET packet format                 June 2007


7.  IANA Considerations

   A new registry for message types must be created with initial
   assignments as specified in Table 6.  Future values in the range
   5-127 can be allocated using standards action [3].  Additionally,
   values in the range 128-255 are reserved for private/local use.

            +-------+----------------------------------------+
            | Value | Description                            |
            +-------+----------------------------------------+
            |   0   | MUST NOT be allocated.                 |
            |       |                                        |
            |  1-4  | RESERVED                               |
            +-------+----------------------------------------+

                                  Table 6

   Message type 0 MUST NOT be allocated because a zero-octet signifies a
   packet header and zero-octets are used for padding.  Message types 1
   to 4 are reserved because they are used by OLSR [4], which uses a
   compatible packet/message header format.

   A new registry for packet TLV types must be created, with no initial
   assignments.  Future values in the range 0-127 can be allocated using
   standards action [3].  Additionally, values in the range 128-255 are
   reserved for private/local use.

   A new registry for message TLV types must be created with no initial
   assignments.  Future values in the range 0-127 can be allocated using
   standards action [3].  Additionally, values in the range 128-255 are
   reserved for private/local use.

   A new registry for address block TLV types must be created with
   initial assignments as specified in Table 7.  Future values in the
   range 1-127 can be allocated using standards action [3].
   Additionally, values in the range 128-255 are reserved for private/
   local use.

   +--------------------+-------+--------------------------------------+
   |      Mnemonic      | Value | Description                          |
   +--------------------+-------+--------------------------------------+
   |    PREFIX_LENGTH   |   0   | Indicates that associated addresses  |
   |                    |       | are network addresses, with given    |
   |                    |       | prefix length, in bits.              |
   +--------------------+-------+--------------------------------------+

                                  Table 7




Clausen, et al.         Expires December 22, 2007              [Page 18]

Internet-Draft             MANET packet format                 June 2007


8.  Security Considerations

   Messages are designed to be carriers of protocol information and MAY,
   at each hop, be forwarded and/or processed according to the
   information in the message header by the protocol using this
   specification.

   For forwarded messages where the message is unchanged by forwarding
   nodes, then end-to-end security MAY be implemented, between nodes
   with an existing security association, by including a suitable
   message TLV containing a cryptographic signature in the message.
   Since <hop-count> and <hop-limit> are the only fields that may be
   modified when such a message is forwarded in this manner, this
   signature can be calculated based on the entire message, including
   the message header, with the <hop-count> and <hop-limit> fields set
   to zero ('0') if present.

   Packets are designed to carry a number of messages between
   neighboring nodes in a single transmission and over a single logical
   hop.  Hop-by-hop packet level security MAY be implemented, between
   nodes with an existing security association, by including a suitable
   packet TLV containing a cryptographic signature to the packet.  Since
   packets are received as transmitted, this signature can be calculated
   based on the entire packet, or on parts thereof as appropriate.



























Clausen, et al.         Expires December 22, 2007              [Page 19]

Internet-Draft             MANET packet format                 June 2007


9.  References

9.1.  Normative References

   [1]  Bradner, S., "Key words for use in RFCs to Indicate Requirement
        Levels", RFC 2119, BCP 14, March 1997.

   [2]  Hinden, R. and S. Deering, "IP Version 6 Addressing
        Architecture", RFC 4291, February 2006.

   [3]  Narten, T. and H. Alvestrand, "Guidelines for Writing an IANA
        Considerations Section in RFCs", October 1998.

9.2.  Informative References

   [4]  Clausen, T. and P. Jacquet, "The Optimized Link State Routing
        Protocol", RFC 3626, October 2003.


































Clausen, et al.         Expires December 22, 2007              [Page 20]

Internet-Draft             MANET packet format                 June 2007


Appendix A.  Examples

   This appendix contains some examples of parts of this specification.

A.1.  Address Block Examples

   The following examples illustrate how some combinations of addresses
   may be efficiently included in address blocks.  These examples are
   for IPv4, with address-length equal to 4. a, b, c etc. represent
   distinct, non-zero, octet values.

   Note that it is permissible to use a less efficient representation,
   in particular one in which the nohead and notail bits of the
   semantics octet are set, and hence head-length = 0, tail-length = 0,
   mid-length = address-length, and the address block consists of the
   number of addresses, the semantics octet with value 3, and a list of
   the uncompressed addresses.  This is also the most efficient way to
   represent a single address, and the only way to represent, for
   example, a.b.c.d and e.f.g.h in one address block.

   Examples:

   o  To include a.b.c.d, a.b.e.f and a.b.g.h:

      *  head-length = 2;

      *  tail-length = 0;

      *  mid-length = 2;

      *  <semantics> has notail set (value 2);

      *  <tail-length> and <tail> are omitted.

      The address block is then 3 2 2 a b c d e f g h (11 octets).

   o  To include a.b.c.g and d.e.f.g:

      *  head-length = 0;

      *  tail-length = 1;

      *  mid-length = 3;

      *  <semantics> has nohead set (value 1);

      *  <head-length> and <head> are omitted.




Clausen, et al.         Expires December 22, 2007              [Page 21]

Internet-Draft             MANET packet format                 June 2007


      The address block is then 2 1 1 g a b c d e f (10 octets).

   o  To include a.b.d.e and a.c.d.e:

      *  head-length = 1;

      *  tail-length = 2;

      *  mid-length = 1;

      *  <semantics> = 0.

      The address block is then 2 0 1 a 2 d e b c (9 octets).

   o  To include a.b.0.0, a.c.0.0, and a.d.0.0:

      *  head-length = 1;

      *  tail-length = 2;

      *  mid-length = 1;

      *  <semantics> has zerotail set (value 4);

      *  <tail> is omitted.

      The address block is then 3 4 1 a 2 b c d (8 octets).

   o  To include a.b.0.0 and c.d.0.0:

      *  head-length = 0;

      *  tail-length = 2;

      *  mid-length = 2;

      *  <semantics> has nohead and zerotail set (value 5);

      *  <head> and <tail> are omitted.

      The address block is then 2 5 2 a b c d (7 octets).

A.2.  TLV Examples

   If network addresses a.b.0.0/16, c.d.0.0/16, c.d.e.0/24 and
   c.d.e.f/32 are to be represented using a single address block
   containing a.b.0.0, c.d.0.0, c.d.e.0 and c.d.e.f, with the prefix
   lengths added using one or more address block TLVs of type



Clausen, et al.         Expires December 22, 2007              [Page 22]

Internet-Draft             MANET packet format                 June 2007


   PREFIX_LENGTH (0), then this can be done in a number of ways.
   Possible examples are:

   o  Using one multivalue TLV covering all of the addresses:

      *  <semantics> has noindex and multivalue set (value 20);

      *  <index-start> and <index-stop> are omitted;

      *  <length> = 4 (single-length = 1).

      *  The TLV is then 0 20 4 16 16 24 32 (7 octets).

   o  Using one multivalue TLV omitting the last address (a prefix
      length of 32 is the default):

      *  <semantics> has multivalue set (value 16);

      *  <index-start> = 0;

      *  <index-stop> = 2

      *  <length> = 3 (single-length = 1).

      *  The TLV is then 0 16 0 2 3 16 16 24 (8 octets).

   o  Using two single value TLVs, omitting the last address.  First:

      *  <semantics> = 0;

      *  <index-start> = 0;

      *  <index-stop> = 1;

      *  <length> = 1;

      *  <value> = 16.

      *  The TLV is then 0 0 0 1 1 16 (6 octets).

      Second:

      *  <semantics> has singlevalue set (value 8);

      *  <index-start> = 2;

      *  <index-stop> is omitted;




Clausen, et al.         Expires December 22, 2007              [Page 23]

Internet-Draft             MANET packet format                 June 2007


      *  <length> = 1;

      *  <value> = 24.

      *  The TLV is then 0 8 2 1 24 (5 octets).

      Total length of TLVs is 11 octets.

   In this case the first of these is the most efficient.  In other
   cases patterns such as the others may be preferred.  Regardless of
   efficiency, any of these may be used.

   Assuming the definition of an address block TLV with type EXAMPLE
   which has no value (it is sufficient to simply indicate which
   addresses are examples), for the same address block, with the second
   and third addresses being examples, this can be indicated with a
   single TLV:

   o  <semantics> has novalue set (value 2);

   o  <index-start> = 1;

   o  <index-stop> = 2;

   o  <length> and <value> are omitted.

   o  The TLV is then EXAMPLE 2 1 2 (4 octets).

   Assuming the definition of a message TLV with type DATA which can
   take a value field of any length, for such a message TLV with 8
   octets of data (a to h):

   o  <semantics> has noindex set (value 4);

   o  <index-start> and <index-stop> are omitted;

   o  <length> = 8.

   o  The TLV is then DATA 4 8 a b c d e f g h (11 octets).

   If, in this example, the number of data octets were 256 or greater
   then <semantics> would also have extended set and have value 5.  The
   length would require two octets (most significant first).  The TLV
   length would be 4 + N octets, where N is the number of data octets
   (it can be 3 + N octets if N is 255 or less).






Clausen, et al.         Expires December 22, 2007              [Page 24]

Internet-Draft             MANET packet format                 June 2007


Appendix B.  Illustrations

   This informative appendix illustrates the elements, which are
   normatively specified in Section 5 using regular expressions.

   Bits labeled Reserved, Resv, or Rsv are cleared ('0').  Bits labeled
   N and M may be cleared ('0') or set ('1').  Octets labeled Padding
   are cleared ('0'), and are optional.

Appendix B.1.  Packet

      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |0 0 0 0 0 0 0 0| Reserved  |0|0|    Packet Sequence Number     |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                                                               |
     |                       Message + Padding                       |
     |                                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                                                               |
     :                              ...                              :
     |                                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                                                               |
     |                       Message + Padding                       |
     |                                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |0 0 0 0 0 0 0 0| Reserved  |0|1|            Padding            |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                                                               |
     |                       Message + Padding                       |
     |                                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                                                               |
     :                              ...                              :
     |                                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                                                               |
     |                       Message + Padding                       |
     |                                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+




Clausen, et al.         Expires December 22, 2007              [Page 25]

Internet-Draft             MANET packet format                 June 2007


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |0 0 0 0 0 0 0 0| Reserved  |1|0|    Packet Sequence Number     |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                                                               |
     |                       Packet TLV Block                        |
     |                                                               |
     |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                               |            Padding            |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                                                               |
     |                       Message + Padding                       |
     |                                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                                                               |
     :                              ...                              :
     |                                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                                                               |
     |                       Message + Padding                       |
     |                                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |0 0 0 0 0 0 0 0| Reserved  |1|1|                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |
     |                                                               |
     |                       Packet TLV Block                        |
     |                                                               |
     |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                               |            Padding            |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                                                               |
     |                       Message + Padding                       |
     |                                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                                                               |
     :                              ...                              :
     |                                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                                                               |
     |                       Message + Padding                       |
     |                                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+



Clausen, et al.         Expires December 22, 2007              [Page 26]

Internet-Draft             MANET packet format                 June 2007


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                                                               |
     |                       Message + Padding                       |
     |                                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                                                               |
     :                              ...                              :
     |                                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                                                               |
     |                       Message + Padding                       |
     |                                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Appendix B.2.  Message and Padding

      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Message Type  | Rsv |N|0|0|0|0|         Message Size          |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                      Originator Address                       |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |   Hop Limit   |   Hop Count   |    Message Sequence Number    |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                                                               |
     |                         Message Body                          |
     |                                                               |
     |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                               |            Padding            |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Message Type  | Rsv |0|0|0|0|1|         Message Size          |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |   Hop Limit   |   Hop Count   |    Message Sequence Number    |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                                                               |
     |                         Message Body                          |
     |                                                               |
     |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                               |            Padding            |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+



Clausen, et al.         Expires December 22, 2007              [Page 27]

Internet-Draft             MANET packet format                 June 2007


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Message Type  | Rsv |N|0|0|1|0|         Message Size          |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                      Originator Address                       |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |   Hop Count   |    Message Sequence Number    |               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+               |
     |                                                               |
     |                         Message Body                          |
     |                                                               |
     |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                               |            Padding            |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Message Type  | Rsv |0|0|0|1|1|         Message Size          |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |   Hop Count   |    Message Sequence Number    |               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+               |
     |                                                               |
     |                         Message Body                          |
     |                                                               |
     |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                               |            Padding            |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Message Type  | Rsv |N|0|1|0|0|         Message Size          |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                      Originator Address                       |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |   Hop Limit   |    Message Sequence Number    |               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+               |
     |                                                               |
     |                         Message Body                          |
     |                                                               |
     |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                               |            Padding            |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+




Clausen, et al.         Expires December 22, 2007              [Page 28]

Internet-Draft             MANET packet format                 June 2007


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Message Type  | Rsv |N|0|1|0|1|         Message Size          |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |   Hop Limit   |    Message Sequence Number    |               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+               |
     |                                                               |
     |                         Message Body                          |
     |                                                               |
     |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                               |            Padding            |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Message Type  | Rsv |N|0|1|1|0|         Message Size          |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                      Originator Address                       |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |    Message Sequence Number    |                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |
     |                                                               |
     |                         Message Body                          |
     |                                                               |
     |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                               |            Padding            |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Message Type  | Rsv |N|0|1|1|1|         Message Size          |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |    Message Sequence Number    |                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |
     |                                                               |
     |                         Message Body                          |
     |                                                               |
     |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                               |            Padding            |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+






Clausen, et al.         Expires December 22, 2007              [Page 29]

Internet-Draft             MANET packet format                 June 2007


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Message Type  | Rsv |N|1|0|0|0|         Message Size          |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                      Originator Address                       |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |   Hop Limit   |   Hop Count   |                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |
     |                                                               |
     |                         Message Body                          |
     |                                                               |
     |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                               |            Padding            |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Message Type  | Rsv |N|1|0|0|1|         Message Size          |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |   Hop Limit   |   Hop Count   |                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |
     |                                                               |
     |                         Message Body                          |
     |                                                               |
     |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                               |            Padding            |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Message Type  | Rsv |N|1|0|1|0|         Message Size          |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                      Originator Address                       |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |   Hop Count   |                                               |
     +-+-+-+-+-+-+-+-+                                               |
     |                         Message Body                          |
     |                                                               |
     |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                               |            Padding            |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+





Clausen, et al.         Expires December 22, 2007              [Page 30]

Internet-Draft             MANET packet format                 June 2007


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Message Type  | Rsv |N|1|0|1|1|         Message Size          |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |   Hop Count   |                                               |
     +-+-+-+-+-+-+-+-+                                               |
     |                         Message Body                          |
     |                                                               |
     |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                               |            Padding            |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Message Type  | Rsv |N|1|1|0|0|         Message Size          |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                      Originator Address                       |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |   Hop Limit   |                                               |
     +-+-+-+-+-+-+-+-+                                               |
     |                         Message Body                          |
     |                                                               |
     |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                               |            Padding            |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Message Type  | Rsv |N|1|1|0|1|         Message Size          |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |   Hop Limit   |                                               |
     +-+-+-+-+-+-+-+-+                                               |
     |                         Message Body                          |
     |                                                               |
     |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                               |            Padding            |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+









Clausen, et al.         Expires December 22, 2007              [Page 31]

Internet-Draft             MANET packet format                 June 2007


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Message Type  | Rsv |N|1|1|1|0|         Message Size          |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                      Originator Address                       |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                                                               |
     |                         Message Body                          |
     |                                                               |
     |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                               |            Padding            |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Message Type  | Rsv |N|1|1|1|0|         Message Size          |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                                                               |
     |                         Message Body                          |
     |                                                               |
     |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                               |            Padding            |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

























Clausen, et al.         Expires December 22, 2007              [Page 32]

Internet-Draft             MANET packet format                 June 2007


Appendix B.3.  Message Body

      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                                                               |
     |                       Message TLV Block                       |
     |                                               +-+-+-+-+-+-+-+-+
     |                                               |               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+               |
     |                                                               |
     |                         Address Block                         |
     |                                                               |
     |               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |               |                                               |
     +-+-+-+-+-+-+-+-+                                               |
     |                       Address TLV Block                       |
     |                                                               |
     |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                               |                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |
     |                                                               |
     :                              ...                              :
     |                                                               |
     |                                               +-+-+-+-+-+-+-+-+
     |                                               |               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+               |
     |                                                               |
     |                         Address Block                         |
     |                                                               |
     |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                               |                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |
     |                                                               |
     |                       Address TLV Block                       |
     |                                                               |
     |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+












Clausen, et al.         Expires December 22, 2007              [Page 33]

Internet-Draft             MANET packet format                 June 2007


Appendix B.4.  Address Block

      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Number Addrs  |  Resv   |0|0|0|  Head Length  |     Head      |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |  Head (cont)  |  Tail Length  |             Tail              |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |              Mid              |                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |
     |                                                               |
     :                              ...                              :
     |                                                               |
     |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                               |              Mid              |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Number Addrs  |  Resv   |0|0|1|  Tail Length  |     Tail      |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |  Tail (cont)  |              Mid              |               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+               |
     |                                                               |
     :                              ...                              :
     |                                                               |
     |               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |               |              Mid              |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Number Addrs  |  Resv   |0|1|0|  Head Length  |     Head      |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |  Head (cont)  |              Mid              |               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+               |
     |                                                               |
     :                              ...                              :
     |                                                               |
     |               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |               |              Mid              |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+




Clausen, et al.         Expires December 22, 2007              [Page 34]

Internet-Draft             MANET packet format                 June 2007


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Number Addrs  |  Resv   |0|1|1|              Mid              |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |          Mid (cont)           |                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |
     |                                                               |
     :                              ...                              :
     |                                                               |
     |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                               |              Mid              |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |          Mid (cont)           |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Number Addrs  |  Resv   |1|0|0|  Head Length  |     Head      |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |  Head (cont)  |  Tail Length  |              Mid              |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                                                               |
     :                              ...                              :
     |                                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |              Mid              |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Number Addrs  |  Resv   |1|0|1|  Tail Length  |      Mid      |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |  Mid (cont)   |                                               |
     +-+-+-+-+-+-+-+-+                                               |
     |                                                               |
     :                              ...                              :
     |                                                               |
     |               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |               |              Mid              |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+






Clausen, et al.         Expires December 22, 2007              [Page 35]

Internet-Draft             MANET packet format                 June 2007


Appendix B.5.  TLV Block

      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |            Length             |                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |
     |                                                               |
     |                              TLV                              |
     |                                               +-+-+-+-+-+-+-+-+
     |                                               |               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+               |
     |                                                               |
     :                              ...                              :
     |                                                               |
     |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                               |                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |
     |                                                               |
     |                              TLV                              |
     |                                               +-+-+-+-+-+-+-+-+
     |                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Appendix B.6.  TLV

      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |     Type      |Resv |M|0|0|0|0|  Index Start  |  Index Stop   |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |    Length     |                                               |
     +-+-+-+-+-+-+-+-+                                               |
     |                             Value                             |
     |                                                               |
     |               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |               |
     +-+-+-+-+-+-+-+-+













Clausen, et al.         Expires December 22, 2007              [Page 36]

Internet-Draft             MANET packet format                 June 2007


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |     Type      |Resv |M|0|0|0|1|  Index Start  |  Index Stop   |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |            Length             |                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |
     |                                                               |
     |                             Value                             |
     |                                                               |
     |               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |               |
     +-+-+-+-+-+-+-+-+


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |     Type      |Resv |0|0|0|1|0|  Index Start  |  Index Stop   |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |     Type      |Resv |M|0|1|0|0|    Length     |               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+               |
     |                                                               |
     |                             Value                             |
     |                                                               |
     |               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |               |
     +-+-+-+-+-+-+-+-+


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |     Type      |Resv |M|0|1|0|1|            Length             |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                                                               |
     |                             Value                             |
     |                                                               |
     |               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |               |
     +-+-+-+-+-+-+-+-+





Clausen, et al.         Expires December 22, 2007              [Page 37]

Internet-Draft             MANET packet format                 June 2007


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |     Type      |Resv |0|0|1|1|0|
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |     Type      |Resv |0|1|0|0|0|  Index Start  |    Length     |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                                                               |
     |                             Value                             |
     |                                                               |
     |               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |               |
     +-+-+-+-+-+-+-+-+


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |     Type      |Resv |0|1|0|0|1|  Index Start  |    Length     |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Length (cont) |                                               |
     +-+-+-+-+-+-+-+-+                                               |
     |                                                               |
     |                             Value                             |
     |                                                               |
     |               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |               |
     +-+-+-+-+-+-+-+-+



      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |     Type      |Resv |0|1|0|1|0|  Index Start  |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+










Clausen, et al.         Expires December 22, 2007              [Page 38]

Internet-Draft             MANET packet format                 June 2007


Appendix C.  Complete Example

   An example packet, using IPv4 addresses (length four octets) is
   shown.  This packet has a header, indicated by the initial octet 0.
   The packet header has semantics octet 0, and hence has a packet
   sequence number, but no packet TLV block.

   The packet contains a single message.  This message has semantics
   octet 0, and hence has a complete message header, including
   originator address, hop limit, hop count and message sequence number
   (which is type independent).  The message has a message TLV block
   with content length 9 octets, containing a single TLV.  This TLV has
   the noindex bit of its semantics octet 4 set, and has value length 6
   octets.  The message then has two address blocks each with a
   following TLV block.

   The first address block contains 3 addresses.  It has the notail bit
   of its semantics octet 2 set, and has head length 2 octets, hence mid
   length two octets.  It is followed by a TLV block, with content
   length 9 octets, containing two TLVs.  The first of these TLVs has
   the noindex bit of its semantics octet 4 set, and has a single value
   of length 2 octets, which applies to all of the addresses in the
   address block.  The second of these TLVs has the novalue bit of its
   semantics octet 2 set, and hence has no length or value fields.  It
   does have index fields, which indicate those addresses this TLV
   applies to.

   The second address block contains 2 addresses.  It has the nohead and
   zerotail bits of its semantics octet 5 set, and has tail length 2
   octets, hence mid length two octets.  The two tail octets of each
   address are zero.  It is followed by a TLV block with content length
   5 octets.  This TLV block contains a single TLV of type PREFIX_LENGTH
   that has the multivalue and noindex bits of its semantics octet 20
   set, and a value field length of 2 octets, indicating two values each
   of one octet length.  There is one final padding octet 0 that is not
   included in the message length of 59 octets.















Clausen, et al.         Expires December 22, 2007              [Page 39]

Internet-Draft             MANET packet format                 June 2007


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |0 0 0 0 0 0 0 0|0 0 0 0 0 0 0 0|    Packet Sequence Number     |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Message Type  |0 0 0 0 0 0 0 0|0 0 0 0 0 0 0 0 0 0 1 1 1 0 1 1|
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                      Originator Address                       |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |   Hop Limit   |   Hop Count   |    Message Sequence Number    |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1|   TLV Type    |0 0 0 0 0 1 0 0|
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |0 0 0 0 0 1 1 0|                     Value                     |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                 Value (cont)                  |0 0 0 0 0 0 1 1|
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |0 0 0 0 0 0 1 0|0 0 0 0 0 0 1 0|             Head              |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |              Mid              |              Mid              |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |              Mid              |0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1|
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |   TLV Type    |0 0 0 0 0 1 0 0|0 0 0 0 0 0 1 0|     Value     |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Value (cont)  |   TLV Type    |0 0 0 0 0 0 1 0|  Index Start  |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |  Index Stop   |0 0 0 0 0 0 1 0|0 0 0 0 0 1 0 1|0 0 0 0 0 0 1 0|
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |              Mid              |              Mid              |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 1| PREFIX_LENGTH |0 0 0 1 0 1 0 0|
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |0 0 0 0 0 0 1 0|    Value0     |    Value1     |0 0 0 0 0 0 0 0|
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
















Clausen, et al.         Expires December 22, 2007              [Page 40]

Internet-Draft             MANET packet format                 June 2007


Appendix D.  Contributors

   This specification is the result of the joint efforts of the
   following contributors from the OLSRv2 Design Team -- listed
   alphabetically.

   o  Cedric Adjih, INRIA, France, <Cedric.Adjih@inria.fr>

   o  Emmanuel Baccelli, Hitachi Labs Europe, France,
      <Emmanuel.Baccelli@inria.fr>

   o  Thomas Heide Clausen, LIX, Ecole Polytechnique, France,
      <T.Clausen@computer.org>

   o  Justin W. Dean, NRL, USA<jdean@itd.nrl.navy.mil>

   o  Christopher Dearlove, BAE Systems, UK,
      <chris.dearlove@baesystems.com>

   o  Satoh Hiroki, Hitachi SDL, Japan, <h-satoh@sdl.hitachi.co.jp>

   o  Philippe Jacquet, INRIA, France, <Philippe.Jacquet@inria.fr>

   o  Monden Kazuya, Hitachi SDL, Japan, <monden@sdl.hitachi.co.jp>



























Clausen, et al.         Expires December 22, 2007              [Page 41]

Internet-Draft             MANET packet format                 June 2007


Appendix E.  Acknowledgements

   The authors would like to acknowledge the team behind OLSRv1, as
   specified in RFC 3626, including Anis Laouiti, Pascale Minet, Laurent
   Viennot (all at INRIA, France), and Amir Qayyum (Center for Advanced
   Research in Engineering, Pakistan) for their contributions.

   The authors would like to gratefully acknowledge the following people
   for intense technical discussions, early reviews and comments on the
   specification and its components: Joe Macker (NRL), Alan Cullen (BAE
   Systems), Ian Chakeres (Boeing), Charlie E. Perkins (Nokia), Andreas
   Schjonhaug (LIX), Florent Brunneau (LIX), Yasunori Owada (Niigata
   University) and the entire IETF MANET working group.






































Clausen, et al.         Expires December 22, 2007              [Page 42]

Internet-Draft             MANET packet format                 June 2007


Authors' Addresses

   Thomas Heide Clausen
   LIX, Ecole Polytechnique, France

   Phone: +33 6 6058 9349
   Email: T.Clausen@computer.org
   URI:   http://www.thomasclausen.org/


   Christopher M. Dearlove
   BAE Systems Advanced Technology Centre

   Phone: +44 1245 242194
   Email: chris.dearlove@baesystems.com
   URI:   http://www.baesystems.com/


   Justin W. Dean
   Naval Research Laboratory

   Phone: +1 202 767 3397
   Email: jdean@itd.nrl.navy.mil
   URI:   http://pf.itd.nrl.navy.mil/


   Cedric Adjih
   INRIA Rocquencourt

   Phone: +33 1 3963 5215
   Email: Cedric.Adjih@inria.fr
   URI:   http://menetou.inria.fr/~adjih/



















Clausen, et al.         Expires December 22, 2007              [Page 43]

Internet-Draft             MANET packet format                 June 2007


Full Copyright Statement

   Copyright (C) The IETF Trust (2007).

   This document is subject to the rights, licenses and restrictions
   contained in BCP 78, and except as set forth therein, the authors
   retain all their rights.

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST AND
   THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS
   OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF
   THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.


Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in BCP 78 and BCP 79.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   http://www.ietf.org/ipr.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.


Acknowledgment

   Funding for the RFC Editor function is provided by the IETF
   Administrative Support Activity (IASA).





Clausen, et al.         Expires December 22, 2007              [Page 44]

