





Internet Engineering Task Force                                   SIP WG
Internet Draft                                             H.Schulzrinne
draft-ietf-sip-dhcp-05.txt                           Columbia University
November 21, 2001
Expires: May 2002


                      DHCP Option for SIP Servers

STATUS OF THIS MEMO

   This document is an Internet-Draft and is in full conformance with
   all provisions of Section 10 of RFC2026.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups.  Note that
   other groups may also distribute working documents as Internet-
   Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress".

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt

   To view the list Internet-Draft Shadow Directories, see
   http://www.ietf.org/shadow.html.


Abstract

   This document defines a DHCP option that contains a single name or
   IPv4 address that can be mapped to one or more SIP outbound proxy
   servers.  This is one of the many methods that a SIP client can use
   to obtain the addresses of such a local SIP server.


1 Terminology

        DHCP client: A DHCP [1] client is an Internet host that uses
             DHCP to obtain configuration parameters such as a network
             address.

        DHCP server: A DHCP server is an Internet host that returns
             configuration parameters to DHCP clients.




H.Schulzrinne                                                 [Page 1]

Internet Draft                                         November 21, 2001


        SIP server: As defined in RFC 2543 [2]. This server MUST be an
             outbound proxy server, as defined in [3]. In the context of
             this document, a SIP server refers to the host the SIP
             server is running on.

        SIP client: As defined in RFC 2543. The client can be a user
             agent client or the client portion of a proxy server. In
             the context of this document, a SIP client refers to the
             host the SIP client is running on.

   In this document, the key words "MUST", "MUST NOT", "REQUIRED",
   "SHALL", "SHALLNOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY",
   and "OPTIONAL" are to be interpreted as described in RFC 2119 [4].

2 Introduction

   The Session Initiation Protocol (SIP) [2] is an application-layer
   control protocol that can establish, modify and terminate multimedia
   sessions or calls. A SIP system has a number of logical components:
   user agents, proxy servers, redirect servers and registrars. User
   agents MAY contain SIP clients, proxy servers always do.

   This draft specifies a DHCP option [1,5] that allows SIP clients to
   locate a local SIP server that is to be used for all outbound SIP
   requests, a so-called outbound proxy server. (SIP clients MAY contact
   the address identified in the SIP URL directly, without involving a
   local SIP server. However in some circumstances, when firewalls are
   present, SIP clients need to use a local server for outbound
   requests.) This is one of many possible solutions for locating the
   outbound SIP server; manual configuration is an example of another.

3 SIP Server DHCP Option

   The SIP server DHCP option carries either a 32-bit (binary) IPv4
   address or, preferably, a DNS (RFC 1035 [6]) fully-qualified domain
   name to be used by the SIP client to locate a SIP server.

   The option has two encodings, specified by the encoding byte ('enc')
   that follows the code byte. If the encoding byte has the value 0, it
   is followed by a list of domain names, as described below (Section
   3.1). If the encoding byte has the value 1, it is followed by one or
   more IPv4 addresses (Section 3.2). All implementations MUST support
   both encodings. The 'Len' field indicates the total number of octets
   in the option following the 'Len' field, including the encoding byte.

   The code for this option is TBD.

3.1 Domain Name List



H.Schulzrinne                                                 [Page 2]

Internet Draft                                         November 21, 2001


   If the 'enc' byte has a value of 0, the encoding byte is followed by
   a sequence of labels, encoded according to Section 3.1 of RFC 1035
   [6], quoted below:


        Domain names in messages are expressed in terms of a
        sequence of labels.  Each label is represented as a one
        octet length field followed by that number of octets. Since
        every domain name ends with the null label of the root, a
        domain name is terminated by a length byte of zero. The
        high order two bits of every length octet must be zero, and
        the remaining six bits of the length field limit the label
        to 63 octets or less. To simplify implementations, the
        total length of a domain name (i.e., label octets and label
        length octets) is restricted to 255 octets or less.


        RFC 1035 encoding was chosen to accomodate future
        internationalized domain name mechanisms.

   The minimum length for this encoding is 3.

   The option MAY contain multiple domain names, but these SHOULD refer
   to different SRV records, rather than different A records. Domain
   names SHOULD be listed in order of preference.

   A SIP client obtains a domain name through the DHCP SIP server
   option, which the client then uses to locate the outbound proxy
   server by the mechanism described in RFC XXXX [3]. In summary, the
   domain name is used first in a DNS SRV lookup and, if that fails
   because of a lack of matching DNS SRV records, the domain name is
   used in an address record lookup. Normative details are contained in
   RFC XXXX [3].


        Use of multiple domain names is not meant to replace SRV
        records, but rather to allow a single DHCP server to
        indicate outbound proxy servers operated by multiple
        providers.


        An encoding according to section 4.1.4 of "Domain Names -
        Implementation And Specification" [6] does not seem
        appropriate here, since the domain names are supposed to be
        different domains, so that compression will have little
        effect.

   If the length of the domain list exceeds the maximum permissible



H.Schulzrinne                                                 [Page 3]

Internet Draft                                         November 21, 2001


   within a single option (254 octets), then the domain list must be
   represented in the DHCP message as specified in "Encoding Long DHCP
   Options".

   The DHCP option for this encoding has the following format:


     Code  Len   enc   DNS name of SIP server
   +-----+-----+-----+-----+-----+-----+-----+-----+--
   | TBD |  n  |  0  |  s1 |  s2 |  s3 |  s4 | s5  |  ...
   +-----+-----+-----+-----+-----+-----+-----+-----+--



   As an example, consider the case where the server wants to offer two
   outbound proxy servers, "example.com" and "example.net". These would
   be encoded as follows:


     +---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+
     |TBD|27 | 0 | 7 |'e'|'x'|'a'|'m'|'p'|'l'|'e'| 3 |'c'|'o'|'m'| 0 |
     +---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+
     +---+---+---+---+---+---+---+---+---+---+---+---+---+
     | 7 |'e'|'x'|'a'|'m'|'p'|'l'|'e'| 3 |'n'|'e'|'t'| 0 |
     +---+---+---+---+---+---+---+---+---+---+---+---+---+



3.2 IPv4 Address List

   This option specifies a list of IPv4 addresses indicating SIP
   outbound proxy servers available to the client. Servers SHOULD be
   listed in order of preference.

   Its minimum length is 5, and the length MUST be a multiple of 4 plus
   one. The DHCP option for this encoding has the following format:


            Code   Len   enc      Address 1            Address 2
           +-----+-----+-----+-----+-----+-----+-----+-----+--
           | TBD |  n  |  1  |  a1 |  a2 |  a3 |  a4 | a1  |  ...
           +-----+-----+-----+-----+-----+-----+-----+-----+--



4 Security Consideration

   There are no security considerations beyond those described in RFC



H.Schulzrinne                                                 [Page 4]

Internet Draft                                         November 21, 2001


   2131 [1], RFC 2543 [2] and RFC XXXX [3].

5 IANA Considerations

   IANA has assigned a DHCP option number of TBD for the "SIP Servers
   DHCP Option" defined in this document.

6 Acknowledgements

   Ralph Droms, Robert Elz, Wenyu Jiang, Peter Koch, Gautam Nair, Thomas
   Narten, Erik Nordmark, Jonathan Rosenberg, Kundan Singh, Sven Ubik,
   Bernie Volz and Dean Willis provided useful feedback through the
   evolution of this draft.

7 Authors' Addresses

   Henning Schulzrinne
   Dept. of Computer Science
   Columbia University 1214 Amsterdam Avenue, MC 0401
   New York, NY 10027
   USA
   electronic mail:  schulzrinne@cs.columbia.edu

8 Bibliography

   [1] R. Droms, "Dynamic host configuration protocol," Request for
   Comments 2131, Internet Engineering Task Force, Mar. 1997.

   [2] M. Handley, H. Schulzrinne, E. Schooler, and J. Rosenberg, "SIP:
   session initiation protocol," Request for Comments 2543, Internet
   Engineering Task Force, Mar. 1999.

   [3] H. Schulzrinne and J. Rosenberg, "SIP: Session initiation
   protocol -- locating SIP servers," Internet Draft, Internet
   Engineering Task Force, Mar. 2001.  Work in progress.

   [4] S. Bradner, "Key words for use in RFCs to indicate requirement
   levels," Request for Comments 2119, Internet Engineering Task Force,
   Mar. 1997.

   [5] S. Alexander and R. Droms, "DHCP options and BOOTP vendor
   extensions," Request for Comments 2132, Internet Engineering Task
   Force, Mar. 1997.

   [6] P. V. Mockapetris, "Domain names - implementation and
   specification," Request for Comments 1035, Internet Engineering Task
   Force, Nov. 1987.




H.Schulzrinne                                                 [Page 5]

Internet Draft                                         November 21, 2001


   [7] T. Lemon and S. Cheshire, "Encoding long DHCP options," Internet
   Draft, Internet Engineering Task Force, Oct. 2001.  Work in progress.

















































H.Schulzrinne                                                 [Page 6]

