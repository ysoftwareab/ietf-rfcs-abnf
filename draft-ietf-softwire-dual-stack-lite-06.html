<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Dual-Stack Lite Broadband Deployments Following IPv4 Exhaustion</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Dual-Stack Lite Broadband Deployments Following IPv4 Exhaustion">
<meta name="keywords" content="NAT">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 60em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 60em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Internet Engineering Task Force</td><td class="header">A. Durand</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Juniper Networks</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">R. Droms</td></tr>
<tr><td class="header">Expires: February 12, 2011</td><td class="header">Cisco</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">J. Woodyatt</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Apple</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Y. Lee</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Comcast</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">August 11, 2010</td></tr>
</table></td></tr></table>
<h1><br />Dual-Stack Lite Broadband Deployments Following IPv4 Exhaustion<br />draft-ietf-softwire-dual-stack-lite-06</h1>

<h3>Abstract</h3>

<p>
This document revisits the dual-stack model and introduces the dual-
stack lite technology aimed at better aligning the costs and benefits
of deploying IPv6 in service provider networks.
Dual-stack lite enables a broadband service provider to share IPv4 addresses among customers by combining two well-known technologies: IP in IP (IPv4-in-IPv6) and Network Address Translation (NAT).
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted  in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF).  Note that other groups may also distribute
working documents as Internet-Drafts.  The list of current
Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
This Internet-Draft will expire on February 12, 2011.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the Simplified BSD License.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#anchor2">2.</a>&nbsp;
Requirements language<br />
<a href="#anchor3">3.</a>&nbsp;
Terminology<br />
<a href="#anchor4">4.</a>&nbsp;
Deployment scenarios<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">4.1.</a>&nbsp;
Access model<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">4.2.</a>&nbsp;
CPE<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">4.3.</a>&nbsp;
Directly connected device<br />
<a href="#anchor8">5.</a>&nbsp;
B4 element<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">5.1.</a>&nbsp;
Definition<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">5.2.</a>&nbsp;
Encapsulation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">5.3.</a>&nbsp;
Fragmentation and Reassembly<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">5.4.</a>&nbsp;
AFTR discovery<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">5.5.</a>&nbsp;
DNS<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">5.6.</a>&nbsp;
Interface initialization<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">5.7.</a>&nbsp;
Well-known IPv4 address<br />
<a href="#anchor16">6.</a>&nbsp;
AFTR element<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor17">6.1.</a>&nbsp;
Definition<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">6.2.</a>&nbsp;
Encapsulation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor19">6.3.</a>&nbsp;
Fragmentation and Reassembly<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor20">6.4.</a>&nbsp;
DNS<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor21">6.5.</a>&nbsp;
Well-known IPv4 address<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor22">6.6.</a>&nbsp;
Extended binding table<br />
<a href="#anchor23">7.</a>&nbsp;
Network Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor24">7.1.</a>&nbsp;
Tunneling<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor25">7.2.</a>&nbsp;
VPN<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor26">7.3.</a>&nbsp;
Multicast considerations<br />
<a href="#anchor27">8.</a>&nbsp;
NAT considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor28">8.1.</a>&nbsp;
NAT pool<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor29">8.2.</a>&nbsp;
NAT conformance<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor30">8.3.</a>&nbsp;
Application Level Gateways (ALG)<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor31">8.4.</a>&nbsp;
Port allocation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor32">8.4.1.</a>&nbsp;
How many ports per customers?<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor33">8.4.2.</a>&nbsp;
Dynamic port assignment considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor34">8.4.3.</a>&nbsp;
Subscriber controlled port assignment<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor35">8.5.</a>&nbsp;
Other considerations about sharing global IPv4 addresses<br />
<a href="#Acknowledgements">9.</a>&nbsp;
Acknowledgements<br />
<a href="#IANA">10.</a>&nbsp;
IANA Considerations<br />
<a href="#Security">11.</a>&nbsp;
Security Considerations<br />
<a href="#anchor36">12.</a>&nbsp;
Appendix A: Deployment considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor37">12.1.</a>&nbsp;
AFTR service distribution and horizontal scaling<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor38">12.2.</a>&nbsp;
Horizontal scaling<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor39">12.3.</a>&nbsp;
High availability<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor40">12.4.</a>&nbsp;
Logging<br />
<a href="#anchor41">13.</a>&nbsp;
Appendix B: Examples<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor42">13.1.</a>&nbsp;
Gateway based architecture<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor43">13.1.1.</a>&nbsp;
Example message flow<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor44">13.1.2.</a>&nbsp;
Translation details<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#host-based-arch">13.2.</a>&nbsp;
Host based architecture<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor45">13.2.1.</a>&nbsp;
Example message flow<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor46">13.2.2.</a>&nbsp;
Translation details<br />
<a href="#anchor47">14.</a>&nbsp;
Appendix C: Related DS-Lite work on port management<br />
<a href="#rfc.references1">15.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">15.1.</a>&nbsp;
Normative references<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">15.2.</a>&nbsp;
Informative references<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>
The common thinking for more than 10 years has been that the
transition to IPv6 will be based solely on the dual stack model and that
most things would be converted this way before we ran out of IPv4.
However, this has not happened. The IANA free pool of IPv4 addresses
will be depleted soon, well before sufficient IPv6 deployment will 
exist. As a result, many IPv4 services have to continue to be provided
even under severely limited address space.

</p>
<p>
This document specifies the dual-stack lite technology which is aimed at
better aligning the costs and benefits in service provider networks.
Dual-stack lite will enable both continued support for IPv4 services
and incentives for the deployment of IPv6. It also de-couples IPv6
deployment in the service provider network from the rest of the Internet,
making incremental deployment easier.

</p>
<p>
Dual-stack lite enables a broadband service provider to share IPv4 addresses among customers by combining two well-known technologies: IP in IP (IPv4-in-IPv6) and NAT.

</p>
<p>
This document makes a distinction between a dual-stack capable and a dual-stack provisioned device. The former is a device that has code that implements both IPv4 and IPv6, from the network layer to the applications. The latter is a similar device that has been provisioned with both an IPv4 and an IPv6 address on its interface(s). This document will also further refine this notion by distinguishing between interfaces provisioned directly by the service provider from those provisioned by the customer.

</p>
<p>
Pure IPv6-only devices (i.e. devices that do not include an IPv4 stack) are outside of the scope of this document.

</p>
<p>
This document will first present some deployment scenario and then define the behavior of the two elements of the dual-stack lite technology:the B4 and the AFTR. It will then go into networking and NATing considerations.

</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Requirements language</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
"SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
document are to be interpreted as described in <a class='info' href='#RFC2119'>RFC 2119<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a> [RFC2119].
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Terminology</h3>

<p>
The technology described in this document is known as dual-stack lite. The abbreviation DS-Lite will be used along this text.

</p>
<p>
This document also introduces two new terms: the DS-Lite Basic Bridging BroadBand element (B4) and the DS-Lite  Address Family Transition Router element (AFTR).

</p>
<p>Dual-stack is defined in  <a class='info' href='#RFC4213'>[RFC4213]<span> (</span><span class='info'>Nordmark, E. and R. Gilligan, &ldquo;Basic Transition Mechanisms for IPv6 Hosts and Routers,&rdquo; October&nbsp;2005.</span><span>)</span></a>.
</p>
<p>NAT related terminology is defined in <a class='info' href='#RFC4787'>[RFC4787]<span> (</span><span class='info'>Audet, F. and C. Jennings, &ldquo;Network Address Translation (NAT) Behavioral Requirements for Unicast UDP,&rdquo; January&nbsp;2007.</span><span>)</span></a>.
</p>
<p>CPE stands for Customer Premise Equipment. This is the layer 3 device in the customer premise that is connected to the service provider network. That device is often a home gateway. However, sometimes computers are directly attached to the service provider network. In such cases, such computers can be viewed as CPEs as well.
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Deployment scenarios</h3>

<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Access model</h3>

<p>
Instead of relying on a cascade of NATs, the dual-stack lite
model is built on IPv4-in-IPv6 tunnels to cross the network to reach
a carrier-grade IPv4-IPv4 NAT (the AFTR) where customers will share IPv4 addresses. There are numbers of benefits to this approach:

</p>
<p>
</p>
<ul class="text">
<li>
This technology decouples the deployment of IPv6 in the service provider network (up to the customer premise equipment or CPE) from the deployment of IPv6 in the global Internet and in customer applications & devices.

</li>
<li>
The management of the service provider access networks is simplified by leveraging the large IPv6 address space. Overlapping private IPv4 address spaces are not required to support very large customer bases.

</li>
<li>
As tunnels can terminate anywhere in the service provider network, this architecture leads itself to horizontal scaling and provides great flexibility to adapt to changing traffic load.

</li>
<li>
Tunnels provide a direct connection between B4 and the AFTR. This can be leveraged to enable customers and their applications to control how the NAT function of the AFTR is performed.

</li>
</ul><p>

</p>
<p>
A key characteristic of this approach is that communications between end-nodes stay within their address family. IPv6 sources only communicate with IPv6 destinations, IPv4 sources only communicate with IPv4 destinations. There is no protocol family translation involved in this approach. This simplifies greatly the task of applications that may carry literal IP addresses in their payload.

</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
CPE</h3>

<p>
This section describes home Local Area networks characterized by the presence of a home gateway, or CPE, provisioned only with IPv6 by the service provider.

</p>
<p>
A DS-Lite CPE is an IPv6 aware CPE with a B4 Interface implemented in the WAN interface. 

</p>
<p>
A DS-Lite CPE SHOULD NOT operate a NAT function between an internal interface and a B4 interface, as the NAT function will be performed by the AFTR in the service provider's network. That will avoid accidentally operating in a double NAT environment.

</p>
<p> 
However, it SHOULD operate its own DHCP(v4) server handing out <a class='info' href='#RFC1918'>[RFC1918]<span> (</span><span class='info'>Rekhter, Y., Moskowitz, R., Karrenberg, D., Groot, G., and E. Lear, &ldquo;Address Allocation for Private Internets,&rdquo; February&nbsp;1996.</span><span>)</span></a> address space (e.g. 192.168.0.0/16) to hosts in the home. It SHOULD advertise itself as the default IPv4 router to those home hosts. It SHOULD also
advertise itself as a DNS server in the DHCP Option 6 (DNS Server).  Additionally, it SHOULD operate a DNS proxy to
accept DNS IPv4 requests from home hosts and send them using IPv6 to the service provider DNS servers,
as described in Section 5.5.

</p>
<p>
Note: if an IPv4 home host decides to use another IPv4 DNS server, the DS-Lite CPE will forward those DNS requests via the B4 interface, the same way it forwards any regular IPv4 packets. However, each DNS request will create a binding in the AFTR. A large number of DNS requests may have direct impact to the AFTR's NAT table utilization.

</p>
<p>IPv6 capable devices directly reach the IPv6 Internet. Packets simply follow IPv6 routing, they do not go through the tunnel, and are not subject to any translation. It is expected that most IPv6 capable devices will also be IPv4 capable and will simply be configured with an IPv4 RFC1918 style address within the home network and access the IPv4 Internet the same way as the legacy IPv4-only devices within the home.
</p>
<p>
Pure IPv6-only devices (i.e. devices that do not include an IPv4 stack) are outside of the scope of this document.

</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
Directly connected device</h3>

<p>
In broadband home networks, sometime devices are directly connected to the broadband service provider. They are connected straight to a modem, without a home gateway. Those devices are, in fact, acting as CPEs.

</p>
<p>
Under this scenario, the customer device is a dual-stack capable host that is only provisioned by the service provider only with IPv6. The device itself acts as a B4 element and the IPv4 service is provided by an IPv4-in-IPv6 tunnel, just as in the home gateway/CPE case. That device can run any combinations of IPv4 and/or IPv6 applications.

</p>
<p>
A directly connected DS-Lite device SHOULD send its DNS requests over IPv6 to the IPv6 DNS server it has been configured to use.

</p>
<p>
Similarly to the previous sections, IPv6 packets follow IPv6 routing, they do not go through the tunnel, and are not subject to any translation.

</p>
<p>
The support of IPv4-only devices and IPv6-only devices in this scenario is out of scope for this document.

</p>
<p>

</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
B4 element</h3>

<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Definition</h3>

<p>
The B4 element is a function implemented on a dual-stack capable node, either a directly connected device or a CPE, that creates a tunnel to an AFTR.

</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Encapsulation</h3>

<p>
The tunnel is a multi-point to point IPv4-in-IPv6 tunnel ending on a service provider AFTR.

</p>
<p>
See section 7.1 for additional tunneling considerations.

</p>
<p>
Note: at this point, DS-Lite only defines IPv4-in-IPv6 tunnels, however other types of encapsulation could be defined in the future.

</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3"></a><h3>5.3.&nbsp;
Fragmentation and Reassembly</h3>

<p>
Using an encapsulation (IPv4-in-IPv6 or anything else) to carry IPv4 traffic over
IPv6 will reduce the effective MTU of the datagram.  Unfortunately,
path MTU discovery <a class='info' href='#RFC1191'>[RFC1191]<span> (</span><span class='info'>Mogul, J. and S. Deering, &ldquo;Path MTU discovery,&rdquo; November&nbsp;1990.</span><span>)</span></a> is not a reliable method to deal with
this problem.

</p>
<p>
A solution to deal with this problem is for the service provider to increase
the MTU size of all the links between the B4 element and the AFTR elements
by at least 40 bytes to accommodate both the IPv6
encapsulation header and the IPv4 datagram without fragmenting the
IPv6 packet.

</p>
<p>
However, as not all service providers will be able to increase their link MTU,
the B4 element MUST perform fragmentation and reassembly if the outgoing link MTU cannot
accommodate for the extra IPv6 header.  Fragmentation MUST happen
after the encapsulation on the IPv6 packet.  Reassembly MUST happen
before the decapsulation of the IPv6 header. 
Detailed procedure has been specified in
<a class='info' href='#RFC2473'>[RFC2473]<span> (</span><span class='info'>Conta, A. and S. Deering, &ldquo;Generic Packet Tunneling in IPv6 Specification,&rdquo; December&nbsp;1998.</span><span>)</span></a> Section 7.2.

</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.4"></a><h3>5.4.&nbsp;
AFTR discovery</h3>

<p>
In order to configure the IPv4-in-IPv6 tunnel, the B4 element needs the
IPv6 address of the AFTR element. This IPv6 address can be
configured using a variety of methods, ranging from an out-of-band mechanism,
manual configuration or a variety of DHCPv6 options.

</p>
<p>
In order to guarantee interoperability, a B4 element SHOULD implement
 the DHCPv6 option defined in <a class='info' href='#I-D.ietf-softwire-ds-lite-tunnel-option'>[I&#8209;D.ietf&#8209;softwire&#8209;ds&#8209;lite&#8209;tunnel&#8209;option]<span> (</span><span class='info'>Hankins, D. and T. Mrugalski, &ldquo;Dynamic Host Configuration Protocol for IPv6 (DHCPv6) Options for Dual- Stack Lite,&rdquo; June&nbsp;2010.</span><span>)</span></a>.

</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.5"></a><h3>5.5.&nbsp;
DNS</h3>

<p>
A B4 element is only configured from the service provider with IPv6. As such, it can
only learn the address of a DNS recursive server through DHCPv6 (or other similar method
over IPv6). As DHCPv6 only defines an option to get the IPv6 address of such a DNS recursive
server, the B4 element cannot easily discover the IPv4 address of such a recursive DNS server,
and as such will have to perform all DNS resolution over IPv6.

</p>
<p>
The B4 element can pass this IPv6 address to downstream IPv6 nodes, but not to downstream IPv4 nodes.
As such, the B4 element SHOULD implement a DNS proxy, following the recommendations of <a class='info' href='#RFC5625'>[RFC5625]<span> (</span><span class='info'>Bellis, R., &ldquo;DNS Proxy Implementation Guidelines,&rdquo; August&nbsp;2009.</span><span>)</span></a>.

</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.6"></a><h3>5.6.&nbsp;
Interface initialization</h3>

<p>
Initialization of the interface including a B4 element is out-of-scope in this specification.

</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.7"></a><h3>5.7.&nbsp;
Well-known IPv4 address</h3>

<p>
Any locally unique IPv4 address could be configured on the IPv4-in-IPv6
tunnel to represent the B4 element. Configuring such an address is
often necessary when the B4 element is sourcing IPv4 datagrams directly
over the tunnel. In order to avoid conflicts with any other address,
IANA has defined a well-known range, 192.0.0.0/29.

</p>
<p>
192.0.0.0 is the reserved subnet address. 192.0.0.1 is reserved for the AFTR
element. The B4 element MAY use any other addresses within the 192.0.0.0/29 range.

</p>
<p>
Note: a range of addresses has been reserved for this purpose. The intent is to accommodate nodes
implementing multiple B4 elements.

</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
AFTR element</h3>

<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
Definition</h3>

<p>
An AFTR element is the combination of an IPv4-in-IPv6 tunnel end-point
and an IPv4-IPv4 NAT implemented on the same node.

</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
Encapsulation</h3>

<p>
The tunnel is a point-to-multipoint IPv4-in-IPv6 tunnel ending at the B4 elements.

</p>
<p>
See section 7.1 for additional tunneling considerations.

</p>
<p>
Note: at this point, DS-Lite only defines IPv4-in-IPv6 tunnels, however other types of encapsulation could be defined in the future.

</p>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.3"></a><h3>6.3.&nbsp;
Fragmentation and Reassembly</h3>

<p>
As noted previously, fragmentation and reassembly need to be taken care of by the tunnel end-points.
As such, the AFTR MUST perform fragmentation and reassembly if
the underlying link MTU cannot accommodate the extra IPv6 header of the tunnel.
Fragmentation MUST happen after the encapsulation on the IPv6 packet.
Reassembly MUST happen before the decapsulation of the IPv6 header.
Detailed procedure has been specified in <a class='info' href='#RFC2473'>[RFC2473]<span> (</span><span class='info'>Conta, A. and S. Deering, &ldquo;Generic Packet Tunneling in IPv6 Specification,&rdquo; December&nbsp;1998.</span><span>)</span></a> Section 7.2.

</p>
<p>
Fragmentation at the Tunnel Entry-Point is a light-weight operation.  In contrast,
reassembly at the Tunnel Exit-Point can be expensive.  When the
Tunnel Exit-Point receives the first fragmented packet, it must wait
for the second fragmented packet to arrive in order to reassemble the
two fragmented IPv6 packets for decapsulation.  This requires the
Tunnel Exit-Point to buffer and keep track of fragmented packets.
Consider that the AFTR is the Tunnel Exit-Point for many
tunnels.  If many clients simultaneously source large number of
fragmented packets to the AFTR, this will require the
AFTR to buffer and consume enormous resources to keep
track of the flows.  This reassembly process will significantly
impact the AFTR performance.  However, this impact only
happens when many clients simultaneously source large IPv4 packets.
Since we believe that majority of the clients will receive large IPv4
packets (such as watching video streams) instead of sourcing large
IPv4 packets (such as sourcing video streams), so reassembly is only
a fraction of the overall AFTR's workload.

</p>
<p>
Methods to avoid fragmentation, such as rewriting the TCP MSS
option or using technologies such as Subnetwork Encapsulation and
Adaptation Layer defined in <a class='info' href='#I-D.templin-seal'>[I&#8209;D.templin&#8209;seal]<span> (</span><span class='info'>Templin, F., &ldquo;The Subnetwork Encapsulation and Adaptation Layer (SEAL),&rdquo; August&nbsp;2008.</span><span>)</span></a> are out of scope for
this document.

</p>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.4"></a><h3>6.4.&nbsp;
DNS</h3>

<p>
As noted previously, DS-Lite node implementing a B4 elements will perform DNS resolution
over IPv6. As such, very few, if any, DNS packets will flow through the AFTR element.

</p>
<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.5"></a><h3>6.5.&nbsp;
Well-known IPv4 address</h3>

<p>
The AFTR MAY use the well-known IPv4 address 192.0.0.1 reserved by IANA to configure the IPv4-in-IPv6 tunnel.
That address can then be used to report ICMP problems and will appear in traceroute outputs.

</p>
<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.6"></a><h3>6.6.&nbsp;
Extended binding table</h3>

<p>
The NAT binding table of the AFTR element is extended to include the source IPv6 address
of the incoming packets. This IPv6 address is used to disambiguate between the overlapping
IPv4 address space of the service provider customers.

</p>
<p>
By doing a reverse look-up in the extended IPv4 NAT binding table, the
 AFTR knows how to reconstruct the IPv6 encapsulation when the packets comes back from the Internet.  That
way, there is no need to keep a static configuration for each tunnel.

</p>
<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Network Considerations</h3>

<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.1"></a><h3>7.1.&nbsp;
Tunneling</h3>

<p>
Tunneling MUST be done in accordance to <a class='info' href='#RFC2473'>[RFC2473]<span> (</span><span class='info'>Conta, A. and S. Deering, &ldquo;Generic Packet Tunneling in IPv6 Specification,&rdquo; December&nbsp;1998.</span><span>)</span></a> and <a class='info' href='#RFC4213'>[RFC4213]<span> (</span><span class='info'>Nordmark, E. and R. Gilligan, &ldquo;Basic Transition Mechanisms for IPv6 Hosts and Routers,&rdquo; October&nbsp;2005.</span><span>)</span></a>.
Traffic classes (<a class='info' href='#RFC2474'>[RFC2474]<span> (</span><span class='info'>Nichols, K., Blake, S., Baker, F., and D. Black, &ldquo;Definition of the Differentiated Services Field (DS Field) in the IPv4 and IPv6 Headers,&rdquo; December&nbsp;1998.</span><span>)</span></a>) from the IPv4 headers SHOULD be carried over to the IPv6 headers and vice versa.

</p>
<a name="anchor25"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.2"></a><h3>7.2.&nbsp;
VPN</h3>

<p>
Dual-stack lite implementations SHOULD NOT interfere with the functioning of IPv4 or IPv6 VPNs.

</p>
<a name="anchor26"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.3"></a><h3>7.3.&nbsp;
Multicast considerations</h3>

<p>
Multicast is out-of-scope in this document.

</p>
<a name="anchor27"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
NAT considerations</h3>

<a name="anchor28"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.1"></a><h3>8.1.&nbsp;
NAT pool</h3>

<p>
AFTRs MAY operate distinct, non overlapping NAT pools. Those NAT pools do not have to be continuous.

</p>
<a name="anchor29"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.2"></a><h3>8.2.&nbsp;
NAT conformance</h3>

<p>
A dual-stack lite AFTR SHOULD implement behavior conforming to the best current practice, currently documented in <a class='info' href='#RFC4787'>[RFC4787]<span> (</span><span class='info'>Audet, F. and C. Jennings, &ldquo;Network Address Translation (NAT) Behavioral Requirements for Unicast UDP,&rdquo; January&nbsp;2007.</span><span>)</span></a>, <a class='info' href='#RFC5382'>[RFC5382]<span> (</span><span class='info'>Guha, S., Biswas, K., Ford, B., Sivakumar, S., and P. Srisuresh, &ldquo;NAT Behavioral Requirements for TCP,&rdquo; October&nbsp;2008.</span><span>)</span></a> and <a class='info' href='#RFC5508'>[RFC5508]<span> (</span><span class='info'>Srisuresh, P., Ford, B., Sivakumar, S., and S. Guha, &ldquo;NAT Behavioral Requirements for ICMP,&rdquo; April&nbsp;2009.</span><span>)</span></a>. Other requirements for AFTRs can be found in <a class='info' href='#I-D.nishitani-cgn'>[I&#8209;D.nishitani&#8209;cgn]<span> (</span><span class='info'>Yamagata, I., Miyakawa, S., Nakagawa, A., and H. Ashida, &ldquo;Common requirements for IP address sharing schemes,&rdquo; July&nbsp;2010.</span><span>)</span></a>.

</p>
<a name="anchor30"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.3"></a><h3>8.3.&nbsp;
Application Level Gateways (ALG)</h3>

<p>
The AFTR should only perform a minimum number of ALG for the classic applications such as FTP, RTSP/RTP, IPsec and PPTP VPN pass-through and enable the users to use their own ALG on statically or dynamically reserved ports instead.

</p>
<a name="anchor31"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.4"></a><h3>8.4.&nbsp;
Port allocation</h3>

<a name="anchor32"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.4.1"></a><h3>8.4.1.&nbsp;
How many ports per customers?</h3>

<p>Because IPv4 addresses will be shared among customers and potentially a large address space reduction factor may be applied, in average, only a limited number N of TCP or UDP port numbers will be available per customer. This means that applications opening a very large number of TCP ports may have a harder time to work. For example, it has been reported that a very well know web site was using AJAX techniques and was opening up to 69 TCP ports per web page. If we make the hypothesis of an address space reduction of a factor 100 (one IPv4 address per 100 customers), and 65k ports per IPv4 addresses available, that makes an average of N = 650 ports available simultaneously to be shared among the various devices behind the dual-stack lite tunnel end-point.

</p>
<p>
There is an important operational difference if those N ports are pre-allocated in a cookie-cutter fashion versus allocated on demand by incoming connections. This is a difference between an average of N ports and a maximum of N ports. Several service providers have reported an average number of connections per customer in the single digits. At the opposite end, thousands or tens of thousands of ports could be use in a peak by any single customer browsing a number of AJAX/Web 2.0 sites.
</p>
<p>As such, service providers allocating a fixed number of ports per user should dimension the system with a minimum of N = several thousands of ports for every user. This would bring the address space reduction ratio to a single digit. Service providers using a smaller number of ports per user (N in the hundreds) should expect customers applications to break in a more or less random way over time.
</p>
<p>In order to achieve higher address space reduction ratios, it is recommended that service provider do not use this cookie-cutter approach, and, on the contrary, allocate ports as dynamically as possible, just like on a regular NAT.
With an average number of connections per customers in the single digit, having an address space reduction of a factor 100 is realistic. However, service providers should exercise caution and make sure their pool of port numbers does not go too low. The actual maximum address space reduction factor is unknown at this time.

</p>
<a name="anchor33"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.4.2"></a><h3>8.4.2.&nbsp;
Dynamic port assignment considerations</h3>

<p>
When dynamic port assignment is used to maximize the number of subscribers sharing 
the AFTR global IPv4 addresses, the AFTR should implement checks to avoid
DOS attack through exhaustion of available ports. It should also avoid mapping
any one subscriber's "flows" across more than one global IPv4 address.

</p>
<a name="anchor34"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.4.3"></a><h3>8.4.3.&nbsp;
Subscriber controlled port assignment</h3>

<p>
Dynamic port assignment precludes inbound access to subscriber 
servers, just as in a CPE NAT.  Inbound access to subscriber 
servers can be provided through pre-assigned and/or reserved port 
mappings in the AFTR.  Specifying the mechanisms for 
managing and signaling these reserved port mappings is out of scope for this 
document.

</p>
<a name="anchor35"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.5"></a><h3>8.5.&nbsp;
Other considerations about sharing global IPv4 addresses</h3>

<p>
More considerations on sharing the port space of IPv4 addresses can be found in <a class='info' href='#I-D.ford-shared-addressing-issues'>[I&#8209;D.ford&#8209;shared&#8209;addressing&#8209;issues]<span> (</span><span class='info'>Ford, M., Boucadair, M., Durand, A., Levis, P., and P. Roberts, &ldquo;Issues with IP Address Sharing,&rdquo; March&nbsp;2010.</span><span>)</span></a>.

</p>
<a name="Acknowledgements"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Acknowledgements</h3>

<p>The authors would like to acknowledge the role of Mark
Townsley for his input on the overall architecture of this
technology by pointing this work in the direction of <a class='info' href='#I-D.droms-softwires-snat'>[I&#8209;D.droms&#8209;softwires&#8209;snat]<span> (</span><span class='info'>Droms, R. and B. Haberman, &ldquo;Softwires Network Address Translation (SNAT),&rdquo; July&nbsp;2008.</span><span>)</span></a>.  Note that this
document results from a merging of <a class='info' href='#I-D.durand-dual-stack-lite'>[I&#8209;D.durand&#8209;dual&#8209;stack&#8209;lite]<span> (</span><span class='info'>Durand, A., &ldquo;Dual-stack lite broadband deployments post IPv4 exhaustion,&rdquo; July&nbsp;2008.</span><span>)</span></a> and <a class='info' href='#I-D.droms-softwires-snat'>[I&#8209;D.droms&#8209;softwires&#8209;snat]<span> (</span><span class='info'>Droms, R. and B. Haberman, &ldquo;Softwires Network Address Translation (SNAT),&rdquo; July&nbsp;2008.</span><span>)</span></a>.Also to be
acknowledged are the many discussions with a number of people
including Shin Miyakawa, Katsuyasu Toyama, Akihide Hiura,
Takashi Uematsu, Tetsutaro Hara, Yasunori Matsubayashi, Ichiro
Mizukoshi. The author would also like to thank David Ward, Jari
Arkko, Thomas Narten and Geoff Huston for their constructive
feedback. Special thanks go to Dave Thaler and Dan Wing for their reviews and comments.

</p>
<a name="IANA"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
IANA Considerations</h3>

<p>This draft request IANA to allocate a well know IPv4 192.0.0.0/29 network prefix. That range is used to number the dual-stack lite interfaces. Reserving a /29 allows for 6 possible interfaces on a multi-home node. The IPv4 address 192.0.0.1 is reserved as the IPv4 address of the default router for such dual-stack lite hosts.
</p>
<a name="Security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
Security Considerations</h3>

<p>Security issues associated with NAT have long been documented. See <a class='info' href='#RFC2663'>[RFC2663]<span> (</span><span class='info'>Srisuresh, P. and M. Holdrege, &ldquo;IP Network Address Translator (NAT) Terminology and Considerations,&rdquo; August&nbsp;1999.</span><span>)</span></a> 
and <a class='info' href='#RFC2993'>[RFC2993]<span> (</span><span class='info'>Hain, T., &ldquo;Architectural Implications of NAT,&rdquo; November&nbsp;2000.</span><span>)</span></a>.
</p>
<p>However, moving the NAT functionality from the CPE to the core of the service provider 
network and sharing IPv4 addresses among customers create additional requirements when logging data 
for abuse usage. With any architecture where an IPv4 address does not uniquely represent an end 
host, IPv4 addresses and a timestamps are no longer sufficient to identify a particular broadband 
customer. Additional information such as transport protocol information will be required for that 
purpose. For example, we suggest to log the transport port number for TCP and UDP connections.

</p>
<p>
The AFTR performs translation functions for interior IPv4 
hosts at RFC 1918 addresses or at the IANA reserved address range 
(TBA by IANA). If the interior host is properly using the  
authorized IPv4 address with the authorized transport protocol 
port range such as A+P semantic for the tunnel, the AFTR 
can simply forward without translation to permit the authorized address
and port range to function properly. All packets with unauthorized 
interior IPv4 addresses or with authorized interior IPv4 address
but unauthorized port range MUST NOT be forwarded by the AFTR.
This prevents rogue devices from launching denial of service attacks
using unauthorized public IPv4 addresses in the IPv4 source header field
or unauthorized transport port range in the IPv4 transport header 
field. For example, rogue devices could bombard a public web server by 
launching TCP SYN ACK attack. The victim will receive TCP SYN from random 
IPv4 source addresses at a rapid rate and deny TCP services to legitimate 
users.

</p>
<p>
With IPv4 addresses shared by multiple users, ports become a critical resource. As such, some mechanisms need to be put in place by an AFTR to limit port usage, either by rate-limiting new connections or putting a hard limit on the maximum number of port usable by single user. If this number is high enough, it should not interfere with normal usage and still provide reasonable protection of the shared pool. More considerations on ports allocation and port exhaustion can be found in section 8.4.

</p>
<p>
More considerations on sharing IPv4 addresses can be found in "I-D.ford-shared-addressing-issues".

</p>
<p>
AFTRs should support ways to limit service to registered customers.
If strict IPv6 ingress filtering is deployed in the broadband network to prevent IPv6 address spoofing and dual-stack lite service is restricted to those customers, then tunnels terminating at the AFTR and coming from registered customer IPv6 addresses cannot be spoofed. Thus a simple access control list on the tunnel transport source address is all that is required to accept traffic on the southbound interface of an AFTR.

</p>
<p>If IPv6 address spoofing prevention is not in place, the AFTR should perform further sanity checks on the IPv6 address of incoming IPv6 packets. For example, it should check if the address has really been allocated to an authorized customer. 
</p>
<a name="anchor36"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12"></a><h3>12.&nbsp;
Appendix A: Deployment considerations</h3>

<a name="anchor37"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12.1"></a><h3>12.1.&nbsp;
AFTR service distribution and horizontal scaling</h3>

<p>
One of the key benefits of the dual-stack lite technology lies in the fact it is tunnel based. That is, tunnel end-points may be anywhere in the service provider network.

</p>
<p>
Using the DHCPv6 tunnel end-point option, service providers can create groups of users sharing the same AFTR. Those groups can be merged or divided at will. This leads to an horizontally scaled solution, where more capacity is added simply by adding more boxes.
As those groups of users can evolve over time, it is best to make sure that AFTRs do not require
per-user configuration in order to provide service.

</p>
<a name="anchor38"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12.2"></a><h3>12.2.&nbsp;
Horizontal scaling</h3>

<p>

</p>
<p>
A service provider can start using just a few AFTR centrally located. Later, when more capacity is needed, more boxes can be added and pushed to the edges of the access network.
In case of a spike of traffic, for example during the Olympic games or an important political event, capacity can be quickly added in any location of the network (tunnels can terminate anywhere) simply by splitting user groups. Extra capacity can be later removed when the traffic returns to normal by resetting the DHCPv6 tunnel end-point settings.

</p>
<a name="anchor39"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12.3"></a><h3>12.3.&nbsp;
High availability</h3>

<p>
An important element in the design of the dual-stack lite technology is the simplicity of implementation on the customer side. A simple IP4-in-IPv6 tunnel and a default route over it is all is needed to get IPv4 connectivity. Dealing with high availability is the responsibility of the service provider, not the customer devices implementing dual-stack lite. As such, a single IPv6 address of the tunnel end-point is provided in the DHCPv6 option defined in <a class='info' href='#I-D.ietf-softwire-ds-lite-tunnel-option'>[I&#8209;D.ietf&#8209;softwire&#8209;ds&#8209;lite&#8209;tunnel&#8209;option]<span> (</span><span class='info'>Hankins, D. and T. Mrugalski, &ldquo;Dynamic Host Configuration Protocol for IPv6 (DHCPv6) Options for Dual- Stack Lite,&rdquo; June&nbsp;2010.</span><span>)</span></a>. The service provider can use techniques such as anycast or various types of clusters to ensure availability of the IPv4 service. The exact synchronization (or lack thereof) between redundant AFTRs is out of scope for this document.

</p>
<a name="anchor40"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12.4"></a><h3>12.4.&nbsp;
Logging</h3>

<p>
DS-Lite AFTR implementation should offer the possility to log NAT binding creations or other ways to keep track of the ports/IP addresses used by customers. This is both to support troubleshooting, which is very important to service providers trying to figure out why something may not be working, as well as to meet region-specific requirements for responding to legally-binding requests for information from law enforcement authorities.

</p>
<a name="anchor41"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.13"></a><h3>13.&nbsp;
Appendix B: Examples</h3>

<a name="anchor42"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.13.1"></a><h3>13.1.&nbsp;
Gateway based architecture</h3>

<p>This architecture is targeted at residential broadband deployments but can be adapted easily to other types of deployment where the installed base of IPv4-only devices is important.
</p>
<p>
Consider a scenario where a Dual-Stack lite CPE is provisioned only with IPv6 in the WAN port, no IPv4. The CPE acts as an IPv4 DCHP server for the LAN network (wireline and wireless) handing out RFC1918 addresses. In addition, the CPE may support IPv6 Auto-Configuration and/or DHCPv6 server for the LAN network. When an IPv4-only device connects to the CPE, that CPE will hand it out a RFC1918 address. When a dual-stack capable device connects to the CPE, that CPE will hand out a RFC1918 address and a global IPv6 address to the device. Besides, the CPE will create an IPv4-in-IPv6 softwire tunnel <a class='info' href='#RFC5571'>[RFC5571]<span> (</span><span class='info'>Storer, B., Pignataro, C., Dos Santos, M., Stevant, B., Toutain, L., and J. Tremblay, &ldquo;Softwire Hub and Spoke Deployment Framework with Layer Two Tunneling Protocol Version 2 (L2TPv2),&rdquo; June&nbsp;2009.</span><span>)</span></a>to an
AFTR that resides in the service provider network.

</p>
<p>
When the device accesses IPv6 service, it will send the IPv6 datagram to the CPE natively. The CPE will route the traffic upstream to the default gateway.
</p>
<p>
When the device accesses IPv4 service, it will source the IPv4 datagram with the RFC1918 address and send the IPv4 datagram to the CPE. The CPE will encapsulate the IPv4 datagram inside the IPv4-in-IPv6 softwire tunnel and forward the IPv6 datagram to the AFTR. This contrasts what the CPE normally does today, which is, NAT the RFC1918 address to the public IPv4 address and route the datagram upstream. When the AFTR receives the IPv6 datagram, it will decapsulate the IPv6 header and perform an IPv4-to-IPv4 NAT on the source address.  

</p>
<p>As illustrated in <a class='info' href='#gnat-arch'>Figure&nbsp;1<span> (</span><span class='info'>gateway-based architecture</span><span>)</span></a>, this dual-stack
     lite deployment model consists of three components: the
     dual-stack lite home router with a B4 element, the 
     AFTR and a softwire between the B4 element acting as softwire initiator (SI) <a class='info' href='#RFC5571'>[RFC5571]<span> (</span><span class='info'>Storer, B., Pignataro, C., Dos Santos, M., Stevant, B., Toutain, L., and J. Tremblay, &ldquo;Softwire Hub and Spoke Deployment Framework with Layer Two Tunneling Protocol Version 2 (L2TPv2),&rdquo; June&nbsp;2009.</span><span>)</span></a> in the
     dual-stack lite home router and the softwire concentrator (SC) <a class='info' href='#RFC5571'>[RFC5571]<span> (</span><span class='info'>Storer, B., Pignataro, C., Dos Santos, M., Stevant, B., Toutain, L., and J. Tremblay, &ldquo;Softwire Hub and Spoke Deployment Framework with Layer Two Tunneling Protocol Version 2 (L2TPv2),&rdquo; June&nbsp;2009.</span><span>)</span></a> in
     the AFTR.  The AFTR performs IPv4-IPv4 NAT translations to
     multiplex multiple subscribers through a pool of global IPv4
     address.  Overlapping address spaces used by subscribers are
     disambiguated through the identification of tunnel endpoints.
</p><br /><hr class="insert" />
<a name="gnat-arch"></a>

<p style='text-align: center'>
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

                +-----------+
                |    Host   |
                +-----+-----+
                      |10.0.0.1
                      |
                      |
                      |10.0.0.2
            +---------|---------+
            |         |         |
            |    Home router    |
            |+--------+--------+|
            ||       B4        ||
            |+--------+--------+|
            +--------|||--------+
                     |||2001:db8:0:1::1
                     |||
                     |||&lt;-IPv4-in-IPv6 softwire
                     |||
              -------|||-------
            /        |||        \
           |   ISP core network  |
            \        |||        /
              -------|||-------
                     |||
                     |||2001:db8:0:2::1
            +--------|||--------+
            |        AFTR       |
            |+--------+--------+|
            ||   Concentrator  ||
            |+--------+--------+|
            |       |NAT|       |
            |       +-+-+       |
            +---------|---------+
                      |192.0.2.1
                      |
              --------|--------
            /         |         \
           |       Internet      |
            \         |         /
              --------|--------
                      |
                      |198.51.100.1
                +-----+-----+
                | IPv4 Host |
                +-----------+
</pre></div>
<p style='text-align: center'>
</p><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: gateway-based architecture&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>Notes:
  </p>
<ul class="text">
<li>The dual-stack lite home router is not required to be on the
    same link as the host
</li>
<li>The dual-stack lite home router could be replaced by a
    dual-stack lite router in the service provider network
</li>
</ul><p>
  
</p>
<p>The resulting solution accepts an IPv4 datagram that is
     translated into an IPv4-in-IPv6 softwire datagram for
     transmission across the softwire.  At the corresponding
     endpoint, the IPv4 datagram is decapsulated, and the translated
     IPv4 address is inserted based on a translation from the
     softwire.
</p>
<a name="anchor43"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.13.1.1"></a><h3>13.1.1.&nbsp;
Example message flow</h3>

<p>In the example shown in <a class='info' href='#outbound-dg'>Figure&nbsp;2<span> (</span><span class='info'>Outbound Datagram</span><span>)</span></a>, the
     translation tables in the AFTR is
     configured to forward between IP/TCP (10.0.0.1/10000) and IP/TCP
     (192.0.2.1/5000).  That is, a datagram received by the dual-stack
     lite home router from the host at address 10.0.0.1, using TCP DST
     port 10000 will be translated a datagram with IP SRC address
     192.0.2.1 and TCP SRC port 5000 in the Internet.
</p><br /><hr class="insert" />
<a name="outbound-dg"></a>

<p style='text-align: center'>
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
                +-----------+
                |    Host   |
                +-----+-----+
                   |  |10.0.0.1
   IPv4 datagram 1 |  |
                   |  |
                   v  |10.0.0.2
            +---------|---------+
            |         |         |
            |    home router    |
            |+--------+--------+|
            ||        B4       ||
            |+--------+--------+|
            +--------|||--------+
                   | |||2001:db8:0:1::1
    IPv6 datagram 2| |||
                   | |||&lt;-IPv4-in-IPv6 softwire
                   | |||
              -----|-|||-------
            /      | |||        \
           |   ISP core network  |
            \      | |||        /
              -----|-|||-------
                   | |||
                   | |||2001:db8:0:2::1
            +------|-|||--------+
            |      | AFTR       |
            |      v |||        |
            |+--------+--------+|
            ||  Concentrartor  ||
            |+--------+--------+|
            |       |NAT|       |
            |       +-+-+       |
            +---------|---------+
                   |  |192.0.2.1
   IPv4 datagram 3 |  |
                   |  |
              -----|--|--------
            /      |  |         \
           |       Internet      |
            \      |  |         /
              -----|--|--------
                   |  |
                   v  |198.51.100.1
                +-----+-----+
                | IPv4 Host |
                +-----------+
</pre></div>
<p style='text-align: center'>
</p><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;2: Outbound Datagram&nbsp;</b></font><br /></td></tr></table><hr class="insert" />
<br /><hr class="insert" />
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="right"><col align="right"><col align="left">
<tr><th align="right">Datagram</th><th align="right">Header field</th><th align="left">Contents</th></tr>
<tr>
<td align="right">IPv4 datagram 1</td>
<td align="right">IPv4 Dst</td>
<td align="left">198.51.100.1</td>
</tr>
<tr>
<td align="right">&nbsp;</td>
<td align="right">IPv4 Src</td>
<td align="left">10.0.0.1</td>
</tr>
<tr>
<td align="right">&nbsp;</td>
<td align="right">TCP Dst</td>
<td align="left">80</td>
</tr>
<tr>
<td align="right">&nbsp;</td>
<td align="right">TCP Src</td>
<td align="left">10000</td>
</tr>
<tr>
<td align="right">---------------</td>
<td align="right">------------</td>
<td align="left">-------------</td>
</tr>
<tr>
<td align="right">IPv6 Datagram 2</td>
<td align="right">IPv6 Dst</td>
<td align="left">2001:db8:0:2::1</td>
</tr>
<tr>
<td align="right">&nbsp;</td>
<td align="right">IPv6 Src</td>
<td align="left">2001:db8:0:1::1</td>
</tr>
<tr>
<td align="right">&nbsp;</td>
<td align="right">IPv4 Dst</td>
<td align="left">198.51.100.1</td>
</tr>
<tr>
<td align="right">&nbsp;</td>
<td align="right">IPv4 Src</td>
<td align="left">10.0.0.1</td>
</tr>
<tr>
<td align="right">&nbsp;</td>
<td align="right">TCP Dst</td>
<td align="left">80</td>
</tr>
<tr>
<td align="right">&nbsp;</td>
<td align="right">TCP Src</td>
<td align="left">10000</td>
</tr>
<tr>
<td align="right">---------------</td>
<td align="right">------------</td>
<td align="left">-------------</td>
</tr>
<tr>
<td align="right">IPv4 datagram 3</td>
<td align="right">IPv4 Dst</td>
<td align="left">198.51.100.1</td>
</tr>
<tr>
<td align="right">&nbsp;</td>
<td align="right">IPv4 Src</td>
<td align="left">192.0.2.1</td>
</tr>
<tr>
<td align="right">&nbsp;</td>
<td align="right">TCP Dst</td>
<td align="left">80</td>
</tr>
<tr>
<td align="right">&nbsp;</td>
<td align="right">TCP Src</td>
<td align="left">5000</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Datagram header contents&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>When datagram 1 is received by the dual-stack lite home router, the B4 function
     encapsulates the datagram in datagram 2 and forwards it to
     the dual-stack lite carrier-grade NAT over the softwire.
</p>
<p>When it receives datagram 2, the tunnel concentrator in the AFTR hands the
     IPv4 datagram to the NAT, which determines from its translation
     table that the datagram received on Softwire_1 with TCP SRC port
     10000 should be translated to datagram 3 with IP SRC address
     192.0.2.1 and TCP SRC port 5000.
</p>
<p><a class='info' href='#inbound-dg'>Figure&nbsp;3<span> (</span><span class='info'>Inbound Datagram</span><span>)</span></a> shows an inbound message received
     at the AFTR.  When the NAT function
     in the AFTR receives datagram 1, it
     looks up the IP/TCP DST in its translation table.  In the example
     in Figure 3, the NAT translates the TCP DST port to 10000, sets
     the IP DST address to 10.0.0.1 and hands the datagram to the SC
     for transmission over Softwire_1.  The B4 in the 
     home router decapsulates IPv4 datagram from the inbound softwire
     datagram, and forwards it to the host.
</p><br /><hr class="insert" />
<a name="inbound-dg"></a>

<p style='text-align: center'>
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
                +-----------+
                |    Host   |
                +-----+-----+
                   ^  |10.0.0.1
   IPv4 datagram 3 |  |
                   |  |
                   |  |10.0.0.2
            +---------|---------+
            |       +-+-+       |
            |    home router    |
            |+--------+--------+|
            ||        B4       ||
            |+--------+--------+|
            +--------|||--------+
                   ^ |||2001:db8:0:1::1
   IPv6 datagram 2 | |||
                   | |||&lt;-IPv4-in-IPv6 softwire
                   | |||
              -----|-|||-------
            /      | |||        \
           |   ISP core network  |
            \      | |||        /
              -----|-|||-------
                   | |||
                   | |||2001:db8:0:2::1
            +------|-|||--------+
            |       AFTR        |
            |+--------+--------+|
            ||   Concentrator  ||
            |+--------+--------+|
            |       |NAT|       |
            |       +-+-+       |
            +---------|---------+
                   ^  |192.0.2.1
   IPv4 datagram 1 |  |
                   |  |
              -----|--|--------
            /      |  |         \
           |       Internet      |
            \      |  |         /
              -----|--|--------
                   |  |
                   |  |198.51.100.1
                +-----+-----+
                | IPv4 Host |
                +-----------+
</pre></div>
<p style='text-align: center'>
</p><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;3: Inbound Datagram&nbsp;</b></font><br /></td></tr></table><hr class="insert" />
<br /><hr class="insert" />
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="right"><col align="right"><col align="left">
<tr><th align="right">Datagram</th><th align="right">Header field</th><th align="left">Contents</th></tr>
<tr>
<td align="right">IPv4 datagram 1</td>
<td align="right">IPv4 Dst</td>
<td align="left">192.0.2.1</td>
</tr>
<tr>
<td align="right">&nbsp;</td>
<td align="right">IPv4 Src</td>
<td align="left">198.51.100.1</td>
</tr>
<tr>
<td align="right">&nbsp;</td>
<td align="right">TCP Dst</td>
<td align="left">5000</td>
</tr>
<tr>
<td align="right">&nbsp;</td>
<td align="right">TCP Src</td>
<td align="left">80</td>
</tr>
<tr>
<td align="right">---------------</td>
<td align="right">------------</td>
<td align="left">-------------</td>
</tr>
<tr>
<td align="right">IPv6 Datagram 2</td>
<td align="right">IPv6 Dst</td>
<td align="left">2001:db8:0:1::1</td>
</tr>
<tr>
<td align="right">&nbsp;</td>
<td align="right">IPv6 Src</td>
<td align="left">2001:db8:0:2::1</td>
</tr>
<tr>
<td align="right">&nbsp;</td>
<td align="right">IPv4 Dst</td>
<td align="left">10.0.0.1</td>
</tr>
<tr>
<td align="right">&nbsp;</td>
<td align="right">IP Src</td>
<td align="left">198.51.100.1</td>
</tr>
<tr>
<td align="right">&nbsp;</td>
<td align="right">TCP Dst</td>
<td align="left">10000</td>
</tr>
<tr>
<td align="right">&nbsp;</td>
<td align="right">TCP Src</td>
<td align="left">80</td>
</tr>
<tr>
<td align="right">---------------</td>
<td align="right">------------</td>
<td align="left">-------------</td>
</tr>
<tr>
<td align="right">IPv4 datagram 3</td>
<td align="right">IPv4 Dst</td>
<td align="left">10.0.0.1</td>
</tr>
<tr>
<td align="right">&nbsp;</td>
<td align="right">IPv4 Src</td>
<td align="left">198.51.100.1</td>
</tr>
<tr>
<td align="right">&nbsp;</td>
<td align="right">TCP Dst</td>
<td align="left">10000</td>
</tr>
<tr>
<td align="right">&nbsp;</td>
<td align="right">TCP Src</td>
<td align="left">80</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Datagram header contents&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor44"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.13.1.2"></a><h3>13.1.2.&nbsp;
Translation details</h3>

<p>The AFTR has a NAT that
     translates between softwire/port pairs and IPv4-address/port
     pairs.  The same translation is applied to IPv4 datagrams
     received on the device's external interface and from the softwire
     endpoint in the device.
</p>
<p>In <a class='info' href='#outbound-dg'>Figure&nbsp;2<span> (</span><span class='info'>Outbound Datagram</span><span>)</span></a>, the translator network
     interface in the AFTR is on the
     Internet, and the softwire interface connects to the dual-stack
     lite home router.  The AFTR translator is configured as follows:

     </p>
<blockquote class="text"><dl>
<dt>Network interface:</dt>
<dd>Translate IPv4 destination
	address and TCP destination port to the softwire identifier
	and TCP destination port
</dd>
<dt>Softwire interface:</dt>
<dd>Translate softwire
	identifier and TCP source port to IPv4 source address and TCP
	source port
</dd>
</dl></blockquote><p>
     
</p>
<p>Here is how the translation in <a class='info' href='#inbound-dg'>Figure&nbsp;3<span> (</span><span class='info'>Inbound Datagram</span><span>)</span></a>
     works:

     </p>
<ul class="text">
<li>Datagram 1 is received on the AFTR translator network
	interface.  The translator looks up the IPv4-address/port
	pair in its translator table, rewrites the IPv4 destination address
	to 10.0.0.1 and the TCP source port to 10000, and hands the
	datagram to the SE to be forwarded over the softwire.
</li>
<li>The IPv4 datagram is received on the dual-stack lite home router B4.  The B4
	function extracts the IPv4 datagram and the dual-stack lite home router forwards
	datagram 3 to the host.
</li>
</ul><p>
     
</p><br /><hr class="insert" />
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="right"><col align="left">
<tr><th align="right">Softwire-Id/IPv4/Prot/Port</th><th align="left">IPv4/Prot/Port</th></tr>
<tr>
<td align="right">2001:db8:0:1::1/10.0.0.1/TCP/10000</td>
<td align="left">192.0.2.1/TCP/5000</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Dual-Stack lite carrier-grade NAT translation table&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p> The Softwire-Id is the IPv6 address assigned to the Dual-Stack lite CPE. Hosts behind
     the same Dual-Stack lite home router have the same Softwire-Id. The source IPv4 is the RFC1918 
     addressed assigned by the Dual-Stack home router which is unique to each host behind the CPE. 
     The AFTR would receive packets sourced from different IPv4 addresses
     in the same softwire tunnel. The AFTR combines the Softwire-Id and 
     IPv4 address/Port [Softwire-Id, IPv4+Port] to uniquely identify the host behind 
     the same Dual-Stack lite home router. 
</p>
<a name="host-based-arch"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.13.2"></a><h3>13.2.&nbsp;
Host based architecture</h3>

<p>
This architecture is targeted at new, large scale deployments of dual-stack capable devices implementing a dual-stack lite interface.

</p>
<p>
Consider a scenario where a Dual-Stack lite host device is directly connected to the service provider network. The host device is dual-stack capable but only provisioned an IPv6 global address. Besides, the host device will pre-configure a well-known IPv4 non-routable address (see IANA section). This well-known IPv4 non-routable address is similar to the 127.0.0.1 loopback address. Every host device implemented Dual-Stack lite will pre-configure the same address. This address will be used to source the IPv4 datagram when the device accesses IPv4 services. Besides, the host device will create an IPv4-in-IPv6 softwire tunnel to an AFTR. The Carrier Grade NAT will reside in the service provider network.
</p>
<p>
When the device accesses IPv6 service, the device will send the IPv6 datagram natively to the default gateway. 
</p>
<p>
When the device accesses IPv4 service, it will source the IPv4 datagram with the well-known non-routable IPv4 address. Then, the host device will encapsulate the IPv4 datagram inside the IPv4-in-IPv6 softwire tunnel and send the IPv6 datagram to the AFTR. When the AFTR receives the IPv6 datagram, it will decapsulate the IPv6 header and perform IPv4-to-IPv4 NAT on the source address.
</p>
<p>
This scenario works on both wireline and wireless networks. A typical wireless device will connect directly to the service provider without CPE in between.

</p>
<p>As illustrated in <a class='info' href='#gnat-arch2'>Figure&nbsp;4<span> (</span><span class='info'>host-based architecture</span><span>)</span></a>, this dual-stack
     lite deployment model consists of three components: the
     dual-stack lite host, the AFTR and a
     softwire between the softwire initiator B4 in the host and the
     softwire concentrator in the AFTR.
     The dual-stack lite host is assumed to have IPv6 service and
     can exchange IPv6 traffic with the AFTR.
</p>
<p>The AFTR performs IPv4-IPv4 NAT
     translations to multiplex multiple subscribers through a pool of 
     global IPv4 address.  Overlapping IPv4 address spaces used by the
     dual-stack lite hosts are disambiguated through the
     identification of tunnel endpoints.
</p>
<p>In this situation, the dual-stack lite host configures the
     IPv4 address 192.0.0.2 out of the well-known range 192.0.0.0/29 (defined by IANA) on its
     B4 interface. It also configure the first non-reserved IPv4 address of the
     reserved range, 192.0.0.1 as the address of its default gateway.
</p><br /><hr class="insert" />
<a name="gnat-arch2"></a>

<p style='text-align: center'>
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>


            +-------------------+
            |                   |
            |  Host 192.0.0.2   |
            |+--------+--------+|
            ||        B4       ||
            |+--------+--------+|
            +--------|||--------+
                     |||2001:db8:0:1::1
                     |||
                     |||&lt;-IPv4-in-IPv6 softwire
                     |||
              -------|||-------
            /        |||        \
           |   ISP core network  |
            \        |||        /
              -------|||-------
                     |||
                     |||2001:db8:0:2::1
            +--------|||--------+
            |       AFTR        |
            |+--------+--------+|
            ||  Concentrator   ||
            |+--------+--------+|
            |       |NAT|       |
            |       +-+-+       |
            +---------|---------+
                      |192.0.2.1
                      |
              --------|--------
            /         |         \
           |       Internet      |
            \         |         /
              --------|--------
                      |
                      |198.51.100.1
                +-----+-----+
                | IPv4 Host |
                +-----------+
</pre></div>
<p style='text-align: center'>
</p><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;4: host-based architecture&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>The resulting solution accepts an IPv4 datagram that is
     translated into an IPv4-in-IPv6 softwire datagram for
     transmission across the softwire.  At the corresponding
     endpoint, the IPv4 datagram is decapsulated, and the translated
     IPv4 address is inserted based on a translation from the
     softwire.
</p>
<a name="anchor45"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.13.2.1"></a><h3>13.2.1.&nbsp;
Example message flow</h3>

<p>In the example shown in <a class='info' href='#outbound-dg2'>Figure&nbsp;5<span> (</span><span class='info'>Outbound Datagram</span><span>)</span></a>, the
     translation tables in the AFTR is configured to forward between IP/TCP (a.b.c.d/10000) and IP/TCP
     (192.0.2.1/5000).  That is, a datagram received from the host at
     address 192.0.0.2, using TCP DST port 10000 will be translated a
     datagram with IP SRC address 192.0.2.1 and TCP SRC port 5000 in
     the Internet.
</p><br /><hr class="insert" />
<a name="outbound-dg2"></a>

<p style='text-align: center'>
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

            +-------------------+
            |                   |
            |Host 192.0.0.2     |
            |+--------+--------+|
            ||        B4       ||
            |+--------+--------+|
            +--------|||--------+
                   | |||2001:db8:0:1::1
    IPv6 datagram 1| |||
                   | |||&lt;-IPv4-in-IPv6 softwire
                   | |||
              -----|-|||-------
            /      | |||        \
           |   ISP core network  |
            \      | |||        /
              -----|-|||-------
                   | |||
                   | |||2001:db8:0:2::1
            +------|-|||--------+
            |      | AFTR       |
            |      v |||        |
            |+--------+--------+|
            ||  Concentrator   ||
            |+--------+--------+|
            |       |NAT|       |
            |       +-+-+       |
            +---------|---------+
                   |  |192.0.2.1
   IPv4 datagram 2 |  |
              -----|--|--------
            /      |  |         \
           |       Internet      |
            \      |  |         /
              -----|--|--------
                   |  |
                   v  |198.51.100.1
                +-----+-----+
                | IPv4 Host |
                +-----------+
</pre></div>
<p style='text-align: center'>
</p><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;5: Outbound Datagram&nbsp;</b></font><br /></td></tr></table><hr class="insert" />
<br /><hr class="insert" />
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="right"><col align="right"><col align="left">
<tr><th align="right">Datagram</th><th align="right">Header field</th><th align="left">Contents</th></tr>
<tr>
<td align="right">IPv6 Datagram 1</td>
<td align="right">IPv6 Dst</td>
<td align="left">2001:db8:0:2::1</td>
</tr>
<tr>
<td align="right">&nbsp;</td>
<td align="right">IPv6 Src</td>
<td align="left">2001:db8:0:1::1</td>
</tr>
<tr>
<td align="right">&nbsp;</td>
<td align="right">IPv4 Dst</td>
<td align="left">198.51.100.1</td>
</tr>
<tr>
<td align="right">&nbsp;</td>
<td align="right">IPv4 Src</td>
<td align="left">a.b.c.d</td>
</tr>
<tr>
<td align="right">&nbsp;</td>
<td align="right">TCP Dst</td>
<td align="left">80</td>
</tr>
<tr>
<td align="right">&nbsp;</td>
<td align="right">TCP Src</td>
<td align="left">10000</td>
</tr>
<tr>
<td align="right">---------------</td>
<td align="right">------------</td>
<td align="left">-------------</td>
</tr>
<tr>
<td align="right">IPv4 datagram 2</td>
<td align="right">IPv4 Dst</td>
<td align="left">198.51.100.1</td>
</tr>
<tr>
<td align="right">&nbsp;</td>
<td align="right">IPv4 Src</td>
<td align="left">192.0.2.1</td>
</tr>
<tr>
<td align="right">&nbsp;</td>
<td align="right">TCP Dst</td>
<td align="left">80</td>
</tr>
<tr>
<td align="right">&nbsp;</td>
<td align="right">TCP Src</td>
<td align="left">5000</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Datagram header contents&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>When sending an IPv4 packet, the dual-stack lite host
     encapsulates it in datagram 1 and forwards it to
     the AFTR over the softwire.
</p>
<p>When it receives datagram 1, the concentrator in the AFTR
     hands the IPv4 datagram to the NAT, which
     determines from its translation table that the datagram received
     on Softwire_1 with TCP SRC port 10000 should be translated to
     datagram 3 with IP SRC address 192.0.2.1 and TCP SRC port
     5000.
</p>
<p><a class='info' href='#inbound-dg2'>Figure&nbsp;6<span> (</span><span class='info'>Inbound Datagram</span><span>)</span></a> shows an inbound message
     received at the AFTR.  When the NAT
     function in the AFTR receives
     datagram 1, it looks up the IP/TCP DST in its translation table.
     In the example in Figure 3, the NAT translates the TCP DST port
     to 10000, sets the IP DST address to a.b.c.d and hands the
     datagram to the concentrator for transmission over Softwire_1.  The B4 in
     the dual-stack lite hosts decapsulates IPv4 datagram from
     the inbound softwire datagram, and forwards it to the host.
</p><br /><hr class="insert" />
<a name="inbound-dg2"></a>

<p style='text-align: center'>
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

            +-------------------+
            |                   |
            |Host 192.0.0.2     |
            |+--------+--------+|
            ||        B4       ||
            |+--------+--------+|
            +--------|||--------+
                   ^ |||2001:db8:0:1::1
   IPv6 datagram 2 | |||
                   | |||&lt;-IPv4-in-IPv6 softwire
                   | |||
              -----|-|||-------
            /      | |||        \
           |   ISP core network  |
            \      | |||        /
              -----|-|||-------
                   | |||
                   | |||2001:db8:0:2::1
            +------|-|||--------+
            |       AFTR        |
            |      | |||        |
            |+--------+--------+|
            ||  Concentrator   ||
            |+--------+--------+|
            |       |NAT|       |
            |       +-+-+       |
            +---------|---------+
                   ^  |192.0.2.1
   IPv4 datagram 1 |  |
              -----|--|--------
            /      |  |         \
           |       Internet      |
            \      |  |         /
              -----|--|--------
                   |  |
                   |  |198.51.100.1
                +-----+-----+
                | IPv4 Host |
                +-----------+
</pre></div>
<p style='text-align: center'>
</p><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;6: Inbound Datagram&nbsp;</b></font><br /></td></tr></table><hr class="insert" />
<br /><hr class="insert" />
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="right"><col align="right"><col align="left">
<tr><th align="right">Datagram</th><th align="right">Header field</th><th align="left">Contents</th></tr>
<tr>
<td align="right">IPv4 datagram 1</td>
<td align="right">IPv4 Dst</td>
<td align="left">192.0.2.1</td>
</tr>
<tr>
<td align="right">&nbsp;</td>
<td align="right">IPv4 Src</td>
<td align="left">198.51.100.1</td>
</tr>
<tr>
<td align="right">&nbsp;</td>
<td align="right">TCP Dst</td>
<td align="left">5000</td>
</tr>
<tr>
<td align="right">&nbsp;</td>
<td align="right">TCP Src</td>
<td align="left">80</td>
</tr>
<tr>
<td align="right">---------------</td>
<td align="right">------------</td>
<td align="left">-------------</td>
</tr>
<tr>
<td align="right">IPv6 Datagram 2</td>
<td align="right">IPv6 Dst</td>
<td align="left">2001:db8:0:1::1</td>
</tr>
<tr>
<td align="right">&nbsp;</td>
<td align="right">IPv6 Src</td>
<td align="left">2001:db8:0:2::1</td>
</tr>
<tr>
<td align="right">&nbsp;</td>
<td align="right">IPv4 Dst</td>
<td align="left">a.b.c.d</td>
</tr>
<tr>
<td align="right">&nbsp;</td>
<td align="right">IP Src</td>
<td align="left">198.51.100.1</td>
</tr>
<tr>
<td align="right">&nbsp;</td>
<td align="right">TCP Dst</td>
<td align="left">10000</td>
</tr>
<tr>
<td align="right">&nbsp;</td>
<td align="right">TCP Src</td>
<td align="left">80</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Datagram header contents&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor46"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.13.2.2"></a><h3>13.2.2.&nbsp;
Translation details</h3>

<p>The translations happening in the AFTR
     are the same as in the previous examples. The
     well known IPv4 address 192.0.0.2 out of the 192.0.0.0/29 (defined by IANA) range used by all the hosts are
     disambiguated by the IPv6 source address of the softwire.
     
</p><br /><hr class="insert" />
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="right"><col align="left">
<tr><th align="right">Softwire-Id/IPv4/Prot/Port</th><th align="left">IPv4/Prot/Port</th></tr>
<tr>
<td align="right">2001:db8:0:1::1/a.b.c.d/TCP/10000</td>
<td align="left">192.0.2.1/TCP/5000</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Dual-Stack lite carrier-grade NAT translation table&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p> The Softwire-Id is the IPv6 address assigned to the Dual-Stack host. Each host has an unique
     Softwire-Id. The source IPv4 address is one of the well-known IPv4 address. The AFTR
     could receive packets from different hosts sourced from the same IPv4 well-known address from different 
     softwire tunnels. Similar to the gateway architecture, the AFTR
     combines the Softwire-Id and IPv4
     address/Port [Softwire-Id, IPv4+Port] to uniquely identify the individual host. 
     
</p>
<a name="anchor47"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.14"></a><h3>14.&nbsp;
Appendix C: Related DS-Lite work on port management</h3>

<p>Techniques discussed below are not part of the core dual-stack lite specification and may or may not be standardized in separate documents. They are only listed here for reference.

</p>
<p>
Applications expecting incoming connections, such a peer-to-peer applications, have become popular. Those applications use a very limited number of ports, usually a single one. Making sure those applications keep working in a dual-stack lite environment is important. Similarly, there is a growing list of applications that require some kind of ALG to work through a NAT. Service provider AFTRs should not prevent the deployment of such applications. As such, there is a legitimate need to leave certain ports under the control of the end user or its applications. This argues for a hybrid environment, where most ports are dynamically managed by the AFTR in a shared pool and a limited number are dedicated per users and controlled by them.

</p>
<p> The details of how ports can be controlled by users and applications are beyond the scope of this document. For reference, the  <a class='info' href='#I-D.ymbk-aplusp'>A+P<span> (</span><span class='info'>Bush, R., &ldquo;The A+P Approach to the IPv4 Address Shortage,&rdquo; October&nbsp;2009.</span><span>)</span></a> [I&#8209;D.ymbk&#8209;aplusp] model where an address and a set of ports are assigned to users has been extensively discussed. User controled techniques for port allocation via a service provider portal or a <a class='info' href='#I-D.bajko-v6ops-port-restricted-ipaddr-assign'>DHCPv6 option<span> (</span><span class='info'>Bajko, G. and T. Savolainen, &ldquo;Port Restricted IP Address Assignment,&rdquo; November&nbsp;2008.</span><span>)</span></a> [I&#8209;D.bajko&#8209;v6ops&#8209;port&#8209;restricted&#8209;ipaddr&#8209;assign] have been proposed. Techniques using some form of port control protocol such as <a class='info' href='#UPnP-IGD'>UPnP<span> (</span><span class='info'>UPnP Forum, &ldquo;Universal Plug and Play Internet Gateway Device Standardized 	  Gateway Device Protocol,&rdquo; September&nbsp;2006.</span><span>)</span></a> [UPnP&#8209;IGD], <a class='info' href='#I-D.cheshire-nat-pmp'>NAT-PMP<span> (</span><span class='info'>Cheshire, S., &ldquo;NAT Port Mapping Protocol (NAT-PMP),&rdquo; April&nbsp;2008.</span><span>)</span></a> [I&#8209;D.cheshire&#8209;nat&#8209;pmp] and <a class='info' href='#I-D.wing-softwire-port-control-protocol'>PCP<span> (</span><span class='info'>Wing, D., Penno, R., and M. Boucadair, &ldquo;Pinhole Control Protocol (PCP),&rdquo; July&nbsp;2010.</span><span>)</span></a> [I&#8209;D.wing&#8209;softwire&#8209;port&#8209;control&#8209;protocol] are under discussion to enable a direct communication beetween applications and the service provider NAT.

</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.15"></a><h3>15.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>15.1.&nbsp;Normative references</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.ietf-softwire-ds-lite-tunnel-option">[I-D.ietf-softwire-ds-lite-tunnel-option]</a></td>
<td class="author-text">Hankins, D. and T. Mrugalski, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-softwire-ds-lite-tunnel-option-03.txt">Dynamic Host Configuration Protocol for IPv6 (DHCPv6) Options for Dual- Stack Lite</a>,&rdquo; draft-ietf-softwire-ds-lite-tunnel-option-03 (work in progress), June&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-softwire-ds-lite-tunnel-option-03.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2473">[RFC2473]</a></td>
<td class="author-text"><a href="mailto:aconta@lucent.com">Conta, A.</a> and <a href="mailto:deering@cisco.com">S. Deering</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2473">Generic Packet Tunneling in IPv6 Specification</a>,&rdquo; RFC&nbsp;2473, December&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2473.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2473.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2473.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2474">[RFC2474]</a></td>
<td class="author-text"><a href="mailto:kmn@cisco.com">Nichols, K.</a>, <a href="mailto:slblake@torrentnet.com">Blake, S.</a>, <a href="mailto:fred@cisco.com">Baker, F.</a>, and <a href="mailto:black_david@emc.com">D. Black</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2474">Definition of the Differentiated Services Field (DS Field) in the IPv4 and IPv6 Headers</a>,&rdquo; RFC&nbsp;2474, December&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2474.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2474.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2474.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4213">[RFC4213]</a></td>
<td class="author-text">Nordmark, E. and R. Gilligan, &ldquo;<a href="http://tools.ietf.org/html/rfc4213">Basic Transition Mechanisms for IPv6 Hosts and Routers</a>,&rdquo; RFC&nbsp;4213, October&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4213.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5625">[RFC5625]</a></td>
<td class="author-text">Bellis, R., &ldquo;<a href="http://tools.ietf.org/html/rfc5625">DNS Proxy Implementation Guidelines</a>,&rdquo; BCP&nbsp;152, RFC&nbsp;5625, August&nbsp;2009 (<a href="http://www.rfc-editor.org/rfc/rfc5625.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>15.2.&nbsp;Informative references</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.bajko-v6ops-port-restricted-ipaddr-assign">[I-D.bajko-v6ops-port-restricted-ipaddr-assign]</a></td>
<td class="author-text">Bajko, G. and T. Savolainen, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-bajko-v6ops-port-restricted-ipaddr-assign-02.txt">Port Restricted IP Address Assignment</a>,&rdquo; draft-bajko-v6ops-port-restricted-ipaddr-assign-02 (work in progress), November&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-bajko-v6ops-port-restricted-ipaddr-assign-02.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.cheshire-nat-pmp">[I-D.cheshire-nat-pmp]</a></td>
<td class="author-text">Cheshire, S., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-cheshire-nat-pmp-03.txt">NAT Port Mapping Protocol (NAT-PMP)</a>,&rdquo; draft-cheshire-nat-pmp-03 (work in progress), April&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-cheshire-nat-pmp-03.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.droms-softwires-snat">[I-D.droms-softwires-snat]</a></td>
<td class="author-text">Droms, R. and B. Haberman, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-droms-softwires-snat-01.txt">Softwires Network Address Translation (SNAT)</a>,&rdquo; draft-droms-softwires-snat-01 (work in progress), July&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-droms-softwires-snat-01.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.durand-dual-stack-lite">[I-D.durand-dual-stack-lite]</a></td>
<td class="author-text">Durand, A., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-durand-dual-stack-lite-00.txt">Dual-stack lite broadband deployments post IPv4 exhaustion</a>,&rdquo; draft-durand-dual-stack-lite-00 (work in progress), July&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-durand-dual-stack-lite-00.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ford-shared-addressing-issues">[I-D.ford-shared-addressing-issues]</a></td>
<td class="author-text">Ford, M., Boucadair, M., Durand, A., Levis, P., and P. Roberts, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ford-shared-addressing-issues-02.txt">Issues with IP Address Sharing</a>,&rdquo; draft-ford-shared-addressing-issues-02 (work in progress), March&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ford-shared-addressing-issues-02.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.nishitani-cgn">[I-D.nishitani-cgn]</a></td>
<td class="author-text">Yamagata, I., Miyakawa, S., Nakagawa, A., and H. Ashida, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-nishitani-cgn-05.txt">Common requirements for IP address sharing schemes</a>,&rdquo; draft-nishitani-cgn-05 (work in progress), July&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-nishitani-cgn-05.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.templin-seal">[I-D.templin-seal]</a></td>
<td class="author-text">Templin, F., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-templin-seal-23.txt">The Subnetwork Encapsulation and Adaptation Layer (SEAL)</a>,&rdquo; draft-templin-seal-23 (work in progress), August&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-templin-seal-23.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.wing-softwire-port-control-protocol">[I-D.wing-softwire-port-control-protocol]</a></td>
<td class="author-text">Wing, D., Penno, R., and M. Boucadair, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-wing-softwire-port-control-protocol-02.txt">Pinhole Control Protocol (PCP)</a>,&rdquo; draft-wing-softwire-port-control-protocol-02 (work in progress), July&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-wing-softwire-port-control-protocol-02.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ymbk-aplusp">[I-D.ymbk-aplusp]</a></td>
<td class="author-text">Bush, R., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ymbk-aplusp-05.txt">The A+P Approach to the IPv4 Address Shortage</a>,&rdquo; draft-ymbk-aplusp-05 (work in progress), October&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-ymbk-aplusp-05.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1191">[RFC1191]</a></td>
<td class="author-text"><a href="mailto:mogul@decwrl.dec.com">Mogul, J.</a> and <a href="mailto:deering@xerox.com">S. Deering</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1191">Path MTU discovery</a>,&rdquo; RFC&nbsp;1191, November&nbsp;1990 (<a href="http://www.rfc-editor.org/rfc/rfc1191.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1918">[RFC1918]</a></td>
<td class="author-text"><a href="mailto:yakov@cisco.com">Rekhter, Y.</a>, <a href="mailto:rgm3@is.chrysler.com">Moskowitz, R.</a>, <a href="mailto:Daniel.Karrenberg@ripe.net">Karrenberg, D.</a>, <a href="mailto:GeertJan.deGroot@ripe.net">Groot, G.</a>, and <a href="mailto:lear@sgi.com">E. Lear</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1918">Address Allocation for Private Internets</a>,&rdquo; BCP&nbsp;5, RFC&nbsp;1918, February&nbsp;1996 (<a href="http://www.rfc-editor.org/rfc/rfc1918.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2663">[RFC2663]</a></td>
<td class="author-text"><a href="mailto:srisuresh@lucent.com">Srisuresh, P.</a> and <a href="mailto:holdrege@lucent.com">M. Holdrege</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2663">IP Network Address Translator (NAT) Terminology and Considerations</a>,&rdquo; RFC&nbsp;2663, August&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2663.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2993">[RFC2993]</a></td>
<td class="author-text">Hain, T., &ldquo;<a href="http://tools.ietf.org/html/rfc2993">Architectural Implications of NAT</a>,&rdquo; RFC&nbsp;2993, November&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2993.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4787">[RFC4787]</a></td>
<td class="author-text">Audet, F. and C. Jennings, &ldquo;<a href="http://tools.ietf.org/html/rfc4787">Network Address Translation (NAT) Behavioral Requirements for Unicast UDP</a>,&rdquo; BCP&nbsp;127, RFC&nbsp;4787, January&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4787.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5382">[RFC5382]</a></td>
<td class="author-text">Guha, S., Biswas, K., Ford, B., Sivakumar, S., and P. Srisuresh, &ldquo;<a href="http://tools.ietf.org/html/rfc5382">NAT Behavioral Requirements for TCP</a>,&rdquo; BCP&nbsp;142, RFC&nbsp;5382, October&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5382.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5508">[RFC5508]</a></td>
<td class="author-text">Srisuresh, P., Ford, B., Sivakumar, S., and S. Guha, &ldquo;<a href="http://tools.ietf.org/html/rfc5508">NAT Behavioral Requirements for ICMP</a>,&rdquo; BCP&nbsp;148, RFC&nbsp;5508, April&nbsp;2009 (<a href="http://www.rfc-editor.org/rfc/rfc5508.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5571">[RFC5571]</a></td>
<td class="author-text">Storer, B., Pignataro, C., Dos Santos, M., Stevant, B., Toutain, L., and J. Tremblay, &ldquo;<a href="http://tools.ietf.org/html/rfc5571">Softwire Hub and Spoke Deployment Framework with Layer Two Tunneling Protocol Version 2 (L2TPv2)</a>,&rdquo; RFC&nbsp;5571, June&nbsp;2009 (<a href="http://www.rfc-editor.org/rfc/rfc5571.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="UPnP-IGD">[UPnP-IGD]</a></td>
<td class="author-text">UPnP Forum, &ldquo;<a href="http://www.upnp.org/standardizeddcps/igd.asp">Universal Plug and Play Internet Gateway Device Standardized
	  Gateway Device Protocol</a>,&rdquo; September&nbsp;2006.</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Alain Durand</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Juniper Networks</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">1194 North Mathilda Avenue</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Sunnyvale, CA  94089-1206</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:adurand@juniper.net">adurand@juniper.net</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Ralph Droms</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">1414 Massachusetts Avenue</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Boxborough, MA  01714</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:rdroms@cisco.com">rdroms@cisco.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">James Woodyatt</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Apple</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">1 Infinite Loop</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cupertino, CA  95014</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:jhw@apple.com">jhw@apple.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Yiu Lee</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Comcast</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">1, Comcast center</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Philadelphia, PA  19103</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:yiu_lee@cable.comcast.com">yiu_lee@cable.comcast.com</a></td></tr>
</table>
</body></html>
