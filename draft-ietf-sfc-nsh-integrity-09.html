<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Integrity Protection for the Network Service Header (NSH) and Encryption of Sensitive Context Headers</title>
<meta content="Mohamed Boucadair" name="author">
<meta content="Tirumaleswar Reddy" name="author">
<meta content="Dan Wing" name="author">
<meta content="
       This specification presents an optional method to add integrity
      protection directly to the Network Service Header (NSH) used for Service
      Function Chaining (SFC). Also, this specification allows for the
      encryption of sensitive metadata that is carried in the NSH. 
    " name="description">
<meta content="xml2rfc 3.9.1" name="generator">
<meta content="Security" name="keyword">
<meta content="Resilience" name="keyword">
<meta content="Automation" name="keyword">
<meta content="Service delivery" name="keyword">
<meta content="Providers" name="keyword">
<meta content="Differentiated services" name="keyword">
<meta content="Traffic Engineering" name="keyword">
<meta content="Attack mitigation" name="keyword">
<meta content="draft-ietf-sfc-nsh-integrity-09" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.9.1
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.5.2
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.6.3
    pycountry 20.7.3
    pyflakes 2.3.1
    PyYAML 5.4.1
    requests 2.26.0
    setuptools 58.0.2
    six 1.16.0
-->
<link href="/tmp/draft-ietf-sfc-nsh-integrity-09-68snr0dt.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Integrity Protection for the NSH</td>
<td class="right">September 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Boucadair, et al.</td>
<td class="center">Expires 24 March 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">SFC</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-sfc-nsh-integrity-09</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2021-09-20" class="published">20 September 2021</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-03-24">24 March 2022</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">M. Boucadair</div>
<div class="org">Orange</div>
</div>
<div class="author">
      <div class="author-name">T. Reddy</div>
<div class="org">Akamai</div>
</div>
<div class="author">
      <div class="author-name">D. Wing</div>
<div class="org">Citrix</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Integrity Protection for the Network Service Header (NSH) and Encryption of Sensitive Context Headers</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This specification presents an optional method to add integrity
      protection directly to the Network Service Header (NSH) used for Service
      Function Chaining (SFC). Also, this specification allows for the
      encryption of sensitive metadata that is carried in the NSH.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 24 March 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="toc compact ulBare ulEmpty">
<li class="toc compact ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
</li>
          <li class="toc compact ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="xref">2</a>.  <a href="#name-terminology" class="xref">Terminology</a></p>
</li>
          <li class="toc compact ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1" class="keepWithNext"><a href="#section-3" class="xref">3</a>.  <a href="#name-assumptions-and-basic-requi" class="xref">Assumptions and Basic Requirements</a></p>
</li>
          <li class="toc compact ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-design-overview" class="xref">Design Overview</a></p>
<ul class="compact ulBare ulEmpty toc">
<li class="compact ulBare ulEmpty toc" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-supported-security-services" class="xref">Supported Security Services</a></p>
<ul class="compact ulBare ulEmpty toc">
<li class="compact ulBare ulEmpty toc" id="section-toc.1-1.4.2.1.2.1">
                    <p id="section-toc.1-1.4.2.1.2.1.1"><a href="#section-4.1.1" class="xref">4.1.1</a>.  <a href="#name-encrypt-all-or-a-subset-of-" class="xref">Encrypt All or a Subset of Context Headers</a></p>
</li>
                  <li class="compact ulBare ulEmpty toc" id="section-toc.1-1.4.2.1.2.2">
                    <p id="section-toc.1-1.4.2.1.2.2.1"><a href="#section-4.1.2" class="xref">4.1.2</a>.  <a href="#name-integrity-protection" class="xref">Integrity Protection</a></p>
</li>
                </ul>
</li>
              <li class="compact ulBare ulEmpty toc" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-one-secret-key-two-security" class="xref">One Secret Key, Two Security Services</a></p>
</li>
              <li class="compact ulBare ulEmpty toc" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.  <a href="#name-mandatory-to-implement-auth" class="xref">Mandatory-to-Implement Authenticated Encryption and HMAC Algorithms</a></p>
</li>
              <li class="compact ulBare ulEmpty toc" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="xref">4.4</a>.  <a href="#name-key-management" class="xref">Key Management</a></p>
</li>
              <li class="compact ulBare ulEmpty toc" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="xref">4.5</a>.  <a href="#name-new-nsh-variable-length-con" class="xref">New NSH Variable-Length Context Headers</a></p>
</li>
              <li class="compact ulBare ulEmpty toc" id="section-toc.1-1.4.2.6">
                <p id="section-toc.1-1.4.2.6.1"><a href="#section-4.6" class="xref">4.6</a>.  <a href="#name-encapsulation-of-nsh-within" class="xref">Encapsulation of NSH within NSH</a></p>
</li>
            </ul>
</li>
          <li class="toc compact ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-new-nsh-variable-length-cont" class="xref">New NSH Variable-Length Context Headers</a></p>
<ul class="compact ulBare ulEmpty toc">
<li class="compact ulBare ulEmpty toc" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-mac1-context-header" class="xref">MAC#1 Context Header</a></p>
</li>
              <li class="compact ulBare ulEmpty toc" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-mac2-context-header" class="xref">MAC#2 Context Header</a></p>
</li>
            </ul>
</li>
          <li class="toc compact ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-timestamp-format" class="xref">Timestamp Format</a></p>
</li>
          <li class="toc compact ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-processing-rules" class="xref">Processing Rules</a></p>
<ul class="compact ulBare ulEmpty toc">
<li class="compact ulBare ulEmpty toc" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.  <a href="#name-generic-behavior" class="xref">Generic Behavior</a></p>
</li>
              <li class="compact ulBare ulEmpty toc" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="xref">7.2</a>.  <a href="#name-mac-nsh-data-generation" class="xref">MAC NSH Data Generation</a></p>
</li>
              <li class="compact ulBare ulEmpty toc" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="xref">7.3</a>.  <a href="#name-encrypted-nsh-metadata-gene" class="xref">Encrypted NSH Metadata Generation</a></p>
</li>
              <li class="compact ulBare ulEmpty toc" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="xref">7.4</a>.  <a href="#name-timestamp-for-replay-attack" class="xref">Timestamp for Replay Attack Prevention</a></p>
</li>
              <li class="compact ulBare ulEmpty toc" id="section-toc.1-1.7.2.5">
                <p id="section-toc.1-1.7.2.5.1"><a href="#section-7.5" class="xref">7.5</a>.  <a href="#name-nsh-data-validation" class="xref">NSH Data Validation</a></p>
</li>
              <li class="compact ulBare ulEmpty toc" id="section-toc.1-1.7.2.6">
                <p id="section-toc.1-1.7.2.6.1"><a href="#section-7.6" class="xref">7.6</a>.  <a href="#name-decryption-of-nsh-metadata" class="xref">Decryption of NSH Metadata</a></p>
</li>
            </ul>
</li>
          <li class="toc compact ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-mtu-considerations" class="xref">MTU Considerations</a></p>
</li>
          <li class="toc compact ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
<ul class="compact ulBare ulEmpty toc">
<li class="compact ulBare ulEmpty toc" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="xref">9.1</a>.  <a href="#name-mac1" class="xref">MAC#1</a></p>
</li>
              <li class="compact ulBare ulEmpty toc" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="xref">9.2</a>.  <a href="#name-mac2" class="xref">MAC#2</a></p>
</li>
              <li class="compact ulBare ulEmpty toc" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a href="#section-9.3" class="xref">9.3</a>.  <a href="#name-time-synchronization" class="xref">Time Synchronization</a></p>
</li>
            </ul>
</li>
          <li class="toc compact ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
</li>
          <li class="toc compact ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>. <a href="#name-acknowledgements" class="xref">Acknowledgements</a></p>
</li>
          <li class="toc compact ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="xref">12</a>. <a href="#name-references" class="xref">References</a></p>
<ul class="compact ulBare ulEmpty toc">
<li class="compact ulBare ulEmpty toc" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#section-12.1" class="xref">12.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
              <li class="compact ulBare ulEmpty toc" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#section-12.2" class="xref">12.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="toc compact ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-A" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Many advanced Service Functions (SFs) are enabled for the delivery of
      value-added services. Typically, SFs are used to meet various service
      objectives such as IP address sharing, avoiding covert channels,
      detecting Denial-of-Service (DoS) attacks and protecting network
      infrastructures against them, network slicing, etc. Because of the
      proliferation of such advanced SFs together with complex service
      deployment constraints that demand more agile service delivery
      procedures, operators need to rationalize their service delivery logic
      and control its complexity while optimising service activation time
      cycles. The overall problem space is described in <span>[<a href="#RFC7498" class="xref">RFC7498</a>]</span>.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2"><span>[<a href="#RFC7665" class="xref">RFC7665</a>]</span> presents a data plane architecture
      addressing the problematic aspects of existing service deployments,
      including topological dependence and configuration complexity. It also
      describes an architecture for the specification, creation, and
      maintenance of Service Function Chains (SFCs) within a network. That is,
      how to define an ordered set of SFs and ordering constraints that must
      be applied to packets/flows selected as a result of traffic
      classification. <span>[<a href="#RFC8300" class="xref">RFC8300</a>]</span> specifies the SFC
      encapsulation: Network Service Header (NSH).<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">The NSH data is unauthenticated and unencrypted, forcing a service
      topology that requires security and privacy to use a transport
      encapsulation that supports such features (Section 8.2 of <span>[<a href="#RFC8300" class="xref">RFC8300</a>]</span>).<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">Note that some transport encapsulations (e.g., IPsec) only provide
      hop-by-hop security between two SFC data plane elements (e.g., two
      Service Function Forwarders (SFFs), SFF to SF) and do not provide
      SF-to-SF security of NSH metadata. For example, if IPsec is used, SFFs
      or SFs within a Service Function Path (SFP) that are not authorized to
      access the sensitive metadata (e.g., privacy-sensitive information) will
      have access to the metadata. As a reminder, the metadata referred to is
      information that is inserted by Classifiers or intermediate SFs and
      shared with downstream SFs; such information is not visible to the
      communication endpoints (Section 4.9 of <span>[<a href="#RFC7665" class="xref">RFC7665</a>]</span>).<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">The lack of such capability was reported during the development of
      <span>[<a href="#RFC8300" class="xref">RFC8300</a>]</span> and <span>[<a href="#RFC8459" class="xref">RFC8459</a>]</span>. The
      reader may refer to Section 3.2.1 of <span>[<a href="#I-D.arkko-farrell-arch-model-t" class="xref">I-D.arkko-farrell-arch-model-t</a>]</span> for a discussion on the
      need for more awareness about attacks from within closed domains.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">This specification fills that gap for SFC (that is, it defines the
      "NSH Variable Header-Based Integrity" option mentioned in Section 8.2.1
      of <span>[<a href="#RFC8300" class="xref">RFC8300</a>]</span>). Concretely, this document adds
      integrity protection and optional encryption of sensitive metadata
      directly to the NSH (<a href="#overview" class="xref">Section 4</a>). The integrity
      protection covers the packet payload and provides replay protection
      (<a href="#time" class="xref">Section 7.4</a>). Thus, the NSH does not have to rely upon
      an underlying transport encapsulation for security.<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7">This specification introduces new Variable-Length Context Headers to
      carry fields necessary for integrity-protected NSH headers and encrypted
      Context Headers (<a href="#new" class="xref">Section 5</a>). This specification is only
      applicable to NSH MD Type 0x02 (Section 2.5 of <span>[<a href="#RFC8300" class="xref">RFC8300</a>]</span>). MTU considerations are discussed in <a href="#MTU" class="xref">Section 8</a>. This specification is not applicable to NSH MD
      Type 0x01 (Section 2.4 of <span>[<a href="#RFC8300" class="xref">RFC8300</a>]</span>) because that
      MD Type only allows a Fixed-Length Context Header whose size is
      16-bytes; that is not sufficient to accommodate both the metadata and
      message integrity of the NSH data.<a href="#section-1-7" class="pilcrow">¶</a></p>
<p id="section-1-8">This specification limits access to NSH-supplied information along an
      SFP to entities that have a need to interpret it.<a href="#section-1-8" class="pilcrow">¶</a></p>
<p id="section-1-9">The mechanism specified in this document does not preclude the use of
      transport security. Such considerations are deployment-specific.<a href="#section-1-9" class="pilcrow">¶</a></p>
<p id="section-1-10">It is out of the scope of this document to specify an NSH-aware
      control plane solution.<a href="#section-1-10" class="pilcrow">¶</a></p>
</section>
<div id="notation">
<section id="section-2">
      <h2 id="name-terminology">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
      </h2>
<p id="section-2-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
      "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
      "OPTIONAL" in this document are to be interpreted as described in BCP 14
      <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and
      only when, they appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">This document makes use of the terms defined in <span>[<a href="#RFC7665" class="xref">RFC7665</a>]</span> and <span>[<a href="#RFC8300" class="xref">RFC8300</a>]</span>. The term
      "transport encapsulation" used in this document refers to the outer
      encapsulation (e.g., Generic Routing Encapsulation (GRE), IPsec, Generic
      Protocol Extension for VXLAN (VXLAN-GPE)) that is used to carry
      NSH-encapsulated packets as per Section 4 of <span>[<a href="#RFC8300" class="xref">RFC8300</a>]</span>.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">The document defines the following terms:<a href="#section-2-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2-4">
        <dt id="section-2-4.1">SFC data plane element:</dt>
        <dd style="margin-left: 1.5em" id="section-2-4.2">Refers to NSH-aware SF, SFF,
          SFC Proxy, or Classifier as defined in the SFC data plane
          architecture <span>[<a href="#RFC7665" class="xref">RFC7665</a>]</span> and further refined in
          <span>[<a href="#RFC8300" class="xref">RFC8300</a>]</span>.<a href="#section-2-4.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-4.3">SFC control element:</dt>
        <dd style="margin-left: 1.5em" id="section-2-4.4">Is a logical entity that
          instructs one or more SFC data plane elements on how to process NSH
          packets within an SFC-enabled domain.<a href="#section-2-4.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-4.5">Key Identifier:</dt>
        <dd style="margin-left: 1.5em" id="section-2-4.6">Is used to identify keys to authorized
          entities. See, for example, 'kid' usage in <span>[<a href="#RFC7635" class="xref">RFC7635</a>]</span>.<a href="#section-2-4.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-4.7">NSH data:</dt>
        <dd style="margin-left: 1.5em" id="section-2-4.8">The NSH is composed of a Base Header, a
          Service Path Header, and optional Context Headers. NSH data refers
          to all the above headers and the packet or frame on which the NSH is
          imposed to realize an SFP.<a href="#section-2-4.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-4.9">NSH imposer:</dt>
        <dd style="margin-left: 1.5em" id="section-2-4.10">Refers to an SFC data plane element that
          is entitled to impose the NSH with the Context Headers defined in
          this document.<a href="#section-2-4.10" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
</section>
</div>
<div id="req">
<section id="section-3">
      <h2 id="name-assumptions-and-basic-requi">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-assumptions-and-basic-requi" class="section-name selfRef">Assumptions and Basic Requirements</a>
      </h2>
<p id="section-3-1">Section 2 of <span>[<a href="#RFC8300" class="xref">RFC8300</a>]</span> specifies that the NSH
      data can be spread over three headers:<a href="#section-3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-2.1">Base Header: Provides information about the service header and
          the payload protocol.<a href="#section-3-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-2.2">Service Path Header: Provides path identification and location
          within an SFP.<a href="#section-3-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-2.3">Context Header(s): Carries metadata (i.e., context data) along a
          service path.<a href="#section-3-2.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-3-3">The NSH allows sharing context information (a.k.a., metadata) with
      downstream NSH-aware data plane elements on a per SFC/SFP basis. To that
      aim:<a href="#section-3-3" class="pilcrow">¶</a></p>
<ul class="ulEmpty normal">
<li class="ulEmpty normal" id="section-3-4.1">The Classifier is instructed by an SFC control element about the
          set of context information to be supplied for a given service
          function chain.<a href="#section-3-4.1" class="pilcrow">¶</a>
</li>
        <li class="ulEmpty normal" id="section-3-4.2">An NSH-aware SF is instructed by an SFC control element about any
          metadata it needs to attach to packets for a given service function
          chain. This instruction may occur any time during the validity
          lifetime of an SFC/SFP. For a given service function chain, the
          NSH-aware SF is also provided with an order for consuming a set of
          contexts supplied in a packet.<a href="#section-3-4.2" class="pilcrow">¶</a>
</li>
        <li class="ulEmpty normal" id="section-3-4.3">An NSH-aware SF can also be instructed by an SFC control element
          about the behavior it should adopt after consuming context
          information that was supplied in the NSH. For example, the context
          information can be maintained, updated, or stripped.<a href="#section-3-4.3" class="pilcrow">¶</a>
</li>
        <li class="ulEmpty normal" id="section-3-4.4">An SFC Proxy may be instructed by an SFC control element about
          the behavior it should adopt to process the context information that
          was supplied in the NSH on behalf of an NSH-unaware SF (e.g., the
          context information can be maintained or stripped). The SFC Proxy
          may also be instructed to add some new context information into the
          NSH on behalf of an NSH-unaware SF.<a href="#section-3-4.4" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-3-5">In reference to Table 1,<a href="#section-3-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-6.1">Classifiers, NSH-aware SFs, and SFC proxies are entitled to
          update the Context Header(s).<a href="#section-3-6.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-6.2">Only NSH-aware SFs and SFC proxies are entitled to update the
          Service Path Header.<a href="#section-3-6.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-6.3">SFFs are entitled to modify the Base Header (TTL value, for
          example). Nevertheless, SFFs are not supposed to act on the Context
          Headers or look into the content of the Context Headers (Section 4.3
          of <span>[<a href="#RFC7665" class="xref">RFC7665</a>]</span>).<a href="#section-3-6.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-3-7">Thus, the following requirements:<a href="#section-3-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-8.1">Only Classifiers, NSH-aware SFs, and SFC proxies must be able to
          encrypt and decrypt a given Context Header.<a href="#section-3-8.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-8.2">Both encrypted and unencrypted Context Headers may be included in
          the same NSH.<a href="#section-3-8.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-8.3">The solution must provide integrity protection for the Service
          Path Header.<a href="#section-3-8.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-8.4">The solution must provide optional integrity protection for the
          Base Header. The implications of disabling such checks are discussed
          in <a href="#mac1" class="xref">Section 9.1</a>.<a href="#section-3-8.4" class="pilcrow">¶</a>
</li>
      </ul>
<div class="artwork art-text alignCenter" id="section-3-9">
<pre>+----------------+-----------------------------+-------------------+
|                | Insert, remove, or replace  |  Update the NSH   |
|                |          the NSH            |                   |
|                |                             |                   |
| SFC Data Plane +---------+---------+---------+---------+---------+
|   Element      |         |         |         |Decrement| Update  |
|                | Insert  | Remove  | Replace | Service | Context |
|                |         |         |         |  Index  |Header(s)|
+================+=========+=========+=========+=========+=========+
|                |    +    |         |    +    |         |    +    |
|   Classifier   |         |         |         |         |         |
+----------------+---------+---------+---------+---------+---------+
|Service Function|         |    +    |         |         |         |
|Forwarder (SFF) |         |         |         |         |         |
+----------------+---------+---------+---------+---------+---------+
|Service Function|         |         |         |    +    |    +    |
|      (SF)      |         |         |         |         |         |
+----------------+---------+---------+---------+---------+---------+
|                |    +    |    +    |         |    +    |    +    |
|   SFC Proxy    |         |         |         |         |         |
+----------------+---------+---------+---------+---------+---------+


                     Table 1: Summary of NSH Actions</pre><a href="#section-3-9" class="pilcrow">¶</a>
</div>
<p id="section-3-10"></p>
</section>
</div>
<div id="overview">
<section id="section-4">
      <h2 id="name-design-overview">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-design-overview" class="section-name selfRef">Design Overview</a>
      </h2>
<p id="section-4-1"></p>
<section id="section-4.1">
        <h3 id="name-supported-security-services">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-supported-security-services" class="section-name selfRef">Supported Security Services</a>
        </h3>
<p id="section-4.1-1">This specification provides the functions described in the
        following subsections.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<section id="section-4.1.1">
          <h4 id="name-encrypt-all-or-a-subset-of-">
<a href="#section-4.1.1" class="section-number selfRef">4.1.1. </a><a href="#name-encrypt-all-or-a-subset-of-" class="section-name selfRef">Encrypt All or a Subset of Context Headers</a>
          </h4>
<p id="section-4.1.1-1">The solution allows encrypting all or a subset of NSH Context
          Headers by Classifiers, NSH-aware SFs, and SFC proxies.<a href="#section-4.1.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1.1-2">As depicted in Table 2, SFFs are not involved in data
          encryption.<a href="#section-4.1.1-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.1.1-3">
<pre>   +-----------------+------------------------------+------------------+
   | Data Plane      | Base and Service Path        | Context Header   |
   | Element         | Headers Encryption           | Encryption       |
   +-----------------+------------------------------+------------------+
   | Classifier      | No                           | Yes              |
   | SFF             | No                           | No               |
   | NSH-aware SF    | No                           | Yes              |
   | SFC Proxy       | No                           | Yes              |
   | NSH-unaware SF  | No                           | No               |
   +-----------------+------------------------------+------------------+

     Table 2: Encryption Function Supported by SFC Data Plane Elements</pre><a href="#section-4.1.1-3" class="pilcrow">¶</a>
</div>
<p id="section-4.1.1-4">Classifier(s), NSH-aware SFs, and SFC proxies are instructed with
          the set of Context Headers (privacy-sensitive metadata, typically)
          that must be encrypted. Encryption keying material is only provided
          to these SFC data plane elements.<a href="#section-4.1.1-4" class="pilcrow">¶</a></p>
<p id="section-4.1.1-5">The control plane may indicate the set of SFC data plane elements
          that are entitled to supply a given Context Header (e.g., in
          reference to their identifiers as assigned within the SFC-enabled
          domain). It is out of the scope of this document to elaborate on how
          such instructions are provided to the appropriate SFC data plane
          elements, nor to detail the structure used to store the
          instructions.<a href="#section-4.1.1-5" class="pilcrow">¶</a></p>
<p id="section-4.1.1-6">The Service Path Header (Section 2 of <span>[<a href="#RFC8300" class="xref">RFC8300</a>]</span>) is not encrypted because SFFs use Service
          Index (SI) in conjunction with Service Path Identifier (SPI) for
          determining the next SF in the path.<a href="#section-4.1.1-6" class="pilcrow">¶</a></p>
</section>
<section id="section-4.1.2">
          <h4 id="name-integrity-protection">
<a href="#section-4.1.2" class="section-number selfRef">4.1.2. </a><a href="#name-integrity-protection" class="section-name selfRef">Integrity Protection</a>
          </h4>
<p id="section-4.1.2-1">The solution provides integrity protection for the NSH data. Two
          levels of assurance (LoAs) are supported.<a href="#section-4.1.2-1" class="pilcrow">¶</a></p>
<p id="section-4.1.2-2">The first level of assurance is where all NSH data except the
          Base Header are integrity protected (<a href="#first" class="xref">Figure 1</a>).
          In this case, the NSH imposer may be a Classifier, an NSH-aware SF,
          or an SFC Proxy. SFFs are not provided with authentication material.
          Further details are discussed in <a href="#enc1" class="xref">Section 5.1</a>.<a href="#section-4.1.2-2" class="pilcrow">¶</a></p>
<span id="name-first-level-of-assurance"></span><div id="first">
<figure id="figure-1">
            <div class="artwork art-text alignCenter" id="section-4.1.2-3.1">
<pre>   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                Transport Encapsulation                |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+...
   |                Base Header                            |  |
+-&gt;+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  N
|  |                Service Path Header                    |  S
|  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  H
|  |                Context Header(s)                      |  |
|  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+...
|  |                Original Packet                        |
+-&gt;+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|
+------Scope of integrity protected data
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-first-level-of-assurance" class="selfRef">First Level of Assurance</a>
            </figcaption></figure>
</div>
<p id="section-4.1.2-4">The second level of assurance is where all NSH data, including
          the Base Header, are integrity protected (<a href="#sec" class="xref">Figure 2</a>). In this case, the NSH imposer may be a
          Classifier, an NSH-aware SF, an SFF, or an SFC Proxy. Further
          details are provided in <a href="#enc2" class="xref">Section 5.2</a>.<a href="#section-4.1.2-4" class="pilcrow">¶</a></p>
<span id="name-second-level-of-assurance"></span><div id="sec">
<figure id="figure-2">
            <div class="artwork art-text alignCenter" id="section-4.1.2-5.1">
<pre>   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                Transport Encapsulation                |
+-&gt;+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+...
|  |                Base Header                            |  |
|  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  N
|  |                Service Path Header                    |  S
|  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  H
|  |                Context Header(s)                      |  |
|  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+...
|  |                Original Packet                        |
+-&gt;+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|
+----Scope of integrity protected data

</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-second-level-of-assurance" class="selfRef">Second Level of Assurance</a>
            </figcaption></figure>
</div>
<p id="section-4.1.2-6">The integrity protection scope is explicitly signaled to
          NSH-aware SFs, SFFs, and SFC proxies in the NSH by means of a
          dedicated MD Type (<a href="#new" class="xref">Section 5</a>).<a href="#section-4.1.2-6" class="pilcrow">¶</a></p>
<p id="section-4.1.2-7">In both levels of assurance, the Context Headers and the packet
          on which the NSH is imposed are subject to integrity protection.<a href="#section-4.1.2-7" class="pilcrow">¶</a></p>
<p id="section-4.1.2-8">Table 3 classifies the data plane elements as being involved in
          providing integrity protection for the NSH or not.<a href="#section-4.1.2-8" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.1.2-9">
<pre>         +--------------------+----------------------------------+
         | Data Plane Element | Integrity Protection             |
         +--------------------+----------------------------------+
         | Classifier         | Yes                              |
         | SFF                | No (first LoA); Yes (second LoA) |
         | NSH-aware SF       | Yes                              |
         | SFC Proxy          | Yes                              |
         | NSH-unaware SF     | No                               |
         +--------------------+----------------------------------+

    Table 3: Integrity Protection Supported by SFC Data Plane Elements</pre><a href="#section-4.1.2-9" class="pilcrow">¶</a>
</div>
</section>
</section>
<section id="section-4.2">
        <h3 id="name-one-secret-key-two-security">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-one-secret-key-two-security" class="section-name selfRef">One Secret Key, Two Security Services</a>
        </h3>
<p id="section-4.2-1">The Authenticated Encryption with Associated Data (AEAD) interface
        defined in Section 5 of <span>[<a href="#RFC5116" class="xref">RFC5116</a>]</span> is used to
        encrypt the Context Headers that carry sensitive metadata and to
        provide integrity protection for the encrypted Context Headers.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">The secondary keys MAC_KEY and ENC_KEY are generated from the input
        secret key (K) as follows; each of these two keys is an octet
        string:<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.2-3">
          <dt id="section-4.2-3.1">MAC_KEY:</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-3.2">consists of the initial MAC_KEY_LEN octets
            of K, in order. The MAC_KEY is used for calculating the message
            integrity of the NSH data. In other words, the integrity
            protection provided by the cryptographic mechanism is extended to
            also provide protection for the unencrypted Context Headers and
            the packet on which the NSH is imposed.<a href="#section-4.2-3.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-3.3">ENC_KEY:</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-3.4">consists of the final ENC_KEY_LEN octets of
            K, in order. The ENC_KEY is used as the symmetric encryption key
            for encrypting the Context Headers.<a href="#section-4.2-3.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.2-4">The Hashed Message Authentication Mode (HMAC) algorithm discussed
        in <span>[<a href="#RFC4868" class="xref">RFC4868</a>]</span> is used to protect the integrity of
        the NSH data. The algorithm for implementing and validating HMACs is
        provided in <span>[<a href="#RFC2104" class="xref">RFC2104</a>]</span>.<a href="#section-4.2-4" class="pilcrow">¶</a></p>
<p id="section-4.2-5">The advantage of using both AEAD and HMAC algorithms (instead of
        just AEAD) is that NSH-aware SFs and SFC proxies only need to
        re-compute the message integrity of the NSH data after decrementing
        the Service Index (SI) and do not have to re-compute the ciphertext.
        The other advantage is that SFFs do not have access to the ENC_KEY and
        cannot act on the encrypted Context Headers and (in the case of the
        second level of assurance) SFFs do have access to the MAC_KEY.
        Similarly, an NSH-aware SF or SFC Proxy not allowed to decrypt the
        Context Headers will not have access to the ENC_KEY.<a href="#section-4.2-5" class="pilcrow">¶</a></p>
<p id="section-4.2-6">The authenticated encryption algorithm or HMAC algorithm to be used
        by SFC data plane elements is typically controlled using the SFC
        control plane. Mandatory to implement authenticated encryption and
        HMAC algorithms are listed in <a href="#mti" class="xref">Section 4.3</a>.<a href="#section-4.2-6" class="pilcrow">¶</a></p>
<p id="section-4.2-7">The authenticated encryption process takes four inputs, each of
        which is an octet string: a secret key (ENC_KEY, referred to as K in
        <span>[<a href="#RFC5116" class="xref">RFC5116</a>]</span>), a plaintext (P), associated data (A)
        (which contains the data to be authenticated, but not encrypted), and
        a nonce (N). A ciphertext (C) is generated as an output as discussed
        in Section 2.1 of <span>[<a href="#RFC5116" class="xref">RFC5116</a>]</span>.<a href="#section-4.2-7" class="pilcrow">¶</a></p>
<p id="section-4.2-8">In order to decrypt and verify, the cipher takes as input ENC_KEY,
        N, A, and C. The output is either the plaintext or an error indicating
        that the decryption failed as described in Section 2.2 of <span>[<a href="#RFC5116" class="xref">RFC5116</a>]</span>.<a href="#section-4.2-8" class="pilcrow">¶</a></p>
</section>
<div id="mti">
<section id="section-4.3">
        <h3 id="name-mandatory-to-implement-auth">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-mandatory-to-implement-auth" class="section-name selfRef">Mandatory-to-Implement Authenticated Encryption and HMAC Algorithms</a>
        </h3>
<p id="section-4.3-1">Classifiers, NSH-aware SFs, and SFC proxies MUST implement the
        AES_128_GCM <span>[<a href="#GCM" class="xref">GCM</a>]</span><span>[<a href="#RFC5116" class="xref">RFC5116</a>]</span>
        algorithm and SHOULD implement the AES_192_GCM and AES_256_GCM
        algorithms.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">Classifiers, NSH-aware SFs, and SFC proxies MUST implement the
        HMAC- SHA-256-128 algorithm and SHOULD implement the HMAC-SHA-384-192
        and HMAC-SHA-512-256 algorithms.<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<p id="section-4.3-3">SFFs MAY implement the aforementioned cipher suites and HMAC
        algorithms.<a href="#section-4.3-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.3-4">
          <dt id="section-4.3-4.1">Note:</dt>
          <dd style="margin-left: 1.5em" id="section-4.3-4.2">The use of AES_128_CBC_HMAC_SHA_256 algorithm
            would have avoided the need for a second 128-bit authentication
            tag, but due to the nature of how Cipher Block Chaining (CBC) mode
            operates, AES_128_CBC_HMAC_SHA_256 allows for malleability of
            plaintexts. This malleability allows for attackers that know the
            MAC key but not the encryption key to make changes in the
            ciphertext and, if parts of the plaintext are known, create
            arbitrary blocks of plaintext. This specification mandates the use
            of separate AEAD and MAC protections to prevent this type of
            attack.<a href="#section-4.3-4.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="kms">
<section id="section-4.4">
        <h3 id="name-key-management">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-key-management" class="section-name selfRef">Key Management</a>
        </h3>
<p id="section-4.4-1">The procedure for the allocation/provisioning of secret keys (K)
        and authenticated encryption algorithm or MAC_KEY and HMAC algorithm
        is outside the scope of this specification. As such, this
        specification does not mandate the support of any specific
        mechanism.<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<p id="section-4.4-2">The document does not assume nor preclude the following:<a href="#section-4.4-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4-3.1">The same keying material is used for all the service functions
            used within an SFC-enabled domain.<a href="#section-4.4-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.4-3.2">Distinct keying material is used per SFP by all involved SFC
            data path elements.<a href="#section-4.4-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.4-3.3">Per-tenant keys are used.<a href="#section-4.4-3.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.4-4">In order to accommodate deployments relying upon keying material
        per SFC/SFP and also the need to update keys after encrypting NSH data
        for a certain amount of time, this document uses key identifiers to
        unambiguously identify the appropriate keying material and associated
        algorithms for MAC and encryption. This use of in-band identifiers
        addresses the problem of synchronization of keying material.<a href="#section-4.4-4" class="pilcrow">¶</a></p>
<p id="section-4.4-5">Additional information on manual vs. automated key management and
        when one should be used over the other can be found in <span>[<a href="#RFC4107" class="xref">RFC4107</a>]</span>.<a href="#section-4.4-5" class="pilcrow">¶</a></p>
<p id="section-4.4-6">The risk involved in using a group-shared symmetric key increases
        with the size of the group to which it is shared. Additional security
        issues are discussed in <a href="#Security" class="xref">Section 9</a>.<a href="#section-4.4-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="newch">
<section id="section-4.5">
        <h3 id="name-new-nsh-variable-length-con">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-new-nsh-variable-length-con" class="section-name selfRef">New NSH Variable-Length Context Headers</a>
        </h3>
<p id="section-4.5-1">New NSH Variable-Length Context Headers are defined in <a href="#new" class="xref">Section 5</a> for NSH data integrity protection and,
        optionally, encryption of Context Headers carrying sensitive metadata.
        Concretely, an NSH imposer includes (1) the key identifier to identify
        the keying material, (2) the timestamp to protect against replay
        attacks (<a href="#time" class="xref">Section 7.4</a>), and (3) the Message
        Authentication Code (MAC) for the target NSH data (depending on the
        integrity protection scope) calculated using the MAC_KEY and
        optionally Context Headers encrypted using ENC_KEY.<a href="#section-4.5-1" class="pilcrow">¶</a></p>
<p id="section-4.5-2">An SFC data plane element that needs to check the integrity of the
        NSH data uses MAC_KEY and the HMAC algorithm for the key identifier
        being carried in the NSH.<a href="#section-4.5-2" class="pilcrow">¶</a></p>
<p id="section-4.5-3">An NSH-aware SF or SFC Proxy that needs to decrypt some Context
        Headers uses ENC_KEY and the decryption algorithm for the key
        identifier being carried in the NSH.<a href="#section-4.5-3" class="pilcrow">¶</a></p>
<p id="section-4.5-4"><a href="#prorules" class="xref">Section 7</a> specifies the detailed
        procedure.<a href="#section-4.5-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="nsh-in-nsh">
<section id="section-4.6">
        <h3 id="name-encapsulation-of-nsh-within">
<a href="#section-4.6" class="section-number selfRef">4.6. </a><a href="#name-encapsulation-of-nsh-within" class="section-name selfRef">Encapsulation of NSH within NSH</a>
        </h3>
<p id="section-4.6-1">As discussed in Section 3 of <span>[<a href="#RFC8459" class="xref">RFC8459</a>]</span>, an
        SFC-enabled domain (called, upper-level domain) may be decomposed into
        many sub-domains (called, lower-level domains). In order to avoid
        maintaining state to restore back upper-level NSH information at the
        boundaries of lower-level domains, two NSH levels are used: an
        Upper-NSH which is imposed at the boundaries of the upper-level domain
        and a Lower-NSH that is pushed by the Classifier of a lower-level
        domain in front of the original NSH (<a href="#nest" class="xref">Figure 3</a>). As
        such, the Upper-NSH information is carried along the lower-level chain
        without modification. The packet is forwarded in the top-level domain
        according to the Upper-NSH, while it is forwarded according to the
        Lower-NSH in a lower-level domain.<a href="#section-4.6-1" class="pilcrow">¶</a></p>
<span id="name-encapsulation-of-nsh-within-"></span><div id="nest">
<figure id="figure-3">
          <div class="artwork art-text alignCenter" id="section-4.6-2.1">
<pre>   +---------------------------------+
   |     Transport Encapsulation     |
+-&gt;+---------------------------------+
|  |        Lower-NSH Header         |
|  +---------------------------------+
|  |        Upper-NSH Header         |
|  +---------------------------------+
|  |          Original Packet        |
+-&gt;+---------------------------------+
|
|
+----Scope of NSH security protection
     provided by a lower-level domain
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-encapsulation-of-nsh-within-" class="selfRef">Encapsulation of NSH within NSH</a>
          </figcaption></figure>
</div>
<p id="section-4.6-3">SFC data plane elements of a lower-level domain include the
        Upper-NSH when computing the MAC.<a href="#section-4.6-3" class="pilcrow">¶</a></p>
<p id="section-4.6-4">Keying material used at the upper-level domain SHOULD NOT be the
        same as the one used by a lower-level domain.<a href="#section-4.6-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="new">
<section id="section-5">
      <h2 id="name-new-nsh-variable-length-cont">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-new-nsh-variable-length-cont" class="section-name selfRef">New NSH Variable-Length Context Headers</a>
      </h2>
<p id="section-5-1">This section specifies the format of new Variable-Length Context
      headers that are used for NSH integrity protection and, optionally,
      Context Headers encryption.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">In particular, this section defines two "MAC and Encrypted Metadata"
      Context Headers; each having specific deployment constraints. Unlike
      <a href="#enc1" class="xref">Section 5.1</a>, the level of assurance provided in <a href="#enc2" class="xref">Section 5.2</a> requires sharing MAC_KEY with SFFs. Both Context
      headers have the same format as shown in <a href="#mac" class="xref">Figure 4</a>.<a href="#section-5-2" class="pilcrow">¶</a></p>
<span id="name-mac-and-encrypted-metadata-"></span><div id="mac">
<figure id="figure-4">
        <div class="artwork art-text alignCenter" id="section-5-3.1">
<pre>        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |          Metadata Class       |      Type     |U|    Length   |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       | Key Id Len  |         Key Identifier (Variable)               ~
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       ~                      Timestamp (8 bytes)                      ~
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       | Nonce Length  |           Nonce  (Variable)                   ~
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |     Message Authentication Code and optional Encrypted        |
       ~                  Context Headers (Variable)                   ~
       |                                                               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-mac-and-encrypted-metadata-" class="selfRef">MAC and Encrypted Metadata Context Header</a>
        </figcaption></figure>
</div>
<p id="section-5-4">The "MAC and Encrypted Metadata" Context Headers are padded out to a
      multiple of 4 bytes as per Section 2.2 of <span>[<a href="#RFC8300" class="xref">RFC8300</a>]</span>. The "MAC and Encrypted Metadata" Context
      Header, if included, MUST always be the last Context Header.<a href="#section-5-4" class="pilcrow">¶</a></p>
<div id="enc1">
<section id="section-5.1">
        <h3 id="name-mac1-context-header">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-mac1-context-header" class="section-name selfRef">MAC#1 Context Header</a>
        </h3>
<p id="section-5.1-1">MAC#1 Context Header is a variable-length Context Header that
        carries the Message Authentication Code (MAC) for the Service Path
        Header, Context Headers, and the inner packet on which NSH is imposed,
        calculated using MAC_KEY, and optionally Context Headers encrypted
        using ENC_KEY. The scope of the integrity protection provided by this
        Context Header is depicted in <a href="#scope1" class="xref">Figure 5</a>.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">This MAC scheme does not require sharing MAC_KEY with SFFs. It does
        not require to re-compute the MAC by each SFF because of TTL
        processing. <a href="#mac1" class="xref">Section 9.1</a> discusses the possible threat
        associated with this level of assurance.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<span id="name-scope-of-mac1"></span><div id="scope1">
<figure id="figure-5">
          <div class="artwork art-text alignCenter" id="section-5.1-3.1">
<pre>    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |Ver|O|U|    TTL    |   Length  |U|U|U|U|MD Type| Next Protocol |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+&lt;--+
   |          Service Path Identifier              | Service Index |   |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+   |
   ~       Variable-Length Unencrypted Context Headers  (opt.)     ~   |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+   |
   |          Metadata Class       |      Type     |U|    Length   |   |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+   |
   | Key Id Len  |         Key Identifier (Variable)               ~   |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+   |
   ~                      Timestamp (8 bytes)                      ~   |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+   |
   | Nonce Length  |           Nonce  (Variable)                   ~   |
+-&gt;+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+   |
|  ~                Encrypted Context Headers (opt.)               ~   |
+-&gt;+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+   |
|  ~                 Message Authentication Code                   ~   |
|  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+   |
|  |                                                               |   |
|  ~               Inner Packet on which NSH is imposed            ~   |
|  |                                                               |   |
|  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+&lt;--|
|                                                                      |
|                                       Integrity Protection Scope ----+
+----Encrypted Data
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-scope-of-mac1" class="selfRef">Scope of MAC#1</a>
          </figcaption></figure>
</div>
<p id="section-5.1-4"></p>
<p id="section-5.1-5">In reference to <a href="#mac" class="xref">Figure 4</a>, the description of the
        fields is as follows:<a href="#section-5.1-5" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.1-6">
          <dt id="section-5.1-6.1">Metadata Class:</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-6.2">MUST be set to 0x0 (Section 2.5.1 of
            <span>[<a href="#RFC8300" class="xref">RFC8300</a>]</span>).<a href="#section-5.1-6.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-6.3">Type:</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-6.4">TBD1 (See <a href="#IANA" class="xref">Section 10</a>)<a href="#section-5.1-6.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-6.5">U:</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-6.6">Unassigned bit (Section 2.5.1 of <span>[<a href="#RFC8300" class="xref">RFC8300</a>]</span>).<a href="#section-5.1-6.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-6.7">Length:</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-6.8">Indicates the length of the variable-length
            metadata, in bytes. Padding considerations are discussed in
            Section 2.5.1 of <span>[<a href="#RFC8300" class="xref">RFC8300</a>]</span>.<a href="#section-5.1-6.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-6.9">Key Id Len:</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-6.10">Variable. Carries the length of the key
            identifier, in octets.<a href="#section-5.1-6.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-6.11">Key Identifier:</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-6.12">Carries a variable-length Key
            Identifier object used to identify and deliver keys to SFC data
            plane elements. This identifier is helpful to accommodate
            deployments relying upon keying material per SFC/SFP. The key
            identifier helps in resolving the problem of synchronization of
            keying material. A single key identifier is used to lookup both
            the ENC_KEY and the MAC_KEY associated with a key, and the
            corresponding encryption and MAC algorithms used with those
            keys.<a href="#section-5.1-6.12" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-6.13">Timestamp:</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-6.14">Refer to <a href="#timef" class="xref">Section 6</a> for
            more details about the structure of this field.<a href="#section-5.1-6.14" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-6.15">Nonce Length:</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-6.16">Carries the length of the Nonce. If
            the Context Headers are only integrity protected, "Nonce Length"
            is set to zero (that is, no "Nonce" is included).<a href="#section-5.1-6.16" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-6.17">Nonce:</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-6.18">Carries the Nonce for the authenticated
            encryption operation (Section 3.1 of <span>[<a href="#RFC5116" class="xref">RFC5116</a>]</span>).<a href="#section-5.1-6.18" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-6.19">Encrypted Context Headers:</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-6.20">Carries the optional
            encrypted Context Headers.<a href="#section-5.1-6.20" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-6.21">Message Authentication Code: </dt>
          <dd style="margin-left: 1.5em" id="section-5.1-6.22">Covers the entire NSH
            data, excluding the Base header.<a href="#section-5.1-6.22" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="enc2">
<section id="section-5.2">
        <h3 id="name-mac2-context-header">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-mac2-context-header" class="section-name selfRef">MAC#2 Context Header</a>
        </h3>
<p id="section-5.2-1">MAC#2 Context Header is a variable-length Context Header that
        carries the MAC for the entire NSH data calculated using MAC_KEY and
        optionally Context Headers encrypted using ENC_KEY. The scope of the
        integrity protection provided by this Context Header is depicted in
        <a href="#scope2" class="xref">Figure 6</a>.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<span id="name-scope-of-mac2"></span><div id="scope2">
<figure id="figure-6">
          <div class="artwork art-text alignCenter" id="section-5.2-2.1">
<pre>    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+&lt;--+
   |Ver|O|U|    TTL    |   Length  |U|U|U|U|MD Type| Next Protocol |   |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+   |
   |          Service Path Identifier              | Service Index |   |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+   |
   ~       Variable-Length Unencrypted Context Headers  (opt.)     ~   |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+   |
   |          Metadata Class       |      Type     |U|    Length   |   |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+   |
   | Key Id Len  |         Key Identifier (Variable)               ~   |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+   |
   ~                      Timestamp (8 bytes)                      ~   |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+   |
   | Nonce Length  |           Nonce  (Variable)                   ~   |
+-&gt;+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+   |
|  ~                Encrypted Context Headers (opt.)               ~   |
+-&gt;+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+   |
|  ~                 Message Authentication Code                   ~   |
|  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+   |
|  |                                                               |   |
|  ~               Inner Packet on which NSH is imposed            ~   |
|  |                                                               |   |
|  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+&lt;--|
|                                                                      |
|                                       Integrity Protection Scope ----+
+----Encrypted Data
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-scope-of-mac2" class="selfRef">Scope of MAC#2</a>
          </figcaption></figure>
</div>
<p id="section-5.2-3"></p>
<p id="section-5.2-4">In reference to <a href="#mac" class="xref">Figure 4</a>, the description of the
        fields is as follows:<a href="#section-5.2-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.2-5">
          <dt id="section-5.2-5.1">Metadata Class:</dt>
          <dd style="margin-left: 1.5em" id="section-5.2-5.2">MUST be set to 0x0 (Section 2.5.1 of
            <span>[<a href="#RFC8300" class="xref">RFC8300</a>]</span>).<a href="#section-5.2-5.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.2-5.3">Type:</dt>
          <dd style="margin-left: 1.5em" id="section-5.2-5.4">TBD2 (See <a href="#IANA" class="xref">Section 10</a>)<a href="#section-5.2-5.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.2-5.5">U:</dt>
          <dd style="margin-left: 1.5em" id="section-5.2-5.6">Unassigned bit (Section 2.5.1 of <span>[<a href="#RFC8300" class="xref">RFC8300</a>]</span>).<a href="#section-5.2-5.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.2-5.7">Length:</dt>
          <dd style="margin-left: 1.5em" id="section-5.2-5.8">Indicates the length of the variable-length
            metadata, in bytes. Padding considerations are discussed in
            Section 2.5.1 of <span>[<a href="#RFC8300" class="xref">RFC8300</a>]</span>.<a href="#section-5.2-5.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.2-5.9">Key Id Len:</dt>
          <dd style="margin-left: 1.5em" id="section-5.2-5.10">See <a href="#enc1" class="xref">Section 5.1</a>.<a href="#section-5.2-5.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.2-5.11">Key Identifier:</dt>
          <dd style="margin-left: 1.5em" id="section-5.2-5.12">See <a href="#enc1" class="xref">Section 5.1</a>.<a href="#section-5.2-5.12" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.2-5.13">Timestamp:</dt>
          <dd style="margin-left: 1.5em" id="section-5.2-5.14">See <a href="#timef" class="xref">Section 6</a>.<a href="#section-5.2-5.14" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.2-5.15">Nonce Length:</dt>
          <dd style="margin-left: 1.5em" id="section-5.2-5.16">See <a href="#enc1" class="xref">Section 5.1</a>.<a href="#section-5.2-5.16" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.2-5.17">Nonce:</dt>
          <dd style="margin-left: 1.5em" id="section-5.2-5.18">See <a href="#enc1" class="xref">Section 5.1</a>.<a href="#section-5.2-5.18" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.2-5.19">Encrypted Context Headers:</dt>
          <dd style="margin-left: 1.5em" id="section-5.2-5.20">Carries the optional
            encrypted Context Headers.<a href="#section-5.2-5.20" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.2-5.21">Message Authentication Code:</dt>
          <dd style="margin-left: 1.5em" id="section-5.2-5.22">Covers the entire NSH
            data.<a href="#section-5.2-5.22" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="timef">
<section id="section-6">
      <h2 id="name-timestamp-format">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-timestamp-format" class="section-name selfRef">Timestamp Format</a>
      </h2>
<p id="section-6-1">This section follows the template provided in Section 3 of <span>[<a href="#RFC8877" class="xref">RFC8877</a>]</span>.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">The format of the Timestamp field introduced in <a href="#new" class="xref">Section 5</a> is depicted in <a href="#tf" class="xref">Figure 7</a>.<a href="#section-6-2" class="pilcrow">¶</a></p>
<span id="name-timestamp-field-format"></span><div id="tf">
<figure id="figure-7">
        <div class="artwork art-text alignCenter" id="section-6-3.1">
<pre>        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                            Seconds                            |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                           Fraction                            |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</pre>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-timestamp-field-format" class="selfRef">Timestamp Field Format</a>
        </figcaption></figure>
</div>
<p id="section-6-4">Timestamp field format:<a href="#section-6-4" class="pilcrow">¶</a></p>
<ul class="ulEmpty normal">
<li class="ulEmpty normal" id="section-6-5.1">Seconds: specifies the integer portion of the number of seconds
          since the epoch.<a href="#section-6-5.1" class="pilcrow">¶</a>
</li>
        <li class="ulEmpty normal" id="section-6-5.2">+ Size: 32 bits.<a href="#section-6-5.2" class="pilcrow">¶</a>
</li>
        <li class="ulEmpty normal" id="section-6-5.3">+ Units: seconds.<a href="#section-6-5.3" class="pilcrow">¶</a>
</li>
        <li class="ulEmpty normal" id="section-6-5.4">Fraction: specifies the fractional portion of the number of
          seconds since the epoch.<a href="#section-6-5.4" class="pilcrow">¶</a>
</li>
        <li class="ulEmpty normal" id="section-6-5.5">+ Size: 32 bits.<a href="#section-6-5.5" class="pilcrow">¶</a>
</li>
        <li class="ulEmpty normal" id="section-6-5.6">+ Units: the unit is 2^(-32) seconds, which is roughly equal to
          233 picoseconds.<a href="#section-6-5.6" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-6-6">Epoch:<a href="#section-6-6" class="pilcrow">¶</a></p>
<ul class="ulEmpty normal">
<li class="ulEmpty normal" id="section-6-7.1">The epoch is 1970-01-01T00:00 in UTC time. Note this epoch value
          is different from the one used in Section 6 of <span>[<a href="#RFC5905" class="xref">RFC5905</a>]</span> (which will wrap around in 2036).<a href="#section-6-7.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-6-8">Leap seconds:<a href="#section-6-8" class="pilcrow">¶</a></p>
<ul class="ulEmpty normal">
<li class="ulEmpty normal" id="section-6-9.1">This timestamp format is affected by leap seconds. The timestamp
          represents the number of seconds elapsed since the epoch minus the
          number of leap seconds.<a href="#section-6-9.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-6-10">Resolution:<a href="#section-6-10" class="pilcrow">¶</a></p>
<ul class="ulEmpty normal">
<li class="ulEmpty normal" id="section-6-11.1">The resolution is 2^(-32) seconds.<a href="#section-6-11.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-6-12">Wraparound:<a href="#section-6-12" class="pilcrow">¶</a></p>
<ul class="ulEmpty normal">
<li class="ulEmpty normal" id="section-6-13.1">This time format wraps around every 2^32 seconds, which is
          roughly 136 years. The next wraparound will occur in the year
          2106.<a href="#section-6-13.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-6-14">Synchronization aspects:<a href="#section-6-14" class="pilcrow">¶</a></p>
<ul class="ulEmpty normal">
<li class="ulEmpty normal" id="section-6-15.1">It is assumed that SFC data plane elements are synchronized to
          UTC using a synchronization mechanism that is outside the scope of
          this document. In typical deployments, SFC data plane elements use
          NTP <span>[<a href="#RFC5905" class="xref">RFC5905</a>]</span> for synchronization. Thus, the
          timestamp may be derived from the NTP-synchronized clock, allowing
          the timestamp to be measured with respect to the clock of an NTP
          server. Since this time format is specified in terms of UTC, it is
          affected by leap seconds (in a manner analogous to the NTP time
          format, which is similar). Therefore, the value of a timestamp
          during or slightly after a leap second may be temporarily
          inaccurate.<a href="#section-6-15.1" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="prorules">
<section id="section-7">
      <h2 id="name-processing-rules">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-processing-rules" class="section-name selfRef">Processing Rules</a>
      </h2>
<p id="section-7-1">The following subsections describe the processing rules for integrity
      protected NSH and optionally encrypted Context Headers.<a href="#section-7-1" class="pilcrow">¶</a></p>
<div id="gen">
<section id="section-7.1">
        <h3 id="name-generic-behavior">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-generic-behavior" class="section-name selfRef">Generic Behavior</a>
        </h3>
<p id="section-7.1-1">This document adheres to the recommendations in Section 8.1 of
        <span>[<a href="#RFC8300" class="xref">RFC8300</a>]</span> for handling the Context Headers at
        both ingress and egress SFC boundary nodes (i.e., to strip the entire
        NSH, including Context Headers).<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">Failures of a classifier to inject the Context Headers defined in
        this document SHOULD be logged locally while a notification alarm MAY
        be sent to an SFC control element. Failures of an NSH-aware node to
        validate the integrity of the NSH data MUST cause that packet to be
        discarded while a notification alarm MAY be sent to an SFC control
        element. The details of sending notification alarms (i.e., the
        parameters that affect the transmission of the notification alarms
        depending on the information in the context header such as frequency,
        thresholds, and content in the alarm) SHOULD be configurable.<a href="#section-7.1-2" class="pilcrow">¶</a></p>
<p id="section-7.1-3">NSH-aware SFs and SFC proxies MAY be instructed to strip some
        encrypted Context Headers from the packet or to pass the data to the
        next SF in the service function chain after processing the content of
        the Context Headers. If no instruction is provided, the default
        behavior for intermediary NSH-aware nodes is to maintain such Context
        Headers so that the information can be passed to next NSH-aware hops.
        NSH-aware SFs and SFC proxies MUST re-apply the integrity protection
        if any modification is made to the Context Headers (e.g., strip a
        Context Header, update the content of an existing Context Header,
        insert a new Context Header).<a href="#section-7.1-3" class="pilcrow">¶</a></p>
<p id="section-7.1-4">An NSH-aware SF or SFC Proxy that is not allowed to decrypt any
        Context Headers MUST NOT be given access to the ENC_KEY.<a href="#section-7.1-4" class="pilcrow">¶</a></p>
<p id="section-7.1-5">Otherwise, an NSH-aware SF or SFC Proxy that receives encrypted
        Context Headers, for which it is not allowed to consume a specific
        Context Header it decrypts (but consumes others), MUST keep that
        Context Header unaltered when forwarding the packet upstream.<a href="#section-7.1-5" class="pilcrow">¶</a></p>
<p id="section-7.1-6">Only one instance of "MAC and Encrypted Metadata" Context Header
        (<a href="#new" class="xref">Section 5</a>) is allowed in an NSH level. If multiple
        instances of "MAC and Encrypted Metadata" Context Header are included
        in an NSH level, the SFC data plane element MUST process the first
        instance and ignore subsequent instances, and MAY log or increase a
        counter for this event as per Section 2.5.1 of <span>[<a href="#RFC8300" class="xref">RFC8300</a>]</span>. If NSH-in-NSH is used (<a href="#nsh-in-nsh" class="xref">Section 4.6</a>), distinct LoAs may be used for each NSH
        level.<a href="#section-7.1-6" class="pilcrow">¶</a></p>
<p id="section-7.1-7">MTU and fragmentation considerations are discussed in <a href="#MTU" class="xref">Section 8</a>.<a href="#section-7.1-7" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-7.2">
        <h3 id="name-mac-nsh-data-generation">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-mac-nsh-data-generation" class="section-name selfRef">MAC NSH Data Generation</a>
        </h3>
<p id="section-7.2-1">After performing any Context Header encryption, the HMAC algorithm
        discussed in <span>[<a href="#RFC4868" class="xref">RFC4868</a>]</span> is used to integrity
        protect the target NSH data. An NSH imposer inserts a "MAC and
        Encrypted Metadata" Context Header for integrity protection (<a href="#new" class="xref">Section 5</a>).<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<p id="section-7.2-2">The NSH imposer sets the MAC field to zero and then computes the
        message integrity for the target NSH data (depending on the integrity
        protection scope discussed in <a href="#new" class="xref">Section 5</a>) using
        MAC_KEY and HMAC algorithm. It inserts the computed digest in the MAC
        field of the "MAC and Encrypted Metadata" Context Header. The length
        of the MAC is decided by the HMAC algorithm adopted for the particular
        key identifier.<a href="#section-7.2-2" class="pilcrow">¶</a></p>
<p id="section-7.2-3">The Message Authentication Code (T) computation process for the
        target NSH data with HMAC-SHA-256-128() can be illustrated as
        follows:<a href="#section-7.2-3" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-7.2-4">
<pre>      T = HMAC-SHA-256-128(MAC_KEY, target NSH data)
</pre><a href="#section-7.2-4" class="pilcrow">¶</a>
</div>
<p id="section-7.2-5"></p>
<p id="section-7.2-6">An entity in the SFP that updates the NSH MUST follow the above
        behavior to maintain message integrity of the NSH for subsequent
        validations.<a href="#section-7.2-6" class="pilcrow">¶</a></p>
</section>
<section id="section-7.3">
        <h3 id="name-encrypted-nsh-metadata-gene">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-encrypted-nsh-metadata-gene" class="section-name selfRef">Encrypted NSH Metadata Generation</a>
        </h3>
<p id="section-7.3-1">An NSH imposer can encrypt Context Headers carrying sensitive
        metadata, i.e., encrypted and unencrypted metadata may be carried
        simultaneously in the same NSH packet (Sections <a href="#scope1" class="xref">5</a> and <a href="#scope2" class="xref">6</a>).<a href="#section-7.3-1" class="pilcrow">¶</a></p>
<p id="section-7.3-2">In order to prevent pervasive monitoring <span>[<a href="#RFC7258" class="xref">RFC7258</a>]</span>, it is RECOMMENDED to encrypt all Context
        Headers. All Context Headers carrying privacy-sensitive metadata MUST
        be encrypted; by doing so, privacy-sensitive metadata is not revealed
        to attackers. Privacy specific threats are discussed in Section 5.2 of
        <span>[<a href="#RFC6973" class="xref">RFC6973</a>]</span>.<a href="#section-7.3-2" class="pilcrow">¶</a></p>
<p id="section-7.3-3">Using the secret key (ENC_KEY) and authenticated encryption
        algorithm, the NSH imposer encrypts the Context Headers (as set, for
        example, in <a href="#req" class="xref">Section 3</a>) and inserts the resulting
        payload in the "MAC and Encrypted Metadata" Context Header (<a href="#new" class="xref">Section 5</a>). The additional authenticated data input to the
        AEAD function is a zero-length byte string. The entire Context Header
        carrying a sensitive metadata is encrypted (that is, including the MD
        Class, Type, Length, and associated metadata of each Context
        Header).<a href="#section-7.3-3" class="pilcrow">¶</a></p>
<p id="section-7.3-4">More details about the exact encryption procedure are provided in
        Section 2.1 of <span>[<a href="#RFC5116" class="xref">RFC5116</a>]</span>. In this case, the
        associated data (A) input is zero-length for AES-GCM.<a href="#section-7.3-4" class="pilcrow">¶</a></p>
<p id="section-7.3-5">An authorized entity in the SFP that updates the content of an
        encrypted Context Header or needs to add a new encrypted Context
        Header MUST also follow the aforementioned behavior.<a href="#section-7.3-5" class="pilcrow">¶</a></p>
</section>
<div id="time">
<section id="section-7.4">
        <h3 id="name-timestamp-for-replay-attack">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-timestamp-for-replay-attack" class="section-name selfRef">Timestamp for Replay Attack Prevention</a>
        </h3>
<p id="section-7.4-1">The Timestamp imposed by an initial Classifier is left untouched
        along an SFP. However, it can be updated when reclassification occurs
        (Section 4.8 of <span>[<a href="#RFC7665" class="xref">RFC7665</a>]</span>). The same
        considerations for setting the Timestamp are followed in both initial
        classification and reclassification (<a href="#timef" class="xref">Section 6</a>).<a href="#section-7.4-1" class="pilcrow">¶</a></p>
<p id="section-7.4-2">The received NSH is accepted by an NSH-aware node if the Timestamp
        (TS) in the NSH is recent enough to the reception time of the NSH
        (TSrt). The following formula is used for this check:<a href="#section-7.4-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-7.4-3">
<pre>          -Delta &lt; (TSrt - TS) &lt; +Delta
</pre><a href="#section-7.4-3" class="pilcrow">¶</a>
</div>
<p id="section-7.4-4">The Delta interval is a configurable parameter. The default value
        for the allowed Delta is 2 seconds. Special care should be taken when
        setting very low Delta values as this may lead to dropping legitimate
        traffic. If the timestamp is not within the boundaries, then the SFC
        data plane element receiving such packet MUST discard the NSH
        message.<a href="#section-7.4-4" class="pilcrow">¶</a></p>
<p id="section-7.4-5">Replay attacks within the Delta window may be detected by an
        NSH-aware node by recording a unique value derived from the packet,
        for example, a unique value from the MAC field value. Such an
        NSH-aware node will detect and reject duplicates. If for legitimate
        service reasons, some flows have to be duplicated but still share
        portion of an SFP with the original flow, legitimate duplicate packets
        will be tagged by NSH-aware nodes involved in that segment as replay
        packets unless sufficient entropy is added to the duplicate packet.
        How such an entropy is added is implementation-specific.<a href="#section-7.4-5" class="pilcrow">¶</a></p>
<ul class="ulEmpty normal">
<li class="ulEmpty normal" id="section-7.4-6.1">Note: Within the timestamp delta window, defining a sequence
            number to protect against replay attacks may be considered. In
            such mode, NSH-aware nodes must discard packets with duplicate
            sequence numbers within the timestamp delta window. However, in
            deployments with several instances of the same SF (e.g., cluster
            or load-balanced SFs), a mechanism to coordinate among those
            instances to discard duplicate sequence numbers is required.
            Because the coordination mechanism to comply with this requirement
            is service-specific, this document does not include this
            protection.<a href="#section-7.4-6.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-7.4-7">All SFC data plane elements must be synchronized among themselves.
        These elements may be synchronized to a global reference time.<a href="#section-7.4-7" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-7.5">
        <h3 id="name-nsh-data-validation">
<a href="#section-7.5" class="section-number selfRef">7.5. </a><a href="#name-nsh-data-validation" class="section-name selfRef">NSH Data Validation</a>
        </h3>
<p id="section-7.5-1">When an SFC data plane element that conforms to this specification
        needs to check the validity of the NSH data, it MUST ensure that a
        "MAC and Encrypted Metadata" Context Header is included in a received
        NSH packet. The imposer MUST silently discard the packet and MUST log
        an error at least once per the SPI if at least one of the following is
        observed:<a href="#section-7.5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.5-2.1">the "MAC and Encrypted Metadata" Context Header is missing,<a href="#section-7.5-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.5-2.2">the enclosed key identifier is unknown or invalid (e.g., the
            corresponding key expired),<a href="#section-7.5-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.5-2.3">the timestamp is invalid (<a href="#time" class="xref">Section 7.4</a>).<a href="#section-7.5-2.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-7.5-3">If the timestamp check is successfully passed, the SFC data plane
        element proceeds with NSH data integrity validation. After storing the
        value of the MAC field in the "MAC and Encrypted Metadata" Context
        Header, the SFC data plane element fills the MAC field with zeros.
        Then, the SFC data plane element generates the message integrity for
        the target NSH data (depending on the integrity protection scope
        discussed in <a href="#new" class="xref">Section 5</a>) using MAC_KEY and HMAC
        algorithm. If the value of the newly generated digest is identical to
        the stored one, the SFC data plane element is certain that the NSH
        data has not been tampered and validation is therefore successful.
        Otherwise, the NSH packet MUST be discarded. The comparison of the
        computed HMAC value to the stored value MUST be done in a
        constant-time manner to thwart timing attacks.<a href="#section-7.5-3" class="pilcrow">¶</a></p>
</section>
<section id="section-7.6">
        <h3 id="name-decryption-of-nsh-metadata">
<a href="#section-7.6" class="section-number selfRef">7.6. </a><a href="#name-decryption-of-nsh-metadata" class="section-name selfRef">Decryption of NSH Metadata</a>
        </h3>
<p id="section-7.6-1">If entitled to consume a supplied encrypted Context Header, an
        NSH-aware SF or SFC Proxy decrypts metadata using (K) and decryption
        algorithm for the key identifier in the NSH.<a href="#section-7.6-1" class="pilcrow">¶</a></p>
<p id="section-7.6-2">Authenticated encryption algorithm has only a single output, either
        a plaintext or a special symbol (FAIL) that indicates that the inputs
        are not authentic (Section 2.2 of [RFC5116]).<a href="#section-7.6-2" class="pilcrow">¶</a></p>
</section>
</section>
</div>
<div id="MTU">
<section id="section-8">
      <h2 id="name-mtu-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-mtu-considerations" class="section-name selfRef">MTU Considerations</a>
      </h2>
<p id="section-8-1">The SFC architecture prescribes that additional information be added
      to packets to:<a href="#section-8-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8-2.1">Identify SFPs: this is typically the NSH Base Header and Service
          Path Header.<a href="#section-8-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-8-2.2">Carry metadata such as those defined in <a href="#new" class="xref">Section 5</a>.<a href="#section-8-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-8-2.3">Steer the traffic along the SFPs: transport encapsulation.<a href="#section-8-2.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-8-3">This added information increases the size of the packet to be carried
      along an SFP.<a href="#section-8-3" class="pilcrow">¶</a></p>
<p id="section-8-4">Aligned with Section 5 of <span>[<a href="#RFC8300" class="xref">RFC8300</a>]</span>, it is
      RECOMMENDED for network operators to increase the underlying MTU so that
      NSH traffic is forwarded within an SFC-enabled domain without
      fragmentation. The available underlying MTU should be taken into account
      by network operators when providing SFs with the required Context
      Headers to be injected per SFP and the size of the data to be carried in
      these Context Headers.<a href="#section-8-4" class="pilcrow">¶</a></p>
<p id="section-8-5">If the underlying MTU cannot be increased to accommodate the NSH
      overhead, network operators may rely upon a transport encapsulation
      protocol with the required fragmentation handling. The impact of
      activating such feature on SFFs should be carefully assessed by network
      operators (Section 5.6 of <span>[<a href="#RFC7665" class="xref">RFC7665</a>]</span>).<a href="#section-8-5" class="pilcrow">¶</a></p>
<p id="section-8-6">When dealing with MTU issues, network operators should consider the
      limitations of various tunnel mechanisms such as those discussed in
      <span>[<a href="#I-D.ietf-intarea-tunnels" class="xref">I-D.ietf-intarea-tunnels</a>]</span>.<a href="#section-8-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Security">
<section id="section-9">
      <h2 id="name-security-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-9-1">Data plane SFC-related security considerations, including privacy,
      are discussed in Section 6 of <span>[<a href="#RFC7665" class="xref">RFC7665</a>]</span> and Section
      8 of <span>[<a href="#RFC8300" class="xref">RFC8300</a>]</span>. In particular, Section 8.2.2 of
      <span>[<a href="#RFC8300" class="xref">RFC8300</a>]</span> states that attached metadata (i.e.,
      Context Headers) should be limited to that necessary for correct
      operation of the SFP. Also, that section indicates that <span>[<a href="#RFC8165" class="xref">RFC8165</a>]</span> discusses metadata considerations that
      operators can take into account when using NSH.<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">The guidelines for cryptographic key management are discussed in
      <span>[<a href="#RFC4107" class="xref">RFC4107</a>]</span>. The group key management protocol
      related security considerations discussed in Section 8 of <span>[<a href="#RFC4046" class="xref">RFC4046</a>]</span> needs to be taken into consideration.<a href="#section-9-2" class="pilcrow">¶</a></p>
<p id="section-9-3">The interaction between the SFC data plane elements and a key
      management system MUST NOT be transmitted in clear since this would
      completely destroy the security benefits of the integrity protection
      solution defined in this document.<a href="#section-9-3" class="pilcrow">¶</a></p>
<p id="section-9-4">The secret key (K) must have an expiration time assigned as the
      latest point in time before which the key may be used for integrity
      protection of NSH data and encryption of Context Headers. Prior to the
      expiration of the secret key, all participating NSH-aware nodes SHOULD
      have the control plane distribute a new key identifier and associated
      keying material so that when the secret key is expired, those nodes are
      prepared with the new secret key. This allows the NSH imposer to switch
      to the new key identifier as soon as necessary. It is RECOMMENDED that
      the next key identifier and associated keying material be distributed by
      the control plane well prior to the secret key expiration time.
      Additional guidance for users of AEAD functions about rekeying can be
      found in <span>[<a href="#I-D.irtf-cfrg-aead-limits" class="xref">I-D.irtf-cfrg-aead-limits</a>]</span>.<a href="#section-9-4" class="pilcrow">¶</a></p>
<p id="section-9-5">The security and integrity of the key-distribution mechanism is vital
      to the security of the SFC system as a whole.<a href="#section-9-5" class="pilcrow">¶</a></p>
<p id="section-9-6">NSH data are exposed to several threats:<a href="#section-9-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9-7.1">A on-path attacker modifying the NSH data.<a href="#section-9-7.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-9-7.2">Attacker spoofing the NSH data.<a href="#section-9-7.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-9-7.3">Attacker capturing and replaying the NSH data.<a href="#section-9-7.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-9-7.4">Data carried in Context Headers revealing privacy-sensitive
          information to attackers.<a href="#section-9-7.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-9-7.5">Attacker replacing the packet on which the NSH is imposed with a
          modified or bogus packet.<a href="#section-9-7.5" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-9-8">In an SFC-enabled domain where the above attacks are possible, (1)
      NSH data MUST be integrity-protected and replay-protected, and (2)
      privacy-sensitive NSH metadata MUST be encrypted for confidentiality
      preservation purposes. The Base and Service Path headers are not
      encrypted.<a href="#section-9-8" class="pilcrow">¶</a></p>
<p id="section-9-9">MACs with two levels of assurance are defined in <a href="#new" class="xref">Section 5</a>. Considerations specific to each level of assurance
      are discussed in Sections <a href="#mac1" class="xref">9.1</a>
      and <a href="#mac2" class="xref">9.2</a>.<a href="#section-9-9" class="pilcrow">¶</a></p>
<p id="section-9-10">The attacks discussed in <span>[<a href="#I-D.nguyen-sfc-security-architecture" class="xref">I-D.nguyen-sfc-security-architecture</a>]</span> are handled owing
      to the solution specified in this document, except for attacks dropping
      packets. Such attacks can be detected relying upon statistical analysis;
      such analysis is out of the scope of this document. Also, if SFFs are
      not involved in the integrity checks, a misbehaving SFF which decrements
      SI while this should be done by an SF (SF bypass attack) will be
      detected by an upstream SF because the integrity check will fail.<a href="#section-9-10" class="pilcrow">¶</a></p>
<p id="section-9-11">Some events are logged locally with notification alerts sent by
      NSH-aware nodes to a Control Element. These events SHOULD be
      rate-limited.<a href="#section-9-11" class="pilcrow">¶</a></p>
<p id="section-9-12">The solution specified in this document does not provide data origin
      authentication.<a href="#section-9-12" class="pilcrow">¶</a></p>
<p id="section-9-13">In order to detect compromised nodes, it is assumed that appropriate
      mechanisms to monitor and audit an SFC-enabled domain to detect
      misbehavior and to deter misuse are in place. Compromised nodes can thus
      be withdrawn from active service function chains using appropriate
      control plane mechanisms.<a href="#section-9-13" class="pilcrow">¶</a></p>
<div id="mac1">
<section id="section-9.1">
        <h3 id="name-mac1">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-mac1" class="section-name selfRef">MAC#1</a>
        </h3>
<p id="section-9.1-1">An active attacker can potentially modify the Base header (e.g.,
        decrement the TTL so the next SFF in the SFP discards the NSH packet).
        An active attacker can typically also drop NSH packets. As such, this
        attack is not considered an attack against the security mechanism
        specified in the document.<a href="#section-9.1-1" class="pilcrow">¶</a></p>
<p id="section-9.1-2">It is expected that specific devices in the SFC-enabled domain will
        be configured such that no device other than the classifiers (when
        reclassification is enabled), NSH-aware SFs, and SFC proxies will be
        able to update the integrity protected NSH data (<a href="#gen" class="xref">Section 7.1</a>), and also such that no device other than the
        NSH-aware SFs and SFC proxies will be able to decrypt and update the
        Context Headers carrying sensitive metadata (<a href="#gen" class="xref">Section 7.1</a>). In other words, if the NSH-aware SFs and SFC
        proxies in the SFC-enabled domain are considered fully trusted to act
        on the NSH data. Only these elements can have access to sensitive NSH
        metadata and the keying material used to integrity protect NSH data
        and encrypt Context Headers.<a href="#section-9.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="mac2">
<section id="section-9.2">
        <h3 id="name-mac2">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-mac2" class="section-name selfRef">MAC#2</a>
        </h3>
<p id="section-9.2-1">SFFs can detect whether an illegitimate node has altered the
        content of the Base header. Such messages must be discarded with
        appropriate logs and alarms generated (see <a href="#gen" class="xref">Section 7.1</a>).<a href="#section-9.2-1" class="pilcrow">¶</a></p>
<p id="section-9.2-2">Similar to <a href="#mac1" class="xref">Section 9.1</a>, no device other than the
        NSH-aware SFs and SFC proxies in the SFC-enabled domain should be able
        to decrypt and update the Context Headers carrying sensitive
        metadata.<a href="#section-9.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-9.3">
        <h3 id="name-time-synchronization">
<a href="#section-9.3" class="section-number selfRef">9.3. </a><a href="#name-time-synchronization" class="section-name selfRef">Time Synchronization</a>
        </h3>
<p id="section-9.3-1"><span>[<a href="#RFC8633" class="xref">RFC8633</a>]</span> describes best current practices to
        be considered in deployments where SFC data plane elements use NTP for
        time synchronization purposes.<a href="#section-9.3-1" class="pilcrow">¶</a></p>
<p id="section-9.3-2">Also, a mechanism to provide cryptographic security for NTP is
        specified in <span>[<a href="#RFC8915" class="xref">RFC8915</a>]</span>.<a href="#section-9.3-2" class="pilcrow">¶</a></p>
</section>
</section>
</div>
<div id="IANA">
<section id="section-10">
      <h2 id="name-iana-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-10-1">This document requests IANA to assign the following types from the
      "NSH IETF-Assigned Optional Variable-Length Metadata Types" (0x0000 IETF
      Base NSH MD Class) registry available at:
      https://www.iana.org/assignments/nsh/nsh.xhtml#optional-variable-length-metadata-types.<a href="#section-10-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignCenter" id="section-10-2">
<pre>+-------+-------------------------------+----------------+
| Value | Description                   | Reference      |
+=======+===============================+================+
| TBD1  | MAC and Encrypted Metadata #1 | [ThisDocument] |
| TBD2  | MAC and Encrypted Metadata #2 | [ThisDocument] |
+-------+-------------------------------+----------------+</pre><a href="#section-10-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<section id="section-11">
      <h2 id="name-acknowledgements">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="section-11-1">This document was edited as a follow-up to the discussion in
      IETF#104:
      https://datatracker.ietf.org/meeting/104/materials/slides-104-sfc-sfc-chair-slides-01
      (slide 7).<a href="#section-11-1" class="pilcrow">¶</a></p>
<p id="section-11-2">Thanks to Joel Halpern, Christian Jacquenet, Dirk von Hugo, Tal
      Mizrahi, Daniel Migault, Diego Lopez, Greg Mirsky, and Dhruv Dhody for
      the comments.<a href="#section-11-2" class="pilcrow">¶</a></p>
<p id="section-11-3">Many thanks to Steve Hanna for the valuable secdir review and
      Juergen Schoenwaelder for the opsdir review.<a href="#section-11-3" class="pilcrow">¶</a></p>
<p id="section-11-4">Thanks to Greg Mirsky for the Shepherd review.<a href="#section-11-4" class="pilcrow">¶</a></p>
<p id="section-11-5">Thanks to Alvaro Retana, Lars Eggert, Martin Duke, Erik Kline,
      Zaheduzzaman Sarker, Eric Vyncke, Roman Danyliw, Murray
      Kucherawy, John Scudder, and Benjamin Kaduk for the IESG review.<a href="#section-11-5" class="pilcrow">¶</a></p>
</section>
<section id="section-12">
      <h2 id="name-references">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-12.1">
        <h3 id="name-normative-references">
<a href="#section-12.1" class="section-number selfRef">12.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="GCM">[GCM]</dt>
        <dd>
<span class="refAuthor">Dworkin, M.</span>, <span class="refTitle">"Recommendation for Block Cipher Modes of Operation: Galois/Counter Mode (GCM) and GMAC"</span>, <span class="seriesInfo">NIST Special Publication 800-38D</span>, <time datetime="2007-11" class="refDate">November 2007</time>. </dd>
<dd class="break"></dd>
<dt id="RFC2104">[RFC2104]</dt>
        <dd>
<span class="refAuthor">Krawczyk, H.</span>, <span class="refAuthor">Bellare, M.</span>, and <span class="refAuthor">R. Canetti</span>, <span class="refTitle">"HMAC: Keyed-Hashing for Message Authentication"</span>, <span class="seriesInfo">RFC 2104</span>, <span class="seriesInfo">DOI 10.17487/RFC2104</span>, <time datetime="1997-02" class="refDate">February 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2104">https://www.rfc-editor.org/info/rfc2104</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4107">[RFC4107]</dt>
        <dd>
<span class="refAuthor">Bellovin, S.</span> and <span class="refAuthor">R. Housley</span>, <span class="refTitle">"Guidelines for Cryptographic Key Management"</span>, <span class="seriesInfo">BCP 107</span>, <span class="seriesInfo">RFC 4107</span>, <span class="seriesInfo">DOI 10.17487/RFC4107</span>, <time datetime="2005-06" class="refDate">June 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4107">https://www.rfc-editor.org/info/rfc4107</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4868">[RFC4868]</dt>
        <dd>
<span class="refAuthor">Kelly, S.</span> and <span class="refAuthor">S. Frankel</span>, <span class="refTitle">"Using HMAC-SHA-256, HMAC-SHA-384, and HMAC-SHA-512 with IPsec"</span>, <span class="seriesInfo">RFC 4868</span>, <span class="seriesInfo">DOI 10.17487/RFC4868</span>, <time datetime="2007-05" class="refDate">May 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4868">https://www.rfc-editor.org/info/rfc4868</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5116">[RFC5116]</dt>
        <dd>
<span class="refAuthor">McGrew, D.</span>, <span class="refTitle">"An Interface and Algorithms for Authenticated Encryption"</span>, <span class="seriesInfo">RFC 5116</span>, <span class="seriesInfo">DOI 10.17487/RFC5116</span>, <time datetime="2008-01" class="refDate">January 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5116">https://www.rfc-editor.org/info/rfc5116</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7665">[RFC7665]</dt>
        <dd>
<span class="refAuthor">Halpern, J., Ed.</span> and <span class="refAuthor">C. Pignataro, Ed.</span>, <span class="refTitle">"Service Function Chaining (SFC) Architecture"</span>, <span class="seriesInfo">RFC 7665</span>, <span class="seriesInfo">DOI 10.17487/RFC7665</span>, <time datetime="2015-10" class="refDate">October 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7665">https://www.rfc-editor.org/info/rfc7665</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8300">[RFC8300]</dt>
      <dd>
<span class="refAuthor">Quinn, P., Ed.</span>, <span class="refAuthor">Elzur, U., Ed.</span>, and <span class="refAuthor">C. Pignataro, Ed.</span>, <span class="refTitle">"Network Service Header (NSH)"</span>, <span class="seriesInfo">RFC 8300</span>, <span class="seriesInfo">DOI 10.17487/RFC8300</span>, <time datetime="2018-01" class="refDate">January 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8300">https://www.rfc-editor.org/info/rfc8300</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-12.2">
        <h3 id="name-informative-references">
<a href="#section-12.2" class="section-number selfRef">12.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.arkko-farrell-arch-model-t">[I-D.arkko-farrell-arch-model-t]</dt>
        <dd>
<span class="refAuthor">Arkko, J.</span> and <span class="refAuthor">S. Farrell</span>, <span class="refTitle">"Challenges and Changes in the Internet Threat Model"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-arkko-farrell-arch-model-t-04</span>, <time datetime="2020-07-13" class="refDate">13 July 2020</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-arkko-farrell-arch-model-t-04.txt">https://www.ietf.org/archive/id/draft-arkko-farrell-arch-model-t-04.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-intarea-tunnels">[I-D.ietf-intarea-tunnels]</dt>
        <dd>
<span class="refAuthor">Touch, J.</span> and <span class="refAuthor">M. Townsley</span>, <span class="refTitle">"IP Tunnels in the Internet Architecture"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-intarea-tunnels-10</span>, <time datetime="2019-09-12" class="refDate">12 September 2019</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-intarea-tunnels-10.txt">https://www.ietf.org/archive/id/draft-ietf-intarea-tunnels-10.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.irtf-cfrg-aead-limits">[I-D.irtf-cfrg-aead-limits]</dt>
        <dd>
<span class="refAuthor">Günther, F.</span>, <span class="refAuthor">Thomson, M.</span>, and <span class="refAuthor">C. A. Wood</span>, <span class="refTitle">"Usage Limits on AEAD Algorithms"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-irtf-cfrg-aead-limits-03</span>, <time datetime="2021-07-12" class="refDate">12 July 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-irtf-cfrg-aead-limits-03.txt">https://www.ietf.org/archive/id/draft-irtf-cfrg-aead-limits-03.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.nguyen-sfc-security-architecture">[I-D.nguyen-sfc-security-architecture]</dt>
        <dd>
<span class="refAuthor">THANG, N. C.</span> and <span class="refAuthor">M. Park</span>, <span class="refTitle">"A Security Architecture Against Service Function Chaining Threats"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-nguyen-sfc-security-architecture-00</span>, <time datetime="2019-11-24" class="refDate">24 November 2019</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-nguyen-sfc-security-architecture-00.txt">https://www.ietf.org/archive/id/draft-nguyen-sfc-security-architecture-00.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4046">[RFC4046]</dt>
        <dd>
<span class="refAuthor">Baugher, M.</span>, <span class="refAuthor">Canetti, R.</span>, <span class="refAuthor">Dondeti, L.</span>, and <span class="refAuthor">F. Lindholm</span>, <span class="refTitle">"Multicast Security (MSEC) Group Key Management Architecture"</span>, <span class="seriesInfo">RFC 4046</span>, <span class="seriesInfo">DOI 10.17487/RFC4046</span>, <time datetime="2005-04" class="refDate">April 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4046">https://www.rfc-editor.org/info/rfc4046</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5905">[RFC5905]</dt>
        <dd>
<span class="refAuthor">Mills, D.</span>, <span class="refAuthor">Martin, J., Ed.</span>, <span class="refAuthor">Burbank, J.</span>, and <span class="refAuthor">W. Kasch</span>, <span class="refTitle">"Network Time Protocol Version 4: Protocol and Algorithms Specification"</span>, <span class="seriesInfo">RFC 5905</span>, <span class="seriesInfo">DOI 10.17487/RFC5905</span>, <time datetime="2010-06" class="refDate">June 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5905">https://www.rfc-editor.org/info/rfc5905</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6973">[RFC6973]</dt>
        <dd>
<span class="refAuthor">Cooper, A.</span>, <span class="refAuthor">Tschofenig, H.</span>, <span class="refAuthor">Aboba, B.</span>, <span class="refAuthor">Peterson, J.</span>, <span class="refAuthor">Morris, J.</span>, <span class="refAuthor">Hansen, M.</span>, and <span class="refAuthor">R. Smith</span>, <span class="refTitle">"Privacy Considerations for Internet Protocols"</span>, <span class="seriesInfo">RFC 6973</span>, <span class="seriesInfo">DOI 10.17487/RFC6973</span>, <time datetime="2013-07" class="refDate">July 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6973">https://www.rfc-editor.org/info/rfc6973</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7258">[RFC7258]</dt>
        <dd>
<span class="refAuthor">Farrell, S.</span> and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Pervasive Monitoring Is an Attack"</span>, <span class="seriesInfo">BCP 188</span>, <span class="seriesInfo">RFC 7258</span>, <span class="seriesInfo">DOI 10.17487/RFC7258</span>, <time datetime="2014-05" class="refDate">May 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7258">https://www.rfc-editor.org/info/rfc7258</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7498">[RFC7498]</dt>
        <dd>
<span class="refAuthor">Quinn, P., Ed.</span> and <span class="refAuthor">T. Nadeau, Ed.</span>, <span class="refTitle">"Problem Statement for Service Function Chaining"</span>, <span class="seriesInfo">RFC 7498</span>, <span class="seriesInfo">DOI 10.17487/RFC7498</span>, <time datetime="2015-04" class="refDate">April 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7498">https://www.rfc-editor.org/info/rfc7498</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7635">[RFC7635]</dt>
        <dd>
<span class="refAuthor">Reddy, T.</span>, <span class="refAuthor">Patil, P.</span>, <span class="refAuthor">Ravindranath, R.</span>, and <span class="refAuthor">J. Uberti</span>, <span class="refTitle">"Session Traversal Utilities for NAT (STUN) Extension for Third-Party Authorization"</span>, <span class="seriesInfo">RFC 7635</span>, <span class="seriesInfo">DOI 10.17487/RFC7635</span>, <time datetime="2015-08" class="refDate">August 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7635">https://www.rfc-editor.org/info/rfc7635</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8165">[RFC8165]</dt>
        <dd>
<span class="refAuthor">Hardie, T.</span>, <span class="refTitle">"Design Considerations for Metadata Insertion"</span>, <span class="seriesInfo">RFC 8165</span>, <span class="seriesInfo">DOI 10.17487/RFC8165</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8165">https://www.rfc-editor.org/info/rfc8165</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8459">[RFC8459]</dt>
        <dd>
<span class="refAuthor">Dolson, D.</span>, <span class="refAuthor">Homma, S.</span>, <span class="refAuthor">Lopez, D.</span>, and <span class="refAuthor">M. Boucadair</span>, <span class="refTitle">"Hierarchical Service Function Chaining (hSFC)"</span>, <span class="seriesInfo">RFC 8459</span>, <span class="seriesInfo">DOI 10.17487/RFC8459</span>, <time datetime="2018-09" class="refDate">September 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8459">https://www.rfc-editor.org/info/rfc8459</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8633">[RFC8633]</dt>
        <dd>
<span class="refAuthor">Reilly, D.</span>, <span class="refAuthor">Stenn, H.</span>, and <span class="refAuthor">D. Sibold</span>, <span class="refTitle">"Network Time Protocol Best Current Practices"</span>, <span class="seriesInfo">BCP 223</span>, <span class="seriesInfo">RFC 8633</span>, <span class="seriesInfo">DOI 10.17487/RFC8633</span>, <time datetime="2019-07" class="refDate">July 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8633">https://www.rfc-editor.org/info/rfc8633</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8877">[RFC8877]</dt>
        <dd>
<span class="refAuthor">Mizrahi, T.</span>, <span class="refAuthor">Fabini, J.</span>, and <span class="refAuthor">A. Morton</span>, <span class="refTitle">"Guidelines for Defining Packet Timestamps"</span>, <span class="seriesInfo">RFC 8877</span>, <span class="seriesInfo">DOI 10.17487/RFC8877</span>, <time datetime="2020-09" class="refDate">September 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8877">https://www.rfc-editor.org/info/rfc8877</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8915">[RFC8915]</dt>
      <dd>
<span class="refAuthor">Franke, D.</span>, <span class="refAuthor">Sibold, D.</span>, <span class="refAuthor">Teichel, K.</span>, <span class="refAuthor">Dansarie, M.</span>, and <span class="refAuthor">R. Sundblad</span>, <span class="refTitle">"Network Time Security for the Network Time Protocol"</span>, <span class="seriesInfo">RFC 8915</span>, <span class="seriesInfo">DOI 10.17487/RFC8915</span>, <time datetime="2020-09" class="refDate">September 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8915">https://www.rfc-editor.org/info/rfc8915</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="authors-addresses">
<section id="appendix-A">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Mohamed Boucadair</span></div>
<div dir="auto" class="left"><span class="org">Orange</span></div>
<div dir="auto" class="left">
<span class="postal-code">35000</span> <span class="locality">Rennes</span>
</div>
<div dir="auto" class="left"><span class="country-name">France</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:mohamed.boucadair@orange.com" class="email">mohamed.boucadair@orange.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Tirumaleswar Reddy</span></div>
<div dir="auto" class="left"><span class="org">Akamai</span></div>
<div dir="auto" class="left"><span class="street-address">Embassy Golf Link Business Park</span></div>
<div dir="auto" class="left">
<span class="locality">Bangalore</span> <span class="postal-code">560071</span>
</div>
<div dir="auto" class="left"><span class="region">Karnataka</span></div>
<div dir="auto" class="left"><span class="country-name">India</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:kondtir@gmail.com" class="email">kondtir@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Dan Wing</span></div>
<div dir="auto" class="left"><span class="org">Citrix Systems, Inc.</span></div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:dwing-ietf@fuggles.com" class="email">dwing-ietf@fuggles.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
