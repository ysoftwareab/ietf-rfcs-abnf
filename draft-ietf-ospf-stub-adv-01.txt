Network Working Group                                      Alvaro Retana
Internet Draft                                               Liem Nguyen
Expiration Date: May 2001                                     Russ White
File name: draft-ietf-ospf-stub-adv-01.txt                    Alex Zinin
                                                           Cisco Systems
                                                         Danny McPherson
                                                          Amber Networks
                                                           November 2000



                     OSPF Stub Router Advertisement
                    draft-ietf-ospf-stub-adv-01.txt


Status of this Memo

   This document is an Internet-Draft and is in full conformance with
   all provisions of Section 10 of RFC2026.

   Internet Drafts are working documents of the Internet Engineering
   Task Force (IETF), its Areas, and its Working Groups. Note that other
   groups may also distribute working documents as Internet Drafts.

   Internet Drafts are draft documents valid for a maximum of six
   months. Internet Drafts may be updated, replaced, or obsoleted by
   other documents at any time. It is not appropriate to use Internet
   Drafts as reference material or to cite them other than as a "working
   draft" or "work in progress".

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html.


Abstract

   In some cases, it is desirable not to route transit traffic via a
   specific OSPF router.  However, OSPF [RFC2328] does not specify a
   standard way to accomplish this. This memo describes a backward-
   compatible technique that may be used by OSPF implementations to
   advertise unavailability to forward transit traffic or to lower the
   preference level for the paths through such a router.

1 Motivation




Retana, et al.                                                  [Page 1]





INTERNET DRAFT       OSPF Stub Router Advertisement        November 2000


   In some situations, it may be advantageous to inform routers in a
   network not to use a specific router as a transit point, but still
   route to it. Possible situations include the following.


       o    The router is in a critical condition (for example, has very
            high CPU load or does not have enough memory to store all
            LSAs or build the routing table).

       o    Graceful introduction and removal of the router to/from the
            network.

       o    Other (administrative or traffic engineering) reasons.

   Note that the proposed solution does not remove the router from the
   topology view of the network (as could be done by just flushing that
   router's router-LSA), but prevents other routers from using it for
   transit routing, while still routing packets to router's own IP
   addresses, i.e., the router is announced as stub.

   It must be emphasized that the proposed solution provides real bene-
   fits in networks designed with at least some level of redundancy so
   that traffic can be routed around the stub router. Otherwise, traffic
   destined for the networks reachable through such a stub router will
   either be still routed through it.

2 Proposed Solution

   The solution described in this document solves two challenges associ-
   ated with the outlined problem. In the description below, router X is
   the router announcing itself as a stub.


      1)   Making other routers prefer routes around router X while per-
           forming the Dijkstra calculation.


      2)   Allowing other routers to reach IP prefixes directly con-
           nected to router X

   Note that it would be easy to address issue 1) alone by just flushing
   router X's router-LSA from the domain. However, it does not solve
   problem 2), since other routers will not be able to use links to
   router X in Dijkstra (no back link), and because router X will not
   have links to its neighbors.

   To address both problems, router X announces its router-LSA to the
   neighbors as follows.



Retana, et al.                                                  [Page 2]





INTERNET DRAFT       OSPF Stub Router Advertisement        November 2000


      o    costs of all non-stub links (links of the types other than 3)
           are set to LSInfinity (16-bit value 0xFFFF, rather than 24-
           bit value 0xFFFFFF used in summary and AS-external LSAs).

      o    costs of stub links (type 3) are set to the interface output
           cost.

   This addresses issues 1) and 2).

3 Implementation details

   To simplify the implementation of the described technique, it may be
   useful for  OSPF routers to keep two versions of their router-LSAs.
   One version (public) is installed in the LSDB and sent to the neigh-
   bors, while another version (internal) is used for local routing
   table calculation. When the router announces itself as stub, it con-
   structs the public version as indicated in Section 2, but the inter-
   nal version is constructed as in standard OSPF [RFC2328]. When the
   router does not announce itself as stub, both versions are con-
   structed as in standard OSPF and would both yield the same result,
   hence it is not necessary (though acceptable) to keep two versions of
   the LSAs at this point.

4 Compatibility issues

   Some inconsistency may be seen when the network is constructed of the
   routers that perform intra-area Dijkstra calculation as specified in
   [RFC1247] (discarding link records in router-LSAs that have LSInfin-
   ity cost value) and routers that perform it as specified in [RFC1583]
   and higher (do not treat links with LSInfinity cost as unreachable).
   Note that this inconsistency will not lead to routing loops, because
   if there are some alternate paths in the network, both types of
   routers will agree on using them rather than the path through the
   stub router. If the path through the stub router is the only one, the
   routers of the first type will not use the stub router for transit
   (which is the desired behavior), while the routers of the second type
   will still use this path.

5 Acknowledgements

   The authors of this document do not make any claims on the original-
   ity of the ideas described.  Among other people, we would like to
   acknowledge Henk Smit for being part of one of the initial discus-
   sions around this topic.



6 Security Considerations



Retana, et al.                                                  [Page 3]





INTERNET DRAFT       OSPF Stub Router Advertisement        November 2000


   The technique described in this document does not introduce any new
   security issues into OSPF protocol.

7 References


[RFC2328]
      J. Moy. OSPF version 2. Technical Report RFC 2328,
       Internet Engineering Task Force, 1998.
       ftp://ftp.isi.edu/in-notes/rfc2328.txt.


[RFC1247]
      J. Moy. OSPF version 2. RFC 1247,
       Internet Engineering Task Force, 1991.
       ftp://ftp.isi.edu/in-notes/rfc1247.txt.


[RFC1583]
      J. Moy. OSPF version 2. RFC 1583,
       Internet Engineering Task Force, 1994.
       ftp://ftp.isi.edu/in-notes/rfc1583.txt.

8 Authors' addresses


   Alvaro Retana
   7025 Kit Creek Rd.
   Research Triangle Park, NC 27709
   USA
   e-mail: aretana@cisco.com

   Liem Nguyen
   7025 Kit Creek Rd.
   Research Triangle Park, NC 27709
   USA
   e-mail: lhnguyen@cisco.com

   Russ White
   Cisco Systems, Inc.
   7025 Kit Creek Rd.
   Research Triangle Park, NC 27709
   e-mail: riw@cisco.com

   Alex D. Zinin
   Cisco Systems
   150 West Tasman Dr.
   San Jose,CA 95134



Retana, et al.                                                  [Page 4]





INTERNET DRAFT       OSPF Stub Router Advertisement        November 2000


   E-mail: azinin@cisco.com

   Danny McPherson
   Amber Networks
   2465 Augustine Drive
   Santa Clara, CA  95054
   e-mail: danny@ambernetworks.com












































Retana, et al.                                                  [Page 5]



