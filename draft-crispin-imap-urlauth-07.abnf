resetkey       = "RESETKEY" [SP mailbox *(SP mechanism)]

command-auth    =/ resetkey / signurl / urlfetch

resp-text-code  =/ "URLMECH" SP "INTERNAL" *(SP mechanism ["=" base64])

signurl         = "SIGNURL" 1*(SP url SP mechanism)

signurl-data    = "*" SP "SIGNURL" 1*(SP url)

url             = astring
                    ; contains imapurl as defined below

urlfetch        = "URLFETCH" SP url

urlfetch-data   = "*" SP "URLFETCH" SP url SP nstring

    The following modifications are made to the Formal Syntax in [IMAPURL]:

enc-urlauth     = 32*HEXDIG

imessagepart    = enc_mailbox [uidvalidity] iuid [isection] [iurlauth]

iurlauth        = [expire] ";URLAUTH=" access ":" mechanism ":" enc-urlauth

access          = ("submit+" iuserauth) / ("user+" iuserauth)

expire          = ";EXPIRE=" date-time
                     ; date-time defined in [DATETIME]

mechanism       = "INTERNAL" / 1*uchar
                    ; new mechanisms MUST be registered with IANA

