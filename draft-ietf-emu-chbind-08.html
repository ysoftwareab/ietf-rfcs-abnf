<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Channel Binding Support for EAP Methods</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.2" rel="Chapter" title="2 Terminology">
<link href="#rfc.section.3" rel="Chapter" title="3 Problem Statement">
<link href="#rfc.section.4" rel="Chapter" title="4 Channel Bindings">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 Types of EAP Channel Bindings">
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 Channel Bindings in the Secure Association  Protocol">
<link href="#rfc.section.4.3" rel="Chapter" title="4.3 Channel Bindings Scope">
<link href="#rfc.section.5" rel="Chapter" title="5 Channel Binding Process">
<link href="#rfc.section.5.1" rel="Chapter" title="5.1 Protocol Operation">
<link href="#rfc.section.5.2" rel="Chapter" title="5.2 Channel Binding Consistency Check">
<link href="#rfc.section.5.3" rel="Chapter" title="5.3 EAP Protocol">
<link href="#rfc.section.5.3.1" rel="Chapter" title="5.3.1 Channel Binding Codes">
<link href="#rfc.section.5.3.2" rel="Chapter" title="5.3.2 Namespace Identifiers">
<link href="#rfc.section.5.3.3" rel="Chapter" title="5.3.3 Radius Namespace">
<link href="#rfc.section.6" rel="Chapter" title="6 System Requirements">
<link href="#rfc.section.6.1" rel="Chapter" title="6.1 General Transport Protocol Requirements">
<link href="#rfc.section.6.2" rel="Chapter" title="6.2 EAP Method Requirements">
<link href="#rfc.section.7" rel="Chapter" title="7 Channel Binding TLV">
<link href="#rfc.section.7.1" rel="Chapter" title="7.1 Requirements for Lower-Layer Bindings">
<link href="#rfc.section.7.2" rel="Chapter" title="7.2 General Attributes">
<link href="#rfc.section.7.3" rel="Chapter" title="7.3 IEEE 802.11">
<link href="#rfc.section.7.3.1" rel="Chapter" title="7.3.1 IEEE 802.11r">
<link href="#rfc.section.8" rel="Chapter" title="8 AAA-Layer Bindings">
<link href="#rfc.section.9" rel="Chapter" title="9 Security Considerations">
<link href="#rfc.section.9.1" rel="Chapter" title="9.1 Trust Model">
<link href="#rfc.section.9.2" rel="Chapter" title="9.2 Consequences of Trust Violation">
<link href="#rfc.section.9.3" rel="Chapter" title="9.3 Privacy Violations">
<link href="#rfc.section.10" rel="Chapter" title="10 Operations and Management Considerations">
<link href="#rfc.section.11" rel="Chapter" title="11 IANA Considerations">
<link href="#rfc.section.12" rel="Chapter" title="12 Acknowledgements">
<link href="#rfc.references" rel="Chapter" title="13 References">
<link href="#rfc.references.1" rel="Chapter" title="13.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="13.2 Informative References">
<link href="#rfc.appendix.Appendix%20A" rel="Chapter" title="Appendix A Attacks Prevented by Channel Bindings">
<link href="#rfc.appendix.Appendix%20A.1" rel="Chapter" title="Appendix A.1 Enterprise Subnetwork Masquerading">
<link href="#rfc.appendix.Appendix%20A.2" rel="Chapter" title="Appendix A.2 Forced Roaming">
<link href="#rfc.appendix.Appendix%20A.3" rel="Chapter" title="Appendix A.3 Downgrading attacks">
<link href="#rfc.appendix.Appendix%20A.4" rel="Chapter" title="Appendix A.4 Bogus Beacons in IEEE 802.11r">
<link href="#rfc.appendix.Appendix%20A.5" rel="Chapter" title="Appendix A.5 Forcing false authorization in IEEE 802.11i">
<link href="#rfc.appendix.Appendix%20B" rel="Chapter" title="Appendix B Change History">
<link href="#rfc.appendix.Appendix%20B.1" rel="Chapter" title="Appendix B.1 Changes since Version 06">
<link href="#rfc.appendix.Appendix%20B.2" rel="Chapter" title="Appendix B.2 Changes since version 04">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="This document defines how to implement channel bindings for Extensible Authentication Protocol (EAP) methods to address the lying NAS as well as the lying provider problem." />
  <meta name="description" content="This document defines how to implement channel bindings for Extensible Authentication Protocol (EAP) methods to address the lying NAS as well as the lying provider problem." />
  <meta name="keywords" content="EAP, Channel Bindings" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">EMU Working Group</td>
<td class="right">S. Hartman, Ed.</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Painless Security</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">T. Clancy</td>
</tr>
<tr>
<td class="left">Expires: January 12, 2012</td>
<td class="right">Electrical and Computer Engineering</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">K. Hoeper</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Motorola, Inc.</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">July 11, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Channel Binding Support for EAP Methods<br />
  <span class="filename">draft-ietf-emu-chbind-08.txt</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>This document defines how to implement channel bindings for Extensible Authentication Protocol (EAP) methods to address the lying NAS as well as the lying provider problem.</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on January 12, 2012.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>
<p>This document may contain material from IETF Documents or IETF Contributions published or made publicly available before November 10, 2008.  The person(s) controlling the copyright in some of this material may not have granted the IETF Trust the right to allow modifications of such material outside the IETF Standards Process. Without obtaining an adequate license from the person(s) controlling the copyright in such materials, this document may not be modified outside the IETF Standards Process, and derivative works of it may not be created outside the IETF Standards Process, except to format it for publication as an RFC or to translate it into languages other than English.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>2.   <a href="#rfc.section.2">Terminology</a>
</li>
<li>3.   <a href="#rfc.section.3">Problem Statement</a>
</li>
<li>4.   <a href="#rfc.section.4">Channel Bindings</a>
</li>
<li>4.1.   <a href="#rfc.section.4.1">Types of EAP Channel Bindings</a>
</li>
<li>4.2.   <a href="#rfc.section.4.2">Channel Bindings in the Secure Association  Protocol</a>
</li>
<li>4.3.   <a href="#rfc.section.4.3">Channel Bindings Scope</a>
</li>
<li>5.   <a href="#rfc.section.5">Channel Binding Process</a>
</li>
<li>5.1.   <a href="#rfc.section.5.1">Protocol Operation</a>
</li>
<li>5.2.   <a href="#rfc.section.5.2">Channel Binding Consistency Check</a>
</li>
<li>5.3.   <a href="#rfc.section.5.3">EAP Protocol</a>
</li>
<li>5.3.1.   <a href="#rfc.section.5.3.1">Channel Binding Codes</a>
</li>
<li>5.3.2.   <a href="#rfc.section.5.3.2">Namespace Identifiers</a>
</li>
<li>5.3.3.   <a href="#rfc.section.5.3.3">Radius Namespace</a>
</li>
<li>6.   <a href="#rfc.section.6">System Requirements</a>
</li>
<li>6.1.   <a href="#rfc.section.6.1">General Transport Protocol Requirements</a>
</li>
<li>6.2.   <a href="#rfc.section.6.2">EAP Method Requirements</a>
</li>
<li>7.   <a href="#rfc.section.7">Channel Binding TLV</a>
</li>
<li>7.1.   <a href="#rfc.section.7.1">Requirements for Lower-Layer Bindings</a>
</li>
<li>7.2.   <a href="#rfc.section.7.2">General Attributes</a>
</li>
<li>7.3.   <a href="#rfc.section.7.3">IEEE 802.11</a>
</li>
<li>7.3.1.   <a href="#rfc.section.7.3.1">IEEE 802.11r</a>
</li>
<li>8.   <a href="#rfc.section.8">AAA-Layer Bindings</a>
</li>
<li>9.   <a href="#rfc.section.9">Security Considerations</a>
</li>
<li>9.1.   <a href="#rfc.section.9.1">Trust Model</a>
</li>
<li>9.2.   <a href="#rfc.section.9.2">Consequences of Trust Violation</a>
</li>
<li>9.3.   <a href="#rfc.section.9.3">Privacy Violations</a>
</li>
<li>10.   <a href="#rfc.section.10">Operations and Management Considerations</a>
</li>
<li>11.   <a href="#rfc.section.11">IANA Considerations</a>
</li>
<li>12.   <a href="#rfc.section.12">Acknowledgements</a>
</li>
<li>13.   <a href="#rfc.references">References</a>
</li>
<li>13.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>13.2.   <a href="#rfc.references.2">Informative References</a>
</li>
<li>Appendix A.   <a href="#rfc.appendix.Appendix%20A">Attacks Prevented by Channel Bindings</a>
</li>
<li>Appendix A.1.   <a href="#rfc.appendix.Appendix%20A.1">Enterprise Subnetwork Masquerading</a>
</li>
<li>Appendix A.2.   <a href="#rfc.appendix.Appendix%20A.2">Forced Roaming</a>
</li>
<li>Appendix A.3.   <a href="#rfc.appendix.Appendix%20A.3">Downgrading attacks</a>
</li>
<li>Appendix A.4.   <a href="#rfc.appendix.Appendix%20A.4">Bogus Beacons in IEEE 802.11r</a>
</li>
<li>Appendix A.5.   <a href="#rfc.appendix.Appendix%20A.5">Forcing false authorization in IEEE 802.11i</a>
</li>
<li>Appendix B.   <a href="#rfc.appendix.Appendix%20B">Change History</a>
</li>
<li>Appendix B.1.   <a href="#rfc.appendix.Appendix%20B.1">Changes since Version 06</a>
</li>
<li>Appendix B.2.   <a href="#rfc.appendix.Appendix%20B.2">Changes since version 04</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> Introduction</h1>
<p id="rfc.section.1.p.1">The so-called "lying NAS" problem is a well-documented problem with the current Extensible Authentication Protocol (EAP) architecture <a href="#RFC3748">[RFC3748]</a> when used in pass-through authenticator mode.  Here, a Network Access Server (NAS), or pass-through authenticator, may represent one set of information (e.g. network identity, capabilities, configuration, etc) to the backend Authentication, Authorization, and Accounting (AAA) infrastructure, while representing contrary information to EAP peers.  Another possibility is that the same false information could be provided to both the EAP peer and EAP server by the NAS. A "lying" entity can also be located anywhere on the AAA path between the NAS and the EAP server. </p>
<p id="rfc.section.1.p.2">This problem results when the same credentials are used to access multiple services that differ in some interesting property. The EAP server learns which client credentials are in use. The client knows which EAP credentials are used, but cannot distinguish between servers that use those credentials.</p>
<p id="rfc.section.1.p.3">As a concrete example, consider an organization with two different IEEE 802.11 wireless networks. One is a relatively low-security network for reading e-mail while the other has access to valuable confidential information. An access point on the e-mail network could act as a lying NAS, sending the SSID of the confidential network in its beacons. This access point could gain an advantage by doing so if it tricks clients intending to connect to the confidential network to connect to it and disclose confidential information.</p>
<p id="rfc.section.1.p.4">A similar problem can be observed in the context of roaming. Here, the lying entity is located in a visited service provider network, e.g. attempting to lure peers to connect to the network based on false advertized roaming rates. This is referred to as "lying provider" problem in the remainder of this document. The lying entity's motivation often is financial; the entity may be paid whenever peers roam to its service. However a lying entity in a provider network can gain access to traffic that it might not otherwise see.</p>
<p id="rfc.section.1.p.5">This document defines and implements EAP channel bindings to solve the lying NAS and the lying provider problems, using a process in which the EAP peer provides information about the characteristics of the service provided by the authenticator to the AAA server protected within the EAP method.  This allows the server to verify the authenticator is providing information to the peer that is consistent with the information received from this authenticator as well as the information stored about this authenticator.  "AAA Payloads" defined in <a href="#I-D.clancy-emu-aaapay">[I-D.clancy-emu-aaapay]</a>  served as the starting point for the mechanism proposed in this specification to carry this information.</p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> Terminology</h1>
<p id="rfc.section.2.p.1">In this document, several words are used to signify the requirements of the specification.  These words are often capitalized. The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">[RFC2119]</a>.</p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#probstate" id="probstate">Problem Statement</a>
</h1>
<p id="rfc.section.3.p.1">In a <a href="#RFC4017">[RFC4017]</a> compliant EAP authentication, the EAP peer and EAP server mutually authenticate each other, and derive keying material.  However, when operating in pass-through mode, the EAP server can be far removed from the authenticator.  A malicious or compromised authenticator may represent incorrect information about the network to the peer in an effort to affect its operation in some way.  Additionally, while an authenticator may not be compromised, other compromised elements in the network (such as proxies) could provide false information to the authenticator that it could simply be relaying to EAP peers.  Hence, the goal must be to ensure that the authenticator is providing correct information to the EAP peer during the initial network discovery, selection, and authentication.</p>
<p id="rfc.section.3.p.2">There are two different types of networks to consider: enterprise networks and service provider networks.  In enterprise networks, assuming a single administrative domain, it is feasible for an EAP server to have information about all the authenticators in the network.  In service provider networks, global knowledge is infeasible due to indirection via roaming.  When a peer is outside its home administrative domain, the goal is to ensure that the level of service received by the peer is consistent with the contractual agreement between the two service providers. The same EAP server may need to support both types of networks. For example an enterprise may have a roaming agreement permitting its users to use the networks of third-party service providers. In these situations, the EAP server may authenticate for an enterprise and provider network. </p>
<p id="rfc.section.3.p.3">The following are example attacks possible by presenting false network information to peers.</p>
<p></p>

<ul>
<li>Enterprise Network: A corporate network may have multiple virtual Lads (VLANs) running throughout their campus network, and have IEEE 802.11 access points connected to each VLAN.  Assume one VLAN connects users to the firewalled corporate network, while the other connects users to a public guest network.  The corporate network is assumed to be free of adversarial elements, while the guest network is assumed to possibly have malicious elements.  Access Points on both VLANs are serviced by the same EAP server, but broadcast different SSIDs to differentiate.  A compromised access point connected to the guest network but not the corporate network could advertise the SSID of the corporate network in an effort to lure peers to connect to a network with a false sense of security regarding their traffic. Conditions and further details of this attack can be found in the Appendix.  <br><br>
</li>
<li>Enterprise network: The EAP GSS-API mechanism <a href="#I-D.ietf-abfab-gss-eap">[I-D.ietf-abfab-gss-eap]</a> mechanism provides a way to use EAP to authenticate to mail servers, instant messaging servers and other non-network services. Without EAP channel binding, an attacker could trick the user into connecting to a relatively untrusted service instead of a relatively trusted service.<br><br>
</li>
<li>Service Provider Network: An EAP-enabled mobile phone provider could advertize very competitive flat rates but send per minute rates to the home server, thus, luring peers to connect to their network and overcharging them.  In more elaborate attacks, peers can be tricked into roaming without their knowledge. For example, a mobile phone provider operating along a geo-political boundary could boost their cell towers' transmission power and advertise the network identity of the neighboring country's indigenous provider.  This would cause unknowing handsets to associate with an unintended operator, and consequently be subject to high roaming fees without realizing they had roamed off their home provider's network.  These types of scenarios can be considered as "lying provider" problem, because here the provider configures its NAS to broadcast false information. For the purpose of channel bindings as defined in this draft, it does not matter which local entity (or entities) is "lying" in a service provider network (local NAS, local authentication server and/or local proxies), because the only information received from the visited network that is verified by channel bindings is the information the home authentication server received from the last hop in the communication chain. In other words, channel bindings enable the detection of inconsistencies in the information from a visited network, but cannot determine which entity is lying.  Naturally, channel bindings for EAP methods can only verify the endpoints and, if desirable, intermediate hops need to be protected by the employed AAA protocol.<br><br>
</li>
<li>Enterprise and provider networks: In a situation where an enterprise has roaming agreements with providers, a compromised access point in a provider network could masquerade as the enterprise network in an attempt to gain confidential information. Today this could potentially be solved by using different credentials for internal and external access. Depending on the type of credential this may introduce usability or man-in-the-middle security issues.</li>
</ul>
<p id="rfc.section.3.p.5">To address these problems, a mechanism is required to validate unauthenticated information advertised by EAP authenticators.</p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#overview" id="overview">Channel Bindings</a>
</h1>
<p id="rfc.section.4.p.1">EAP channel bindings seek to authenticate previously unauthenticated information provided by the authenticator to the EAP peer, by allowing the peer and server to compare their perception of network properties in a secure channel.</p>
<p id="rfc.section.4.p.2">It should be noted that the definition of EAP channel bindings differs somewhat from channel bindings documented in <a href="#RFC5056">[RFC5056]</a>, which seek to securely bind together the end points of a multi-layer protocol, allowing lower layers to protect data from higher layers.  Unlike <a href="#RFC5056">[RFC5056]</a>, EAP channel bindings do not ensure the binding of different layers of a session but rather the information advertised to EAP peer by an authenticator acting as pass-through device during an EAP execution. The term channel bindings was independently adopted by these two related concepts; by the time the conflict was discovered, a wide body of literature existed for each usage. EAP channel bindings could be used to provide RFC 5056 channel bindings. In particular, an inner EAP method could be bound to an outer method by including the RFC 5056 channel binding data for the outer channel in the inner EAP method's channel bindings. Doing so would provide a facility similar to EAP cryptographic binding, except that a man-in-the-middle could not extract the inner method from the tunnel. This specification does not weigh the advantages of doing so nor specify how to do so; the example is provided only to illustrate how EAP channel binding and RFC 5056 channel binding overlap.</p>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> <a href="#bindingtypes" id="bindingtypes">Types of EAP Channel Bindings</a>
</h1>
<p id="rfc.section.4.1.p.1">There are two categories of approach to EAP channel bindings:</p>
<p></p>

<ul>
<li>After keys have been derived during an EAP execution, the peer and server can, in an integrity-protected channel, exchange plaintext information about the network with each other, and verify consistency and correctness.<br><br>
</li>
<li>The peer and server can both uniquely encode their respective view of the network information without exchanging it, resulting into an opaque blob that can be included directly into the derivation of EAP session keys.</li>
</ul>
<p id="rfc.section.4.1.p.3">Both approaches are only applicable to key deriving EAP methods and both have advantages and disadvantages.  Various hybrid approaches are also possible.  Advantages of exchanging plaintext information include:</p>
<p></p>

<ul>
<li>It allows for policy-based comparisons of network properties, rather than requiring precise matches for every field, which achieves a policy-defined consistency, rather than bitwise equality.  This allows network operators to define which properties are important and even verifiable in their network.<br><br>
</li>
<li>EAP methods that support extensible, integrity-protected channels can easily include support for exchanging this network information.  In contrast, direct inclusion into the key derivation would require more extensive revisions to existing EAP methods or a wrapper EAP method.<br><br>
</li>
<li>Given it doesn't affect the key derivation, this approach facilitates debugging, incremental deployment, backward compatibility and a logging mode in which verification results are recorded but do not have an effect on the remainder of the EAP execution. The exact use of the verification results can be subject to the network policy.  Additionally, consistent information canonicalization and formatting for the key derivation approach would likely cause significant deployment problems.</li>
</ul>
<p id="rfc.section.4.1.p.5">The following are advantages of directly including channel binding information in the key derivation:</p>
<p></p>

<ul>
<li>EAP methods not supporting extensible, integrity-protected channels could still be supported, either by revising their key derivation, revising EAP, or wrapping them in a universal method that supports channel binding.<br><br>
</li>
<li>It can guarantee proper channel information, since subsequent communication would be impossible if differences in channel information yielded different session keys on the EAP peer and server.</li>
</ul>
<h1 id="rfc.section.4.2">
<a href="#rfc.section.4.2">4.2.</a> <a href="#SAP" id="SAP">Channel Bindings in the Secure Association  Protocol</a>
</h1>
<p id="rfc.section.4.2.p.1">This document describes channel bindings performed by transporting channel binding information as part of an integrity-protected exchange within an EAP method. Alternatively, some future document could specify a mechanism for transporting channel bindings within the lower layer's secure association protocol. Such a specification would need to describe how channel bindings are exchanged over the lower layer protocol between the peer and authenticator. In addition, since the EAP exchange concludes before the secure association protocol begins, a mechanism for transporting the channel bindings from the authenticator to the EAP server needs to be specified. A mechanism for transporting a protected result from the EAP server, through the authenticator, back to the peer needs to be specified.</p>
<p id="rfc.section.4.2.p.2">The channel bindings MUST be transported with integrity protection based on a key known only to the peer and EAP server. The channel bindings SHOULD be confidentiality protected using a key known only to the peer and EAP server. For the system to function, the EAP server  or AAA server needs access to the channel binding information from the peer as well as the AAA attributes and a local database described later in this document.</p>
<p id="rfc.section.4.2.p.3">The primary advantage of sending channel bindings as part of the secure association protocol is that EAP methods need not be changed. The disadvantage is that a new AAA exchange is required, and secure association protocols need to be changed. As the result of the secure association protocol change, every NAS needs to be upgraded to support channel bindings within the secure association protocol.</p>
<p id="rfc.section.4.2.p.4">For many deployments, changing all the NASes is expensive and adding channel binding support to enough EAP methods to meet the goals of the deployment will be cheaper. However for deployment of new equipment, or especially deployment of a new lower layer technology, changing the NASes may be cheaper than changing EAP methods. Especially if such a deployment needed to support a large number of EAP methods, sending channel bindings in the secure association protocol might make sense.</p>
<p id="rfc.section.4.2.p.5">If channel bindings using a secure association protocol is specified, semantics as well as the set of information that peers exchange can be shared with the mechanism described in this document.</p>
<h1 id="rfc.section.4.3">
<a href="#rfc.section.4.3">4.3.</a> Channel Bindings Scope</h1>
<p id="rfc.section.4.3.p.1">The scope of EAP channel bindings differs somewhat depending on the type of deployment in which they are being used.  In enterprise networks, they can be used to authenticate very specific properties of the authenticator (e.g. MAC address, supported link types and data rates, etc), while in service provider networks they can generally only authenticate broader information about a roaming partner's network (e.g. network name, roaming information, link security requirements, etc).  The reason for the difference has to do with the amount of information about the authenticator and/or network to which the peer is connected the home EAP server is expected  to have access to.  In roaming cases, the home server is likely to only have access to information contained in their roaming agreements.</p>
<p id="rfc.section.4.3.p.2">With any multi-hop AAA infrastructure, many of the NAS-specific AAA attributes are obscured by the AAA proxy that's decrypting, reframing, and retransmitting the underlying AAA messages.  Especially service provider networks are affected by this and the AAA information received from the last hop may not contain much verifiable information any longer. For example, information carried in AAA attributes such as the NAS IP address may have been lost in transition and are thus not known to the EAP server.  This affects the ability of the EAP server to verify specific NAS properties.  However, often verification of the MAC or IP address of the NAS is not useful for improving the overall security posture of a network.  More often it is useful to make policy decisions about services being offered to peers.  For example, in an IEEE 802.11 network, the EAP server may wish to ensure that peers connecting to the corporate intranet are using secure link-layer encryption, while link-layer security requirements for peers connecting to the guest network could be less stringent.  These types of policy decisions can be made without knowing or being able to verify the IP address of the NAS through which the peer is connecting.</p>
<p id="rfc.section.4.3.p.3">The properties of the network that the peer wishes to validate depend on the specific deployment. In a mobile phone network, peers generally don't care what the name of the network is, as long as they can make their phone call and are charged the expected amount for the call.  However, in an enterprise network the administrators of a peer may be more concerned with specifics of where their network traffic is being routed and what VLAN is in use. To establish policies surrounding these requirements administrators would capture some attribute such as SSID to describe the properties of the network they care about. Channel bindings could validate the SSID. The administrator would need to make sure that the network guarantees that when an authenticator trusted by the AAA infrastructure to offer a particular SSID to clients does offer this SSID, that network has the intended properties. Generally it is not possible for channel bindings to detect lying NAS behavior when the NAS is authorized to claim a particular service. That is, if the same physical authenticator is permitted to advertize two networks, the AAA infrastructure is unlikely to be able to determine when this authenticator lyes.</p>
<p id="rfc.section.4.3.p.4">As discussed in the next section, some of the most important information to verify cannot come from AAA attributes but instead comes from local configuration. For example in the mobile phone case, the expected roaming rate cannot come from the roaming provider without being verified against the contract between the two providers. Similarly, in an enterprise, the SSID a particular access point is expected to advertize is a matter of configuration rather than something that can be trusted because it is included in an AAA exchange.</p>
<p id="rfc.section.4.3.p.5">Channel bindings can be important for forming pockets of trust, especially when provider networks are involved, and exact information is not available to the EAP server.  Without channel bindings, all entities in the system need to be held to the standards of the most trusted entity that could be accessed using the EAP credential. Otherwise, a less trusted entity can impersonate a more trusted entity. However when channel bindings are used, the EAP server can use information supplied by the peer, AAA protocols and local database to distinguish less trusted entities from more trusted entities. One possible deployment involves being able to verify a number of characteristics about relatively trusted entities while for other entities simply verifying that they are less trusted.</p>
<p id="rfc.section.4.3.p.6">Any deployment of channel bindings should take into consideration both what information the EAP server is likely to know or have access to, and also what type of network information the peer would want and need authenticated.</p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#chbp" id="chbp">Channel Binding Process</a>
</h1>
<p id="rfc.section.5.p.1">This section defines the process for verifying channel binding information during an EAP authentication.  The protocol uses the approach where  plaintext data is exchanged, since it allows channel bindings to be used more flexibly in varied deployment models (see <a href="#bindingtypes">Section 4.1</a>). In the first subsection, the general communication infrastructure is outlined, the messages used for channel binding verifications are specified, and the protocol flows are defined.  The second subsection explores the difficulties of checking the different pieces of information that are exchanged during the channel binding protocol for consistency. The third subsection describes the information carried in the EAP exchange.</p>
<h1 id="rfc.section.5.1">
<a href="#rfc.section.5.1">5.1.</a> Protocol Operation</h1>
<p id="rfc.section.5.1.p.1">Channel bindings are always provided between two communication endpoints, here the EAP peer and the EAP server, who communicate through an authenticator typically in pass-through mode. For the channel binding protocol presented in this draft to work, the EAP server needs to be able to access information from the AAA server that is utilized during the EAP session and a local database. For example, the EAP server and the local database can be co-located with the AAA server, as illustrated in <a href="#chbinddiag">Figure 1</a>. An alternate architecture would be to provide a mechanism for the EAP server to inform the AAA server what channel binding attributes were supplied and the AAA server to inform the EAP server about what channel binding attributes it considered when making its decision.</p>
<div id="#rfc.figure.1"></div>
<div id="#chbinddiag"></div>
<pre>
                                     + -------------------------+
  --------        -------------      |   ----------     ______  |
 |EAP peer|&lt;----&gt;|Authenticator|&lt;--&gt; |  |EAP Server|___(______) |
  --------        -------------      |   ----------    | DB   | |
     .                 .             |AAA              (______) | 
     .       i1        .             +--------------------------+
     .&lt;----------------.      i2     .       .
     .                 .------------&gt;        .
     .                  i1                   .
     .--------------------------------------&gt;.
     .     CB_success/failure(i1, i2,info)   .
     .&lt;--------------------------------------.

</pre>
<p id="rfc.section.5.1.p.2">During network advertisement, selection, and authentication, the authenticator presents unauthenticated information, labeled i1, about the network to the peer.  Message i1 could include an authenticator identifier and the identity of the network it represents, in addition to advertised network information such as offered services and roaming information. Information may be communicated implicitly in i1, such as the type of media in use. As there is no established trust relationship between the peer and authenticator, there is no way for the peer to validate this information.</p>
<p id="rfc.section.5.1.p.3">Additionally, during the transaction the authenticator presents a number of information properties in form of AAA attributes about itself and the current request to the AAA infrastructure which may or may not be valid. This information is labeled i2.  Message i2 is the information the AAA server receives from the last hop in the AAA proxy chain which is not necessarily the authenticator.</p>
<p id="rfc.section.5.1.p.4">AAA hops between the authenticator and AAA server can validate some of i2. Whether the AAA server will be able to depend on this depends significantly on the business relationship executed with these proxies and on the structure of the AAA network.</p>
<p id="rfc.section.5.1.p.5">The local database is perhaps the most important part of this system.  In order for the EAP server or AAA server  to know whether i1 and i2 are correct, they need access to trustworthy information, since an authenticator could include false information in both i1 and i2. Additional reasons why  such a database is necessary for channel bindings to work are discussed in the next subsection.  The information contained within the database could involve wildcards.  For example, this could be used to check whether WiFi access points on a particular IP subnet all use a specific SSID.  The exact IP address is immaterial, provided it is on the correct subnet.</p>
<p id="rfc.section.5.1.p.6">During an EAP method execution with channel bindings,  the peer sends i1 to the EAP server using the mechanism described in <a href="#PROTOCOL">Section 5.3</a>. The EAP server verifies  the consistency of i1 provided by the peer, i2 provided by the authenticator, and the information in the local database. Upon the check, the EAP server sends a message to the peer indicating whether the channel binding validation check succeeded or failed and  includes the attributes  that were used in the check. The message flow is illustrated in <a href="#chbinddiag">Figure 1</a>. </p>
<p id="rfc.section.5.1.p.7">Above, the EAP server is described as performing the channel binding validation. In most deployments, this will be a necessary implementation constraint. The EAP exchange needs to include an indication of channel binding success or failure. Most existing implementations do not have a way to have an exchange between the EAP server and another AAA entity during the EAP server's processing of a single EAP message. However another AAA entity can provide information to the EAP server to make its decision.</p>
<p id="rfc.section.5.1.p.8">If the compliance of i1 or i2 information with the authoritative policy source is mandatory and a consistency check failed, then after sending a protected indication of failed consistency, the EAP server MUST send an EAP-Failure message to terminate the session.  If the EAP server is otherwise configured, it MUST allow the EAP session to complete normally, and leave the decision about network access up to the peer's policy. If i1 or i2 does not comply with policy, the EAP server MUST not list information that failed to comply in the set of information used to perform channel binding. In this case the EAP server SHOULD indicate channel binding failure; this requirement may be upgraded to a MUST in the future.</p>
<h1 id="rfc.section.5.2">
<a href="#rfc.section.5.2">5.2.</a> Channel Binding Consistency Check</h1>
<p id="rfc.section.5.2.p.1">The validation check that is the core of the channel binding protocol described in the previous subsection, consists of two parts in which the server checks whether:<br><br> </p>

<ol>
<li>the authenticator is lying to the peer, i.e. i1 contains false information, <br><br> </li>
<li>the authenticator or any entity on the AAA path to the AAA server provides false information in form of AAA attributes, i.e. i2 contains false information, <br><br> </li>
</ol>

<p> These checks enable the EAP server to detect lying NAS/authenticator in enterprise networks and lying providers in service provider networks.  </p>
<p id="rfc.section.5.2.p.2">Checking the consistency of i1 and i2 is nontrivial, as has been pointed out already in <a href="#HC07">[HC07]</a>.  First, i1 can contain any type of information propagated by the authenticator, whereas i2 is restricted to information that can be carried in AAA attributes. Second, because the authenticator typically communicates over different link layers with the peer and the AAA infrastructure, different type of identifiers and addresses may have been presented to both communication endpoints. Whether these different identifiers and addresses belong to the same device cannot be directly checked by the EAP server or AAA server without additional information. Finally, i2 may be different from the original information sent by the authenticator because of en route processing or malicious modifications.  As a result, in the service provider model, typically the i1 information available to the EAP server can only be verified against the last-hop portion of i2, or values propagated by proxy servers. In addition, checking the consistency of i1 and i2 alone is insufficient because an authenticator could lie to both, the peer and the EAP server, i.e. i1 and i2 may be consistent but both contain false information.</p>
<p id="rfc.section.5.2.p.3">A local database is required to leverage the above mentioned shortcomings and support the consistency and validation checks. In particular, information stored for each NAS/authenticator (enterprise scenario) or each roaming partner (service provider scenario) enables a comparison of any information received in i1 with AAA attributes in i2 as well as additionally stored AAA attributes that might have gone lost in transition. Furthermore, only such a database enables the EAP server and AAA server to check the received information against trusted information about the network including roaming agreements. </p>
<p><a href="#l2bindings">Section 7</a> describes lower-layer specific properties that can be exchanged as a part of i1.  <a href="#aaabind">Section 8</a> describes specific AAA attributes that can be included and evaluated in i2. The EAP server reports back the results from the channel binding validation check that compares the consistency of all the values with those in the local database. The challenges of setting up such a local database are discussed in <a href="#OMcons">Section 10</a>.</p>
<h1 id="rfc.section.5.3">
<a href="#rfc.section.5.3">5.3.</a> <a href="#PROTOCOL" id="PROTOCOL">EAP Protocol</a>
</h1>
<p id="rfc.section.5.3.p.1">EAP methods supporting channel binding consistent with this specification provide a mechanism for carrying channel binding data from the peer to the EAP server and a channel binding response from the EAP server to the peer. The specifics of this mechanism are dependent on the method, although the content of the channel binding data and channel binding response are defined by this section.</p>
<p id="rfc.section.5.3.p.2">Typically the lower layer will communicate a set of attributes to the EAP implementation on the peer that should be part of channel binding. The EAP implementation may need to indicate to the lower layer that channel binding information cannot be sent. Reasons for failing to send channel binding information include an EAP method that does not support channel binding is selected, or channel binding data is too big for the EAP method selected. Peers SHOULD provide appropriate policy controls to select channel binding or mandate its success.</p>
<p id="rfc.section.5.3.p.3">The EAP server receives the channel binding data and performs the validation. The EAP method provides a way to return a response; the channel binding response uses the same basic format as the channel binding data.</p>
<p id="rfc.section.5.3.p.4">XXX Nice figure goes here. Both the channel binding data and response use the following format. The protocol starts with a one byte code; see <a href="#P.CODES">Section 5.3.1</a>. Then for each type of attributes contained in the channel binding data, the following information is encoded: </p>

<dl>
<dt>NSID:</dt>
<dd style="margin-left: 8">One octet describing the namespace from which the attributes are drawn. See <a href="#P.RADIUS">Section 5.3.3</a> for a description of   how to encode RADIUS attributes in channel binding data and responses. RADIUS uses a namespace identifier of 0.</dd>
<dt>len:</dt>
<dd style="margin-left: 8">two octets of length in network byte order, not including the length or the namespace ID.</dd>
<dt>NSSPECIFIC:</dt>
<dd style="margin-left: 8">The encoding of the attributes in a manner specific to the type of attribute.</dd>
</dl>

<p> </p>
<p id="rfc.section.5.3.p.5">A given NSID MUST NOT appear more than once in a channel binding data or channel binding response.</p>
<p id="rfc.section.5.3.p.6">In channel binding data, the code is set to 0 (channel binding data) and the full attributes and values are included. In a channel binding response, the server selects the code; see <a href="#P.CODES">Section 5.3.1</a>. The server includes any attributes that were considered in making the channel binding decision. The server SHOULD only include the attributes but not their values. In some cases, a server may not have information sufficient to know where the attribute stops and the value starts; as an example, consider attribute containers such as the RADIUS vendor-specific attribute. For this reason and for future extensibility, clients MUST ignore any values sent in the channel binding response.</p>
<h1 id="rfc.section.5.3.1">
<a href="#rfc.section.5.3.1">5.3.1.</a> <a href="#P.CODES" id="P.CODES">Channel Binding Codes</a>
</h1>
<div id="#rfc.table.1"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<thead><tr>
<th class="left">Code</th>
<th class="left">Meaning</th>
</tr></thead>
<tbody>
<tr>
<td class="left">0</td>
<td class="left">Channel Binding data from client</td>
</tr>
<tr>
<td class="left">1</td>
<td class="left">Channel binding success</td>
</tr>
<tr>
<td class="left">2</td>
<td class="left">Channel binding failure</td>
</tr>
</tbody>
</table>
<h1 id="rfc.section.5.3.2">
<a href="#rfc.section.5.3.2">5.3.2.</a> <a href="#P.NSID" id="P.NSID">Namespace Identifiers</a>
</h1>
<div id="#rfc.table.2"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<thead><tr>
<th class="left">ID</th>
<th class="left">Namespace</th>
<th class="left">Reference</th>
</tr></thead>
<tbody>
<tr>
<td class="left">0</td>
<td class="left">RADIUS</td>
<td class="left"><a href="#P.RADIUS">Section 5.3.3</a></td>
</tr>
<tr>
<td class="left">255</td>
<td class="left">Private Use</td>
<td class="left"></td>
</tr>
</tbody>
</table>
<h1 id="rfc.section.5.3.3">
<a href="#rfc.section.5.3.3">5.3.3.</a> <a href="#P.RADIUS" id="P.RADIUS">Radius Namespace</a>
</h1>
<p id="rfc.section.5.3.3.p.1">RADIUS attribute-value pairs (AVPs) are encoded with a one-octet attribute type followed by a one-octet length followed by  the value of the RADIUS attribute being encoded. The length includes the type and length octets; the minimum legal length is 2 for an attribute with no value. Attributes are concatenated to form the namespace specific portion of the packet.</p>
<p id="rfc.section.5.3.3.p.2">XXX nice figure goes here.</p>
<p id="rfc.section.5.3.3.p.3">The full value of an attribute is included in the channel binding data. For most attributes, none of the value is included in a channel binding response. However for attributes such as the vendor-specific attribute that include sub-attributes, enough information SHOULD be included to identify the sub-attribute. This means that the internal lengths SHOULD be 0 but the attribute information is included. Some RADIUS container specifications forbid sending attributes with no value. This prohibition not withstanding, these attributes SHOULD be sent with no value in channel binding responses. XXX example figure of a RFC-style VSA in a channel binding response.</p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#sysreq" id="sysreq">System Requirements</a>
</h1>
<p id="rfc.section.6.p.1">This section defines requirements on components used to implement the channel bindings protocol.</p>
<p id="rfc.section.6.p.2">The channel binding protocol defined in this document MUST be transported after keying material has been derived between the EAP peer and server, and before the peer would suffer adverse affects from joining an adversarial network. This document describes a protocol for performing channel binding within EAP methods. As discussed in <a href="#SAP">Section 4.2</a>, an alternative approach for meeting this requirement is to perform channel bindings during the secure association protocol of the lower layer.</p>
<h1 id="rfc.section.6.1">
<a href="#rfc.section.6.1">6.1.</a> <a href="#req_tranport" id="req_tranport">General Transport Protocol Requirements</a>
</h1>
<p id="rfc.section.6.1.p.1">The transport protocol for carrying channel binding information MUST support end-to-end (i.e. between the EAP peer and server) message integrity protection to prevent the adversarial NAS or AAA device from manipulating the transported data.  The transport protocol SHOULD provide confidentiality.  The motivation for this that the channel bindings could contain private information, including peer identities, which SHOULD be protected.  If confidentiality cannot be provided, private information MUST NOT be sent as part of the channel binding information.</p>
<p id="rfc.section.6.1.p.2">Any transport needs to be careful not to exceed the MTU for its lower-layer medium.  In particular, if channel binding information is exchanged within protected EAP method channels, these methods may or may not support fragmentation.  In order to work with all methods, the channel binding messages must fit within the available payload.  For example, if the EAP MTU is 1020 octets, and EAP-GPSK is used as the authentication method, and maximal-length identities are used, a maximum of 384 octets are available for conveying channel binding information.  Other methods, such as EAP-TTLS, support fragmentation and could carry significantly longer payloads.</p>
<h1 id="rfc.section.6.2">
<a href="#rfc.section.6.2">6.2.</a> EAP Method Requirements</h1>
<p id="rfc.section.6.2.p.1">If transporting data directly within an EAP method, it MUST be able to carry integrity protected data from the EAP peer to server.  EAP methods SHOULD provide a mechanism to carry protected data from server to peer.  EAP methods MUST exchange channel binding data with the AAA subsystem hosting the EAP server.  EAP methods MUST be able to import channel binding data from the lower layer on the EAP peer.</p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> <a href="#l2bindings" id="l2bindings">Channel Binding TLV</a>
</h1>
<p id="rfc.section.7.p.1">This section defines some channel binding TLVs. While message i1 is not limited to AAA attributes, for the sake of tangible attributes that are already in place, this section discusses AAA AVPs that are appropriate for carrying channel bindings (i.e. data from i1 in <a href="#chbp">Section 5</a>). In particular, attributes for IEEE 802.11 are provided, which can be used as a template for developing bindings for other EAP lower-layer protocols. </p>
<p id="rfc.section.7.p.2">For any lower-layer protocol, network information of interest to the peer and server can be encapsulated in AVPs or other defined payload containers.  The appropriate AVPs depend on the lower layer protocol as well as on the network type (i.e. enterprise network or service provider network) and its application. Additional TLV types can be defined beyond AAA AVPs.  For example it may be useful to define TLVs that can carry 802.11 information elements. </p>
<h1 id="rfc.section.7.1">
<a href="#rfc.section.7.1">7.1.</a> Requirements for Lower-Layer Bindings</h1>
<p id="rfc.section.7.1.p.1">Lower-layer protocols MUST support EAP in order to support EAP channel bindings.  These lower layers MUST support EAP methods that derive keying material, as otherwise no integrity-protected channel would be available to execute the channel bindings protocol.  Lower-layer protocols need not support traffic encryption, since this is independent of the authentication phase.  </p>
<p id="rfc.section.7.1.p.2">The data conveyed within the AVP type MUST NOT conflict with the externally-defined usage of the AVP. Additional TLV types SHOULD be defined for values that are not communicated within AAA attributes.</p>
<h1 id="rfc.section.7.2">
<a href="#rfc.section.7.2">7.2.</a> General Attributes</h1>
<p id="rfc.section.7.2.p.1">This section lists AAA AVPs useful to all link-layers.  The peer SHOULD transmit to the server the following fields, encapsulated within the appropriate AVPs:</p>
<p></p>

<dl>
<dt>NAS-Port-Type:</dt>
<dd style="margin-left: 8">Indicates the underlying link-layer technology used to connect (e.g. IEEE 802.11, PPP, etc), and SHOULD be included by the EAP peer, and SHOULD be verified against the database and NAS-Port-Type received from the NAS.  <br><br>
</dd>
</dl>
<h1 id="rfc.section.7.3">
<a href="#rfc.section.7.3">7.3.</a> IEEE 802.11</h1>
<p id="rfc.section.7.3.p.1">The peer SHOULD transmit to the server the following fields, encapsulated within the appropriate AVPs:</p>
<p></p>

<dl>
<dt>Called-Station-Id:</dt>
<dd style="margin-left: 8">contains BSSID and SSID and SHOULD be verified against the database and Called-Station-Id received from the NAS <br><br>
</dd>
</dl>
<h1 id="rfc.section.7.3.1">
<a href="#rfc.section.7.3.1">7.3.1.</a> IEEE 802.11r</h1>
<p id="rfc.section.7.3.1.p.1">In addition to the AVPs for IEEE 802.11, an IEEE 802.11r client SHOULD transmit the following additional field:</p>
<p></p>

<dl>
<dt>Mobility-Domain-Id:</dt>
<dd style="margin-left: 8">contains the identity of the mobility domain and SHOULD be verified against the database and Mobility-Domain-Id received from the NAS <a href="#I-D.aboba-radext-wlan">[I-D.aboba-radext-wlan]</a>
</dd>
</dl>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> <a href="#aaabind" id="aaabind">AAA-Layer Bindings</a>
</h1>
<p id="rfc.section.8.p.1">This section discusses which AAA attributes in a AAA Accept-Request messages can and should be validated by a AAA server (i.e. data from i2 in  <a href="#chbp">Section 5</a>).  As noted before, this data can be manipulated by AAA proxies either to enable functionality (e.g. removing realm information after messages have been proxied) or maliciously (e.g. in the case of a lying provider).  As such, this data cannot always be easily validated.  However as thorough of a validation as possible should be conducted in an effort to detect possible attacks.</p>
<p></p>

<dl>
<dt>User-Name:</dt>
<dd style="margin-left: 8">This value should be checked for consistency with the database and any method-specific user information.  If EAP method identity protection is employed, this value typically contains a pseudonym or keyword.  <br><br>
</dd>
<dt>NAS-IP-Address:</dt>
<dd style="margin-left: 8">This value is typically the IP address of the authenticator, but in a proxied connection it likely will not match the source IP address of an Access-Request.  A consistency check MAY verify the subnet of the IP address was correct based on the last-hop proxy.  <br><br>
</dd>
<dt>NAS-IPv6-Address:</dt>
<dd style="margin-left: 8">This value is typically the IPv6 address of the authenticator, but in a proxied connection it likely will not match the source IPv6 address of an Access-Request.  A consistency check MAY verify the subnet of the IPv6 address was correct based on the last-hop proxy.  <br><br>
</dd>
<dt>Called-Station-Id:</dt>
<dd style="margin-left: 8">This is typically the MAC address of the NAS.  On an enterprise network, it MAY be validated against the MAC address is one that has been provisioned on the network.  <br><br>
</dd>
<dt>Calling-Station-Id:</dt>
<dd style="margin-left: 8">This is typically the MAC address of the EAP peer, and verification of this is likely difficult, unless EAP credentials have been provisioned on a per-host basis to specific L2 addresses.  It SHOULD be validated against the database in an enterprise deployment.  <br><br>
</dd>
<dt>NAS-Identifier:</dt>
<dd style="margin-left: 8">This is an identifier populated by the NAS, and could be related to the MAC address, and should be validated similarly to the Called-Station-Id.  <br><br>
</dd>
<dt>NAS-Port-Type:</dt>
<dd style="margin-left: 8">This specifies the underlying link technology.  It SHOULD be validated against the value received from the peer in the information exchange, and against a database of authorized link-layer technologies.</dd>
</dl>
<h1 id="rfc.section.9">
<a href="#rfc.section.9">9.</a> <a href="#seccons" id="seccons">Security Considerations</a>
</h1>
<p id="rfc.section.9.p.1">This section discusses security considerations surrounding the use of EAP channel bindings.</p>
<h1 id="rfc.section.9.1">
<a href="#rfc.section.9.1">9.1.</a> <a href="#trustmodel" id="trustmodel">Trust Model</a>
</h1>
<p id="rfc.section.9.1.p.1">In the considered  trust model, EAP peer and authentication server are honest while the authenticator is maliciously sending false information to peer and/or server.  In the model, the peer and server trust each other, which is not an unreasonable assumption, considering they already have a trust relationship.  The following are the trust relationships:</p>
<p></p>

<ul>
<li>The server trusts that the channel binding information received from the peer is the information that the peer	received from the authenticator.</li>
<li>The peer trusts the channel binding result received from the server.</li>
<li>The server trusts the information contained within its local database.</li>
</ul>
<p id="rfc.section.9.1.p.3">In order to establish the first two trust relationships during an EAP execution, an EAP method needs to provide the following:</p>
<p></p>

<ul>
<li>mutual authentication between peer and server</li>
<li>derivation of keying material including a key for integrity protection of channel binding messages</li>
<li>sending i1 from peer to server over an integrity-protected channel</li>
<li>sending the result and optionally i2 from server to peer over an integrity-protected channel</li>
</ul>
<h1 id="rfc.section.9.2">
<a href="#rfc.section.9.2">9.2.</a> Consequences of Trust Violation</h1>
<p id="rfc.section.9.2.p.1">If any of the trust relationships listed in <a href="#trustmodel">Section 9.1</a> are violated, channel binding cannot be provided. In other words, if mutual authentication with key establishment as part of the EAP method as well as protected database access are not provided, then achieving channel binding is not feasible.</p>
<p id="rfc.section.9.2.p.2">Dishonest peers can only manipulate the first message i1 of the channel binding protocol.  In this scenario, a peer sends i1&#8217; to the server. If i1&#8217; is invalid, the channel binding validation will fail.  On the other hand if i1&#8217; passes the validation, either the original i1 was wrong and i1&#8217; corrected the problem or both i1 and i1&#8217; constitute valid information.  A peer could potentially gain an advantage in auditing or charging if both are valid and information from i1 is used for auditing or charging. Such peers can be detected by including the information in i2 and checking i1 against i2.</p>
<p id="rfc.section.9.2.p.3">Dishonest servers can send EAP-Failure messages and abort the EAP authentication even if the received i1 is valid.  However, servers can always abort any EAP session independent of whether channel binding is offered or not.  On the other hand, dishonest servers can claim a successful validation even if i1 contains invalid information.  This can be seen as collaboration of authenticator and server.  Channel binding can neither prevent nor detect such attacks.  In general such attacks cannot be prevented by cryptographic means and should be addressed using policies making servers liable for their provided information and services.</p>
<p id="rfc.section.9.2.p.4">Additional network entities (such as proxies) might be on the communication path between peer and server and may attempt to manipulate the channel binding protocol. If these entities do not possess the keying material used for integrity protection of the channel binding messages, the same threat analysis applies as for the dishonest authenticators.  Hence, such entities can neither manipulate single channel binding messages nor the outcome.  On the other hand, entities with access to the keying material must be treated like a server in a threat analysis.  Hence such entities are able to manipulate the channel binding protocol without being detected.  However, the required knowledge of keying material is unlikely since channel binding is executed before the EAP method is completed, and thus before keying material is typically transported to other entities.</p>
<h1 id="rfc.section.9.3">
<a href="#rfc.section.9.3">9.3.</a> Privacy Violations</h1>
<p id="rfc.section.9.3.p.1">While the channel binding information exchanged between EAP peer and EAP server (i.e. i1 and the optional result message) must always be integrity-protected it may not be encrypted. In the case that these messages contain identifiers of peer and/or network entities, the privacy property of the executed EAP method may be violated. Hence, in order to maintain the privacy of an EAP method, the exchanged channel binding information must be encrypted.  If encryption is not available, private information is not sent as part of the channel binding information, as described in <a href="#req_tranport">Section 6.1</a>. </p>
<h1 id="rfc.section.10">
<a href="#rfc.section.10">10.</a> <a href="#OMcons" id="OMcons">Operations and Management Considerations</a>
</h1>
<p id="rfc.section.10.p.1">As with any extension to existing protocols, there will be an impact on existing systems.  Typically the goal is to develop an extension that minimizes the impact on both development and deployment of the new system, subject to the system requirements.  This section  discusses the impact on existing devices that currently utilize EAP, assuming the channel binding information is transported within the EAP method execution.</p>
<p id="rfc.section.10.p.2">The EAP peer will need an API between the EAP lower layer and the EAP method that exposes the necessary information from the NAS to be validated to the EAP peer, which can then feed that information into the EAP methods for transport.  For example, an IEEE 802.11 system would need to make available the various information elements that require validation to the EAP peer which would properly format them and pass them to the EAP method.  Additionally, the EAP peer will require updated EAP methods that support transporting channel binding information.  While most method documents are written modularly to allow incorporating arbitrary protected information, implementations of those methods would need to be revised to support these extensions.  Driver updates are also required so methods can access the required information.</p>
<p id="rfc.section.10.p.3">No changes to the pass-through authenticator would be required.</p>
<p id="rfc.section.10.p.4">The EAP server would need an API between the database storing NAS information and the individual EAP server.  The database may  already exist on the AAA server in which case the EAP server passes the parameters to the AAA server for validation. The EAP methods need to be able to export received channel binding information to the EAP server so it can be validated.</p>
<h1 id="rfc.section.11">
<a href="#rfc.section.11">11.</a> <a href="#ianacons" id="ianacons">IANA Considerations</a>
</h1>
<p id="rfc.section.11.p.1">A new top level registry is created for "EAP Channel Binding Parameters." This registry consists of several sub registries.</p>
<p id="rfc.section.11.p.2">The "Channel Binding Codes" registry defines values for the code field in the channel binding data and channel binding response packet. See the table in <a href="#P.CODES">Section 5.3.1</a> for initial registrations. This registry requires standards action <a href="#RFC5226">[RFC5226]</a> for new registrations. Early allocation is allowed. An additional reference column should be added to the table for the registry, pointing all codes in the initial registration to this specification.</p>
<p id="rfc.section.11.p.3">The "Channel Binding Namespaces" sub-registry contains registrations for the NSID field in the channel binding data and channel binding response. Initial registrations are found in the table in <a href="#P.NSID">Section 5.3.2</a>. Registrations in this registry require IETF review.</p>
<h1 id="rfc.section.12">
<a href="#rfc.section.12">12.</a> Acknowledgements</h1>
<p id="rfc.section.12.p.1">The authors and editor would like to thank Bernard Aboba, Glen Zorn, Joe Salowey, and Klaas Wierenga for their valuable inputs that helped to improve and shape this document over the time.</p>
<p id="rfc.section.12.p.2">Sam hartman's work on this specification is funded by JANET(UK).</p>
<h1 id="rfc.references">
<a href="#rfc.references">13.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">13.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3748">[RFC3748]</b></td>
<td class="top">
<a>Aboba, B.</a>, <a>Blunk, L.</a>, <a>Vollbrecht, J.</a>, <a>Carlson, J.</a> and <a>H. Levkowetz</a>, "<a href="http://tools.ietf.org/html/rfc3748">Extensible Authentication Protocol (EAP)</a>", RFC 3748, June 2004.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5226">[RFC5226]</b></td>
<td class="top">
<a>Narten, T.</a> and <a>H. Alvestrand</a>, "<a href="http://tools.ietf.org/html/rfc5226">Guidelines for Writing an IANA Considerations Section in RFCs</a>", BCP 26, RFC 5226, May 2008.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">13.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="I-D.aboba-radext-wlan">[I-D.aboba-radext-wlan]</b></td>
<td class="top">
<a>Aboba, B</a>, <a>Malinen, J</a>, <a>Congdon, P</a> and <a>J Salowey</a>, "<a href="http://tools.ietf.org/html/draft-aboba-radext-wlan-15">RADIUS Attributes for IEEE 802 Networks</a>", Internet-Draft draft-aboba-radext-wlan-15, October 2011.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.clancy-emu-aaapay">[I-D.clancy-emu-aaapay]</b></td>
<td class="top">
<a>Clancy, T.</a>, <a>Lior, A.</a> and <a>G. Zorn</a>, "<a>EAP Method Support for Transporting AAA Payloads</a>", Internet Draft draft-clancy-emu-aaapay-02, May 2009.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4006">[RFC4006]</b></td>
<td class="top">
<a>Hakala, H.</a>, <a>Mattila, L.</a>, <a>Koskinen, J-P.</a>, <a>Stura, M.</a> and <a>J. Loughney</a>, "<a href="http://tools.ietf.org/html/rfc4006">Diameter Credit-Control Application</a>", RFC 4006, August 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4017">[RFC4017]</b></td>
<td class="top">
<a>Stanley, D.</a>, <a>Walker, J.</a> and <a>B. Aboba</a>, "<a href="http://tools.ietf.org/html/rfc4017">Extensible Authentication Protocol (EAP) Method Requirements for Wireless LANs</a>", RFC 4017, March 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5056">[RFC5056]</b></td>
<td class="top">
<a>Williams, N.</a>, "<a href="http://tools.ietf.org/html/rfc5056">On the Use of Channel Bindings to Secure Channels</a>", RFC 5056, November 2007.</td>
</tr>
<tr>
<td class="reference"><b id="HC07">[HC07]</b></td>
<td class="top">
<a>Hoeper, K.</a> and <a>L. Chen</a>, "<a>Where EAP Security Claims Fail</a>", ICST QShine, August 2007.</td>
</tr>
<tr>
<td class="reference"><b id="80211U-D4.01">[80211U-D4.01]</b></td>
<td class="top">
<a>Information technology - Telecommunications and information exchange between systems - Local and metropolitan area networks - Specific requirements - Part 11: Wireless LAN Medium Access Control (MAC) and Physical Layer (PHY) specifications - Amendment 7: Interworking with External Networks</a>", IEEE Draft Standard 802.11u, November 2008.</td>, "</tr>
<tr>
<td class="reference"><b id="I-D.ietf-abfab-gss-eap">[I-D.ietf-abfab-gss-eap]</b></td>
<td class="top">
<a>Hartman, S</a> and <a>J Howlett</a>, "<a href="http://tools.ietf.org/html/draft-ietf-abfab-gss-eap-04">A GSS-API Mechanism for the Extensible Authentication Protocol</a>", Internet-Draft draft-ietf-abfab-gss-eap-04, October 2011.</td>
</tr>
</tbody></table>
<h1 id="rfc.appendix.Appendix A">
<a href="#rfc.appendix.Appendix%20A">Appendix A.</a> Attacks Prevented by Channel Bindings</h1>
<p id="rfc.section.Appendix A.p.1">In the following it is demonstrated how the presented channel bindings can prevent attacks by malicious authenticators (representing the lying NAS problem) as well as malicious visited networks (representing the lying provider problem).</p>
<h1 id="rfc.appendix.Appendix A.1">
<a href="#rfc.appendix.Appendix%20A.1">Appendix A.1.</a> Enterprise Subnetwork Masquerading</h1>
<p id="rfc.section.Appendix A.1.p.1">As outlined in <a href="#probstate">Section 3</a>, an enterprise network may have multiple VLANs providing different levels of security. In an attack, a malicious NAS connecting to a guest network with lesser security protection could broadcast the SSID of a subnetwork with higher protection. This could lead peers to believe that they are accessing the network over secure connections, and, e.g., transmit confidential information that they normally would not send over a weakly protected connection. This attack works under the conditions that peers use the same set of credentials to authenticate to the different kinds of VLANs and that the VLANs support at least one common EAP method. If these conditions are not met, the EAP server would not authorize the peers to connect to the guest network, because the peers used credentials and/or an EAP method that is associated with the corporate network.</p>
<h1 id="rfc.appendix.Appendix A.2">
<a href="#rfc.appendix.Appendix%20A.2">Appendix A.2.</a> Forced Roaming</h1>
<p id="rfc.section.Appendix A.2.p.1">Mobile phone providers boosting their cell tower's transmission power to get more users to use their networks have occurred in the past. The increased transmission range combined with a NAS sending a false network identity lures users to connect to the network without being aware of that they are roaming. </p>
<p id="rfc.section.Appendix A.2.p.2">Channel bindings would detect the bogus network identifier because the network identifier send to the authentication server in i1 will neither match information i2 nor the stored data. The verification fails because the info in i1 claims to come from the peer&#8217;s home network while the home authentication server knows that the connection is through a visited network outside the home domain. In the same context, channel bindings can be utilized to provide a "home zone" feature that notifies users every time they are about to connect to a NAS outside their home domain.</p>
<h1 id="rfc.appendix.Appendix A.3">
<a href="#rfc.appendix.Appendix%20A.3">Appendix A.3.</a> Downgrading attacks</h1>
<p id="rfc.section.Appendix A.3.p.1">A malicious authenticator could modify the set of offered EAP methods in its Beacon to force the peer to choose from only the weakest EAP method(s) accepted by the authentication server. For instance, instead of having a choice between EAP-MD5-CHAP, EAP-FAST and some other methods, the authenticator reduces the choice for the peer to the weaker EAP-MD5-CHAP method. Assuming that weak EAP methods are supported by the authentication server, such a downgrading attack can enable the authenticator to attack the integrity and confidentiality of the remaining EAP execution and/or break the authentication and key exchange.  The presented channel bindings prevent such downgrading attacks, because peers submit the offered EAP method selection that they have received in the beacon as part of i1 to the authentication server. As a result, the authentication server recognizes the modification when comparing the information to the respective information in its policy database.</p>
<h1 id="rfc.appendix.Appendix A.4">
<a href="#rfc.appendix.Appendix%20A.4">Appendix A.4.</a> Bogus Beacons in IEEE 802.11r</h1>
<p id="rfc.section.Appendix A.4.p.1">In IEEE 802.11r, the SSID is bound to the TSK calculations, so that the TSK needs to be consistent with the SSID advertised in an authenticator&#8217;s Beacon. While this prevents outsiders from spoofing a Beacon it does not stop a "lying NAS" from sending a bogus Beacon and calculating the TSK accordingly.</p>
<p id="rfc.section.Appendix A.4.p.2">By implementing channel bindings, as described in this draft, in IEEE 802.11r, the verification by the authentication server would detect the inconsistencies between the information the authenticator has sent to the peer and the information the server received from the authenticator and stores in the policy database.</p>
<h1 id="rfc.appendix.Appendix A.5">
<a href="#rfc.appendix.Appendix%20A.5">Appendix A.5.</a> Forcing false authorization in IEEE 802.11i</h1>
<p id="rfc.section.Appendix A.5.p.1">In IEEE 802.11i a malicious NAS can modify the beacon to make the peer believe it is connected to a network different from the on the peer is actually connected to.</p>
<p id="rfc.section.Appendix A.5.p.2">In addition, a malicious NAS can force an authentication server into authorizing access by sending an incorrect Called-Station-ID that belongs to an authorized NAS in the network. This could cause the authentication server to believe it had granted access to a different network or even provider than the one the peer got access to.</p>
<p id="rfc.section.Appendix A.5.p.3">Both attacks can be prevented by implementing channel bindings, because the server can compare the information that was sent to the peer, with information it received from the authenticator during the AAA communication as well as the information stored in the policy database.</p>
<h1 id="rfc.appendix.Appendix B">
<a href="#rfc.appendix.Appendix%20B">Appendix B.</a> Change History</h1>
<p id="rfc.section.Appendix B.p.1">RFC editor, remove this section prior to publication.</p>
<h1 id="rfc.appendix.Appendix B.1">
<a href="#rfc.appendix.Appendix%20B.1">Appendix B.1.</a> Changes since Version 06</h1>
<p id="rfc.section.Appendix B.1.p.1">The purpose of this revision is to provide a specific candidate protocol for channel binding data and channel binding responses.</p>
<h1 id="rfc.appendix.Appendix B.2">
<a href="#rfc.appendix.Appendix%20B.2">Appendix B.2.</a> Changes since version 04</h1>
<p></p>

<ul>
<li>Clarify examples in introduction.</li>
<li>In problem statement note that one EAP server may deal with both enterprise and provider networks.</li>
<li>Update discussion of the architecture. Talk about channel bindings as a mechanism to introduce levels of trust.</li>
<li>Indicate that this document is focusing on EAP channel bindings within methods while trying to do a better job of describing the SAP approach in more detail.</li>
<li>Claim that we're using the encoding from draft-clancy-emu-aaapay. The WG almost certainly doesn't have consensus on this, but in the interest of actually describing what the protocol might be like, it is a good straw-man proposal.</li>
<li>Update protocol description.</li>
</ul>

<p> </p>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Sam Hartman</span> editor
	  <span class="n hidden">
		<span class="family-name">Hartman</span>
	  </span>
	</span>
	<span class="org vcardline">Painless Security</span>
	<span class="adr">
	  <span>356 Abbott ST</span>

	  <span class="vcardline">
		<span class="locality">North Andover</span>,  
		<span class="region">MA</span> 
		<span class="code">01845</span>
	  </span>
	  <span class="country-name vcardline">USA</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:hartmans-ietf@mit.edu">hartmans-ietf@mit.edu</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">T. Charles Clancy</span> 
	  <span class="n hidden">
		<span class="family-name">Clancy</span>
	  </span>
	</span>
	<span class="org vcardline">Electrical and Computer Engineering</span>
	<span class="adr">
	  <span>Virginia Tech</span>

	  <span class="vcardline">
		<span class="locality">Arlington</span>,  
		<span class="region">VA</span> 
		<span class="code">22203</span>
	  </span>
	  <span class="country-name vcardline">USA</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:tcc@vt.edu">tcc@vt.edu</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Katrin Hoeper</span> 
	  <span class="n hidden">
		<span class="family-name">Hoeper</span>
	  </span>
	</span>
	<span class="org vcardline">Motorola, Inc.</span>
	<span class="adr">
	  <span>1301 E. Algonquin Road</span>

	  <span class="vcardline">
		<span class="locality">Schaumburg</span>,  
		<span class="region">IL</span> 
		<span class="code">60196</span>
	  </span>
	  <span class="country-name vcardline">USA</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:khoeper@motorola.com">khoeper@motorola.com</a></span>

  </address>
</div>

</body>
</html>