<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>CPace, a balanced composable PAKE</title>
<meta content="Michel Abdalla" name="author">
<meta content="Bjoern Haase" name="author">
<meta content="Julia Hesse" name="author">
<meta content="
       This document describes CPace which is a protocol for two
      parties that share a low-entropy secret (password) to derive a strong shared key without 
      disclosing the secret to offline dictionary attacks. This method was tailored for constrained devices,
      is compatible with any group of both prime- and non-prime order,
       and comes with  a security proof providing composability guarantees. 
    " name="description">
<meta content="xml2rfc 3.9.1" name="generator">
<meta content="draft-irtf-cfrg-cpace-02" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.9.1
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.5.1
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.6.3
    pycountry 20.7.3
    pyflakes 2.3.1
    PyYAML 5.4.1
    requests 2.26.0
    setuptools 57.4.0
    six 1.16.0
-->
<link href="/tmp/draft-irtf-cfrg-cpace-02-zuxhfaor.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">CPace, a balanced composable PAKE</td>
<td class="right">July 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Abdalla, et al.</td>
<td class="center">Expires 25 January 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-irtf-cfrg-cpace-02</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2021-07" class="published">July 2021</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-01-25">25 January 2022</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">M. Abdalla</div>
<div class="org">DI, École Normale Supérieure, Paris</div>
</div>
<div class="author">
      <div class="author-name">B. Haase</div>
<div class="org">Endress + Hauser Liquid Analysis</div>
</div>
<div class="author">
      <div class="author-name">J. Hesse</div>
<div class="org">IBM, Zürich Research Laboratory</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">CPace, a balanced composable PAKE</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document describes CPace which is a protocol for two
      parties that share a low-entropy secret (password) to derive a strong shared key without 
      disclosing the secret to offline dictionary attacks. This method was tailored for constrained devices,
      is compatible with any group of both prime- and non-prime order,
       and comes with  a security proof providing composability guarantees.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 2 January 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="ulEmpty toc compact ulBare">
<li class="ulEmpty toc compact ulBare" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
</li>
          <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="xref">2</a>.  <a href="#name-requirements-notation" class="xref">Requirements Notation</a></p>
</li>
          <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-definition-cpace" class="xref">Definition  CPace</a></p>
<ul class="ulEmpty ulBare toc compact">
<li class="ulEmpty ulBare toc compact" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1" class="keepWithNext"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-setup" class="xref">Setup</a></p>
</li>
              <li class="ulEmpty ulBare toc compact" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-protocol-flow" class="xref">Protocol Flow</a></p>
</li>
              <li class="ulEmpty ulBare toc compact" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-cpace" class="xref">CPace</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-ciphersuites" class="xref">Ciphersuites</a></p>
<ul class="ulEmpty ulBare toc compact">
<li class="ulEmpty ulBare toc compact" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-cpace-x25519-elligator2_sha" class="xref">CPACE-X25519-ELLIGATOR2_SHA512-SHA512</a></p>
</li>
              <li class="ulEmpty ulBare toc compact" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-cpace-p256-sswu_sha256-sha2" class="xref">CPACE-P256-SSWU_SHA256-SHA256</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
</li>
          <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
</li>
          <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-acknowledgments" class="xref">Acknowledgments</a></p>
</li>
          <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-references" class="xref">References</a></p>
<ul class="ulEmpty ulBare toc compact">
<li class="ulEmpty ulBare toc compact" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="xref">8.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
              <li class="ulEmpty ulBare toc compact" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="xref">8.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#appendix-A" class="xref">Appendix A</a>.  <a href="#name-cpace25519-test-vectors" class="xref">CPace25519 Test Vectors</a></p>
<ul class="ulEmpty ulBare toc compact">
<li class="ulEmpty ulBare toc compact" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#appendix-A.1" class="xref">A.1</a>.  <a href="#name-x25519-test-vectors" class="xref">X25519 test vectors</a></p>
</li>
              <li class="ulEmpty ulBare toc compact" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#appendix-A.2" class="xref">A.2</a>.  <a href="#name-elligator2-test-vectors" class="xref">Elligator2 test vectors</a></p>
</li>
              <li class="ulEmpty ulBare toc compact" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a href="#appendix-A.3" class="xref">A.3</a>.  <a href="#name-test-vectors-for-the-secret" class="xref">Test vectors for the secret generator G</a></p>
</li>
              <li class="ulEmpty ulBare toc compact" id="section-toc.1-1.9.2.4">
                <p id="section-toc.1-1.9.2.4.1"><a href="#appendix-A.4" class="xref">A.4</a>.  <a href="#name-test-vectors-for-cpace-dh" class="xref">Test vectors for CPace DH</a></p>
</li>
              <li class="ulEmpty ulBare toc compact" id="section-toc.1-1.9.2.5">
                <p id="section-toc.1-1.9.2.5.1"><a href="#appendix-A.5" class="xref">A.5</a>.  <a href="#name-test-vectors-for-intermedia" class="xref">Test vectors for intermediate session key generation</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-B" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="intro">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">This document describes CPace which is a protocol for two
      parties that share a low-entropy secret (password) to derive a to derive a strong shared key without 
      disclosing the secret to offline dictionary attacks. 
      
      This preliminary working version is a renamed version of the earlier draft-haase-cpace-01 
      with minor corrections. It has been uploaded for starting the work in the newly formed team 
      of editors (M. Abdalla, B. Haase, J. Hesse) and did not yet see a detailed review by M. 
      Abdalla and J. Hesse.
      
      The CPace method was tailored for constrained devices and
      specifically considers efficiency and hardware side-channel attack mitigations at the protocol level.
      CPace is designed to be compatible with any group of both prime- and non-prime order and explicitly
      handles the complexity of cofactor clearing on the protcol level. CPace
      comes with a security proof providing composability guarantees. As a protocol, CPace is designed
      to be compatible with so-called "x-coordinate-only" Diffie-Hellman implementations on elliptic curve
      groups.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2"> CPace is designed to be suitable as both, a building block within a larger protocol construction using CPace as substep, 
        and as a standalone protocol.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3"> It is considered, that for composed larger protocol constructions, the CPace subprotocol might be best executed in a 
        separate cryptographic hardware, such as secure element chipsets. The CPace protocol design aims at considering 
        the resulting constraints.<a href="#section-1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="notation">
<section id="section-2">
      <h2 id="name-requirements-notation">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-requirements-notation" class="section-name selfRef">Requirements Notation</a>
      </h2>
<p id="section-2-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
        NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED",
        "MAY", and "OPTIONAL" in this document are to be interpreted as
        described in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span>
        when, and only when, they
        appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="definition">
<section id="section-3">
      <h2 id="name-definition-cpace">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-definition-cpace" class="section-name selfRef">Definition  CPace</a>
      </h2>
<div id="setup">
<section id="section-3.1">
        <h3 id="name-setup">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-setup" class="section-name selfRef">Setup</a>
        </h3>
<p id="section-3.1-1">Let C be a group in which there exists a subgroup of prime order p where 
          the strong computational simultaneous Diffie-Hellman (sSDH) and the strong Diffie-Hellman problem (sCDH)
          problem <span>[<a href="#VTBPEKE" class="xref">VTBPEKE</a>]</span> is hard. C has order p*c where p is a large prime;
          c  will be called the cofactor. Let I be the unit element in
          C, e.g., the point at infinity in if C is an elliptic curve group. 
          We denote the operations in the group using addition and multiplication operators, e.g. P + (P + P) = P + 2 * P = 3 * P. 
          We refer to a sequence of n additions of an element in P as scalar multiplication by n and use the notation 
          scalar_multiply(P,n).<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2"> 
          With F we denote a field that may be associated with C, e.g. the prime base field used for representing the coordinates 
          of points on an elliptic curve.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<p id="section-3.1-3">
          We assume that for any element P in C there is a representation modulo negation, 
          encode_group_element_mod_neg(P) as a byte string such 
          that for any Q in C with Q != P and Q != -P, encode_group_element_mod_neg(P) != encode_group_element_mod_neg(Q). 
          It is recommended that encodings of the elements P and -P share the same result string.

          Common choices would be a fixed (per-group) length encoding 
          of the x-coordinate of points on an
          elliptic curve C or its twist C' in Weierstrass form, e.g. according to <span>[<a href="#IEEE1363" class="xref">IEEE1363</a>]</span> in case of
          short Weierstrass form curves. 
          For curves in Montgomery form correspondingly the 
          u-coordinate would be encoded, as specified, e.g., by the encodeUCoordinate function from <span>[<a href="#RFC7748" class="xref">RFC7748</a>]</span>.<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<p id="section-3.1-4"> With J we denote the group modulo negation associated to C. Note that in J the scalar multiplication operation 
           scalar_multiply
           is well defined since scalar_multiply(P,s) == -scalar_multiply(-P,s) while arbitrary additions of group elements 
           are no longer available.<a href="#section-3.1-4" class="pilcrow">¶</a></p>
<p id="section-3.1-5"> 
          With J' be denote a second group modulo negation that might share the byte-string encoding function
          encode_group_element_mod_neg with J 
          such for a given byte string 
          either an element in J or J' is encoded. If the x-coordinate of an elliptic curve point group is used for the encoding,
          J' would commonly be corresponding to the group of points on
          the elliptic curve's quadratic twist. Correspondingly, with p' we denote the largest prime factor of the order 
          of J' and its cofactor with c'.<a href="#section-3.1-5" class="pilcrow">¶</a></p>
<p id="section-3.1-6"> Let scalar_cofactor_clearing(s) be a cofactor clearing function taking an integer input argument and 
           returning an integer as result. 
           For any s, scalar_cofactor_clearing(s) is REQUIRED to be of the form c * s1. I.e. 
           it MUST return a multiple of the cofactor. An example of such a function may be the cofactor
           clearing and clamping functions decodeScalar25519 and decodeScalar448 as used in the X25519 and X448 protocols 
           definitions of <span>[<a href="#RFC7748" class="xref">RFC7748</a>]</span>.
           In case of prime-order groups with c == 1, it is RECOMMENDED to use the identity function 
           with scalar_cofactor_clearing(s) = s.<a href="#section-3.1-6" class="pilcrow">¶</a></p>
<p id="section-3.1-7">
          Let scalar_mult_cc(P,s) be a joint "scalar multiplication and cofactor clearing" function of an integer s and 
          an string-encoded value P, where P could represent an element either on J or J'. If P is an element in J or J', 
          the scalar_mult_cc function returns a string encoding of an element in J or J' respectively, such that the result of 
          scalar_mult_cc(P,s) encodes (scalar_cofactor_clearing(s) * P).<a href="#section-3.1-7" class="pilcrow">¶</a></p>
<p id="section-3.1-8">
          Let scalar_mult_ccv(P,s) be a "scalar multiplication cofactor clearing and verify" function of an integer s and an 
          encoding of a group element P. Unlike scalar_mult_cc, scalar_mult_ccv additionally
          carries out a verification that checks that the computational simultaneous Diffie-Hellman problem (SDH) is hard in the
          subgroup (in J or J') generated by the encoded element SP = scalar_mult_cc(P,s).
          In case that the verification fails (SP might be of low order or on the wrong curve), 
          scalar_mult_ccv is REQUIRED to return the encoding of the identity element I.
          Otherwise scalar_mult_ccv(P,S) is REQUIRED to return the result of scalar_mult_cc(P,s).
 
          A common choice for scalar_mult_ccv for Montgomery curves with twist security would be the 
          X25519 and X448 Diffie-Hellman functions as specified in <span>[<a href="#RFC7748" class="xref">RFC7748</a>]</span>.
          For curves in short Weierstrass form, scalar_mult_ccv could be implemented by the combination of a point verification
          of the input point with a scalar multiplication. Here scalar_mult_ccv SHALL return the encoding of the neutral 
          element I if the input point P was not on the curve C.<a href="#section-3.1-8" class="pilcrow">¶</a></p>
<p id="section-3.1-9">
          Let P=map_to_group_mod_neg(r) be a mapping operation that maps a string r to an encoding 
          of an element P in J. 
          Common choices
          would be the combination of map_to_base and map_to_curve methods as defined in 
          the hash2curve draft <span>[<a href="#HASH2CURVE" class="xref">HASH2CURVE</a>]</span>.
          Note that we don't require and RECOMMEND cofactor clearing here 
          since this complexity is already included in the definition of the scalar multiplication operation calar_mult_cc above. 
          Additionally requiring cofactor clearing also in map_to_group_mod_neg() would result in efficiency loss.<a href="#section-3.1-9" class="pilcrow">¶</a></p>
<p id="section-3.1-10">|| denotes concatenation of strings. We also let len(S) denote the
          length of a string in bytes. Finally, let nil represent an empty string, i.e.,
          len(nil) = 0.<a href="#section-3.1-10" class="pilcrow">¶</a></p>
<p id="section-3.1-11"> Let H(m) be a hash function from
          arbitrary strings m to bit strings of a fixed length. Common choices
          for H are SHA256 or SHA512 <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span>. H is assumed to segment messages m into blocks m_i of byte length H_block.
          E.g. the blocks used in SHA512 have a size of 128 bytes.<a href="#section-3.1-11" class="pilcrow">¶</a></p>
<p id="section-3.1-12"> Let strip_sign_information(P) be function that takes a string encoding of an element P in J and strips any information
            regarding the sign of P, such that strip_sign_information(P) = strip_sign_information(-P). 
            For short Weierstrass (Montgomery) curves this function will return a string 
            encoding the x-coordinate (u-coordinate).
            The purpose of defining this function is for allowing for x-coordinate only scalar multiplication algorithms. 
            The sign is to be stripped before generating the intermediate session key ISK.<a href="#section-3.1-12" class="pilcrow">¶</a></p>
<p id="section-3.1-13"> With ISK we denote the intermediate session key output string provided by CPace that is 
            generated by a hash operation on the Diffie-Hellman result. It is RECOMMENDED to apply ISK 
            to a KDF function prior to using the key in a higher-level protocol.<a href="#section-3.1-13" class="pilcrow">¶</a></p>
<p id="section-3.1-14">KDF(Q) is a key-derivation function that takes an string and derives key of length L. A common choice for a KDF would be 
           HMAC-SHA512.<a href="#section-3.1-14" class="pilcrow">¶</a></p>
<p id="section-3.1-15"> With DSI we denote domain-separation identifier strings that may be prepended to the inputs of Hash and KDF functions.<a href="#section-3.1-15" class="pilcrow">¶</a></p>
<p id="section-3.1-16">Let A and B be two parties. A and B may also have digital
          representations of the parties' identities such as Media Access Control addresses
          or other names (hostnames, usernames, etc). We denote the parties' representation and the parties themselves both
          by using the identifiers A and B.<a href="#section-3.1-16" class="pilcrow">¶</a></p>
<p id="section-3.1-17"> With prepend_len(byte_sequence) we denote the byte sequence that is obtained from prepending
            the length of the byte sequence as an utf-8 to the byte sequence itself. (This will prepend one
            single byte for sequences shorter than 128 bytes and more bytes otherwise)<a href="#section-3.1-17" class="pilcrow">¶</a></p>
<p id="section-3.1-18"> With CI we denote an OPTIONAL string containing information on the communication channel.
            If knowledge on the identies is known before protocol start for both parties,
            CI is RECOMMENDED to be formed by the concatenation of the identifiers A and B and 
            an an OPTIONAL associated data string, each with prepended length. 
            AD includes information which A and B might want to authenticate in the 
            protocol execution. CI = prepend_len(A) || prepend_len(B) || prepend_len(AD);
            
            One other possibility for CI data might be an encoding of the concatenation of MAC-addresses 
            of both communication partners.

            AD might include a list of supported protocol versions if CPace were
            used in a higher-level protocol which negotiates use of a particular version. Including
            this list would ensure that both parties agree upon the same set of supported protocols
            and therefore prevent downgrade attacks.<a href="#section-3.1-18" class="pilcrow">¶</a></p>
<p id="section-3.1-19"> We also assume that A and B share a common encoding of a password related string PRS.
          Typically PRS is derived from a low-entropy secret such as a user-supplied password (pw) or a personal identification
          by PRS = prepend_len(pw)
          Note that CPace is NOT RECOMMENDED to be used in conjunction with user datbases that include more than 
          one user account. CPace does not provide
          mechanisms for agreeing on user names, deriving salt values and agreeing on workload parameters, as required by the
          memory hard iterated hash functions that should be used for such databases. 
          In such settings it is RECOMMENDED to use CPace as a subcomponent of the higher-level AuCPace protocol.<a href="#section-3.1-19" class="pilcrow">¶</a></p>
<p id="section-3.1-20">Let sid be a session id byte string chosen for each protocol session before protocol execution; 
           The length len(sid) SHOULD be larger or equal to 16 bytes.<a href="#section-3.1-20" class="pilcrow">¶</a></p>
<p id="section-3.1-21"> With ZPAD we denote a zero-padding string that is appended to PRS such that DSI||PRS has a length of at least 
            H_block. 
            CPace aims at mixing in
            entropy of PRS into the full internal state of the hash function before any adversary-known variable information (ADVI) 
            enters the hashing algorithm. ADVI such as party identities or session IDs might be partially controlled by an adversary. 
            Correlations of ADVI with the bare PRS string are considered to be easier exploitable by side-channel methods in comparison
            to a pre-hashed representation of PRS.<a href="#section-3.1-21" class="pilcrow">¶</a></p>
</section>
</div>
<div id="flow">
<section id="section-3.2">
        <h3 id="name-protocol-flow">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-protocol-flow" class="section-name selfRef">Protocol Flow</a>
        </h3>
<p id="section-3.2-1">CPace is a one round protocol to establish an intermediate shared secret ISK 
          with implicit mutual authentication.
          Prior to invocation, A and B are provisioned with public (CI) and secret
          information (PRS) as prerequisite for running the protocol. 
          During the first round, A sends a public share Ya 
          to B, and B responds with its own public share Yb. 
          Both A and B then derive a shared secret ISK. ISK is meant to be
          used for producing encryption and authentication keys by a KDF function
          outside of the scope of CPace.
 
          Prior to entering the protocol, A and B agree on a sid string.
          sid is typically pre-established by a higher-level protocol 
          invocing CPace. If no such sid is available from a higher-level
          protocol, a suitable approach is to let A choose a fresh random sid 
          string and send it to B together with Ya. This method is shown in the
          setup protocol section below.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">This sample trace is shown below.<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.2-3">
<pre>
                A                  B
                | (setup protocol  |
  (sample sid)  |     and sid)     |
                |-----------------&gt;|
       ---------------------------------------
                |                  |
  (compute Ya)  |        Ya        |
                |-----------------&gt;|
                |        Yb        | (compute Yb)
                |&lt;-----------------|
                |   (verify data)  |
                |   (derive ISK)   |

</pre><a href="#section-3.2-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="cpace">
<section id="section-3.3">
        <h3 id="name-cpace">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-cpace" class="section-name selfRef">CPace</a>
        </h3>
<p id="section-3.3-1"> Both parties start with agreed values on the sid string, the channel identifier CI and the password-related string PRS.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2"> The channel identifier, CI, SHOULD include an encoding of the communication channel used by both parties A and B, 
            such as, e.g., IP and port numbers of both parties.<a href="#section-3.3-2" class="pilcrow">¶</a></p>
<p id="section-3.3-3"> To begin, A calculates a generator G = map_to_group_mod_neg(DSI1 || PRS || ZPAD || sid || CI).<a href="#section-3.3-3" class="pilcrow">¶</a></p>
<p id="section-3.3-4"> A picks ya randomly and uniformly according to the requirement of the group J
            and calculates Ya=scalar_mult_cc (G,ya). A then transmits Ya to B.<a href="#section-3.3-4" class="pilcrow">¶</a></p>
<p id="section-3.3-5"> B picks yb randomly and uniformly. B then calculates 
            G = map_to_group_mod_neg(DSI1 || PRS || ZPAD || sid || CI) and
           Yb = scalar_mult_cc(G,yb). B then calculates K = scalar_mult_ccv(Ya,yb). 
           B MUST abort if K is the encoding of the neutral element I.
           Otherwise B sends Yb to A and proceeds as follows.

           B strips the sign information from K, Ya and Yb  to obtain the strings Ks, Yas and Ybs by 
           using the strip_sign_information() function.
           B returns ISK = H(DSI2 || sid || Ks || Yas || Ybs).<a href="#section-3.3-5" class="pilcrow">¶</a></p>
<p id="section-3.3-6"> Upon reception of Yb, A calculates K = scalar_mult_ccv(Yb,ya). A MUST abort if K is the neutral element I.
            If K is different from I, A strips the sign information from K, Ya and Yb and 
            returns ISK = H(DSI2 || sid || Ks || Yas || Ybs).<a href="#section-3.3-6" class="pilcrow">¶</a></p>
<p id="section-3.3-7">K and Ks are shared values, though they MUST NOT be used as a shared secret key.
          Note that calculation of ISK from Ks includes the protocol transcript and
          prevents key malleability with respect to man-in-the-middle attacks from active adversaries.<a href="#section-3.3-7" class="pilcrow">¶</a></p>
<p id="section-3.3-8">Upon completion of this protocol, the session key ISK returned by A and B will be identical by both
           parties if and only if the supplied input parameters sid, PRS and CI match on both sides and the information
           on the public elements in J were not modified by an adversary.<a href="#section-3.3-8" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="Ciphersuites">
<section id="section-4">
      <h2 id="name-ciphersuites">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-ciphersuites" class="section-name selfRef">Ciphersuites</a>
      </h2>
<p id="section-4-1">
            This section documents CPACE ciphersuite configurations. A ciphersuite
            is REQUIRED to specify all of,<a href="#section-4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-2.1">a group modulo negation J with an associated encode_group_element_mod_neg function<a href="#section-4-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-2.2">scalar_mult_cc(P,s) and scalar_mult_ccv(P,s) functions operating on encodings of 
                      elements P in J<a href="#section-4-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-2.3"> a mapping function map_to_group_mod_neg(r) converting byte strings r into elements in J<a href="#section-4-2.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-2.4"> a strip_sign_information(Q) function operating on string representations of elements Q<a href="#section-4-2.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-2.5"> a hash function H<a href="#section-4-2.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-2.6"> and domain separation strings DSI1, DSI2<a href="#section-4-2.6" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-4-3">
            Currently, detailed specifications are available for 
            CPACE-X25519-ELLIGATOR2_SHA512-SHA512 and
            CPACE-P256-SSWU_SHA256-SHA256. These cipher suites 
            are specifically designed for suitability also
            with constrained hardware. It is recommended that cipher suites for
            short Weierstrass curves are specified in line with the corresponding definitions
            for NIST-P256. Cipher suites for modern Montgomery or Edwards curves 
            are recommended to be specified in line with the definitions for Curve25519.<a href="#section-4-3" class="pilcrow">¶</a></p>
<span id="name-cpace-ciphersuites"></span><div id="cpace_ciphersuites">
<table class="center" id="table-1">
        <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-cpace-ciphersuites" class="selfRef">CPace Ciphersuites</a>
        </caption>
<thead>
          <tr>
            <th class="text-center" rowspan="1" colspan="1">J</th>
            <th class="text-center" rowspan="1" colspan="1">map_to_group_mod_neg</th>
            <th class="text-center" rowspan="1" colspan="1">KDF</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">X25519</td>
            <td class="text-center" rowspan="1" colspan="1">ELLIGATOR2_SHA512 </td>
            <td class="text-center" rowspan="1" colspan="1">SHA512 <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span>
</td>
          </tr>
          <tr>
            <td class="text-center" rowspan="1" colspan="1">NIST P-256</td>
            <td class="text-center" rowspan="1" colspan="1">SSWU_SHA256 <span>[<a href="#HASH2CURVE" class="xref">HASH2CURVE</a>]</span>
</td>
            <td class="text-center" rowspan="1" colspan="1">SHA256 <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span>
</td>
          </tr>
        </tbody>
      </table>
</div>
<section id="section-4.1">
        <h3 id="name-cpace-x25519-elligator2_sha">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-cpace-x25519-elligator2_sha" class="section-name selfRef">CPACE-X25519-ELLIGATOR2_SHA512-SHA512</a>
        </h3>
<p id="section-4.1-1">      
      This cipher suite targets particularly constrained targets and implements specific optimizations.
      It uses the group of points on the Montgomery curve Curve25519 for constructing J. The base field F is the 
      prime field built upon the prime 2^255 - 19.
      The Diffie-Hellmann protocol X25519 and the group are specified in <span>[<a href="#RFC7748" class="xref">RFC7748</a>]</span>. 
      The encode_group_element_mod_neg(P) is implemented by the encodeUCoordinate(P) function defined in <span>[<a href="#RFC7748" class="xref">RFC7748</a>]</span>. 
      The neutral element I is encoded as a 32 byte zero-filled string.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2"> The domain separation strings are defined as DSI1 = "CPace25519-1", DSI2 = "CPace25519-2" 
         (twelve-byte ASCII encoding without ANSI-C style trailing zeros).<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1-3"> Both, scalar_mult_cc and scalar_mult_ccv, are implemented by the X25519 function specified in <span>[<a href="#RFC7748" class="xref">RFC7748</a>]</span>.<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1-4"> The secret scalars ya and yb used for X25519 shall be sampled as uniformly distributed 32 byte strings.<a href="#section-4.1-4" class="pilcrow">¶</a></p>
<p id="section-4.1-5"> The map_to_group_mod_neg function is implemented as follows. First the byte length of the ZPAD zero-padding string is determined
         such that len(ZPAD) = max(0, H_block_SHA512 - len(DSI1 || PRS)), with H_block_SHA512 = 128 bytes. 
         Then a byte string u is calculated by use of u = SHA512(DSI1||PRS||ZPAD||sid||CI). The resulting string is interpreted
         as 512-bit integer in little-endian format according to the definition of decodeLittleEndian() from <span>[<a href="#RFC7748" class="xref">RFC7748</a>]</span>. 
         The resulting integer is then reduced to the base field as input to the Elligator2 map specified in <span>[<a href="#HASH2CURVE" class="xref">HASH2CURVE</a>]</span>
         to yield the secret generator G = Elligator2(u).<a href="#section-4.1-5" class="pilcrow">¶</a></p>
<p id="section-4.1-6"> CPace25519 returns a session key ISK of 64 bytes length by a single invocation of SHA512(DSI2||sid||K||Ya||Yb). 
         Since the encoding does not incorporate the sign
         from the very beginning Qs = strip_sign_information(Q) == Q for this cipher suite.<a href="#section-4.1-6" class="pilcrow">¶</a></p>
<p id="section-4.1-7"> The following sage code could be used as reference implementation for the mapping and key derivation functions.<a href="#section-4.1-7" class="pilcrow">¶</a></p>
<div id="section-4.1-8">
<pre class="sourcecode">&lt;CODE BEGINS&gt;

def littleEndianStringToInteger(k):
    bytes = [ord(b) for b in k]
    return sum((bytes[i] &lt;&lt; (8 * i)) for i in range(len(bytes)))

def map_to_group_mod_neg_CPace25519(sid, PRS, CI):
    m = hashlib.sha512()
    p = 2^255 - 19

    H_block_SHA512 = 128
    DSI1 = b"CPace25519-1"
    ZPAD_len = max(0,H_block_SHA512 - len(CI) - len(PRS))
    ZPAD = ZPAD_len * "\0"

    m.update(DSI1)
    m.update(PRS)
    m.update(ZPAD)
    m.update(sid)
    m.update(CI)
    u = littleEndianStringToInteger(m.digest())
    return map_to_curve_elligator2_curve25519(u % p)

def generate_ISK_CPace25519(sid,K,Ya,Yb):
    m = hashlib.sha512(b"CPace25519-2")
    m.update(sid)
    m.update(K)
    m.update(Ya)
    m.update(Yb)
    return m.digest()


&lt;CODE ENDS&gt;</pre><a href="#section-4.1-8" class="pilcrow">¶</a>
</div>
<p id="section-4.1-9">

        The definitions above aim at making the protocol suitable for outsourcing CPace to
        secure elements (SE) where nested hash function constructions such as defined in <span>[<a href="#RFC5869" class="xref">RFC5869</a>]</span> 
        have to be considered to be particularly costly. 
        As a result, the task of generating session keys by a strong KDF function is left out of the scope 
        of the CPace protocol. This fact is expressed by the naming of the intermediate shared Key ISK.

        The definitions above regarding the mapping deviate from the definition in the 
        encode_to_curve function from <span>[<a href="#HASH2CURVE" class="xref">HASH2CURVE</a>]</span> by significantly reducing the amount of hash invocations. 

        Moreover, the CPace protocol specification, unlike 
        the hash-to-curve draft specification also considers the risk of side-channel leakage during the hashing of PRS by introducing
        the ZPAD padding.
        Mitigating attacks of an adversary that analyzes correlations between publicly known information with the low-entropy PRS
        strings was considered relevant in important settings. 

        We also avoid the overhead of redundant cofactor clearing, by making the Diffie-Hellman protocol responsible for this task 
        (and not the mapping algorithm). 

        Due to its use in Ed25519 <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>, SHA512 is considered to be the natural hash choice for Curve25519.
        The 512 bit output of SHA512 moreover allows for removing any statistical bias stemming from the non-canonical base field
        representations, such that the overhead of the HKDF_extract/HKDF_expand sequences from <span>[<a href="#HASH2CURVE" class="xref">HASH2CURVE</a>]</span> 
        are considered not necessary (in line with the assessments regarding Curve25519 in <span>[<a href="#HASH2CURVE" class="xref">HASH2CURVE</a>]</span>).<a href="#section-4.1-9" class="pilcrow">¶</a></p>
</section>
<section id="section-4.2">
        <h3 id="name-cpace-p256-sswu_sha256-sha2">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-cpace-p256-sswu_sha256-sha2" class="section-name selfRef">CPACE-P256-SSWU_SHA256-SHA256</a>
        </h3>
<p id="section-4.2-1">      
      This cipher suite targets applications that do not as agressively focus on efficiency, bandwidth and code size as the 
      Curve25519 implementation. Instead it aims at reusing existing encoding and curve standards wherever possible.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">
      It uses the group of points on the NIST P-256 curve which is defined in short Weierstrass form 
      for constructing J <span>[<a href="#RFC5480" class="xref">RFC5480</a>]</span>. The base field F is the 
      prime field built upon the Solinas prime p = 2^256-2^224+2^192+2^96-1.

      Encoding of full group elements requires both, x and y coordinates. In order to facilitate point
      validation and in order to be in line with recent TLS 1.3 requirements, implementations MUST encode 
      both, x and y coordinates. It is RECOMMENDED to use the
      uncompressed format from <span>[<a href="#SEC1" class="xref">SEC1</a>]</span> using the 0x04 octet prefix. The strip_sign_information() function
      returns the substring from the SEC1 representation encoding the x-coordinate of the curve point.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2-3"> NIST P-256 is of prime order and does not require cofactor clearing. The scalar_cofactor_clearing function is the
          identity function with scalar_cofactor_clearing(s) == s<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<p id="section-4.2-4"> The domain separation strings are defined as DSI1 = "CPace-P256-1", DSI2 = "CPace-P256-2".<a href="#section-4.2-4" class="pilcrow">¶</a></p>
<p id="section-4.2-5"> For the scalar_mult_cc function operating on the internally generated points, 
         a conventional scalar multiplication on P-256 is used, i.e. without the need of further
         verification checks.
         The scalar_mult_ccv function that operates on remotely generated points includes the mandatory verification as follows. 
         First from the encoded point
         the x and y coordinates are decoded. These points are used for verifying the curve equation. If the point is not on the curve,
         scalar_mult_ccv returns the neutral element I. If the point is on the curve, scalar_mult_ccv calls scalar_mult_cc and returns
         the result of the scalar multiplication.<a href="#section-4.2-5" class="pilcrow">¶</a></p>
<p id="section-4.2-6"> For P-256, the map_to_group_mod_neg function is implemented as follows. The zero-padding string length is calculated as 
         len(ZPAD) = max(0, H_block_SHA256 - len(DSI1 || PRS)) with H_block_SHA256 = 64.
         For the mapping to the curve, a 32 byte string 
         U1 = SHA256(DSI1 || PRS || ZPAD || sid || CI) is calculated. From U1 a second 32 byte value is calculated as U2 = SHA256(U1).
         The concatenation of U1 and U2 is interpreted as a 512 bit integer u by use of the 
         u = OS2IP(U1 || U2) function from <span>[<a href="#HASH2CURVE" class="xref">HASH2CURVE</a>]</span>. 
         This value is reduced to a 32 byte representation of a field element fu = u % p. The coordinates (x,y) in F  
         of the secret generator G are calculated as (x,y) = map_to_curve_simple_swu_3mod4(fu) function 
         from <span>[<a href="#HASH2CURVE" class="xref">HASH2CURVE</a>]</span>.<a href="#section-4.2-6" class="pilcrow">¶</a></p>
<p id="section-4.2-7"> As hash function H SHA256 is chosen, returning a session key ISK of 32 bytes length with 
         ISK=SHA256(DSI2 || sid || Ks || Yas || Ybs).<a href="#section-4.2-7" class="pilcrow">¶</a></p>
<p id="section-4.2-8"> The following sage code could be used as reference implementation for the mapping and key derivation functions.<a href="#section-4.2-8" class="pilcrow">¶</a></p>
<div id="section-4.2-9">
<pre class="sourcecode">&lt;CODE BEGINS&gt;

def map_to_group_mod_neg_CPace_P256(sid, PRS, CI):
    m = hashlib.sha256()

    H_block_SHA256 = 64
    DSI1 = b"CPace-P256-1"
    ZPAD_len = max(0,H_block_SHA256 - len(CI) - len(PRS))
    ZPAD = ZPAD_len * "\0"

    m.update(DSI1)
    m.update(PRS)
    m.update(ZPAD)
    m.update(sid)
    m.update(CI)
    U1 = m.digest()
    U2 = hashlib.sha256(U1).digest()
    u = OS2I(U1 + U2)
    return map_to_curve_simple_swu_3mod4(u)

def generate_ISK_CPace_P256(sid,K,Ya,Yb):
    m = hashlib.sha256(b"CPace-P256-2")
    m.update(sid)
    m.update(strip_sign_information(K))
    m.update(strip_sign_information(Ya))
    m.update(strip_sign_information(Yb))
    return m.digest()


&lt;CODE ENDS&gt;</pre><a href="#section-4.2-9" class="pilcrow">¶</a>
</div>
<p id="section-4.2-10">

        Similarly to the Curve25519 implementation, the definitions above aim at making the protocol suitable for outsourcing to
        secure elements where hash function invocations have to be considered to be particularly costly. 
        As a result, the task of generating session keys by a strong KDF function is left out of the scope 
        of the CPace protocol. The naming of ISK as intermediate shared key reflects this fact.
        Also the method for calculating the generator has been optimized for reducing the number of hash calculations in comparison
        to the suggestions <span>[<a href="#HASH2CURVE" class="xref">HASH2CURVE</a>]</span>.<a href="#section-4.2-10" class="pilcrow">¶</a></p>
</section>
</section>
</div>
<section id="section-5">
      <h2 id="name-security-considerations">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-5-1">A security proof of CPace is found in <span>[<a href="#cpace_paper" class="xref">cpace_paper</a>]</span>.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">Elements received from a peer MUST be checked by a proper implementation of the scalar_mult_ccv method. 
          Failure to properly validate group elements can lead to attacks. The Curve25519-based cipher suite employs
          the twist security feature of the curve for point validation. 
          As such, it is mandatory to check that all low-order points on both
          the curve and the twist are
          mapped on the neutral element by the X25519 function. Corresponding test vectors are provided in the 
          appendix.<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">The choices of random numbers MUST be uniform. Randomly generated values (e.g., ya and yb)
          MUST NOT be reused.<a href="#section-5-3" class="pilcrow">¶</a></p>
<p id="section-5-4">CPace is NOT RECOMMENDED to be used in conjunction with applications supporting different username/password pairs. 
         In this case it is RECOMMENDED to use CPace as building block of the augmented AuCPace protocol  <span>[<a href="#aucpace_paper" class="xref">aucpace_paper</a>]</span>.<a href="#section-5-4" class="pilcrow">¶</a></p>
<p id="section-5-5">If CPace is used as a building block of higher-level protocols, it is RECOMMENDED that sid
         is generated by the higher-level protocol and passed to CPace. It is RECOMMENDED sid, 
         is generated by sampling ephemeral random strings.<a href="#section-5-5" class="pilcrow">¶</a></p>
<p id="section-5-6">Since CPace is designed to be used as a building block in higher-level protocols and for 
         compatibility with constrained hardware, 
         it does not by itself include a strong KDF construction. CPace uses a simple hash operation for generating its 
         intermediate key ISK.
         It is RECOMMENDED that the ISK is post-processed by a KDF according the needs of the higher-level protocol. In case
         that the CPace protocol is delegated to a secure element hardware, it is RECOMMENDED that the main processing unit
         applies a KDF to the externally generated ISK.<a href="#section-5-6" class="pilcrow">¶</a></p>
<p id="section-5-7">In case that side-channel attacks are to be considered practical for a given application, it is RECOMMENDED to focus
         side-channel protections such as masking and redundant execution (faults) on the process of calculating
         the secret generator G. The most critical aspect to consider is the processing of the first block of the hash that includes 
         the PRS string. The CPace protocol construction considers the fact that side-channel protections of hash functions might 
         be particularly resource hungry. For this reason, CPace aims at minimizing the number of hash functions invocations in the 
         specified mapping method.<a href="#section-5-7" class="pilcrow">¶</a></p>
<p id="section-5-8">CPace is proven secure under the hardness of the computational Simultaneous Diffie-Hellmann (SDH) 
         assumption in the group J (as defined in <span>[<a href="#VTBPEKE" class="xref">VTBPEKE</a>]</span>). 
         Still, even for the event that large-scale quantum computers (LSQC) will become available, CPace forces an active 
         adversary to solve one CDH per password guess. Using the wording suggested by Steve Thomas on the CFRG mailing list,
         CPace is "quantum-annoying".<a href="#section-5-8" class="pilcrow">¶</a></p>
</section>
<section id="section-6">
      <h2 id="name-iana-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-6-1">No IANA action is required.<a href="#section-6-1" class="pilcrow">¶</a></p>
</section>
<section id="section-7">
      <h2 id="name-acknowledgments">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="section-7-1"> Thanks
         to the members of the CFRG for
        comments and advice. Any comment and advice is appreciated.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2"> Comments are specifically invited regarding
        the following aspect. The CPace mapping function design is based on the following
        assessments. 1.) Masked, hardware-side-channel-protected hash function implementations 
        should be considered highly desirable for the calculation of the generators G if an implementation
        might be exposed to physical attacks. 
        2.) The complexity of such protected hash implementations (possibly with lots of boolean-arithmetic 
        masking conversions) was assessed critical for constrained hardware. Hash operation complexity
        was also assessed to be critical for secure element
        chipsets that often were assessed to run hash operations in software without hardware accellerator support.<a href="#section-7-2" class="pilcrow">¶</a></p>
<p id="section-7-3"> 
        This assessment is not in line with the assumptions for the hash-to-curve-05 draft.
        As a consequence, this draft aimed at more aggressively reducing the number of nested hash 
        function invocations in comparison to the suggestions of the hash-to-curve-05 draft.<a href="#section-7-3" class="pilcrow">¶</a></p>
</section>
<section id="section-8">
      <h2 id="name-references">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-8.1">
        <h3 id="name-normative-references">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="SEC1">[SEC1]</dt>
        <dd>
<span class="refAuthor">SEC</span>, <span class="refTitle">"STANDARDS FOR EFFICIENT CRYPTOGRAPHY, "SEC 1: Elliptic Curve Cryptography", version 2.0"</span>, <time datetime="2009-05" class="refDate">May 2009</time>, <span>&lt;<a href="http://www.sec.org/sec1-v2.pdf">http://www.sec.org/sec1-v2.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd><dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd><dt id="RFC5480">[RFC5480]</dt>
        <dd>
<span class="refAuthor">Turner, S.</span>, <span class="refAuthor">Brown, D.</span>, <span class="refAuthor">Yiu, K.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">T. Polk</span>, <span class="refTitle">"Elliptic Curve Cryptography Subject Public Key Information"</span>, <span class="seriesInfo">RFC 5480</span>, <span class="seriesInfo">DOI 10.17487/RFC5480</span>, <time datetime="2009-03" class="refDate">March 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5480">https://www.rfc-editor.org/info/rfc5480</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5869">[RFC5869]</dt>
        <dd>
<span class="refAuthor">Krawczyk, H.</span> and <span class="refAuthor">P. Eronen</span>, <span class="refTitle">"HMAC-based Extract-and-Expand Key Derivation Function (HKDF)"</span>, <span class="seriesInfo">RFC 5869</span>, <span class="seriesInfo">DOI 10.17487/RFC5869</span>, <time datetime="2010-05" class="refDate">May 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5869">https://www.rfc-editor.org/info/rfc5869</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6234">[RFC6234]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span> and <span class="refAuthor">T. Hansen</span>, <span class="refTitle">"US Secure Hash Algorithms (SHA and SHA-based HMAC and HKDF)"</span>, <span class="seriesInfo">RFC 6234</span>, <span class="seriesInfo">DOI 10.17487/RFC6234</span>, <time datetime="2011-05" class="refDate">May 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6234">https://www.rfc-editor.org/info/rfc6234</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7748">[RFC7748]</dt>
        <dd>
<span class="refAuthor">Langley, A.</span>, <span class="refAuthor">Hamburg, M.</span>, and <span class="refAuthor">S. Turner</span>, <span class="refTitle">"Elliptic Curves for Security"</span>, <span class="seriesInfo">RFC 7748</span>, <span class="seriesInfo">DOI 10.17487/RFC7748</span>, <time datetime="2016-01" class="refDate">January 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7748">https://www.rfc-editor.org/info/rfc7748</a>&gt;</span>. </dd>
<dd class="break"></dd><dt id="RFC8032">[RFC8032]</dt>
        <dd>
<span class="refAuthor">Josefsson, S.</span> and <span class="refAuthor">I. Liusvaara</span>, <span class="refTitle">"Edwards-Curve Digital Signature Algorithm (EdDSA)"</span>, <span class="seriesInfo">RFC 8032</span>, <span class="seriesInfo">DOI 10.17487/RFC8032</span>, <time datetime="2017-01" class="refDate">January 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8032">https://www.rfc-editor.org/info/rfc8032</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="HASH2CURVE">[HASH2CURVE]</dt>
        <dd>
<span class="refAuthor">Faz-Hernandez, A.</span>, <span class="refAuthor">Scott, S.</span>, <span class="refAuthor">Sullivan, N.</span>, <span class="refAuthor">Wahby, R.</span>, and <span class="refAuthor">C. Wood</span>, <span class="refTitle">"draft-irtf-cfrg-hash-to-curve-05"</span>, <time datetime="2019" class="refDate">2019</time>. <span class="annotation">IRTF draft standard
          </span>
        </dd>
<dd class="break"></dd>
<dt id="IEEE1363">[IEEE1363]</dt>
      <dd>
<span class="refAuthor">IEEE</span>, <span class="refTitle">""Standard Specifications for Public Key Cryptography", IEEE 1363"</span>, <time datetime="2000" class="refDate">2000</time>. <span class="annotation">IEEE 1363
          </span>
        </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-8.2">
        <h3 id="name-informative-references">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="cpace_paper">[cpace_paper]</dt>
        <dd>
<span class="refAuthor">Abdalla, M.</span>, <span class="refAuthor">Haase, B.</span>, and <span class="refAuthor">J. Hesse</span>, <span class="refTitle">"Security analysis of CPace."</span>, <time datetime="2021-01" class="refDate">January 2021</time>. <span class="annotation">eprint.iacr.org/2021/114
          </span>
        </dd>
<dd class="break"></dd>
<dt id="aucpace_paper">[aucpace_paper]</dt>
        <dd>
<span class="refAuthor">Haase, B.</span> and <span class="refAuthor">B. Labrique</span>, <span class="refTitle">"AuCPace. PAKE protocol tailored for the use in the internet of things."</span>, <time datetime="2018-02" class="refDate">February 2018</time>. <span class="annotation">eprint.iacr.org/2018/286
          </span>
        </dd>
<dd class="break"></dd><dt id="VTBPEKE">[VTBPEKE]</dt>
        <dd>
<span class="refAuthor">Pointcheval, D.</span> and <span class="refAuthor">G. Wang</span>, <span class="refTitle">"VTBPEKE: Verifier-based Two-Basis Password ExponentialKey Exchange"</span>, <time datetime="2017" class="refDate">2017</time>. <span class="annotation">Proceedings of the 2017 {ACM} on Asia Conference on Computer and Communications
               Security, AsiaCCS 2017
          </span>
        </dd>
<dd class="break"></dd></dl>
</section>
</section>
<section id="appendix-A">
      <h2 id="name-cpace25519-test-vectors">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-cpace25519-test-vectors" class="section-name selfRef">CPace25519 Test Vectors</a>
      </h2>
<p id="appendix-A-1">  The test vectors for CPace25519 consist of three blocks.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<p id="appendix-A-2"> First test vectors for X25519 are provided which is used as
          combined scalar multiplication, cofactor clearing and verification
          function. Specifically, test vectors for the small order points
          are provided for checking that all small order points are mapped to
          the neutral element<a href="#appendix-A-2" class="pilcrow">¶</a></p>
<p id="appendix-A-3"> Then test vectors for the Elligator2 primitive are provided.<a href="#appendix-A-3" class="pilcrow">¶</a></p>
<p id="appendix-A-4"> Then test vectors for the encoding of the secret generator are provided combining
          the hash operation and the encoding of the generator.<a href="#appendix-A-4" class="pilcrow">¶</a></p>
<p id="appendix-A-5">
          Finally test vectors for a honest party protocol execution are provided, including
          derivation of the session key ISK.<a href="#appendix-A-5" class="pilcrow">¶</a></p>
<section id="appendix-A.1">
        <h3 id="name-x25519-test-vectors">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-x25519-test-vectors" class="section-name selfRef">X25519 test vectors</a>
        </h3>
<div class="artwork art-text alignLeft" id="appendix-A.1-1">
<pre>
########################### /X25519 ###############################
Test vectors for X25519 include three values:
- The scalar encoding prior to co-factor clearing and clamping, s
- The little-endian byte string encoding of the input point, u
- The expected little-endian byte string encoding of the result, r

The test vectors below shall be applied to the X25519 function
called with the outputs of the decode-u-coordinate function
(that is expected to clear the most significant bit.

Test vector for X25519 with a coordinate on J:
s: a546e36bf0527c9d3b16154b82465edd62144c0ac1fc5a18506a2244ba449ac4
u: e6db6867583030db3594c1a424b15f7c726624ec26b3353b10a903a6d0ab1c4c
r: c3da55379de9c6908e94ea4df28d084f32eccf03491c71f754b4075577a28552

Test vector for X25519 with a coordinate on the twist J':
s: 4b66e9d4d1b4673c5ad22691957d6af5c11b6421e0ea01d42ca4169e7918ba0d
u: e5210f12786811d3f4b7959d0538ae2c31dbe7106fc03c3efc4cd549c715a413
r: 95cbde9476e8907d7aade45cb4b873f88b595a68799fa152e6f8f7647aac7957

Out in the wild there might be two variants of X25519 which
differ by clearing or not clearing bit #255 of inputs.

Test vectors for plain X25519 that MUST return the neutral element
for X25519 implementations that don't clear bit #255 of inputs.
u0: 0000000000000000000000000000000000000000000000000000000000000000
u1: 0100000000000000000000000000000000000000000000000000000000000000
u2: e0eb7a7c3b41b8ae1656e3faf19fc46ada098deb9c32b1fd866205165f49b800
u3: 5f9c95bca3508c24b1d0b1559c83ef5b04445cc4581c8e86d8224eddd09f1157
u4: ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f
u5: edffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f
u6: eeffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f
u7: cdeb7a7c3b41b8ae1656e3faf19fc46ada098deb9c32b1fd866205165f49b880
u8: 4c9c95bca3508c24b1d0b1559c83ef5b04445cc4581c8e86d8224eddd09f11d7
u9: d9ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ua: daffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
ub: dbffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff

Results for X25519 implementations *not* clearing bit #255:
s = af46e36bf0527c9d3b16154b82465edd62144c0ac1fc5a18506a2244ba449aff
rN = X25519(uX, s);
r0: 0000000000000000000000000000000000000000000000000000000000000000
r1: 0000000000000000000000000000000000000000000000000000000000000000
r2: 0000000000000000000000000000000000000000000000000000000000000000
r3: 0000000000000000000000000000000000000000000000000000000000000000
r4: 0000000000000000000000000000000000000000000000000000000000000000
r5: 0000000000000000000000000000000000000000000000000000000000000000
r6: 0000000000000000000000000000000000000000000000000000000000000000
r7: 0000000000000000000000000000000000000000000000000000000000000000
r8: 0000000000000000000000000000000000000000000000000000000000000000
r9: 0000000000000000000000000000000000000000000000000000000000000000
ra: 0000000000000000000000000000000000000000000000000000000000000000
rb: 0000000000000000000000000000000000000000000000000000000000000000

Results for X25519 implementations that *do* clear bit #255:
s = af46e36bf0527c9d3b16154b82465edd62144c0ac1fc5a18506a2244ba449aff
qN = X25519(uX &amp; ((1 &lt;&lt; 255) - 1),s);
q0: 0000000000000000000000000000000000000000000000000000000000000000
q1: 0000000000000000000000000000000000000000000000000000000000000000
q2: 0000000000000000000000000000000000000000000000000000000000000000
q3: 0000000000000000000000000000000000000000000000000000000000000000
q4: 0000000000000000000000000000000000000000000000000000000000000000
q5: 0000000000000000000000000000000000000000000000000000000000000000
q6: 0000000000000000000000000000000000000000000000000000000000000000
q7: e062dcd5376d58297be2618c7498f55baa07d7e03184e8aada20bca28888bf7a
q8: 993c6ad11c4c29da9a56f7691fd0ff8d732e49de6250b6c2e80003ff4629a175
q9: db64dafa9b8fdd136914e61461935fe92aa372cb056314e1231bc4ec12417456
qa: d8e2c776bbacd510d09fd9278b7edcd25fc5ae9adfba3b6e040e8d3b71b21806
qb: c85c655ebe8be44ba9c0ffde69f2fe10194458d137f09bbff725ce58803cdb38

########################### X25519/ ###############################

</pre><a href="#appendix-A.1-1" class="pilcrow">¶</a>
</div>
</section>
<section id="appendix-A.2">
        <h3 id="name-elligator2-test-vectors">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-elligator2-test-vectors" class="section-name selfRef">Elligator2 test vectors</a>
        </h3>
<p id="appendix-A.2-1"> Two test vectors are provided<a href="#appendix-A.2-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="appendix-A.2-2">
<pre>

#################### /Elligator 2 ##################################

Vector set 1 as little endian byte strings:
in: bc149a46d293b0aeea34581349d72f8a5a96cd531102d67379cd9bfadd4ec800
out:66b68f7575cd282403fc2bd323ff04601203c1ec5516ce247f7c0adbef05d367

Vector set 1 as base 10 numbers:
in:  35391373371110637358764021258915994089392966
     2186061014226937583985831318716
out: 46961069109971370193035504450677895166687682
     601074157241352710439876254742118

####################################################################

Vector set 2 as little endian byte strings:
in: 89cf55d4b5d3f84b1634957ac503a32b84ba11471a96b227bca70a0c3bf26375
out:1db163c86ceca7621903c9412d6dc71b4ed263b687eed092b194b5e540bba308

Vector set 2 as base 10 numbers:

in:  530971929581761349677698694411105058011053992421528586742712709
     85522606362505
out: 390779123641965710057372702362153599533842156764537839663973068
     2305857171741

#################### Elligator 2/ ##################################

</pre><a href="#appendix-A.2-2" class="pilcrow">¶</a>
</div>
</section>
<section id="appendix-A.3">
        <h3 id="name-test-vectors-for-the-secret">
<a href="#appendix-A.3" class="section-number selfRef">A.3. </a><a href="#name-test-vectors-for-the-secret" class="section-name selfRef">Test vectors for the secret generator G</a>
        </h3>
<div class="artwork art-text alignLeft" id="appendix-A.3-1">
<pre>
###################### /Secret generator G #########################
Inputs:
DSI1 = 'CPace25519-1'
sid  = SHA512('sid'), bytes 0 to 15

Input strings without prepended length:
pw   = 'password'
A    = 'Ainitiator'
B    = 'Bresponder'
AD   = 'AD'
####################################################################
Outputs and intermediate results:

DSI11= 435061636532353531392d31 string (b'CPace25519-1') of len(12)
PRS  = 0870617373776f7264 (b'\x08password') string of len(9)
ZPAD = 107 zero bytes (before mixing in adversary controlled var. data)
sid  = 7e4b4791d6a8ef019b936c79fb7f2c57 string of len(16)
CI   = 0a41696e69746961746f720a42726573706f6e646572024144
       (b'\nAinitiator\nBresponder\x02AD') string of len(25)

u = SHA512(DSI1||PRS||ZPAD||sid||CI) as 512 bit little-endian int:
  0xc2d3f2db868b7cde013b1b7d3b27c9cdf6845ec2eaf18ec6bffcf70f40e73349
  &lt;&lt; 256
+  0x491041def788da930a86b7dbfedbe016200c259d2d2a980dfde2238a3ea0a6c8
u as reduced base field element coordinate:
  0x34864e74f03d6387394ccc72c6c3d4a8b7b2368c0d05c98e7d6ecfcde0f247ec
Elligator2 output G as base field element coordinate:
  0xf0fdadcc2e334ceb73832be22e736a2a296dd46438f0541c1447dfbaf85ce1d

###################### Secret generator G/ #########################
</pre><a href="#appendix-A.3-1" class="pilcrow">¶</a>
</div>
</section>
<section id="appendix-A.4">
        <h3 id="name-test-vectors-for-cpace-dh">
<a href="#appendix-A.4" class="section-number selfRef">A.4. </a><a href="#name-test-vectors-for-cpace-dh" class="section-name selfRef">Test vectors for CPace DH</a>
        </h3>
<div class="artwork art-text alignLeft" id="appendix-A.4-1">
<pre>
##################### /CPace Diffie-Hellman ########################
Inputs:

Elligator2 output G as base field element coordinate:
  0x307760941be97d7c68b037cb9d22d69838b60e194c50ded8b85873f9e1395126
Elligator2 output G encoded as little endian byte string:
    265139e1f97358b8d8de504c190eb63898d6229dcb37b0687c7de91b94607730

Secret scalar ya=SHA512('ya'), bytes 0...31, as integer:
  0xbfec93334144994275a3eba9eb0adf3fe40d54e400d105d59724bee398b722d1
ya encoded as little endian byte string:
    d122b798e3be2497d505d100e4540de43fdf0aeba9eba375429944413393ecbf

Secret scalar yb=SHA512('yb'), bytes 0...31, as integer:
  0xb16a6ff3fcaf874cb59058493cb1f28b3e20084ad6d46fcd3c053284d60cecc0
yb encoded as little endian byte string:
    c0ec0cd68432053ccd6fd4d64a08203e8bf2b13c495890b54c87affcf36f6ab1

####################################################################
Outputs:

Public point Ya as integer:
  0x79f9f2c1245fd8c4ab38bc75082f2daf6f47ca53fd5f0de7af72fee9c7ddd993
Ya encoded as little endian byte string:
    93d9ddc7e9fe72afe70d5ffd53ca476faf2d2f0875bc38abc4d85f24c1f2f979

Public point Yb as integer:
  0x18ac9063b4419695db48028d2eda7b2b2e649d22f56a5987eba9f05941de1c74
Yb encoded as little endian byte string:
    741cde4159f0a9eb87596af5229d642e2b7bda2e8d0248db959641b46390ac18

DH point K as integer:
  0x276896a227a09f389a04b9656099aa05ef8ec2b394cf32cc50cca9ae56334215
K encoded as little endian byte string:
    15423356aea9cc50cc32cf94b3c28eef05aa996065b9049a389fa027a2966827

##################### CPace Diffie-Hellman/ ########################

</pre><a href="#appendix-A.4-1" class="pilcrow">¶</a>
</div>
</section>
<section id="appendix-A.5">
        <h3 id="name-test-vectors-for-intermedia">
<a href="#appendix-A.5" class="section-number selfRef">A.5. </a><a href="#name-test-vectors-for-intermedia" class="section-name selfRef">Test vectors for intermediate session key generation</a>
        </h3>
<div class="artwork art-text alignLeft" id="appendix-A.5-1">
<pre>
#################### /Session Key derivation #######################
Inputs:

DSI2 = 435061636532353531392d32 string ('CPace25519-2') of len(12)
sid  = 7e4b4791d6a8ef019b936c79fb7f2c57 string of len(16)

strings of length 32:
K = 15423356aea9cc50cc32cf94b3c28eef05aa996065b9049a389fa027a2966827
Ya= 93d9ddc7e9fe72afe70d5ffd53ca476faf2d2f0875bc38abc4d85f24c1f2f979
Yb= 741cde4159f0a9eb87596af5229d642e2b7bda2e8d0248db959641b46390ac18

####################################################################

string of length 64:
ISK = SHA512(DSI2 || sid || K || Ya || Yb)
  = de0be1eeb7e6453d8c961353cd333694866f5432f24b0d4ed393cb6473e835df
    265ce72613effa3368a907031d897c733d300dfdb364ff66d270b404cdfbcb0a

#################### Session Key derivation/ #######################
</pre><a href="#appendix-A.5-1" class="pilcrow">¶</a>
</div>
</section>
</section>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Michel Abdalla</span></div>
<div dir="auto" class="left"><span class="org">DI, École Normale Supérieure, Paris</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:michel.abdalla@ens.fr" class="email">michel.abdalla@ens.fr</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Bjoern Haase</span></div>
<div dir="auto" class="left"><span class="org">Endress + Hauser Liquid Analysis</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:bjoern.m.haase@web.de" class="email">bjoern.m.haase@web.de</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Julia Hesse</span></div>
<div dir="auto" class="left"><span class="org">IBM, Zürich Research Laboratory</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:JHS@zurich.ibm.com" class="email">JHS@zurich.ibm.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
