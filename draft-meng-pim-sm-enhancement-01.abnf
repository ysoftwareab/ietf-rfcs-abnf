S = multicast_source(msg);

state = S ? get_state(*, G) : get_state(S, G); 

state = S ? new_state(*, G) : new_state(S, G); 

new_msg = msg; 

S = multicast_source(msg);

state = S ? get_state(*, G) : get_state(S, G); 

IIF = tunnel(IIF(msg).addr, msg.src) ?
new_msg = msg; 

S = multicast_source(msg);

state = S ? get_state(*, G) : get_state(S, G); 
 




state = S ? new_state(*, G) : new_state(S, G);

new_msg = msg; 

IIF = (msg.ttl == 255) ? IIF(msg) : create_tunnel(IIF(msg).addr,
S = multicast_source(msg);

state = S ? get_state(*, G) : get_state(S, G); 

IIF = tunnel(IIF(msg).addr, msg.src) ? tunnel(IIF(msg).addr,
new_msg = msg; 

