



DetNet
Internet-Draft                                                   X. Wang
Intended status: Standards Track                                  J. Dai
Expires: May 08, 2022                                           J. Liu
                                                                 F.Zhang
                                                   Fiberhome Telecom LTD
                                                        November 08, 2021


   DetNet Data Plane: IEEE 802.1 Time Sensitive Networking over SRv6
               draft-wang-detnet-tsn-over-srv6-04
Abstract

   This document specifies the Deterministic Networking data plane when
   TSN networks interconnected over an Segment Routing IPv6 Packet
   Switched Networks.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on May 08, 2022.

Copyright Notice

   Copyright (c) 2020 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (https://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.



Wang, et al.            Expires May 08, 2022                  [Page 1]

Internet-Draft           DetNet TSN over SRv6              November 2021


Table of Contents
   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
   2.  Terminology . . . . . . . . . . . . . . . . . . . . . . . . .   3
     2.1.  Terms Used in This Document . . . . . . . . . . . . . . .   3
     2.2.  Abbreviations . . . . . . . . . . . . . . . . . . . . . .   3
   3.  Requirements Language . . . . . . . . . . . . . . . . . . . .   4
   4.  IEEE 802.1 TSN Over SRv6 Data Plane Scenario . . . . . . . . .  4
   5.  IEEE 802.1 TSN Operation Over SRv6 Sub-Networks. . . . . .  .   5
     5.1. Mapping of TSN Stream ID and Sequence Number . . . . . . .   5
     5.2. SRv6 Network Programming new Functions . . . . . . . . . .   8
       5.2.1. End. B.Replication DetNet SID: Packet Replication
              Function  . . . . . . . .  . . . . . . . . . . . . . .   8
       5.2.2. End. B. Elimination: Packet Elimination Function. . . .  9
   6.  SRv6 Data Plane Considerations . . . . . . . . . . . . . . . .  9
     6.1. DetNet PREOF  . . . . . . . . . . . . . . . . . . . . . .    9
     6.2. Edge Node Processing   . . . . . . . . . . . . . . . . . .  10
     6.3. MTU and Fragmentation  . . . . . . . . . . . . . . . . . .  10
   7. Management and Control Information Summary. . . . . . . . . . . 11
   8.  Security Considerations . . . . . . . . . . . . . . . . . . .  12
   9.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .  12
   10. Acknowledgements  . . . . . . . . . . . . . . . . . . . . . .  12
   11. Normative References. . . . . . . . . . . . . . . . . . . . .  12
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  13

1.  Introduction

   Deterministic Networking (DetNet) is a service that can be offered as
   DetNet flows in network.  DetNet provides these flows extremely low
   packet loss rates and assured bounded end-to-end delivery latency.
   General background and concepts of DetNet can be found in the DetNet
   Architecture [RFC8655].

   Segment Routing(SR) leverages the source routing paradigm. An ingress
   node steers a packet through an ordered list of instructions, called
   "segments".  SR can be applied over IPv6 data plane using Routing
   Extension Header [RFC8754]. A segment in Segment Routing is not 
   limited to a routing/forwarding function.  A SRv6 Segment can 
   indicate functions that are executed locally in the node where they 
   are defined. [RDC8986] describes some well-known functions and 
   segments associated to them. SRH TLVs ([RFC8754]) also provides 
   meta-data for segment processing.  All these features make SRv6 
   suitable to carry DetNet flows by defining new segments associated 
   with DetNet functions and Meta data for DetNet.

   The Time-Sensitive Networking (TSN) is to provide deterministic
   services through IEEE 802 networks, i.e., guaranteed packet transport
   with bounded latency, low packet delay variation,and low packet loss.




Wang, et al.            Expires May 08, 2022                  [Page 2]

Internet-Draft           DetNet TSN over SRv6              November 2021


   The TSN is a unified industrial Ethernet standard, and supports
   production control and information application.

   TSN over DetNet needs to focus on the real-time interconnection of
   multi-subnet network layer. Based on the existing mechanism of TSN,
   interface scheduling is carried out for routers, firewalls, servers
   and other devices, in order to ensure the deterministic network
   services between cross-domain subnets.  The remote control
   requirements across networks of TSN need deterministic transmission
   of network services through DetNet technology.  TSN needs to be
   deployed with DetNet technology in larger areas such as networking
   of plant equipment, automatic building control of plant and office
   buildings.

   This document defines how to carry DetNet IEEE 802.1 TSN flows over
   SRv6 networks.

2.  Terminology

2.1.  Terms Used in This Document

   This document uses the terminology and concepts established in the
   DetNet architecture [RFC8655] and [RFC8938]. The reader is assumed 
   to be familiar with these documents and their terminology.

2.2.  Abbreviations

   Terminologies for DetNet go along with the definition in [RFC8655].
   The following abbreviations are used in this document:

   CE: Customer Edge equipment.
   CoS: Class of Service.
   DetNet: Deterministic Networking.
   DF: DetNet Flow.
   L2: Layer 2.
   L3: Layer 3.
   OAM: Operations, Administration, and Maintenance.
   PE: Provider Edge.
   PEF: Packet Elimination Function.
   PRF: Packet Replication Function.
   PREOF: Packet Replication, Elimination and Ordering Functions.
   POF: Packet Ordering Function.
   QoS: Quality of Service.
   TSN: IEEE 802.1 Time-Sensitive Network.
   SR: Segment Routing.
   SRv6: Segment Routing IPv6.
   SL: Segment Left.




Wang, et al.            Expires May 08, 2022                  [Page 3]

Internet-Draft           DetNet TSN over SRv6              November 2021


   NH: The IPv6 next-header field.
   SID: A Segment Identifier ([RFC8402]).
   SRH: The Segment Routing Header ([RFC8754]).

3.  Requirements Language

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in BCP
   14 [RFC2119] [RFC8174] when, and only when, they appear in all
   capitals, as shown here.

4.  IEEE 802.1 TSN over SRv6 Data Plane Scenario

   Realize the DetNet network in the Internet and connect with the time 
   sensitive network in the factory. Figure 1 illustrates how DetNet can 
   provide services for IEEE 802.1 TSN end systems, CE1 and CE2, over a 
   DetNet enabled SRv6 network. DetNet Edge Nodes sit at the boundary of 
   a DetNet domain. They are responsible for mapping non-DetNet aware L2 
   traffic to DetNet services. They also support the imposition and 
   disposition of the required DetNet encapsulation. They understand and 
   support IEEE 802.1 TSN and are able to map TSN flows into DetNet 
   flows. Edge nodes, PE1 and PE2, insert and remove required DetNet 
   SRv6 data plane encapsulation.  The 'X' in the edge nodes and relay 
   node, R1, represent a potential DetNet compound flow packet 
   replication and elimination point.

        TSN    |<------- End to End DetNet Service ------>|  TSN
       Service |         Sub              Sub             | Service
   TSN  (AC)   |        |network|        |network|        |  (AC)  TSN
   Talker/ |    V        V       V        V       V        V   | Talker/
   Listener|    +--------+       +--------+       +--------+   |Listener
   +---+   |    |  PE1   |       |   R1   |       |  PE2   |   |  +---+
   |   |---|----|   X    |------ |   X    |------ |   X    |---|--|   |
   |CE1|   |    |        |       |        |       |        |   |  |CE2|
   +---+        +--------+       +--------+       +--------+      +---+
       |        Edge Node       Relay Node        Edge Node       |
       |                                                          |
       |<- TSN -> <------- TSN Over DetNet SRv6 -------> <- TSN ->|
       |                                                          |
       |<--- Emulated Time Sensitive Networking (TSN) Service --->|

       X   = Service protection

               Figure 1: IEEE 802.1TSN Over DetNet SRv6

   Native TSN flow and DetNet SRv6 flow differ not only by the
   additional SRH specific encapsulation, but DetNet SRv6 flows have on



Wang, et al.            Expires May 08, 2022                  [Page 4]

Internet-Draft           DetNet TSN over SRv6              November 2021


   each DetNet node an associated DetNet specific data structure, what
   defines flow related characteristics and required forwarding
   functions.  In this example, edge Nodes provide a service proxy
   function that "associates" the DetNet flows and native flows at the
   edge of the DetNet domain.  This ensures that the DetNet SRv6 Flow is
   properly served at the Edge node (and inside the domain).
   
5.  IEEE 802.1 TSN Operation Over SRv6 Sub-Networks

   A classical SRv6 data plane solution is showed in the picture below:

                                  +-------------------+ -
                                  |       DATA        |  \
                                  +-------------------+   -IPv6 payload  
                                  |TSN Ethernet Header|  /
      +-------------------+       +-------------------+ -
      |        DATA       |       |         SRH       |
      +-------------------+       +-------------------+
      |TSN Ethernet Header| ----> |    IPv6 Header    |
      +-------------------+       +-------------------+
          Figure 2: SRv6 DetNet data plane solution

   In SRv6 for DetNet, the DATA with the SRH is used for
   carrying DetNet flows. Traffic Engineering is instantiated in the
   segment list of SRH, and other functions and arguments for service
   protection (packet replication, elimination and ordering) and
   congestion control (packet queuing and forwarding) are also defined
   in the SRH.

   The Time-Sensitive Networking (TSN) Task Group of the IEEE 802.1
   Working Group have defined (and are defining) a number of amendments
   to IEEE 802.1Q [IEEE8021Q] that provides zero congestion loss and
   bounded latency in bridged networks.  Furthermore IEEE 802.1CB
   [IEEE8021CB] defines frame replication and elimination functions for
   reliability that should prove both compatible with and useful to
   DetNet networks. All these functions have to identify flows those
   require TSN treatment.

   The challenge for SRv6 flows is that the protocol interworking
   function defined in IEEE 802.1CB [IEEE8021CB] does not works for
   segment list of SRH flows.  The aim of the protocol interworking
   function is to convert a TSN ingress flow (for examples, identified
   by a specific destination MAC address and VLAN) to segment list of
   SRH.  A similar interworking pair at the other end of the SRv6 sub-
   network would restore the packet to its original TSN packet.

   The TSN layer 2 header and application payload carried by the TSN
   network are encapsulated in IPv6 payload field as figure 2.



Wang, et al.            Expires May 08, 2022                  [Page 5]

Internet-Draft           DetNet TSN over SRv6              November 2021

   
5.1. IPv6 Header
   
   The Edge Node encapsulates the Ipv6 Heade when a TSN packet go into 
   DetNet SRv6 network, the Ipv6 header field values are as follows:
   Version: 6, represented as Ipv6 packets;
   Traffic Class: the level of the DetNet stream from Control Plane, if
      not, the same as the vlan priority in the TSN packet;
   Flow label: as default incremental value by the edge node or same as
      the Sequence Number in the TSN packet;
   Payload Length: according to the Ipv6 packet length, it is equal to 
      the TSN packet length normally;
   Next Header: 43, represents the Ipv6 routing extension head;
   Hop Limit: set as default value;
   Source Address: the sender Ipv6 address. when the packets from CE1 
      to CE2 as shown in figure 1, the PE1 node encapsulate Ipv6 Header
      source address as its own Ipv6 address;
   Destination Address: the receiver Ipv6 address. when the packets 
      from CE1 to CE2 as shown in figure 1, the PE1 node encapsulate 
      Ipv6 Header destination address as the PE2 Ipv6 address.

5.2. DetNet SID Mapping from TSN Stream

   The Srv6 network edge node uses BGP protocol to announce SRv6 service
   Sid. SRv6 edge node encapsulates the data payload in the outer IPv6 
   header and sets the outer destination address as the service Sid. The 
   underlying network between the edge nodes needs to support IPv6 
   according to [RFC8200], and can transform TSN data flow into srv6 
   service.
   
   The Edge node MUST provide the SRv6 sub-network specific 
   segment list of SRH encapsulation over the link(s) towards the sub-
   network.  A SRv6-aware edge node MUST support the following TSN 
   components:

   1.  For recognizing flows:
       * Stream Identification (SRv6-flow-aware).

   2.  For FRER used inside the TSN domain, additionally:
       * Sequencing function (SRv6-flow-aware);
       * Sequence encode/decode function.

   3.  For FRER when the node is a TSN replication or elimination point.

   additionally:
       * Stream splitting function;
       * Individual recovery function.

   The Time-Sensitive Networking (TSN) Task Group of the IEEE 802.1



Wang, et al.            Expires May 08, 2022                  [Page 6]

Internet-Draft           DetNet TSN over SRv6              November 2021


   Working Group has defined Stream identification in section 6.1 of
   IEEE 802.1CB [IEEE8021CB]. Four specific Stream identification
   functions are described: Null Stream identification, Source MAC and
   VLAN Stream identification, Active Destination MAC and VLAN Stream
   identification, and IP Stream identification. These Stream
   identification functions are summarized as follow:

   o Null Stream identification: destination MAC address, vlan
     identifier.
   o Source MAC and VLAN Stream identification: source MAC address, vlan
     identifier.
   o Active Destination MAC and VLAN Stream identification: destination
     MAC address, vlan identifier.
   o IP Stream identification: destination MAC address, vlan identifier,
     IP source address, IP destination address, DSCP, IP next protocol,
     source port, destination port.

   The SRH for DetNet in the IPv6 header is showed as follows, according
   to [RFC8754], [draft-geng-detnet-dp-sol-srv6-02] and [RFC8986]:

     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |  Next Header  |   Hdr Ext Len |  Routing Type |  Segment Left |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |   Last Entry  |     Flags     |              Tag              |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                                                               |
    |                         DetNet SID                            |
    |                 Segment List(0) (128-bit)                     |
    |                                                               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                              ...                              |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                                                               |
    |            Segment List(n) (128-bit IPv6 address)             |
    |                                                               |
    |                                                               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    //         Optional Type Length Value objects (variable)       //
    //                                                             //
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                     Figure 3: SRH for DetNet

   The DetNet SRv6 flow is identified by DetNet SID in SRH. DetNet SID
   is defined as a 128-bit value.




Wang, et al.            Expires May 08, 2022                  [Page 7]

Internet-Draft           DetNet TSN over SRv6             November 2021


   A new DetNet SID is defined to support DetNet service protection for
   TSN stream. It is used to uniquely identify a DetNet flow in a SRv6
   DetNet node and to discriminate packets in the same DetNet flow by
   sequence number. DetNet SID is defined as follows:

     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |     Type      |    Length     |     Flow Identification       |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                      Flow Identification                      |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |    Flow Identification        |           RESERVED            |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |  Frag |                Sequence Number                        |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

              Figure 4: DetNet SID for Flow Identification
   Where:
   o Type: 8bits, to be assigned by IANA.
   o Length: 8 bits.
   o Flow Identification: 64 bits, which is used for identifying DetNet
     flow.
   o RESERVED: 20 bits, MUST be 0 on transmission and ignored on
     receipt.
   o Sequence Number: 28 bits, which is used for indicating sequence
     number of a DetNet flow.
   o Frag: 4 bits, if a packet must be divided into multiple packages 
     for transmission, record the fragmentation number.

   When TSN stream is transmitted over a SRv6 network, TSN Stream
   Identification MUST pair SRv6 flows and TSN Streams and encode that
   in data plane formats as well.  When the new DetNet SID is used to
   identify DetNet flow and the mapping for TSN stream is as follows:

   o Type: 8bits, to be assigned by IANA, used to identify sources from
     the TSN stream.
   o Length: 8 bits, the value is 16 octets.
   o Flow Identification: 64 bits, which is used for identifying DetNet
     flow. The former 48 bit corresponds to the MAC address identified
     by the TSN stream, and the post 16 bit comes from the VLAN-ID and
     priority parameters in TSN packet.
   o RESERVED: 20 bits, MUST be 0 on transmission and ignored on
     receipt.
   o Sequence Number: 28 bits, which is used for indicating sequence
     number of a DetNet flow. The value comes from the Redundancy tag
     (R-TAG) in TSN packet as defined in Clause 7.8 of IEEE 802.1CB
     [IEEE8021CB].



Wang, et al.            Expires May 08, 2022                  [Page 8]

Internet-Draft           DetNet TSN over SRv6              November 2021


   Flow Identification in SRH can identify Null Stream, Source MAC and
   VLAN Stream, Active Destination MAC and VLAN Stream in TSN stream.
   For TSN IP Stream, destination MAC address and vlan is still
   indicated by flow Identification, other IP-based fields correspond
   to IP fields in SRv6 one by one, such as IP source address, IP
   destination address, DSCP, IP next protocol, source port, destination
   port etc.

5.3.  SRv6 Network Programming new Functions

   New SRv6 Network Programming functions are defined as follows:

5.3.1.  End. B.Replication DetNet SID: Packet Replication Function

   When N receives a packet whose IPv6 DA is S and S is a local End.B.
   SL is Segment Left(SL), Replication DetNet SID, does:

   S01. IF NH=SRH & SL>0 THEN {
   S02. Extract the DetNet SID values from the SRH or TSN Stream
        identification and TSN Rtag.
   S03. Create two new outer IPv6+SRH headers: IPv6-SRH-1 and
        IPv6-SRH-2 Insert the policy-instructed segment lists in each
        newly created SRH (SRH-1 and SRH-2).  Also, add the extracted
        DetNet SID into SRH-1 and SRH-2.
   S04. Remove the incoming outer IPv6+SRH header, restore DATA as the
        original packet.
   S05. Create a duplication of the restore DATA as the duplicate
        packet.
   S06. Encapsulate the original packet into the first outer IPv6+SRH
        header: (IPv6-SRH-1) (original packet)
   S07. Encapsulate the duplicate packet into the second outer IPv6+SRH
        header: (IPv6-SRH-2) (duplicate packet)
   S08. Set the IPv6 SA as the local address of this node.
   S09. Set the IPv6 DA of IPv6-SRH-1 to the first segment of the SRv6
        Policy in of SRH-1 segment list.
   S10. Set the IPv6 DA of IPv6-SRH-2 to the first segment of the SRv6
        Policy in of SRH-2 segment list.
   S11. }

5.3.2.  End. B. Elimination: Packet Elimination Function

   When N receives a packet whose IPv6 DA is S and S is a local End.B.
   SL is Segment Left(SL), Elimination DetNet SID, does:

   S01. IF NH=SRH & SL>0 & "the packet is not a redundant packet" THEN {
   S02.    Do not decrement SL nor update the IPv6 DA with SRH(SL)
   S03.    Extract the value of DetNet SID from the SRH
   S04.    Extract Flow Identification and Sequence Number from DetNet



Wang, et al.            Expires May 08, 2022                  [Page 9]

Internet-Draft           DetNet TSN over SRv6              November 2021


           SID.
   S05.    IF NOT receive the packet with the same Flow Identification
           and Sequence Number {
   S06.      Create a new outer IPv6+SRH header
   S07.      Insert the policy-instructed segment lists in the newly
             created SRH and add the retrieved DetNet SID in the newly
             created SRH
   S08.      Remove the incoming outer IPv6+SRH header.
   S09.      Set the IPv6 DA to the first segment of the SRv6 Policy in
             the newly created SRH
   S10.    } Else {
   S11.      Drop the packet
   S12.    }
   S13.  }

6.  SRv6 Data Plane Considerations

6.1.  DetNet PREOF

   Flow Identification and sequence number are necessary in the
   encapsulation of SRv6 for DetNet in order to support service
   protection.  Replication nodes decide which DetNet flows are supposed
   to be replicated by the flow identification.  Elimination nodes
   decide whether a packet should be dropped because of redundancy by
   the flow identification and sequence number.

   FRER function and the provided service recovery is available in that
   the Stream-ID and the TSN sequence number are paired with the SRv6
   flow parameters they can be combined with PREOF functions.

   SRv6 supporting DetNet flows may use Packet Replication, Elimination
   and Ordering Functions (PREOF) based on the DetNet SID in SRH, which
   is derived from TSN Stream.  The specific operation of Frame
   Replication and Elimination for Redundancy (FRER) [802.1CB] is not
   modified by the use of DetNet and follows IEEE 802.1CB [IEEE8021CB].

6.2.  Edge Node Processing

   An edge node is responsible for matching ingress packets to the
   service they require and encapsulating them accordingly. An edge node
   is a SRv6 DetNet-aware forwarder, and may participate in the packet
   replication and duplication elimination.

   The Controller sends Detnet SRv6 polices to the edge node.  These
   polices include mapping of ingress TSN stream to DetNet SRv6 flow.
   The detnet SID is associated with an SR Policy, and its value comes
   from a TSN packet. When the edge node forwards a TSN packet to SRv6
   network, inserting an SRH with the policy and adds an outer IPv6



Wang, et al.            Expires May 08, 2022                 [Page 10]

Internet-Draft           DetNet TSN over SRv6              November 2021


   header. The TSN flow identification and sequence number is copied to
   DetNet SID in SRv6 SRH.

   Additionally the DetNet-aware edge node does duplicate frame
   elimination based on the flow identification and the sequence number
   combination.  The packet replication is also done within the
   DetNet-aware forwarder.  During elimination and the replication
   process the sequence number of the DetNet member flow MUST be
   preserved and copied to the egress DetNet member flow.

6.3. MTU and Fragmentation
   
   Because the SRH field is added during transmission in the srv6 
   network, the data packet may exceed the MTU of the device interface, 
   so it is necessary to divide the packet. The serial number of the 
   fragment packet is recorded in the frag field of DetNet Sid for flow 
   identification. At the SRv6 network edge node, reorganize these 
   received fragment packets as one packet and send it to the TSN 
   network.
   
   In the process of fragment, the Flow Identification number and 
   Sequence Number of the packet are consistent with the original 
   packet. Based on the Flow Identification number of each stream, the 
   transmission node sends the fragment alarm information to the 
   controller.

7.  Management and Control Information Summary

   The following summarizes the set of information that is needed to
   support TSN over SRv6 at the ingress edge node:

   o TSN Stream identification and TSN R-tag information to be mapped to
     SRv6 SRH SID. Note that a single TSN Stream identification can map
     to one SRH DetNet SID, and it can used for PREOF.
   o IPv6 source address.
   o IPv6 destination address.
   o IPv6 Traffic Class.

   This information MUST be provisioned per DetNet flow via
   configuration, e.g., via the controller or management plane.

   It is the responsibility of the DetNet controller plane to properly
   provision both flow identification information and the flow specific
   resources needed to be provided the traffic treatment needed to meet
   each flow's service requirements. This applies for aggregated and
   individual flows.

   DetNet SRv6 flow and TSN Stream mapping related information are



Wang, et al.            Expires May 08, 2022                 [Page 11]

Internet-Draft           DetNet TSN over SRv6              November 2021


   required only for DetNet SRv6 edge nodes; the edge node is TSN-aware
   and DetNet SRv6-aware node.  These DetNet SRv6 edge nodes are member
   of both the DetNet SRv6 domain and the TSN sub-network.  Within the
   TSN sub-network the DetNet SRv6 node may has a TSM-aware role, so TSN
   specific management and control plane functionalities must be
   implemented.  There are many similarities in the management plane
   techniques used in DetNet and TSN, but that is not the case for the
   control plane protocols.  For example, RSVP-TE and MSRP behaves
   differently. Therefore management and control plane design is an
   important aspect of scenarios, where mapping between DetNet SRv6 and
   TSN is required.

   In order to use a DetNet SRv6 sub-network between TSN nodes, TSN
   stream specific information must be converted to SRv6 DetNet SRH. TSN
   Stream ID and stream related parameters/requirements must be
   converted to a SRv6 DetNet flow ID and flow related parameters/
   requirements. Note that, as the DetNet SRv6 sub-network is just a
   portion of the end2end TSN path (i.e., single hop from IP
   perspective), some parameters (e.g., delay) may differ significantly.
   Other TSN stream parameters (like bandwidth) also may have to be
   tuned due to the SRv6 encapsulation used in the DetNet sub-network.

   In some case it may be challenging to determine some TSN Stream
   related information.  For example which DetNet SRv6 paths are
   multi-Listener of the mapped TSN stream to one TSN stream Talker?
   However it may be not trivial to locate the point/interface where
   that Listener is connected to the TSN sub-network.  Such
   attributes may require interaction between control and management
   plane functions and between DetNet SRv6 and TSN domains.

   Mapping between DetNet SRv6 flow identifiers and TSN Stream
   identifiers, if not provided explicitly, can be done by a DetNet SRv6
   node locally based on the configuration of SRv6 Behaviors associated
   with a SID.

8.  Security Considerations

   This document will not introduce new security problems.

9.  IANA Considerations

   This document requests assigning new DetNet SID TLV code-points as
   described in section 5.

10.  Acknowledgements

   Thanks for Guanghua Lan and Ximing Dong for their comments and
   contributions.



Wang, et al.            Expires May 08, 2022                 [Page 12]

Internet-Draft           DetNet TSN over SRv6              November 2021


11.  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <https://www.rfc-editor.org/info/rfc2119>.

   [RFC8174]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in RFC
              2119 Key Words", RFC 8174, May 2017, 
              <https://www.rfc-editor.org/info/rfc8174>.

   [RFC8200]  Deering, S. and R. Hinden, "Internet Protocol, Version 6
              (IPv6) Specification", RFC 8200, July 2017,
              <https://www.rfc-editor.org/info/rfc8200>.

   [RFC8402]  Filsfils, C., Ed., Previdi, S., Ed., Ginsberg, L.,
              Decraene, B., Litkowski, S., and R. Shakir, "Segment
              Routing Architecture", RFC 8402, DOI 10.17487/RFC8402,
              July 2018, <https://www.rfc-editor.org/info/rfc8402>.
              
   [RFC8655]  Finn, N., Thubert, P., Varga, B., and J. Farkas,
              "Deterministic Networking Architecture", RFC 8655, May
              2019, <https://www.rfc-editor.org/info/rfc8655>.

   [RFC8754]  Filsfils, C., Dukes, D., Previdi, S., Leddy, J.,
              Matsushima, S., and d. daniel.voyer@bell.ca, "IPv6 Segment
              Routing Header (SRH)", RFC 8754, June 2019.  
              <https://www.rfc-editor.org/info/rfc8754>.

   [IEEE8021CB]
              Finn, N., "Draft Standard for Local and metropolitan area
              networks - Seamless Redundancy", IEEE P802.1CB
              /D2.1 P802.1CB, December 2015,
              <http://www.ieee802.org/1/files/private/cb-drafts/
              d2/802-1CB-d2-1.pdf>.

   [IEEE8021Q]
              IEEE 802.1, "Standard for Local and metropolitan area
              networks--Bridges and Bridged Networks (IEEE Std 802.1Q-
              2014)", 2014, <http://standards.ieee.org/about/get/>.

   [RFC8986]
              Filsfils, C., Camarillo, P., Leddy, J.,
              daniel.voyer@bell.ca, d., Matsushima, S., and Z. Li, "SRv6
              Network Programming", RFC8986, February 2021.
              <https://www.rfc-editor.org/info/rfc8986>.

Authors' Addresses

   Xueshun Wang
   Fiberhome Telecom LTD
   Email: xswang@fiberhome.com
   
   Jinyou Dai
   Fiberhome Telecom LTD
   Email: djy@fiberhome.com

   Jianhua Liu



Wang, et al.            Expires May 08, 2022                 [Page 13]

Internet-Draft           DetNet TSN over SRv6              November 2021


   Fiberhome Telecom LTD
   Email: liujianhua@fiberhome.com

   Feng Zhang
   Fiberhome Telecom LTD
   Email: fengzhang@fiberhome.com


Wang, et al.            Expires May 08, 2022                 [Page 14]
