mac = MAC(key, sequence_number || unencrypted_packet)

length = 20)
length = 12, key length = 20)
length = 16)
length = 12, key length = 16)
K1 = HASH(K || H || X || session_id)   (X is e.g., "A")
K2 = HASH(K || H || K1)
K3 = HASH(K || H || K1 || K2)
key = K1 || K2 || K3 || ...

e = g^x mod p.  C sends e to S.

f = g^y mod p.  S receives e.  It computes K = e^y mod p,
H = hash(V_C || V_S || I_C || I_S || K_S || e || f || K)
