<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Sieve Notification Mechanism: SIP MESSAGE</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Overview">
<link href="#rfc.section.1.2" rel="Chapter" title="1.2 Terminology">
<link href="#rfc.section.2" rel="Chapter" title="2 Definition">
<link href="#rfc.section.2.1" rel="Chapter" title='2.1 Notify parameter "method"'>
<link href="#rfc.section.2.2" rel="Chapter" title='2.2 Notify tag ":from"'>
<link href="#rfc.section.2.3" rel="Chapter" title='2.3 Notify tag ":options"'>
<link href="#rfc.section.2.4" rel="Chapter" title='2.4 Notify tag ":importance"'>
<link href="#rfc.section.2.5" rel="Chapter" title='2.5 Notify tag ":message"'>
<link href="#rfc.section.2.6" rel="Chapter" title="2.6 Other Definitions">
<link href="#rfc.section.2.7" rel="Chapter" title="2.7 Test notify_method_capability">
<link href="#rfc.section.3" rel="Chapter" title="3 Examples">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 Example 1">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 Example 2">
<link href="#rfc.section.4" rel="Chapter" title="4 Requirements Conformance Checklist">
<link href="#rfc.section.5" rel="Chapter" title="5 Security Considerations">
<link href="#rfc.section.6" rel="Chapter" title="6 IANA Considerations">
<link href="#rfc.section.7" rel="Chapter" title="7 Acknowledgements">
<link href="#rfc.references" rel="Chapter" title="8 References">
<link href="#rfc.references.1" rel="Chapter" title="8.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="8.2 Informative References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="This document describes a profile of the Sieve extension for notifications, to allow notifications to be sent over SIP MESSAGE." />
  <meta name="description" content="This document describes a profile of the Sieve extension for notifications, to allow notifications to be sent over SIP MESSAGE." />
  <meta name="keywords" content="Sieve, SIP, notification" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Sieve Working Group</td>
<td class="right">A. Melnikov</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Isode Limited</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">Q. Sun</td>
</tr>
<tr>
<td class="left">Expires: April 13, 2012</td>
<td class="right">B. Leiba</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">K. Li</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Huawei Technologies</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">October 11, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Sieve Notification Mechanism: SIP MESSAGE<br />
  <span class="filename">draft-ietf-sieve-notify-sip-message-08</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>This document describes a profile of the Sieve extension for notifications, to allow notifications to be sent over SIP MESSAGE.</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on April 13, 2012.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>1.1.   <a href="#rfc.section.1.1">Overview</a>
</li>
<li>1.2.   <a href="#rfc.section.1.2">Terminology</a>
</li>
<li>2.   <a href="#rfc.section.2">Definition</a>
</li>
<li>2.1.   <a href="#rfc.section.2.1">Notify parameter "method"</a>
</li>
<li>2.2.   <a href="#rfc.section.2.2">Notify tag ":from"</a>
</li>
<li>2.3.   <a href="#rfc.section.2.3">Notify tag ":options"</a>
</li>
<li>2.4.   <a href="#rfc.section.2.4">Notify tag ":importance"</a>
</li>
<li>2.5.   <a href="#rfc.section.2.5">Notify tag ":message"</a>
</li>
<li>2.6.   <a href="#rfc.section.2.6">Other Definitions</a>
</li>
<li>2.7.   <a href="#rfc.section.2.7">Test notify_method_capability</a>
</li>
<li>3.   <a href="#rfc.section.3">Examples</a>
</li>
<li>3.1.   <a href="#rfc.section.3.1">Example 1</a>
</li>
<li>3.2.   <a href="#rfc.section.3.2">Example 2</a>
</li>
<li>4.   <a href="#rfc.section.4">Requirements Conformance Checklist</a>
</li>
<li>5.   <a href="#rfc.section.5">Security Considerations</a>
</li>
<li>6.   <a href="#rfc.section.6">IANA Considerations</a>
</li>
<li>7.   <a href="#rfc.section.7">Acknowledgements</a>
</li>
<li>8.   <a href="#rfc.references">References</a>
</li>
<li>8.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>8.2.   <a href="#rfc.references.2">Informative References</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> Introduction</h1>
<h1 id="rfc.section.1.1">
<a href="#rfc.section.1.1">1.1.</a> Overview</h1>
<p id="rfc.section.1.1.p.1">The <a href="#RFC5435">Notify extension</a> <cite title="NONE">[RFC5435]</cite> to the <a href="#RFC5228">Sieve mail filtering language</a> <cite title="NONE">[RFC5228]</cite> is a framework for providing notifications by employing URIs that specify the notification mechanism.  (See RFC 5435 for details about the motivation and use cases.) This document defines how Session Initiation Protocol (SIP) URIs <a href="#RFC3261">RFC 3261</a> <cite title="NONE">[RFC3261]</cite> are used to generate notifications via SIP MESSAGE <a href="#RFC3428">RFC 3428</a> <cite title="NONE">[RFC3428]</cite>.  </p>
<h1 id="rfc.section.1.2">
<a href="#rfc.section.1.2">1.2.</a> Terminology</h1>
<p id="rfc.section.1.2.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">RFC 2119</a> <cite title="NONE">[RFC2119]</cite>.  </p>
<p id="rfc.section.1.2.p.2">This document inherits terminology from the <a href="#RFC5228">Sieve email filtering language</a> <cite title="NONE">[RFC5228]</cite>, the <a href="#RFC5435">Sieve Notify extension</a> <cite title="NONE">[RFC5435]</cite>, and <a href="#RFC3261">RFC 3261</a> <cite title="NONE">[RFC3261]</cite>.  </p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> Definition</h1>
<p id="rfc.section.2.p.1">The SIP MESSAGE mechanism defined in this document results in the sending of a SIP MESSAGE request to notify a recipient about an email message.  </p>
<h1 id="rfc.section.2.1">
<a href="#rfc.section.2.1">2.1.</a> Notify parameter "method"</h1>
<p id="rfc.section.2.1.p.1">The "method" parameter MUST be a URI that conforms to the SIP or SIPS URI scheme (as specified in <a href="#RFC3261">RFC 3261</a> <cite title="NONE">[RFC3261]</cite>) and that identifies a SIP or SIPS recipient of the notification.  The URI MAY include the resource identifier portion of a SIP address and URI parameters.  The URI MUST include the URI parameter "method", with the value "MESSAGE".  Example: </p>
<p></p>

<ul class="empty">
<li>notify "sip:romeo@example.com;method=MESSAGE"</li>
<li>-------------- </li>
</ul>

<p> </p>
<p id="rfc.section.2.1.p.3">Note that future specifications might extend this document and define Sieve notifications that use SIP methods other than "MESSAGE".  </p>
<p id="rfc.section.2.1.p.4">The processing application MUST form a request according to the rules specified in <a href="#RFC3261">RFC 3261</a> <cite title="NONE">[RFC3261]</cite>.  </p>
<p id="rfc.section.2.1.p.5">Note that other URI schemes can also trigger SIP processing, but only SIP and SIPS are defined here.  Future extensions might define other Sieve notification methods that use SIP through other URI schemes.  </p>
<h1 id="rfc.section.2.2">
<a href="#rfc.section.2.2">2.2.</a> <a href="#from-tag" id="from-tag">Notify tag ":from"</a>
</h1>
<p id="rfc.section.2.2.p.1">The value of the ":from" tag MUST use the SIP "From" header field syntax; if the ":from" value is specified, has valid syntax, and is valid according to the implementation-specific security checks (see Section 3.3 of Sieve Notify <a href="#RFC5435">[RFC5435]</a>), then the notification SHOULD include the "From" SIP header field containing the value of the ":from" notify tag. If the specified value is not valid, then it is ignored.  </p>
<p id="rfc.section.2.2.p.2">All SIP authentication, including challenges and client certificates, SHOULD be done in the context of the Sieve engine -- the Sieve engine is the identity being authenticated.  This avoids security issues associated with the Sieve engine's having access to the end user's SIP authentication credentials.  The Sieve engine MAY use server-wide credentials (including applicable certificates) that are the same for all scripts.  Alternatively, it MAY, for auditing purposes, use different sets of Sieve-engine credentials when operating on behalf of different users.  </p>
<p id="rfc.section.2.2.p.3">See section 22 of RFC 3261 <a href="#RFC3261">[RFC3261]</a> for more information about SIP authentication.  </p>
<h1 id="rfc.section.2.3">
<a href="#rfc.section.2.3">2.3.</a> Notify tag ":options"</h1>
<p id="rfc.section.2.3.p.1">Handling of the ":options" tag is implementation specific. This document doesn't require presence of any option and doesn't define how options are processed.  </p>
<h1 id="rfc.section.2.4">
<a href="#rfc.section.2.4">2.4.</a> Notify tag ":importance"</h1>
<p id="rfc.section.2.4.p.1">The ":importance" tag is intended to convey the importance of the SIP MESSAGE notification, not the importance of the email message that generated the notification.  The value of the ":importance" tag MAY, therefore, be transformed into SIP "Priority" header field (in addition to or instead of including it in the body of the message).  Note that because the Sieve ":importance" tag only has three values, not all SIP "Priority" values can be represented in the transformation.  If this transformation is done, the value of the "Priority" header field MUST be "urgent" if the value of the ":importance" tag is "1", "normal" if the value of the ":importance" tag is "2", and "non-urgent" if the value of the ":importance" tag is "3".  There is no mapping to the SIP value "emergency", nor to any additional values that might be defined.  </p>
<h1 id="rfc.section.2.5">
<a href="#rfc.section.2.5">2.5.</a> <a href="#message-tag" id="message-tag">Notify tag ":message"</a>
</h1>
<p id="rfc.section.2.5.p.1">If the ":message" tag is included, it MUST be transformed into the message-body of a SIP MESSAGE, which MUST have Content-Type value of "text/plain" with CHARSET="UTF-8".  If the ":message" tag is not included, a default message will be used.  The values of the "From" and "Subject" header fields of the triggering email message are particularly useful to users receiving notifications, and including them in the default message is generally a good idea (but see the Security Considerations, <a href="#security">Section 5</a>).  The default body might also include the value of the ":importance" tag, if one is specified), as shown in <a href="#Example2">Section 3.2</a> below.  </p>
<p id="rfc.section.2.5.p.2">Note that in no case is the actual triggering message body included in the notification.  </p>
<p id="rfc.section.2.5.p.3">Implementations MUST comply with the SIP MESSAGE size limits, as discussed in section 8 of RFC 3428 <a href="#RFC3428">[RFC3428]</a>.  </p>
<h1 id="rfc.section.2.6">
<a href="#rfc.section.2.6">2.6.</a> <a href="#other-req" id="other-req">Other Definitions</a>
</h1>
<p id="rfc.section.2.6.p.1">An implementation MUST ignore any URI parameter it does not understand (the URI MUST be processed as if the parameter were not present).  The URI "body" parameter can serve the same purpose as the Sieve ":message" tag, providing the message body of the SIP MESSAGE request.  If both are present at the same time, the Sieve processing MUST ignore the "body" parameter.  </p>
<p id="rfc.section.2.6.p.2">Using the ":message" tag has advantages over using the "body" parameter.  Because the ":message" tag is part of the "notify" statement syntax, it can be easier to include it in a script, and to do things such as variable substitutions <a href="#RFC5229">[RFC5229]</a> with it.  It is also easier to include non-ASCII characters in the ":message" tag, because such characters have to be encoded if they are within URI parameters, but can be included directly in UTF-8 in Sieve tag values.  </p>
<p id="rfc.section.2.6.p.3">The policy for retrying delivery of failed notifications is specified in RFC 3261 [RFC3261], according to the SIP error code returned during an attempt to deliver a SIP notification.  In other words, unlike the situation with some other Sieve notification methods, retries for SIP MESSAGE notifications are controlled by the notification protocol itself (SIP).  </p>
<h1 id="rfc.section.2.7">
<a href="#rfc.section.2.7">2.7.</a> <a href="#notify_method_capability" id="notify_method_capability">Test notify_method_capability</a>
</h1>
<p id="rfc.section.2.7.p.1">Absent use of SIP extensions such as <a href="#RFC3856">[RFC3856]</a>, it is impossible to tell in advance whether the notification recipient is online and able to receive a SIP MESSAGE.  Expect the notify_method_capability test for "online" to frequently return "maybe" for this notification method.  </p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> Examples</h1>
<p id="rfc.section.3.p.1">In the following examples, the sender of the email has an address of juliet@example.org, the entity to be notified has a SIP address of &lt;sip:romeo@example.com&gt;, and the notification service has a SIP address &lt;sip:notifier@example.com&gt;.  </p>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> <a href="#Example1" id="Example1">Example 1</a>
</h1>
<p id="rfc.section.3.1.p.1">The following is a basic Sieve notify action with only a method: </p>
<p id="rfc.section.3.1.p.2">notify "sip:romeo@example.com;method=MESSAGE" </p>
<p id="rfc.section.3.1.p.3">The resulting SIP MESSAGE request might be as follows: </p>
<div id="#rfc.figure.1"></div>
<pre>
   MESSAGE sip:romeo@example.com SIP/2.0
   Via: SIP/2.0/TCP notifier.example.com;branch=z9hG4bK776sgdkse
   Max-Forwards: 70
   From: sip:notifier@example.com;tag=32328
   To: sip:romeo@example.com
   Call-ID: asd88asd77a@1.2.3.4
   CSeq: 1 MESSAGE
   Date: Sat, 13 Nov 2010 23:29:00 GMT
   Content-Type: text/plain
   Content-Length: 53   

   &lt;juliet@example.com&gt; wrote: Contact me immediately!
</pre>
<p>In the example above the email message was received from juliet@example.com and had "Subject: Contact me immediately!" </p>
<h1 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> <a href="#Example2" id="Example2">Example 2</a>
</h1>
<p id="rfc.section.3.2.p.1">The following is a more advanced Sieve notify action with a method, importance, subject, and message: </p>
<div id="#rfc.figure.2"></div>
<pre>
   notify :importance "1"
       :message "You got new mail!"
       "sip:romeo@example.com;method=MESSAGE?subject=SIEVE"

   MESSAGE sip:romeo@example.com SIP/2.0
   Via: SIP/2.0/TCP notifier.example.com;branch=z9hG4bK776sgdkse
   Max-Forwards: 70
   From: sip:notifier@example.com;tag=32328
   To: sip:romeo@example.com
   Subject: SIEVE
   Priority: urgent
   Call-ID: asd88asd77a@1.2.3.4
   CSeq: 1 MESSAGE
   Date: Fri, 08 Apr 2011 06:54:00 GMT
   Content-Type: text/plain
   Content-Length: 19

   You got new mail!
</pre>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> Requirements Conformance Checklist</h1>
<p id="rfc.section.4.p.1">Section 3.8 of Sieve Notify <a href="#RFC5435">[RFC5435]</a> specifies a set of requirements for Sieve notification methods.  A checklist is provided here to show conformance of the SIP MESSAGE notification method.  </p>

<ol>
<li>No new Sieve tags have been added to the "notify" action.  </li>
<li>An implementation of the SIP MESSAGE notification method SHOULD NOT modify the final notification text, except to comply with SIP MESSAGE length limits.  Deployments MAY make operational decisions about notification text, for reasons such as privacy and confidentiality.  Modification of characters themselves should not be necessary, since the SIP MESSAGE body is encoded in UTF-8 <a href="#RFC3629">[RFC3629]</a>.  </li>
<li>An implementation MAY ignore parameters specified in the ":importance", and ":options" tags.  </li>
<li>A default message is suggested in <a href="#message-tag">Section 2.5</a>.  </li>
<li>A notification sent via the SIP MESSAGE notification method MAY include the Date header field containing the date-time of the moment when the SIP MESSAGE notification was generated.  </li>
<li>The notification source is identified through the SIP "From:" header field, via the Sieve Notify ":from" tag (see <a href="#from-tag">Section 2.2</a>.  </li>
<li>An implementation MUST NOT include any other extraneous information not specified in parameters to the notify action.  </li>
<li>An implementation MUST ignore any URI parameters it does not understand (i.e., the URI MUST be processed as if the action or parameter were not present). See <a href="#other-req">Section 2.6</a> for more details.  </li>
<li>The notify_method_capability test for the "online" notification-capability behaves as described in <a href="#notify_method_capability">Section 2.7</a>.  </li>
<li>The policy for retrying delivery of failed notifications is specified in RFC 3261 <a href="#RFC3261">[RFC3261]</a>, as noted in <a href="#other-req">Section 2.6</a>.  </li>
</ol>

<p> </p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#security" id="security">Security Considerations</a>
</h1>
<p id="rfc.section.5.p.1">Depending on the information included, sending a notification can be, from a confidentiality point of view, comparable to forwarding mail to the notification recipient.  Care must be taken when automatically forwarding information such as the sender and the subject of a message, to ensure that confidential information is not sent into an insecure environment or over an insecure channel.  Depending upon the environment, this might entail using SIPS URIs, not sending information about the subject and/or the sender, or applying heuristics to the message to determine what may be sent.  </p>
<p id="rfc.section.5.p.2">As required by RFC 3428, user agents that support the SIP MESSAGE request MUST implement end-to-end authentication, body integrity, and body confidentiality mechanisms.  At the time of this writing, there is not widespread deployment of SIP end-to-end security, so there can be cases where it is not possible to use it, even though it is implemented on one end.  Its important to note that such situations are open to exposure of user credentials, message content, and other private information via man-in-the-middle and other passive attacks.  </p>
<p id="rfc.section.5.p.3">The Sieve Notify extension specifies that notification methods MUST provide mechanisms for avoiding notification loops.  In this case, the SIP protocol itself prevents loops, and no explicit work is needed within the notification mechanism.  In situations where a SIP MESSAGE notification can result in an email message, which could generate another SIP MESSAGE notification, loop prevention through rate detection and limiting might be necessary.  An implementation might detect too many notifications within a given time period, too many triggered by a particular sender, too many with the same subject, or the like, and shut off the affected notifications for a period of time or until manual intervention turns them back on.  </p>
<p id="rfc.section.5.p.4">If SIP MESSAGE requests might be billed by the message, or the use of them might deplete a user's quota of messages, notification by this mechanism can present a situation where someone using a large number of messages to generate a large number of notifications will cause a significant expense to the recipient.  Because there is no external way an attacker can tell that this is the case, such an attack would likely be a random or nuisance attack.  Nevertheless, users might be warned of potential costs when they set up SIP MESSAGE notifications.  </p>
<p id="rfc.section.5.p.5">Other security considerations given in the Sieve base specification <a href="#RFC5228">[RFC5228]</a>, the Sieve Notify extension <a href="#RFC5435">[RFC5435]</a>, and RFC 3261 <a href="#RFC3261">[RFC3261]</a> are also relevant to this document.  </p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> IANA Considerations</h1>
<p id="rfc.section.6.p.1">The following template provides the IANA registration of the Sieve notification mechanism specified in this document.  This information should be added to the list of Sieve notification mechanisms maintained at &lt;http://www.iana.org/assignments/sieve-notification&gt;.  </p>
<p id="rfc.section.6.p.2">To: iana@iana.org<br> Subject: Registration of new Sieve notification mechanism<br> Mechanism name: sip-message<br> Mechanism URI: SIP/SIPS as specified in <a href="#RFC3261">RFC 3261</a> <cite title="NONE">[RFC3261]</cite><br> Mechanism-specific options: none<br> Standards Track/IESG-approved experimental RFC number: [RFC XXXX]<br> Person and email address to contact for further information:<br> &#160;&#160;&#160;&#160;See authors of [RFC XXXX] </p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> Acknowledgements</h1>
<p id="rfc.section.7.p.1">This document borrows some text from draft-ietf-sieve-notify-xmpp <a href="#RFC5437">[RFC5437]</a>.  </p>
<p id="rfc.section.7.p.2">Henning Schulzrinne (hgs@cs.columbia.edu) was a special contributor to this document, with early work and reviews.  </p>
<p id="rfc.section.7.p.3">The authors would like to thank Adam Roach and Eric Burger for their helpful comments.  Ben Campbell did a very thorough RAI-team review, as well as a follow-up review to make sure we resolved all of his issues satisfactorily.  This document was greatly improved by their input.  </p>
<h1 id="rfc.references">
<a href="#rfc.references">8.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">8.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5228">[RFC5228]</b></td>
<td class="top">
<a>Guenther, P.</a> and <a>T. Showalter</a>, "<a href="http://tools.ietf.org/html/rfc5228">Sieve: An Email Filtering Language</a>", RFC 5228, January 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5435">[RFC5435]</b></td>
<td class="top">
<a>Melnikov, A.</a>, <a>Leiba, B.</a>, <a>Segmuller, W.</a> and <a>T. Martin</a>, "<a href="http://tools.ietf.org/html/rfc5435">Sieve Email Filtering: Extension for Notifications</a>", RFC 5435, January 2009.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3261">[RFC3261]</b></td>
<td class="top">
<a>Rosenberg, J.</a>, <a>Schulzrinne, H.</a>, <a>Camarillo, G.</a>, <a>Johnston, A.</a>, <a>Peterson, J.</a>, <a>Sparks, R.</a>, <a>Handley, M.</a> and <a>E. Schooler</a>, "<a href="http://tools.ietf.org/html/rfc3261">SIP: Session Initiation Protocol</a>", RFC 3261, June 2002.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3428">[RFC3428]</b></td>
<td class="top">
<a>Campbell, B.</a>, <a>Rosenberg, J.</a>, <a>Schulzrinne, H.</a>, <a>Huitema, C.</a> and <a>D. Gurle</a>, "<a href="http://tools.ietf.org/html/rfc3428">Session Initiation Protocol (SIP) Extension for Instant Messaging</a>", RFC 3428, December 2002.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3629">[RFC3629]</b></td>
<td class="top">
<a>Yergeau, F.</a>, "<a href="http://tools.ietf.org/html/rfc3629">UTF-8, a transformation format of ISO 10646</a>", STD 63, RFC 3629, November 2003.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">8.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC3856">[RFC3856]</b></td>
<td class="top">
<a>Rosenberg, J.</a>, "<a href="http://tools.ietf.org/html/rfc3856">A Presence Event Package for the Session Initiation Protocol (SIP)</a>", RFC 3856, August 2004.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5229">[RFC5229]</b></td>
<td class="top">
<a>Homme, K.</a>, "<a href="http://tools.ietf.org/html/rfc5229">Sieve Email Filtering: Variables Extension</a>", RFC 5229, January 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5437">[RFC5437]</b></td>
<td class="top">
<a>Saint-Andre, P.</a> and <a>A. Melnikov</a>, "<a href="http://tools.ietf.org/html/rfc5437">Sieve Notification Mechanism: Extensible Messaging and Presence Protocol (XMPP)</a>", RFC 5437, January 2009.</td>
</tr>
</tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Alexey Melnikov</span> 
	  <span class="n hidden">
		<span class="family-name">Melnikov</span>
	  </span>
	</span>
	<span class="org vcardline">Isode Limited</span>
	<span class="adr">
	  <span>5 Castle Business Village</span>
<span>36 Station Road</span>

	  <span class="vcardline">
		<span class="locality">Hampton</span>,  
		<span class="region">Middlesex</span> 
		<span class="code">TW12 2BX</span>
	  </span>
	  <span class="country-name vcardline">UK</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:Alexey.Melnikov@isode.com">Alexey.Melnikov@isode.com</a></span>

<span class="vcardline">URI: <a href="http://www.melnikov.ca/">http://www.melnikov.ca/</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Qian Sun</span> 
	  <span class="n hidden">
		<span class="family-name">Sun</span>
	  </span>
	</span>
	<span class="org vcardline">Huawei Technologies</span>
	<span class="adr">
	  <span>Bantian, Longgang</span>

	  <span class="vcardline">
		<span class="locality">Shenzhen</span>,  
		<span class="region">Guandong</span> 
		<span class="code">518129</span>
	  </span>
	  <span class="country-name vcardline">P.R China</span>
	</span>
	<span class="vcardline">Phone: +86 755 28780808</span>

<span class="vcardline">EMail: <a href="mailto:sunqian@huawei.com">sunqian@huawei.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Barry Leiba</span> 
	  <span class="n hidden">
		<span class="family-name">Leiba</span>
	  </span>
	</span>
	<span class="org vcardline">Huawei Technologies</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">Phone: +1 646 827 0648</span>

<span class="vcardline">EMail: <a href="mailto:barryleiba@computer.org">barryleiba@computer.org</a></span>

<span class="vcardline">URI: <a href="http://internetmessagingtechnology.org/">http://internetmessagingtechnology.org/</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Kepeng Li</span> 
	  <span class="n hidden">
		<span class="family-name">Li</span>
	  </span>
	</span>
	<span class="org vcardline">Huawei Technologies</span>
	<span class="adr">
	  <span>Huawei Base, Bantian, Longgang District</span>

	  <span class="vcardline">
		<span class="locality">Shenzhen</span>,  
		<span class="region">Guangdong</span> 
		<span class="code">518129</span>
	  </span>
	  <span class="country-name vcardline">P. R. China</span>
	</span>
	<span class="vcardline">Phone: +86-755-28974289</span>

<span class="vcardline">EMail: <a href="mailto:likepeng@huawei.com">likepeng@huawei.com</a></span>

  </address>
</div>

</body>
</html>