Internet Draft                                             Dan Romascanu
                                                     Lucent Technologies
                                                             10 May 2000


                 Remote Monitoring MIB Extensions for
                   Interface Parameters Monitoring


              <draft-ietf-rmonmib-iftopn-mib-01.txt>

Status of this Memo

   This document is an Internet-Draft and is in full conformance with
   all provisions of Section 10 of RFC2026.  Internet-Drafts are working
   documents of the Internet Engineering Task Force (IETF), its areas,
   and its working groups.  Note that other groups may also distribute
   working documents as Internet-Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet- Drafts as reference
   material or to cite them other than as "work in progress."

     The list of current Internet-Drafts can be accessed at
     http://www.ietf.org/ietf/1id-abstracts.txt

     The list of Internet-Draft Shadow Directories can be accessed at
     http://www.ietf.org/shadow.html.

.

   Copyright Notice

   Copyright (C) The Internet Society (2000).  All Rights Reserved.

Abstract

   This memo defines a portion of the Management Information Base (MIB)
   for use with network management protocols in the Internet community.
   The document proposes an extension to the Remote Monitoring MIB [17]
   with a method of sorting the interfaces of a monitored device
   according to values of parameters specific to this interface.

   Distribution of this memo is unlimited.

Table of Contents

   Status of this Memo                                             1
   Abstract                                                        1
    1 Introduction                                                 2
    2 The SNMP Management Framework                                2
    3 Overview                                                     3



D.Romascanu               Expires November 2000                 [Page 1]





INTERNET DRAFT              InterfaceTopN MIB                   May 2000


    4 MIB Structure                                                4
    5 Evolution of the Document, Limitations and Future Work       4
    6 Definitions                                                  5
    7 References                                                  32
    8 Intellectual Property                                       35
    9 Security Considerations                                     36
    10 Author's Address                                           36
    A Full Copyright Statement                                    37

1.  Introduction

   This memo defines a portion of the Management Information Base (MIB)
   for use with network management protocols in the Internet community.
   In particular, it defines a method of sorting the interfaces of a
   monitored device according to values of parameters specific to this
   interface.

   This memo also includes a MIB module.  This MIB module extends the
   list of managed objects specified in [17] and [18].

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [20].

2.  The SNMP Management Framework

   The SNMP Management Framework presently consists of five major
   components:

   o   An overall architecture, described in RFC 2271 [1].

   o   Mechanisms for describing and naming objects and events for the
       purpose of management. The first version of this Structure of
       Management Information (SMI) is called SMIv1 and described in
       RFC 1155 [2], RFC 1212 [3] and RFC 1215 [4]. The second version,
       called SMIv2, is described in RFC 1902 [5], RFC 1903 [6] and RFC
       1904 [7].

   o   Message protocols for transferring management information. The
       first version of the SNMP message protocol is called SNMPv1 and
       described in RFC 1157 [8]. A second version of the SNMP message
       protocol, which is not an Internet standards track protocol, is
       called SNMPv2c and described in RFC 1901 [9] and RFC 1906 [10].
       The third version of the message protocol is called SNMPv3 and
       described in RFC 1906 [10], RFC 2272 [11] and RFC 2274 [12].

   o   Protocol operations for accessing management information. The
       first set of protocol operations and associated PDU formats is



D.Romascanu               Expires November 2000                 [Page 2]





INTERNET DRAFT              InterfaceTopN MIB                   May 2000


       described in RFC 1157 [8]. A second set of protocol operations
       and associated PDU formats is described in RFC 1905 [13].

   o   A set of fundamental applications described in RFC 2273 [14] and
       the view-based access control mechanism described in RFC 2275
       [15].

   Managed objects are accessed via a virtual information store, termed
   the Management Information Base or MIB.  Objects in the MIB are
   defined using the mechanisms defined in the SMI.

   This memo specifies a MIB module that is compliant to the SMIv2. A
   MIB conforming to the SMIv1 can be produced through the appropriate
   translations. The resulting translated MIB must be semantically
   equivalent, except where objects or events are omitted because no
   translation is possible (use of Counter64). Some machine readable
   information in SMIv2 will be converted into textual descriptions in
   SMIv1 during the translation process. However, this loss of machine
   readable information is not considered to change the semantics of the
   MIB.

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED","MAY", and "OPTIONAL" in this
   document are to be interpreted as described in RFC2119 [16].

3. Overview

   This document continues the architecture created in the RMON MIB [17]
   and extended by the SMON MIB [18], by providing a method of ordering
   the interfaces of a device according to the value of a specific
   parameter that characterizes the interfaces.

   The need for such a technique derives from the evolution of the
   network devices - bridges / switches, routers, etc. into complex
   entities with a large number of interfaces and with many parameters
   that need to be monitored on each interface. It is common for certain
   classes of switching devices to contain hundred of ports, and for
   each port to instrument and support tens of parameters - usually
   expressed as counters - for each interface. As a result, it becomes
   impossible for applications that monitor these devices to provide a
   view that would allow the user to understand easily what is the
   status of the device, whether the behavior of a port or interface is
   in normal boundaries or not, and which are the most congested or
   problematic interfaces of the device.

   This document tries to answer this problem, by proposing a method of
   providing a sorted list of interfaces, according to programmable
   criteria. The result of applying this method will be a shorter list,



D.Romascanu               Expires November 2000                 [Page 3]





INTERNET DRAFT              InterfaceTopN MIB                   May 2000


   that includes the most significant interfaces sorted according to the
   selected criteria. One possible action that can be taken by a network
   manager could be applying to this interface a copy port operation, to
   a destination port that has a dedicated monitoring device (e.g. a
   network analyzer) connected to it. A standard MIB interface for
   performing this operation is described in [18].


4. MIB Structure

   This MIB contains two MIB groups:

    - The interfaceTopNObjects

    - The usrTopNObjects

   The interfaceTopNObjects includes one capability object and two
   tables:
    - The interfaceControlTable
    - The interfaceTopNTable

   The interfaceControlTable is an RMON-style control table, allowing
   for the creation of interfaceTopN reports. The parameters specific
   for each report, like the duration of the report, the number of
   reports, start time and the characteristics of the variables that are
   sorted (absolute, 'deltas' or percentage of the total bandwidth) are
   set in this table. An optional operation that is controlled from this
   table is the normalization of values of the variables, which allows
   for sorting of variables on the interfaces, despite the basic speed
   of the interfaces being different on different interfaces.

   The interfaceTopNTable provides the results in a table associated
   with the control entries.

   The usrTopNObjects includes one capability object and two tables:
    - The usrControlTable
    - The usrTopNTable

   The interfaceControlTable is an RMON-style control table, allowing
   for the creation of usrTopN reports. The parameters specific for each
   report, like the duration of the report, the number of reports, start
   time and the characteristics of the variables that are sorted
   (absolute 'deltas' or percentage of the total bandwidth) are set in
   this table. An optional operation that is controlled from this table
   is the normalization of values of the variables, which allows for
   sorting of variables on the interfaces, despite the basic speed of
   the interfaces being different on different interfaces.




D.Romascanu               Expires November 2000                 [Page 4]





INTERNET DRAFT              InterfaceTopN MIB                   May 2000


   The usrTopNTable provides the results in a table associated with the
   control entries.

5. Evolution of the Document, Limitations and Future Work

   The RMON MIB Working Group included in its Charter a MIB document
   that would offer a solution to the problem of quickly determining the
   most congested (highest utilized) physical ports and links in an
   RMON-capable device with multiple interfaces.

   An intial solution, proposed in the first version of this document
   included a limited approach. The objects whose values are used as
   criteria for sorting are elements in tables indexed by an
   InterfaceIndex type of object, as defined in [19] and [20]. This
   approach simplifies the search algorithm and the result table, but
   restricts the method to interface parameters. A more generic
   'usrTopN' function was initially considered out of the scope of this
   work.

   At the Working Group meeting in Adelaide in March 2000, it was
   decided to try to define the more generic function of usrTopN. As a
   result, variables belonging to tables indexed by any type of indices
   may be sorted.

   The more genric approach may be considered a superset of the simpler
   one, but it involves extra processing and 'sanity' checking from the
   agent. The Working Group may decide eventually to chose only one of
   the two proposed approaches for the final version of this document
   that will enter the standards track.

   The following changes have been introduced in the second version
   draft-ietf- rmonmib-iftopn-mib-01.txt:
    - added capability object interfaceTopNCaps
    - changed interfaceTopNObjectVariable to an enumerated INTEGER, in
   order to clarify that the interfaceTopN function is strictly designed
   to cover the options described by the enumerated values, and has no
   general scope
    - added bandwidthPercetage enumerated value to
   interfaceTopNObjectSampleType
    - added interfaceTopNValue64 to interfaceTopNTable. The
   CounterBasedGauge64 TC is imported from [22] adopting the temporary
   solution proposed there in order to allow sorting of values derived
   from Counter64 objects.




6. Definitions



D.Romascanu               Expires November 2000                 [Page 5]





INTERNET DRAFT              InterfaceTopN MIB                   May 2000


   INTERFACETOPN-MIB DEFINITIONS ::= BEGIN

      IMPORTS
           MODULE-IDENTITY, OBJECT-TYPE, Counter32, Integer32, Gauge32
                   FROM SNMPv2-SMI
           RowStatus, TimeStamp, TEXTUAL-CONVENTION
                   FROM SNMPv2-TC
           rmon, OwnerString
                   FROM RMON-MIB
           rmonConformance, probeConfig
                   FROM RMON2-MIB
           CounterBasedGauge64
                   FROM HCNUM-TC
           MODULE-COMPLIANCE, OBJECT-GROUP
                   FROM SNMPv2-CONF;

      interfaceTopNMIB MODULE-IDENTITY
           LAST-UPDATED "200005090000Z"
           ORGANIZATION "IETF RMON MIB Working Group"
           CONTACT-INFO
           "

                   Dan Romascanu
                   Lucent Technologies
                   Tel:  +972-3-645-8414
                   Email: dromasca@lucent.com"

          DESCRIPTION
                   "The MIB module for sorting device interfaces for RMON and
                   SMON monitoring in a multiple device implementation."
           ::= { rmon 23 }

   interfaceTopNObjects       OBJECT IDENTIFIER ::= { interfaceTopNMIB 1 }
   usrTopNObjects             OBJECT IDENTIFIER ::= { interfaceTopNMIB 2 }
   interfaceTopNNotifications OBJECT IDENTIFIER ::= { interfaceTopNMIB 3 }
   interfaceTopNConformance   OBJECT IDENTIFIER ::= { interfaceTopNMIB 4 }

      -- The Interface Top N group is used to prepare reports that
      -- describe a list of interfaces (data sources)
      -- ordered by the values of one
      -- of the objects that apply to the interfaces of the respective device.
   -- Those objects are defined by standard MIBs. The exact objects that
   -- are supported by the agent are described by interfaceTopNCaps
      -- The objects must be elements in tables indexed only by an
      -- InterfaceIndex object.
      -- The objects  chosen by the
      -- management station may be sampled over a management
      -- station-specified time interval, making the report rate based.



D.Romascanu               Expires November 2000                 [Page 6]





INTERNET DRAFT              InterfaceTopN MIB                   May 2000


      -- The management station also specifies the number of interfaces
      -- that are reported.
      --
      -- The interfaceTopNControlTable is used to initiate the generation
      -- of a report.  The management station may select the parameters
      -- of such a report, such as which object, how
      -- many interfaces, and the start & stop times of the sampling.  When
      -- the report is prepared, entries are created in the
      -- interfaceTopNTable associated with the relevant
      -- interfaceTopNControlEntry.  These entries are static for
      -- each report after it has been prepared.

   interfaceTopNCaps   OBJECT-TYPE
       SYNTAX      BITS {
                  usrTopN(0),
                  ifInOctets(1),
                  ifInUcastPkts(2),
                  ifInNUcastPkts(3),
                  ifInDiscards(4),
                  ifInErrors(5),
                  ifInUnknownProtos(6),
                  ifOutOctets(7),
                  ifOutUcastPkts(8),
                  ifOutNUcastPkts(9),
                  ifOutDiscards(10),
                  ifOutErrors(11),
                  ifInMulticastPkts(12),
                  ifInBroadcastPkts(13),
                  ifOutMulticastPkts(14),
                  ifOutBroadcastPkts(15),
                  ifHCInOctets(16),
                  ifHCInUcastPkts(17),
                  ifHCInMulticastPkts(18),
                  ifHCInBroadcastPkts(19),
                  ifHCOutOctets(20),
                  ifHCOutUcastPkts(21),
                  ifHCOutMulticastPkts(22),
                  ifHCOutBroadcastPkts(23),
                  dot3StatsAlignmentErrors(24),
                  dot3StatsFCSErrors(25),
                  dot3StatsSingleCollisionFrames(26),
                  dot3StatsMultipleCollisionFrames(27),
                  dot3StatsSQETestErrors(28),
                  dot3StatsDeferredTransmissions(29),
                  dot3StatsLateCollisions(30),
                  dot3StatsExcessiveCollisions(31),
                  dot3StatsInternalMacTransmitErrors(32),
                  dot3StatsCarrierSenseErrors(33),



D.Romascanu               Expires November 2000                 [Page 7]





INTERNET DRAFT              InterfaceTopN MIB                   May 2000


                  dot3StatsFrameTooLongs(34),
                  dot3StatsInternalMacReceiveErrors(35),
                  dot3StatsSymbolErrors(36),
                  dot5StatsLineErrors(37),
                  dot5StatsBurstErrors(38),
                  dot5StatsACErrors(39),
                  dot5StatsAbortTransErrors(40),
                  dot5StatsInternalErrors(41),
                  dot5StatsLostFrameErrors(42),
                  dot5StatsReceiveCongestions(43),
                  dot5StatsFrameCopiedErrors(44),
                  dot5StatsTokenErrors(45),
                  dot5StatsSoftErrors(46),
                  dot5StatsHardErrors(47),
                  dot5StatsSignalLoss(48),
                  dot5StatsTransmitBeacons(49),
                  dot5StatsRecoverys(50),
                  dot5StatsLobeWires(51),
                  dot5StatsRemoves(52),
                  dot5StatsSingles(53),
                  dot5StatsFreqErrors(54)

       }
       MAX-ACCESS  read-only
       STATUS      current
       DESCRIPTION
               "The type(s) of sorting capabilities supported by the agent.

               If the agent supports usrTopN functionality, then the 'usrTopN'
               bit will be set. A management application SHOULD NOT try to
               access the usrTopN functionality if this bit is not set.

               If the agent can perform sorting of interfaces according to the
               values of ifInOctets, as defined in [20],
               then the 'ifInOctets' bit will be set.

               If the agent can perform sorting of interfaces according to the
               values of ifInUcastPkts, as defined in [20],
               then the 'ifInUcastPkts' bit will be set.

               If the agent can perform sorting of interfaces according to the
               values of ifInNUcastPkts, as defined in [20],
               then the 'ifInNUcastPkts' bit will be set.

               If the agent can perform sorting of interfaces according to the
               values of ifInDiscards, as defined in [20],
               then the 'ifInDiscards' bit will be set.




D.Romascanu               Expires November 2000                 [Page 8]





INTERNET DRAFT              InterfaceTopN MIB                   May 2000


               If the agent can perform sorting of interfaces according to the
               values of ifInErrors, as defined in [20],
               then the 'ifInErrors' bit will be set.

               If the agent can perform sorting of interfaces according to the
               values of ifInUnknownProtocols, as defined in [20],
               then the 'ifInUnknownProtocols' bit will be set.

               If the agent can perform sorting of interfaces according to the
               values of ifOutOctets, as defined in [20],
               then the 'ifOutOctets' bit will be set.

               If the agent can perform sorting of interfaces according to the
               values of ifOutUcastPackets, as defined in [20],
               then the 'ifOutUcastPackets' bit will be set.

               If the agent can perform sorting of interfaces according to the
               values of ifOutNUcastPackets, as defined in [20],
               then the 'ifOutNUcastPackets' bit will be set.

               If the agent can perform sorting of interfaces according to the
               values of ifOutDiscards, as defined in [20],
               then the 'ifOutDiscards' bit will be set.

               If the agent can perform sorting of interfaces according to the
               values of ifOutErrors, as defined in [20],
               then the 'ifOutErrors' bit will be set.

               If the agent can perform sorting of interfaces according to the
               values of ifInMulticastPkts, as defined in [20],
               then the 'ifInMulticastPkts' bit will be set.

               If the agent can perform sorting of interfaces according to the
               values of ifInBroadcastPkts, as defined in [20],
               then the 'ifInBroadcastPkts' bit will be set.

               If the agent can perform sorting of interfaces according to the
               values of ifOutMulticastPkts, as defined in [20],
               then the 'ifOutMulticastPkts' bit will be set.

               If the agent can perform sorting of interfaces according to the
               values of ifOutBroadcastPkts, as defined in [20],
               then the 'ifOutBroadcastPkts' bit will be set.

               If the agent can perform sorting of interfaces according to the
               values of ifHCInOctes, as defined in [20],
               then the 'ifHCInOctes' bit will be set.




D.Romascanu               Expires November 2000                 [Page 9]





INTERNET DRAFT              InterfaceTopN MIB                   May 2000


               If the agent can perform sorting of interfaces according to the
               values of ifHCInMulticastPkts, as defined in [20],
               then the 'ifHCInMulticastPkts' bit will be set.

               If the agent can perform sorting of interfaces according to the
               values of ifHCInBroadcastPkts, as defined in [20],
               then the 'ifHCInBroadcastPkts' bit will be set.

               If the agent can perform sorting of interfaces according to the
               values of ifHCOutOctets, as defined in [20],
               then the 'ifHCOutOctets' bit will be set.

               If the agent can perform sorting of interfaces according to the
               values of ifHCOutUcastPkts, as defined in [20],
               then the 'ifHCOutUcastPkts' bit will be set.

               If the agent can perform sorting of interfaces according to the
               values of ifHCOutMulticastPkts, as defined in [20],
               then the 'ifHCOutMulticastPkts' bit will be set.

               If the agent can perform sorting of interfaces according to the
               values of ifHCOutBroadcastPkts, as defined in [20],
               then the 'ifHCOutBroadcastPkts' bit will be set.

               If the agent can perform sorting of interfaces according to the
               values of dot3StatsAlignementErrors, as defined in [23],
               then the 'dot3StatsAlignementErrors' bit will be set.

               If the agent can perform sorting of interfaces according to the
               values of dot3StatsFCSErrors, as defined in [23],
               then the 'dot3StatsFCSErrors' bit will be set.

               If the agent can perform sorting of interfaces according to the
               values of dot3StatsSingleCollisionFrames, as defined in [23],
               then the 'dot3StatsSingleCollisionFrames' bit will be set.

               If the agent can perform sorting of interfaces according to the
               values of dot3StatsSQETestErrors, as defined in [23],
               then the 'dot3StatsSQETestErrors' bit will be set.

               If the agent can perform sorting of interfaces according to the
               values of dot3StatsDeferredTransmissions, as defined in [23],
               then the 'dot3StatsDeferredTransmissions' bit will be set.

               If the agent can perform sorting of interfaces according to the
               values of dot3StatsLateCollisions, as defined in [23],
               then the 'dot3StatsLateCollisions' bit will be set.




D.Romascanu               Expires November 2000                [Page 10]





INTERNET DRAFT              InterfaceTopN MIB                   May 2000


               If the agent can perform sorting of interfaces according to the
               values of dot3StatsExcessiveCollisions, as defined in [23],
               then the 'dot3StatsExcessiveCollisions' bit will be set.

               If the agent can perform sorting of interfaces according to the
               values of dot3StatsInternalMacTransmitErrors, as defined in [23],
               then the 'dot3StatsInternalMacTransmitErrors' bit will be set.

               If the agent can perform sorting of interfaces according to the
               values of dot3StatsCarrierSenseErrors, as defined in [23],
               then the 'dot3StatsCarrierSenseErrors' bit will be set.

               If the agent can perform sorting of interfaces according to the
               values of dot3StatsFrameTooLongs, as defined in [23],
               then the 'dot3StatsFrameTooLongs' bit will be set.

               If the agent can perform sorting of interfaces according to the
               values of dot3StatsInternalMacReceiveErrors, as defined in [23],
               then the 'dot3StatsInternalMacReceiveErrors' bit will be set.

               If the agent can perform sorting of interfaces according to the
               values of dot3StatsSymbolErrors, as defined in [23],
               then the 'dot3StatsSymbolErrors' bit will be set.

               If the agent can perform sorting of interfaces according to the
               values of dot5StatsLineErrors, as defined in [24],
               then the 'dot5StatsLineErrors' bit will be set.

               If the agent can perform sorting of interfaces according to the
               values of dot5StatsBurstErrors, as defined in [24],
               then the 'dot5StatsBurstErrors' bit will be set.

               If the agent can perform sorting of interfaces according to the
               values of dot5StatsACErrors, as defined in [24],
               then the 'dot5StatsACErrors' bit will be set.

               If the agent can perform sorting of interfaces according to the
               values of dot5StatsAbortTransErrors, as defined in [24],
               then the 'dot5StatsAbortTransErrors' bit will be set.

               If the agent can perform sorting of interfaces according to the
               values of dot5StatsInternalErrors, as defined in [24],
               then the 'dot5StatsInternalErrors' bit will be set.

               If the agent can perform sorting of interfaces according to the
               values of dot5StatsLostFrameErrors, as defined in [24],
               then the 'dot5StatsLostFrameErrors' bit will be set.




D.Romascanu               Expires November 2000                [Page 11]





INTERNET DRAFT              InterfaceTopN MIB                   May 2000


               If the agent can perform sorting of interfaces according to the
               values of dot5StatsReceiveCongestionErrors, as defined in [24],
               then the 'dot5StatsReceiveCongestionErrors' bit will be set.

               If the agent can perform sorting of interfaces according to the
               values of dot5StatsFrameCopiedErrors, as defined in [24],
               then the 'dot5StatsFrameCopiedErrors' bit will be set.

               If the agent can perform sorting of interfaces according to the
               values of dot5StatsTokenErrors, as defined in [24],
               then the 'dot5StatsTokenErrors' bit will be set.

               If the agent can perform sorting of interfaces according to the
               values of dot5StatsSoftErrors, as defined in [24],
               then the 'dot5StatsSoftErrors' bit will be set.

               If the agent can perform sorting of interfaces according to the
               values of dot5StatsHardErrors, as defined in [24],
               then the 'dot5StatsHardErrors' bit will be set.

               If the agent can perform sorting of interfaces according to the
               values of dot5StatsSignalLoss, as defined in [24],
               then the 'dot5StatsSignalLoss' bit will be set.

               If the agent can perform sorting of interfaces according to the
               values of dot5StatsTransmitBeacons, as defined in [24],
               then the 'dot5StatsTransmitBeacons' bit will be set.

               If the agent can perform sorting of interfaces according to the
               values of dot5StatsRecoverys, as defined in [24],
               then the 'dot5StatsRecoverys' bit will be set.

               If the agent can perform sorting of interfaces according to the
               values of dot5StatsLobeWires, as defined in [24],
               then the 'dot5StatsLobeWires' bit will be set.

               If the agent can perform sorting of interfaces according to the
               values of dot5StatsRemoves, as defined in [24],
               then the 'dot5StatsRemoves' bit will be set.

               If the agent can perform sorting of interfaces according to the
               values of dot5StatsSingles, as defined in [24],
               then the 'dot5StatsSingles' bit will be set.

               If the agent can perform sorting of interfaces according to the
               values of dot5StatsFreqErrors, as defined in [24],
               then the 'dot5StatsFreqErrors' bit will be set."
       ::= { interfaceTopNObjects 1 }



D.Romascanu               Expires November 2000                [Page 12]





INTERNET DRAFT              InterfaceTopN MIB                   May 2000


     interfaceTopNControlTable OBJECT-TYPE
          SYNTAX      SEQUENCE OF InterfaceTopNControlEntry
          MAX-ACCESS  not-accessible
          STATUS      current
          DESCRIPTION
              "A table of control records for reports on the top `N'
              interfaces for the value or rate of a selected object.
              The number of entries depends on the configuration of the agent.
              The maximum number of entries is implementation
              dependent."
          ::= { interfaceTopNObjects 2 }

      interfaceTopNControlEntry OBJECT-TYPE
          SYNTAX      InterfaceTopNControlEntry
          MAX-ACCESS  not-accessible
          STATUS      current
          DESCRIPTION
                  "A set of parameters that control the creation of a
                  report of the top N ports according to several metrics."
          INDEX    { interfaceTopNControlIndex }
          ::= { interfaceTopNControlTable 1 }

      InterfaceTopNControlEntry ::= SEQUENCE {
          interfaceTopNControlIndex
              Integer32,
          interfaceTopNObjectVariable
              INTEGER,
          InterfaceTopNObjectSampleType
              INTEGER,
          interfaceTopNNormalization
              INTEGER,
          interfaceTopNNormalizationFactor
              INTEGER,
          interfaceTopNControlGeneratedReports
              Counter32,
          interfaceTopNTimeRemaining
              Integer32,
          interfaceTopNDuration
              Integer32,
          interfaceTopNRequestedSize
              Integer32,
          interfaceTopNGrantedSize
              Integer32,
          interfaceTopNStartTime
              TimeStamp,
          interfaceTopNOwner
              OwnerString,
          interfaceTopNRowStatus



D.Romascanu               Expires November 2000                [Page 13]





INTERNET DRAFT              InterfaceTopN MIB                   May 2000


              RowStatus
      }

      interfaceTopNControlIndex OBJECT-TYPE
          SYNTAX      Integer32 (1 .. 65535)
          MAX-ACCESS  not-accessible
          STATUS      current
          DESCRIPTION
                  "An index that uniquely identifies an entry in the
                  interfaceTopNControl table.  Each such entry defines
                  one top N report prepared for a probe."
          ::= { interfaceTopNControlEntry 1 }


   interfaceTopNObjectVariable OBJECT-TYPE
       SYNTAX INTEGER   {
                  ifInOctets(1),
                  ifInUcastPkts(2),
                  ifInNUcastPkts(3),
                  ifInDiscards(4),
                  ifInErrors(5),
                  ifInUnknownProtos(6),
                  ifOutOctets(7),
                  ifOutUcastPkts(8),
                  ifOutNUcastPkts(9),
                  ifOutDiscards(10),
                  ifOutErrors(11),
                  ifInMulticastPkts(12),
                  ifInBroadcastPkts(13),
                  ifOutMulticastPkts(14),
                  ifOutBroadcastPkts(15),
                  ifHCInOctets(16),
                  ifHCInUcastPkts(17),
                  ifHCInMulticastPkts(18),
                  ifHCInBroadcastPkts(19),
                  ifHCOutOctets(20),
                  ifHCOutUcastPkts(21),
                  ifHCOutMulticastPkts(22),
                  ifHCOutBroadcastPkts(23),
                  dot3StatsAlignmentErrors(24),
                  dot3StatsFCSErrors(25),
                  dot3StatsSingleCollisionFrames(26),
                  dot3StatsMultipleCollisionFrames(27),
                  dot3StatsSQETestErrors(28),
                  dot3StatsDeferredTransmissions(29),
                  dot3StatsLateCollisions(30),
                  dot3StatsExcessiveCollisions(31),
                  dot3StatsInternalMacTransmitErrors(32),



D.Romascanu               Expires November 2000                [Page 14]





INTERNET DRAFT              InterfaceTopN MIB                   May 2000


                  dot3StatsCarrierSenseErrors(33),
                  dot3StatsFrameTooLongs(34),
                  dot3StatsInternalMacReceiveErrors(35),
                  dot3StatsSymbolErrors(36),
                  dot5StatsLineErrors(37),
                  dot5StatsBurstErrors(38),
                  dot5StatsACErrors(39),
                  dot5StatsAbortTransErrors(40),
                  dot5StatsInternalErrors(41),
                  dot5StatsLostFrameErrors(42),
                  dot5StatsReceiveCongestions(43),
                  dot5StatsFrameCopiedErrors(44),
                  dot5StatsTokenErrors(45),
                  dot5StatsSoftErrors(46),
                  dot5StatsHardErrors(47),
                  dot5StatsSignalLoss(48),
                  dot5StatsTransmitBeacons(49),
                  dot5StatsRecoverys(50),
                  dot5StatsLobeWires(51),
                  dot5StatsRemoves(52),
                  dot5StatsSingles(53),
                  dot5StatsFreqErrors(54)
              }
       MAX-ACCESS read-create
       STATUS current
       DESCRIPTION
           "The particular variable to be sampled.

           Values between 1 and 23, point to MIB objects defined in
           IF-MIB [20].

           Values between 24 and 36, point to MIB objects defined in
           EtherLike-MIB [23].

           Values between 37 and 54, point to MIB objects defined in
           TOKENRING-MIB [24].

           Only variables that resolve to an ASN.1 primitive type of
           Integer32 (Integer32, Counter, Gauge, or TimeTicks) may be
           sampled.

           Only variables belonging to tables indexed uniquely by an
           object of the type InterfaceIndex may be sampled.

           Because SNMP access control is articulated entirely in terms
           of the contents of MIB views, no access control mechanism
           exists that can restrict the value of this object to identify
           only those objects that exist in a particular MIB view.



D.Romascanu               Expires November 2000                [Page 15]





INTERNET DRAFT              InterfaceTopN MIB                   May 2000


           Because there is thus no acceptable means of restricting the
           read access that could be obtained through the TopN
           mechanism, the probe must only grant write access to this
           object in those views that have read access to all objects on
           the probe.

           During a set operation, if the supplied variable name is not
           available in the selected MIB view, or does not conform the
           other conditions mentioned above, a badValue error must be
           returned.

           This object may not be modified if the associated
           interfaceTopNControlStatus object is equal to active(1)."
       ::= { interfaceTopNControlEntry 2 }

   interfaceTopNObjectSampleType OBJECT-TYPE
       SYNTAX INTEGER {
                  absoluteValue(1),
                  deltaValue(2),
                  bandwidthPercentage(3)
              }
       MAX-ACCESS read-create
       STATUS current
       DESCRIPTION
           "The method of sampling the selected variable for storage in
           the interfaceTopNTable.

           If the value of this object is absoluteValue(1), the value of
           the selected variable will be copied directly into the topNValue.

           If the value of this object is deltaValue(2), the value of the
           selected variable at the last sample will be subtracted from
           the current value, and the difference will be stored in topNValue.

           If the value of this object is bandwidthPercentage(3), the agent
           Records the total number of octets sent over an interval divided
           by the total number of octets that represent '100% bandwidth'
           for that interface. This ratio is multiplied by 1000 to
           retain a 3 digit integer (0..1000) in units of
          'tenth of one percent'.

           This object may not be modified if the associated
           interfaceTopNControlStatus object is equal to active(1)."
       ::= { interfaceTopNObjectEntry 3 }


   interfaceTopNNormalization OBJECT-TYPE
       SYNTAX INTEGER {



D.Romascanu               Expires November 2000                [Page 16]





INTERNET DRAFT              InterfaceTopN MIB                   May 2000


                  normalizationRequired(1),
                  normalizationNotRequired(2)
              }
       MAX-ACCESS read-create
       STATUS current
       DESCRIPTION
           "The method of normalization in computation of the selected
            value.

           If the value of this object is normalizationRequired(1), the value of
           the selected variable will be multiplied by a factor equal to the
           effective speed of the interface divided by the value of
           interfaceTopNNormalizationFactor.

           If the value of this object is normalizationNot Required(2),
           the value of the selected variable will be taken 'as is' in
           the TopN computation.

          This object may not be modified if the associated
           interfaceTopNControlStatus object is equal to active(1)."
       ::= { interfaceTopNObjectEntry 4 }

   interfaceTopNNormalizationFactor OBJECT-TYPE
       SYNTAX INTEGER
       MAX-ACCESS read-create
       STATUS current
       DESCRIPTION
           "The value used for normalization if interfaceTopNNormalization
           has the value normalizationRequired(1)."
       DEFVAL { 1 }
   ::= { interfaceTopNObjectEntry 5 }

   interfaceTopNControlGeneratedReports OBJECT-TYPE
       SYNTAX     Counter32
       MAX-ACCESS read-only
       STATUS     current
       DESCRIPTION
           "The number of reports that have been generated by this entry."
       ::= { interfaceTopNControlEntry 6 }

     interfaceTopNTimeRemaining OBJECT-TYPE
          SYNTAX      Integer32 (0..2147483647)
          MAX-ACCESS  read-create
          STATUS      current
          DESCRIPTION
                  "The number of seconds left in the report
                  currently being collected.  When this object
                  is modified by the management station, a new



D.Romascanu               Expires November 2000                [Page 17]





INTERNET DRAFT              InterfaceTopN MIB                   May 2000


                  collection is started, possibly aborting a
                  currently running report.  The new value is
                  used as the requested duration of this report,
                  which is loaded into the associated
                  interfaceTopNDuration object.

                  When this object is set to a non-zero value,
                  any associated interfaceTopNEntries shall be
                  made inaccessible by the agent.  While the value
                  of this object is non-zero, it decrements by one
                  per second until it reaches zero.  During this
                  time, all associated interfaceTopNEntries shall
                  remain inaccessible.  At the time that this object
                  decrements to zero, the report is made accessible
                  in the interfaceTopNTable.  Thus, the interfaceTopN
                  table needs to be created only at the end of the
                  collection interval.

                  If the value of this object is set to zero
                  while the associated report is running, the
                  running report is aborted and no associated
                  interfaceTopNEntries are created."
          DEFVAL { 0 }
          ::= { interfaceTopNControlEntry 7 }

      interfaceTopNDuration OBJECT-TYPE
          SYNTAX      Integer32 (0..2147483647)
          MAX-ACCESS  read-only
          STATUS      current
          DESCRIPTION
                  "The number of seconds that this report has
                  collected during the last sampling interval,
                  or if this report is currently being collected,
                  the number of seconds that this report is being
                  collected during this sampling interval.

                  When the associated interfaceTopNTimeRemaining
                  object is set, this object shall be set by the
                  agent to the same value and shall not be modified
                  until the next time the interfaceTopNTimeRemaining
                  is set.

                  This value shall be zero if no reports have been
                  requested for this interfaceTopNControlEntry."
          ::= { interfaceTopNControlEntry 8 }

      interfaceTopNRequestedSize OBJECT-TYPE
          SYNTAX      Integer32



D.Romascanu               Expires November 2000                [Page 18]





INTERNET DRAFT              InterfaceTopN MIB                   May 2000


          MAX-ACCESS  read-create
          STATUS      current
          DESCRIPTION
                  "The maximum number of interfaces requested
                  for the Top N Table.

                  When this object is created or modified, the
                  agent should set interfaceTopNGrantedSize as close
                  to this object as is possible for the particular
                  implementation and available resources."
          DEFVAL { 10 }
          ::= { interfaceTopNControlEntry 9 }

      interfaceTopNGrantedSize OBJECT-TYPE
          SYNTAX      Integer32 (0..65535)
          MAX-ACCESS  read-only
          STATUS      current
          DESCRIPTION
                  "The maximum number of interfaces in the
                  top N table.

                  When the associated interfaceTopNRequestedSize object is
                  created or modified, the agent should set this object as
                  closely to the requested value as is possible for the
                  particular implementation and available resources.  The
                  agent must not lower this value except as a result of a
                  set to the associated interfaceTopNRequestedSize object."
          ::= { interfaceTopNControlEntry 10 }

      interfaceTopNStartTime OBJECT-TYPE
          SYNTAX      TimeStamp
          MAX-ACCESS  read-only
          STATUS      current
          DESCRIPTION
                  "The value of sysUpTime when this top N report was
                  last started.  In other words, this is the time that
                  the associated interfaceTopNTimeRemaining object was
                  modified to start the requested report.

                  If the report has not yet been started, the value
                  of this object is zero."
          ::= { interfaceTopNControlEntry 11 }

      interfaceTopNOwner OBJECT-TYPE
          SYNTAX      OwnerString
          MAX-ACCESS  read-create
          STATUS      current
          DESCRIPTION



D.Romascanu               Expires November 2000                [Page 19]





INTERNET DRAFT              InterfaceTopN MIB                   May 2000


                  "The entity that configured this entry and is
                  using the resources assigned to it."
          ::= { interfaceTopNControlEntry 12 }

      interfaceTopNRowStatus OBJECT-TYPE
          SYNTAX      RowStatus
          MAX-ACCESS  read-create
          STATUS      current
          DESCRIPTION
                 "The status of this row.

                 If the value of this object is not equal to
                 active(1), all associated entries in the
                 interfaceTopNTable shall be deleted by the
                 agent."
          ::= { interfaceTopNControlEntry 13 }


      -- Interface Top "N" reports

      interfaceTopNTable OBJECT-TYPE
          SYNTAX      SEQUENCE OF InterfaceTopNEntry
          MAX-ACCESS  not-accessible
          STATUS      current
          DESCRIPTION
                  "A table of reports for the top `N' ports based on
                  setting of associated control table entries. The
                  maximum number of entries depends on the number
                  of entries in table interfaceTopNControlTable and
                  the value of object interfaceTopNGrantedSize for
                  each entry.

                  For each entry in the interfaceTopNControlTable,
                  interfaces with the highest value of
                  interfaceTopNValue shall be placed in this table
                  in decreasing order of that rate until there is
                  no more room or until there are no more ports."
          ::= { interfaceTopNObjects 3 }

      interfaceTopNEntry OBJECT-TYPE
          SYNTAX      InterfaceTopNEntry
          MAX-ACCESS  not-accessible
          STATUS      current
          DESCRIPTION
                  "A set of statistics for an interface that is
                  part of a top N report."
          INDEX    { interfaceTopNControlIndex,
                     interfaceTopNIndex }



D.Romascanu               Expires November 2000                [Page 20]





INTERNET DRAFT              InterfaceTopN MIB                   May 2000


          ::= { interfaceTopNTable 1 }

      InterfaceTopNEntry ::= SEQUENCE {
          interfaceTopNIndex
              Integer32,
          interfaceTopNDataSourceIndex
              Integer32,
          interfaceTopNValue
              Gauge32,
          interfaceTopNValue64
              CounterBasedGauge64
      }

      interfaceTopNIndex OBJECT-TYPE
          SYNTAX      Integer32 (1..65535)
          MAX-ACCESS  not-accessible
          STATUS      current
          DESCRIPTION
                  "An index that uniquely identifies an entry in
                  the interfaceTopN table among those in the same
                  report.  This index is between 1 and N, where N
                  is the number of entries in this report.  Increasing
                  values of interfaceTopNIndex shall be assigned to
                  entries with decreasing values of interfaceTopNValue
                  until index N is assigned to the entry with the
                  lowest value of interfaceTopNValue or there are no
                  more interfaceTopNEntries.

                  No ports are included in a report where their
                  value of interfaceTopNValue would be zero."
          ::= { interfaceTopNEntry 1 }

      interfaceTopNDataSourceIndex OBJECT-TYPE
          SYNTAX      Integer32  (1..2147483647)
          MAX-ACCESS  read-only
          STATUS      current
          DESCRIPTION
                  "This object identifies the index corresponding
                   to the dataSource for this entry."
          ::= { interfaceTopNEntry 2 }

      interfaceTopNValue OBJECT-TYPE
          SYNTAX      Gauge32
          MAX-ACCESS  read-only
          STATUS      current
          DESCRIPTION
                  "The value at the end of the sampling interval, or
                  the amount of change in the selected variable



D.Romascanu               Expires November 2000                [Page 21]





INTERNET DRAFT              InterfaceTopN MIB                   May 2000


                  during this sampling interval for the identified
                  interface.  The selected variable is that interfaces's
                  instance of the object selected by
                  interfaceTopNObjectVariable.
                  This value of this object will be computed for all
                  cases when interfaceTopNObjectVariable points to a
                  32-bit counter or Gauge or when
                  interfaceTopNObjectSampleType equals bandwidthPercentage(3),
                  and will be zero for all other cases."
          ::= { interfaceTopNEntry 3 }

      interfaceTopNValue64 OBJECT-TYPE
          SYNTAX      CounterBasedGauge64
          MAX-ACCESS  read-only
          STATUS      current
          DESCRIPTION
                  "The value at the end of the sampling interval, or
                  the amount of change in the selected variable
                  during this sampling interval for the identified
                  interface.  The selected variable is that interfaces's
                  instance of the object selected by
                  interfaceTopNObjectVariable.
                  This value of this object will be computed for all
                  cases when interfaceTopNObjectVariable points to
                  a 64-bit counter, and will be zero for all other cases."
          ::= { interfaceTopNEntry 4 }

      -- The UsrTopN group is used to prepare reports that
   -- describe a list of sorted MIB objects that describe performance
   -- parameters of the interfaces, bridge ports, physical ports, physical
      -- entities of the respective device.
      -- Those objects may be defined by standard or proprietary MIBs.
      -- The objects  chosen by the
      -- management station may be sampled over a management
      -- station-specified time interval, making the report rate based.
      -- The management station also specifies the number of objects
      -- that are reported.
      --
      -- The usrTopNControlTable is used to initiate the generation
      -- of a report.  The management station may select the parameters
      -- of such a report, such as which object, how
      -- many interfaces, and the start & stop times of the sampling.  When
      -- the report is prepared, entries are created in the
      -- usrTopNTable associated with the relevant
      -- usrTopNControlEntry.  These entries are static for
      -- each report after it has been prepared

   -- usrTopN MIB Group



D.Romascanu               Expires November 2000                [Page 22]





INTERNET DRAFT              InterfaceTopN MIB                   May 2000


   usrTopNControlTable OBJECT-TYPE
          SYNTAX      SEQUENCE OF UsrTopNControlEntry
          MAX-ACCESS  not-accessible
          STATUS      current
          DESCRIPTION
              "A table of control records for reports on the top `N'
              values for the value or rate of a selected object.
              The number of entries depends on the configuration of the agent.
              The maximum number of entries is implementation
              dependent."
          ::= { usrTopNObjects 1 }

      usrTopNControlEntry OBJECT-TYPE
          SYNTAX      UsrTopNControlEntry
          MAX-ACCESS  not-accessible
          STATUS      current
          DESCRIPTION
                  "A set of parameters that control the creation of a
                  report of the top N entities according to several metrics."
          INDEX    { usrTopNControlIndex }
          ::= { usrTopNControlTable 1 }

      UsrTopNControlEntry ::= SEQUENCE {
          usrTopNControlIndex
              Integer32,
          usrTopNObjectVariable
              OBJECT IDENTIFIER,
          UsrTopNObjectSampleType
              INTEGER,
          usrTopNNormalization
              INTEGER,
          usrTopNNormalizationFactor
              INTEGER,
          usrTopNControlGeneratedReports
              Counter32,
          usrTopNTimeRemaining
              Integer32,
          usrTopNDuration
              Integer32,
          usrTopNRequestedSize
              Integer32,
          usrTopNGrantedSize
              Integer32,
          usrTopNStartTime
              TimeStamp,
          usrTopNOwner
              OwnerString,
          usrTopNRowStatus



D.Romascanu               Expires November 2000                [Page 23]





INTERNET DRAFT              InterfaceTopN MIB                   May 2000


              RowStatus
      }

   usrTopNControlIndex OBJECT-TYPE
          SYNTAX      Integer32 (1 .. 65535)
          MAX-ACCESS  not-accessible
          STATUS      current
          DESCRIPTION
                  "An index that uniquely identifies an entry in the
                  usrTopNControl table.  Each such entry defines
                  one top N report prepared for a probe."
          ::= { usrTopNControlEntry 1 }


   usrTopNObjectVariable OBJECT-TYPE
       SYNTAX OBJECT IDENTIFIER
       MAX-ACCESS read-create
       STATUS current
       DESCRIPTION
           "The object identifier of the particular variable to be
           sampled. This object points to a column in a table, and the
           particular instances belonging to that column are the one to
           be sorted.

           Only variables that resolve to an ASN.1 primitive type of
           Integer32 (Integer32, Counter, Gauge, or TimeTicks) may be
           sampled.

           if Normalization is on, the Normalization factor is walked in sync
           with walking the usrTopNObjectVariable column (e.g. like running:
           % snmpwalk ifInOctets ifSpeed)

           This would walk both columns in the same series of packets
           (i.e. the first packet is getNext(ifInOctets, ifSpeed) and the
           second is getNext(ifInOctets.1, ifSpeed.1). The walk is completed
           when either of the two returned variables is not a subchild of
           ifInOctets or ifSpeed respectively.

           Because SNMP access control is articulated entirely in terms
           of the contents of MIB views, no access control mechanism
           exists that can restrict the value of this object to identify
           only those objects that exist in a particular MIB view.
           Because there is thus no acceptable means of restricting the
           read access that could be obtained through the TopN
           mechanism, the probe must only grant write access to this
           object in those views that have read access to all objects on
           the probe.




D.Romascanu               Expires November 2000                [Page 24]





INTERNET DRAFT              InterfaceTopN MIB                   May 2000


           During a set operation, if the supplied variable name is not
           available in the selected MIB view, or does not conform the
           other conditions mentioned above, a badValue error must be
           returned.

           This object may not be modified if the associated
           usrTopNControlStatus object is equal to active(1)."
       ::= { usrTopNControlEntry 2 }

   usrTopNObjectSampleType OBJECT-TYPE
       SYNTAX INTEGER {
                  absoluteValue(1),
                  deltaValue(2),
                  bandwidthPercentage(3)
              }
       MAX-ACCESS read-create
       STATUS current
       DESCRIPTION
           "The method of sampling the selected variable for storage in
           the usrTopNTable.

           If the value of this object is absoluteValue(1), the value of
           the selected variable will be copied directly into the topNValue.

           If the value of this object is deltaValue(2), the value of the
           selected variable at the last sample will be subtracted from
           the current value, and the difference will be stored in topNValue.

           If the value of this object is bandwidthPercentage(3), the agent
           Records the total number of octets sent over an interval divided
           by the total number of octets that represent '100% bandwidth'
           for that interface. This ratio is multiplied by 1000 to
           retain a 3 digit integer (0..1000) in units of
          'tenth of one percent'.

           This object may not be modified if the associated
           usrTopNControlStatus object is equal to active(1)."
       ::= { usrTopNObjectEntry 3 }


   usrTopNNormalization OBJECT-TYPE
       SYNTAX INTEGER {
                  normalizationRequired(1),
                  normalizationNotRequired(2)
              }
       MAX-ACCESS read-create
       STATUS current
       DESCRIPTION



D.Romascanu               Expires November 2000                [Page 25]





INTERNET DRAFT              InterfaceTopN MIB                   May 2000


           "The method of normalization in computation of the selected
            value.

           If the value of this object is normalizationRequired(1), the value of
           the selected variable will be multiplied by a factor equal to the
           effective speed of the interface divided by the value of
           usrTopNNormalizationFactor.

           If the value of this object is normalizationNot Required(2),
           the value of the selected variable will be taken 'as is' in
           the TopN computation.

          This object may not be modified if the associated
           usrTopNControlStatus object is equal to active(1)."
       ::= { usrTopNObjectEntry 4 }

   usrTopNNormalizationFactor OBJECT-TYPE
       SYNTAX INTEGER
       MAX-ACCESS read-create
       STATUS current
       DESCRIPTION
           "The value used for normalization if usrTopNNormalization
           has the value normalizationRequired(1)."
       DEFVAL { 1 }
   ::= { usrTopNObjectEntry 5 }

   usrTopNControlGeneratedReports OBJECT-TYPE
       SYNTAX     Counter32
       MAX-ACCESS read-only
       STATUS     current
       DESCRIPTION
           "The number of reports that have been generated by this entry."
       ::= { usrTopNControlEntry 6 }

     usrTopNTimeRemaining OBJECT-TYPE
          SYNTAX      Integer32 (0..2147483647)
          MAX-ACCESS  read-create
          STATUS      current
          DESCRIPTION
                  "The number of seconds left in the report
                  currently being collected.  When this object
                  is modified by the management station, a new
                  collection is started, possibly aborting a
                  currently running report.  The new value is
                  used as the requested duration of this report,
                  which is loaded into the associated
                  usrTopNDuration object.




D.Romascanu               Expires November 2000                [Page 26]





INTERNET DRAFT              InterfaceTopN MIB                   May 2000


                  When this object is set to a non-zero value,
                  any associated usrTopNEntries shall be
                  made inaccessible by the agent.  While the value
                  of this object is non-zero, it decrements by one
                  per second until it reaches zero.  During this
                  time, all associated usrTopNEntries shall
                  remain inaccessible.  At the time that this object
                  decrements to zero, the report is made accessible
                  in the usrTopNTable.  Thus, the usrTopN
                  table needs to be created only at the end of the
                  collection interval.

                  If the value of this object is set to zero
                  while the associated report is running, the
                  running report is aborted and no associated
                  usrTopNEntries are created."
          DEFVAL { 0 }
          ::= { usrTopNControlEntry 7 }

      usrTopNDuration OBJECT-TYPE
          SYNTAX      Integer32 (0..2147483647)
          MAX-ACCESS  read-only
          STATUS      current
          DESCRIPTION
                  "The number of seconds that this report has
                  collected during the last sampling interval,
                  or if this report is currently being collected,
                  the number of seconds that this report is being
                  collected during this sampling interval.

                  When the associated usrTopNTimeRemaining
                  object is set, this object shall be set by the
                  agent to the same value and shall not be modified
                  until the next time the usrTopNTimeRemaining
                  is set.

                  This value shall be zero if no reports have been
                  requested for this usrTopNControlEntry."
          ::= { usrTopNControlEntry 8 }

      usrTopNRequestedSize OBJECT-TYPE
          SYNTAX      Integer32
          MAX-ACCESS  read-create
          STATUS      current
          DESCRIPTION
                  "The maximum number of interfaces requested
                  for the Top N Table.




D.Romascanu               Expires November 2000                [Page 27]





INTERNET DRAFT              InterfaceTopN MIB                   May 2000


                  When this object is created or modified, the
                  agent should set usrTopNGrantedSize as close
                  to this object as is possible for the particular
                  implementation and available resources."
          DEFVAL { 10 }
          ::= { usrTopNControlEntry 9 }

      usrTopNGrantedSize OBJECT-TYPE
          SYNTAX      Integer32 (0..65535)
          MAX-ACCESS  read-only
          STATUS      current
          DESCRIPTION
                  "The maximum number of interfaces in the
                  top N table.

                  When the associated usrTopNRequestedSize object is
                  created or modified, the agent should set this object as
                  closely to the requested value as is possible for the
                  particular implementation and available resources.  The
                  agent must not lower this value except as a result of a
                  set to the associated usrTopNRequestedSize object."
          ::= { usrTopNControlEntry 10 }

      usrTopNStartTime OBJECT-TYPE
          SYNTAX      TimeStamp
          MAX-ACCESS  read-only
          STATUS      current
          DESCRIPTION
                  "The value of sysUpTime when this top N report was
                  last started.  In other words, this is the time that
                  the associated usrTopNTimeRemaining object was
                  modified to start the requested report.

                  If the report has not yet been started, the value
                  of this object is zero."
          ::= { usrTopNControlEntry 11 }

      usrTopNOwner OBJECT-TYPE
          SYNTAX      OwnerString
          MAX-ACCESS  read-create
          STATUS      current
          DESCRIPTION
                  "The entity that configured this entry and is
                  using the resources assigned to it."
          ::= { usrTopNControlEntry 12 }

      usrTopNRowStatus OBJECT-TYPE
          SYNTAX      RowStatus



D.Romascanu               Expires November 2000                [Page 28]





INTERNET DRAFT              InterfaceTopN MIB                   May 2000


          MAX-ACCESS  read-create
          STATUS      current
          DESCRIPTION
                 "The status of this row.

                 If the value of this object is not equal to
                 active(1), all associated entries in the
                 usrTopNTable shall be deleted by the
                 agent."
          ::= { usrTopNControlEntry 13 }


      -- usrTop "N" reports

      usrTopNTable OBJECT-TYPE
          SYNTAX      SEQUENCE OF UsrTopNEntry
          MAX-ACCESS  not-accessible
          STATUS      current
          DESCRIPTION
                  "A table of reports for the top `N' entities based on
                  setting of associated control table entries. The
                  maximum number of entries depends on the number
                  of entries in table usrTopNControlTable and
                  the value of object usrTopNGrantedSize for
                  each entry.

                  For each entry in the usrTopNControlTable,
                  interfaces with the highest value of
                  usrTopNValue shall be placed in this table
                  in decreasing order of that rate until there is
                  no more room or until there are no more ports."
          ::= { usrTopNObjects 2 }

      usrTopNEntry OBJECT-TYPE
          SYNTAX      UsrTopNEntry
          MAX-ACCESS  not-accessible
          STATUS      current
          DESCRIPTION
                  "A set of statistics for an interface that is
                  part of a top N report."
          INDEX    { usrTopNControlIndex,
                     usrTopNIndex }
          ::= { usrTopNTable 1 }

      UsrTopNEntry ::= SEQUENCE {
          usrTopNIndex
              Integer32,
          usrTopNInstance



D.Romascanu               Expires November 2000                [Page 29]





INTERNET DRAFT              InterfaceTopN MIB                   May 2000


              OBJECT IDENTIFIER,
          usrTopNValue
              Gauge32,
          usrTopNValue64
              CounterBasedGauge64
      }

      usrTopNIndex OBJECT-TYPE
          SYNTAX      Integer32 (1..65535)
          MAX-ACCESS  not-accessible
          STATUS      current
          DESCRIPTION
                  "An index that uniquely identifies an entry in
                  the usrTopN table among those in the same
                  report.  This index is between 1 and N, where N
                  is the number of entries in this report.  Increasing
                  values of usrTopNIndex shall be assigned to
                  entries with decreasing values of usrTopNValue
                  until index N is assigned to the entry with the
                  lowest value of usrTopNValue or there are no
                  more usrTopNEntries.

                  No ports are included in a report where their
                  value of usrTopNValue would be zero."
          ::= { usrTopNEntry 1 }

      usrTopNInstance OBJECT-TYPE
          SYNTAX      OBJECT IDENTIFIER
          MAX-ACCESS  read-only
          STATUS      current
          DESCRIPTION
                  "This object identifies the instance corresponding
                   to this entry."
          ::= { usrTopNEntry 2 }

      usrTopNValue OBJECT-TYPE
          SYNTAX      Gauge32
          MAX-ACCESS  read-only
          STATUS      current
          DESCRIPTION
                  "The value at the end of the sampling interval, or
                  the amount of change in the selected variable
                  during this sampling interval for the identified
                  interface.  The selected variable is that interfaces's
                  instance of the object selected by
                  usrTopNObjectVariable.
                  This value of this object will be computed for all
                  cases when usrTopNObjectVariable points to a



D.Romascanu               Expires November 2000                [Page 30]





INTERNET DRAFT              InterfaceTopN MIB                   May 2000


                  32-bit counter or Gauge or when
                  usrTopNObjectSampleType equals bandwidthPercentage(3),
                  and will be zero for all other cases."
          ::= { usrTopNEntry 3 }

      usrTopNValue64 OBJECT-TYPE
          SYNTAX      CounterBasedGauge64
          MAX-ACCESS  read-only
          STATUS      current
          DESCRIPTION
                  "The value at the end of the sampling interval, or
                  the amount of change in the selected variable
                  during this sampling interval for the identified
                  interface.  The selected variable is that interfaces's
                  instance of the object selected by
                  usrTopNObjectVariable.
                  This value of this object will be computed for all
                  cases when usrTopNObjectVariable points to
                  a 64-bit counter, and will be zero for all other cases."
          ::= { usrTopNEntry 4 }

   --
   -- Notifications Section
   -- (none defined)
   --

   --
   -- Conformance Section
   --

   interfaceTopNCompliances OBJECT IDENTIFIER ::= { interfaceTopNConformance 1 }
   interfaceTopNGroups      OBJECT IDENTIFIER ::= { interfaceTopNConformance 2 }

   interfaceTopNCompliance MODULE-COMPLIANCE
       STATUS  current
       DESCRIPTION
               "Describes the requirements for conformance to the
               InterfaceTopN MIB."
           MODULE  -- this module
           MANDATORY-GROUPS { interfaceTopNGroup }
           GROUP   usrTopNGroup
           DESCRIPTION
               "The usrTopNGroup is mandatory for systems which
               implement user defined (usrTopN) sorting ."
        ::= { interfaceTopNCompliances 1 }

   interfaceTopNGroup OBJECT-GROUP
       OBJECTS {



D.Romascanu               Expires November 2000                [Page 31]





INTERNET DRAFT              InterfaceTopN MIB                   May 2000


          interfaceTopNCaps,
          interfaceTopNControlIndex,
          interfaceTopNObjectVariable,
          interfaceTopNObjectSampleType,
          interfaceTopNNormalization,
          interfaceTopNNormalizationFactor,
          interfaceTopNControlGeneratedReports,
          interfaceTopNTimeRemaining,
          interfaceTopNDuration,
          interfaceTopNRequestedSize,
          interfaceTopNGrantedSize,
          interfaceTopNStartTime,
          interfaceTopNOwner,
          interfaceTopNRowStatus,
          interfaceTopNIndex,
          interfaceTopNDataSourceIndex,
          interfaceTopNValue,
          interfaceTopNValue64
       }
       STATUS  current
       DESCRIPTION
               "A collection of objects providing interfaceTopN data for
               a multiple interfaces device."
   ::= { interfaceTopNGroups 1 }

   usrTopNGroup OBJECT-GROUP
       OBJECTS {
          usrTopNControlIndex,
          usrTopNObjectVariable,
          usrTopNObjectSampleType,
          usrTopNNormalization,
          usrTopNNormalizationFactor,
          usrTopNControlGeneratedReports,
          usrTopNTimeRemaining,
          usrTopNDuration,
          usrTopNRequestedSize,
          usrTopNGrantedSize,
          usrTopNStartTime,
          usrTopNOwner,
          usrTopNRowStatus,
          usrTopNIndex,
          usrTopNInstance,
          usrTopNValue,
          usrTopNValue64
       }
       STATUS  current
       DESCRIPTION
               "A collection of objects providing usrTopN data for



D.Romascanu               Expires November 2000                [Page 32]





INTERNET DRAFT              InterfaceTopN MIB                   May 2000


               a multiple interfaces device."
   ::= { interfaceTopNGroups 2 }


   END





7. References

       [1] Harrington, D., Presuhn, R., and B. Wijnen, "An Architecture for
           Describing SNMP Management Frameworks", RFC 2271, Cabletron
           Systems, Inc., BMC Software, Inc., IBM T. J. Watson Research,
           January 1998

       [2] Rose, M., and K. McCloghrie, "Structure and Identification of
           Management Information for TCP/IP-based Internets", STD 16,
           RFC 1155, Performance Systems International, Hughes LAN Systems,
           May 1990

       [3] Rose, M., and K. McCloghrie, "Concise MIB Definitions", STD 16,
           RFC 1212, Performance Systems International, Hughes LAN Systems,

       [4] M. Rose, "A Convention for Defining Traps for use with the
           SNMP", RFC 1215, Performance Systems International, March 1991

       [5] Case, J., McCloghrie, K., Rose, M., and S. Waldbusser,
           "Structure of Management Information for Version 2 of the Simple
           Network Management Protocol (SNMPv2)", RFC 1902, SNMP Research,
           Inc., Cisco Systems, Inc., Dover Beach Consulting, Inc.,
           International Network Services, January 1996.

       [6] Case, J., McCloghrie, K., Rose, M., and S. Waldbusser, "Textual
           Conventions for Version 2 of the Simple Network Management
           Protocol (SNMPv2)", RFC 1903, SNMP Research, Inc., Cisco
           Systems, Inc., Dover Beach Consulting, Inc., International
           Network Services, January 1996.

       [7] Case, J., McCloghrie, K., Rose, M., and S. Waldbusser,
           "Conformance Statements for Version 2 of the Simple Network
           Management Protocol (SNMPv2)", RFC 1904, SNMP Research, Inc.,
           Cisco Systems, Inc., Dover Beach Consulting, Inc., International
           Network Services, January 1996.

       [8] Case, J., Fedor, M., Schoffstall, M., and J. Davin, "Simple
           Network Management Protocol", STD 15, RFC 1157, SNMP Research,



D.Romascanu               Expires November 2000                [Page 33]





INTERNET DRAFT              InterfaceTopN MIB                   May 2000


           Performance Systems International, Performance Systems
           International, MIT Laboratory for Computer Science, May 1990.

       [9] Case, J., McCloghrie, K., Rose, M., and S. Waldbusser,
           "Introduction to Community-based SNMPv2", RFC 1901, SNMP
           Research, Inc., Cisco Systems, Inc., Dover Beach Consulting,
           Inc., International Network Services, January 1996.

      [10] Case, J., McCloghrie, K., Rose, M., and S. Waldbusser,
           "Transport Mappings for Version 2 of the Simple Network
           Management Protocol (SNMPv2)", RFC 1906, SNMP Research, Inc.,
           Cisco Systems, Inc., Dover Beach Consulting, Inc., International
           Network Services, January 1996.

      [11] Case, J., Harrington D., Presuhn R., and B. Wijnen, "Message
           Processing and Dispatching for the Simple Network Management
           Protocol (SNMP)", RFC 2272, SNMP Research, Inc., Cabletron
           Systems, Inc., BMC Software, Inc., IBM T. J. Watson Research,
           January 1998.

      [12] Blumenthal, U., and B. Wijnen, "User-based Security Model (USM)
           for version 3 of the Simple Network Management Protocol
           (SNMPv3)", RFC 2274, IBM T. J. Watson Research, January 1998.

      [13] Case, J., McCloghrie, K., Rose, M., and S. Waldbusser, "Protocol
           Operations for Version 2 of the Simple Network Management
           Protocol (SNMPv2)", RFC 1905, SNMP Research, Inc., Cisco
           Systems, Inc., Dover Beach Consulting, Inc., International
           Network Services, January 1996.

      [14] Levi, D., Meyer, P., and B. Stewart, "SNMPv3 Applications", RFC
           2273, SNMP Research, Inc., Secure Computing Corporation, Cisco
           Systems, January 1998

      [15] Wijnen, B., Presuhn, R., and K. McCloghrie, "View-based Access
           Control Model (VACM) for the Simple Network Management Protocol
           (SNMP)", RFC 2275, IBM T. J. Watson Research, BMC Software,
           Inc., Cisco Systems, Inc., January 1998

      [16] Bradner, S., "Key words for use in RFCs to Indicate Requirement
           Levels", BCP 14, RFC 2119, Harvard University, March 1997.

      [17] Waldbusser, S., "Remote Network Monitoring Management
           Information Base", RFC 1757, Carnegie Mellon University,
           February 1995

      [18] Waterman, R., Lahaye, B., Romascanu, D., and S. Waldbusser, "Remote
           Network Monitoring MIB Extensions for Switched Networks, Version



D.Romascanu               Expires November 2000                [Page 34]





INTERNET DRAFT              InterfaceTopN MIB                   May 2000


           1.0", Internet-Draft, February 1999

      [19] McCloghrie, K., and M. Rose, Editors, "Management Information
           Base for Network Management of TCP/IP-based internets: MIB-II",
           STD 17, RFC 1213, Hughes LAN Systems, Performance Systems
           International, March 1991.

      [20] McCloghrie, K., and Kastenholtz, F., "The Interfaces Group MIB
           using SMIv2", RFC 2233, Cisco Systems, FTP Software, November
           1997.

      [21] Stewart B., "Distributed Management Expression MIB", Internet-Draft,
           February 1999

      [22] Bierman, A., McCloghrie, K., and Presuhn R., "Textual Conventions for
           Additional High Capacity Data Types", Internet Draft, Cisco Systems,
           Inc., February 2000

      [23] Flick, J., and Johnson, J., "Definitions of Managed Objects for the
           Ethernet-like Interface Types", RFC 2665, Hewlett-Packard Company,
           RedBack Networks, August 1999

      [24] McCloghrie, K., and Decker E., "IEEE802.5 MIB Using SMIv2", RFC 1748,
           Cisco Systems, December 1994



8. Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   intellectual property or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; neither does it represent that it
   has made any effort to identify any such rights.  Information on the
   IETF's procedures with respect to rights in standards-track and
   standards-related documentation can be found in BCP-11.  Copies of
   claims of rights made available for publication and any assurances of
   licenses to be made available, or the result of an attempt made to
   obtain a general license or permission for the use of such
   proprietary rights by implementors or users of this specification can
   be obtained from the IETF Secretariat.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights which may cover technology that may be required to practice
   this standard.  Please address the information to the IETF Executive
   Director.



D.Romascanu               Expires November 2000                [Page 35]





INTERNET DRAFT              InterfaceTopN MIB                   May 2000


9.  Security Considerations

   There are a number of management objects defined in this MIB
   that have a MAX-ACCESS clause of read-write and/or read-create.
   Such objects may be considered sensitive or vulnerable in some
   network environments.  The support for SET operations in a
   non-secure environment without proper protection can have a
   negative effect on network operations.

   There are a number of managed objects in this MIB that may
   contain sensitive information. These are:
       interfaceTopNDataSourceIndex
       intefaceTopNValue
       usrTopNInstance
       usrTopNValue

   It is thus important to control even GET access to these objects
   and possibly to even encrypt the values of these object when
   sending them over the network via SNMP.  Not all versions of
   SNMP provide features for such a secure environment.

   SNMPv1 by itself is not a secure environment.  Even if the
   network itself is secure (for example by using IPSec), even then,
   there is no control as to who on the secure network is allowed
   to access and GET/SET (read/change/create/delete) the objects in
   this MIB.

   It is RECOMMENDED that the implementers consider the security
   features as provided by the SNMPv3 framework.  Specifically, the
   use of the User-based Security Model RFC 2274 [12] and the
   View-based Access Control Model RFC 2275 [15] is RECOMMENDED.

   It is then a customer/user responsibility to ensure that the SNMP
   entity giving access to an instance of this MIB, is properly
   configured to give access to the objects only to those
   principals (users) that have legitimate rights to indeed GET or
   SET (change/create/delete) them.

10.  Author's Address

        Dan Romascanu
        Lucent Technologies
        Atidim Technology Park, Bldg. #3
        Tel Aviv, 61131
        Israel
        Tel: +972-3-645-8414
        Email: dromasca@lucent.com




D.Romascanu               Expires November 2000                [Page 36]





INTERNET DRAFT              InterfaceTopN MIB                   May 2000


   A.  Full Copyright Statement

   This document and translations of it may be copied and furnished to
   others, and derivative works that comment on or otherwise explain it
   or assist in its implementation may be prepared, copied, published
   and distributed, in whole or in part, without restriction of any
   kind, provided that the above copyright notice and this paragraph are
   included on all such copies and derivative works.  However, this
   document itself may not be modified in any way, such as by removing
   the copyright notice or references to the Internet Society or other
   Internet organizations, except as needed for the purpose of
   developing Internet standards in which case the procedures for
   copyrights defined in the Internet Standards process must be
   followed, or as required to translate it into languages other than
   English.

   The limited permissions granted above are perpetual and will not be
   revoked by the Internet Society or its successors or assigns.

   This document and the information contained herein is provided on an
   "AS IS" basis and THE INTERNET SOCIETY AND THE INTERNET ENGINEERING
   TASK FORCE DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING
   BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE INFORMATION
   HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED WARRANTIES OF
   MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.


























D.Romascanu               Expires November 2000                [Page 37]


