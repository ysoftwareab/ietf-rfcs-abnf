<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Carrying next-hop cost
    information in BGP</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Carrying next-hop cost
    information in BGP">
<meta name="keywords" content="IDR, BGP">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 60em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 60em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Internet Engineering Task Force</td><td class="header">I. Varlashkin</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Easynet Global Services</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">R. Raszuk</td></tr>
<tr><td class="header">Expires: July 28, 2011</td><td class="header">Cisco Systems</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">January 24, 2011</td></tr>
</table></td></tr></table>
<h1><br />Carrying next-hop cost
    information in BGP<br />draft-varlashkin-bgp-nh-cost-00</h1>

<h3>Abstract</h3>

<p>This document describes new BGP SAFI to exchange cost information to
      next-hops for the purpose of calculating best path from a peer
      perspective rather than local BGP speaker own perspective.
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted  in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF).  Note that other groups may also distribute
working documents as Internet-Drafts.  The list of current
Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
This Internet-Draft will expire on July 28, 2011.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2011 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the Simplified BSD License.</p>
<p>
This document may contain material from IETF Documents or IETF
Contributions published or made publicly available before November
10, 2008.  The person(s) controlling the copyright in some of this
material may not have granted the IETF Trust the right to allow
modifications of such material outside the IETF Standards Process.
Without obtaining an adequate license from the person(s) controlling
the copyright in such materials, this document may not be modified
outside the IETF Standards Process, and derivative works of it may
not be created outside the IETF Standards Process, except to format
it for publication as an RFC or to translate it into languages other
than English.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Motivation<br />
<a href="#anchor2">2.</a>&nbsp;
NEXT-HOP INFORMATION BASE<br />
<a href="#anchor3">3.</a>&nbsp;
BGP BEST PATH SELECTION MODIFICATION<br />
<a href="#anchor4">4.</a>&nbsp;
USING BGP TO POPULATE NHIB<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">4.1.</a>&nbsp;
NEXT-HOP SAFI<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">4.2.</a>&nbsp;
CAPABILITY ADVERTISEMENT<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">4.3.</a>&nbsp;
INFORMATION ENCODING<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">4.4.</a>&nbsp;
SESSION ESTABLISHMENT<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">4.5.</a>&nbsp;
INFORMATION EXCHANGE<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">4.6.</a>&nbsp;
TERMINATION OF NH SAFI SESSION<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">4.7.</a>&nbsp;
GRACEFUL RESTART AND ROUTE REFRESH<br />
<a href="#anchor12">5.</a>&nbsp;
Security considerations<br />
<a href="#anchor13">6.</a>&nbsp;
IANA Considerations<br />
<a href="#rfc.references1">7.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">7.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">7.2.</a>&nbsp;
Informative References<br />
<a href="#anchor16">Appendix&nbsp;A.</a>&nbsp;
Corner case<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Motivation</h3>

<p>In certain situation route-reflector clients may not get optimum path
      to certain destinations. ADDPATH solves this problem by letting
      route-reflector to advertise multiple paths for given prefix. If number
      of advertised paths sufficiently big, route-reflector clients can choose
      same route as they would in case of full-mesh. This approach however
      places additional burden on the control plane. Solutions proposed by
      [BGP-ORR] use different approach - instead of calculating best path from
      local speaker own perspective the calculations are done using cost from
      the client to the next-hops. Although they eliminate need for
      transmitting redundant routing information between peers, there are
      scenarios where cost to the next-hop cannot be obtained accurately using
      this methods. For example, if next-hop information itself has been
      learned via BGP then simple SPF run on link-state database won't be
      sufficient to obtain cost information. To address such scenarios this
      document proposes a solution where cost information to the next-hops is
      carried within BGP itself using dedicated SAFI.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
NEXT-HOP INFORMATION BASE</h3>

<p>To facilitate further description of the proposed solution we
      introduce new table for all known next hops and costs to it from various
      routers on the network.
</p>
<p>Next-Hop Information Base (NHIB) stores cost to reach next-hop from
      arbitrary router on the network. This information is essential for
      choosing best path from a peer perspective rather than BGP-speaker own
      perspective. In canonical form NHIB entry is triplet (router, next-hop,
      cost), however this specification does not impose any restriction on how
      BGP implementations store that information internally. The cost in NHIB
      is does not have to be an IGP cost, but all costs in NHIB MUST be
      comparable with each other.
</p>
<p>NHIB can be populated from various sources both static and dynamic.
      This document focuses on populating NHIB using BGP. However it is
      possible that protocols other than BGP could be also used to populate
      NHIB.
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
BGP BEST PATH SELECTION MODIFICATION</h3>

<p>This section applies regardless of method used to populate NHIB.
</p>
<p>When BGP speaker conforming to this specification selects routes to
      be advertised to a peer it SHOULD use cost information from NHIB rather
      than its own IGP cost to the next-hop after step (d) of 9.1.2.2 in <a class='info' href='#RFC4271'>[RFC4271]<span> (</span><span class='info'>Rekhter, Y., Li, T., and S. Hares, &ldquo;A Border Gateway Protocol 4 (BGP-4),&rdquo; January&nbsp;2006.</span><span>)</span></a>.
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
USING BGP TO POPULATE NHIB</h3>

<p>This section describes extension to base BGP specification that
      allows BGP to be used for exchanging next-hop information between BGP
      speakers via new SAFI in order to populate NHIB. Although next-hops
      costs are exchanged via dedicated SAFI, this information is vital to
      best path selection process for other AFI/SAFI (e.g. IPv4 and IPv6
      unicast). It's therefore recommended that next-hop cost information is
      exchanged before other AFI/SAFI.
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
NEXT-HOP SAFI</h3>

<p>This document introduces Next-Hop SAFI (NH SAFI) with value to be
        assigned by IANA and purpose of exchanging information about cost to
        next-hops.
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
CAPABILITY ADVERTISEMENT</h3>

<p>A BGP speaker willing to exchange next-hop information MUST
        advertise this in the OPEN message using BGP Capability Code 1
        (Multiprotocol Extensions, see <a class='info' href='#RFC4760'>[RFC4760]<span> (</span><span class='info'>Bates, T., Chandra, R., Katz, D., and Y. Rekhter, &ldquo;Multiprotocol Extensions for BGP-4,&rdquo; January&nbsp;2007.</span><span>)</span></a>) setting
        AFI appropriately to indicate IPv4 or IPv6 and SAFI to the value
        assigned by IANA for NH SAFI. Note that if BGP speaker whishes to
        exchange cost information for both IPv4 and IPv6, then it MUST
        advertise two capabilities: one NH SAFI for IPv4 and one NH SAFI for
        IPv6.
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
INFORMATION ENCODING</h3>

<p>To request cost to a next-hop from peer or to inform peer about
        cost to a next-hop BGP attribute 14 is used as follow:
</p>
<p></p>
<ol class="text">
<li>AFI is set to indicate IPv4 or IPv6 (whichever is
            appropriate)
</li>
<li>SAFI is set to NH SAFI
</li>
<li>Network Address of Next-Hop field is zeroed out
</li>
<li>NLRI field is encoded as shown in the next figure
</li>
</ol>

<p></p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre> +-------------+------------+
 |  NEXT_HOP   |     cost   |
 +-------------+------------+</pre></div><p>

</p>
<p>Where cost is 32-bit unsigned integer (value described below), and
        NEXT_HOP is AFI-specific address of the next-hop cost to which is
        being communicated or requested. Size of NEXT_HOP field is inferred
        from total length of attribute 14.
</p>
<p>To request cost to arbitrary next-hop from a peer, BGP speaker sets
        cost field to zero.
</p>
<p>To inform peer about cost to a next-hop BGP speaker sets cost to
        actual cost value.
</p>
<p>To inform peer that a next-hop is not reachable the cost is set to
        all-ones (0xFFFFFFFF).
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4"></a><h3>4.4.&nbsp;
SESSION ESTABLISHMENT</h3>

<p>BGP speakers willing to exchange next-hop information SHOULD NOT
        establish more then one session for given AFI and NH SAFI, even using
        different transport addresses. This can be ensured for example by
        checking peer&rsquo;s Router Id.
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5"></a><h3>4.5.&nbsp;
INFORMATION EXCHANGE</h3>

<p>Typically NH SAFI sessions will be established between
        route-reflectors and its internal peers (both clients and
        non-clients). As soon as the NH SAFI session is ESTABLISHED requests
        for next-hop cost and information information about next-hop costs MAY
        be sent independently. That is, route-reflector MAY send multiple
        requests without waiting for response, and its peers MAY send cost
        information before or after receiving such request. On the other hand,
        Router Reflectors SHOULD request cost information from their internal
        peers as soon as possible (due to reasons stated in section &ldquo;BGP
        best path selection modification&rdquo;). BGP speaker does not need to
        track outstanding requests to the peer.
</p>
<p>When a BGP speaker receives request for cost information it MUST
        reply with actual cost (not necessarily IGP cost, but whatever has
        been chosen to be carried in NH SAFI) to given next-hop or with cost
        set to all-ones indicating that next-hop is unreachable.
</p>
<p>Note that BGP speaker MUST use longest match rather than exact
        match for the next-hop.
</p>
<p>When a BGP speaker detects change in cost to previously advertised
        next-hop with delta equal or exceeding configured advertisement
        threshold, it SHOULD inform peer by advertising new cost or
        0xFFFFFFFF.
</p>
<p>When a BGP speaker discovers new next-hop among candidate routes it
        SHOULD request cost information from the peer.
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.6"></a><h3>4.6.&nbsp;
TERMINATION OF NH SAFI SESSION</h3>

<p>When BGP speaker terminates (for whatever reason) NH SAFI session
        with a peer, it SHOULD remove all cost information received from that
        peer unless instructed by configuration to do otherwise.
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.7"></a><h3>4.7.&nbsp;
GRACEFUL RESTART AND ROUTE REFRESH</h3>

<p>NH SAFI sessions could use graceful restart and route refresh
        mechanisms in the same way as it&rsquo;s used for IPv4 and IPv6
        unicast.
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Security considerations</h3>

<p>No new security issues are introduced to the BGP protocol by this
      specification.
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
IANA Considerations</h3>

<p>IANA is requested to allocate value for Next-Hop Subsequent Address
      Family Identifier.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>7.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC4271">[RFC4271]</a></td>
<td class="author-text">Rekhter, Y., Li, T., and S. Hares, &ldquo;<a href="http://tools.ietf.org/html/rfc4271">A Border Gateway Protocol 4 (BGP-4)</a>,&rdquo; RFC&nbsp;4271, January&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4271.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4760">[RFC4760]</a></td>
<td class="author-text">Bates, T., Chandra, R., Katz, D., and Y. Rekhter, &ldquo;<a href="http://tools.ietf.org/html/rfc4760">Multiprotocol Extensions for BGP-4</a>,&rdquo; RFC&nbsp;4760, January&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4760.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>7.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.raszuk-bgp-optimal-route-reflection">[I-D.raszuk-bgp-optimal-route-reflection]</a></td>
<td class="author-text">Raszuk, R., Cassar, C., Aman, E., and B. Decraene, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-raszuk-bgp-optimal-route-reflection-00.txt">BGP Optimal Route Reflection (BGP-ORR)</a>,&rdquo; draft-raszuk-bgp-optimal-route-reflection-00 (work in progress), October&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-raszuk-bgp-optimal-route-reflection-00.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2918">[RFC2918]</a></td>
<td class="author-text">Chen, E., &ldquo;<a href="http://tools.ietf.org/html/rfc2918">Route Refresh Capability for BGP-4</a>,&rdquo; RFC&nbsp;2918, September&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2918.txt">TXT</a>).</td></tr>
</table>

<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Corner case</h3>

<p></p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   --+---NetA--+--
     |         |
RR---R1        R2
       \      /
        R3---R4</pre></div><p>
In the above network cost from R3 to R1 is 10, all other
      costs are 1. If RR advertises NetA to R3 based on cost information
      received from R3, but uses its own cost when advertising NetA to R4,
      there will be a loop formed. This is the reason why section &ldquo;BGP
      best path selection modification&rdquo; requires RR to have next-hop
      cost information for every next-hop and every peer.
</p>
<p>Note that the problem is the same as if RR would not use extensions
      described in this document and R3 would peer directly with R1 and R2,
      while R4 would peer only with RR.
</p>
<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Ilya Varlashkin</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Easynet Global Services</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:ilya.varlashkin@easynet.com">ilya.varlashkin@easynet.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Robert Raszuk</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text"></td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text"></td></tr>
<tr><td class="author" align="right">Fax:&nbsp;</td>
<td class="author-text"></td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:raszuk@cisco.com">raszuk@cisco.com</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href=""></a></td></tr>
</table>
</body></html>
