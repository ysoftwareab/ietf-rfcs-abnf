<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>LOOPS Generic Information Set</title>
<meta content="Michael Welzl" name="author">
<meta content="Carsten Bormann" name="author">
<meta content="
       LOOPS (Local Optimizations on Path Segments) aims to provide local
(not end-to-end but in-network) recovery of lost packets to achieve
better data delivery in the presence of losses.   
provides an overview over the problems and optimization opportunities
that LOOPS could address. 
       The present document is a strawman for the set of information that
would be interchanged in a LOOPS protocol, without already defining a
specific data packet format. 
       The generic information set needs to be mapped to a specific
encapsulation protocol to actually run the LOOPS optimizations.
A companion document contains a sketch of a binding to the tunnel
encapsulation protocol Geneve  . 
    " name="description">
<meta content="xml2rfc 2.46.0" name="generator">
<meta content="draft-welzl-loops-gen-info-04" name="ietf.draft">
<link href="/tmp/draft-welzl-loops-gen-info.prepped-04-e355vgbi.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code {
  background-color: #f9f9f9;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">LOOPS</td>
<td class="right">July 2020</td>
</tr></thead>
<tfoot><tr>
<td class="left">Welzl &amp; Bormann</td>
<td class="center">Expires 14 January 2021</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">TSVWG</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-welzl-loops-gen-info-04</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2020-07-13" class="published">13 July 2020</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2021-01-14">14 January 2021</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">M. Welzl</div>
<div class="org">University of Oslo</div>
</div>
<div class="author">
      <div class="author-name">C. Bormann, <span class="editor">Ed.</span>
</div>
<div class="org">Universität Bremen TZI</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">LOOPS Generic Information Set</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">LOOPS (Local Optimizations on Path Segments) aims to provide local
(not end-to-end but in-network) recovery of lost packets to achieve
better data delivery in the presence of losses.  <span>[<a href="#I-D.li-tsvwg-loops-problem-opportunities" class="xref">I-D.li-tsvwg-loops-problem-opportunities</a>]</span>
provides an overview over the problems and optimization opportunities
that LOOPS could address.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">The present document is a strawman for the set of information that
would be interchanged in a LOOPS protocol, without already defining a
specific data packet format.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
<p id="section-abstract-3">The generic information set needs to be mapped to a specific
encapsulation protocol to actually run the LOOPS optimizations.
A companion document contains a sketch of a binding to the tunnel
encapsulation protocol Geneve <span>[<a href="#I-D.ietf-nvo3-geneve" class="xref">I-D.ietf-nvo3-geneve</a>]</span>.<a href="#section-abstract-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 14 January 2021.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2020 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a><a href="#section-toc.1-1.1.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-terminology" class="xref">Terminology</a><a href="#section-toc.1-1.1.2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-challenges" class="xref">Challenges</a><a href="#section-toc.1-1.2.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-no-access-to-end-to-end-tra" class="xref">No Access to End-to-End Transport Information</a><a href="#section-toc.1-1.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-path-asymmetry" class="xref">Path Asymmetry</a><a href="#section-toc.1-1.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="xref">2.3</a>.  <a href="#name-reordering-vs-spurious-retr" class="xref">Reordering vs. Spurious Retransmission</a><a href="#section-toc.1-1.2.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a href="#section-2.4" class="xref">2.4</a>.  <a href="#name-informing-the-end-to-end-tr" class="xref">Informing the End-to-End Transport</a><a href="#section-toc.1-1.2.2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-simplifying-assumptions" class="xref">Simplifying assumptions</a><a href="#section-toc.1-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-loops-architecture" class="xref">LOOPS Architecture</a><a href="#section-toc.1-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-loops-generic-information-s" class="xref">LOOPS Generic Information Set</a><a href="#section-toc.1-1.5.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-setup-information" class="xref">Setup Information</a><a href="#section-toc.1-1.5.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-forward-information" class="xref">Forward Information</a><a href="#section-toc.1-1.5.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="xref">5.3</a>.  <a href="#name-reverse-information" class="xref">Reverse Information</a><a href="#section-toc.1-1.5.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-loops-general-operation" class="xref">LOOPS General Operation</a><a href="#section-toc.1-1.6.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-initial-packet-sequence-num" class="xref">Initial Packet Sequence Number</a><a href="#section-toc.1-1.6.2.1.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.6.2.1.2.1">
                    <p id="section-toc.1-1.6.2.1.2.1.1"><a href="#section-6.1.1" class="xref">6.1.1</a>.  <a href="#name-minimizing-collisions" class="xref">Minimizing collisions</a><a href="#section-toc.1-1.6.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.6.2.1.2.2">
                    <p id="section-toc.1-1.6.2.1.2.2.1"><a href="#section-6.1.2" class="xref">6.1.2</a>.  <a href="#name-optional-initial-psn-proced" class="xref">Optional Initial PSN procedure</a><a href="#section-toc.1-1.6.2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-acknowledgement-generation" class="xref">Acknowledgement Generation</a><a href="#section-toc.1-1.6.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="xref">6.3</a>.  <a href="#name-measurement" class="xref">Measurement</a><a href="#section-toc.1-1.6.2.3.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.6.2.3.2.1">
                    <p id="section-toc.1-1.6.2.3.2.1.1"><a href="#section-6.3.1" class="xref">6.3.1</a>.  <a href="#name-ingress-relative-timestamps" class="xref">Ingress-relative timestamps</a><a href="#section-toc.1-1.6.2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.6.2.3.2.2">
                    <p id="section-toc.1-1.6.2.3.2.2.1"><a href="#section-6.3.2" class="xref">6.3.2</a>.  <a href="#name-ack-generation" class="xref">ACK generation</a><a href="#section-toc.1-1.6.2.3.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="xref">6.4</a>.  <a href="#name-loss-detection-and-recovery" class="xref">Loss detection and Recovery</a><a href="#section-toc.1-1.6.2.4.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.6.2.4.2.1">
                    <p id="section-toc.1-1.6.2.4.2.1.1"><a href="#section-6.4.1" class="xref">6.4.1</a>.  <a href="#name-local-retransmission" class="xref">Local Retransmission</a><a href="#section-toc.1-1.6.2.4.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.6.2.4.2.2">
                    <p id="section-toc.1-1.6.2.4.2.2.1"><a href="#section-6.4.2" class="xref">6.4.2</a>.  <a href="#name-fec" class="xref">FEC</a><a href="#section-toc.1-1.6.2.4.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.6.2.5">
                <p id="section-toc.1-1.6.2.5.1"><a href="#section-6.5" class="xref">6.5</a>.  <a href="#name-discussion" class="xref">Discussion</a><a href="#section-toc.1-1.6.2.5.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-sketches-of-bindings-to-tun" class="xref">Sketches of Bindings to Tunnel Protocols</a><a href="#section-toc.1-1.7.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.  <a href="#name-embedding-loops-in-geneve" class="xref">Embedding LOOPS in Geneve</a><a href="#section-toc.1-1.7.2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a><a href="#section-toc.1-1.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a><a href="#section-toc.1-1.9.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="xref">9.1</a>.  <a href="#name-threat-model" class="xref">Threat model</a><a href="#section-toc.1-1.9.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="xref">9.2</a>.  <a href="#name-discussion-2" class="xref">Discussion</a><a href="#section-toc.1-1.9.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-references" class="xref">References</a><a href="#section-toc.1-1.10.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="xref">10.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a><a href="#section-toc.1-1.10.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="xref">10.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a><a href="#section-toc.1-1.10.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-appendix.a" class="xref">Appendix A</a>.  <a href="#name-protocol-used-in-prototype-" class="xref">Protocol used in Prototype Implementation</a><a href="#section-toc.1-1.11.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-a.1" class="xref">A.1</a>.  <a href="#name-block-code-fec" class="xref">Block Code FEC</a><a href="#section-toc.1-1.11.2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-appendix.b" class="xref">Appendix B</a>.  <a href="#name-transparent-mode" class="xref">Transparent mode</a><a href="#section-toc.1-1.12.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#section-b.1" class="xref">B.1</a>.  <a href="#name-packet-identification" class="xref">Packet identification</a><a href="#section-toc.1-1.12.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#section-b.2" class="xref">B.2</a>.  <a href="#name-generic-information-and-pro" class="xref">Generic information and protocol operation</a><a href="#section-toc.1-1.12.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.12.2.3">
                <p id="section-toc.1-1.12.2.3.1"><a href="#section-b.3" class="xref">B.3</a>.  <a href="#name-a-hybrid-mode" class="xref">A hybrid mode</a><a href="#section-toc.1-1.12.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-appendix.c" class="xref"></a><a href="#name-acknowledgements" class="xref">Acknowledgements</a><a href="#section-toc.1-1.13.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-appendix.d" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a><a href="#section-toc.1-1.14.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Today's networks exhibit a wide variety of data rates and, relative to
those, processing power and memory capacities of nodes acting as
routers.  For instance, networks that employ tunneling to build
overlay networks may position powerful virtual router nodes in the
network to act as tunnel endpoints.  The capabilities available in the
more powerful cases provide new opportunities for optimizations.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">LOOPS (Local Optimizations on Path Segments) aims to provide local
(not end-to-end but in-network) recovery of lost packets to achieve
better data delivery.  <span>[<a href="#I-D.li-tsvwg-loops-problem-opportunities" class="xref">I-D.li-tsvwg-loops-problem-opportunities</a>]</span> provides an overview over
the problems and optimization opportunities that LOOPS could address.
One simplifying assumption (<a href="#sec-simply" class="xref">Section 3</a>) in the present document is
that LOOPS segments operate independently from each other, each as a
pair of a LOOPS Ingress and a LOOPS Egress node.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">The present document is a strawman for the set of information that
would be interchanged in a LOOPS protocol between these nodes, without
already defining a specific data packet format.
The main body of the document defines a mode of the LOOPS protocol
that is based on traditional tunneling, the "tunnel mode".
<a href="#sec-trans" class="xref">Appendix B</a> is an even rougher strawman of a radically different,
alternative mode that we call "transparent mode", as well as a
slightly more conventional "hybrid mode" (<a href="#hybrid" class="xref">Appendix B.3</a>).
These different modes may be applicable to different usage scenarios
and will be developed in parallel, with a view of ultimately
standardizing one or more of them.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">For tunnel mode,
the generic information set needs to be mapped to a specific
encapsulation protocol to actually run the LOOPS optimizations.  LOOPS
is not tied to any specific overlay protocol, but is meant to run
embedded into a variety of tunnel protocols.  LOOPS information is
added as part of a tunnel protocol header at the LOOPS ingress as
shown in <a href="#fig-loops-packet" class="xref">Figure 1</a>.
A companion document <span>[<a href="#I-D.bormann-loops-geneve-binding" class="xref">I-D.bormann-loops-geneve-binding</a>]</span> contains a sketch of a binding to the tunnel
encapsulation protocol Geneve <span>[<a href="#I-D.ietf-nvo3-geneve" class="xref">I-D.ietf-nvo3-geneve</a>]</span>.<a href="#section-1-4" class="pilcrow">¶</a></p>
<span id="name-packet-in-tunnel-with-loops"></span><div id="fig-loops-packet">
<figure id="figure-1">
        <div class="artwork art-text alignLeft" id="section-1-5.1">
<pre>
          +------------------------------------+
          |           Outer header             |
          +------------------------------------+
        / |         Tunnel Base Header         |
      /   +------------------------------------+\
 Tunnel   |    +-------------------------+     | \
 Header   ~    |    LOOPS Information    |     ~  Tunnel Header
      \   |    +-------------------------+     |  Extensions
        \ +------------------------------------+ /
          |           Data packet              |
          +------------------------------------+

</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-packet-in-tunnel-with-loops" class="selfRef">Packet in Tunnel with LOOPS Information</a>
        </figcaption></figure>
</div>
<p id="section-1-6"><a href="#fig-loops-usage-scenario" class="xref">Figure 2</a> is extracted from the LOOPS problems and
opportunities document <span>[<a href="#I-D.li-tsvwg-loops-problem-opportunities" class="xref">I-D.li-tsvwg-loops-problem-opportunities</a>]</span>. It illustrates the basic
architecture and terms of the applicable scenario of LOOPS.  Not all
of the concepts introduced in the problems and opportunities document
are actually used in the current strawman specification;
<a href="#sec-simply" class="xref">Section 3</a> lays out some simplifying assumptions that the present
proposal makes.<a href="#section-1-6" class="pilcrow">¶</a></p>
<span id="name-loops-usage-scenario"></span><div id="fig-loops-usage-scenario">
<figure id="figure-2">
        <div class="artwork art-text alignLeft" id="section-1-7.1">
<pre>
                                                   ON=overlay node
                                                   UN=underlay node

+---------+                                               +---------+
|   App   | &lt;---------------- end-to-end ---------------&gt; |   App   |
+---------+                                               +---------+
|Transport| &lt;---------------- end-to-end ---------------&gt; |Transport|
+---------+                                               +---------+
|         |                                               |         |
|         |        +--+  path  +--+  path segment2  +--+  |         |
|         |        |  |&lt;-seg1-&gt;|  |&lt;--------------&gt; |  |  |         |
| Network |  +--+  |ON|  +--+  |ON|  +--+   +----+  |ON|  | Network |
|         |--|UN|--|  |--|UN|--|  |--|UN|---| UN |--|  |--|         |
+---------+  +--+  +--+  +--+  +--+  +--+   +----+  +--+  +---------+
  End Host                                                  End Host
                    &lt;---------------------------------&gt;
                     LOOPS domain: path segments enabling
                     optimization for local in-network recovery
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-loops-usage-scenario" class="selfRef">LOOPS Usage Scenario</a>
        </figcaption></figure>
</div>
<div id="terminology">
<section id="section-1.1">
        <h3 id="name-terminology">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.1-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED",
"MAY", and "OPTIONAL" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">This document makes use of the terminology defined in
<span>[<a href="#I-D.li-tsvwg-loops-problem-opportunities" class="xref">I-D.li-tsvwg-loops-problem-opportunities</a>]</span>.
This section defines additional terminology used by this document.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-1.1-3">
          <dt id="section-1.1-3.1">Data packets:</dt>
          <dd id="section-1.1-3.2">
  The payload packets that enter and exit a LOOPS segment.<a href="#section-1.1-3.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-3.3">LOOPS Segment:</dt>
          <dd id="section-1.1-3.4">
  A part of an end-to-end path covered by a single instance of the
LOOPS protocol, the sub-path between the LOOPS Ingress and the LOOPS
Egress.  Several LOOPS segments may be encountered on an end-to-end
path, with or without intervening routers.<a href="#section-1.1-3.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-3.5">LOOPS Ingress:</dt>
          <dd id="section-1.1-3.6">
  The node that forwards data packets and forward information into the
LOOPS segment, potentially performing retransmission and forward
error correction based on acknowledgements and measurements received
from the LOOPS Egress.<a href="#section-1.1-3.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-3.7">LOOPS Egress:</dt>
          <dd id="section-1.1-3.8">
  The node that receives the data packets and forward information from
the LOOPS ingress, sends acknowledgements and measurements back to
the LOOPS ingress (reverse information), potentially recovers data
packets from forward error correction information received.<a href="#section-1.1-3.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-3.9">LOOPS Nodes:</dt>
          <dd id="section-1.1-3.10">
  Collective term for LOOPS Ingress and LOOPS Egress in a LOOPS
Segment.<a href="#section-1.1-3.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-3.11">Forward Information:</dt>
          <dd id="section-1.1-3.12">
  Information that is added to the stream of data packets in the
forward direction by the LOOPS Ingress.<a href="#section-1.1-3.12" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-3.13">Reverse Information:</dt>
          <dd id="section-1.1-3.14">
  Information that flows in the reverse direction, from the LOOPS
Egress back to the LOOPS Ingress.<a href="#section-1.1-3.14" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-3.15">Setup Information:</dt>
          <dd id="section-1.1-3.16">
  Information that is not transferred as part of the Forward or
Reverse Information, but is part of the setup of the LOOPS Nodes.<a href="#section-1.1-3.16" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-3.17">PSN:</dt>
          <dd id="section-1.1-3.18">
  Packet Sequence Number, a sequence number identifying a data packet
between the LOOPS Ingress and Egress.<a href="#section-1.1-3.18" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-3.19">Sender:</dt>
          <dd id="section-1.1-3.20">
  Original sender of a packet on an end-to-end path that includes one
or more LOOPS segment(s).<a href="#section-1.1-3.20" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-3.21">Receiver:</dt>
          <dd id="section-1.1-3.22">
  Ultimate receiver of a packet on an end-to-end path that includes
one or more LOOPS segment(s).<a href="#section-1.1-3.22" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="challenges">
<section id="section-2">
      <h2 id="name-challenges">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-challenges" class="section-name selfRef">Challenges</a>
      </h2>
<p id="section-2-1">LOOPS has to perform well in the presence of some challenges, which
are discussed in this section.<a href="#section-2-1" class="pilcrow">¶</a></p>
<div id="no-access-to-end-to-end-transport-information">
<section id="section-2.1">
        <h3 id="name-no-access-to-end-to-end-tra">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-no-access-to-end-to-end-tra" class="section-name selfRef">No Access to End-to-End Transport Information</a>
        </h3>
<p id="section-2.1-1">LOOPS is defined to be independent of the content of the packets being
forwarded: there is no dependency on transport-layer or higher
information.  The intention is to keep LOOPS useful with a traffic mix
that may contain encrypted transport protocols such as QUIC as well as
encrypted VPN traffic.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="path-asymmetry">
<section id="section-2.2">
        <h3 id="name-path-asymmetry">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-path-asymmetry" class="section-name selfRef">Path Asymmetry</a>
        </h3>
<p id="section-2.2-1">A LOOPS segment is defined as a unidirectional forwarding path.
The tunnel might be shared with a LOOPS segment in the inverse
direction; this then allows to piggyback Reverse Information on
encapsulated packets on that segment.
But there is no guarantee that the inverse direction of any
end-to-end-path crosses that segment, so the LOOPS optimizations have
to be useful on their own in each direction.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="reordering-vs-spurious-retransmission">
<section id="section-2.3">
        <h3 id="name-reordering-vs-spurious-retr">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-reordering-vs-spurious-retr" class="section-name selfRef">Reordering vs. Spurious Retransmission</a>
        </h3>
<p id="section-2.3-1">The end-to-end transport layer protocol may have its own
retransmission mechanism to recover lost packets.
When LOOPS recovers a loss, ideally this local recovery would replace the
triggering of a retransmission at the end-to-end sender.<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<p id="section-2.3-2">Whether this is possible depends on the specific end-to-end mechanism
used for triggering retransmission.  When end-to-end retransmission is
triggered by receiving a sequence of duplicate acknowledgements
(DUPACKs), and with more than a few packets in flight, the recovered
packet is likely to be too late to fill the hole in the sequence
number space that triggers the DUPACK detection.<a href="#section-2.3-2" class="pilcrow">¶</a></p>
<p id="section-2.3-3">(Given a reasonable setting of parameters, the local retransmission
will still arrive earlier than the end-to-end retransmission and will
possibly unblock application processing earlier; with spurious
retransmission detection, there also will be little long-term effect
on the send rate.)<a href="#section-2.3-3" class="pilcrow">¶</a></p>
<p id="section-2.3-4">While LOOPS makes no requirements on end-to-end protocols, it is worth
noting that
the waste of bandwidth caused by a DUPACK-based end-to-end
retransmission can be avoided when the end-to-end loss detection is
based on time instead of sequence numbers, e.g., with RACK
<span>[<a href="#I-D.ietf-tcpm-rack" class="xref">I-D.ietf-tcpm-rack</a>]</span>.  This requires a limit on the additional
latency that LOOPS will incur in its attempt to recover the loss
locally.  In the present version of this document, opportunity to set
such a limit is
provided in the Setup Information.  The limit can be used to compute a
deadline for retransmission, but also can be used to choose FEC
parameters that keep extra latency low.<a href="#section-2.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-cc">
<section id="section-2.4">
        <h3 id="name-informing-the-end-to-end-tr">
<a href="#section-2.4" class="section-number selfRef">2.4. </a><a href="#name-informing-the-end-to-end-tr" class="section-name selfRef">Informing the End-to-End Transport</a>
        </h3>
<p id="section-2.4-1">Congestion control at the end-to-end sender is used to adapt its
sending rate to the network congestion status.  In typical TCP
senders, packet loss implies congestion and leads to a reduction in
sending rate.  With LOOPS operating, packet loss can be masked from
the sender as the loss may have been locally recovered.
In this case, rate reduction may not be invoked at the
sender.  This is a desirable performance improvement if the loss was a
random loss, but it is hard to ascertain that.<a href="#section-2.4-1" class="pilcrow">¶</a></p>
<p id="section-2.4-2">If LOOPS successfully conceals congestion losses from the end-to-end
transport protocol, that might increase the rate to a level that
congests the LOOPS segment, or that causes excessive queueing at the
LOOPS ingress.
What LOOPS should be able to achieve is to let the end host sender
invoke the rate reduction mechanism when there is a congestion loss no
matter if the lost packet was recovered locally.<a href="#section-2.4-2" class="pilcrow">¶</a></p>
<p id="section-2.4-3">As with any tunneling protocol, information about congestion events
inside the tunnel needs to be exported to the end-to-end path the
tunnel is part of.
See e.g., <span>[<a href="#RFC6040" class="xref">RFC6040</a>]</span> for a discussion of how to
do this in the presence of ECN.  A more recent draft,
<span>[<a href="#I-D.ietf-tsvwg-tunnel-congestion-feedback" class="xref">I-D.ietf-tsvwg-tunnel-congestion-feedback</a>]</span>, proposes to activate ECN for the
tunnel regardless of whether the end-to-end protocol signals the use
of an ECN-capable transport (ECT), which requires more complicated
action at the tunnel egress.<a href="#section-2.4-3" class="pilcrow">¶</a></p>
<p id="section-2.4-4">A sender that interprets reordering as a signal of packet loss
(DUPACKs) initiates a retransmission and reduces the sending rate.
When spurious retransmission detection (e.g., via F-RTO <span>[<a href="#RFC5862" class="xref">RFC5862</a>]</span> or DSACK <span>[<a href="#RFC3708" class="xref">RFC3708</a>]</span>) is
enabled by the TCP sender, it will often be able undo the unnecessary window
reduction shortly afterwards.  As LOOPS recovers lost packets locally, in most cases the
end host sender will eventually find out its reordering-based
retransmission (if any) is spurious.  This is an appropriate
performance improvement if the loss was a random loss.  For congestion
losses, a congestion event needs to be signaled to the end-to-end
transport.<a href="#section-2.4-4" class="pilcrow">¶</a></p>
<p id="section-2.4-5">The present version of LOOPS requires
the end-to-end transport to be ECN-capable (which is visible at the IP
level).  Congestion loss events can easily be signaled to them by
setting the CE (congestion experienced) mark.
Effectively, LOOPS converts a packet loss (which would be a congestion
indication) to a CE mark (which also is a congestion indication).<a href="#section-2.4-5" class="pilcrow">¶</a></p>
<p id="section-2.4-6">In effect, LOOPS can be used to convert a path segment that does not
yet use CE marks for congestion indication, and drops packets instead,
into a segment that marks for congestion and does not drop packets
except in extreme cases, incurring the benefits of Using Explicit
Congestion Notification (ECN) <span>[<a href="#RFC8087" class="xref">RFC8087</a>]</span>.  We speak about the
"drop-to-mark" function of LOOPS.<a href="#section-2.4-6" class="pilcrow">¶</a></p>
<p id="section-2.4-7"></p>
</section>
</div>
</section>
</div>
<div id="sec-simply">
<section id="section-3">
      <h2 id="name-simplifying-assumptions">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-simplifying-assumptions" class="section-name selfRef">Simplifying assumptions</a>
      </h2>
<p id="section-3-1">The above notwithstanding, Implementations may want to make use of
indicators such as transport layer port numbers to partition a tunnel
flow into separate application flows, e.g., for active queue
management (AQM).  Any such functionality is orthogonal to the LOOPS
protocol itself and thus out of scope for the present document.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">One observation that simplifies the design of LOOPS in comparison to
that of a reliable transport protocol is that LOOPS does not <em>have</em> to
recover every packet loss.  Therefore, probabilistic approaches, and
simply giving up after some time has elapsed, can simplify the
protocol significantly.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">For now, we assume that LOOPS segments that may line up on an
end-to-end path operate independently of each other.  Since the
objective of LOOPS ultimately is to assist the end-to-end protocol, it
is likely that some cooperation between them would be beneficial,
e.g., to obtain some measurements that cover a larger part of the
end-to-end path.  For instance, cooperating LOOPS segments could try
to divide up permissible increases to end-to-end latency between
them.  This is out of scope for the present version.<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">Another simplifying assumption is that LOOPS nodes have reasonably
precise absolute time available to them, so there is no need to burden
the LOOPS protocol with time synchronization.  How this is achieved is
out of scope.<a href="#section-3-4" class="pilcrow">¶</a></p>
<p id="section-3-5">LOOPS nodes are created and set up (information about their peers,
parameters) by some control plane mechanism that is out of scope for
this specification.  This means there is no need in the LOOPS protocol
itself to manage setup information.<a href="#section-3-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="loops-architecture">
<section id="section-4">
      <h2 id="name-loops-architecture">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-loops-architecture" class="section-name selfRef">LOOPS Architecture</a>
      </h2>
<p id="section-4-1">From the above, the following architecture is derived for LOOPS.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">LOOPS governs the segment from an ingress node to an egress node,
which is part of one or more end-to-end paths.
Often, a LOOPS segment will operate on aggregate traffic from many
such end-to-end paths.<a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3">The LOOPS protocol itself does not define how a LOOPS segment and the
protocol entities in the ingress and egress node are set up.  We
expect that a <em>setup protocol</em> on the control plane will provide some
<em>setup information</em> to the two nodes, including when to start and to
tear down processing.<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4">Each LOOPS segment governs traffic on one direction in the segment.
The LOOPS ingress adds <em>forward information</em> to that traffic; the
LOOPS egress removes the forward information and sends some <em>reverse
information</em> to inform the behavior of the ingress.<a href="#section-4-4" class="pilcrow">¶</a></p>
<p id="section-4-5">Hence, in the data plane, forward information is added to each data
packet.  Reverse information can be sent in separate packets (e.g.,
Geneve control-only packets <span>[<a href="#I-D.ietf-nvo3-geneve" class="xref">I-D.ietf-nvo3-geneve</a>]</span>) and/or piggybacked on a
related, reverse-direction LOOPS flow, similar to the way the
forward information for that flow is carried.  The setup protocol is
used to provide the relationship between the LOOPS segments in the two
directions that is used for piggybacking reverse information.<a href="#section-4-5" class="pilcrow">¶</a></p>
<p id="section-4-6">The above describes the "tunnel mode".  A transparent mode is
described in <a href="#sec-trans" class="xref">Appendix B</a>, which does not modify the data packets and
therefore needs to send any forward information (if needed, e.g., for FEC) in
separate packets, usually aggregated.<a href="#section-4-6" class="pilcrow">¶</a></p>
<p id="section-4-7">The LOOPS <em>generic information set</em> defines what information is provided
as setup information, forward information, and reverse information.
<em>Bindings</em> map this information set to specific control plane and data
plane protocols, including defining the specific encoding being used.
Where separate packets (outside the data plane protocols being used)
need to be sent, a special UDP-based protocol needs to be defined as
well.  The various bindings aim for some commonality, so that an
implementation for multiple bindings does not need to support
gratuitous variety between them.<a href="#section-4-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-model">
<section id="section-5">
      <h2 id="name-loops-generic-information-s">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-loops-generic-information-s" class="section-name selfRef">LOOPS Generic Information Set</a>
      </h2>
<p id="section-5-1">This section sketches a generic information set for the LOOPS
protocol.  Entries marked with (*) are items that may not be necessary
and probably should be left out of an initial specification.<a href="#section-5-1" class="pilcrow">¶</a></p>
<div id="setup-information">
<section id="section-5.1">
        <h3 id="name-setup-information">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-setup-information" class="section-name selfRef">Setup Information</a>
        </h3>
<p id="section-5.1-1">Setup Information might include:<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1-2.1">encapsulation protocol in use, and its vital parameters<a href="#section-5.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.1-2.2">identity of LOOPS ingress and LOOPS egress; information relevant for
running the encapsulation protocol such as port numbers<a href="#section-5.1-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.1-2.3">target maximum latency increase caused by the operation of LOOPS on
this segment<a href="#section-5.1-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.1-2.4">maximum retransmission count (*)<a href="#section-5.1-2.4" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="forward-information">
<section id="section-5.2">
        <h3 id="name-forward-information">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-forward-information" class="section-name selfRef">Forward Information</a>
        </h3>
<p id="section-5.2-1">In the forward information, we have identified:<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2-2.1">tunnel type  (a few bits, meaning agreed between Ingress and Egress)<a href="#section-5.2-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-2.2">packet sequence number PSN (20+ bits), counting the data packets forwarded
transmitted by the LOOPS ingress (i.e., retransmissions re-use the PSN)<a href="#section-5.2-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-2.3">an "ACK desirable" flag (one bit, usually set for a certain
percentage of the data packets only)<a href="#section-5.2-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-2.4">an optional blob, to be echoed by the egress<a href="#section-5.2-2.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-2.5">anything that the FEC scheme needs.<a href="#section-5.2-2.5" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.2-3">The first four together (say, 3+24+4+1) might even fit into 32 bits,
but probably need up to 48 bits total.  FEC info of course often needs
more space.<a href="#section-5.2-3" class="pilcrow">¶</a></p>
<p id="section-5.2-4">(Note that in this proposal there is no timestamp in the forward
information; see <a href="#sec-meas" class="xref">Section 6.3</a>.)<a href="#section-5.2-4" class="pilcrow">¶</a></p>
<p id="section-5.2-5">24 bits of PSN, minus one bit for sequence number arithmetic, gives 8
million packets (or 2.4 GB at typical packet sizes) per worst-case
RTT.  So if that is, say, 30 seconds, this would be enough to fill 640
Mbit/s.<a href="#section-5.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="reverse-information">
<section id="section-5.3">
        <h3 id="name-reverse-information">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-reverse-information" class="section-name selfRef">Reverse Information</a>
        </h3>
<p id="section-5.3-1">For the reverse information, we have identified:<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3-2.1">
            <p id="section-5.3-2.1.1">one optional block 1, possibly repeated:<a href="#section-5.3-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3-2.1.2.1">PSN being acknowledged<a href="#section-5.3-2.1.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.3-2.1.2.2">absolute time of reception for the packet acknowledged (PSN)<a href="#section-5.3-2.1.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.3-2.1.2.3">the blob, if present, echoed back<a href="#section-5.3-2.1.2.3" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-5.3-2.2">
            <p id="section-5.3-2.2.1">one optional block 2, possibly repeated:<a href="#section-5.3-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3-2.2.2.1">an ACK bitmap (based on PSN), always starting at a multiple of 8<a href="#section-5.3-2.2.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.3-2.2.2.2">a delta indicating the end PSN of the bitmap (actually the first
 PSN that is beyond it), using (Acked-PSN &amp; ~7) + 8*(delta+1) as the
 end of the bitmap.
 Acked-PSN in that formula is the previous block 1 PSN seen in this
 packet, or 0 if none so far.<a href="#section-5.3-2.2.2.2" class="pilcrow">¶</a>
</li>
            </ul>
</li>
        </ul>
<p id="section-5.3-3">Block 1 and Block 2 can be interspersed and repeated.  They can be
piggybacked on a reverse direction data packet or sent separately if
none occurs within some timeout.  They will usually be aggregated in
some useful form.  Block 1 information sets are only returned for
packets that have "ACK desirable" set.  Block 2 information is sent by
the receiver based on some saturation scheme (e.g., at least three
copies for each PSN span over time).  Still, it might be possible to
go down to 1 or 2 amortized bytes per forward packet spent for all
this.<a href="#section-5.3-3" class="pilcrow">¶</a></p>
<p id="section-5.3-4">The latency calculation is done by the sender, who occasionally sets
"ACK desirable", and notes down the absolute time of transmission for
this data packet (the timekeeping can be done quite
efficiently as deltas).  Upon reception of a block 1 ACK, it can then
subtract that from the absolute time of reception indicated.  This
assumes time synchronization between the nodes is at least as good as
the precision of latency measurement needed, which should be no
problem with IEEE 1588 PTP synchronization (but could be if using NTP-based
synchronization only).  A sender can freely garbage collect noted down
transmission time information; doing this too early just means that
the quality of the RTT sampling will reduce.<a href="#section-5.3-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="loops-general-operation">
<section id="section-6">
      <h2 id="name-loops-general-operation">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-loops-general-operation" class="section-name selfRef">LOOPS General Operation</a>
      </h2>
<p id="section-6-1">In the Tunnel Mode described in the main body of this document,
LOOPS information is carried by some tunnel encapsulation.<a href="#section-6-1" class="pilcrow">¶</a></p>
<div id="initial-packet-sequence-number">
<section id="section-6.1">
        <h3 id="name-initial-packet-sequence-num">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-initial-packet-sequence-num" class="section-name selfRef">Initial Packet Sequence Number</a>
        </h3>
<p id="section-6.1-1">There is no connection establishment procedure in LOOPS.
The initial PSN is assigned unilaterally by the LOOPS Ingress.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">Because of the short time that is usually set in the maximum latency
increase, there is little damage from a collision of PSNs with
packets still in flight from previous instances of LOOPS.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<div id="minimizing-collisions">
<section id="section-6.1.1">
          <h4 id="name-minimizing-collisions">
<a href="#section-6.1.1" class="section-number selfRef">6.1.1. </a><a href="#name-minimizing-collisions" class="section-name selfRef">Minimizing collisions</a>
          </h4>
<p id="section-6.1.1-1">If desired, collisions can be minimized by assigning initial PSNs
randomly, or using stable storage.  Random assignment is more useful
for longer PSNs, where the likelihood of overlap will be low.  The
specific way a LOOPS ingress uses stable storage is a local matter and
thus out of scope.  (Implementation note: this can be made to work
similar to secure nonce generation with write attenuation: Say, every
10000 packets, the sender notes down the PSN into stable storage.
After a reboot, it reloads the PSN and adds 10000 in sequence number
arithmetic <span>[<a href="#RFC1982" class="xref">RFC1982</a>]</span>, plus maybe another 10000 so the sender does
not have to wait for the store operation to succeed before sending
more packets.)<a href="#section-6.1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="optional-initial-psn-procedure">
<section id="section-6.1.2">
          <h4 id="name-optional-initial-psn-proced">
<a href="#section-6.1.2" class="section-number selfRef">6.1.2. </a><a href="#name-optional-initial-psn-proced" class="section-name selfRef">Optional Initial PSN procedure</a>
          </h4>
<p id="section-6.1.2-1">As a potential option (to be discussed), an initial packet sequence
number could be communicated using a simple two-bit protocol, based on
an I flag (Initial PSN) carried in the forward information and an R
flag (Initial PSN Received) in the reverse information.  This
procedure essentially clears the egress of any previous state,
however, the benefits of this procedure are limited.<a href="#section-6.1.2-1" class="pilcrow">¶</a></p>
<p id="section-6.1.2-2">The initial PSN is assigned unilaterally by the LOOPS ingress,
selected randomly.
The ingress will keep setting the I flag to one when it
starts to send packets from a new beginning or whenever it believes there is
a need to notify the egress about a new initial PSN.
The ingress will stop setting the I flag when it receives an
acknowledgement with the R flag set from the egress.<a href="#section-6.1.2-2" class="pilcrow">¶</a></p>
<p id="section-6.1.2-3">When the LOOPS egress receives a packets with the I flag set, it stops
performing services that assume a sequential PSN.  The egress will no
longer provide acknowledgement information for the packets with PSN
smaller than this new initial PSN (per sequence number arithmetic
<span>[<a href="#IEN74" class="xref">IEN74</a>]</span>).  The egress sends acknowledgement information back without
any delay by echoing the value of the I flag in the R flag.  This also
means the egress unsets the R flag in subsequent acknowledgements for
packets with the I flag unset.<a href="#section-6.1.2-3" class="pilcrow">¶</a></p>
<p id="section-6.1.2-4">It may happen that the first few packets are lost in an initial PSN
assignment process. In this case, the loss of these packets is not
detectable by the LOOPS ingress since the first received PSN will be
treated as an initial PSN at the egress.  This is an acceptable
temporary performance degradation: LOOPS does not intend to provide
perfect reliability, and LOOPS usually applies to the aggregated
traffic over a tunnel so that the initial PSN assignment happens
infrequently.<a href="#section-6.1.2-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="acknowledgement-generation">
<section id="section-6.2">
        <h3 id="name-acknowledgement-generation">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-acknowledgement-generation" class="section-name selfRef">Acknowledgement Generation</a>
        </h3>
<p id="section-6.2-1">A data packet forwarded by the LOOPS ingress always carries PSN
information. The LOOPS egress uses the largest newly received PSN with
the "ACK desired" bit as the ACK number in the block 1 part of the
acknowledgement.  This means that the LOOPS ingress gets to modulate
the number of acknowledgement sent by the LOOPS egress.  However,
whenever an out-of-order packet arrives while there still are "holes"
in the PSNs received, the LOOPS receiver should generate a block 2
acknowledgement immediately that the LOOPS sender can use as an ACK list.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">Reverse information can be piggybacked in a reverse direction data packet.
When the reverse direction has no user data to be sent, a pure reverse
information packet needs to be generated.  This may be based on a
short delay during which the LOOPS egress waits for a data packet to
piggyback on.  (To reduce MTU considerations, the egress could wait
for less-than-full data packets.)<a href="#section-6.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-meas">
<section id="section-6.3">
        <h3 id="name-measurement">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-measurement" class="section-name selfRef">Measurement</a>
        </h3>
<p id="section-6.3-1">When sending a block 1 acknowledgement, the LOOPS egress indicates the
absolute time of reception of the packet.  The LOOPS ingress can
subtract the absolute time of transmission that it still has
available, resulting in one high quality latency sample.
(In an alternative design, the forward information could include the
absolute time of transmission as well, and block1 information would echo it
back.  This trades memory management at the ingress for increased
bandwidth and MTU reduction.)<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<p id="section-6.3-2">When a data packet has been transmitted, it may not be clear which
specific copy is acknowledged in a block 1 acknowledgement: the
acknowledgement for the initial (or, more generally, an earlier) copy
may have been delayed (ACK ambiguity)).  The LOOPS ingress therefore
SHOULD NOT base its measurements on acknowledgements for retransmitted
data packets.  One way to achieve this is by not setting the "ACK
desired" bit on retransmissions in the first place.<a href="#section-6.3-2" class="pilcrow">¶</a></p>
<p id="section-6.3-3">The LOOPS ingress can also use the time of reception of the block 1
acknowledgement to obtain a segment RTT sample.  Note that this will
include any wait time the LOOPS egress incurs while waiting for a
piggybacking opportunity -- this is appropriate, as all uses of an
RTT will be for keeping a retransmission timeout.<a href="#section-6.3-3" class="pilcrow">¶</a></p>
<p id="section-6.3-4">To maintain quality of information during idle times, the LOOPS
ingress may send keepalive packets, which are discarded at the LOOPS
egress after sending acknowledgements.  The indication that a packet
is a keepalive packet is dependent on the encapsulation protocol.<a href="#section-6.3-4" class="pilcrow">¶</a></p>
<div id="ingress-relative-timestamps">
<section id="section-6.3.1">
          <h4 id="name-ingress-relative-timestamps">
<a href="#section-6.3.1" class="section-number selfRef">6.3.1. </a><a href="#name-ingress-relative-timestamps" class="section-name selfRef">Ingress-relative timestamps</a>
          </h4>
<p id="section-6.3.1-1">As an optional procedure, the ingress node can attach a small blob of
data to a forward packet that carries an ACK desired flag; this blob
is then echoed by the egress in its block 1 acknowledgement.
This is typically used to attach a timestamp on a time scale defined
by the ingress; we speak of an ingress-relative timestamp.
Alternatively, the ingress can keep a timestamp in its local storage,
associated with the PSN of the packet that carries an ACK desired
flag; it can then retrieve this timestamp when the block 1
acknowledgement arrives.<a href="#section-6.3.1-1" class="pilcrow">¶</a></p>
<p id="section-6.3.1-2">In either case, the LOOPS ingress keeps track of the local segment
round trip time (LRTT) based on the (saved or received) timestamp and
the arrival time of the block 1 acknowledgement, by setting the ACK
Desired flag (D flag) occasionally (several times per RTT) and
saving/including a sending timestamp for/in the packet.<a href="#section-6.3.1-2" class="pilcrow">¶</a></p>
<p id="section-6.3.1-3">As the egress will send block 1 acknowledgement information right away
when it receives a packet with the D flag set, the measurement of LRTT
is more accurate for such packets.
A smoothed local segment round trip time S_LRTT can be computed in a
similar way as defined by <span>[<a href="#RFC0793" class="xref">RFC0793</a>]</span>. A recent minimum value of LRTT
is also kept as min_LRTT.  S_LRTT is used as a basis for the overall
timing of retransmission and state management.<a href="#section-6.3.1-3" class="pilcrow">¶</a></p>
<p id="section-6.3.1-4">Retransmitted packets MUST NOT be used for local segment round trip
time (LRTT) calculation.<a href="#section-6.3.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ack-generation">
<section id="section-6.3.2">
          <h4 id="name-ack-generation">
<a href="#section-6.3.2" class="section-number selfRef">6.3.2. </a><a href="#name-ack-generation" class="section-name selfRef">ACK generation</a>
          </h4>
<p id="section-6.3.2-1">A block 1 acknowledgement is generated based on receiving a forward
packet with a D flag.<a href="#section-6.3.2-1" class="pilcrow">¶</a></p>
<p id="section-6.3.2-2">The way block 2 acknowledgement information is sent is more subject to
control by the egress.  Generally, the egress will aggregate ACK
bits for at least K packets before sending a block 2; this can be used
to amortize the overhead to close to a couple of bits per ACK.  In
order to counter loss of reverse information packets, an egress will
also want to send an ACK bit more than once -- a saturation value of
3 or more may be chosen based on setup information.  Typically, ACK
bits already sent will be prepended to ACK bits that are new in this
block 2 information set.
If K packets do not accumulate for a while, the egress will send one
or more packets with block 2 information that covers the unsent ACK
bits it has so far.<a href="#section-6.3.2-2" class="pilcrow">¶</a></p>
<p id="section-6.3.2-3">(Discussion: This works best if the egress has information both about
the S_RTT and min_RTT that the ingress uses and the reverse packet
loss rate.)<a href="#section-6.3.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="loss-detection-and-recovery">
<section id="section-6.4">
        <h3 id="name-loss-detection-and-recovery">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-loss-detection-and-recovery" class="section-name selfRef">Loss detection and Recovery</a>
        </h3>
<p id="section-6.4-1">There are two ways for LOOPS local recovery, retransmission and FEC.<a href="#section-6.4-1" class="pilcrow">¶</a></p>
<div id="local-retransmission">
<section id="section-6.4.1">
          <h4 id="name-local-retransmission">
<a href="#section-6.4.1" class="section-number selfRef">6.4.1. </a><a href="#name-local-retransmission" class="section-name selfRef">Local Retransmission</a>
          </h4>
<p id="section-6.4.1-1">When retransmission is used as recovery mechanism, the LOOPS ingress
detects a packet loss by not receiving an ACK for the packet within
the time expected based on an RTO value (which might be calculated as
in <span>[<a href="#RFC6298" class="xref">RFC6298</a>]</span>).  Packet retransmission should then not be performed more
than once within an LRTT.<a href="#section-6.4.1-1" class="pilcrow">¶</a></p>
<p id="section-6.4.1-2">When a retransmission is desired, the LOOPS ingress performs the local in-network recovery by
retransmitting the packet.  Further retransmissions may be desirable
if the lack of ACK is persistent beyond an RTO, as long as the maximum
latency increase is not reached.<a href="#section-6.4.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="fec">
<section id="section-6.4.2">
          <h4 id="name-fec">
<a href="#section-6.4.2" class="section-number selfRef">6.4.2. </a><a href="#name-fec" class="section-name selfRef">FEC</a>
          </h4>
<p id="section-6.4.2-1">FEC is another way to perform local recovery.  When FEC is in use, a
FEC header is sent with data packets as well as with special repair
packets added to the flow.  The specific FEC scheme used could be
defined in the Setup Information, using a mechanism like <span>[<a href="#RFC5052" class="xref">RFC5052</a>]</span>.
The FEC rate (amount of redundancy added) and possibly the FEC scheme
could be unilaterally adjusted by the LOOPS ingress in an adaptive
mechanism based on the measurement information.<a href="#section-6.4.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="discussion">
<section id="section-6.5">
        <h3 id="name-discussion">
<a href="#section-6.5" class="section-number selfRef">6.5. </a><a href="#name-discussion" class="section-name selfRef">Discussion</a>
        </h3>
<p id="section-6.5-1">Without progress in the way that end-host transport protocols handle
reordering, LOOPS will be unable to prevent end-to-end retransmissions
that duplicate effort that is spent in local retransmissions.
It depends on parameters of the path segment whether this wasted
effort is significant or not.<a href="#section-6.5-1" class="pilcrow">¶</a></p>
<p id="section-6.5-2">One remedy against this waste could be the
introduction of resequencing at the LOOPS Egress node.  This increases
overall mean packet latency, but does not always increase actual
end-to-end data stream latency if a head-of-line blocking transport
such as TCP is in use.  For applications with a large percentage of
legacy TCP end-hosts and sufficient processing capabilities at the
LOOPS Egress node, resequencing may be a viable choice.  Note that
resequencing could be switched off and on depending on some
measurement information.<a href="#section-6.5-2" class="pilcrow">¶</a></p>
<p id="section-6.5-3">The packet numbering scheme chosen by LOOPS already provides the
necessary information for the LOOPS Egress to reconstruct the sequence
of data packets at the LOOPS ingress.<a href="#section-6.5-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-sketches">
<section id="section-7">
      <h2 id="name-sketches-of-bindings-to-tun">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-sketches-of-bindings-to-tun" class="section-name selfRef">Sketches of Bindings to Tunnel Protocols</a>
      </h2>
<p id="section-7-1">The LOOPS information defined above in a generic way can be mapped to
specific tunnel encapsulation protocols.  A sketch for the tunnel
protocol Geneve is given below (<a href="#sec-geneve" class="xref">Section 7.1</a>).
The actual encapsulation can be designed in a "native"
way by putting each of the various elements into the TLV format of the
encapsulation protocol, or it can be achieved by providing single
TLVs for forward and reverse information and using some generic
encoding of both kinds of information as shown in <a href="#hybrid" class="xref">Appendix B.3</a>.<a href="#section-7-1" class="pilcrow">¶</a></p>
<div id="sec-geneve">
<section id="section-7.1">
        <h3 id="name-embedding-loops-in-geneve">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-embedding-loops-in-geneve" class="section-name selfRef">Embedding LOOPS in Geneve</a>
        </h3>
<p id="section-7.1-1">Geneve <span>[<a href="#I-D.ietf-nvo3-geneve" class="xref">I-D.ietf-nvo3-geneve</a>]</span> is an extensible overlay protocol
which can embed LOOPS functions. Geneve uses TLVs to carry optional
information between NVEs.  NVE is logically the same entity as the
LOOPS node.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">The Geneve header has a mandatory Virtual Network Identifier (VNI)
field. The specific VNI value to be used is part of the setup
information for the LOOPS tunnel.<a href="#section-7.1-2" class="pilcrow">¶</a></p>
<p id="section-7.1-3">More details for a Geneve binding for LOOPS can be found in <span>[<a href="#I-D.bormann-loops-geneve-binding" class="xref">I-D.bormann-loops-geneve-binding</a>]</span>.<a href="#section-7.1-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-8">
      <h2 id="name-iana-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-8-1">No IANA action is required at this stage.  When a LOOPS representation
is designed for a specific tunneling protocol, new codepoints will be
required in the registries that pertain to that protocol.<a href="#section-8-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-considerations">
<section id="section-9">
      <h2 id="name-security-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-9-1">The security of a specific LOOPS segment will depend both on the
properties of the generic information set described here and those of
the encapsulation protocol employed.  The security considerations of
the encapsulation protocol will apply, as will the protection afforded
by any security measures provided by the encapsulation protocol.
Any LOOPS encapsulation specification is expected to provide
information about preferred configurations of the encapsulation
protocol employed, including security mechanisms, and to provide a
security considerations section discussing the combination.
The following discussion aims at discussing security considerations
that will be common between different encapsulations.<a href="#section-9-1" class="pilcrow">¶</a></p>
<div id="threat-model">
<section id="section-9.1">
        <h3 id="name-threat-model">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-threat-model" class="section-name selfRef">Threat model</a>
        </h3>
<p id="section-9.1-1">Attackers might attempt to perturb the operation of a LOOPS segment
for a number of purposes:<a href="#section-9.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.1-2.1">Denial of Service: Damaging the ability of LOOPS to recover packets,
or damaging packet forwarding through the LOOPS segment in general.<a href="#section-9.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-9.1-2.2">Attacks on Confidentiality or Integrity: Obtaining the content of
data packets, modifying them, injecting new or suppressing specific
data packets.<a href="#section-9.1-2.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-9.1-3">For the purposes of these security considerations, we can distinguish
three classes of attackers:<a href="#section-9.1-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-9.1-4">
          <li id="section-9.1-4.1">
            <p id="section-9.1-4.1.1">on-path read-write: The attacker sees packets under way on the
segment and can modify, inject, or suppress them.<a href="#section-9.1-4.1.1" class="pilcrow">¶</a></p>
<p id="section-9.1-4.1.2">
In this case there is really nothing LOOPS can do, except for
acting as a full security protocol on its own, which would be the
task of the encapsulation protocol.  Without that, attackers
already can manipulate the packet stream as they wish.  This class
of attackers is considered out of scope for these security
considerations.<a href="#section-9.1-4.1.2" class="pilcrow">¶</a></p>
</li>
          <li id="section-9.1-4.2">
            <p id="section-9.1-4.2.1">on-path read + inject: The attacker sees packets under way on the
segment and can inject new packets.<a href="#section-9.1-4.2.1" class="pilcrow">¶</a></p>
<p id="section-9.1-4.2.2">
For this case, LOOPS itself similarly cannot add to the
confidentiality of the data stream.  However, LOOPS could protect
against denial of service against its own protocol operation and,
in a limited fashion, against attacks on integrity that wouldn't
already have been possible by packet injection without LOOPS.<a href="#section-9.1-4.2.2" class="pilcrow">¶</a></p>
</li>
          <li id="section-9.1-4.3">
            <p id="section-9.1-4.3.1">off-path inject: The attacker can inject new packets, but cannot
see existing packets under way on the segment.<a href="#section-9.1-4.3.1" class="pilcrow">¶</a></p>
<p id="section-9.1-4.3.2">
Similar considerations apply as for class 2, except that the
"blind" class 3 attacker might need to guess information it could
have extracted from the packet stream in class 2.<a href="#section-9.1-4.3.2" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
<div id="discussion-1">
<section id="section-9.2">
        <h3 id="name-discussion-2">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-discussion-2" class="section-name selfRef">Discussion</a>
        </h3>
<p id="section-9.2-1">Class 2 attackers can see e.g. sequence numbers and can inject, but
not modify traffic.  Attacks might include injecting false ACKs, initial
PSN flags, ... (TBD)<a href="#section-9.2-1" class="pilcrow">¶</a></p>
<p id="section-9.2-2">Class 3 ("blind") attackers might still be able to fake initial PSN
bits + false ACKs, but will have a harder time otherwise as it would need
to guess the PSN range in which it can wreak havoc.  Even random
guesses will sometimes hit, though, so the protocol needs to be robust
to such injection attacks. ... (TBD)<a href="#section-9.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<section id="section-10">
      <h2 id="name-references">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-10.1">
        <h3 id="name-normative-references">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-10.2">
        <h3 id="name-informative-references">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC0793">[RFC0793]</dt>
        <dd>
<span class="refAuthor">Postel, J.</span>, <span class="refTitle">"Transmission Control Protocol"</span>, <span class="seriesInfo">STD 7</span>, <span class="seriesInfo">RFC 793</span>, <span class="seriesInfo">DOI 10.17487/RFC0793</span>, <time datetime="1981-09" class="refDate">September 1981</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc793">https://www.rfc-editor.org/info/rfc793</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1982">[RFC1982]</dt>
        <dd>
<span class="refAuthor">Elz, R.</span><span class="refAuthor"> and R. Bush</span>, <span class="refTitle">"Serial Number Arithmetic"</span>, <span class="seriesInfo">RFC 1982</span>, <span class="seriesInfo">DOI 10.17487/RFC1982</span>, <time datetime="1996-08" class="refDate">August 1996</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1982">https://www.rfc-editor.org/info/rfc1982</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3708">[RFC3708]</dt>
        <dd>
<span class="refAuthor">Blanton, E.</span><span class="refAuthor"> and M. Allman</span>, <span class="refTitle">"Using TCP Duplicate Selective Acknowledgement (DSACKs) and Stream Control Transmission Protocol (SCTP) Duplicate Transmission Sequence Numbers (TSNs) to Detect Spurious Retransmissions"</span>, <span class="seriesInfo">RFC 3708</span>, <span class="seriesInfo">DOI 10.17487/RFC3708</span>, <time datetime="2004-02" class="refDate">February 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3708">https://www.rfc-editor.org/info/rfc3708</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5052">[RFC5052]</dt>
        <dd>
<span class="refAuthor">Watson, M.</span><span class="refAuthor">, Luby, M.</span><span class="refAuthor">, and L. Vicisano</span>, <span class="refTitle">"Forward Error Correction (FEC) Building Block"</span>, <span class="seriesInfo">RFC 5052</span>, <span class="seriesInfo">DOI 10.17487/RFC5052</span>, <time datetime="2007-08" class="refDate">August 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5052">https://www.rfc-editor.org/info/rfc5052</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5862">[RFC5862]</dt>
        <dd>
<span class="refAuthor">Yasukawa, S.</span><span class="refAuthor"> and A. Farrel</span>, <span class="refTitle">"Path Computation Clients (PCC) - Path Computation Element (PCE) Requirements for Point-to-Multipoint MPLS-TE"</span>, <span class="seriesInfo">RFC 5862</span>, <span class="seriesInfo">DOI 10.17487/RFC5862</span>, <time datetime="2010-06" class="refDate">June 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5862">https://www.rfc-editor.org/info/rfc5862</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6040">[RFC6040]</dt>
        <dd>
<span class="refAuthor">Briscoe, B.</span>, <span class="refTitle">"Tunnelling of Explicit Congestion Notification"</span>, <span class="seriesInfo">RFC 6040</span>, <span class="seriesInfo">DOI 10.17487/RFC6040</span>, <time datetime="2010-11" class="refDate">November 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6040">https://www.rfc-editor.org/info/rfc6040</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6298">[RFC6298]</dt>
        <dd>
<span class="refAuthor">Paxson, V.</span><span class="refAuthor">, Allman, M.</span><span class="refAuthor">, Chu, J.</span><span class="refAuthor">, and M. Sargent</span>, <span class="refTitle">"Computing TCP's Retransmission Timer"</span>, <span class="seriesInfo">RFC 6298</span>, <span class="seriesInfo">DOI 10.17487/RFC6298</span>, <time datetime="2011-06" class="refDate">June 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6298">https://www.rfc-editor.org/info/rfc6298</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6330">[RFC6330]</dt>
        <dd>
<span class="refAuthor">Luby, M.</span><span class="refAuthor">, Shokrollahi, A.</span><span class="refAuthor">, Watson, M.</span><span class="refAuthor">, Stockhammer, T.</span><span class="refAuthor">, and L. Minder</span>, <span class="refTitle">"RaptorQ Forward Error Correction Scheme for Object Delivery"</span>, <span class="seriesInfo">RFC 6330</span>, <span class="seriesInfo">DOI 10.17487/RFC6330</span>, <time datetime="2011-08" class="refDate">August 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6330">https://www.rfc-editor.org/info/rfc6330</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8610">[RFC8610]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span><span class="refAuthor">, Vigano, C.</span><span class="refAuthor">, and C. Bormann</span>, <span class="refTitle">"Concise Data Definition Language (CDDL): A Notational Convention to Express Concise Binary Object Representation (CBOR) and JSON Data Structures"</span>, <span class="seriesInfo">RFC 8610</span>, <span class="seriesInfo">DOI 10.17487/RFC8610</span>, <time datetime="2019-06" class="refDate">June 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8610">https://www.rfc-editor.org/info/rfc8610</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8087">[RFC8087]</dt>
        <dd>
<span class="refAuthor">Fairhurst, G.</span><span class="refAuthor"> and M. Welzl</span>, <span class="refTitle">"The Benefits of Using Explicit Congestion Notification (ECN)"</span>, <span class="seriesInfo">RFC 8087</span>, <span class="seriesInfo">DOI 10.17487/RFC8087</span>, <time datetime="2017-03" class="refDate">March 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8087">https://www.rfc-editor.org/info/rfc8087</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-tcpm-rack">[I-D.ietf-tcpm-rack]</dt>
        <dd>
<span class="refAuthor">Cheng, Y.</span><span class="refAuthor">, Cardwell, N.</span><span class="refAuthor">, Dukkipati, N.</span><span class="refAuthor">, and P. Jha</span>, <span class="refTitle">"RACK: a time-based fast loss detection algorithm for TCP"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-tcpm-rack-08</span>, <time datetime="2020-03-09" class="refDate">9 March 2020</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-ietf-tcpm-rack-08.txt">http://www.ietf.org/internet-drafts/draft-ietf-tcpm-rack-08.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-nvo3-geneve">[I-D.ietf-nvo3-geneve]</dt>
        <dd>
<span class="refAuthor">Gross, J.</span><span class="refAuthor">, Ganga, I.</span><span class="refAuthor">, and T. Sridhar</span>, <span class="refTitle">"Geneve: Generic Network Virtualization Encapsulation"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-nvo3-geneve-16</span>, <time datetime="2020-03-07" class="refDate">7 March 2020</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-ietf-nvo3-geneve-16.txt">http://www.ietf.org/internet-drafts/draft-ietf-nvo3-geneve-16.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.li-tsvwg-loops-problem-opportunities">[I-D.li-tsvwg-loops-problem-opportunities]</dt>
        <dd>
<span class="refAuthor">Yizhou, L.</span><span class="refAuthor">, Zhou, X.</span><span class="refAuthor">, Boucadair, M.</span><span class="refAuthor">, Wang, J.</span><span class="refAuthor">, and F. Qin</span>, <span class="refTitle">"LOOPS (Localized Optimizations on Path Segments) Problem Statement and Opportunities for Network-Assisted Performance Enhancement"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-li-tsvwg-loops-problem-opportunities-05</span>, <time datetime="2020-07-06" class="refDate">6 July 2020</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-li-tsvwg-loops-problem-opportunities-05.txt">http://www.ietf.org/internet-drafts/draft-li-tsvwg-loops-problem-opportunities-05.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-tsvwg-tunnel-congestion-feedback">[I-D.ietf-tsvwg-tunnel-congestion-feedback]</dt>
        <dd>
<span class="refAuthor">Wei, X.</span><span class="refAuthor">, Yizhou, L.</span><span class="refAuthor">, Boutros, S.</span><span class="refAuthor">, and L. Geng</span>, <span class="refTitle">"Tunnel Congestion Feedback"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-tsvwg-tunnel-congestion-feedback-07</span>, <time datetime="2019-05-05" class="refDate">5 May 2019</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-ietf-tsvwg-tunnel-congestion-feedback-07.txt">http://www.ietf.org/internet-drafts/draft-ietf-tsvwg-tunnel-congestion-feedback-07.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.bormann-loops-geneve-binding">[I-D.bormann-loops-geneve-binding]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span>, <span class="refTitle">"Embedding LOOPS in Geneve"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-bormann-loops-geneve-binding-01</span>, <time datetime="2020-06-12" class="refDate">12 June 2020</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-bormann-loops-geneve-binding-01.txt">http://www.ietf.org/internet-drafts/draft-bormann-loops-geneve-binding-01.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IEN74">[IEN74]</dt>
      <dd>
<span class="refAuthor">Plummer, W.W.</span>, <span class="refTitle">"Sequence Number Arithmetic"</span>, <span class="seriesInfo">Internet Experiment Note 74</span>, <time datetime="1978-09" class="refDate">September 1978</time>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="sec-proto">
<section id="section-appendix.a">
      <h2 id="name-protocol-used-in-prototype-">
<a href="#section-appendix.a" class="section-number selfRef">Appendix A. </a><a href="#name-protocol-used-in-prototype-" class="section-name selfRef">Protocol used in Prototype Implementation</a>
      </h2>
<p id="section-appendix.a-1">This appendix describes, in a somewhat abstracted form, the protocol
as used in a prototype implementation, as described by Yizhou Li, and
Xingwang Zhou.<a href="#section-appendix.a-1" class="pilcrow">¶</a></p>
<p id="section-appendix.a-2">The prototype protocol can be run in one of two modes (defined by
preconfiguration):<a href="#section-appendix.a-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.a-3.1">Retransmission mode<a href="#section-appendix.a-3.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.a-3.2">Forward Error Correction (FEC) mode<a href="#section-appendix.a-3.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-appendix.a-4">Forward information is piggybacked in data packets.<a href="#section-appendix.a-4" class="pilcrow">¶</a></p>
<p id="section-appendix.a-5">Reverse information can be carried in a pure acknowledgement packet or
piggybacked when carrying packets for the inverse direction.<a href="#section-appendix.a-5" class="pilcrow">¶</a></p>
<p id="section-appendix.a-6">The forward information includes:<a href="#section-appendix.a-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.a-7.1">Packet Sequence Number (PSN) (32 bits): This identifies a packet
over a specific overlay segment from a specific LOOPS Ingress.  If a
packet is retransmitted by LOOPS, the retransmission uses the
original PSN.<a href="#section-appendix.a-7.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.a-7.2">Timestamp (32 bits): Information, in a format local to the LOOPS
ingress, that provides the time when the packet was sent.  In the
current implementation, a 32-bit unsigned value specifying the time
delta in some granularity from the epoch time to the sending time of
the packet carrying this timestamp. The granularity can be from 1 ms
to 1 second. The epoch time follows the current TCP practice which
is 1 January 1970 00:00:00 UTC.  Note that a retransmitted packet
uses its own Timestamp.<a href="#section-appendix.a-7.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.a-7.3">FEC Info for Block Code (56 bits): This header is used in FEC mode.
It currently only provides for a block code FEC scheme.  It includes
the Source Block Number (SBN), Encoding Symbol ID (ESI), number of
symbols in a single source block and symbol size. <a href="#sec-fec" class="xref">Appendix A.1</a> gives
more details on FEC.<a href="#section-appendix.a-7.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-appendix.a-8">The reverse information includes:<a href="#section-appendix.a-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.a-9.1">ACK Number (32 bits): The largest (in sequence number arithmetic
<span>[<a href="#RFC1982" class="xref">RFC1982</a>]</span>) PSN received so far.<a href="#section-appendix.a-9.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.a-9.2">ACK List (variable): This indicates an array of PSN numbers to
describe the PSN "holes" preceding the ACK number. It conceptually
lists the PSNs of every packet perceived as lost by the LOOPS
egress.  In actual use, it is truncated.<a href="#section-appendix.a-9.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.a-9.3">Echoed Timestamp (32 bits): The timestamp received with the packet
being acknowledged.<a href="#section-appendix.a-9.3" class="pilcrow">¶</a>
</li>
      </ul>
<div id="sec-fec">
<section id="section-a.1">
        <h2 id="name-block-code-fec">
<a href="#section-a.1" class="section-number selfRef">A.1. </a><a href="#name-block-code-fec" class="section-name selfRef">Block Code FEC</a>
        </h2>
<p id="section-a.1-1">The prototype currently uses a block code FEC scheme (RaptorQ
<span>[<a href="#RFC6330" class="xref">RFC6330</a>]</span>).  The fields in the FEC Info forward information are:<a href="#section-a.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-a.1-2.1">Source Block Number (SBN): 16 bits. An integer identifier for the
source block that the encoding symbols within the packet relate to.<a href="#section-a.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.1-2.2">Encoding Symbol ID (ESI): 16 bits. An integer identifier for the
encoding symbols within the packet.<a href="#section-a.1-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.1-2.3">K: 8 bits. Number of symbols in a single source block.<a href="#section-a.1-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-a.1-2.4">T: 16 bits. Symbol size in bytes.<a href="#section-a.1-2.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-a.1-3">The LOOPS Ingress uses the data packet in <a href="#fig-loops-packet" class="xref">Figure 1</a> to
generate the encoding packet.  Both source packets and repair packets
carry the FEC header information; the LOOPS Egress reconstructs the
data packets from both kinds of packets.  The LOOPS Egress currently
resequences the forwarded and reconstructed packets, so they are
passed on in-order when the lost packets are recoverable within the
source block.<a href="#section-a.1-3" class="pilcrow">¶</a></p>
<p id="section-a.1-4">The LOOPS Nodes need to agree on the use of FEC block mode and on the
specific FEC Encoding ID to use; this is currently done by
configuration.<a href="#section-a.1-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-trans">
<section id="section-appendix.b">
      <h2 id="name-transparent-mode">
<a href="#section-appendix.b" class="section-number selfRef">Appendix B. </a><a href="#name-transparent-mode" class="section-name selfRef">Transparent mode</a>
      </h2>
<p id="section-appendix.b-1">This appendix defines a very different way to provide
the LOOPS services, "transparent mode".  (We call the protocol
described in the main body of the document "encapsulated mode".)<a href="#section-appendix.b-1" class="pilcrow">¶</a></p>
<p id="section-appendix.b-2">In transparent mode, the idea is that LOOPS does not meddle with the
forward transmission of data packets, but runs on the side exchanging
additional information.<a href="#section-appendix.b-2" class="pilcrow">¶</a></p>
<p id="section-appendix.b-3">An implementation could be based on conventional forwarding switches
that just provide a copy of the ingress and egress packet stream to
the LOOPS implementations.  The LOOPS process would occasionally
inject recovered packets back into the LOOPS egress node's forwarding
switch, see <a href="#fig-transparent" class="xref">Figure 3</a>.<a href="#section-appendix.b-3" class="pilcrow">¶</a></p>
<span id="name-loops-transparent-mode"></span><div id="fig-transparent">
<figure id="figure-3">
        <div class="artwork art-text alignLeft" id="section-appendix.b-4.1">
<pre>
           |
   +-------+-------------------------------------------+
   |       |                                           |
   |  +----+--------+   +-------------------+          |
   |  |    | copy   |   |                   |          |
   |  |    |----------------&gt; LOOPS ingress |          |
   |  |    |        |   |     |     ^       |          |
   |  +----+--------+   +-----|-----|-------+          |
   |   data|packets    forward|     |reverse           |
   |       |              info|     |info              |
   +-------+------------------|-----|------------------+
           |                  |     |
   +-------+------------------|-----|------------------+
   |       |                  |     |                  |
   |  +----+---------+   +----|-----|----------+       |
   |  |    | copy    |   |    v     |          |       |
   |  |    |---------|---|---&gt; LOOPS egress    |       |
   |  |    |         |   |                     |       |
   |  |    |&lt;--------|---|---- inject          |       |
   |  +----+---------+   +---------------------+       |
   |       |                                           |
   +-------+-------------------------------------------+
           |
           v
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-loops-transparent-mode" class="selfRef">LOOPS Transparent Mode</a>
        </figcaption></figure>
</div>
<p id="section-appendix.b-5">The obvious advantage of transparent mode is that no encapsulation is
needed, reducing processing requirements and keeping the MTU
unchanged.  The obvious disadvantage is that no forward information
can be provided with each data packet, so a replacement needs to be
found for the PSN (packet sequence number) employed in encapsulated mode.
Any forward information beyond the data packets is sent in separate
packets exchanged directly between the LOOPS nodes.<a href="#section-appendix.b-5" class="pilcrow">¶</a></p>
<div id="packet-identification">
<section id="section-b.1">
        <h2 id="name-packet-identification">
<a href="#section-b.1" class="section-number selfRef">B.1. </a><a href="#name-packet-identification" class="section-name selfRef">Packet identification</a>
        </h2>
<p id="section-b.1-1">Retransmission mode and FEC mode differ in their needs for packet
identification.  For retransmission mode, a somewhat probabilistic
accuracy of the packet identification is sufficient, for FEC mode,
packet identification should not make mistakes (as these would lead to
faultily reconstructed packets).<a href="#section-b.1-1" class="pilcrow">¶</a></p>
<p id="section-b.1-2">In Retransmission mode, misidentification of a packet could lead to
measurement errors as well as missed retransmission opportunities.
The latter will be fixed end-to-end.  The tolerance for measurement
errors would influence the degree of accuracy that is aimed for.<a href="#section-b.1-2" class="pilcrow">¶</a></p>
<p id="section-b.1-3">Packet identification can be based on a cryptographic hash of the
packet, computed in LOOPS ingress and egress using the same algorithm
(excluding fields that can change in transit, such as TTL/hop limit).
The hash can directly be used as a packet number, or it can
be sent in the forward information together with a packet sequence
number, establishing a mapping.<a href="#section-b.1-3" class="pilcrow">¶</a></p>
<p id="section-b.1-4">For probabilistic packet identification, it is almost always
sufficient to hash the first few (say, 64) bytes of the packet; all
known transport protocols keep sufficient identifying information in
that part (and, for encrypted protocols, the entropy will be
sufficient).  Any collisions of the hash could be used to disqualify
the packet for measurement purposes, minimizing the measurement
errors; this could allow rather short packet identifiers in
retransmission mode.<a href="#section-b.1-4" class="pilcrow">¶</a></p>
<p id="section-b.1-5">For FEC mode, the packet identification together with the per-packet
FEC information needs to be sent in the (separate) forward
information, so that a systematic code can be reconstructed.  For
retransmission mode, there is no need to send any forward information
for most packets, or a mapping from packet identifiers to packet
sequence numbers could be sent in the forward information (probably in
some aggregated form).
The latter would allow keeping the acknowledgement form described in
the main body (with aggregate acknowledgement); otherwise, packet
identifiers need to be acknowledged.  With this change, the LOOPS
egress will send reverse information as in the encapsulating LOOPS
protocol.<a href="#section-b.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="generic-information-and-protocol-operation">
<section id="section-b.2">
        <h2 id="name-generic-information-and-pro">
<a href="#section-b.2" class="section-number selfRef">B.2. </a><a href="#name-generic-information-and-pro" class="section-name selfRef">Generic information and protocol operation</a>
        </h2>
<p id="section-b.2-1">With the changes outlined above, transparent mode operates just as
encapsulated mode.  If packet sequence numbers are not used, there is
no use for block2 reverse information; if they are used, a new block3
needs to be defined that provides the mapping from packet identifiers
to packet sequence numbers in the forward information.  To avoid MTU
reduction, some mechanism will be needed to encapsulate the actual FEC
information (additional packets) in the forward information.<a href="#section-b.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="hybrid">
<section id="section-b.3">
        <h2 id="name-a-hybrid-mode">
<a href="#section-b.3" class="section-number selfRef">B.3. </a><a href="#name-a-hybrid-mode" class="section-name selfRef">A hybrid mode</a>
        </h2>
<p id="section-b.3-1"><a href="#fig-transparent" class="xref">Figure 3</a> can be modified by including a GRE encapsulator
into the top left corner and a GRE decapsulator in the bottom left
corner.  This provides more defined ingress and egress points, but it
also provides an opportunity to add a packet sequence number at the
ingress.  The copies to the top right and bottom right corners are the
encapsulated form, i.e., include the sequence number.<a href="#section-b.3-1" class="pilcrow">¶</a></p>
<p id="section-b.3-2">The GRE packet header then has the form:<a href="#section-b.3-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-b.3-3">
<pre>
   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |0|0|0|1|    000000000    | 000 |         Protocol Type         |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                         Sequence Number                       |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-b.3-3" class="pilcrow">¶</a>
</div>
<p id="section-b.3-4">The forward and reverse information can be designed closer to the
approach in the main body of the document, to be exchanged using UDP
packets between top right ingress and bottom right egress using a port
number allocated for this purpose.<a href="#section-b.3-4" class="pilcrow">¶</a></p>
<p id="section-b.3-5">Rough ideas for both directions are given below in CDDL <span>[<a href="#RFC8610" class="xref">RFC8610</a>]</span>.
This information set could be encoded in CBOR or in a bespoke
encoding; details such as this can be defined later.<a href="#section-b.3-5" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft art-cddl" id="section-b.3-6">
<pre>
forward-information = [
  [rel-psn, ack-desired, ? fec-info] /
  fec-repair-data
]

rel-psn = uint; relative packet sequence number
; always given as a delta from the previous one in the array
; starting out with a "previous value" of 0

ack-desired = bool

fec-info = [
    sbn: uint, ; Source Block Number
    esi: uint, ; Encoding Symbol ID
    ? (
      nsssb: uint; number of symbols in a single source block
      ss: uint; symbol size
    )
]

fec-repair-data = [
    repair-data: bytes
    ? (
      sbn: uint, ; Source Block Number
      esi: uint, ; Encoding Symbol ID
    )
]
</pre><a href="#section-b.3-6" class="pilcrow">¶</a>
</div>
<p id="section-b.3-7">If left out for a sequence number, the fec-info block is constructed
by adding one to the previous one.  fec-repair-data contain repair
symbols for the sbn/esi given (which, again, are reconstructed from
context if not given).<a href="#section-b.3-7" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft art-CDDL" id="section-b.3-8">
<pre>
reverse-information = [
    block1 / block2
]

block1 = [rel-psn, timestamp]
block2 = [end-psn-delta: uint, acked-bits: bytes]
</pre><a href="#section-b.3-8" class="pilcrow">¶</a>
</div>
<p id="section-b.3-9">The acked-bits in a block2 is a bitmap that gives acknowledgments for received data
packets.  The bitmap always comes as a multiple of 8 bits (all bytes
are filled in with 8 bits, each identifying a PSN).
The end PSN of the bitmap (actually the first PSN that would
be beyond it) is computed from the current PSN as set by rel-psn,
rounded down to a multiple of 8, and adding 8*(end-psn-delta+1) to
that value.<a href="#section-b.3-9" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="acknowledgements">
<section id="section-appendix.c">
      <h2 id="name-acknowledgements">
<a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="section-appendix.c-1">Sami Boutros helped with sketching the use of Geneve (<a href="#sec-geneve" class="xref">Section 7.1</a>).<a href="#section-appendix.c-1" class="pilcrow">¶</a></p>
<p id="section-appendix.c-2">Michael Welzl has been supported by the Research Council of Norway under its "Toppforsk" programme through the "OCARINA" project.<a href="#section-appendix.c-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="section-appendix.d">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Michael Welzl</span></div>
<div dir="auto" class="left"><span class="org">University of Oslo</span></div>
<div dir="auto" class="left"><span class="street-address">PO Box 1080 Blindern</span></div>
<div dir="auto" class="left">
<span class="postal-code">N-0316</span> <span class="locality">Oslo</span>
</div>
<div dir="auto" class="left"><span class="country-name">Norway</span></div>
<div class="tel">
<span>Phone:</span>
<a href="tel:+47%2022%2085%2024%2020" class="tel">+47 22 85 24 20</a>
</div>
<div class="email">
<span>Email:</span>
<a href="mailto:michawe@ifi.uio.no" class="email">michawe@ifi.uio.no</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Carsten Bormann (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">Universität Bremen TZI</span></div>
<div dir="auto" class="left"><span class="street-address">Postfach 330440</span></div>
<div dir="auto" class="left">
<span class="postal-code">D-28359</span> <span class="locality">Bremen</span>
</div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="tel">
<span>Phone:</span>
<a href="tel:+49-421-218-63921" class="tel">+49-421-218-63921</a>
</div>
<div class="email">
<span>Email:</span>
<a href="mailto:cabo@tzi.org" class="email">cabo@tzi.org</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
