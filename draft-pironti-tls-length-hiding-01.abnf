AEADEncrypted = AEAD-Encrypt(write_key, nonce,
                                              pad + plaintext,
                                              additional_data);

all_pad = min(all_pad, total->high - total->low);
current = split_range(&total);
next_len = fragment(data.length - sent, current, total);
