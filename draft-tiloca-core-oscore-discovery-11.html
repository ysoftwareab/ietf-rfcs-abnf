<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Discovery of OSCORE Groups with the CoRE Resource Directory</title>
<meta content="Marco Tiloca" name="author">
<meta content="Christian Amsuess" name="author">
<meta content="Peter van der Stok" name="author">
<meta content="
       Group communication over the Constrained Application Protocol (CoAP) can be secured by means of Group Object Security for Constrained RESTful Environments (Group OSCORE). At deployment time, devices may not know the exact security groups to join, the respective Group Manager, or other information required to perform the joining process. This document describes how a CoAP endpoint can use descriptions and links of resources registered at the CoRE Resource Directory to discover security groups and to acquire information for joining them through the respective Group Manager. A given security group may protect multiple application groups, which are separately announced in the Resource Directory as sets of endpoints sharing a pool of resources. This approach is consistent with, but not limited to, the joining of security groups based on the ACE framework for Authentication and Authorization in constrained environments. 
    " name="description">
<meta content="xml2rfc 3.12.3" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-tiloca-core-oscore-discovery-11" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.12.3
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.8.0
    MarkupSafe 2.0.1
    pycountry 22.1.10
    pyflakes 2.4.0
    PyYAML 6.0
    requests 2.27.1
    setuptools 59.6.0
    six 1.16.0
    WeasyPrint 52.5
-->
<link href="/tmp/draft-tiloca-core-oscore-discovery-11-z2983pl2.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">OSCORE group discovery with the CoRE RD</td>
<td class="right">March 2022</td>
</tr></thead>
<tfoot><tr>
<td class="left">Tiloca, et al.</td>
<td class="center">Expires 8 September 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">CoRE Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-tiloca-core-oscore-discovery-11</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2022-03-07" class="published">7 March 2022</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-09-08">8 September 2022</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">M. Tiloca</div>
<div class="org">RISE AB</div>
</div>
<div class="author">
      <div class="author-name">C. Amsuess</div>
</div>
<div class="author">
      <div class="author-name">P. van der Stok</div>
<div class="org">Consultant</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Discovery of OSCORE Groups with the CoRE Resource Directory</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">Group communication over the Constrained Application Protocol (CoAP) can be secured by means of Group Object Security for Constrained RESTful Environments (Group OSCORE). At deployment time, devices may not know the exact security groups to join, the respective Group Manager, or other information required to perform the joining process. This document describes how a CoAP endpoint can use descriptions and links of resources registered at the CoRE Resource Directory to discover security groups and to acquire information for joining them through the respective Group Manager. A given security group may protect multiple application groups, which are separately announced in the Resource Directory as sets of endpoints sharing a pool of resources. This approach is consistent with, but not limited to, the joining of security groups based on the ACE framework for Authentication and Authorization in constrained environments.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-discussion-venues-2">
<a href="#name-discussion-venues-2" class="section-name selfRef">Discussion Venues</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">Discussion of this document takes place on the
  Constrained RESTful Environments Working Group mailing list (core@ietf.org),
  which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/core/">https://mailarchive.ietf.org/arch/browse/core/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">Source for this draft and an issue tracker can be found at
  <span><a href="https://gitlab.com/crimson84/draft-tiloca-core-oscore-discovery">https://gitlab.com/crimson84/draft-tiloca-core-oscore-discovery</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo-9">
<a href="#name-status-of-this-memo-9" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 8 September 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice-9">
<a href="#name-copyright-notice-9" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2022 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents-9">
<a href="#name-table-of-contents-9" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction-8" class="xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-terminology-6" class="xref">Terminology</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-registration-of-group-manag" class="xref">Registration of Group Manager Endpoints</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-parameters" class="xref">Parameters</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-relation-link-to-authorizat" class="xref">Relation Link to Authorization Server</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="xref">2.3</a>.  <a href="#name-registration-example" class="xref">Registration Example</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3.2.1">
                    <p id="section-toc.1-1.2.2.3.2.1.1"><a href="#section-2.3.1" class="xref">2.3.1</a>.  <a href="#name-example-in-link-format" class="xref">Example in Link Format</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3.2.2">
                    <p id="section-toc.1-1.2.2.3.2.2.1"><a href="#section-2.3.2" class="xref">2.3.2</a>.  <a href="#name-example-in-coral" class="xref">Example in CoRAL</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-addition-and-update-of-secu" class="xref">Addition and Update of Security Groups</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-addition-example" class="xref">Addition Example</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.1">
                    <p id="section-toc.1-1.3.2.1.2.1.1"><a href="#section-3.1.1" class="xref">3.1.1</a>.  <a href="#name-example-in-link-format-2" class="xref">Example in Link Format</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.2">
                    <p id="section-toc.1-1.3.2.1.2.2.1"><a href="#section-3.1.2" class="xref">3.1.2</a>.  <a href="#name-example-in-coral-2" class="xref">Example in CoRAL</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-discovery-of-security-group" class="xref">Discovery of Security Groups</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-discovery-example-1" class="xref">Discovery Example #1</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.1">
                    <p id="section-toc.1-1.4.2.1.2.1.1"><a href="#section-4.1.1" class="xref">4.1.1</a>.  <a href="#name-example-in-link-format-3" class="xref">Example in Link Format</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.2">
                    <p id="section-toc.1-1.4.2.1.2.2.1"><a href="#section-4.1.2" class="xref">4.1.2</a>.  <a href="#name-example-in-coral-3" class="xref">Example in CoRAL</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-discovery-example-2" class="xref">Discovery Example #2</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a href="#section-4.2.1" class="xref">4.2.1</a>.  <a href="#name-example-in-link-format-4" class="xref">Example in Link Format</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.2">
                    <p id="section-toc.1-1.4.2.2.2.2.1"><a href="#section-4.2.2" class="xref">4.2.2</a>.  <a href="#name-example-in-coral-4" class="xref">Example in CoRAL</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-use-case-example-with-full-" class="xref">Use Case Example With Full Discovery</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-security-considerations-9" class="xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-iana-considerations-9" class="xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-references-7" class="xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="xref">8.1</a>.  <a href="#name-normative-references-8" class="xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="xref">8.2</a>.  <a href="#name-informative-references-8" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#appendix-A" class="xref">Appendix A</a>.  <a href="#name-use-case-example-with-full-d" class="xref">Use Case Example With Full Discovery (CoRAL)</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-B" class="xref"></a><a href="#name-acknowledgments-3" class="xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-C" class="xref"></a><a href="#name-authors-addresses-9" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="intro">
<section id="section-1">
      <h2 id="name-introduction-8">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction-8" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">The Constrained Application Protocol (CoAP) <span>[<a href="#RFC7252" class="xref">RFC7252</a>]</span> supports group communication over IP multicast <span>[<a href="#I-D.ietf-core-groupcomm-bis" class="xref">I-D.ietf-core-groupcomm-bis</a>]</span> to improve efficiency and latency of communication and reduce bandwidth requirements. A set of CoAP endpoints constitutes an application group by sharing a common pool of resources, that can be efficiently accessed through group communication. The members of an application group may be members of a security group, thus sharing a common set of keying material to secure group communication.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">The security protocol Group Object Security for Constrained RESTful Environments (Group OSCORE) <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span> builds on OSCORE <span>[<a href="#RFC8613" class="xref">RFC8613</a>]</span> and protects CoAP messages end-to-end in group communication contexts through CBOR Object Signing and Encryption (COSE) <span>[<a href="#I-D.ietf-cose-rfc8152bis-struct" class="xref">I-D.ietf-cose-rfc8152bis-struct</a>]</span><span>[<a href="#I-D.ietf-cose-rfc8152bis-algs" class="xref">I-D.ietf-cose-rfc8152bis-algs</a>]</span>. An application group may rely on one or more security groups, and a same security group may be used by multiple application groups at the same time.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">A CoAP endpoint relies on a Group Manager (GM) to join a security group and get the group keying material. The joining process in <span>[<a href="#I-D.ietf-ace-key-groupcomm-oscore" class="xref">I-D.ietf-ace-key-groupcomm-oscore</a>]</span> is based on the ACE framework for Authentication and Authorization in constrained environments <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>, with the joining endpoint and the GM acting as ACE Client and Resource Server, respectively. That is, the joining endpoint accesses the group-membership resource exported by the GM and associated with the security group to join.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">Typically, devices store a static X509 IDevID certificate installed at manufacturing time <span>[<a href="#RFC8995" class="xref">RFC8995</a>]</span>. This is used at deployment time during an enrollment process that provides the devices with an Operational Certificate, possibly updated during the device lifetime. Operational Certificates may specify information to join security groups, especially a reference to the group-membership resources to access at the respective GMs.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">However, it is usually impossible to provide such precise information to freshly deployed devices, as part of their (early) Operational Certificate. This can be due to a number of reasons: (1) the security group(s) to join and the responsible GM(s) are generally unknown at manufacturing time; (2) a security group of interest is created, or the responsible GM is deployed, only after the device is enrolled and fully operative in the network; (3) information related to existing security groups or to their GMs has changed. This requires a method for CoAP endpoints to dynamically discover security groups and their GM, and to retrieve relevant information about deployed groups.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">To this end, CoAP endpoints can use descriptions and links of group-membership resources at GMs, to discover security groups and retrieve the information required for joining them. With the discovery process of security groups expressed in terms of links to resources, the remaining problem is the discovery of those links. The CoRE Resource Directory (RD) <span>[<a href="#I-D.ietf-core-resource-directory" class="xref">I-D.ietf-core-resource-directory</a>]</span> allows such discovery in an efficient way, and it is expected to be used in many setups that would benefit of security group discovery.<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7">This specification builds on this approach and describes how CoAP endpoints can use the RD to perform the link discovery steps, in order to discover security groups and retrieve the information required to join them through their GM. In short, the GM registers as an endpoint with the RD. The resulting registration resource includes one link per security group under that GM, specifying the path to the related group-membership resource to access for joining that group.<a href="#section-1-7" class="pilcrow">¶</a></p>
<p id="section-1-8">Additional descriptive information about the security group is stored with the registered link. In a RD based on Link Format <span>[<a href="#RFC6690" class="xref">RFC6690</a>]</span> as defined in <span>[<a href="#I-D.ietf-core-resource-directory" class="xref">I-D.ietf-core-resource-directory</a>]</span>, this information is specified as target attributes of the registered link, and includes the identifiers of the application groups which use that security group. This enables a lookup of those application groups at the RD, where they are separately announced by a Commissioning Tool (see Appendix A of <span>[<a href="#I-D.ietf-core-resource-directory" class="xref">I-D.ietf-core-resource-directory</a>]</span>).<a href="#section-1-8" class="pilcrow">¶</a></p>
<p id="section-1-9">When querying the RD for security groups, a CoAP endpoint can use CoAP observation <span>[<a href="#RFC7641" class="xref">RFC7641</a>]</span>. This results in automatic notifications on the creation of new security groups or the update of existing groups. Thus, it facilitates the early deployment of CoAP endpoints, i.e., even before the GM is deployed and security groups are created.<a href="#section-1-9" class="pilcrow">¶</a></p>
<p id="section-1-10">Interaction examples are provided in Link Format, as well as in the Constrained RESTful Application Language CoRAL <span>[<a href="#I-D.ietf-core-coral" class="xref">I-D.ietf-core-coral</a>]</span> with reference to a CoRAL-based RD <span>[<a href="#I-D.hartke-t2trg-coral-reef" class="xref">I-D.hartke-t2trg-coral-reef</a>]</span>. While all the CoRAL examples show the CoRAL textual serialization format, its binary serialization format is used on the wire.<a href="#section-1-10" class="pilcrow">¶</a></p>
<p id="section-1-11">[ NOTE:<a href="#section-1-11" class="pilcrow">¶</a></p>
<p id="section-1-12">The reported CoRAL examples are based on the textual representation used until  version -03 of <span>[<a href="#I-D.ietf-core-coral" class="xref">I-D.ietf-core-coral</a>]</span>. These will be revised to use the CBOR diagnostic notation instead.<a href="#section-1-12" class="pilcrow">¶</a></p>
<p id="section-1-13">]<a href="#section-1-13" class="pilcrow">¶</a></p>
<p id="section-1-14">The approach in this document is consistent with, but not limited to, the joining of security groups defined in <span>[<a href="#I-D.ietf-ace-key-groupcomm-oscore" class="xref">I-D.ietf-ace-key-groupcomm-oscore</a>]</span>.<a href="#section-1-14" class="pilcrow">¶</a></p>
<div id="terminology">
<section id="section-1.1">
        <h3 id="name-terminology-6">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-terminology-6" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.1-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they appear in all capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">This specification requires readers to be familiar with the terms and concepts discussed in <span>[<a href="#I-D.ietf-core-resource-directory" class="xref">I-D.ietf-core-resource-directory</a>]</span> and <span>[<a href="#RFC6690" class="xref">RFC6690</a>]</span>, as well as in <span>[<a href="#I-D.ietf-core-coral" class="xref">I-D.ietf-core-coral</a>]</span>. Readers should also be familiar with the terms and concepts discussed in <span>[<a href="#RFC7252" class="xref">RFC7252</a>]</span><span>[<a href="#I-D.ietf-core-groupcomm-bis" class="xref">I-D.ietf-core-groupcomm-bis</a>]</span>, <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span> and <span>[<a href="#I-D.ietf-ace-key-groupcomm-oscore" class="xref">I-D.ietf-ace-key-groupcomm-oscore</a>]</span>.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
<p id="section-1.1-3">Terminology for constrained environments, such as "constrained device" and "constrained-node network", is defined in <span>[<a href="#RFC7228" class="xref">RFC7228</a>]</span>.<a href="#section-1.1-3" class="pilcrow">¶</a></p>
<p id="section-1.1-4">Consistently with the definitions from <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-groupcomm-bis-06#section-2.1" class="relref">Section 2.1</a> of [<a href="#I-D.ietf-core-groupcomm-bis" class="xref">I-D.ietf-core-groupcomm-bis</a>]</span>, this document also refers to the following terminology.<a href="#section-1.1-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-5.1">CoAP group: a set of CoAP endpoints all configured to receive CoAP multicast messages sent to the group's associated IP multicast address and UDP port. An endpoint may be a member of multiple CoAP groups by subscribing to multiple IP multicast addresses.<a href="#section-1.1-5.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-5.2">
            <p id="section-1.1-5.2.1">Security group: a set of CoAP endpoints that share the same security material, and use it to protect and verify exchanged messages. A CoAP endpoint may be a member of multiple security groups. There can be a one-to-one or a one-to-many relation between security groups and CoAP groups.<a href="#section-1.1-5.2.1" class="pilcrow">¶</a></p>
<p id="section-1.1-5.2.2">
This document especially considers a security group to be an OSCORE group, where all members share one OSCORE Security Context to protect group communication with Group OSCORE <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>. However, the approach defined in this document can be used to support the discovery of different security groups than OSCORE groups.<a href="#section-1.1-5.2.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-5.3">Application group: a set of CoAP endpoints that share a common set of resources. An endpoint may be a member of multiple application groups. An application group can be associated with one or more security groups, and multiple application groups can use the same security group. Application groups are announced in the RD by a Commissioning Tool, according to the RD-Groups usage pattern (see Appendix A of <span>[<a href="#I-D.ietf-core-resource-directory" class="xref">I-D.ietf-core-resource-directory</a>]</span>).<a href="#section-1.1-5.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-1.1-6">Like <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>, this document also uses the following term.<a href="#section-1.1-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-7.1">Authentication credential: set of information associated with an entity, including that entity's public key and parameters associated with the public key. Examples of authentication credentials are CBOR Web Tokens (CWTs) and CWT Claims Sets (CCSs)
<span>[<a href="#RFC8392" class="xref">RFC8392</a>]</span>, X.509 certificates <span>[<a href="#RFC7925" class="xref">RFC7925</a>]</span> and C509 certificates <span>[<a href="#I-D.ietf-cose-cbor-encoded-cert" class="xref">I-D.ietf-cose-cbor-encoded-cert</a>]</span>.<a href="#section-1.1-7.1" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="sec-GM-registration">
<section id="section-2">
      <h2 id="name-registration-of-group-manag">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-registration-of-group-manag" class="section-name selfRef">Registration of Group Manager Endpoints</a>
      </h2>
<p id="section-2-1">During deployment, a Group Manager (GM) can find the CoRE Resource Directory (RD) as described in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-resource-directory-28#section-4" class="relref">Section 4</a> of [<a href="#I-D.ietf-core-resource-directory" class="xref">I-D.ietf-core-resource-directory</a>]</span>.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">Afterwards, the GM registers as an endpoint with the RD, as described in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-resource-directory-28#section-5" class="relref">Section 5</a> of [<a href="#I-D.ietf-core-resource-directory" class="xref">I-D.ietf-core-resource-directory</a>]</span>. The GM SHOULD NOT use the Simple Registration approach described in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-resource-directory-28#section-5.1" class="relref">Section 5.1</a> of [<a href="#I-D.ietf-core-resource-directory" class="xref">I-D.ietf-core-resource-directory</a>]</span>.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">When registering with the RD, the GM also registers the links to all the group-membership resources it has at that point in time, i.e., one for each of its security groups.<a href="#section-2-3" class="pilcrow">¶</a></p>
<p id="section-2-4">In the registration request, each link to a group-membership resource has as target the URI of that resource at the GM. Also, it specifies a number of descriptive parameters as defined in <a href="#ssec-parameters" class="xref">Section 2.1</a>.<a href="#section-2-4" class="pilcrow">¶</a></p>
<p id="section-2-5">Furthermore, the GM MAY additionally register the link to its resource implementing the ACE authorization information endpoint (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oauth-authz-46#section-5.10.1" class="relref">Section 5.10.1</a> of [<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>). A joining node can provide the GM with its own access token by sending it in a request targeting that resource, thus proving to be authorized to join certain security groups (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-oscore-13#section-6.1" class="relref">Section 6.1</a> of [<a href="#I-D.ietf-ace-key-groupcomm-oscore" class="xref">I-D.ietf-ace-key-groupcomm-oscore</a>]</span>). In such a case, the link MUST include the parameter 'rt' with value "ace.ai", defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oauth-authz-46#section-8.2" class="relref">Section 8.2</a> of [<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>.<a href="#section-2-5" class="pilcrow">¶</a></p>
<div id="ssec-parameters">
<section id="section-2.1">
        <h3 id="name-parameters">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-parameters" class="section-name selfRef">Parameters</a>
        </h3>
<p id="section-2.1-1">For each registered link to a group-membership resource at a GM, the following parameters are specified together with the link.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1-2">In the RD defined in <span>[<a href="#I-D.ietf-core-resource-directory" class="xref">I-D.ietf-core-resource-directory</a>]</span> and based on Link Format, each parameter is specified in a target attribute with the same name.<a href="#section-2.1-2" class="pilcrow">¶</a></p>
<p id="section-2.1-3">In a RD based on CoRAL, such as the one defined in <span>[<a href="#I-D.hartke-t2trg-coral-reef" class="xref">I-D.hartke-t2trg-coral-reef</a>]</span>, each parameter is specified in a nested element with the same name.<a href="#section-2.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-4.1">
            <p id="section-2.1-4.1.1">'ct', specifying the content format used with the group-membership resource at the Group Manager, with value "application/ace-groupcomm+cbor" registered in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-15#section-8.2" class="relref">Section 8.2</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>.<a href="#section-2.1-4.1.1" class="pilcrow">¶</a></p>
<p id="section-2.1-4.1.2">
Note: The examples in this document use the provisional value 65000 from the range "Reserved for Experimental Use" of the "CoAP Content-Formats" registry, within the "CoRE Parameters" registry.<a href="#section-2.1-4.1.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-4.2">'rt', specifying the resource type of the group-membership resource at the Group Manager, with value "core.osc.gm" registered in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-oscore-13#section-25.11" class="relref">Section 25.11</a> of [<a href="#I-D.ietf-ace-key-groupcomm-oscore" class="xref">I-D.ietf-ace-key-groupcomm-oscore</a>]</span>.<a href="#section-2.1-4.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-4.3">'if', specifying the interface description for accessing the group-membership resource at the Group Manager, with value "ace.group" registered in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-15#section-8.10" class="relref">Section 8.10</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>.<a href="#section-2.1-4.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-4.4">'sec-gp', specifying the name of the security group of interest, as a stable and invariant identifier, such as the group name used in <span>[<a href="#I-D.ietf-ace-key-groupcomm-oscore" class="xref">I-D.ietf-ace-key-groupcomm-oscore</a>]</span>. This parameter MUST specify a single value.<a href="#section-2.1-4.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-4.5">
            <p id="section-2.1-4.5.1">'app-gp', specifying the name(s) of the application group(s) associated with the security group of interest indicated by 'sec-gp'. This parameter MUST occur once for each application group, and MUST specify only a single application group.<a href="#section-2.1-4.5.1" class="pilcrow">¶</a></p>
<p id="section-2.1-4.5.2">
When a security group is created at the GM, the names of the application groups using it are also specified as part of the security group configuration (see <span>[<a href="#I-D.ietf-ace-oscore-gm-admin" class="xref">I-D.ietf-ace-oscore-gm-admin</a>]</span>). Thus, when registering the links to its group-membership resource, the GM is aware of the application groups and their names.<a href="#section-2.1-4.5.2" class="pilcrow">¶</a></p>
<p id="section-2.1-4.5.3">
If a different entity than the GM registers the security groups to the RD, e.g., a Commissioning Tool, this entity has to also be aware of the application groups and their names to specify. To this end, it can obtain them from the GM or from the Administator that created the security groups at the GM (see <span>[<a href="#I-D.ietf-ace-oscore-gm-admin" class="xref">I-D.ietf-ace-oscore-gm-admin</a>]</span>).<a href="#section-2.1-4.5.3" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-2.1-5">Optionally, the following parameters can also be specified. If Link Format is used, the value of each of these parameters is encoded as a text string.<a href="#section-2.1-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-6.1">'hkdf', specifying the HKDF Algorithm used in the security group. If present, this parameter MUST specify a single value, which is taken from the 'Value' column of the "COSE Algorithms" Registry <span>[<a href="#COSE.Algorithms" class="xref">COSE.Algorithms</a>]</span>.<a href="#section-2.1-6.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-6.2">
            <p id="section-2.1-6.2.1">'cred_fmt', specifying the format of the authentication credentials used in the security group. If present, this parameter MUST specify a single value, which is taken from the 'Label' column of the "COSE Header Parameters" Registry <span>[<a href="#COSE.Header.Parameters" class="xref">COSE.Header.Parameters</a>]</span>. Acceptable values denote a format that MUST explicitly provide the public key as well as the comprehensive set of information related to the public key algorithm, including, e.g., the used elliptic curve (when applicable).<a href="#section-2.1-6.2.1" class="pilcrow">¶</a></p>
<p id="section-2.1-6.2.2">
At the time of writing this specification, acceptable formats of authentication credentials are CBOR Web Tokens (CWTs) and CWT Claim Sets (CCSs) <span>[<a href="#RFC8392" class="xref">RFC8392</a>]</span>, X.509 certificates <span>[<a href="#RFC7925" class="xref">RFC7925</a>]</span> and C509 certificates <span>[<a href="#I-D.ietf-cose-cbor-encoded-cert" class="xref">I-D.ietf-cose-cbor-encoded-cert</a>]</span>. Further formats may be available in the future, and would be acceptable to use as long as they comply with the criteria defined above.<a href="#section-2.1-6.2.2" class="pilcrow">¶</a></p>
<p id="section-2.1-6.2.3">
[ As to CWTs and unprotected CWT claim sets, there is a pending registration requested by draft-ietf-lake-edhoc. ]<a href="#section-2.1-6.2.3" class="pilcrow">¶</a></p>
<p id="section-2.1-6.2.4">
[ As to C509 certificates, there is a pending registration requested by draft-ietf-cose-cbor-encoded-cert. ]<a href="#section-2.1-6.2.4" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-6.3">'sign_enc_alg', specifying the encryption algorithm used to encrypt messages in the security group, when these are also signed, e.g., as in the group mode of Group OSCORE (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-14#section-8" class="relref">Section 8</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>). If present, this parameter MUST specify a single value, which is taken from the 'Value' column of the "COSE Algorithms" Registry <span>[<a href="#COSE.Algorithms" class="xref">COSE.Algorithms</a>]</span>.<a href="#section-2.1-6.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-6.4">'sign_alg', specifying the algorithm used to sign messages in the security group. If present, this parameter MUST specify a single value, which is taken from the 'Value' column of the "COSE Algorithms" Registry <span>[<a href="#COSE.Algorithms" class="xref">COSE.Algorithms</a>]</span>.<a href="#section-2.1-6.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-6.5">'sign_alg_crv', specifying the elliptic curve (if applicable) for the algorithm used to sign messages in the security group. If present, this parameter MUST specify a single value, which is taken from the 'Value' column of the "COSE Elliptic Curves" Registry <span>[<a href="#COSE.Elliptic.Curves" class="xref">COSE.Elliptic.Curves</a>]</span>.<a href="#section-2.1-6.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-6.6">'sign_key_kty', specifying the key type of countersignature keys used to sign messages in the security group. If present, this parameter MUST specify a single value, which is taken from the 'Value' column of the "COSE Key Types" Registry <span>[<a href="#COSE.Key.Types" class="xref">COSE.Key.Types</a>]</span>.<a href="#section-2.1-6.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-6.7">'sign_key_crv', specifying the elliptic curve (if applicable) of countersignature keys used to sign messages in the security group. If present, this parameter MUST specify a single value, which is taken from the 'Value' column of the "COSE Elliptic Curves" Registry <span>[<a href="#COSE.Elliptic.Curves" class="xref">COSE.Elliptic.Curves</a>]</span>.<a href="#section-2.1-6.7" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-6.8">'alg', specifying the encryption algorithm used to encrypt messages in the security group, when these are encrypted with pairwise encryption keys, e.g., as in the pairwise mode of Group OSCORE (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-14#section-9" class="relref">Section 9</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>). If present, this parameter MUST specify a single value, which is taken from the 'Value' column of the "COSE Algorithms" Registry <span>[<a href="#COSE.Algorithms" class="xref">COSE.Algorithms</a>]</span>.<a href="#section-2.1-6.8" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-6.9">'ecdh_alg', specifying the ECDH algorithm used to derive pairwise encryption keys in the security group, e.g., as for the pairwise mode of Group OSCORE (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-14#section-2.4" class="relref">Section 2.4</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>). If present, this parameter MUST specify a single value, which is taken from the 'Value' column of the "COSE Algorithms" Registry <span>[<a href="#COSE.Algorithms" class="xref">COSE.Algorithms</a>]</span>.<a href="#section-2.1-6.9" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-6.10">'ecdh_alg_crv', specifying the elliptic curve for the ECDH algorithm used to derive pairwise encryption keys in the security group. If present, this parameter MUST specify a single value, which is taken from the 'Value' column of the "COSE Elliptic Curves" Registry <span>[<a href="#COSE.Elliptic.Curves" class="xref">COSE.Elliptic.Curves</a>]</span>.<a href="#section-2.1-6.10" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-6.11">'ecdh_key_kty', specifying the key type of keys used with an ECDH algorithm to derive pairwise encryption keys in the security group. If present, this parameter MUST specify a single value, which is taken from the 'Value' column of the "COSE Key Types" Registry <span>[<a href="#COSE.Key.Types" class="xref">COSE.Key.Types</a>]</span>.<a href="#section-2.1-6.11" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-6.12">'ecdh_key_crv', specifying the elliptic curve of keys used with an ECDH algorithm to derive pairwise encryption keys in the security group. If present, this parameter MUST specify a single value, which is taken from the 'Value' column of the "COSE Elliptic Curves" Registry <span>[<a href="#COSE.Elliptic.Curves" class="xref">COSE.Elliptic.Curves</a>]</span>.<a href="#section-2.1-6.12" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-6.13">'det_hash_alg', specifying the hash algorithm used in the security group when producing deterministic requests, as defined in <span>[<a href="#I-D.amsuess-core-cachable-oscore" class="xref">I-D.amsuess-core-cachable-oscore</a>]</span>. If present, this parameter MUST specify a single value, which is taken from the 'Value' column of the "COSE Algorithms" Registry <span>[<a href="#COSE.Algorithms" class="xref">COSE.Algorithms</a>]</span>. This parameter MUST NOT be present if the security group does not use deterministic requests.<a href="#section-2.1-6.13" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-6.14">'rekeying_scheme', specifying the rekeying scheme used in the security group for distributing new group keying meterial to the group members. If present, this parameter MUST specify a single value, which is taken from the 'Value' column of the "ACE Groupcomm Rekeying Schemes" registry defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-15#section-11.14" class="relref">Section 11.14</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>.<a href="#section-2.1-6.14" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-2.1-7">If the security group does not recur to message signing, then the parameters 'sign_enc_alg', 'sign_alg', 'sign_alg_crv', 'sign_key_kty' and 'sign_key_crv' MUST NOT be present. For instance, this is the case for a security group that uses Group OSCORE and uses only the pairwise mode (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-14#section-9" class="relref">Section 9</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>).<a href="#section-2.1-7" class="pilcrow">¶</a></p>
<p id="section-2.1-8">If the security group does not recur to message encryption through pairwise encryption keys, then the parameters 'alg', 'ecdh_alg', 'ecdh_alg_crv', 'ecdh_key_kty' and 'ecdh_key_crv' MUST NOT be present. For instance, this is the case for a security group that uses Group OSCORE and uses only the group mode see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-14#section-8" class="relref">Section 8</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>).<a href="#section-2.1-8" class="pilcrow">¶</a></p>
<p id="section-2.1-9">Note that the values registered in the COSE Registries <span>[<a href="#COSE.Algorithms" class="xref">COSE.Algorithms</a>]</span><span>[<a href="#COSE.Elliptic.Curves" class="xref">COSE.Elliptic.Curves</a>]</span><span>[<a href="#COSE.Key.Types" class="xref">COSE.Key.Types</a>]</span> are strongly typed. On the contrary, Link Format is weakly typed and thus does not distinguish between, for instance, the string value "-10" and the integer value -10.<a href="#section-2.1-9" class="pilcrow">¶</a></p>
<p id="section-2.1-10">Thus, in RDs that return responses in Link Format, string values which look like an integer are not supported. Therefore, such values MUST NOT be advertised through the corresponding parameters above.<a href="#section-2.1-10" class="pilcrow">¶</a></p>
<p id="section-2.1-11">A CoAP endpoint that queries the RD to discover security groups and their group-membership resource to access (see <a href="#sec-group-discovery" class="xref">Section 4</a>) would benefit from the information above as follows.<a href="#section-2.1-11" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-12.1">
            <p id="section-2.1-12.1.1">The values of 'cred_fmt', 'sign_alg', 'sign_alg_crv', 'sign_key_kty', 'sign_key_crv', 'ecdh_alg', 'ecdh_alg_crv', 'ecdh_key_kty' and 'ecdh_key_crv' related to a group-membership resource provide an early knowledge of the format of authentication credentials as well as of the type of public keys used in the security group.<a href="#section-2.1-12.1.1" class="pilcrow">¶</a></p>
<p id="section-2.1-12.1.2">
Thus, the CoAP endpoint does not need to ask the GM for this information as a preliminary step before the joining process, or to perform a trial-and-error joining exchange with the GM. Hence, at the very first step of the joining process, the CoAP endpoint is able to provide the GM with its own authentication credential in the correct expected format and including a public key of the correct expected type.<a href="#section-2.1-12.1.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-12.2">
            <p id="section-2.1-12.2.1">The values of 'hkdf', 'sign_enc_alg', 'sign_alg', 'alg' and 'ecdh_alg' related to a group-membership resource provide an early knowledge of the algorithms used in the security group.<a href="#section-2.1-12.2.1" class="pilcrow">¶</a></p>
<p id="section-2.1-12.2.2">
Thus, the CoAP endpoint is able to decide whether to actually proceed with the joining process, depending on its support for the indicated algorithms.<a href="#section-2.1-12.2.2" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="ssec-link-as">
<section id="section-2.2">
        <h3 id="name-relation-link-to-authorizat">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-relation-link-to-authorizat" class="section-name selfRef">Relation Link to Authorization Server</a>
        </h3>
<p id="section-2.2-1">For each registered link to a group-membership resource, the GM MAY additionally specify the link to the ACE Authorization Server (AS) <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span> associated with the GM, and issuing authorization credentials to join the security group as described in <span>[<a href="#I-D.ietf-ace-key-groupcomm-oscore" class="xref">I-D.ietf-ace-key-groupcomm-oscore</a>]</span>.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<p id="section-2.2-2">The link to the AS has as target the URI of the resource where to send an authorization request to.<a href="#section-2.2-2" class="pilcrow">¶</a></p>
<p id="section-2.2-3">In the RD defined in <span>[<a href="#I-D.ietf-core-resource-directory" class="xref">I-D.ietf-core-resource-directory</a>]</span> and based on Link Format, the link to the AS is separately registered with the RD, and includes the following parameters as target attributes.<a href="#section-2.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2-4.1">'rel', with value "authorization_server".<a href="#section-2.2-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.2-4.2">'anchor', with value the target of the link to the group-membership resource at the GM.<a href="#section-2.2-4.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-2.2-5">In a RD based on CoRAL, such as the one defined in <span>[<a href="#I-D.hartke-t2trg-coral-reef" class="xref">I-D.hartke-t2trg-coral-reef</a>]</span>, this is mapped (as describe there) to a link from the registration resource to the AS, using the &lt;http://www.iana.org/assignments/relation/authorization_server&gt; link relation type.<a href="#section-2.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ssec-registration--ex">
<section id="section-2.3">
        <h3 id="name-registration-example">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-registration-example" class="section-name selfRef">Registration Example</a>
        </h3>
<p id="section-2.3-1">The example below shows a GM with endpoint name "gm1" and address 2001:db8::ab that registers with the RD.<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<p id="section-2.3-2">The GM specifies the value of the 'sec-gp' parameter for accessing the security group with name "feedca570000", and used by the application group with name "group1" specified with the value of the 'app-gp' parameter.<a href="#section-2.3-2" class="pilcrow">¶</a></p>
<p id="section-2.3-3">The countersignature algorithm used in the security group is EdDSA (-8), with elliptic curve Ed25519 (6). Authentication credentials used in the security group are X.509 certificates <span>[<a href="#RFC7925" class="xref">RFC7925</a>]</span>, which is signaled through the COSE Header Parameter "x5chain" (33). The ECDH algorithm used in the security group is ECDH-SS + HKDF-256 (-27), with elliptic curve X25519 (4).<a href="#section-2.3-3" class="pilcrow">¶</a></p>
<p id="section-2.3-4">In addition, the GM specifies the link to the ACE Authorization Server associated with the GM, to which a CoAP endpoint should send an Authorization Request for joining the corresponding security group (see <span>[<a href="#I-D.ietf-ace-key-groupcomm-oscore" class="xref">I-D.ietf-ace-key-groupcomm-oscore</a>]</span>).<a href="#section-2.3-4" class="pilcrow">¶</a></p>
<div id="sssec-registration--ex-link-format">
<section id="section-2.3.1">
          <h4 id="name-example-in-link-format">
<a href="#section-2.3.1" class="section-number selfRef">2.3.1. </a><a href="#name-example-in-link-format" class="section-name selfRef">Example in Link Format</a>
          </h4>
<p id="section-2.3.1-1">Request:  GM -&gt; RD<a href="#section-2.3.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.3.1-2">
<pre>
Req: POST coap://rd.example.com/rd?ep=gm1
Content-Format: 40
Payload:
&lt;/ace-group/feedca570000&gt;;ct=65000;rt="core.osc.gm";if="ace.group";
                             sec-gp="feedca570000";app-gp="group1";
                             cred_fmt="33";sign_enc_alg="10";
                             sign_alg="-8";sign_alg_crv="6";
                             alg="10";ecdh_alg="-27";ecdh_alg_crv="4",
&lt;coap://as.example.com/token&gt;;rel="authorization-server";
      anchor="coap://[2001:db8::ab]/ace-group/feedca570000"
</pre><a href="#section-2.3.1-2" class="pilcrow">¶</a>
</div>
<p id="section-2.3.1-3">Response:  RD -&gt; GM<a href="#section-2.3.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.3.1-4">
<pre>
Res: 2.01 Created
Location-Path: /rd/4521
</pre><a href="#section-2.3.1-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="example-in-coral">
<section id="section-2.3.2">
          <h4 id="name-example-in-coral">
<a href="#section-2.3.2" class="section-number selfRef">2.3.2. </a><a href="#name-example-in-coral" class="section-name selfRef">Example in CoRAL</a>
          </h4>
<p id="section-2.3.2-1">Request:  GM -&gt; RD<a href="#section-2.3.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.3.2-2">
<pre>
Req: POST coap://rd.example.com/rd?ep=gm1
Content-Format: TBD123456 (application/coral+cbor)

Payload:
#using &lt;http://coreapps.org/core.oscore-discovery#&gt;
#using reef = &lt;http://coreapps.org/reef#&gt;
#using iana = &lt;http://www.iana.org/assignments/relation/&gt;

#base &lt;coap://[2001:db8::ab]/&gt;
reef:rd-item &lt;/ace-group/feedca570000&gt; {
   reef:ct 65000
   reef:rt "core.osc.gm"
   reef:if "ace.group"
   sec-gp "feedca570000"
   app-gp "group1"
   cred_fmt 33
   sign_enc_alg 10
   sign_alg -8
   sign_alg_crv 6
   alg 10
   ecdh_alg -27
   ecdh_alg_crv 4
   iana:authorization-server &lt;coap://as.example.com/token&gt;
}
</pre><a href="#section-2.3.2-2" class="pilcrow">¶</a>
</div>
<p id="section-2.3.2-3">Response:  RD -&gt; GM<a href="#section-2.3.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.3.2-4">
<pre>
Res: 2.01 Created
Location-Path: /rd/4521
</pre><a href="#section-2.3.2-4" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="sec-update-addition">
<section id="section-3">
      <h2 id="name-addition-and-update-of-secu">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-addition-and-update-of-secu" class="section-name selfRef">Addition and Update of Security Groups</a>
      </h2>
<p id="section-3-1">The GM is responsible to refresh the registration of all its group-membership resources in the RD. This means that the GM has to update the registration within its lifetime as per <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-resource-directory-28#section-5.3.1" class="relref">Section 5.3.1</a> of [<a href="#I-D.ietf-core-resource-directory" class="xref">I-D.ietf-core-resource-directory</a>]</span>, and has to change the content of the registration when a group-membership resource is added/removed, or if its parameters have to be changed, such as in the following cases.<a href="#section-3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-2.1">The GM creates a new security group and starts exporting the related group-membership resource.<a href="#section-3-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-2.2">The GM dismisses a security group and stops exporting the related group-membership resource.<a href="#section-3-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-2.3">Information related to an existing security group changes, e.g., the list of associated application groups.<a href="#section-3-2.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-3-3">To perform an update of its registrations, the GM can re-register with the RD and fully specify all links to its group-membership resources.<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">Alternatively, the GM can perform a PATCH/iPATCH <span>[<a href="#RFC8132" class="xref">RFC8132</a>]</span> request to the RD, as per <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-resource-directory-28#section-5.3.3" class="relref">Section 5.3.3</a> of [<a href="#I-D.ietf-core-resource-directory" class="xref">I-D.ietf-core-resource-directory</a>]</span>. This requires new media-types to be defined in future standards, to apply a new document as a patch to an existing stored document.<a href="#section-3-4" class="pilcrow">¶</a></p>
<div id="ssec-addition--ex">
<section id="section-3.1">
        <h3 id="name-addition-example">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-addition-example" class="section-name selfRef">Addition Example</a>
        </h3>
<p id="section-3.1-1">The example below shows how the GM from <a href="#sec-GM-registration" class="xref">Section 2</a> re-registers with the RD. When doing so, it specifies:<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-2.1">The same previous group-membership resource associated with the security group with name "feedca570000".<a href="#section-3.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-2.2">An additional group-membership resource associated with the security group with name "ech0ech00000" and used by the application group "group2".<a href="#section-3.1-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-2.3">A third group-membership resource associated with the security group with name "abcdef120000" and used by two application groups, namely "group3" and "group4".<a href="#section-3.1-2.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.1-3">Furthermore, the GM relates the same Authorization Server also to the security groups "ech0ech00000" and "abcdef120000".<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<div id="example-in-link-format">
<section id="section-3.1.1">
          <h4 id="name-example-in-link-format-2">
<a href="#section-3.1.1" class="section-number selfRef">3.1.1. </a><a href="#name-example-in-link-format-2" class="section-name selfRef">Example in Link Format</a>
          </h4>
<p id="section-3.1.1-1">Request:  GM -&gt; RD<a href="#section-3.1.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.1.1-2">
<pre>
Req: POST coap://rd.example.com/rd?ep=gm1
Content-Format: 40
Payload:
&lt;/ace-group/feedca570000&gt;;ct=65000;rt="core.osc.gm";if="ace.group";
                             sec-gp="feedca570000";app-gp="group1";
                             cred_fmt="33";sign_enc_alg="10";
                             sign_alg="-8";sign_alg_crv="6";
                             alg="10";ecdh_alg="-27";ecdh_alg_crv="4",
&lt;/ace-group/ech0ech00000&gt;;ct=65000;rt="core.osc.gm";if="ace.group";
                             sec-gp="ech0ech00000";app-gp="group2";
                             cred_fmt="33";sign_enc_alg="10";
                             sign_alg="-8";sign_alg_crv="6";
                             alg="10";ecdh_alg="-27";ecdh_alg_crv="4",
&lt;/ace-group/abcdef120000&gt;;ct=65000;rt="core.osc.gm";if="ace.group";
                             sec-gp="abcdef120000";app-gp="group3";
                             app-gp="group4";cred_fmt="33";
                             sign_enc_alg="10";sign_alg="-8";
                             sign_alg_crv="6";alg="10";ecdh_alg="-27";
                             ecdh_alg_crv="4",
&lt;coap://as.example.com/token&gt;;rel="authorization-server";
      anchor="coap://[2001:db8::ab]/ace-group/feedca570000",
&lt;coap://as.example.com/token&gt;;rel="authorization-server";
      anchor="coap://[2001:db8::ab]/ace-group/ech0ech00000",
&lt;coap://as.example.com/token&gt;;rel="authorization-server";
      anchor="coap://[2001:db8::ab]/ace-group/abcdef120000"
</pre><a href="#section-3.1.1-2" class="pilcrow">¶</a>
</div>
<p id="section-3.1.1-3">Response:  RD -&gt; GM<a href="#section-3.1.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.1.1-4">
<pre>
Res: 2.04 Changed
Location-Path: /rd/4521
</pre><a href="#section-3.1.1-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="example-in-coral-1">
<section id="section-3.1.2">
          <h4 id="name-example-in-coral-2">
<a href="#section-3.1.2" class="section-number selfRef">3.1.2. </a><a href="#name-example-in-coral-2" class="section-name selfRef">Example in CoRAL</a>
          </h4>
<p id="section-3.1.2-1">Request:  GM -&gt; RD<a href="#section-3.1.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.1.2-2">
<pre>
Req: POST coap://rd.example.com/rd?ep=gm1
Content-Format: TBD123456 (application/coral+cbor)

Payload:
#using &lt;http://coreapps.org/core.oscore-discovery#&gt;
#using reef = &lt;http://coreapps.org/reef#&gt;
#using iana = &lt;http://www.iana.org/assignments/relation/&gt;

#base &lt;coap://[2001:db8::ab]/&gt;
reef:rd-item &lt;/ace-group/feedca570000&gt; {
   reef:ct 65000
   reef:rt "core.osc.gm"
   reef:if "ace.group"
   sec-gp "feedca570000"
   app-gp "group1"
   cred_fmt 33
   sign_enc_alg 10
   sign_alg -8
   sign_alg_crv 6
   alg 10
   ecdh_alg -27
   ecdh_alg_crv 4
   iana:authorization-server &lt;coap://as.example.com/token&gt;
}
reef:rd-item &lt;/ace-group/ech0ech00000&gt; {
   reef:ct 65000
   reef:rt "core.osc.gm"
   reef:if "ace.group"
   sec-gp "ech0ech00000"
   app-gp "group2"
   cred_fmt 33
   sign_enc_alg 10
   sign_alg -8
   sign_alg_crv 6
   alg 10
   ecdh_alg -27
   ecdh_alg_crv 4
   iana:authorization-server &lt;coap://as.example.com/token&gt;
}
reef:rd-item &lt;/ace-group/abcdef120000&gt; {
   reef:ct 65000
   reef:rt "core.osc.gm"
   reef:if "ace.group"
   sec-gp "abcdef120000"
   app-gp "group3"
   app-gp "group4"
   cred_fmt 33
   sign_enc_alg 10
   sign_alg -8
   sign_alg_crv 6
   alg 10
   ecdh_alg -27
   ecdh_alg_crv 4
   iana:authorization-server &lt;coap://as.example.com/token&gt;
}
</pre><a href="#section-3.1.2-2" class="pilcrow">¶</a>
</div>
<p id="section-3.1.2-3">Response:  RD -&gt; GM<a href="#section-3.1.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.1.2-4">
<pre>
Res: 2.04 Changed
Location-Path: /rd/4521
</pre><a href="#section-3.1.2-4" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="sec-group-discovery">
<section id="section-4">
      <h2 id="name-discovery-of-security-group">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-discovery-of-security-group" class="section-name selfRef">Discovery of Security Groups</a>
      </h2>
<p id="section-4-1">A CoAP endpoint that wants to join a security group, hereafter called the joining node, might not have all the necessary information at deployment time. Also, it might want to know about possible new security groups created afterwards by the respective Group Managers.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">To this end, the joining node can perform a resource lookup at the RD as per <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-resource-directory-28#section-6.1" class="relref">Section 6.1</a> of [<a href="#I-D.ietf-core-resource-directory" class="xref">I-D.ietf-core-resource-directory</a>]</span>, to retrieve the missing pieces of information needed to join the security group(s) of interest. The joining node can find the RD as described in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-resource-directory-28#section-4" class="relref">Section 4</a> of [<a href="#I-D.ietf-core-resource-directory" class="xref">I-D.ietf-core-resource-directory</a>]</span>.<a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3">The joining node uses the following parameter value for the lookup filtering.<a href="#section-4-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-4.1">'rt' = "core.osc.gm", specifying the resource type of the group-membership resource at the Group Manager, with value "core.osc.gm" registered in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-oscore-13#section-25.11" class="relref">Section 25.11</a> of [<a href="#I-D.ietf-ace-key-groupcomm-oscore" class="xref">I-D.ietf-ace-key-groupcomm-oscore</a>]</span>.<a href="#section-4-4.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-4-5">The joining node may additionally consider the following parameters for the lookup filtering, depending on the information it has already available.<a href="#section-4-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-6.1">'sec-gp', specifying the name of the security group of interest. This parameter MUST specify a single value.<a href="#section-4-6.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-6.2">'ep', specifying the registered endpoint of the GM.<a href="#section-4-6.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-6.3">'app-gp', specifying the name(s) of the application group(s) associated with the security group of interest. This parameter MAY be included multiple times, and each occurrence MUST specify the name of one application group.<a href="#section-4-6.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-6.4">'if', specifying the interface description for accessing the group-membership resource at the Group Manager, with value "ace.group" registered in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-15#section-8.10" class="relref">Section 8.10</a> of [<a href="#I-D.ietf-ace-key-groupcomm" class="xref">I-D.ietf-ace-key-groupcomm</a>]</span>.<a href="#section-4-6.4" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-4-7">The response from the RD may include links to a group-membership resource specifying multiple application groups, as all using the same security group. In this case, the joining node is already expected to know the exact application group of interest.<a href="#section-4-7" class="pilcrow">¶</a></p>
<p id="section-4-8">Furthermore, the response from the RD may include the links to different group-membership resources, all specifying a same application group of interest for the joining node, if the corresponding security groups are all used by that application group.<a href="#section-4-8" class="pilcrow">¶</a></p>
<p id="section-4-9">In this case, application policies on the joining node should define how to determine the exact security group to join (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-groupcomm-bis-06#section-2.1" class="relref">Section 2.1</a> of [<a href="#I-D.ietf-core-groupcomm-bis" class="xref">I-D.ietf-core-groupcomm-bis</a>]</span>). For example, different security groups can reflect different security algorithms to use. Hence, a client application can take into account what the joining node supports and prefers, when selecting one particular security group among the indicated ones, while a server application would need to join all of them. Later on, the joining node will be anyway able to join only security groups for which it is actually authorized to be a member (see <span>[<a href="#I-D.ietf-ace-key-groupcomm-oscore" class="xref">I-D.ietf-ace-key-groupcomm-oscore</a>]</span>).<a href="#section-4-9" class="pilcrow">¶</a></p>
<p id="section-4-10">Note that, with RD-based discovery, including the 'app-gp' parameter multiple times would result in finding only the group-membership resource that serves all the specified application groups, i.e., not any group-membership resource that serves either. Therefore, a joining node needs to perform N separate queries with different values for 'app-gp', in order to safely discover the (different) group-membership resource(s) serving the N application groups.<a href="#section-4-10" class="pilcrow">¶</a></p>
<p id="section-4-11">The discovery of security groups as defined in this document is applicable and useful to other CoAP endpoints than the actual joining nodes. In particular, other entities can be interested to discover and interact with the group-membership resource at the Group Manager. These include entities acting as signature
checkers, e.g., intermediary gateways, that do not join a security group, but can retrieve authentication credentials of group members from the Group Manager, in order to verify counter signatures of group messages (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-14#section-3" class="relref">Section 3</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>).<a href="#section-4-11" class="pilcrow">¶</a></p>
<div id="ssec-group-discovery-ex1">
<section id="section-4.1">
        <h3 id="name-discovery-example-1">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-discovery-example-1" class="section-name selfRef">Discovery Example #1</a>
        </h3>
<p id="section-4.1-1">Consistently with the examples in <a href="#sec-GM-registration" class="xref">Section 2</a> and <a href="#sec-update-addition" class="xref">Section 3</a>, the examples below consider a joining node that wants to join the security group associated with the application group "group1", but that does not know the name of the security group, the responsible GM and the group-membership resource to access.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<div id="example-in-link-format-1">
<section id="section-4.1.1">
          <h4 id="name-example-in-link-format-3">
<a href="#section-4.1.1" class="section-number selfRef">4.1.1. </a><a href="#name-example-in-link-format-3" class="section-name selfRef">Example in Link Format</a>
          </h4>
<p id="section-4.1.1-1">Request:  Joining node -&gt; RD<a href="#section-4.1.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1.1-2">
<pre>
Req: GET coap://rd.example.com/rd-lookup/res
  ?rt=core.osc.gm&amp;app-gp=group1
</pre><a href="#section-4.1.1-2" class="pilcrow">¶</a>
</div>
<p id="section-4.1.1-3">Response:  RD -&gt; Joining node<a href="#section-4.1.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1.1-4">
<pre>
Res: 2.05 Content
Payload:
&lt;coap://[2001:db8::ab]/ace-group/feedca570000&gt;;ct=65000;
    rt="core.osc.gm";if="ace.group";sec-gp="feedca570000";
    app-gp="group1";cred_fmt="33";sign_enc_alg="10";
    sign_alg="-8";sign_alg_crv="6";alg="10";
    ecdh_alg="-27";ecdh_alg_crv="4"
</pre><a href="#section-4.1.1-4" class="pilcrow">¶</a>
</div>
<p id="section-4.1.1-5">By performing the separate resource lookup below, the joining node can retrieve the link to the ACE Authorization Server associated with the GM, where to send an Authorization Request for joining the corresponding security group (see <span>[<a href="#I-D.ietf-ace-key-groupcomm-oscore" class="xref">I-D.ietf-ace-key-groupcomm-oscore</a>]</span>).<a href="#section-4.1.1-5" class="pilcrow">¶</a></p>
<p id="section-4.1.1-6">Request:  Joining node -&gt; RD<a href="#section-4.1.1-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1.1-7">
<pre>
Req: GET coap://rd.example.com/rd-lookup/res
  ?rel=authorization-server&amp;
   anchor=coap://[2001:db8::ab]/ace-group/feedca570000
</pre><a href="#section-4.1.1-7" class="pilcrow">¶</a>
</div>
<p id="section-4.1.1-8">Response:  RD -&gt; Joining node<a href="#section-4.1.1-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1.1-9">
<pre>
Res: 2.05 Content
Payload:
&lt;coap://as.example.com/token&gt;;rel=authorization-server;
      anchor="coap://[2001:db8::ab]/ace-group/feedca570000"
</pre><a href="#section-4.1.1-9" class="pilcrow">¶</a>
</div>
<p id="section-4.1.1-10">To retrieve the multicast IP address of the CoAP group used by the application group "group1", the joining node performs an endpoint lookup as shown below. The following assumes that the application group "group1" had been previously registered as per Appendix A of <span>[<a href="#I-D.ietf-core-resource-directory" class="xref">I-D.ietf-core-resource-directory</a>]</span>, with ff35:30:2001:db8::23 as multicast IP address of the associated CoAP group.<a href="#section-4.1.1-10" class="pilcrow">¶</a></p>
<p id="section-4.1.1-11">Request:  Joining node -&gt; RD<a href="#section-4.1.1-11" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1.1-12">
<pre>
Req: GET coap://rd.example.com/rd-lookup/ep
  ?et=core.rd-group&amp;ep=group1
</pre><a href="#section-4.1.1-12" class="pilcrow">¶</a>
</div>
<p id="section-4.1.1-13">Response:  RD -&gt; Joining node<a href="#section-4.1.1-13" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1.1-14">
<pre>
Res: 2.05 Content
Payload:
&lt;/rd/501&gt;;ep="group1";et="core.rd-group";
          base="coap://[ff35:30:2001:db8::23]";rt="core.rd-ep"
</pre><a href="#section-4.1.1-14" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="example-in-coral-2">
<section id="section-4.1.2">
          <h4 id="name-example-in-coral-3">
<a href="#section-4.1.2" class="section-number selfRef">4.1.2. </a><a href="#name-example-in-coral-3" class="section-name selfRef">Example in CoRAL</a>
          </h4>
<p id="section-4.1.2-1">Request:  Joining node -&gt; RD<a href="#section-4.1.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1.2-2">
<pre>
Req: GET coap://rd.example.com/rd-lookup/res
  ?rt=core.osc.gm&amp;app-gp=group1
Accept: TBD123456 (application/coral+cbor)
</pre><a href="#section-4.1.2-2" class="pilcrow">¶</a>
</div>
<p id="section-4.1.2-3">Response:  RD -&gt; Joining node<a href="#section-4.1.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1.2-4">
<pre>
Res: 2.05 Content
Content-Format: TBD123456 (application/coral+cbor)

Payload:
#using &lt;http://coreapps.org/core.oscore-discovery#&gt;
#using reef = &lt;http://coreapps.org/reef#&gt;
#using iana = &lt;http://www.iana.org/assignments/relation/&gt;

#base &lt;coap://[2001:db8::ab]/&gt;
reef:rd-item &lt;/ace-group/feedca570000&gt; {
   reef:ct 65000
   reef:rt "core.osc.gm"
   reef:if "ace.group"
   sec-gp "feedca570000"
   app-gp "group1"
   cred_fmt 33
   sign_enc_alg 10
   sign_alg -8
   sign_alg_crv 6
   alg 10
   ecdh_alg -27
   ecdh_alg_crv 4
   iana:authorization-server &lt;coap://as.example.com/token&gt;
}
</pre><a href="#section-4.1.2-4" class="pilcrow">¶</a>
</div>
<p id="section-4.1.2-5">To retrieve the multicast IP address of the CoAP group used by the application group "group1", the joining node performs an endpoint lookup as shown below. The following assumes that the application group "group1" had been previously registered, with ff35:30:2001:db8::23 as multicast IP address of the associated CoAP group.<a href="#section-4.1.2-5" class="pilcrow">¶</a></p>
<p id="section-4.1.2-6">Request:  Joining node -&gt; RD<a href="#section-4.1.2-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1.2-7">
<pre>
Req: GET coap://rd.example.com/rd-lookup/ep
  ?et=core.rd-group&amp;ep=group1
Accept: TBD123456 (application/coral+cbor)
</pre><a href="#section-4.1.2-7" class="pilcrow">¶</a>
</div>
<p id="section-4.1.2-8">Response:  RD -&gt; Joining node<a href="#section-4.1.2-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1.2-9">
<pre>
Res: 2.05 Content
Content-Format: TBD123456 (application/coral+cbor)

Payload:
#using &lt;http://coreapps.org/core.oscore-discovery#&gt;
#using reef = &lt;http://coreapps.org/reef#&gt;

reef:rd-unit &lt;./rd/501&gt; {
   reef:ep "group1"
   reef:et "core.rd-group"
   reef:base &lt;coap://[ff35:30:2001:db8::23]&gt;
   reef:rt "core.rd-ep"
}
</pre><a href="#section-4.1.2-9" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="ssec-group-discovery-ex2">
<section id="section-4.2">
        <h3 id="name-discovery-example-2">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-discovery-example-2" class="section-name selfRef">Discovery Example #2</a>
        </h3>
<p id="section-4.2-1">Consistently with the examples in <a href="#sec-GM-registration" class="xref">Section 2</a> and <a href="#sec-update-addition" class="xref">Section 3</a>, the examples below consider a joining node that wants to join the security group with name "feedca570000", but that does not know the responsible GM, the group-membership resource to access, and the associated application groups.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">The examples also show how the joining node uses CoAP observation <span>[<a href="#RFC7641" class="xref">RFC7641</a>]</span>, in order to be notified of possible changes to the parameters of the group-membership resource. This is also useful to handle the case where the security group of interest has not been created yet, so that the joining node can receive the requested information when it becomes available.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<div id="example-in-link-format-2">
<section id="section-4.2.1">
          <h4 id="name-example-in-link-format-4">
<a href="#section-4.2.1" class="section-number selfRef">4.2.1. </a><a href="#name-example-in-link-format-4" class="section-name selfRef">Example in Link Format</a>
          </h4>
<p id="section-4.2.1-1">Request:  Joining node -&gt; RD<a href="#section-4.2.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.1-2">
<pre>
Req: GET coap://rd.example.com/rd-lookup/res
  ?rt=core.osc.gm&amp;sec-gp=feedca570000
Observe: 0
</pre><a href="#section-4.2.1-2" class="pilcrow">¶</a>
</div>
<p id="section-4.2.1-3">Response:  RD -&gt; Joining node<a href="#section-4.2.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.1-4">
<pre>
Res: 2.05 Content
Observe: 24
Payload:
&lt;coap://[2001:db8::ab]/ace-group/feedca570000&gt;;ct=65000;
    rt="core.osc.gm";if="ace.group";sec-gp="feedca570000";
    app-gp="group1";cred_fmt="33";sign_enc_alg="10";
    sign_alg="-8";sign_alg_crv="6";alg="10";
    ecdh_alg="-27";ecdh_alg_crv="4"
</pre><a href="#section-4.2.1-4" class="pilcrow">¶</a>
</div>
<p id="section-4.2.1-5">Depending on the search criteria, the joining node performing the resource lookup can get large responses. This can happen, for instance, when the lookup request targets all the group-membership resources at a specified GM, or all the group-membership resources of all the registered GMs, as in the example below.<a href="#section-4.2.1-5" class="pilcrow">¶</a></p>
<p id="section-4.2.1-6">Request:  Joining node -&gt; RD<a href="#section-4.2.1-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.1-7">
<pre>
Req: GET coap://rd.example.com/rd-lookup/res?rt=core.osc.gm
</pre><a href="#section-4.2.1-7" class="pilcrow">¶</a>
</div>
<p id="section-4.2.1-8">Response:  RD -&gt; Joining node<a href="#section-4.2.1-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.1-9">
<pre>
Res: 2.05 Content
Payload:
&lt;coap://[2001:db8::ab]/ace-group/feedca570000&gt;;ct=65000;
    rt="core.osc.gm";if="ace.group";sec-gp="feedca570000";
    app-gp="group1";cred_fmt="33";sign_enc_alg="10";
    sign_alg="-8";sign_alg_crv="6";alg="10";ecdh_alg="-27";
    ecdh_alg_crv="4",
&lt;coap://[2001:db8::ab]/ace-group/ech0ech00000&gt;;ct=65000;
    rt="core.osc.gm";if="ace.group";sec-gp="ech0ech00000";
    app-gp="group2";cred_fmt="33";sign_enc_alg="10";
    sign_alg="-8";sign_alg_crv="6";alg="10";ecdh_alg="-27";
    ecdh_alg_crv="4",
&lt;coap://[2001:db8::ab]/ace-group/abcdef120000&gt;;ct=65000;
    rt="core.osc.gm";if="ace.group";sec-gp="abcdef120000";
    app-gp="group3";app-gp="group4";cred_fmt="33";
    sign_enc_alg="10";sign_alg="-8";sign_alg_crv="6";alg="10";
    ecdh_alg="-27";ecdh_alg_crv="4"
</pre><a href="#section-4.2.1-9" class="pilcrow">¶</a>
</div>
<p id="section-4.2.1-10">Therefore, it is RECOMMENDED that a joining node which performs a resource lookup with the CoAP Observe option specifies the value of the parameter 'sec-gp' in its GET request sent to the RD.<a href="#section-4.2.1-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="example-in-coral-3">
<section id="section-4.2.2">
          <h4 id="name-example-in-coral-4">
<a href="#section-4.2.2" class="section-number selfRef">4.2.2. </a><a href="#name-example-in-coral-4" class="section-name selfRef">Example in CoRAL</a>
          </h4>
<p id="section-4.2.2-1">Request:  Joining node -&gt; RD<a href="#section-4.2.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.2-2">
<pre>
Req: GET coap://rd.example.com/rd-lookup/res
  ?rt=core.osc.gm&amp;sec-gp=feedca570000
Accept: TBD123456 (application/coral+cbor)
Observe: 0
</pre><a href="#section-4.2.2-2" class="pilcrow">¶</a>
</div>
<p id="section-4.2.2-3">Response:  RD -&gt; Joining node<a href="#section-4.2.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.2-4">
<pre>
Res: 2.05 Content
Observe: 24
Content-Format: TBD123456 (application/coral+cbor)

Payload:
#using &lt;http://coreapps.org/core.oscore-discovery#&gt;
#using reef = &lt;http://coreapps.org/reef#&gt;
#using iana = &lt;http://www.iana.org/assignments/relation/&gt;

#base &lt;coap://[2001:db8::ab]/&gt;
reef:rd-item &lt;/ace-group/feedca570000&gt; {
   reef:ct 65000
   reef:rt "core.osc.gm"
   reef:if "ace.group"
   sec-gp "feedca570000"
   app-gp "group1"
   cred_fmt 33
   sign_enc_alg 10
   sign_alg -8
   sign_alg_crv 6
   alg 10
   ecdh_alg -27
   ecdh_alg_crv 4
   iana:authorization-server &lt;coap://as.example.com/token&gt;
}
</pre><a href="#section-4.2.2-4" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="use-case-example">
<section id="section-5">
      <h2 id="name-use-case-example-with-full-">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-use-case-example-with-full-" class="section-name selfRef">Use Case Example With Full Discovery</a>
      </h2>
<p id="section-5-1">In this section, the discovery of security groups is described to support the installation process of a lighting installation in an office building. The described process is a simplified version of one of many processes.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">The process described in this section is intended as an example and does not have any particular ambition to serve as recommendation or best practice to adopt. That is, it shows a possible workflow involving a Commissioning Tool (CT) used in a certain way, while it is not meant to prescribe how the workflow should necessarily be.<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">Assume the existence of four luminaires that are members of two application groups. In the first application group, the four luminaires receive presence messages and light intensity messages from sensors or their proxy. In the second application group, the four luminaires and several other pieces of equipment receive building state schedules.<a href="#section-5-3" class="pilcrow">¶</a></p>
<p id="section-5-4">Each of the two application groups is associated with a different security group and to a different CoAP group with its own dedicated multicast IP address.<a href="#section-5-4" class="pilcrow">¶</a></p>
<p id="section-5-5">The Fairhair Alliance describes how a new device is accepted and commissioned in the network <span>[<a href="#Fairhair" class="xref">Fairhair</a>]</span>, by means of its certificate stored during the manufacturing process. When commissioning the new device in the installation network, the new device gets a new identity defined by a newly allocated certificate, following the BRSKI specification.<a href="#section-5-5" class="pilcrow">¶</a></p>
<p id="section-5-6"><span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-resource-directory-28#section-7.3" class="relref">Section 7.3</a> of [<a href="#I-D.ietf-core-resource-directory" class="xref">I-D.ietf-core-resource-directory</a>]</span> describes how the CT assigns an endpoint name based on the CN field, (CN=ACME) and the serial number of the certificate (serial number = 123x, with 3 &lt; x &lt; 8). Corresponding ep-names ACME-1234, ACME-1235, ACME-1236 and ACME-1237 are also assumed.<a href="#section-5-6" class="pilcrow">¶</a></p>
<p id="section-5-7">It is common practice that locations in the building are specified according to a coordinate system. After the acceptance of the luminaires into the installation network, the coordinate of each device is communicated to the CT. This can be done manually or automatically.<a href="#section-5-7" class="pilcrow">¶</a></p>
<p id="section-5-8">The mapping between location and ep-name is calculated by the CT. For instance, on the basis of grouping criteria, the CT assigns: i) application group "grp_R2-4-015" to the four luminaires; and ii) application group "grp_schedule" to all schedule requiring devices. Also, the device with ep name ACME-123x has been assigned IP address: [2001:db8:4::x]. The RD is assigned IP address: [2001:db8:4:ff]. The used multicast addresses are: [ff05::5:1] and [ff05::5:2].<a href="#section-5-8" class="pilcrow">¶</a></p>
<p id="section-5-9">The following assumes that each device is pre-configured with the name of the two application groups it belongs to. Additional mechanisms can be defined in the RD, for supporting devices to discover the application groups they belong to.<a href="#section-5-9" class="pilcrow">¶</a></p>
<p id="section-5-10"><a href="#use-case-example-coral" class="xref">Appendix A</a> provides this same use case example in CoRAL.<a href="#section-5-10" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5-11">
<pre>
*** *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** ***
</pre><a href="#section-5-11" class="pilcrow">¶</a>
</div>
<p id="section-5-12">The CT defines the application group "grp_R2-4-015", with resource /light and base address [ff05::5:1], as follows.<a href="#section-5-12" class="pilcrow">¶</a></p>
<p id="section-5-13">Request:  CT -&gt; RD<a href="#section-5-13" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5-14">
<pre>
Req: POST coap://[2001:db8:4::ff]/rd
  ?ep=grp_R2-4-015&amp;et=core.rd-group&amp;base=coap://[ff05::5:1]
Content-Format: 40
Payload:
&lt;/light&gt;;rt="oic.d.light"
</pre><a href="#section-5-14" class="pilcrow">¶</a>
</div>
<p id="section-5-15">Response:  RD -&gt; CT<a href="#section-5-15" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5-16">
<pre>
Res: 2.01 Created
Location-Path: /rd/501
</pre><a href="#section-5-16" class="pilcrow">¶</a>
</div>
<p id="section-5-17">Also, the CT defines a second application group "grp_schedule", with resource /schedule and base address [ff05::5:2], as follows.<a href="#section-5-17" class="pilcrow">¶</a></p>
<p id="section-5-18">Request:  CT -&gt; RD<a href="#section-5-18" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5-19">
<pre>
Req: POST coap://[2001:db8:4::ff]/rd
  ?ep=grp_schedule&amp;et=core.rd-group&amp;base=coap://[ff05::5:2]
Content-Format: 40
Payload:
&lt;/schedule&gt;;rt="oic.r.time.period"
</pre><a href="#section-5-19" class="pilcrow">¶</a>
</div>
<p id="section-5-20">Response:  RD -&gt; CT<a href="#section-5-20" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5-21">
<pre>
Res: 2.01 Created
Location-Path: /rd/502
</pre><a href="#section-5-21" class="pilcrow">¶</a>
</div>
<div class="alignLeft art-text artwork" id="section-5-22">
<pre>
*** *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** ***
</pre><a href="#section-5-22" class="pilcrow">¶</a>
</div>
<p id="section-5-23">Finally, the CT defines the corresponding security groups. In particular, assuming a Group Manager responsible for both security groups and with address [2001:db8::ab], the CT specifies:<a href="#section-5-23" class="pilcrow">¶</a></p>
<p id="section-5-24">Request:  CT -&gt; RD<a href="#section-5-24" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5-25">
<pre>
Req: POST coap://[2001:db8:4::ff]/rd
  ?ep=gm1&amp;base=coap://[2001:db8::ab]
Content-Format: 40
Payload:
&lt;/ace-group/feedca570000&gt;;ct=65000;rt="core.osc.gm";if="ace.group";
                          sec-gp="feedca570000";
                          app-gp="grp_R2-4-015",
&lt;/ace-group/feedsc590000&gt;;ct=65000;rt="core.osc.gm";if="ace.group";
                          sec-gp="feedsc590000";
                          app-gp="grp_schedule"
</pre><a href="#section-5-25" class="pilcrow">¶</a>
</div>
<p id="section-5-26">Response:  RD -&gt; CT<a href="#section-5-26" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5-27">
<pre>
Res: 2.01 Created
Location-Path: /rd/4521
</pre><a href="#section-5-27" class="pilcrow">¶</a>
</div>
<div class="alignLeft art-text artwork" id="section-5-28">
<pre>
*** *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** ***
</pre><a href="#section-5-28" class="pilcrow">¶</a>
</div>
<p id="section-5-29">The device with IP address [2001:db8:4::x] can retrieve the multicast IP address of the CoAP group used by the application group "grp_R2-4-015", by performing an endpoint lookup as shown below.<a href="#section-5-29" class="pilcrow">¶</a></p>
<p id="section-5-30">Request:  Joining node -&gt; RD<a href="#section-5-30" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5-31">
<pre>
Req: GET coap://[2001:db8:4::ff]/rd-lookup/ep
  ?et=core.rd-group&amp;ep=grp_R2-4-015
</pre><a href="#section-5-31" class="pilcrow">¶</a>
</div>
<p id="section-5-32">Response:  RD -&gt; Joining node<a href="#section-5-32" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5-33">
<pre>
Res: 2.05 Content
Content-Format: 40
Payload:
&lt;/rd/501&gt;;ep="grp_R2-4-015";et="core.rd-group";
          base="coap://[ff05::5:1]";rt="core.rd-ep"
</pre><a href="#section-5-33" class="pilcrow">¶</a>
</div>
<p id="section-5-34">Similarly, to retrieve the multicast IP address of the CoAP group used by the application group "grp_schedule", the device performs an endpoint lookup as shown below.<a href="#section-5-34" class="pilcrow">¶</a></p>
<p id="section-5-35">Request:  Joining node -&gt; RD<a href="#section-5-35" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5-36">
<pre>
Req: GET coap://[2001:db8:4::ff]/rd-lookup/ep
  ?et=core.rd-group&amp;ep=grp_schedule
</pre><a href="#section-5-36" class="pilcrow">¶</a>
</div>
<p id="section-5-37">Response:  RD -&gt; Joining node<a href="#section-5-37" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5-38">
<pre>
Res: 2.05 Content
Content-Format: 40
Payload:
&lt;/rd/502&gt;;ep="grp_schedule";et="core.rd-group";
          base="coap://[ff05::5:2]";rt="core.rd-ep"
</pre><a href="#section-5-38" class="pilcrow">¶</a>
</div>
<div class="alignLeft art-text artwork" id="section-5-39">
<pre>
*** *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** ***
</pre><a href="#section-5-39" class="pilcrow">¶</a>
</div>
<p id="section-5-40">Consequently, the device learns the security groups it has to join. In particular, it does the following for app-gp="grp_R2-4-015".<a href="#section-5-40" class="pilcrow">¶</a></p>
<p id="section-5-41">Request:  Joining node -&gt; RD<a href="#section-5-41" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5-42">
<pre>
Req: GET coap://[2001:db8:4::ff]/rd-lookup/res
  ?rt=core.osc.gm&amp;app-gp=grp_R2-4-015
</pre><a href="#section-5-42" class="pilcrow">¶</a>
</div>
<p id="section-5-43">Response:  RD -&gt; Joining Node<a href="#section-5-43" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5-44">
<pre>
Res: 2.05 Content
Content-Format: 40
Payload:
&lt;coap://[2001:db8::ab]/ace-group/feedca570000&gt;;ct=65000;
    rt="core.osc.gm";if="ace.group";sec-gp="feedca570000";
    app-gp="grp_R2-4-015"
</pre><a href="#section-5-44" class="pilcrow">¶</a>
</div>
<p id="section-5-45">Similarly, the device does the following for app-gp="grp_schedule".<a href="#section-5-45" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5-46">
<pre>
Req: GET coap://[2001:db8:4::ff]/rd-lookup/res
  ?rt=core.osc.gm&amp;app-gp=grp_schedule
</pre><a href="#section-5-46" class="pilcrow">¶</a>
</div>
<p id="section-5-47">Response:  RD -&gt; Joining Node<a href="#section-5-47" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5-48">
<pre>
Res: 2.05 Content
Content-Format: 40
Payload:
&lt;coap://[2001:db8::ab]/ace-group/feedsc590000&gt;;ct=65000;
    rt="core.osc.gm";if="ace.group";sec-gp="feedsc590000";
    app-gp="grp_schedule"
</pre><a href="#section-5-48" class="pilcrow">¶</a>
</div>
<div class="alignLeft art-text artwork" id="section-5-49">
<pre>
*** *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** ***
</pre><a href="#section-5-49" class="pilcrow">¶</a>
</div>
<p id="section-5-50">After this last discovery step, the device can ask permission to join the security groups, and effectively join them through the Group Manager, e.g., according to <span>[<a href="#I-D.ietf-ace-key-groupcomm-oscore" class="xref">I-D.ietf-ace-key-groupcomm-oscore</a>]</span>.<a href="#section-5-50" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-security-considerations">
<section id="section-6">
      <h2 id="name-security-considerations-9">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-security-considerations-9" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-6-1">The security considerations as described in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-resource-directory-28#section-8" class="relref">Section 8</a> of [<a href="#I-D.ietf-core-resource-directory" class="xref">I-D.ietf-core-resource-directory</a>]</span> apply here as well.<a href="#section-6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana">
<section id="section-7">
      <h2 id="name-iana-considerations-9">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-iana-considerations-9" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-7-1">This document has no actions for IANA.<a href="#section-7-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-8">
      <h2 id="name-references-7">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-references-7" class="section-name selfRef">References</a>
      </h2>
<section id="section-8.1">
        <h3 id="name-normative-references-8">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-normative-references-8" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="COSE.Algorithms">[COSE.Algorithms]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"COSE Algorithms"</span>, <span>&lt;<a href="https://www.iana.org/assignments/cose/cose.xhtml#algorithms">https://www.iana.org/assignments/cose/cose.xhtml#algorithms</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="COSE.Elliptic.Curves">[COSE.Elliptic.Curves]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"COSE Elliptic Curves"</span>, <span>&lt;<a href="https://www.iana.org/assignments/cose/cose.xhtml#elliptic-curves">https://www.iana.org/assignments/cose/cose.xhtml#elliptic-curves</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="COSE.Header.Parameters">[COSE.Header.Parameters]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"COSE Header Parameters"</span>, <span>&lt;<a href="https://www.iana.org/assignments/cose/cose.xhtml#header-parameters">https://www.iana.org/assignments/cose/cose.xhtml#header-parameters</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="COSE.Key.Types">[COSE.Key.Types]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"COSE Key Types"</span>, <span>&lt;<a href="https://www.iana.org/assignments/cose/cose.xhtml#key-type">https://www.iana.org/assignments/cose/cose.xhtml#key-type</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-core-coral">[I-D.ietf-core-coral]</dt>
        <dd>
<span class="refAuthor">Amsüss, C.</span> and <span class="refAuthor">T. Fossati</span>, <span class="refTitle">"The Constrained RESTful Application Language (CoRAL)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-core-coral-04</span>, <time datetime="2021-10-25" class="refDate">25 October 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-core-coral-04.txt">https://www.ietf.org/archive/id/draft-ietf-core-coral-04.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-core-groupcomm-bis">[I-D.ietf-core-groupcomm-bis]</dt>
        <dd>
<span class="refAuthor">Dijk, E.</span>, <span class="refAuthor">Wang, C.</span>, and <span class="refAuthor">M. Tiloca</span>, <span class="refTitle">"Group Communication for the Constrained Application Protocol (CoAP)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-core-groupcomm-bis-06</span>, <time datetime="2022-03-07" class="refDate">7 March 2022</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-core-groupcomm-bis-06.txt">https://www.ietf.org/archive/id/draft-ietf-core-groupcomm-bis-06.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-core-oscore-groupcomm">[I-D.ietf-core-oscore-groupcomm]</dt>
        <dd>
<span class="refAuthor">Tiloca, M.</span>, <span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Palombini, F.</span>, <span class="refAuthor">Mattsson, J. P.</span>, and <span class="refAuthor">J. Park</span>, <span class="refTitle">"Group OSCORE - Secure Group Communication for CoAP"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-core-oscore-groupcomm-14</span>, <time datetime="2022-03-07" class="refDate">7 March 2022</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-core-oscore-groupcomm-14.txt">https://www.ietf.org/archive/id/draft-ietf-core-oscore-groupcomm-14.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-core-resource-directory">[I-D.ietf-core-resource-directory]</dt>
        <dd>
<span class="refAuthor">Amsüss, C.</span>, <span class="refAuthor">Shelby, Z.</span>, <span class="refAuthor">Koster, M.</span>, <span class="refAuthor">Bormann, C.</span>, and <span class="refAuthor">P. V. D. Stok</span>, <span class="refTitle">"CoRE Resource Directory"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-core-resource-directory-28</span>, <time datetime="2021-03-07" class="refDate">7 March 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-core-resource-directory-28.txt">https://www.ietf.org/archive/id/draft-ietf-core-resource-directory-28.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-cose-rfc8152bis-algs">[I-D.ietf-cose-rfc8152bis-algs]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Initial Algorithms"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-cose-rfc8152bis-algs-12</span>, <time datetime="2020-09-24" class="refDate">24 September 2020</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-cose-rfc8152bis-algs-12.txt">https://www.ietf.org/archive/id/draft-ietf-cose-rfc8152bis-algs-12.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-cose-rfc8152bis-struct">[I-D.ietf-cose-rfc8152bis-struct]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Structures and Process"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-cose-rfc8152bis-struct-15</span>, <time datetime="2021-02-01" class="refDate">1 February 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-cose-rfc8152bis-struct-15.txt">https://www.ietf.org/archive/id/draft-ietf-cose-rfc8152bis-struct-15.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6690">[RFC6690]</dt>
        <dd>
<span class="refAuthor">Shelby, Z.</span>, <span class="refTitle">"Constrained RESTful Environments (CoRE) Link Format"</span>, <span class="seriesInfo">RFC 6690</span>, <span class="seriesInfo">DOI 10.17487/RFC6690</span>, <time datetime="2012-08" class="refDate">August 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6690">https://www.rfc-editor.org/info/rfc6690</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7252">[RFC7252]</dt>
        <dd>
<span class="refAuthor">Shelby, Z.</span>, <span class="refAuthor">Hartke, K.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"The Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 7252</span>, <span class="seriesInfo">DOI 10.17487/RFC7252</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7252">https://www.rfc-editor.org/info/rfc7252</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-8.2">
        <h3 id="name-informative-references-8">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-informative-references-8" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="Fairhair">[Fairhair]</dt>
        <dd>
<span class="refAuthor">FairHair Alliance</span>, <span class="refTitle">"Security Architecture for the Internet of Things (IoT) in Commercial Buildings"</span>, <span class="seriesInfo">White Paper, ed. Piotr Polak </span>, <time datetime="2018-03" class="refDate">March 2018</time>, <span>&lt;<a href="https://openconnectivity.org/wp-content/uploads/2019/11/fairhair_security_wp_march-2018.pdf">https://openconnectivity.org/wp-content/uploads/2019/11/fairhair_security_wp_march-2018.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.amsuess-core-cachable-oscore">[I-D.amsuess-core-cachable-oscore]</dt>
        <dd>
<span class="refAuthor">Amsüss, C.</span> and <span class="refAuthor">M. Tiloca</span>, <span class="refTitle">"Cacheable OSCORE"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-amsuess-core-cachable-oscore-04</span>, <time datetime="2022-03-06" class="refDate">6 March 2022</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-amsuess-core-cachable-oscore-04.txt">https://www.ietf.org/archive/id/draft-amsuess-core-cachable-oscore-04.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.hartke-t2trg-coral-reef">[I-D.hartke-t2trg-coral-reef]</dt>
        <dd>
<span class="refAuthor">Hartke, K.</span>, <span class="refTitle">"Resource Discovery in Constrained RESTful Environments (CoRE) using the Constrained RESTful Application Language (CoRAL)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-hartke-t2trg-coral-reef-04</span>, <time datetime="2020-05-09" class="refDate">9 May 2020</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-hartke-t2trg-coral-reef-04.txt">https://www.ietf.org/archive/id/draft-hartke-t2trg-coral-reef-04.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-ace-key-groupcomm">[I-D.ietf-ace-key-groupcomm]</dt>
        <dd>
<span class="refAuthor">Palombini, F.</span> and <span class="refAuthor">M. Tiloca</span>, <span class="refTitle">"Key Provisioning for Group Communication using ACE"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-ace-key-groupcomm-15</span>, <time datetime="2021-12-23" class="refDate">23 December 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-ace-key-groupcomm-15.txt">https://www.ietf.org/archive/id/draft-ietf-ace-key-groupcomm-15.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-ace-key-groupcomm-oscore">[I-D.ietf-ace-key-groupcomm-oscore]</dt>
        <dd>
<span class="refAuthor">Tiloca, M.</span>, <span class="refAuthor">Park, J.</span>, and <span class="refAuthor">F. Palombini</span>, <span class="refTitle">"Key Management for OSCORE Groups in ACE"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-ace-key-groupcomm-oscore-13</span>, <time datetime="2022-03-07" class="refDate">7 March 2022</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-ace-key-groupcomm-oscore-13.txt">https://www.ietf.org/archive/id/draft-ietf-ace-key-groupcomm-oscore-13.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-ace-oauth-authz">[I-D.ietf-ace-oauth-authz]</dt>
        <dd>
<span class="refAuthor">Seitz, L.</span>, <span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Wahlstroem, E.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Authentication and Authorization for Constrained Environments (ACE) using the OAuth 2.0 Framework (ACE-OAuth)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-ace-oauth-authz-46</span>, <time datetime="2021-11-08" class="refDate">8 November 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-ace-oauth-authz-46.txt">https://www.ietf.org/archive/id/draft-ietf-ace-oauth-authz-46.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-ace-oscore-gm-admin">[I-D.ietf-ace-oscore-gm-admin]</dt>
        <dd>
<span class="refAuthor">Tiloca, M.</span>, <span class="refAuthor">Höglund, R.</span>, <span class="refAuthor">Stok, P. V. D.</span>, and <span class="refAuthor">F. Palombini</span>, <span class="refTitle">"Admin Interface for the OSCORE Group Manager"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-ace-oscore-gm-admin-05</span>, <time datetime="2022-03-07" class="refDate">7 March 2022</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-ace-oscore-gm-admin-05.txt">https://www.ietf.org/archive/id/draft-ietf-ace-oscore-gm-admin-05.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-cose-cbor-encoded-cert">[I-D.ietf-cose-cbor-encoded-cert]</dt>
        <dd>
<span class="refAuthor">Mattsson, J. P.</span>, <span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Raza, S.</span>, <span class="refAuthor">Höglund, J.</span>, and <span class="refAuthor">M. Furuhed</span>, <span class="refTitle">"CBOR Encoded X.509 Certificates (C509 Certificates)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-cose-cbor-encoded-cert-03</span>, <time datetime="2022-01-10" class="refDate">10 January 2022</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-cose-cbor-encoded-cert-03.txt">https://www.ietf.org/archive/id/draft-ietf-cose-cbor-encoded-cert-03.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7228">[RFC7228]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span>, <span class="refAuthor">Ersue, M.</span>, and <span class="refAuthor">A. Keranen</span>, <span class="refTitle">"Terminology for Constrained-Node Networks"</span>, <span class="seriesInfo">RFC 7228</span>, <span class="seriesInfo">DOI 10.17487/RFC7228</span>, <time datetime="2014-05" class="refDate">May 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7228">https://www.rfc-editor.org/info/rfc7228</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7641">[RFC7641]</dt>
        <dd>
<span class="refAuthor">Hartke, K.</span>, <span class="refTitle">"Observing Resources in the Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 7641</span>, <span class="seriesInfo">DOI 10.17487/RFC7641</span>, <time datetime="2015-09" class="refDate">September 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7641">https://www.rfc-editor.org/info/rfc7641</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7925">[RFC7925]</dt>
        <dd>
<span class="refAuthor">Tschofenig, H., Ed.</span> and <span class="refAuthor">T. Fossati</span>, <span class="refTitle">"Transport Layer Security (TLS) / Datagram Transport Layer Security (DTLS) Profiles for the Internet of Things"</span>, <span class="seriesInfo">RFC 7925</span>, <span class="seriesInfo">DOI 10.17487/RFC7925</span>, <time datetime="2016-07" class="refDate">July 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7925">https://www.rfc-editor.org/info/rfc7925</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8132">[RFC8132]</dt>
        <dd>
<span class="refAuthor">van der Stok, P.</span>, <span class="refAuthor">Bormann, C.</span>, and <span class="refAuthor">A. Sehgal</span>, <span class="refTitle">"PATCH and FETCH Methods for the Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 8132</span>, <span class="seriesInfo">DOI 10.17487/RFC8132</span>, <time datetime="2017-04" class="refDate">April 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8132">https://www.rfc-editor.org/info/rfc8132</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8392">[RFC8392]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Wahlstroem, E.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"CBOR Web Token (CWT)"</span>, <span class="seriesInfo">RFC 8392</span>, <span class="seriesInfo">DOI 10.17487/RFC8392</span>, <time datetime="2018-05" class="refDate">May 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8392">https://www.rfc-editor.org/info/rfc8392</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8613">[RFC8613]</dt>
        <dd>
<span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Mattsson, J.</span>, <span class="refAuthor">Palombini, F.</span>, and <span class="refAuthor">L. Seitz</span>, <span class="refTitle">"Object Security for Constrained RESTful Environments (OSCORE)"</span>, <span class="seriesInfo">RFC 8613</span>, <span class="seriesInfo">DOI 10.17487/RFC8613</span>, <time datetime="2019-07" class="refDate">July 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8613">https://www.rfc-editor.org/info/rfc8613</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8995">[RFC8995]</dt>
      <dd>
<span class="refAuthor">Pritikin, M.</span>, <span class="refAuthor">Richardson, M.</span>, <span class="refAuthor">Eckert, T.</span>, <span class="refAuthor">Behringer, M.</span>, and <span class="refAuthor">K. Watsen</span>, <span class="refTitle">"Bootstrapping Remote Secure Key Infrastructure (BRSKI)"</span>, <span class="seriesInfo">RFC 8995</span>, <span class="seriesInfo">DOI 10.17487/RFC8995</span>, <time datetime="2021-05" class="refDate">May 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8995">https://www.rfc-editor.org/info/rfc8995</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="use-case-example-coral">
<section id="appendix-A">
      <h2 id="name-use-case-example-with-full-d">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-use-case-example-with-full-d" class="section-name selfRef">Use Case Example With Full Discovery (CoRAL)</a>
      </h2>
<p id="appendix-A-1">This section provides the same use case example of <a href="#use-case-example" class="xref">Section 5</a>, but specified in CoRAL <span>[<a href="#I-D.ietf-core-coral" class="xref">I-D.ietf-core-coral</a>]</span>.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A-2">
<pre>
*** *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** ***
</pre><a href="#appendix-A-2" class="pilcrow">¶</a>
</div>
<p id="appendix-A-3">The CT defines the application group "grp_R2-4-015", with resource /light and base address [ff05::5:1], as follows.<a href="#appendix-A-3" class="pilcrow">¶</a></p>
<p id="appendix-A-4">Request:  CT -&gt; RD<a href="#appendix-A-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A-5">
<pre>
Req: POST coap://[2001:db8:4::ff]/rd
Content-Format: TBD123456 (application/coral+cbor)

Payload:
#using reef = &lt;http://coreapps.org/reef#&gt;

#base &lt;coap://[ff05::5:1]/&gt;
reef:ep "grp_R2-4-015"
reef:et "core.rd-group"
reef:rd-item &lt;/light&gt; {
   reef:rt "oic.d.light"
}
</pre><a href="#appendix-A-5" class="pilcrow">¶</a>
</div>
<p id="appendix-A-6">Response:  RD -&gt; CT<a href="#appendix-A-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A-7">
<pre>
Res: 2.01 Created
Location-Path: /rd/501
</pre><a href="#appendix-A-7" class="pilcrow">¶</a>
</div>
<p id="appendix-A-8">Also, the CT defines a second application group "grp_schedule", with resource /schedule and base address [ff05::5:2], as follows.<a href="#appendix-A-8" class="pilcrow">¶</a></p>
<p id="appendix-A-9">Request:  CT -&gt; RD<a href="#appendix-A-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A-10">
<pre>
Req: POST coap://[2001:db8:4::ff]/rd?ep=grp_schedule&amp;et=core.rd-group
Content-Format: TBD123456 (application/coral+cbor)

Payload:
#using reef = &lt;http://coreapps.org/reef#&gt;

#base &lt;coap://[ff05::5:2]/&gt;
reef:rd-item &lt;/schedule&gt; {
   reef:rt "oic.r.time.period"
}
</pre><a href="#appendix-A-10" class="pilcrow">¶</a>
</div>
<p id="appendix-A-11">Response:  RD -&gt; CT<a href="#appendix-A-11" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A-12">
<pre>
Res: 2.01 Created
Location-Path: /rd/502
</pre><a href="#appendix-A-12" class="pilcrow">¶</a>
</div>
<div class="alignLeft art-text artwork" id="appendix-A-13">
<pre>
*** *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** ***
</pre><a href="#appendix-A-13" class="pilcrow">¶</a>
</div>
<p id="appendix-A-14">Finally, the CT defines the corresponding security groups. In particular, assuming a Group Manager responsible for both security groups and with address [2001:db8::ab], the CT specifies:<a href="#appendix-A-14" class="pilcrow">¶</a></p>
<p id="appendix-A-15">Request:  CT -&gt; RD<a href="#appendix-A-15" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A-16">
<pre>
Req: POST coap://[2001:db8:4::ff]/rd?ep=gm1
Content-Format: TBD123456 (application/coral+cbor)

Payload:
#using &lt;http://coreapps.org/core.oscore-discovery#&gt;
#using reef = &lt;http://coreapps.org/reef#&gt;

#base &lt;coap://[2001:db8::ab]/&gt;
reef:rd-item &lt;/ace-group/feedca570000&gt; {
   reef:ct 65000
   reef:ct 41
   reef:rt "core.osc.gm"
   reef:if "ace.group"
   sec-gp "feedca570000"
   app-gp "grp_R2-4-015"
}
reef:rd-item &lt;/ace-group/feedsc590000&gt; {
   reef:ct 65000
   reef:ct 41
   reef:rt "core.osc.gm"
   reef:if "ace.group"
   sec-gp "feedsc590000"
   app-gp "grp_schedule"
}
</pre><a href="#appendix-A-16" class="pilcrow">¶</a>
</div>
<p id="appendix-A-17">Response:  RD -&gt; CT<a href="#appendix-A-17" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A-18">
<pre>
Res: 2.01 Created
Location-Path: /rd/4521
</pre><a href="#appendix-A-18" class="pilcrow">¶</a>
</div>
<div class="alignLeft art-text artwork" id="appendix-A-19">
<pre>
*** *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** ***
</pre><a href="#appendix-A-19" class="pilcrow">¶</a>
</div>
<p id="appendix-A-20">The device with IP address [2001:db8:4::x] can retrieve the multicast IP address of the CoAP group used by the application group "grp_R2-4-015", by performing an endpoint lookup as shown below.<a href="#appendix-A-20" class="pilcrow">¶</a></p>
<p id="appendix-A-21">Request:  Joining node -&gt; RD<a href="#appendix-A-21" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A-22">
<pre>
Req: GET coap://[2001:db8:4::ff]/rd-lookup/ep
  ?et=core.rd-group&amp;ep=grp_R2-4-015
</pre><a href="#appendix-A-22" class="pilcrow">¶</a>
</div>
<p id="appendix-A-23">Response:  RD -&gt; Joining node<a href="#appendix-A-23" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A-24">
<pre>
Res: 2.05 Content
Content-Format: TBD123456 (application/coral+cbor)

Payload:
#using reef = &lt;http://coreapps.org/reef#&gt;

#base &lt;coap://[2001:db8:4::ff]/rd/&gt;
reef:rd-unit &lt;501&gt; {
   reef:ep "grp_R2-4-015"
   reef:et "core.rd-group"
   reef:base &lt;coap://[ff05::5:1]/&gt;
   reef:rt "core.rd-ep"
}
</pre><a href="#appendix-A-24" class="pilcrow">¶</a>
</div>
<p id="appendix-A-25">Similarly, to retrieve the multicast IP address of the CoAP group used by the application group "grp_schedule", the device performs an endpoint lookup as shown below.<a href="#appendix-A-25" class="pilcrow">¶</a></p>
<p id="appendix-A-26">Request:  Joining node -&gt; RD<a href="#appendix-A-26" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A-27">
<pre>
Req: GET coap://[2001:db8:4::ff]/rd-lookup/ep
  ?et=core.rd-group&amp;ep=grp_schedule
</pre><a href="#appendix-A-27" class="pilcrow">¶</a>
</div>
<p id="appendix-A-28">Response:  RD -&gt; Joining node<a href="#appendix-A-28" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A-29">
<pre>
Res: 2.05 Content
Content-Format: TBD123456 (application/coral+cbor)

Payload:
#using reef = &lt;http://coreapps.org/reef#&gt;

#base &lt;coap://[2001:db8:4::ff]/rd/&gt;
reef:rd-unit &lt;502&gt; {
   reef:ep "grp_schedule"
   reef:et "core.rd-group"
   reef:base &lt;coap://[ff05::5:2]/&gt;
   reef:rt "core.rd-ep"
}
</pre><a href="#appendix-A-29" class="pilcrow">¶</a>
</div>
<div class="alignLeft art-text artwork" id="appendix-A-30">
<pre>
*** *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** ***
</pre><a href="#appendix-A-30" class="pilcrow">¶</a>
</div>
<p id="appendix-A-31">Consequently, the device learns the security groups it has to join. In particular, it does the following for app-gp="grp_R2-4-015".<a href="#appendix-A-31" class="pilcrow">¶</a></p>
<p id="appendix-A-32">Request:  Joining node -&gt; RD<a href="#appendix-A-32" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A-33">
<pre>
Req: GET coap://[2001:db8:4::ff]/rd-lookup/res
  ?rt=core.osc.gm&amp;app-gp=grp_R2-4-015
</pre><a href="#appendix-A-33" class="pilcrow">¶</a>
</div>
<p id="appendix-A-34">Response:  RD -&gt; Joining Node<a href="#appendix-A-34" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A-35">
<pre>
Res: 2.05 Content
Content-Format: TBD123456 (application/coral+cbor)

Payload:
#using &lt;http://coreapps.org/core.oscore-discovery#&gt;
#using reef = &lt;http://coreapps.org/reef#&gt;

#base &lt;coap://[2001:db8::ab]/&gt;
reef:rd-item &lt;/ace-group/feedca570000&gt; {
   reef:ct 65000
   reef:rt "core.osc.gm"
   reef:if "ace.group"
   sec-gp "feedca570000"
   app-gp "grp_R2-4-015"
}
</pre><a href="#appendix-A-35" class="pilcrow">¶</a>
</div>
<p id="appendix-A-36">Similarly, the device does the following for app-gp="grp_schedule".<a href="#appendix-A-36" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A-37">
<pre>
Req: GET coap://[2001:db8:4::ff]/rd-lookup/res
  ?rt=core.osc.gm&amp;app-gp=grp_schedule
</pre><a href="#appendix-A-37" class="pilcrow">¶</a>
</div>
<p id="appendix-A-38">Response:  RD -&gt; Joining Node<a href="#appendix-A-38" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A-39">
<pre>
Res: 2.05 Content
Content-Format: TBD123456 (application/coral+cbor)

Payload:
#using &lt;http://coreapps.org/core.oscore-discovery#&gt;
#using reef = &lt;http://coreapps.org/reef#&gt;

#base &lt;coap://[2001:db8::ab]/&gt;
reef:rd-item &lt;/ace-group/feedsc590000&gt; {
   reef:ct 65000
   reef:rt "core.osc.gm"
   reef:if "ace.group"
   sec-gp "feedsc590000"
   app-gp "grp_schedule"
}
</pre><a href="#appendix-A-39" class="pilcrow">¶</a>
</div>
<div class="alignLeft art-text artwork" id="appendix-A-40">
<pre>
*** *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** ***
</pre><a href="#appendix-A-40" class="pilcrow">¶</a>
</div>
<p id="appendix-A-41">After this last discovery step, the device can ask permission to join the security groups, and effectively join them through the Group Manager, e.g., according to <span>[<a href="#I-D.ietf-ace-key-groupcomm-oscore" class="xref">I-D.ietf-ace-key-groupcomm-oscore</a>]</span>.<a href="#appendix-A-41" class="pilcrow">¶</a></p>
</section>
</div>
<div id="acknowldegment">
<section id="appendix-B">
      <h2 id="name-acknowledgments-3">
<a href="#name-acknowledgments-3" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-B-1">The authors sincerely thank Carsten Bormann, Klaus Hartke, Jaime Jimenez, Francesca Palombini, Dave Robin and Jim Schaad for their comments and feedback.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<p id="appendix-B-2">The work on this document has been partly supported by VINNOVA and the Celtic-Next project CRITISEC; by the H2020 project SIFIS-Home (Grant agreement 952652); and by the EIT-Digital High Impact Initiative ACTIVE.<a href="#appendix-B-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-addresses-9">
<a href="#name-authors-addresses-9" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Marco Tiloca</span></div>
<div dir="auto" class="left"><span class="org">RISE AB</span></div>
<div dir="auto" class="left"><span class="street-address">Isafjordsgatan 22</span></div>
<div dir="auto" class="left">SE-<span class="postal-code">16440 Stockholm</span> <span class="locality">Kista</span>
</div>
<div dir="auto" class="left"><span class="country-name">Sweden</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:marco.tiloca@ri.se" class="email">marco.tiloca@ri.se</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Christian Amsuess</span></div>
<div dir="auto" class="left"><span class="street-address">Hollandstr. 12/4</span></div>
<div dir="auto" class="left">
<span class="postal-code">1020</span> <span class="locality">Vienna</span>
</div>
<div dir="auto" class="left"><span class="country-name">Austria</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:christian@amsuess.com" class="email">christian@amsuess.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Peter van der Stok</span></div>
<div dir="auto" class="left"><span class="org">Consultant</span></div>
<div class="tel">
<span>Phone:</span>
<a href="tel:+31-492474673%20(Netherlands),%20+33-966015248%20(France)" class="tel">+31-492474673 (Netherlands), +33-966015248 (France)</a>
</div>
<div class="email">
<span>Email:</span>
<a href="mailto:stokcons@bbhmail.nl" class="email">stokcons@bbhmail.nl</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
