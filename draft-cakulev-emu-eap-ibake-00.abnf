K_PUBs = H1(IDs).

K_PUBp = H1(IDp).

ECDHComponent_S = Encr(K_PUBp, IDs || IDp || [Rs]P).

ECDHComponent_P = Encr(K_PUBs, IDs || IDp || [Rs]P || [Rp]P).

ECDHComponent_S = Encr(K_PUBp, IDs || IDp || [Rp]P).

Ka = prf(K_Session, "EAP-IBAKE Ka" || IDs || IDp)

Auth_S = prf(Ka, "EAP-IBAKE server" || EAP-Request/IBAKE-ID ||
                 EAP-Response/IBAKE-ID || EAP-Request/IBAKE-Challenge ||
                 EAP-Response/IBAKE-Challenge).

Auth_P = prf(Ka, "EAP-IBAKE peer" || EAP-Request/IBAKE-ID ||
                 EAP-Response/IBAKE-ID || EAP-Request/IBAKE-Challenge ||
                 EAP-Response/IBAKE-Challenge).

