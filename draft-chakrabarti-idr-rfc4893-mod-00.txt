

Internet Domain Routing                                   S. Chakrabarti
Internet-Draft                           IP Infusion - An Access Company
Intended status: Standards Track                              March 2008
Expires: September 2, 2008


       A proposal for modification of BGP 4-octet AS number usage
                draft-chakrabarti-idr-rfc4893-mod-00.txt

Status of this Memo

   By submitting this Internet-Draft, each author represents that any
   applicable patent or other IPR claims of which he or she is aware
   have been or will be disclosed, and any of which he or she becomes
   aware will be disclosed, in accordance with Section 6 of BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups.  Note that
   other groups may also distribute working documents as Internet-
   Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt.

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html.

   This Internet-Draft will expire on September 2, 2008.

Copyright Notice

   Copyright (C) The IETF Trust (2008).

Abstract

   RFC 4893 defines BGP support for four-octet AS number space.  This
   document proposes clarification texts for RFC 4893 for clear
   understanding of the transition behavior between existing
   implementations with two-octet AS numbers and the new BGP
   implementations with four-octet AS numbers.  This document also
   proposes an addition of notification message and clearly defines the
   processing of "My AS Number" field in the BGP OPEN message for better
   interoperability during the transition phase of two-octet and four-



Chakrabarti             Expires September 2, 2008               [Page 1]

Internet-Draft           RFC 4893 Calrification               March 2008


   octet compliant BGP speakers.


Table of Contents

   1.  Requirements notation . . . . . . . . . . . . . . . . . . . . . 3
   2.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . . . 3
   3.  Terminology . . . . . . . . . . . . . . . . . . . . . . . . . . 3
   4.  Clarification issue-I . . . . . . . . . . . . . . . . . . . . . 3
     4.1.  Proposal for new text . . . . . . . . . . . . . . . . . . . 4
   5.  Clarification - issue-2 . . . . . . . . . . . . . . . . . . . . 4
     5.1.  Proposal for new text . . . . . . . . . . . . . . . . . . . 5
   6.  Clarification - issue-3 . . . . . . . . . . . . . . . . . . . . 5
     6.1.  Proposal for change in protocol . . . . . . . . . . . . . . 6
   7.  Calrification issue-4 . . . . . . . . . . . . . . . . . . . . . 6
   8.  Proposal for a NOTIFICATION message . . . . . . . . . . . . . . 6
   9.  IANA Considerations . . . . . . . . . . . . . . . . . . . . . . 7
   10. Acknowledgements  . . . . . . . . . . . . . . . . . . . . . . . 7
   11. Normative References  . . . . . . . . . . . . . . . . . . . . . 7
   Author's Address  . . . . . . . . . . . . . . . . . . . . . . . . . 7
   Intellectual Property and Copyright Statements  . . . . . . . . . . 8






























Chakrabarti             Expires September 2, 2008               [Page 2]

Internet-Draft           RFC 4893 Calrification               March 2008


1.  Requirements notation

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [3].


2.  Introduction

   RFC 4893[1] defines the extensions to BGP in order to use 4-byte
   autonomous system (AS) number and it also describes the behavior of
   BGP speakers with 4-byte AS numbers and the existing BGP speakers
   with 2-byte AS numbers for ease of transitions.  However, the
   specification requires more clarity in handling the AS numbers in
   OPEN and UPDATE messages between the 2-byte AS number speakers and
   4-byte AS number speakers.  Without the clear understanding of
   handling of these messages the existing and new implementations of
   BGP speakers may fail to interoperate or may degrade routing services
   over the Internet.

   This document is initiated based on some questions raised during an
   implementation of RFC 4893.  Thus the goal of this document is to
   point out the areas of clarification required in the 4-byte AS number
   specification[1].  Besides the clarification text, it also proposes a
   notification message and clearly defines the processing of "MY AS
   Number" field in BGP[2] when 4-byte AS number capability message is
   present.


3.  Terminology

   OLD BGP Speaker: A BGP speaker which is RFC 4271[2] compliant and
   does not implement 4byte extension to the AS number as defined in RFC
   4893.

   NEW BGP Speaker: A BGP speaker which implements the 4-byte AS number
   support as defined in RFC 4893.


4.  Clarification issue-I

   RFC4893 is unclear about the processing of "My AS Number" field in
   the OPEN message[2].  Section 3 mentions about the capability message
   for 4byte ASN support: "The Capability that is used by a BGP speaker
   to convey to its BGP peer the 4-octet Autonomous System number
   capability, also carries the 4-octet Autonomous System number of the
   speaker in the Capability Value field of the Capability Optional
   Parameter.  The Capability Length field of the Capability is set to



Chakrabarti             Expires September 2, 2008               [Page 3]

Internet-Draft           RFC 4893 Calrification               March 2008


   4. " and "We denote this special AS number as AS_TRANS for ease of
   description in the rest of this specification.  This AS number is
   also placed in the "My Autonomous System" field of the OPEN message
   originated by a NEW BGP speaker, if the speaker does not have a
   (globally unique) 2-octet AS number."

   The questions are : 1) When 4-byte AS number capability message is
   present and the receiver is able to process the capability message,
   should it ignore the AS number field in the OPEN message? [ note:
   2-byte mappable As Numbered BGP speaker may send 4-byte AS capability
   support]

4.1.  Proposal for new text

   A separate section on handling OPEN message would be very useful.  A
   suggested text is below.

   Processing and sending OPEN message:
      1) Sending OPEN message:If the BGP speaker has a 2byte AS number
      or 2-byte mappable 4-byte AS number, it uses the 2 byte ASN in the
      "My AS number" field of OPEN message.  If the BGP speaker has a
      4-byte non-mappable AS number, then it uses AS_TRANS in "My AS
      Number" field of OPEN message.
      2) Receiving OPEN message: If a NEW BGP speaker receives a OPEN
      message with extended AS number capability, then it uses the
      4-byte AS number from the extended AS capability message and may
      disregard the value in the "My AS number" field in the OPEN
      message.  If there is no extended AS capability is present and the
      OPEN messge "My AS number" field contains AS_TRANS, then the NEW
      BGP implementation sends a notification message to the peer and
      closes connection.  An OLD BGP speaker-implementation is not aware
      of the extended AS number capability; it processes the OPEN
      message as per RFC 4271.


5.  Clarification - issue-2

   Currently, in section 4.2.1 RFC 4893 states:

   "Note that peering between a NEW BGP speaker and an OLD one is
   possible only if the NEW BGP speaker has a 2-octet AS number.
   However, this document does not assume that an Autonomous System with
   NEW speakers has to have a globally unique 2-octet AS number -
   AS_TRANS could be used instead (even if a multiple Autonomous System
   would use it)."






Chakrabarti             Expires September 2, 2008               [Page 4]

Internet-Draft           RFC 4893 Calrification               March 2008


   R1                   R2                 R3                    R4
   o-------------------o-------------------o----------------------o
    OLD            NEW                   OLD                   NEW
    (50)         (77777)                 (100)                (65666)


                 A scenario with OLD and NEW BGP speakers

   In the above scenario, if both R2 and R4 peer with R3, R3
   configuration may assume that R4 and R2 are part of same AS.  This
   may cause R3 to make undesirable routing decision.  Some
   clarification/recommendation is required in this case.

5.1.  Proposal for new text

   Note that peering between a NEW BGP speaker and an OLD one is
   possible only if the NEW BGP speaker has a 2-octet AS number or a
   2-octet mappable extended AS number.  However, this document does not
   assume that an Autonomous System with NEW speakers has to have a
   globally unique 2-octet AS number - AS_TRANS could be used
   instead;careful considerations are required such that it does not
   affect the routing path of the traffic due to some local policy on AS
   number at the OLD BGP speaker.  During transition to NEW BGP speaker
   from an OLD BGP speaker, the above scenario should be avoided.


6.  Clarification - issue-3

   Section 3 of RFC4893 states: "NEW BGP speakers carry AS path
   information expressed in terms of 4-octet Autonomous Systems numbers
   by using the existing AS_PATH attribute, except that each AS number
   in this attribute is encoded not as a 2-octet, but as a 4-octet
   entity."


   R1                   R2                 R3                    R4
   o-------------------o-------------------o----------------------o
   NEW               NEW                   OLD                   NEW
   (77777)         (65666)                 (100)                (200)


                2nd scenario with OLD and NEW BGP speakers

   According to the current specification, R1 will send AS_PATH with
   4-byte AS numbers to R2.  Since R2 is peering with an OLD BGP
   speaker, it will make the conversion of 4-byte AS_PATH attributes to
   2-byte AS_PATH attributes and pass them to R3 along with AS4_PATH
   attributes.



Chakrabarti             Expires September 2, 2008               [Page 5]

Internet-Draft           RFC 4893 Calrification               March 2008


   Since OLD and NEW BGP speakers will exist in the network for a long
   time, it might be clean to use 4-byte numbers in AS4_PATH attributes
   only and corresponding value AS_TRANS in AS_PATH attribute even when
   two NEW BGP peers with non-mappable 4-byte AS number exchange
   information.  It also simplifies the NEW BGP speaker implementation
   and processing of AS_PATH.  This simplifies the NEW BGP
   implementation and saves the extra time in processing an UPDATE
   message.

6.1.  Proposal for change in protocol

   A NEW BGP speaker with 4-byte AS number always includes AS4_PATH
   attribute containing the extended 4-byte AS number.  If the AS number
   is 2-byte mappable, then it adds the corresponding 2-byte mapped AS
   number in the AS_PATH attribute, otherwise it uses AS_TRANS as the AS
   number in the corresponding AS_PATH attribute.  Thus the NEW BGP
   speaker will always have AS4_PATH and a corresponding AS_PATH
   attribute.  Following a complete transition to 4-byte AS numbered
   systems, AS_PATH may be replaced by AS4_PATH by turning a
   configuration knob on each system.  Thus a NEW BGP implementation may
   consider providing a configuration knob which disables AS_PATH
   attribute sending and processing.


7.  Calrification issue-4

   Minor nit: "truly 4-octet" should be defined as a quantity higher
   than 65535.

   Should the NEW BGP speaker send a NOTIFICATION message when it
   receives a OPEN message with AS_TRANS but without any corresponding
   capability message ?  Note that although AS_TRANS(23456) is a
   reserved number now, it is still possible to receive a OPEN message
   with AS_TRANS value from an OLD BGP speaker or from a ill-behaving
   NEW BGP speaker.


8.  Proposal for a NOTIFICATION message

   When two BGP speakers correspond with each other by sending AS_TRANS
   value in the 'My AS number' field, then the OPEN message MUST contain
   the 4-octet AS number capability option.  If the 4-octet capability
   is missing in OPEN message where the 'My AS Number' field contains
   AS_TRANS value, a NEW BGP speaker-receiver SHOULD send a notification
   with code=2, subcode=2 [bad peer AS] to the sender of the OPEN
   message.

   If an OLD BGP speaker receives a OPEN message with AS_TRANS value in



Chakrabarti             Expires September 2, 2008               [Page 6]

Internet-Draft           RFC 4893 Calrification               March 2008


   the 'My AS number' field it should treat it normally as per RFC 4271
   and local policy.


9.  IANA Considerations

   This document has no actions for IANA.


10.  Acknowledgements


11.  Normative References

   [1]  Vohra, Q. and E. Chen, "BGP Support for Four-octet AS Number
        Space", RFC 4893, May 2007.

   [2]  Rekhter, Y., Li, T., and S. Hares, "Border Gateway Protocol 4",
        RFC 4271, January 2006.

   [3]  Bradner, S., "Key words for use in RFCs to Indicate Requirement
        Levels", BCP 14, RFC 2119, March 1997.


Author's Address

   Samita Chakrabarti
   IP Infusion - An Access Company
   125 S. Market Street
   San Jose
   USA

   Email: samitac@ipinfusion.com


















Chakrabarti             Expires September 2, 2008               [Page 7]

Internet-Draft           RFC 4893 Calrification               March 2008


Full Copyright Statement

   Copyright (C) The IETF Trust (2008).

   This document is subject to the rights, licenses and restrictions
   contained in BCP 78, and except as set forth therein, the authors
   retain all their rights.

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST AND
   THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS
   OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF
   THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.


Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in BCP 78 and BCP 79.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   http://www.ietf.org/ipr.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.


Acknowledgment

   Funding for the RFC Editor function is provided by the IETF
   Administrative Support Activity (IASA).





Chakrabarti             Expires September 2, 2008               [Page 8]


