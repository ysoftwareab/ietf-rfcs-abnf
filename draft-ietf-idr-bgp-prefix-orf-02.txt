





Network Working Group                                         Enke Chen
Internet Draft                                        Srihari R. Sangli
Expiration Date: May 2006                                 Cisco Systems


          Address Prefix Based Outbound Route Filter for BGP-4

                  draft-ietf-idr-bgp-prefix-orf-02.txt


Status of this Memo

   By submitting this Internet-Draft, each author represents that any
   applicable patent or other IPR claims of which he or she is aware
   have been or will be disclosed, and any of which he or she becomes
   aware will be disclosed, in accordance with Section 6 of BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups.  Note that
   other groups may also distribute working documents as Internet-
   Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html.

Abstract

   This document defines a new Outbound Router Filter type for BGP,
   termed "Address Prefix Outbound Route Filter", that can be used to
   perform address prefix based route filtering. This ORF-type supports
   prefix length or range based matching, wild-card based address prefix
   matching, as well as the exact address prefix matching for address
   families.










Chen & Sangli                                                   [Page 1]





Internet Draft    draft-ietf-idr-bgp-prefix-orf-02.txt     November 2005


1. Introduction

   The Cooperative Outbound Route Filtering Capability defined in [BGP-
   ORF] provides a mechanism for a BGP speaker to send to its BGP peer a
   set of Outbound Route Filters (ORFs) that can be used by its peer to
   filter its outbound routing updates to the speaker.

   This documents defines a new ORF-type for BGP, termed "Address Prefix
   Outbound Route Filter (Address Prefix ORF)", that can be used to
   perform address prefix based route filtering. The Address Prefix ORF
   supports prefix length or range based matching, wild-card based
   address prefix matching, as well as the exact address prefix matching
   for address families [BGP-MP].


2. Address Prefix ORF-Type

   The Address Prefix ORF-Type allows one to express ORFs in terms of
   address prefixes. That is, it provides address prefix based route
   filtering, including prefix length or range based matching, as well
   as wild-card address prefix matching.

   Conceptually an Address Prefix ORF entry consists of the fields
   <Sequence, Match, Length, Prefix, Minlen, Maxlen>.

   The "Sequence" field specifies the relative ordering of the entry
   among all the Address Prefix ORF entries.

   The "Match" field specifies whether this entry is "PERMIT" (value 0),
   or "DENY" (value 1).

   The "Length" field indicates the length in bits of the address
   prefix. A length of zero indicates a prefix that matches all (as
   specified by the address family) addresses (with prefix itself of
   zero octets).

   The "Prefix" field contains an address prefix of an address family.

   The "Minlen" field indicates the minimum prefix length in bits that
   is required for "matching". The field is considered as un-specified
   with value 0.

   The "Maxlen" field indicates the maximum prefix length in bits that
   is required for "matching". The field is considered as un-specified
   with value 0.

   The fields "Sequence", "Length", "Minlen", and "Maxlen" are all
   unsigned integers.



Chen & Sangli                                                   [Page 2]





Internet Draft    draft-ietf-idr-bgp-prefix-orf-02.txt     November 2005


   This document imposes the following requirement on the values of
   these fields:

           0 <= Length < Minlen <= Maxlen

   In addition, the "Maxlen" must be no more than the maximum length (in
   bits) of a host address for a given address family [BGP-MP].


3. Address Prefix ORF Encoding

   The value of the ORF-Type for the Address Prefix ORF-Type is 64.

   An Address Prefix ORF entry is encoded as follows. The "Match" field
   of the entry is encoded in the "Match" field of the common part [BGP-
   ORF], and the remaining fields of the entry is encoded in the "Type
   specific part" as follows.


               +--------------------------------+
               |   Sequence (4 octets)          |
               +--------------------------------+
               |   Minlen   (1 octet)           |
               +--------------------------------+
               |   Maxlen   (1 octet)           |
               +--------------------------------+
               |   Length   (1 octet)           |
               +--------------------------------+
               |   Prefix   (variable length)   |
               +--------------------------------+


   Note that the Prefix field contains the address prefix followed by
   enough trailing bits to make the end of the field fall on an octet
   boundary.  The value of the trailing bits is irrelevant.
















Chen & Sangli                                                   [Page 3]





Internet Draft    draft-ietf-idr-bgp-prefix-orf-02.txt     November 2005


4. Address Prefix ORF Matching

   In addition to the general matching rules defined in [BGP-ORF],
   several Address Prefix ORF specific matching rules are defined as
   follows.

   Consider an Address Prefix ORF entry, and a route maintained by a BGP
   speaker with NLRI in the form of <Prefix, Length>.

   The route is considered as "no match" to the ORF entry if the NLRI is
   neither more specific than, nor equal to, the <Prefix, Length> fields
   of the ORF entry.

   When the NLRI is either more specific than, or equal to, the <Prefix,
   Length> fields of the ORF entry, the route is considered as a match
   to the ORF entry only if the NLRI match condition as listed in the
   following table is satisfied.


              ORF Entry                  NLRI
         Minlen      Maxlen         Match Condition
       +------------------------------------------------------+
       | un-spec.    un-spec.       NLRI.legnth == ORF.length |
       +------------------------------------------------------+
       | specified   un-spec.       NLRI.length >= ORF.Minlen |
       +------------------------------------------------------+
       | un-spec.    specified      NLRI.length <= ORF.Maxlen |
       +------------------------------------------------------+
       | specified   specified      NLRI.length >= ORF.Minlen |
       |                        AND NLRI.length <= ORF.Maxlen |
       +------------------------------------------------------+


   When more than one Address Prefix ORF entry match the NLRI of the
   route, the "first-match" rule applies. That is, the ORF entry with
   the smallest sequence number (among all the matching ORF entries) is
   considered as the sole match, and it would determine whether the
   route should be advertised.

   The assignment of the sequence numbers is a local matter for the BGP
   speaker that sends the Address Prefix ORF entries.










Chen & Sangli                                                   [Page 4]





Internet Draft    draft-ietf-idr-bgp-prefix-orf-02.txt     November 2005


5. IANA Considerations

   This document specifies a new Outbound Route Filtering (ORF) type,
   Address Prefix ORF. The value of the ORF-type is 64.


6. Security Considerations

   This extension to BGP does not change the underlying security issues.


7. Normative References

   [BGP-4] Rekhter, Y., T. Li, and S. Hares, "A Border Gateway Protocol
   4 (BGP-4)", draft-ietf-idr-bgp4-26.txt, December 2004.

   [BGP-MP] Bates, T., Chandra, R., Katz, D. and Y. Rekhter,
   "Multiprotocol Extensions for BGP-4", RFC 2858, June 2000.

   [BGP-ORF] Chen, E., and Rekhter, Y., "Cooperative Route Filtering
   Capability for BGP-4", draft-ietf-idr-route-filter-12.txt, July 2005.


8. Author Information

   Enke Chen
   Cisco Systems, Inc.
   170 W. Tasman Dr.
   San Jose, CA 95134

   Email: enkechen@cisco.com


   Srihari R. Sangli
   Cisco Systems, Inc.
   170 W. Tasman Dr.
   San Jose, CA 95134

   Email: rsrihari@cisco.com












Chen & Sangli                                                   [Page 5]





Internet Draft    draft-ietf-idr-bgp-prefix-orf-02.txt     November 2005


9. Full Copyright Notice

   Copyright (C) The Internet Society (2005). This document is subject
   to the rights, licenses and restrictions contained in BCP 78, and
   except as set forth therein, the authors retain all their rights.

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY AND THE INTERNET
   ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS OR IMPLIED,
   INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE
   INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.






































Chen & Sangli                                                   [Page 6]


