<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>A Dual-end Recursive PCE-Based Computation (DRPC) Procedure to Compute Shortest Constrained Inter-domain Traffic Engineering Label Switched Paths </title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Conventions Used in This Document">
<link href="#rfc.section.2" rel="Chapter" title="2 Terminologies">
<link href="#rfc.section.3" rel="Chapter" title="3 General Assumptions">
<link href="#rfc.section.4" rel="Chapter" title="4 DRPC Procedure">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 PCE Sequence Selection Approaches">
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 DRPC Procedure">
<link href="#rfc.section.4.3" rel="Chapter" title="4.3 Stitching PCE Selection">
<link href="#rfc.section.4.3.1" rel="Chapter" title="4.3.1 Case(1): Mode of Operation in PCE Designation">
<link href="#rfc.section.4.3.2" rel="Chapter" title="4.3.2 Case(2): Mode of Operation in PCEP Signaling Procedure">
<link href="#rfc.section.4.4" rel="Chapter" title="4.4 An Example of PCE Collaboration">
<link href="#rfc.section.5" rel="Chapter" title="5 PCEP Protocol Extension Requirements">
<link href="#rfc.section.6" rel="Chapter" title="6 VSPG Encoding">
<link href="#rfc.section.7" rel="Chapter" title="7 DRPC Procedure Failures">
<link href="#rfc.section.8" rel="Chapter" title="8 Path Computation Failures">
<link href="#rfc.section.9" rel="Chapter" title="9 Security Considerations">
<link href="#rfc.section.10" rel="Chapter" title="10 IANA Consideration">
<link href="#rfc.section.10.1" rel="Chapter" title="10.1 New Flags Of The RP Object">
<link href="#rfc.section.10.2" rel="Chapter" title="10.2 New Error-Type and Error-Value">
<link href="#rfc.section.10.3" rel="Chapter" title="10.3 New Flag Of The NO-PATH-VECTOR TLV">
<link href="#rfc.section.11" rel="Chapter" title="11 Acknowledgments">
<link href="#rfc.references" rel="Chapter" title="12 References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="A dual-end recursive PCE-based computation procedure (DRPC) is proposed to compute shortest constrained inter-domain traffic engineering label switched paths based on BRPC in Multi-protocol Label Switching (MPLS) and Generalized MPLS (GMPLS) networks. By recursively performing shortest path algorithm and transferring the segmental path computation result from both ends bi-directionally, they meet at one of the Middle PCEs, generating a directional shortest path graph into which the two shortest path trees are stitched together. Therefore, the end-to-end constrained inter-domain traffic engineering label switched path, even k shortest paths can be gained from the directional shortest path graph directly." />
  <meta name="description" content="A dual-end recursive PCE-based computation procedure (DRPC) is proposed to compute shortest constrained inter-domain traffic engineering label switched paths based on BRPC in Multi-protocol Label Switching (MPLS) and Generalized MPLS (GMPLS) networks. By recursively performing shortest path algorithm and transferring the segmental path computation result from both ends bi-directionally, they meet at one of the Middle PCEs, generating a directional shortest path graph into which the two shortest path trees are stitched together. Therefore, the end-to-end constrained inter-domain traffic engineering label switched path, even k shortest paths can be gained from the directional shortest path graph directly." />
  <meta name="keywords" content="PCE, DRPC, Inter-domain, Constraints" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Network Working Group</td>
<td class="right">XH. Fu</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">YL. Bao</td>
</tr>
<tr>
<td class="left">Intended status: Informational</td>
<td class="right">ZTE Corporation</td>
</tr>
<tr>
<td class="left">Expires: March 03, 2012</td>
<td class="right">YL. Zhao</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">J. Zhang</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Y. G</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">BUPT</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">August 31, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">A Dual-end Recursive PCE-Based Computation (DRPC) Procedure to Compute Shortest Constrained Inter-domain Traffic Engineering Label Switched Paths <br />
  <span class="filename">draft-fuxh-pce-drpc-03</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>A dual-end recursive PCE-based computation procedure (DRPC) is proposed to compute shortest constrained inter-domain traffic engineering label switched paths based on BRPC in Multi-protocol Label Switching (MPLS) and Generalized MPLS (GMPLS) networks. By recursively performing shortest path algorithm and transferring the segmental path computation result from both ends bi-directionally, they meet at one of the Middle PCEs, generating a directional shortest path graph into which the two shortest path trees are stitched together. Therefore, the end-to-end constrained inter-domain traffic engineering label switched path, even k shortest paths can be gained from the directional shortest path graph directly.</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on March 03, 2012.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>1.1.   <a href="#rfc.section.1.1">Conventions Used in This Document</a>
</li>
<li>2.   <a href="#rfc.section.2">Terminologies</a>
</li>
<li>3.   <a href="#rfc.section.3">General Assumptions</a>
</li>
<li>4.   <a href="#rfc.section.4">DRPC Procedure</a>
</li>
<li>4.1.   <a href="#rfc.section.4.1">PCE Sequence Selection Approaches</a>
</li>
<li>4.2.   <a href="#rfc.section.4.2">DRPC Procedure</a>
</li>
<li>4.3.   <a href="#rfc.section.4.3">Stitching PCE Selection</a>
</li>
<li>4.3.1.   <a href="#rfc.section.4.3.1">Case(1): Mode of Operation in PCE Designation</a>
</li>
<li>4.3.2.   <a href="#rfc.section.4.3.2">Case(2): Mode of Operation in PCEP Signaling Procedure</a>
</li>
<li>4.4.   <a href="#rfc.section.4.4">An Example of PCE Collaboration</a>
</li>
<li>5.   <a href="#rfc.section.5">PCEP Protocol Extension Requirements</a>
</li>
<li>6.   <a href="#rfc.section.6">VSPG Encoding</a>
</li>
<li>7.   <a href="#rfc.section.7">DRPC Procedure Failures</a>
</li>
<li>8.   <a href="#rfc.section.8">Path Computation Failures</a>
</li>
<li>9.   <a href="#rfc.section.9">Security Considerations</a>
</li>
<li>10.   <a href="#rfc.section.10">IANA Consideration</a>
</li>
<li>10.1.   <a href="#rfc.section.10.1">New Flags Of The RP Object</a>
</li>
<li>10.2.   <a href="#rfc.section.10.2">New Error-Type and Error-Value</a>
</li>
<li>10.3.   <a href="#rfc.section.10.3">New Flag Of The NO-PATH-VECTOR TLV</a>
</li>
<li>11.   <a href="#rfc.section.11">Acknowledgments</a>
</li>
<li>12.   <a href="#rfc.references">References</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> Introduction</h1>
<p id="rfc.section.1.p.1">With regards to the constraint-based shortest path computation in Multi-protocol Label Switching (MPLS) and Generalized MPLS (GMPLS) multi-layer and multi-domain networks, IETF groups propose the architecture of Path Computation Element (PCE) [RFC4655]. As an important approach of path computation in PCE architecture, backward recursive PCE-based computation (BRPC) procedure can gain a shortest path tree along the direction from the destination node to the source node, and then get an end-to-end optimal path [RFC5441]. During the procedure of BRPC, a sequence of PCEs  should be pre-determined. However, when the number of PCEs in the predetermined PCE sequence are very large, the path computation time may be long for the customer, and the long PCE chain will be vulnerable. A dual-end recursive PCE-based computation (DRPC) procedure is proposed to compute shortest constrained inter-domain traffic engineering label switched paths. DRPC procedure aims to provide a further improvement of the existing BRPC procedure by computing and transferring the shortest path tree bi-directionally, which doubles the pace of inter-domain path computation.In DRPC procedure, path computation is launched at the source PCE and the destination PCE simultaneously. By recursively performing shortest path algorithm and transferring the segmental path computation result from both ends bi-directionally, they meet at one of the Middle PCEs, generating a directional shortest path graph into which the two shortest path trees are stitched together. Therefore, the end-to-end constrained inter-domain traffic engineering label switched path, even the k shortest paths can be gained from the directional shortest path graph directly. Only the differences from [RFC5441] are listed here, the overlapped comments all inherit the corresponding terms in [RFC5441], such as section 7, 8, 10, 11, 13, 14, 16, and so on.</p>
<h1 id="rfc.section.1.1">
<a href="#rfc.section.1.1">1.1.</a> Conventions Used in This Document</h1>
<p id="rfc.section.1.1.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">[RFC2119]</a>.</p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> Terminologies</h1>
<p id="rfc.section.2.p.1">ABR: Area Border Routers. Routers used to connect two IGP areas (areas in OSPF or levels in IS-IS).</p>
<p id="rfc.section.2.p.2">ASBR: Autonomous System Border Routers. Routers used to connect together ASes of the same or different Service Providers via one or more Inter-AS links.</p>
<p id="rfc.section.2.p.3">Boundary Node (BN): a boundary node is either an ABR in the context of inter-area Traffic Engineering or an ASBR in the context of inter-AS Traffic Engineering.</p>
<p id="rfc.section.2.p.4">Entry BN of domain (n): a BN connecting domain (n-1) to domain (n) along a determined sequence of domains.</p>
<p id="rfc.section.2.p.5">Exit BN of domain (n): a BN connecting domain (n) to domain (n+1) along a determined sequence of domains.</p>
<p id="rfc.section.2.p.6">Inter-AS TE LSP: A TE LSP that crosses an AS boundary. Inter-area TE LSP: A TE LSP that crosses an IGP area boundary.</p>
<p id="rfc.section.2.p.7">LSR: Label Switching Router.</p>
<p id="rfc.section.2.p.8">LSP: Label Switched Path.</p>
<p id="rfc.section.2.p.9">PCC: Path Computation Client. Any client application requesting a path computation to be performed by the Path Computation Element.</p>
<p id="rfc.section.2.p.10">PCE (Path Computation Element): an entity (component, application or network node) that is capable of computing a network path or route based on a network graph and applying computational constraints.</p>
<p id="rfc.section.2.p.11">PCE(i): a PCE with the scope of domain (i).</p>
<p id="rfc.section.2.p.12">TED: Traffic Engineering Database.</p>
<p id="rfc.section.2.p.13">VSPT: Virtual Shortest Path Tree.</p>
<p id="rfc.section.2.p.14">VSPG: Virtual Shortest Path Graph.</p>
<p id="rfc.section.2.p.15">Source PCE: the PCE in the source domain to launch the DRPC procedure and transfer the calculated VSPT forward.</p>
<p id="rfc.section.2.p.16">Destination PCE: the PCE in the destination domain to launch the DRPC procedure and transfer the calculated VSPT backward.</p>
<p id="rfc.section.2.p.17">Middle PCE: a PCE which is a relative concept ,that is one of the PCEs in the PCE sequence(the direction from the Destination PCE to the Source PCE or from the Source PCE to the Destination PCE relatively).And the Middle PCE must not be the source PCE or the destination PCE.</p>
<p id="rfc.section.2.p.18">Stitching PCE: a PCE which is determined to stitch the two VSPTs from both source and destination sides of PCEs into a VSPG.</p>
<p id="rfc.section.2.p.19">Downstream: In forward direction, from Source PCE to Destination PCE.</p>
<p id="rfc.section.2.p.20">Upstream: In backward direction, from Destination PCE to Source PCE.</p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> General Assumptions</h1>
<p id="rfc.section.3.p.1">In the rest of this document, we make the following set of assumptions common to inter-area and inter-AS MPLS TE, which are same to the assumptions of [RFC 5441].  </p>

<ul>
<li>Each IGP area or Autonomous System (AS) is assumed to be Traffic Engineering enabled.</li>
<li>No topology or resource information is distributed between domains (as mandated per [RFC4105] and [RFC4216]), which is critical to preserve IGP/BGP scalability and confidentiality.</li>
<li>while certain constraints like bandwidth can be used across different domains, other TE constraints like resource affinity, color, metric, etc. as listed in RFC2702 could be translated at domain boundaries. If required, it is assumed that, at the domain boundary nodes, there will exist some sort of local mapping based on policy agreement, in order to translate such constraints across domain boundaries during the inter-PCE communication process.</li>
<li>Each AS can be made of several IGP areas. The path computation procedure described in this document applies to the case of a single AS made of multiple IGP areas, multiple ASes made of a single IGP area or any combination of the above. For the sake of simplicity, each AS will be considered to be made of a single area in this document. The case of an Inter-AS TE LSP spanning multiple ASes where some of those ASes are themselves made of multiple IGP areas can be easily derived from this case by applying the DRPC procedure described in this document, recursively.</li>
<li>The domain path (set of domains traversed to reach the destination domain) is either administratively pre-determined or discovered by some means that is outside of the scope of this document.</li>
</ul>

<p> </p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> DRPC Procedure</h1>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> PCE Sequence Selection Approaches</h1>
<p id="rfc.section.4.1.p.1">A PCE sequence has to be predetermined before DRPC procedure is launched, which corresponds to the domain path selection. The PCE/domain path may be either administratively predetermined or discovered by some means outside of the scope of this document. </p>
<p id="rfc.section.4.1.p.2">A hierarchical PCE architecture is highly recommended which is proposed in [I-D.ietf-pce-hierarchy-fwk]. In the hierarchical PCE architecture, there are concepts of Parent (hierarchical) PCE and child PCE.</p>
<p id="rfc.section.4.1.p.3">The Parent PCE is responsible for selecting a PCE/domian path across its domain map.The Parent PCE maintains the domain topology map that contains the child domains and their interconnections and  the traffic engineering (TE) capabilities of domain interconnections. But The Parent PCE has no information about the contents of the child domains.And it learns those from configuration or information received from each Child PCE.</p>
<p id="rfc.section.4.1.p.4">Each domain has has at least one PCE capable of computing paths across it. These PCEs are known as Child PCEs and have a relationship with the Parent PCE. A child PCE is responsible for computing the path across one or more specific (child) domains. Each Child PCE knows the identity of the border nodes and links of its own adjacent domains. But a child PCE only knows the topology of the domain it serves and does not know the topology of other domains.And it is also not aware of the general domain mesh connectivity beyond the connectivity to the immediate neighbordomains of the domain it serves.</p>
<p id="rfc.section.4.1.p.5">When the ingress PCE responsible for the ingress domain receives a path computation request from the source node, and the destination is outside of this domain, the ingress PCE will send a path computation request(PCReq Message) to the parent PCE. The parent PCE determines which domian the destination node belongs to.And then the parent PCE selects the sequence of candidate domain PCEs based on its domain topology map. It then sends the selected candidate PCE sequence within the computation requests (PCRep Message) to the ingress PCE .</p>
<p id="rfc.section.4.1.p.6">Each selected candidate PCE that in the selected sequence computes a set of candidate path segments across its own domain and then use some methods(e.g. BRPC, etc.) to gain an optimal end-to-end optimal path from the source node to the destination node.</p>
<p id="rfc.section.4.1.p.7">The communication with Parent PCE is unnecessary within the context of non-hierarchical PCE architecture and PCE/domain path can be obtained by other means.</p>
<h1 id="rfc.section.4.2">
<a href="#rfc.section.4.2">4.2.</a> DRPC Procedure</h1>
<p id="rfc.section.4.2.p.1">Definition of VSPG(i), VSPT(0,i) and VSPT(1,i): </p>
<p id="rfc.section.4.2.p.2">VSPG(i) consists of multi shortest paths from the same node to other multi nodes. </p>
<p id="rfc.section.4.2.p.3">In each domain i, </p>

<ul>
<li>There is a set of X-en(i) entry BNs noted BN-en(k,i) where BN-en(k,i) is the kth entry BN of domain(i).</li>
<li>There is a set of X-ex(i) exit BNs noted BN-ex(k,i) where BN-ex(k,i) is the kth exit BN of domain(i).</li>
</ul>

<p> </p>
<p id="rfc.section.4.2.p.4">The definition of VSPT(1,i) is the same as that of VSPT(i) in BRPC (see [RFC5441]).</p>
<p id="rfc.section.4.2.p.5">VSPT(1,i): MP2P (multipoint-to-point) tree returned by PCE(i) to PCE(i-1):</p>
<div id="#rfc.figure.1"></div>
<div id="#VSPT(1,i) Backward Shortest Path MP2P Tree"></div>
<pre>
							 
   ---------------------------------------------
  |                                             |   
  |        -------------------------            |
  |       |Root (TE LSP destination)|           |
  |        -------------------------            |
  |         /          |          \             |
  |        /           |           \            |
  |       /            |            \           |
  |   ----------   ----------      ----------   |
  |  |BN-en(1,i)| |BN-en(2,i)| ...|BN-en(j,i)|  |
  |   ----------   ----------      ----------   |
  |                                             |
   ---------------------------------------------
where [X-en(i)] is the number of entry BNs in
domain (i), and j is no larger than [X-en(i)] 
               
					</pre>
<p id="rfc.section.4.2.p.6">Each link of tree VSPT(1,i) represents the shortest constrained path between BN-en(j,i) and the TE LSP destination that satisfies the set of required constraints for the TE LSP (bandwidth, resource affinity, metrics, etc.). These are path segments to reach the TE LSP destination from BN-en(j,i).</p>
<p id="rfc.section.4.2.p.7">The definition of VSPT(0,i) is vary similar to the VSPT(1,i).</p>
<p id="rfc.section.4.2.p.8">VSPT(0,i): P2MP (point-to-multipoint) tree returned by PCE(i) to PCE(i+1):</p>
<div id="#rfc.figure.2"></div>
<div id="#VSPT(0,i) Forward Shortest Path P2MP Tree"></div>
<pre> 
						
 -----------------------------------------------------
|                                                      |   
|               ---------------------                  |
|              | Root (TE LSP source)|                 |
|               ---------------------                  |     
|              /          |          \                 |
|             /           |           \                |
|            /            |            \               |
|   ------------     ------------       ------------   |
|  |BN-en(1,i+1)|   |BN-en(2,i+1)| ... |BN-en(j,i+1)|  |
|   ------------     ------------       ------------   |
|                                                      |
 -----------------------------------------------------
where [X-en(i)] is the number of entry BNs in
domain (i), and j is no larger than [X-en(i)]
 
					</pre>
<p id="rfc.section.4.2.p.9">Each link of tree VSPT(0,i) represents the shortest constrained path between BN-en(j,i+1) and the TE LSP source that satisfies the set of required constraints for the TE LSP (bandwidth, resource affinity, metrics, etc.). These are path segments to reach BN-en(j,i+1) from the TE LSP source.</p>
<p id="rfc.section.4.2.p.10">Different from BRPC, when a path computation request arriving and the PCE sequence to be traversed has been predetermined, DRPC will launch the path computation from dual-end PCEs to the Middle PCEs bi-directionally. It is worth noting that the Middle PCE may not be the PCE in the middle of the PCE sequence but the PCE receiving the two path computation requests from two directions. And the domian that servered by the Middle PCE is called as Stitching Domain,and this Middle PCE is also called as stitching PCE. According to the path computation request, the source PCE sparks the path computaion to the Entry BN of the stitching domain. While, the destination PCE sparks the path computation to the the Entry BN of the domain next to the stitching domain. When the stitching PCE receives the two messages which contain the two virtual shortest path trees (VSPT) at the root of the source node and the destination node respectively, the stitching PCE will stitch the two VSPTs into one complete directional shortest path graph. At last, the shortest path or k shortest paths will be selected from the directional shortest path graph by the stitching PCE according to some strategies and transferred to the source node through the Source PCE. Similar with BRPC procedure, a predetermined PCE sequence should also be designated before DRPC procedure.</p>
<p id="rfc.section.4.2.p.11">PCE(i+1) computes VSPT(1,i+1) by using its own topology map without considerating any cross-domain links. VSPT(1,i+1) is returned by PCE(i+1) to PCE(i) along the direction from the Destination PCE to the Source PCE, which consists of multi shortest paths from the multi BN-en(j,i+1)s to the destination node, as is shown in Fig.1.</p>
<p id="rfc.section.4.2.p.12">PCE(i-1) computes VSPT(0,i-1) by using its own topology map together with the cross-domain links between domain(i-1) and domain(i). VSPT(0, i-1) is returned by PCE(i-1) to PCE (i) along the direction from the Source PCE to the Destination PCE, which consists of multi shortest paths from the source node to multi BN-en(j,i), as is shown in Fig.2.</p>
<p id="rfc.section.4.2.p.13">VSPG(i)=VSPT(0,i)+VSPT(1,i+1) is the directional shortest path graph from the source node to the destination node which is stitched by the two directional shortest path trees that gained above.  As the Stitching PCE, PCE(i) computes VSPT(0,i) and then stitches the two directional shortest path graphs together where VSPT(0,i) represents the directional shortest path tree computed from source node to the Entry BN of domain(i+1) and VSPT(1,i+1) represents the directional shortest path graph computed from destination node to the Entry BN of domain(i+1). At last, the directional shortest path graph from the source node to the destination node is generated as shown in Fig.3.</p>
<div id="#rfc.figure.3"></div>
<div id="#VSPG(i) Shortest Path Graph"></div>
<pre> 
						 
 ----------------------------------------------------
|                                                      |
|                 -------------------                  |
|                |Root (TE LSP source)|                |
|                 -------------------                  |              
|                /         |         \                 |
|               /          |          \                |
|   ------------     ------------       ------------   |
|  |BN-en(1,i+1)|   |BN-en(2,i+1)| ... |BN-en(j,i+1)|  |
|   ------------     ------------       ------------   |
|               \          |          /                |
|                \         |         /                 |
|              -------------------------               |
|             |Root (TE LSP destination)|              |
|              -------------------------               |
|                                                      |
  ----------------------------------------------------
  
					</pre>
<p id="rfc.section.4.2.p.14">The Stitching PCE can be either designated before DRPC procedure or dynamic selected in PCEP signaling procedure automatically.</p>
<p id="rfc.section.4.2.p.15">Two path selection strategies are permitted to return the shortest path back to PCC.  </p>

<ul>
<li>The Stitching PCE transfers the computed optimal end-to-end path to the Source PCE through PCReq message and the Source PCE returns the path back to PCC. The non-optimal paths are deleted at the Stitching PCE.</li>
<li>The Stitching PCE transfers the newly stitched directional shortest path graph to the Source PCE through PCRep message. Source PCE generates the shortest path and returns it back to PCC.  The non-shortest paths are deleted at the Source PCE.</li>
</ul>

<p> </p>
<h1 id="rfc.section.4.3">
<a href="#rfc.section.4.3">4.3.</a> Stitching PCE Selection</h1>
<p id="rfc.section.4.3.p.1">The Stitching PCE is an ordinary PCE. It acts as the role of stitching the two VSPTs from both source and destination sides of PCEs into a VSPG. The Stitching PCE can be designated by several means before DRPC procedure, such as Parent PCE computation, Network Management System(NMS) designation, administrative configuration and etc. These can be regarded as Designation Case and Section 4.3.1 describes the DRPC operation in this case. By utilizing the characteristics of the PCEP signaling, the stitching role can be dynamically determined. Section 4.3.2 elaborates the details of PCEP signaling procedure in Stitching PCE Selection.</p>
<h1 id="rfc.section.4.3.1">
<a href="#rfc.section.4.3.1">4.3.1.</a> Case(1): Mode of Operation in PCE Designation</h1>
<p id="rfc.section.4.3.1.p.1">Denoting that PCE(1) is the Source PCE, PCE(m) is the Stitching PCE, and PCE(n) is the Destination PCE.</p>
<p id="rfc.section.4.3.1.p.2">Step 1:</p>
<p id="rfc.section.4.3.1.p.3">PCE(1) computes VSPT(0,1), the tree made of the list of shortest constrained paths between the TE LSP source and every BN-en(j,2) by using a suitable path computation algorithm (e.g. CSPF, etc.) and returns the computed VSPT(0,1) to PCE(2). This can be triggered by Parent  PCE, PCC or spontaneously.</p>
<p id="rfc.section.4.3.1.p.4">Simultaneously, PCE(n) computes VSPT(1,n), the tree made of the list of shortest constrained paths between every BN-en(j,n) and the TE LSP destination using a suitable path computation algorithm (e.g. CSPF, etc.) and returns the computed VSPT(n) to PCE(n-1). This can be triggered by Parent PCE, PCE(n-1) or PCE(1) directly. It is highly recommended to drive PCE(n) to compute VSPT(1,n) by PCE chain and to relay PCReq message PCE-by-PCE downstream from PCE(1). An example of specific PCEP message flow is shown in section 4.4.</p>
<p id="rfc.section.4.3.1.p.5">Step i: (Downstream)</p>
<p id="rfc.section.4.3.1.p.6">For i=2 to m-1: PCE(i) computes VSPT(0,i), the tree made of the shortest constrained paths between the TE LSP source and each BN-en(j,i+1). It does this by considering the information in VSPT(0,i-1) and its own TED including the links that provide connectivity from domain(i) to domain(i+1). PCE(i) returns the computed VSPT(0,i) to PCE(i+1).</p>
<p id="rfc.section.4.3.1.p.7">Step i: (Upstream)</p>
<p id="rfc.section.4.3.1.p.8">For i=n-1 to m+1: PCE(i) computes VSPT(1,i), the tree made of the shortest constrained paths between each BN-en(j,i) and the TE LSP destination. It does this by considering the information in VSPT(1,i+1) and its own TED. PCE(i) returns the computed VSPT(1,i) to PCE(i-1).</p>
<p id="rfc.section.4.3.1.p.9">Step m:</p>
<p id="rfc.section.4.3.1.p.10">The Stitching PCE(m) computes VSPT(0,m), the tree made of the shortest constrained paths between the TE LSP source and each BN-en(j,m+1). It does this by considering the information in VSPT(0,m-1) and its own TED including the links that provide connectivity from domain(m) to domain(m+1). PCE(m) stitches the computed VSPT(0,m) and VSPT(1,m+1) which is returned from PCE(m+1) into a VSPG.</p>
<p id="rfc.section.4.3.1.p.11">If n=2, the source domain and the destination domain are directly interconnected with each other.  The Stitching PCE is recommended to be specified as the Source PCE where step i is omitted.</p>
<p id="rfc.section.4.3.1.p.12">The PCRep message which carries VSPG(m) or final Explicit Route Objects (EROs) should be relayed from PCE(m) to PCE(1) upstream PCE-by-PCE. PCE(1) returns the final path computation result to PCC. The optimal path can be selected from VSPG(m) either by PCE(m) or PCE(1). For the sake of topology confidentialality, PCE(m) is recommended to select the final explicit route rather than PCE(1).</p>
<h1 id="rfc.section.4.3.2">
<a href="#rfc.section.4.3.2">4.3.2.</a> Case(2): Mode of Operation in PCEP Signaling Procedure</h1>
<p id="rfc.section.4.3.2.p.1">Denoting that PCE(1) is the Source PCE and PCE(n) is the Destination PCE. In case(2), every PCE transfers VSPT to the next PCE without knowing a predefined Stitching PCE. So, the Stitching PCE is selected automatically in PCEP signaling procedure where VSPT request messages upstream and downstream meet each other and there are three scenarios.</p>
<p id="rfc.section.4.3.2.p.2">Scenario (1): PCE(i) and PCE(i+1) receive messages request for VSPT(1,i+1) and VSPT(0,i) respectively after these two messages have been sent. Thus, PCE(i) stitches VSPT(0,i) and VSPT(1,i+1) into VSPG(i), whereas PCE(i+1) discards the message.</p>
<p id="rfc.section.4.3.2.p.3">Scenario (2): PCE(i) receives a message carrying VSPT(1,i+1) after it has received a message carrying VSPT(0,i), and it is unable to stop sending PCReq with computed VSPT(0,i) to PCE(i+1) immediately or the message has already been sent. Thus, PCE(i) stitches VSPT(0,i) and VSPT(1,i+1) into VSPG(i), whereas PCE(i+1) discards VSPT(0,i).</p>
<p id="rfc.section.4.3.2.p.4">Scenario (3): PCE(i+1) receives a message carrying VSPT(0,i) after it has received a message carrying VSPT(1,i+2), and it is unable to stop sending message carrying a computed VSPT(1,i+1) to PCE(i) immediately. Thus, PCE(i) stitches VSPT(0,i) and VSPT(1,i+1) into VSPG(i), whereas PCE(i+1) discards VSPT(0,i).</p>
<p id="rfc.section.4.3.2.p.5">The following steps are described to deal with these three situations in a uniform procedure. Denoting that PCE(m) is the Stitching PCE and it is the intersection of the two VSPTs.</p>
<p id="rfc.section.4.3.2.p.6">Step 1:</p>
<p id="rfc.section.4.3.2.p.7">PCE(1) computes VSPT(0,1), the tree made of the list of shortest constrained paths between the TE LSP source and every BN-en(j,2) by using a suitable path computation algorithm (e.g., CSPF) and returns the computed VSPT(0,1) to PCE(2).  This can be triggered by Parent PCE, PCC or spontaneously.</p>
<p id="rfc.section.4.3.2.p.8">Simultaneously, PCE(n) computes VSPT(1,n), the tree made of the list of shortest constrained paths between every BN-en(j,n) and the TE LSP destination using a suitable path computation algorithm (e.g., CSPF) and returns the computed VSPT(n) to PCE(n-1). This can be triggered by Parent PCE, PCE(n-1) or PCE(1) directly. It is highly recommended to drive PCE(n) to compute VSPT(1,n) by PCE chain and to relay PCReq message PCE-by-PCE downstream from PCE(1). This step is identical with that of Case (1).</p>
<p id="rfc.section.4.3.2.p.9">Step i: (Downstream)</p>
<p id="rfc.section.4.3.2.p.10">For i=2 to m: PCE(i) computes VSPT(0,i), the tree made of the shortest constrained paths between the TE LSP source and each BN-en(j,i+1). It does this by considering the information in VSPT(0,i-1) and its own TED including the links that provide connectivity from domain(i) to domain(i+1). If PCE(i) has already received a valid message request for VSPT(0,i) from PCE(i+1) which carries VSPT(1,i+1), it ignores the message once received from PCE(i-1) downstream. Otherwise PCE(i) returns the computed VSPT(0,i) to PCE(i+1).</p>
<p id="rfc.section.4.3.2.p.11">Step i: (Upstream)</p>
<p id="rfc.section.4.3.2.p.12">For i=n to m+1: PCE(i) computes VSPT(1,i), the tree made of the shortest constrained paths between each BN-en(j,i) and the TE LSP destination. It does this by considering the information in VSPT(1,i+1) and its own TED.  PCE(i) returns the computed VSPT(1,i) to PCE(i-1). If PCE(i) has already received a valid message request for VSPT(1,i-1) from PCE(i-1) which carries VSPT(0,i-1), it computes VSPT(0,i+1) and transfers the VSPT(0,i) to PCE(i+1).  Once a valid message carrying VSPT(1, i+1) received from PCE(i+1) after receiving VSPT(0, i-1) from PCE(i-1), PCE(i) stitches these two VSPTs into a VSPG(i).</p>
<p id="rfc.section.4.3.2.p.13">Both PCReq and PCRep message are permitted to trigger VSPT computation. It is recommended to use PCRep message to trigger the VSPT computation on the Middle PCE, and PCReq on the Source and Destination PCE. VSPT(0, i), VSPT(1, i) and VSPG(i) MUST be encoded in ERO, IRO, RRO, or XRO Objects (see [RFC5440] and [RFC5521]).</p>
<p id="rfc.section.4.3.2.p.14">The PCRep message which carries VSPG(m) or final ERO should be relayed from PCE(m) to PCE(1) upstream PCE-by-PCE. PCE(1) returns the final path computation result to PCC. The shortest path can be selected from VSPG(m) either by PCE(m) or PCE(1). These are identical with case (1).</p>
<h1 id="rfc.section.4.4">
<a href="#rfc.section.4.4">4.4.</a> An Example of PCE Collaboration</h1>
<p id="rfc.section.4.4.p.1">The following example is used for demonstrating PCE collaboration of DRPC procedure in this document. It uses the recommended PCEP message flow.</p>
<p id="rfc.section.4.4.p.2">Notes: </p>

<dl>
<dt></dt>
<dd style="margin-left: 8">- Only three domains are depicted in the diagram below for the sake of simplicity.</dd>
<dt></dt>
<dd style="margin-left: 8">- We assume that the Stitching PCE is in the middle of the PCE sequence, which may be determined by either of the two cases described in Section 4.3.</dd>
</dl>

<p> </p>
<div id="#rfc.figure.4"></div>
<div id="#An Example of DRPC Procedure"></div>
<pre> 
						
                                                                    
            (1.1)PCReq      ------------                            
        +-----------------&gt;| Parent PCE |                           
        |   (1.2)PCRep      ------------                            
        |                                                           
   -----+------             ------------             ------------   
  |     |      |           |  Domain 2  |           |  Domain 3  |  
  |     v      |           | (Stitcher) |           |            |  
  |   ------   | (2a)PCReq |   ------   | (3a)PCReq |   ------   |  
  |  | PCE1 |&lt;-+-----------+-&gt;| PCE2 |&lt;-+-----------+-&gt;| PCE3 |  |  
  |   ------   | (2b)PCRep |   ------   | (3b)PCRep |   ------   |  
  |     ^      | (4)PCRep  |            |           |            |  
  |  (1)|PCReq |            ------------             ------------   
  |  (5)|PCRep |                                                    
  |     v      |                                                    
  |   -----    |                                                    
  |  | PCC |   |                                                    
  |   -----    |                                                    
  |            |                                                    
  |  Domain 1  |                                                    
   ------------                                                     
                                                                     
 						
					</pre>
<p id="rfc.section.4.4.p.3">Workflows: </p>

<dl>
<dt></dt>
<dd style="margin-left: 8">(1) PCC sends a PCReq message to the Source PCE, requesting an end-to-end explicit route.</dd>
<dt></dt>
<dd style="margin-left: 8">(1.1) Source PCE sends a PCReq message to Parent PCE, requesting a PCE Sequence.</dd>
<dt></dt>
<dd style="margin-left: 8">(1.2) Parent PCE sends a PCReq message to Source PCE, replying the PCE Sequence.</dd>
<dt></dt>
<dd style="margin-left: 8">(2a) Once PCE(1) obtained the PCE Sequence by some means, it sends a PCReq message to PCE(2), asking for PCE(2) to relay this message to the Destination PCE. It expects the Destination PCE to compute VSPT(1, 3).</dd>
<dt></dt>
<dd style="margin-left: 8">(2b) Once PCE(1) obtained the PCE Sequence by some means, it computes VSPT(0, 1) and encapsulate this VSPT into a PCRep message. Then it sends this PCRep message to PCE(2) to launch a VSPT(0, 2) computation.</dd>
<dt></dt>
<dd style="margin-left: 8">(3a) Having received a PCReq message from PCE(1), PCE(2) sends a PCReq message to PCE(3), asking for PCE(3) to relay this message to the Destination PCE. </dd>
<dt></dt>
<dd style="margin-left: 8">(3b) Having received a PCReq message from PCE(2) and checked that the Destination PCE is itself, PCE(3) computes VSPT(1, 3) and encapsulate this VSPT into a PCRep message. Then it sends this PCRep message to PCE(2) to launch a VSPT(1, 2) computation.</dd>
<dt></dt>
<dd style="margin-left: 8">(4) The Stiching PCE stitches VSPT(0, 2) and VSPT(1, 2) into a VSPG(2). It may either select a shortest path from this VSPG and encapsulate it into a PCRep message or it may encapsulate the VSPG into a PCRep message. No matter which strategy is chosen, it sends back the PCRep message to PCE(1), the neighbor PCE along the upstream direction, expecting that PCE to relay this PCReq message to the Source PCE.</dd>
<dt></dt>
<dd style="margin-left: 8">(5) Having received a PCRep message from PCE(2) and checked that the Source PCE is itself, PCE(1) returns the final ERO to PCC by sending a PCRep message. If the received PCRep message contains a VSPG, PCE(1) selects the shortest path from the VSPG, or else PCE(1) relays the received PCRep message to PCC directly.</dd>
</dl>

<p> </p>
<p id="rfc.section.4.4.p.4">If the parent PCE which maintains the domain topology map of the child domains and their interconnectivity does not exist, the PCE sequence can be predetermined by other means such as administrative configuration, Network Management System(NMS)designated, non-shortest path computation without regard to detailed TE attributes, and etc. This way, the (1.1) and (1.2) steps are skipped.</p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> PCEP Protocol Extension Requirements</h1>
<p id="rfc.section.5.p.1">The two different DRPC procedures require the specification of new flags of the RP object carried within the PCReq message to specify that the shortest paths satisfying the constraints from the destination to the set of entry boundary nodes or from the source to the set of entry boundary nodes are requested.</p>
<p id="rfc.section.5.p.2">Note that IANA has already defined Bit 25 of the flags in RP Object for VSPT.</p>
<p id="rfc.section.5.p.3">The following new flags of the RP object is defined:</p>
<p></p>

<dl>
<dt>Bit Number</dt>
<dd style="margin-left: 17">Name Flag</dd>
<dt>16</dt>
<dd style="margin-left: 17">VSPG</dd>
</dl>

<p> When Bit 16 is set, it enables VSPG encoding in ERO, IRO, RRO, or XRO Object.  In PCReq message, when Bit 16 is set, it indicates that the Source PCE is response for path selection from VSPG rather than the Stitching PCE, which is defined in this document. Bit 16 is valid under the assumption that bit 17 is valid.  </p>
<p></p>

<dl>
<dt>Bit Number</dt>
<dd style="margin-left: 17">Name Flag</dd>
<dt>17</dt>
<dd style="margin-left: 17">DRPC VSPT Extension</dd>
</dl>

<p> In PCReq Message: </p>

<dl>
<dt>17</dt>
<dd style="margin-left: 17">1: Request for DRPC Procedure</dd>
</dl>

<p> In PCRep Message: </p>

<dl>
<dt>17</dt>
<dd style="margin-left: 17">0: from source PCE to Middle PCE for VSPT Extension</dd>
<dt></dt>
<dd style="margin-left: 17">1: from destination PCE to Middle PCE for VSPT Extension</dd>
</dl>

<p> </p>
<p id="rfc.section.5.p.6">In PCReq message, when Bit 17 is set, it indicates that the PCC requests the computation of an inter-domain TE LSP using the DRPC procedure defined in this document. In PCRep message Bit 17 is valid under the assumption that bit 25 is valid.</p>
<p id="rfc.section.5.p.7">Because path segments computed by the two end PCEs in the context of the DRPC procedure must be provided along with their respective path costs, the C flag of the METRIC object carried within the PCReq message must be set. It is the choice of the requester to appropriately set the O bit of the RP object.</p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> VSPG Encoding</h1>
<p id="rfc.section.6.p.1">The VSPG encoding objects must be returned within a PCRep message. The encoding consists of a non-ordered list of Explicit Route Objects (EROs) where each ERO represents a path from the source node to the destination node specified in the END-POINT object of the corresponding PCReq message from PCC to Source PCE.</p>
<p id="rfc.section.6.p.2">Example:</p>
<div id="#rfc.figure.5"></div>
<div id="#An Example of VSPG Encoding Using a Set of EROs"></div>
<pre> 

 
                                                                       
 &lt;---- area 1 -----&gt;&lt;-------- area 2 ---------&gt;&lt;----- area 3 ------&gt;  
  +--A--B---BNex1-1--BNen2-1---E---F---BNex2-1--BNen3-1---K----L--+   
  |                                                               |   
  |                                                               |   
  S----C----BNex1-2--BNen2-2---G---H---BNex2-2--BNen3-2-----M-----D   
                               |                                  |   
                               |                                  |   
                               +---J---BNex2-3--BNen3-3---N----P--+   
                                         |                     |      
                                         |                     |      
                                         +------BNen3-4---Q----+      
                                                                       


				</pre>
<p id="rfc.section.6.p.3">In the example shown in Figure 5, along the direction from the source node S to the destination node D, when the Stitching PCE completes the path computation and the Source PCE expects a VSPG to select the optimal path in it, four non-ordered EROs are transferred to PCE(1). The four EROs are as follows: </p>

<dl>
<dt> ERO[1 ]:</dt>
<dd>S---A---B---BN-ex(1,1)---BN-en(2,1)---E---F---BN-ex(2,1)---BN-en(3,1)---K---L---D</dd>
<dt> ERO[2 ]:</dt>
<dd>S---C---BN-ex(1,2)---BN-en(2,2)---G---H---BN-ex(2,2)---BN-en(3,2)---M---D</dd>
<dt> ERO[3 ]:</dt>
<dd>S---C---BN-ex(1,2)---BN-en(2,2)---G---J---BN-ex(2,3)---BN-en(3,3)---N---P---D</dd>
<dt> ERO[4 ]:</dt>
<dd>S---C---BN-ex(1,2)---BN-en(2,2)---G---J---BN-ex(2,3)---BN-en(3,4)---Q---P---D</dd>
</dl>

<p> </p>
<p id="rfc.section.6.p.4">Note that the (BN-ex, BN-en) pair can either be a pair of interfaces on a single ABR or two detached TE-Routers in different domains. In both cases they should be encoded to ERO sub-object specified in [RFC3209].</p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> DRPC Procedure Failures</h1>
<p id="rfc.section.7.p.1">If the DRPC procedure cannot be completed because a PCE along the domain does not recognize the procedure (VSPG flag of the RP object), the PCE sends a PCErr message to the parent PCE with an Error-Type=4 (not supported object), Error-value-4 (Unsupported parameter). Then the parent PCE sends the failure message to the other PCEs along the PCE chain. The corresponding path computation request is then cancelled by the PCE without further notification. The PCErr message must be relayed to the requesting PCC by the source PCE.</p>
<p id="rfc.section.7.p.2">PCEP-ERROR objects are used to report a PCEP protocol error and are characterized by an Error-Type which specifies the type of error and an Error-value that provides additional information about the error type. Both the Error-Type and the Error-Value are managed by IANA. A new Error-Type and the corresponding error value are defined here.</p>
<p></p>

<dl>
<dt>Error-type</dt>
<dd style="margin-left: 17">Meaning</dd>
<dt>14</dt>
<dd style="margin-left: 17">DRPC procedure completion failure</dd>
</dl>

<p> </p>
<p></p>

<dl>
<dt>Error-value</dt>
<dd style="margin-left: 17">Meaning</dd>
<dt>1</dt>
<dd style="margin-left: 17">DRPC procedure not supported by one or more PCEs along the domain path</dd>
</dl>

<p> </p>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> Path Computation Failures</h1>
<p id="rfc.section.8.p.1">If a PCE requires to relay a path computation request according to the DRPC procedure defined in this document to a downstream PCE and no such PCE is available, the PCE MUST cancel all the procedures of path computation on all the other PCEs along the PCE chain through the Source PCE, and send a path computation reply to the PCC using a PCRep message that contains a NO-PATH object. In such case, the NO-PATH object MUST carry a NO-PATH-VECTOR TLV with the newly defined bit named "DRPC Path Computation chain unavailable" set.</p>
<p id="rfc.section.8.p.2">Different from BRPC using bit 28, Bit 23 is defined here.</p>
<p></p>

<dl>
<dt>Bit Number</dt>
<dd style="margin-left: 17">Name Flag</dd>
<dt>23</dt>
<dd style="margin-left: 17">DRPC Path computation chain unavailable</dd>
</dl>

<p> </p>
<h1 id="rfc.section.9">
<a href="#rfc.section.9">9.</a> Security Considerations</h1>
<p id="rfc.section.9.p.1">TBD.</p>
<h1 id="rfc.section.10">
<a href="#rfc.section.10">10.</a> IANA Consideration</h1>
<h1 id="rfc.section.10.1">
<a href="#rfc.section.10.1">10.1.</a> New Flags Of The RP Object</h1>
<p id="rfc.section.10.1.p.1">New flags Of The RP Object is defined in this document (VSPG and VSPT-DRPC-Extension to be assigned by IANA).  </p>

<dl>
<dt>Bit Number</dt>
<dd style="margin-left: 17">Name Flag</dd>
<dt>16</dt>
<dd style="margin-left: 17">VSPG</dd>
<dt>17</dt>
<dd style="margin-left: 17">DRPC VSPT Extension</dd>
</dl>

<p> In PCReq Message: </p>

<dl>
<dt>17</dt>
<dd style="margin-left: 17">1: Request for DRPC Procedure</dd>
</dl>

<p> In PCRep Message: </p>

<dl>
<dt>17</dt>
<dd style="margin-left: 17">0: from source PCE to Middle PCE for VSPT Extension</dd>
<dt></dt>
<dd style="margin-left: 17">1: from destination PCE to Middle PCE for VSPT Extension</dd>
</dl>

<p> </p>
<p id="rfc.section.10.1.p.2">Bit 16 is valid under the assumption that bit 17 is valid.</p>
<p id="rfc.section.10.1.p.3">Bit 17 is valid under the assumption that bit 25 is valid in PCRep message.</p>
<h1 id="rfc.section.10.2">
<a href="#rfc.section.10.2">10.2.</a> New Error-Type and Error-Value</h1>
<p id="rfc.section.10.2.p.1">A new Error-Type is defined in this document (Error-Type and Error-value to be assigned by IANA).  </p>

<dl>
<dt>Error-type</dt>
<dd style="margin-left: 17">Meaning</dd>
<dt>14</dt>
<dd style="margin-left: 17">DRPC procedure completion failure</dd>
<dt>Error-value</dt>
<dd style="margin-left: 17">Meaning</dd>
<dt>1</dt>
<dd style="margin-left: 17">DRPC procedure not supported by one or more PCEs along the domain path</dd>
</dl>

<p> </p>
<h1 id="rfc.section.10.3">
<a href="#rfc.section.10.3">10.3.</a> New Flag Of The NO-PATH-VECTOR TLV</h1>
<p id="rfc.section.10.3.p.1">A new flag of the NO-PATH-VECTOR TLV defined in is specified in this document.(Bit 23 to be assigned by IANA) </p>

<dl>
<dt>Bit number</dt>
<dd style="margin-left: 17">Name Flag</dd>
<dt>23</dt>
<dd style="margin-left: 17">DRPC Path computation chain unavailable</dd>
</dl>

<p> </p>
<h1 id="rfc.section.11">
<a href="#rfc.section.11">11.</a> Acknowledgments</h1>
<p id="rfc.section.11.p.1">The RFC text was produced using Marshall Rose's xml2rfc tool.</p>
<h1 id="rfc.references">
<a href="#rfc.references">12.</a> References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFC's to Indicate Requirement Levels</a>", RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4665">[RFC4665]</b></td>
<td class="top">
<a title="Old Dog Consulting">Farrel, A.</a>, <a title="Cisco Systems, Inc.">Vasseur, J.-P.</a> and <a title="AT&amp;T">J. Ash</a>, "<a href="http://tools.ietf.org/html/rfc4655">A Path Computation Element (PCE)-Based Architecture</a>", RFC 4655, August 2006.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5441">[RFC5441]</b></td>
<td class="top">
<a title="Cisco Systems, Inc.">Vasseur, J.-P.</a>, <a title="BT Infonet">Zhang, R.</a>, <a title="Verizon">Bitar, N.</a> and <a title="Verizon">JL. Le Roux</a>, "<a href="http://tools.ietf.org/html/rfc5441">A Path Computation Element (PCE)-Based Architecture</a>", RFC 5441, April 2009.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5521">[RFC5521]</b></td>
<td class="top">
<a title="University of Electro-Communications">Oki, E.</a>, <a title="NTT">Takeda, T.</a> and <a title="Old Dog Consulting">A. Farrel</a>, "<a href="http://tools.ietf.org/html/rfc5521">Extensions to the Path Computation Element Communication Protocol (PCEP) for Route Exclusions</a>", RFC 5521, April 2009.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-pce-hierarchy-fwk">[I-D.ietf-pce-hierarchy-fwk]</b></td>
<td class="top">
<a title="Old Dog Consulting">King, D.</a> and <a title="Old Dog Consulting">A. Farrel</a>, "<a>The Application of the Path Computation Element Architecture to the Determination of a Sequence of Domains in MPLS &amp; GMPLS</a>", December 2009.</td>
</tr>
</tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Xihua Fu</span> 
	  <span class="n hidden">
		<span class="family-name">Fu</span>
	  </span>
	</span>
	<span class="org vcardline">ZTE Corporation</span>
	<span class="adr">
	  <span>West District,ZTE Plaza,No.10,Tangyan South Road,Gaoxin District</span>

	  <span class="vcardline">
		<span class="locality">Xi'an</span>,  
		<span class="region"></span>
		<span class="code">710065</span>
	  </span>
	  <span class="country-name vcardline">P.R.China</span>
	</span>
	<span class="vcardline">Phone: +8613798412242</span>

<span class="vcardline">EMail: <a href="mailto:fu.xihua@zte.com.cn">fu.xihua@zte.com.cn</a></span>

<span class="vcardline">URI: <a href="http://www.zte.com.cn/">http://www.zte.com.cn/</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Yuanlin Bao</span> 
	  <span class="n hidden">
		<span class="family-name">Bao</span>
	  </span>
	</span>
	<span class="org vcardline">ZTE Corporation</span>
	<span class="adr">
	  <span>5F,R&amp;D Building 3, ZTE Industrial Park, XiLi LiuXian Road</span>
<span>Nanshan District</span>

	  <span class="vcardline">
		<span class="locality">Shen Zhen</span>,  
		<span class="region"></span>
		<span class="code">518055</span>
	  </span>
	  <span class="country-name vcardline">P.R.China</span>
	</span>
	<span class="vcardline">Phone: +86 755 26773731</span>

<span class="vcardline">EMail: <a href="mailto:bao.yuanlin@zte.com.cn">bao.yuanlin@zte.com.cn</a></span>

<span class="vcardline">URI: <a href="http://www.zte.com.cn/">http://www.zte.com.cn/</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Yongli Zhao</span> 
	  <span class="n hidden">
		<span class="family-name">Zhao</span>
	  </span>
	</span>
	<span class="org vcardline">BUPT</span>
	<span class="adr">
	  <span>No.10,Xitucheng Road,Haidian District</span>

	  <span class="vcardline">
		<span class="locality">Beijing</span>,  
		<span class="region"></span>
		<span class="code">100876</span>
	  </span>
	  <span class="country-name vcardline">P.R.China</span>
	</span>
	<span class="vcardline">Phone: +8613811761857</span>

<span class="vcardline">EMail: <a href="mailto:yonglizhao@bupt.edu.cn">yonglizhao@bupt.edu.cn</a></span>

<span class="vcardline">URI: <a href="http://www.bupt.edu.cn/">http://www.bupt.edu.cn/</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Jie Zhang</span> 
	  <span class="n hidden">
		<span class="family-name">Zhang</span>
	  </span>
	</span>
	<span class="org vcardline">BUPT</span>
	<span class="adr">
	  <span>No.10,Xitucheng Road,Haidian District</span>

	  <span class="vcardline">
		<span class="locality">Beijing</span>,  
		<span class="region"></span>
		<span class="code">100876</span>
	  </span>
	  <span class="country-name vcardline">P.R.China</span>
	</span>
	<span class="vcardline">Phone: +8613911060930</span>

<span class="vcardline">EMail: <a href="mailto:lgr24@bupt.edu.cn">lgr24@bupt.edu.cn</a></span>

<span class="vcardline">URI: <a href="http://www.bupt.edu.cn/">http://www.bupt.edu.cn/</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Yuan Gu</span> 
	  <span class="n hidden">
		<span class="family-name">G</span>
	  </span>
	</span>
	<span class="org vcardline">BUPT</span>
	<span class="adr">
	  <span>No.10,Xitucheng Road,Haidian District</span>

	  <span class="vcardline">
		<span class="locality">Beijing</span>,  
		<span class="region"></span>
		<span class="code">100876</span>
	  </span>
	  <span class="country-name vcardline">P.R.China</span>
	</span>
	<span class="vcardline">Phone: +8613466734941</span>

<span class="vcardline">EMail: <a href="mailto:josephstrauss@yahoo.com.cn">josephstrauss@yahoo.com.cn</a></span>

<span class="vcardline">URI: <a href="http://www.bupt.edu.cn/">http://www.bupt.edu.cn/</a></span>

  </address>
</div>

</body>
</html>