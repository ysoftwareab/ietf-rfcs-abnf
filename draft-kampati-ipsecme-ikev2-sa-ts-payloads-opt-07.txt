



IPSECME Working Group                                         S. Kampati
Internet-Draft                                                    W. Pan
Intended status: Standards Track                                  Huawei
Expires: 24 January 2022                                      P. Wouters
                                                                   Aiven
                                                              M. Bharath
                                                                 Mavenir
                                                                 M. Chen
                                                                    CMCC
                                                            23 July 2021


            IKEv2 Optional SA&TS Payloads in Child Exchange
           draft-kampati-ipsecme-ikev2-sa-ts-payloads-opt-07

Abstract

   This document describes a method for reducing the size of the
   Internet Key Exchange version 2 (IKEv2) CREATE_CHILD_SA exchanges
   used for rekeying of the IKE or Child SA by replacing the SA and TS
   payloads with a Notify Message payload.  Reducing size and complexity
   of IKEv2 exchanges is especially useful for low power consumption
   battery powered devices.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on 24 January 2022.

Copyright Notice

   Copyright (c) 2021 IETF Trust and the persons identified as the
   document authors.  All rights reserved.






Kampati, et al.          Expires 24 January 2022                [Page 1]

Internet-Draft     IKEv2 Optional Child SA&TS Payloads         July 2021


   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents (https://trustee.ietf.org/
   license-info) in effect on the date of publication of this document.
   Please review these documents carefully, as they describe your rights
   and restrictions with respect to this document.  Code Components
   extracted from this document must include Simplified BSD License text
   as described in Section 4.e of the Trust Legal Provisions and are
   provided without warranty as described in the Simplified BSD License.

Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
   2.  Conventions Used in This Document . . . . . . . . . . . . . .   3
     2.1.  Requirements Language . . . . . . . . . . . . . . . . . .   3
   3.  Negotiation of Support for OPTIMIZED REKEY  . . . . . . . . .   4
   4.  Optimized Rekey of the IKE SA . . . . . . . . . . . . . . . .   4
   5.  Optimized Rekey of Child SAs  . . . . . . . . . . . . . . . .   5
   6.  Payload Formats . . . . . . . . . . . . . . . . . . . . . . .   5
     6.1.  OPTIMIZED_REKEY_SUPPORTED Notify  . . . . . . . . . . . .   5
     6.2.  OPTIMIZED_REKEY Notify  . . . . . . . . . . . . . . . . .   6
   7.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .   6
   8.  Operational Considerations  . . . . . . . . . . . . . . . . .   7
   9.  Security Considerations . . . . . . . . . . . . . . . . . . .   7
   10. Acknowledgments . . . . . . . . . . . . . . . . . . . . . . .   7
   11. Normative References  . . . . . . . . . . . . . . . . . . . .   7
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .   7

1.  Introduction

   The Internet Key Exchange protocol version 2 (IKEv2) [RFC7296] is
   used to negotiate Security Association (SA) parameters for the IKE SA
   and the Child SAs.  Cryptographic key material for these SAs have a
   limited lifetime before it needs to be refreshed, a process referred
   to as "rekeying".  IKEv2 uses the CREATE_CHILD_SA exchange to rekey
   either the IKE SA or the Child SAs.

   When rekeying, a full set of previously negotiated parameters are
   exchanged.  However, most of these parameters will be the same, and
   some of these parameters MUST be the same.












Kampati, et al.          Expires 24 January 2022                [Page 2]

Internet-Draft     IKEv2 Optional Child SA&TS Payloads         July 2021


   For example, the Traffic Selector (TS) negotiated for the new Child
   SA MUST cover the Traffic Selectors negotiated for the old Child SA.
   And in practically all cases, a new Child SA would not need to cover
   more Traffic Selectors.  In the rare case where this would be needed,
   a new Child SA could be negotiated instead of the current Child SA
   being rekeyed.  Similarly, IKEv2 states that the cryptographic
   parameters negotiated for rekeying SHOULD NOT be different.  This
   means that the security properties of the IKE or Child SA in practise
   do not change during a typical rekey.

   This document specifies a method to omit these parameters and replace
   them with a single Notify Message declaring that all these parameters
   are identical to the originally negotiated parameters.

   For security gateways/ePDG in 4G networks or cRAN/Cloud gateways in
   5G networks, gateways typically support more than 100,000 IKE/IPSec
   tunnels.  At any point in time, there will be hundreds or thousands
   of IKE SAs and Child SAs that are being rekeyed.  This takes a large
   amount of bandwidth and CPU power and any protocol simplification or
   bandwidth reducing would result in an significant resource saving.

   For Internet of Things (IoT) devices which utilize low power
   consumption technology, reducing the size of rekey exchange reduces
   its power consumption, as sending bytes over the air is usually the
   most power consuming operation of such a device.  Reducing the CPU
   operations required to verify the rekey exchanges parameters will
   also save power and extend the lifetime for these devices.

   When using identical parameters during the IKE or Child SA rekey, the
   SA and TS payloads can be omitted.  For an IKE SA rekey, instead of
   the (large) SA payload, only a Key Exchange (KE) payload and a new
   Notify Type payload with the new SPI is required.  For a Child SA
   payload, instead of the SA or TS payloads, only an optional Nonce
   payload (when using PFS) and a new Notify Type payload with the new
   SPI is needed.  This makes the rekey exchange packets much smaller
   and the peers do not need to verify that the SA or TS parameters are
   compatible with the old SA.

2.  Conventions Used in This Document

2.1.  Requirements Language

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in BCP
   14 [RFC2119] [RFC8174] when, and only when, they appear in all
   capitals, as shown here.




Kampati, et al.          Expires 24 January 2022                [Page 3]

Internet-Draft     IKEv2 Optional Child SA&TS Payloads         July 2021


3.  Negotiation of Support for OPTIMIZED REKEY

   To indicate support for the optimized rekey negotiation, the
   initiator includes the OPTIMIZED_REKEY_SUPPORTED Notify payload in
   the IKE_AUTH exchange request.  A responder that supports the
   optimized rekey exchange includes the OPTIMIZED_REKEY_SUPPORTED
   Notify payload in its response.  Note that the notify indicates
   support for optimized rekey for both IKE and Child SAs.

   When a peer wishes to rekey an IKE SA or Child SA, it MAY use the
   optimized rekey method during the CREATE_CHILD_SA exchange.  A
   responder MUST accept that the initiator uses a regular or optimized
   rekey.

   The IKE_AUTH message exchange in this case is shown below:

   Initiator                         Responder
   --------------------------------------------------------------------
   HDR, SK {IDi, [CERT,] [CERTREQ,]
       [IDr,] AUTH, SAi2, TSi, TSr,
       N(OPTIMIZED_REKEY_SUPPORTED)} -->
                                 <-- HDR, SK {IDr, [CERT,] AUTH,
                                         SAr2, TSi, TSr,
                                         N(OPTIMIZED_REKEY_SUPPORTED)}

   If the responder does not support this extension, as per regular
   IKEv2 processing, it MUST ignore the unknown Notify payload.  The
   initiator will notice the lack of the OPTIMIZED_REKEY_SUPPORTED
   Notify in the reply and thus know it cannot use the optimized rekey
   method.

4.  Optimized Rekey of the IKE SA

   The initiator of an optimized rekey request sends a CREATE_CHILD_SA
   payload with the OPTIMIZED_REKEY notify payload containing the new
   Security Parameter Index (SPI) for the new IKE SA.  It omits the SA
   payload.

   The responder of an optimized rekey request performs the same
   process.  It includes the OPTIMIZED_REKEY notify with its new IKE SPI
   and omits the SA payload.

   Both parties send Nonce and KE payloads just as they would do for a
   regular IKE SA rekey.

   The CREATE_CHILD_SA message exchange in this case is shown below:





Kampati, et al.          Expires 24 January 2022                [Page 4]

Internet-Draft     IKEv2 Optional Child SA&TS Payloads         July 2021


   Initiator                         Responder
   --------------------------------------------------------------------
   HDR, SK {N(OPTIMIZED_REKEY),
       Ni, KEi} -->
                                 <-- HDR, SK {N(OPTIMIZED_REKEY),
                                         Nr, KEr}

5.  Optimized Rekey of Child SAs

   The initiator of an optimized rekey request sends a CREATE_CHILD_SA
   payload with the OPTIMIZED_REKEY notify payload containing the new
   Security Parameter Index (SPI) for the new Child SA.  It omits the SA
   and TS payloads.  If the current Child SA was negotiated with Perfect
   Forward Secrecy (PFS), a KEi payload MUST be included as well.  If no
   PFS was negotiated for the current Child SA, a KEi payload MUST NOT
   be included.

   The responder of an optimized rekey request performs the same
   process.  It includes the OPTIMIZED_REKEY notify with its new IKE SPI
   and omits the SA and TS payloads.  Depending on the PFS negotiation
   of the current Child SA, the responder includes a KEr payload.

   Both parties send Nonce payloads just as they would do for a regular
   Child SA rekey.

   Using the received old SPI from the REKEY_SA payload and the new SPI
   received from the OPTIMIZED_REKEY payload, both parties can perform
   the Child SA rekey operation.

   The CREATE_CHILD_SA message exchange in this case is shown below:

   Initiator                         Responder
   --------------------------------------------------------------------
   HDR, SK {N(REKEY_SA), N(OPTIMIZED_REKEY),
       Ni, [KEi,]} -->
                                 <-- HDR, SK {N(OPTIMIZED_REKEY),
                                         Nr, [KEr,]}

6.  Payload Formats

6.1.  OPTIMIZED_REKEY_SUPPORTED Notify

   The OPTIMIZED_REKEY_SUPPORTED Notify Message type notification is
   used by the initiator and responder to indicate their support for the
   optimized rekey negotiation.






Kampati, et al.          Expires 24 January 2022                [Page 5]

Internet-Draft     IKEv2 Optional Child SA&TS Payloads         July 2021


                        1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   | Next Payload  |C|  RESERVED   |         Payload Length        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |Protocol ID(=0)| SPI Size (=0) |      Notify Message Type      |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   *  Protocol ID (1 octet) - MUST be 0.

   *  SPI Size (1 octet) - MUST be 0, meaning no SPI is present.

   *  Notify Message Type (2 octets) - MUST be set to the value [TBD1].

   This Notify Message type contains no data.

6.2.  OPTIMIZED_REKEY Notify

   The OPTIMIZED_REKEY Notify Message type is used to perform an
   optimized IKE SA or Child SA rekey.

    0                 1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   | Next Payload  |C|  RESERVED   |         Payload Length        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |Protocol ID    | SPI Size (=8) |      Notify Message Type      |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                Security Parameter Index (SPI)                 |
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   *  Protocol ID (1 octet) - MUST be 1.

   *  SPI Size (1 octet) - MUST be 8 when rekeying an IKE SA.  MUST be 4
      when rekeying a Child SA.

   *  Notify Message Type (2 octets) - MUST be set to the value [TBD2].

   *  SPI (4 octets or 8 octets) - Security Parameter Index.  The peer's
      new SPI.

7.  IANA Considerations

   This document defines two new Notify Message Types in the "IKEv2
   Notify Message Types - Status Types" registry.  IANA is requested to
   assign codepoints in this registry.




Kampati, et al.          Expires 24 January 2022                [Page 6]

Internet-Draft     IKEv2 Optional Child SA&TS Payloads         July 2021


   NOTIFY messages: status types            Value
   ----------------------------------------------------------
   OPTIMIZED_REKEY_SUPPORTED                TBD1
   OPTIMIZED_REKEY                          TBD2

8.  Operational Considerations

   Some implementations allow sending rekey messages with a different
   set of Traffic Selectors or cryptographic parameters in response to a
   configuration update.  IKEv2 states this SHOULD NOT be done.  Whether
   or not optimized rekeying is used, a configuration change that
   changes the Traffic Selectors or cryptographic parameters MUST NOT
   use the optimized rekey method.  It SHOULD also not use a regular
   rekey method but instead start an entire new IKE and Child SA
   negotiation with the new parameters.

9.  Security Considerations

   The optimized rekey removes sending unnecessary new parameters that
   originally would have to be validated against the original
   parameters.  In that sense, this optimization enhances the security
   of the rekey process.

10.  Acknowledgments

   Special thanks go to Paul Wouters, Valery Smyslov, and Antony Antony.

11.  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <https://www.rfc-editor.org/info/rfc2119>.

   [RFC7296]  Kaufman, C., Hoffman, P., Nir, Y., Eronen, P., and T.
              Kivinen, "Internet Key Exchange Protocol Version 2
              (IKEv2)", STD 79, RFC 7296, DOI 10.17487/RFC7296, October
              2014, <https://www.rfc-editor.org/info/rfc7296>.

   [RFC8174]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in RFC
              2119 Key Words", BCP 14, RFC 8174, DOI 10.17487/RFC8174,
              May 2017, <https://www.rfc-editor.org/info/rfc8174>.

Authors' Addresses

   Sandeep Kampati
   Huawei Technologies
   Divyashree Techno Park, Whitefield



Kampati, et al.          Expires 24 January 2022                [Page 7]

Internet-Draft     IKEv2 Optional Child SA&TS Payloads         July 2021


   Bangalore 560066
   Karnataka
   India

   Email: sandeepkampati@huawei.com


   Wei Pan
   Huawei Technologies
   101 Software Avenue, Yuhuatai District
   Nanjing
   Jiangsu,
   China

   Email: william.panwei@huawei.com


   Paul Wouters
   Aiven

   Email: paul.wouters@aiven.io


   Meduri S S Bharath
   Mavenir Systems Pvt Ltd
   Manyata Tech Park
   Bangalore
   Karnataka
   India

   Email: bharath.meduri@mavenir.com


   Meiling Chen
   China Mobile
   32 Xuanwumen West Street, West District
   Beijing
   Beijing, 100053
   China

   Email: chenmeiling@chinamobile.com










Kampati, et al.          Expires 24 January 2022                [Page 8]
