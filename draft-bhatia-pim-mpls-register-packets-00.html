<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Replacing PIM Register packets with MPLS encapsulation</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.2" rel="Chapter" title="2 Mechanism">
<link href="#rfc.section.3" rel="Chapter" title="3 Handling Null-Register Probes">
<link href="#rfc.section.4" rel="Chapter" title="4 Handling Register-Stop Messages">
<link href="#rfc.section.5" rel="Chapter" title="5 Security Considerations">
<link href="#rfc.section.6" rel="Chapter" title="6 Acknowledgements">
<link href="#rfc.section.7" rel="Chapter" title="7 IANA Considerations">
<link href="#rfc.references" rel="Chapter" title="8 References">
<link href="#rfc.references.1" rel="Chapter" title="8.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="8.2 Informative References">
<link href="#rfc.appendix.Appendix%20A" rel="Chapter" title="Appendix A Appendix">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="In PIM-SM the designated router (DR) closest to the source keeps sending PIM register packets till it receives an explicit Register-Stop message from the rendezvous point (RP) router. The process of encapsulating multicast data traffic to the RP, and the decapsulation done by RP are relatively expensive operations for a router to perform, depending upon whether or not the router has appropriate hardware support for these tasks." />
  <meta name="description" content="In PIM-SM the designated router (DR) closest to the source keeps sending PIM register packets till it receives an explicit Register-Stop message from the rendezvous point (RP) router. The process of encapsulating multicast data traffic to the RP, and the decapsulation done by RP are relatively expensive operations for a router to perform, depending upon whether or not the router has appropriate hardware support for these tasks." />
  <meta name="keywords" content="" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">PIM Working Group</td>
<td class="right">M.B. Bhatia</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Alcatel-Lucent</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">February 11, 2011</td>
</tr>
<tr>
<td class="left">Expires: August 15, 2011</td>
<td class="right"></td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Replacing PIM Register packets with MPLS encapsulation<br />
  <span class="filename">draft-bhatia-pim-mpls-register-packets-00</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>In PIM-SM the designated router (DR) closest to the source keeps sending PIM register packets till it receives an explicit Register-Stop message from the rendezvous point (RP) router. The process of encapsulating multicast data traffic to the RP, and the decapsulation done by RP are relatively expensive operations for a router to perform, depending upon whether or not the router has appropriate hardware support for these tasks.</p>
<p>Since the PIM register messages are native IP packets and routed based on IP forwarding tables no resource reservation mechanisms are available. All IP packets will follow common paths that are defined by the traditional IGP's algorithm and customizing the path for multicast applications is impossible.  </p>
<p>This document proposes using MPLS tunnel(s) to send traffic from the source to the RP till the shortest path tree (SPT) from the RP to the source is established. Processing MPLS packets is easy and is readily supported on most platforms.</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on August 15, 2011.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>2.   <a href="#rfc.section.2">Mechanism</a>
</li>
<li>3.   <a href="#rfc.section.3">Handling Null-Register Probes</a>
</li>
<li>4.   <a href="#rfc.section.4">Handling Register-Stop Messages</a>
</li>
<li>5.   <a href="#rfc.section.5">Security Considerations</a>
</li>
<li>6.   <a href="#rfc.section.6">Acknowledgements</a>
</li>
<li>7.   <a href="#rfc.section.7">IANA Considerations</a>
</li>
<li>8.   <a href="#rfc.references">References</a>
</li>
<li>8.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>8.2.   <a href="#rfc.references.2">Informative References</a>
</li>
<li>Appendix A.   <a href="#rfc.appendix.Appendix%20A">Appendix</a>
</li>
<li><a href="#rfc.authors">Author's Address</a>
</li>


  </ul>

  <p id="rfc.section..p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in RFC2119<a href="#RFC2119">[RFC2119]</a>.</p>
<p id="rfc.section..p.2">When used in lower case, these words convey their typical use in common language, and are not to be interpreted as described in RFC2119<a href="#RFC2119">[RFC2119]</a>.</p>
<h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> Introduction</h1>
<p id="rfc.section.1.p.1">PIM-SM <a href="#RFC4601">[RFC4601]</a>DR encapsulates all multicast packets that it receives directly from the source and sends these unicast to the RP for that group. The multicast  data traffic is encapsulated in PIM Register packets. These packets convey the source address, S, and the group address, G to the RP.</p>
<p id="rfc.section.1.p.2">The RP decapsulates the PIM Register packets and forwards them natively down the RPT. Additionally, the RP joins the SPT by sending a (S,G) Join to its RPF neighbor for the source and waits till it starts receiving multicast packets natively directly from the source. Till this happens, the RP must extract the multicast data traffic from every PIM Register packet it receives for the (S,G) pair that needs to be forwarded down the RPT natively.</p>
<p id="rfc.section.1.p.3">Encapsulation and Decapsulation are expensive operations for routers and the latter, especially, as it entails a double lookup that many routers cannot do in hardware.  It is for this reason that several off the shelf chips do not support decapsulating the PIM Register packets. Any router that cannot decapsulate the PIM Register packet in hardware must send all this traffic to CPU, where its decapsulated, and forwarded based on the multicast forwarding table. This increases the load on the CPU and also makes the router susceptible for DoS attacks. Also, since Register packets are unicast, then can be easily spoofed and an attacker can use this to attack the router and thus the network.</p>
<p id="rfc.section.1.p.4">This document attempts to solve the above problems by doing away with the PIM Register packets. It instead proposes using an MPLS tunnel to send all multicast data traffic till an SPT is formed. This eliminates the complexity of decapsulating PIM register packets on the RP as it now only needs to pop off the MPLS labels before forwarding the native packet down the RPT.</p>
<p id="rfc.section.1.p.5">The mechanism described in this draft is only applicable when both DR and the RP are MPLS capable and exist in an environment where they can use MPLS in data plane.</p>
<p id="rfc.section.1.p.6">Additionally there are other advantages in using MPLS as a transport mechanism over the native IP that PIM register traditionally uses. Operators can set up resource reservation along the entire path requesting a certain level of QoS for the multicast flow across the network.  It simplifies operations by providing a common operational framework for unicast and multicast traffic. The failover time is very less because of MPLS FRR mechanisms - something that&#8217;s unachievable when using traditional IP.</p>
<p id="rfc.section.1.p.7">This document is only applicable to PIM-SM in the ASM (Any Source Multicast)  mode and introduces no change to PIM-SSM (Source Specific Multicast).  This is because there is no concept of an RP in the latter.</p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> Mechanism</h1>
<p id="rfc.section.2.p.1">The DR close to the source MUST set up an MPLS RSVP-TE tunnel <a href="#RFC3936">[RFC3936]</a> between itself and the RP. The operator can use various constraints in setting up the tunnel.  This tunnel would be used for sending all multicast data traffic till the RP is able to receive multicast traffic natively through the SPT.</p>
<p id="rfc.section.2.p.2">It is suggested that this tunnel be established ahead of time as soon as the RP is configured so that there is no signaling involved when receiving data traffic from the source. A discussion about the life of the tunnel is beyond the scope of this draft and an operator could keep it for as long as there is traffic expected from the source.</p>
<p id="rfc.section.2.p.3">Implementations can either set up one RSVP-TE tunnel between the DR and the RP or multiple tunnels with different constraints per  multicast group, G.</p>
<p id="rfc.section.2.p.4">This draft introduces no changes in how the DR sends the Register packets. The same rules apply as defined in<a href="#RFC4601">[RFC4601]</a>. The only thing that changes is that the DR MUST send Register packets using the tunnel, instead of the regular registration encapsulation that&#8217;s defined in <a href="#RFC4601">[RFC4601]</a>.</p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#NullProbes" id="NullProbes">Handling Null-Register Probes</a>
</h1>
<p id="rfc.section.3.p.1">Implementations MAY use the RSVP-TE tunnel established between the DR and the RP to send Null-Register Probes or can continue sending them as specified in <a href="#RFC4601">[RFC4601]</a>.</p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#RegisterStops" id="RegisterStops">Handling Register-Stop Messages</a>
</h1>
<p id="rfc.section.4.p.1">Implementations should continue sending Register-Stop messages as described in <a href="#RFC4601">[RFC4601]</a>. While there is nothing that prevents routers from establishing a reverse MPLS RSVP-TE tunnel from the RP to the DR that could be used for transporting these messages,  there isn't too much that one would gain by doing that. It is thus suggested that there should be no change in how the Register-Stop messages are sent.</p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#Security" id="Security">Security Considerations</a>
</h1>
<p id="rfc.section.5.p.1">This document does not introduce any new security concerns. In fact, it reduces the risk of an attacker spoofing PIM Register packets.</p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#ACK" id="ACK">Acknowledgements</a>
</h1>
<p id="rfc.section.6.p.1">Thanks to Stig Venaas for all his comments and feedback that resulted in significant improvement of this document.</p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> <a href="#IANA" id="IANA">IANA Considerations</a>
</h1>
<p id="rfc.section.7.p.1">This document places no requests to IANA.</p>
<h1 id="rfc.references">
<a href="#rfc.references">8.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">8.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4601">[RFC4601]</b></td>
<td class="top">
<a>Fenner, B.</a>, <a>Handley, M.</a>, <a>Holbrook, H.</a> and <a>I. Kouvelas</a>, "<a href="http://tools.ietf.org/html/rfc4601">Protocol Independent Multicast - Sparse Mode (PIM-SM): Protocol Specification (Revised)</a>", RFC 4601, August 2006.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">8.2.</a> Informative References</h1>
<table><tbody><tr>
<td class="reference"><b id="RFC3936">[RFC3936]</b></td>
<td class="top">
<a>Kompella, K.</a> and <a>J. Lang</a>, "<a href="http://tools.ietf.org/html/rfc3936">Procedures for Modifying the Resource reSerVation Protocol (RSVP)</a>", BCP 96, RFC 3936, October 2004.</td>
</tr></tbody></table>
<h1 id="rfc.appendix.Appendix A">
<a href="#rfc.appendix.Appendix%20A">Appendix A.</a> <a href="#Appendix" id="Appendix">Appendix</a>
</h1>
<p id="rfc.section.Appendix A.p.1">As mentioned earlier, there is no change in the exchange that occurs between the DR and the RP. This section just describes it in case someone would like to get more clarity on how the RSVP-TE tunnel is used.</p>
<p id="rfc.section.Appendix A.p.2">When the DR receives multicast traffic directly from the source for a multicast group it will not encapsulate this in a PIM Register packet. It will instead forward this traffic over the MPLS tunnel that has been established between the DR and the RP. The RP will receive this traffic over the RSVP-TE tunnel and will pop off the label, before sending it natively over the RPT towards the listeners.</p>
<p id="rfc.section.Appendix A.p.3">When the RP joins the SPT by sending (S,G) Join to its RPF neighbor for the source it will wait till it starts receiving packets natively before sending a Register-Stop message. Meanwhile, it will continue using the traffic that arrives on the RSVP-TE tunnel and will forward it natively on the RPT tree.</p>
<p id="rfc.section.Appendix A.p.4">Upon receiving the Register-Stop message, the DR MUST stop sending the multicast data traffic over the RSVP-TE tunnel and should start a Register-Stop timer for the (S,G) pair.  The DR can periodically send a Null-Register to the RP over the tunnel.  The Null-Register message will be used to probe the RP to determine whether the DR needs to start sending normal multicast data traffic over the tunnel to the RP for the (S,G) pair.</p>
<p id="rfc.section.Appendix A.p.5">The RP upon receiving a Null-Register needs to decide if it wants to send a Register-Stop message back to the DR based on whether its receiving traffic natively or not. If the RP sends a Register-Stop, the Register-Stop timer on the DR is reset before it expires, and the DR does not start sending data over the RSVP-TE tunnel again.</p>
<p id="rfc.section.Appendix A.p.6">If the Register-Stop is not sent and the DR's Register-Stop timer expires, the DR MUST start sending multicast data traffic over the MPLS tunnel to the RP until it receives another Register-Stop.</p>
<h1 id="rfc.authors"><a href="#rfc.authors">Author's Address</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Manav Bhatia</span> 
	  <span class="n hidden">
		<span class="family-name">Bhatia</span>
	  </span>
	</span>
	<span class="org vcardline">Alcatel-Lucent</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality">Bangalore</span>,  
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline">India</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:manav.bhatia@alcatel-lucent.com">manav.bhatia@alcatel-lucent.com</a></span>

  </address>
</div>

</body>
</html>