IKM-Sender    = Sender Pub Key | Recipient Pub Key | Shared Secret
IKM-Recipient = Recipient Pub Key | Sender Pub Key | Shared Secret

ENC_SIGNATURE = SIGNATURE XOR KEYSTREAM

KEYSTREAM = HKDF(salt, IKM, info, L)

info = [
     id : bstr,
     id_context : bstr,
     type : bool,
     L: uint
external_aad = bstr .cbor aad_array

aad_array = [
        oscore_version : uint,
        algorithms : [alg_aead : int / tstr / null,
                      alg_signature_enc : int / tstr / null,
                      alg_signature : int / tstr / null,
                      alg_pairwise_key_agreement : int / tstr / null],
        request_kid : bstr,
        request_piv : bstr,
        options : bstr,
        request_kid_context : bstr,
        OSCORE_option: bstr,
        sender_public_key: bstr,
        gm_public_key: bstr / null
SIGNATURE = ENC_SIGNATURE XOR KEYSTREAM

SIGNATURE = ENC_SIGNATURE XOR KEYSTREAM

SIGNATURE = ENC_SIGNATURE XOR KEYSTREAM

