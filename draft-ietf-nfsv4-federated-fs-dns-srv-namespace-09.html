<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Using DNS SRV to Specify a Global File Name Space with NFS version 4 </title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Requirements notation">
<link href="#rfc.section.2" rel="Chapter" title="2 Background">
<link href="#rfc.section.3" rel="Chapter" title="3 Use of SRV Resource Record in DNS">
<link href="#rfc.section.4" rel="Chapter" title="4 Integration with Use of NFS Version 4">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 Globally-useful names: conventional mount point">
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 Mount options">
<link href="#rfc.section.4.3" rel="Chapter" title="4.3 Filesystem integration issues">
<link href="#rfc.section.4.4" rel="Chapter" title="4.4 Multicast, mDNS, and DNS-SD">
<link href="#rfc.section.5" rel="Chapter" title="5 Where is this integration carried out?">
<link href="#rfc.section.6" rel="Chapter" title="6 Security Considerations">
<link href="#rfc.section.7" rel="Chapter" title="7 IANA Considerations">
<link href="#rfc.references" rel="Chapter" title="8 References">
<link href="#rfc.references.1" rel="Chapter" title="8.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="8.2 Informative References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="The NFS version 4 protocol provides a mechanism for a collection of NFS file servers to collaborate in providing an organization-wide file name space.  The DNS SRV RR allows a simple and appropriate way for an organization to publish the root of its filesystem name space, even to clients that might not be intimately associated with such an organization.  The DNS SRV RR can be used to join these organization-wide file name spaces together to allow construction of a global, uniform NFS file name space.  " />
  <meta name="description" content="The NFS version 4 protocol provides a mechanism for a collection of NFS file servers to collaborate in providing an organization-wide file name space.  The DNS SRV RR allows a simple and appropriate way for an organization to publish the root of its filesystem name space, even to clients that might not be intimately associated with such an organization.  The DNS SRV RR can be used to join these organization-wide file name spaces together to allow construction of a global, uniform NFS file name space.  " />
  <meta name="keywords" content="" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Network Working Group</td>
<td class="right">C. Everhart</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">NetApp</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">W.A. Adamson</td>
</tr>
<tr>
<td class="left">Expires: April 09, 2012</td>
<td class="right">NetApp</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">J. Zhang</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Google</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">October 07, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Using DNS SRV to Specify a Global File Name Space with NFS version 4 <br />
  <span class="filename">draft-ietf-nfsv4-federated-fs-dns-srv-namespace-09.txt</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>The NFS version 4 protocol provides a mechanism for a collection of NFS file servers to collaborate in providing an organization-wide file name space.  The DNS SRV RR allows a simple and appropriate way for an organization to publish the root of its filesystem name space, even to clients that might not be intimately associated with such an organization.  The DNS SRV RR can be used to join these organization-wide file name spaces together to allow construction of a global, uniform NFS file name space.  </p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on April 09, 2012.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>
<p>This document may contain material from IETF Documents or IETF Contributions published or made publicly available before November 10, 2008.  The person(s) controlling the copyright in some of this material may not have granted the IETF Trust the right to allow modifications of such material outside the IETF Standards Process. Without obtaining an adequate license from the person(s) controlling the copyright in such materials, this document may not be modified outside the IETF Standards Process, and derivative works of it may not be created outside the IETF Standards Process, except to format it for publication as an RFC or to translate it into languages other than English.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Requirements notation</a>
</li>
<li>2.   <a href="#rfc.section.2">Background</a>
</li>
<li>3.   <a href="#rfc.section.3">Use of SRV Resource Record in DNS</a>
</li>
<li>4.   <a href="#rfc.section.4">Integration with Use of NFS Version 4</a>
</li>
<li>4.1.   <a href="#rfc.section.4.1">Globally-useful names: conventional mount point</a>
</li>
<li>4.2.   <a href="#rfc.section.4.2">Mount options</a>
</li>
<li>4.3.   <a href="#rfc.section.4.3">Filesystem integration issues</a>
</li>
<li>4.4.   <a href="#rfc.section.4.4">Multicast, mDNS, and DNS-SD</a>
</li>
<li>5.   <a href="#rfc.section.5">Where is this integration carried out?</a>
</li>
<li>6.   <a href="#rfc.section.6">Security Considerations</a>
</li>
<li>7.   <a href="#rfc.section.7">IANA Considerations</a>
</li>
<li>8.   <a href="#rfc.references">References</a>
</li>
<li>8.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>8.2.   <a href="#rfc.references.2">Informative References</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> Requirements notation</h1>
<p id="rfc.section.1.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">[RFC2119]</a>.</p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> Background</h1>
<p id="rfc.section.2.p.1">Version 4 of the NFS protocol <a href="#RFC3530">[RFC3530]</a> introduced the fs_locations attribute.  Use of this attribute was elaborated further in the NFS Version 4 Minor Version 1 protocol <a href="#RFC5661">[RFC5661]</a>, which also defined an extended version of the attribute as fs_locations_info.  With the advent of these attributes, NFS servers can cooperate to build a file name space that crosses server boundaries.  The fs_locations and fs_locations_info attributes are used as referrals, so that a file server may indicate to its client that the file name tree beneath a given name in the server is not present on itself, but is represented by a filesystem in some other set of servers.  The mechanism is general, allowing servers to describe any filesystem as being reachable by requests to any of a set of servers.  Thus, starting with a single NFS Version 4 server, using these referrals, an NFS Version 4 client could see a large name space associated with a collection of interrelated NFS Version 4 file servers.  An organization could use this capability to construct a uniform file name space for itself.  </p>
<p id="rfc.section.2.p.2">An organization might wish to publish the starting point for this name space to its clients.  In many cases, the organization will want to publish this starting point to a broader set of possible clients.  At the same time, it is useful to require clients to know only the smallest amount of information in order to locate the appropriate name space.  Simultaneously, that required information should be constant through the life of an organization if the clients are not to require reconfiguration as administrative events change, for instance, a server's name or address.  </p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> Use of SRV Resource Record in DNS</h1>
<p id="rfc.section.3.p.1">Providing an organization's published filesystem name space is a service, and the DNS <a href="#RFC1034">[RFC1034]</a><a href="#RFC1035">[RFC1035]</a> provides methods for discovery of that service.  This standard defines a mapping from a domain name to the NFS filesystem(s) associated with that name; such filesystems are called "domain root" filesystems.  From such filesystems, like other NFS filesystems, an NFS client can use the standard NFS mechanisms to navigate the rest of the NFS file servers that make up the filesystem name space for the given domain.  </p>
<p id="rfc.section.3.p.2">Such "domain root" filesystems are mounted at a conventional point in the NFS client namespace.  The mechanism results in a uniform cross-organizational file name space, similar to that seen in both AFS <a href="#AFS">[AFS]</a><a href="#RFC5864">[RFC5864]</a> and DCE/DFS <a href="#DFS">[DFS]</a>.  An NFS client need know only the domain name for an organization in order to locate the filesystem name space published by that organization.  </p>
<div id="#rfc.figure.1"></div>
<p></p>

<p>The DNS SRV resource record type <a href="#RFC2782">[RFC2782]</a> is used to locate "domain root" file servers.  The format of the DNS SRV record is as follows: </p>
<pre>
   _Service._Proto.Name TTL Class SRV Priority Weight Port Target
</pre>
<p>The Service name is "_nfs._domainroot".  The Protocol as of this writing could be either "_tcp" or "_sctp"; version 4 NFS is not defined over UDP.  Other transport protocols could be defined in the future, and SRV records that advertise domain root file services with other transport protocols would use the same Service name.  The Target fields give the domain names of the NFS servers that export filesystems for the domain's root.  An NFS client may then interpret any of the exported root filesystems as the filesystem published by the organization with the given domain name.  </p>
<p id="rfc.section.3.p.4">In order to allow the NFSv4 servers so given to export a variety of filesystems, those file servers MUST export the given domain's root filesystems at "/.domainroot-{Name}" within their pseudo-filesystems, where the "{Name}" is the name of the organization as used in the SRV RR.  </p>
<div id="#rfc.figure.2"></div>
<p></p>

<p>As an example, suppose a client wished to locate the root of the filesystem published by organization example.net.  The DNS servers for the domain would publish records like </p>
<pre>
   $ORIGIN example.net.
   _nfs._domainroot._tcp IN SRV 0 0 2049 nfs1tr.example.net.
   _nfs._domainroot._tcp IN SRV 1 0 2049 nfs2ex.example.net.
</pre>
<p>The result domain names nfs1tr.example.net and nfs2ex.example.net indicate NFS Version 4 file servers that export the root of the published name space for the example.net domain.  In accordance with RFC 2782 <a href="#RFC2782">[RFC2782]</a>, these records are to be interpreted using the Priority and Weight field values, selecting an appropriate file server with which to begin a network conversation.  The two file servers would export filesystems that would be found at "/.domainroot-example.net" in their pseudo-filesystems, which clients would mount.  Clients then carry out subsequent accesses in accordance with the ordinary NFS Version 4 protocol.  </p>
<p id="rfc.section.3.p.6">Other filesystem protocols could make use of the same "domain root" abstraction, but this document discusses only the SRV records indicating NFS servers.  </p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> Integration with Use of NFS Version 4</h1>
<p id="rfc.section.4.p.1">NFSv4 clients adhering to this specification implement a special directory, analogous to an Automounter <a href="#AMD1">[AMD1]</a><a href="#AMD2">[AMD2]</a> directory, the entries in which are domain names that have recently been traversed.  When an application attempts to traverse a new name in that special directory, the NFSv4 client consults DNS to obtain the SRV data for the given name, and if successful, it mounts the indicated filesystem(s) in that name in the special directory.  The goal is that NFS applications will be able to lookup an organization's domain name in the special directory, and the NFSv4 client will be able to discover the filesystem that that organization publishes.  Entries in the special directory will be domain names, and they will each appear to the application as a directory name pointing to the root directory of the filesystem published by the organization responsible for that domain name.  </p>
<p id="rfc.section.4.p.2">This DNS SRV record evaluation could, in principle, be done either in the NFSv4 client or in an NFSv4 server.  In either case, the result would appear the same to applications on the NFSv4 client.  This is discussed further in section 5 of this document.  </p>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> Globally-useful names: conventional mount point</h1>
<div id="#rfc.figure.3"></div>
<p></p>

<p>In order that the inter-organizational name space function as a global name space, the client-side mount point for that name space must be the same on different clients.  Conventionally, on POSIX machines, the name /nfs4/ is be used so that names on one machine will be directly usable on any machine.  Thus, the example.net published filesystem would be accessible as </p>
<pre>
	/nfs4/example.net/
</pre>
<p>on any POSIX client.  Using this convention, "/nfs4/" is the name of the special directory that is populated with domain names, leading to file servers and filesystems that capture the results of SRV record lookups.  </p>
<h1 id="rfc.section.4.2">
<a href="#rfc.section.4.2">4.2.</a> Mount options</h1>
<p id="rfc.section.4.2.p.1">SRV records are necessarily less complete than the information in the existing NFS Version 4 attributes fs_locations <a href="#RFC3530">[RFC3530]</a> or fs_locations_info <a href="#RFC5661">[RFC5661]</a>.  For the rootpath field of fs_location, or the fli_fs_root of fs_locations_info, NFS servers MUST use the "/.domainroot-{Name}" string.  Thus, the servers listed as targets for the SRV resource records MUST export the root of the organization's published filesystem as the directory "/.domainroot-{Name}" (for the given organization Name) in their exported NFS namespaces.  For example, for organization "example.net", the directory "/.domainroot-example.net" would be used.  </p>
<p id="rfc.section.4.2.p.2">Chapter 11 of the NFS Version 4.1 document <a href="#RFC5661">[RFC5661]</a> describes the approach that an NFS client should take to navigating fs_locations_info information.  </p>
<p id="rfc.section.4.2.p.3">The process of mounting an organization's name space should permit the use of what is likely to impose the lowest cost on the server.  Thus, the NFS client SHOULD NOT insist on using a writable copy of the filesystem if read-only copies exist, or a zero-age copy rather than a copy that may be a little older.  We presume that the organization's file name space can be navigated to provide access to higher-cost properties such as writability or freshness as necessary, but that the default use when navigating to the base information for an organization ought to be as low-overhead as possible.  </p>
<p id="rfc.section.4.2.p.4">Because of the possible distinction between read-only and read-write versions of a filesystem, organizations MAY also publish the location of a writable instance of their domain root filesystems, and that NFSv4 clients would conventionally mount that filesystem under the organizational domain name preceded by a period (".").  Therefore, when names beginning with a period are looked up under the NFSv4 client's special directory, the SRV RR looked up in DNS uses a Service name of "_nfs._write._domainroot", and any indicated server (or servers) MUST export the writable instance at "/.domainroot-write-{Name}" for a domain name Name.  </p>
<div id="#rfc.figure.4"></div>
<p></p>

<p>Extending the opening example, suppose a client wished to locate the read-only and read-write roots of the filesystem published by organization example.net.  Suppose a read-write instance were hosted on server nfs1tr.example.net, and read-only instances were on that server and also on server nfs2ex.example.net.  The DNS servers for the domain would publish records like </p>
<pre>
   $ORIGIN example.net.
   _nfs._domainroot._tcp IN SRV 0 0 2049 nfs1tr.example.net.
   _nfs._domainroot._tcp IN SRV 1 0 2049 nfs2ex.example.net.
   _nfs._write._domainroot._tcp IN SRV 0 0 2049 nfs1tr.example.net.
</pre>
<p>The nfs1tr.example.net server would export filesystems at both "/.domainroot-example.net" (the read-only instance) and "/.domainroot-write-example.net" (the read-write instance).  The nfs2ex.example.net server need export only the "/.domainroot-example.net" name for its read-only instance.  </p>
<div id="#rfc.figure.5"></div>
<p></p>

<p>The read-write version of the filesystem would be mounted (upon use) under ".example.net" in the special directory, and a read-only version would be mounted under "example.net".  Thus, </p>
<pre>
	/nfs4/example.net/users
</pre>
<div id="#rfc.figure.6"></div>
<pre>
	/nfs4/.example.net/users
</pre>
<p>would be a writable form of that same directory.</p>
<h1 id="rfc.section.4.3">
<a href="#rfc.section.4.3">4.3.</a> Filesystem integration issues</h1>
<p id="rfc.section.4.3.p.1">The result of the DNS search SHOULD appear as a (pseudo-)directory in the client name space.  A further refinement is RECOMMENDED: that only fully-qualified domain names appear as directories.  That is, in many environments, DNS names may be abbreviated from their fully-qualified form.  In such circumstances, multiple names might be given to NFS clients that all resolve to the same DNS SRV RRs.  The abbreviated form SHOULD be represented in the client's name space cache as a symbolic link, pointing to the fully-qualified name, case-folded if the client filesystem is case-sensitive.  This will allow pathnames obtained with, say, getcwd() to include the DNS name that is most likely to be usable outside the scope of any particular DNS abbreviation convention.  </p>
<h1 id="rfc.section.4.4">
<a href="#rfc.section.4.4">4.4.</a> Multicast, mDNS, and DNS-SD</h1>
<p id="rfc.section.4.4.p.1">Location of the NFS domain root does not involve IP-layer broadcast, multicast, or anycast communication.  </p>
<p id="rfc.section.4.4.p.2">It is not expected that this DNS SRV record format will be used in conjunction with Multicast DNS (mDNS) or DNS Service Discovery (DNS-SD).  While mDNS could be used to locate a local domain root via these SRV records, no other domain's root could be discovered.  This means that mDNS with DNS-SD has too little value to use in locating NFSv4 domain roots.  </p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> Where is this integration carried out?</h1>
<p id="rfc.section.5.p.1">The NFS client is responsible for interpreting SRV records.  Using something like Automounter <a href="#AMD1">[AMD1]</a> <a href="#AMD2">[AMD2]</a> technology, the client interprets names under a particular directory, discovering the appropriate filesystem to mount, and mounting it in the specified place in the client name space before returning control to the application doing a lookup.  The result of the DNS lookup should be cached (obeying TTL) so that the result could be returned more quickly the next time.  </p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> Security Considerations</h1>
<p id="rfc.section.6.p.1">This functionality introduces a new reliance of NFSv4 on the integrity of DNS.  Forged SRV records in DNS could cause the NFSv4 client to connect to the file servers of an attacker, not the file servers of an organization.  This is similar to attacks that can be made on the base NFSv4 protocol, if server names are given in fs_location attributes: the client can be made to connect to the file servers of an attacker, not the file servers intended to be the target for the fs_location attributes.  </p>
<p id="rfc.section.6.p.2">If DNSSEC <a href="#RFC4033">[RFC4033]</a> is available, it SHOULD be used to avoid both such attacks.  Domain-based service principal names are an additional mechanism that also apply in this case, and it would be prudent to use them.  They provide a mapping from the domain name that the user specified to names of security principals used on the NFSv4 servers that are indicated as the targets in the SRV records (as providing file service for the root filesystems).  </p>
<p id="rfc.section.6.p.3">With domain-based service principal names, the idea is that one wants to authenticate {nfs, domainname, host.fqdn}, not simply {nfs, host.fqdn}, when the server is a domain's root file server obtained through a DNS SRV RR lookup that may or may not have been secure.  The domain administrator can thus ensure that only domain root NFSv4 servers have credentials for such domain-based service principal names.  </p>
<div id="#rfc.figure.7"></div>
<p></p>

<p>Domain-based service principal names are defined in RFCs 5178 <a href="#RFC5178">[RFC5178]</a> and 5179 <a href="#RFC5179">[RFC5179]</a>.  To make use of RFC 5178's domain-based names, the syntax for "domain-based-name" MUST be used with a service of "nfs", a domain matching the name of the organization whose root filesystem is being sought, and a hostname given in the target of the DNS SRV resource record.  Thus, in the example above, two file servers (nfs1tr.example.net and nfs2ex.example.net) are located as hosting the root filesystem for the organization example.net.  To communicate with, for instance, the second of the given file servers, GSS-API is used with the name-type of GSS_C_NT_DOMAINBASED_SERVICE defined in RFC 5178 and with a symbolic name of </p>
<pre>
	nfs@example.net@nfs2ex.example.net
</pre>
<p>in order to verify that the named server (nfs2ex.example.net) is authorized to provide the root filesystem for the example.net organization.  </p>
<p id="rfc.section.6.p.5">NFSv4 itself contains a facility for the negotiation of security mechanisms to be used between NFS clients and NFS servers.  Section 3.3 of RFC 3530 <a href="#RFC3530">[RFC3530]</a> and Section 2.6 of RFC 5661 <a href="#RFC5661">[RFC5661]</a> both describe how security mechanisms are to be negotiated.  As such, there is no need for this document to describe how that negotiation is to be carried out when the NFS client contacts the NFS server for the specified domain root filesystem(s).  </p>
<p id="rfc.section.6.p.6">Using SRV records to advertise the locations of NFS servers may expose those NFS servers to attacks.  Organizations should carefully consider whether they wish their DNS servers to respond differentially to different DNS clients, perhaps exposing their SRV records to only those DNS requests that originate within a given perimeter, in order to reduce this exposure.  </p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> IANA Considerations</h1>
<div id="#rfc.figure.8"></div>
<p></p>

<p>This document requests the assignment of two new Service names without associated port numbers, each for both TCP and SCTP.  For both Services, the Reference is this document.  </p>
<pre>
Service name: _nfs._domainroot
Transport Protocol(s) TCP, SCTP
Assignee (REQUIRED)  IESG (iesg@ietf.org)
Contact (REQUIRED)   IETF Chair (chair@ietf.org)
Description (REQUIRED) NFS file service for the domain root, the root
                    of the organization's published file name space
Reference (REQUIRED)  This document
Port Number (OPTIONAL)
Service Code (REQUIRED for DCCP only)
Known Unauthorized Uses (OPTIONAL)
Assignment Notes (OPTIONAL)


Service name: _nfs._write._domainroot
Transport Protocol(s) TCP, SCTP
Assignee (REQUIRED)  IESG (iesg@ietf.org)
Contact (REQUIRED)   IETF Chair (chair@ietf.org)
Description (REQUIRED)  Writable file server for the NFS file service
                  for the domain root, the root of the organization's
                  published file name space
Reference (REQUIRED)  This document
Port Number (OPTIONAL)
Service Code (REQUIRED for DCCP only)
Known Unauthorized Uses (OPTIONAL)
Assignment Notes (OPTIONAL)
</pre>
<h1 id="rfc.references">
<a href="#rfc.references">8.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">8.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a>Key words for use in RFCs to Indicate Requirement Levels</a>", March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3530">[RFC3530]</b></td>
<td class="top">
<a title="Sun Microsystems, Inc.">Shepler, S.</a>, <a title="Sun Microsystems, Inc.">Callaghan, B.</a>, <a title="Sun Microsystems, Inc.">Robinson, D.</a>, <a title="Sun Microsystems, Inc.">Thurlow, R.</a>, <a title="Hummingbird, Ltd.">Beame, C.</a>, <a title="Network Appliance, Inc.">Eisler, M.</a> and <a title="Network Appliance, Inc.">D. Noveck</a>, "<a href="http://tools.ietf.org/html/rfc3530">Network File System (NFS) version 4 Protocol</a>", RFC 3530, April 2003.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5661">[RFC5661]</b></td>
<td class="top">
<a title="Storspeed, Inc.">Shepler, S.</a>, <a title="Network Appliance, Inc.">Eisler, M.</a> and <a title="Network Appliance, Inc.">D. Noveck, Editors</a>, "<a href="http://tools.ietf.org/html/rfc5661">Network File System (NFS) Version 4 Minor Version 1 Protocol</a>", RFC 5661, January 2010.</td>
</tr>
<tr>
<td class="reference"><b id="RFC1034">[RFC1034]</b></td>
<td class="top">
<a>Mockapetris, P.V.</a>, "<a href="http://tools.ietf.org/html/rfc1034">Domain Names - Concepts and Facilities</a>", RFC 1034, November 1987.</td>
</tr>
<tr>
<td class="reference"><b id="RFC1035">[RFC1035]</b></td>
<td class="top">
<a>Mockapetris, P.V.</a>, "<a href="http://tools.ietf.org/html/rfc1035">Domain Names - Implementation and Specification</a>", RFC 1035, November 1987.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2782">[RFC2782]</b></td>
<td class="top">
<a title="Troll Technologies">Gulbrandsen, A.</a>, <a title="Internet Software Consortium">Vixie, P.</a> and <a title="Microsoft Corporation">L. Esibov</a>, "<a href="http://tools.ietf.org/html/rfc2782">A DNS RR for specifying the location of services (DNS SRV)</a>", RFC 2782, February 2000.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4033">[RFC4033]</b></td>
<td class="top">
<a title="Telematica Institut">Arends, R.</a>, <a title="Internet Systems Consortium">Austein, R.</a>, <a title="VeriSign, Inc.">Larson, M.</a>, <a title="Colorado State University">Massey, D.</a> and <a title="National Institute for Standards and Technology">S. Rose</a>, "<a href="http://tools.ietf.org/html/rfc4033">DNS Security Introduction and Requirements</a>", RFC 4033, March 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5178">[RFC5178]</b></td>
<td class="top">
<a title="Sun">Williams, N.</a> and <a title="Isode Ltd.">A. Melnikov</a>, "<a href="http://tools.ietf.org/html/rfc5178">Generic Security Service Application Program Interface (GSS-API) Internationalization and Domain-Based Service Names and Name Type</a>", RFC 5178, May 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5179">[RFC5179]</b></td>
<td class="top">
<a title="Sun">Williams, N.</a>, "<a href="http://tools.ietf.org/html/rfc5179">Generic Security Service Application Program Interface (GSS-API) Domain-Based Service Names Mapping for the Kerberos V GSS Mechanism</a>", RFC 5179, May 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5864">[RFC5864]</b></td>
<td class="top">
<a title="Stanford University">Allbery, R.</a>, "<a href="http://tools.ietf.org/html/rfc5864">DNS SRV Resource Records for AFS</a>", RFC 5864, April 2010.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6335">[RFC6335]</b></td>
<td class="top">
<a title="ICANN">Cotton, M.</a>, <a title="Nokia">Eggert, L.</a>, <a title="USC/ISI">Touch, J.</a>, <a title="Ericsson">Westerlund, M.</a> and <a title="Stanford University">S. Cheshire</a>, "<a href="http://tools.ietf.org/html/rfc6335">Internet Assigned Numbers Authority (IANA) Procedures for the Management of the Service Name and Transport Protocol Port Number Registry</a>", RFC 6335, August 2011.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">8.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="DFS">[DFS]</b></td>
<td class="top">
<a title="Transarc Corporation">Kazar, M.L.</a>, <a title="Transarc Corporation">Leverett, B.W.</a>, <a title="Transarc Corporation">Anderson, O.T.</a>, <a title="Transarc Corporation">Apostolides, V.</a>, <a title="Transarc Corporation">Bottos, B.A.</a>, <a title="Transarc Corporation">Chutani, S.</a>, <a title="Transarc Corporation">Everhart, C.F.</a>, <a title="Transarc Corporation">Mason, W.A.</a>, <a title="Transarc Corporation">Tu, S.-T.</a> and <a title="Transarc Corporation">E.R. Zayas</a>, "<a>DEcorum File System Architectural Overview</a>", Proc. USENIX Summer Conf. Anaheim, Calif., June 1990.</td>
</tr>
<tr>
<td class="reference"><b id="AMD1">[AMD1]</b></td>
<td class="top">
<a title="Imperial College of Science, London">Pendry, J.-S.</a> and <a title="Imperial College of Science, London">N. Williams</a>, "<a>Amd: The 4.4 BSD Automounter Reference Manual</a>", March 1991.</td>
</tr>
<tr>
<td class="reference"><b id="AMD2">[AMD2]</b></td>
<td class="top">
<a title="University of Colorado, Boulder">Crosby, M.</a>, "<a>AMD--AutoMount Daemon</a>", Linux Journal 1997, 35es Article 4, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="AFS">[AFS]</b></td>
<td class="top">
<a title='"Carnegie Mellon University, Information Technology Center"'>Howard, J.H.</a>, "<a>An Overview of the Andrew File System"</a>", Proc. USENIX Winter Tech. Conf. Dallas, February 1988.</td>
</tr>
</tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Craig Everhart</span> 
	  <span class="n hidden">
		<span class="family-name">Everhart</span>
	  </span>
	</span>
	<span class="org vcardline">NetApp </span>
	<span class="adr">
	  <span>800 Cranberry Woods Drive, Ste. 300</span>

	  <span class="vcardline">
		<span class="locality">Cranberry Township</span>,  
		<span class="region">PA</span> 
		<span class="code">16066</span>
	  </span>
	  <span class="country-name vcardline">US</span>
	</span>
	<span class="vcardline">Phone: +1 724 741 5101</span>

<span class="vcardline">EMail: <a href="mailto:everhart@netapp.com">everhart@netapp.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">W.A. (Andy) Adamson</span> 
	  <span class="n hidden">
		<span class="family-name">Adamson</span>
	  </span>
	</span>
	<span class="org vcardline">NetApp</span>
	<span class="adr">
	  <span>495 East Java Drive</span>

	  <span class="vcardline">
		<span class="locality">Sunnyvale</span>,  
		<span class="region">CA</span> 
		<span class="code">94089</span>
	  </span>
	  <span class="country-name vcardline">US</span>
	</span>
	<span class="vcardline">Phone: +1 734 665 1204</span>

<span class="vcardline">EMail: <a href="mailto:andros@netapp.com">andros@netapp.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Jiaying Zhang</span> 
	  <span class="n hidden">
		<span class="family-name">Zhang</span>
	  </span>
	</span>
	<span class="org vcardline">Google</span>
	<span class="adr">
	  <span>604 Arizona Avenue</span>

	  <span class="vcardline">
		<span class="locality">Santa Monica</span>,  
		<span class="region">CA</span> 
		<span class="code">90401</span>
	  </span>
	  <span class="country-name vcardline">US</span>
	</span>
	<span class="vcardline">Phone: +1 310 309 6884</span>

<span class="vcardline">EMail: <a href="mailto:jiayingz@google.com">jiayingz@google.com</a></span>

  </address>
</div>

</body>
</html>