



SFC                                                          Y. Wei, Ed.
Internet-Draft                                           ZTE Corporation
Intended status: Standards Track                                U. Elzur
Expires: September 4, 2020                                         Intel
                                                                S. Majee
                                                       Caber systems inc
                                                           March 3, 2020


                      Network Service Header TLVs
                       draft-ietf-sfc-nsh-tlv-02

Abstract

   This draft describes Network Service Header (NSH) MD-Type 2 metadata
   TLVs that can be used within a service function path.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on September 4, 2020.

Copyright Notice

   Copyright (c) 2020 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (https://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.



Wei, et al.             Expires September 4, 2020               [Page 1]

Internet-Draft         Network Service Header TLVs            March 2020


Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
   2.  Conventions used in this document . . . . . . . . . . . . . .   2
     2.1.  Terminology . . . . . . . . . . . . . . . . . . . . . . .   3
     2.2.  Requirements Language . . . . . . . . . . . . . . . . . .   3
   3.  NSH Type 2 Format . . . . . . . . . . . . . . . . . . . . . .   3
   4.  NSH Type 2 TLVs . . . . . . . . . . . . . . . . . . . . . . .   4
     4.1.  Forwarding Context  . . . . . . . . . . . . . . . . . . .   4
     4.2.  Tenant Identifier . . . . . . . . . . . . . . . . . . . .   5
     4.3.  Content Type  . . . . . . . . . . . . . . . . . . . . . .   6
     4.4.  Ingress Network Information . . . . . . . . . . . . . . .   6
     4.5.  Flow ID . . . . . . . . . . . . . . . . . . . . . . . . .   6
     4.6.  Source and/or Destination Groups  . . . . . . . . . . . .   7
     4.7.  Universal Resource Identifier . . . . . . . . . . . . . .   7
     4.8.  Policy Identifier (POLICY_ID) . . . . . . . . . . . . . .   8
   5.  Security Considerations . . . . . . . . . . . . . . . . . . .   8
   6.  Acknowledgments . . . . . . . . . . . . . . . . . . . . . . .   9
   7.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .   9
   8.  References  . . . . . . . . . . . . . . . . . . . . . . . . .   9
     8.1.  Normative References  . . . . . . . . . . . . . . . . . .  10
     8.2.  Informative References  . . . . . . . . . . . . . . . . .  10
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  10

1.  Introduction

   Network Service Header (NSH) [RFC8300] is the Service Function
   Chaining (SFC) encapsulation protocol used to create Service Function
   Chains.  As such, NSH provides two key elements:

   1.  Service Function Path identification

   2.  Metadata

   [RFC8300] further defines two metadata formats (MD Types): 1 and 2.
   MD Type 1 defines fixed length, 16 bytes-long metadata, whereas MD
   Type 2 defines a variable-length TLV format for metadata.  This draft
   defines some common TLVs for use with NSH MD Type 2.

   This draft does not address metadata usage, updating/chaining of
   metadata or other SFP functions.  Those topics are described in
   [RFC8300].

2.  Conventions used in this document







Wei, et al.             Expires September 4, 2020               [Page 2]

Internet-Draft         Network Service Header TLVs            March 2020


2.1.  Terminology

   NSH: Network Service Header

   MD Type: Metadata Format

   CT: Context Type

   TT: Tenant Type

   URI: Universal Resource Identifier

   SFC: Service Function Chaining

2.2.  Requirements Language

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in BCP
   14 [RFC2119] [RFC8174] when, and only when, they appear in all
   capitals, as shown here.

3.  NSH Type 2 Format

   A NSH is composed of a 4-byte Base Header, a 4-byte Service Path
   Header and Context Headers.  The Base Header identifies the MD-Type
   in use:

       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |Ver|O|C|R|R|R|R|R|R|   Length  |    MD Type    | Next Protocol |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                         Figure 1: NSH Base Header

   Please refer to NSH [RFC8300] for a detailed header description.

   When the base header specifies MD Type = 0x2, zero or more Variable
   Length Context Headers MAY be added, immediately following the
   Service Path Header.  Therefore, Length = 0x2 indicates that only the
   Base Header followed by the Service Path Header is present.  The
   number, indicated in the Length field, of optional Variable Length
   Context Headers MUST be of an integer indicating length in 4-bytes
   words Figure 2 below depicts the format of the Context Header as
   defined in Section 2.5.1 of [RFC8300].





Wei, et al.             Expires September 4, 2020               [Page 3]

Internet-Draft         Network Service Header TLVs            March 2020


        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |          Metadata Class       |      Type     |U|    Length   |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                   Variable-Length Metadata                    |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                         Figure 2: NSH TLV Format

   where

      Metadata Class (MD Class): Defines the scope of the Type field to
      provide a hierarchical namespace.

      Type - Indicates the explicit type of metadata being carried.  The
      value is one from the Network Service Header (NSH) TLV Type
      registry (Section 7).

      Unassigned bit: One unassigned bit is available for future use.
      This bit MUST NOT be set, and it MUST be ignored on receipt.

      Length: Indicates the length of the variable-length metadata, in
      bytes.  In case the metadata length is not an integer number of
      4-byte words, the sender MUST add pad bytes immediately following
      the last metadata byte to extend the metadata to an integer number
      of 4-byte words.  The receiver MUST round the Length field up to
      the nearest 4-byte-word boundary, to locate and process the next
      field in the packet.  The receiver MUST access only those bytes in
      the metadata indicated by the Length field (i.e., actual number of
      bytes) and MUST ignore the remaining bytes up to the nearest 4-
      byte-word boundary.  The length may be 0 or greater.

      A value of 0 denotes a Context Header without a Variable-Length
      Metadata field.

4.  NSH Type 2 TLVs

   In [RFC8300] defined that Metadata Class 0x0000 as IETF Base NSH MD
   Class.  In this draft, metadata types are defined for the IETF Base
   NSH MD Class.

4.1.  Forwarding Context

   This TLV carries a network-centric forwarding context, used for
   segregation and forwarding scope.  Forwarding context can take
   several forms depending on the network environment.  Commonly used
   data includes VXLAN/VXLAN- GPE VNID, VRF identification or VLAN.



Wei, et al.             Expires September 4, 2020               [Page 4]

Internet-Draft         Network Service Header TLVs            March 2020


       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |    Metadata Class = 0x0000    |  Type = 0x01  |U|  Length = 8 |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |   CT  |             Reserved                                  |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                      Tenant ID                                |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                       Figure 3: Forwarding Context

   where:

      Context Type (CT) is four bits-long field that defines the length
      and the interpretation of the Tenant ID field.  This document
      defines these CT values:

         0x0 - 24 bits-long VXLAN/LISP virtual network identifier (VNI)

         0x1 - 32 bits-long MPLS VPN label

         0x2 - VLAN

4.2.  Tenant Identifier

   Tenant identification is often used for segregation within a multi-
   tenant environment.  Orchestration system-generated tenant IDs are an
   example of such data.

       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |    Metadata Class = 0x0000    |  Type = 0x02  |U|  Length=12  |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |  TT   |             Reserved                                  |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                         Tenant ID                             |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                         Tenant ID                             |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                     Figure 4: Tenant Identifier List

   where:






Wei, et al.             Expires September 4, 2020               [Page 5]

Internet-Draft         Network Service Header TLVs            March 2020


      Tenant Type (TT) is four bits-long field that specifies the length
      of the Tenant ID field.  This document defines the following
      values for TT:

      *  0x0 - 32 bits-long Tenant ID

      *  0x1 - 64 bits-long Tenant ID

4.3.  Content Type

   Provides explicit information about the content being carried, for
   example, type of video or content value for billing purposes.

       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |    Metadata Class = 0x0000    |  Type = 0x03  |U|  Length = 4 |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                     Content Type                              |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                          Figure 5: Content Type

4.4.  Ingress Network Information

   This data identifies the ingress network node, and, if required,
   ingress interface.

       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |    Metadata Class = 0x0000    |  Type = 0x04  |U|  Length = 8 |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                        Node ID                                |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                     Source Interface/Port                     |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                   Figure 6: Ingress Network Information

4.5.  Flow ID

   Flow ID provides a representation of the flow.  Akin, but not
   identical to the usage described in [RFC6437].







Wei, et al.             Expires September 4, 2020               [Page 6]

Internet-Draft         Network Service Header TLVs            March 2020


       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |    Metadata Class = 0x0000    |  Type = 0x05  |U|  Length = 4 |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                     Flow ID                                   |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                             Figure 7: Flow ID

4.6.  Source and/or Destination Groups

   Intent-based systems can use this data to express the logical
   grouping of source and/or destination objects.  [GROUPBASEDPOLICY]
   and [GROUPPOLICY] provide examples of such a system.

       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |    Metadata Class = 0x0000    |  Type = 0x06  |U|  Length=12  |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |  GT   |                Reserved                               |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                        Source Group                           |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                        Dest Group                             |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


                         Figure 8: End Point Group

   where:

      Group Type (GT) is four bits-long field that specifies the the
      interpretation of Source Group and/or Destination Group fields.
      This document defines the following values for GT:

      *  0x1 - Group Based Policy (GBP) end point group (EPG)

4.7.  Universal Resource Identifier











Wei, et al.             Expires September 4, 2020               [Page 7]

Internet-Draft         Network Service Header TLVs            March 2020


       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |    Metadata Class = 0x0000    |  Type = 0x07  |U|  Length=var |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |  UT   |                URI                                    |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      ~                        URI                                    ~
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                  Figure 9: Universal Resource Identifier

   where

      URI (Universal Resource Identifier) Type is four bits-long field
      that specifies the format of the URI field.  This document defines
      the following values for the URI Type field:

      *  0x1: URI in standard string format as defined in [RFC3986].

      *  0x2: URI represented in a compacted hash format.

4.8.  Policy Identifier (POLICY_ID)

   The policy is often referred by a system-generated identifier which
   is then used by the devices to lookup the content of the policy
   locally.  For example, this identifier could be an index to an array,
   a lookup key, a database Id.  The identifier allows enforcement
   agents or services to lookup up the content of their part of the
   policy quite efficiently.

       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |    Metadata Class = 0x0000    |  Type = 0x08  |U|  Length=var |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                     POLICY_ID                                 |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      ~                     POLICY_ID                                  ~
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                           Figure 10: POLICY_ID

5.  Security Considerations

   [RFC8300] describes the requisite security considerations for
   protecting NSH metadata.




Wei, et al.             Expires September 4, 2020               [Page 8]

Internet-Draft         Network Service Header TLVs            March 2020


6.  Acknowledgments

   The authors would like to thank Paul Quinn for contributing to the
   draft and thank Behcet Sarikaya, Dirk von Hugo and Mohamed Boucadair
   for their work regarding usage of subscriber and host information
   TLVs.

7.  IANA Considerations

   IANA is requested to create a new "Network Service Header (NSH) TLV
   Type" registry according to Table 1.

          +-----------+--------------+-------------------------+
          | Value     | Description  | Reference               |
          +-----------+--------------+-------------------------+
          | 0         |   Reserved   | This document           |
          | 1- 127    |  Unassigned  | IETF Review             |
          | 128 - 239 |  Unassigned  | First Come First Served |
          | 240 - 249 | Experimental | This document           |
          | 250 - 254 | Private Use  | This document           |
          | 255       |   Reserved   | This document           |
          +-----------+--------------+-------------------------+

              Table 1: Network Service Header (NSH) TLV Type

   This document defines the following new values (Table 2) in the
   Network Service Header (NSH) TLV Type registry:

       +-------+----------------------------------+---------------+
       | Value |           Description            | Reference     |
       +-------+----------------------------------+---------------+
       | 1     |        Forwarding Context        | This document |
       | 2     |        Tenant Identifier         | This document |
       | 3     |           Content Type           | This document |
       | 4     |   Ingress Network Information    | This document |
       | 5     |             Flow ID              | This document |
       | 6     | Source and/or Destination Groups | This document |
       | 7     |  Universal Resource Identifier   | This document |
       | 8     |        Policy Identifier         | This document |
       +-------+----------------------------------+---------------+

                           Table 2: Type Values

8.  References







Wei, et al.             Expires September 4, 2020               [Page 9]

Internet-Draft         Network Service Header TLVs            March 2020


8.1.  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <https://www.rfc-editor.org/info/rfc2119>.

   [RFC3986]  Berners-Lee, T., Fielding, R., and L. Masinter, "Uniform
              Resource Identifier (URI): Generic Syntax", STD 66,
              RFC 3986, DOI 10.17487/RFC3986, January 2005,
              <https://www.rfc-editor.org/info/rfc3986>.

   [RFC8174]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in RFC
              2119 Key Words", BCP 14, RFC 8174, DOI 10.17487/RFC8174,
              May 2017, <https://www.rfc-editor.org/info/rfc8174>.

   [RFC8300]  Quinn, P., Ed., Elzur, U., Ed., and C. Pignataro, Ed.,
              "Network Service Header (NSH)", RFC 8300,
              DOI 10.17487/RFC8300, January 2018,
              <https://www.rfc-editor.org/info/rfc8300>.

8.2.  Informative References

   [GROUPBASEDPOLICY]
              OpenStack, "Group Based Policy", 2014.

   [GROUPPOLICY]
              OpenDaylight, "Group Policy", 2014.

   [RFC6437]  Amante, S., Carpenter, B., Jiang, S., and J. Rajahalme,
              "IPv6 Flow Label Specification", RFC 6437,
              DOI 10.17487/RFC6437, November 2011,
              <https://www.rfc-editor.org/info/rfc6437>.

Authors' Addresses

   Yuehua (Corona) Wei (editor)
   ZTE Corporation
   No.50, Software Avenue
   Nanjing  210012
   China

   Email: wei.yuehua@zte.com.cn








Wei, et al.             Expires September 4, 2020              [Page 10]

Internet-Draft         Network Service Header TLVs            March 2020


   Uri Elzur
   Intel

   Email: uri.elzur@intel.com


   Sumandra Majee
   Caber systems inc

   Email: Sum.majee@gmail.com









































Wei, et al.             Expires September 4, 2020              [Page 11]
