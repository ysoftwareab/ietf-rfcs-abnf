Z = scalar-op(x, Y) = x*Y

Z = element-op(X, Y) = X + Y

Y = scalar-op(1, Y)

Y = scalar-op(x, Y) = element-op(Y, scalar-op(x-1, Y)), for x > 1

Z = scalar-op(x, Y) = Y^x mod p

Z = element-op(X, Y) = (X * Y) mod p

stretch = KDF-n(k, label)

base = H((max(Alice,Bob) | min(Alice,Bob) | password | counter)

seed = KDF-n(base, "Dragonfly Hunting and Pecking")
found = 0
counter = 1
n = len(p)
base = H(max(Alice,Bob) | min(Alice,Bob) | password | counter)
seed = KDF-n(seed, "Dragonfly Hunting And Pecking")
x = seed
y = sqrt(x^3 + ax + b)
PE = (x,y)
PE = (x,p-y)
found = 1
counter = counter + 1
found = 0
counter = 1
n = len(p)
base = H(max(Alice,Bob) | min(Alice,Bob) | password | counter)
seed = KDF-n(base, "Dragonfly Hunting And Pecking")
PE = seed ^ ((p-1)/q) mod p
found = 1
counter = counter + 1
scalar = (private + mask) modulo q

Element = inverse(scalar-op(mask, PE))

ss = F(scalar-op(private,
                          element-op(peer-Element,
                                     scalar-op(peer-scalar, PE))))

confirm = H(KCK | scalar | peer-scalar |
                              Element | Peer-Element)

