VQEvent  =  LocalMetrics CLRF
                    RemoteMetrics

LocalMetrics = ("LocalMetrics") HCOLON VoiceQualityMetrics
RemoteMetrics = ("RemoteMetrics") HCOLON VoiceQualityMetrics


VoiceQualityMetrics = ("VQMetrics") HCOLON CLRF
                              CodecInfo CRLF
                              JitterBufferInfo CRLF
                              PacketLossMetrics CRLF
                              BurstMetrics CLRF
                              GapMetrics CLRF
                              DelayMetrics CLRF
                              SignalMetrics CLRF
                              QualityScores CLRF

CodecInfo      = ("codec") EQUALS c-type SPACE packet-rate SPACE pl-conceal
c-type         = ("type") HCOLON HEX (HH)
packet-rate    = ("prate") HCOLON HEX (HH)
pl-conceal = ("plc") HCOLON ("std" | "enh" | "unk")

JitterBufferInfo = ("jb") EQUALS jb-type SPACE jb-rate SPACE jb-nominal
                               SPACE jb-max SPACE jb-abs-max
jb-type = ("type") HCOLON ("adapt" | "non-adapt" | "unknown")
jb-rate = ("rate") HCOLON HEX (HHH)
jb-max  = ("max") HCOLON HEX (HHH)
jb-nominal = ("nom") HCOLON HEX (HHH)
jb-absmax = ("abmax") HCOLON HEX (HHH)


PacketLossMetrics = ("pl") EQUALS loss-rate SPACE discard-rate
loss-rate         = ("loss") HCOLON HEX (HH)
discard-rate      = ("disc") HCOLON HEX (HH)

BurstMetrics  = ("burst") EQUALS density SPACE length
GapMetrics    = ("gap") EQUALS density SPACE length

density            = ("den") HCOLON HEX (HH)
length             = ("len") HCOLON HEX (HHHH)

DelayMetrics       = ("delay") EQUALS round-trip SPACE end-system
round-trip = ("rt") COLON HEX (HHHH)
end-system = ("es") COLON HEX (HHHH)


SignalMetrics      = ("signal") EQUALS signal SPACE echo-return-loss SPACE
                                            noise
signal             = ("sig") HCOLON HEX (HH)
echo-return-loss   = ("erl") HCOLON HEX (HH)
noise              = ("n") HCOLON HEX (HH)


QualityScores  = ("qs") EQUALS r-lq SPACE r-cg SPACE mos-lq SPACE mos-cq
r-lq               = ("r-lq") HCOLON HEX (HH)
r-cq           = ("r-cg") HCOLON HEX (HH)
mos-lq         = ("m-lq") HCOLON HEX (H"."H)
mos-cq         = ("m-cq") HCOLON HEX (H"."H)

DialogID       = ("DialogID") HCOLON callid *(SEMI dialogid-param)
dialogid-param  = to-tag / from-tag / generic-param
callid          = token
to-tag          = "to-tag" EQUAL token
from-tag        = "from-tag" EQUAL token

VoiceQualityAlert = ("VQAlert") HCOLON SPACE ViolationMetric SPACE
                                  Severity CRLF VoiceQualityMetrics

ViolationMetric = ("Type")  HCOLON ("r-lq" / "r-cq" / "burst" / "erl"
                               / "delay" / token )

Severity = ("Severity") HCOLON ("Warning" | "Critical" | "Clear")


codec=type:0 prate:20 plc:enh
jb=type:adapt rate:2 nom:40 max:80 abmax:120
pl=loss:5 disc:2
burst=den:0 len:0
gap=den:2 len:0
delay=rt:200 es:140
signal=sig:2 rerl:14 n:1
qs=r-lq:82 r-cq:80 ml:3.4 mc:3.3
codec=type:0 prate:20 plc:std
jb=type:adapt rate:2 nom:40 max:80 abmax:120
plm=loss:02 disc:01
burst=den:0 len:0
gap=den:2 len:0
delay=rt:100 es:140
signal=sig:2 rerl:14 n:1
qs=r-lq:81 r-cq:90 ml:3.1 mc:3.2
codec=type:0 prate:20 plc:std
jb=type:adapt rate:2 nom:40 max:80 abmax:120
pl=loss:05 disc:02
burst=den:0 len:0
gap=den:2 len:0
delay=rt:200 es:140
signal=sig:2 rerl:14 n:1
qs=r-lq:90 r-cq:80 ml:3.4 mc:3.3
codec=type:0 prate:20 plc:std
jb=type:adapt rate:2 nom:40 max:80 abmax:120
pl=loss:02 disc:01
burst=den:0 len:0
gap=den:2 len:0
dly=rt:100 es:140
sig=sig:2 rerl:14 n:1
qs=r-lq:90 r-cq:90 ml:3.1 mc:3.2
