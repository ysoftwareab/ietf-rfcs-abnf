<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>MPLS-TP Linear Protection</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="MPLS-TP Linear Protection">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 60em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 60em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">S. Bryant, Ed.</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">E. Osborne</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">Cisco</td></tr>
<tr><td class="header">Expires: April 27, 2011</td><td class="header">N. Sprecher, Ed.</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Nokia Siemens Networks</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">A. Fulignoli, Ed.</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Ericsson</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Y. Weingarten</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Nokia Siemens Networks</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">October 24, 2010</td></tr>
</table></td></tr></table>
<h1><br />MPLS-TP Linear Protection<br />draft-ietf-mpls-tp-linear-protection-03.txt</h1>

<h3>Abstract</h3>

<p>The Transport Profile for Multiprotocol Label Switching (MPLS-TP) is being 
	  specified jointly by IETF and ITU-T. This document addresses the functionality 
	  described in the MPLS-TP Survivability Framework document <a class='info' href='#SurvivFwk'>[SurvivFwk]<span> (</span><span class='info'>Sprecher, N., Farrel, A., and H. Shah, &ldquo;Multi-protocol Label Switching Transport Profile           Survivability Framework,&rdquo; Feb&nbsp;2009.</span><span>)</span></a> and defines a protocol that may be used to fulfill the function 
	  of the Protection State Coordination for linear protection, as described in 
	  that document.
</p>
<p>This document is a product of a joint Internet Engineering Task Force
      (IETF) / International Telecommunications Union Telecommunications
      Standardization Sector (ITU-T) effort to include an MPLS Transport
      Profile within the IETF MPLS and PWE3 architectures to support the
      capabilities and functionalities of a packet transport network as
      defined by the ITU-T. 
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted  in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF).  Note that other groups may also distribute
working documents as Internet-Drafts.  The list of current
Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
This Internet-Draft will expire on April 27, 2011.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the Simplified BSD License.</p>
<p>
This document may contain material from IETF Documents or IETF
Contributions published or made publicly available before November
10, 2008.  The person(s) controlling the copyright in some of this
material may not have granted the IETF Trust the right to allow
modifications of such material outside the IETF Standards Process.
Without obtaining an adequate license from the person(s) controlling
the copyright in such materials, this document may not be modified
outside the IETF Standards Process, and derivative works of it may
not be created outside the IETF Standards Process, except to format
it for publication as an RFC or to translate it into languages other
than English.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">1.1.</a>&nbsp;
Protection architectures<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">1.2.</a>&nbsp;
Scope of the document<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">1.3.</a>&nbsp;
Contributing authors<br />
<a href="#anchor5">2.</a>&nbsp;
Conventions used in this document<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">2.1.</a>&nbsp;
Acronyms<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">2.2.</a>&nbsp;
Definitions and Terminology<br />
<a href="#anchor8">3.</a>&nbsp;
Protection switching control logic<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">3.1.</a>&nbsp;
Protection switching control logical architecture<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">3.1.1.</a>&nbsp;
Local Request Logic<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">3.1.2.</a>&nbsp;
Remote Requests<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">3.1.3.</a>&nbsp;
PSC Process Logic<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">3.1.4.</a>&nbsp;
PSC Message Generator<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">3.1.5.</a>&nbsp;
Wait-to-Restore (WTR) timer<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">3.1.6.</a>&nbsp;
PSC Control States<br />
<a href="#anchor16">4.</a>&nbsp;
Protection state coordination (PSC) protocol<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor17">4.1.</a>&nbsp;
Transmission and acceptance of PSC control packets<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">4.2.</a>&nbsp;
Protocol format<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor19">4.2.1.</a>&nbsp;
PSC Ver field<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor20">4.2.2.</a>&nbsp;
PSC Request field<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor21">4.2.3.</a>&nbsp;
Protection Type (PT)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor22">4.2.4.</a>&nbsp;
Revertive (R) field<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor23">4.2.5.</a>&nbsp;
Fault path (FPath) field<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor24">4.2.6.</a>&nbsp;
Data path (Path) field<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor25">4.3.</a>&nbsp;
Principles of Operation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor26">4.3.1.</a>&nbsp;
Basic operation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor27">4.3.2.</a>&nbsp;
Priority of inputs<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor28">4.3.3.</a>&nbsp;
Operation of PSC States<br />
<a href="#IANA">5.</a>&nbsp;
IANA Considerations<br />
<a href="#Security">6.</a>&nbsp;
Security Considerations<br />
<a href="#Acknowledgements">7.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">8.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">8.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">8.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>The MPLS Transport Profile (MPLS-TP) <a class='info' href='#TPFwk'>[TPFwk]<span> (</span><span class='info'>Bocci, M., Bryant, S., and L. Levrau, &ldquo;A Framework for MPLS in Transport Networks,&rdquo; July&nbsp;2009.</span><span>)</span></a> is a 
	  framework for the construction and operation of packet-switched transport 
	  networks based on the architectures for MPLS (<a class='info' href='#RFC3031'>[RFC3031]<span> (</span><span class='info'>Rosen, E., Viswanathan, A., and R. Callon, &ldquo;Multiprotocol Label Switching           Architecture,&rdquo; Jan&nbsp;2001.</span><span>)</span></a> 
	  and <a class='info' href='#RFC3032'>[RFC3032]<span> (</span><span class='info'>Rosen, E., Tappan, D., Fedorkow, G., Rekhter, Y., Farinacci, D., Li, T., and A. Conta, &ldquo;MPLS Label Stack Encoding,&rdquo; Jan&nbsp;2001.</span><span>)</span></a>) and for Pseudowires (PWs) (<a class='info' href='#RFC3985'>[RFC3985]<span> (</span><span class='info'>Bryant, S. and P. Pate, &ldquo;Pseudowire Emulation Edge-to-Edge (PWE3) Architecture,&rdquo; March&nbsp;2005.</span><span>)</span></a> and <a class='info' href='#RFC5659'>[RFC5659]<span> (</span><span class='info'>Bocci, M. and S. Bryant, &ldquo;An Architecture for Multi-Segment Pseudowire Emulation  		  Edge-to-Edge,&rdquo; October&nbsp;2009.</span><span>)</span></a>) and the requirements of 
	  <a class='info' href='#RFC5654'>[RFC5654]<span> (</span><span class='info'>Niven-Jenkins, B., Brungard, D., Betts, M., Sprecher, N., and S. Ueno, &ldquo;Requirements of an MPLS Transport Profile,&rdquo; September&nbsp;2009.</span><span>)</span></a>.
</p>
<p>Network survivability is the ability of a network to recover traffic 
	  delivery following failure, or degradation of network resources.  The 
	  MPLS-TP Survivability Framework <a class='info' href='#SurvivFwk'>[SurvivFwk]<span> (</span><span class='info'>Sprecher, N., Farrel, A., and H. Shah, &ldquo;Multi-protocol Label Switching Transport Profile           Survivability Framework,&rdquo; Feb&nbsp;2009.</span><span>)</span></a> is a framework 
	  for survivability in MPLS-TP networks, and describes recovery elements, 
	  types, methods, and topological considerations, focusing on mechanisms 
	  for recovering MPLS-TP Label Switched Paths (LSPs).
</p>
<p>Linear protection in mesh networks &ndash; networks with arbitrary 
	  interconnectivity between nodes &ndash; is described in Section 4.7 of 
	  <a class='info' href='#SurvivFwk'>[SurvivFwk]<span> (</span><span class='info'>Sprecher, N., Farrel, A., and H. Shah, &ldquo;Multi-protocol Label Switching Transport Profile           Survivability Framework,&rdquo; Feb&nbsp;2009.</span><span>)</span></a>.  Linear protection provides rapid and simple 
	  protection switching.  In a mesh network, linear protection provides a 
	  very suitable protection mechanism because it can operate between any pair 
	  of points within the network.  It can protect against a defect in an 
	  intermediate node, a span, a transport path segment, or an end-to-end 
	  transport path.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Protection architectures</h3>

<p>Protection switching is a fully allocated survivability mechanism. It
      is fully allocated in the sense that the route and bandwidth of the
      recovery path is reserved for a selected working path or set of working
      paths. It provides a fast and simple survivability mechanism, that
      allows the network operator to easily grasp the active state of the
      network, compared to other survivability mechanisms.
</p>
<p>As specified in the Survivability Framework document <a class='info' href='#SurvivFwk'>[SurvivFwk]<span> (</span><span class='info'>Sprecher, N., Farrel, A., and H. Shah, &ldquo;Multi-protocol Label Switching Transport Profile           Survivability Framework,&rdquo; Feb&nbsp;2009.</span><span>)</span></a>, protection switching is applied to a protection 
	  domain. For the purposes of this document, we define the protection 
	  domain of a P2P LSP as consisting of two Label Edge Routers (LER) and 
	  the transport paths that connect them. For a P2MP LSP the protection 
	  domain includes the root (or source) LER, the destination (or sink) LERs, 
	  and the transport paths that connect them.
</p>
<p>In 1+1 unidirectional architecture as presented in <a class='info' href='#SurvivFwk'>[SurvivFwk]<span> (</span><span class='info'>Sprecher, N., Farrel, A., and H. Shah, &ldquo;Multi-protocol Label Switching Transport Profile           Survivability Framework,&rdquo; Feb&nbsp;2009.</span><span>)</span></a>, a recovery transport path is dedicated to the 
	  working transport path. Normal traffic is bridged (as defined in <a class='info' href='#RFC4427'>[RFC4427]<span> (</span><span class='info'>Mannie, E. and D. Papadimitriou, &ldquo;Recovery Terminology for Generalized Multi-Protocol Label           Switching,&rdquo; Mar&nbsp;2006.</span><span>)</span></a>)and fed to both the working and the recovery 
	  transport entities by a permanent bridge at the source of the protection 
	  domain. The sink of the protection domain selects which of the working or 
	  recovery entities to receive the traffic from, based on a predetermined 
	  criteria, e.g. server defect indication. When used for bidirectional 
	  switching the 1+1 protection architecture must also support a Protection 
	  State Coordination (PSC) protocol. This protocol is used to help coordinate 
	  between both ends of the protection domain in selecting the proper 
	  traffic flow.
</p>
<p>In the 1:1 architecture, a recovery transport path is dedicated to
      the working transport path of a single service and the traffic is only 
	  transmitted either on the working or the recovery path, by using a selector 
	  bridge at the source of the protection domain.  A selector at the sink of 
	  the protection domain then selects the path that carries the normal traffic. 
	  Since the source and sink need to be coordinated to ensure that the selector 
	  bridge at both ends select the same path, this architecture must support a 
	  PSC protocol.
</p>
<p>The 1:n protection architecture extends the 1:1 architecture above by
      sharing the recovery path amongst n services. Again, the recovery path
      is fully allocated and disjoint from any of the n working transport
      paths that it is being used to protect. The normal data traffic for each
      service is transmitted either on the normal working path for
      that service or, in cases that trigger protection switching (as defined
      in <a class='info' href='#SurvivFwk'>[SurvivFwk]<span> (</span><span class='info'>Sprecher, N., Farrel, A., and H. Shah, &ldquo;Multi-protocol Label Switching Transport Profile           Survivability Framework,&rdquo; Feb&nbsp;2009.</span><span>)</span></a>), may be sent on the recovery path.
	  The switching action is similar to the 1:1 case where a selector bridge 
	  is used at the source.  It should be noted that in cases where multiple 
	  working path services have triggered protection switching that some 
	  services, dependent upon their Service Level Agreement (SLA), may not be 
	  transmitted as a result of limited resources on the recovery path. In this 
	  architecture there may be a need for coordination of the protection switching, 
	  and also for resource allocation negotiation. The procedures for this are for 
	  further study and may be addressed in future documents.
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.2"></a><h3>1.2.&nbsp;
Scope of the document</h3>

<p>As was pointed out in the Survivability Framework <a class='info' href='#SurvivFwk'>[SurvivFwk]<span> (</span><span class='info'>Sprecher, N., Farrel, A., and H. Shah, &ldquo;Multi-protocol Label Switching Transport Profile           Survivability Framework,&rdquo; Feb&nbsp;2009.</span><span>)</span></a> and highlighted above, there is a need for coordination 
		between the end points of the protection domain when employing bidirectional 
		protection schemes. This is especially true when there is a need to maintain 
		traffic over a co-routed bidirectional LSP.
</p>
<p>The scope of this draft is to present a protocol for the Protection State 
		Coordination of Linear Protection.  The protocol addresses the protection of 
		LSPs in an MPLS-TP network as required by <a class='info' href='#RFC5654'>[RFC5654]<span> (</span><span class='info'>Niven-Jenkins, B., Brungard, D., Betts, M., Sprecher, N., and S. Ueno, &ldquo;Requirements of an MPLS Transport Profile,&rdquo; September&nbsp;2009.</span><span>)</span></a> (in 
		particular requirements 63-67 and 74-79) and described in <a class='info' href='#SurvivFwk'>[SurvivFwk]<span> (</span><span class='info'>Sprecher, N., Farrel, A., and H. Shah, &ldquo;Multi-protocol Label Switching Transport Profile           Survivability Framework,&rdquo; Feb&nbsp;2009.</span><span>)</span></a>.  The basic protocol is designed for use in conjunction with the 1:1 protection 
		architecture (for both unidirectional and bidirectional protection) and for 
		1+1 protection of a bidirectional path (for both unidirectional and bidirectional 
		protection switching).  Applicability of the protocol for 1:n protection schemes
		may be documented in a future document.	The applicability of this protocol to 
		additional MPLS-TP constructs and topologies may be documented in future 
		documents.
</p>
<p>While the unidirectional 1+1 protection architecture does not require the
		use of a coordination protocol, the protocol may be used by the ingress node
		of the path to notify the far-side end point that a switching condition has 
		occurred and verify the consistency of the end point configuration.  This use may 
		be especially useful for point-to-multipoint transport paths, that are 
		unidirectional by definition of <a class='info' href='#RFC5654'>[RFC5654]<span> (</span><span class='info'>Niven-Jenkins, B., Brungard, D., Betts, M., Sprecher, N., and S. Ueno, &ldquo;Requirements of an MPLS Transport Profile,&rdquo; September&nbsp;2009.</span><span>)</span></a>.
		
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.3"></a><h3>1.3.&nbsp;
Contributing authors</h3>

<p>Hao Long (Huawei), Dan Frost (Cisco), Davide Chiara 
		(Ericsson), Francesco Fondelli (Ericsson), 
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Conventions used in this document</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
      "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
      document are to be interpreted as described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate           Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
Acronyms</h3>

<p style='text-align: left'>This draft uses the following acronyms:
</p><table class="none" align="left" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left">
<tr>
<td align="left">DNR</td>
<td align="left">Do not revert</td>
</tr>
<tr>
<td align="left">FS</td>
<td align="left">Forced Switch</td>
</tr>
<tr>
<td align="left">G-ACh</td>
<td align="left">Generic Associated Channel Header</td>
</tr>
<tr>
<td align="left">LER</td>
<td align="left">Label Switching Router</td>
</tr>
<tr>
<td align="left">MPLS-TP</td>
<td align="left">Transport Profile for MPLS</td>
</tr>
<tr>
<td align="left">MS</td>
<td align="left">Manual Switch</td>
</tr>
<tr>
<td align="left">P2P</td>
<td align="left">Point-to-point</td>
</tr>
<tr>
<td align="left">P2MP</td>
<td align="left">Point-to-multipoint</td>
</tr>
<tr>
<td align="left">PSC</td>
<td align="left">Protection State Coordination Protocol</td>
</tr>
<tr>
<td align="left">PST</td>
<td align="left">Path Segment Tunnel</td>
</tr>
<tr>
<td align="left">SD</td>
<td align="left">Signal Degrade</td>
</tr>
<tr>
<td align="left">SF</td>
<td align="left">Signal Fail</td>
</tr>
<tr>
<td align="left">SLA</td>
<td align="left">Service Level Agreement</td>
</tr>
<tr>
<td align="left">WTR</td>
<td align="left">Wait-to-Restore</td>
</tr>
</table>
<br clear="all" />

<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
Definitions and Terminology</h3>

<p>The terminology used in this document is based on the terminology
        defined in <a class='info' href='#RFC4427'>[RFC4427]<span> (</span><span class='info'>Mannie, E. and D. Papadimitriou, &ldquo;Recovery Terminology for Generalized Multi-Protocol Label           Switching,&rdquo; Mar&nbsp;2006.</span><span>)</span></a> and further adapted for
        MPLS-TP in <a class='info' href='#SurvivFwk'>[SurvivFwk]<span> (</span><span class='info'>Sprecher, N., Farrel, A., and H. Shah, &ldquo;Multi-protocol Label Switching Transport Profile           Survivability Framework,&rdquo; Feb&nbsp;2009.</span><span>)</span></a>. In addition, we use the
        term LER to refer to a MPLS-TP Network Element, whether it is a LSR,
        LER, T-PE, or S-PE.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Protection switching control logic</h3>

<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Protection switching control logical architecture</h3>

<p>Protection switching processes the local triggers described in 
		requirements 74-79 of <a class='info' href='#RFC5654'>[RFC5654]<span> (</span><span class='info'>Niven-Jenkins, B., Brungard, D., Betts, M., Sprecher, N., and S. Ueno, &ldquo;Requirements of an MPLS Transport Profile,&rdquo; September&nbsp;2009.</span><span>)</span></a> together with inputs
		received from the far-end LER. Based on these inputs the LER will take certain 
		protection switching actions, e.g. switching the Selector Bridge to select 
		the working or protection path, and transmit different protocol messages.
</p>
<p>The following figure shows the logical decomposition of the PSC Control 
		Logic into different logical processing units.  These processing units are 
		presented in subsequent subsections of this document.
</p><br /><hr class="insert" />
<a name="figure1"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
               Server Indication     Control Plane Indication
               -----------------+  +-------------
             Operator Command   |  |   OAM Indication
             ----------------+  |  |  +---------------
                             |  |  |  |
                             V  V  V  V
                          +---------------+         +-------+
                          | Local Request |&lt;--------|  WTR  |
                          |    logic      |WTR Exps | Timer |
                          +---------------+         +-------+
                                 |                      ^
                    Highest local|request               |
                                 V                      | Start/Stop
                         +-----------------+            |
             Remote PSC  |  PSC  Process   |------------+
            ------------&gt;|      logic      |
               Request   +-----------------+
                                 |
                                 |  Action         +------------+
                                 +----------------&gt;|  Message   |
                                                   | Generator  |
                                                   +------------+
                                                         |
                                              Output PSC | Message
                                                         V

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: Protection switching control logic&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p><a class='info' href='#figure1'>Figure&nbsp;1<span> (</span><span class='info'>Protection switching control logic</span><span>)</span></a> describes the logical architecture
        of the protection switching control. The Local Request logic unit
        accepts the triggers from the OAM, external operator commands, from the 
		local control plane (when present), and the Wait-to-Restore timer.  By
		considering all of these local request sources it determines the highest
        priority local request. This high-priority request is passed to the PSC
		Process logic, that will cross-check this local request with the information 
		received from the far-end LER. The PSC Process logic uses this input to
        determine what actions need to be taken, e.g. local actions at the LER, or 
		what message should be sent to the far-end LER, and the current status of 
		the protection domain.
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.1"></a><h3>3.1.1.&nbsp;
Local Request Logic</h3>

<p>The protection switching logic processes input triggers from five 
		sources:
</p>
<p></p>
<ul class="text">
<li>Operator command &ndash; the network operator may issue
            commands that trigger protection switching. The supported commands 
			are Forced Switch, Manual Switch, Clear, Lockout of Protection, 
			(see definitions in <a class='info' href='#RFC4427'>[RFC4427]<span> (</span><span class='info'>Mannie, E. and D. Papadimitriou, &ldquo;Recovery Terminology for Generalized Multi-Protocol Label           Switching,&rdquo; Mar&nbsp;2006.</span><span>)</span></a>).
</li>
<li>Server layer alarm indication &ndash; the underlying server 
			layer of the network detects failure conditions at the underlying 
			layer and may issue an indication to the MPLS-TP layer.  The server 
			layer may employ its own protection switching mechanism, and 
			therefore this input MAY be controlled by a holdoff-timer that 
			SHOULD be configurable by the network operator.
</li>
<li>Control plane &ndash; if there is a control plane active in the
            network (either signaling or routing), it MAY trigger protection
            switching based on conditions detected by the control plane. If
            the control plane is based on GMPLS <a class='info' href='#RFC3945'>[RFC3945]<span> (</span><span class='info'>Mannie, E., &ldquo;Generalized Multi-Protocol Label Switching (GMPLS)           Architecture,&rdquo; Oct&nbsp;2004.</span><span>)</span></a>
            then the recovery process SHALL comply with the process described
            in <a class='info' href='#RFC4872'>[RFC4872]<span> (</span><span class='info'>Lang, J., Papadimitriou, D., and Y. Rekhter, &ldquo;RSVP-TE Extensions in Support of End-to-End Generalized           Multi-Protocol Label Switching (GMPLS) Recovery,&rdquo; May&nbsp;2007.</span><span>)</span></a>.
</li>
<li>OAM indication &ndash; OAM fault management or performance 
			measurement tools may detect a failure or degrade condition on the MPLS-TP 
			transport path and this SHOULD input an indication to the Local 
			Request Logic.
</li>
<li>WTR expires &ndash; The Wait-to-Restore timer is used in conjunction 
			with recovery from failure conditions on the working path in revertive mode.  
			The timer SHALL signal the PSC control process when it expires and the 
			end point SHOULD revert to the normal transmission of the user data traffic.
</li>
</ul>

<p>The Local request logic SHALL process these different input sources and, 
		  based on the priorities between them, SHOULD produce a current local request.  
		  The different local requests that may be output from the Local Request Logic 
		  are:
</p>
<p></p>
<ul class="text">
<li>Clear &ndash; if the operator cancels an active local administrative 
			command, i.e. LO/FS/MS.
</li>
<li>Lockout of Protection (LO) &ndash; if the operator requested to disable 
			the protection path.
</li>
<li>Signal Fail (SF) &ndash; if any of the Server Layer, Control plane, or 
			OAM indications signaled a failure condition on either the protection path or 
			one of the working paths.
</li>
<li>Signal Degrade (SD) &ndash; if any of the Server Layer, Control plane, or 
			OAM indications signaled a degraded transmission condition on either the 
			protection path or one of the working paths
</li>
<li>Clear Signal Fail &ndash; if all of the Server Layer, Control plane, or OAM
			indications are no longer indicating a failure condition on a path that was
			peviously indicating a failure condition.
</li>
<li>Forced Switch (FS) &ndash; if the operator requested that traffic be 
			switched from one of the working paths to the protection path.
</li>
<li>Manual Switch (MS) &ndash; if the operator requested that traffic be switched 
			from its current path to the other path.  This is only relevant if there 
			is no currently active Fault condition or Operator command.
</li>
<li>WTR Expires &ndash; generated by the WTR timer completing its period.
</li>
</ul>

<p>If none of the input sources have generated any input then the current local 
		  request SHALL be a No Request (NR) request.
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.2"></a><h3>3.1.2.&nbsp;
Remote Requests</h3>

<p>In addition to the local requests generated as a result of the local triggers 
		indicated in the previous subsection, the PSC Control Logic SHALL accept PSC 
		messages from the far-end LER of the transport path.   These remote messages 
		indicate the status of the transport path from the viewpoint of the far-end LER, 
		and may indicate if the local MEP SHOULD initiate a protection switch operation.
</p>
<p>The following remote requests may be received by the PSC process:
</p>
<p></p>
<ul class="text">
<li>Remote LO &ndash; indicates that the remote end point is in Unavailable 
			state due to a Lockout of Protection operator command.
</li>
<li>Remote SF &ndash; indicates that the remote end point has detected a Signal 
			Fail condition on one of the transport paths in the protection domain.  
			This remote message SHALL include an indication of which transport path is 
			affected by the SF condition.  In addition, it should be noted that the SF 
			condition may be either a unidirectional or a bidirectional failure, even if  
			the transport path is bidirectional.
</li>
<li>Remote SD &ndash; indicates that the remote end point has detected a Signal 
			Degrade condition on one of the transport paths in the protection domain.  
			This remote message SHALL include an indication of which transport path is 
			affected by the SD condition.  In addition, it should be noted that the SD 
			condition may be either a unidirectional or a bidirectional failure, even if  
			the transport path is bidirectional.
</li>
<li>Remote FS &ndash; indicates that the remote end point is operating under 
			an operator command to switch the traffic to the protection path.
</li>
<li>Remote MS &ndash; indicates that the remote end point is operating under 
			an operator command to switch the traffic to the path that was not being 
			used previously.
</li>
<li>Remote WTR &ndash; indicates that the remote end point has determined that
			the failure condition has recovered and has started its WTR timer in 
			preparation for reverting to the Normal state.
</li>
<li>Remote DNR &ndash; indicates that the remote end point has determined that
			the failure condition has recovered and will continue transporting traffic on 
			the protection path due to operator configuration that prevents automatic 
			reversion to the Normal state.
</li>
<li>Remote NR &ndash; indicates that the remote end point has no abnormal 
			condition to report.
</li>
</ul>

<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.3"></a><h3>3.1.3.&nbsp;
PSC Process Logic</h3>

<p>The PSC Process Logic SHALL accept as input &ndash; 
		  </p>
<blockquote class="text"><dl>
<dt>a.</dt>
<dd>the Local request output from the Local Request Logic,
</dd>
<dt>b.</dt>
<dd>the remote request message from the remote end point of the transport 
		  path, and
</dd>
<dt>c.</dt>
<dd>the current state of the PSC Control Logic (maintained internally by 
		  the PSC Control Logic).
</dd>
</dl></blockquote>

<p>Based on the priorities between the different inputs, the PSC Process 
		  Logic SHALL determine the new state of the PSC Control Logic and what 
		  actions need to be taken.
</p>
<p>The new state information should be retained by the PSC Process Logic, 
		  while the requested action SHALL be sent to the PSC Message Generator (see 
		  subsection 3.1.4) to generate and transmit the proper PSC message to be 
		  transmitted to the remote end point of the protection domain.
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.4"></a><h3>3.1.4.&nbsp;
PSC Message Generator</h3>

<p>Based on the action output from the Process Logic this unit formats the 
		  PSC protocol message that is transmitted to the remote end point of the 
		  protection domain.  When the PSC information has changed, three PSC messages 
		  SHOULD be transmitted in quick succession, and subsequent messages should be 
		  transmitted continually at a lower rate.
</p>
<p>The transmission of three rapid packets allows for fast protection switching 
		  even if one or two PSC messages are lost or corrupted.  For protection 
		  switching within 50ms, it is RECOMMENDED that the default interval of the first 
		  three PSC messages SHOULD be no larger than 3.3ms.  The subsequent messages 
		  SHOULD be transmitted with an interval of 5 sec, to avoid traffic congestion.
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.5"></a><h3>3.1.5.&nbsp;
Wait-to-Restore (WTR) timer</h3>

<p>The WTR timer is used to delay reversion to Normal state when recovering 
		  from a failure condition on the working path and the protection domain is 
		  configured for revertive behavior.  The WTR may be in one of two states &ndash;
		  either Running or Stopped.  The WTR timer MAY be started or stopped by the PSC
		  Process Logic.
</p>
<p>If the WTR timer expires prior to being stopped it SHALL generate a WTR 
		  Expires local signal that shall be processed by the Local Request Logic.  If 
		  the WTR timer is running, sending a Stop command SHALL reset the timer but 
		  SHALL NOT generate a WTR Expires local signal.  If the WTR timer is not 
		  running, a Stop command SHALL be ignored.
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.6"></a><h3>3.1.6.&nbsp;
PSC Control States</h3>

<p>The PSC Control Logic SHOULD maintain information on the current state of 
		  the protection domain.  The state information SHALL include information of the 
		  current state and an indication of the cause for the current state (e.g. 
		  unavailable due to local LO command, protecting due to remote FS).  In 
		  particular, the state information SHOULD include an indication if the state 
		  is related to a remote or local condition.
</p>
<p>It should be noted that when referring to the &quot;transport&quot; of 
		  the data traffic, in the following descriptions and later in the document 
		  that the data will be transmitted on both the working and the protection 
		  paths when using 1+1 protection, and on either the working or the protection 
		  path exclusively when using 1:1 protection.  When using 1+1 protection, the
		  receiving LER should select the proper transmission, according to the state
		  of the protection domain.
</p>
<p>The states that are supported by the PSC Control Logic are:
		    </p>
<ul class="text">
<li>Normal state &ndash; Both the protection and working paths are fully 
			allocated and active, data traffic is being transported over (or selected
			from) the working path, and no trigger events are reported within the 
			domain.
</li>
<li>Unavailable state &ndash; The protection path is unavailable &ndash;
			either as a result of an operator Lockout command or a failure/degrade 
			condition detected on the protection path.
</li>
<li>Protecting failure state &ndash; The working path has reported a 
			failure/degrade condition and the user traffic is being transported (or
			selected) on the protection path.
</li>
<li>Protecting administrative state &ndash; The operator has issued a 
			command switching the user traffic to the protection path.
</li>
<li>Wait-to-restore state &ndash; The protection domain is recovering from 
			a SF/SD condition on the working path that is being controlled by the 
			Wait-to-Restore (WTR) timer.
</li>
<li>Do-not-revert state &ndash; The protection domain is recovering from a 
			Protecting state, but the operator has configured the protection domain to 
			not automatically revert to the Normal state upon recovery.  The protection
			domain SHALL remain in this state until the operator issues a command to 
			revert to the Normal state or there is a new trigger to switch to a
			different state.
</li>
</ul>

<p>See section 4.3.1 for details on what actions are taken by the PSC Process
			Logic for each state and the relevant input.
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Protection state coordination (PSC) protocol</h3>

<p>Bidirectional protection switching, as well as unidirectional 1:1
      protection, requires coordination between the two end points in
      determining which of the two possible paths, the working or recovery
      path, is transmitting the data traffic in any given situation. When
      protection switching is triggered as described in section 3.1, the
      end points must inform each other of the switch-over from one path to
      the other in a coordinated fashion.
</p>
<p>There are different possibilities for the type of coordinating
      protocol. One possibility is a two-phased coordination in which the LER
      that is initiating the protection switching sends a protocol message
      indicating the switch but the actual switch-over is performed only after
      receiving an 'Ack' from the far-end LER. The other possibility is a
      single-phased coordination, in which the initiating LER performs the 
	  protection switchover to the alternate path and informs the far-end LER 
	  of the switch, and the far-end LER MUST complete the switchover.
</p>
<p>This protocol is a single-phase protocol, as described above.  In the
	  following subsections we describe the protocol messages that SHALL be
	  used between the two end points of the protection domain.
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Transmission and acceptance of PSC control packets</h3>

<p>The PSC control packets SHALL be transmitted over the protection
        path only. This allows the transmission of the messages without
        affecting the normal data traffic in the most prevalent case, i.e. the Normal
        state. In addition, limiting the transmission to a single path avoids
        possible conflicts and race conditions that could develop if the PSC
        messages were sent on both paths.
</p>
<p>When the PSC information is changed due to a local input, three PSC messages 
		SHOULD be transmitted as quickly as possible, to allow for rapid protection 
		switching.  This set of three rapid messages allows for fast protection switching 
		even if one or two of these packets are lost or corrupted.  When the PSC 
		information changes due to a remote message there is no need for the 
		aforementioned rapid transmission of three messages.  The exception (e.g. 
		when the rapid tranmission is still required) is when going from WTR state to 
		Normal state as a result of a remote NR message.
</p>
<p>The frequency of the three rapid messages and the separate frequency of the 
		continual transmission SHOULD be configurable by the operator.  For protection 
		switching within 50ms, the default interval of the first three PSC messages is 
		RECOMMENDED to be no larger than 3.3ms.  The continuous transmission interval 
		is RECOMMENDED to be 5 seconds.
</p>
<p>If no valid PSC specific information is received, the last valid
        received information remains applicable. In the event a signal fail
        condition is detected on the protection path, the received PSC specific
        information should be evaluated.
</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Protocol format</h3>

<p>The protocol messages SHALL be sent over the G-ACh as described in
        <a class='info' href='#RFC5586'>[RFC5586]<span> (</span><span class='info'>Vigoureux,, M., Bocci, M., Swallow, G., Aggarwal, R., and D. Ward, &ldquo;MPLS Generic Associated Channel,&rdquo; May&nbsp;2009.</span><span>)</span></a>. There is a single channel type for the 
		set of PSC messages [to be assigned by IANA].  The actual message function 
		SHALL be identified by the Request field of the ACH payload as described 
		below.  The following figure shows the format for the complete PSC message:.
</p><br /><hr class="insert" />
<a name="figure 2"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |0 0 0 1|Version|  Reserved     |   Channel Type = MPLS-TP PSC  |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                          ACH TLV Header                       |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    ~                         Optional TLVs                         ~
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |Ver|Request|PT |R|  Reserved   |     FPath     |     Path      |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;2: Format of PSC packet with a G-ACh header&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>Where: </p>
<ul class="text">
<li>MPLS-TP PSC Channel Code is the G-ACh channel number assigned to
            the PSC = TBD
</li>
<li>The ACH TLV Header is described in <a class='info' href='#RFC5586'>[RFC5586]<span> (</span><span class='info'>Vigoureux,, M., Bocci, M., Swallow, G., Aggarwal, R., and D. Ward, &ldquo;MPLS Generic Associated Channel,&rdquo; May&nbsp;2009.</span><span>)</span></a>
</li>
<li>The following subsections describe the fields of the PSC payload.
</li>
</ul>

<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.1"></a><h3>4.2.1.&nbsp;
PSC Ver field</h3>

<p>The Ver field identifies the version of the protocol.  For this 
			version the value SHALL be 0.
</p>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.2"></a><h3>4.2.2.&nbsp;
PSC Request field</h3>

<p>The PSC protocol SHALL support transmission of the following requests 
		  between the two end points of the protection domain:
</p>
<p></p>
<ul class="text">
<li>(1110) Lockout of protection &ndash; indicates that the end point has 
			disabled the protection path as a result of an administrative command.  
			Both the FPath and Path fields SHALL be set to 0.
</li>
<li>(1101) Forced switch &ndash; indicates that the transmitting end point has 
			switched traffic to the protection path as a result of an administrative 
			command.  The Fpath field SHALL indicate that the working path is being 
			blocked (i.e. Fpath set to 1), and the Path field SHALL indicate that user 
			data traffic is being transported on the protection path (i.e. Path set to 1).
</li>
<li>(0110) Signal Fail &ndash; indicates that the transmitting end point has 
			identified a signal fail condition on either the working or protection 
			path.  The Fpath field SHALL identify the path that is reporting the failure 
			condition (i.e. if protection path then Fpath set to 0 and if working path
			then Fpath set to 1), and the Path field SHALL indicate where the data traffic 
			is being transported (i.e. if protection path is blocked then Path set to 0 
			and if working path is blocked then Path set to 1).
</li>
<li>(0101) Signal Defect &ndash; indicates that that the transmitting end point
			has identified a degradation of the signal, or integrity of the packet 
			transmission on either the working or protection path.  The specifics for 
			the method of identifying this degradation is out-of-scope for this document.
			The details of the actions to be taken for this situation is left for
			future specification.
</li>
<li>(0100) Manual switch &ndash; indicates that the transmitting end point has 
			switched traffic as a result of an administrative Manual Switch command.  
			The Fpath field SHALL indicate that the working path is being blocked (i.e. 
			Fpath set to 1), and the Path field SHALL indicate that user data traffic is 
			being transported on the protection path (i.e. Path set to 1).
</li>
<li>(0011) Wait to restore &ndash; indicates that the transmitting end point 
			is recovering from a failure condition of the working path and has started 
			the Wait-to-Restore timer.  Fpath SHALL be set to 0 and ignored upon 
			receipt.  Path SHALL indicate the working path that is currently being
			protected (i.e. Path set to 1).
</li>
<li>(0010) Do not revert &ndash; indicates that the transmitting end point is 
			recovering from a failure/blocked condition, but due to the local settings 
			is requesting that the protection domain continues to transmit data over 
			the protection path, rather than revert to the Normal state.  Fpath SHALL 
			be set to 0 and ignored upon receipt.  Path SHALL indicate the working 
			path that is currently being protected (i.e. Path set to 1).
</li>
<li>(0000) No request &ndash; indicates that the transmitting end point has 
			nothing to report, Fpath and Path fields SHALL be set to according to the 
			state of the end point, see section 4.3.3 for detailed scenarios.
</li>
</ul>

<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.3"></a><h3>4.2.3.&nbsp;
Protection Type (PT)</h3>

<p>The PT field indicates the currently configured protection architecture 
		  type, this SHOULD be validated to be consistent for both ends of the 
		  protection domain. If an inconsistency is detected then an alarm SHALL be 
		  sent to the management system. The following are the possible values:
</p>
<p></p>
<ul class="text">
<li>11: bidirectional switching using a permanent bridge
</li>
<li>10: bidirectional switching using a selector bridge
</li>
<li>01: unidirectional switching using a permanent bridge
</li>
<li>00: unidirectional switching using a selector bridge
</li>
</ul>

<p>As described in the introduction (section 1.1) a 1+1 protection architecture
		  is characterized by the use of a permanent bridge at the source node, whereas 
		  the 1:1 and 1:n protection architectures are characterized by the use of a 
		  selector bridge at the source node.
</p>
<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.4"></a><h3>4.2.4.&nbsp;
Revertive (R) field</h3>

<p>This field indicates that the transmitting end point is configured to work 
		  in revertive mode.  If there is an inconsistency between the two end points, 
		  i.e. one end point is configured for revertive action and the second end point 
		  is in non-revertive mode, then the management system SHOULD be notified.  
		  Possible values are:
</p>
<p></p>
<ul class="text">
<li>0 &ndash; non-revertive mode
</li>
<li>1 &ndash; revertive mode
</li>
</ul>

<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.5"></a><h3>4.2.5.&nbsp;
Fault path (FPath) field</h3>

<p>The Fpath field indicates which path (i.e. working or protection) is 
		  identified to be in a fault condition or affected by an administrative 
		  command.  The following are the possible values:
</p>
<p></p>
<ul class="text">
<li>0: indicates that the anomaly condition is on the protection
              path
</li>
<li>1: indicates that the anomaly condition is on the working path
</li>
<li>2-255: for future extensions
</li>
</ul>

<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.6"></a><h3>4.2.6.&nbsp;
Data path (Path) field</h3>

<p>The Path field indicates which data is being transmitted on the 
		  protection path.  Under normal conditions, the protection path 
		  (especially in 1:1 or 1:n architecture) does not need to carry any 
		  user data traffic.  If there is a failure/degrade condition on one of 
		  the working paths, then that working path's data traffic will be 
		  transmitted over the protection path.  The following are the 
		  possible values:
</p>
<p></p>
<ul class="text">
<li>0: indicates that the protection path is not transporting user 
			  data traffic (in 1:n architecture) or transporting redundant user 
			  data traffic (in 1+1 architecture).
</li>
<li>1: indicates that the protection path is transmitting user 
			  traffic replacing the use of the working path.
</li>
<li>2-255: for future extensions
</li>
</ul>

<a name="anchor25"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
Principles of Operation</h3>

<p>In all of the following subsections, assume a protection domain
        between LER-A and LER-Z, using paths W (working) and P (protection) as
        shown in figure 3.
</p><br /><hr class="insert" />
<a name="figure 3"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
              +-----+ //=======================\\ +-----+
              |LER-A|//     Working Path        \\|LER-Z|
              |    /|                             |\    |
              |  ?&lt; |                             | &gt;?  |
              |    \|\\    Protection Path      //|/    |
              +-----+ \\=======================// +-----+

                  |--------Protection Domain--------|

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;3: Protection domain&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor26"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.1"></a><h3>4.3.1.&nbsp;
Basic operation</h3>

<p>The purpose of the PSC protocol is to allow the end points of the protection 
		  domain to notify their peer of the status of the domain that is known at the end
		  point and coordinate the transmission of the data traffic.  The current state
		  of the end point is expressed in the values of the Request field [reflecting
		  the local requests at that end point] and the Fpath field [reflecting knowledge 
		  of a blocked path].  The coordination between the end points is expressed by 
		  the value of the Path field [indicating where the data traffic is being 
		  transmitted].  The value of the Path field SHOULD be identical for both end 
		  points at any particular time.  The values of the Request and Fpath fields may 
		  not be identical between the two end points.In particular it should be noted 
		  that a remote message MAY not cause the end point to change the Request field 
		  that is being transmitted while it does affect the Path field (see details in 
		  the following subsections).
</p>
<p>The protocol is a single-phase protocol.  Single-phase implies that each end 
		  point notifies its peer of a change in the operation (switching to or from the 
		  protection path) and makes the switch without waiting for acknowledgement.
</p>
<p>The following subsections will identify the messages that SHALL be transmitted 
		  by the end point in different scenarios.  The messages are described as 
		  REQ(FP, P) &ndash; where REQ is the value of the Request field,  FP is the 
		  value of the Fpath field, and P is the value of the Path field.  All examples 
		  assume a protection domain between LER-A and LER-Z with a single working path 
		  and single protection path (as shown in figure 3).  Again it should be noted that
		  when using 1:1 protection the data traffic will be transmitted exclusively on
		  either the protection or working path, while when using 1+1 protection the 
		  traffic will be transmitted on both paths and the receiving LER should select
		  the appropriate signal based on the state.  The text will refer to this 
		  transmission/selection as &quot;transport&quot; of the data traffic.
</p>
<a name="anchor27"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.2"></a><h3>4.3.2.&nbsp;
Priority of inputs</h3>

<p>As noted above (in section 3.1.1) the PSC Control Process 
		  accepts input from five local input sources.  There is a definition of 
		  priority between the different inputs that may be triggered locally.  The 
		  list of local requests in order of priority are (from highest to lowest 
		  priority):
</p>
<p></p>
<ol class="text">
<li>Clear (Operator command)
</li>
<li>Lockout of protection (Operator command)
</li>
<li>Signal Fail on protection (OAM/Control Plane/Server Indication)
</li>
<li>Forced switch (Operator command)
</li>
<li>Signal Fail on working (OAM/Control Plane/Server Indication)
</li>
<li>Signal Degrade on working (OAM/Control Plane/Server Indication)
</li>
<li>Clear Signal Fail/Degrade (OAM/Control Plane/Server Indication)
</li>
<li>Manual switch (Operator command)
</li>
<li>WTR expires (WTR Timer)
</li>
</ol>

<p>The determination of whether a remote message is accepted or ignored is 
		  a function of the current state of the local LER and the current local 
		  request (see section 3.1.3).  Part of this consideration will be included in 
		  the following subsections describing the operation in the different states.
</p>
<a name="anchor28"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.3"></a><h3>4.3.3.&nbsp;
Operation of PSC States</h3>

<a name="anchor29"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.3.1"></a><h3>4.3.3.1.&nbsp;
Normal State</h3>

<p>When the protection domain has no special condition in effect,
            the ingress LER SHALL forward the user data along the working
            path, and, in the case of 1+1 protection, the Permanent Bridge
            will bridge the data to the recovery path as well. The receiving
            LER SHALL read the data from the working path.
</p>
<p>When the end point is in Normal State it SHALL transmit a NR(0,0) 
			message, indicating &ndash; Nothing to report and data traffic is being 
			transported on the working path.
</p>
<p>When the LER (assume LER-A) is in Normal State the following transitions 
			are relevant in reaction to a local input (new state SHOULD be marked as 
			local):
			</p>
<ul class="text">
<li>A local Lockout of protection input SHALL cause the LER to go into 
			  Unavailable State and begin transmission of a LO(0,0) message to the 
			  far-end LER (LER-Z).
</li>
<li>A local Forced switch input SHALL cause the LER to go into Protecting 
			  administrative state and begin transmission of a FS(1,1) message to the 
			  far-end LER (LER-Z).
</li>
<li>A local Signal Fail indication on the protection path SHALL cause the 
			  LER to go into Unavailable state and begin transmission of a SF(0,0) message 
			  to the far-end LER (LER-Z).
</li>
<li>A local Signal Fail indication on the working path SHALL cause the LER 
			  to go into Protecting failure state and begin transmission of a SF(1,1) message 
			  to the far-end LER (LER-Z).
</li>
<li>A local Manual switch input SHALL cause the LER to go into Protecting 
			  administrative state and begin transmission of a MS(1,1) message to the 
			  far-end LER (LER-Z).
</li>
<li>All other local inputs SHOULD be ignored.
</li>
</ul>

<p>In Normal state, remote messages would cause the following reaction from 
			the LER (new state SHOULD be marked as remote):
			  </p>
<ul class="text">
<li>A remote Lockout of protection message SHALL cause the LER (LER-A) to go 
			  into Unavailable state, while continuing to transmit the NR(0,0) message.
</li>
<li>A remote Forced switch message SHALL cause the LER (LER-A) to go into 
			  Protecting administrative state, and transmit a NR(0,1) message.
</li>
<li>A remote Signal Fail message that indicates that the failure is on the 
			  protection path SHALL cause the LER (LER-A) to go into Unavailable state, 
			  while continuing to transmit the NR(0,0) message.
</li>
<li>A remote Signal Fail message that indicates that the failure is on the 
			  working path SHALL cause the LER (LER-A) to go into Protecting failure state, 
			  and transmit a NR(0,1) message.
</li>
<li>A remote Manual switch message SHALL cause the LER (LER-A) to go into 
			  Protecting administrative state, and transmit a NR(0,1) message.
</li>
<li>All other remote messages SHOULD be ignored.
</li>
</ul>

<a name="anchor30"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.3.2"></a><h3>4.3.3.2.&nbsp;
Unavailable State</h3>

<p>When the protection path is unavailable &ndash; either as a result 
			of a Lockout operator command, or as a result of a SF or SD detected 
			on the protection path &ndash; then the protection domain is in the 
			unavailable state. In this state, the data traffic is transported on 
			the working path.
</p>
<p>The protection domain will exit the unavailable state and revert to 
			the normal state when, either the operator clears the Lockout command 
			or the protection path recovers from the signal fail or degraded 
			situation. Both ends will resume sending the PSC packets over the 
			protection path, as a result of this recovery.
</p>
<p>When in unavailable state the data traffic is being transported on 
			the working path and is not protected.  When the domain is in unavailable 
			state the PSC messages may not get through and therefore the protection 
			is more dependent on the local inputs rather than the remote messages 
			(that may not be received).
</p>
<p>When the LER (assume LER-A) is in Unavailable State the following 
			transitions are relevant in reaction to a local input (new state SHOULD 
			be marked as local):
			</p>
<ul class="text">
<li>A local Clear input SHOULD be ignored if the LER is in remote 
			  Unavailable state.  If in local Unavailable state due to a Lockout 
			  command, then the input SHALL cause the LER to go to Normal state and 
			  begin transmitting a NR(0,0) message.
</li>
<li>A local Lockout of protection input SHALL cause the LER to remain in 
			  Unavailable State and begin transmission of a LO(0,0) message to the 
			  far-end LER (LER-Z).
</li>
<li>A local Clear SF in local Unavailable state due to a Signal Fail 
			  on the protection path and the Clear SF indicates that the protection 
			  path is now cleared, then the input SHALL cause the LER to go to Normal 
			  state and begin transmitting a NR(0,0) message.  If the LER is in remote
			  Unavailable state but is under a local SF condition, then the local Clear
			  SF SHALL clear the SF local condition and the LER SHALL begin transmitting
			  NR(0,0) messages, maintaining the remote Unavailable state.  In all other
			  cases the local Clear SF SHOULD be ignored.
</li>
<li>A local Forced switch SHOULD be ignored by the PSC Process Logic.
</li>
<li>A local Signal Fail indication on the protection path SHALL cause the 
			  LER to remain in Unavailable state and begin transmission of a SF(0,0) 
			  message.
</li>
<li>All other local inputs SHOULD be ignored.
</li>
</ul>

<p>If remote messages are being received over the protection path then they 
			would have the following affect:
			</p>
<ul class="text">
<li>A remote Lockout of protection message SHALL cause the LER to remain in 
			  Unavailable state, and continue transmission of the current message (either 
			  NR(0,0) or LO(0,0) or SF(0,0))
</li>
<li>A remote Signal Fail message that indicates that the failure is on the 
			  protection path SHALL cause the LER to remain in Unavailable state and 
			  continue transmission of the current message (either NR(0,0) or SF(0,0) or
			  LO(0,0)).
</li>
<li>A remote No Request, when the LER is remote Unavailable state SHALL 
			  cause the LER to go into Normal state and begin transmission of a NR(0,0) 
			  message.  When in local Unavailable state, the message SHALL be ignored.
</li>
<li>All other remote messages SHOULD be ignored.
</li>
</ul>

<a name="anchor31"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.3.3"></a><h3>4.3.3.3.&nbsp;
Protecting administrative state</h3>

<p>In the protecting state the user data traffic is being transported on 
			the protection path, while the working path is blocked due to an operator 
			command, i.e. Forced Switch or Manual Switch.
</p>
<p>The following describe the reaction to local input:
			</p>
<ul class="text">
<li>A local Clear SHOULD be ignored if in remote Protecting state.  If 
			  in local Protecting administrative state then this input SHALL cause 
			  the LER to go into Normal state and begin transmitting a NR(0,0) 
			  message.
</li>
<li>A local Lockout of protection input SHALL cause the LER to go into 
			  Unavailable state and begin transmission of a LO(0,0) message.
</li>
<li>A local Forced switch input SHALL cause the LER to remain in Protecting 
			  administrative state and begin transmission of a FS(1,1) message.
</li>
<li>A local Signal Fail indication on the protection path SHALL cause the 
			  LER to go into Unavailable state and begin transmission of a SF(0,0) 
			  message.
</li>
<li>A local Signal Fail indication on the working path SHOULD be filtered 
			  by the Local Request Logic if the protecting state was entered due to an 
			  active local Forced switch operator command.  If the protecting state is 
			  due to a remote Forced switch message, then this local indication SHOULD 
			  be filtered by the PSC Process Logic.  If the current state is due to a 
			  (local or remote) Manual switch operator command, it SHALL cause the LER 
			  to go into Protecting failure state and begin transmitting a SF(1,1) 
			  message.
</li>
<li>A local Clear SF when in remote Protecting administrative state SHOULD
			  clear any local SF condition that may exist.  The LER SHALL stop 
			  transmitting the SF(1,1) message and begin transmitting an NR(0,1) message.
</li>
<li>A local Manual switch input SHALL be filtered by the Local Request Logic 
			  if there is an active local Forced switch.  If the protecting state is due 
			  to a remote Forced switch command, then this local indication SHOULD be 
			  filtered by the PSC Process Logic.  If the current state is due to a (local 
			  or remote) Manual switch operator command, it SHALL cause the LER to remain 
			  in Protecting administrative state and begin transmission of a MS(1,1) 
			  message.
</li>
<li>All other local inputs SHOULD be ignored.
</li>
</ul>

<p>While in Protecting administrative state the LER may receive and react 
			  as follows to remote PSC messages:
			  </p>
<ul class="text">
<li>A remote Lockout of protection message SHALL cause the LER to go into 
				Unavailable state and begin transmitting a NR(0,0) message.  It should be 
				noted that this automatically cancels the current Forced switch or Manual 
				switch command and data traffic is reverted to the working path.
</li>
<li>A remote Forced switch message SHOULD be ignored by the PSC Process 
				Logic if there is an active local Forced switch operator command.  If the 
				Protecting state is due to a remote Forced switch message then the LER 
				SHALL remain in Protecting administrative state and continue transmission 
				of the last message.  If the Protecting state is due to either a local or 
				remote Manual switch then the LER SHALL remain in Protecting administrative 
				state (updating the state information with the proper relevant information) 
				and begin transmitting a NR(0,1) message.
</li>
<li>A remote Signal Fail message indicating a failure on the protection path 
				SHALL cause the LER to go into Unavailable state and begin transmitting a 
				NR(0,0) message.  It should be noted that this automatically cancels the 
				current Forced switch or Manual switch command and data traffic is reverted 
				to the working path.
</li>
<li>A remote Signal Fail message indicating a failure on the working path 
				SHALL be ignored if there is an active local Forced switch command.  If 
				the Protecting state is due to a local or remote Manual switch then the 
				LER SHALL go to Protecting failure state and begin transmitting a NR(0,1) 
				message.
</li>
<li>A remote Manual switch message SHALL be ignored by the PSC Process Logic 
				if in Protecting state due to a local or remote Forced switch.  If in 
				Protecting state due to a remote Manual switch then the LER SHALL remain in 
				Protecting administrative state and continue transmitting the current 
				message.  If in Protecting state due to an active local Manual switch then 
				the LER SHALL remain in Protecting administrative state and continue 
				transmission of the MS(1,1) message.
</li>
<li>A remote DNR(0,0) message SHALL be ignored if in Protecting state due to 
				a local input.  If in Protecting state due to a remote message then the LER 
				SHALL go to Do-not-revert state and begin transmitting a NR(0,0) message.
</li>
<li>A remote NR(0,0) message SHALL be ignored if in Protecting state due to a 
				local input.  If in Protecting state due to a remote message then the LER 
				SHALL go to Normal state and begin transmitting a NR(0,0) message.
</li>
<li>All other remote messages SHOULD be ignored.
</li>
</ul>

<a name="anchor32"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.3.4"></a><h3>4.3.3.4.&nbsp;
Protecting failure state</h3>

<p>When the protection mechanism has been triggered and the protection domain 
			has performed a protection switch, the domain is in the protecting failure state. 
			In this state the normal data traffic is transported on the protection path.
</p>
<p>The following describe the reaction to local input:
			</p>
<ul class="text">
<li>A local Clear SF SHOULD be ignored if in remote Protecting state.  If the 
			  Clear SF indicates that the protection path is now cleared (but working is 
			  still in SF condition) then the indicateion SHOULD be ignored.  If in 
			  local Protecting failure state and the LER is configured for revertive 
			  behavior then this input SHALL cause the LER to go into Wait-to-restore state,
			  start the WTR timer, and begin transmitting a WTR(0,1) message.  If in local 
			  Protecting failure state and the LER is configured for non-revertive behavior 
			  then this input SHALL cause the LER to go into Do-not-revert state and begin 
			  transmitting a DNR(0,1) message.
</li>
<li>A local Lockout of protection input SHALL cause the LER to go into 
			  Unavailable state and begin transmission of a LO(0,0) message.
</li>
<li>A local Forced switch input SHALL cause the LER to go into Protecting 
			  administrative state and begin transmission of a FS(1,1) message.
</li>
<li>A local Signal Fail indication on the protection path SHALL cause the LER 
			  to go into Unavailable state and begin transmission of a SF(0,0) message.
</li>
<li>A local Signal Fail indication on the working path SHALL cause the LER to 
			  remain in Protecting failure state and begin transmitting a SF(1,1) message.
</li>
<li>All other local inputs SHOULD be ignored.
</li>
</ul>

<p>While in Protecting failure state the LER may receive and react as follows to 
			remote PSC messages:
			</p>
<ul class="text">
<li>A remote Lockout of protection message SHALL cause the LER to go into 
			  Unavailable state and if in protecting failure state due to a local SF 
			  condition then the LER SHALL begin transmitting a SF(1,0) message, otherwise 
			  it SHALL transmit a NR(0,0) message.  It should be noted that this may cause 
			  loss of user data since the working path is still in a failure condition.
</li>
<li>A remote Forced switch message SHALL cause the LER go into Protecting 
			  administrative state and if in protecting failure state due to a local SF 
			  condition the LER SHALL begin transmitting the SF(1,1) message, otherwise 
			  it SHALL begin transmitting NR(0,0).
</li>
<li>A remote Signal Fail message indicating a failure on the protection path 
			  SHALL cause the LER to go into Unavailable state and if in protecting failure 
			  state due to a local SF condition then the LER SHALL begin transmitting a 
			  SF(1,0) message, otherwise it SHALL begin transmitting NR(0,0) message.  It 
			  should be noted that this may cause loss of user data since the working path 
			  is still in a failure condition.
</li>
<li>If in Protecting state due to a remote message, a remote Wait-to-Restore 
			  message SHALL cause the LER to go into Wait-to-Restore state and continue 
			  transmission of the current message.
</li>
<li>If in Protecting state due to a remote message, a remote Do-not-revert 
			  message SHALL cause the LER to go into Do-not-revert state and continue 
			  transmission of the current message.
</li>
<li>All other remote messages SHOULD be ignored.
</li>
</ul>

<a name="anchor33"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.3.5"></a><h3>4.3.3.5.&nbsp;
Wait-to-restore state</h3>

<p>The Wait-to-Restore state is used by the PSC protocol to delay reverting to 
			the normal state, when recovering from a failure condition on the working path, 
			for the period of the WTR timer to allow the recovering failure to stabilize.  
			While in the Wait-to-Restore state the data traffic SHALL continue to be 
			transported on the protection path.  The natural transition from the 
			Wait-to-Restore state to Normal state will occur when the WTR timer expires.
</p>
<p>When in Wait-to-Restore state the following describe the reaction to local 
			inputs:
			</p>
<ul class="text">
<li>A local Lockout of protection command SHALL cause the LER to Stop the WTR 
			  timer, go into Unavailable state, and begin transmitting a LO(0,0) message.
</li>
<li>A local Forced switch command SHALL cause the LER to Stop the WTR timer, go 
			  into Protecting administrative state, and begin transmission of a FS(1,1) 
			  message.
</li>
<li>A local Signal Fail indication on the protection path SHALL cause the LER 
			  to Stop the WTR timer, go into Unavailable state, and begin transmission of a 
			  SF(0,0) message.
</li>
<li>A local Signal Fail indication on the working path SHALL cause the LER to 
			  Stop the WTR timer, go into Protecting failure state, and begin transmission of 
			  a SF(1,1) message.
</li>
<li>A local Manual switch input SHALL cause the LER to Stop the WTR timer, go 
			  into Protecting administrative state and begin transmission of a MS(1,1) 
			  message.
</li>
<li>A local WTR expires input SHALL cause the LER to remain in Wait-to-Restore 
			  state and begin transmitting a NR(0,1) message.
</li>
<li>All other local inputs SHOULD be ignored.
			  
</li>
</ul>

<p>When in Wait-to-Restore state the following describe the reaction to remote 
			messages:
			</p>
<ul class="text">
<li>A remote Lockout of protection message SHALL cause the LER to Stop the WTR 
			  timer, go into Unavailable state, and begin transmitting a NR(0,0) message.
</li>
<li>A remote Forced switch message SHALL cause the LER to Stop the WTR timer, 
			  go into Protecting administrative state, and begin transmission of a NR(0,1) 
			  message.
</li>
<li>A remote Signal Fail message for the protection path SHALL cause the LER 
			  to Stop the WTR timer, go into Unavailable state, and begin transmission of 
			  a NR(0,0) message.
</li>
<li>A remote Signal Fail message for the working path SHALL cause the LER to 
			  Stop the WTR timer, go into Protecting failure state, and begin transmission 
			  of a NR(0,1) message.
</li>
<li>A remote Manual switch message SHALL cause the LER to Stop the WTR timer, 
			  go into Protecting administrative state and begin transmission of a NR(0,1) 
			  message.
</li>
<li>If the WTR timer is running then a remote NR message SHALL be ignored.  
			  If the WTR timer is no longer running then a remote NR message SHALL cause 
			  the LER to go into Normal state and begin transmitting a NR(0,0) message.
</li>
<li>All other remote messages SHOULD be ignored.
</li>
</ul>

<a name="anchor34"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.3.6"></a><h3>4.3.3.6.&nbsp;
Do-not-revert state</h3>

<p>Do-not-revert state is a continuation of the protecting state when the 
			protection domain is configured for non-revertive behavior.  While in 
			Do-not-revert state, data traffic continues to be transported on the protection 
			path until the administrator sends a command to revert to the Normal state.  
			It should be noted that there is a fundemental difference between this state 
			and Normal &ndash; whereas Forced Switch in Normal state actually causes a 
			switch in the transport path used, in Do-not-revert state the Forced switch 
			just switches the state (to Protecting administrative state) but the traffic 
			would continue to be transported on the protection path!  The command to revert 
			back to Normal state could either be a Lockout of protection (followed be a 
			Clear command), a Clear command, or a new form of the Manual switch command 
			[note: This would also require some kind of agreement, although it seems to 
			have been adopted by ITU-T in G.8031 for Ethernet].  The following description 
			of operation is based on the Lockout/Clear option mentioned!
</p>
<p>When in Do-not-revert state the following describe the reaction to local 
			input:
			</p>
<ul class="text">
<li>A local Lockout of protection command SHALL cause the LER to go into 
			  Unavailable state and begin transmitting a LO(0,0) message.
</li>
<li>A local Forced switch command SHALL cause the LER to go into Protecting 
			  administrative state and begin transmission of a FS(1,1) message.
</li>
<li>A local Signal Fail indication on the protection path SHALL cause the 
			  LER to go into Unavailable state and begin transmission of a SF(0,0) 
			  message.
</li>
<li>A local Signal Fail indication on the working path SHALL cause the LER 
			  to go into Protecting failure state and begin transmission of a SF(1,1) 
			  message.
</li>
<li>A local Manual switch input SHALL cause the LER to go into Protecting 
			  administrative state and begin transmission of a MS(1,1) message.
</li>
<li>All other local inputs SHOULD be ignored.
</li>
</ul>

<p>When in Do-not-revert state the following describe the reaction to remote 
			messages:
			</p>
<ul class="text">
<li>A remote Lockout of protection message SHALL cause the LER to go into 
			  Unavailable state and begin transmitting a NR(0,0) message.
</li>
<li>A remote Forced switch message SHALL cause the LER to go into Protecting 
			  administrative state and begin transmission of a NR(0,1) message.
</li>
<li>A remote Signal Fail message for the protection path SHALL cause the LER 
			  to go into Unavailable state and begin transmission of a NR(0,0) message.
</li>
<li>A remote Signal Fail message for the working path SHALL cause the LER to 
			  go into Protecting failure state, and begin transmission of a NR(0,1) message.
</li>
<li>A remote Manual switch message SHALL cause the LER to go into Protecting 
			  administrative state and begin transmission of a NR(0,1) message.
</li>
<li>All other remote messages SHOULD be ignored.
</li>
</ul>

<a name="IANA"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
IANA Considerations</h3>

<p>To be added in future version.
</p>
<a name="Security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Security Considerations</h3>

<p>To be added in future version.
</p>
<a name="Acknowledgements"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Acknowledgements</h3>

<p>The authors would like to thank all members of the teams (the Joint
      Working Team, the MPLS Interoperability Design Team in IETF and the
      T-MPLS Ad Hoc Group in ITU-T) involved in the definition and
      specification of MPLS Transport Profile.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>8.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text">Bradner, S., &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate
          Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5654">[RFC5654]</a></td>
<td class="author-text">Niven-Jenkins, B., Brungard, D., Betts, M., Sprecher, N., and S. Ueno, &ldquo;<a href="http://tools.ietf.org/html/rfc5654">Requirements of an MPLS Transport Profile</a>,&rdquo; RFC&nbsp;5654, September&nbsp;2009.</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>8.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC3031">[RFC3031]</a></td>
<td class="author-text">Rosen, E., Viswanathan, A., and R. Callon, &ldquo;<a href="http://tools.ietf.org/html/rfc3031">Multiprotocol Label Switching
          Architecture</a>,&rdquo; RFC&nbsp;3031, Jan&nbsp;2001.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3032">[RFC3032]</a></td>
<td class="author-text">Rosen, E., Tappan, D., Fedorkow, G., Rekhter, Y., Farinacci, D., Li, T., and A. Conta, &ldquo;<a href="http://tools.ietf.org/html/rfc3032">MPLS Label Stack Encoding</a>,&rdquo; RFC&nbsp;3032, Jan&nbsp;2001.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5659">[RFC5659]</a></td>
<td class="author-text">Bocci, M. and S. Bryant, &ldquo;<a href="http://tools.ietf.org/html/rfc5659">An Architecture for Multi-Segment Pseudowire Emulation 
		  Edge-to-Edge</a>,&rdquo; RFC&nbsp;5659, October&nbsp;2009.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3985">[RFC3985]</a></td>
<td class="author-text">Bryant, S. and P. Pate, &ldquo;<a href="http://tools.ietf.org/html/rfc3985">Pseudowire Emulation Edge-to-Edge (PWE3) Architecture</a>,&rdquo; RFC&nbsp;3985, March&nbsp;2005 (<a href="ftp://ftp.isi.edu/in-notes/rfc3985.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5085">[RFC5085]</a></td>
<td class="author-text">Nadeau, T. and C. Pignataro, &ldquo;<a href="http://tools.ietf.org/html/rfc5085">Pseudowire Virtual Circuit Connectivity Verification (VCCV):
          A Control Channel for Pseudowires</a>,&rdquo; RFC&nbsp;5085, December&nbsp;2007 (<a href="ftp://ftp.isi.edu/in-notes/rfc5085.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="TPFwk">[TPFwk]</a></td>
<td class="author-text">Bocci, M., Bryant, S., and L. Levrau, &ldquo;A Framework for MPLS in Transport Networks,&rdquo; ID&nbsp;draft-ietf-mpls-tp-framework-06.txt, July&nbsp;2009.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5586">[RFC5586]</a></td>
<td class="author-text">Vigoureux,, M., Bocci, M., Swallow, G., Aggarwal, R., and D. Ward, &ldquo;<a href="http://tools.ietf.org/html/rfc5586">MPLS Generic Associated Channel</a>,&rdquo; RFC&nbsp;5586, May&nbsp;2009.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4427">[RFC4427]</a></td>
<td class="author-text">Mannie, E. and D. Papadimitriou, &ldquo;<a href="http://tools.ietf.org/html/rfc4427">Recovery Terminology for Generalized Multi-Protocol Label
          Switching</a>,&rdquo; RFC&nbsp;4427, Mar&nbsp;2006.</td></tr>
<tr><td class="author-text" valign="top"><a name="SurvivFwk">[SurvivFwk]</a></td>
<td class="author-text">Sprecher, N., Farrel, A., and H. Shah, &ldquo;Multi-protocol Label Switching Transport Profile
          Survivability Framework,&rdquo; ID&nbsp;draft-ietf-mpls-tp-survive-fwk-02.txt, Feb&nbsp;2009.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4872">[RFC4872]</a></td>
<td class="author-text">Lang, J., Papadimitriou, D., and Y. Rekhter, &ldquo;<a href="http://tools.ietf.org/html/rfc4872">RSVP-TE Extensions in Support of End-to-End Generalized
          Multi-Protocol Label Switching (GMPLS) Recovery</a>,&rdquo; RFC&nbsp;4872, May&nbsp;2007.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3945">[RFC3945]</a></td>
<td class="author-text">Mannie, E., &ldquo;<a href="http://tools.ietf.org/html/rfc3945">Generalized Multi-Protocol Label Switching (GMPLS)
          Architecture</a>,&rdquo; RFC&nbsp;3945, Oct&nbsp;2004.</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Stewart Bryant (editor)</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">United Kingdom</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:stbryant@cisco.com">stbryant@cisco.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Eric Osborne</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">United States</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:eosborne@cisco.com">eosborne@cisco.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Nurit Sprecher (editor)</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Nokia Siemens Networks</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">3 Hanagar St. Neve Ne'eman B</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Hod Hasharon,   45241</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Israel</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:nurit.sprecher@nsn.com">nurit.sprecher@nsn.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Annamaria Fulignoli (editor)</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Ericsson</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Italy</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text"></td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:annamaria.fulignoli@ericsson.com">annamaria.fulignoli@ericsson.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Yaacov Weingarten</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Nokia Siemens Networks</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">3 Hanagar St. Neve Ne'eman B</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Hod Hasharon,   45241</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Israel</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+972-9-775 1827</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:yaacov.weingarten@nsn.com">yaacov.weingarten@nsn.com</a></td></tr>
</table>
</body></html>
