<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Location Configuration Extensions for Policy Management</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Location Configuration Extensions for Policy Management">
<meta name="keywords" content="geopriv, geolocation, privacy, policy">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">GEOPRIV</td><td class="header">R. Barnes</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">BBN Technologies</td></tr>
<tr><td class="header">Intended status: Informational</td><td class="header">October 07, 2009</td></tr>
<tr><td class="header">Expires: April 10, 2010</td><td class="header">&nbsp;</td></tr>
</table></td></tr></table>
<h1><br />Location Configuration Extensions for Policy Management<br />draft-barnes-geopriv-policy-uri-00</h1>

<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on April 10, 2010.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2009 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents in effect on the date of
publication of this document (http://trustee.ietf.org/license-info).
Please review these documents carefully, as they describe your
rights and restrictions with respect to this document.</p>

<h3>Abstract</h3>

<p>Current location configuration protocols are capable of provisioning an Internet host with a location URI that refers to the host's location.  However, these protocols lack a mechnism for the htarget host to inspect or set the privacy rules that are applied to the URIs they distribute.  This document extends the current location configuration protocols to provide hosts with a reference to the rules that are applied to a URI, so that the host can view or set these rules.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#intro-sec">1.</a>&nbsp;
Introduction<br />
<a href="#def-sec">2.</a>&nbsp;
Definitions<br />
<a href="#policy-uri-sec">3.</a>&nbsp;
Policy URIs<br />
<a href="#extn-sec">4.</a>&nbsp;
Location Configuration Extensions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#held-extn-sec">4.1.</a>&nbsp;
HELD<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#dhcp-extn-sec">4.2.</a>&nbsp;
DHCP<br />
<a href="#example-sec">5.</a>&nbsp;
Examples<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#held-example-sec">5.1.</a>&nbsp;
HELD<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#dhcp-example-sec">5.2.</a>&nbsp;
DHCP<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#policy-example-sec">5.3.</a>&nbsp;
Basic access control policy<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#possession-example-sec">5.4.</a>&nbsp;
The possession model<br />
<a href="#ack-sec">6.</a>&nbsp;
Acknowledgements<br />
<a href="#iana-sec">7.</a>&nbsp;
IANA Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#iana-ns-sec">7.1.</a>&nbsp;
URN Sub-Namespace Registration for urn:ietf:params:xml:ns:geopriv:held:policy<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#iana-schema-sec">7.2.</a>&nbsp;
XML Schema Registration<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#iana-dhcp-sec">7.3.</a>&nbsp;
DHCP LuriType Registration<br />
<a href="#sec-cons-sec">8.</a>&nbsp;
Security Considerations<br />
<a href="#rfc.references1">9.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">9.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">9.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Author's Address<br />
</p>
<br clear="all" />

<a name="intro-sec"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>A critical step in enabling Internet hosts to access location-based services is to provision those hosts with information about their own location.  This is accomplished via a Location Configuration Protocol (LCP) <a class='info' href='#I-D.ietf-geopriv-l7-lcp-ps'>[7]<span> (</span><span class='info'>Tschofenig, H. and H. Schulzrinne, &ldquo;GEOPRIV Layer 7 Location Configuration Protocol; Problem Statement and Requirements,&rdquo; July&nbsp;2009.</span><span>)</span></a>, which allow a location provider (e.g., a local access network) to inform a host about its location.
</p>
<p>There are two basic patterns for location configuration, namely configuration "by value" and "by reference" <a class='info' href='#I-D.ietf-geopriv-lbyr-requirements'>[8]<span> (</span><span class='info'>Marshall, R., &ldquo;Requirements for a Location-by-Reference Mechanism,&rdquo; November&nbsp;2009.</span><span>)</span></a>.  Configuration by value provisions a host directly with its location, by providing it location information that is directly usable (e.g., coordinates or a civic address).  Configuration by reference provides a host with a URI that references the host's location, i.e., one that can be dereferenced to obtain the location (by value) of the host.
</p>
<p>In some cases, location by reference offers a few benefits over location by value.  From a privacy perspective, the required dereference transaction provides a policy enforcement point, so that the opaque URI itself can be safely conveyed over untrusted media (e.g., SIP through untrusted proxies <a class='info' href='#RFC5606'>[9]<span> (</span><span class='info'>Peterson, J., Hardie, T., and J. Morris, &ldquo;Implications of 'retransmission-allowed' for SIP Location Conveyance,&rdquo; August&nbsp;2009.</span><span>)</span></a>).  If the target host is mobile, an application provider can use a single reference to obtain the location of the host multiple times, saving bandwidth to the host.  For some configuration protocols, the location object referenced by a location URI provides a much more expressive syntax for location values than the configuration protocol itself (e.g., DHCP geodetic location <a class='info' href='#I-D.ietf-geopriv-rfc3825bis'>[10]<span> (</span><span class='info'>Polk, J., Schnizlein, J., Linsner, M., Thomson, M., and B. Aboba, &ldquo;Dynamic Host Configuration Protocol Options for Coordinate-based Location Configuration Information,&rdquo; March&nbsp;2010.</span><span>)</span></a> versus GML in a PIDF-LO <a class='info' href='#RFC4119'>[11]<span> (</span><span class='info'>Peterson, J., &ldquo;A Presence-based GEOPRIV Location Object Format,&rdquo; December&nbsp;2005.</span><span>)</span></a>). 
</p>
<p>From a privacy perspective, however, current LCPs are limited in their flexibility, in that they do not provide the Target (the client in an LCP) with a way to inform the Location Server with policy for how his location information should be handled.  This document addresses this gap by defining a simple mechanism for referring to and manipulating policy, and by extending current LCPs to carry policy references.  Using the mechanisms defined in this document, a Location Server (acting as an LCP server) can inform a client as to which policy document controls a given location resource, and the LCP client (a Target and Rule Maker) can inspect this document and modify it as necessary.
</p>
<p>The remainder of this document is structured as follows: After introducing a few relevant terms, we define policy URIs as a channel for referencing, inspecting, and updating policy documents.  We then define extensions to HELD protocol and the DHCP option for location by reference to allow these protocols to cary policy URIs.  Examples are given that demonstrate how policy URIs are carried in these protocols and how they can be used by clients.
</p>
<a name="def-sec"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Definitions</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
      "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
      document are to be interpreted as described in <a class='info' href='#RFC2119'>RFC 2119<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a> [1].
</p>
<a name="policy-uri-sec"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Policy URIs</h3>

<p>A policy URI is an HTTP or HTTPS URI that a Rule Holder can use to inspect and install policy documents that tell a location server how it should protect a given location resource.  A policy URI is always a reference to a common-policy document <a class='info' href='#RFC4745'>[2]<span> (</span><span class='info'>Schulzrinne, H., Tschofenig, H., Morris, J., Cuellar, J., Polk, J., and J. Rosenberg, &ldquo;Common Policy: A Document Format for Expressing Privacy Preferences,&rdquo; February&nbsp;2007.</span><span>)</span></a> (possibly including some extensions, e.g., for geolocation policy <a class='info' href='#I-D.ietf-geopriv-policy'>[3]<span> (</span><span class='info'>Schulzrinne, H., Tschofenig, H., Morris, J., Cuellar, J., and J. Polk, &ldquo;Geolocation Policy: A Document Format for Expressing Privacy Preferences for Location Information,&rdquo; January&nbsp;2010.</span><span>)</span></a>).
</p>
<p>A server that is the authority for policy URIs MUST support GET, PUT, and DELETE requests to these URIs, in order to allow clients to inspect, replace, and delete policy documents.  While the server MAY deny any particular request according to local policy, it SHOULD allow all requests (with any of the three methods) from the Target of the protected location resource.  Clients MUST likewise support the three required request types.
</p>
<p>A GET request to a policy URI is a request for the referenced policy information.  In response to a GET request, the server MUST validate that the requestor is an authorized Rule Maker or Rule Holder according to local policy.  If the request is valid, then the server MUST send an HTTP 200 response containing the full policy document referenced by the URI, in the common-policy format; these responses MUST have content-type 'application/auth-policy+xml'.
</p>
<p>A PUT request to a policy URI is a request to replace the current policy.  The entity-body of a PUT requests MUST be a common-policy document; it must have content-type 'application/auth-policy+xml'.  When a server receives a PUT request, it MUST validate the policy document included in the body of the request, and it MUST validate that the requestor is an authorized Rule Maker or Rule Holder according to local policy.  If the request is valid, then the server MUST replace the current policy document referenced by the URI with the policy document provided in the request.
</p>
<p>A DELETE request to a policy URI is a request to delete the referenced policy document and terminate access to the protected resource.  In response to a DELETE request, the server MUST validate that the requestor is an authorized Rule Maker or Rule Holder according to local policy.  If the request is valid, then the server MUST delete the policy document referenced by the URI and disallow any further access to the location resource it governs.
</p>
<p>It should be noted that this usage of HTTP is generally compatible with the use of XCAP or WebDAV to manage policy documents, but this document does not define or require the use of these protocols.
</p>
<a name="extn-sec"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Location Configuration Extensions</h3>

<p>Location configuration protocols can provision hosts with location URIs that refer to the host's location.  If the target host is to control policy on these URIs, it needs a way to access the policy that the server will use to guide its interactions.  This section defines extensions to LCPs to carry policy URIs that the target can use to control access to location resources.
</p>
<a name="held-extn-sec"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
HELD</h3>

<p>The HELD protocol <a class='info' href='#I-D.ietf-geopriv-http-location-delivery'>[4]<span> (</span><span class='info'>Barnes, M., Winterbottom, J., Thomson, M., and B. Stark, &ldquo;HTTP Enabled Location Delivery (HELD),&rdquo; August&nbsp;2009.</span><span>)</span></a> provides &lt;locationUriSet&gt; elements, which contain a set of one or more location URIs that reference the same resource and share a common access control policy.  The schema in Figure <a class='info' href='#policy-uri-schema'>Figure&nbsp;1</a> defines an extended &lt;locationUriSet&gt; object with a new optional attribute "policy" 
</p><br /><hr class="insert" />
<a name="policy-uri-schema"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;xs:schema
     targetNamespace="urn:ietf:params:xml:ns:geopriv:held:policy"
     xmlns:xs="http://www.w3.org/2001/XMLSchema"
     xmlns:held="urn:ietf:params:xml:ns:geopriv:held"
     xmlns:hp="urn:ietf:params:xml:ns:geopriv:held:policy"
     elementFormDefault="qualified" attributeFormDefault="unqualified"&gt;

  &lt;xs:import namespace="http://www.w3.org/XML/1998/namespace" /&gt;

  &lt;xs:complexType name="returnLocationTypeWithPolicy"&gt;
    &lt;xs:complexContent&gt;
      &lt;xs:restriction base="held:returnLocationType"&gt;
        &lt;xs:attribute name="policy" type="xs:anyURI" use="optional"/&gt;
      &lt;/xs:restriction&gt;
    &lt;/xs:complexContent&gt;
  &lt;/xs:complexType&gt;

  &lt;xs:element name="locationUriSet"
              type="hp:returnLocationTypeWithPolicy"/&gt;

&lt;/xs:schema&gt;

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>The URI carried in a "policy" attribute refers to the common access control policy for the location URIs in the &lt;locationUriSet&gt;.  The URI MUST be a policy URI as described in Section <a class='info' href='#policy-uri-sec'>Section&nbsp;3<span> (</span><span class='info'>Policy URIs</span><span>)</span></a>: It MUST be an HTTP or HTTPS URI, and the server MUST support the specified operations on the URI.
</p>
<a name="dhcp-extn-sec"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
DHCP</h3>

<p>The DHCP location by reference option <a class='info' href='#I-D.ietf-geopriv-dhcp-lbyr-uri-option'>[5]<span> (</span><span class='info'>Polk, J., &ldquo;Dynamic Host Configuration Protocol (DHCP) IPv4 and IPv6 Option for a Location Uniform Resource Identifier (URI),&rdquo; March&nbsp;2010.</span><span>)</span></a> provides location URIs in sub-options called LuriElements.  This document defines a new LuriElement type for policy URIs
</p>
<p>
        </p>
<blockquote class="text"><dl>
<dt>LuriType=X </dt>
<dd>Policy-URI - This is a policy URI that refers to the access control policy for the location URI in the preceding LuriElement.
</dd>
</dl></blockquote><p>
        
</p>
<p>[NOTE TO IANA/RFC-EDITOR: Please replace X above with the assigned LuriType value]
</p>
<p>Each Policy-URI LuriElement MUST immediately follow a sub-option that carries a location URI, for example, a sub-option with LuriType 1.  The URI carried in a Policy-URI LuriElement refers to the access control policy for the location URI in the sub-option that precedes it.  The URI MUST be a policy URI as described in Section <a class='info' href='#policy-uri-sec'>Section&nbsp;3<span> (</span><span class='info'>Policy URIs</span><span>)</span></a>: It MUST be an HTTP or HTTPS URI, and the server MUST support the specified operations on the URI.
</p>
<a name="example-sec"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Examples</h3>

<p>In this section, we provide some brief illustrations of how policy URIs are delivered to target hosts and used by those hosts to manage policy
</p>
<a name="held-example-sec"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
HELD</h3>

<p>A HELD response providing a single &lt;locationUriSet&gt;, containing two URIs under a common policy, would have the following form:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;locationResponse xmlns="urn:ietf:params:xml:ns:geopriv:held"&gt;
  &lt;locationUriSet
      xmlns="urn:ietf:params:xml:ns:geopriv:held:policy"
      expires="2006-01-01T13:00:00.0Z"
      policy="https://ls.example.com:9768/policy/357yc6s64ceyoiuy5ax3o"&gt;
    &lt;locationURI&gt;
      https://ls.example.com:9768/357yc6s64ceyoiuy5ax3o
    &lt;/locationURI&gt;
    &lt;locationURI&gt;
      sip:9769+357yc6s64ceyoiuy5ax3o@ls.example.com:
    &lt;/locationURI&gt;
  &lt;/locationUriSet&gt;
&lt;/locationResponse&gt;
</pre></div>
<a name="dhcp-example-sec"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
DHCP</h3>

<p>A DHCP option providing a single location URI along with a single policy URI would have the following form:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |          option-code          |              111              |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |   1   |   0   |       1       |      49       |     'h'       |
    +---------------+---------------+---------------+---------------|
    |      't'      |      't'      |      'p'      |     's'       |
    +---------------+---------------+---------------+---------------|
    |      ':'      |      '/'      |      '/'      |     'l'       |
    +---------------+---------------+---------------+---------------|
    |      's'      |      '.'      |              ...              |
    +---------------+---------------+---------------+---------------|
    |       3       |      56       |      'h'            't'       |
    +---------------+---------------+---------------+---------------|
    |      't'      |      'p'      |      's'      |     ':'       |
    +---------------+---------------+---------------+---------------|
    |      '/'      |      '/'      |              ...              |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div>
<a name="policy-example-sec"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3"></a><h3>5.3.&nbsp;
Basic access control policy</h3>

<p>Consider a user that gets the policy URI &lt;https://ls.example.com/&gt;, as in the above LCP example.  The first thing this allows the user to do is inspect the default policy that the LS has assigned to this URI:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
GET /policy/357yc6s64ceyoiuy5ax3o HTTP/1.1
Host: ls.example.com:9768


HTTP/1.1 200 OK
Content-type: application/auth-policy+xml
Content-length: 388

&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;ruleset xmlns="urn:ietf:params:xml:ns:common-policy"&gt;
  &lt;rule id="f3g44r1"&gt;
    &lt;conditions&gt;
      &lt;identity&gt;
        &lt;many domain="example.com"&gt;
          &lt;except id="sip:alice@example.com"/&gt;
          &lt;except id="sip:bob@example.com"/&gt;
        &lt;/many&gt;
      &lt;/identity&gt;
    &lt;/conditions&gt;
    &lt;actions/&gt;
    &lt;transformations/&gt;
  &lt;/rule&gt;
&lt;/ruleset&gt;
</pre></div>
<p>This policy allows all users in the domain "example.com" to access the bound location URI, except for users "alice" and "bob".  If the user disagrees with this policy, and prefers for example, to only provide location to one friend, at a city level of granularity, then he can install this policy on the LS:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
PUT /policy/357yc6s64ceyoiuy5ax3o HTTP/1.1
Host: ls.example.com:9768
Content-type: application/auth-policy+xml
Content-length: 462

&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;ruleset xmlns="urn:ietf:params:xml:ns:common-policy"&gt;
  &lt;rule id="f3g44r1"&gt;
    &lt;conditions&gt;
      &lt;identity&gt;
        &lt;one id="sip:friend@example.com"/&gt;
      &lt;/identity&gt;
    &lt;/conditions&gt;
    &lt;actions/&gt;
    &lt;transformations&gt;
      &lt;gp:provide-location
          profile="civic-transformation"&gt;
        &lt;lp:provide-civic&gt;city&lt;/lp:provide-civic&gt;
      &lt;/gp:provide-location&gt;
    &lt;/transformations&gt;
  &lt;/rule&gt;
&lt;/ruleset&gt;


HTTP/1.1 200 OK

</pre></div>
<p>Finally, after using the URI for a period, the user wishes to permanently invalidate the URI.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
DELETE /policy/357yc6s64ceyoiuy5ax3o HTTP/1.1
Host: ls.example.com:9768


HTTP/1.1 200 OK

</pre></div>
<a name="possession-example-sec"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.4"></a><h3>5.4.&nbsp;
The possession model</h3>

<a name="ack-sec"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Acknowledgements</h3>

<p>Thanks to James Winterbottom, Martin Thomson, Hannes Tschofenig, and Mary Barnes for providing critical commentary on the ideas described in this document.  
</p>
<a name="iana-sec"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
IANA Considerations</h3>

<p>This document requires several IANA registrations, detailed below.
</p>
<a name="iana-ns-sec"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.1"></a><h3>7.1.&nbsp;
URN Sub-Namespace Registration for urn:ietf:params:xml:ns:geopriv:held:policy</h3>

<p>This section registers a new XML namespace, "urn:ietf:params:xml:ns:geopriv:held", per the guidelines in <a class='info' href='#RFC3688'>[6]<span> (</span><span class='info'>Mealling, M., &ldquo;The IETF XML Registry,&rdquo; January&nbsp;2004.</span><span>)</span></a>.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      URI: urn:ietf:params:xml:ns:geopriv:held:policy
      Registrant Contact: IETF, GEOPRIV working group,
      (geopriv@ietf.org), Richard Barnes (rbarnes@bbn.com).
      XML:

         BEGIN
           &lt;?xml version="1.0"?&gt;
           &lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
             "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"&gt;
           &lt;html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"&gt;
             &lt;head&gt;
               &lt;title&gt;HELD Policy URI Extension&lt;/title&gt;
             &lt;/head&gt;
             &lt;body&gt;
               &lt;h1&gt;Namespace for HELD Policy URI Extension&lt;/h1&gt;
               &lt;h2&gt;urn:ietf:params:xml:ns:geopriv:held:policy&lt;/h2&gt;
       [NOTE TO IANA/RFC-EDITOR: Please replace XXXX
       with the RFC number for this specification.]
               &lt;p&gt;See RFCXXXX&lt;/p&gt;
             &lt;/body&gt;
           &lt;/html&gt;
         END
</pre></div>
<a name="iana-schema-sec"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.2"></a><h3>7.2.&nbsp;
XML Schema Registration</h3>

<p>This section registers an XML schema as per the guidelines in <a class='info' href='#RFC3688'>[6]<span> (</span><span class='info'>Mealling, M., &ldquo;The IETF XML Registry,&rdquo; January&nbsp;2004.</span><span>)</span></a>.
	</p>
<blockquote class="text"><dl>
<dt>URI:</dt>
<dd> urn:ietf:params:xml:schema:geopriv:held
</dd>
<dt>Registrant Contact:</dt>
<dd> IETF, GEOPRIV working group (geopriv@ietf.org), Richard Barnes (rbarnes@bbn.com)
</dd>
<dt>Schema:</dt>
<dd>The XML for this schema can be found in Section <a class='info' href='#held-extn-sec'>Section&nbsp;4.1<span> (</span><span class='info'>HELD</span><span>)</span></a>.
</dd>
</dl></blockquote><p>
	
</p>
<a name="iana-dhcp-sec"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.3"></a><h3>7.3.&nbsp;
DHCP LuriType Registration</h3>

<p>IANA is requested to add a value to the LuriTypes registry, as follows:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   +------------+----------------------------------------+-----------+
   |  LuriType  |   Name                                 | Reference |
   +------------+----------------------------------------+-----------+
   |     X*     |   Policy-URI                           | RFC XXXX**|
   +------------+----------------------------------------+-----------+

    * X is to be replaced with the assigned value
   ** RFC XXXX is to be replaced with this document's RFC-Editor RFC
      number.
</pre></div>
<a name="sec-cons-sec"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Security Considerations</h3>

<p>There are two main classes of risks associated with access control policy management: The risk of unauthorized disclosure of the protected resource via manipulation of the policy management process, and the risk of disclosure of policy information itself.
</p>
<p>Protecting the policy management process from manipulation entails two primary requirements: First, the policy URI has to be faithfully transmitted to the client, and second, the policy document has to be faithfully transmitted to the location server.  The first requirement is met by the integrity properties of the underlying LCP.  To meet the second requirement, the LCP server SHOULD provide HTTPS policy URIs and the policy server SHOULD support cipher suites that provide integrity protection.
</p>
<p>Authorization policy at the policy server also plays a central role in the protection of both location information and user policy information.  In order to prevent the unauthorized disclosure of location information and policyinformation, the policy server MUST authenticate all requests to policy URIs and verify that the requestor is an authorized Rule Maker for the protected location resource.  In the particular case where the target itself is an authorized Rule Maker and the target is identified to the LS by its IP address, the server MAY use IP return routability as an authentication mechanism.
</p>
<p>Finally, policy information must be protected from observation by unauthorized entities en route between the client and the policy server.  This protection is provided by the use of HTTPS with appropriate cipher suites.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[1]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4745">[2]</a></td>
<td class="author-text">Schulzrinne, H., Tschofenig, H., Morris, J., Cuellar, J., Polk, J., and J. Rosenberg, &ldquo;<a href="http://tools.ietf.org/html/rfc4745">Common Policy: A Document Format for Expressing Privacy Preferences</a>,&rdquo; RFC&nbsp;4745, February&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4745.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-geopriv-policy">[3]</a></td>
<td class="author-text">Schulzrinne, H., Tschofenig, H., Morris, J., Cuellar, J., and J. Polk, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-geopriv-policy-21.txt">Geolocation Policy: A Document Format for Expressing Privacy Preferences for Location Information</a>,&rdquo; draft-ietf-geopriv-policy-21 (work in progress), January&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-geopriv-policy-21.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-geopriv-http-location-delivery">[4]</a></td>
<td class="author-text">Barnes, M., Winterbottom, J., Thomson, M., and B. Stark, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-geopriv-http-location-delivery-16.txt">HTTP Enabled Location Delivery (HELD)</a>,&rdquo; draft-ietf-geopriv-http-location-delivery-16 (work in progress), August&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-geopriv-http-location-delivery-16.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-geopriv-dhcp-lbyr-uri-option">[5]</a></td>
<td class="author-text">Polk, J., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-geopriv-dhcp-lbyr-uri-option-07.txt">Dynamic Host Configuration Protocol (DHCP) IPv4 and IPv6 Option for a Location Uniform Resource Identifier (URI)</a>,&rdquo; draft-ietf-geopriv-dhcp-lbyr-uri-option-07 (work in progress), March&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-geopriv-dhcp-lbyr-uri-option-07.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3688">[6]</a></td>
<td class="author-text">Mealling, M., &ldquo;<a href="http://tools.ietf.org/html/rfc3688">The IETF XML Registry</a>,&rdquo; BCP&nbsp;81, RFC&nbsp;3688, January&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3688.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.ietf-geopriv-l7-lcp-ps">[7]</a></td>
<td class="author-text">Tschofenig, H. and H. Schulzrinne, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-geopriv-l7-lcp-ps-10.txt">GEOPRIV Layer 7 Location Configuration Protocol; Problem Statement and Requirements</a>,&rdquo; draft-ietf-geopriv-l7-lcp-ps-10 (work in progress), July&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-geopriv-l7-lcp-ps-10.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-geopriv-lbyr-requirements">[8]</a></td>
<td class="author-text">Marshall, R., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-geopriv-lbyr-requirements-09.txt">Requirements for a Location-by-Reference Mechanism</a>,&rdquo; draft-ietf-geopriv-lbyr-requirements-09 (work in progress), November&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-geopriv-lbyr-requirements-09.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5606">[9]</a></td>
<td class="author-text">Peterson, J., Hardie, T., and J. Morris, &ldquo;<a href="http://tools.ietf.org/html/rfc5606">Implications of 'retransmission-allowed' for SIP Location Conveyance</a>,&rdquo; RFC&nbsp;5606, August&nbsp;2009 (<a href="http://www.rfc-editor.org/rfc/rfc5606.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-geopriv-rfc3825bis">[10]</a></td>
<td class="author-text">Polk, J., Schnizlein, J., Linsner, M., Thomson, M., and B. Aboba, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-geopriv-rfc3825bis-09.txt">Dynamic Host Configuration Protocol Options for Coordinate-based Location Configuration Information</a>,&rdquo; draft-ietf-geopriv-rfc3825bis-09 (work in progress), March&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-geopriv-rfc3825bis-09.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4119">[11]</a></td>
<td class="author-text">Peterson, J., &ldquo;<a href="http://tools.ietf.org/html/rfc4119">A Presence-based GEOPRIV Location Object Format</a>,&rdquo; RFC&nbsp;4119, December&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4119.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Author's Address</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Richard Barnes</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">BBN Technologies</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">9861 Broken Land Parkway</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Columbia, MD  21046</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 410 290 6169</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:rbarnes@bbn.com">rbarnes@bbn.com</a></td></tr>
</table>
</body></html>
