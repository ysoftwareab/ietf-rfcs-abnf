type="query"
version="3"
xmlns="http://www.hactrn.net/uris/rpki/publication-spec/">
type="reply"
version="3"
xmlns="http://www.hactrn.net/uris/rpki/publication-spec/">
version = "3"

query_elt = publish_query | withdraw_query | list_query
reply_elt = publish_reply | withdraw_reply | list_reply | error_reply

tag = attribute tag { xsd:token { maxLength="1024" } }

base64 = xsd:base64Binary

uri = attribute uri { xsd:anyURI { maxLength="4096" } }

hash = attribute hash { xsd:string { pattern = "[0-9a-fA-F]+" } }

error = xsd:token { maxLength="1024" }

publish_query = element publish { tag?, uri, hash?, base64 }
publish_reply = element publish { tag?, uri }

withdraw_query = element withdraw { tag?, uri, hash }
withdraw_reply = element withdraw { tag?, uri }

list_query = element list { tag? }
list_reply = element list { tag?, uri, hash }

error_reply = element report_error {
     tag?,
     attribute error_code { error },
     xsd:string { maxLength="512000" }?
type="query"
version="3"
xmlns="http://www.hactrn.net/uris/rpki/publication-spec/">
uri="rsync://wombat.example/Alice/blCrcCp9ltyPDNzYKPfxc.cer">
type="query"
version="3"
xmlns="http://www.hactrn.net/uris/rpki/publication-spec/">
hash="deadf00d"
uri="rsync://wombat.example/Alice/blCrcCp9ltyPDNzYKPfxc.cer">
type="reply"
version="3"
xmlns="http://www.hactrn.net/uris/rpki/publication-spec/">
uri="rsync://wombat.example/Alice/blCrcCp9ltyPDNzYKPfxc.cer"/>
type="query"
version="3"
xmlns="http://www.hactrn.net/uris/rpki/publication-spec/">
hash="deadf00d"
uri="rsync://wombat.example/Alice/blCrcCp9ltyPDNzYKPfxc.cer"/>
type="reply"
version="3"
xmlns="http://www.hactrn.net/uris/rpki/publication-spec/">
uri="rsync://wombat.example/Alice/blCrcCp9ltyPDNzYKPfxc.cer"/>
type="reply"
version="3"
xmlns="http://www.hactrn.net/uris/rpki/publication-spec/">
error_code="your_hair_is_on_fire">
type="reply"
version="3"
xmlns="http://www.hactrn.net/uris/rpki/publication-spec/">
error_code="your_hair_is_on_fire"/>
