<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>XTLS: End-to-End Encryption for the Extensible Messaging and Presence Protocol (XMPP) Using Transport Layer Security (TLS)</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="XTLS: End-to-End Encryption for the Extensible Messaging and Presence Protocol (XMPP) Using Transport Layer Security (TLS)">
<meta name="keywords" content="Extensible Messaging and Presence Protocol, XMPP, Jabber, encryption">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">D. Meyer</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Universitaet Bremen TZI</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">P. Saint-Andre</td></tr>
<tr><td class="header">Expires: January 1, 2010</td><td class="header">Cisco</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">June 30, 2009</td></tr>
</table></td></tr></table>
<h1><br />XTLS: End-to-End Encryption for the Extensible Messaging and Presence Protocol (XMPP) Using Transport Layer Security (TLS)<br />draft-meyer-xmpp-e2e-encryption-02</h1>

<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on January 1, 2010.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2009 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents in effect on the date of
publication of this document (http://trustee.ietf.org/license-info).
Please review these documents carefully, as they describe your
rights and restrictions with respect to this document.</p>

<h3>Abstract</h3>

<p>This document specifies "XTLS", a protocol for end-to-end encryption of Extensible Messaging and Presence Protocol (XMPP) traffic.  XTLS is an application-level usage of Transport Layer Security (TLS) that is set up using the XMPP Jingle extension for session negotiation and transported using any streaming transport as the data delivery mechanism.  Thus XTLS treats the end-to-end exchange of XML stanzas as a virtual transport and uses TLS to secure that transport, enabling XMPP entities to communicate in a way that is designed to ensure the confidentiality and integrity XML stanzas.  The protocol can be used for secure end-to-end messaging as well as other XMPP applications, such as file transfer.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#intro">1.</a>&nbsp;
Introduction<br />
<a href="#approach">2.</a>&nbsp;
Approach<br />
<a href="#proto">3.</a>&nbsp;
XTLS Protocol Flow<br />
<a href="#streamproto">4.</a>&nbsp;
End-to-End Streams over XTLS Protocol Flow<br />
<a href="#bootstrapping">5.</a>&nbsp;
Bootstrapping Trust on First Communication<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#exchange">5.1.</a>&nbsp;
Exchanging Certificates<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#bootstrap-bot">5.2.</a>&nbsp;
Verification of Non-Human Parties<br />
<a href="#terminate">6.</a>&nbsp;
Session Termination<br />
<a href="#support">7.</a>&nbsp;
Determining Support<br />
<a href="#security">8.</a>&nbsp;
Security Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#security-mti">8.1.</a>&nbsp;
Mandatory-to-Implement Technologies<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#security-certs">8.2.</a>&nbsp;
Certificates<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#security-dos">8.3.</a>&nbsp;
Denial of Service<br />
<a href="#iana">9.</a>&nbsp;
IANA Considerations<br />
<a href="#rfc.references1">10.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">10.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">10.2.</a>&nbsp;
Informative References<br />
<a href="#schema">Appendix&nbsp;A.</a>&nbsp;
XML Schema<br />
<a href="#copying">Appendix&nbsp;B.</a>&nbsp;
Copying Conditions<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="intro"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>End-to-end encryption of traffic sent over the Extensible Messaging and Presence Protocol (XMPP) is a desirable goal.  Requirements and a threat analysis for XMPP encryption are provided in <a class='info' href='#E2E-REQ'>[E2E&#8209;REQ]<span> (</span><span class='info'>Saint-Andre, P., &ldquo;Requirements for End-to-End Encryption in the Extensible Messaging and Presence Protocol (XMPP),&rdquo; June&nbsp;2009.</span><span>)</span></a>.  This document explores the possibility of using the Transport Layer Security <a class='info' href='#TLS'>[TLS]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a> to meet those requirements.
</p>
<p>TLS is the most widely implemented protocol for securing network traffic.  In addition to applications in the email infrastructure, the World Wide Web <a class='info' href='#HTTP-TLS'>[HTTP&#8209;TLS]<span> (</span><span class='info'>Rescorla, E., &ldquo;HTTP Over TLS,&rdquo; May&nbsp;2000.</span><span>)</span></a>, and datagram transport for multimedia session negotiation <a class='info' href='#DTLS'>[DTLS]<span> (</span><span class='info'>Rescorla, E. and N. Modadugu, &ldquo;Datagram Transport Layer Security,&rdquo; April&nbsp;2006.</span><span>)</span></a>, TLS is used in XMPP to secure TCP connections from client to server and from server to server, as specified in <a class='info' href='#XMPP-CORE'>[XMPP&#8209;CORE]<span> (</span><span class='info'>Saint-Andre, P., &ldquo;Extensible Messaging and Presence Protocol (XMPP): Core,&rdquo; June&nbsp;2009.</span><span>)</span></a>.  Therefore TLS is already familiar to XMPP developers.
</p>
<p>This specification, called "XTLS", defines a method whereby any XMPP entity that supports the XMPP Jingle negotiation framework <a class='info' href='#JINGLE'>[JINGLE]<span> (</span><span class='info'>Ludwig, S., Beda, J., Saint-Andre, P., McQueen, R., Egan, S., and J. Hildebrand, &ldquo;Jingle,&rdquo; June&nbsp;2009.</span><span>)</span></a> can use TLS semantics for end-to-end encryption, whether the application data is sent over a streaming transport (like TCP) or a datagram transport (like UDP).  The basic use case is to tunnel XMPP stanzas between two IM users for end-to-end secure chat using end-to-end XML streams.  However, XTLS is not limited to encryption of one-to-one text chat, since it can be used between two XMPP clients for encryption of any XMPP payloads, between an XMPP client and a remote XMPP service (i.e., a service with which a client does not have a direct XML stream, such as a <a class='info' href='#MUC'>[MUC]<span> (</span><span class='info'>Saint-Andre, P., &ldquo;Multi-User Chat,&rdquo; July&nbsp;2008.</span><span>)</span></a> chatroom), or between two remote XMPP services.  Furthermore, XTLS can be used for encrypted file transfer using <a class='info' href='#JINGLE-FILE'>[JINGLE&#8209;FILE]<span> (</span><span class='info'>Saint-Andre, P., &ldquo;Jingle File Transfer,&rdquo; February&nbsp;2009.</span><span>)</span></a>, for encrypted voice or video sessions using <a class='info' href='#JINGLE-RTP'>[JINGLE&#8209;RTP]<span> (</span><span class='info'>Ludwig, S., Saint-Andre, P., Egan, S., McQueen, R., and D. Cionoiu, &ldquo;Jingle RTP Sessions,&rdquo; June&nbsp;2009.</span><span>)</span></a> and <a class='info' href='#DTLS-SRTP'>[DTLS&#8209;SRTP]<span> (</span><span class='info'>McGrew, D. and E. Rescorla, &ldquo;Datagram Transport Layer Security (DTLS) Extension to Establish Keys for  Secure Real-time Transport Protocol (SRTP),&rdquo; February&nbsp;2009.</span><span>)</span></a>, and other applications.
</p>
<p>Note: The following capitalized keywords are to be interpreted as described in <a class='info' href='#TERMS'>[TERMS]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>: "MUST", "SHALL", "REQUIRED"; "MUST NOT", "SHALL NOT"; "SHOULD", "RECOMMENDED"; "SHOULD NOT", "NOT RECOMMENDED"; "MAY", "OPTIONAL".
</p>
<a name="approach"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Approach</h3>

<p>In broad outline, XTLS takes the following approach to end-to-end encryption of XMPP traffic:
</p>
<p>
        </p>
<ol class="text">
<li>We assume that all XMPP entities will have X.509 certificates; realistically these certificates are likely to be self-signed and automatically generated by an XMPP client, however certificates issued by known certification authorities are encouraged to overcome problems with self-signed certificates.
</li>
<li>We use the XMPP Jingle extensions as the negotiation framework (see <a class='info' href='#JINGLE'>[JINGLE]<span> (</span><span class='info'>Ludwig, S., Beda, J., Saint-Andre, P., McQueen, R., Egan, S., and J. Hildebrand, &ldquo;Jingle,&rdquo; June&nbsp;2009.</span><span>)</span></a>).
</li>
<li>We use the concept of Jingle security preconditions to ensure that the negotiated transport will be encrypted before used for sending application data.
</li>
<li>When an entity wishes to encrypt its communications with a second entity, it sends a Jingle session-initiate request that specifies the desired application type, a possible transport, and a TLS security precondition that includes the sender's X.509 fingerprint and optionally hints about the sender's supported TLS methods.
</li>
<li>If both parties support XTLS, the first data sent over the negotiated transport is TLS handshake data, not application data.  Once the TLS handshake has finished, the parties can then send application data over the now-encrypted transport (called an "XTLS tunnel").
</li>
<li>The simplest scenario is end-to-end encryption of traditional XMPP text chat using end-to-end XML streams as the application and in-band bytestreams <a class='info' href='#IBB'>[IBB]<span> (</span><span class='info'>Karneges, J., &ldquo;In-Band Bytestreams (IBB),&rdquo; March&nbsp;2009.</span><span>)</span></a> as the transport.
</li>
<li>If the parties have previously negotiated an XTLS tunnel, during the TLS negotiation each party simply needs to verify that the other party is presenting the same certificate as used in previous sessions.
</li>
<li>If the parties have not previously negotiated an XTLS tunnel, they need to bootstrap trust in their certificates; to do so, it is encouraged to use secure remote passwords rather than leap-of-faith.
</li>
</ol><p>
      
</p>
<p>We expand on this approach in the following section.
</p>
<p>More complex scenarios are theoretically supported (e.g., encrypted file transfer using SOCKS5 bytestreams and encrypted voice chat using DTLS-SRTP) but have not yet been fully defined.
</p>
<p>XTLS theoretically can be used to establish a TLS-encrypted streaming transport or a DTLS-encrypted datagram transport, but integration with DTLS <a class='info' href='#DTLS'>[DTLS]<span> (</span><span class='info'>Rescorla, E. and N. Modadugu, &ldquo;Datagram Transport Layer Security,&rdquo; April&nbsp;2006.</span><span>)</span></a> has not yet been prototyped so use with streaming transports is the more stable scenario.
</p>
<a name="proto"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
XTLS Protocol Flow</h3>

<p>The basic flow for an XTLS session is as follows, where traffic represented by single dashes (---) is sent over the XMPP signalling channel and traffic represented by double lines (===) is sent over the negotiated transport.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
Initiator                   Responder
  |                            |
  |  session-initiate          |
  |  (with security info)      |
  |---------------------------&gt;|
  |  ack                       |
  |&lt;---------------------------|
  |  session-accept            |
  |&lt;---------------------------|
  |  ack                       |
  |---------------------------&gt;|
  |  open transport            |
  |&lt;==========================&gt;|
  |  TLS ClientHello           |
  |===========================&gt;|
  |  TLS ServerHello, [...]    |
  |&lt;===========================|
  |  TLS [...], Finished       |
  |===========================&gt;|
  |  TLS [...], Finished       |
  |&lt;===========================|
  |  application data          |
  |&lt;==========================&gt;|
  |  session-terminate         |
  |&lt;---------------------------|
  |  ack                       |
  |---------------------------&gt;|
  |                            |
</pre></div>
<p>To simplify the description we assume here that the parties already trust each other's certificates.  See discussion under <a class='info' href='#bootstrapping'>Section&nbsp;5<span> (</span><span class='info'>Bootstrapping Trust on First Communication</span><span>)</span></a> for information about bootstrapping of certificate trust when the parties first negotiate the use of an XTLS tunnel.
</p>
<p>First the initiator sends a Jingle session-initiate request (here the simple case of an end-to-end text chat session using in-band bytestreams <a class='info' href='#IBB'>[IBB]<span> (</span><span class='info'>Karneges, J., &ldquo;In-Band Bytestreams (IBB),&rdquo; March&nbsp;2009.</span><span>)</span></a>).  This request includes a &lt;security/&gt; element that contains the fingerprint of the certificate that the initiator will use during the TLS negotiation and a list of TLS methods the initiator supports (here certificate-based authentication <a class='info' href='#X509'>[X509]<span> (</span><span class='info'>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; May&nbsp;2008.</span><span>)</span></a> and TLS with Secure Remote Passwords <a class='info' href='#TLS-SRP'>[TLS&#8209;SRP]<span> (</span><span class='info'>Taylor, D., Wu, T., Mavrogiannopoulos, N., and T. Perrin, &ldquo;Using the Secure Remote Password (SRP) Protocol for TLS Authentication,&rdquo; November&nbsp;2007.</span><span>)</span></a>).  Note that this information is exchanged over the insecure server-based connection.  The purpose of the exchange is to gather information about which TLS method should be used in the TLS handshake, e.g. if a client cannot verify the fingerprint of the peer it MAY omit the X.509 method.  If both clients can verify the fingerprint of the other, it is likely that X.509 certificate-based authentication will succeed (unless the data is altered); if one client cannot verify the fingerprint the client MAY prompt the user for a password for TLS-SRP based authentication (see <a class='info' href='#bootstrapping'>Section&nbsp;5<span> (</span><span class='info'>Bootstrapping Trust on First Communication</span><span>)</span></a> for details).
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;iq from='romeo@montague.lit/orchard'
    id='xn28s7gk'
    to='juliet@capulet.lit/balcony'
    type='set'&gt;
  &lt;jingle xmlns='urn:xmpp:jingle:1'&gt;
          action='session-initiate'
          initiator='romeo@montague.lit/orchard'
          sid='a73sjjvkla37jfea'&gt;
    &lt;content creator='initiator' name='xmlstream'&gt;
      &lt;description xmlns='urn:xmpp:jingle:apps:xmlstream:0'/&gt;
      &lt;transport xmlns='urn:xmpp:jingle:transports:ibb:0'
                 block-size='4096'
                 sid='ch3d9s71'/&gt;
      &lt;security xmlns='urn:xmpp:jingle:security:xtls:0'&gt;
        &lt;fingerprint algo='sha1'&gt;RomeoX509CertSHA1Hash&lt;/fingerprint&gt;
        &lt;method name='x509'/&gt;
        &lt;method name='srp'/&gt;
      &lt;/security&gt;
    &lt;/content&gt;
  &lt;/jingle&gt;
&lt;/iq&gt;
</pre></div>
<p>The responder immediately acknowledges receipt of the session-initiate by sending an IQ stanza of type "result" (not shown here).
</p>
<p>Depending on the application type, a user agent controlled by a human user might need to wait for the user to affirm a desire to proceed with the session before continuing.  When the user agent has received such affirmation (or if the user agent can automatically proceed for any reason, e.g.  because no human intervention is expected or because a human user has configured the user agent to automatically accept sessions with a given entity), it returns a Jingle session-accept message.  This message will typically contain the offered application type, transport method, and a &lt;security/&gt; element that includes the fingerprint of the responder's X.509 certificate as well as the responder's supported TLS methods.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;iq from='juliet@capulet.com/balcony'
    id='hf64hl'
    to='romeo@montague.net/orchard'
    type='set'&gt;
  &lt;jingle xmlns='urn:xmpp:jingle:1'&gt;
          action='session-accept'
          initiator='romeo@montague.lit/orchard'
          sid='a73sjjvkla37jfea'&gt;
    &lt;content creator='initiator' name='xmlstream'&gt;
      &lt;description xmlns='urn:xmpp:jingle:apps:xmlstream:0'/&gt;
      &lt;transport xmlns='urn:xmpp:jingle:transports:ibb:0'
                 block-size='4096'
                 sid='ch3d9s71'/&gt;
      &lt;security xmlns='urn:xmpp:jingle:security:xtls:0'/&gt;
        &lt;fingerprint algo='sha1'&gt;JulietX509CertSHA1Hash&lt;/fingerprint&gt;
        &lt;method name='x509'/&gt;
        &lt;method name='srp'/&gt;
      &lt;/security&gt;
    &lt;/content&gt;
  &lt;/jingle&gt;
&lt;/iq&gt;
</pre></div>
<p>The following rules apply to the responder's handling of the session-initiate message:
</p>
<p>
        </p>
<ol class="text">
<li>If the responder does not support XTLS it will silently ignore the &lt;security/&gt; element in the offer and therefore will return a session-accept message without a &lt;security/&gt; element.
</li>
<li>If the responder supports XTLS it MUST return a session-accept message that contains a &lt;security/&gt; element.
</li>
<li>If the responder thinks it will be able to verify the initiator's certificate, it MUST include the fingerprint for the responder's certificate in the &lt;security/&gt; element of the session-accept message.  This is the "happy path" and will occur when the parties have already verified each other's certificates.
</li>
<li>If the responder thinks it will not be able to verify the initiator's certificate, it MAY omit the fingerprint for the responder's certificate in the &lt;security/&gt; element of the session-accept message.  This indicates that certificate-based authentication is not possible.  In this case the responder SHOULD signal that it wishes to use some other authentication method, such as secure remote passwords (see discussion under <a class='info' href='#bootstrapping'>Section&nbsp;5<span> (</span><span class='info'>Bootstrapping Trust on First Communication</span><span>)</span></a>).
</li>
<li>If the responding client cannot verify the initiator's certificate, it SHOULD ask the responding user if a password was exchanged between the parties that can be used for TLS-SRP.  If this is not the case, setting up a mutually-authenticated link will fail and the responder MAY terminate the session.  Alternatively it could send its own fingerprint knowing it cannot authenticate the initiator, in which case the responder has to trust that there is no man-in-the-middle (see discussion under <a class='info' href='#bootstrapping'>Section&nbsp;5<span> (</span><span class='info'>Bootstrapping Trust on First Communication</span><span>)</span></a>).
</li>
</ol><p>
      
</p>
<p>When the responder sends the session-accept message, the initiator acknowledges receipt by sending an IQ stanza of type "result" (not shown here).
</p>
<p>The following rules apply to the initiator's handling of the session-accept message:
</p>
<p>
        </p>
<ol class="text">
<li>If the initiator receives a session-accept without a &lt;security/&gt; element, setting up a secure transport layer has failed.  The initiator MAY terminate the session at this point or instead proceed without securing the transport.  The client SHOULD ask the initiating user how to processed.  This depends on the Jingle application and the initiator's preferences: it makes no sense to use end-to-end XML streams without encryption, but the initiator might continue a file transfer without encryption.
</li>
<li>If the initiating client cannot verify the responder's certificate it SHOULD ask the initiating user if a password was exchanged between the parties that can be used for TLS-SRP.  If this is not the case, setting up a mutually-authenticated link will fail and the responder MAY terminate the session or proceed with leap-of-faith (see discussion under <a class='info' href='#bootstrapping'>Section&nbsp;5<span> (</span><span class='info'>Bootstrapping Trust on First Communication</span><span>)</span></a>).
</li>
</ol><p>
      
</p>
<p>The initiator can now determine if X.509 certificate-based authentication will work or if TLS-SRP will be used.  It sends an additional security-info message to the responder to signal its choice.  This step is not really necessary because the responder will see the initiator's choice in the first message of the TLS handshake, but it can assist an implementation in setting up its TLS library properly.  Because in this section we assume that the parties already have validated each other's certificates, the security method signalled here is "x509".
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;iq from='romeo@montague.lit/orchard'
    id='hf749j'
    to='juliet@capulet.lit/balcony'
    type='set'&gt;
  &lt;jingle xmlns='urn:xmpp:jingle:1'&gt;
          action='security-info'
          initiator='romeo@montague.lit/orchard'
          sid='a73sjjvkla37jfea'&gt;
    &lt;content creator='initiator' name='xmlstream'&gt;
      &lt;security xmlns='urn:xmpp:jingle:security:xtls:0'&gt;
        &lt;method name='x509'/&gt;
      &lt;/security&gt;
    &lt;/content&gt;
  &lt;/jingle&gt;
&lt;/iq&gt;
</pre></div>
<p>The responder acknowledges receipt by sending an IQ stanza of type "result" (not shown here).
</p>
<p>Parallel to the security-info exchange, the clients negotiate a transport for the Jingle session (here the transport is an in-band bytestream as defined in <a class='info' href='#IBB'>[IBB]<span> (</span><span class='info'>Karneges, J., &ldquo;In-Band Bytestreams (IBB),&rdquo; March&nbsp;2009.</span><span>)</span></a>, for which the Jingle negotiation process is specified in <a class='info' href='#XEP-0261'>[XEP&#8209;0261]<span> (</span><span class='info'>Saint-Andre, P., &ldquo;Jingle In-Band Bytestreams Transport,&rdquo; February&nbsp;2009.</span><span>)</span></a>; however other transports could be used, for example SOCKS5 bytestreams as defined in <a class='info' href='#XEP-0065'>[XEP&#8209;0065]<span> (</span><span class='info'>Smith, D., Miller, M., and P. Saint-Andre, &ldquo;SOCKS5 Bytestreams,&rdquo; May&nbsp;2007.</span><span>)</span></a> and negotiated for Jingle as specified in <a class='info' href='#XEP-0260'>[XEP&#8209;0260]<span> (</span><span class='info'>Saint-Andre, P. and D. Meyer, &ldquo;Jingle SOCKS5 Bytestreams Transport Method,&rdquo; February&nbsp;2009.</span><span>)</span></a>).  Because the parties wish to establish end-to-end encryption, they do not send application data over the transport until the transport has been secured.  Therefore the first data that they exchange over the transport consists of the standard four-way TLS handshake, encoded in accordance with the negotiated transport method.
</p>
<p></p>
<blockquote class="text">
<p>Note: Each transport MUST define a specific time when both clients know that the transport is secured.  When XTLS is not used, the Jingle implementation would signal to the using application that the transport is open when the session-accept is sent or received, or when connectivity checks determine media can flow over one of the transport candidates.  When XTLS is used, the Jingle implementation starts a TLS handshake on the transport and signals to the using application that the transport is open only after the TLS handshake has finished successfully.
</p>
</blockquote>

<p>During the TLS handshake, the responder MUST take the role of the TLS server and the initiator MUST take the role of the TLS client.  Because the transport is an in-band bytestream, the TLS handshake data is prepared as described in <a class='info' href='#IBB'>[IBB]<span> (</span><span class='info'>Karneges, J., &ldquo;In-Band Bytestreams (IBB),&rdquo; March&nbsp;2009.</span><span>)</span></a> (i.e., Base64-encoded).  First the initiator (acting as the TLS client) constructs a TLS ClientHello, encodes it according to IBB, and sends it to the responder.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;iq from='romeo@montague.net/orchard'
    id='vh38s618'
    to='juliet@capulet.com/balcony'
    type='set'&gt;
  &lt;data xmlns='http://jabber.org/protocol/ibb'
        seq='0'
        sid='vj3hs98y'&gt;
    Base64-encoded-TLS-data
  &lt;/data&gt;
&lt;/iq&gt;
</pre></div>
<p>The responder (acting as the TLS server) then acknowledges receipt by sending an IQ stanza of type "result" (not shown here).
</p>
<p>The responder then constructs an appropriate TLS message or messages, such as a ServerHello and a CertificateRequest.
</p>
<p></p>
<blockquote class="text">
<p>Note: The responder MUST send a CertificateRequest to the initiator.
</p>
</blockquote>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;iq from='juliet@capulet.com/balcony'
    id='xyw516d0'
    from='romeo@montague.net/orchard'
    type='set'&gt;
  &lt;data xmlns='http://jabber.org/protocol/ibb'
        seq='0'
        sid='vj3hs98y'&gt;
    Base64-encoded-TLS-data
  &lt;/data&gt;
&lt;/iq&gt;
</pre></div>
<p>(Because in-band bytestreams are bidirectional and this data is sent from the responder to the initiator, the IBB 'seq' attribute has a value of zero, not 1.)
</p>
<p>The initiator then acknowledges receipt by sending an IQ stanza of type "result" (not shown here).
</p>
<p>After some number of TLS messages, the initiator eventually sends a TLS Finished message to the responder.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;iq from='romeo@montague.net/orchard'
    id='s91vd527'
    to='juliet@capulet.com/balcony'
    type='set'&gt;
  &lt;data xmlns='http://jabber.org/protocol/ibb'
        seq='3'
        sid='vj3hs98y'&gt;
    Base64-encoded-TLS-data
  &lt;/data&gt;
&lt;/iq&gt;
</pre></div>
<p>The responder then acknowledges receipt by sending an IQ stanza of type "result" (not shown here).
</p>
<p>The responder then also sends a TLS Finished message.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;iq from='juliet@capulet.com/balcony'
    id='z71gs73t'
    from='romeo@montague.net/orchard'
    type='set'&gt;
  &lt;data xmlns='http://jabber.org/protocol/ibb'
        seq='3'
        sid='vj3hs98y'&gt;
    Base64-encoded-TLS-data
  &lt;/data&gt;
&lt;/iq&gt;
</pre></div>
<p>The initiator then acknowledges receipt by sending an IQ stanza of type "result" (not shown here).
</p>
<p>If the TLS negotiation has finished successfully, then the Jingle implementation shall signal to the using application that the transport has been secured and is ready to be used.  The parties now have a secure channel for the end-to-end exchange of application data using XMPP as the virtual transport; we call such a channel an XTLS TUNNEL.
</p>
<a name="streamproto"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
End-to-End Streams over XTLS Protocol Flow</h3>

<p>For end-to-end encryption of XMPP stanzas (&lt;message/&gt;, &lt;presence/&gt;, and &lt;iq/&gt;), the application data is an end-to-end XML stream.  After the XTLS tunnel is established, the peers open an XML stream over the tunnel to exchange stanzas.  In this example, the tunnel is established using a transport of IBB, but any streaming transport could be used.
</p>
<p>First the initiator constructs an initial stream header.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;stream:stream
        xmlns='jabber:client'
        xmlns:stream='http://etherx.jabber.org/streams'
        from='romeo@montague.lit/orchard'
        to='juliet@capulet.lit/balcony'
        version='1.0'&gt;
</pre></div>
<p>Note: In accordance with <a class='info' href='#XMPP-CORE'>[XMPP&#8209;CORE]<span> (</span><span class='info'>Saint-Andre, P., &ldquo;Extensible Messaging and Presence Protocol (XMPP): Core,&rdquo; June&nbsp;2009.</span><span>)</span></a>, the initial stream header SHOULD include the 'to' and 'from' attributes, which SHOULD specify the full JIDs of the clients. The initiator SHOULD include the version='1.0' flag as shown in the previous example.
</p>
<p>The initiator then transforms the stream header into TLS data, encodes the data into IBB, and sends an IQ-set to the responder.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;iq from='romeo@montague.net/orchard'
    id='ur73n153'
    to='juliet@capulet.com/balcony'
    type='set'&gt;
  &lt;data xmlns='http://jabber.org/protocol/ibb'
        seq='4'
        sid='vj3hs98y'&gt;
    Base64-TLS-data-of-the-stream-header
  &lt;/data&gt;
&lt;/iq&gt;
</pre></div>
<p>The responder then acknowledges receipt by sending an IQ stanza of type "result" (not shown here).
</p>
<p>The responder then constructs a response stream header back to the initiator.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;stream:stream
        xmlns='jabber:client'
        xmlns:stream='http://etherx.jabber.org/streams'
        from='juliet@capulet.lit/balcony'
        id='hs91gh1836d8s717'
        to='romeo@montague.lit/orchard'
        version='1.0'&gt;
</pre></div>
<p>The responder then sends the response stream header over the XTLS tunnel.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;iq from='juliet@capulet.com/balcony'
    id='pd61g397'
    to='romeo@montague.net/orchard'
    type='set'&gt;
  &lt;data xmlns='http://jabber.org/protocol/ibb'
        seq='4'
        sid='vj3hs98y'&gt;
    Base64-TLS-data-of-the-responce-stream-header
  &lt;/data&gt;
&lt;/iq&gt;
</pre></div>
<p>The initiator then acknowledges receipt by sending an IQ stanza of type "result" (not shown here).
</p>
<p>Once the XML stream is established over the XTLS tunnel, either entity then can send XMPP message, presence, and IQ stanzas, with or without 'to' and 'from' addresses.
</p>
<p>For example, the initiator could construct an XMPP message.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;message from='romeo@montague.lit/orchard'
         to='juliet@capulet.lit/balcony'&gt;
  &lt;body&gt;
    M&amp;apos;lady, I would be pleased to make your acquaintance.
  &lt;/body&gt;
&lt;/message&gt;
</pre></div>
<p>The initiator then sends the message over the XTLS tunnel.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;iq from='romeo@montague.net/orchard'
    id='iq7dh294'
    to='juliet@capulet.com/balcony'
    type='set'&gt;
  &lt;data xmlns='http://jabber.org/protocol/ibb'
        seq='5'
        sid='vj3hs98y'&gt;
    Base64-TLS-data
  &lt;/data&gt;
&lt;/iq&gt;
</pre></div>
<p>The responder then acknowledges receipt by sending an IQ stanza of type "result" (not shown here).
</p>
<p>The responder could then construct a reply.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;message from='juliet@capulet.lit/balcony'
         to='romeo@montague.lit/orchard'&gt;
  &lt;body&gt;Art thou not Romeo, and a Montague?&lt;/body&gt;
&lt;/message&gt;
</pre></div>
<p>The responder then sends the reply over the XTLS tunnel.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;iq from='juliet@capulet.com/balcony'
    id='hr91hd63'
    to='romeo@montague.net/orchard'
    type='set'&gt;
  &lt;data xmlns='http://jabber.org/protocol/ibb'
        seq='5'
        sid='vj3hs98y'&gt;
    Base64-TLS-data
  &lt;/data&gt;
&lt;/iq&gt;
</pre></div>
<p>The initiator then acknowledges receipt by sending an IQ stanza of type "result" (not shown here).
</p>
<p>To close the end-to-end XML stream, either party (here the responder) constructs a closing &lt;/stream:stream&gt; element.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;/stream:stream&gt;
</pre></div>
<p>The client sends the closing element to the peer over the XTLS tunnel.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;iq from='juliet@capulet.com/balcony'
    id='kr91n475'
    to='romeo@montague.net/orchard'
    type='set'&gt;
  &lt;data xmlns='http://jabber.org/protocol/ibb'
        seq='6'
        sid='vj3hs98y'&gt;
    Base64-TLS-data
  &lt;/data&gt;
&lt;/iq&gt;
</pre></div>
<p>The peer then acknowledges receipt by sending an IQ stanza of type "result" (not shown here).
</p>
<p>However, even after the end-to-end XML stream is terminated, the negotiated Jingle transport (here an in-band bytestream) continues and could be re-used. To completely terminate the Jingle session, the terminating party would then also send a Jingle session-terminate message.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;iq from='juliet@capulet.lit/balcony'
    id='psy617r4'
    to='romeo@montague.lit/orchard'
    type='set'&gt;
  &lt;jingle xmlns='urn:xmpp:jingle:1'
          action='session-terminate'
          initiator='romeo@montague.lit/orchard'
          sid='851ba2'/&gt;
&lt;/iq&gt;
</pre></div>
<p>The other party then acknowledges the Jingle session-terminate by sending an IQ stanza of type "result" (not shown here).
</p>
<a name="bootstrapping"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Bootstrapping Trust on First Communication</h3>

<p>When two parties first attempt to use XTLS, their certificates might not be accepted (e.g., because they are self-signed or issued by unknown certification authorities).  Therefore each party needs to accept the other's certificate for use in future communication sessions.  There are several ways to do so:
</p>
<p>
        </p>
<ul class="text">
<li>Leap of faith.  The recipient can hope that there is no man-in-the-middle during the first communication session.  If the certificate does not change in future sessions, the recipient at least knows that it is talking with the same entity it talked with during the first session.  However, that entity might be a man-in-the-middle rather than the assumed communication partner.  Therefore, leap of faith is discouraged.
</li>
<li>Check fingerprints.  The parties could validate the certificate fingerprints via some trusted means outside the XMPP band, such as in person, via encrypted email, or over the phone.  This is not user-friendly because certificate fingerprints consist of long strings of letters and numbers.  As a result, few humans routinely check certificate fingerprints in protocols such as Secure Shell (ssh).
</li>
<li>One-time password.  The parties can exchange a user-friendly password known only to themselves and verify it out of band before the TLS handshake finishes.  For this purpose, it is REQUIRED for implementations to support at least one TLS cipher that uses Secure Remote Password (SRP) as defined in <a class='info' href='#TLS-SRP'>[TLS&#8209;SRP]<span> (</span><span class='info'>Taylor, D., Wu, T., Mavrogiannopoulos, N., and T. Perrin, &ldquo;Using the Secure Remote Password (SRP) Protocol for TLS Authentication,&rdquo; November&nbsp;2007.</span><span>)</span></a>.
</li>
<li>Channel binding.  It is possible that a future version of this specification will describe how to use an appropriate Simple Authentication and Security Layer (SASL) mechanism, such as <a class='info' href='#SCRAM'>[SCRAM]<span> (</span><span class='info'>Menon-Sen, A., Melnikov, A., Newman, C., and N. Williams, &ldquo;Salted Challenge Response (SCRAM) SASL Mechanism,&rdquo; May&nbsp;2009.</span><span>)</span></a>, to authenticate the XTLS tunnel after the TLS handshake finishes; such a method would use the concept of channel bindings as described in <a class='info' href='#RFC5056'>[RFC5056]<span> (</span><span class='info'>Williams, N., &ldquo;On the Use of Channel Bindings to Secure Channels,&rdquo; November&nbsp;2007.</span><span>)</span></a>.
</li>
</ul><p>
      
</p>
<p>If the parties use a password or SASL channel binding to bootstrap trust, the process needs to be completed only once.  After the clients have authenticated with the shared secret, they can exchange their certificates for future communication.
</p>
<a name="exchange"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Exchanging Certificates</h3>

<p>To retrieve the certificate of the peer for future communications, a client SHOULD request the certificate according to <a class='info' href='#XEP-0189'>[XEP&#8209;0189]<span> (</span><span class='info'>Paterson, I., Saint-Andre, P., and D. Meyer, &ldquo;Public Key Publishing,&rdquo; March&nbsp;2009.</span><span>)</span></a> over the secure connection.  This works only if XTLS was used to set up an end-to-end secure XML stream; exchanging certificates if XTLS was used for other purposes like file transfer is not possible.  A client MUST NOT request the certificate over the insecure stream-based on the connection to the XMPP server.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;iq from='romeo@montague.lit/orchard'
    id='hf7634k4'
    to='juliet@capulet.lit/balcony'
    type='get'&gt;
  &lt;pubkeys xmlns='urn:xmpp:pubkey:0'/&gt;
&lt;/iq&gt;
</pre></div>
<p>The peer MUST return its own client certificate.  If the user has different clients with different client certificates and one user certificate, the user certificate SHOULD also be returned.  The user certificate allows it to verify other client certificates using public key retrieval as described in <a class='info' href='#XEP-0189'>[XEP&#8209;0189]<span> (</span><span class='info'>Paterson, I., Saint-Andre, P., and D. Meyer, &ldquo;Public Key Publishing,&rdquo; March&nbsp;2009.</span><span>)</span></a>.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;iq from='juliet@capulet.com/balcony'
    id='hf7634k4'
    to='romeo@montague.lit/orchard'
    type='result'&gt;
  &lt;pubkeys xmlns='urn:xmpp:pubkey:0'&gt;
    &lt;keyinfo&gt;
      &lt;x509cert&gt;
MIICCTCCAXKgAwIBAgIJALhU0Id6xxwQMA0GCSqGSIb3DQEBBQUAMA4xDDAKBgNV
BAMTA2ZvbzAeFw0wNzEyMjgyMDA1MTRaFw0wODEyMjcyMDA1MTRaMA4xDDAKBgNV
BAMTA2ZvbzCBnzANBgkqhkiG9w0BAQEFAAOBjQAwgYkCgYEA0DPcfeJzKWLGE22p
RMINLKr+CxqozF14DqkXkLUwGzTqYRi49yK6aebZ9ssFspTTjqa2uNpw1U32748t
qU6bpACWHbcC+eZ/hm5KymXBhL3Vjfb/dW0xrtxjI9JRFgrgWAyxndlNZUpN2s3D
hKDfVgpPSx/Zp8d/ubbARxqZZZkCAwEAAaNvMG0wHQYDVR0OBBYEFJWwFqmSRGcx
YXmQfdF+XBWkeML4MD4GA1UdIwQ3MDWAFJWwFqmSRGcxYXmQfdF+XBWkeML4oRKk
EDAOMQwwCgYDVQQDEwNmb2+CCQC4VNCHesccEDAMBgNVHRMEBTADAQH/MA0GCSqG
SIb3DQEBBQUAA4GBAIhlUeGZ0d0msNVxYWAXg2lRsJt9INHJQTCJMmoUeTtaRjyp
ffJtuopguNNBDn+MjrEp2/+zLNMahDYLXaTVmBf6zvY0hzB9Ih0kNTh23Fb5j+yK
QChPXQUo0EGCaODWhfhKRNdseUozfNWOz9iTgMGw8eYNLllQRL//iAOfOr/8
      &lt;/x509cert&gt;
    &lt;/keyinfo&gt;
  &lt;/pubkeys&gt;
&lt;/iq&gt;
</pre></div>
<a name="bootstrap-bot"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Verification of Non-Human Parties</h3>

<p>If one of the parties is a "bot" (e.g., an automated service or a device such as a set-top box), the password exchange is a bit more complicated.  It is similar to Bluetooth peering if the user has access to both clients at the same time.  One of the following scenarios might apply:
</p>
<p>
          </p>
<ul class="text">
<li>The bot can be controlled via a remote control input device.  The human user can enter the same password or "PIN" on both the bot and the XMPP client.
</li>
<li>If the bot has no user input but does have a small display, it could display a random password.  The human user can then enter the provided password on the XMPP client.
</li>
<li>The bot might not have enough buttons for input and might not have an output screen.  In that case the password is fixed.  Similar to Bluetooth peering with simple devices such as a headset, the password will be written in the manual or printed on the device.  For security reasons the device SHOULD NOT use password-based authentication without any user input.  Many Bluetooth devices have at least one button to set the device into peering mode.
</li>
<li>A bot may be associated with a web service and could display a random password when the user has logged in to the web site using HTTPS.  This assumes that an attacker cannot at the same time both control over the web server and perform a man-in-the-middle attack on the XMPP channel.  If the web service knows the GPG key of the user it could send an encrypted email.
</li>
</ul><p>
        
</p>
<p>A user might have different X.509 certificates for each device.  <a class='info' href='#XEP-0189'>[XEP&#8209;0189]<span> (</span><span class='info'>Paterson, I., Saint-Andre, P., and D. Meyer, &ldquo;Public Key Publishing,&rdquo; March&nbsp;2009.</span><span>)</span></a> can be used to manage the user's certificates.  A client SHOULD check the peer's PubSub node for certificates.  This makes it possible to use the password method only once between two users even if one or both users switch clients.  A user can also communicate with a friend's bots:  they first open a secure link between two chat clients with a password and exchange the user certificates.  After that each device of a user can verify all devices of the other without the need of a password.
</p>
<p>The retrieved certificate from the PubSub node might be signed by a certification authority that the client can verify.  In that case the client MAY skip the password authentication and rely on the X.509 certificate chain.  The client SHOULD ask the user if the certificate is acceptable or if a password exchange is desired.
</p>
<a name="terminate"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Session Termination</h3>

<p>If either client cannot verify the certificate of the peer or receives an invalid message on the TLS layer, it MUST terminate the Jingle session immediately by sending a Jingle session-terminate message that includes a Jingle reason of &lt;security-error/&gt;.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;iq from='romeo@montague.lit/orchard'
    id='hz81vf48'
    to='juliet@capulet.lit/balcony'
    type='set'&gt;
  &lt;jingle xmlns='urn:xmpp:jingle:1'
          action='session-terminate'
          initiator='romeo@montague.lit/orchard'
          sid='a73sjjvkla37jfea'&gt;
    &lt;reason&gt;&lt;security-error/&gt;&lt;/reason&gt;
  &lt;/jingle&gt;
&lt;/iq&gt;
</pre></div>
<p>The other party then acknowledges the session-terminate by sending an IQ stanza of type "result" (not shown here), and the Jingle session is finished.
</p>
<a name="support"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Determining Support</h3>

<p>If an entity wishes to request the use of XTLS, it SHOULD first determine whether the intended responder supports the protocol.  This can be done directly via <a class='info' href='#XEP-0030'>[XEP&#8209;0030]<span> (</span><span class='info'>Hildebrand, J., Millard, P., Eatmon, R., and P. Saint-Andre, &ldquo;Service Discovery,&rdquo; June&nbsp;2008.</span><span>)</span></a> or indirectly via <a class='info' href='#XEP-0115'>[XEP&#8209;0115]<span> (</span><span class='info'>Hildebrand, J., Saint-Andre, P., Tron&#xE7;on, R., and J. Konieczny, &ldquo;Entity Capabilities,&rdquo; February&nbsp;2008.</span><span>)</span></a>.
</p>
<p>If an entity supports XTLS, it MUST report that by including a service discovery feature of "urn:xmpp:jingle:security:xtls:1" in response to disco#info requests.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;iq from='romeo@montague.lit/orchard'
    id='disco1'
    to='juliet@capulet.lit/chamber'
    type='get'&gt;
  &lt;query xmlns='http://jabber.org/protocol/disco#info'/&gt;
&lt;/iq&gt;
</pre></div><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;iq from='juliet@capulet.lit/chamber'
    id='disco1'
    to='romeo@montague.lit/orchard'
    type='result'&gt;
  &lt;query xmlns='http://jabber.org/protocol/disco#info'&gt;
    &lt;feature var='urn:xmpp:jingle:security:xtls:1'/&gt;
    &lt;feature var='urn:xmpp:jingle:apps:xmlstream:1'/&gt;
  &lt;/query&gt;
&lt;/iq&gt;
</pre></div>
<p>Both service discovery and entity capabilities information could be corrupted or intercepted; for details, see under <a class='info' href='#security-dos'>Section&nbsp;8.3<span> (</span><span class='info'>Denial of Service</span><span>)</span></a>.
</p>
<a name="security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Security Considerations</h3>

<p>This entire document addresses security.  Particular security-related issues are discussed in the following sections.
</p>
<a name="security-mti"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.1"></a><h3>8.1.&nbsp;
Mandatory-to-Implement Technologies</h3>

<p>An implementation MUST at a minimum support the "srp" and "x509" methods.  A future version of this specification will document mandatory-to-implement TLS ciphers.
</p>
<a name="security-certs"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.2"></a><h3>8.2.&nbsp;
Certificates</h3>

<p>As noted, XTLS can be used between XMPP clients, between an XMPP client and a remote XMPP service (i.e., a service with which a client does not have a direct XML stream), or between remote XMPP services.  Therefore, a party to an XTLS bytestream will present either a client certificate or a server certificate as appropriate.  Such certificates MUST be generated and validated in accordance with the certificate guidelines guidelines provided in <a class='info' href='#XMPP-CORE'>[XMPP&#8209;CORE]<span> (</span><span class='info'>Saint-Andre, P., &ldquo;Extensible Messaging and Presence Protocol (XMPP): Core,&rdquo; June&nbsp;2009.</span><span>)</span></a>.
</p>
<p>A future version of this specification might provide additional guidelines regarding certificate validation in the context of client-to-client encryption.
</p>
<a name="security-dos"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.3"></a><h3>8.3.&nbsp;
Denial of Service</h3>

<p>Currently XMPP stanzas such as Jingle negotiation messages and service discovery exchanges are not encrypted or signed. As a result, it is possible for an attacker to intercept these stanzas and modify them, thus convincing one party that the other party does not support XTLS and therefore denying the parties an opportunity to use XTLS.
</p>
<p>This is a more general problem with XMPP technologies and needs to be addressed at the core XMPP layer.
</p>
<a name="iana"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
IANA Considerations</h3>

<p>It might be helpful to create a registry of TLS methods that can be used in the context of XTLS (e.g., "openpgp" for use of <a class='info' href='#RFC5081'>[RFC5081]<span> (</span><span class='info'>Mavrogiannopoulos, N., &ldquo;Using OpenPGP Keys for Transport Layer Security (TLS) Authentication,&rdquo; November&nbsp;2007.</span><span>)</span></a>, "srp" for use of <a class='info' href='#TLS-SRP'>[TLS&#8209;SRP]<span> (</span><span class='info'>Taylor, D., Wu, T., Mavrogiannopoulos, N., and T. Perrin, &ldquo;Using the Secure Remote Password (SRP) Protocol for TLS Authentication,&rdquo; November&nbsp;2007.</span><span>)</span></a>, and "x509" for use of <a class='info' href='#TLS'>[TLS]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a> with certificates). The registry could be maintained by the IANA or by the XMPP Registrar (see <a class='info' href='#XEP-0053'>[XEP&#8209;0053]<span> (</span><span class='info'>Saint-Andre, P., &ldquo;XMPP Registrar Function,&rdquo; October&nbsp;2008.</span><span>)</span></a>). A future version of this specification will provide more detailed information about the registration requirements.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>10.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="E2E-REQ">[E2E-REQ]</a></td>
<td class="author-text">Saint-Andre, P., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-saintandre-xmpp-e2e-requirements-01.txt">Requirements for End-to-End Encryption in the Extensible Messaging and Presence Protocol (XMPP)</a>,&rdquo; draft-saintandre-xmpp-e2e-requirements-01 (work in progress), June&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-saintandre-xmpp-e2e-requirements-01.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="TERMS">[TERMS]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="ftp://ftp.isi.edu/in-notes/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="TLS">[TLS]</a></td>
<td class="author-text">Dierks, T. and E. Rescorla, &ldquo;<a href="http://tools.ietf.org/html/rfc5246">The Transport Layer Security (TLS) Protocol Version 1.2</a>,&rdquo; RFC&nbsp;5246, August&nbsp;2008 (<a href="ftp://ftp.isi.edu/in-notes/rfc5246.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="IBB">[IBB]</a></td>
<td class="author-text"><a href="mailto:justin@affinix.com">Karneges, J.</a>, &ldquo;<a href="http://www.xmpp.org/extensions/xep-0047.html">In-Band Bytestreams (IBB)</a>,&rdquo; XSF XEP&nbsp;0047, March&nbsp;2009.</td></tr>
<tr><td class="author-text" valign="top"><a name="JINGLE">[JINGLE]</a></td>
<td class="author-text"><a href="mailto:scottlu@google.com">Ludwig, S.</a>, <a href="mailto:jbeda@google.com">Beda, J.</a>, <a href="mailto:">Saint-Andre, P.</a>, <a href="mailto:robert.mcqueen@collabora.co.uk">McQueen, R.</a>, <a href="mailto:seanegan@google.com">Egan, S.</a>, and <a href="mailto:jhildebrand@jabber.com">J. Hildebrand</a>, &ldquo;<a href="http://www.xmpp.org/extensions/xep-0166.html">Jingle</a>,&rdquo; XSF XEP&nbsp;0166, June&nbsp;2009.</td></tr>
<tr><td class="author-text" valign="top"><a name="XMPP-CORE">[XMPP-CORE]</a></td>
<td class="author-text">Saint-Andre, P., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-xmpp-3920bis-00.txt">Extensible Messaging and Presence Protocol (XMPP): Core</a>,&rdquo; draft-ietf-xmpp-3920bis-00 (work in progress), June&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-xmpp-3920bis-00.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>10.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="DTLS">[DTLS]</a></td>
<td class="author-text">Rescorla, E. and N. Modadugu, &ldquo;<a href="http://tools.ietf.org/html/rfc4347">Datagram Transport Layer Security</a>,&rdquo; RFC&nbsp;4347, April&nbsp;2006 (<a href="ftp://ftp.isi.edu/in-notes/rfc4347.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="DTLS-SRTP">[DTLS-SRTP]</a></td>
<td class="author-text">McGrew, D. and E. Rescorla, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-avt-dtls-srtp-07.txt">Datagram Transport Layer Security (DTLS) Extension to Establish Keys for  Secure Real-time Transport Protocol (SRTP)</a>,&rdquo; draft-ietf-avt-dtls-srtp-07 (work in progress), February&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-avt-dtls-srtp-07.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="HTTP-TLS">[HTTP-TLS]</a></td>
<td class="author-text">Rescorla, E., &ldquo;<a href="http://tools.ietf.org/html/rfc2818">HTTP Over TLS</a>,&rdquo; RFC&nbsp;2818, May&nbsp;2000 (<a href="ftp://ftp.isi.edu/in-notes/rfc2818.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="JINGLE-FILE">[JINGLE-FILE]</a></td>
<td class="author-text"><a href="mailto:">Saint-Andre, P.</a>, &ldquo;<a href="http://www.xmpp.org/extensions/xep-0234.html">Jingle File Transfer</a>,&rdquo; XSF XEP&nbsp;0234, February&nbsp;2009.</td></tr>
<tr><td class="author-text" valign="top"><a name="JINGLE-RTP">[JINGLE-RTP]</a></td>
<td class="author-text"><a href="mailto:scottlu@google.com">Ludwig, S.</a>, <a href="mailto:">Saint-Andre, P.</a>, <a href="mailto:seanegan@google.com">Egan, S.</a>, <a href="mailto:robert.mcqueen@collabora.co.uk">McQueen, R.</a>, and <a href="mailto:diana@null.ro">D. Cionoiu</a>, &ldquo;<a href="http://www.xmpp.org/extensions/xep-0167.html">Jingle RTP Sessions</a>,&rdquo; XSF XEP&nbsp;0167, June&nbsp;2009.</td></tr>
<tr><td class="author-text" valign="top"><a name="MUC">[MUC]</a></td>
<td class="author-text"><a href="mailto:">Saint-Andre, P.</a>, &ldquo;<a href="http://www.xmpp.org/extensions/xep-0045.html">Multi-User Chat</a>,&rdquo; XSF XEP&nbsp;0045, July&nbsp;2008.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5056">[RFC5056]</a></td>
<td class="author-text">Williams, N., &ldquo;<a href="http://tools.ietf.org/html/rfc5056">On the Use of Channel Bindings to Secure Channels</a>,&rdquo; RFC&nbsp;5056, November&nbsp;2007 (<a href="ftp://ftp.isi.edu/in-notes/rfc5056.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5081">[RFC5081]</a></td>
<td class="author-text">Mavrogiannopoulos, N., &ldquo;<a href="http://tools.ietf.org/html/rfc5081">Using OpenPGP Keys for Transport Layer Security (TLS) Authentication</a>,&rdquo; RFC&nbsp;5081, November&nbsp;2007 (<a href="ftp://ftp.isi.edu/in-notes/rfc5081.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="TLS-SRP">[TLS-SRP]</a></td>
<td class="author-text">Taylor, D., Wu, T., Mavrogiannopoulos, N., and T. Perrin, &ldquo;<a href="http://tools.ietf.org/html/rfc5054">Using the Secure Remote Password (SRP) Protocol for TLS Authentication</a>,&rdquo; RFC&nbsp;5054, November&nbsp;2007 (<a href="ftp://ftp.isi.edu/in-notes/rfc5054.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="SCRAM">[SCRAM]</a></td>
<td class="author-text">Menon-Sen, A., Melnikov, A., Newman, C., and N. Williams, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-newman-auth-scram-13.txt">Salted Challenge Response (SCRAM) SASL Mechanism</a>,&rdquo; draft-newman-auth-scram-13 (work in progress), May&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-newman-auth-scram-13.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="X509">[X509]</a></td>
<td class="author-text">Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;<a href="http://tools.ietf.org/html/rfc5280">Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>,&rdquo; RFC&nbsp;5280, May&nbsp;2008 (<a href="ftp://ftp.isi.edu/in-notes/rfc5280.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="XEP-0030">[XEP-0030]</a></td>
<td class="author-text"><a href="mailto:jhildebrand@jabber.com">Hildebrand, J.</a>, <a href="mailto:">Millard, P.</a>, <a href="mailto:reatmon@jabber.org">Eatmon, R.</a>, and <a href="mailto:">P. Saint-Andre</a>, &ldquo;<a href="http://www.xmpp.org/extensions/xep-0030.html">Service Discovery</a>,&rdquo; XSF XEP&nbsp;0030, June&nbsp;2008.</td></tr>
<tr><td class="author-text" valign="top"><a name="XEP-0053">[XEP-0053]</a></td>
<td class="author-text"><a href="mailto:">Saint-Andre, P.</a>, &ldquo;<a href="http://www.xmpp.org/extensions/xep-0053.html">XMPP Registrar Function</a>,&rdquo; XSF XEP&nbsp;0053, October&nbsp;2008.</td></tr>
<tr><td class="author-text" valign="top"><a name="XEP-0065">[XEP-0065]</a></td>
<td class="author-text"><a href="mailto:dizzyd@jabber.org">Smith, D.</a>, <a href="mailto:linuxwolf@outer-planes.net">Miller, M.</a>, and <a href="mailto:">P. Saint-Andre</a>, &ldquo;<a href="http://www.xmpp.org/extensions/xep-0065.html">SOCKS5 Bytestreams</a>,&rdquo; XSF XEP&nbsp;0065, May&nbsp;2007.</td></tr>
<tr><td class="author-text" valign="top"><a name="XEP-0115">[XEP-0115]</a></td>
<td class="author-text"><a href="mailto:jhildebrand@jabber.com">Hildebrand, J.</a>, <a href="mailto:">Saint-Andre, P.</a>, <a href="mailto:">Tron&#xE7;on, R.</a>, and <a href="mailto:jajcus@jajcus.net">J. Konieczny</a>, &ldquo;<a href="http://www.xmpp.org/extensions/xep-0115.html">Entity Capabilities</a>,&rdquo; XSF XEP&nbsp;0115, February&nbsp;2008.</td></tr>
<tr><td class="author-text" valign="top"><a name="XEP-0189">[XEP-0189]</a></td>
<td class="author-text"><a href="mailto:ian.paterson@clientside.co.uk">Paterson, I.</a>, <a href="mailto:">Saint-Andre, P.</a>, and <a href="mailto:dmeyer@tzi.de">D. Meyer</a>, &ldquo;<a href="http://www.xmpp.org/extensions/xep-0189.html">Public Key Publishing</a>,&rdquo; XSF XEP&nbsp;0189, March&nbsp;2009.</td></tr>
<tr><td class="author-text" valign="top"><a name="XEP-0260">[XEP-0260]</a></td>
<td class="author-text"><a href="mailto:">Saint-Andre, P.</a> and <a href="mailto:dmeyer@tzi.de">D. Meyer</a>, &ldquo;<a href="http://www.xmpp.org/extensions/xep-0260.html">Jingle SOCKS5 Bytestreams Transport Method</a>,&rdquo; XSF XEP&nbsp;0260, February&nbsp;2009.</td></tr>
<tr><td class="author-text" valign="top"><a name="XEP-0261">[XEP-0261]</a></td>
<td class="author-text"><a href="mailto:">Saint-Andre, P.</a>, &ldquo;<a href="http://www.xmpp.org/extensions/xep-0261.html">Jingle In-Band Bytestreams Transport</a>,&rdquo; XSF XEP&nbsp;0261, February&nbsp;2009.</td></tr>
</table>

<a name="schema"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
XML Schema</h3>

<p>The XML schema will be provided in a later version of this document.
</p>
<a name="copying"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B"></a><h3>Appendix B.&nbsp;
Copying Conditions</h3>

<p>Regarding this entire document or any portion of it, the authors make no guarantees and are not responsible for any damage resulting from its use.  The authors grant irrevocable permission to anyone to use, modify, and distribute it in any way that does not diminish the rights of anyone else to use, modify, and distribute it, provided that redistributed derivative works do not contain misleading author or version information.  Derivative works need not be licensed under similar terms.
</p>
<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Dirk Meyer</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Universitaet Bremen TZI</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:dmeyer@tzi.de">dmeyer@tzi.de</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Peter Saint-Andre</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:psaintan@cisco.com">psaintan@cisco.com</a></td></tr>
</table>
</body></html>
