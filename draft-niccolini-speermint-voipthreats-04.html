<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>SPEERMINT Security Threats and Suggested Countermeasures</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="SPEERMINT Security Threats and Suggested Countermeasures">
<meta name="keywords" content="RFC, Request for Comments, I-D, Internet-Draft, VoIP, Security, Threats">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">SPEERMINT Working Group</td><td class="header">S. Niccolini</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">NEC</td></tr>
<tr><td class="header">Intended status: Informational</td><td class="header">E. Chen</td></tr>
<tr><td class="header">Expires: January 15, 2009</td><td class="header">NTT</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">J. Seedorf</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">NEC</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">July 14, 2008</td></tr>
</table></td></tr></table>
<h1><br />SPEERMINT Security Threats and Suggested Countermeasures<br />draft-niccolini-speermint-voipthreats-04</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on January 15, 2009.</p>

<h3>Abstract</h3>

<p>This memo presents the different security threats related to SPEERMINT classifying
         them into threats to the Location Function, to the Signaling Function and to the Media
         Function. The different instances of the threats are briefly introduced inside the
         classification. Finally the existing security solutions in SIP and RTP/RTCP are presented
         to describe the countermeasures currently available for such threats. The objective of
         this document is to identify and enumerate the SPEERMINT-specific threat vectors in
         order to specify security-related requirements. Once the requirements are identified,
         methods and solutions how to achieve such requirements can be selected.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#intro">1.</a>&nbsp;
Introduction<br />
<a href="#taxonomy">2.</a>&nbsp;
Security Threats relevant to SPEERMINT<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#lookup">2.1.</a>&nbsp;
Threats Relevant to the Look-Up Function (LUF)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#lufConf">2.1.1.</a>&nbsp;
Threats to LUF Confidentiality<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#lufInt">2.1.2.</a>&nbsp;
Threats to LUF Integrity<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#lufAva">2.1.3.</a>&nbsp;
Threats to LUF Availability<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#location">2.2.</a>&nbsp;
Threats Relevant to the Location Function (LF)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#locConf">2.2.1.</a>&nbsp;
Threats to LF Confidentiality<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#locInt">2.2.2.</a>&nbsp;
Threats to LF Integrity<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#locAvl">2.2.3.</a>&nbsp;
Threats to LF Availability<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#signaling">2.3.</a>&nbsp;
Threats to the Signaling Function (SF)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sfConf">2.3.1.</a>&nbsp;
Threats to SF Confidentiality<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sfInt">2.3.2.</a>&nbsp;
Threats to SF Integrity<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sfAvl">2.3.3.</a>&nbsp;
Threats to SF Availability<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#media">2.4.</a>&nbsp;
Threats to the Media Function (MF)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#mfConf">2.4.1.</a>&nbsp;
Threats to MF Confidentiality<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#mfInt">2.4.2.</a>&nbsp;
Threats to MF Integrity<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#mfAvl">2.4.3.</a>&nbsp;
Threats to MF Availability<br />
<a href="#requirements">3.</a>&nbsp;
Suggested Countermeasures<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">3.1.</a>&nbsp;
Security Requirements<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">3.2.</a>&nbsp;
Database Security<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">3.3.</a>&nbsp;
DNSSEC<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">3.4.</a>&nbsp;
DNS Replication<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">3.5.</a>&nbsp;
Cross-Domain Privacy Protection<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">3.6.</a>&nbsp;
Digest Authentication on all requests in peering agreements<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">3.7.</a>&nbsp;
Use TCP instead of UDP to deliver SIP messages<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">3.8.</a>&nbsp;
Ingress Filtering / Reverse-Path Filtering<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">3.9.</a>&nbsp;
Strong Identity Assertion<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">3.10.</a>&nbsp;
Reliable Border Element Pooling<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">3.11.</a>&nbsp;
Rate limit<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">3.12.</a>&nbsp;
Border Element Hardening<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor16">3.13.</a>&nbsp;
SRTCP<br />
<a href="#mapping">4.</a>&nbsp;
Mapping suggested countermeasures to threats<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor17">4.1.</a>&nbsp;
Current Deployment of Countermeasures<br />
<a href="#conclusions">5.</a>&nbsp;
Conclusions<br />
<a href="#security">6.</a>&nbsp;
Security Considerations<br />
<a href="#ack">7.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">8.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="intro"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p> With VoIP, the need for security is compounded because there is the need to protect
         both the control plane and the data plane. In a legacy telephone system, security is a
         more valid assumption. Intercepting conversations requires either physical access to
         telephone lines or to compromise the Public Switched Telephone Network (PSTN) nodes or
         the office Private Branch eXchanges (PBXs). Only particularly security-sensitive
         organizations bother to encrypt voice traffic over traditional telephone lines. In
         contrast, the risk of sending unencrypted data across the Internet is more significant
         (e.g. DTMF tones corresponding to the credit card number). An additional security threat
         to Internet Telephony comes from the fact that the signaling is sent using the same
         network as the multimedia data; traditional telephone systems have the signaling network
         separated from the data network. This is an increased security threat since a hacker
         could attack the signaling network and its servers with increased damage potential (call
         hijacking, call drop, DoS attacks, etc.). Therefore there is the need of investigating
         the different security threats, to extract security-related requirements and to highlight
         the solutions how to protect from such threats.
</p>
<a name="taxonomy"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Security Threats relevant to SPEERMINT</h3>

<p>This section enumerates potential security threats relevant to SPEERMINT. A
         taxonomy of VoIP security threats is defined in <a class='info' href='#refs.voipsataxonomy'>[refs.voipsataxonomy]<span> (</span><span class='info'>Zar, J. and et al, &ldquo;VOIPSA VoIP Security and Privacy Threat Taxonomy,&rdquo; October&nbsp;2005.</span><span>)</span></a>.
         Such a taxonomy is really comprehensive and takes into account also non-VoIP-specific
         threats (e.g. loss of power, etc.). Threats relevant to the boundaries of layer-5 SIP
         networks are extracted from such a taxonomy and mapped to the classification relevant
         for the SPEERMINT architecture as defined in <a class='info' href='#refs.speermintarch'>[refs.speermintarch]<span> (</span><span class='info'>Penno, R., Malas, D., Khan, S., and A. Uzelac, &ldquo;SPEERMINT Peering Architecture,&rdquo; August&nbsp;2007.</span><span>)</span></a>,
         moreover additional threats for the SPEERMINT architecture are listed and detailed
         under the same classification and according the CIA (Confidentiality, Integrity and
         Availability) triad:
            </p>
<ul class="text">
<li> Look-Up Function (LUF);
</li>
<li> Location Function (LF);
</li>
<li> Signaling Function (SF);
</li>
<li> Media Function (MF).
</li>
</ul><p>
         
</p>
<a name="lookup"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
Threats Relevant to the Look-Up Function (LUF)</h3>

<p>This is one of the latest additions of the terminology draft
            <a class='info' href='#I-D.ietf-speermint-terminology'>[I&#8209;D.ietf&#8209;speermint&#8209;terminology]<span> (</span><span class='info'>Malas, D. and D. Meyer, &ldquo;SPEERMINT Terminology,&rdquo; November&nbsp;2008.</span><span>)</span></a>. LUF is vulenrable to the same
            threats that affect database systems in general.
</p>
<a name="lufConf"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1.1"></a><h3>2.1.1.&nbsp;
Threats to LUF Confidentiality</h3>

<p> 
                  </p>
<ul class="text">
<li> SIP URIs and peering domains harvesting - an attacker can exploit 
                     this weakness if the underlying database has a weak authentication
                     system, and then use the gained knowledge to launch other kind of
                     attacks.
</li>
</ul><p>
               
</p>
<a name="lufInt"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1.2"></a><h3>2.1.2.&nbsp;
Threats to LUF Integrity</h3>

<p> The underlying database could be vulnerable to: 
                  </p>
<ul class="text">
<li> Injection attack - an attacker could manipulate statements
                     performed on the database by the end user.
</li>
</ul><p>
               
</p>
<a name="lufAva"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1.3"></a><h3>2.1.3.&nbsp;
Threats to LUF Availability</h3>

<p> The underlying database could be vulnerable to:
                  </p>
<ul class="text">
<li> Denial of Service attacks - e.g. an attacker makes incomplete requests
                     causing the server to create an idle state for each of them causing memory
                     to be exhausted.
</li>
</ul><p>
               
</p>
<a name="location"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
Threats Relevant to the Location Function (LF)</h3>

<a name="locConf"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2.1"></a><h3>2.2.1.&nbsp;
Threats to LF Confidentiality</h3>

<p> 
                  </p>
<ul class="text">
<li> URI harvesting - the attacker harvests URIs and IP addresses of the existing 
                     User Endpoints (UEs) by issuing a multitude of location requests. Direct intrusion
                     against vulnerable UEs or telemarketing are possible attack scenarios that would use
                     the gained knowledge.
                     
</li>
<li> SIP device enumeration  - the attacker discovers the IP address of each intermediate
                     signaling device by looking at the Via and Record-Route headers of a SIP message. Targeting
                     the discovered devices with subsequent attacks is a possible attack scenario.
                     
</li>
</ul><p>
               
</p>
<a name="locInt"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2.2"></a><h3>2.2.2.&nbsp;
Threats to LF Integrity</h3>

<p>  Bogus information can be accepted by LF if specific flaws are exploited (e.g. if the
               LF involves a Location Server, LS, that does not correctly validate routing data such as NAPTR records,
               then the LS may develop incorrect Session Establishment Data, SED). Dynamic call routing discovery and
               establishment, as in scope of SPEERMINT, introduces new opportunities for such an attack. In the following 
               two example variants of such an attack are listed.
                  </p>
<ul class="text">
<li> Man-in-the-Middle attack - the attacker has already or inserts an unauthorized node
                     in the signaling path modifying the SED. The results is that the attacker is then able
                     to read, insert and modify the multimedia communications.
</li>
<li> Incorrect destinations - the attacker redirect the calls to a incorrect destination with the
                     purpose of establishing fraud communications like voice phishing or DoS attacks.
</li>
</ul><p>
               
</p>
<a name="locAvl"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2.3"></a><h3>2.2.3.&nbsp;
Threats to LF Availability</h3>

<p> The LF can be object of DoS attacks. DoS attacks to the LF can be carried out by sending a large
               number of queries to the LS or Session Manager, SM, with the result of preventing an originating SSP
               from looking up call routing data of any URI outside its administrative domain. As an alternative
               the attacker could target the DNS to disable resolution of SIP addresses.
</p>
<a name="signaling"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3"></a><h3>2.3.&nbsp;
Threats to the Signaling Function (SF)</h3>

<p> Signaling function involves a great number of sensitive information. Through signaling
            function, user agents (UA) assert identities and VSP operators authorize billable
            resources. Correct and trusted operations of signaling function is essential for
            service providers. This section discusses potential security threats to the signaling
            function to detail the possible attack vectors.
</p>
<a name="sfConf"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3.1"></a><h3>2.3.1.&nbsp;
Threats to SF Confidentiality</h3>

<p>SF traffic is vulnerable to eavesdropping, in particular when the data is moved across
               multiple SSPs having different levels of security policies. Threats for the SF confidentiality
               are listed here:
                  </p>
<ul class="text">
<li>call pattern analysis - the attacker tracks the call patterns of the users
                     violating his/her privacy (e.g. revealing the social network of various users, the
                     daily phone usage, etc.), also rival SSPs may infer information about the customer
                     base of other SSPs in this way;
</li>
<li>Password cracking - challenge-response authentication mechanism of SIP is not secure
                     if the attacker is able to eavesdrop a sufficient number of SIP authentication messages
                     exchanged between a SIP server and a SIP client.
</li>
</ul><p>
               
</p>
<a name="sfInt"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3.2"></a><h3>2.3.2.&nbsp;
Threats to SF Integrity</h3>

<p>The integrity of the SF can be violated using SIP request spoofing, SIP reply spoofing
               and SIP message tampering.
</p>
<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3.2.1"></a><h3>2.3.2.1.&nbsp;
SIP Request Spoofing</h3>

<p>Most SIP request spoofing require first a SIP message eavesdropping but some of the 
                 them could be also performed by guessing or exploiting broken implementations. Threats
                 in this category are:
                   </p>
<blockquote class="text">
<p>session tear down - the attacker uses CANCEL/BYE messages in order to tear
                     down an existing call at SIP layer, it is needed that the attacker replicates
                     the proper SIP header for the hijacking to be successful (To, From, Call-ID,
                     CSeq);
</p>
<p>REGISTER spoofing - the attacker forges a REGISTER request and register a bogus
                     contact information with the objective of hijacking incoming calls.
</p>
<p>Billing fraud - the same attack as in the case of the REGISTEr spoofing may lead
                     an attacker to be able to direct billing for calls to the victim UE and avoid
                     paying for the phone calls;
</p>
<p>user ID spoofing - SSPs are responsible for asserting the legitimacy of user ID;
                     if an SSP fails to achieve the level of identity assertion that the federation it
                     belongs expects, it may create an entry point for attackers to conduct user ID spoofing
                     attacks.
</p>
</blockquote><p>
                 
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3.2.2"></a><h3>2.3.2.2.&nbsp;
SIP Reply Spoofing</h3>

<p>Threats in this category are:
                   </p>
<blockquote class="text">
<p>Forget 200 Response - the attacker sends a forged CANCEL request to terminate a 
                     call in progress tricking the terminating UE to believe that the originating UE
                     actually sent it, and successfully hijacks a call sending a forged 200 OK message to
                     the originating UE communicating the address of the rogue UE under the attacker's
                     control;
</p>
<p>Forget 302 Response - the attacker sends a forged "302 Moved Temporarily" reply
                     instead of a 200 OK, this enables the attack to hijack the call and to redirect it
                     to any destination UE of his choosing;
</p>
<p>Forget 404 Response - the attacker sends a forged "404 Not Found" reply
                     instead of a 200 OK, this enables the attack to disrupt the call establishment;
</p>
</blockquote><p>
                 
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3.2.3"></a><h3>2.3.2.3.&nbsp;
SIP Message Tampering</h3>

<p>This threat involves the alternation of important field values in a SIP message or in the SDP
                 body. Examples of this threat could be the dropping or modification of handshake packets
                 in order to avoid the establishment of a secure RTP session (SRTP). The same approach could be
                 used to degrade the quality of media session by letting UE negotiate a poor quality codec.
</p>
<a name="sfAvl"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3.3"></a><h3>2.3.3.&nbsp;
Threats to SF Availability</h3>

<p> 
                  </p>
<ul class="text">
<li>Flooding attack - a SBE is susceptible to message flooding attack that may come from
                     interconnected SSPs;
</li>
<li>Session Black Holing - the attacker (assumed to be able to make Man-in-the-Middle attacks)
                     intentionally drops essential packets, e.g. INVITEs, to prevent certain calls from being
                     established;
</li>
<li>SIP Fuzzing attack - fuzzing tests and software can be used by attackersto discover and 
                     exploit vulnerabilities of a SIP entity, this attack may result in crashing SIP entity.
</li>
</ul><p>
               
</p>
<a name="media"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.4"></a><h3>2.4.&nbsp;
Threats to the Media Function (MF)</h3>

<p> The Media function (MF) is responsible for the actual delivery of multimedia comunication
            between the users and carries sensitive information. Through media function, UE
            can establish secure communications and monitor quality of conversations.
            Correct and trusted operations of MF is essential for privacy and service
            assurance issues. This section discusses potential security threats to the MF
            to detail the possible attack vectors.
</p>
<a name="mfConf"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.4.1"></a><h3>2.4.1.&nbsp;
Threats to MF Confidentiality</h3>

<p>The MF is vulnerable to eavesdropping in which the attacker may reconstruct the
               voice conversation or sensitive information (e.g. PIN numbers from DTMF tones).
               SRTP and ZRTP are vulnerable to bid-down attacks, i.e. by selectively dropping
               key exchange protocol packets may result in the establishment of a non-secure
               communications.
</p>
<a name="mfInt"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.4.2"></a><h3>2.4.2.&nbsp;
Threats to MF Integrity</h3>

<p>Both RTP and RTCP are vulnerable to integrity violation in many ways:
                  </p>
<ul class="text">
<li>Media Hijack - if an attacker can somehow detect an ongoing media session and
                    eavesdrop a few RTP packets, he can start sending bogus RTP packets to one of the
                    UEs involved using the same codec. As illustrated in Fig. 8, if the bogus RTP
                    packets have consistently greater timestamps and sequence numbers (but within the
                    acceptable range) than the legitimate RTP packets, the recipient UE may accept the
                    bogus RTP packets and discard the legitimate ones.
</li>
<li>Media Session Tear Down - the attacker sends bogus RTCP BYE messages to a target
                    UE signaling to tear down the media communication, please note tha tRTCP messages
                    are normally not authenticated.
</li>
<li>QoS degradation - the attacker sends wrong RTCP reports advertising more packet
                    loss or more jitter than actually experimented resulting in the usage of a poor
                    quality codec degrading the overall quality of the call experience.
</li>
</ul><p>
               
</p>
<a name="mfAvl"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.4.3"></a><h3>2.4.3.&nbsp;
Threats to MF Availability</h3>

<p> 
                  </p>
<ul class="text">
<li>Malformed messages - the attacker tries to cause a crash or a
                     reboot of the DBE/UE by sending RTP/RTCP malformed messages;
</li>
<li>Messages flooding - the attacker tries to exhaust the resources of
                     the DBE/UE by sending many RTP/RTCP messages.
</li>
</ul><p>
               
</p>
<a name="requirements"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Suggested Countermeasures</h3>

<p>This section describes implementer-specific countermeasures against the threats described in the previous section to supplement the security requirements described in
         <a class='info' href='#I-D.ietf-speermint-requirements'>[I&#8209;D.ietf&#8209;speermint&#8209;requirements]<span> (</span><span class='info'>Mule, J., &ldquo;SPEERMINT Requirements for SIP-based Session Peering,&rdquo; October&nbsp;2009.</span><span>)</span></a>. These countermeasures are described in this section and then mapped to threats in the following section, indicating which countermeasure is recommended to be used in order to solve which threat.
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Security Requirements</h3>

<p>The security requirements for SPEERMINT have been moved from an earlier version of this draft to the requirements draft for speermint <a class='info' href='#I-D.ietf-speermint-requirements'>[I&#8209;D.ietf&#8209;speermint&#8209;requirements]<span> (</span><span class='info'>Mule, J., &ldquo;SPEERMINT Requirements for SIP-based Session Peering,&rdquo; October&nbsp;2009.</span><span>)</span></a>. These security requirements are the following <a class='info' href='#I-D.ietf-speermint-requirements'>[I&#8209;D.ietf&#8209;speermint&#8209;requirements]<span> (</span><span class='info'>Mule, J., &ldquo;SPEERMINT Requirements for SIP-based Session Peering,&rdquo; October&nbsp;2009.</span><span>)</span></a>:
           </p>
<ul class="text">
<li> The protocols used for the LUF and LRF must allow the look-up and SED
   					data to be exchanged securely (authentication and encryption services
   					should be provided).
</li>
<li>One or more Certificate Authorities (CAs) should be agreed
      				between SSPs for securing session peering exchanges.
      				Alternatively, self-signed certificates may also be used.
</li>
<li> It is recommended that the establishment of media security be
      				provided along the media path and not over the signaling path
      				given the indirect peering use cases.
</li>
</ul><p>
           
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Database Security</h3>

<p>Adequate security measures must be applied to the LUF to prevent it from being target of attacks
           since it involves the use of common database systems. Common security Best Current Practises (BCPs) for database systems include
           replication to prevent any database from being a single point of failure, and the use of parameterized
           statements to prevent SQL injections. <a class='info' href='#refs.dbsec'>[refs.dbsec]<span> (</span><span class='info'>Gertz, M. and S. Jajodia, &ldquo;Handbook of Database Security,&rdquo; .</span><span>)</span></a> is one of many existing literatures
           that describe BCPs in this area.
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
DNSSEC</h3>

<p>In the case DNS is used by the LF, it is recommended to deploy the recent version of Domain Name System
           Security Extensions (informally called "DNSSEC-bis") defined by <a class='info' href='#RFC4033'>[RFC4033]<span> (</span><span class='info'>Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose, &ldquo;DNS Security Introduction and Requirements,&rdquo; March&nbsp;2005.</span><span>)</span></a> <a class='info' href='#RFC4034'>[RFC4034]<span> (</span><span class='info'>Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose, &ldquo;Resource Records for the DNS Security Extensions,&rdquo; March&nbsp;2005.</span><span>)</span></a>
           <a class='info' href='#RFC4035'>[RFC4035]<span> (</span><span class='info'>Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose, &ldquo;Protocol Modifications for the DNS Security Extensions,&rdquo; March&nbsp;2005.</span><span>)</span></a>,
           to permit authentication and data integrity checking of DNS data. DNSSEC adds
           new records to the DNS data which permit the validation of data in the DNS using strong cryptography.
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4"></a><h3>3.4.&nbsp;
DNS Replication</h3>

<p>DNS replication is a very important countermeasure to mitigate availability threats. Attacking multiple DNS servers
           simultaneously with the purpose of bringing them all them is much more challenging than attacking a sole
           DNS server (single point of failure).
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.5"></a><h3>3.5.&nbsp;
Cross-Domain Privacy Protection</h3>

<p>Stripping Via and Record-Route headers, replacing the Contact header, and even changing Call-IDs are
           the mechanisms described in <a class='info' href='#RFC3323'>[RFC3323]<span> (</span><span class='info'>Peterson, J., &ldquo;A Privacy Mechanism for the Session Initiation Protocol (SIP),&rdquo; November&nbsp;2002.</span><span>)</span></a> to protect SIP privacy. This practice allows an SSP
           to hide its SIP network topology, prevents intermediate signaling equipment from becoming the target of
           DoS attacks, as well as protects the privacy of UEs according to their preferences.
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.6"></a><h3>3.6.&nbsp;
Digest Authentication on all requests in peering agreements</h3>

<p>In today's current practice, Digest authentication <a class='info' href='#RFC2617'>[RFC2617]<span> (</span><span class='info'>Franks, J., Hallam-Baker, P., Hostetler, J., Lawrence, S., Leach, P., Luotonen, A., and L. Stewart, &ldquo;HTTP Authentication: Basic and Digest Access Authentication,&rdquo; June&nbsp;1999.</span><span>)</span></a> is used to challenge only
           REGISTER and INVITE requests. However, the more messages it is applied to the more prevention
           from threats is assured. It is recommended to apply digest authentication to all SIP requests in peering agreements, including
           BYE and CANCEL, to prevent attacks such as session tear-down.
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.7"></a><h3>3.7.&nbsp;
Use TCP instead of UDP to deliver SIP messages</h3>

<p>SIP clients need to stay connected with the server on a persistent basis (differently from HTTP clients).
           Scalability requirements are therefore much more stringent for a SIP server than for a web server.
           This leads to the choice of UDP as protocol used between SSPs to carry SIP messages (especially for
           providers with a large user community). New improvements in the Linux kernel <a class='info' href='#refs.tcp-scalability'>[refs.tcp&#8209;scalability]<span> (</span><span class='info'>Shemyak, K., &ldquo;Scalability of TCP Servers, Handling Persistent Connections,&rdquo; .</span><span>)</span></a>
           show a big increase of the scalability of TCP in handling large number of persistent (but idle) connections.
           Therefore SSP operators still using UDP for their SIP network should consider switching to TCP. This would
           increase the difficulty of performing attacks such as session teardown or forged responses. Since look-up and SED
   data should be exchanged securely (see security requirements), it is further recommended to not only use TCP but TLS for messages exchanged between SSPs.
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.8"></a><h3>3.8.&nbsp;
Ingress Filtering / Reverse-Path Filtering</h3>

<p>Ingress filtering, i.e., blocking all traffic coming from a host that has a source address different than
           the addresses that have been assigned to that host (see <a class='info' href='#RFC2827'>[RFC2827]<span> (</span><span class='info'>Ferguson, P. and D. Senie, &ldquo;Network Ingress Filtering: Defeating Denial of Service Attacks which employ IP Source Address Spoofing,&rdquo; May&nbsp;2000.</span><span>)</span></a>) can effectively prevent
           UEs from sending packets with a spoofed source IP address. This can be achieved by reverse-path filtering, i.e., only accepting ingress traffic if
responses would take the same path.
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.9"></a><h3>3.9.&nbsp;
Strong Identity Assertion</h3>

<p>"Caller ID spoofing" can be achieved thanks to a Weak identity assertion on the From URI of an INVITE request.
           In a single SSP domain, strong identity assertion can be easily achieved by authenticating each INVITE request.
           However, in the context of SPEERMINT, only the originating SSP is able to verify the identity directly.
           In order to overcome this problem there are currently only two major approaches: transitive trust and cryptographic
           signature.
           
           The transitive trust approach builds a chain of trust among different SSP domains. One example of this approach
           is a combined mechanism specified in <a class='info' href='#RFC3324'>[RFC3324]<span> (</span><span class='info'>Watson, M., &ldquo;Short Term Requirements for Network Asserted Identity,&rdquo; November&nbsp;2002.</span><span>)</span></a> and <a class='info' href='#RFC3325'>[RFC3325]<span> (</span><span class='info'>Jennings, C., Peterson, J., and M. Watson, &ldquo;Private Extensions to the Session Initiation Protocol (SIP) for Asserted Identity within Trusted Networks,&rdquo; November&nbsp;2002.</span><span>)</span></a>.
                      
           Using this approach in a transit peering network scenario, the terminating SSP must establish a trust relationship
           with all SSP domains on the path, which can be seen as an underlying weakness.
           
           The use of cryptographic signatures is an alternative approach. "SIP Authenticated Identity Body (AIB)" is
           specified in <a class='info' href='#RFC3893'>[RFC3893]<span> (</span><span class='info'>Peterson, J., &ldquo;Session Initiation Protocol (SIP) Authenticated Identity Body (AIB) Format,&rdquo; September&nbsp;2004.</span><span>)</span></a>. <a class='info' href='#RFC4474'>[RFC4474]<span> (</span><span class='info'>Peterson, J. and C. Jennings, &ldquo;Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP),&rdquo; August&nbsp;2006.</span><span>)</span></a> introduces two new header fields IDENTITY and
           IDENTITY-INFO that allow a SIP server in the originating SSP to digitally sign an INVITE request after authenticating
           the sending UE. The terminating SSP can verify if the INVITE request is signed by a trusted SSP domain. Although this
           approach does not require the terminating SSP to establish a trust relationship with all transit SSPs on the path, a
           PKI infrastructure is assumed to be in place.
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.10"></a><h3>3.10.&nbsp;
Reliable Border Element Pooling</h3>

<p>It is advisable to implement reliable pooling on border elements. An architecture and protocols for the management of server pools supporting mission-critical applications are addressed
           in the RSERPOOL WG. Using this mechanisms (see <a class='info' href='#RFC3237'>[RFC3237]<span> (</span><span class='info'>Tuexen, M., Xie, Q., Stewart, R., Shore, M., Ong, L., Loughney, J., and M. Stillman, &ldquo;Requirements for Reliable Server Pooling,&rdquo; January&nbsp;2002.</span><span>)</span></a> for requirements) a UE obtains support 
           for server failover in case of availability problems.
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.11"></a><h3>3.11.&nbsp;
Rate limit</h3>

<p>Packet flooding attacks can be mitigated by limiting the rate of incoming traffic through policing or queuing. 
           In this way legitimate clients can be denied of the service since their traffic may be discarded. Rate limiting
           can also be applied on a per-source-IP basis under the assumption that the source IP of each attack packet is not
           spoofed dynamically and will all the limitations related to NAT and mobility issues. It may be preferable to limit 
           the number of concurrent 'sessions', i.e., ongoing calls instead of the messaging associated with it (since session 
           use more resources on backend-systems). When calculating rate limits 
           all entities along the session path should be taken into account. SIP entities on the receiving end of a call may be the
limiting factor (e.g., the number of ISDN channels on PSTN gateways) rather than the ingress limiting device.
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.12"></a><h3>3.12.&nbsp;
Border Element Hardening</h3>

<p>To prevent attackers from hacking SPEERMINT border elements these implementations should be seurity hardened. For instance, fuzz testing is a common black box testing technique used in software engineering. Also, security vulnerability tests can be carried
           out preventively to assure a UE/SBE/DBE can handle unexpected data correctly without crashing.
           <a class='info' href='#RFC4475'>[RFC4475]<span> (</span><span class='info'>Sparks, R., Hawrylyshen, A., Johnston, A., Rosenberg, J., and H. Schulzrinne, &ldquo;Session Initiation Protocol (SIP) Torture Test Messages,&rdquo; May&nbsp;2006.</span><span>)</span></a> and <a class='info' href='#refs.protos'>[refs.protos]<span> (</span><span class='info'>Wieser, C., &ldquo;SIP Robustness Testing for Large-Scale Use,&rdquo; .</span><span>)</span></a> are examples of torture test cases specific for SIP
           devices and freely available security testing tools, respectively. These type of tests needs to be carried out before product release and in addition throughout the product life cycle.
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.13"></a><h3>3.13.&nbsp;
SRTCP</h3>

<p>Secure RTCP (SRTCP) provides the same security-related features to RTCP as SRTP does for RTP.  SRTCP is described in
           <a class='info' href='#RFC3711'>[RFC3711]<span> (</span><span class='info'>Baugher, M., McGrew, D., Naslund, M., Carrara, E., and K. Norrman, &ldquo;The Secure Real-time Transport Protocol (SRTP),&rdquo; March&nbsp;2004.</span><span>)</span></a> as optional. In order to prevent some of the RTCP threats previously described it is recommended to
           turn this feature on.
</p>
<a name="mapping"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Mapping suggested countermeasures to threats</h3>

<p>The following table shows how to mitigate threats with the appropriate countermeasures listed in section <a class='info' href='#requirements'>Section&nbsp;3<span> (</span><span class='info'>Suggested Countermeasures</span><span>)</span></a>.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
          +---------------------------------------------------------+
          | Group  |       Threat        | Suggested Countermeasure |
          +--------+------------------------------------------------+
          |        | Unauthorized access | database BCPs            |
          |        +---------------------+--------------------------+
          |  LUF   | SQL injection       | database BCPs            |
          |        +---------------------+--------------------------+
          |        | DoS to LUF          | database BCPs            |
          +--------+---------------------+--------------------------+
          |        | URI harvesting      | DNSSEC                   |
          |        +---------------------+--------------------------+
          |        | SIP equipment       | DNSSEC,                  |
          |        | enumeration         | privacy protection	    |
          |        +---------------------+--------------------------+
          |  LF    | MitM attack         | DNSSEC                   |
          |        +---------------------+--------------------------+
          |        | Incorrect           |                          |
          |        | destinations        | DNSSEC                   |
          |        +---------------------+--------------------------+
          |        | DoS to LF           | DNS replication          |
          +--------+---------------------+--------------------------+
          |        | Call pattern        |                          |
          |        | analysis            | TLS                      |
          |        +---------------------+--------------------------+
          |        | Password cracking   | TLs                      |
          |        +---------------------+--------------------------+
          |        | Session Tear Down   | TLS, TCP, digest auth.   |
          |        +---------------------+--------------------------+
          |        | REGISTER spoofing   | digest auth.             |
          |        +---------------------+--------------------------+
          |        | Billing fraud       | digest auth.             |
          |        +---------------------+--------------------------+
          |        | User ID spoofing    | strong identity assertion|
          |   SF   +---------------------+--------------------------+
          |        | Forged 200 Response | TLS, TCP, ingress filt.  |
          |        +---------------------+--------------------------+
          |        | Forged 302 Response | TLS, TCP, ingress filt.  |
          |        +---------------------+--------------------------+
          |        | Forged 404 Response | TLS, TCP, ingress filt.  |
          |        +---------------------+--------------------------+
          |        | Flooding attack     | reliable border element  |
          |        |                     | pooling, rate limit      |
          |        +---------------------+--------------------------+
          |        | Session black       | DNSSEC                   |
          |        | holing              |                          |
          |        +---------------------+--------------------------+
          |        | SIP fuzzing attack  | border element hardening |
          +--------+---------------------+--------------------------+
          |        | Eavesdropping       | SRTP                     |
          |        +---------------------+--------------------------+
          |        | Media Hijack        | SRTP                     |
          |        +---------------------+--------------------------+
          |  MF    | Media session       | SRTCP                    |
          |        | tear-down           |                          |
          |        +---------------------+--------------------------+
          |        | QoS degradation     | SRTCP                    |
          |        +---------------------+--------------------------+
          |        | Malformed messages  | border element hardening |
          |        +---------------------+--------------------------+
          |        | Messages flooding   | rate limit               |
          +--------+---------------------+--------------------------+
</pre></div>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Current Deployment of Countermeasures</h3>

<p>At the time of writing this document not all suggested countermeasures are widely deployed. In particular, the following measures to prevent attacks suggested in section <a class='info' href='#requirements'>Section&nbsp;3<span> (</span><span class='info'>Suggested Countermeasures</span><span>)</span></a> have not seen wide deployment:
             </p>
<ul class="text">
<li>DNSSEC
</li>
<li>Digest authentication on all requests in peering agreements
</li>
</ul><p>
           
           Nevertheless, these protocols and solutions can provide effective means for preventing some of the attacks with respect to the SPEERMINT architecture described in this document.
           It is envisioned that these countermeasures will be more widely deployed in the future. Therefore, these mechanisms are listed in this document even though they are not widely deployed today.
</p>
<a name="conclusions"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Conclusions</h3>

<p> This memo presented the different SPEERMINT security threats classified in groups
         related to the LUF, LF, SF and MF respectively. The multiple instances of the threats are
         presented with a brief explanation. Afterwards the suggested countermeasures for SPEERMINT were outlined
         together with possible mitigation of the existing threats by means of them.
</p>
<a name="security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Security Considerations</h3>

<p> This memo is entirely focused on the security threats for SPEERMINT.
</p>
<a name="ack"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Acknowledgements</h3>

<p>This memo takes inspiration from VOIPSA VoIP Security and Privacy Threat Taxonomy. The
         authors would like to thank VOIPSA for having produced such a comprehensive taxonomy
         which is the starting point of this draft. The authors would also like to thank Cullen
         Jennings for the useful slides presented at the VoIP Management and Security workshop
         in Vancouver. Further, the authors thank Hendrik Scholz for providing extensive and very helpful comments to this draft.
         
</p>
<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>8.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="refs.voipsataxonomy">[refs.voipsataxonomy]</a></td>
<td class="author-text">Zar, J. and et al, &ldquo;VOIPSA VoIP Security and Privacy Threat Taxonomy,&rdquo; October&nbsp;2005.</td></tr>
<tr><td class="author-text" valign="top"><a name="refs.speermintarch">[refs.speermintarch]</a></td>
<td class="author-text">Penno, R., Malas, D., Khan, S., and A. Uzelac, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-speermint-architecture-04.txt.txt">SPEERMINT Peering Architecture</a>,&rdquo; draft-ietf-speermint-architecture-04.txt (work in progress), August&nbsp;2007.</td></tr>
<tr><td class="author-text" valign="top"><a name="refs.zrtp">[refs.zrtp]</a></td>
<td class="author-text">Zimmermann, P., Johnston, A., and J. Callas, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-zimmermann-avt-zrtp-04.txt.txt">ZRTP: Extensions to RTP for Diffie-Hellman Key Agreement for SRTP</a>,&rdquo; draft-zimmermann-avt-zrtp-04.txt (work in progress), July&nbsp;2007.</td></tr>
<tr><td class="author-text" valign="top"><a name="refs.tlsbis">[refs.tlsbis]</a></td>
<td class="author-text">Dierks, T. and E. Rescorla, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-tls-rfc4346-bis-09.txt.txt">The TLS Protocol Version 1.2</a>,&rdquo; draft-ietf-tls-rfc4346-bis-09.txt (work in progress), February&nbsp;2008.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3711">[RFC3711]</a></td>
<td class="author-text">Baugher, M., McGrew, D., Naslund, M., Carrara, E., and K. Norrman, &ldquo;<a href="http://tools.ietf.org/html/rfc3711">The Secure Real-time Transport Protocol (SRTP)</a>,&rdquo; RFC&nbsp;3711, March&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3711.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4474">[RFC4474]</a></td>
<td class="author-text">Peterson, J. and C. Jennings, &ldquo;<a href="http://tools.ietf.org/html/rfc4474">Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP)</a>,&rdquo; RFC&nbsp;4474, August&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4474.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-speermint-terminology">[I-D.ietf-speermint-terminology]</a></td>
<td class="author-text">Malas, D. and D. Meyer, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-speermint-terminology-17.txt">SPEERMINT Terminology</a>,&rdquo; draft-ietf-speermint-terminology-17 (work in progress), November&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-speermint-terminology-17.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-speermint-requirements">[I-D.ietf-speermint-requirements]</a></td>
<td class="author-text">Mule, J., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-speermint-requirements-09.txt">SPEERMINT Requirements for SIP-based Session Peering</a>,&rdquo; draft-ietf-speermint-requirements-09 (work in progress), October&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-speermint-requirements-09.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="refs.dbsec">[refs.dbsec]</a></td>
<td class="author-text">Gertz, M. and S. Jajodia, &ldquo;Handbook of Database Security.&rdquo;</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4033">[RFC4033]</a></td>
<td class="author-text">Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose, &ldquo;<a href="http://tools.ietf.org/html/rfc4033">DNS Security Introduction and Requirements</a>,&rdquo; RFC&nbsp;4033, March&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4033.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4034">[RFC4034]</a></td>
<td class="author-text">Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose, &ldquo;<a href="http://tools.ietf.org/html/rfc4034">Resource Records for the DNS Security Extensions</a>,&rdquo; RFC&nbsp;4034, March&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4034.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4035">[RFC4035]</a></td>
<td class="author-text">Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose, &ldquo;<a href="http://tools.ietf.org/html/rfc4035">Protocol Modifications for the DNS Security Extensions</a>,&rdquo; RFC&nbsp;4035, March&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4035.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3323">[RFC3323]</a></td>
<td class="author-text">Peterson, J., &ldquo;<a href="http://tools.ietf.org/html/rfc3323">A Privacy Mechanism for the Session Initiation Protocol (SIP)</a>,&rdquo; RFC&nbsp;3323, November&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3323.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2617">[RFC2617]</a></td>
<td class="author-text"><a href="mailto:john@math.nwu.edu">Franks, J.</a>, <a href="mailto:pbaker@verisign.com">Hallam-Baker, P.</a>, <a href="mailto:jeff@AbiSource.com">Hostetler, J.</a>, <a href="mailto:lawrence@agranat.com">Lawrence, S.</a>, <a href="mailto:paulle@microsoft.com">Leach, P.</a>, Luotonen, A., and <a href="mailto:stewart@OpenMarket.com">L. Stewart</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2617">HTTP Authentication: Basic and Digest Access Authentication</a>,&rdquo; RFC&nbsp;2617, June&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2617.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2617.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2617.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="refs.tcp-scalability">[refs.tcp-scalability]</a></td>
<td class="author-text">Shemyak, K., &ldquo;Scalability of TCP Servers, Handling Persistent Connections.&rdquo;</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2827">[RFC2827]</a></td>
<td class="author-text">Ferguson, P. and D. Senie, &ldquo;<a href="http://tools.ietf.org/html/rfc2827">Network Ingress Filtering: Defeating Denial of Service Attacks which employ IP Source Address Spoofing</a>,&rdquo; BCP&nbsp;38, RFC&nbsp;2827, May&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2827.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3324">[RFC3324]</a></td>
<td class="author-text">Watson, M., &ldquo;<a href="http://tools.ietf.org/html/rfc3324">Short Term Requirements for Network Asserted Identity</a>,&rdquo; RFC&nbsp;3324, November&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3324.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3325">[RFC3325]</a></td>
<td class="author-text">Jennings, C., Peterson, J., and M. Watson, &ldquo;<a href="http://tools.ietf.org/html/rfc3325">Private Extensions to the Session Initiation Protocol (SIP) for Asserted Identity within Trusted Networks</a>,&rdquo; RFC&nbsp;3325, November&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3325.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3893">[RFC3893]</a></td>
<td class="author-text">Peterson, J., &ldquo;<a href="http://tools.ietf.org/html/rfc3893">Session Initiation Protocol (SIP) Authenticated Identity Body (AIB) Format</a>,&rdquo; RFC&nbsp;3893, September&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3893.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3237">[RFC3237]</a></td>
<td class="author-text">Tuexen, M., Xie, Q., Stewart, R., Shore, M., Ong, L., Loughney, J., and M. Stillman, &ldquo;<a href="http://tools.ietf.org/html/rfc3237">Requirements for Reliable Server Pooling</a>,&rdquo; RFC&nbsp;3237, January&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3237.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="refs.protos">[refs.protos]</a></td>
<td class="author-text">Wieser, C., &ldquo;SIP Robustness Testing for Large-Scale Use.&rdquo;</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4475">[RFC4475]</a></td>
<td class="author-text">Sparks, R., Hawrylyshen, A., Johnston, A., Rosenberg, J., and H. Schulzrinne, &ldquo;<a href="http://tools.ietf.org/html/rfc4475">Session Initiation Protocol (SIP) Torture Test Messages</a>,&rdquo; RFC&nbsp;4475, May&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4475.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Saverio Niccolini</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Network Laboratories, NEC Europe Ltd.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Kurfuersten-Anlage 36</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Heidelberg  69115</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Germany</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+49 (0) 6221 4342 118</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:saverio.niccolini@netlab.nec.de">saverio.niccolini@netlab.nec.de</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.netlab.nec.de">http://www.netlab.nec.de</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Eric Chen</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Information Sharing Platform Laboratories, NTT</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">3-9-11 Midori-cho</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Musashino, Tokyo  180-8585</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Japan</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:eric.chen@lab.ntt.co.jp">eric.chen@lab.ntt.co.jp</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.ntt.co.jp/index_e.html">http://www.ntt.co.jp/index_e.html</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Jan Seedorf</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">NEC Laboratories Europe, NEC Europe
         Ltd.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Kurfuersten-Anlage 36</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Heidelberg  69115</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Germany</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+49 (0) 6221 4342 221</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:seedorf@nw.neclab.eu">seedorf@nw.neclab.eu</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.nw.neclab.eu">http://www.nw.neclab.eu</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2008).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
