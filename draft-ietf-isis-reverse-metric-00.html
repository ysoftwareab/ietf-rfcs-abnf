<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>IS-IS Reverse Metric TLV for Network Maintenance Events </title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Node Isolation Challenges">
<link href="#rfc.section.1.2" rel="Chapter" title="1.2 Link Isolation Challenges">
<link href="#rfc.section.1.3" rel="Chapter" title="1.3 IS-IS Reverse Metric">
<link href="#rfc.section.1.4" rel="Chapter" title="1.4 Specification of Requirements">
<link href="#rfc.section.2" rel="Chapter" title="2 IS-IS Reverse Metric TLV">
<link href="#rfc.section.3" rel="Chapter" title="3 Elements of Procedure">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 Processing Changes to Default Metric">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 Processing Changes to Default Metric for Multi-Topology IS-IS">
<link href="#rfc.section.3.3" rel="Chapter" title="3.3 Multi-Access LAN Procedures">
<link href="#rfc.section.3.4" rel="Chapter" title="3.4 Order of Operations">
<link href="#rfc.section.3.5" rel="Chapter" title="3.5 Operational Guidelines">
<link href="#rfc.section.4" rel="Chapter" title="4 Reverse Metric TLV Example Use Cases">
<link href="#rfc.section.5" rel="Chapter" title="5 Operational Considerations">
<link href="#rfc.section.6" rel="Chapter" title="6 Security Considerations">
<link href="#rfc.section.7" rel="Chapter" title="7 IANA Considerations">
<link href="#rfc.section.8" rel="Chapter" title="8 Acknowledgements">
<link href="#rfc.references" rel="Chapter" title="9 References">
<link href="#rfc.references.1" rel="Chapter" title="9.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="9.2 Informative References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="This document describes an improved IS-IS neighbor management scheme which can be used to enhance network performance by allowing operators to quickly and accurately shift traffic away from a point-to-point or multi-access LAN interface by allowing one IS-IS router to signal to a second, adjacent IS-IS neighbor to adjust its IS-IS metric that should be used to temporarily reach the first IS-IS router during network maintenance events.  " />
  <meta name="description" content="This document describes an improved IS-IS neighbor management scheme which can be used to enhance network performance by allowing operators to quickly and accurately shift traffic away from a point-to-point or multi-access LAN interface by allowing one IS-IS router to signal to a second, adjacent IS-IS neighbor to adjust its IS-IS metric that should be used to temporarily reach the first IS-IS router during network maintenance events.  " />
  <meta name="keywords" content="" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">IS-IS Working Group</td>
<td class="right">N. Shen</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">T. Li</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">Cisco Systems, Inc.</td>
</tr>
<tr>
<td class="left">Expires: January 04, 2012</td>
<td class="right">S. Amante</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Level 3 Communications</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">M. Abrahamsson</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Tele2</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">July 03, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">IS-IS Reverse Metric TLV for Network Maintenance Events <br />
  <span class="filename">draft-ietf-isis-reverse-metric-00</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>This document describes an improved IS-IS neighbor management scheme which can be used to enhance network performance by allowing operators to quickly and accurately shift traffic away from a point-to-point or multi-access LAN interface by allowing one IS-IS router to signal to a second, adjacent IS-IS neighbor to adjust its IS-IS metric that should be used to temporarily reach the first IS-IS router during network maintenance events.  </p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on January 04, 2012.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>1.1.   <a href="#rfc.section.1.1">Node Isolation Challenges</a>
</li>
<li>1.2.   <a href="#rfc.section.1.2">Link Isolation Challenges</a>
</li>
<li>1.3.   <a href="#rfc.section.1.3">IS-IS Reverse Metric</a>
</li>
<li>1.4.   <a href="#rfc.section.1.4">Specification of Requirements</a>
</li>
<li>2.   <a href="#rfc.section.2">IS-IS Reverse Metric TLV</a>
</li>
<li>3.   <a href="#rfc.section.3">Elements of Procedure</a>
</li>
<li>3.1.   <a href="#rfc.section.3.1">Processing Changes to Default Metric</a>
</li>
<li>3.2.   <a href="#rfc.section.3.2">Processing Changes to Default Metric for Multi-Topology IS-IS</a>
</li>
<li>3.3.   <a href="#rfc.section.3.3">Multi-Access LAN Procedures</a>
</li>
<li>3.4.   <a href="#rfc.section.3.4">Order of Operations</a>
</li>
<li>3.5.   <a href="#rfc.section.3.5">Operational Guidelines</a>
</li>
<li>4.   <a href="#rfc.section.4">Reverse Metric TLV Example Use Cases</a>
</li>
<li>5.   <a href="#rfc.section.5">Operational Considerations</a>
</li>
<li>6.   <a href="#rfc.section.6">Security Considerations</a>
</li>
<li>7.   <a href="#rfc.section.7">IANA Considerations</a>
</li>
<li>8.   <a href="#rfc.section.8">Acknowledgements</a>
</li>
<li>9.   <a href="#rfc.references">References</a>
</li>
<li>9.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>9.2.   <a href="#rfc.references.2">Informative References</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> <a href="#Intro" id="Intro">Introduction</a>
</h1>
<p id="rfc.section.1.p.1">The IS-IS <a href="#ISO%2010589">[ISO 10589]</a> routing protocol has been widely used in Internet Service Provider IP/MPLS networks.  Operational experience with the protocol, combined with ever increasing requirements for lossless operations have demonstrated some operational issues.  This document describes one issue and a new mechanism for improving it.  </p>
<h1 id="rfc.section.1.1">
<a href="#rfc.section.1.1">1.1.</a> <a href="#node-isolation" id="node-isolation">Node Isolation Challenges</a>
</h1>
<p id="rfc.section.1.1.p.1">On rare occasions it is necessary for an operator to perform disruptive network maintenance on an entire IS-IS router node, i.e.: major software upgrades, power/cooling augments, etc.  In these cases, an operator will set the IS-IS Overload Bit (OL-bit) within the Link State Protocol Data Units (LSP's) of the IS-IS router about to undergo maintenance.  The IS-IS router immediately floods the updated LSP's to all IS-IS routers throughout the IS-IS domain.  Upon receipt of the updated LSP's, all IS-IS routers recalculate their Shortest Path First (SPF) tree excluding IS-IS routers whose LSP's have the OL-bit set.  This effectively removes the IS-IS router about to undergo maintenance from the topology, thus preventing it from forwarding any transit traffic during the maintenance period.  </p>
<p id="rfc.section.1.1.p.2">After the maintenance activity is completed, the operator resets the IS-IS Overload Bit within the LSP's of the original IS-IS router causing it to flood updated IS-IS LSP's throughout the IS-IS domain.  All IS-IS routers recalculate their SPF tree and now include the original IS-IS router in their topology calculations, allowing it to be used for transit traffic again.  </p>
<p id="rfc.section.1.1.p.3">Isolating an entire IS-IS router from the topology can be especially disruptive due to the displacement of a large volume of traffic through an entire IS-IS router to other, sub-optimal paths, (i.e.: those with significantly larger delay).  Thus, in the majority of network maintenance scenarios, where only a single link or LAN needs to be augmented to increase its physical capacity or is experiencing an intermittent failure, it is much more common and desirable to gracefully remove just the targeted link or LAN from service, temporarily, so that the least amount of user-data traffic is affected while intrusive augment, diagnostic and/or replacement procedures are being executed.  </p>
<h1 id="rfc.section.1.2">
<a href="#rfc.section.1.2">1.2.</a> <a href="#link-isolation" id="link-isolation">Link Isolation Challenges</a>
</h1>
<p id="rfc.section.1.2.p.1">Before network maintenance events are performed on individual physical links or LAN's, operators substantially increase the IS-IS metric simultaneously on both devices attached to the same link or LAN.  In doing so, the devices generate new Link State Protocol Data Units (LSP's) that are flooded throughout the network and cause all routers to gradually shift traffic onto alternate paths with very little, to no, disruption to in-flight communications by applications or end-users.  When performed successfully, this allows the operator to confidently perform disruptive augmentation, fault diagnosis or repairs on a link without disturbing ongoing communications in the network.  </p>
<p id="rfc.section.1.2.p.2">The challenge with the above solution are as follows.  First, it is quite common to have routers with several hundred interfaces onboard and individual interfaces that are transferring several hundred Gigabits/second to Terabits/second of traffic.  Thus, it is imperative that operators accurately identify the same point-to-point link on two, separate devices in order to increase (and, afterward, decrease) the IS-IS metric appropriately.  Second, the aforementioned solution is very time consuming and even more error-prone to perform when its necessary to temporarily remove a multi-access LAN from the network topology.  Specifically, the operator needs to configure ALL devices's that have interfaces attached to the multi-access LAN with an appropriately high IS-IS metric, (and then decrease the IS-IS metric to its original value afterward).  Finally, with respect to multi-access LAN's, there is currently no method to bidirectionally isolate only a single node's interface on the LAN when performed more fine-grained diagnosis and repairs to the multi-access LAN.  </p>
<p id="rfc.section.1.2.p.3">In theory, use of a Network Management System (NMS) could improve the accuracy of identifying the appropriate subset of routers attached to either a point-to-point link or a multi-access LAN as well as signaling from the NMS to those devices, using a network management protocol, to adjust the IS-IS metrics on the pertinent set of interfaces.  The reality is that NMS are, to a very large extent, not used within Service Provider's networks for a variety of reasons.  In particular, NMS do not interoperate very well across different vendors or even separate platform families within the same vendor.  </p>
<p id="rfc.section.1.2.p.4">The risks of misidentifying one side of a point-to-point link or one or more interfaces attached to a multi-access LAN and subsequently increasing its IS-IS metric are potentially increased latency, jitter or packet loss.  This is unacceptable given the necessary performance requirements for a variety of applications, the customer perception for near lossless operations and the associated, demanding Service Level Agreement's (SLA's) for all network services.  </p>
<h1 id="rfc.section.1.3">
<a href="#rfc.section.1.3">1.3.</a> <a href="#reverse-metric-solution" id="reverse-metric-solution">IS-IS Reverse Metric</a>
</h1>
<p id="rfc.section.1.3.p.1">This document proposes that the routing protocol itself be the transport mechanism to allow one IS-IS router to advertise to an adjacent node on a point-to-point or multi-access LAN link a "reverse metric" in a IS-IS Hello (IIH) PDU.  This would allow an operator to only configure a single router, set a "reverse metric" on a link and have traffic bidirectionally shift away from that link gracefully to alternate, viable paths.  </p>
<h1 id="rfc.section.1.4">
<a href="#rfc.section.1.4">1.4.</a> <a href="#Req" id="Req">Specification of Requirements</a>
</h1>
<p id="rfc.section.1.4.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">[RFC2119]</a>.  </p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> <a href="#reverse-metric-tlv" id="reverse-metric-tlv">IS-IS Reverse Metric TLV</a>
</h1>
<p id="rfc.section.2.p.1">The Reverse Metric TLV is composed of 1 octet for the Type, 1 octet that specifies the number of bytes in the Value field and a variable-length Value field.  The Value field starts with a 1 octet field of Flags followed by a 3 octet field containing an IS-IS Metric and, lastly, a 1 octet Traffic Engineering (TE) sub-TLV length field representing the length of a variable number of Extended Intermediate System (IS) Reachability sub-TLV's.  If the 'S' bit in the Flags field is set to 1, then the Value field MUST also contain data of 1 or more Extended IS Reachability sub-TLV's.  </p>
<p id="rfc.section.2.p.2">The Reverse Metric TLV is optional.  The Reverse Metric TLV may be present in any IS-IS Hello PDU.  A sender MUST only transmit a single Reverse Metric TLV in a IS-IS Hello PDU.  </p>
<p></p>

<ul class="empty">
<li>TYPE: TBD</li>
<li>LENGTH: variable (5 - 255 octets)</li>
<li>VALUE: <ul class="empty">
<li>Flags (1 octet)</li>
<li>Metric (3 octets)</li>
<li>TE sub-TLV length (1 octet)</li>
<li>TE sub-TLV data (0 - 250 octets)</li>
</ul>
<p> </p>
</li>
</ul>

<p> </p>
<div id="#rfc.figure.1"></div>
<div id="#reverse-metric-tlv-flags"></div>
<p></p>

<p>Flags</p>
<pre>
       0 1 2 3 4 5 6 7
      +-+-+-+-+-+-+-+-+
      | Reserved  |S|W|
      +-+-+-+-+-+-+-+-+
	  </pre>
<p id="rfc.section.2.p.5">The Reverse Metric TLV Type is TBD.  Please refer to IANA Considerations, in <a href="#IANA">Section 7</a>, for more details.  </p>
<p id="rfc.section.2.p.6">The Metric field contains a 24-bit unsigned integer of an IS-IS metric a neighbor SHOULD add to the existing, configured "default metric" contained within its IS Neighbors TLV or Extended IS Reachability TLV's for point-to-point links, or Pseudonode LSP by the Designated Intermediate System (DIS) for multi-access LAN's, back toward the router that originated this Reverse Metric TLV.  Refer to "Elements of Procedure", below in <a href="#procedure-elements">Section 3</a>, for details of how an IS-IS router should process the Metric field in a Reverse Metric TLV.  </p>
<p id="rfc.section.2.p.7">There is currently only two Flag bits defined.  </p>
<p id="rfc.section.2.p.8">W bit (0x01): The "Whole LAN" bit is only used in the context of multi-access LAN's.  When a Reverse Metric TLV is transmitted from a (non-DIS) node to the DIS, if the "Whole LAN" bit is set (1), then a DIS SHOULD add the received Metric value in the Reverse Metric TLV to each node's existing "default metric" in the Pseudonode LSP.  If the "Whole LAN" bit is not set (0), then a DIS SHOULD add the received Metric value in the Reverse Metric TLV to the existing "default metric" in the Pseudonode LSP for the single node from whom the Reverse Metric TLV was received.  Please refer to "Multi-Access LAN Procedures", in <a href="#lan-procedures">Section 3.3</a>, for additional details.  The W bit MUST be unset (0) when a Reverse Metric TLV is transmitted in a IIH PDU onto a point-to-point link to an IS-IS neighbor.  </p>
<p id="rfc.section.2.p.9">S bit (0x02): The "TE sub-TLV" bit MUST be set (1) when an IS-IS router wishes to signal that its neighbor alter parameters contained in the neighbor's Traffic Engineering "Extended IS Reachability TLV", as defined in <a href="#RFC5305">[RFC5305]</a>.  This document defines that only the "Traffic Engineering Default Metric" sub-TLV, sub-TLV Type 18, may be sent toward neighbors in the Reverse Metric TLV, because that is used in Constrained Shortest Path First (CSPF) computations.  Upon receipt of this TE sub-TLV in a Reverse Metric TLV, a node SHOULD add the received TE default metric to its existing, configured TE default metric within its Extended IS Reachability TLV.  Use of other sub-TLV's is outside the scope of this document.  </p>
<p id="rfc.section.2.p.10">The S bit MUST NOT be set (0) when an IS-IS router does not have TE sub-TLV's that it wishes to send to its IS-IS neighbor.  </p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#procedure-elements" id="procedure-elements">Elements of Procedure</a>
</h1>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> <a href="#metric-changes" id="metric-changes">Processing Changes to Default Metric</a>
</h1>
<p id="rfc.section.3.1.p.1">The Metric field, in the Reverse Metric TLV, is a "default metric" that will either be in the range of 0 - 63 when a "narrow" IS-IS metric is used (IS Neighbors TLV, Pseudonode LSP) <a href="#RFC1195">[RFC1195]</a> or in the range of 0 - (2^24 - 2) when a "wide" Traffic Engineering metric value is used, (Extended IS Reachability TLV) <a href="#RFC5305">[RFC5305]</a>.  It is RECOMMENDED that implementations, by default, place the appropriate maximum default metric value, 63 or (2^24 - 2), in the Metric field and TE Default Metric sub-TLV of the Reverse Metric TLV, since the most common use is to remove the link from the topology, except for use as a last-resort path.  </p>
<p id="rfc.section.3.1.p.2">In order to ensure that an individual TE link is used as a link of last resort during SPF computation, its metric MUST NOT be greater than or equal to (2^24 - 1) <a href="#RFC5305">[RFC5305]</a>.  Therefore, a receiver of a Reverse Metric TLV MUST use the numerically smallest value of either the sum of its existing default metric and the Metric value in the Reverse Metric TLV or (2^24 - 2), as the default metric when updating its Extended IS Reachability TLV and TE default-metric sub-TLV's that it will then flood throughout the IS-IS domain, using normal IS-IS procedures.  Likewise, originators of a Pseudonode LSP or IS Neighbors TLV MUST use the numerically smallest value of either the sum of its existing default metric and the Metric value it receives in a Reverse Metric TLV or 63 when updating the corresponding Pseudonode LSP or IS Neighbor TLV before they are flooded.  This also applies when an IS-IS router is only configured or capable of sending a "narrow" IS-IS default metric, in the range of 0 - 63, but receives a "wide" Metric value in a Reverse Metric TLV, in the range of 64 - (2^24 - 2).  In this case, the receiving router MUST use the maximum "narrow" IS-IS default metric, 63, as its IS-IS default metric value in its updated IS Neighbor TLV or Pseudonode LSP that it floods.  </p>
<p id="rfc.section.3.1.p.3">If an IS-IS router is configured to originate a TE Default Metric sub-TLV for a link, but receives a Reverse Metric TLV from its neighbor that does not contain a TE Default Metric sub-TLV, then the IS-IS router MUST add the value in the Metric field of the Reverse Metric TLV to its own TE Default Metric sub-TLV for that link.  The IS-IS router should then flood the updated Extended IS Reachability TLV, including its updated TE Default Metric sub-TLV, using normal IS-IS procedures.  </p>
<p id="rfc.section.3.1.p.4">Routers MUST scan the Metric value and TE sub-TLV's in all subsequently received Reverse Metric TLV's.  If changes are observed by a receiver of the Reverse Metric TLV in the Metric value or TE Default Metric sub-TLV value, the receiving router MUST update its advertised IS-IS default metric or Traffic Engineering parameters in the appropriate TLV's, recompute its SPF tree and flood new LSP's to other IS-IS routers, according to the recommendations outlined in <a href="#order-of-operations">Section 3.4</a>, Order of Operations, below.  </p>
<p id="rfc.section.3.1.p.5">If the router does not understand the Reverse Metric TLV or is explicitly configured to ignore received Reverse Metric TLV's, then it MUST NOT update the default metric in its IS Neighbors TLV, Extended IS Reachability TLV, TE Default Metric sub-TLV, Multi-Topology Intermediate Systems TLV or Pseudonode LSP nor execute other procedures that would result from acting on a Reverse Metric TLV, such as recomputing its SPF tree.  </p>
<h1 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> <a href="#mt-isis-metric-changes" id="mt-isis-metric-changes">Processing Changes to Default Metric for Multi-Topology IS-IS</a>
</h1>
<p id="rfc.section.3.2.p.1">The Reverse Metric TLV is applicable to Multi-Topology IS-IS (M-ISIS) <a href="#RFC5120">[RFC5120]</a> capable point-to-point links.  If an IS-IS router is configured for M-ISIS it MUST send only a single Reverse Metric TLV in IIH PDU's toward its neighbor(s) on the designated link that is about to undergo maintenance.  When an M-ISIS router receives a Reverse Metric TLV it MUST add the received Metric value to its default metric in all Extended IS Reachability TLV's for all topologies.  If an M-ISIS router receives a Reverse Metric TLV with a TE Default Metric sub-TLV, then the M-ISIS router MUST add the received TE Default Metric value to each of its TE Default Metric sub-TLV's in all of its MT Intermediate Systems TLV's.  If an M-ISIS router is configured to advertise TE Default Metric sub-TLV's for one or more topologies, but does not receive a TE Default Metric sub-TLV in a Reverse Metric TLV, then the M-ISIS router MUST add the value in Metric field of the Reverse Metric TLV to each of the TE Default Metric sub-TLV's for all topologies.  The M-ISIS should flood its newly updated MT IS TLV's and recompute its SPF/CSPF accordingly.  </p>
<p id="rfc.section.3.2.p.2">Multi-Topology IS-IS <a href="#RFC5120">[RFC5120]</a> specifies there is no change to construction of the Pseudonode LSP, regardless of the Multi-Topology capabilities of a multi-access LAN.  If any MT capable node on the LAN advertises the Reverse Metric TLV to the DIS, the DIS should act according to the "Multi-Access LAN Procedures" in <a href="#lan-procedures">Section 3.3</a> to update, as appropriate, the default metric contained in the Pseudonode LSP.  If the DIS updates the default metric in and floods a new Pseudonode LSP, those default metric values will be applied to all topologies during Multi-Topology SPF calculations.  </p>
<h1 id="rfc.section.3.3">
<a href="#rfc.section.3.3">3.3.</a> <a href="#lan-procedures" id="lan-procedures">Multi-Access LAN Procedures</a>
</h1>
<p id="rfc.section.3.3.p.1">On a Multi-Access LAN, only the DIS SHOULD act upon information contained in a received Reverse Metric TLV.  All non-DIS nodes MUST silently ignore a received Reverse Metric TLV.  </p>
<p id="rfc.section.3.3.p.2">In the case of multi-access LAN's, the "W" Flags bit is used to signal from a non-DIS to the DIS whether to change the metric and optionally Traffic Engineering parameters for all nodes in the Pseudonode LSP or a single node on the LAN, (the originator of the Reverse Metric TLV).  </p>
<p id="rfc.section.3.3.p.3">A non-DIS node, e.g.: Router B, attached to a multi-access LAN will send a Reverse Metric TLV with the W bit set to 0 to the DIS, when Router B wishes the DIS to add the Metric value to the default metric contained in the Pseudonode LSP specific to just Router B.  Other non-DIS nodes, i.e.: Routers C and D, may simultaneously send a Reverse Metric TLV with the W bit set to 0 to request the DIS add their own Metric value to their default metric contained in the Pseudonode LSP.  When the DIS receives a properly formatted Reverse Metric TLV with the W bit set to 0, the DIS MUST only add the default metric contained in its Pseudonode LSP for the specific neighbor that sent the Reverse Metric TLV.  </p>
<p id="rfc.section.3.3.p.4">It is possible for one node, Router A, to signal to the DIS with the W bit set to 1, in which case the DIS would add the Metric value in the Reverse Metric TLV to all neighbor adjacencies in the Pseudonode LSP and transmit a new Pseudonode LSP to all nodes in the IS-IS domain.  Later, a second node on the LAN, Router B, could signal to the DIS with the W bit also set to 1.  In this case, the DIS MUST use the highest source MAC address from IIH PDU's containing Reverse Metric TLV's it receives as the tie-breaker to determine the sole Reverse Metric TLV used as the source for the Metric value that will be added to the default metric for all nodes in the Pseudonode LSP.  If the source MAC address was highest in IIH PDU's containing a Reverse Metric TLV received from Router B, then the DIS MUST add the Metric value to the default metric of all neighbors in its Pseudonode LSP and flood the LSP to all nodes in the IS-IS domain.  On the other hand, if the DIS determines that Router A's IIH PDU's, containing Reverse Metric TLV's, have the highest source MAC address, then the DIS will ignore Router B's Reverse Metric TLV and continue to use the Metric value found in Router A's Reverse Metric TLV to add to the default metric of all neighbors in the Pseudonode LSP.  When this occurs, the DIS MAY send a single syslog message or SNMP trap indicating that it has received a Reverse Metric TLV from a neighbor, but is ignoring it due to it being received from a neighbor with a lower MAC address.  </p>
<p id="rfc.section.3.3.p.5">Another scenario is that one node, Router A, may signal the DIS with the W bit set to 1.  The DIS would add the Metric value to the default metric for all neighbors in the Pseudonode LSP and flood the LSP.  Later, a second node on the LAN, Router B, could signal the DIS with the W bit set to 0, which indicates to the DIS that Router B is requesting the DIS only add the Metric value in the Reverse Metric TLV from Router B to the default metric for Router B in the Pseudonode LSP.  The DIS MUST honor a neighbor's Reverse Metric TLV to update its individual default metric in the Pseudonode LSP even if the DIS receives prior or later requests to assert a Whole LAN metric from other nodes on the same LAN.  </p>
<p id="rfc.section.3.3.p.6">In all cases above, the DIS is MUST use 0 as the base default-metric value for each neighbor contained in the Pseudonode LSP to which the DIS will add the Metric value in the Reverse Metric TLV(s) it receives from neighbors on the LAN.  </p>
<p id="rfc.section.3.3.p.7">Local configuration on the DIS to adjust the default metric(s) contained in the Pseudonode LSP, as documented in <a href="#I-D.shen-isis-oper-enhance">[I-D.shen-isis-oper-enhance]</a> MUST take precedence over received Reverse Metric TLV's.  </p>
<h1 id="rfc.section.3.4">
<a href="#rfc.section.3.4">3.4.</a> <a href="#order-of-operations" id="order-of-operations">Order of Operations</a>
</h1>
<p id="rfc.section.3.4.p.1">When an IS-IS router starts or stops generating a Reverse Metric TLV, it will go through a process of updating its own IS-IS metric and optionally Traffic Engineering parameters in its IS Neighbors TLV, Extended IS Reachbaility TLV or Pseudonode LSP, flooding updated LSP's (using normal IS-IS mechanisms), recompute its SPF/CSPF tree plus corresponding metrics to IP prefixes, update its FIB and begin advertising the Reverse Metric TLV in IIH PDU's toward its corresponding neighbor(s) on the appropriate link or LAN.  Likewise, when IS-IS neighbor(s) start or stop receiving a Reverse Metric TLV, they will go through a similar process.  It is critical that devices which implement the Reverse Metric TLV conduct this process in a deterministic order that minimizes the possibilities to generate temporary micro forwarding loops during a metric increase and decrease.  </p>
<h1 id="rfc.section.3.5">
<a href="#rfc.section.3.5">3.5.</a> <a href="#ops-guidelines" id="ops-guidelines">Operational Guidelines</a>
</h1>
<p id="rfc.section.3.5.p.1">A router MUST advertise a Reverse Metric TLV toward a neighbor only for the period during which it wants a neighbor to temporarily update its IS-IS metric or TE parameters.  </p>
<p id="rfc.section.3.5.p.2">During the period when a Reverse Metric TLV is used, IS-IS routers that are generating and receiving a Reverse Metric TLV MUST NOT change their existing IS-IS metric or Traffic Engineering parameters in their stored (e.g.: hard disk, etc.) configurations, since those parameters are carefully derived from off-line capacity planning tools and are difficult to restore to their original values.  </p>
<p id="rfc.section.3.5.p.3">Routers that receive a Reverse Metric TLV MAY send a syslog message or SNMP trap, in order to assist in rapidly identifying the node in the network that is asserting an IS-IS metric or Traffic Engineering parameters different from that which is configured locally on the device.  </p>
<p id="rfc.section.3.5.p.4">It is RECOMMENDED that implementations provide a capability to disable any changes to a node's, or individual interfaces of the node, default metric or Traffic Engineering parameters based upon receipt of properly formatted Reverse Metric TLV's.  </p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#example-use-cases" id="example-use-cases">Reverse Metric TLV Example Use Cases</a>
</h1>
<p id="rfc.section.4.p.1">The following is a brief example illustrating one use case of the Reverse Metric TLV.  In order to isolate a point-to-point link from the IS-IS network, an operator would configure one router, Router A, attached to a point-to-point link with a "Reverse Metric".  This should not affect the configuration of the existing IS-IS default metric previously configured on the router's interface.  Assuming Router A is using IS-IS Extensions for Traffic Engineering <a href="#RFC5305">[RFC5305]</a>, this should trigger Router A to update its Traffic Engineering Default Metric sub-TLV in its own Extended IS Reachability TLV, recompute its SPF tree and corresponding metrics to IP prefixes in the IS-IS domain and begin the process of flooding a new LSP throughout the network.  Router A would also begin transmitting a Reverse Metric TLV, with an appropriate Metric value, in an IIH PDU, to its adjacent neighbor, Router B.  Upon receipt of the Reverse Metric TLV, Router B would add the received Metric or TE default metric sub-TLV value to its own Traffic Engineering Default Metric sub-TLV, recalculate its SPF tree and associated route topology as well as start flooding a new LSP containing the updated Extended IS Reachability TLV throughout the network.  As nodes in the network receive the associated LSP's from Router A and B and recalculate a new SPF tree, and route topology, traffic should gracefully shift onto alternate paths away from the A-B link; ultimately, after all nodes in the network recompute their SPF tree link A-B should only be used as a link of last-resort.  The operator can inspect traffic counters on the A-B interface to determine if the link was successfully isolated from the topology and proceed with necessary fault diagnosis or maintenance of the associated link.  </p>
<p id="rfc.section.4.p.2">When the maintenance activity is complete, the operator would remove the reverse metric configuration from Router A, which would cease advertisement of the Reverse Metric TLV in IIH PDU's to Router B.  Both routers would revert to their originally configured IS-IS metric, recompute new SPF trees and corresponding metrics to IP prefixes and originate new LSP's.  As the new LSP's are received and SPF is recalculated by nodes in the IS-IS domain, traffic should gradually shift back onto link A-B.  </p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#Oper" id="Oper">Operational Considerations</a>
</h1>
<p id="rfc.section.5.p.1">Since the Reverse Metric TLV may not be recognized by adjacent IS-IS neighbors, operators should inspect input and output traffic throughput counters on the local router to ensure that traffic has bidirectionally shifted away from a link before starting any maintenance activities.  </p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#Security" id="Security">Security Considerations</a>
</h1>
<p id="rfc.section.6.p.1">The enhancement in this document makes it possible for one IS-IS router to manipulate the IS-IS default metric or optionally Traffic Engineering parameters of adjacent IS-IS neighbors.  Although IS-IS routers within a single Autonomous System nearly always reside under the control of a single administrative authority, it is highly RECOMMENDED that operators configure authentication of IS-IS PDU's to mitigate use of the Reverse Metric TLV as a potential attack vector, particularly on multi-access LAN's.  </p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> <a href="#IANA" id="IANA">IANA Considerations</a>
</h1>
<p id="rfc.section.7.p.1">This document requests that IANA allocate from the IS-IS TLV Codepoints Registry a new TLV, referred to as the "Reverse Metric" TLV, with the following attributes: IIH = y, LSP = n, SNP = n, Purge = n.  </p>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> <a href="#Acknowledgements" id="Acknowledgements">Acknowledgements</a>
</h1>
<p id="rfc.section.8.p.1">The authors would like to thank Mike Shand, Dave Katz, Guan Deng, Ilya Varlashkin, Jay Chen, Les Ginsberg and Peter Ashwood-Smith, Jonathan Harrison, Dave Ward, Himanshu Shah and Wes George for their contributions.  </p>
<h1 id="rfc.references">
<a href="#rfc.references">9.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">9.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="ISO 10589">[ISO 10589]</b></td>
<td class="top">
<a>ISO</a>, "<a>Intermediate system to Intermediate system routeing information exchange protocol for use in conjunction with the Protocol for providing the Connectionless-mode Network Service (ISO 8473) </a>", ISO/IEC 10589:2002, .</td>
</tr>
<tr>
<td class="reference"><b id="RFC1195">[RFC1195]</b></td>
<td class="top">
<a title="Digital Equipment Corporation (DEC)">Callon, R.</a>, "<a href="http://tools.ietf.org/html/rfc1195">Use of OSI IS-IS for routing in TCP/IP and dual environments</a>", RFC 1195, December 1990.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5120">[RFC5120]</b></td>
<td class="top">
<a>Przygienda, T.</a>, <a>Shen, N.</a> and <a>N. Sheth</a>, "<a href="http://tools.ietf.org/html/rfc5120">M-ISIS: Multi Topology (MT) Routing in Intermediate System to Intermediate Systems (IS-ISs)</a>", RFC 5120, February 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5305">[RFC5305]</b></td>
<td class="top">
<a>Li, T.</a> and <a>H. Smit</a>, "<a href="http://tools.ietf.org/html/rfc5305">IS-IS Extensions for Traffic Engineering</a>", RFC 5305, October 2008.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">9.2.</a> Informative References</h1>
<table><tbody><tr>
<td class="reference"><b id="I-D.shen-isis-oper-enhance">[I-D.shen-isis-oper-enhance]</b></td>
<td class="top">
<a>Shen, N</a>, <a>Li, T</a>, <a>Amante, S</a> and <a>M Abrahamsson</a>, "<a href="http://tools.ietf.org/html/draft-shen-isis-oper-enhance-00">IS-IS Operational Enhancements for Network Maintenance Events</a>", Internet-Draft draft-shen-isis-oper-enhance-00, October 2010.</td>
</tr></tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Naiming Shen</span> 
	  <span class="n hidden">
		<span class="family-name">Shen</span>
	  </span>
	</span>
	<span class="org vcardline">Cisco Systems, Inc.</span>
	<span class="adr">
	  <span>225 West Tasman Drive</span>

	  <span class="vcardline">
		<span class="locality">San Jose</span>,  
		<span class="region">CA</span> 
		<span class="code">95134</span>
	  </span>
	  <span class="country-name vcardline">USA</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:naiming@cisco.com">naiming@cisco.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Tony Li</span> 
	  <span class="n hidden">
		<span class="family-name">Li</span>
	  </span>
	</span>
	<span class="org vcardline">Cisco Systems, Inc.</span>
	<span class="adr">
	  <span>225 West Tasman Drive</span>

	  <span class="vcardline">
		<span class="locality">San Jose</span>,  
		<span class="region">CA</span> 
		<span class="code">95134</span>
	  </span>
	  <span class="country-name vcardline">USA</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:tli@cisco.com">tli@cisco.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Shane Amante</span> 
	  <span class="n hidden">
		<span class="family-name">Amante</span>
	  </span>
	</span>
	<span class="org vcardline">Level 3 Communications</span>
	<span class="adr">
	  <span>1025 Eldorado Blvd</span>

	  <span class="vcardline">
		<span class="locality">Broomfield</span>,  
		<span class="region">CO</span> 
		<span class="code">80021</span>
	  </span>
	  <span class="country-name vcardline">USA</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:shane@level3.net">shane@level3.net</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Mikael Abrahamsson</span> 
	  <span class="n hidden">
		<span class="family-name">Abrahamsson</span>
	  </span>
	</span>
	<span class="org vcardline">Tele2</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:swmike@swm.pp.se">swmike@swm.pp.se</a></span>

  </address>
</div>

</body>
</html>