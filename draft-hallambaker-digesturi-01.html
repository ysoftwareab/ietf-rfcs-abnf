<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>The di (DIGEST) URI Scheme</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Definitions">
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Requirements Language">
<link href="#rfc.section.1.2" rel="Chapter" title="1.2 Defined Terms">
<link href="#rfc.section.2" rel="Chapter" title="2 Requirements">
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 Examples of Use">
<link href="#rfc.section.2.1.1" rel="Chapter" title="2.1.1 Simple Digest">
<link href="#rfc.section.2.1.2" rel="Chapter" title="2.1.2 Digest with Meta-Data">
<link href="#rfc.section.2.1.3" rel="Chapter" title="2.1.3 Digest with Locator">
<link href="#rfc.section.2.1.4" rel="Chapter" title="2.1.4 Digest with Decryption Key">
<link href="#rfc.section.3" rel="Chapter" title="3 The di (DIGEST) URI TYPE">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 Syntax">
<link href="#rfc.section.3.1.1" rel="Chapter" title="3.1.1 Encoding Considerations">
<link href="#rfc.section.3.1.1.1" rel="Chapter" title="3.1.1.1 Use of base64url Encoding">
<link href="#rfc.section.3.1.1.2" rel="Chapter" title="3.1.1.2 Query Parameter Encoding">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 Semantics">
<link href="#rfc.section.3.2.1" rel="Chapter" title="3.2.1 Digest Algorithms">
<link href="#rfc.section.3.2.2" rel="Chapter" title="3.2.2 Parameters">
<link href="#rfc.section.3.2.2.1" rel="Chapter" title="3.2.2.1 Content Type (ct)">
<link href="#rfc.section.3.2.2.2" rel="Chapter" title="3.2.2.2 HTTP Locator (http &amp; https)">
<link href="#rfc.section.3.2.2.3" rel="Chapter" title="3.2.2.3 Encryption and MIME Encryption Specifiers (enc &amp; menc)">
<link href="#rfc.section.4" rel="Chapter" title="4 Security Considerations">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 Integrity">
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 Confidentiality">
<link href="#rfc.section.4.3" rel="Chapter" title="4.3 Weak Digest Algorithm">
<link href="#rfc.section.5" rel="Chapter" title="5 IANA Considerations">
<link href="#rfc.section.5.1" rel="Chapter" title="5.1 Assignment of URI Scheme di">
<link href="#rfc.section.5.2" rel="Chapter" title="5.2 Assignment of Well Known URI prefix di">
<link href="#rfc.section.5.3" rel="Chapter" title="5.3 Specification of Additional Cryptographic Algorithms">
<link href="#rfc.section.5.4" rel="Chapter" title="5.4 Creation of di parameter registry">
<link href="#rfc.references" rel="Chapter" title="6 References">
<link href="#rfc.references.1" rel="Chapter" title="6.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="6.2 Non Normative References">
<link href="#rfc.appendix.Appendix%20A" rel="Chapter" title="Appendix A Test Vectors">
<link href="#rfc.appendix.Appendix%20A.1" rel="Chapter" title="Appendix A.1 Example: Hello World !">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="A URI scheme for referencing static data abjects by means of a cryptographic digest mechanism is specified. The format is designed to resist content type substitution attacks and supports a choice of digest algorithms.  " />
  <meta name="description" content="A URI scheme for referencing static data abjects by means of a cryptographic digest mechanism is specified. The format is designed to resist content type substitution attacks and supports a choice of digest algorithms.  " />
  <meta name="keywords" content="Cryptography, URI" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Internet Engineering Task Force</td>
<td class="right">P. M. Hallam-Baker</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Comodo Group Inc.</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">R. N. Stradling</td>
</tr>
<tr>
<td class="left">Expires: April 05, 2012</td>
<td class="right">Comodo CA Ltd.</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">October 03, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">The di (DIGEST) URI Scheme<br />
  <span class="filename">draft-hallambaker-digesturi-01</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>A URI scheme for referencing static data abjects by means of a cryptographic digest mechanism is specified. The format is designed to resist content type substitution attacks and supports a choice of digest algorithms.  </p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on April 05, 2012.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Definitions</a>
</li>
<li>1.1.   <a href="#rfc.section.1.1">Requirements Language</a>
</li>
<li>1.2.   <a href="#rfc.section.1.2">Defined Terms</a>
</li>
<li>2.   <a href="#rfc.section.2">Requirements</a>
</li>
<li>2.1.   <a href="#rfc.section.2.1">Examples of Use</a>
</li>
<li>2.1.1.   <a href="#rfc.section.2.1.1">Simple Digest</a>
</li>
<li>2.1.2.   <a href="#rfc.section.2.1.2">Digest with Meta-Data</a>
</li>
<li>2.1.3.   <a href="#rfc.section.2.1.3">Digest with Locator</a>
</li>
<li>2.1.4.   <a href="#rfc.section.2.1.4">Digest with Decryption Key</a>
</li>
<li>3.   <a href="#rfc.section.3">The di (DIGEST) URI TYPE</a>
</li>
<li>3.1.   <a href="#rfc.section.3.1">Syntax</a>
</li>
<li>3.1.1.   <a href="#rfc.section.3.1.1">Encoding Considerations</a>
</li>
<li>3.1.1.1.   <a href="#rfc.section.3.1.1.1">Use of base64url Encoding</a>
</li>
<li>3.1.1.2.   <a href="#rfc.section.3.1.1.2">Query Parameter Encoding</a>
</li>
<li>3.2.   <a href="#rfc.section.3.2">Semantics</a>
</li>
<li>3.2.1.   <a href="#rfc.section.3.2.1">Digest Algorithms</a>
</li>
<li>3.2.2.   <a href="#rfc.section.3.2.2">Parameters</a>
</li>
<li>3.2.2.1.   <a href="#rfc.section.3.2.2.1">Content Type (ct)</a>
</li>
<li>3.2.2.2.   <a href="#rfc.section.3.2.2.2">HTTP Locator (http &amp; https)</a>
</li>
<li>3.2.2.3.   <a href="#rfc.section.3.2.2.3">Encryption and MIME Encryption Specifiers (enc &amp; menc)</a>
</li>
<li>4.   <a href="#rfc.section.4">Security Considerations</a>
</li>
<li>4.1.   <a href="#rfc.section.4.1">Integrity</a>
</li>
<li>4.2.   <a href="#rfc.section.4.2">Confidentiality</a>
</li>
<li>4.3.   <a href="#rfc.section.4.3">Weak Digest Algorithm</a>
</li>
<li>5.   <a href="#rfc.section.5">IANA Considerations</a>
</li>
<li>5.1.   <a href="#rfc.section.5.1">Assignment of URI Scheme di</a>
</li>
<li>5.2.   <a href="#rfc.section.5.2">Assignment of Well Known URI prefix di</a>
</li>
<li>5.3.   <a href="#rfc.section.5.3">Specification of Additional Cryptographic Algorithms</a>
</li>
<li>5.4.   <a href="#rfc.section.5.4">Creation of di parameter registry</a>
</li>
<li>6.   <a href="#rfc.references">References</a>
</li>
<li>6.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>6.2.   <a href="#rfc.references.2">Non Normative References</a>
</li>
<li>Appendix A.   <a href="#rfc.appendix.Appendix%20A">Test Vectors</a>
</li>
<li>Appendix A.1.   <a href="#rfc.appendix.Appendix%20A.1">Example: Hello World !</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> Definitions</h1>
<h1 id="rfc.section.1.1">
<a href="#rfc.section.1.1">1.1.</a> Requirements Language</h1>
<p id="rfc.section.1.1.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">RFC 2119</a> <cite title="NONE">[RFC2119]</cite>.  </p>
<h1 id="rfc.section.1.2">
<a href="#rfc.section.1.2">1.2.</a> Defined Terms</h1>
<p id="rfc.section.1.2.p.1">The following terms are used in this document:</p>
<p></p>

<dl>
<dt>URI</dt>
<dd style="margin-left: 8"></dd>
</dl>

<p> </p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> Requirements</h1>
<p id="rfc.section.2.p.1">Provides a strong reference to a static data object.  </p>
<p id="rfc.section.2.p.2">Does not provide a means of resolution.  </p>
<p id="rfc.section.2.p.3">Allows an authenticated data source to provide an authenticated reference to a static data object.  </p>
<p id="rfc.section.2.p.4">Intended applications include creating references from </p>
<p></p>

<ul class="empty">
<li>Web pages delivered over HTTP/TLS </li>
<li>DNS resource records signed using DNSSEC </li>
<li>Data values embedded in certificates, CRLs, OCSP tokens and other signed data objects.  </li>
</ul>

<p> </p>
<h1 id="rfc.section.2.1">
<a href="#rfc.section.2.1">2.1.</a> Examples of Use</h1>
<h1 id="rfc.section.2.1.1">
<a href="#rfc.section.2.1.1">2.1.1.</a> Simple Digest</h1>
<p id="rfc.section.2.1.1.p.1">For example, the following digest URI specifies a reference to the text "Hello World !" using the SHA-2 algorithm with 256 bit output: </p>
<p id="rfc.section.2.1.1.p.2">di:sha-256:B_K97zTtFuOhug27fke4_Zgc4Myz4b_lZNgsQjy6fkc</p>
<h1 id="rfc.section.2.1.2">
<a href="#rfc.section.2.1.2">2.1.2.</a> Digest with Meta-Data</h1>
<p id="rfc.section.2.1.2.p.1">The semantics of a digest being used to establish a secure reference from an authenticated source to an external source may be a function of associated meta data such as the content type. This data MAY be specified by means of a parameter: </p>
<p id="rfc.section.2.1.2.p.2">di:sha-256:B_K97zTtFuOhug27fke4_Zgc4Myz4b_lZNgsQjy6fkc?ct=text/plain</p>
<h1 id="rfc.section.2.1.3">
<a href="#rfc.section.2.1.3">2.1.3.</a> Digest with Locator</h1>
<p id="rfc.section.2.1.3.p.1">A digest identifier MAY provide a location from which the referenced content MAY be available. Note however that since it is statistically unlikely that a given identifier will correspond to more than one content sequence, the actual location from which the data is retrieved is immaterial.  </p>
<p id="rfc.section.2.1.3.p.2">di:sha-256:B_K97zTtFuOhug27fke4_Zgc4Myz4b_lZNgsQjy6fkc?http=di.example.com</p>
<p id="rfc.section.2.1.3.p.3">The corresponding content MAY be retrieved from the URL: </p>
<p id="rfc.section.2.1.3.p.4">http://di.example.com/.well-known/B_K97zTtFuOhug27fke4_Zgc4Myz4b_lZNgsQjy6fkc </p>
<p id="rfc.section.2.1.3.p.5">A digest identifier MAY specify multiple locations from which the content MAY be obtained: </p>
<p id="rfc.section.2.1.3.p.6">di:sha-256:B_K97zTtFuOhug27fke4_Zgc4Myz4b_lZNgsQjy6fkc? http=one.example.com&amp;http=two.example.com</p>
<p id="rfc.section.2.1.3.p.7">Asserts that the content may be retrieved from either of the following URIs: </p>
<p id="rfc.section.2.1.3.p.8">http://one.example.com/.well-known/B_K97zTtFuOhug27fke4_Zgc4Myz4b_lZNgsQjy6fkc http://two.example.com/.well-known/B_K97zTtFuOhug27fke4_Zgc4Myz4b_lZNgsQjy6fkc </p>
<h1 id="rfc.section.2.1.4">
<a href="#rfc.section.2.1.4">2.1.4.</a> Digest with Decryption Key</h1>
<p id="rfc.section.2.1.4.p.1">A digest identifier MAY provide a key for decrypting the referenced data.  </p>
<p id="rfc.section.2.1.4.p.2">di:sha-256:B_K97zTtFuOhug27fke4_Zgc4Myz4b_lZNgsQjy6fkc? enc=aes-cbc:Fw3x20nEKfq6FDGzq7ttIQ</p>
<p id="rfc.section.2.1.4.p.3">If the mechanism outlined on the list but not here is used, the digest portion of the URI may be truncated at 128 bits and a value generated from the key portion used to defeat birthday attack: </p>
<p id="rfc.section.2.1.4.p.4">di:sha-128:B_K97zTtFuOhug27fke4_Q?enc=aes-cbc:Fw3x20nEKfq6FDGzq7ttIQ </p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> The di (DIGEST) URI TYPE</h1>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> <a href="#syntax" id="syntax">Syntax</a>
</h1>
<p id="rfc.section.3.1.p.1">The DIGEST URI Type has the following format: </p>
<p id="rfc.section.3.1.p.2">"di:" algorithm ":" digest [ "?" tag "=" value [ "&amp;" tag "=" value ] * ] </p>
<h1 id="rfc.section.3.1.1">
<a href="#rfc.section.3.1.1">3.1.1.</a> <a href="#encoding" id="encoding">Encoding Considerations</a>
</h1>
<h1 id="rfc.section.3.1.1.1">
<a href="#rfc.section.3.1.1.1">3.1.1.1.</a> Use of base64url Encoding</h1>
<p id="rfc.section.3.1.1.1.p.1">Section 2.2 of <a href="#RFC4395">[RFC4395]</a> states [URI schemes that are not intended for use with relative URIs SHOULD avoid use of the forward slash "/" character, which is used for hierarchical delimiters, and the complete path segments "." and ".." (dot-segments).] </p>
<p id="rfc.section.3.1.1.1.p.2">Consequently the encoding of the digest value is effected using the base64url encoding specified in Section 5 of  <a href="#RFC4648">[RFC4648]</a> which avoids the use of the forward slash '/' character.  </p>
<h1 id="rfc.section.3.1.1.2">
<a href="#rfc.section.3.1.1.2">3.1.1.2.</a> Query Parameter Encoding</h1>
<p id="rfc.section.3.1.1.2.p.1">The query segment of a URI is NOT hierarchical. Thus escape encoding of slash '/' characters is NOT required.  </p>
<p id="rfc.section.3.1.1.2.p.2">Section 3.4 of <a href="#RFC3986">[RFC3986]</a> states [The characters slash ("/") and question mark ("?") may represent data within the query component.] </p>
<p id="rfc.section.3.1.1.2.p.3">Consequently no special escaping mechanism is required for the query parameter portion of the URI. URI escaping is however frequently imposed automatically by scripting environments. Thus to ensure interoperability, implementations SHOULD NOT generate URIs that employ URI character escaping and implementations MUST accept and URIs that employ URI character escaping.  </p>
<h1 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> <a href="#semantics" id="semantics">Semantics</a>
</h1>
<p></p>
<h1 id="rfc.section.3.2.1">
<a href="#rfc.section.3.2.1">3.2.1.</a> Digest Algorithms</h1>
<p id="rfc.section.3.2.1.p.1">Implementations MUST support the sha-256 algorithm as specified in <a href="#RFC4055">[RFC4055]</a>.  </p>
<p id="rfc.section.3.2.1.p.2">Implementations MAY support other algorithms specified in the Data Structure for the Security Suitability of Cryptographic Algorithms registry 'Cryptographic Algorithms' <a href="#RFC5698">[RFC5698]</a>.  </p>
<h1 id="rfc.section.3.2.2">
<a href="#rfc.section.3.2.2">3.2.2.</a> Parameters</h1>
<h1 id="rfc.section.3.2.2.1">
<a href="#rfc.section.3.2.2.1">3.2.2.1.</a> Content Type (ct)</h1>
<p id="rfc.section.3.2.2.1.p.1">The Content Type "ct" parameter specifies the MIME Content Type of the associated data as defined in <a href="#RFC4288">[RFC4288]</a> </p>
<h1 id="rfc.section.3.2.2.2">
<a href="#rfc.section.3.2.2.2">3.2.2.2.</a> HTTP Locator (http &amp; https)</h1>
<p id="rfc.section.3.2.2.2.p.1">The http and https parameters are used to specify a possible means of resolving the referenced content. Mulltiple locator parameters MAY be used to specify alternative sources for accessing the content.  </p>
<p id="rfc.section.3.2.2.2.p.2">The http and https parameters take a single argument, the domain name to be used for resolution. To permit the use of digest URIs in ASCII-only environments, the ASCII encoding (aka punycode) of the domain name MUST be used.  </p>
<p id="rfc.section.3.2.2.2.p.3">To resolve such a location reference, a client first transforms the digest URI to obtain a http or https url as follows: </p>
<p id="rfc.section.3.2.2.2.p.4">URL = prefix + domain + "/.well-known/" + digest </p>
<p id="rfc.section.3.2.2.2.p.5">Where: </p>
<p></p>

<dl>
<dt>prefix</dt>
<dd style="margin-left: 8">Is the string "http://" for the http parameter type and is the string "https://" for the https parameter type.  </dd>
<dt>domain</dt>
<dd style="margin-left: 8">Is the value associated with the parameter.  </dd>
<dt>digest</dt>
<dd style="margin-left: 8">Is the digest portion of the digest URI.  </dd>
</dl>

<p> </p>
<p id="rfc.section.3.2.2.2.p.7">Implementations MUST NOT disclose any other data. In particular implementations MUST NOT disclose the query parameter portion of the URI.  </p>
<h1 id="rfc.section.3.2.2.3">
<a href="#rfc.section.3.2.2.3">3.2.2.3.</a> Encryption and MIME Encryption Specifiers (enc &amp; menc)</h1>
<p id="rfc.section.3.2.2.3.p.1">The encryption and MIME encryption specifiers are used to provide a means of obtaining the plaintext of a reference to encrypted content.  </p>
<p id="rfc.section.3.2.2.3.p.2">The enc specifier is used when the encrypted object consists of the encrypted content alone. The menc spcifier is used when the encrypted object consists of a MIME header containing metadata followed by the binary object encoding.  </p>
<p id="rfc.section.3.2.2.3.p.3">The encryption specifiers both take an agrument of the form: </p>
<p id="rfc.section.3.2.2.3.p.4">algorithm ":" base64url (key) [":"  base64url (iv)] </p>
<p id="rfc.section.3.2.2.3.p.5">Where</p>
<p></p>

<dl>
<dt>algorithm</dt>
<dd style="margin-left: 8">Is the algorithm used to encrypt the associated content </dd>
<dt>key</dt>
<dd style="margin-left: 8">Is the value of the cryptographic key </dd>
<dt>iv (optional)</dt>
<dd style="margin-left: 8">Is the value of the cryptographic Initialization Vector.  </dd>
<dt></dt>
<dd style="margin-left: 8">If the IV is not spcified for a block cipher mode that requires one, the IV MUST be prepended to the encrypted content.  </dd>
<dt></dt>
<dd style="margin-left: 8">[Actually the IV does not provide any additional security for this application but explaining the reason would be more effort than it is worth and what I really care about is saving bytes in the identifier, not the resulting data package.] </dd>
</dl>

<p> </p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#sec_cons" id="sec_cons">Security Considerations</a>
</h1>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> Integrity</h1>
<p id="rfc.section.4.1.p.1">No secret information is required to generate a DIGEST URI. Therefore a DIGEST URI only provides a proof of integrity for the referenced object and the proof of integrity provided is only as good as the proof of integrity for the DIGEST URI value.  </p>
<h1 id="rfc.section.4.2">
<a href="#rfc.section.4.2">4.2.</a> Confidentiality</h1>
<p id="rfc.section.4.2.p.1">Disclosure of a DIGEST URI value does not necessarily entail disclosure of the referenced object but may enable an attacker to determine the contents of the referenced object by reference to a search engine or other data repository.  </p>
<h1 id="rfc.section.4.3">
<a href="#rfc.section.4.3">4.3.</a> Weak Digest Algorithm</h1>
<p id="rfc.section.4.3.p.1">[The digest algorithm MUST be strong] </p>
<p id="rfc.section.4.3.p.2">[For most use cases collision resistance is a requirement] </p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> IANA Considerations</h1>
<h1 id="rfc.section.5.1">
<a href="#rfc.section.5.1">5.1.</a> Assignment of URI Scheme di</h1>
<p id="rfc.section.5.1.p.1">The procedures for registration of a URI scheme are specified in <a href="#RFC4395">RFC 4395</a> <cite title="NONE">[RFC4395]</cite>. The following is the proposed assignment template.  </p>
<p id="rfc.section.5.1.p.2">URI scheme name: di </p>
<p id="rfc.section.5.1.p.3">Status: Permanent </p>
<p id="rfc.section.5.1.p.4">URI scheme syntax. See <a href="#syntax">Section 3.1</a> </p>
<p id="rfc.section.5.1.p.5">URI scheme semantics. See <a href="#semantics">Section 3.2</a> </p>
<p id="rfc.section.5.1.p.6">Encoding considerations. See <a href="#encoding">Section 3.1.1</a> </p>
<p id="rfc.section.5.1.p.7">Applications/protocols that use this URI scheme name: General applicability with initial use cases provided by WEBSEC and DECADE </p>
<p id="rfc.section.5.1.p.8">Interoperability considerations: TBS </p>
<p id="rfc.section.5.1.p.9">Security considerations: See <a href="#sec_cons">Section 4</a> </p>
<p id="rfc.section.5.1.p.10">Contact: IETF / Phillip Hallam-Baker </p>
<p id="rfc.section.5.1.p.11">Author/Change controller: IETF / Phillip Hallam-Baker </p>
<p id="rfc.section.5.1.p.12">References: As specified in this document </p>
<h1 id="rfc.section.5.2">
<a href="#rfc.section.5.2">5.2.</a> Assignment of Well Known URI prefix di</h1>
<p id="rfc.section.5.2.p.1">The procedures for registration of a Well Known URI entry are specified in <a href="#RFC5785">RFC 5785</a> <cite title="NONE">[RFC5785]</cite>.  The following is the proposed assignment template.  </p>
<p id="rfc.section.5.2.p.2">URI suffix:  di </p>
<p id="rfc.section.5.2.p.3">Change controller: IETF </p>
<p id="rfc.section.5.2.p.4">Specification document(s): This document </p>
<p id="rfc.section.5.2.p.5">Related information:  None </p>
<h1 id="rfc.section.5.3">
<a href="#rfc.section.5.3">5.3.</a> Specification of Additional Cryptographic Algorithms</h1>
<p id="rfc.section.5.3.p.1">[Added in case it is decided to specify truncated forms of the cryptographic digests] </p>
<p id="rfc.section.5.3.p.2">The procedures for registration of a Cryptographic Algorithm identifier are specified in <a href="#RFC5698">RFC 5698</a> <cite title="NONE">[RFC5698]</cite>.  The following is the proposed assignment template.  </p>
<p id="rfc.section.5.3.p.3">Textual name of the algorithm: SHA-128 </p>
<p id="rfc.section.5.3.p.4">OID of the algorithm: [TBS] </p>
<p id="rfc.section.5.3.p.5">Reference: This document.  </p>
<h1 id="rfc.section.5.4">
<a href="#rfc.section.5.4">5.4.</a> Creation of di parameter registry</h1>
<p id="rfc.section.5.4.p.1">This specification creates a new IANA registry entitled "DI URI Parameter Definitions".  </p>
<p id="rfc.section.5.4.p.2">The policy for future assignments to the registry is "RFC Required".  </p>
<p></p>
<h1 id="rfc.references">
<a href="#rfc.references">6.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">6.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3986">[RFC3986]</b></td>
<td class="top">
<a href="mailto:timbl@w3.org" title="World Wide Web Consortium">Berners-Lee, T.</a>, <a href="mailto:fielding@gbiv.com" title="Day Software">Fielding, R.</a> and <a href="mailto:LMM@acm.org" title="Adobe Systems Incorporated">L. Masinter</a>, "<a href="http://tools.ietf.org/html/rfc3986">Uniform Resource Identifier (URI): Generic Syntax</a>", STD 66, RFC 3986, January 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4055">[RFC4055]</b></td>
<td class="top">
<a>Schaad, J.</a>, <a>Kaliski, B.</a> and <a>R. Housley</a>, "<a href="http://tools.ietf.org/html/rfc4055">Additional Algorithms and Identifiers for RSA Cryptography for use in the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>", RFC 4055, June 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4288">[RFC4288]</b></td>
<td class="top">
<a>Freed, N.</a> and <a>J. Klensin</a>, "<a href="http://tools.ietf.org/html/rfc4288">Media Type Specifications and Registration Procedures</a>", BCP 13, RFC 4288, December 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4395">[RFC4395]</b></td>
<td class="top">
<a>Hansen, T.</a>, <a>Hardie, T.</a> and <a>L. Masinter</a>, "<a href="http://tools.ietf.org/html/rfc4395">Guidelines and Registration Procedures for New URI Schemes</a>", BCP 35, RFC 4395, February 2006.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4648">[RFC4648]</b></td>
<td class="top">
<a>Josefsson, S.</a>, "<a href="http://tools.ietf.org/html/rfc4648">The Base16, Base32, and Base64 Data Encodings</a>", RFC 4648, October 2006.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5280">[RFC5280]</b></td>
<td class="top">
<a>Cooper, D.</a>, <a>Santesson, S.</a>, <a>Farrell, S.</a>, <a>Boeyen, S.</a>, <a>Housley, R.</a> and <a>W. Polk</a>, "<a href="http://tools.ietf.org/html/rfc5280">Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>", RFC 5280, May 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5698">[RFC5698]</b></td>
<td class="top">
<a>Kunz, T.</a>, <a>Okunick, S.</a> and <a>U. Pordesch</a>, "<a href="http://tools.ietf.org/html/rfc5698">Data Structure for the Security Suitability of Cryptographic Algorithms (DSSC)</a>", RFC 5698, November 2009.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5785">[RFC5785]</b></td>
<td class="top">
<a>Nottingham, M.</a> and <a>E. Hammer-Lahav</a>, "<a href="http://tools.ietf.org/html/rfc5785">Defining Well-Known Uniform Resource Identifiers (URIs)</a>", RFC 5785, April 2010.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">6.2.</a> Non Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC3642">[RFC3642]</b></td>
<td class="top">
<a>Legg, S.</a>, "<a href="http://tools.ietf.org/html/rfc3642">Common Elements of Generic String Encoding Rules (GSER) Encodings</a>", RFC 3642, October 2003.</td>
</tr>
<tr>
<td class="reference"><b id="NIST-ALGS">[NIST-ALGS]</b></td>
<td class="top">
<a>National Institute of Standards and Technology </a>, "<a>Cryptographic Algorithm Registration</a>", March 2009.</td>
</tr>
</tbody></table>
<h1 id="rfc.appendix.Appendix A">
<a href="#rfc.appendix.Appendix%20A">Appendix A.</a> Test Vectors</h1>
<h1 id="rfc.appendix.Appendix A.1">
<a href="#rfc.appendix.Appendix%20A.1">Appendix A.1.</a> Example: Hello World !</h1>
<p id="rfc.section.Appendix A.1.p.1">The Digest URI of the text file "Hello World !" is computed as follows: </p>
<p></p>

<ul class="empty">
<li>Scheme  <samp>di</samp> </li>
<li>Algorithm Identifier: <samp>sha-256</samp> </li>
<li>sha-256 ("Hello World !") <samp>07 f2 bd ef  34 ed 16 e3  a1 ba 0d bb  7e 47 b8 fd 98 1c e0 cc  b3 e1 bf e5  64 d8 2c 42  3c ba 7e 47 </samp> </li>
<li>BASE64URI (sha-256 ("Hello World !")): <samp>B_K97zTtFuOhug27fke4_Zgc4Myz4b_lZNgsQjy6fkc </samp> </li>
<li>Content Type Parameter 'text/plain'  <samp>ct=text/plain</samp> </li>
</ul>

<p> </p>
<p id="rfc.section.Appendix A.1.p.3">Depending on the context, the digest URI MAY be specified using the digest value alone or the digest valur plus content type parameter: </p>
<p id="rfc.section.Appendix A.1.p.4">di:sha-256:B_K97zTtFuOhug27fke4_Zgc4Myz4b_lZNgsQjy6fkc </p>
<p id="rfc.section.Appendix A.1.p.5">di:sha-256:B_K97zTtFuOhug27fke4_Zgc4Myz4b_lZNgsQjy6fkc?ct=text/plain </p>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Phillip Hallam-Baker</span> 
	  <span class="n hidden">
		<span class="family-name">Hallam-Baker</span>
	  </span>
	</span>
	<span class="org vcardline">Comodo Group Inc.</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:philliph@comodo.com">philliph@comodo.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Rob Stradling</span> 
	  <span class="n hidden">
		<span class="family-name">Stradling</span>
	  </span>
	</span>
	<span class="org vcardline">Comodo CA Ltd.</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:rob.stradling@comodo.com">rob.stradling@comodo.com</a></span>

  </address>
</div>

</body>
</html>