<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Forcerenew Nonce Authentication</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.2" rel="Chapter" title="2 Requirements Language">
<link href="#rfc.section.3" rel="Chapter" title="3 Message authentication">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 Forcerenew Nonce Authentication ">
<link href="#rfc.section.3.1.1" rel="Chapter" title="3.1.1 Forcerenew Nonce Protocol Capability Option ">
<link href="#rfc.section.3.1.2" rel="Chapter" title="3.1.2 Forcerenew Nonce Protocol">
<link href="#rfc.section.3.1.3" rel="Chapter" title="3.1.3 Server considerations for Forcerenew Nonce Authentication ">
<link href="#rfc.section.3.1.4" rel="Chapter" title="3.1.4 Client considerations for Forcerenew Nonce Authentication">
<link href="#rfc.section.4" rel="Chapter" title="4 Acknowledgements">
<link href="#rfc.section.5" rel="Chapter" title="5 IANA Considerations">
<link href="#rfc.section.6" rel="Chapter" title="6 Security Considerations">
<link href="#rfc.section.6.1" rel="Chapter" title="6.1 Protocol vulnerabilities">
<link href="#rfc.references" rel="Chapter" title="7 References">
<link href="#rfc.references.1" rel="Chapter" title="7.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="7.2 Informative References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="DHCP Forcerenew allows for the reconfiguration of a single host by forcing the DHCP client into a Renew state on a trigger from the DHCP server. In Forcerenew Nonce Authentication the server exchanges a nonce with the client on the initial DHCP ACK that is used for subsequent validation of a Forcerenew message." />
  <meta name="description" content="DHCP Forcerenew allows for the reconfiguration of a single host by forcing the DHCP client into a Renew state on a trigger from the DHCP server. In Forcerenew Nonce Authentication the server exchanges a nonce with the client on the initial DHCP ACK that is used for subsequent validation of a Forcerenew message." />
  <meta name="keywords" content="" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">softwire</td>
<td class="right">D. Miles</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Alcatel-Lucent</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">W. Dec</td>
</tr>
<tr>
<td class="left">Expires: September 11, 2011</td>
<td class="right">Cisco Systems</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">J. Bristow</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Swisscom Schweiz AG</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">R. Maglione</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Telecom Italia</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">March 10, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Forcerenew Nonce Authentication<br />
  <span class="filename">draft-ietf-dhc-forcerenew-nonce-01</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>DHCP Forcerenew allows for the reconfiguration of a single host by forcing the DHCP client into a Renew state on a trigger from the DHCP server. In Forcerenew Nonce Authentication the server exchanges a nonce with the client on the initial DHCP ACK that is used for subsequent validation of a Forcerenew message.</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on September 11, 2011.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>
<p>This document may contain material from IETF Documents or IETF Contributions published or made publicly available before November 10, 2008.  The person(s) controlling the copyright in some of this material may not have granted the IETF Trust the right to allow modifications of such material outside the IETF Standards Process. Without obtaining an adequate license from the person(s) controlling the copyright in such materials, this document may not be modified outside the IETF Standards Process, and derivative works of it may not be created outside the IETF Standards Process, except to format it for publication as an RFC or to translate it into languages other than English.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>2.   <a href="#rfc.section.2">Requirements Language</a>
</li>
<li>3.   <a href="#rfc.section.3">Message authentication</a>
</li>
<li>3.1.   <a href="#rfc.section.3.1">Forcerenew Nonce Authentication </a>
</li>
<li>3.1.1.   <a href="#rfc.section.3.1.1">Forcerenew Nonce Protocol Capability Option </a>
</li>
<li>3.1.2.   <a href="#rfc.section.3.1.2">Forcerenew Nonce Protocol</a>
</li>
<li>3.1.3.   <a href="#rfc.section.3.1.3">Server considerations for Forcerenew Nonce Authentication </a>
</li>
<li>3.1.4.   <a href="#rfc.section.3.1.4">Client considerations for Forcerenew Nonce Authentication</a>
</li>
<li>4.   <a href="#rfc.section.4">Acknowledgements</a>
</li>
<li>5.   <a href="#rfc.section.5">IANA Considerations</a>
</li>
<li>6.   <a href="#rfc.section.6">Security Considerations</a>
</li>
<li>6.1.   <a href="#rfc.section.6.1">Protocol vulnerabilities</a>
</li>
<li>7.   <a href="#rfc.references">References</a>
</li>
<li>7.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>7.2.   <a href="#rfc.references.2">Informative References</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> <a href="#intro" id="intro">Introduction</a>
</h1>
<p id="rfc.section.1.p.1">The DHCP Reconfigure Extension defined in <a href="#RFC3203">[RFC3203]</a> is a useful mechanism allowing dynamic reconfiguration of a single host triggered by the DHCP server. Its application is currently limited by a requirement that FORCERENEW message is always authenticated using procedures as described in <a href="#RFC3118">[RFC3118]</a>. Authentication for DHCP <a href="#RFC3118">[RFC3118]</a> is mandatory for Forcerenew, however as it is currently defined <a href="#RFC3118">[RFC3118]</a> requires distribution of constant token or shared-secret out-of-band to DHCP clients. The mandatory authentication was originally motivated by a legitimate security concern whereby in some network environments a FORCERENEW message can be spoofed. However, in some networks native security mechanisms already provide sufficient protection against spoofing of DHCP traffic. An example of such network is a DSL Forum TR-101 <a href="#TR-101">[TR-101]</a> compliant access network. In such environments the mandatory coupling between FORCERENEW and DHCP Authentication <a href="#RFC3118">[RFC3118]</a> can be relaxed. This document defines extensions to Authentication for DHCP(v4) Messages <a href="#RFC3118">[RFC3118]</a> to create a new authentication protocol for DHCPv4 Forcerenew <a href="#RFC3203">[RFC3203]</a> messages; this method does not require out-of-band key distribution to DHCP clients. The Forcerenew Nonce is exchanged between server and client on initial DHCP ACK and is used for verification of any subsequent Forcerenew message.</p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> <a href="#term" id="term">Requirements Language</a>
</h1>
<p id="rfc.section.2.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">[RFC2119]</a>.</p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> Message authentication</h1>
<p id="rfc.section.3.p.1">The FORCERENEW message must be authenticated using either <a href="#RFC3118">[RFC3118]</a> or the proposed Forcerenew Nonce Authentication protocol.</p>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> Forcerenew Nonce Authentication </h1>
<p id="rfc.section.3.1.p.1">The Forcerenew nonce authentication protocol provides protection against misconfiguration of a client caused by a Forcerenew message sent by a malicious DHCP server. In this protocol, a DHCP server sends a Forcerenew nonce to the client in the initial exchange of DHCP messages. The client records the Forcerenew nonce for use in authenticating subsequent Forcerenew messages from that server. The server then includes an HMAC computed from the Forcerenew nonce in subsequent Forcerenew messages.</p>
<p id="rfc.section.3.1.p.2">Both the Forcerenew nonce sent from the server to the client and the HMAC in subsequent Forcerenew messages are carried as the Authentication information in a DHCP Authentication option. The format of the Authentication information is defined in the following section.</p>
<p id="rfc.section.3.1.p.3">The Forcerenew nonce protocol is used (initiated by the server) only if the client and server are not using any other authentication protocol and the client and server have negotiated to use the Forcerenew Nonce Authentication protocol.</p>
<h1 id="rfc.section.3.1.1">
<a href="#rfc.section.3.1.1">3.1.1.</a> Forcerenew Nonce Protocol Capability Option </h1>
<p id="rfc.section.3.1.1.p.1">A DHCP client indicates DHCP Forcerenew Nonce Protocol capability by including a FORCERENEW_NONCE_CAPABLE(&lt;TBD&gt;) option in DHCP Discover and Request messages sent to the server.</p>
<p id="rfc.section.3.1.1.p.2">A DHCP server that does not support Forcerenew Nonce Protocol authentication should ignore the FORCERENEW_NONCE_CAPABLE(&lt;TBD&gt;) option. A DHCP server indicates DHCP Forcerenew Nonce Protocol preference by including a FORCERENEW_NONCE_CAPABLE(&lt;TBD&gt;) option in any DHCP Offer messages sent to the client.</p>
<p id="rfc.section.3.1.1.p.3">A DHCP client MUST NOT send DHCP messages with authentication options where the protocol value is Forcerenew Nonce Authentication(&lt;TBD&gt;).</p>
<p id="rfc.section.3.1.1.p.4">The FORCERENEW_NONCE_CAPABLE option is a zero length option with code of &lt;TDB&gt; and format as follows:</p>
<div id="#rfc.figure.1"></div>
<p></p>
<pre>          Code   Len
         +-----+-----+
         | TBD |  0  |
         +-----+-----+
</pre>
<p></p>
<p></p>
<p id="rfc.section.3.1.1.p.6">The client would indicate that it supports the functionality by inserting the FORCERENEW_NONCE_CAPABLE option in the DHCP Discover and Request messages. If the server supports Forcerenew nonce authentication and is configured to require Forcerenew nonce authentication, it will insert the FORCERENEW_NONCE_CAPABLE option in the DHCP Offer message.</p>
<div id="#rfc.figure.2"></div>
<p></p>
<pre>                   Server          Client          Server
               (not selected)                    (selected)

                     v               v               v
                     |               |               |
                     |     Begins initialization     |
                     |               |               |
                     | _____________/|\____________  |
                     |/DHCPDISCOVER  | DHCPDISCOVER \|
                     | w/Forcerenew- | w/Forcerenew- |
                     | Nonce-Capable | Nonce-Capable |
                     |               |               |
                 Determines          |          Determines
                configuration        |         configuration
                     |               |               |
                     |\              |              /|
                     | \__________   |    _________/ |
                     |  DHCPOFFER \  |   /DHCPOFFER  |
                     |w/Forcerenew \ |  /w/Forcerenew|
                     |Nonce-Capable \| /Nonce-Capable|
                     |               |               |
                     |       Collects replies        |
                     |               |               |
                     |     Selects configuration     |
                     |               |               |
                     | _____________/|\____________  |
                     |/ DHCPREQUEST  |  DHCPREQUEST\ |
                     | w/Forcerenew- | w/Forcerenew- |
                     | Nonce-Capable | Nonce-Capable |
                     |               |               |
                     |               |     Commits configuration
                     |               |               |
                     |               |Creates 128-bit Forcerenew Nonce
                     |               |               |
                     |               | _____________/|
                     |               |/ DHCPACK      |
                     |               | w/Auth-Proto= |
                     |               | Forcerenew-   |
                     |               |        Nonce  |
                     |               |               |
                     |Client stores Forcerenew Nonce |
                     |               |               |
                     |    Initialization complete    |
                     |               |               |
                     .               .               .
                     .               .               .
                     |               |               |
                     |          Forcerenew           |
                     |               | _____________/|
                     |               |/ DHCPFORCE    |
                     |               | w/Auth-Proto= |
                     |               | Forcerenew-   |
                     |               |   Digest(HMAC)|
                     |               |               |
                     | Client checks HMAC digest     |
                     | using stored Forcerenew Nonce |
                     |               |               |
                     |               |\____________  |
                     |               |  DHCPREQUEST\ |
                     |               | w/Forcerenew- |
                     |               | Nonce-Capable |
                     |               |               |
                     |               |     Commits configuration
                     |               |               |
                     |               |Creates 128-bit Forcerenew Nonce
                     |               |               |
                     |               | _____________/|
                     |               |/ DHCPACK      |
                     |               | w/Auth-Proto= |
                     |               |   Forcerenew- |
                     |               |         Nonce |
                     |               |               |
                     |               |               |
                     |               |               |
                     .               .               .
                     .               .               .
                     |               |               |
                     |      Graceful shutdown        |
                     |               |               |
                     |               |\ ____________ |
                     |               | DHCPRELEASE  \|
                     |               |               |
                     |               |        Discards lease
                     |               |               |
                     v               v               v

</pre>
<p></p>
<h1 id="rfc.section.3.1.2">
<a href="#rfc.section.3.1.2">3.1.2.</a> Forcerenew Nonce Protocol</h1>
<p><a href="#RFC3118">[RFC3118]</a> defined an extensible DHCPv4 authentication option which supports multiple protocols. The Forcerenew Nonce Protocol makes use of the DHCP authentication option defined in <a href="#RFC3118">[RFC3118]</a> re-using the option format.</p>
<p id="rfc.section.3.1.2.p.2">The following fields are set in an DHCP authentication option for the Forcerenew Nonce Authentication Protocol:</p>
<p></p>

<dl>
<dt></dt>
<dd style="margin-left: 5">protocol &lt;TBD (IANA)&gt;</dd>
<dt></dt>
<dd style="margin-left: 5"></dd>
<dt></dt>
<dd style="margin-left: 5">algorithm 1</dd>
<dt></dt>
<dd style="margin-left: 5"></dd>
<dt></dt>
<dd style="margin-left: 5">RDM 0</dd>
<dt></dt>
<dd style="margin-left: 5"></dd>
</dl>

<p>The format of the Authentication information for the Forcerenew Nonce Authentication Protocol is:</p>
<div id="#rfc.figure.3"></div>
<p></p>
<pre>        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |     Type      |                 Value (128 bits)              |
       +-+-+-+-+-+-+-+-+                                               |
       .                                                               .
       .                                                               .
       .                                               +-+-+-+-+-+-+-+-+
       |                                               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</pre>
<p></p>
<p></p>

<dl>
<dt>Type</dt>
<dd style="margin-left: 5">Type of data in Value field carried in this option:</dd>
<dt></dt>
<dd style="margin-left: 5"></dd>
<dt></dt>
<dd style="margin-left: 5">1 Forcerenew Nonce value (used in ACK message)</dd>
<dt></dt>
<dd style="margin-left: 5"></dd>
<dt></dt>
<dd style="margin-left: 5">2 HMAC-MD5 digest of the message (FORCERENEW message)</dd>
<dt></dt>
<dd style="margin-left: 5"></dd>
<dt>Value</dt>
<dd style="margin-left: 5">Data as defined by field</dd>
</dl>
<h1 id="rfc.section.3.1.3">
<a href="#rfc.section.3.1.3">3.1.3.</a> Server considerations for Forcerenew Nonce Authentication </h1>
<p id="rfc.section.3.1.3.p.1">The use of Forcerenew Nonce Protocol is dependent on the client indicating its capability through the FORCERENEW_NONCE_CAPABLE(&lt;TBD&gt;) DHCP option in any DHCP Discover or Request messages. The DHCP Discovery or Request message from the client MUST contain the FORCERENEW_NONCE_CAPABLE(&lt;TBD&gt;) option if the Forcerenew Nonce Protocol is to be used by the server. The absence of the FORCERENEW_NONCE_CAPABLE(&lt;TBD&gt;) option indicates to the server that the Forcerenew Nonce Authentication protocol is not supported and thus the server MUST NOT include a Forcerenew Nonce Protocol Authentication option in the DHCP Ack.</p>
<p id="rfc.section.3.1.3.p.2">The server indicates its support of the Forcerenew Nonce Protocol authentication by including the DHCP FORCERENEW_NONCE_CAPABLE(&lt;TBDP&gt;) option in the DHCP Offer message. The server SHOULD NOT include this option unless the client has indicated its capability in a DHCP Discovery message . The presence of the FORCERENEW_NONCE_CAPABLE(&lt;TDB&gt;) option in the DHCP offer may be used by clients to prefer Forcerenew nonce Protocol authentication-capable DHCP servers over those servers which do not support such capability.</p>
<p id="rfc.section.3.1.3.p.3">The server selects a Forcerenew nonce for a client only during Request/Ack message exchange. The server records the Forcerenew nonce and transmits that nonce to the client in an Authentication option in the DHCP Ack message.</p>
<p id="rfc.section.3.1.3.p.4">The Forcerenew nonce is 128 bits long, and MUST be a cryptographically strong random or pseudo-random number that cannot easily be predicted. The nonce is imbedded as a 128-bit value of the Authentication information where type is set to 1 (Forcerenew nonce Value).</p>
<p id="rfc.section.3.1.3.p.5">To provide authentication for a Forcerenew message, the server selects a replay detection value according to the RDM selected by the server, and computes an HMAC-MD5 of the Forcerenew message using the Forcerenew nonce for the client. The server computes the HMAC-MD5 over the entire DHCP Forcerenew message, including the Authentication option; the HMAC-MD5 field in the Authentication option is set to zero for the HMAC-MD5 computation. The server includes the HMAC-MD5 in the authentication information field in an Authentication option included in the Forcerenew message sent to the client with type set to 2 (HMAC-MD5 digest).</p>
<h1 id="rfc.section.3.1.4">
<a href="#rfc.section.3.1.4">3.1.4.</a> Client considerations for Forcerenew Nonce Authentication</h1>
<p id="rfc.section.3.1.4.p.1">The client MUST indicate Forcerenew nonce Capability by including the FORCERENEW_NONCE_CAPABLE(&lt;TBD&gt;) DHCP option (Section 2.1.1) in all DHCP Discover and Request messages. DHCP servers that support Forcerenew nonce Protocol authentication MUST include the DHCP Forcerenew Nonce protocol authentication option in DHCP Offers with type set to zero(0), allowing the client to use this capability in selecting DHCP servers should multiple Offers arrive.</p>
<p id="rfc.section.3.1.4.p.2">A DHCP server has indicates its support through the inclusion of the FORCERENEW_NONCE_CAPABLE(&lt;TBD&gt;) option in the DHCP Offer.  The client MUST validate the DHCP Ack message contains a Forcerenew Nonce in a DHCP authentication option. If the server has indicated capability for Forcerenew Nonce Protocol authentication in the DHCP Offer and a subsequent Ack omits a valid DHCP authentication option for the Forcerenew Nonce Protocol, the client MUST send a DHCP Decline message and return to the DHCP Init state.</p>
<p id="rfc.section.3.1.4.p.3">The client will receive a Forcerenew Nonce from the server in the initial DHCP Ack message from the server. The client records the Forcerenew Nonce for use in authenticating subsequent Forcerenew messages.</p>
<p id="rfc.section.3.1.4.p.4">To authenticate a Forcerenew message, the client computes an HMAC-MD5 over the DHCP Forcerenew message, using the Forcerenew Nonce received from the server. If this computed HMAC-MD5 matches the value in the Authentication option, the client accepts the Forcerenew message.</p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#contr" id="contr">Acknowledgements</a>
</h1>
<p id="rfc.section.4.p.1">Comments are solicited and should be addressed to the DHC WG mailing list (dhcwg@ietf.org) and/or the authors. This contribution is based on work by Vitali Vinokour. Major sections of this draft use modified text from [RFC3315]. The authors wish to thank Ted Lemon and Bernie Volz for their support.</p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#seccons" id="seccons">IANA Considerations</a>
</h1>
<p id="rfc.section.5.p.1">This document requests IANA to allocate an option code for the newly defined DHCP option FORCERENEW_NONCE_CAPABALE as described in the text.</p>
<p id="rfc.section.5.p.2">This document requests IANA to allocate a DHCP Authentication Option(90) protocol number be assigned for Forcerenew Nonce Authentication, per <a href="#RFC3118">[RFC3118]</a>.</p>
<p id="rfc.section.5.p.3">This document requests IANA to create a new namespace associated with the Forcerenew Nonce Authentication protocol: algorithm, per <a href="#RFC3118">[RFC3118]</a>.</p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#IANA" id="IANA">Security Considerations</a>
</h1>
<p id="rfc.section.6.p.1">As in some network environments FORCERENEW can be used to snoop and spoof traffic, the FORCERENEW message MUST be authenticated using the procedures as described in <a href="#RFC3118">[RFC3118]</a> or this proposal. In this proposal any party able intercept the nonce exchange could impersonate a server and thus offers no protection from man-in-the- middle attacks. FORCERENEW messages failing the authentication should be silently discarded by the client.</p>
<h1 id="rfc.section.6.1">
<a href="#rfc.section.6.1">6.1.</a> Protocol vulnerabilities</h1>
<p id="rfc.section.6.1.p.1">The mechanism described in this document is vulnerable to a denial of service attack through flooding a client with bogus FORCERENEW messages. The calculations involved in authenticating the bogus FORECERENEW messages may overwhelm the device on which the client is running.</p>
<p id="rfc.section.6.1.p.2">The mechanism described provides protection against the use of a FORCERENEW message by a malicious DHCP server to mount a denial of service or man-in-the-middle attack on a client. This protocol can be compromised by an attacker that can intercept the initial message in which the DHCP server sends the nonce to the client.</p>
<h1 id="rfc.references">
<a href="#rfc.references">7.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">7.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3118">[RFC3118]</b></td>
<td class="top">
<a>Droms, R.</a> and <a>W. Arbaugh</a>, "<a href="http://tools.ietf.org/html/rfc3118">Authentication for DHCP Messages</a>", RFC 3118, June 2001.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3203">[RFC3203]</b></td>
<td class="top">
<a>T'Joens, Y.</a>, <a>Hublet, C.</a> and <a>P. De Schrijver</a>, "<a href="http://tools.ietf.org/html/rfc3203">DHCP reconfigure extension</a>", RFC 3203, December 2001.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">7.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="TR-101">[TR-101]</b></td>
<td class="top">
<a>Cohen et al, </a>, "<a>Architecture &amp; Transport: "Migration to Ethernet Based DSL Aggregation, DSL Forum TR-101</a>", 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3315">[RFC3315]</b></td>
<td class="top">
<a>Droms, R.</a>, <a>Bound, J.</a>, <a>Volz, B.</a>, <a>Lemon, T.</a>, <a>Perkins, C.</a> and <a>M. Carney</a>, "<a href="http://tools.ietf.org/html/rfc3315">Dynamic Host Configuration Protocol for IPv6 (DHCPv6)</a>", RFC 3315, July 2003.</td>
</tr>
</tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">David Miles</span> 
	  <span class="n hidden">
		<span class="family-name">Miles</span>
	  </span>
	</span>
	<span class="org vcardline">Alcatel-Lucent</span>
	<span class="adr">
	  <span>L3 / 215 Spring St</span>

	  <span class="vcardline">
		<span class="locality">Melbourne, Victoria 3000</span>,  
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline">Australia</span>
	</span>
	<span class="vcardline">Phone: +61 3 9664 3308</span>

<span class="vcardline">EMail: <a href="mailto:david.miles@alcatel-lucent.com">david.miles@alcatel-lucent.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Wojciech Dec </span> 
	  <span class="n hidden">
		<span class="family-name">Dec</span>
	  </span>
	</span>
	<span class="org vcardline">Cisco Systems</span>
	<span class="adr">
	  <span>Haarlerbergpark Haarlerbergweg 13-19</span>

	  <span class="vcardline">
		<span class="locality">Amsterdam</span>,  
		<span class="region">NOORD-HOLLAND</span> 
		<span class="code">1101 CH</span>
	  </span>
	  <span class="country-name vcardline">Netherlands</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:wdec@cisco.com">wdec@cisco.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">James Bristow</span> 
	  <span class="n hidden">
		<span class="family-name">Bristow</span>
	  </span>
	</span>
	<span class="org vcardline">Swisscom Schweiz AG</span>
	<span class="adr">
	  <span>Zentweg 9</span>

	  <span class="vcardline">
		<span class="locality">Bern, 3050</span>,  
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline">Switzerland</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:James.Bristow@swisscom.com">James.Bristow@swisscom.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Roberta Maglione</span> 
	  <span class="n hidden">
		<span class="family-name">Maglione</span>
	  </span>
	</span>
	<span class="org vcardline">Telecom Italia</span>
	<span class="adr">
	  <span>Via Reiss Romoli 274</span>

	  <span class="vcardline">
		<span class="locality">Torino</span>,  
		<span class="region"></span>
		<span class="code">10148</span>
	  </span>
	  <span class="country-name vcardline">Italy</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:roberta.maglione@telecomitalia.it">roberta.maglione@telecomitalia.it</a></span>

  </address>
</div>

</body>
</html>