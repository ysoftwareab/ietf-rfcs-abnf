<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>LISP Security Threats</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="LISP Security Threats">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 60em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 60em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">D. Saucez</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Universite catholique de Louvain</td></tr>
<tr><td class="header">Intended status: Informational</td><td class="header">L. Iannone</td></tr>
<tr><td class="header">Expires: January 13, 2011</td><td class="header">TU Berlin - Deutsche Telekom</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Laboratories AG</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">O. Bonaventure</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Universite catholique de Louvain</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">July 12, 2010</td></tr>
</table></td></tr></table>
<h1><br />LISP Security Threats<br />draft-saucez-lisp-security-01</h1>

<h3>Abstract</h3>

<p>This draft analyses some of the threats against the security of
    the Locator/Identifier Separation Protocol and proposes a set of
    recommendations to mitigate some of the identified security risks.
    
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted  in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF).  Note that other groups may also distribute
working documents as Internet-Drafts.  The list of current
Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
This Internet-Draft will expire on January 13, 2011.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the Simplified BSD License.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Requirements notation<br />
<a href="#anchor2">2.</a>&nbsp;
Introduction<br />
<a href="#anchor3">3.</a>&nbsp;
Definition of Terms<br />
<a href="#refenv">4.</a>&nbsp;
Reference Environment<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">4.1.</a>&nbsp;
On-path Attackers<br />
<a href="#anchor5">5.</a>&nbsp;
Data-Plane Threats<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">5.1.</a>&nbsp;
LISP-Database Threats<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#lc-threats">5.2.</a>&nbsp;
LISP-Cache Threats<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#lc-poison">5.2.1.</a>&nbsp;
LISP-Cache poisoning<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#lc-oflow">5.2.2.</a>&nbsp;
LISP-Cache overflow<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#nolispatk">5.3.</a>&nbsp;
Attacks not leveraging on the LISP header<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#lispatk">5.4.</a>&nbsp;
Attacks leveraging on the LISP header<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">5.4.1.</a>&nbsp;
Attacks using the Locator Status Bits<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#veratk">5.4.2.</a>&nbsp;
Attacks using the Map-Version bit<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">5.4.3.</a>&nbsp;
Attacks using the Nonce-Present and the Echo-Nonce bits<br />
<a href="#cp-threats">6.</a>&nbsp;
Control Plane Threats<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#mapreqatk">6.1.</a>&nbsp;
Attacks with Map-Request messages<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#mapreply">6.2.</a>&nbsp;
Attacks with Map-Reply messages<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#gleaning">6.3.</a>&nbsp;
Gleaning Attacks<br />
<a href="#malicious">7.</a>&nbsp;
Threats with Malicious xTRs<br />
<a href="#alt">8.</a>&nbsp;
Security of the ALT Mapping System<br />
<a href="#anchor9">9.</a>&nbsp;
Discussion<br />
<a href="#docstatus">10.</a>&nbsp;
Document Status and Plans<br />
<a href="#anchor10">11.</a>&nbsp;
IANA Considerations<br />
<a href="#anchor11">12.</a>&nbsp;
Security Considerations<br />
<a href="#ack">13.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">14.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">14.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">14.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Requirements notation</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL",
    "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY",
    and "OPTIONAL" in this document are to be interpreted as
    described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Introduction</h3>

<p>The Locator/ID Separation Protocol (LISP) is defined in 
    <a class='info' href='#I-D.ietf-lisp'>[I&#8209;D.ietf&#8209;lisp]<span> (</span><span class='info'>Farinacci, D., Fuller, V., Meyer, D., and D. Lewis, &ldquo;Locator/ID Separation Protocol (LISP),&rdquo; April&nbsp;2010.</span><span>)</span></a>. The present document aims at
    identifying threats in the current LISP specification. We also
    propose some recommendations on mechanisms that could improve the
    security of LISP against off-path attackers. This document builds
    upon <a class='info' href='#I-D.bagnulo-lisp-threat'>[I&#8209;D.bagnulo&#8209;lisp&#8209;threat]<span> (</span><span class='info'>Bagnulo, M., &ldquo;Preliminary LISP Threat Analysis,&rdquo; July&nbsp;2007.</span><span>)</span></a>. 
    
</p>
<p> This document is split in two main parts. The first discusses
    the LISP data-plane and the second the LISP control-plane. 
    
</p>
<p> The LISP data-plane consists of LISP packet encapsulation,
    decapsulation, and forwarding and includes the LISP-Cache and
    LISP-Database data structures used to perform these operations.
    
</p>
<p> The LISP control-plane consists in the mapping distribution
    system, which can be one of the mapping distribution systems
    proposed so far (e.g., <a class='info' href='#I-D.ietf-lisp'>[I&#8209;D.ietf&#8209;lisp]<span> (</span><span class='info'>Farinacci, D., Fuller, V., Meyer, D., and D. Lewis, &ldquo;Locator/ID Separation Protocol (LISP),&rdquo; April&nbsp;2010.</span><span>)</span></a>, 
    <a class='info' href='#I-D.ietf-lisp-alt'>[I&#8209;D.ietf&#8209;lisp&#8209;alt]<span> (</span><span class='info'>Fuller, V., Farinacci, D., Meyer, D., and D. Lewis, &ldquo;LISP Alternative Topology (LISP+ALT),&rdquo; April&nbsp;2010.</span><span>)</span></a>, 
    <a class='info' href='#I-D.ietf-lisp-ms'>[I&#8209;D.ietf&#8209;lisp&#8209;ms]<span> (</span><span class='info'>Fuller, V. and D. Farinacci, &ldquo;LISP Map Server,&rdquo; April&nbsp;2010.</span><span>)</span></a>,
    <a class='info' href='#I-D.meyer-lisp-cons'>[I&#8209;D.meyer&#8209;lisp&#8209;cons]<span> (</span><span class='info'>Brim, S., &ldquo;LISP-CONS: A Content distribution Overlay Network Service for LISP,&rdquo; April&nbsp;2008.</span><span>)</span></a>, and 
    <a class='info' href='#I-D.lear-lisp-nerd'>[I&#8209;D.lear&#8209;lisp&#8209;nerd]<span> (</span><span class='info'>Lear, E., &ldquo;NERD: A Not-so-novel EID to RLOC Database,&rdquo; March&nbsp;2010.</span><span>)</span></a>), and the Map-Request
    and Map-Reply messages.
    
</p>
<p> This document does not consider all the possible utilizations
    of LISP as discussed in <a class='info' href='#I-D.ietf-lisp'>[I&#8209;D.ietf&#8209;lisp]<span> (</span><span class='info'>Farinacci, D., Fuller, V., Meyer, D., and D. Lewis, &ldquo;Locator/ID Separation Protocol (LISP),&rdquo; April&nbsp;2010.</span><span>)</span></a>. In the
    current version, we focus on LISP unicast and briefly consider the
    ALT mapping system described <a class='info' href='#I-D.ietf-lisp-alt'>[I&#8209;D.ietf&#8209;lisp&#8209;alt]<span> (</span><span class='info'>Fuller, V., Farinacci, D., Meyer, D., and D. Lewis, &ldquo;LISP Alternative Topology (LISP+ALT),&rdquo; April&nbsp;2010.</span><span>)</span></a>.
    Later versions of this document will include a deeper analysis of
    the ALT mapping system, as well as the analysis of the security
    issues in multicast LISP 
    (<a class='info' href='#I-D.ietf-lisp-multicast'>[I&#8209;D.ietf&#8209;lisp&#8209;multicast]<span> (</span><span class='info'>Farinacci, D., Meyer, D., Zwiebel, J., and S. Venaas, &ldquo;LISP for Multicast Environments,&rdquo; April&nbsp;2010.</span><span>)</span></a>), interworking between
    LISP and the legacy IPv4 and IPv6 Internet 
    (<a class='info' href='#I-D.ietf-lisp-interworking'>[I&#8209;D.ietf&#8209;lisp&#8209;interworking]<span> (</span><span class='info'>Lewis, D., Meyer, D., Farinacci, D., and V. Fuller, &ldquo;Interworking LISP with IPv4 and IPv6,&rdquo; May&nbsp;2009.</span><span>)</span></a>), and LISP-MS 
    (<a class='info' href='#I-D.ietf-lisp-ms'>[I&#8209;D.ietf&#8209;lisp&#8209;ms]<span> (</span><span class='info'>Fuller, V. and D. Farinacci, &ldquo;LISP Map Server,&rdquo; April&nbsp;2010.</span><span>)</span></a>).
    
</p>
<p> Furthermore, here we assume a generic IP service and do not
    discuss the difference from a security viewpoint between using
    IPv4 or IPv6.
    
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Definition of Terms</h3>

<p> The present document does not introduce any new term, compared
    to the main LISP specification. For a complete list of terms
    please refer to <a class='info' href='#I-D.ietf-lisp'>[I&#8209;D.ietf&#8209;lisp]<span> (</span><span class='info'>Farinacci, D., Fuller, V., Meyer, D., and D. Lewis, &ldquo;Locator/ID Separation Protocol (LISP),&rdquo; April&nbsp;2010.</span><span>)</span></a>.
    
</p>
<a name="refenv"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Reference Environment</h3>

<p>Throughout this document we consider the reference environment
    shown in the figure below. There are two hosts attached to LISP
    routers: HA and HB. HA is attached to LISP xTR LR1 and LR2 that
    are attached to two different ISPs. HB is attached to LISP xTR LR3
    and LR4. HA and HB are the EIDs of the two hosts. LR1, LR2, LR3
    and LR4 are the RLOCs of the xTRs.
    
</p><br /><hr class="insert" />
<a name="net1"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
              +----+
              | HA |
              +----+
                 | EID: HA
                 |
             -----------------
                 |        |
              +----+    +----+
              |LR1 |    |LR2 |
              +----+    +----+
                |          |
                |          |
              +----+     +----+
              |ISP1|     |ISP2|
              +----+     +----+      +----+
                 |          |     +--| SA |
              +----------------+  |  +----+
              |                |--+
              |    Internet    |     +----+
              |                |-----| NSA|
              +----------------+     +----+
                 |         |
                 |         |
              +----+     +----+
              |LR3 |     | LR4|
              +----+     +----+
                 |           |
             -------------------
                       |
                       | EID: HB
                     +---+
                     | HB|
                     +---+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: Reference Network&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p> We consider two off-path attackers with different
    capabilities:
    </p>
<blockquote class="text"><dl>
<dt>SA</dt>
<dd>
	is an off-path attacker that is able to send spoofed packets,
	i.e., packets with a different source IP address than its
	assigned IP address. 
      
</dd>
<dt>NSA</dt>
<dd>
	is an off-path attacker that is only able to send packets
	whose source address is its assigned IP address. 
      
</dd>
</dl></blockquote><p>
    
</p>
<p> It should be noted that with LISP, packet spoofing is slightly
    different than in the current Internet. Generally the term
    "spoofed packet" indicates a packet containing a source IP address
    which is not the one of the actual originator of the packet. Since
    LISP uses encapsulation, this translates in two types of spoofing: 
    </p>
<blockquote class="text"><dl>
<dt>EID Spoofing:</dt>
<dd> 
	the originator of the packet puts in it a spoofed EID. The
	packet will be normally encapsulated by the ITR of the site. 
      
</dd>
<dt>RLOC Spoofing:</dt>
<dd>
	the originator of the packet generates directly a
	LISP-encapsulated packet with a spoofed source RLOC. 
      
</dd>
</dl></blockquote><p>
    Note that the two types of spoofing are not mutually exclusive,
    rather all combinations are possible and can be used to perform
    several kind of attacks.
    
</p>
<p> In our reference environment, SA is able to perform both RLOC
    and EID spoofing while NSA can only perform EID spoofing.  Both
    attackers are capable of sending LISP encapsulated data packets
    and LISP control packets. They may also send other types of IP
    packets such as ICMP messages. We assume that both attackers 
    can query the LISP mapping system to obtain the mappings for both
    HA and HB.
    
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
On-path Attackers</h3>

<p> Besides the off-path attackers that we consider in this
      document, there are other types of attackers. On-path attackers
      are attackers that are able to capture and modify all the
      packets exchanged between an ITR and an ETR. To cope with such
      an attacker, cryptographic techniques such as those used by
      IPSec are required. We do not consider that LISP has to cope
      with such attackers. 
      
</p>
<p> Mobile IP has also considered time-shifted attacks from
      on-path attackers. A time-shifted attack is an attack where the
      attacker is temporarily on the path between two communicating
      hosts. 
      While it is on-path, the attacker sends specially crafted
      packets or modifies packets exchanged by the communicating hosts
      in order to disturb the packet flow (e.g., by performing a
      man in the middle attack). An important issue for time-shifted
      attacks is the duration of the attack once the attacker has left
      the path between the two communicating hosts. We do not consider
      time-shifted attacks in this document. 
      
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Data-Plane Threats</h3>

<p>This section discusses threats and attacks related to the
    LISP data-plane. More precisely, we discuss the operations
    of encapsulation, decapsulation, and forwarding as well as the
    content of the LISP-Cache and LISP-Database as specified in the
    original LISP document (<a class='info' href='#I-D.ietf-lisp'>[I&#8209;D.ietf&#8209;lisp]<span> (</span><span class='info'>Farinacci, D., Fuller, V., Meyer, D., and D. Lewis, &ldquo;Locator/ID Separation Protocol (LISP),&rdquo; April&nbsp;2010.</span><span>)</span></a>).
    
</p>
<p>We start considering the two main data structures of LISP,
    namely the LISP Database and the LISP Cache. Then, we look at the 
    data plane attacks that can be performed by a spoofing off-path
    attacker (SA) and discuss how they can be mitigated by the LISP
    xTRs. In this analysis, we assume that the LR1 and LR2 (resp. LR3
    and LR4) xTRs maintain a LISP Cache that contains the required
    mapping entries to allow HA and HB to exchange packets.
    
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
LISP-Database Threats</h3>

<p> The LISP Database on each xTR maintains the set of mappings
    related to the EID-Prefixes that are "behind" the xTR. Where
    "behind" means that at least one of the xTR's globally-visible IP 
    addresses is a RLOC for those EID-Prefixes.
    
</p>
<p> As described in <a class='info' href='#I-D.ietf-lisp'>[I&#8209;D.ietf&#8209;lisp]<span> (</span><span class='info'>Farinacci, D., Fuller, V., Meyer, D., and D. Lewis, &ldquo;Locator/ID Separation Protocol (LISP),&rdquo; April&nbsp;2010.</span><span>)</span></a>, the LISP
    Database content is determined by configuration. This means that
    the only way to attack this data structure is by gaining
    privileged access to the xTR. As such, it is out of the scope of
    LISP to propose any mechanism to protect routers and, hence, it is
    no further analyzed in this document.
    
</p>
<a name="lc-threats"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
LISP-Cache Threats</h3>

<p> A key component of the overall LISP architecture is the
      LISP-Cache. The LISP-Cache is the data structure that stores the
      bindings between EID and RLOC (namely the "mappings") to be used
      later on. Attacks against this data structure can happen either
      when the mappings are first installed in the cache (see also 
      <a class='info' href='#cp-threats'>Section&nbsp;6<span> (</span><span class='info'>Control Plane Threats</span><span>)</span></a>) or by corrupting (poisoning) the
      mappings already present in the cache.
      
</p>
<a name="lc-poison"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2.1"></a><h3>5.2.1.&nbsp;
LISP-Cache poisoning</h3>

<p> The content of the LISP-Cache can be poisoned by spoofing 
	LISP encapsulated packets. Example of LISP-Cache poisoning
	are: 
	</p>
<blockquote class="text"><dl>
<dt>Fake mapping:</dt>
<dd> The cache contains entirely
	  fake mappings that do not originate from an authoritative
	  mapping server. This can be achieved either through gleaning
	  as described in <a class='info' href='#gleaning'>Section&nbsp;6.3<span> (</span><span class='info'>Gleaning Attacks</span><span>)</span></a> or by attacking
	  the control-plane as described in 
	  <a class='info' href='#cp-threats'>Section&nbsp;6<span> (</span><span class='info'>Control Plane Threats</span><span>)</span></a>. 
	  
</dd>
<dt>EID Poisoning:</dt>
<dd> The EID-Prefix in a specific  
	  mapping is not owned by the originator of the entry.
	  Similarly to the previous case, this can be achieved either
	  through gleaning as described in <a class='info' href='#gleaning'>Section&nbsp;6.3<span> (</span><span class='info'>Gleaning Attacks</span><span>)</span></a>
	  or by attacking the control-plane as described in  
	  <a class='info' href='#cp-threats'>Section&nbsp;6<span> (</span><span class='info'>Control Plane Threats</span><span>)</span></a>.  
	  
</dd>
<dt>EID redirection/RLOC poisoning:</dt>
<dd> The
	  EID-Prefix in the mapping is not bound to (located by) the
	  set of RLOCs present in the mapping. This can result in
	  packets being redirected elsewhere, eavesdropped, or even
	  blackholed. Note that not necessarily all RLOCs are
	  fake/spoofed. The attack works also if only part of the
	  RLOCs, the highest priority ones, are compromised. 
	  Again, this can be achieved either through the gleaning as
	  described in <a class='info' href='#gleaning'>Section&nbsp;6.3<span> (</span><span class='info'>Gleaning Attacks</span><span>)</span></a> or by attacking the
	  control-plane as described in <a class='info' href='#cp-threats'>Section&nbsp;6<span> (</span><span class='info'>Control Plane Threats</span><span>)</span></a>.   
	  
</dd>
<dt>Reachability poisoning:</dt>
<dd> The reachability
	  information stored in the mapping could be poisoned,
	  redirecting the packets to a subset of the RLOCs (or even
	  stopping it if locator status bits are all set to 0). If
	  reachability information is not verified through the
	  control-plane this attack can be simply achieved by sending
	  a spoofed packet with swapped or all locator status bits
	  reset. The same result can be obtained by attacking the
	  control-plane as described in <a class='info' href='#cp-threats'>Section&nbsp;6<span> (</span><span class='info'>Control Plane Threats</span><span>)</span></a>.   
	  
</dd>
<dt>Traffic Engineering information poisoning:</dt>
<dd>
	    The LISP protocol defines two attributes associated to
	    each RLOC in order to perform inbound Traffic Engineering:
	    namely priority and weight. 
	    By injecting fake TE attributes, the attacker is able to
	    break load balancing policies and concentrate all the
	    traffic on a single RLOC or put more load on a RLOC than
	    what is expected, creating congestion.
	    Corrupting the TE attributes can be achieved by attacking
	    the control-plane as described in 
	    <a class='info' href='#cp-threats'>Section&nbsp;6<span> (</span><span class='info'>Control Plane Threats</span><span>)</span></a>.  
	  
</dd>
<dt>Mapping TTL poisoning:</dt>
<dd> The LISP protocol
	  associates a Time-To-Live to each mapping that, once
	  expired, allows to delete a mapping from the LISP-Cache (or
	  forces a Map-Request/Map-Reply exchange to refresh it if
	  still needed). By injecting fake TTL values, an attacker can
	  either shrink the Cache (using very short TTL), thus
	  creating an excess of cache miss causing a DoS on the
	  mapping system, or it can increase the size of the cache by
	  putting very high TTL values, up to a cache overflow (see 
	  <a class='info' href='#lc-oflow'>Section&nbsp;5.2.2<span> (</span><span class='info'>LISP-Cache overflow</span><span>)</span></a>). 
	  Corrupting the TTL can be achieved by attacking the
	  control-plane as described in <a class='info' href='#cp-threats'>Section&nbsp;6<span> (</span><span class='info'>Control Plane Threats</span><span>)</span></a>.    
	  
</dd>
<dt>Instance ID poisoning:</dt>
<dd> The LISP
	  protocol allows to use an 24-bit identifier to select the
	  forwarding table to use on the decapsulating ETR to forward
	  the decapsulated packet. By spoofing this attribute the
	  attacker is able to redirect or blackhole inbound traffic.
	  Corrupting the Instance ID attribute can be achieved by
	  attacking the control-plane as described in 
	  <a class='info' href='#cp-threats'>Section&nbsp;6<span> (</span><span class='info'>Control Plane Threats</span><span>)</span></a>.
	  
</dd>
<dt>Map-Version poisoning:</dt>
<dd> The LISP
	  protocol allows to associate a version number to mappings 
	  (<a class='info' href='#I-D.iannone-lisp-mapping-versioning'>[I&#8209;D.iannone&#8209;lisp&#8209;mapping&#8209;versioning]<span> (</span><span class='info'>Iannone, L., Saucez, D., and O. Bonaventure, &ldquo;LISP Mapping Versioning,&rdquo; March&nbsp;2010.</span><span>)</span></a>). 
	  The LISP header can transport source and destination
	  map-versions, describing which version of the mapping have
	  been used to select the source and the destination RLOCs of
	  the LISP encapsulated packet. By spoofing this attribute the
	  attacker is able to trigger Map-Request on the receiving
	  xTR. Corrupting the Map-Version attribute can be achieved
	  either by attacking the control-plane as described in 
	  <a class='info' href='#cp-threats'>Section&nbsp;6<span> (</span><span class='info'>Control Plane Threats</span><span>)</span></a> or by using spoofed packets as
	  described in <a class='info' href='#veratk'>Section&nbsp;5.4.2<span> (</span><span class='info'>Attacks using the Map-Version bit</span><span>)</span></a>.
	  
</dd>
</dl></blockquote><p>
	If the above listed attacks succeed, the attacker has the
	means of controlling the traffic.
	
</p>
<a name="lc-oflow"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2.2"></a><h3>5.2.2.&nbsp;
LISP-Cache overflow</h3>

<p> Depending on how the LISP Cache is managed (e.g., LRU
	vs. LFU) and depending on its size, an attacker can try to
	fill the cache with fake mappings. Once the cache is full,
	some mappings will be replaced by new fake ones, causing
	traffic disruption. 
	
</p>
<p>This can be achieved either through the gleaning as
	described in <a class='info' href='#gleaning'>Section&nbsp;6.3<span> (</span><span class='info'>Gleaning Attacks</span><span>)</span></a> or by attacking the
	control-plane as described in  <a class='info' href='#cp-threats'>Section&nbsp;6<span> (</span><span class='info'>Control Plane Threats</span><span>)</span></a>.  
	
</p>
<p> Another way to generate a LISP-Cache overflow is by
	injecting mapping with a fake and very large TTL value. In
	this case the cache will keep a large amount of mappings
	ending with a completely full cache. This type of attack can  
	also be performed through the control-plane.       
	
</p>
<a name="nolispatk"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3"></a><h3>5.3.&nbsp;
Attacks not leveraging on the LISP header</h3>

<p> We first consider an attacker that sends packets without
      exploiting the LISP header, i.e., with the N, L, E, V, and I bits
      reset (<a class='info' href='#I-D.ietf-lisp'>[I&#8209;D.ietf&#8209;lisp]<span> (</span><span class='info'>Farinacci, D., Fuller, V., Meyer, D., and D. Lewis, &ldquo;Locator/ID Separation Protocol (LISP),&rdquo; April&nbsp;2010.</span><span>)</span></a>).
      
</p>
<p> To inject a packet in the HA-HB flow, a spoofing off-path
      attacker (SA) can send a LISP encapsulated packet whose source
      is set to LR1 or LR2 and destination LR3 or LR4. The packet will
      reach HB as if the packet was sent by host HA. This is not
      different from today's Internet where a spoofing off-path
      attacker may inject data packets in any flow. Several existing
      techniques can be used by hosts to prevent such attacks from
      affecting established flows, e.g., <a class='info' href='#RFC4301'>[RFC4301]<span> (</span><span class='info'>Kent, S. and K. Seo, &ldquo;Security Architecture for the Internet Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a> and  
      <a class='info' href='#I-D.ietf-tcpm-tcp-security'>[I&#8209;D.ietf&#8209;tcpm&#8209;tcp&#8209;security]<span> (</span><span class='info'>Gont, F., &ldquo;Security Assessment of the Transmission Control Protocol (TCP),&rdquo; February&nbsp;2010.</span><span>)</span></a> . 
      
</p>
<p> On the other hand, a non-spoofing off-path attacker (NSA)
      can only send a packet whose source address is set to its
      assigned IP address. The destination address of the encapsulated
      packet can be LR3 or LR4. When the LISP ETR that serves HB
      receives the encapsulated packet, it can consult its LISP-cache
      and verify that NSA is not a valid source address for LISP
      encapsulated packets containing a packet sent by HA. This
      verification is only possible if the ETR already has a valid
      mapping for HA. Otherwise, and to avoid such data packet
      injection attacks, the LISP ETR should reject the packet and
      possibly query the mapping system to obtain a mapping for the
      encapsulated source EID (HA).
      
</p>
<a name="lispatk"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.4"></a><h3>5.4.&nbsp;
Attacks leveraging on the LISP header</h3>

<p> The latest LISP draft <a class='info' href='#I-D.ietf-lisp'>[I&#8209;D.ietf&#8209;lisp]<span> (</span><span class='info'>Farinacci, D., Fuller, V., Meyer, D., and D. Lewis, &ldquo;Locator/ID Separation Protocol (LISP),&rdquo; April&nbsp;2010.</span><span>)</span></a> defines
      several flags that modify the interpretation of the LISP header
      in data packets. In this section, we discuss how an off-path
      attacker could exploit this LISP header. 
      
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.4.1"></a><h3>5.4.1.&nbsp;
Attacks using the Locator Status Bits</h3>

<p> When the L bit is set to 1, it indicates that the second
	32-bits longword of the LISP header contains the
	Locator Status Bits. In this field, each bit position reflects
	the status of one of the RLOCs mapped to the source EID found
	in the encapsulated packet. In particular, a packet with the 
	L bit set and all Locator Status Bits set to zero indicates
	that none of the locators of the encapsulated source EID are
	reachable. The reaction of a LISP ETR that receives such a
	packet is not clearly described in 
	<a class='info' href='#I-D.ietf-lisp'>[I&#8209;D.ietf&#8209;lisp]<span> (</span><span class='info'>Farinacci, D., Fuller, V., Meyer, D., and D. Lewis, &ldquo;Locator/ID Separation Protocol (LISP),&rdquo; April&nbsp;2010.</span><span>)</span></a>. 
	
</p>
<p> A spoofing off-path attacker (SA) can send a data packet
	with the L bit set to 1, all Locator Status Bits set to zero, a
	spoofed source RLOC (e.g. LR1), destination LR3, and
	containing an encapsulated packet whose source is HA. 
	If LR3 blindly trust the Locator Status Bits of the received
	packet it will set LR1 and LR2 as unreachable, possibly
	disrupting ongoing communication. 
	
</p>
<p> Locator Status Bits can be blindly trusted only in secure
	environments. In the general unsecured Internet environment,
	the safest practice for xTRs is to confirm the reachability
	change through the mapping system. In the above example, LR3
	should note that something as changed in the Locator Status
	Bits and query the mapping system in order to confirm
	status of the RLOCs of the source EID.
	
</p>
<p> A similar attack could occur by setting only one Locator
	Status Bit to 1, e.g., the one that corresponds to the source
	RLOC of the packet.
	
</p>
<p> If a non-spoofing off-path attacker (NSA) sends a data packet
	with the L bit set to 1 and all Locator Status Bits set to
	zero, this packet will contain the source address of the
	attacker. Similarly as in <a class='info' href='#nolispatk'>Section&nbsp;5.3<span> (</span><span class='info'>Attacks not leveraging on the LISP header</span><span>)</span></a>, if the
	xTR accepts the packet without checking the LISP Cache for a
	mapping that binds the source EID and the source RLOC of the
	received packet, then the same observation like for the the
	spoofing attacker (SA) apply.
	
</p>
<p> Otherwise, if the xTR does make the check through the LISP
	Cache, it should reject the packet because its source address
	is not one of the addresses listed as RLOCs for the source
	EID. Nevertheless, in this case a Map-Request should be sent,
	which can be used to perform Denial of Service attacks. Indeed
	an attacker can frequently change the Locator Status Bits in
	order to trigger a large amount of Map-Requests. 
	Rate limitation, as described in 
	<a class='info' href='#I-D.ietf-lisp'>[I&#8209;D.ietf&#8209;lisp]<span> (</span><span class='info'>Farinacci, D., Fuller, V., Meyer, D., and D. Lewis, &ldquo;Locator/ID Separation Protocol (LISP),&rdquo; April&nbsp;2010.</span><span>)</span></a>, does not allow to send high
	number of such a request, resulting in the attacker saturating
	the rate with these spoofed packets.
	
</p>
<a name="veratk"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.4.2"></a><h3>5.4.2.&nbsp;
Attacks using the Map-Version bit</h3>

<p> The Map-Version bit is used to indicate whether the
	low-order 24 bits of the first 32 bits word of the LISP header
	contain an Source and Destination Map-Version. When a LISP ETR
	receives a LISP encapsulated packet with the Map-Version bit
	set to 1, the following actions are taken:  
	
</p>
<p>
	  </p>
<ul class="text">
<li> It compares the Destination Map-Version found in the
	    header with the current version of its own mapping, in the
	    LISP Database, for the destination EID found in the
	    encapsulated packet. If the received Destination
	    Map-Version is smaller (i.e., older) than the current
	    version, the ETR should apply the SMR procedure described 
	    in <a class='info' href='#I-D.ietf-lisp'>[I&#8209;D.ietf&#8209;lisp]<span> (</span><span class='info'>Farinacci, D., Fuller, V., Meyer, D., and D. Lewis, &ldquo;Locator/ID Separation Protocol (LISP),&rdquo; April&nbsp;2010.</span><span>)</span></a> and send a Map-Request
	    with the SMR bit set.
	    
</li>
<li> If a mapping exists in the LISP Cache for the source
	    EID, then it compares the Map-Version of that entry with
	    the Source Map-Version found in the header of the packet.
	    If the stored mapping is older (i.e., the Map-Version is
	    smaller) than the source version of the LISP encapsulated
	    packet, the xTR should send a Map-Request for the source
	    EID. 
	    
</li>
</ul><p>
	
</p>
<p> A spoofing off-path attacker (SA) could use the
	Map-Version bit to force an ETR to send Map-Request messages. 
	The attacker can retrieve the current source and destination
	Map-Version for both HA and HB. Based on this information, it
	can send a spoofed packet with an older Source Map-Version or
	Destination Map-Version. If the size of the Map-Request
	message is larger than the size of the smallest
	LISP-encapsulated packet that could trigger such a message,
	this could lead to amplification attacks (see 
	<a class='info' href='#mapreqatk'>Section&nbsp;6.1<span> (</span><span class='info'>Attacks with Map-Request messages</span><span>)</span></a>). Fortunately, 
	<a class='info' href='#I-D.ietf-lisp'>[I&#8209;D.ietf&#8209;lisp]<span> (</span><span class='info'>Farinacci, D., Fuller, V., Meyer, D., and D. Lewis, &ldquo;Locator/ID Separation Protocol (LISP),&rdquo; April&nbsp;2010.</span><span>)</span></a> recommends to rate limit the
	Map-Request messages that are sent by an xTR. This prevents
	the amplification attack, but there is a risk of Denial of
	Service attack if an attacker sends packets with Source and
	Destination Map-Versions that frequently change. In this case,
	the ETR could consume all its rate by sending Map-Request
	messages in response to these spoofed packets.
	
</p>
<p> A non-spoofing off-path attacker (NSA) cannot success in
	such an attack if the destination xTR rejects the LISP
	encapsulated packets that are not sent by one of the RLOCs
	mapped to the included source EID. If it is not the case, the
	attacker can be able to perform attacks concerning the
	Destination Map Version number as for the spoofing off-path
	attacker (SA).
	
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.4.3"></a><h3>5.4.3.&nbsp;
Attacks using the Nonce-Present and the Echo-Nonce bits</h3>

<p> The Nonce-Present and Echo-Nonce bits are used when
	verifying the reachability of a remote ETR. Assume that LR3
	wants to verify that LR1 receives the packets that it
	sends. LR3 can set the Echo-Nonce and the Nonce-Present bits
	in LISP data encapsulated packets and include a random nonce
	in these packets. Upon reception of this packet, LR1 will
	store the nonce sent by LR3 and echo it when it returns LISP
	encapsulated data packets to LR3. 
	
</p>
<p>A spoofing off-path attacker (SA) could interfere with this
	reachability test by sending two different types of packets:
	</p>
<ol class="text">
<li> LISP data encapsulated packets with the Nonce-Present
	    bit set and a random nonce and the appropriate source
	    and destination RLOCs. 
	    
</li>
<li> LISP data encapsulated packets with the Nonce-Present
	    and the Echo-Nonce bits both set and the appropriate
	    source and destination RLOCs. These packets will force the
	    receiving ETR to store the received nonce and echo it in
	    the LISP encapsulated packets that it sends. 
	    
</li>
</ol><p>
	
</p>
<p> The first type of packet should not cause any major problem
	to ITRs. As the reachability test uses a 24 bits nonce, it is
	unlikely that an off-path attacker could send a packet that
	causes an ITR to believe that the ETR it is testing is
	reachable while in reality it is not reachable. 
	
</p>
<p>The second type of packet could be exploited to create a
	Denial of Service attack against the nonce-based reachability
	test. Consider a spoofing off-path attacker (SA) that sends a
	continuous flow of spoofed LISP data encapsulated packets that
	contain the Nonce-Present and the Echo-Nonce bit and each
	packet contains a different random nonce. The ETR that
	receives such packets will continuously change the nonce that
	it returns to the remote ITR. If the remote ITR starts a
	nonce-reachability test, this test may fail because the ETR
	has received a spoofed LISP data encapsulated packet with a
	different random nonce and never echoes the real nonce. In
	this case the ITR will consider the ETR not reachable. The
	success of this test will of course depend on the ratio
	between the amount of packets sent by the legitimate ITR and
	the spoofing off-path attacker (SA).
	
</p>
<p>Packets sent by a non-spoofing off-path attacker (NSA) can
	cause similar problem if no check is done with the LISP Cache
	(see <a class='info' href='#nolispatk'>Section&nbsp;5.3<span> (</span><span class='info'>Attacks not leveraging on the LISP header</span><span>)</span></a> for the LISP Cache check).
	Otherwise, if the check is performed the packets will be
	rejected by the ETR that receives them and cannot cause 
	problems.
	
</p>
<a name="cp-threats"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Control Plane Threats</h3>

<p> In this section, we discuss the different types of attacks that
    can occur when an off-path attacker sends control plane
    packets. We focus on the packets that are sent directly to the ETR
    and do not analyze the particularities of a LISP mapping system.
    The ALT mapping system is discussed in <a class='info' href='#alt'>Section&nbsp;8<span> (</span><span class='info'>Security of the ALT Mapping System</span><span>)</span></a>.
    
</p>
<a name="mapreqatk"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
Attacks with Map-Request messages</h3>

<p> An off-path attacker could send Map-Request packets to a
      victim ETR. In theory, a Map-Request packet is only used to
      solicit an answer and as such it should not lead to security
      problems. However, the LISP specification 
      <a class='info' href='#I-D.ietf-lisp'>[I&#8209;D.ietf&#8209;lisp]<span> (</span><span class='info'>Farinacci, D., Fuller, V., Meyer, D., and D. Lewis, &ldquo;Locator/ID Separation Protocol (LISP),&rdquo; April&nbsp;2010.</span><span>)</span></a> contains several particularities
      that could be exploited by an off-path attacker.
      
</p>
<p>The first possible exploitation is the P bit. The P bit is
      used to probe the reachability of remote ETRs in the control
      plane. In our reference environment, LR3 could probe the
      reachability of LR1 by sending a Map-Request with the P bit
      set. LR1 would reply by sending a Map-Reply message with the P
      bit set and the same nonce as in the Map-Request message. 
      
</p>
<p> A spoofing off-path attacker (SA) could use the P bit to
      force a victim ETR to send a Map-Reply to the spoofed source
      address of the Map-Request message. As the Map-Reply can be
      larger than the Map-Request message, there is a risk of
      amplification attack.
      Considering only IPv4 addresses, a Map-Request has a size of 32
      bytes at least, considering one single ITR address and no
      Mapping Protocol Data. The Map-Reply instead has a size of
      28+(N*12) bytes, where N is the number of RLOCs. Since there 
      is no hard limit in the number of RLOCs that can be associated
      to an EID-Prefix, the packet can easily grow large.   
      
</p>
<p> Any ISP with a large number of potential RLOCs for a given
      EID-Prefix should carefully ponder the best trade-off between the
      number of RLOCs through which it wants that the EID is
      reachable and the consequences that an amplification attack
      can produce.
      
</p>
<p> It should be noted that the maximum rate of Map-Reply
      messages should apply to all Map-Replies and also be associated
      to each destination that receives Map-Reply messages. Otherwise,
      a possible amplification attack could be launched by a spoofing
      off-path attacker (SA) as follows. Consider an attacker SA and
      and EID-Prefix p/P and a victim ITR. 
      To amplify a Denial of Service attack against the victim ITR, SA
      could send spoofed Map-Request messages whose source EID
      addresses are all the addresses inside p/P and source RLOC
      address is the victim ITR. Upon reception of these Map-Request
      messages, the ETR would send large Map-Reply messages for each
      of the addresses inside p/P back to the victim ITR. 
      
</p>
<p> If a non-spoofing off-path attacker (NSA) sends a
      Map-Request with the P bit set, it will receive a Map-Reply with
      the P bit set. This does not raise security issues besides the
      usual risk of overloading a victim ETR by sending too many
      Map-Request messages. 
      
</p>
<p> The Map-Request message may also contain the SMR bit. Upon
      reception of a Map-Request message with the SMR bit, an ETR must
      return to the source of the Map-Request message a Map-Request
      message to retrieve the corresponding mapping. This raises
      similar problems as the P bit discussed above except that as the
      Map-Request messages are smaller than Map-Reply messages, the
      risk of amplification attacks is reduced.  
      This is not true anymore if the ETR append to the Map-Request
      messages its own Map-Records. This mechanism is meant to reduce
      the delay in mapping distribution since mapping information is
      provided in the Map-Request message. 
      
</p>
<p> Furthermore, appending Map-Records to Map-Request messages
      represents a major security risk since an off-path attacker
      could generate a (spoofed or not) Map-Request message and
      include in the Map-Reply portion of the message mapping for 
      EID prefixes that it does not serve. This could lead to various
      types of redirection and denial of service attacks. An xTR
      should not process the Map-Records information that it receives in
      a Map-Request message.
      
</p>
<a name="mapreply"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
Attacks with Map-Reply messages</h3>

<p> In this section we analyze the attacks that could occur when
      an off-path attacker sends directly Map-Reply messages to 
      ETRs without using one of the proposed LISP mapping systems. 
      
</p>
<p> There are two different types of Map-Reply messages:
      </p>
<blockquote class="text"><dl>
<dt>Positive Map-Reply:</dt>
<dd> This messages contain a
	  Map-Record binding an EID-Prefix to one or more RLOCs.  
	  
</dd>
<dt>Negative Map-Reply:</dt>
<dd> This messages contain a
	  Map-Record for an EID-Prefix with an empty locator-set and
	  specifying an action, which may be either Drop, Natively
	  forward, or Send Map-Request.
	  
</dd>
</dl></blockquote><p>
      
</p>
<p> Positive Map-Reply messages are used to map EID-Prefixes onto
      RLOCs. Negative Map-Reply messages are used to support PTR and
      interconnect the LISP Internet with the legacy Internet.
      
</p>
<p> Most of the security of the Map-Reply messages depend on the
      64 bits nonce that is included in a Map-Request and returned in
      the Map-Reply. An ETR must never accept a Map-Request message
      whose nonce does not match one of the pending Map-Request
      messages. If an ETR does not accept Map-Reply messages with an
      invalid nonce, the risk of attack is very small given the size
      of the nonce (64 bits). 
      
</p>
<p> Note, however, that the nonce only confirms that the
      Map-Reply was sent by the ETR that received the Map-Request. It
      does not validate the content of the Map-Reply message.
      
</p>
<a name="gleaning"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.3"></a><h3>6.3.&nbsp;
Gleaning Attacks</h3>

<p> A third type of attack involves the gleaning mechanism
      proposed in <a class='info' href='#I-D.ietf-lisp'>[I&#8209;D.ietf&#8209;lisp]<span> (</span><span class='info'>Farinacci, D., Fuller, V., Meyer, D., and D. Lewis, &ldquo;Locator/ID Separation Protocol (LISP),&rdquo; April&nbsp;2010.</span><span>)</span></a> and discussed in 
      <a class='info' href='#Saucez09'>[Saucez09]<span> (</span><span class='info'>Saucez, D. and L. Iannone, &ldquo;How to mitigate the effect of scans on mapping systems,&rdquo; .</span><span>)</span></a>. 
      In order to reduce the time required to obtain a mapping,
      <a class='info' href='#I-D.ietf-lisp'>[I&#8209;D.ietf&#8209;lisp]<span> (</span><span class='info'>Farinacci, D., Fuller, V., Meyer, D., and D. Lewis, &ldquo;Locator/ID Separation Protocol (LISP),&rdquo; April&nbsp;2010.</span><span>)</span></a> allows an ITR to learn a mapping
      from the LISP data encapsulated packets and the Map-Request
      packets that it receives. LISP data encapsulated packet contains
      a source RLOC, destination RLOC, source EID and destination
      EID. When a ITR receives a data encapsulated packet coming
      from a source EID for which it does not already know a mapping,
      it may insert the mapping between the source RLOC and the source
      EID in its LISP Cache. Gleaning can also be used when an ITR
      receives a Map-Request as the Map-Request also contains a source
      EID address and a source RLOC. Once a gleaned entry has been
      added to the cache, the LISP ITR sends a Map-Request to retrieve
      the mapping for the gleaned EID from the mapping system. 
      <a class='info' href='#I-D.ietf-lisp'>[I&#8209;D.ietf&#8209;lisp]<span> (</span><span class='info'>Farinacci, D., Fuller, V., Meyer, D., and D. Lewis, &ldquo;Locator/ID Separation Protocol (LISP),&rdquo; April&nbsp;2010.</span><span>)</span></a> recommends to store the gleaned
      entries for only a few seconds.
      
</p>
<p> The first risk of gleaning is the ability to temporarily
      hijack an identity. Consider an off-path attacker that wants to
      temporarily hijack host HA's identity and send packets to host
      HB with host HA's identity. If the xTRs that serve host HB do
      not store a mapping for host HA, a non-spoofing off-path
      attacker (NSA) could send a LISP encapsulated data packet to LR3
      or LR4. The ETR will store the gleaned entry and use it to
      return the packets sent by host HB to the attacker. In parallel,
      the ETR will send a Map-Request to retrieve the mapping for
      HA. During a few seconds or until the reception of the
      Map-Reply, host HB will exchange packets with the attacker that
      has hijacked HA's identity. Note that the attacker could in 
      parallel send lots of Map-Requests or lots of LISP data
      encapsulated packets with random sources to force the xTR that
      is responsible for host HA to send lots of Map-Request messages
      in order to force  it to exceed its rate limit for control plane
      messages. This could further delay the arrival of the Map-Reply
      message on the requesting ETR.
      
</p>
<p> Gleaning also introduces the possibility of a
      man-in-the-middle attack. Consider an off-path attacker that
      knows that hosts HA and HB that reside in different sites will
      exchange information at time t. An off-path attacker could use
      this knowledge to launch a man-in-the-middle attack if the xTRs
      that serve the two hosts do not have mapping for the other
      EID. For this, the attacker sends to LR1 (resp. LR3) a LISP data
      encapsulated packet whose source RLOC is its IP address and
      contains an IP packet whose source is set to HB (resp. HA). The
      attacker chooses a packet that will not trigger an answer, for
      example the last part of a fragmented packet. Upon reception of
      these packets, LR1 and LR3 install gleaned entries that point to
      the attacker. As explained above, the attacker could, at the
      same time, send lots of packets to LR1 and LR3 to force them to
      exhaust their control plane rate limit. This will extend the
      duration of the gleaned entry. If host HA establishes a flow
      with host HB at that time, the packets that they exchange will
      first pass through the attacker.
      
</p>
<p> In both cases, the attack only lasts for a few
      seconds (unless the attacker is able to exhaust the rate
      limitation). However it should be noted that today
      a large amount of packets may be exchanged during even a small
      fraction of time.
      
</p>
<a name="malicious"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Threats with Malicious xTRs</h3>

<p> In this section, we discuss the threats that could be caused
    by malicious xTRs. We consider the reference environment below
    where EL1 is a malicious or compromised xTR. This malicious
    xTR serves a set of hosts that includes HC. The other xTR and
    hosts in this network play the same role as in the reference
    environment described in <a class='info' href='#refenv'>Section&nbsp;4<span> (</span><span class='info'>Reference Environment</span><span>)</span></a>. 
    
</p><br /><hr class="insert" />
<a name="net2"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   +----+
   | HA |
   +----+
     | EID: HA
     |
    -----------------
        |         |
      +----+    +----+
      |LR1 |    |LR2 |
      +----+    +----+
        |         |
        |         |
     +----+     +----+
     |ISP1|     |ISP2|             |
     +----+     +----+     +----+  |
       |           |    +--| EL1|--|    EID: HC
    +----------------+  |  +----+  |    +----+
    |                |--+          |----| HC |
    |    Internet    |             |    +----+
    |                |
    +----------------+
        |         |
        |         |
     +----+     +----+
     |LR3 |     | LR4|
     +----+     +----+
       |           |
    --------------------
            |
            | EID: HB
          +----+
          | HB |
          +----+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;2: Malicious xTRs' Reference Environment&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p> Malicious xTRs are probably the most serious threat to the
    LISP control plane from a security viewpoint. To understand the
    problem, let us consider the following scenario. Host HC and HB
    exchange packets with host HA. As all these hosts reside in LISP
    sites, LR1 and LR2 store mappings for HB and HC. Thus, these xTRs
    may need to exchange LISP control plane packets with EL1, e.g., to  
    perform reachability tests or to refresh expired mappings (e.g., if
    HC's mapping has a small TTL).
    
</p>
<p> A first threat against the LISP control plane is when EL1
    replies to a legitimate Map-Request message sent by LR1 or LR2
    with a Map-Reply message that contains an EID-Prefix that is
    larger than the prefix owned by the site attached to EL1. This
    could allow EL1 to attract packets destined to other EIDs than the
    EIDs that are attached to EL1. 
    
</p>
<p> Another possible attack is a Denial of Service attack by
    sending a Negative Map-Reply message for a coarser prefix without
    any locator and with the Drop action. Such a Negative Map-Reply
    indicates that the ETR that receives it should discard all
    packets. The current LISP specification briefly discusses this
    problem <a class='info' href='#I-D.ietf-lisp'>[I&#8209;D.ietf&#8209;lisp]<span> (</span><span class='info'>Farinacci, D., Fuller, V., Meyer, D., and D. Lewis, &ldquo;Locator/ID Separation Protocol (LISP),&rdquo; April&nbsp;2010.</span><span>)</span></a>, but the proposed solutions
    does not solve the problem.   
    
</p>
<p> Another concern with malicious xTRs is the possibility of
    Denial of Service attacks. A first attack is the flooding attack
    that was described in <a class='info' href='#I-D.bagnulo-lisp-threat'>[I&#8209;D.bagnulo&#8209;lisp&#8209;threat]<span> (</span><span class='info'>Bagnulo, M., &ldquo;Preliminary LISP Threat Analysis,&rdquo; July&nbsp;2007.</span><span>)</span></a>. 
    This attack allows a malicious xTR to redirect traffic to a
    victim. The malicious xTR first defines a mapping for HC with two
    RLOCs: its own RLOC (EL1) and the RLOC of the victim (e.g., LR3). 
    The victim's RLOC is set as unreachable in the mapping. 
    HC starts a large download from host HA. Once the download starts,
    the malicious xTR updates its Locator Status Bits, changes
    the mapping's version number or sets the SMR bit such that LR1
    updates its LISP Cache to send all packets destined to HC to the
    victim's RLOC. Instead of downloading from HA, the attacker could
    also send packets that trigger a response (e.g., ICMP, TCP SYN,
    DNS request, ...) to HA. HA would then send its response and its
    xTR would forward it to the victim's RLOC.
    
</p>
<p> An important point to note about this flooding attack is that
    it reveals a potential problem in the LISP architecture. A LISP
    ITR relies on the received mapping and possible reachability
    information to select the RLOC of the ETR that it uses to reach a
    given EID or block of EIDs. However, if the ITR made a mistake,
    e.g., due to configuration, implementation or other types of
    errors and has chosen a RLOC that does not serve the 
    destination EID, there is no easy way for the LISP ETR to inform
    the ITR of its mistake. A possible solution could be to force
    a ETR to perform a reachability test with the selected ITR as soon
    as it selects it. This will be analyzed in the next version of
    this document. 
    
</p>
<a name="alt"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Security of the ALT Mapping System</h3>

<p> One of the assumptions in <a class='info' href='#I-D.ietf-lisp'>[I&#8209;D.ietf&#8209;lisp]<span> (</span><span class='info'>Farinacci, D., Fuller, V., Meyer, D., and D. Lewis, &ldquo;Locator/ID Separation Protocol (LISP),&rdquo; April&nbsp;2010.</span><span>)</span></a> is
    that the mapping system is more secure than sending Map-Request
    and Map-Reply messages directly. We analyze this assumption in
    this section by analyzing the security of the ALT mapping
    system. 
    
</p>
<p> The ALT mapping system is basically a manually configured
    overlay of GRE tunnels between ALT routers. BGP sessions are
    established between ALT routers that are connected through such a
    tunnel. An ALT router advertises the EID prefixes that it serves
    over its BGP sessions with neighboring ALT routers and the 
    EID-Prefixes that it has learned from neighboring ALT routers.
    
</p>
<p> The ALT mapping system is in fact a discovery system that
    allows any ALT router to discover the ALT router that is
    responsible for a given EID-Prefix. To obtain a mapping from the
    ALT system, an ITR sends a packet containing a Map-Request on
    the overlay. This Map-Request is sent inside a packet whose
    destination is the requested EID. The Map-Request is routed on the
    overlay until it reaches the ALT router that advertised initially
    the prefix that contains the requested EID. This ALT router then
    replies directly by sending a Map-Reply to the RLOC of the
    requesting ITR. 
    
</p>
<p> The security of the ALT mapping system depends on many
    factors, including:
    </p>
<ul class="text">
<li> The security of the intermediate ALT routers.
      
</li>
<li> The validity of the BGP advertisements sent on the ALT
      overlay.
      
</li>
</ul><p>
    
</p>
<p> Unfortunately, experience with BGP on the global Internet has
    shown that BGP is subject to various types of misconfiguration
    problems and security attacks. The SIDR working group is
    developing a more secure inter-domain routing architecture to solve
    this problem (<a class='info' href='#I-D.ietf-sidr-arch'>[I&#8209;D.ietf&#8209;sidr&#8209;arch]<span> (</span><span class='info'>Lepinski, M. and S. Kent, &ldquo;An Infrastructure to Support Secure Internet Routing,&rdquo; October&nbsp;2009.</span><span>)</span></a>). 
    
</p>
<p> The security of the intermediate ALT routers is another
    concern. A malicious intermediate ALT router could manipulate the
    received BGP advertisements and also answer to received
    Map-Requests without forwarding them to their final destination on
    the overlay. This could lead to various types of redirection
    attacks. Note that in contrast with a regular IP router that could
    also manipulate in transit packets, when a malicious or
    compromised ALT router replies to a Map-Request, it can redirect
    legitimate traffic for a long period of time by sending an invalid
    Map-Reply message. Thus, the impact of a malicious ALT router
    could be much more severe than a malicious router in today's
    Internet.
    
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Discussion</h3>

<p> To mitigate the impact of attacks against LISP, the following
    recommendations should be followed. 
    
</p>
<p>First, the use of some form of filtering can help in avoid or
    at least mitigate some types of attacks.  
    </p>
<ul class="text">
<li> On ETRs, packets should be decapsulated only if the
      destination EID is effectively part of the EID-Prefix downstream
      the ETR. Further, still on ETRs, packets should be decapsulated
      only if a mapping for the source EID is present in the
      LISP-Cache and has been obtained through the mapping system (not
      gleaned). 
      
</li>
<li> On ITRs, packets should be encapsulated only if the source
      EID is effectively part of the EID-Prefix downstream the
      ITR. Further, still on ITRs, packets should be encapsulated only
      if a mapping obtained from the mapping system is present in the
      LISP Cache (no Data-Probing).  
      
</li>
</ul><p>
    
</p>
<p> Note that this filtering, since complete mappings need to be
    installed in both ITRs and ETRs, can introduce a higher connection
    setup latency and hence potentially more packets drops due to the
    lack of mappings in the LISP Cache. 
    
</p>
<p> While the gleaning mechanism allows to start encapsulating
    packets to a certain EID in parallel with the Map-Request to
    obtain a mapping when a new flow is established, it creates
    important security risks since it allows attackers to perform
    identity hijacks. Although the duration of these identity hijacks
    is limited (except the case of rate limitation exhaustion), their
    impact can be severe. A first option would be to disable gleaning
    until the security concerns are solved. A second option would be
    to strictly limit the number of packets that can be forwarded via
    a gleaned entry. Overall the benefits of gleaning, i.e., avoiding
    the loss of the first packet of a flow, seems very small compared
    to the associated security risks. Furthermore, measurements
    performed in data centers show that today's Internet often operate
    with packet loss ratio of 1 or 2 percentage (<a class='info' href='#Chu'>[Chu]<span> (</span><span class='info'>Jerry Chu, H., &ldquo;Tuning TCP Parameters for the 21st Century,&rdquo; July&nbsp;2009.</span><span>)</span></a>). 
    These packet loss ratio are probably already orders of magnitude
    larger than the improvement provided by the gleaning mechanism.
    
</p>
<p> With the increasing deployment of spoofing prevention
    techniques such as <a class='info' href='#RFC3704'>[RFC3704]<span> (</span><span class='info'>Baker, F. and P. Savola, &ldquo;Ingress Filtering for Multihomed Networks,&rdquo; March&nbsp;2004.</span><span>)</span></a> or SAVI 
    <a class='info' href='#SAVI'>[SAVI]<span> (</span><span class='info'>IETF, &ldquo;Source Address Validation Improvements Working Group,&rdquo; .</span><span>)</span></a>, it can be expected that attackers will
    become less capable of sending packets with a spoofed source
    address. To prevent packet injection attacks from non-spoofing
    attackers (NSA), ETRs should always verify that the source RLOC of
    each received LISP data encapsulated packet corresponds to one of
    the RLOCs listed in the mappings for the source EID found in the
    inner packet. An alternative could be to use existing IPSec
    techniques <a class='info' href='#RFC4301'>[RFC4301]<span> (</span><span class='info'>Kent, S. and K. Seo, &ldquo;Security Architecture for the Internet Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>and when necessary including
    perhaps <a class='info' href='#RFC5386'>[RFC5386]<span> (</span><span class='info'>Williams, N. and M. Richardson, &ldquo;Better-Than-Nothing Security: An Unauthenticated Mode of IPsec,&rdquo; November&nbsp;2008.</span><span>)</span></a> to establish an authenticated
    tunnel between the ITR and the ETR. 
    
</p>
<p> <a class='info' href='#I-D.ietf-lisp'>[I&#8209;D.ietf&#8209;lisp]<span> (</span><span class='info'>Farinacci, D., Fuller, V., Meyer, D., and D. Lewis, &ldquo;Locator/ID Separation Protocol (LISP),&rdquo; April&nbsp;2010.</span><span>)</span></a> recommends to rate limit
    the control messages that are sent by a xTR. This limit is
    important to deal with denial of service attacks. However, a
    strict limit, e.g., implemented with a token bucket, on all the
    Map-Request and Map-Reply messages sent by a xTR is not
    sufficient. A xTR should distinguish between different types of
    control plane packets: 
    </p>
<ol class="text">
<li> The Map-Request messages that it sends to refresh expired
      mapping information.  
      
</li>
<li> The Map-Request messages that it sends to obtain mapping
      information because one of the served hosts tried to contact an
      external EID. 
      
</li>
<li> The Map-Request messages that it sends as reachability
      probes. 
      
</li>
<li> The Map-Reply messages that it sends as response to
      reachability probes. 
      
</li>
<li> The Map-Request messages that it sends to support gleaning.
      
</li>
</ol><p>
    
</p>
<p> These control plane messages are used for different
    purposes. Fixing a global rate limit for all control plane
    messages increases the risk of Denial of Service attacks if a
    single type of control plane message can exceed the configured
    limit. This risk could be mitigated by either specifying a rate
    for each of the five types of control plane messages. Another
    option could be to define a maximum rate for all control plane
    messages, and prioritize the control plane messages according to
    the list above (with the highest priority for message type 1).
    
</p>
<p> In <a class='info' href='#I-D.ietf-lisp'>[I&#8209;D.ietf&#8209;lisp]<span> (</span><span class='info'>Farinacci, D., Fuller, V., Meyer, D., and D. Lewis, &ldquo;Locator/ID Separation Protocol (LISP),&rdquo; April&nbsp;2010.</span><span>)</span></a>, there is no mechanism that
    allows a xTR to verify the validity of the content a Map-Reply
    message that it receives. Besides the attacks discussed earlier in
    the document, a time-shifted attack where an attacker is able to
    modify the content of a Map-Reply message but then needs to move
    off-path could also create redirection attacks. The nonce only
    allows a xTR to verify that a Map-Reply responds to a previously
    sent Map-Request message. The LISP Working Group should explore
    solutions that allow to verify the binding between EID-Prefixes
    and their RLOCS. Having such kind of mechanism would allow ITRs to
    ignore non-verified mappings, thus increasing security. 
    
</p>
<p> LISP Working Group should consider developing secure
    mechanisms to allow an ETR to indicate to an ITR that it does 
    not serve a particular EID or block of EIDs in order to mitigate
    the flooding attacks.  
    
</p>
<p> Finally, there is also the risk of Denial of Service attack
    against the LISP Cache. We have discussed these attacks when
    considering external attackers with, e.g., the gleaning mechanism
    and in <a class='info' href='#lc-threats'>Section&nbsp;5.2<span> (</span><span class='info'>LISP-Cache Threats</span><span>)</span></a>. 
    If an ITR has a limited LISP Cache, a malicious or compromised
    host residing in the site that it serves could generate packets to
    random destinations to force the ITR to issue a large number of
    Map-Requests whose answers could fill its cache. Faced with such
    misbehaving hosts, LISP ITR should be able to limit the percent
    of Map-Requests that it sends for a given source EID.
    
</p>
<a name="docstatus"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
Document Status and Plans</h3>

<p>In this document, we have analyzed some of the security threats
    that affect the Locator/Identifier Separation Protocol (LISP). We
    have focused our analysis on unicast traffic and considered both
    the LISP data and control planes and provided some recommendations
    to improve the security of LISP. 
    
</p>
<p> Revisions of this document will document the security threats
    of other parts of the LISP architecture, including but not limited
    to:
    </p>
<ul class="text">
<li> Instance ID attribute.
      
</li>
<li> LISP Multicast.
      
</li>
<li> LISP Map-Server.
      
</li>
</ul><p>
    
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
IANA Considerations</h3>

<p>This document makes no request to IANA.
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12"></a><h3>12.&nbsp;
Security Considerations</h3>

<p> Security considerations are the core of this document and do
    not need to be further discussed in this section.
    
</p>
<a name="ack"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.13"></a><h3>13.&nbsp;
Acknowledgements</h3>

<p>The flooding attack and the reference environment were first
    described in Marcelo Bagnulo's draft 
    <a class='info' href='#I-D.bagnulo-lisp-threat'>[I&#8209;D.bagnulo&#8209;lisp&#8209;threat]<span> (</span><span class='info'>Bagnulo, M., &ldquo;Preliminary LISP Threat Analysis,&rdquo; July&nbsp;2007.</span><span>)</span></a>.
    
</p>
<p> This work has been partially supported by the
    INFSO-ICT-216372 TRILOGY Project (www.trilogy-project.org).  
    
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.14"></a><h3>14.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>14.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.ietf-lisp">[I-D.ietf-lisp]</a></td>
<td class="author-text">Farinacci, D., Fuller, V., Meyer, D., and D. Lewis, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-lisp-07.txt">Locator/ID Separation Protocol (LISP)</a>,&rdquo; draft-ietf-lisp-07 (work in progress), April&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-lisp-07.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-lisp-alt">[I-D.ietf-lisp-alt]</a></td>
<td class="author-text">Fuller, V., Farinacci, D., Meyer, D., and D. Lewis, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-lisp-alt-04.txt">LISP Alternative Topology (LISP+ALT)</a>,&rdquo; draft-ietf-lisp-alt-04 (work in progress), April&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-lisp-alt-04.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-lisp-interworking">[I-D.ietf-lisp-interworking]</a></td>
<td class="author-text">Lewis, D., Meyer, D., Farinacci, D., and V. Fuller, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-lisp-interworking-00.txt">Interworking LISP with IPv4 and IPv6</a>,&rdquo; draft-ietf-lisp-interworking-00 (work in progress), May&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-lisp-interworking-00.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-lisp-ms">[I-D.ietf-lisp-ms]</a></td>
<td class="author-text">Fuller, V. and D. Farinacci, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-lisp-ms-05.txt">LISP Map Server</a>,&rdquo; draft-ietf-lisp-ms-05 (work in progress), April&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-lisp-ms-05.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-lisp-multicast">[I-D.ietf-lisp-multicast]</a></td>
<td class="author-text">Farinacci, D., Meyer, D., Zwiebel, J., and S. Venaas, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-lisp-multicast-03.txt">LISP for Multicast Environments</a>,&rdquo; draft-ietf-lisp-multicast-03 (work in progress), April&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-lisp-multicast-03.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>14.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="Chu">[Chu]</a></td>
<td class="author-text">Jerry Chu, H., &ldquo;<a href="http://tools.ietf.org/wg/savi/">Tuning TCP Parameters for the 21st Century</a>,&rdquo; &nbsp;75th IETF, Stockholm, July&nbsp;2009.</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.bagnulo-lisp-threat">[I-D.bagnulo-lisp-threat]</a></td>
<td class="author-text">Bagnulo, M., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-bagnulo-lisp-threat-01.txt">Preliminary LISP Threat Analysis</a>,&rdquo; draft-bagnulo-lisp-threat-01 (work in progress), July&nbsp;2007 (<a href="http://www.ietf.org/internet-drafts/draft-bagnulo-lisp-threat-01.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.iannone-lisp-mapping-versioning">[I-D.iannone-lisp-mapping-versioning]</a></td>
<td class="author-text">Iannone, L., Saucez, D., and O. Bonaventure, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-iannone-lisp-mapping-versioning-01.txt">LISP Mapping Versioning</a>,&rdquo; draft-iannone-lisp-mapping-versioning-01 (work in progress), March&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-iannone-lisp-mapping-versioning-01.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-sidr-arch">[I-D.ietf-sidr-arch]</a></td>
<td class="author-text">Lepinski, M. and S. Kent, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-sidr-arch-09.txt">An Infrastructure to Support Secure Internet Routing</a>,&rdquo; draft-ietf-sidr-arch-09 (work in progress), October&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-sidr-arch-09.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-tcpm-tcp-security">[I-D.ietf-tcpm-tcp-security]</a></td>
<td class="author-text">Gont, F., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-tcpm-tcp-security-01.txt">Security Assessment of the Transmission Control Protocol (TCP)</a>,&rdquo; draft-ietf-tcpm-tcp-security-01 (work in progress), February&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-tcpm-tcp-security-01.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.lear-lisp-nerd">[I-D.lear-lisp-nerd]</a></td>
<td class="author-text">Lear, E., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-lear-lisp-nerd-08.txt">NERD: A Not-so-novel EID to RLOC Database</a>,&rdquo; draft-lear-lisp-nerd-08 (work in progress), March&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-lear-lisp-nerd-08.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.meyer-lisp-cons">[I-D.meyer-lisp-cons]</a></td>
<td class="author-text">Brim, S., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-meyer-lisp-cons-04.txt">LISP-CONS: A Content distribution Overlay Network Service for LISP</a>,&rdquo; draft-meyer-lisp-cons-04 (work in progress), April&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-meyer-lisp-cons-04.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3704">[RFC3704]</a></td>
<td class="author-text">Baker, F. and P. Savola, &ldquo;<a href="http://tools.ietf.org/html/rfc3704">Ingress Filtering for Multihomed Networks</a>,&rdquo; BCP&nbsp;84, RFC&nbsp;3704, March&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3704.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4301">[RFC4301]</a></td>
<td class="author-text">Kent, S. and K. Seo, &ldquo;<a href="http://tools.ietf.org/html/rfc4301">Security Architecture for the Internet Protocol</a>,&rdquo; RFC&nbsp;4301, December&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4301.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5386">[RFC5386]</a></td>
<td class="author-text">Williams, N. and M. Richardson, &ldquo;<a href="http://tools.ietf.org/html/rfc5386">Better-Than-Nothing Security: An Unauthenticated Mode of IPsec</a>,&rdquo; RFC&nbsp;5386, November&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5386.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="SAVI">[SAVI]</a></td>
<td class="author-text">IETF, &ldquo;<a href="http://tools.ietf.org/wg/savi/">Source Address Validation Improvements Working Group</a>.&rdquo;</td></tr>
<tr><td class="author-text" valign="top"><a name="Saucez09">[Saucez09]</a></td>
<td class="author-text">Saucez, D. and L. Iannone, &ldquo;How to mitigate the effect of scans on mapping systems,&rdquo; &nbsp;Submitted to the Trilogy Summer School on Future Internet.</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Damien Saucez</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Universite catholique de Louvain</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Place St. Barbe 2</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Louvain la Neuve</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Belgium</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:damien.saucez@uclouvain.be">damien.saucez@uclouvain.be</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Luigi Iannone</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">TU Berlin - Deutsche Telekom Laboratories AG</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Ernst-Reuter Platz 7</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Berlin</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Germany</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:luigi@net.t-labs.tu-berlin.de">luigi@net.t-labs.tu-berlin.de</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Olivier Bonaventure</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Universite catholique de Louvain</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Place St. Barbe 2</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Louvain la Neuve</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Belgium</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:olivier.bonaventure@uclouvain.be">olivier.bonaventure@uclouvain.be</a></td></tr>
</table>
</body></html>
