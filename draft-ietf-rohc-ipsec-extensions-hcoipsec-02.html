<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>IPsec Extensions to Support Robust Header Compression over IPsec (RoHCoIPsec)</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="IPsec Extensions to Support Robust Header Compression over IPsec (RoHCoIPsec)">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">E. Ertekin</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">J. Pezeshki</td></tr>
<tr><td class="header">Expires: February 17, 2009</td><td class="header">M. Casey</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">C. Christou</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Booz Allen Hamilton</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">C. Bormann</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Universitaet Bremen TZI</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">August 16, 2008</td></tr>
</table></td></tr></table>
<h1><br />IPsec Extensions to Support Robust Header Compression over IPsec (RoHCoIPsec)<br />draft-ietf-rohc-ipsec-extensions-hcoipsec-02</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on February 17, 2009.</p>

<h3>Abstract</h3>

<p>
   Integrating RoHC with IPsec (RoHCoIPsec) offers the combined benefits
   of IP security services and efficient bandwidth utilization.  However, 
   extensions to the SPD and SAD are required in order to integrate RoHC 
   with IPsec.  This document describes the IPsec extensions required 
   to support RoHCoIPsec.
                        
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#anchor2">2.</a>&nbsp;
Extensions to IPsec Databases<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">2.1.</a>&nbsp;
Security Policy Database (SPD)<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">2.2.</a>&nbsp;
Security Association Database (SAD)<br />
<a href="#anchor5">3.</a>&nbsp;
Extensions to IPsec Processing<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">3.1.</a>&nbsp;
Addition to the IANA Protocol Numbers Registry<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">3.2.</a>&nbsp;
Verifying the Integrity of Decompressed Packet Headers<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">3.2.1.</a>&nbsp;
ICV Computation and Integrity Verification<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">3.3.</a>&nbsp;
Nested IPComp and RoHCoIPsec Processing<br />
<a href="#anchor10">4.</a>&nbsp;
Security Considerations<br />
<a href="#anchor11">5.</a>&nbsp;
IANA Considerations<br />
<a href="#anchor12">6.</a>&nbsp;
Acknowledgments<br />
<a href="#rfc.references1">7.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">7.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">7.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>
   Using IPsec ([IPSEC]) protection offers various security services for
   IP traffic.  However, these
   benefits come at the cost of additional packet headers, which
   increase packet overhead.  As described in [ROHCOIPSEC], Robust
   Header Compression (RoHC [ROHC]) can be used with IPsec to reduce the
   overhead associated with IPsec-protected packets.
                        
</p>
<p>
   IPsec-protected traffic is carried over Security
   Associations (SAs), whose parameters are negotiated on a case-by-case
   basis.  The Security Policy Database (SPD) specifies the services
   that are to be offered to IP datagrams, and the parameters associated
   with SAs that have been established are stored in the Security
   Association Database (SAD).  To integrate RoHC and IPsec,
   various extensions to the SPD and SAD that incorporate RoHC-relevant
   parameters are required.
                        
</p>
<p>
   In addition, three extensions to IPsec processing are
   required.  First, a mechanism for identifying RoHC packets must be
   defined.  Second, a mechanism is required to ensure the integrity of the 
   decompressed packet.  Finally, the order of the inbound and outbound 
   processing must be enumerated when nesting IP Compression (IPComp [IPCOMP]), RoHC, and IPsec processing. 
                        
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Extensions to IPsec Databases</h3>

<p>
   The following subsections specify extensions to the SPD and the SAD
   to support RoHCoIPsec.
			
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
Security Policy Database (SPD)</h3>

<p>
   In general, the SPD is responsible for specifying the security
   services that are offered to IP datagrams.  Entries in the SPD
   specify how to derive the corresponding values for SAD entries.  To
   support RoHC, the SPD must be extended to include per-channel RoHC
   parameters.  Together, the existing IPsec SPD parameters and the 
   RoHC parameters will dictate the services that are provided to 
   packets protected by IPsec.
			
</p>
<p>
   The fields contained within each SPD entry are defined in [IPSEC],
   Section 4.4.1.2.  To support RoHC, several processing info fields
   must be added to the SPD; these fields contain information regarding
   the RoHC profiles and channel parameters supported by the local RoHC
   instance.   
			
</p>
<p>
      The SPD specifies what services are to be offered to IP datagrams, 
      and in what fashion.  To offer IP datagrams compression services, 
      the per-channel configuration parameters, defined in [ROHC], are 
      added to the SPD. Specifically, the following parameters must be 
      included if the processing info field in the SPD is set to PROTECT (suggested values for these parameters are consistent with [ROHCPPP]):
			
</p>
<p>
</p>
<blockquote class="text">
<p>
      MAX_CID: The highest context ID number to be used by the compressor.  
      MAX_CID must be at least 0 and at most 16383 (The value 0 implies having one context).  The suggested value for MAX_CID is 15.
				
</p>
</blockquote>
<p>
</p>
<blockquote class="text">
<p>
      PROFILES: This indicates the RoHC profiles supported by the
      decompressor.  The list of possible values this field may assume
      is defined in the [ROHCPROF] registry.
				
</p>
</blockquote>
<p>
</p>
<blockquote class="text">
<p>
      MRRU: The size of the largest reconstructed unit that the
      decompressor is expected to reassemble from segments.  In general,
      it is not anticipated that a RoHCoIPsec instance will use RoHC
      segmentation.  Consequently, the suggested value for MRRU
      is 0.
				
</p>
</blockquote>
<p>
</p>
<blockquote class="text">
<p>
      MAX_HEADER: The largest header size (in octets) that can be
      compressed.  Note that the four RoHC profiles defined in RFC 3095
      do not provide for a MAX_HEADER parameter.  The parameter
      MAX_HEADER is therefore without consequence in these profiles.
      Other profiles (e.g., ones based on RFC 2507) can make use of the
      parameter by explicitly referencing it.
				
</p>
</blockquote>
<p>
</p>
<p>
   Note: The RoHC LARGE_CIDS channel parameter is set implicitly, based
   on the value of MAX_CID.  Furthermore, if a SA in the reverse direction 
   exists, the RoHC FEEDBACK_FOR channel parameter is set implicitly to 
   the RoHC channel associated with the SA in the reverse direction.  If 
   a SA in the reverse direction does not exist, RoHC must 
   operate in the Unidirectional Mode.  Because both of these RoHC channel
   parameters are set implicitly, they are not stored in the SPD.
			
</p>
<p>
   In addition to these RoHC channel parameters, a field within the SPD 
   entry is required to store a list of integrity algorithms supported 
   by the RoHCoIPsec instance.  This integrity algorithm will be used by 
   the RoHC process to ensure that packet headers are properly 
   decompressed (see Section 3.2).
                        
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
Security Association Database (SAD)</h3>

<p>
   Each entry within the SAD defines the parameters associated with each
   established SA.  Unless if the "populate from packet" (PFP) flag is
   asserted for a particular field, SAD entries are determined by the
   corresponding SPD entries during the creation of the SA.
				
</p>
<p>
   The data items contained within the SAD are defined in [IPSEC],
   Section 4.4.2.1.  To support RoHC, this list of data items is
   augmented to include a "RoHC Data Item" field that defines the RoHC
   parameters.  These parameters (i.e., MAX_CID, PROFILES, MRRU, and
   MAX_HEADER) are enumerated above in Section 2.1.  In addition, the
   FEEDBACK_FOR parameter is also included, which is associated with the
   SA in the reverse direction (this data item does not need to be included
   in the SPD, since its value is implicitly derived).  Finally, two 
   additional data items 
   are required to store the Integrity Algorithm and respective key that 
   is to be used to ensure that packets are properly decompressed 
   (see Section 3.2).  
</p>
<p>These "RoHC Data Item" values
   may be initialized manually (i.e., administratively configured for
   manual SAs), or initialized via a key exchange protocol (e.g.  IKEv2
   [IKEV2]) that has been extended to support the negotiation of RoHC
   parameters [IKEV2EXT].
				
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Extensions to IPsec Processing</h3>

<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Addition to the IANA Protocol Numbers Registry</h3>

<p>
   In order to demultiplex header-compressed from uncompressed traffic
   on a RoHC-enabled SA, a "RoHC" value must be reserved in the IANA
   Protocol Numbers registry.  If an outbound packet has a compressed
   header, the Next Header field of the security protocol header (e.g.,
   AH [AH], ESP [ESP]) must be set to the "RoHC" protocol identifer.  If
   the packet header has not been compressed, the Next Header field
   remains unaltered.  Conversely, for an inbound packet, the value of
   the security protocol Next Header field is checked to determine if
   the packet includes a RoHC header.
				
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Verifying the Integrity of Decompressed Packet Headers</h3>

<p>
   Since RoHC is inherently a lossy algorithm, RoHCoIPsec will use an additional Integrity Algorithm (and respective
   key) to compute a second Integrity Check Value (ICV) for the
   uncompressed packet.  Specifically, this ICV will be computed for the uncompressed IP header, as well at the higher-layer headers and the packet payload.  This ICV will be appended to the RoHC-compressed packet.  At the decompressor, the
   decompressed packet (including the uncompressed IP header, higher-layer headers, and packet payload; but not including the authentication data) will be used with the Integrity Algorithm (and
   its respective key) to compute a value that will be compared to the
   ICV.  If these values are not identical, the decompressed packet must
   be dropped by the decompressor.
				
</p>
<p>Figure 1 illustrates the composition of a RoHCoIPsec-processed IPv4 packet.  In the example, TCP/IP compression is applied, and the packet is processed with tunnel mode ESP.
</p>
<p> 
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
             BEFORE COMPRESSION AND APPLICATION OF ESP
             ----------------------------
       IPv4  |orig IP hdr  |     |      |
             |(any options)| TCP | Data |
             ----------------------------

	      AFTER ROHCOIPSEC COMPRESSION AND APPLICATION OF ESP
            ------------------------------------------------------
      IPv4  | new IP hdr  |     | Cmpr  |    | RoHC | ESP   | ESP|
            |(any options)| ESP | Hdr.  |Data| ICV  |Trailer| ICV|
            ------------------------------------------------------

</pre></div>
<p>Figure 1. Example of a RoHCoIPsec-processed packet.
</p>
<p>
Note: The authentication data should never be included in the calculation of the ICV.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.1"></a><h3>3.2.1.&nbsp;
ICV Computation and Integrity Verification</h3>

<p>
In order to correctly verify the integrity of the decompressed packets, the processing steps for RoHCoIPsec must be implemented in a specific order, as given below.
					
</p>
<p>For outbound packets that are to be processed by RoHC:
						</p>
<ul class="text">
<li>
An ICV is computed for the uncompressed packet via RoHCoIPsec's Integrity Algorithm (and respective key)
							
</li>
<li>
The packet is compressed by the RoHC process
							
</li>
<li>
The ICV is appended to the end of the compressed packet
							
</li>
<li>
The security protocol is applied to the packet
							
</li>
</ul><p>
					
</p>
<p>For inbound packets that are to be decompressed by RoHC:
						</p>
<ul class="text">
<li>
A packet received on a RoHC-enabled SA is IPsec-processed
							
</li>
<li>
The packet is decompressed by the RoHC process
							
</li>
<li>
The decompressed packet is used with the Integrity Algorithm (and its respective key) to compute a value that is compared to the ICV (if these two values differ, the packet is dropped)
							
</li>
</ul><p>
					
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
Nested IPComp and RoHCoIPsec Processing</h3>

<p>
   IPComp ([IPCOMP]) is another mechanism that can be implemented to
   reduce the size of an IP datagram.  If IPComp and RoHCoIPsec are
   implemented in a nested fashion, the order of the outbound and
   inbound processing steps must be carefully enumerated.
				
</p>
<p>
For outbound packets that are to be processed by IPcomp and RoHC:
					</p>
<ul class="text">
<li>
The ICV is computed for the uncompressed packet, and the appropriate RoHC compression profile is applied to the packet
						
</li>
<li>
IPComp is applied, and the packet is sent to the IPsec process
						
</li>
<li>
The security protocol is applied to the packet
						
</li>
</ul><p>
				
</p>
<p>
Conversely, for inbound packets that are to be both RoHC- and IPcomp-decompressed:
					</p>
<ul class="text">
<li>
A packet received on a RoHC-enabled SA is IPsec-processed
						
</li>
<li>
The datagram is decompressed based on the appropriate IPComp algorithm
						
</li>
<li>
The packet is sent to the RoHC module for header decompression and integrity verification
						
</li>
</ul><p>
				
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Security Considerations</h3>

<p>
   A RoHCoIPsec implementer should consider the strength of protection 
   provided by the integrity check algorithm used to verify the valid 
   decompression of RoHC-compressed packets.  Failure to implement a 
   strong integrity check algorithm increases the probability of an 
   invalidly decompressed packet to be forwarded by a RoHCoIPsec device 
   into a protected domain.  In general, if an integrity check algorithm 
   is used with IPsec, it is recommended that the integrity check 
   algorithm used by RoHC is at least the same strength.
			
</p>
<p>
   The implementation of RoHCoIPsec may increase the susceptibility for traffic
   flow analysis, where an attacker can
   identify new traffic flows by monitoring the relative size of the
   encrypted packets (i.e. a group of "long" packets, followed by a long
   series of "short" packets may indicate a new flow for some RoHCoIPsec
   implementations).  To mitigate this concern, RoHC padding mechanisms
   may be used to arbitrarily add padding to transmitted packets to
   randomize packet sizes.
			
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
IANA Considerations</h3>

<p>
   IANA is requested to allocate one value within the "Protocol Numbers"
   registry [PROTOCOL] for "RoHC".  This value will be used to indicate
   that the next level protocol header is a RoHC header.
			
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Acknowledgments</h3>

<p>
   The authors would like to thank Mr. Sean O'Keeffe, Mr. James Kohler,
   Ms. Linda Noone of the Department of Defense, and Mr. A. Rich Espy of
   OPnet for their contributions and support for developing this
   document.  In addition, the authors would like to thank Mr. Rohan
   Jasani for his valuable assistance.  Finally, the authors would like
   to thank the following for their numerous reviews and comments to
   this document:
			
</p>
<p>
				</p>
<ul class="text">
<li>Dr. Stephen Kent
</li>
<li>Dr. Carsten Bormann
</li>
<li>Mr. Lars-Erik Jonnson
</li>
<li>Mr. Pasi Eronen
</li>
<li>Dr. Joseph Touch
</li>
</ul><p>
			
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>7.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="IPSEC">[IPSEC]</a></td>
<td class="author-text">Kent, S. and K. Seo, &ldquo;<a href="http://tools.ietf.org/html/rfc4301">Security Architecture for the Internet Protocol</a>,&rdquo; RFC&nbsp;4301, December&nbsp;2005.</td></tr>
<tr><td class="author-text" valign="top"><a name="ROHC">[ROHC]</a></td>
<td class="author-text">Bormann, C., Burmeister, C., Degermark, M., Fukushima, H., Hannu, H., Jonsson, L., Hakenberg, R., Koren, T., Le, K., Liu, Z., Martensson, A., Miyazaki, A., Svanbro, K., Wiebke, T., Yoshimura, T., and H. Zheng, &ldquo;<a href="http://tools.ietf.org/html/rfc3095">RObust Header Compression (ROHC): Framework and four profiles: RTP, UDP, ESP, and uncompressed</a>,&rdquo; RFC&nbsp;3095, July&nbsp;2001.</td></tr>
<tr><td class="author-text" valign="top"><a name="IPCOMP">[IPCOMP]</a></td>
<td class="author-text">Shacham, A., Monsour, R., Pereira, and Thomas, &ldquo;<a href="http://tools.ietf.org/html/rfc3173">IP Payload Compression Protocol (IPComp)</a>,&rdquo; RFC&nbsp;3173, September&nbsp;2001.</td></tr>
<tr><td class="author-text" valign="top"><a name="ROHCPPP">[ROHCPPP]</a></td>
<td class="author-text">Bormann, C., &ldquo;<a href="http://tools.ietf.org/html/rfc3241">Robust Header Compression (ROHC) over PPP</a>,&rdquo; RFC&nbsp;3241, April&nbsp;2002.</td></tr>
<tr><td class="author-text" valign="top"><a name="IKEV2">[IKEV2]</a></td>
<td class="author-text">Kaufman, C., &ldquo;<a href="http://tools.ietf.org/html/rfc4306">Internet Key Exchange (IKEv2) Protocol</a>,&rdquo; RFC&nbsp;4306, December&nbsp;2005.</td></tr>
<tr><td class="author-text" valign="top"><a name="IKEV2EXT">[IKEV2EXT]</a></td>
<td class="author-text">Pezeshki, J., Ertekin, E., and C. Christou, &ldquo;Extensions to IKEv2 to Support Robust Header Compression over IPsec (RoHCoIPsec),&rdquo; work in progress&nbsp;, August&nbsp;2008.</td></tr>
<tr><td class="author-text" valign="top"><a name="AH">[AH]</a></td>
<td class="author-text">Kent, S., &ldquo;<a href="http://tools.ietf.org/html/rfc4302">IP Authentication Header</a>,&rdquo; RFC&nbsp;4302, December&nbsp;2005.</td></tr>
<tr><td class="author-text" valign="top"><a name="ESP">[ESP]</a></td>
<td class="author-text">Kent, S., &ldquo;<a href="http://tools.ietf.org/html/rfc4303">IP Encapsulating Security Payload (ESP)</a>,&rdquo; RFC&nbsp;4303, December&nbsp;2005.</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>7.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="ROHCOIPSEC">[ROHCOIPSEC]</a></td>
<td class="author-text">Ertekin, E. and C. Christou, &ldquo;Integration of Header Compression over IPsec Security Associations,&rdquo; work in progress&nbsp;, August&nbsp;2008.</td></tr>
<tr><td class="author-text" valign="top"><a name="ROHCPROF">[ROHCPROF]</a></td>
<td class="author-text">&ldquo;RObust Header Compression (ROHC) Profile Identifiers,&rdquo; www.iana.org/assignments/rohc-pro-ids&nbsp;, October&nbsp;2005.</td></tr>
<tr><td class="author-text" valign="top"><a name="PROTOCOL">[PROTOCOL]</a></td>
<td class="author-text">IANA, &ldquo;"Assigned Internet Protocol Numbers", IANA registry at: http://www.iana.org/assignments/protocol-numbers.&rdquo;</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Emre Ertekin</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Booz Allen Hamilton</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">13200 Woodland Park Dr.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Herndon, VA  20171</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:ertekin_emre@bah.com">ertekin_emre@bah.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Jonah Pezeshki</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Booz Allen Hamilton</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">13200 Woodland Park Dr.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Herndon, VA  20171</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:pezeshki_jonah@bah.com">pezeshki_jonah@bah.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Michele Casey</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Booz Allen Hamilton</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">13200 Woodland Park Dr.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Herndon, VA  20171</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:casey_michele@bah.com">casey_michele@bah.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Chris Christou</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Booz Allen Hamilton</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">13200 Woodland Park Dr.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Herndon, VA  20171</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:christou_chris@bah.com">christou_chris@bah.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Carsten Bormann</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Universitaet Bremen TZI</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Postfach 330440</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Bremen  D-28334</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Germany</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:cabo@tzi.org">cabo@tzi.org</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2008).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
