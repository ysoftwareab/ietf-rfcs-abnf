<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Operational Guidance for Deployment of L4S in the Internet</title>
<meta content="Greg White" name="author">
<meta content="
       This document is intended to provide guidance in order to ensure successful deployment of Low Latency Low Loss Scalable throughput (L4S) in the Internet. Other L4S documents provide guidance for running an L4S experiment, but this document is focused solely on potential interactions between L4S flows and flows using the original ('Classic') ECN over a Classic ECN bottleneck link. The document discusses the potential outcomes of these interactions, describes mechanisms to detect the presence of Classic ECN bottlenecks, and identifies opportunities to prevent and/or detect and resolve fairness problems in such networks. This guidance is aimed at operators of end-systems, operators of networks, and researchers. 
    " name="description">
<meta content="xml2rfc 3.9.1" name="generator">
<meta name="keyword">
<meta content="draft-ietf-tsvwg-l4sops-01" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.9.1
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.5.1
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.6.3
    pycountry 20.7.3
    pyflakes 2.3.1
    PyYAML 5.4.1
    requests 2.25.1
    setuptools 57.0.0
    six 1.16.0
-->
<link href="/tmp/draft-ietf-tsvwg-l4sops-01-4y79wn40.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">L4S Operational Guidance</td>
<td class="right">July 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">White</td>
<td class="center">Expires 13 January 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Transport Area Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-tsvwg-l4sops-01</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2021-07-12" class="published">12 July 2021</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-01-13">13 January 2022</time></dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">G. White, <span class="editor">Ed.</span>
</div>
<div class="org">CableLabs</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Operational Guidance for Deployment of L4S in the Internet</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document is intended to provide guidance in order to ensure successful deployment of Low Latency Low Loss Scalable throughput (L4S) in the Internet. Other L4S documents provide guidance for running an L4S experiment, but this document is focused solely on potential interactions between L4S flows and flows using the original ('Classic') ECN over a Classic ECN bottleneck link. The document discusses the potential outcomes of these interactions, describes mechanisms to detect the presence of Classic ECN bottlenecks, and identifies opportunities to prevent and/or detect and resolve fairness problems in such networks. This guidance is aimed at operators of end-systems, operators of networks, and researchers.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo-3">
<a href="#name-status-of-this-memo-3" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 13 January 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice-3">
<a href="#name-copyright-notice-3" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents-3">
<a href="#name-table-of-contents-3" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="ulEmpty toc compact ulBare">
<li class="ulEmpty toc compact ulBare" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction-3" class="xref">Introduction</a></p>
</li>
          <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="xref">2</a>.  <a href="#name-per-flow-fairness" class="xref">Per-Flow Fairness</a></p>
</li>
          <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1" class="keepWithNext"><a href="#section-3" class="xref">3</a>.  <a href="#name-flow-queuing-systems" class="xref">Flow Queuing Systems</a></p>
</li>
          <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-detection-of-classic-ecn-bo" class="xref">Detection of Classic ECN Bottlenecks</a></p>
<ul class="ulBare toc ulEmpty compact">
<li class="ulBare toc ulEmpty compact" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-recent-studies" class="xref">Recent Studies</a></p>
</li>
              <li class="ulBare toc ulEmpty compact" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-future-experiments" class="xref">Future Experiments</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-operator-of-an-l4s-host" class="xref">Operator of an L4S host</a></p>
<ul class="ulBare toc ulEmpty compact">
<li class="ulBare toc ulEmpty compact" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-server-type" class="xref">Server Type</a></p>
<ul class="ulBare toc ulEmpty compact">
<li class="ulBare toc ulEmpty compact" id="section-toc.1-1.5.2.1.2.1">
                    <p id="section-toc.1-1.5.2.1.2.1.1"><a href="#section-5.1.1" class="xref">5.1.1</a>.  <a href="#name-general-purpose-servers-eg-" class="xref">General purpose servers (e.g. web servers)</a></p>
</li>
                  <li class="ulBare toc ulEmpty compact" id="section-toc.1-1.5.2.1.2.2">
                    <p id="section-toc.1-1.5.2.1.2.2.1"><a href="#section-5.1.2" class="xref">5.1.2</a>.  <a href="#name-specialized-servers-handlin" class="xref">Specialized servers handling long-running sessions (e.g. cloud gaming)</a></p>
</li>
                </ul>
</li>
              <li class="ulBare toc ulEmpty compact" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-server-deployment-environme" class="xref">Server deployment environment</a></p>
<ul class="ulBare toc ulEmpty compact">
<li class="ulBare toc ulEmpty compact" id="section-toc.1-1.5.2.2.2.1">
                    <p id="section-toc.1-1.5.2.2.2.1.1"><a href="#section-5.2.1" class="xref">5.2.1</a>.  <a href="#name-edge-servers" class="xref">Edge Servers</a></p>
</li>
                  <li class="ulBare toc ulEmpty compact" id="section-toc.1-1.5.2.2.2.2">
                    <p id="section-toc.1-1.5.2.2.2.2.1"><a href="#section-5.2.2" class="xref">5.2.2</a>.  <a href="#name-other-hosts" class="xref">Other hosts</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-operator-of-a-network-emplo" class="xref">Operator of a Network Employing RFC3168 FIFO Bottlenecks</a></p>
<ul class="ulBare toc ulEmpty compact">
<li class="ulBare toc ulEmpty compact" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-preferred-options" class="xref">Preferred Options</a></p>
<ul class="ulBare toc ulEmpty compact">
<li class="ulBare toc ulEmpty compact" id="section-toc.1-1.6.2.1.2.1">
                    <p id="section-toc.1-1.6.2.1.2.1.1"><a href="#section-6.1.1" class="xref">6.1.1</a>.  <a href="#name-upgrade-aqms-to-an-l4s-awar" class="xref">Upgrade AQMs to an L4S-aware AQM</a></p>
</li>
                  <li class="ulBare toc ulEmpty compact" id="section-toc.1-1.6.2.1.2.2">
                    <p id="section-toc.1-1.6.2.1.2.2.1"><a href="#section-6.1.2" class="xref">6.1.2</a>.  <a href="#name-configure-non-coupled-dual-" class="xref">Configure Non-Coupled Dual Queue with Shallow Target</a></p>
</li>
                  <li class="ulBare toc ulEmpty compact" id="section-toc.1-1.6.2.1.2.3">
                    <p id="section-toc.1-1.6.2.1.2.3.1"><a href="#section-6.1.3" class="xref">6.1.3</a>.  <a href="#name-approximate-fair-dropping" class="xref">Approximate Fair Dropping</a></p>
</li>
                  <li class="ulBare toc ulEmpty compact" id="section-toc.1-1.6.2.1.2.4">
                    <p id="section-toc.1-1.6.2.1.2.4.1"><a href="#section-6.1.4" class="xref">6.1.4</a>.  <a href="#name-replace-rfc3168-fifo-with-r" class="xref">Replace RFC3168 FIFO with RFC3168 FQ</a></p>
</li>
                  <li class="ulBare toc ulEmpty compact" id="section-toc.1-1.6.2.1.2.5">
                    <p id="section-toc.1-1.6.2.1.2.5.1"><a href="#section-6.1.5" class="xref">6.1.5</a>.  <a href="#name-do-nothing" class="xref">Do Nothing</a></p>
</li>
                </ul>
</li>
              <li class="ulBare toc ulEmpty compact" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-less-preferred-options" class="xref">Less Preferred Options</a></p>
<ul class="ulBare toc ulEmpty compact">
<li class="ulBare toc ulEmpty compact" id="section-toc.1-1.6.2.2.2.1">
                    <p id="section-toc.1-1.6.2.2.2.1.1"><a href="#section-6.2.1" class="xref">6.2.1</a>.  <a href="#name-configure-non-coupled-dual-q" class="xref">Configure Non-Coupled Dual Queue Treating ECT(1) as NotECT</a></p>
</li>
                  <li class="ulBare toc ulEmpty compact" id="section-toc.1-1.6.2.2.2.2">
                    <p id="section-toc.1-1.6.2.2.2.2.1"><a href="#section-6.2.2" class="xref">6.2.2</a>.  <a href="#name-wred-with-ect1-differentati" class="xref">WRED with ECT(1) Differentation</a></p>
</li>
                  <li class="ulBare toc ulEmpty compact" id="section-toc.1-1.6.2.2.2.3">
                    <p id="section-toc.1-1.6.2.2.2.3.1"><a href="#section-6.2.3" class="xref">6.2.3</a>.  <a href="#name-configure-aqm-to-treat-ect1" class="xref">Configure AQM to treat ECT(1) as NotECT</a></p>
</li>
                  <li class="ulBare toc ulEmpty compact" id="section-toc.1-1.6.2.2.2.4">
                    <p id="section-toc.1-1.6.2.2.2.4.1"><a href="#section-6.2.4" class="xref">6.2.4</a>.  <a href="#name-ect1-tunnel-bypass" class="xref">ECT(1) Tunnel Bypass</a></p>
</li>
                </ul>
</li>
              <li class="ulBare toc ulEmpty compact" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="xref">6.3</a>.  <a href="#name-last-resort-options" class="xref">Last Resort Options</a></p>
<ul class="ulBare toc ulEmpty compact">
<li class="ulBare toc ulEmpty compact" id="section-toc.1-1.6.2.3.2.1">
                    <p id="section-toc.1-1.6.2.3.2.1.1"><a href="#section-6.3.1" class="xref">6.3.1</a>.  <a href="#name-disable-rfc3168-support" class="xref">Disable RFC3168 Support</a></p>
</li>
                  <li class="ulBare toc ulEmpty compact" id="section-toc.1-1.6.2.3.2.2">
                    <p id="section-toc.1-1.6.2.3.2.2.1"><a href="#section-6.3.2" class="xref">6.3.2</a>.  <a href="#name-re-mark-ect1-to-notect-prio" class="xref">Re-mark ECT(1) to NotECT Prior to AQM</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-operator-of-a-network-employ" class="xref">Operator of a Network Employing RFC3168 FQ Bottlenecks</a></p>
</li>
          <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-conclusion-of-the-l4s-exper" class="xref">Conclusion of the L4S experiment</a></p>
<ul class="ulBare toc ulEmpty compact">
<li class="ulBare toc ulEmpty compact" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="xref">8.1</a>.  <a href="#name-termination-of-a-successful" class="xref">Termination of a successful L4S experiment</a></p>
</li>
              <li class="ulBare toc ulEmpty compact" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="xref">8.2</a>.  <a href="#name-termination-of-an-unsuccess" class="xref">Termination of an unsuccessful L4S experiment</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-contributors" class="xref">Contributors</a></p>
</li>
          <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-iana-considerations-3" class="xref">IANA Considerations</a></p>
</li>
          <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>. <a href="#name-security-considerations-3" class="xref">Security Considerations</a></p>
</li>
          <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="xref">12</a>. <a href="#name-informative-references-2" class="xref">Informative References</a></p>
</li>
          <li class="ulEmpty toc compact ulBare" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-A" class="xref"></a><a href="#name-authors-address" class="xref">Author's Address</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<section id="section-1">
      <h2 id="name-introduction-3">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction-3" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1"><span><a href="#I-D.ietf-tsvwg-l4s-arch" class="xref">Low-latency, low-loss, scalable throughput (L4S)</a> [<a href="#I-D.ietf-tsvwg-l4s-arch" class="xref">I-D.ietf-tsvwg-l4s-arch</a>]</span> traffic is designed to provide lower queuing delay than conventional traffic via a new network service based on a modified Explicit Congestion Notification (ECN) response from the network.  L4S traffic is identified by the ECT(1) codepoint, and network bottlenecks that support L4S should congestion-mark ECT(1) packets to enable L4S congestion feedback.  However, L4S traffic is also expected to coexist well with classic congestion controlled traffic even if the bottleneck queue does not support L4S.  This includes paths where the bottleneck link utilizes packet drops in response to congestion (either due to buffer overrun or active queue management), as well as paths that implement a 'flow-queuing' scheduler such as fq_codel <span>[<a href="#RFC8290" class="xref">RFC8290</a>]</span>.  A potential area of poor interoperability lies in network bottlenecks employing a shared queue that implements an Active Queue Management (AQM) algorithm that provides Explicit Congestion Notification signaling according to <span>[<a href="#RFC3168" class="xref">RFC3168</a>]</span>.  RFC3168 has been updated (via <span>[<a href="#RFC8311" class="xref">RFC8311</a>]</span>) to reserve ECT(1) for experimental use only (also see <span>[<a href="#IANA-ECN" class="xref">IANA-ECN</a>]</span>), and its use for L4S has been specified in <span>[<a href="#I-D.ietf-tsvwg-ecn-l4s-id" class="xref">I-D.ietf-tsvwg-ecn-l4s-id</a>]</span>. However, any deployed RFC3168 AQMs might not be updated, and RFC8311 still prefers that routers not involved in L4S experimentation treat ECT(1) and ECT(0) as equivalent.  It has been demonstrated <span>[<a href="#Briscoe" class="xref">Briscoe</a>]</span> that when a set of long-running flows comprising both classic congestion controlled flows and L4S-compliant congestion controlled flows compete for bandwidth in such a legacy shared RFC3168 queue, the classic congestion controlled flows may achieve lower throughput than they would have if all of the flows had been classic congestion controlled flows.  This 'unfairness' between the two classes is more pronounced on longer RTT paths (e.g. 50ms and above) and/or at higher link rates (e.g. 50 Mbps and above). The lower the capacity per flow, the less pronounced the problem becomes. Thus the imbalance is most significant when the slowest flow rate is still high in absolute terms.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">The root cause of the unfairness is that the L4S architecture redefines the congestion signal (CE mark) and congestion response in the case of packets marked ECT(1) (used by L4S senders), whereas a RFC3168 queue does not differentiate between packets marked ECT(0) (used by classic senders) and those marked ECT(1), and provides CE marks identically to both types. The classic senders expect that CE marks are sent very rarely (e.g. approximately 1 CE mark every 200 round trips on a 50 Mbps x 50ms path) while the L4S senders expect very frequent CE marking (e.g. approximately 2 CE marks per round trip).  The result is that the classic senders respond to the CE marks provided by the bottleneck by yielding capacity to the L4S flows.  The resulting rate imbalance can be demonstrated, and could be a cause of concern in some cases.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">This concern primarily relates to single-queue (FIFO) bottleneck links that implement RFC3168 ECN, but the situation can also potentially occur with per-flow queuing, e.g. fq_codel <span>[<a href="#RFC8290" class="xref">RFC8290</a>]</span>, when flow isolation is imperfect due to hash collisions or VPN tunnels.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">While the above mentioned unfairness has been demonstrated in laboratory testing, it has not been observed in operational networks, in part because members of the Transport Working group are not aware of any deployments of single-queue Classic ECN bottlenecks in the Internet.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">This issue was considered in November 2015 (and reaffirmed in April 2020) when the WG decided on the identifier to use for L4S, as recorded in Appendix B.1 of <span>[<a href="#I-D.ietf-tsvwg-ecn-l4s-id" class="xref">I-D.ietf-tsvwg-ecn-l4s-id</a>]</span>. It was recognized that compromises would have to be made because IP header space is extremely limited. A number of alternative codepoint schemes were compared for their ability to traverse most Internet paths, to work over tunnels, to work at lower layers, to work with TCP, etc.  It was decided to progress on the basis that robust performance in presence of these single-queue RFC3168 bottlenecks is not the most critical issue, since it was believed that they are rare.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">Nonetheless, there is the possibility that such deployments exist, and there is the possibility that they could be deployed/enabled in the future.  Since any negative impact of this coexistence issue would not be directly experienced by the party experimenting with L4S endpoints, but rather by the other users of the bottleneck, there is an interest in providing guidance to ensure that measures can be taken to address the potential issues, should they arise in practice.<a href="#section-1-6" class="pilcrow">¶</a></p>
</section>
<section id="section-2">
      <h2 id="name-per-flow-fairness">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-per-flow-fairness" class="section-name selfRef">Per-Flow Fairness</a>
      </h2>
<p id="section-2-1">There are a number of factors that influence the relative rates achieved by a set of users or a set of applications sharing a queue in a bottleneck link. Notably the response that each application has to congestion signals (whether loss or explicit signaling) can play a large role in determining whether the applications share the bandwidth in an equitable manner. In the Internet, ISPs typically control capacity sharing between their customers using a scheduler at the access bottleneck rather than relying on the congestion responses of end-systems. So in that context this question primarily concerns capacity sharing between the applications used by one customer site.  Nonetheless, there are many networks on the Internet where capacity sharing relies, at least to some extent, on congestion control in the end-systems. The traditional norm for congestion response has been that it is handled on a per-connection basis, and that (all else being equal) it results in each connection in the bottleneck achieving a data rate inversely proportional to the average RTT of the connection. The end result (in the case of steady-state behavior of a set of like connections) is that each user or application achieves a data rate proportional to N/RTT, where N is the number of simultaneous connections that the user or application creates, and RTT is the harmonic mean of the average round-trip-times for those connections. Thus, users or applications that create a larger number of connections and/or that have a lower RTT achieve a larger share of the bottleneck link rate than others.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">While this may not be considered fair by many, it nonetheless has been the typical starting point for discussions around fairness. In fact it has been common when evaluating new congestion responses to actually set aside N &amp; RTT as variables in the equation, and just compare per-flow rates between flows with the same RTT. For example <span>[<a href="#RFC5348" class="xref">RFC5348</a>]</span> defines the congestion response for a flow to be '"reasonably fair" if its sending rate is generally within a factor of two of the sending rate of a [Reno] TCP flow under the same conditions.' Given that RTTs can vary by roughly two orders of magnitude and flow counts can vary by at least an order of magnitude between applications, it seems that the accepted definition of reasonable fairness leaves quite a bit of room for different levels of performance between users or applications, and so perhaps isn't the gold standard, but is rather a metric that is used because of its convenience.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">In practice, the effect of this RTT dependence has historically been muted by the fact that many networks were deployed with very large ("bloated") drop-tail buffers that would introduce queuing delays well in excess of the base RTT of the flows utilizing the link, thus equalizing (to some degree) the effective RTTs of those flows. Recently, as network equipment suppliers and operators have worked to improve the latency performance of the network by the use of smaller buffers and/or AQM algorithms, this has had the side-effect of uncovering the inherent RTT bias in classic congestion control algorithms.<a href="#section-2-3" class="pilcrow">¶</a></p>
<p id="section-2-4">The L4S architecture aims to significantly improve this situation, by requiring senders to adopt a congestion response that eliminates RTT bias as much as possible (see <span>[<a href="#I-D.ietf-tsvwg-ecn-l4s-id" class="xref">I-D.ietf-tsvwg-ecn-l4s-id</a>]</span>). As a result, L4S promotes a level of per-flow fairness beyond what is ordinarily considered for classic senders, the RFC3168 issue notwithstanding.<a href="#section-2-4" class="pilcrow">¶</a></p>
<p id="section-2-5">It is also worth noting that the congestion control algorithms deployed currently on the internet tend toward (RTT-weighted) fairness only over long timescales. For example, the cubic algorithm can take minutes to converge to fairness when a new flow joins an existing flow on a link <span>[<a href="#Ha" class="xref">Ha</a>]</span>. Since the vast majority of TCP connections don't last for minutes, it is unclear to what degree per-flow, same-RTT fairness, even when demonstrated in the lab, translates to the real world.<a href="#section-2-5" class="pilcrow">¶</a></p>
<p id="section-2-6">So, in real networks, where per-application, per-end-host or per-customer fairness may be more important than long-term, same-RTT, per-flow fairness, it may not be that instructive to focus on the latter as being a necessary end goal.<a href="#section-2-6" class="pilcrow">¶</a></p>
<p id="section-2-7">Nonetheless, situations in which the presence of an L4S flow has the potential to cause harm <span>[<a href="#Ware" class="xref">Ware</a>]</span> to classic flows need to be understood. Most importantly, if there are situations in which the introduction of L4S traffic would degrade both the absolute and relative performance of classic traffic significantly, i.e. to the point that it would be considered starvation while L4S was not starved, these situations need to be understood and either remedied or avoided.<a href="#section-2-7" class="pilcrow">¶</a></p>
<p id="section-2-8">Aligned with this context, the guidance provided in this document is aimed not at monitoring the relative performance of L4S senders compared against classic senders on a per-flow basis, but rather at identifying instances where RFC3168 bottlenecks are deployed so that operators of L4S senders can have the opportunity to assess whether any actions need to be taken. Additionally this document provides guidance for network operators around configuring any RFC3168 bottlenecks to minimize the potential for negative interactions between L4S and classic senders.<a href="#section-2-8" class="pilcrow">¶</a></p>
</section>
<div id="FQ">
<section id="section-3">
      <h2 id="name-flow-queuing-systems">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-flow-queuing-systems" class="section-name selfRef">Flow Queuing Systems</a>
      </h2>
<p id="section-3-1">As noted above, the concern around RFC3168 coexistence mainly concerns single-queue systems where classic and L4S traffic are mixed.  In a flow-queuing system, when flow isolation is successful, the FQ scheduling of such queues isolates classic congestion control traffic from L4S traffic, and thus eliminates the potential for unfairness. But, these systems are known to sometimes result in imperfect isolation, either due to hash collisions (see <span><a href="https://rfc-editor.org/rfc/rfc8290#section-5.3" class="relref">Section 5.3</a> of [<a href="#RFC8290" class="xref">RFC8290</a>]</span>), because of VPN tunneling (see <span><a href="https://rfc-editor.org/rfc/rfc8290#section-6.2" class="relref">Section 6.2</a> of [<a href="#RFC8290" class="xref">RFC8290</a>]</span>), or due to deliberate configuration (see <a href="#per-user" class="xref">Section 7, Paragraph 5</a>).<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">It is believed that the majority of FQ deployments in bottleneck links today (e.g. Cake <span>[<a href="#Hoiland-Jorgensen" class="xref">Hoiland-Jorgensen</a>]</span>) employ hashing algorithms that virtually eliminate the possibility of collisions, making this a non-issue for those deployments.  But, VPN tunnels remain an issue for FQ deployments, and the introduction of L4S traffic raises the possibility that tunnels containing mixed classic and L4S traffic would exist, in which case FQ implementations that have not been updated to be L4S-aware could exhibit similar unfairness properties as single queue AQMs.  <a href="#FQrecs" class="xref">Section 7</a> discusses some remedies that can be implemented by operators of FQ equipment in order to minimize this risk. Additionally, end-host mitigations such as separating L4S and Classic traffic into distinct VPN tunnels could be employed.<a href="#section-3-2" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-4">
      <h2 id="name-detection-of-classic-ecn-bo">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-detection-of-classic-ecn-bo" class="section-name selfRef">Detection of Classic ECN Bottlenecks</a>
      </h2>
<p id="section-4-1">The IETF encourages researchers, end system deployers and network operators to conduct experiments to identify to what degree RFC3168 bottlecks exist in networks. These types of measurement campaigns, even if each is conducted over a limited set of paths, could be useful to further understand the scope of any potential issues, to guide end system deployers on where to examine performance more closely (or possibly delay L4S deployment), and to help network operators identify nodes where remediation may be necessary to provide the best performance.<a href="#section-4-1" class="pilcrow">¶</a></p>
<div id="studies">
<section id="section-4.1">
        <h3 id="name-recent-studies">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-recent-studies" class="section-name selfRef">Recent Studies</a>
        </h3>
<p id="section-4.1-1">A small number of recent studies have attempted to gauge the level of RFC3168 AQM deployment in the internet.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">In 2020, Akamai conducted a <a href="https://mailarchive.ietf.org/arch/msg/tsvwg/2tbRHphJ8K_CE6is9n7iQy-VAZM/">study</a> of "downstream" (server to client) CE marking broken out by ASN on two separate days, one in late March, the other in mid July <span>[<a href="#Holland" class="xref">Holland</a>]</span>.  They concluded that prevalence of CE-marking was low across the ~800 ASNs observed (0.19% - 0.30% of ECT client IPs ever saw a CE mark), but it was growing, and that they could not determine whether the CE marking was due to a single queue or FQ. They also observed that RFC3168 AQMs are not uniformly distributed. There were three small ISPs where prevalence of CE-marking was above ~70%, indicating a likely deployment by the ISP.  There were another four small ASNs where the prevalence was between 10% and 20%, which may also indicate deployment by the ISP. There were also roughly six larger ASNs (and perhaps 20 small ASNs) where the prevalence was between 3% and 8%.<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1-3">In 2017, Apple reported on their observations of ECN marking by networks, broken out by country <span>[<a href="#Bhooma" class="xref">Bhooma</a>]</span>.  They reported four countries that exceeded the global baseline seen by Akamai, but one of these (Argentine Republic) was later <a href="https://datatracker.ietf.org/meeting/106/materials/slides-106-tsvwg-sessa-72-l4s-drafts-00#page=15">discovered to be due to a bug</a>, leaving three countries: China 1% of paths, Mexico 3.2% of paths, France 6% of paths. The percentage in France appears consistent with <a href="https://mailarchive.ietf.org/arch/msg/tsvwg/UyvpwUiNw0obd_EylBBV7kDRIHs/">reports</a> that fq_codel has been implemented in DSL home routers deployed by Free.fr.<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1-4">In December 2020 - January 2021, Pete Heist worked with a small cooperative WISP in the Czech Republic to collect data on CE-marking <span>[<a href="#I-D.heist-tsvwg-ecn-deployment-observations" class="xref">I-D.heist-tsvwg-ecn-deployment-observations</a>]</span>. Overall, 18.6% of paths saw possible RFC3168 AQM activity, which appears to place this ISP in the small group with moderately high RFC3168 prevalence reported by Akamai. This ISP was known to have deployed RFC3168 fq_codel equipment in some of their subnets, and in other subnets there were 33 IPs where possible AQM activity was observed via CE-marks and/or ECE flags, corresponding to approximately 10% of paths. It was <a href="https://mailarchive.ietf.org/arch/msg/tsvwg/Rj7GylByZuFa3_LTCMvEfb-CYpw/">agreed</a> that these were likely to be due to fq_codel implementations in home routers deployed by members of the cooperative.<a href="#section-4.1-4" class="pilcrow">¶</a></p>
<p id="section-4.1-5">The interpretation of these studies seems to be that there are no known deployments of FIFO RFC3168, all of the known RFC3168 deployments are fq_codel, the majority of the currently unknown deployments are likely to be fq_codel, and there may be a small number of networks where CE-marking is prevalent (and thus likely ISP-managed) where it is currently unknown as to whether the source is a FIFO or an FQ system.<a href="#section-4.1-5" class="pilcrow">¶</a></p>
<p id="section-4.1-6"> Other studies (e.g. <span>[<a href="#Trammel" class="xref">Trammel</a>]</span>, <span>[<a href="#Bauer" class="xref">Bauer</a>]</span>, <span>[<a href="#Mandalari" class="xref">Mandalari</a>]</span>) have examined ECN traversal, but have not reported data on prevalence of CE-marking by networks. Another <span>[<a href="#Roddav" class="xref">Roddav</a>]</span> examined traces from a Tier 1 ISP link in 2018 and observed that 94% of the non-zero ECN marked packets were CE, which appears to reflect a misconfiguration of equipment using that link, as opposed to providing evidence of RFC3168 AQM deployment.<a href="#section-4.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-4.2">
        <h3 id="name-future-experiments">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-future-experiments" class="section-name selfRef">Future Experiments</a>
        </h3>
<p id="section-4.2-1">The design of future experiments should consider not only the detection of RFC3168 ECN marking, but also the determination whether the bottleneck AQM is a single queue (FIFO) or a flow-queuing (FQ) system. It is believed that the vast majority, if not all, of the RFC3168 AQMs in use at bottleneck links are flow-queuing systems (e.g. fq_codel <span>[<a href="#RFC8290" class="xref">RFC8290</a>]</span> or COBALT <span>[<a href="#Palmei" class="xref">Palmei</a>]</span>).<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2"><span>[<a href="#Briscoe" class="xref">Briscoe</a>]</span> contains recommendations on some of the mechanisms that can be used to detect RFC3168 bottlenecks. In particular, Section 4 of <span>[<a href="#Briscoe" class="xref">Briscoe</a>]</span> outlines an approach for out-band-detection of RFC3168 bottlenecks.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
</section>
</section>
<section id="section-5">
      <h2 id="name-operator-of-an-l4s-host">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-operator-of-an-l4s-host" class="section-name selfRef">Operator of an L4S host</a>
      </h2>
<p id="section-5-1">From a host's perspective, support for L4S only involves the sender via ECT(1) marking &amp; L4S-compatible congestion control. The receiver is involved in ECN feedback but can generally be agnostic to whether ECN is being used for L4S <span>[<a href="#I-D.ietf-tsvwg-l4s-arch" class="xref">I-D.ietf-tsvwg-l4s-arch</a>]</span>. Between these two entities, it is primarily incumbent upon the sender to evaluate the potential for presence of RFC3168 FIFO bottlenecks and make decisions whether or not to use L4S congestion control. While is is possible for a receiver to disable L4S functionality by not negotiating ECN, a general purpose receiver is not expected to perform any testing or monitoring for RFC3168, and is also not expected to invoke any active response in the case that such a bottleneck exists.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">Prior to deployment of any new technology, it is commonplace for the parties involved in the deployment to validate the performance of the new technology via lab testing, limited field testing, large scale field testing, etc., usually in a progressive manner. The same is expected for deployers of L4S technology. As part of that validation, it is recommended that deployers consider the issue of RFC3168 FIFO bottlenecks and conduct experiments as described in the previous section, or otherwise assess the impact that the L4S technology will have in the networks in which it is to be deployed, and take action as is described further in this section. This sort of progressive (incremental) deployment helps to ensure that any issues are discovered when the scale of those issues is relatively small.<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">TODO: discussion of risk of incorrectly classifying a path<a href="#section-5-3" class="pilcrow">¶</a></p>
<section id="section-5.1">
        <h3 id="name-server-type">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-server-type" class="section-name selfRef">Server Type</a>
        </h3>
<p id="section-5.1-1">If pre-deployment testing raises concerns about issues with RFC3168 bottlenecks, the actions taken may depend on the server type.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<section id="section-5.1.1">
          <h4 id="name-general-purpose-servers-eg-">
<a href="#section-5.1.1" class="section-number selfRef">5.1.1. </a><a href="#name-general-purpose-servers-eg-" class="section-name selfRef">General purpose servers (e.g. web servers)</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-5.1.1-1.1">Out-of-band active testing could be performed by the server. For example, a javascript application could run simultaneous downloads (i.e. with and without L4S) during page reading time in order to survey for presence of RFC3168 FIFO bottlenecks on paths to users (e.g. as described in Section 4 of <span>[<a href="#Briscoe" class="xref">Briscoe</a>]</span>).<a href="#section-5.1.1-1.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.1.1-1.2">In-band testing could be built in to the transport protocol implementation at the sender in order to perform detection (see Section 5 of <span>[<a href="#Briscoe" class="xref">Briscoe</a>]</span>, though note that this mechanism does not differentiate between FIFO and FQ).<a href="#section-5.1.1-1.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.1.1-1.3">Discontinuing use of L4S based on the detection of RFC3168 FIFO bottlenecks is likely not needed for short transactional transfers (e.g. sub 10 seconds) since these are unlikely to achieve the steady-state conditions where unfairness has been observed.<a href="#section-5.1.1-1.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.1.1-1.4">For longer file transfers, it may be possible to fall-back to Classic behavior in real-time (i.e. when doing in-band testing), or to cache those destinations where RFC3168 has been detected, and disable L4S for subsequent long file transfers to those destinations.<a href="#section-5.1.1-1.4" class="pilcrow">¶</a>
</li>
          </ul>
</section>
<section id="section-5.1.2">
          <h4 id="name-specialized-servers-handlin">
<a href="#section-5.1.2" class="section-number selfRef">5.1.2. </a><a href="#name-specialized-servers-handlin" class="section-name selfRef">Specialized servers handling long-running sessions (e.g. cloud gaming)</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-5.1.2-1.1">Out-of-band active testing could be performed at each session startup<a href="#section-5.1.2-1.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.1.2-1.2">Out-of-band active testing could be integrated into a "pre-validation" of the service, done when the user signs up, and periodically thereafter<a href="#section-5.1.2-1.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.1.2-1.3">In-band detection as described in <span>[<a href="#Briscoe" class="xref">Briscoe</a>]</span> could be performed during the session<a href="#section-5.1.2-1.3" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</section>
<section id="section-5.2">
        <h3 id="name-server-deployment-environme">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-server-deployment-environme" class="section-name selfRef">Server deployment environment</a>
        </h3>
<p id="section-5.2-1">The responsibilities of and actions taken by a sender may additionally depend on the environment in which it is deployed. The following sub-sections discuss two scenarios: senders serving a limited, known target audience and those that serve an unknown target audience.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<section id="section-5.2.1">
          <h4 id="name-edge-servers">
<a href="#section-5.2.1" class="section-number selfRef">5.2.1. </a><a href="#name-edge-servers" class="section-name selfRef">Edge Servers</a>
          </h4>
<p id="section-5.2.1-1">Some hosts (such as CDN leaf nodes and servers internal to an ISP) are deployed in environments in which they serve content to a constrained set of networks or clients. The operator of such hosts may be able to determine whether there is the possibility of <span>[<a href="#RFC3168" class="xref">RFC3168</a>]</span> FIFO bottlenecks being present, and utilize this information to make decisions on selectively deploying L4S and/or disabling it (e.g. bleaching ECN). Furthermore, such an operator may be able to determine the likelihood of an L4S bottleneck being present, and use this information as well.<a href="#section-5.2.1-1" class="pilcrow">¶</a></p>
<p id="section-5.2.1-2">For example, if a particular network is known to have deployed legacy <span>[<a href="#RFC3168" class="xref">RFC3168</a>]</span> FIFO bottlenecks, usage of L4S for long capacity-seeking file transfers on that network could be delayed until those bottlenecks can be upgraded to mitigate any potential issues as discussed in the next section.<a href="#section-5.2.1-2" class="pilcrow">¶</a></p>
<p id="section-5.2.1-3">Prior to deploying L4S on edge servers a server operator should:<a href="#section-5.2.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.1-4.1">Consult with network operators on presence of legacy <span>[<a href="#RFC3168" class="xref">RFC3168</a>]</span> FIFO bottlenecks<a href="#section-5.2.1-4.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.2.1-4.2">Consult with network operators on presence of L4S bottlenecks<a href="#section-5.2.1-4.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.2.1-4.3">Perform pre-deployment testing per network<a href="#section-5.2.1-4.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-5.2.1-5">If a particular network offers connectivity to other networks (e.g. in the case of an ISP offering service to their customer's networks), the lack of RFC3168 FIFO bottleneck deployment in the ISP network can't be taken as evidence that RFC3168 FIFO bottlenecks don't exist end-to-end (because one may have been deployed by the end-user network). In these cases, deployment of L4S will need to take appropriate steps to detect the presence of such bottlenecks. At present, it is believed that the vast majority of RFC3168 bottlenecks in end-user networks are implementations that utilize fq_codel or Cake, where the unfairness problem is less likely to be a concern. While this doesn't completely eliminate the possibility that a legacy <span>[<a href="#RFC3168" class="xref">RFC3168</a>]</span> FIFO bottleneck could exist, it nonetheless provides useful information that can be utilized in the decision making around the potential risk for any unfairness to be experienced by end users.<a href="#section-5.2.1-5" class="pilcrow">¶</a></p>
</section>
<section id="section-5.2.2">
          <h4 id="name-other-hosts">
<a href="#section-5.2.2" class="section-number selfRef">5.2.2. </a><a href="#name-other-hosts" class="section-name selfRef">Other hosts</a>
          </h4>
<p id="section-5.2.2-1">Hosts that are deployed in locations that serve a wide variety of networks face a more difficult prospect in terms of handling the potential presence of RFC3168 FIFO bottlenecks. Nonetheless, the steps listed in the ealier section (based on server type) can be taken to minimize the risk of unfairness.<a href="#section-5.2.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2.2-2">The interpretation of studies on ECN usage and their deployment context (see <a href="#studies" class="xref">Section 4.1</a>) has so far concluded that RFC3168 FIFO bottlenecks are likely to be rare, and so detections using these techniques may also prove to be rare. Therefore, it may be possible for a host to cache a list of end host ip addresses where a RFC3168 bottleneck has been detected.  Entries in such a cache would need to age-out after a period of time to account for IP address changes, path changes, equipment upgrades, etc. [TODO: more info on ways to cache/maintain such a list]<a href="#section-5.2.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2.2-3">It has been suggested that a public block-list of domains that implement RFC3168 FIFO bottlenecks could be maintained. There are a number of significant issues that would seem to make this idea infeasible, not the least of which is the fact that presence of RFC3168 FIFO bottlenecks or L4S bottlenecks is not a property of a domain, it is the property of a link, and therefore of the particular current path between two endpoints.<a href="#section-5.2.2-3" class="pilcrow">¶</a></p>
<p id="section-5.2.2-4">It has also been suggested that a public allow-list of domains that are participating in the L4S experiment could be maintained. This approach would not be useful, given the presence of an L4S domain on the path does not imply the absence of RFC3168 AQMs upstream or downstream of that domain. Also, the approach cannot cater for domains with a mix of L4S and RFC3168 AQMs.<a href="#section-5.2.2-4" class="pilcrow">¶</a></p>
</section>
</section>
</section>
<section id="section-6">
      <h2 id="name-operator-of-a-network-emplo">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-operator-of-a-network-emplo" class="section-name selfRef">Operator of a Network Employing RFC3168 FIFO Bottlenecks</a>
      </h2>
<p id="section-6-1">While it is more preferable for L4S senders to detect problems themselves, a network operator who has deployed equipment in a likely bottleneck link location (i.e. a link that is expected to frequently be fully saturated) that is configured with a legacy <span>[<a href="#RFC3168" class="xref">RFC3168</a>]</span> FIFO AQM can take certain steps in order to improve rate fairness between classic traffic and L4S traffic, and thus enable L4S to be deployed in a greater number of paths.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">Some of the options listed in this section may not be feasible in all networking equipment.<a href="#section-6-2" class="pilcrow">¶</a></p>
<section id="section-6.1">
        <h3 id="name-preferred-options">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-preferred-options" class="section-name selfRef">Preferred Options</a>
        </h3>
<section id="section-6.1.1">
          <h4 id="name-upgrade-aqms-to-an-l4s-awar">
<a href="#section-6.1.1" class="section-number selfRef">6.1.1. </a><a href="#name-upgrade-aqms-to-an-l4s-awar" class="section-name selfRef">Upgrade AQMs to an L4S-aware AQM</a>
          </h4>
<p id="section-6.1.1-1">If the RFC3168 AQM implementation can be upgraded to enable support for L4S, either via <span>[<a href="#I-D.ietf-tsvwg-aqm-dualq-coupled" class="xref">I-D.ietf-tsvwg-aqm-dualq-coupled</a>]</span> or via an L4S-aware FQ implementation, this is the preferred approach to addressing potential unfairness, because it additionally enables all of the benefits of L4S.<a href="#section-6.1.1-1" class="pilcrow">¶</a></p>
</section>
<div id="non-coupled-shallow">
<section id="section-6.1.2">
          <h4 id="name-configure-non-coupled-dual-">
<a href="#section-6.1.2" class="section-number selfRef">6.1.2. </a><a href="#name-configure-non-coupled-dual-" class="section-name selfRef">Configure Non-Coupled Dual Queue with Shallow Target</a>
          </h4>
<p id="section-6.1.2-1">Equipment supporting <span>[<a href="#RFC3168" class="xref">RFC3168</a>]</span> may be configurable to enable two parallel queues for the same traffic class, with classification done based on the ECN field.<a href="#section-6.1.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1.2-2.1">
              <p id="section-6.1.2-2.1.1">Configure 2 queues, both with ECN; 50:50 WRR scheduler<a href="#section-6.1.2-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1.2-2.1.2.1">Queue #1: ECT(1) &amp; CE packets - Shallow immediate AQM target<a href="#section-6.1.2-2.1.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-6.1.2-2.1.2.2">Queue #2: ECT(0) &amp; NotECT packets - Classic AQM target<a href="#section-6.1.2-2.1.2.2" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li class="normal" id="section-6.1.2-2.2">
              <p id="section-6.1.2-2.2.1">Outcome in the case of n L4S flows and m long-running Classic flows<a href="#section-6.1.2-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1.2-2.2.2.1">if m &amp; n are non-zero, flows get 1/2n and 1/2m of the capacity, otherwise 1/n or 1/m<a href="#section-6.1.2-2.2.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-6.1.2-2.2.2.2">never &lt; 1/2 each flow's rate if all had been Classic<a href="#section-6.1.2-2.2.2.2" class="pilcrow">¶</a>
</li>
              </ul>
</li>
          </ul>
<p id="section-6.1.2-3">This option would allow L4S flows to achieve low latency, low loss and scalable throughput, but would sacrifice the more precise flow balance offered by <span>[<a href="#I-D.ietf-tsvwg-aqm-dualq-coupled" class="xref">I-D.ietf-tsvwg-aqm-dualq-coupled</a>]</span>. This option would be expected to result in some reordering of previously CE marked packets sent by Classic ECN senders, which is a trait shared with <span>[<a href="#I-D.ietf-tsvwg-aqm-dualq-coupled" class="xref">I-D.ietf-tsvwg-aqm-dualq-coupled</a>]</span>. As is discussed in <span>[<a href="#I-D.ietf-tsvwg-ecn-l4s-id" class="xref">I-D.ietf-tsvwg-ecn-l4s-id</a>]</span>, this reordering would be either zero risk or very low risk.<a href="#section-6.1.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-6.1.3">
          <h4 id="name-approximate-fair-dropping">
<a href="#section-6.1.3" class="section-number selfRef">6.1.3. </a><a href="#name-approximate-fair-dropping" class="section-name selfRef">Approximate Fair Dropping</a>
          </h4>
<p id="section-6.1.3-1">The Approximate Fair Dropping (<span>[<a href="#AFD" class="xref">AFD</a>]</span>) algorithm tracks individual flow rates and introduces either packet drops or CE-marks to each flow in proportion to the amount by which the flow rate exceeds a computed per-flow fair-share rate. Where an implementation of AFD or an equivalent algorithm is available, it could be enabled on an interface with a single-queue RFC3168 AQM as a fairly lightweight way to inject additional ECN marks into any significantly higher rate flows. See also <span>[<a href="#Cisco-N9000" class="xref">Cisco-N9000</a>]</span>.<a href="#section-6.1.3-1" class="pilcrow">¶</a></p>
</section>
<section id="section-6.1.4">
          <h4 id="name-replace-rfc3168-fifo-with-r">
<a href="#section-6.1.4" class="section-number selfRef">6.1.4. </a><a href="#name-replace-rfc3168-fifo-with-r" class="section-name selfRef">Replace RFC3168 FIFO with RFC3168 FQ</a>
          </h4>
<p id="section-6.1.4-1">As discussed in Section XREF, implementations of RFC3168 with an FQ scheduler (e.g. fq_codel or Cake) significantly reduce the likelihood of experiencing any unfairness between Classic and L4S traffic.<a href="#section-6.1.4-1" class="pilcrow">¶</a></p>
</section>
<section id="section-6.1.5">
          <h4 id="name-do-nothing">
<a href="#section-6.1.5" class="section-number selfRef">6.1.5. </a><a href="#name-do-nothing" class="section-name selfRef">Do Nothing</a>
          </h4>
<p id="section-6.1.5-1">If it is infeasible to implement any of the above options, it may be preferable for an operator of RFC3168 FIFO bottlenecks to leave them unchanged. In many deployment situations the risk of fairness issues may be very low, and the impact if they occur may not be particularly troublesome. This could, for instance, be true in bottlenecks where there is a high degree of flow aggregation or in high-speed bottlenecks (e.g. greater than 100 Mbps).<a href="#section-6.1.5-1" class="pilcrow">¶</a></p>
</section>
</section>
<section id="section-6.2">
        <h3 id="name-less-preferred-options">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-less-preferred-options" class="section-name selfRef">Less Preferred Options</a>
        </h3>
<p id="section-6.2-1">In the case that there is a concern about per-flow fairness between L4S flows and Classic flows in an RFC3168 FIFO bottleneck, and none of the remedies in the previous section can be implemented, the options listed in this section could be considered.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<div id="non-coupled-notECT">
<section id="section-6.2.1">
          <h4 id="name-configure-non-coupled-dual-q">
<a href="#section-6.2.1" class="section-number selfRef">6.2.1. </a><a href="#name-configure-non-coupled-dual-q" class="section-name selfRef">Configure Non-Coupled Dual Queue Treating ECT(1) as NotECT</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-6.2.1-1.1">
              <p id="section-6.2.1-1.1.1">Configure 2 queues, both with AQM; 50:50 WRR scheduler<a href="#section-6.2.1-1.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2.1-1.1.2.1">Queue #1: ECT(1) &amp; NotECT packets - ECN disabled<a href="#section-6.2.1-1.1.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-6.2.1-1.1.2.2">Queue #2: ECT(0) &amp; CE packets - ECN enabled<a href="#section-6.2.1-1.1.2.2" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li class="normal" id="section-6.2.1-1.2">
              <p id="section-6.2.1-1.2.1">Outcome<a href="#section-6.2.1-1.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2.1-1.2.2.1">ECT(1) treated as NotECT<a href="#section-6.2.1-1.2.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-6.2.1-1.2.2.2">Flow balance for the 2 queues is the same as in <a href="#non-coupled-shallow" class="xref">Section 6.1.2</a><a href="#section-6.2.1-1.2.2.2" class="pilcrow">¶</a>
</li>
              </ul>
</li>
          </ul>
<p id="section-6.2.1-2">This option would not allow L4S flows to achieve low latency, low loss and scalable throughput in this bottleneck link. As a result it is the less preferred option.<a href="#section-6.2.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-6.2.2">
          <h4 id="name-wred-with-ect1-differentati">
<a href="#section-6.2.2" class="section-number selfRef">6.2.2. </a><a href="#name-wred-with-ect1-differentati" class="section-name selfRef">WRED with ECT(1) Differentation</a>
          </h4>
<p id="section-6.2.2-1">This configuration is similar to the option described in <a href="#non-coupled-notECT" class="xref">Section 6.2.1</a>, but uses a single queue with WRED functionality.<a href="#section-6.2.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2.2-2.1">
              <p id="section-6.2.2-2.1.1">Configure the queue with two WRED classes<a href="#section-6.2.2-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2.2-2.1.2.1">Class #1: ECT(1) &amp; NotECT packets - ECN disabled<a href="#section-6.2.2-2.1.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-6.2.2-2.1.2.2">Class #2: ECT(0) &amp; CE packets - ECN enabled<a href="#section-6.2.2-2.1.2.2" class="pilcrow">¶</a>
</li>
              </ul>
</li>
          </ul>
</section>
<section id="section-6.2.3">
          <h4 id="name-configure-aqm-to-treat-ect1">
<a href="#section-6.2.3" class="section-number selfRef">6.2.3. </a><a href="#name-configure-aqm-to-treat-ect1" class="section-name selfRef">Configure AQM to treat ECT(1) as NotECT</a>
          </h4>
<p id="section-6.2.3-1">If equipment is configurable in such a way as to only supply CE marks to ECT(0) packets, and treat ECT(1) packets identically to NotECT, or is upgradable to support this capability, doing so will eliminate the risk of unfairness.<a href="#section-6.2.3-1" class="pilcrow">¶</a></p>
</section>
<section id="section-6.2.4">
          <h4 id="name-ect1-tunnel-bypass">
<a href="#section-6.2.4" class="section-number selfRef">6.2.4. </a><a href="#name-ect1-tunnel-bypass" class="section-name selfRef">ECT(1) Tunnel Bypass</a>
          </h4>
<p id="section-6.2.4-1">Tunnel ECT(1) traffic through the RFC3168 bottleneck with the outer header indicating Not-ECT, by using either an ECN tunnel ingress in Compatibility Mode <span>[<a href="#RFC6040" class="xref">RFC6040</a>]</span> or a Limited Functionality ECN tunnel <span>[<a href="#RFC3168" class="xref">RFC3168</a>]</span>.<a href="#section-6.2.4-1" class="pilcrow">¶</a></p>
<p id="section-6.2.4-2">Two variants exist for this approach<a href="#section-6.2.4-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.2.4-3">
          <li id="section-6.2.4-3.1">per-domain: tunnel ECT(1) pkts to domain edge towards dst<a href="#section-6.2.4-3.1" class="pilcrow">¶</a>
</li>
            <li id="section-6.2.4-3.2">per-dst: tunnel ECT(1) pkts to dst<a href="#section-6.2.4-3.2" class="pilcrow">¶</a>
</li>
          </ol>
</section>
</section>
<section id="section-6.3">
        <h3 id="name-last-resort-options">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-last-resort-options" class="section-name selfRef">Last Resort Options</a>
        </h3>
<p id="section-6.3-1">If serious issues are detected, where the presence of L4S flows is determined to be the likely cause, and none of the above options are implementable, the options in this section can be considered as a last resort.  These options are not recommended.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<section id="section-6.3.1">
          <h4 id="name-disable-rfc3168-support">
<a href="#section-6.3.1" class="section-number selfRef">6.3.1. </a><a href="#name-disable-rfc3168-support" class="section-name selfRef">Disable RFC3168 Support</a>
          </h4>
<p id="section-6.3.1-1">Disabling an <span>[<a href="#RFC3168" class="xref">RFC3168</a>]</span> AQM from CE marking both ECT(0) traffic and ECT(1) traffic eliminates the unfairness issue. A downside to this approach is that classic senders will no longer get the benefits of Explict Congestion Notification at this bottleneck link either. This alternative is only mentioned in case there is no other way to reconfigure an RFC3168 AQM.<a href="#section-6.3.1-1" class="pilcrow">¶</a></p>
</section>
<section id="section-6.3.2">
          <h4 id="name-re-mark-ect1-to-notect-prio">
<a href="#section-6.3.2" class="section-number selfRef">6.3.2. </a><a href="#name-re-mark-ect1-to-notect-prio" class="section-name selfRef">Re-mark ECT(1) to NotECT Prior to AQM</a>
          </h4>
<p id="section-6.3.2-1">Remarking ECT(1) packets as NotECT (i.e. bleaching ECT(1)) ensures that they are treated identically to classic NotECT senders. However, this action is not recommended because a) it would also prevent downstream L4S bottlenecks from providing high fidelity congestion signals; b) it could lead to problems with future experiments that use ECT(1) in alternative ways to L4S; and c) it would violate requirements in <span>[<a href="#I-D.ietf-tsvwg-ecn-l4s-id" class="xref">I-D.ietf-tsvwg-ecn-l4s-id</a>]</span>. This alternative is mentioned as an absolute last resort in case there is no other way to reconfigure an RFC3168 AQM.<a href="#section-6.3.2-1" class="pilcrow">¶</a></p>
<p id="section-6.3.2-2">Note that the CE codepoint must never be bleached, otherwise it would black-hole congestion indications.<a href="#section-6.3.2-2" class="pilcrow">¶</a></p>
</section>
</section>
</section>
<div id="FQrecs">
<section id="section-7">
      <h2 id="name-operator-of-a-network-employ">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-operator-of-a-network-employ" class="section-name selfRef">Operator of a Network Employing RFC3168 FQ Bottlenecks</a>
      </h2>
<p id="section-7-1">A network operator who has deployed flow-queuing systems that implement RFC3168 (e.g. fq_codel or CAKE using default hashing) at network bottlenecks will likely see fewer potential issues when L4S traffic is present on their network as compared to operators of RFC3168 FIFOs. As discussed in <a href="#FQ" class="xref">Section 3</a>, the flow queuing mechanism will typically isolate L4S flows and Classic flows into separate queues, and the scheduler will then enforce per-flow fairness. As a result, the potential fairness issues between Classic and L4S traffic that can occur in FIFOs will typically not occur in FQ systems.  That said, FQ systems commonly treat a tunneled traffic aggregate as a single flow, and thus a tunneled traffic aggregate that contains a mix of Classic and L4S traffic will utilize a single queue, and the traffic within the tunnel could experience the same fairness issue as has been described for RFC3168 FIFOs. This unfairness is compounded by the fact that the FQ scheduler will already be causing unfairness to flows within the tunnel relative to flows that are not tunneled (each of which gets the same bandwidth share as does the tunnel).  Additionally, many of the deployed RFC3168 FQ systems currently implement an AQM algorithm (either CoDel or COBALT) that is designed for Classic traffic and reacts sluggishly to L4S (or unresponsive) traffic, with the result being that L4S senders could in some cases see worse latency performance than Classic senders.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">While the potential unfairness result is arguably less impactful in the case of RFC3168 FQ bottlenecks, it is believed that RFC3168 FQ bottlenecks are currently more common than RFC3168 FIFO bottlenecks. The most common deployments of RFC3168 FQ bottlenecks are in home routers running OpenWRT firmware where the user has turned the feature on.<a href="#section-7-2" class="pilcrow">¶</a></p>
<p id="section-7-3">As is the case with RFC3168 FIFOs, the preferred remedy for a network operator that wishes to enable the best performance possible with regard to L4S, is for the network operator to update RFC3168 FQ bottlenecks to be L4S-aware. In cases where that is infeasible, several of the remedies described in the previous section can be used to reduce or eliminate these issues.<a href="#section-7-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-4.1">Configure AQM to treat ECT(1) as NotECT<a href="#section-7-4.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-7-4.2">Disable RFC3168 Support<a href="#section-7-4.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-7-4.3">Re-mark ECT(1) to NotECT Prior to AQM<a href="#section-7-4.3" class="pilcrow">¶</a>
</li>
      </ul>
<div id="per-user">
<p id="section-7-5">Note that some FQ schedulers can be configured to intentionally aggregate multiple flows into each queue. This might be used, for instance, to implement per-user or per-host fairness rather than per-flow fairness.  In this case, if the flow aggregates contain a mix of Classic and L4S traffic, one would expect to see the same potential unfairness as is seen in the FIFO case. The same remedies mentioned above would apply in this case as well.<a href="#section-7-5" class="pilcrow">¶</a></p>
</div>
</section>
</div>
<section id="section-8">
      <h2 id="name-conclusion-of-the-l4s-exper">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-conclusion-of-the-l4s-exper" class="section-name selfRef">Conclusion of the L4S experiment</a>
      </h2>
<p id="section-8-1">This section gives guidance on how L4S-deploying networks and endpoints should respond to either of the two possible outcomes of the IETF-supported L4S experiment.<a href="#section-8-1" class="pilcrow">¶</a></p>
<section id="section-8.1">
        <h3 id="name-termination-of-a-successful">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-termination-of-a-successful" class="section-name selfRef">Termination of a successful L4S experiment</a>
        </h3>
<p id="section-8.1-1">If the L4S experiment is deemed successful, the IETF would be expected to move the L4S specifications to standards track.  Networks would then be encouraged to continue/begin deploying L4S-aware nodes and to replace all non-L4S-aware RFC3168 AQMs already deployed as far as feasible, or at least restrict RFC3168 AQM to interpret ECT(1) equal to NotECT. Networks that participated in the experiment would be expected to track the evolution of the L4S standards and adapt their implementations accordingly (e.g. if as part of switching from experimental to standards track, changes in the L4S RFCs become necessary).<a href="#section-8.1-1" class="pilcrow">¶</a></p>
</section>
<section id="section-8.2">
        <h3 id="name-termination-of-an-unsuccess">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-termination-of-an-unsuccess" class="section-name selfRef">Termination of an unsuccessful L4S experiment</a>
        </h3>
<p id="section-8.2-1">If the L4S experiment is deemed unsuccessful due to lack of deployment of compliant end-systems or AQMs, it might need to be terminated: any L4S network nodes should then be un-deployed and the ECT(1) codepoint usage should be released/recycled as quickly as possible, recognizing that this process may take some time. To facilitate this potential outcome, <span>[<a href="#I-D.ietf-tsvwg-ecn-l4s-id" class="xref">I-D.ietf-tsvwg-ecn-l4s-id</a>]</span> requires L4S hosts to be configurable to revert to non-L4S congestion control, and networks to be configurable to treat ECT(1) the same as ECT(0).<a href="#section-8.2-1" class="pilcrow">¶</a></p>
</section>
</section>
<div id="Contributors">
<section id="section-9">
      <h2 id="name-contributors">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-contributors" class="section-name selfRef">Contributors</a>
      </h2>
<p id="section-9-1">Thanks to Bob Briscoe, Jake Holland, Koen De Schepper, Olivier Tilmans, Tom Henderson, Asad Ahmed, Gorry Fairhurst, Sebastian Moeller, Pete Heist, and members of the TSVWG mailing list for their contributions to this document.<a href="#section-9-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="IANA">
<section id="section-10">
      <h2 id="name-iana-considerations-3">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-iana-considerations-3" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-10-1">None.<a href="#section-10-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Security">
<section id="section-11">
      <h2 id="name-security-considerations-3">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-security-considerations-3" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-11-1">For further study.<a href="#section-11-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-12">
      <h2 id="name-informative-references-2">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-informative-references-2" class="section-name selfRef">Informative References</a>
      </h2>
<dl class="references">
<dt id="AFD">[AFD]</dt>
      <dd>
<span class="refAuthor">Pan, R.</span>, <span class="refAuthor">Breslau, L.</span>, <span class="refAuthor">Prabhakar, B.</span>, and <span class="refAuthor">S. Shenker</span>, <span class="refTitle">"Approximate Fairness through Differential Dropping"</span>, <span class="seriesInfo">Computer Comm. Rev. vol.33, no.1</span>, <time datetime="2003-01" class="refDate">January 2003</time>, <span>&lt;<a href="https://people.eecs.berkeley.edu/~istoica/classes/cs268/10/papers/afd.pdf">https://people.eecs.berkeley.edu/~istoica/classes/cs268/10/papers/afd.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Bauer">[Bauer]</dt>
      <dd>
<span class="refAuthor">Bauer, S.</span>, <span class="refAuthor">Beverly, R.</span>, and <span class="refAuthor">A. Berger</span>, <span class="refTitle">"Measuring the State of ECN Readiness in Servers, Clients, and Routers"</span>, <span class="seriesInfo">Proc ACM SIGCOMM Internet Measurement Conference IMC'11</span>, <time datetime="2011" class="refDate">2011</time>, <span>&lt;<a href="http://conferences.sigcomm.org/imc/2011/docs/p171.pdf">http://conferences.sigcomm.org/imc/2011/docs/p171.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Bhooma">[Bhooma]</dt>
      <dd>
<span class="refAuthor">Bhooma, P.</span>, <span class="refTitle">"TCP ECN: Experience with enabling ECN on the Internet"</span>, <span class="seriesInfo">98th IETF MAPRG Presentation </span>, <time datetime="2017" class="refDate">2017</time>, <span>&lt;<a href="https://datatracker.ietf.org/meeting/98/materials/slides-98-maprg-tcp-ecn-experience-with-enabling-ecn-on-the-internet-padma-bhooma-00">https://datatracker.ietf.org/meeting/98/materials/slides-98-maprg-tcp-ecn-experience-with-enabling-ecn-on-the-internet-padma-bhooma-00</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Briscoe">[Briscoe]</dt>
      <dd>
<span class="refAuthor">Briscoe, B.</span> and <span class="refAuthor">A.S. Ahmed</span>, <span class="refTitle">"TCP Prague Fall-back on Detection of a Classic ECN AQM"</span>, <span class="seriesInfo">ArXiv </span>, <time datetime="2021-02" class="refDate">February 2021</time>, <span>&lt;<a href="https://arxiv.org/abs/1911.00710">https://arxiv.org/abs/1911.00710</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Cisco-N9000">[Cisco-N9000]</dt>
      <dd>
<span class="refAuthor">Cisco</span>, <span class="refTitle">"Intelligent Buffer Management on Cisco Nexus 9000 Series Switches White Paper"</span>, <span class="seriesInfo">Cisco Product Document 1486580292771926</span>, <time datetime="2017-06-06" class="refDate">6 June 2017</time>, <span>&lt;<a href="https://www.cisco.com/c/en/us/products/collateral/switches/nexus-9000-series-switches/white-paper-c11-738488.html">https://www.cisco.com/c/en/us/products/collateral/switches/nexus-9000-series-switches/white-paper-c11-738488.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Ha">[Ha]</dt>
      <dd>
<span class="refAuthor">Ha, S.</span>, <span class="refAuthor">Rhee, I.</span>, and <span class="refAuthor">L. Xu</span>, <span class="refTitle">"CUBIC: A New TCP-Friendly High-Speed TCP Variant"</span>, <span class="seriesInfo">ACM SIGOPS Operating Systems Review </span>, <time datetime="2008" class="refDate">2008</time>, <span>&lt;<a href="https://www.cs.princeton.edu/courses/archive/fall16/cos561/papers/Cubic08.pdf">https://www.cs.princeton.edu/courses/archive/fall16/cos561/papers/Cubic08.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Hoiland-Jorgensen">[Hoiland-Jorgensen]</dt>
      <dd>
<span class="refAuthor">Hoiland-Jorgensen, T.</span>, <span class="refAuthor">Taht, D.</span>, and <span class="refAuthor">J. Morton</span>, <span class="refTitle">"Piece of CAKE: A Comprehensive Queue Management Solution for Home Gateways"</span>, <time datetime="2018" class="refDate">2018</time>, <span>&lt;<a href="https://arxiv.org/abs/1804.07617">https://arxiv.org/abs/1804.07617</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Holland">[Holland]</dt>
      <dd>
<span class="refAuthor">Holland, J.</span>, <span class="refTitle">"Latency &amp; AQM Observations on the Internet"</span>, <span class="seriesInfo">IETF MAPRG interim-2020-maprg-01</span>, <time datetime="2020-08" class="refDate">August 2020</time>, <span>&lt;<a href="https://www.ietf.org/proceedings/interim-2020-maprg-01/slides/slides-interim-2020-maprg-01-sessa-latency-aqm-observations-on-the-internet-01.pdf">https://www.ietf.org/proceedings/interim-2020-maprg-01/slides/slides-interim-2020-maprg-01-sessa-latency-aqm-observations-on-the-internet-01.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.heist-tsvwg-ecn-deployment-observations">[I-D.heist-tsvwg-ecn-deployment-observations]</dt>
      <dd>
<span class="refAuthor">Heist, P.</span> and <span class="refAuthor">J. Morton</span>, <span class="refTitle">"Explicit Congestion Notification (ECN) Deployment Observations"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-heist-tsvwg-ecn-deployment-observations-02</span>, <time datetime="2021-03-08" class="refDate">8 March 2021</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-heist-tsvwg-ecn-deployment-observations-02.txt">http://www.ietf.org/internet-drafts/draft-heist-tsvwg-ecn-deployment-observations-02.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-tsvwg-aqm-dualq-coupled">[I-D.ietf-tsvwg-aqm-dualq-coupled]</dt>
      <dd>
<span class="refAuthor">Schepper, K.</span>, <span class="refAuthor">Briscoe, B.</span>, and <span class="refAuthor">G. White</span>, <span class="refTitle">"DualQ Coupled AQMs for Low Latency, Low Loss and Scalable Throughput (L4S)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-tsvwg-aqm-dualq-coupled-13</span>, <time datetime="2020-11-15" class="refDate">15 November 2020</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-ietf-tsvwg-aqm-dualq-coupled-13.txt">http://www.ietf.org/internet-drafts/draft-ietf-tsvwg-aqm-dualq-coupled-13.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-tsvwg-ecn-l4s-id">[I-D.ietf-tsvwg-ecn-l4s-id]</dt>
      <dd>
<span class="refAuthor">Schepper, K.</span> and <span class="refAuthor">B. Briscoe</span>, <span class="refTitle">"Identifying Modified Explicit Congestion Notification (ECN) Semantics for Ultra-Low Queuing Delay (L4S)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-tsvwg-ecn-l4s-id-12</span>, <time datetime="2020-11-15" class="refDate">15 November 2020</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-ietf-tsvwg-ecn-l4s-id-12.txt">http://www.ietf.org/internet-drafts/draft-ietf-tsvwg-ecn-l4s-id-12.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-tsvwg-l4s-arch">[I-D.ietf-tsvwg-l4s-arch]</dt>
      <dd>
<span class="refAuthor">Briscoe, B.</span>, <span class="refAuthor">Schepper, K.</span>, <span class="refAuthor">Bagnulo, M.</span>, and <span class="refAuthor">G. White</span>, <span class="refTitle">"Low Latency, Low Loss, Scalable Throughput (L4S) Internet Service: Architecture"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-tsvwg-l4s-arch-08</span>, <time datetime="2020-11-15" class="refDate">15 November 2020</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-ietf-tsvwg-l4s-arch-08.txt">http://www.ietf.org/internet-drafts/draft-ietf-tsvwg-l4s-arch-08.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA-ECN">[IANA-ECN]</dt>
      <dd>
<span class="refAuthor">Internet Assigned Numbers Authority</span>, <span class="refTitle">"IANA ECN Field Assignments"</span>, <time datetime="2018" class="refDate">2018</time>, <span>&lt;<a href="https://www.iana.org/assignments/dscp-registry/dscp-registry.xhtml#ecn-field">https://www.iana.org/assignments/dscp-registry/dscp-registry.xhtml#ecn-field</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Mandalari">[Mandalari]</dt>
      <dd>
<span class="refAuthor">Mandalari, AM.</span>, <span class="refAuthor">Lutu, A.</span>, <span class="refAuthor">Briscoe, B.</span>, <span class="refAuthor">Bagnulo, M.</span>, and <span class="refAuthor">O. Alay</span>, <span class="refTitle">"Measuring ECN++: Good News for ++, Bad News for ECN over Mobile"</span>, <span class="seriesInfo">DOI 10.1109/MCOM.2018.1700739</span>, <span class="seriesInfo">IEEE Communications Magazine vol. 56, no. 3</span>, <time datetime="2018-03" class="refDate">March 2018</time>, <span>&lt;<a href="https://ieeexplore.ieee.org/document/8316790">https://ieeexplore.ieee.org/document/8316790</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Palmei">[Palmei]</dt>
      <dd>
<span class="refAuthor">Palmei, J.</span> and <span class="refAuthor">X. et al.</span>, <span class="refTitle">"Design and Evaluation of COBALT Queue Discipline"</span>, <span class="seriesInfo">IEEE International Symposium on Local and Metropolitan Area Networks 2019</span>, <time datetime="2019" class="refDate">2019</time>, <span>&lt;<a href="https://ieeexplore.ieee.org/abstract/document/8847054">https://ieeexplore.ieee.org/abstract/document/8847054</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3168">[RFC3168]</dt>
      <dd>
<span class="refAuthor">Ramakrishnan, K.</span>, <span class="refAuthor">Floyd, S.</span>, and <span class="refAuthor">D. Black</span>, <span class="refTitle">"The Addition of Explicit Congestion Notification (ECN) to IP"</span>, <span class="seriesInfo">RFC 3168</span>, <span class="seriesInfo">DOI 10.17487/RFC3168</span>, <time datetime="2001-09" class="refDate">September 2001</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3168">https://www.rfc-editor.org/info/rfc3168</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5348">[RFC5348]</dt>
      <dd>
<span class="refAuthor">Floyd, S.</span>, <span class="refAuthor">Handley, M.</span>, <span class="refAuthor">Padhye, J.</span>, and <span class="refAuthor">J. Widmer</span>, <span class="refTitle">"TCP Friendly Rate Control (TFRC): Protocol Specification"</span>, <span class="seriesInfo">RFC 5348</span>, <span class="seriesInfo">DOI 10.17487/RFC5348</span>, <time datetime="2008-09" class="refDate">September 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5348">https://www.rfc-editor.org/info/rfc5348</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6040">[RFC6040]</dt>
      <dd>
<span class="refAuthor">Briscoe, B.</span>, <span class="refTitle">"Tunnelling of Explicit Congestion Notification"</span>, <span class="seriesInfo">RFC 6040</span>, <span class="seriesInfo">DOI 10.17487/RFC6040</span>, <time datetime="2010-11" class="refDate">November 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6040">https://www.rfc-editor.org/info/rfc6040</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8290">[RFC8290]</dt>
      <dd>
<span class="refAuthor">Hoeiland-Joergensen, T.</span>, <span class="refAuthor">McKenney, P.</span>, <span class="refAuthor">Taht, D.</span>, <span class="refAuthor">Gettys, J.</span>, and <span class="refAuthor">E. Dumazet</span>, <span class="refTitle">"The Flow Queue CoDel Packet Scheduler and Active Queue Management Algorithm"</span>, <span class="seriesInfo">RFC 8290</span>, <span class="seriesInfo">DOI 10.17487/RFC8290</span>, <time datetime="2018-01" class="refDate">January 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8290">https://www.rfc-editor.org/info/rfc8290</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8311">[RFC8311]</dt>
      <dd>
<span class="refAuthor">Black, D.</span>, <span class="refTitle">"Relaxing Restrictions on Explicit Congestion Notification (ECN) Experimentation"</span>, <span class="seriesInfo">RFC 8311</span>, <span class="seriesInfo">DOI 10.17487/RFC8311</span>, <time datetime="2018-01" class="refDate">January 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8311">https://www.rfc-editor.org/info/rfc8311</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Roddav">[Roddav]</dt>
      <dd>
<span class="refAuthor">Roddav, N.</span>, <span class="refAuthor">Streit, K.</span>, <span class="refAuthor">Rodosek, G.D.</span>, and <span class="refAuthor">A. Pras</span>, <span class="refTitle">"On the Usage of DSCP and ECN Codepoints in Internet Backbone Traffic Traces for IPv4 and IPv6"</span>, <span class="seriesInfo">DOI 10.1109/ISNCC.2019.8909187</span>, <span class="seriesInfo">ISNCC 2019</span>, <time datetime="2019" class="refDate">2019</time>, <span>&lt;<a href="https://ieeexplore.ieee.org/document/8909187">https://ieeexplore.ieee.org/document/8909187</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Trammel">[Trammel]</dt>
      <dd>
<span class="refAuthor">Trammel, B.</span>, <span class="refAuthor">Kuehlewind, M.</span>, <span class="refAuthor">Boppart, D.</span>, <span class="refAuthor">Learmonth, I.</span>, <span class="refAuthor">Fairhurst, G.</span>, and <span class="refAuthor">R. Scheffenegger</span>, <span class="refTitle">"Enabling Internet-Wide Deployment of Explicit Congestion Notification"</span>, <span class="seriesInfo">Proc Passive &amp; Active Measurement Conference PAM15</span>, <time datetime="2015" class="refDate">2015</time>, <span>&lt;<a href="https://link.springer.com/chapter/10.1007%2F978-3-319-15509-8_15">https://link.springer.com/chapter/10.1007%2F978-3-319-15509-8_15</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Ware">[Ware]</dt>
    <dd>
<span class="refAuthor">Ware, R.</span>, <span class="refAuthor">Mukerjee, M.</span>, <span class="refAuthor">Seshan, S.</span>, and <span class="refAuthor">J. Sherry</span>, <span class="refTitle">"Beyond Jain's Fairness Index: Setting the Bar For The Deployment of Congestion Control Algorithms"</span>, <span class="seriesInfo">Hotnets'19 </span>, <time datetime="2019" class="refDate">2019</time>, <span>&lt;<a href="https://www.cs.cmu.edu/~rware/assets/pdf/ware-hotnets19.pdf">https://www.cs.cmu.edu/~rware/assets/pdf/ware-hotnets19.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<div id="authors-addresses">
<section id="appendix-A">
      <h2 id="name-authors-address">
<a href="#name-authors-address" class="section-name selfRef">Author's Address</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Greg White (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">CableLabs</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:g.white@cablelabs.com" class="email">g.white@cablelabs.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
