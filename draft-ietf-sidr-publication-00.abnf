version="1"
type="message type">
start = element msg { attribute version { xsd:positiveInteger {
maxInclusive="1" } }, ((attribute type { "query" }, query_elt*) |
query_elt = ( config_query | client_query | certificate_query |
       crl_query | manifest_query | roa_query )

reply_elt = ( config_reply | client_reply | certificate_reply |
       crl_reply | manifest_reply | roa_reply | report_error_reply )

tag = attribute tag { xsd:token {maxLength="1024" } }

base64 = xsd:base64Binary { maxLength="512000" }

uri_t = xsd:anyURI { maxLength="4096" }
uri = attribute uri { uri_t }

object_handle = xsd:string { maxLength="255" pattern="[\-_A-Za-z0-9/]*" }

config_payload = (element bpki_crl { base64 }?)

client_handle = attribute client_handle { object_handle }

client_payload = (attribute base_uri { uri_t }?, element bpki_cert {
       base64 }?, element bpki_glue { base64 }?)

error = xsd:token { maxLength="1024" }

report_error_reply = element report_error {
       tag?,
       attribute error_code { error },
       xsd:string { maxLength="512000" }?
       }


