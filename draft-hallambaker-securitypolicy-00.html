<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Security Policy Distribution Format (SPDF)</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Definitions">
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Requirements Language">
<link href="#rfc.section.1.2" rel="Chapter" title="1.2 Defined Terms">
<link href="#rfc.section.2" rel="Chapter" title="2 Introduction">
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 Requirements">
<link href="#rfc.section.2.1.1" rel="Chapter" title="2.1.1 Protocol Downgrade Attack">
<link href="#rfc.section.2.1.2" rel="Chapter" title="2.1.2 CA Downgrade Attack">
<link href="#rfc.section.2.1.3" rel="Chapter" title="2.1.3 Use of Revoked Certificate">
<link href="#rfc.section.2.1.3.1" rel="Chapter" title="2.1.3.1 Use of Expired Certificate">
<link href="#rfc.section.2.1.4" rel="Chapter" title="2.1.4 Security Policy Origination">
<link href="#rfc.section.2.1.4.1" rel="Chapter" title="2.1.4.1 Explicit">
<link href="#rfc.section.2.1.4.2" rel="Chapter" title="2.1.4.2 Heuristic">
<link href="#rfc.section.2.1.5" rel="Chapter" title="2.1.5 Security Policy Distribution">
<link href="#rfc.section.2.1.5.1" rel="Chapter" title="2.1.5.1 Embedded">
<link href="#rfc.section.2.1.5.2" rel="Chapter" title="2.1.5.2 In-Band">
<link href="#rfc.section.2.1.5.3" rel="Chapter" title="2.1.5.3 DNS">
<link href="#rfc.section.2.1.5.4" rel="Chapter" title="2.1.5.4 Data Driven Update">
<link href="#rfc.section.2.1.5.5" rel="Chapter" title="2.1.5.5 Irregular">
<link href="#rfc.section.2.2" rel="Chapter" title="2.2 Security Policy Statements">
<link href="#rfc.section.2.2.1" rel="Chapter" title="2.2.1 Common Syntax">
<link href="#rfc.section.2.2.2" rel="Chapter" title="2.2.2 Common Parameters">
<link href="#rfc.section.2.2.2.1" rel="Chapter" title="2.2.2.1 Domain=&lt;dns-name&gt;">
<link href="#rfc.section.2.2.2.2" rel="Chapter" title="2.2.2.2 Protocol=&lt;Protocol&gt;*">
<link href="#rfc.section.2.2.2.3" rel="Chapter" title="2.2.2.3 UTC=&lt;date-time&gt;">
<link href="#rfc.section.2.2.2.4" rel="Chapter" title="2.2.2.4 Expire=&lt;date-time&gt;">
<link href="#rfc.section.2.2.3" rel="Chapter" title="2.2.3 Statement: CA-PIN: &lt;uri&gt;">
<link href="#rfc.section.2.2.3.1" rel="Chapter" title="2.2.3.1 Match= 'key' | 'csk' | 'cert' | 'path' ">
<link href="#rfc.section.2.2.3.1.1" rel="Chapter" title="2.2.3.1.1 Calculating the digest of a Subject Key.">
<link href="#rfc.section.2.2.3.1.2" rel="Chapter" title="2.2.3.1.2 Calculating the digest of a Certificate.">
<link href="#rfc.section.2.2.3.2" rel="Chapter" title="2.2.3.2 After=&lt;date-time&gt;">
<link href="#rfc.section.2.2.3.3" rel="Chapter" title="2.2.3.3 Before=&lt;date-time&gt;">
<link href="#rfc.section.2.2.3.4" rel="Chapter" title="2.2.3.4 Unpin=&lt;uri&gt;">
<link href="#rfc.section.2.2.4" rel="Chapter" title="2.2.4 Statement: Unpin: &lt;data&gt;">
<link href="#rfc.section.2.2.5" rel="Chapter" title="2.2.5 Statement: Revoke: &lt;uri&gt;">
<link href="#rfc.section.2.2.6" rel="Chapter" title="2.2.6 Statement: Action: &lt;action&gt;">
<link href="#rfc.section.2.2.7" rel="Chapter" title="2.2.7 Statement: Report: &lt;dns-name&gt;">
<link href="#rfc.section.2.2.8" rel="Chapter" title="2.2.8 Statement: TLS: &lt;level&gt;">
<link href="#rfc.section.2.2.8.1" rel="Chapter" title="2.2.8.1 version=&lt;version&gt;">
<link href="#rfc.section.3" rel="Chapter" title="3 Distribution Format">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 Cryptographic Message Syntax Properties">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 JSON Packaging">
<link href="#rfc.section.4" rel="Chapter" title="4 Security Considerations">
<link href="#rfc.section.5" rel="Chapter" title="5 IANA Considerations">
<link href="#rfc.references" rel="Chapter" title="6 References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="This document describes a format for distributing security policy statments.  " />
  <meta name="description" content="This document describes a format for distributing security policy statments.  " />
  <meta name="keywords" content="DNS, DNSSEC, PKIX" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Internet Engineering Task Force</td>
<td class="right">P. M. Hallam-Baker</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Comodo Group Inc.</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">R. N. Stradling</td>
</tr>
<tr>
<td class="left">Expires: April 26, 2012</td>
<td class="right">Comodo CA Ltd.</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">October 24, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Security Policy Distribution Format (SPDF)<br />
  <span class="filename">draft-hallambaker-securitypolicy-00</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>This document describes a format for distributing security policy statments.  </p>
<p>Individual security policy statements are expressed in a HTTP compatible header syntax. Lists of security policy statements are exchanged as signed CMS objects. Strong references to static data objects are formed using Named Information (ni) URI specifiers.  </p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on April 26, 2012.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Definitions</a>
</li>
<li>1.1.   <a href="#rfc.section.1.1">Requirements Language</a>
</li>
<li>1.2.   <a href="#rfc.section.1.2">Defined Terms</a>
</li>
<li>2.   <a href="#rfc.section.2">Introduction</a>
</li>
<li>2.1.   <a href="#rfc.section.2.1">Requirements</a>
</li>
<li>2.1.1.   <a href="#rfc.section.2.1.1">Protocol Downgrade Attack</a>
</li>
<li>2.1.2.   <a href="#rfc.section.2.1.2">CA Downgrade Attack</a>
</li>
<li>2.1.3.   <a href="#rfc.section.2.1.3">Use of Revoked Certificate</a>
</li>
<li>2.1.3.1.   <a href="#rfc.section.2.1.3.1">Use of Expired Certificate</a>
</li>
<li>2.1.4.   <a href="#rfc.section.2.1.4">Security Policy Origination</a>
</li>
<li>2.1.4.1.   <a href="#rfc.section.2.1.4.1">Explicit</a>
</li>
<li>2.1.4.2.   <a href="#rfc.section.2.1.4.2">Heuristic</a>
</li>
<li>2.1.5.   <a href="#rfc.section.2.1.5">Security Policy Distribution</a>
</li>
<li>2.1.5.1.   <a href="#rfc.section.2.1.5.1">Embedded</a>
</li>
<li>2.1.5.2.   <a href="#rfc.section.2.1.5.2">In-Band</a>
</li>
<li>2.1.5.3.   <a href="#rfc.section.2.1.5.3">DNS</a>
</li>
<li>2.1.5.4.   <a href="#rfc.section.2.1.5.4">Data Driven Update</a>
</li>
<li>2.1.5.5.   <a href="#rfc.section.2.1.5.5">Irregular</a>
</li>
<li>2.2.   <a href="#rfc.section.2.2">Security Policy Statements</a>
</li>
<li>2.2.1.   <a href="#rfc.section.2.2.1">Common Syntax</a>
</li>
<li>2.2.2.   <a href="#rfc.section.2.2.2">Common Parameters</a>
</li>
<li>2.2.2.1.   <a href="#rfc.section.2.2.2.1">Domain=&lt;dns-name&gt;</a>
</li>
<li>2.2.2.2.   <a href="#rfc.section.2.2.2.2">Protocol=&lt;Protocol&gt;*</a>
</li>
<li>2.2.2.3.   <a href="#rfc.section.2.2.2.3">UTC=&lt;date-time&gt;</a>
</li>
<li>2.2.2.4.   <a href="#rfc.section.2.2.2.4">Expire=&lt;date-time&gt;</a>
</li>
<li>2.2.3.   <a href="#rfc.section.2.2.3">Statement: CA-PIN: &lt;uri&gt;</a>
</li>
<li>2.2.3.1.   <a href="#rfc.section.2.2.3.1">Match= 'key' | 'csk' | 'cert' | 'path' </a>
</li>
<li>2.2.3.1.1.   <a href="#rfc.section.2.2.3.1.1">Calculating the digest of a Subject Key.</a>
</li>
<li>2.2.3.1.2.   <a href="#rfc.section.2.2.3.1.2">Calculating the digest of a Certificate.</a>
</li>
<li>2.2.3.2.   <a href="#rfc.section.2.2.3.2">After=&lt;date-time&gt;</a>
</li>
<li>2.2.3.3.   <a href="#rfc.section.2.2.3.3">Before=&lt;date-time&gt;</a>
</li>
<li>2.2.3.4.   <a href="#rfc.section.2.2.3.4">Unpin=&lt;uri&gt;</a>
</li>
<li>2.2.4.   <a href="#rfc.section.2.2.4">Statement: Unpin: &lt;data&gt;</a>
</li>
<li>2.2.5.   <a href="#rfc.section.2.2.5">Statement: Revoke: &lt;uri&gt;</a>
</li>
<li>2.2.6.   <a href="#rfc.section.2.2.6">Statement: Action: &lt;action&gt;</a>
</li>
<li>2.2.7.   <a href="#rfc.section.2.2.7">Statement: Report: &lt;dns-name&gt;</a>
</li>
<li>2.2.8.   <a href="#rfc.section.2.2.8">Statement: TLS: &lt;level&gt;</a>
</li>
<li>2.2.8.1.   <a href="#rfc.section.2.2.8.1">version=&lt;version&gt;</a>
</li>
<li>3.   <a href="#rfc.section.3">Distribution Format</a>
</li>
<li>3.1.   <a href="#rfc.section.3.1">Cryptographic Message Syntax Properties</a>
</li>
<li>3.2.   <a href="#rfc.section.3.2">JSON Packaging</a>
</li>
<li>4.   <a href="#rfc.section.4">Security Considerations</a>
</li>
<li>5.   <a href="#rfc.section.5">IANA Considerations</a>
</li>
<li>6.   <a href="#rfc.references">References</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> Definitions</h1>
<h1 id="rfc.section.1.1">
<a href="#rfc.section.1.1">1.1.</a> Requirements Language</h1>
<p id="rfc.section.1.1.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">[RFC2119]</a> </p>
<h1 id="rfc.section.1.2">
<a href="#rfc.section.1.2">1.2.</a> Defined Terms</h1>
<p id="rfc.section.1.2.p.1">The following terms are used in this document:</p>
<p></p>

<dl>
<dt>Certificate</dt>
<dd style="margin-left: 8">An X.509 Certificate, as specified in <a href="#RFC5280">RFC 5280</a> <cite title="NONE">[RFC5280]</cite>.  </dd>
<dt>Certification Policy (CP)</dt>
<dd style="margin-left: 8">Specifies the criteria that a Certification Authority undertakes to meet in its issue of certificates.  </dd>
<dt>Certification Practices Statement (CPS)</dt>
<dd style="margin-left: 8">Specifies the means by which the criteria of the Certification Policy are met. In most cases this will be the document against which the operations of the Certification Authority are audited.  </dd>
<dt>Certification Authority (CA)</dt>
<dd style="margin-left: 8">An entity that issues Certificates in accordance with a specified Certification Policy.  </dd>
<dt>Domain</dt>
<dd style="margin-left: 8">The set of resources associated with a DNS Domain Name.  </dd>
<dt>Domain Name</dt>
<dd style="margin-left: 8">A DNS Domain name as specified in <a href="#RFC1035">RFC 1035</a> <cite title="NONE">[RFC1035]</cite> and revisions.  </dd>
<dt>Domain Name System (DNS)</dt>
<dd style="margin-left: 8">The Internet naming system specified in <a href="#RFC1035">RFC 1035</a> <cite title="NONE">[RFC1035]</cite> and revisions.  </dd>
<dt>DNS Security (DNSSEC)</dt>
<dd style="margin-left: 8">Extensions to the DNS that provide authentication services as specified in <a href="#RFC4033">RFC 4033</a> <cite title="NONE">[RFC4033]</cite> and revisions.  </dd>
<dt>Public Key Infrastructure X.509 (PKIX)</dt>
<dd style="margin-left: 8">Standards and specifications issued by the IETF that apply the <a href="#X.509">X.509</a> <cite title="NONE">[X.509]</cite> certificate standards specified by the ITU to Internet applications as specified in <a href="#RFC5280">RFC 5280</a> <cite title="NONE">[RFC5280]</cite> and related documents.  </dd>
<dt>Resource Record (RR)</dt>
<dd style="margin-left: 8">A set of attributes bound to a Domain Name.  </dd>
<dt>Relying Party</dt>
<dd style="margin-left: 8">A party that makes use of an application whose operation depends on use of a Certificate for making a security decision.  </dd>
<dt>Relying Application</dt>
<dd style="margin-left: 8">An application whose operation depends on use of a Certificate for making a security decision.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> Introduction</h1>
<p id="rfc.section.2.p.1">Recent compromises of critical infrastructure have highlighted the weaknesses that result from the fact that on the Internet, security is an option, not the default.  </p>
<p id="rfc.section.2.p.2">Security Policy provides a mechanism for advising parties of the minimum degree of security that they should accept for a communication and thus preventing downgrade attacks.  </p>
<h1 id="rfc.section.2.1">
<a href="#rfc.section.2.1">2.1.</a> Requirements</h1>
<p id="rfc.section.2.1.p.1">Security Policy statements provide a mechanism for advising parties of the risk of a downgrade attack and the enforcement actions that are appropriate based on the quality of the security policy information available.  </p>
<p id="rfc.section.2.1.p.2">While the natural inclination of security specialists is to advise that a security policy violation always result in a hard failure with the corresponding transaction being aborted, this approach imposes a high cost for false positives. Previous attempts to employ security policy data (e.g. in DKIM) have faced objections from those fearing that the false positive rate will be unacceptably high.  </p>
<p id="rfc.section.2.1.p.3">Recent events have demonstrated that the value of reporting a security policy violation is considerably higher than than security policy enforcement on a limited scale. While security policy enforcement has the potential to protect the individual Internet user, reporting a violation to the appropriate parties has the potential to protect the entire community of Internet users.  </p>
<h1 id="rfc.section.2.1.1">
<a href="#rfc.section.2.1.1">2.1.1.</a> Protocol Downgrade Attack</h1>
<p id="rfc.section.2.1.1.p.1">In a protocol downgrade attack the attacker causes client software to communicate en-clair when TLS or some other security enhancement is offered.  </p>
<h1 id="rfc.section.2.1.2">
<a href="#rfc.section.2.1.2">2.1.2.</a> CA Downgrade Attack</h1>
<p id="rfc.section.2.1.2.p.1">In a CA downgrade attack the attacker applies for a certificate from a different issuer to that authorized by the Domain name holder or for a category of certificate with lest strict validation requirements.  </p>
<h1 id="rfc.section.2.1.3">
<a href="#rfc.section.2.1.3">2.1.3.</a> Use of Revoked Certificate</h1>
<p id="rfc.section.2.1.3.p.1">Although PKIX specifies two mechanisms for certificate status checking, many clients will accept certificates when access to the certificate status checking infrastructure fails.  </p>
<h1 id="rfc.section.2.1.3.1">
<a href="#rfc.section.2.1.3.1">2.1.3.1.</a> Use of Expired Certificate</h1>
<p id="rfc.section.2.1.3.1.p.1">Although use of expired certificates is discouraged, the frequency with which use of expired certificates occurs from administrative oversight prevents strict enforcement.  </p>
<h1 id="rfc.section.2.1.4">
<a href="#rfc.section.2.1.4">2.1.4.</a> Security Policy Origination</h1>
<p id="rfc.section.2.1.4.p.1">Security policy statements may be obtained from explicit statements by domain name holders or obtained heuristically from observation of the network.  </p>
<h1 id="rfc.section.2.1.4.1">
<a href="#rfc.section.2.1.4.1">2.1.4.1.</a> Explicit</h1>
<p id="rfc.section.2.1.4.1.p.1">A domain name holder MAY specify security policy explicitly through publication mechanisms that include: </p>
<p></p>

<ul class="empty">
<li>Publishing statements in Security Policy Distribution Format </li>
<li>Security Policy Statements in HTTP headers </li>
<li>Security Policy Statements in DNS records </li>
<li>Out of band contact with remediation parties.  </li>
<li>Statements to a Certification Authority at certificate issue.  </li>
</ul>

<p> </p>
<p id="rfc.section.2.1.4.1.p.3">Even though a statement is explicit, an enforcement point may only learn of its existence through heuristic means. For example observing DNS traffic, use of Web crawlers and HTTPS inspection.  </p>
<p id="rfc.section.2.1.4.1.p.4">Publication of an explicit Security policy Statement requires a considerable commitment of time and effort for a large site.  </p>
<h1 id="rfc.section.2.1.4.2">
<a href="#rfc.section.2.1.4.2">2.1.4.2.</a> Heuristic</h1>
<p id="rfc.section.2.1.4.2.p.1">Security policy data MAY also be determined heuristically by observation of network traffic. If a site has been using a particular CA for many years and a certificate is suddenly detected from an obscure issuer, questions may be asked.  </p>
<p id="rfc.section.2.1.4.2.p.2">While the quality of heuristic data may fall short of that required to abort transactions by itself, it can still provide a useful basis for reporting potential violations and for enforcement when combined with data from other sources.  </p>
<h1 id="rfc.section.2.1.5">
<a href="#rfc.section.2.1.5">2.1.5.</a> Security Policy Distribution</h1>
<p id="rfc.section.2.1.5.p.1">Security policy can be distributed through multiple channels.  The best choice of channel depends on the information in question and the application.  </p>
<h1 id="rfc.section.2.1.5.1">
<a href="#rfc.section.2.1.5.1">2.1.5.1.</a> Embedded</h1>
<p id="rfc.section.2.1.5.1.p.1">The Security Policy is embedded in client or operating system code. This approach has traditionally been limited to embedding revocation notices for certificates that have been known to be fraudulently issued.  </p>
<h1 id="rfc.section.2.1.5.2">
<a href="#rfc.section.2.1.5.2">2.1.5.2.</a> In-Band</h1>
<p id="rfc.section.2.1.5.2.p.1">The security policy data is carried in the protocol to which the policy applies. E.G HTTP headers for a HTTP transaction.  One drawback to this approach is that it only provides 'secure after first contact'.  </p>
<h1 id="rfc.section.2.1.5.3">
<a href="#rfc.section.2.1.5.3">2.1.5.3.</a> DNS</h1>
<p id="rfc.section.2.1.5.3.p.1">The DNS has been used to distribute Security Policy Statements.  The principle drawback being that deployment of DNSSEC is immature and likely to be blocked in the regions where security policy is most needed.  </p>
<h1 id="rfc.section.2.1.5.4">
<a href="#rfc.section.2.1.5.4">2.1.5.4.</a> Data Driven Update</h1>
<p id="rfc.section.2.1.5.4.p.1">The format described in this document is designed to support data driven update.  </p>
<p id="rfc.section.2.1.5.4.p.2">The main limitation to this approach is that it does not scale.  Thus the use of the distribution format should be limited to distributing policy for the domains that carry the highest risk.  </p>
<h1 id="rfc.section.2.1.5.5">
<a href="#rfc.section.2.1.5.5">2.1.5.5.</a> Irregular</h1>
<p id="rfc.section.2.1.5.5.p.1">Security Policy distribution is hard because the adversaries encountered to date include nation state actors with complete control of the local network infrastructure. It is thus not possible to address every possible need in a standard based approach since the adversary  can block deployment of the necessary standards.  </p>
<p id="rfc.section.2.1.5.5.p.2">It follows that standards based techniques SHOULD be supplemented by resort to irregular methods where necessary.  </p>
<h1 id="rfc.section.2.2">
<a href="#rfc.section.2.2">2.2.</a> Security Policy Statements</h1>
<h1 id="rfc.section.2.2.1">
<a href="#rfc.section.2.2.1">2.2.1.</a> Common Syntax</h1>
<p id="rfc.section.2.2.1.p.1">All Security Policy Statements have a common syntax based on the syntax used in HTTP and SMTP message format.  </p>
<p id="rfc.section.2.2.1.p.2">Forgetting about the traditional white space and line wrapping considerations, the syntax has the format has the following common syntax: </p>
<div id="#rfc.figure.1"></div>
<pre>
              
statement         = token ":"  values

values            = principal-value *("," principal-value) 
                                       *( ";" parameter )
principal-value   = dns-name | uri | quoted-string 

parameter         = attribute "=" value
attribute         = token
value             = token | quoted-string

WS                = " " | tab
            </pre>
<h1 id="rfc.section.2.2.2">
<a href="#rfc.section.2.2.2">2.2.2.</a> Common Parameters</h1>
<p id="rfc.section.2.2.2.p.1">The following parameters MAY occur in any Security Policy Statement.  </p>
<h1 id="rfc.section.2.2.2.1">
<a href="#rfc.section.2.2.2.1">2.2.2.1.</a> Domain=&lt;dns-name&gt;</h1>
<p id="rfc.section.2.2.2.1.p.1">The domain(s) to which the security policy statement applies.  </p>
<p id="rfc.section.2.2.2.1.p.2">The wildcard character '*' MAY be used to indicate that the security policy statement also applies to subdomains within the specified domain.  </p>
<p id="rfc.section.2.2.2.1.p.3">To facilitate mapping of security policy originated in DNS records, the rules for use of wildcards are the same as those defined for DNSSEC.  I.e. wildcards SHALL only occur as the first label in a DNS name, if a domain is in the scope of multiple security policy statements, the principle of closest match is applied.  </p>
<h1 id="rfc.section.2.2.2.2">
<a href="#rfc.section.2.2.2.2">2.2.2.2.</a> Protocol=&lt;Protocol&gt;*</h1>
<p id="rfc.section.2.2.2.2.p.1">A list of protocols to which the Security Policy applies. Protocols are identified by their SRV prefix labels.  </p>
<h1 id="rfc.section.2.2.2.3">
<a href="#rfc.section.2.2.2.3">2.2.2.3.</a> UTC=&lt;date-time&gt;</h1>
<p id="rfc.section.2.2.2.3.p.1">The time at which the security policy statement was obtained. This MAY be earlier than the time at which the SPDF document is signed but SHOULD NOT be later.  </p>
<h1 id="rfc.section.2.2.2.4">
<a href="#rfc.section.2.2.2.4">2.2.2.4.</a> Expire=&lt;date-time&gt;</h1>
<p id="rfc.section.2.2.2.4.p.1">The time at which the security policy statement expires. This MUST NOT be earlier than the time at which the SPDF document was signed.  </p>
<h1 id="rfc.section.2.2.3">
<a href="#rfc.section.2.2.3">2.2.3.</a> Statement: CA-PIN: &lt;uri&gt;</h1>
<p id="rfc.section.2.2.3.p.1">The CA-PIN statement is used to prevent a certificate issuer downgrade attack. A certificate SHALL be in violation of the specified security policy if the domain in question was within the scope of at least one CA-PIN statement at the time in question and the certificate does not comply with the requirements of any CA-PIN statements that were active at the time in question.  </p>
<p id="rfc.section.2.2.3.p.2">The principal parameter of a CA-PIN statement is an ni URI that specifies the criteria for the pinning.  </p>
<h1 id="rfc.section.2.2.3.1">
<a href="#rfc.section.2.2.3.1">2.2.3.1.</a> Match= 'key' | 'csk' | 'cert' | 'path' </h1>
<p id="rfc.section.2.2.3.1.p.1">Specifies whether the specified Named Information URI applies to an end entity subject key (key), a certificate signing subject key (csk), an end entity certificate (cert) or a certificate signing certificate (path).  If no match is specified, the 'key' match is the default.  </p>
<h1 id="rfc.section.2.2.3.1.1">
<a href="#rfc.section.2.2.3.1.1">2.2.3.1.1.</a> Calculating the digest of a Subject Key.</h1>
<p id="rfc.section.2.2.3.1.1.p.1">TBS </p>
<h1 id="rfc.section.2.2.3.1.2">
<a href="#rfc.section.2.2.3.1.2">2.2.3.1.2.</a> Calculating the digest of a Certificate.</h1>
<p id="rfc.section.2.2.3.1.2.p.1">TBS </p>
<h1 id="rfc.section.2.2.3.2">
<a href="#rfc.section.2.2.3.2">2.2.3.2.</a> After=&lt;date-time&gt;</h1>
<p id="rfc.section.2.2.3.2.p.1">The statement is only to be applied to certificates issued after the specified date and time.  </p>
<h1 id="rfc.section.2.2.3.3">
<a href="#rfc.section.2.2.3.3">2.2.3.3.</a> Before=&lt;date-time&gt;</h1>
<p id="rfc.section.2.2.3.3.p.1">The statement is only to be applied to certificates issued before the specified date and time.  </p>
<h1 id="rfc.section.2.2.3.4">
<a href="#rfc.section.2.2.3.4">2.2.3.4.</a> Unpin=&lt;uri&gt;</h1>
<p id="rfc.section.2.2.3.4.p.1">A Named Information URI that specifies the digest of an unpinning value. Disclosure of the unpinning value has the effect of revoking the corresponding security policy statement to which it is attached.  </p>
<p id="rfc.section.2.2.3.4.p.2">The unpinning value SHOULD be a randomly chosen nonce with sufficient ergodicity to make determination by brute force attack infeasible.  </p>
<h1 id="rfc.section.2.2.4">
<a href="#rfc.section.2.2.4">2.2.4.</a> Statement: Unpin: &lt;data&gt;</h1>
<p id="rfc.section.2.2.4.p.1">An unpinning value for a previously distributed CA pinning statement encoded as Base64.  </p>
<h1 id="rfc.section.2.2.5">
<a href="#rfc.section.2.2.5">2.2.5.</a> Statement: Revoke: &lt;uri&gt;</h1>
<p id="rfc.section.2.2.5.p.1">The Revoke statement is used to declare that a certificate is invalid.  </p>
<p id="rfc.section.2.2.5.p.2">While the functionality of the Revoke statement overlaps the capabilities and functionality of the existing PKIX revocation schemes (CRLs and OCSP), it is intended for a different field of use.  </p>
<p id="rfc.section.2.2.5.p.3">In particular the Revoke statement SHOULD NOT be employed except as a last resort mechanism for use in situations that are not adequately addressed by the existing certificate status infrastructure and the risk of relying on the revoked certificate is unacceptably high.  </p>
<h1 id="rfc.section.2.2.6">
<a href="#rfc.section.2.2.6">2.2.6.</a> Statement: Action: &lt;action&gt;</h1>
<p id="rfc.section.2.2.6.p.1">Specifies the action that SHOULD be performed in the case that a security policy violation is detected. Valid actions are 'Ignore', 'Advise', 'Fail' and 'Block': </p>
<p></p>

<dl>
<dt>Ignore</dt>
<dd style="margin-left: 8">The client SHOULD ignore policy violations. This option is intended for use in testing Security Policy configuration prior to requesting enforcement.  </dd>
<dt>Advise</dt>
<dd style="margin-left: 8">The client SHOULD advise the user when policy violations occur but not impede access to the corresponding network resource.  </dd>
<dt>Fail</dt>
<dd style="margin-left: 8">The client SHOULD advise the user that a policy violation has occurred and discourage (but not prevent) access to the corresponding network resource.  </dd>
<dt>Block</dt>
<dd style="margin-left: 8">The client SHOULD advise the user that a policy violation has occurred and prevent access to the corresponding network resource.  </dd>
</dl>

<p> </p>
<p id="rfc.section.2.2.6.p.3">Note that the specification of client actions is independent of reporting requests.  </p>
<h1 id="rfc.section.2.2.7">
<a href="#rfc.section.2.2.7">2.2.7.</a> Statement: Report: &lt;dns-name&gt;</h1>
<p id="rfc.section.2.2.7.p.1">This part is to be aligned with whatever is agreed in PKIX for use in CAA.  </p>
<h1 id="rfc.section.2.2.8">
<a href="#rfc.section.2.2.8">2.2.8.</a> Statement: TLS: &lt;level&gt;</h1>
<p id="rfc.section.2.2.8.p.1">Specifies the use of TLS: </p>
<p></p>

<dl>
<dt>refused</dt>
<dd style="margin-left: 8">Use of TLS is not supported.  </dd>
<dt>unknown</dt>
<dd style="margin-left: 8">Use of TLS is unkown.  </dd>
<dt>optional</dt>
<dd style="margin-left: 8">Use of TLS is optional.  </dd>
<dt>required</dt>
<dd style="margin-left: 8">Use of TLS is required.  </dd>
<dt>strict</dt>
<dd style="margin-left: 8">Use of TLS is required with Strict Transport Security.  </dd>
</dl>

<p> </p>
<p id="rfc.section.2.2.8.p.3">Additional parameters MAY be specified to further control the mode of use of TLS. For example the minimum version of the protocol to be used. [[While this could be extended to include cipher suites it is believed that the existing protocol is sufficiently proofed against downgrade attack on cipher suites. If this should be found not to be the case it would likely drive an urgent update of the protocol version.]] </p>
<h1 id="rfc.section.2.2.8.1">
<a href="#rfc.section.2.2.8.1">2.2.8.1.</a> version=&lt;version&gt;</h1>
<p id="rfc.section.2.2.8.1.p.1">Specifies the minimum version of TLS to be used in a format that I am sure someone will advise me on.  </p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> Distribution Format</h1>
<p id="rfc.section.3.p.1">A SPDF document consists of a Cryptographic Message Syntax object <a href="#RFC5652">[RFC5652]</a> that contains a list of Security Policy statements. SPDF documents SHOULD be signed and MAY be encrypted.  </p>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> Cryptographic Message Syntax Properties</h1>
<p id="rfc.section.3.1.p.1">[TBS details of CMS options that MUST be supported, crib this from SMIME] </p>
<h1 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> JSON Packaging</h1>
<p id="rfc.section.3.2.p.1">[TBS optional, not sure if it is actually very usefull for this particular application but...] </p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> Security Considerations</h1>
<p id="rfc.section.4.p.1">TBS</p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> IANA Considerations</h1>
<p id="rfc.section.5.p.1">TBS </p>
<p id="rfc.section.5.p.2">Need to create a registry for the statements and parameters.  </p>
<h1 id="rfc.references">
<a href="#rfc.references">6.</a> References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5652">[RFC5652]</b></td>
<td class="top">
<a>Housley, R.</a>, "<a href="http://tools.ietf.org/html/rfc5652">Cryptographic Message Syntax (CMS)</a>", STD 70, RFC 5652, September 2009.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4033">[RFC4033]</b></td>
<td class="top">
<a>Arends, R.</a>, <a>Austein, R.</a>, <a>Larson, M.</a>, <a>Massey, D.</a> and <a>S. Rose</a>, "<a href="http://tools.ietf.org/html/rfc4033">DNS Security Introduction and Requirements</a>", RFC 4033, March 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5280">[RFC5280]</b></td>
<td class="top">
<a>Cooper, D.</a>, <a>Santesson, S.</a>, <a>Farrell, S.</a>, <a>Boeyen, S.</a>, <a>Housley, R.</a> and <a>W. Polk</a>, "<a href="http://tools.ietf.org/html/rfc5280">Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>", RFC 5280, May 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC1035">[RFC1035]</b></td>
<td class="top">
<a title="USC/ISI">Mockapetris, P.</a>, "<a href="http://tools.ietf.org/html/rfc1035">Domain names - implementation and specification</a>", STD 13, RFC 1035, November 1987.</td>
</tr>
<tr>
<td class="reference"><b id="X.509">[X.509]</b></td>
<td class="top">
<a>International Telecommunication Union </a>, "<a>ITU-T Recommendation X.509 (11/2008): Information technology - Open systems interconnection - The Directory: Public-key and attribute certificate frameworks </a>", ITU-T Recommendation X.509, November 2008.</td>
</tr>
</tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Phillip Hallam-Baker</span> 
	  <span class="n hidden">
		<span class="family-name">Hallam-Baker</span>
	  </span>
	</span>
	<span class="org vcardline">Comodo Group Inc.</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:philliph@comodo.com">philliph@comodo.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Rob Stradling</span> 
	  <span class="n hidden">
		<span class="family-name">Stradling</span>
	  </span>
	</span>
	<span class="org vcardline">Comodo CA Ltd.</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:rob.stradling@comodo.com">rob.stradling@comodo.com</a></span>

  </address>
</div>

</body>
</html>