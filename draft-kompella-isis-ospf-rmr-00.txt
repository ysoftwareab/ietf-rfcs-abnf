



IS-IS OSPF                                                   K. Kompella
Internet-Draft                                    Juniper Networks, Inc.
Intended status: Standards Track                        October 30, 2016
Expires: May 3, 2017


                IGP Extensions for Resilient MPLS Rings
                    draft-kompella-isis-ospf-rmr-00

Abstract

   This document describes the use of IS-IS and OSPF for discovering
   Resilient MPLS Rings (RMR).  RMR relies on the IGP for discovery of
   the ring elements and properties, as well as subsequent changes to
   the ring topology.  Details of auto-discovery and operation are given
   in the RMR architecture document; this document simply describes the
   formats of RMR-related constructs in IS-IS and OSPF.

Requirements Language

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [RFC2119].

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at http://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on May 3, 2017.

Copyright Notice

   Copyright (c) 2016 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents



Kompella                   Expires May 3, 2017                  [Page 1]

Internet-Draft   IGP Extensions for Resilient MPLS Rings    October 2016


   (http://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
     1.1.  Definitions . . . . . . . . . . . . . . . . . . . . . . .   2
   2.  Theory of Operation . . . . . . . . . . . . . . . . . . . . .   4
     2.1.  Provisioning  . . . . . . . . . . . . . . . . . . . . . .   4
     2.2.  Announcement  . . . . . . . . . . . . . . . . . . . . . .   5
   3.  Security Considerations . . . . . . . . . . . . . . . . . . .   7
   4.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .   7
   5.  References  . . . . . . . . . . . . . . . . . . . . . . . . .   7
     5.1.  Normative References  . . . . . . . . . . . . . . . . . .   7
     5.2.  Informative References  . . . . . . . . . . . . . . . . .   7
   Author's Address  . . . . . . . . . . . . . . . . . . . . . . . .   8

1.  Introduction

   Rings are a very common topology in transport networks.  A ring is
   the simplest topology offering link and node resilience.  Rings are
   nearly ubiquitous in access and aggregation networks.  As MPLS
   increases its presence in such networks, and takes on a greater role
   in transport, it is imperative that MPLS handles rings well; this is
   not the case today.  The RMR architecture document
   [I-D.ietf-mpls-rmr] describes the motivations and operation of RMR.

   RMR uses protocols such as IS-IS [RFC5305] and OSPF[RFC3630] for
   auto-discovery, and RSVP-TE [RFC3209] and LDP [RFC5036] for signaling
   LSPs.  This document gives the specifics of Type-Length-Value (TLV)
   formats for IS-IS and OSPF.

1.1.  Definitions

   For a more detailed description, see [I-D.ietf-mpls-rmr].

   A ring is a subgraph of a given graph G = (V, E), consisting of a
   subset of n nodes {R_i, 0 <= i < n}.  The directed edges {(R_i,
   R_i+1) and (R_i+1, R_i), 0 <= i < n-1} must be a subset of E (note
   that index arithmetic is done modulo n).  We define the direction
   from node R_i to R_i+1 as "clockwise" (CW) and the reverse direction
   as "anticlockwise" (AC).  As there may be several rings in a graph,
   we number each ring with a distinct ring ID RID.



Kompella                   Expires May 3, 2017                  [Page 2]

Internet-Draft   IGP Extensions for Resilient MPLS Rings    October 2016


                                R0 . . . R1
                              .             .
                           R7                 R2
              Anti-     |  .        Ring       .  |
              Clockwise |  .                   .  | Clockwise
                        v  .      RID = 17     .  v
                           R6                 R3
                              .             .
                                R5 . . . R4

                        Figure 1: Ring with 8 nodes

   The following terminology is used for ring LSPs:

   Ring ID (RID):  A non-zero number that identifies a ring; this is
      unique in some scope of a Service Provider's network.  A node may
      belong to multiple rings.

   Ring node:  A member of a ring.  Note that a device may belong to
      several rings.

   Node index:  A logical numbering of nodes in a ring, from zero upto
      one less than the ring size.  Used purely for exposition in this
      document.

   Ring master:  The ring master initiates the ring identification
      process.  Mastership is indicated in the IGP by a two-bit field.

   Ring neighbors:  Nodes whose indices differ by one (modulo ring
      size).

   Ring links:  Links that connnect ring neighbors.

   Express links:  Links that connnect non-neighboring ring nodes.

   Ring direction:  A two-bit field in the IGP indicating the direction
      of a link.  The choices are:

      UN: 00  undefined link

      CW: 01  clockwise ring link

      AC: 10  anticlockwise ring link

      EX: 11  express link

   Ring Identification:  The process of discovering ring nodes, ring
      links, link directions, and express links.



Kompella                   Expires May 3, 2017                  [Page 3]

Internet-Draft   IGP Extensions for Resilient MPLS Rings    October 2016


   The following notation is used for ring LSPs:

   R_k:  A ring node with index k.  R_k has AC neighbor R_(k-1) and CW
      neighbor R_(k+1).

   RL_k:  A (unicast) Ring LSP anchored on node R_k.

   CL_jk:  A label allocated by R_j for RL_k in the CW direction.

   AL_jk:  A label allocated by R_j for RL_k in the AC direction.

   P_jk (Q_jk):  A Path (Resv) message sent by R_j for RL_k.

2.  Theory of Operation

   Say a ring has ring ID RID.  The ring is provisioned by choosing one
   or more ring masters for the ring and assigning them the RID.  Other
   nodes in the ring may also be assigned this RID, or may be configured
   as "promiscuous".  Ring discovery then kicks in.  When each ring node
   knows its CW and AC ring neighbors and its ring links, and all
   express links have been identified, ring identification is complete.

   Once ring identification is complete, each node signals one or more
   ring LSPs RL_i.  RL_i, anchored on node R_i, consists of two counter-
   rotating unicast LSPs that start and end at R_i.  A ring LSP is
   "multipoint": any node R_j can use RL_i to send traffic to R_i; this
   can be in either the CW or AC directions, or both (i.e., load
   balanced).  Both of these counter-rotating LSPs are "active"; the
   choice of direction to send traffic to R_i is determined by policy at
   the node where traffic is injected into the ring.  The default is to
   send traffic along the shortest path.  Bidirectional connectivity
   between nodes R_i and R_j is achieved by using two different ring
   LSPs: R_i uses RL_j to reach R_j, and R_j uses RL_i to reach R_i.

2.1.  Provisioning

   For the purposes of RMR, a ring node R is configured with its
   loopback address, the RID that it will participate in, and what link-
   state IGP to use for auto-discovery.  R is also configured with a
   mastership value, which is used in master election.  Finally, R may
   be configured with the signaling protocols and OAM protocols it
   supports, or these may be inferred.  Note that R may participate in
   multiple rings; each would have its own configuration.

   To simplify ring provisioning even further, R may be made
   "promiscuous" by being assigned an RID of 0.  A promiscuous node
   listens to RIDs in its IGP neighbors' link-state updates in order to
   acquire an RID for its use.  Details are in [I-D.ietf-mpls-rmr].



Kompella                   Expires May 3, 2017                  [Page 4]

Internet-Draft   IGP Extensions for Resilient MPLS Rings    October 2016


2.2.  Announcement

   Once configured, R announces its configuration parameters in the IGP
   via an RMR Node TLV.  The RMR Node TLV may contain sub-TLVs; in
   particular, the RMR Neighbor TLV.  At a high level, these TLVs are as
   follows.

        [RMR Node Type][RMR Node Length][RID][Node Flags][sub-TLVs]

                          Ring Node TLV Structure

          [RMR Nbr Type][RMR Nbr Length][Nbr Address][Nbr Flags]

                      Ring Neighbor Sub-TLV Structure

   In IS-IS, the RMR Node TLV is a new top-level TLV.  The specific
   format is as follows:

      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |   Type (TBD)  | Length = 6+S  |       Ring ID (4 octets) ...  |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |      ... (RID continued)      |     Node Flags (2 octets)     |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | sub-TLVs, if any ...
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     S is the total size of the sub-TLVs

                           Ring Node TLV Format

      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |   Type (TBD)  | Length = n*6  |      Neighbor Loopback ...    |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | ... (continued, 4 octets)     |   Neighbor Flags (2 octets)   |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                   Neighbor Loopback (4 octets)                |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |   Neighbor Flags (2 octets)   | (etc.)
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     n = number of neighbors included in the sub-TLV

                       Ring Neighbor sub-TLV Format

   In OSPF, the RMR Node TLV is a new top-level TLV of the Traffic
   Engineering Opaque LSA.



Kompella                   Expires May 3, 2017                  [Page 5]

Internet-Draft   IGP Extensions for Resilient MPLS Rings    October 2016


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |           Type (TBD)          |         Length = 8+S          |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                       Ring ID (4 octets)                      |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |     Node Flags (2 octets)     |         Pad (2 octets)        |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | sub-TLVs ...
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     Pad is set to zero when sending and ignored on receipt.
     S = total length of sub-TLVs

                         OSPF Ring Node TLV Format

      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |           Type (TBD)          |         Length = 6*N          |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                   Neighbor Loopback (4 octets)                |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |    Neighbor Flags (2 octets)  |         Pad (2 octets)        |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                   Neighbor Loopback (4 octets)                |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |    Neighbor Flags (2 octets)  |         Pad (2 octets)        |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |  ... etc.                                                     |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     Pad is set to zero when sending and ignored on receipt.

                       OSPF Neighbor sub-TLV Format

     0                   1
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |MV |SS | SO  |    MBZ    |SU |M|
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    MV: Mastership Value
    SS: Supported Signaling Protocols (10 = RSVP-TE; 01 = LDP)
    SO: Supported OAM Protocols (100 = BFD; 010 = CFM; 001 = EFM)
    SU: Signaling Protocol to Use  (00 = none; 01 = LDP; 10 = RSVP-TE)
    M : Elected Master (0 = no, 1 = yes)

                         Flags for a Ring Node TLV




Kompella                   Expires May 3, 2017                  [Page 6]

Internet-Draft   IGP Extensions for Resilient MPLS Rings    October 2016


     0                   1
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |RD |OAM|          MBZ          |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    RD:  Ring Direction
    OAM: OAM Protocol to use (00 = none; 01 = BFD; 10 = CFM; 11 = EFM)

                       Flags for a Ring Neighbor TLV

3.  Security Considerations

   It is not anticipated that either the notion of MPLS rings or the
   extensions to link-state IGPs to support them will cause new security
   loopholes.  As this document is updated, this section will also be
   updated.

4.  IANA Considerations

   IANA is requested to assign a new top-level TLV for the RMR Node TLV
   from the IS-IS TLV Codepoints Registry.  IANA is also requested to
   create a new registry for sub-TLVs of the RMR Node TLV.

   IANA is also requested to assign a new top-level type for the RMR
   Node TLV from the OSPF TE TLVs Registry.  IANA is also requested to
   create a new registry for sub-TLVs of the RMR Node TLV.

5.  References

5.1.  Normative References

   [I-D.ietf-mpls-rmr]
              Kompella, K. and L. Contreras, "Resilient MPLS Rings",
              draft-ietf-mpls-rmr-03 (work in progress), October 2016.

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <http://www.rfc-editor.org/info/rfc2119>.

5.2.  Informative References

   [RFC3209]  Awduche, D., Berger, L., Gan, D., Li, T., Srinivasan, V.,
              and G. Swallow, "RSVP-TE: Extensions to RSVP for LSP
              Tunnels", RFC 3209, DOI 10.17487/RFC3209, December 2001,
              <http://www.rfc-editor.org/info/rfc3209>.





Kompella                   Expires May 3, 2017                  [Page 7]

Internet-Draft   IGP Extensions for Resilient MPLS Rings    October 2016


   [RFC3630]  Katz, D., Kompella, K., and D. Yeung, "Traffic Engineering
              (TE) Extensions to OSPF Version 2", RFC 3630,
              DOI 10.17487/RFC3630, September 2003,
              <http://www.rfc-editor.org/info/rfc3630>.

   [RFC5036]  Andersson, L., Ed., Minei, I., Ed., and B. Thomas, Ed.,
              "LDP Specification", RFC 5036, DOI 10.17487/RFC5036,
              October 2007, <http://www.rfc-editor.org/info/rfc5036>.

   [RFC5305]  Li, T. and H. Smit, "IS-IS Extensions for Traffic
              Engineering", RFC 5305, DOI 10.17487/RFC5305, October
              2008, <http://www.rfc-editor.org/info/rfc5305>.

Author's Address

   Kireeti Kompella
   Juniper Networks, Inc.
   1133 Innovation Way
   Sunnyvale, CA  94089
   USA

   Email: kireeti.kompella@gmail.com





























Kompella                   Expires May 3, 2017                  [Page 8]
