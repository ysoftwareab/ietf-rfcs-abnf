<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>MPLS-TP Shared Mesh Protection</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.2" rel="Chapter" title="2 Conventions Used in this Document">
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 Acronyms">
<link href="#rfc.section.2.2" rel="Chapter" title="2.2 Definitions and Terminology">
<link href="#rfc.section.3" rel="Chapter" title="3 Shared Mesh Protection Architecture">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 Shared Mesh Protection Group">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 Shared Start and End Nodes">
<link href="#rfc.section.3.3" rel="Chapter" title="3.3 Connecting the end-points">
<link href="#rfc.section.3.4" rel="Chapter" title="3.4 Network planning for SMP">
<link href="#rfc.section.3.5" rel="Chapter" title="3.5 Preemption and race conditions">
<link href="#rfc.section.3.6" rel="Chapter" title="3.6 SMP Protection Switching Overview">
<link href="#rfc.section.3.6.1" rel="Chapter" title="3.6.1 LP Protocol extensions for shared protection">
<link href="#rfc.section.3.6.2" rel="Chapter" title="3.6.2 Protection switching event">
<link href="#rfc.section.3.6.3" rel="Chapter" title="3.6.3 Protection Locking">
<link href="#rfc.section.3.6.4" rel="Chapter" title="3.6.4 Messages between the SEN and SSN">
<link href="#rfc.section.4" rel="Chapter" title="4 Protocol">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 PDU Format">
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 Message Transmission">
<link href="#rfc.section.5" rel="Chapter" title="5 Operation of Shared Mesh Protection">
<link href="#rfc.section.6" rel="Chapter" title="6 Manageability Considerations">
<link href="#rfc.section.7" rel="Chapter" title="7 IANA Considerations">
<link href="#rfc.section.8" rel="Chapter" title="8 Security Considerations">
<link href="#rfc.references" rel="Chapter" title="9 References">
<link href="#rfc.references.1" rel="Chapter" title="9.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="9.2 Informative References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="This document describes a mechanism to address the requirement to support protection of Label Switched Paths (LSPs) in an MPLS Transport Profile (MPLS-TP) mesh topology. The shared mesh protection mechanism enables multiple protection paths within a shared mesh protection domain to share protection resources for the protection of working paths by coordinating protection switching operations according to the priority assigned to each end-to-end linear protection domain." />
  <meta name="description" content="This document describes a mechanism to address the requirement to support protection of Label Switched Paths (LSPs) in an MPLS Transport Profile (MPLS-TP) mesh topology. The shared mesh protection mechanism enables multiple protection paths within a shared mesh protection domain to share protection resources for the protection of working paths by coordinating protection switching operations according to the priority assigned to each end-to-end linear protection domain." />
  <meta name="keywords" content="" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">MPLS Working Group</td>
<td class="right">T. Cheung</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">J. Ryoo</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">ETRI</td>
</tr>
<tr>
<td class="left">Expires: May 03, 2012</td>
<td class="right">Y. Weingarten</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">N. Sprecher</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Nokia Siemens Networks</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">D. King</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Old Dog Consulting</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">October 31, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">MPLS-TP Shared Mesh Protection<br />
  <span class="filename">draft-cheung-mpls-tp-mesh-protection-04.txt</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>This document describes a mechanism to address the requirement to support protection of Label Switched Paths (LSPs) in an MPLS Transport Profile (MPLS-TP) mesh topology. The shared mesh protection mechanism enables multiple protection paths within a shared mesh protection domain to share protection resources for the protection of working paths by coordinating protection switching operations according to the priority assigned to each end-to-end linear protection domain.</p>
<p>This document is a product of a joint Internet Engineering Task Force (IETF) / International Telecommunications Union Telecommunications Standardization Sector (ITU-T) effort to include an MPLS Transport Profile within the IETF MPLS and PWE3 architectures to support the capabilities and functionalities of a packet transport network as defined by the ITU-T.</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on May 03, 2012.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>2.   <a href="#rfc.section.2">Conventions Used in this Document</a>
</li>
<li>2.1.   <a href="#rfc.section.2.1">Acronyms</a>
</li>
<li>2.2.   <a href="#rfc.section.2.2">Definitions and Terminology</a>
</li>
<li>3.   <a href="#rfc.section.3">Shared Mesh Protection Architecture</a>
</li>
<li>3.1.   <a href="#rfc.section.3.1">Shared Mesh Protection Group</a>
</li>
<li>3.2.   <a href="#rfc.section.3.2">Shared Start and End Nodes</a>
</li>
<li>3.3.   <a href="#rfc.section.3.3">Connecting the end-points</a>
</li>
<li>3.4.   <a href="#rfc.section.3.4">Network planning for SMP</a>
</li>
<li>3.5.   <a href="#rfc.section.3.5">Preemption and race conditions</a>
</li>
<li>3.6.   <a href="#rfc.section.3.6">SMP Protection Switching Overview</a>
</li>
<li>3.6.1.   <a href="#rfc.section.3.6.1">LP Protocol extensions for shared protection</a>
</li>
<li>3.6.2.   <a href="#rfc.section.3.6.2">Protection switching event</a>
</li>
<li>3.6.3.   <a href="#rfc.section.3.6.3">Protection Locking</a>
</li>
<li>3.6.4.   <a href="#rfc.section.3.6.4">Messages between the SEN and SSN</a>
</li>
<li>4.   <a href="#rfc.section.4">Protocol</a>
</li>
<li>4.1.   <a href="#rfc.section.4.1">PDU Format</a>
</li>
<li>4.2.   <a href="#rfc.section.4.2">Message Transmission</a>
</li>
<li>5.   <a href="#rfc.section.5">Operation of Shared Mesh Protection</a>
</li>
<li>6.   <a href="#rfc.section.6">Manageability Considerations</a>
</li>
<li>7.   <a href="#rfc.section.7">IANA Considerations</a>
</li>
<li>8.   <a href="#rfc.section.8">Security Considerations</a>
</li>
<li>9.   <a href="#rfc.references">References</a>
</li>
<li>9.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>9.2.   <a href="#rfc.references.2">Informative References</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> Introduction</h1>
<p id="rfc.section.1.p.1">The MPLS Transport Profile (MPLS-TP) is a packet transport technology based on a profile of the MPLS and Pseudowires (PW) as described in <a href="#RFC3031">[RFC3031]</a>, <a href="#RFC3985">[RFC3985]</a>, and <a href="#RFC5085">[RFC5085]</a>. MPLS-TP is the application of MPLS to the construction of packet-switched paths that are analogous to traditional circuit-switched technologies. Requirements for MPLS-TP are specified in <a href="#RFC5654">[RFC5654]</a>. </p>
<p id="rfc.section.1.p.2">An important feature of a transport network is its survivability function and the ability to maintain or recover traffic following a network failure or attack. According to Requirement 56 of <a href="#RFC5654">[RFC5654]</a>, MPLS-TP must provide protection and restoration mechanisms, and it must also be possible to protect 100% of the traffic on the protected path (Requirement 58).</p>
<p id="rfc.section.1.p.3">1+1 and 1:1 linear protection meets these requirements by reserving the equivalent amount of network resources for the protection paths as is allocated to the normal traffic that is being protected. While those dedicated protection mechanisms provide very good protection capabilities, they are resource inefficient and will increase overall network resource consumption. Deploying 1+1 and 1:1 protection mechanisms for all services that require resiliency, dramatically increases network costs.</p>
<p><a href="#RFC5654">[RFC5654]</a> also establishes that MPLS-TP should support shared protection (Requirement 68). 1:n end-to-end protection uses one protection path to protect n working paths between the same two end-points.  This improves overall network utilization, but the resource (bandwidth) allocated to a protection path is typically not sufficient to protect multiple simultaneous failures on different working paths. If multiple working paths require concurrent protection switching, the path with the highest priority should be protected as described in <a href="#RFC6372">[RFC6372]</a>.</p>
<p id="rfc.section.1.p.5">In 1+1 and 1:1 protection, the end nodes of the working path must be the same as those of the protection path. Similarly in 1:n protection all pairs of end nodes of the n working paths are the same, and the protection path must also have the same end nodes.  In the event that the MPLS-TP network scales up, the number of Label Switched Paths (LSPs) having different end nodes will also increase.  The network utilization benefit for sharing protection resources among multiple protected domains for such LSPs will increase accordingly.</p>
<p id="rfc.section.1.p.6">Requirement 68 of <a href="#RFC5654">[RFC5654]</a> specifies that MPLS-TP should support 1:n shared mesh recovery, and Requirement 69 states that MPLS-TP must support sharing of protection resources. It may be possible that some working paths are sufficiently disjoint and would be unlikely to be simultaneously affected by a single network failure. Typically, such a scenario is hard to track in real network environments where new services are often added and removed.</p>
<p id="rfc.section.1.p.7">In mesh protection, network resources may be shared to provide protection for working paths that do not share the same end nodes at the edge of a protection domain. This type of protection can make very efficient use of network resources, but requires coordination of several segments in order to ensure that only a single traffic flow is switched to the protection resources at any time. </p>
<p><a href="#RFC4428">[RFC4428]</a> defines two shared mesh recovery schemes named (1:1)^n and (M:N)^n. The (1:1)^n recovery scheme is a simple case of (M:N)^n recovery scheme. In (1:1)^n protection, n working paths are protected by n dedicated protection paths while sharing the same protection bandwidth.  The protection bandwidth can be optimized to allow only one of the n working paths to be protected at any time. In this case, it achieves network utilization similar to 1:n protection.</p>
<p id="rfc.section.1.p.9">It should be noted that the (1:1)^n protection scheme described in <a href="#RFC4428">[RFC4428]</a> differs with that defined in <a href="#G.808.1">[G.808.1]</a> in that the former allows each n pairs of working and protection paths to have different end nodes while the latter applies to the case where all pairs have the same end nodes.</p>
<p id="rfc.section.1.p.10">This document defines a data-plane shared mesh protection mechanism based on the concept of the (1:1)^n recovery scheme described in <a href="#RFC4428">[RFC4428]</a> and a protocol for coordination of the shared protection resources.  The actual protection switching is controlled by end-to-end linear protection, while the usage of the shared resources is based on the protection switching priority assigned to each pair of working and protection paths.</p>
<p id="rfc.section.1.p.11">The shared mesh protection mechanism defined in this document utilizes the existing MPLS-TP linear protection switching mechanism, and assumes that the protection paths are established and ready to forward data prior to a failure.  Upon detection of a failure on a working path, only the two end nodes of the failed working path exchange their linear protection protocol messages to switch data traffic. No explicit activation procedure to switch data traffic to the protection path is needed in the intermediate nodes along the protection path.  However, the intermediate nodes that are part of the shared segments need to coordinate the resource allocation on the shared nodes and this coordination will be addressed by the protocol proposed in this document.</p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> Conventions Used in this Document</h1>
<p id="rfc.section.2.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">[RFC2119]</a>.</p>
<h1 id="rfc.section.2.1">
<a href="#rfc.section.2.1">2.1.</a> Acronyms</h1>
<div id="#rfc.table.1"></div>
<p>This draft uses the following acronyms:</p>
<table cellpadding="3" cellspacing="0" class="tt full left">
<thead><tr>
<th class="left"></th>
<th class="left"></th>
</tr></thead>
<tbody>
<tr>
<td class="left">G-ACh</td>
<td class="left">Generic Associated Channel Header</td>
</tr>
<tr>
<td class="left">LoP</td>
<td class="left">Lockout of Protection</td>
</tr>
<tr>
<td class="left">LP</td>
<td class="left">Linear Protection</td>
</tr>
<tr>
<td class="left">LSP</td>
<td class="left">Label Switched Path</td>
</tr>
<tr>
<td class="left">MIP</td>
<td class="left">Maintenance Entity Group Intermediate Point</td>
</tr>
<tr>
<td class="left">MPLS-TP</td>
<td class="left">Transport Profile for MPLS</td>
</tr>
<tr>
<td class="left">P2P</td>
<td class="left">Point-to-point</td>
</tr>
<tr>
<td class="left">P2MP</td>
<td class="left">Point-to-multipoint</td>
</tr>
<tr>
<td class="left">PW</td>
<td class="left">Pseudowire</td>
</tr>
<tr>
<td class="left">SEN</td>
<td class="left">Shared End Node</td>
</tr>
<tr>
<td class="left">SMP</td>
<td class="left">Shared Mesh Protection</td>
</tr>
<tr>
<td class="left">SMPG</td>
<td class="left">Shared Mesh Protection Group</td>
</tr>
<tr>
<td class="left">SPME</td>
<td class="left">Sub-Path Maintenance Entity</td>
</tr>
<tr>
<td class="left">SSN</td>
<td class="left">Shared Start Node</td>
</tr>
</tbody>
</table>
<h1 id="rfc.section.2.2">
<a href="#rfc.section.2.2">2.2.</a> Definitions and Terminology</h1>
<p id="rfc.section.2.2.p.1">This document defines two protection domains as follows:</p>
<p></p>

<ul>
<li>End-to-end linear protection domain: A protection domain as defined in <a href="#RFC6372">[RFC6372]</a> for protecting a P2P or P2MP LSP. It consists of two or more end points at the boundary of the domain and a working path and a protection path between the end nodes. An end-to-end linear protection switching protocol runs within the domain.</li>
<li>Shared mesh protection domain: A protection domain for protecting a number of P2P or P2MP LSPs. It consists of a number of end-to-end linear protection domains. Each end-to-end linear protection domain shares protection resources with other domains. The shared protection resource may be a node, link, transport path segment or concatenated transport path segment. A shared mesh protection switching protocol runs within the domain.</li>
</ul>
<p id="rfc.section.2.2.p.3">In addition, we define the following:</p>
<p></p>

<ul><li>Shared mesh protection group (SMPG): a protection group includes the pairs of working and protection paths, whose working paths do not belong to a single SRLG and whose protection paths share a single sub-segment.  Note that an LSP may belong to multiple protection groups.</li></ul>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#sec3" id="sec3">Shared Mesh Protection Architecture</a>
</h1>
<p id="rfc.section.3.p.1">The shared mesh protection domain shown in <a href="#Fig1">Figure 1</a> has two end-to-end linear protection domains. One consists of the two end nodes A and E and includes one working path, ABCDE, and one dedicated protection path APQRE.  The second consists of end nodes V and Z and one working path, VWXYZ, and the dedicated protection path, VPQRZ. Those two domains share a common  segment PQR for their protection path.  This illustrates a simple configuration of shared mesh protection. Note that the two working paths, ABCDE and VWXYZ, do not share end points so they cannot make use of 1:n protection even though they also do not share any potential common points of failure.</p>
<p id="rfc.section.3.p.2">It is possible to apply linear protection to each of these working paths individually.  If there are no failures affecting either of the two working paths, the network segment PQR carries no traffic (or only interruptible extra traffic). In the event of only one failure, the segment PQR carries traffic from the working path that detected the failure.  Only in the event that there are failures detected on both of the working paths is there a conflict over the appropriate use of the shared PQR segment.  It is important to note that there are two distinct LSPs (i.e. APQRE and VPQRZ) that are signaled over the shared segment, and that although we refer to the singular segment, the traffic is actually being transported on separated transport paths.</p>
<p id="rfc.section.3.p.3">Thus, it is possible for the network resources of segment PQR to be shared by the two protection paths. In this way, shared mesh protection can substantially reduce the amount of network resources that need to be reserved to provide protection of the multiple paths within the same protection group.</p>
<div id="#rfc.figure.1"></div>
<div id="#Fig1"></div>
<pre>
             A----B----C----D----E 
              \                 / 
               \               / 
                \             / 
                 P-----Q-----R 
                /             \ 
               /               \ 
              /                 \ 
             V----W----X----Y----Z 
									 
		  </pre>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> Shared Mesh Protection Group</h1>
<p id="rfc.section.3.1.p.1">The two working paths in <a href="#Fig1">Figure 1</a>, ABCDE and VWXYZ, are considered a Shared Mesh Protection Group (SMPG).  Such a group is defined as the set of working paths whose protection path share the resources of a single shared segment.  As pointed out above, there are individual protection LSP for each of the LP domains, however the resources that are being shared are the nodes, ports, links and bandwidth of the segment.</p>
<p id="rfc.section.3.1.p.2">The shared resources, for example bandwidth capacity, should be reserved in partitions according to the different SMPGs at the particular segment.</p>
<div id="#rfc.figure.2"></div>
<div id="#Fig2"></div>
<pre>
             A------B-------C     D------E 
              \            /     /        \
               \          /     /          \
                F---G----H-----J------K-----L
                   /          /        \     \
                  /          M----------N     \ 
                 /                             \ 
                V-------W-------X-------Y-------Z 
									 
		  </pre>
<p id="rfc.section.3.1.p.3">To further clarify, consider the mesh network in <a href="#Fig2">Figure 2</a>.  In this figure we have the following working paths and corresponding protection paths:</p>
<div id="#rfc.table.2"></div>
<table cellpadding="3" cellspacing="0" class="tt full left">
<thead><tr>
<th class="center">Wx</th>
<th class="left">working path</th>
<th class="left">protection path</th>
</tr></thead>
<tbody>
<tr>
<td class="center">W1</td>
<td class="left">A-B-C</td>
<td class="left">A-F-G-H-C</td>
</tr>
<tr>
<td class="center">W2</td>
<td class="left">D-E</td>
<td class="left">D-J-K-L-E</td>
</tr>
<tr>
<td class="center">W3</td>
<td class="left">M-N</td>
<td class="left">M-J-K-N</td>
</tr>
<tr>
<td class="center">W4</td>
<td class="left">V-W-X-Y-Z</td>
<td class="left">V-G-H-J-K-L-Z</td>
</tr>
</tbody>
</table>
<p id="rfc.section.3.1.p.4">In this network we would define three SMPG - characterized by the three shared segments - </p>

<ol>
<li>S1 segment G-H &#8211; shared by W1 and W4</li>
<li>S2 segment J-K &#8211; shared by W2, W3, and W4</li>
<li>S3 segment K-L &#8211; shared by W2 and W4</li>
</ol>
<p id="rfc.section.3.1.p.5">The shared segment is always the smallest segment that is shared by multiple protection paths.  Therefore, even though segment J-K-L is shared by W2 and W4, we split this into two shared segments - J-K and K-L, since W3 also shares the resources of segment J-K.</p>
<p id="rfc.section.3.1.p.6">In addition, this demonstrates that a single working path may be a member of a number of SMPGs.  Also a single SMPG may include more than two working paths.</p>
<h1 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> Shared Start and End Nodes</h1>
<p id="rfc.section.3.2.p.1">For the sake of the discussion of the SMP operation we designate the two end- points of the shared protection segment as a Shared Start Node (SSN) and Shared End Node (SEN).  To simplify the discussion this designation is based on referencing the protection path as a pair of unidirectional LSPs.</p>
<p id="rfc.section.3.2.p.2">A SSN is the first node of a unidirectional shared protection segment.  For example, in <a href="#Fig1">Figure 1</a>, node P is a SSN on unidirectional protection paths A-P-Q-R-E and V-P-Q-R-Z.  SSN may act as a Maintenance Entity Group Intermediate Point (MIP) for each protection path sharing the same protection resources.</p>
<p id="rfc.section.3.2.p.3">Similarly, a SEN is defined as the last node of a unidirectional shared protection segment (for example, node R on unidirectional protection paths A-P-Q-R-E and V-P-Q-R-Z in Figure 1).  A SEN acts as a MIP on each protection path that shares the protection resource.</p>
<p id="rfc.section.3.2.p.4">Both end-points are involved in coordinating the use of the unidirectional shared protection segment during the shared mesh protection operation.</p>
<p id="rfc.section.3.2.p.5">Table 1 summarizes the relationship between SSN and SEN of the shared protection segment and protection paths sharing it as illustrated in <a href="#Fig1">Figure 1</a>.</p>
<div id="#rfc.table.3"></div>
<p>Table 1: SSN/SEN in Figure 1</p>
<table cellpadding="3" cellspacing="0" class="tt full center">
<thead><tr>
<th class="center">Protection paths</th>
<th class="center">Shared protection segment</th>
<th class="center">SSN</th>
<th class="center">SEN</th>
</tr></thead>
<tbody>
<tr>
<td class="center">A-P-Q-R-E, V-P-Q-R-Z</td>
<td class="center">P-Q-R</td>
<td class="center">P</td>
<td class="center">R</td>
</tr>
<tr>
<td class="center">E-R-Q-P-A, Z-R-Q-P-V</td>
<td class="center">R-Q-P</td>
<td class="center">R</td>
<td class="center">P</td>
</tr>
</tbody>
</table>
<p><a href="#Fig3">Figure 3</a> shows a more complex example of the shared mesh protection domain. Three working paths ABC, DEF, and GHJ are protected by the protection paths APQC, DRSF, and GPQRSJ, respectively.</p>
<div id="#rfc.figure.3"></div>
<div id="#Fig3"></div>
<pre>
           A------B------C  D------E------F 
            \           /    \           / 
             \         /      \         / 
              \       /        \       / 
               P-----Q----------R-----S 
              /                        \ 
             /                          \ 
            /                            \ 
           G--------------H---------------J 
									 
		  </pre>
<div id="#rfc.table.4"></div>
<p>Table 1: SSN/SEN in Figure 3</p>
<table cellpadding="3" cellspacing="0" class="tt full center">
<thead><tr>
<th class="center">Protection paths</th>
<th class="center">Shared protection segment</th>
<th class="center">SSN</th>
<th class="center">SEN</th>
</tr></thead>
<tbody>
<tr>
<td class="center">A-P-Q-C, G-P-Q-R-S-J</td>
<td class="center">P-Q</td>
<td class="center">P</td>
<td class="center">Q</td>
</tr>
<tr>
<td class="center">C-Q-P-A, J-S-R-Q-P-G</td>
<td class="center">Q-P</td>
<td class="center">Q</td>
<td class="center">P</td>
</tr>
<tr>
<td class="center">D-R-S-F, G-P-Q-R-S-J</td>
<td class="center">R-S</td>
<td class="center">R</td>
<td class="center">S</td>
</tr>
<tr>
<td class="center">F-S-R-D, J-S-R-Q-P-G</td>
<td class="center">S-R</td>
<td class="center">S</td>
<td class="center">R</td>
</tr>
</tbody>
</table>
<h1 id="rfc.section.3.3">
<a href="#rfc.section.3.3">3.3.</a> Connecting the end-points</h1>
<p id="rfc.section.3.3.p.1">The MPLS-TP Framework <a href="#RFC5921">[RFC5921]</a> defines the concept of a Sub-Path Maintenance Entity (SPME) and together with <a href="#RFC5586">[RFC5586]</a> define the use of the Generic Associated Channel (G-ACh) for communication of MPLS-TP control protocols between the end-points of a maintenance entity,  While the usual utility of a SPME is to allow tunneling of transport traffic while monitoring the segment with in-band connectivity verification messages, it is possible to use concept of a SPME to describe a LSP that is dedicated to carry a control protocol over the G-ACh between the end-points of the shared protection segment and the end-points of the protection paths within the SPMG.</p>
<p id="rfc.section.3.3.p.2">For example, referring to the network in <a href="#Fig3">Figure 3</a>, we would configure the following SPME (without identifying the intermediate nodes): A-P, G-P, P-Q, Q-C, D-R, G-R, S-F, S-J, R-S, and Q-J.  These SPME are bidirectional LSP that are not used to carry any data traffic, only the control traffic described in <a href="#Protocol">Section 4</a>.</p>
<p id="rfc.section.3.3.p.3">The connection between the end-points of the shared protection segment between themselves and the end-points of the protection paths within the SPMG is to coordinate the allocation of the shared segment to a single protection path during a protection switching condition.  This process is described more fully in <a href="#SwOverview">Section 3.6</a></p>
<h1 id="rfc.section.3.4">
<a href="#rfc.section.3.4">3.4.</a> Network planning for SMP</h1>
<p id="rfc.section.3.4.p.1">Shared mesh protection will typically be dependent upon careful network planning. This includes:</p>
<p></p>

<ul>
<li>Preparing the working and protection paths for the different services that require protection.</li>
<li>Determining which working paths are disjoint and so will not be subject to common failures.  It should be clear that working paths within the same SRLG should not be included in the same SMPG.</li>
<li>Identifying which protection paths share network resources and can constitute a shared protection group.  Signaling or configuring the proper path information for the shared segment end-points to allow for communication between the corresponding end points of the shared segment and the protection path.</li>
<li>Assigning Protection Switching Priority and a path identifier for each working path within a shared protection group.</li>
<li>Ensuring that working paths of high Protection Switching Priority do not share resources on their protection paths in such a way that would mean that one of them could be unprotected.</li>
<li>Enabling the necessary shared mesh protection functions at the end-points of the shared protection segments.  This includes preparing the different SPME used for communication between the corresponding end points of the shared segments and the protection paths, as well as between the end-points of the shared protection segment.</li>
</ul>
<p id="rfc.section.3.4.p.3">Note that some control plane features of GMPLS may be used to dynamically configure shared mesh protection. These features are out of scope for this document which focuses on the operation of shared mesh protection switching once it has been configured.</p>
<h1 id="rfc.section.3.5">
<a href="#rfc.section.3.5">3.5.</a> <a href="#PreemptRC" id="PreemptRC">Preemption and race conditions</a>
</h1>
<p id="rfc.section.3.5.p.1">In the normal operation of SMP, when a working path triggers a protection switch, and requests allocation of the shared resources, the process should verify that the resources are available and allocate them to the requesting protection path.  There are some cases where the determination of the availability is not simply determined.</p>
<p id="rfc.section.3.5.p.2">Within the SMP protection domain there is a need to define a "Protection Switching Priority" for each working path.  This Protection Switching Priority will be used to determine the use of the shared protection resources in cases of possible preemption.  When the shared resources are in use protecting the traffic of a failed working path and a second working path fails, the SMP process should compare the Protection Switching Priority of the two working paths and if the priority of the second path is higher than the priority of the currently protected traffic, then this second path will preempt the currently protected traffic.  If the second path has a lower or equal priority to the currently protected traffic, then the second path is locked-out of the protection resources.</p>
<p id="rfc.section.3.5.p.3">The Protection Switching Priority may be provisioned by the network management system or configured by some other mechanism that is outside the scope of this document.</p>
<p id="rfc.section.3.5.p.4">There is an additional case where the SMP process needs to make a determination of which working path should be allocated the shared resources.  This is the case of multiple working paths triggering a protection switch virtually simultaneously.  This may result in a race condition where the two end-points of the shared protection segment ostensibly receive requests from two different working paths.  By default, working paths with equal priority results in first-come first-served recovery.  If multiple working paths request protection switching simultaneously, a pre-defined identifier assigned to each working path in the SMP domain MUST be used to determine the priority among them.  The definition of the identifier is for further study.</p>
<h1 id="rfc.section.3.6">
<a href="#rfc.section.3.6">3.6.</a> <a href="#SwOverview" id="SwOverview">SMP Protection Switching Overview</a>
</h1>
<p id="rfc.section.3.6.p.1">When a protection switching trigger is activated on any of the working paths within a shared protection group, then the local linear protection mechanism (in 1:1 protection mode) should cause a protection switch.  If, as a result of the protection switch action, there is a need to transmit working data on the protection path then the protection path endpoint should inform the endpoint of the shared segment of the allocation of the shared resources.</p>
<p id="rfc.section.3.6.p.2">At this point the shared segment endpoints should notify all of the other protection paths in the shared protection group that the resources have been allocated, which could affect the linear protection actions relative to future triggers.</p>
<h1 id="rfc.section.3.6.1">
<a href="#rfc.section.3.6.1">3.6.1.</a> LP Protocol extensions for shared protection</h1>
<p id="rfc.section.3.6.1.p.1">The shared mesh protection mechanism is designed to fully utilize the existing end-to-end LP switching on the working paths.  These LP domains SHALL operate in revertive mode.  The LP protocol should use the normal procedures for LP without any changes except support for the following additional functionalities:</p>
<p></p>

<ul>
<li>Function to generate a protection switching event message to the SEN when a switching trigger occurs at the end-to-end linear protection domain.</li>
<li>Function to take a protection locking message from the SEN, and incorporate it as the Lockout of Protection (LoP) command.</li>
<li>Function to notify the SEN when the shared allocated resources may be released, when the LP domain is reverting to normal state.</li>
</ul>
<h1 id="rfc.section.3.6.2">
<a href="#rfc.section.3.6.2">3.6.2.</a> Protection switching event</h1>
<p id="rfc.section.3.6.2.p.1">If the end point of a working path detects a switching trigger, it triggers the protection switching and exchanges LP switching protocol messages with far end-point. This operation is independent of the SMP switching mechanism specified in this document.</p>
<p id="rfc.section.3.6.2.p.2">At the same time, for the operation of SMP, the protection path end-point notifies its protection switching event to SENs by sending a "protection switching event" message.</p>
<p id="rfc.section.3.6.2.p.3">The protection switching event message MUST be transmitted immediately when an end node changes its selector position either from working to protection or vice versa.  The event message SHALL be transmitted over the SPME, that is configured between the protection path end-point and the SEN, using the G-ACh.  When bidirectional protection switching is being used by the working path, both end nodes will transmit the event messages to their corresponding SENs using the properly configured SPME.  When unidirectional protection switching and a unidirectional failure is detected, only the detecting end-point will send the messages to its corresponding SENs.</p>
<p id="rfc.section.3.6.2.p.4">The end-point of the protection path that is becoming active (or released) sends the messages directly to each SEN. This requires that N messages are sent, where N is the number of SMPG that the working path is a member of.  This, of course, implies that the end-points are pre-configured with knowledge of all SENs associated with the SPMG.</p>
<h1 id="rfc.section.3.6.3">
<a href="#rfc.section.3.6.3">3.6.3.</a> Protection Locking</h1>
<p id="rfc.section.3.6.3.p.1">When a SEN receives the protection switching event notifying that protection switching to the protection path has begun in an end-to-end LP domain and that the shared resources are to be allocated, it compares the Protection Switching Priority of the working path notifying the event with those of other LP domains in the same SMPG.</p>
<p id="rfc.section.3.6.3.p.2">The SEN determines which of the LP domains (within the SPMG) have a lower or equal priority to that of the notifying LP domain.  The SEN then sends a notification to the end-points of these protection paths that is equivalent to a "Lockout of Protection" operator command.  This notification should prevent any protection switching actions in those LP domains.  For those LP domains having higher priorities no notification is transmitted and those LP domains may continue to perform protection switching actions.</p>
<p id="rfc.section.3.6.3.p.3">When a protection path end point receives the protection locking message from an SEN, it SHOULD react as if a LoP command was received, according to the actions dictated by the LP protocol.  Since the LoP command has the highest priority in the LP switching protocol, it will inhibit any further protection switching in the LP domain.</p>
<p id="rfc.section.3.6.3.p.4">If the LP domain that received the protection locking message is currently transmitting traffic on the protection path, it SHALL immediately stop transmitting the traffic on the protection path and release the allocated resources.</p>
<p id="rfc.section.3.6.3.p.5">When a SEN receives a protection switching event message indicating that the shared protection resources are being released, i.e. the LP domain is reverting to normal state, it sends a protection locking message to the end points of all the protection paths in the SMPG that were previously locked (i.e. those with equal or lower priority) to clear the LoP command.  The end-point of the protection path that receives this message SHALL react as if a Clear command was received.</p>
<h1 id="rfc.section.3.6.4">
<a href="#rfc.section.3.6.4">3.6.4.</a> Messages between the SEN and SSN</h1>
<p id="rfc.section.3.6.4.p.1">As was pointed out in <a href="#PreemptRC">Section 3.5</a> there are some cases, in particular in unidirectional protection switching triggers, of simultaneous protection switching that could cause race conditions.  In these use-cases there is a need for the two end nodes of the shared protection segment, i.e. the SEN and the SSN, to coordinate the selection of the LP domain that will be allocated the shared protection resources.</p>
<p id="rfc.section.3.6.4.p.2">For this purpose, additional messages are defined that are transmitted on the SPME that is defined between the end nodes of the shared protection segment.  When a SEN receives a protection switching event notification from a LP domain indicating that protection switching to the protection path has begun, it SHALL send a message to the SSN that the resources have been allocated, with an indication of the working path identifier.  This allocation needs to be confirmed for cases where both end nodes report allocation to different working path identifiers.</p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#Protocol" id="Protocol">Protocol</a>
</h1>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> PDU Format</h1>
<p id="rfc.section.4.1.p.1">The shared mesh protection protocol messages MUST be sent over a G-ACh as defined in <a href="#RFC5586">[RFC5586]</a>.</p>
<p id="rfc.section.4.1.p.2">The shared mesh protection protocol messages are as follows:</p>
<p></p>

<ul>
<li>Protection switching event message [sent from protection path to SEN]</li>
<li>Protection locking message [sent from SEN to protection path]</li>
<li>Protection release message [sent from SEN to protection path]</li>
<li>Resource allocation(working-path identifier) [sent from SEN to SSN]</li>
<li>Resource allocation acknowledge [sent from SSN to SEN]</li>
</ul>
<p id="rfc.section.4.1.p.4">The channel type in ACH is used to indicate that the message is a SMP protocol message.  The protocol message MUST follow the ACH.</p>
<div id="#rfc.figure.4"></div>
<div id="#Fig4"></div>
<pre>
      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |0 0 0 1|Version|   Reserved    | Channel Type = Shared Mesh P. |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |           Shared Mesh Protection Protocol Message             |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

			</pre>
<p id="rfc.section.4.1.p.5">Each protocol message includes the following fields:</p>
<p></p>

<ul>
<li>Version number</li>
<li>Identifier of the working path/LP domain - this is either the identifier of the LP domain that is sending the message or the working path that was allocated the resources (dependent upon the message)</li>
<li>Request/State field - identifies the message type as one of the messages listed above (i.e. Protection Switching Event, Protection Locking, Resource Allocation, Resource Allocation Ack)</li>
<li>Sub-request field - identifies the sub-function of the message (for example if protection path is being switched to or released for the Protection Switching Event message)</li>
</ul>
<h1 id="rfc.section.4.2">
<a href="#rfc.section.4.2">4.2.</a> Message Transmission</h1>
<p id="rfc.section.4.2.p.1">A new message must be transmitted immediately. The first three messages should be transmitted as fast as possible so that fast protection switching is possible even if one or two messages are lost or corrupted. The interval of the first three messages should be less than 3.3ms. Messages after the first three should be transmitted with the interval of 5 seconds.</p>
<p id="rfc.section.4.2.p.2">If no valid message is received, the last valid received information remains applicable.</p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> Operation of Shared Mesh Protection</h1>
<p id="rfc.section.5.p.1">This section illustrates the operation of the shared mesh protection protocol based on the example illustrated in <a href="#Fig3">Figure 3</a> and the following assumptions:</p>
<p></p>

<ul>
<li>The SMP domain consists of the following end-to-end LP domains (LPDs): <ul>
<li>LPD1: Working path ABC (W1) / Protection path APQC (P1)</li>
<li>LPD2: Working path GHJ (W2) / Protection path GPQRSJ (P2)</li>
<li>LPD3: Working path DEF (W3) / Protection path DRSF (P3)</li>
</ul>
</li>
<li>The SMP domain includes the following SMPG: <ul>
<li>S1: LPD1 &amp; LPD2</li>
<li>S2: LPD3 &amp; LPD2</li>
</ul>
</li>
<li>Protection Switching Priority is LPD1 &gt; LPD2 &gt; LPD3 (i.e. LPD1 has the highest priority.)</li>
<li>All working paths are protected by 1:1 bidirectional protection switching.</li>
</ul>
<p id="rfc.section.5.p.3">If a unidirectional failure occurs on W2 in the direction from node H to node G as shown in <a href="#Fig7">Figure 5</a>, SMP will perform the following: </p>

<ol style="list-style-type: lower-alpha">
<li>Node G detects the failure, and initiates linear protection switching for the failed W2.</li>
<li>At the same time, node G transmits the protection switching event message notifying the SENs of the shared protection segments for S1 &amp; S2, i.e.  P and R, that a protection switching event occured to node.</li>
<li>SEN P compares the protection switching priority of LPD2 with those of other members of S1, i.e. LPD1. In this example, since the priority of LPD1 is higher than LPD2, SEN P does not send any message to node A.</li>
<li>SEN R compares the protection switching priority of LPD2 with those of other members of S2, i.e. LPD3. In this example, as the priority of LPD3 is lower than LPD2, SEN R sends the protection locking message requesting LoP to node D.</li>
<li>Node D takes the protection locking message as input to the LP switching, and follows the LP procedure to process the end-to-end LoP command.</li>
<li>Since LPD2 operates in 1:1 bidirectional protection switching mode, node J performs the switching operations (i.e. switches its bridge and selector state) to synchronize with node G, and also transmits the protection switching event message to node S and Q, which are SENs for G-&gt;H-&gt;J. Using a parallel procedure to that described in steps c &amp; d SEN S sends the protection locking message to node F while the SEN Q does not take an action to node C.</li>
</ol>
<div id="#rfc.figure.5"></div>
<div id="#Fig7"></div>
<pre>
                  W1                     W3 
         ==A======B======C==    ==D======E======F== 
            \           /          \           / 
             \   LPD1  /            \   LPD3  / 
              \       /              \       /      == : Normal traffic
               P=====Q================R=====S 
              //                            \\ 
             //             LPD2             \\ 
            //                                \\ 
         ==G------xx---------H------------------J== 
              SF on G&lt;-H     W2
        
		  </pre>
<p><a href="#Fig8">Figure 6</a> shows a progression from <a href="#Fig7">Figure 5</a>. While LPD2 is in protecting state with its traffic transported on protection path P2, another unidirectional failure occurs on W1 in the direction from node B to node A.</p>
<p id="rfc.section.5.p.5">In this case, the shared mesh protection will operate as follows: </p>

<ol style="list-style-type: lower-alpha">
<li>Node A detects the failure, and initiates the linear protection switching for the failed W1.</li>
<li>At the same time, node A transmits the protection switching event message notifying SEN for S1, i.e. node P, that a protection switching event occurred.</li>
<li>SEN P compares the protection switching priority of LPD1 with those of the other members in S1, in this case  LPD2. In this example, since the priority of LPD2 is lower than LPD1, SEN P sends the protection locking message requesting LoP to node G.</li>
<li>Node G accepts the protection locking message as input to linear protection switching, and follows LP procedure to process the LoP command.  When LPD2 is forced to lock its protection path P2, it may try to find another available path. m:n protection or other recovery mechanism may be used for this, but this discussion is out of scope for this document.</li>
<li>As node G changes its bridge and selector states from protection to working, it will transmit the protection switching event message to the SENs of S1 &amp; S2, i.e. P &amp; R, notifying that the shared protection resources should be released.</li>
<li>SEN P compares the protection switching priority of LPD2 with the other members of S1, i.e. LPD1, and does not transmit any message to node A, but SEN R sends the protection locking message requesting clearance of LoP to node D, after comparing the protection switching priorities of the members of S2.</li>
<li>Node D accepts the message as input to the linear protection switching, and follows the LP procedures to clear the LoP command.</li>
</ol>
<div id="#rfc.figure.6"></div>
<div id="#Fig8"></div>
<pre>
            SF on
             A&lt;-B W1                    W3 
         ==A-xx---B------C==   ==D======E======F== 
           \\           //        \           / 
            \\   LPD1  //          \   LPD3  / 
             \\       //            \       /      == : Normal traffic
               P=====Q---------------R-----S 
              /                             \ 
             /              LPD2             \ 
            /                                 \ 
         ==G------xx---------H-----------------J== 
              SF on G&lt;-H     W2

		  </pre>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> Manageability Considerations</h1>
<p id="rfc.section.6.p.1">To be added in future version.</p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> <a href="#IANA" id="IANA">IANA Considerations</a>
</h1>
<p id="rfc.section.7.p.1">To be added in future version.</p>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> <a href="#Security" id="Security">Security Considerations</a>
</h1>
<p id="rfc.section.8.p.1">To be added in future version.</p>
<h1 id="rfc.references">
<a href="#rfc.references">9.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">9.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a>Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", RFC 2119, BCP 14, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5654">[RFC5654]</b></td>
<td class="top">
<a>Niven-Jenkins, B.</a>, <a>Nadeau, T.</a> and <a>C. Pignataro</a>, "<a href="http://tools.ietf.org/html/rfc5654">Requirements for the Transport Profile of MPLS</a>", RFC 5654, April 2009.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">9.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC3031">[RFC3031]</b></td>
<td class="top">
<a>Rosen, E.</a>, <a>Viswanathan, A.</a> and <a>R. Callon</a>, "<a href="http://tools.ietf.org/html/rfc3031">Multiprotocol Label Switching Architecture</a>", RFC 3031, January 2001.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3985">[RFC3985]</b></td>
<td class="top">
<a>Bryant, S.</a> and <a>P. Pate</a>, "<a href="http://tools.ietf.org/html/rfc3985">Pseudo Wire Emulation Edge-to-Edge (PWE3) Architecture</a>", RFC 3985, March 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5921">[RFC5921]</b></td>
<td class="top">
<a title="Alcatel Lucent">Bocci, M.</a>, <a title="Cisco">Bryant, S.</a>, <a title="Cisco">Frost, D.</a> and <a title="Alcatel-Lucent">L. Levrau</a>, "<a href="http://tools.ietf.org/html/rfc5921">MPLS-TP Framework</a>", RFC 5921, July 2010.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6372">[RFC6372]</b></td>
<td class="top">
<a>Sprecher, N.</a> and <a>A. Farrel</a>, "<a href="http://tools.ietf.org/html/rfc6372">MPLS-TP Survivability Framework</a>", RFC 6372, Sept 2011.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5085">[RFC5085]</b></td>
<td class="top">
<a>Nadeau, T.</a> and <a>C. Pignataro</a>, "<a href="http://tools.ietf.org/html/rfc5085">Pseudo Wire (PW) Virtual Circuit Connectivity Verification ((VCCV): A Control Channel for Pseudowires</a>", RFC 5085, Dec 2007.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5586">[RFC5586]</b></td>
<td class="top">
<a>Bocci, M.</a>, <a>Vigoureux, M.</a> and <a>S. Bryant</a>, "<a href="http://tools.ietf.org/html/rfc5586">MPLS Generic Associated Channel</a>", RFC 5586, June 2009.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4428">[RFC4428]</b></td>
<td class="top">
<a>Papadimitriou, D.</a> and <a>E. Mannie</a>, "<a href="http://tools.ietf.org/html/rfc4428">Analysis of Generalized Multi-Protocol Label Switching (GMPLS) based Recovery Mechanisms (including Protection and Restoration) Recovery (Protection and Restoration)</a>", RFC 4428, March 2006.</td>
</tr>
<tr>
<td class="reference"><b id="G.808.1">[G.808.1]</b></td>
<td class="top">
<a>SG15, </a>, "<a>Generic Protection Switching - Linear trail and subnetwork protection</a>", ITU-T G.808.1, Feb 2010.</td>
</tr>
</tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Tae-sik Cheung</span> 
	  <span class="n hidden">
		<span class="family-name">Cheung</span>
	  </span>
	</span>
	<span class="org vcardline">ETRI</span>
	<span class="adr">
	  <span>161 Gajeong</span>

	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region">Yuseong, Daejeon</span> 
		<span class="code">305-700</span>
	  </span>
	  <span class="country-name vcardline">South Korea</span>
	</span>
	<span class="vcardline">Phone: +82 42 860 5646</span>

<span class="vcardline">EMail: <a href="mailto:cts@etri.re.kr">cts@etri.re.kr</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Jeong-dong Ryoo</span> 
	  <span class="n hidden">
		<span class="family-name">Ryoo</span>
	  </span>
	</span>
	<span class="org vcardline">ETRI</span>
	<span class="adr">
	  <span>161 Gajeong</span>

	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region">Yuseong, Daejeon</span> 
		<span class="code">305-700</span>
	  </span>
	  <span class="country-name vcardline">South Korea</span>
	</span>
	<span class="vcardline">Phone: +82 42 860 5384</span>

<span class="vcardline">EMail: <a href="mailto:ryoo@etri.re.kr">ryoo@etri.re.kr</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Yaacov Weingarten</span> 
	  <span class="n hidden">
		<span class="family-name">Weingarten</span>
	  </span>
	</span>
	<span class="org vcardline">Nokia Siemens Networks</span>
	<span class="adr">
	  <span>3 Hanagar St. Neve Ne'eman B</span>

	  <span class="vcardline">
		<span class="locality">Hod Hasharon</span>,  
		<span class="region"></span>
		<span class="code">45241</span>
	  </span>
	  <span class="country-name vcardline">Israel</span>
	</span>
	<span class="vcardline">Phone: +972-9-775 1827</span>

<span class="vcardline">EMail: <a href="mailto:yaacov.weingarten@nsn.com">yaacov.weingarten@nsn.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Nurit Sprecher</span> 
	  <span class="n hidden">
		<span class="family-name">Sprecher</span>
	  </span>
	</span>
	<span class="org vcardline">Nokia Siemens Networks</span>
	<span class="adr">
	  <span>3 Hanagar St. Neve Ne'eman B</span>

	  <span class="vcardline">
		<span class="locality">Hod Hasharon</span>,  
		<span class="region"></span>
		<span class="code">45241</span>
	  </span>
	  <span class="country-name vcardline">Israel</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:nurit.sprecher@nsn.com">nurit.sprecher@nsn.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Daniel King</span> 
	  <span class="n hidden">
		<span class="family-name">King</span>
	  </span>
	</span>
	<span class="org vcardline">Old Dog Consulting</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline">United Kingdom</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:daniel@olddog.co.uk">daniel@olddog.co.uk</a></span>

  </address>
</div>

</body>
</html>