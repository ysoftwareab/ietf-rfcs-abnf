Prearranged-Key-Info =
         "Prearranged-Key-Info" ":" Hdr-Cipher "," CoveredDEK "," CoverKey-ID
CoverKey-ID = method ":" key-name
CoveredDEK = *HEX
method = "inband" |  "outband"


MAC = hex(H(Message||[<time>]||<shared key>))


HMAC = hex(H(K' ^ pad2 || H(K' ^ pad1 ||[<time>]|| Message)))
pad1 = the byte 0x36 repeated enough times to fill out a
                   hash input block. (I.e. 64 times for both MD5 and SHA-1)
pad2 = the byte 0x5c repeated enough times to fill out a
                   hash input block.
MAC-Info =
hex-time = <unsigned seconds since Unix epoch represented as HEX>
hash-alg = <hash algorithms from section 3.2.4.8>
hex-hash-data = <computation as described above represented as HEX>
Key-Spec = "null" | "dek" | Key-ID


Option = Field ":" Key-val ";" *(Key-val)
Key-val = Key "=" Value *("," Value)
Key = Mode"-"Action             ; This is represented as one token
                                           ; without whitespace
Mode = "orig" | "recv"
Action = "optional" | "required" | "refused"

recv-optional=cms,MOSS

recv-required=DH


Your-Key-Pattern =
                "Your-Key-Pattern" ":" key-use "," pattern-info
key-use = "cover-key" | "auth-key" | "signing-key"


pattern-info = name-domain "," pattern-data


Value = DN-spec *("," Dn-spec)["."]
Dn-spec = "/" *(Field-spec) "/"
Attr = "CN" | "L" | "ST" | "O" |
                   "OU" | "C" | <or as appropriate>
Pattern = <POSIX 1003.2 regular expressions>


orig-required=CMS
orig-required=X.509
orig-optional=Inband,DH
orig-optional=encrypt


recv-optional=CMS
recv-optional=X.509
recv-optional=DH,Inband,Outband
recv-optional=RSA-MD5
recv-optional=DES-CBC
recv-optional=DES-ECB
recv-required=encrypt;
recv-optional=sign, auth
Encryption-Identity =
                   "Encryption Identity" ":" name-class,key-sel,name-arg
name-class = "DN-1485" | MOSS name forms

Key-Assign =
                "Key-Assign" ":" Method "," Key-Name ","
                Lifetime "," Ciphers ";" Method-args

Key-name = string
Lifetime = "this" | "reply" | ""
Method ="inband"
Ciphers = "null" | Cipher+
kv = "4" | "5"


Key-ID = method ":" key-name
SHTTP-Cryptopts =
                   "SHTTP-Cryptopts" ":" scope ";" cryptopt-list
scope = "scope="<tag-spec>    ; This is all one token without whitespace
tag-spec = tag *("," tag) | ""
cryptopt-list = cryptopt *(";" cryptopt)
cryptopt = <S-HTTP cryptopt lines described below>
tag = <value used in HTML anchor NAME attribute>


orig-required=cms; recv-optional=cms,MOSS


AAAAA==
CRYPTOPTS="Key-Assign: Inband,alice1,reply,des-ecb;020406080a0c0e0f;
AAAAAAAAAAA=
Message = *Content
Content = Data | SignedData | EnvelopedData |
                   DigestedData | EncryptedData
Data = Bytes
SignedData = *DigestAlg Content *Certificates
                    *CRLs SignerInfo*
EnvelopedData = *RecipientInfo BulkCryptAlg
                   Encrypted(Content)
DigestedData = DigestAlg Content DigestBytes
EncryptedData = BulkCryptAlg Encrypted(Bytes)
SignerInfo = CertID ... Encrypted(DigestBytes) ...
RecipientInfo = CertID KeyCryptAlg Encrypted(DEK)

