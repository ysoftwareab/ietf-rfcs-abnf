<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Protecting The Router Control Plane</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Protecting The Router Control Plane">
<meta name="keywords" content="ACL">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">OPSEC</td><td class="header">D. Dugal</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Juniper Networks</td></tr>
<tr><td class="header">Intended status: Informational</td><td class="header">C. Pignataro</td></tr>
<tr><td class="header">Expires: July 8, 2010</td><td class="header">R. Dunn</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Cisco Systems</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">January 04, 2010</td></tr>
</table></td></tr></table>
<h1><br />Protecting The Router Control Plane<br />draft-dugal-opsec-protect-control-plane-00.txt</h1>

<h3>Abstract</h3>

<p>
This memo provides a recommendation for protecting a router's control plane from undesired or malicious traffic.
In this recommendation, all legitimate control plane traffic is identifed. Once legitimate traffic has been 
identified, a filter is deployed on the router's forwarding plane. That filter prevents traffic not specifically
identified as legitimate from reaching the router's control plane.
The examples given are simplified and minimalistic, designed to 
illustrate the concept of protecting the router's control plane.

</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on July 8, 2010.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the BSD License.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#Introduction">1.</a>&nbsp;
Introduction<br />
<a href="#Method">2.</a>&nbsp;
Method<br />
<a href="#Legitimate_Traffic">3.</a>&nbsp;
Legitimate Traffic<br />
<a href="#Filter_Design">4.</a>&nbsp;
Filter Design<br />
<a href="#Security">5.</a>&nbsp;
Security Considerations<br />
<a href="#IANA">6.</a>&nbsp;
IANA Considerations<br />
<a href="#Acks">7.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">8.</a>&nbsp;
Informative References<br />
<a href="#CiscoIOSConfig">Appendix&nbsp;A.</a>&nbsp;
Cisco Configuration<br />
<a href="#JUNOSConfig">Appendix&nbsp;B.</a>&nbsp;
Juniper Configuration<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="Introduction"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>
One of the primary goals of modern core router architecture design is to 
maintain a strict separation of forwarding and control plane hardware 
and software.
Forwarding plane is defined as router architecture hardware and software 
components responsible for taking a packet coming in one interface, 
performing a lookup to identify the packet's IP next hop and determine the outgoing interface towards the 
destination, and forwarding the packet through the correct outgoing interface.
Control plane supports routing and management functions, and is defined as router architecture hardware and 
software components for handling packets destined to the device itself 
as well as building and sending packets originated locally on the 
device.

</p>
<p>
Visually it can be represented as the control plane hardware 
sitting on top of and interfacing with the forwarding plane hardware, with interfaces 
connecting to other network devices. See <a class='info' href='#Fig1'>Figure&nbsp;1<span> (</span><span class='info'>Router Control Plane Protection</span><span>)</span></a>.

</p><br /><hr class="insert" />
<a name="Fig1"></a>
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
              +---------------+
              | Control Plane |
              +------+ +------+
                     | |
                Router Control
               Plane Protection
                     | |
              +------+ +------+
              |   Forwarding  |
Interface X ==[     Plane     ]== Interface Y
              +---------------+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: Router Control Plane Protection&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>
Typically, forwarding plane functionality is realized in high-performance Application 
Specific Integrated Circuits (ASICs) that are capable of handling frames 
transit the device at multiple levels of magnitude greater load than the 
control plane hardware.
By contrast, the control plane is generally realized in software on general purpose processors.
And while
software instructions run on both planes, the control plane software is usually not 
optimized for high speed packet handling. ASICs perform well even with high offered load,
but in most cases control plane hardware can be overwhelmed by a DoS attack.
Additionally, the control plane is what drives the programming of the forwarding plane.
Therefore, it is imperative that the control plane remain stable regardless of 
traffic load to and from the device.

</p>
<p>
When compared to forwarding plane functionality, control plane 
functionality is more complex as it has to fully process protocol constructs in packets to and 
from the device versus simply rewriting the header of a transit frame to 
move it from one interface to another along the path towards the 
destination. The full processing of the contents of packets and the function of keeping protocol states and machineries result in more potential 
security vulnerabilities as well as a more likely target for a DoS 
attack given the lesser processing power at the control plane level.

</p>
<p>
Because the control plane is more susceptible to attacks, it is 
advisable to protect the control plane by implementing mechanisms to 
filter completely or rate limit traffic not required at the control 
plane level (i.e., unwanted traffic). Control Plane Protection is the concept of filtering 
traffic unwanted traffic which would be diverted out of the forwarding plane up to the control 
plane. The closer to the forwarding plane and line-rate hardware the filters and rate-limiters are,
the more effective the protection is and the more resistent the system is to DoS attacks.
This memo demonstrates how to deploy such a filter.

</p>
<a name="Method"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Method</h3>

<p>
In this memo, the authors demonstrate how a filter protecting the control plane can be deployed.
In  <a class='info' href='#Legitimate_Traffic'>Section&nbsp;3<span> (</span><span class='info'>Legitimate Traffic</span><span>)</span></a>, a sample router introduced and all traffic that its 
control plane must process is identified. In  <a class='info' href='#Filter_Design'>Section&nbsp;4<span> (</span><span class='info'>Filter Design</span><span>)</span></a>,  filter design  concepts are discussed. 
Cisco (Cisco IOS software) and Juniper (JUNOS) implementations are provided in Appendices <a class='info' href='#CiscoIOSConfig'>A<span> (</span><span class='info'>Cisco Configuration</span><span>)</span></a> and <a class='info' href='#JUNOSConfig'>B<span> (</span><span class='info'>Juniper Configuration</span><span>)</span></a>, respectively.

</p>
<a name="Legitimate_Traffic"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Legitimate Traffic</h3>

<p>
In this example, the router control plane must process traffic from the following sources:

</p>
<p>
</p>
<ul class="text">
<li> 
ICMP traffic from any source, rate-limited

</li>
<li>   
OSPF traffic from routers within own network (network mask 192.0.2.0/24)

</li>
<li> 
iBGP traffic from routers within own network (network mask 192.0.2.0/24)

</li>
<li> 
eBGP traffic from known eBGP peers (network addresses 198.51.100.25, 198.51.100.27, 198.51.100.29, 198.51.100.31)

</li>
<li>
DNS traffic from local DNS resolvers (198.51.100.0/30)

</li>
<li>
NTP traffic from local NTP (198.51.100.4/30)

</li>
<li>
SSH traffic from network management stations (198.51.100.128/25)

</li>
<li>
SNMP traffic from network management stations (198.51.100.128/25)

</li>
</ul><p>

</p>
<p>
The characteristics of legitimate traffic will vary from network to network. The list provided above is for 
example only.

</p>
<a name="Filter_Design"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Filter Design</h3>

<p>
A filter is installed on the forwarding plane. This filter counts and silently discards all traffic 
not matching the profile provided in <a class='info' href='#Legitimate_Traffic'>Section&nbsp;3<span> (</span><span class='info'>Legitimate Traffic</span><span>)</span></a>. Because the filter is 
enforced on the forwarding plane, it prevents unwanted traffic from consuming bandwidth on the
interface that connects the forwarding plane to the control plane.

    The counters serve as an important forensic tool for the analysis of 
    potential attacks, and as an invaluable debugging and 
    troubleshooting aid.

</p>
<p>
A rate limiter also is installed on the forwarding plane. The rate limiter restricts ICMP traffic bound for the 
control plane to some reasonable volume. In our example, we will rate limit to 2 Megabits per second (Mbps).

</p>
<p>
Syntactically, these filters explicitly define "allowed" traffic (including IP addresses, protocols, and ports),
define acceptable actions for these acceptable traffic profiles (e.g., rate-limit or simply permit the traffic),
and then drop to the bit bucket all traffic destined to the control plane but not explicitly allowed.

</p>
<a name="Security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Security Considerations</h3>

<p>
    The filter above leaves the router susceptible to discovery from any 
    host on the Internet. If network operators find this risk 
    objectionable, they can mitigate it by restricting the sub-networks 
    from which ICMP Echo requests are accepted.

</p>
<p>
The filter above also leaves the router exposed to port scans from hosts spoofing the source addresses
found in <a class='info' href='#Legitimate_Traffic'>Section&nbsp;3<span> (</span><span class='info'>Legitimate Traffic</span><span>)</span></a>. Network operators can 
mitigate this risk by  preventing source address
spoofing with filters applied at the network edge.
Refer to Section 5.3.8 of <a class='info' href='#RFC1812'>[RFC1812]<span> (</span><span class='info'>Baker, F., &ldquo;Requirements for IP Version 4 Routers,&rdquo; June&nbsp;1995.</span><span>)</span></a>
for more information regarding source address validation.

</p>
<p>
The ICMP rate limiter specified in this filter protects the router from floods of ICMP traffic. However, 
during an ICMP flood, some legitimate ICMP traffic may be dropped. Because of this, when operators discover a flood of ICMP
traffic, they are highly motivated to cut it off at its source.

</p>
<p>
    The treatment of exception traffic in the forwarding plane, 
    and the generation of specific messages by the control plane also requires 
    protection from a DoS attack.  Specifically, the generation of ICMP 
    Unreachable messages by the control plane needs to be rate-limited,
    either implicitly within the router's architecture or explicitly through 
    configuration.    See Section 4.3.2.8 of <a class='info' href='#RFC1812'>[RFC1812]<span> (</span><span class='info'>Baker, F., &ldquo;Requirements for IP Version 4 Routers,&rdquo; June&nbsp;1995.</span><span>)</span></a>.
    Additionally, the handling of TTL / Hop Limit expired traffic needs 
    protection. For example, rate limiting the TTL / Hop Limit expired 
    traffic before sending the packets to the control plane component 
    that will send the ICMP error, and distributing the sending of ICMP 
    errors in a Line Card CPU are protection mechanisms that  deter 
    attacks before a rate limited in the main control plane 
    component.

</p>
<a name="IANA"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
IANA Considerations</h3>

<p>
[RFC Editor: please remove this section prior to publication.]

</p>
<p>
This document has no IANA actions.

</p>
<a name="Acks"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Acknowledgements</h3>

<p>
    The authors would like to thank Ron Bonica for providing review, 
    suggestions, and valuable input.

</p>
<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>8.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC1812">[RFC1812]</a></td>
<td class="author-text"><a href="mailto:fred@cisco.com">Baker, F.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1812">Requirements for IP Version 4 Routers</a>,&rdquo; RFC&nbsp;1812, June&nbsp;1995 (<a href="http://www.rfc-editor.org/rfc/rfc1812.txt">TXT</a>).</td></tr>
</table>

<a name="CiscoIOSConfig"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Cisco Configuration</h3>

<p>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
!Start: Protecting The Router Control Plane
!
!Policy-map Configuration
!
!Access-list Definitions
ip access-list extended ICMP
 permit icmp any any
ip access-list extended OSPF
 permit ospf 192.0.2.0 0.0.0.255 any
ip access-list extended IBGP
 permit tcp 192.0.2.0 0.0.0.255 eq bgp any
 permit tcp 192.0.2.0 0.0.0.255 any eq bgp
ip access-list extended EBGP
 permit tcp host 198.51.100.25 eq bgp any
 permit tcp host 198.51.100.25 any eq bgp
 permit tcp host 198.51.100.27 eq bgp any
 permit tcp host 198.51.100.27 any eq bgp
 permit tcp host 198.51.100.29 eq bgp any
 permit tcp host 198.51.100.29 any eq bgp
 permit tcp host 198.51.100.31 eq bgp any
 permit tcp host 198.51.100.31 any eq bgp
ip access-list extended DNS
 permit udp 198.51.100.0 0.0.0.252 eq domain any
ip access-list extended NTP
 permit udp 198.51.100.4 255.255.255.252 any eq ntp
ip access-list extended SSH
 permit tcp 198.51.100.0 0.0.0.128 any eq 22
ip access-list extended SNMP
 permit udp 198.51.100.128 0.0.0.125 eq snmp any
 permit udp 198.51.100.128 0.0.0.125 eq snmptrap any
!
!Class Definitions
!
class-map match-all ICMP
 match access-group name ICMP
class-map match-all OSPF
 match access-group name OSPF
class-map match-all IBGP
 match access-group name IBGP
class-map match-all EBGP
 match access-group name EBGP
class-map match-all DNS
 match access-group name DNS
class-map match-all NTP
 match access-group name NTP
class-map match-all SSH
 match access-group name SSH
class-map match-all SNMP
 match access-group name SNMP
!
!Policy Definition
!
policy-map COPP
 class ICMP
  police 2000000
 class OSPF
 class IBGP
 class EBGP
 class DNS
 class NTP
 class SSH
 class SNMP
 class class-default
   police cir 8000
     conform-action drop
     exceed-action drop
     violate-action drop
!
!Control Plane Configuration
!
control-plane
 service-policy input COPP
!
!End: Protecting The Router Control Plane
</pre></div><p>



</p>
<a name="JUNOSConfig"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B"></a><h3>Appendix B.&nbsp;
Juniper Configuration</h3>

<p>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
firewall {
    policer 2Mbps {
        if-exceeding {
            bandwidth-limit 2m;
            burst-size-limit 2k;
        }
        then discard;
    }
    family inet {
        filter protect-control-plane {
            term icmp {
                from {
                    protocol icmp;
                }
                policer 2Mbps;
                then accept;
            }
            term ospf {
                from {
                    source-address {
                        192.0.2.0/24;
                    }
                    protocol ospf;
                }
                then accept;
            }
            term ibgp-connect {
                from {
                    source-address {
                        192.0.2.0/24;
                    }
                    protocol tcp;
                    destination-port bgp;
                }
                then accept;
            }
           term ibgp-reply {
                from {
                    source-address {
                        192.0.2.0/24;
                    }
                    protocol tcp;
                    port bgp;
                }
                then accept;
            }
            term ebgp-connect {
                from {
                    source-address {
                        198.51.100.25;
                        198.51.100.27;
                        198.51.100.29;
                        198.51.100.31;
                    }
                    protocol tcp;
                    destination-port bgp;
                }
                then accept;
            }
            term ebgp-reply {
                from {
                    source-address {
                        198.51.100.25;
                        198.51.100.27;
                        198.51.100.29;
                        198.51.100.31;
                    }
                    protocol tcp;
                    port bgp;
                }
                then accept;
            }
            term dns {
                from {
                    source-address {
                        198.51.100.0/30;
                    }
                    protocol udp;
                    port domain;
                }
                then accept;
            }
            term ntp {
                from {
                    source-address {
                        198.51.100.4/30;
                    }
                    protocol udp;
                    destination-port ntp;
                }
                then accept;
            }
            term ssh {
                from {
                    source-address {
                        198.51.100.128/25;
                    }
                    protocol tcp;
                    destination-port ssh;
                }
                then accept;
            }
            term snmp {
                from {
                    source-address {
                        198.51.100.128/25;
                    }
                    protocol udp;
                    port [snmp snmptrap];
                }
                then accept;
            }
            term default-term {
                then {
                    count copp-discards;
                    log;
                    discard;
                }
            }
        }
    }
}
interfaces {
    lo0 {
        unit 0 {
            family inet {
                filter input protect-control-plane;
            }
         }
    }
}
</pre></div><p>



</p>
<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">David Dugal</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Juniper Networks</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">10 Technology Park Drive</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Westford, MA  01886</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:ddugal@juniper.net">ddugal@juniper.net</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Carlos Pignataro</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">7200-12 Kit Creek Road</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Research Triangle Park, NC  27709</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:cpignata@cisco.com">cpignata@cisco.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Rodney Dunn</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">7200-12 Kit Creek Road</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Research Triangle Park, NC  27709</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:rodunn@cisco.com">rodunn@cisco.com</a></td></tr>
</table>
</body></html>
