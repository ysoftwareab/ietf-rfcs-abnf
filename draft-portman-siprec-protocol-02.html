<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>The SIP-based Media Recording Protocol (SIPREC)</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="The SIP-based Media Recording Protocol (SIPREC)">
<meta name="keywords" content="siprec">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 60em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 60em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">SIPREC</td><td class="header">L. Portman, Ed.</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">NICE Systems</td></tr>
<tr><td class="header">Intended status: Informational</td><td class="header">H. Lum</td></tr>
<tr><td class="header">Expires: July 21, 2011</td><td class="header">Genesys, Alcatel-Lucent</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">A. Johnston</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Avaya</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">A. Hutton</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Siemens Enterprise Communications</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">January 17, 2011</td></tr>
</table></td></tr></table>
<h1><br />The SIP-based Media Recording Protocol (SIPREC)<br />draft-portman-siprec-protocol-02</h1>

<h3>Abstract</h3>

<p>SIPREC Session Recording Protocol is used for establishing recording session and reporting of the metadata of the communication session.
</p>
<p>This document specifies the SIPREC Protocol (SIPREC).  SIPREC is used between Session Recording Client (SRC) and Session Recording Server (SRS).
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted  in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF).  Note that other groups may also distribute
working documents as Internet-Drafts.  The list of current
Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
This Internet-Draft will expire on July 21, 2011.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2011 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the Simplified BSD License.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#Introduction">1.</a>&nbsp;
Introduction<br />
<a href="#Definitions">2.</a>&nbsp;
Definitions<br />
<a href="#anchor1">3.</a>&nbsp;
Scope<br />
<a href="#Overview">4.</a>&nbsp;
Overview of operations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">4.1.</a>&nbsp;
Delivering recorded media<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">4.2.</a>&nbsp;
Delivering recording metadata<br />
<a href="#extensions">5.</a>&nbsp;
SIP Extensions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">5.1.</a>&nbsp;
Callee Capabilities Extensions for SIP Recording<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">5.1.1.</a>&nbsp;
src Feature Tag<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">5.1.2.</a>&nbsp;
srs Feature Tag<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">5.2.</a>&nbsp;
SDP handling<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">5.3.</a>&nbsp;
Metadata<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">5.3.1.</a>&nbsp;
Delivering Metadata as a stream of events<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">5.3.1.1.</a>&nbsp;
Example - indication for which the SRS is willing to receive INFO Package<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#realtime_control">5.4.</a>&nbsp;
Recording Pause and Resume<br />
<a href="#transport">6.</a>&nbsp;
Transport<br />
<a href="#failover">7.</a>&nbsp;
Failover and Recovery<br />
<a href="#error_handling">8.</a>&nbsp;
Error Handling<br />
<a href="#iana">9.</a>&nbsp;
IANA Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">9.1.</a>&nbsp;
New Content-Disposition Parameter Registrations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">9.2.</a>&nbsp;
MIME Type<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">9.3.</a>&nbsp;
Info Package<br />
<a href="#Security">10.</a>&nbsp;
Security Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#authentication">10.1.</a>&nbsp;
Authentication and Authorization<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">10.2.</a>&nbsp;
Privacy of metadata<br />
<a href="#rfc.references1">11.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">11.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">11.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="Introduction"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>Communication session recording requires establishment of a recording session (RS) between a session recording client (SRC) and session recording server (SRS). The overall architecture for media recording is described in the architecture draft <a class='info' href='#I-D.ietf-siprec-architecture'>[I&#8209;D.ietf&#8209;siprec&#8209;architecture]<span> (</span><span class='info'>Hutton, A., Portman, L., Jain, R., and K. Rehor, &ldquo;An Architecture for Media Recording using the Session Initiation Protocol,&rdquo; October&nbsp;2010.</span><span>)</span></a>
</p>
<p>The SIPREC Requirements <a class='info' href='#I-D.ietf-siprec-req'>[I&#8209;D.ietf&#8209;siprec&#8209;req]<span> (</span><span class='info'>Rehor, K., Portman, L., Hutton, A., and R. Jain, &ldquo;Requirements for SIP-based Media Recording (SIPREC),&rdquo; December&nbsp;2010.</span><span>)</span></a> list a set of requirements that need to be met by session recording protocols.  SIP is chosen to be the protocol to establish the recording session to deliver recorded media to the session recording server.  Additional SIP extensions are specified in this document to meet some of the requirements outlined in the requirements draft.
</p>
<p>In order to describe the recorded media and the communication sessions involved, a metadata model is described in <a class='info' href='#I-D.ram-siprec-metadata'>[I&#8209;D.ram&#8209;siprec&#8209;metadata]<span> (</span><span class='info'>R, R., R, P., and P. Kyzivat, &ldquo;Session Initiation Protocol (SIP) Recording Metadata,&rdquo; December&nbsp;2010.</span><span>)</span></a> to deliver additional information shared between SRC and SRS.
</p>
<a name="Definitions"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Definitions</h3>

<p>The core SIPREC definitions are taken from the requirements document <a class='info' href='#I-D.ietf-siprec-req'>[I&#8209;D.ietf&#8209;siprec&#8209;req]<span> (</span><span class='info'>Rehor, K., Portman, L., Hutton, A., and R. Jain, &ldquo;Requirements for SIP-based Media Recording (SIPREC),&rdquo; December&nbsp;2010.</span><span>)</span></a>.
</p>
<p>
	  </p>
<blockquote class="text"><dl>
<dt>Session Recording Server (SRS)</dt>
<dd>A Session Recording Server (SRS) is a SIP User Agent (UA) that is a specialized media server or collector that acts as the sink of the recorded media.  An SRS is a logical function that typically archives media for extended durations of time and provides interfaces for search and retrieval of the archived media.  An SRS is typically implemented as a multi-port device that is capable of receiving media from several sources simultaneously. An SRS is typically also the sink of the recorded session metadata.
</dd>
<dt>Session Recording Client (SRC)</dt>
<dd>A Session Recording Client (SRC) is a SIP User Agent (UA) that acts as the source of the recorded media, sending it to the SRS.  An SRC is a logical function.  Its capabilities may be implemented across one or more physical devices.  In practice, an SRC could be a personal device (such as a SIP phone), a SIP Media Gateway (MG), a Session Border Controller (SBC) or a SIP Media Server (MS) integrated with an Application Server (AS).  This specification defines the term SRC such that all such SIP entities can be generically addressed under one definition.  The SRC itself or another entity working on its behalf (such as a SIP Application Server) may act as the source of the recording metadata.
</dd>
<dt>Communication Session (CS)</dt>
<dd>A session created between two or more SIP User Agents (UAs) that is the target for recording.
</dd>
<dt>Recording Session (RS)</dt>
<dd> The SIP session created between an SRC and SRS for the purpose of recording a Communication Session.
</dd>
<dt></dt>
<dd>Figure 1 pictorially represents the relationship between a Recording Session and Communication Session.
</dd>
</dl></blockquote><p>
   </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

  +-------------+                                      +-----------+
  |             |        Communication Session         |           |
  |     A       |&lt;------------------------------------&gt;|     B     |
  |             |                                      |           |
  +-------------+                                      +-----------+
  ..................................................................
  .                             Session                            .
  .                            Recording                           .
  .                             Client                             .
  ..................................................................
                                   |
                                   | Recording
                                   | Session
                                   |
                                   v
                            +------------+
                            |   Session  |
                            |  Recording |
                            |   Server   |
                            +------------+

	   Figure 1: Relationship between CS, SRC, SRS, and RS

</pre></div><p>

   </p>
<blockquote class="text"><dl>
<dt>Metadata</dt>
<dd>Information that describes recorded media and the CS to which they relate.
</dd>
<dt>Pause during a Communication Session:</dt>
<dd> The action of temporarily discontinuing the transmission and collection of RS media.
</dd>
<dt>Resume during a Communication Session:</dt>
<dd>The action of recommencing the transmission and collection of RS media.
</dd>
</dl></blockquote><p>
      
</p>
<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Scope</h3>

<p>The scope of the SIPREC protocol includes the establishment of the recording sessions and the reporting of the metadata, and extensions to the communication sessions.
</p>
<p>The following items, which is not an exhaustive list, do not represent the SIPREC protcol itself and are considered out of the scope of the SIPREC protcol:
</p>
<p></p>
<ul class="text">
<li>Recording policies that determine whether the CS should be recorded
</li>
<li>Retention policies that determine how long a recording is stored
</li>
<li>Searching and accessing the recorded media and metadata
</li>
<li>Delivering recording session metadata through non-SIP mechanism
</li>
</ul><p>
		
</p>
<a name="Overview"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Overview of operations</h3>

<p>This section is informative and provides a description of SIPREC operations.
</p>
<p>As mentioned in the architecture document <a class='info' href='#I-D.ietf-siprec-architecture'>[I&#8209;D.ietf&#8209;siprec&#8209;architecture]<span> (</span><span class='info'>Hutton, A., Portman, L., Jain, R., and K. Rehor, &ldquo;An Architecture for Media Recording using the Session Initiation Protocol,&rdquo; October&nbsp;2010.</span><span>)</span></a>, there are a couple of types of call flows based on the location of the Session Recording Client. The following sample call flows provide a quick overview of the operations between the SRC and the SRS.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Delivering recorded media</h3>

<p>When the SRC is deployed as a B2BUA, the SRC can route call requests from UA(A) to UA(B). As a SIP B2BUA, the SRC has access to the SDP and therefore can manipulate the media path between the user agents.  When the SRC is aware that it should be recording the conversation, the SRC may bridge the media between UA(A) and UA(B).  The SRC then establishes the Recording Session with the SRS and sends replicated media towards the SRS.
</p>
<p>An endpoint can act as the SRC, and in this case may establish the Recording Session to the SRS.  Since the endpoint has access to the media in the communication session, the endpoint can send replicated media towards the SRS.
</p>
<p>The following basic call flow shows the SRC establishing a recording session towards the SRS. The call flow is essentially identical when the SRC is a B2BUA or as the endpoint itself.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

UA A           B2BUA                   UA B                   SRS
 |             (SRC)                    |                      |
 |(1)CS INVITE  |                       |                      |
 |-------------&gt;|                       |                      |
 |              |(2)CS INVITE           |                      |
 |              |----------------------&gt;|                      |
 |              |               (3)OK   |                      |
 |              |&lt;----------------------|                      |
 |        (4)OK |                       |                      |
 |&lt;-------------|                       |                      |
 |              |(5)RS INVITE (CallId + Participants) with SDP |
 |              |---------------------------------------------&gt;|
 |              |                       |       (6)OK with SDP |
 |              |&lt;---------------------------------------------|
 |(7)CS RTP     |                       |                      |
 |=============&gt;|======================&gt;|                      |
 |&lt;=============|&lt;======================|                      |
 |              |(8)RS RTP              |                      |
 |              |=============================================&gt;|
 |              |=============================================&gt;|
 |(9)CS BYE     |                       |                      |
 |-------------&gt;|                       |                      |
 |              |(10)CS BYE             |                      |
 |              |----------------------&gt;|                      |
 |              |(11)RS BYE             |                      |
 |              |---------------------------------------------&gt;|
 |              |                       |                      |

         Figure 2: Basic Recording Call flow

</pre></div>
<p>A conference focus may also act as an SRC since it has access to all the media from each conference participant.  In this example, a user agent may REFER the conference focus to the SRS, and the SRC may choose to mix media streams from all participants as a single media stream towards the SRS.  In order to tell the conference focus to start a recording session to the SRS, the user agent can include the srs feature tag in the Refer-To header as per <a class='info' href='#RFC4508'>[RFC4508]<span> (</span><span class='info'>Levin, O. and A. Johnston, &ldquo;Conveying Feature Tags with the Session Initiation Protocol (SIP) REFER Method,&rdquo; May&nbsp;2006.</span><span>)</span></a>.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

 UA A                 Focus                 UA B                SRS
   |                  (SRC)                  |                   |
   |                    |                    |                   |
   |      (already in a conference)          |                   |
   |&lt;==================&gt;|&lt;==================&gt;|                   |
   |(1)REFER sip:Conf-ID Refer-To:&lt;SRS&gt;;srs  |                   |
   |-------------------&gt;|                                        |
   |(2)202 Accepted     |                                        |
   |&lt;-------------------|                                        |
   |  (3)NOTIFY (Trying)|                                        |
   |&lt;-------------------|                                        |
   |(4)200 OK           |                                        |
   |-------------------&gt;|                                        |
   |                    |(5)INVITE Contact:Conf-ID;isfocus       |
   |                    |---------------------------------------&gt;|
   |                    |                              (6)200 OK |
   |                    |&lt;---------------------------------------|
   |                    | (7)RTP (mixed or unmixed)              |
   |                    |=======================================&gt;|
   |     (8)NOTIFY (OK) |                                        |
   |&lt;-------------------|                                        |
   |(9)200 OK           |                                        |
   |-------------------&gt;|                                        |

  Figure 3: Recording call flow - SRC as a conference focus

</pre></div>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Delivering recording metadata</h3>

<p>Certain metadata, such as the attributes of the recorded media stream, are already included in the SDP of the recording session.  This information is reused as part of the metadata.  The SRC may update or add additional metadata about recorded media streams in requests such as INVITE, reINVITE, and UPDATE in the Recording Session.  
</p>
<p>The rest of the metadata will be delivered as content.  Metadata can also be represented as a stream of events.  There are 4 ways to transport metadata events as outlined in the architecture document:
</p>
<p>SIP INVITE Content: for a simple call recording use case where no mid-dialog events are required to be delivered after the RS is established, the SIP INVITE may include content for all the metadata needed for the call.
</p>
<p>SIP INFO Package: metadata can be provided as an INFO package <a class='info' href='#I-D.ietf-sipcore-info-events'>[I&#8209;D.ietf&#8209;sipcore&#8209;info&#8209;events]<span> (</span><span class='info'>Holmberg, C., Burger, E., and H. Kaplan, &ldquo;Session Initiation Protocol (SIP) INFO Method and Package Framework,&rdquo; October&nbsp;2010.</span><span>)</span></a> and sent as mid-dialog messages within the recording session.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

   UA A                   UA B                    SRS
   (SRC)                    |                      |
    |(1)CS INVITE           |                      |
    |----------------------&gt;|                      |
    |               (2)OK   |                      |
    |&lt;----------------------|                      |
    |(3)RS INVITE (SDP)     |                      |
    |---------------------------------------------&gt;|
    |                       |       (4)OK with SDP |
    |----------------------------------------------|
    |(5)CS RTP              |                      |
    |======================&gt;|                      |
    |&lt;======================|                      |
    |(6)RS RTP              |                      |
    |=============================================&gt;|
    |=============================================&gt;|
    |(7)RS INFO (metadata)  |                      |
    |---------------------------------------------&gt;|
    |(8)CS BYE              |                      |
    |----------------------&gt;|                      |
    |(9)RS BYE              |                      |
    |---------------------------------------------&gt;|
    |                       |                      |

       Figure 4: Delivering metadata via SIP INFO

</pre></div>
<p>[OPEN ISSUE: is Event Package desired?]
</p>
<p>Event Package: Metadata can also be conveyed from the SRC to the SRS using the SIP event notification mechanism <a class='info' href='#RFC3265'>[RFC3265]<span> (</span><span class='info'>Roach, A., &ldquo;Session Initiation Protocol (SIP)-Specific Event Notification,&rdquo; June&nbsp;2002.</span><span>)</span></a>.  Using a subscription allows the SRC to deliver metadata to the SRS when the lifecycles of the CS and RS are different.  This also allows the SRC to deliver session metadata and recorded media separately, for example, an SRS that reports metadata for multiple recording sessions as a single subscription.
</p>
<p>Non-SIP transport: In some cases session metadata can be conveyed through non-SIP mechanism such as HTTP or JTAPI.  These non-SIP mechanisms are considered out of the scope of the SIPREC protocol, however, it is envisioned that a link with a URI can be provided in the recording session INVITE message so that the SRS can access the session metadata via the URI provided that the SRS supports the type of URI.
</p>
<a name="extensions"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
SIP Extensions</h3>

<p>The following sections describe SIP extensions for the recording protocol.
</p>
<p>The From header must contain the identity of the SRC.  Participants information is not recorded in the From or To header; they are included in the metadata information.
</p>
<p>Note that a recording session does not have to have live within the scope of a single communication session. As outline in REQ-005 of <a class='info' href='#I-D.ietf-siprec-req'>[I&#8209;D.ietf&#8209;siprec&#8209;req]<span> (</span><span class='info'>Rehor, K., Portman, L., Hutton, A., and R. Jain, &ldquo;Requirements for SIP-based Media Recording (SIPREC),&rdquo; December&nbsp;2010.</span><span>)</span></a>, the recording session can be established in the absence of a communication session.  In this case, the SRC must offer an SDP with zero m= lines.
</p>
<p>Recorded media from multiple communication sessions may be handled in a single recording session.  The SRC provides a reference of each recorded media stream to the metadata described in the next section.
</p>
<p>The SRC must be able to accept re-INVITE from SRS with the updated SDP as part of the session timer mechanism.
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Callee Capabilities Extensions for SIP Recording</h3>

<p>
This section discusses  how the callee capabilities defined in <a class='info' href='#RFC3840'>[RFC3840]<span> (</span><span class='info'>Rosenberg, J., Schulzrinne, H., and P. Kyzivat, &ldquo;Indicating User Agent Capabilities in the Session Initiation Protocol (SIP),&rdquo; August&nbsp;2004.</span><span>)</span></a> can be extended for SIP call recording. 

</p>
<p>
SIP Callee Capabilities defines feature tags which are used to represent characteristics and capabilities of a UA.  From RFC 3840:

</p>
<p>
</p>
<blockquote class="text">
<p>
  "Capability and characteristic information about a UA is carried as parameters of
   the Contact header field.  These parameters can be used within
   REGISTER requests and responses, OPTIONS responses, and requests and
   responses that create dialogs (such as INVITE)."

</p>
</blockquote><p>

</p>
<p>
Note that feature tags are also used in dialog modifying requests and responses such as re-INVITE and responses to a re-INVITE, and UPDATE.  The 'isfocus' feature tag, defined in <a class='info' href='#RFC4579'>[RFC4579]<span> (</span><span class='info'>Johnston, A. and O. Levin, &ldquo;Session Initiation Protocol (SIP) Call Control - Conferencing for User Agents,&rdquo; August&nbsp;2006.</span><span>)</span></a> is similar semantically to this case: it indicates that the UA is acting as a SIP conference focus, and is performing a specific action (mixing) on the resulting media stream.  This information is available from OPTIONS queries, dialog package notifications, and the SIP registration event package.

</p>
<p>
We propose the definition of two new feature tags:  'src' and 'srs'.

</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.1"></a><h3>5.1.1.&nbsp;
src Feature Tag</h3>

<p>
The 'src' feature tag is used in Contact URIs by the Session Recording Client (SRC) related to recording sessions.  A Session Recording Server uses the presence of this feature tag in dialog creating and modifying requests and responses to confirm that the dialog being created is for the purpose of a Recording Session. In addition, a registrar could discover that a UA is an SRC based on the presence of this feature tag in a registration.  Other SIP Recording extensions and behaviors can be triggered by the presence of this feature tag.

</p>
<p>
Note that we could use a single feature tag, such as 'recording' used by either an SRC or SRS to identify that the session is a recording session.  However, due to the differences in functionality and behavior between an SRC and SRS, using only one feature tag for both is not ideal.  For instance, if a routing mistake resulted in a request from a SRC being routed back to another SRC, if only one feature tag were defined, they would not know right away about the error and could become confused.  With separate feature tags, they would realize the error immediately and terminate the session.  Also, call logs would clearly show the routing error.

</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.2"></a><h3>5.1.2.&nbsp;
srs Feature Tag</h3>

<p>
The 'srs' feature tag is used in Contact URIs by the Session Recording Server (SRS) related to recording sessions.  A Session Recording Client uses the presence of this feature tag in dialog creating and modifying requests and responses to confirm that the dialog being created is for the purpose of a Recording Session (REQ-30). In addition, a registrar could discover that a UA is an SRS based on the presence of this feature tag in a registration. Other SIP Recording extensions and behaviors can be triggered by the presence of this feature tag.

</p>
<p>
To ensure a recording session is redirected to an SRS, an SRC can utilize the SIP Caller Preferences extensions, defined in <a class='info' href='#RFC3841'>[RFC3841]<span> (</span><span class='info'>Rosenberg, J., Schulzrinne, H., and P. Kyzivat, &ldquo;Caller Preferences for the Session Initiation Protocol (SIP),&rdquo; August&nbsp;2004.</span><span>)</span></a>.  The presence of a Accept-Contact: *;sip.srs allows a UA to request that the INVITE be routed to an SRS.  Note that to be completely sure, the SRC would need to include a Require: prefs header field field in the request.

</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
SDP handling</h3>

<p>SRC can include one or more media streams to the SRS.  The SRS must respond with the same number of media descriptors in the SDP body of the 200 OK.
</p>
<p>The SRC should use a=sendonly attribute as the SRC does not expect to receive media from the SRS.  As SRS only receives RTP streams from SRS, the 200 OK response will normally contain SDP with a=recvonly attribute.
</p>
<p>Since the SRC may send recorded media of different participants (or even mixed streams) to the SRS, the SDP must provide a label on each media stream in order to identify the recorded stream with the rest of the metadata.  The a=label attribute <a class='info' href='#RFC4574'>[RFC4574]<span> (</span><span class='info'>Levin, O. and G. Camarillo, &ldquo;The Session Description Protocol (SDP) Label Attribute,&rdquo; August&nbsp;2006.</span><span>)</span></a> will be used to identify each recorded media stream, and the label name will be used as the reference for the metadata.  Note that a participant may have multiple streams (audio and video) and each stream is labeled separately.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

           v=0
           o=SRS 0 0 IN IP4 172.22.3.8
           s=SRS
           c=IN IP4 172.22.3.8
           t=0 0
           m=audio 12241 RTP/AVP 0 4 8
           a=sendonly
           a=label:1
           m=audio 12242 RTP/AVP 98
           a=rtpmap:98 H264/90000
           a=fmtp:98 ...
           a=sendonly
           a=label:2
           m=audio 12243 RTP/AVP 0 4 8
           a=sendonly
           a=label:3
           m=audio 12244 RTP/AVP 98
           a=rtpmap:98 H264/90000
           a=fmtp:98 ...
           a=sendonly
           a=label:4

    Figure 6: Sample SDP with audio and video streams

</pre></div>
<p>To remove a recorded media stream from the recording session, send a reINVITE and set the port to zero in the m= line.
</p>
<p>To add a recorded media stream, send a reINVITE and add a new m= line.
</p>
<p>The SRS may respond with a=inactive attribute as part of the SDP in the 200 OK response when the SRS is not ready to receive recorded media.  The SRS can send re-INVITE to update the SDP with a=recvonly when it is ready to receive media.
</p>
<p>The following sequence diagram shows an example of SRS responds with SDP that contain a=inactive, and then later update media information update with re-INVITE.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

  SRC                                                   SRS
   |                                                     |
   |(1) INVITE (no offer)                                |
   |----------------------------------------------------&gt;|
   |                         (2)200 OK with SDP inactive |
   |&lt;----------------------------------------------------|
   |(3) ACK with SDP inactive                            |
   |----------------------------------------------------&gt;|
   |                      ...                            |
   |                     (4) re-INVITE with SDP recvonly |
   |&lt;----------------------------------------------------|
   |(5)200 OK with SDP sendonly                          |
   |----------------------------------------------------&gt;|
   |                                  (6) ACK with SDP   |
   |&lt;----------------------------------------------------|
   |(7) RTP                                              |
   |====================================================&gt;|
   |                      ...                            |
   |(8) BYE                                              |
   |----------------------------------------------------&gt;|
   |                                             (9) OK  |
   |&lt;----------------------------------------------------|

	   Figure 7: SRS to offer with a=inactive

</pre></div>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3"></a><h3>5.3.&nbsp;
Metadata</h3>

<p>The format of the full metadata will be described as part of the mechanism in <a class='info' href='#I-D.ram-siprec-metadata'>[I&#8209;D.ram&#8209;siprec&#8209;metadata]<span> (</span><span class='info'>R, R., R, P., and P. Kyzivat, &ldquo;Session Initiation Protocol (SIP) Recording Metadata,&rdquo; December&nbsp;2010.</span><span>)</span></a>.
</p>
<p>As mentioned in the previous section, the SDP of the recording session is the metadata for all recorded media streams. The label attribute contains a reference to the rest of the metadata information.
</p>
<p>For all basic metadata information such as communication session, participants, call identifiers and direction, they can be included in the initial INVITE request sent by the SRC. Metadata can be included as content in the INVITE request.  A new "disposition-type" of Content-Disposition is defined for this purpose and the value is "recording-session".  There is a single payload type "application/rs-metadata" defined for recording metadata.
</p>
<p>The following SIP example for RS establishment between SRC and SRS with metadata as content.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

    INVITE sip:97753210@10.240.3.10:5060 SIP/2.0
    From: &lt;sip:2000@10.226.240.3&gt;;tag=35e195d2-947d-4585-946f-098392474
    To: &lt;sip:Recorder@10.240.3.10&gt;
    Call-ID: d253c800-b0d1ea39-4a7dd-3f0e20a@10.226.240.3
    CSeq: 101 INVITE
    Date: Thu, 26 Nov 2009 02:38:49 GMT
    Supported: timer
    Supported: replaces
    User-Agent: B2BUA
    Max-Forwards: 70
    Allow: INVITE,OPTIONS,INFO,BYE,CANCEL,ACK,PRACK,UPDATE,
      REFER,SUBSCRIBE,NOTIFY,PUBLISH
    Allow-Events: presence,kpml
	Min-SE: 90
    Contact: &lt;sip:2000@10.226.240.3:5060;transport=tcp&gt;;isfocus;src
    Via: SIP/2.0/TCP 10.226.240.3:5060;branch=z9hG4bKdf6b622b648d9
    Session-Expires: 1800
    Content-Type: multipart/mixed;boundary=foobar
    Content-Length: [length]

    --foobar
    Content-Type: application/sdp

    v=0
    o=SRS 0 0 IN IP4 10.226.240.3
    c=IN IP4 10.226.240.3
    t=0 0
    m=audio 12241 RTP/AVP 0 4 8
    a=sendonly
    a=label:1

    --foobar
    Content-Type: application/rs-metadata
    Content-Disposition: recording-session

    [metadata content]

        Figure 8: Sample INVITE request for the recording session

</pre></div>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.1"></a><h3>5.3.1.&nbsp;
Delivering Metadata as a stream of events</h3>

<p>Recording metadata can delivered as a stream of events.  For this case, the metadata events is reported as SIP INFO messages within the recording session.  INFO Package is chosen as the mechanism because the metadata events does not always have to be associated with changes to the recorded media that requires the use of a reINVITE.  For example, when a new participant is joined to a recorded conference and the SRS is receiving the recorded media as a mixed audio stream, then there is no need to send a reINVITE update the recorded media; an INFO message with the necessary metadata to describe the new participant is sufficient information for the SRS.
</p>
<p>The Info Package name is "recording-session".  This name is used in both the Info-Package header as well as the Recv-Info header fields.
</p>
<p>The SRS must set the Recv-Info header to indicate that it is willing to receive INFO requests for Info Package recording-session.  The SRC is not required to set the Recv-Info header since it does not expect to receive any Info Package from the SRS.
</p>
<p>There is only a single payload type "application/rs-metadata" defined for the Info Package.  Similar to the metadata format for INVITE requests, the metadata format is defined in <a class='info' href='#I-D.ram-siprec-metadata'>[I&#8209;D.ram&#8209;siprec&#8209;metadata]<span> (</span><span class='info'>R, R., R, P., and P. Kyzivat, &ldquo;Session Initiation Protocol (SIP) Recording Metadata,&rdquo; December&nbsp;2010.</span><span>)</span></a>.
</p>
<p>This Info Package does not impose any rate limit or throttling mechansim for the stream of metadata events.  A recording session is not expect to emit a high rate of metadata events, however, there are scenarios where there can be short bursts metadata events generated.  For example, when a scheduled conference is being recorded, there can be a burst of participants joining the conference at the scheduled time and hence a burst of metadata update to the communication session.
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.1.1"></a><h3>5.3.1.1.&nbsp;
Example - indication for which the SRS is willing to receive INFO Package</h3>

<p>The SRC initiates a recording session and indicates that it is the SRC.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

    INVITE sip:srs@example.com SIP/2.0
    Via: SIP/2.0/TCP src12.example.com;branch=z9hG4bKdf6b622b648d9
    From: &lt;sip:src@example.com&gt;;tag=35e195d2
    To: &lt;sip:srs@example.com&gt;
    Call-ID: d253c800-b0d1ea39-4a7dd-3f0e20a@10.226.240.3
    CSeq: 101 INVITE
    Contact: &lt;sip:src12.example.com&gt;;src
    Content-Type: multipart/mixed;boundary=foobar
    Content-Length: ...

    ...

</pre></div>
<p>The SRS sends a 200 OK response and indicate that it is willing to receive metadata Info Package
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

    SIP/2.0 200 OK
    Via: SIP/2.0/TCP src12.example.com;branch=z9hG4bKdf6b622b648d9
    From: &lt;sip:src@example.com&gt;;tag=35e195d2
    To: &lt;sip:srs@example.com&gt;;tag=12345678
    Call-ID: d253c800-b0d1ea39-4a7dd-3f0e20a@10.226.240.3
    CSeq: 101 INVITE
    Contact: &lt;sip:srs07.example.com&gt;;srs
    Recv-Info: recording-session
    Content-Type: application/sdp
    Content-Length: ...

    ...

</pre></div>
<p>After the recording session is established, the SRC sends an INFO request to the SRS to indicate participant changes to the communication session.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

    INFO sip:srs07.example.com SIP/2.0
    Via: SIP/2.0/TCP src12.example.com;branch=z9hG4bKdf6b622abcd
    From: &lt;sip:src@example.com&gt;;tag=35e195d2
    To: &lt;sip:srs@example.com&gt;;tag=12345678
    Call-ID: d253c800-b0d1ea39-4a7dd-3f0e20a@10.226.240.3
    CSeq: 102 INFO
    Contact: &lt;sip:src12.example.com&gt;;src
    Info-Package: recording-session
    Content-Type: application/rs-metadata
    Content-Disposition: Info-Package
    Content-Length: ...

    [metadata content]

</pre></div>
<a name="realtime_control"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.4"></a><h3>5.4.&nbsp;
Recording Pause and Resume</h3>

<p>To temporarily discontinue streaming and collection of recorded media from the SRC to the SRS, the SRC must send a reINVITE and set a=inactive for each recorded media stream to be paused.
</p>
<p>To resume streaming and collection of recorded media, the SRC must send a reINVITE and set a=sendonly for each recorded media stream to resume.
</p>
<p>Note that when a media stream in the CS is muted/unmuted, this information may conveyed in the metadata by the SRC.  The SRC should not modify the recorded media stream with a=inactive for mute since this operation is reserved for pausing the RS media.
</p>
<a name="transport"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Transport</h3>

<p>TBD
</p>
<a name="failover"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Failover and Recovery</h3>

<p>TBD
</p>
<a name="error_handling"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Error Handling</h3>

<p>For handling errors with session establishment of the recording session, error handling of a standard SIP dialog applies.
</p>
<p>For handling errors with the metadata content such as syntactic or semantic errors, it is possible to introduce another Info content as a response to each metadata content sent by the SRS in order to allow the SRS to posivitively or negatively acknowledge each metadata content. [TBD - need to sync with metadata draft]
</p>
<a name="iana"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
IANA Considerations</h3>

<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.1"></a><h3>9.1.&nbsp;
New Content-Disposition Parameter Registrations</h3>

<p>This document registers a new "disposition-type" value in Content-Disposition header: recording-session.
</p>
<p>recording-session   the body describes the metadata information about the recording session
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.2"></a><h3>9.2.&nbsp;
MIME Type</h3>

<p>This document registers the application/rs-metadata MIME media type in order to describe the recording session metadata. This media type is defined by the following information:
</p>
<p>  Media type name: application
</p>
<p>  Media subtype name: rs-metadata
</p>
<p>  Required parameters: none
</p>
<p>  Options parameters: none
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.3"></a><h3>9.3.&nbsp;
Info Package</h3>

<p>This document registers a new INFO package for transpoting recording session metadata.
</p>
<p>Info Package Name: recording-session
</p>
<p>Reference: [RFCXXXX]
</p>
<a name="Security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
Security Considerations</h3>

<p>The recording session is fundamentally a standard SIP dialog <a class='info' href='#RFC3261'>[RFC3261]<span> (</span><span class='info'>Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;SIP: Session Initiation Protocol,&rdquo; June&nbsp;2002.</span><span>)</span></a>, therefore, the recording session can reuse any of the existing SIP security mechanism available for securing the recorded media as well as metadata.
</p>
<a name="authentication"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.1"></a><h3>10.1.&nbsp;
Authentication and Authorization</h3>

<p>The recording session reuses the SIP mechanism to challenge requests that is based on HTTP authentication.  The mechanism relies on 401 and 407 SIP responses as well as other SIP header fields for carrying challenges and credentials.
</p>
<p>The SRS may have its own set of recording policies to authorize recording requests from the SRC. The use of recording policies is outside the scope of the SIPREC protocol.
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.2"></a><h3>10.2.&nbsp;
Privacy of metadata</h3>

<p>Since metadata is transported as content in SIP messages such as INVITE and INFO Packages, the requests can be routed through SIP proxies between the SRC and SRS. If the metadata content is considered private, then the SRC and SRS will need to use end-to-end encryption such as S/MIME in addition to hop-by-hop security (SIP/TLS) to prevent access by proxies or B2BUAs.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>11.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.ietf-siprec-req">[I-D.ietf-siprec-req]</a></td>
<td class="author-text">Rehor, K., Portman, L., Hutton, A., and R. Jain, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-siprec-req-06.txt">Requirements for SIP-based Media Recording (SIPREC)</a>,&rdquo; draft-ietf-siprec-req-06 (work in progress), December&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-siprec-req-06.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2804">[RFC2804]</a></td>
<td class="author-text">IAB and IESG, &ldquo;<a href="http://tools.ietf.org/html/rfc2804">IETF Policy on Wiretapping</a>,&rdquo; RFC&nbsp;2804, May&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2804.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3261">[RFC3261]</a></td>
<td class="author-text">Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;<a href="http://tools.ietf.org/html/rfc3261">SIP: Session Initiation Protocol</a>,&rdquo; RFC&nbsp;3261, June&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3261.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3265">[RFC3265]</a></td>
<td class="author-text">Roach, A., &ldquo;<a href="http://tools.ietf.org/html/rfc3265">Session Initiation Protocol (SIP)-Specific Event Notification</a>,&rdquo; RFC&nbsp;3265, June&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3265.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3840">[RFC3840]</a></td>
<td class="author-text">Rosenberg, J., Schulzrinne, H., and P. Kyzivat, &ldquo;<a href="http://tools.ietf.org/html/rfc3840">Indicating User Agent Capabilities in the Session Initiation Protocol (SIP)</a>,&rdquo; RFC&nbsp;3840, August&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3840.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3841">[RFC3841]</a></td>
<td class="author-text">Rosenberg, J., Schulzrinne, H., and P. Kyzivat, &ldquo;<a href="http://tools.ietf.org/html/rfc3841">Caller Preferences for the Session Initiation Protocol (SIP)</a>,&rdquo; RFC&nbsp;3841, August&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3841.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4574">[RFC4574]</a></td>
<td class="author-text">Levin, O. and G. Camarillo, &ldquo;<a href="http://tools.ietf.org/html/rfc4574">The Session Description Protocol (SDP) Label Attribute</a>,&rdquo; RFC&nbsp;4574, August&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4574.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>11.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.ietf-sipcore-info-events">[I-D.ietf-sipcore-info-events]</a></td>
<td class="author-text">Holmberg, C., Burger, E., and H. Kaplan, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-sipcore-info-events-10.txt">Session Initiation Protocol (SIP) INFO Method and Package Framework</a>,&rdquo; draft-ietf-sipcore-info-events-10 (work in progress), October&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-sipcore-info-events-10.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-siprec-architecture">[I-D.ietf-siprec-architecture]</a></td>
<td class="author-text">Hutton, A., Portman, L., Jain, R., and K. Rehor, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-siprec-architecture-01.txt">An Architecture for Media Recording using the Session Initiation Protocol</a>,&rdquo; draft-ietf-siprec-architecture-01 (work in progress), October&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-siprec-architecture-01.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ram-siprec-metadata">[I-D.ram-siprec-metadata]</a></td>
<td class="author-text">R, R., R, P., and P. Kyzivat, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ram-siprec-metadata-02.txt">Session Initiation Protocol (SIP) Recording Metadata</a>,&rdquo; draft-ram-siprec-metadata-02 (work in progress), December&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ram-siprec-metadata-02.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4508">[RFC4508]</a></td>
<td class="author-text">Levin, O. and A. Johnston, &ldquo;<a href="http://tools.ietf.org/html/rfc4508">Conveying Feature Tags with the Session Initiation Protocol (SIP) REFER Method</a>,&rdquo; RFC&nbsp;4508, May&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4508.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4579">[RFC4579]</a></td>
<td class="author-text">Johnston, A. and O. Levin, &ldquo;<a href="http://tools.ietf.org/html/rfc4579">Session Initiation Protocol (SIP) Call Control - Conferencing for User Agents</a>,&rdquo; BCP&nbsp;119, RFC&nbsp;4579, August&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4579.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Leon Portman (editor)</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">NICE Systems</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">8 Hapnina</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Ra'anana  43017</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Israel</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:leon.portman@nice.com">leon.portman@nice.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Henry Lum</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Genesys, Alcatel-Lucent</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">1380 Rodick Road, Suite 200</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Markham, Ontario  L3R4G5</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Canada</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:henry.lum@genesyslab.com">henry.lum@genesyslab.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Alan Johnston</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Avaya</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">St. Louis, MO  63124</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:alan.b.johnston@gmail.com">alan.b.johnston@gmail.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Andrew Hutton</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Siemens Enterprise Communications</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:andrew.hutton@siemens-enterprise.com">andrew.hutton@siemens-enterprise.com</a></td></tr>
</table>
</body></html>
