



Network Working Group                                         J.G. Gould
Internet-Draft                                                D.S. Smith
Intended status: Standards Track                          VeriSign, Inc.
Expires: 13 January 2022                                     J.K. Kolker
                                                             R.C. Carney
                                                            GoDaddy Inc.
                                                            12 July 2021


Redacted Fields in the Registration Data Access Protocol (RDAP) Response
                  draft-gould-regext-rdap-redacted-00

Abstract

   This document describes an RDAP extension for explicitly identifying
   redacted RDAP response fields, using JSONPath as the default
   expression language.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on 13 January 2022.

Copyright Notice

   Copyright (c) 2021 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents (https://trustee.ietf.org/
   license-info) in effect on the date of publication of this document.
   Please review these documents carefully, as they describe your rights
   and restrictions with respect to this document.  Code Components
   extracted from this document must include Simplified BSD License text
   as described in Section 4.e of the Trust Legal Provisions and are
   provided without warranty as described in the Simplified BSD License.



Gould, et al.            Expires 13 January 2022                [Page 1]

Internet-Draft           Redacted Fields in RDAP               July 2021


Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
   2.  Conventions Used in This Document . . . . . . . . . . . . . .   2
   3.  Redaction Methods . . . . . . . . . . . . . . . . . . . . . .   3
     3.1.  Redaction by Removal Method . . . . . . . . . . . . . . .   3
     3.2.  Redaction by Empty Value Method . . . . . . . . . . . . .   4
   4.  Redacted RDAP Response  . . . . . . . . . . . . . . . . . . .   5
     4.1.  RDAP Conformance  . . . . . . . . . . . . . . . . . . . .   5
     4.2.  "redacted" Member . . . . . . . . . . . . . . . . . . . .   5
   5.  JSONPath Considerations . . . . . . . . . . . . . . . . . . .  21
   6.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .  21
     6.1.  RDAP Extensions Registry  . . . . . . . . . . . . . . . .  21
   7.  Security Considerations . . . . . . . . . . . . . . . . . . .  22
   8.  Acknowledgements  . . . . . . . . . . . . . . . . . . . . . .  22
   9.  References  . . . . . . . . . . . . . . . . . . . . . . . . .  22
     9.1.  Normative References  . . . . . . . . . . . . . . . . . .  22
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  23

1.  Introduction

   This document describes an RDAP extension for explicitly identifying
   redacted RDAP response fields, using JSONPath as the default
   expression language.  A redacted RDAP field is one that has data
   removed from the RDAP response due to the lack of client privilege to
   receive the field.  This extension can be used to identify redacted
   RDAP fields in any RDAP object class, as defined in [RFC7483], or
   RDAP fields defined in RDAP extensions.  Because an RDAP response may
   exclude a field due to either the lack of data or based on the lack
   of RDAP client privileges, this extension is used to explicitly
   specify which RDAP fields are not included in the RDAP response due
   to redaction.  It thereby provides a capability for disambiguation
   between redaction and possible other reasons for data or field
   absence.

   JSONPath, as defined in [I-D.ietf-jsonpath-base], is used as the
   default expression language to reference RDAP fields that have been
   redacted.  The redacted JSON fields will either be removed or have
   empty values in the RDAP response.  JSON is defined by [RFC8259].

2.  Conventions Used in This Document

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in BCP
   14 [RFC2119] [RFC8174] when, and only when, they appear in all
   capitals, as shown here.




Gould, et al.            Expires 13 January 2022                [Page 2]

Internet-Draft           Redacted Fields in RDAP               July 2021


   The JSON examples include extra line breaks and whitespace.  For
   instance, the JSONPath expressions are broken out into multiple lines
   when required for illustration.

3.  Redaction Methods

   Redaction in RDAP can be handled in multiple ways.  The use of
   placeholder text for the values of the RDAP fields, such as the
   placeholder text "XXXX", MUST NOT be used for redaction.  A
   placeholder text value will not match the format requirements of each
   of the RDAP fields and provides an inconsistent and unreliable
   redaction signal.  This section covers the redaction methods that can
   be used with the redaction signaling defined in Section 4.2.

   RDAP responses, as defined in [RFC7483], include a mix of JSON
   objects and JSON arrays, where JSON arrays are heavily used for
   entity objects with jCard [RFC7095].  jCard [RFC7095] is a JSON
   representation of vCard [RFC6350] that inherits its dependency on
   arrays.  An example is the vCard [RFC6350] "ADR" property / jCard
   [RFC7095] "adr" property that defines a sequence of address
   components.  According to [RFC6350], when an "ADR" property component
   value is missing, the associated component separator MUST still be
   specified.  jCard [RFC7095] extends the use of arrays with each
   individual vCard property being represented by an array of three
   fixed elements, followed by one or more additional elements.  The mix
   of JSON objects and JSON arrays impacts the methods used for
   redaction in RDAP.  The redaction of RDAP fields fall into the two
   categories of Redaction by Removal Method (Section 3.1) and Redaction
   by Empty Value Method (Section 3.2), defined in the following sub-
   sections.

3.1.  Redaction by Removal Method

   The Redaction by Removal Method is when the RDAP field is removed
   from the RDAP response, which is the preferred method.  The Redaction
   by Removal Method can be done for all RDAP response fields other than
   the JSON arrays used with jCard [RFC7095].  When an RDAP object is
   redacted by removal, all of the RDAP object's child fields are also
   removed.  Only the redacted RDAP object needs to be referenced in the
   list of redacted fields, as defined in Section 4.2.  An example of
   redacting an RDAP object is removing the administrative contact from
   the RDAP response and including the following "redacted" member:









Gould, et al.            Expires 13 January 2022                [Page 3]

Internet-Draft           Redacted Fields in RDAP               July 2021


   "redacted": [
     {
       "name": "Administrative Contact",
       "path": "$.entities[?(@.roles[0]=='administrative')]",
       "method": "removal"
       "reason": "Client request"
     }
   ]

   The Redaction by Removal Method MUST NOT be used to remove a field
   from a jCard [RFC7095] fixed array position, which will result in a
   non-conformant jCard [RFC7095] array definition.

3.2.  Redaction by Empty Value Method

   The Redaction by Empty Value Method is when a redacted field is not
   removed, but its value is set to an empty value, such as "" for a
   jCard [RFC7095] Text ("text") property or null for non-Text ("text")
   properties.  The empty jCard [RFC7095] values ("" or null) are
   referenced in the "redacted" member in place of the jCard [RFC7095]
   property name, such as referencing the "fn" jCard property value at
   position 3 instead of referencing the "fn" jCard property name at
   position 0.  The Redaction by Empty Value Method SHOULD be used only
   when redacting JSON response fields that use jCard [RFC7095] arrays.
   Optional jCard [RFC7095] properties SHOULD use the Redaction by
   Removal Method (Section 3.1) to redact the entire property.  The
   required jCard [RFC7095] "fn" property, defined in section 6.2.1 of
   vCard [RFC6350], MUST use the Redaction by Empty Value Method to
   redact the property value.  Removing the "fn" property would violate
   vCard [RFC6350] and removing the property value would violate the
   fixed array positions defined in jCard [RFC7095].

   An example of the redacted field "fn" jCard property using the
   Redaction by Empty Value Method:

   [
     "fn",
     {},
     "text",
     ""
   ]

   An example of the "redacted" member for the redacted "fn" jCard
   property value, which is array position 3:







Gould, et al.            Expires 13 January 2022                [Page 4]

Internet-Draft           Redacted Fields in RDAP               July 2021


   "redacted": [
     {
       "name": "Registrant Name",
       "path": "$.entities[?(@.roles[0]=='registrant')].
         vcardArray[1][?(@[0]=='fn')][3]",
       "pathLang": "jsonpath",
       "method": "emptyValue"
       "reason": "Server policy"
     }
   ]

4.  Redacted RDAP Response

4.1.  RDAP Conformance

   RDAP responses that contain values described in this document MUST
   indicate conformance with this specification by including an
   rdapConformance ([RFC7483]) value of "redacted_0".  The information
   needed to register this value in the RDAP Extensions Registry is
   described in Section 6.1.

   Example rdapConformance member with the redacted extension:

   "rdapConformance" :
   [
     "rdap_level_0",
     "redacted_0"
   ]

4.2.  "redacted" Member

   The "redacted" member MUST be added to the RDAP response when there
   are redacted fields.  The "redacted" member contains an array of
   redacted objects with the following child members:

   "name":  A logical name for the redacted field.  The logical name
       used for the redacted field is up to server policy.  Conventions
       used for the chosen logical names MAY be defined in other
       documents to meet the needs of different RDAP services or
       industries.

   "path":  The JSON expression of the redacted field, using the
       expression language defined by the "pathLang" member.  The JSON
       expression references a removed JSON field or an empty field
       value based on Section 3.

   "pathLang":  OPTIONAL JSON path expression language used, with the




Gould, et al.            Expires 13 January 2022                [Page 5]

Internet-Draft           Redacted Fields in RDAP               July 2021


       default value of "jsonpath" for JSONPath
       ([I-D.ietf-jsonpath-base]).  Other JSON path expression languages
       MAY be used based on server policy.

   "method":  OPTIONAL redaction method used with "removal" indicating
       the Redaction By Removed Method (Section 3.1) and "emptyValue"
       indicating the Redaction by Empty Value Method (Section 3.2),
       with the default value of "removal".

   "reason":  OPTIONAL human readable reason(s) for the redacted field
       in the language defined by the [RFC7483] "lang" member.  The
       default language is "en" if the [RFC7483] "lang" member is not
       specified.  The "reason" member is provided for informational
       purposes and MUST NOT be a client processing dependency.

   Example unredacted version of RDAP response:

     {
       "rdapConformance": [
         "rdap_level_0"
       ],
       "objectClassName": "domain",
       "handle": "ABC123",
       "ldhName": "example.com",
       "secureDNS": {
         "delegationSigned": false
       },
       "notices": [
         {
           "title": "Terms of Use",
           "description": [
             "Service subject to Terms of Use."
           ],
           "links": [
             {
               "rel": "self",
               "href": "https://www.example.com/terms-of-use",
               "type": "text/html",
               "value": "https://www.example.com/terms-of-use"
             }
           ]
         }
       ],
       "nameservers": [
         {
           "objectClassName": "nameserver",
           "ldhName": "ns1.example.com"
         },



Gould, et al.            Expires 13 January 2022                [Page 6]

Internet-Draft           Redacted Fields in RDAP               July 2021


         {
           "objectClassName": "nameserver",
           "ldhName": "ns2.example.com"
         }
       ],
       "entities": [
         {
           "objectClassName": "entity",
           "handle": "123",
           "roles": [
             "registrar"
           ],
           "publicIds": [
             {
               "type": "IANA Registrar ID",
               "identifier": "1"
             }
           ],
           "vcardArray": [
             "vcard",
             [
               [
                 "version",
                 {},
                 "text",
                 "4.0"
               ],
               [
                 "fn",
                 {},
                 "text",
                 "Example Registrar Inc."
               ],
               [
                 "adr",
                 {},
                 "text",
                 [
                   "",
                   "Suite 100",
                   "123 Example Dr.",
                   "Dulles",
                   "VA",
                   "20166-6503",
                   "US"
                 ]
               ],
               [



Gould, et al.            Expires 13 January 2022                [Page 7]

Internet-Draft           Redacted Fields in RDAP               July 2021


                 "email",
                 {},
                 "text",
                 "contact@organization.example"
               ],
               [
                 "tel",
                 {
                   "type": "voice"
                 },
                 "uri",
                 "tel:+1.7035555555;ext=1234"
               ],
               [
                 "tel",
                 {
                   "type": "fax"
                 },
                 "uri",
                 "tel:+1.7035555556"
               ]
             ]
           ],
           "entities": [
             {
               "objectClassName": "entity",
               "roles": [
                 "abuse"
               ],
               "vcardArray": [
                 "vcard",
                 [
                   [
                     "version",
                     {},
                     "text",
                     "4.0"
                   ],
                   [
                     "fn",
                     {},
                     "text",
                     "Abuse Contact"
                   ],
                   [
                     "email",
                     {},
                     "text",



Gould, et al.            Expires 13 January 2022                [Page 8]

Internet-Draft           Redacted Fields in RDAP               July 2021


                     "abuse@organization.example"
                   ],
                   [
                     "tel",
                     {
                       "type": "voice"
                     },
                     "uri",
                     "tel:+1.7035555555;ext=1234"
                   ]
                 ]
               ]
             }
           ]
         },
         {
           "roles": [
             "registrant"
           ],
           "vcardArray": [
             "vcard",
             [
               [
                 "version",
                 {},
                 "text",
                 "4.0"
               ],
               [
                 "fn",
                 {},
                 "text",
                 "Registrant User"
               ],
               [
                 "org",
                 {},
                 "text",
                 "Example Inc."
               ],
               [
                 "adr",
                 {},
                 "text",
                 [
                   "",
                   "Suite 1235",
                   "4321 Rue Somewhere",



Gould, et al.            Expires 13 January 2022                [Page 9]

Internet-Draft           Redacted Fields in RDAP               July 2021


                   "Quebec",
                   "QC",
                   "G1V 2M2",
                   "Canada"
                 ]
               ],
               [
                 "email",
                 {},
                 "text",
                 "registrant.user@example.com"
               ],
               [
                 "tel",
                 {
                   "type": "voice"
                 },
                 "uri",
                 "tel:+1-555-555-1235;ext=123"
               ],
               [
                 "tel",
                 {
                   "type": "fax"
                 },
                 "uri",
                 "tel:+1-555-555-5321"
               ]
             ]
           ]
         },
         {
           "roles": [
             "technical"
           ],
           "vcardArray": [
             "vcard",
             [
               [
                 "version",
                 {},
                 "text",
                 "4.0"
               ],
               [
                 "fn",
                 {},
                 "text",



Gould, et al.            Expires 13 January 2022               [Page 10]

Internet-Draft           Redacted Fields in RDAP               July 2021


                 "Technical User"
               ],
               [
                 "org",
                 {},
                 "text",
                 "Example Inc."
               ],
               [
                 "adr",
                 {},
                 "text",
                 [
                   "",
                   "Suite 1234",
                   "4321 Rue Somewhere",
                   "Quebec",
                   "QC",
                   "G1V 2M2",
                   "Canada"
                 ]
               ],
               [
                 "email",
                 {},
                 "text",
                 "technical.user@example.com"
               ],
               [
                 "tel",
                 {
                   "type": "voice"
                 },
                 "uri",
                 "tel:+1-555-555-1234;ext=321"
               ],
               [
                 "tel",
                 {
                   "type": "fax"
                 },
                 "uri",
                 "tel:+1-555-555-4321"
               ]
             ]
           ]
         },
         {



Gould, et al.            Expires 13 January 2022               [Page 11]

Internet-Draft           Redacted Fields in RDAP               July 2021


           "roles": [
             "administrative"
           ],
           "vcardArray": [
             "vcard",
             [
               [
                 "version",
                 {},
                 "text",
                 "4.0"
               ],
               [
                 "fn",
                 {},
                 "text",
                 "Administrative User"
               ],
               [
                 "org",
                 {},
                 "text",
                 "Example Inc."
               ],
               [
                 "adr",
                 {},
                 "text",
                 [
                   "",
                   "Suite 1236",
                   "4321 Rue Somewhere",
                   "Quebec",
                   "QC",
                   "G1V 2M2",
                   "Canada"
                 ]
               ],
               [
                 "email",
                 {},
                 "text",
                 "administrative.user@example.com"
               ],
               [
                 "tel",
                 {
                   "type": "voice"



Gould, et al.            Expires 13 January 2022               [Page 12]

Internet-Draft           Redacted Fields in RDAP               July 2021


                 },
                 "uri",
                 "tel:+1-555-555-1236;ext=789"
               ],
               [
                 "tel",
                 {
                   "type": "fax"
                 },
                 "uri",
                 "tel:+1-555-555-6321"
               ]
             ]
           ]
         }
       ],
       "events": [
         {
           "eventAction": "registration",
           "eventDate": "1997-06-03T00:00:00Z"
         },
         {
           "eventAction": "last changed",
           "eventDate": "2020-05-28T01:35:00Z"
         },
         {
           "eventAction": "expiration",
           "eventDate": "2021-06-03T04:00:00Z"
         }
       ],
       "status": [
         "server delete prohibited",
         "server update prohibited",
         "server transfer prohibited",
         "client transfer prohibited"
       ]
     }

   Example redacted version of RDAP response:

     {
       "rdapConformance": [
         "rdap_level_0",
         "redacted_0"
       ],
       "objectClassName": "domain",
       "ldhName": "example.com",
       "secureDNS": {



Gould, et al.            Expires 13 January 2022               [Page 13]

Internet-Draft           Redacted Fields in RDAP               July 2021


         "delegationSigned": false
       },
       "notices": [
         {
           "title": "Terms of Use",
           "description": [
             "Service subject to Terms of Use."
           ],
           "links": [
             {
               "rel": "self",
               "href": "https://www.example.com/terms-of-use",
               "type": "text/html",
               "value": "https://www.example.com/terms-of-use"
             }
           ]
         }
       ],
       "nameservers": [
         {
           "objectClassName": "nameserver",
           "ldhName": "ns1.example.com"
         },
         {
           "objectClassName": "nameserver",
           "ldhName": "ns2.example.com"
         }
       ],
       "entities": [
         {
           "objectClassName": "entity",
           "handle": "123",
           "roles": [
             "registrar"
           ],
           "publicIds": [
             {
               "type": "IANA Registrar ID",
               "identifier": "1"
             }
           ],
           "vcardArray": [
             "vcard",
             [
               [
                 "version",
                 {},
                 "text",



Gould, et al.            Expires 13 January 2022               [Page 14]

Internet-Draft           Redacted Fields in RDAP               July 2021


                 "4.0"
               ],
               [
                 "fn",
                 {},
                 "text",
                 "Example Registrar Inc."
               ],
               [
                 "adr",
                 {},
                 "text",
                 [
                   "",
                   "Suite 100",
                   "123 Example Dr.",
                   "Dulles",
                   "VA",
                   "20166-6503",
                   "US"
                 ]
               ],
               [
                 "email",
                 {},
                 "text",
                 "contact@organization.example"
               ],
               [
                 "tel",
                 {
                   "type": "voice"
                 },
                 "uri",
                 "tel:+1.7035555555"
               ],
               [
                 "tel",
                 {
                   "type": "fax"
                 },
                 "uri",
                 "tel:+1.7035555556"
               ]
             ]
           ],
           "entities": [
             {



Gould, et al.            Expires 13 January 2022               [Page 15]

Internet-Draft           Redacted Fields in RDAP               July 2021


               "objectClassName": "entity",
               "roles": [
                 "abuse"
               ],
               "vcardArray": [
                 "vcard",
                 [
                   [
                     "version",
                     {},
                     "text",
                     "4.0"
                   ],
                   [
                     "fn",
                     {},
                     "text",
                     "Abuse Contact"
                   ],
                   [
                     "email",
                     {},
                     "text",
                     "abuse@organization.example"
                   ],
                   [
                     "tel",
                     {
                       "type": "voice"
                     },
                     "uri",
                     "tel:+1.7035555555"
                   ]
                 ]
               ]
             }
           ]
         },
         {
           "roles": [
             "registrant"
           ],
           "vcardArray": [
             "vcard",
             [
               [
                 "version",
                 {},



Gould, et al.            Expires 13 January 2022               [Page 16]

Internet-Draft           Redacted Fields in RDAP               July 2021


                 "text",
                 "4.0"
               ],
               [
                 "fn",
                 {},
                 "text",
                 ""
               ],
               [
                 "adr",
                 {},
                 "text",
                 [
                   "",
                   "",
                   "",
                   "",
                   "QC",
                   "",
                   "Canada"
                 ]
               ]
             ]
           ]
         },
         {
           "roles": [
             "technical"
           ],
           "vcardArray": [
             "vcard",
             [
               [
                 "version",
                 {},
                 "text",
                 "4.0"
               ],
               [
                 "fn",
                 {},
                 "text",
                 ""
               ],
               [
                 "org",
                 {},



Gould, et al.            Expires 13 January 2022               [Page 17]

Internet-Draft           Redacted Fields in RDAP               July 2021


                 "text",
                 "Example Inc."
               ],
               [
                 "adr",
                 {},
                 "text",
                 [
                   "",
                   "Suite 1234",
                   "4321 Rue Somewhere",
                   "Quebec",
                   "QC",
                   "G1V 2M2",
                   "Canada"
                 ]
               ]
             ]
           ]
         }
       ],
       "events": [
         {
           "eventAction": "registration",
           "eventDate": "1997-06-03T00:00:00Z"
         },
         {
           "eventAction": "last changed",
           "eventDate": "2020-05-28T01:35:00Z"
         },
         {
           "eventAction": "expiration",
           "eventDate": "2021-06-03T04:00:00Z"
         }
       ],
       "status": [
         "server delete prohibited",
         "server update prohibited",
         "server transfer prohibited",
         "client transfer prohibited"
       ],
       "redacted": [
         {
           "name": "Registry Domain ID",
           "path": "$.handle",
           "pathLang": "jsonpath",
           "method": "removal",
           "reason": "Server policy"



Gould, et al.            Expires 13 January 2022               [Page 18]

Internet-Draft           Redacted Fields in RDAP               July 2021


         },
         {
           "name": "Registrant Name",
           "path": "$.entities[?(@.roles[0]=='registrant')].
             vcardArray[1][?(@[0]=='fn')][3]",
           "pathLang": "jsonpath",
           "method": "emptyValue",
           "reason": "Server policy"
         },
         {
           "name": "Registrant Organization",
           "path": "$.entities[?(@.roles[0]=='registrant')].
             vcardArray[1][?(@[0]=='org')]",
           "pathLang": "jsonpath",
           "method": "removal",
           "reason": "Server policy"
         },
         {
           "name": "Registrant Street",
           "path": "$.entities[?(@.roles[0]=='registrant')].
             vcardArray[1][?(@[0]=='adr')][3][:3]",
           "pathLang": "jsonpath",
           "method": "emptyValue",
           "reason": "Server policy"
         },
         {
           "name": "Registrant City",
           "path": "$.entities[?(@.roles[0]=='registrant')].
             vcardArray[1][?(@[0]=='adr')][3][3]",
           "pathLang": "jsonpath",
           "method": "emptyValue",
           "reason": "Server policy"
         },
         {
           "name": "Registrant Postal Code",
           "path": "$.entities[?(@.roles[0]=='registrant')].
             vcardArray[1][?(@[0]=='adr')][3][5]",
           "pathLang": "jsonpath",
           "method": "emptyValue",
           "reason": "Server policy"
         },
         {
           "name": "Registrant Email",
           "path": "$.entities[?(@.roles[0]=='registrant')].
             vcardArray[1][?(@[0]=='email')]",
           "method": "removal",
           "reason": "Server policy"
         },



Gould, et al.            Expires 13 January 2022               [Page 19]

Internet-Draft           Redacted Fields in RDAP               July 2021


         {
           "name": "Registrant Phone",
           "path": "$.entities[?(@.roles[0]=='registrant')].
             vcardArray[1][?(@[1].type=='voice')]",
           "method": "removal",
           "reason": "Server policy"
         },
         {
           "name": "Technical Name",
           "path": "$.entities[?(@.roles[0]=='technical')].
             vcardArray[1][?(@[0]=='fn')][3]",
           "method": "emptyValue",
           "reason": "Server policy"
         },
         {
           "name": "Technical Email",
           "path": "$.entities[?(@.roles[0]=='technical')].
             vcardArray[1][?(@[0]=='email')]",
           "method": "removal",
           "reason": "Server policy"
         },
         {
           "name": "Technical Phone",
           "path": "$.entities[?(@.roles[0]=='technical')].
             vcardArray[1][?(@[1].type=='voice')]",
           "method": "removal",
           "reason": "Server policy"
         },
         {
           "name": "Technical Fax",
           "path": "$.entities[?(@.roles[0]=='technical')].
             vcardArray[1][?(@[1].type=='fax')]",
           "reason": "Client request"
         },
         {
           "name": "Administrative Contact",
           "path": "$.entities[?(@.roles[0]=='administrative')]",
           "method": "removal",
           "reason": "Client request"
         }
       ]
     }









Gould, et al.            Expires 13 January 2022               [Page 20]

Internet-Draft           Redacted Fields in RDAP               July 2021


5.  JSONPath Considerations

   JSONPath [I-D.ietf-jsonpath-base] is the default JSON path expression
   language.  This section covers considerations for servers using
   [I-D.ietf-jsonpath-base] to identify redacted RDAP fields with the
   "path" member of redacted objects in the "redacted" member.  The list
   of JSONPath considerations include:

   1.  Use absolute paths with the '$' JSONPath element.  An example is
       "$.handle" for the "Registry Domain ID".
   2.  Validate a JSONPath expression using a non-redacted RDAP
       response, where evaluating the expression results in returning
       the redacted field.
   3.  Reference the removed object field when redacting an entire
       object by the Redaction by Removal Method (Section 3.1), where
       all of the object's child fields are explicitly removed.  An
       example is "$.entities[?(@.roles[0]=='administrative')]" for the
       entire "Administrative Contact".
   4.  Reference the removed field when using the Redaction by Removal
       Method (Section 3.1).  An example is "$.handle" for the "Registry
       Domain ID".
   5.  Reference index 0 of the jCard [RFC7095] property array, which is
       the jCard [RFC7095] "name" property, with a filter expression
       containing the name of the field, when redacting a jCard
       [RFC7095] field using the Redaction by Removal Method
       (Section 3.1).  An example is "$.entities[?(@.roles[0]=='registra
       nt')].vcardArray[1][?(@[0]=='email')]" for the "Registrant
       Email".
   6.  Reference jCard [RFC7095] field value or values redacted by array
       index 3 and greater, when redacting a jCard [RFC7095] field using
       the Redaction by Empty Value Method (Section 3.2).  The jCard
       [RFC7095] property array index 3 and greater contain the property
       values, where the property values set with an empty value are
       referenced directly in place of the jCard [RFC7095] property
       name.  Servers can then systematically redact jCard [RFC7095]
       field value or values based on the JSONPath expressions and
       clients will directly know which jCard [RFC7095] property values
       have been redacted.  An example is "$.entities[?(@.roles[0]=='reg
       istrant')].vcardArray[1][?(@[0]=='fn')][3]" for the "Registrant
       Name" or "$.entities[?(@.roles[0]=='registrant')].vcardArray[1][?
       (@[0]=='adr')][3][5]" for the "Registrant Postal Code".

6.  IANA Considerations

6.1.  RDAP Extensions Registry

   IANA is requested to register the following value in the RDAP
   Extensions Registry:



Gould, et al.            Expires 13 January 2022               [Page 21]

Internet-Draft           Redacted Fields in RDAP               July 2021


   Extension identifier:  redacted_0
   Registry operator:  Any
   Published specification:  This document.
   Contact:  IESG <iesg@ietf.org>
   Intended usage:  This extension identifies the redacted fields in an
      RDAP response.

7.  Security Considerations

   The server including a redacted signal provides an unauthorized
   client additional information related to the existence of data.
   Servers MAY exclude the redacted members for RDAP fields that are
   considered a privacy issue in providing a data existence signal.

8.  Acknowledgements

   The authors wish to thank the following persons for their feedback
   and suggestions: Scott Hollenbeck, and Rick Wilhelm.

9.  References

9.1.  Normative References

   [I-D.ietf-jsonpath-base]
              Normington, G., Surov, E., Mikulicic, M., and F. Dortmund,
              "JavaScript Object Notation (JSON) Path", Work in
              Progress, Internet-Draft, draft-ietf-jsonpath-base-00, 7
              March 2021,
              <https://tools.ietf.org/html/draft-ietf-jsonpath-base-00>.

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <https://www.rfc-editor.org/info/rfc2119>.

   [RFC6350]  Perreault, S., "vCard Format Specification", RFC 6350,
              DOI 10.17487/RFC6350, August 2011,
              <https://www.rfc-editor.org/info/rfc6350>.

   [RFC7095]  Kewisch, P., "jCard: The JSON Format for vCard", RFC 7095,
              DOI 10.17487/RFC7095, January 2014,
              <https://www.rfc-editor.org/info/rfc7095>.

   [RFC7483]  Newton, A. and S. Hollenbeck, "JSON Responses for the
              Registration Data Access Protocol (RDAP)", RFC 7483,
              DOI 10.17487/RFC7483, March 2015,
              <https://www.rfc-editor.org/info/rfc7483>.




Gould, et al.            Expires 13 January 2022               [Page 22]

Internet-Draft           Redacted Fields in RDAP               July 2021


   [RFC8174]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in RFC
              2119 Key Words", BCP 14, RFC 8174, DOI 10.17487/RFC8174,
              May 2017, <https://www.rfc-editor.org/info/rfc8174>.

   [RFC8259]  Bray, T., Ed., "The JavaScript Object Notation (JSON) Data
              Interchange Format", STD 90, RFC 8259,
              DOI 10.17487/RFC8259, December 2017,
              <https://www.rfc-editor.org/info/rfc8259>.

Authors' Addresses

   James Gould
   VeriSign, Inc.
   12061 Bluemont Way
   Reston, VA 20190
   United States of America

   Email: jgould@verisign.com
   URI:   http://www.verisigninc.com


   David Smith
   VeriSign, Inc.
   12061 Bluemont Way
   Reston, VA 20190
   United States of America

   Email: dsmith@verisign.com
   URI:   http://www.verisigninc.com


   Jody Kolker
   GoDaddy Inc.
   14455 N. Hayden Rd. #219
   Scottsdale, AZ 85260
   United States of America

   Email: jkolker@godaddy.com
   URI:   http://www.godaddy.com


   Roger Carney
   GoDaddy Inc.
   14455 N. Hayden Rd. #219
   Scottsdale, AZ 85260
   United States of America

   Email: rcarney@godaddy.com



Gould, et al.            Expires 13 January 2022               [Page 23]

Internet-Draft           Redacted Fields in RDAP               July 2021


   URI:   http://www.godaddy.com


















































Gould, et al.            Expires 13 January 2022               [Page 24]
