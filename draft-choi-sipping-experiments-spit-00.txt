SIPPING                                                   Jaeduck Choi 
Internet Draft                                            Souhwan Jung 
Intended status: Informational                             Yujung Jang 
Expires: January 17, 2008                          Soongsil University
                                                            Yoojae Won
                                                          Youngduk Cho 
                                     Korea Information Security Agency 
 
                                                         July 18, 2007 
                                      
            Experiments on SPIT in the Commercial VoIP Services 
                draft-choi-sipping-experiments-spit-00.txt 


Status of this Memo 

   By submitting this Internet-Draft, each author represents that       
   any applicable patent or other IPR claims of which he or she is       
   aware have been or will be disclosed, and any of which he or she       
   becomes aware will be disclosed, in accordance with Section 6 of       
   BCP 79. 

   Internet-Drafts are working documents of the Internet Engineering 
   Task Force (IETF), its areas, and its working groups.  Note that 
   other groups may also distribute working documents as Internet-
   Drafts. 

   Internet-Drafts are draft documents valid for a maximum of six months 
   and may be updated, replaced, or obsoleted by other documents at any 
   time.  It is inappropriate to use Internet-Drafts as reference 
   material or to cite them other than as "work in progress." 

   The list of current Internet-Drafts can be accessed at 
        http://www.ietf.org/ietf/1id-abstracts.txt 

   The list of Internet-Draft Shadow Directories can be accessed at 
        http://www.ietf.org/shadow.html 

   This Internet-Draft will expire on January 17, 2008. 

Copyright Notice  

   Copyright (C) The IETF Trust (2007). 

 
Abstract 

   This document shows some experimental results on SPIT on commercial 
   VoIP services, in which a SIP UA has not been secured by SIP security 
   protocol such as TLS. Although many service providers have been 
 
 
 
Choi, et al.          Expires January 17, 2008                [Page 1] 

Internet-Draft           Experiments on SPIT                 July 2007 
    

   applying the HTTP digest scheme to authenticate a SIP UA, they often 
   do not apply SIP signaling protection against potential threats 
   between the SIP UA and the SIP proxy. This cause vulnerabilities to 
   the VoIP services like SPIT. The aim of this memo is to inform the 
   service providers of SPIT threats by showing some experimental 
   results of SPIT on current VoIP networks. 

    

Table of Contents 

   1. Introduction....................................................2 
   2. Terminology.....................................................3 
   3. Experiments on SPIT.............................................4 
      3.1. The SPIT between the UAC and the Proxy.....................4 
      3.2. The SPIT between the Proxy and the UAS.....................5 
      3.3. The SPIT using Dictionary Attack...........................6 
   4. Security Considerations.........................................7 
   5. IANA Considerations.............................................7 
   6. References......................................................7 
      6.1. Normative References.......................................7 
      6.2. Informative References.....................................7 
   Author's Addresses.................................................8 
   Intellectual Property Statement....................................9 
   Disclaimer of Validity............................................10 
   Copyright Statement...............................................10 
   Acknowledgment....................................................10 
    
 

1. Introduction 

   The SPIT [2] can be classified into two categories based on delivery 
   routes: the SPIT sent on path associated with SIP signaling and off 
   path. 

   It is not easy for spammers to send a SPIT if the security 
   mechanisms specified in the SIP protocol [3] are applied to all the 
   signaling routes in SIP: among the UA, proxy, registrar, and so on. 
   For sending SPIT, spammers SHOULD register a VoIP service, and then 
   could send a SPIT only through normal signaling routes. The studies 
   on protecting SPIT that are sent through normal routes have been 
   discussed in several drafts [4][5][6][7][8] at the SIPPING WG. SPIT 
   on normal route is out of the scope of this draft. 

   In case of abnormal routes, the SPIT might be occurred between the 
   UA and the SIP proxy when the TLS mechanism is not applied between 
 
 
Choi, et al.          Expires January 17, 2008                [Page 2] 

Internet-Draft           Experiments on SPIT                 July 2007 
    

   the UA and the SIP proxy. The spammer can send SIP messages like 
   INVITE or 200 OK directly to the UA, and then communicate with the 
   user by establishing a media channel. 

   Currently, VoIP providers have been applying only the HTTP digest 
   scheme to authenticate a UA. They do not consider protecting SIP 
   signaling between the UA and the SIP proxy. On the commercial 
   networks where the TLS mechanism is not applied, some SPIT scenarios 
   were tested as follows.  

   - The SPIT between the UAC and proxy 
   - The SPIT between the proxy and UAS 
   - The SPIT using dictionary attack 

   Although both the UA and the spammer belong to the same local area 
   network during experiments, it is possible for the spammer with 
   sophisticated spywares or monitoring tools to send SPIT to the remote 
   users. 

   The goal of this document is to inform service providers of potential 
   SPIT threats by showing some experimental results on SPIT on current 
   VoIP networks so that they SHOULD carefully consider applying the TLS 
   mechanism to the SIP UA. 

    

2. Terminology 

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", 
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this 
   document are to be interpreted as described in RFC-2119 [1]. 

    

   Two terminologies are defined in this document. 

   A normal route in SIP: The signaling route where SIP messages are 
   sent through proxy server of the VoIP provider 

   An abnormal route in SIP: The signaling route where SIP messages are 
   sent without proxy server of the VoIP provider   

    




 
 
Choi, et al.          Expires January 17, 2008                [Page 3] 

Internet-Draft           Experiments on SPIT                 July 2007 
    

3. Experiments on SPIT 

   The experiments are performed on the following networks. 

   - Three commercial VoIP providers 
   - Three UA operated by each service provider 
   - Two open UA using a commercial SIP proxy. 

   There is no TLS mechanism applied between the UA and the proxy
   server. Also, the UA and the spammer belong to the same LAN so that
   the spammer can sniff SIP messages and send them directly to the UA. 

     +-----------------+  +-------------------+  +-------------------+ 
     |   LAN A         |  |     Internet      |  |    LAN B          | 
     |                 |  |                   |  |                   | 
     |  +---+          |  |   +-----------+   |  |            +---+  | 
     |  |UAC|---+------|------|   Proxy   |------|------+-----|UAS|  | 
     |  +---+   |      |  |   +-----------+   |  |      |     +---+  | 
     |          |      |  |                   |  |      |            | 
     |      +---+---+  |  |                   |  |  +---+---+        | 
     |      |Spammer|  |  |                   |  |  |Spammer|        | 
     |      +-------+  |  |                   |  |  +-------+        | 
     +-----------------+  +-------------------+  +-------------------+ 
                 Figure 1 : Configuration of SPIT Testbed 



3.1. The SPIT between the UAC and the Proxy 

   This experiment shows that the spammer sends a 200 OK response to the 
   UAC in complying with an INVITE message initiated by an UA as a call 
   request to the UAS. Figure 2 shows the message flow of our
   experiment. When the spammer senses the INVITE message, he generates
   a 200 OK message, spoofs IP address of the proxy server, and then
   replies with the 200 OK message. Upon receiving the 200 OK message,
   the media channel might be established between the UAC and the
   spammer. As a result, the spammer could play out a recorded
   announcement or communicate with the UAS. In the experiment, this
   SPIT succeeded at all the tested UA's. 







 
 
Choi, et al.          Expires January 17, 2008                [Page 4] 

Internet-Draft           Experiments on SPIT                 July 2007 
    

     UAC                          Proxy                          UAS 
      |                             |                             | 
      |                             |                             | 
      |        INVITE               |                             | 
      |---------------------------->|                             | 
      |          407                |                             | 
      |<----------------------------|                             | 
      |          ACK                |                             | 
      |---------------------------->|                             | 
      |        INVITE (credential)  |                             | 
      |---------------------------->|           INVITE            | 
      |                             |---------------------------->| 
      |      Spammer                |                             | 
      |  200 OK                     |                             | 
      |<--------|                   |                             | 
      |   ACK   |                   |                             | 
      |-------->|                   |                             | 
      |   RTP   |                   |                             | 
      |<=======>|                   |          180 Ring           | 
      |         180 Ring            |<----------------------------| 
    Ingnore<------------------------|           200 OK            | 
      |         200 OK              |<----------------------------| 
    Ingnore<------------------------|                             | 
      |                             |                             | 
  Figure 2 : The Message Flow of the SPIT between the UAC and the Proxy 


   This SPIT was possible because the spammer could easily sniff the 
   INVITE message. If the TLS mechanism is used between the UA and proxy
   server, this SPIT can be protected. 

    

3.2. The SPIT between the Proxy and the UAS 

   This scenario that spammers can directly send SIP calls to the UAS 
   using P2P call signaling has been discussed on the draft [9]. This 
   document shows an experimental result using this scenario on 
   commercial VoIP networks. Figure 2 shows the SPIT flow. To make a 
   direct call, the spammer generates an INVITE message and sends it to
   the UAS. The spammer needs to sniff the 200 OK message from the UAS.
   The 200 OK message includes the IP address and port number for media
   session. Upon sniffing the 200 OK, the spammer could play out a 
   recorded announcement or communicate with the UAS. In our test, this
   SPIT worked at all the UA's. 


 
 
Choi, et al.          Expires January 17, 2008                [Page 5] 

Internet-Draft           Experiments on SPIT                 July 2007 
    

   Also, the one-ring SPIT is tested. In this case, the spammer sends 
   only the INVITE message without sniffing the corresponding 200 OK 
   message. When the UAS receives the INVITE message, the phone is 
   ringing and the SIP URI is displayed at the user. The user who feels 
   curious about the name ID might make a return call to the caller. 
   Consequently, the spammer can make a successful talk with the callee. 
   This SPIT also worked at all the UA's during our experiments. 

     UAC                          Proxy                          UAS 
      |                             |                             | 
      |                             |            Spammer          | 
      |                             |               |   INVITE    | 
      |                             |               |------------>| 
      |                             |               |  180 Ring   | 
      |                           Ignore<-------------------------| 
      |                             |               |   200 OK    | 
      |                           Ignore<-------------------------| 
      |                             |               |    ACK      | 
      |                             |               |------------>| 
      |                             |               |    RTP      | 
      |                             |               |<===========>| 
      |                             |                             | 
      |                             |                             | 
   Figure 3 : The Message Flow of the SPIT between the Proxy and the UA 


   This SPIT was also possible because the TLS was not established 
   between the proxy server and the UAS. If the TLS was applied to the 
   UAS, the INVITE message sent by the spammer could be blocked during 
   the TLS process. Hence, the INVITE message could be dropped. 

    

3.3. The SPIT using Dictionary Attack 

   The spammer can send SPIT to the UA through normal routes without 
   revealing his position and privacy information. When the TLS is not 
   used at the UA, the spammer can apply the dictionary attack with 
   credential value obtained by sniffing to guess the legitimate 
   password. If the attack is successful, the spammer can make a call 
   spam via normal routes in SIP network without disclosing any of his 
   information. 





 
 
Choi, et al.          Expires January 17, 2008                [Page 6] 

Internet-Draft           Experiments on SPIT                 July 2007 
    

   Anybody could easily sniff the REGISTER or INVITE messages on the 
   deployed VoIP networks. They could also guess the legitimate password 
   of a UA using dictionary attack tools. For the reason, VoIP service 
   providers SHOULD apply the TLS mechanism between the UA and the SIP 
   server such as registrar and proxy server. 

    

4. Security Considerations 

   This document showed some experimental results on feasible SPIT 
   scenarios on commercial VoIP networks. Spammers might try to directly 
   send SPIT to the UA without its proxy server, on abnormal routes in 
   SIP-based networks. If the TLS mechanism is used among the UAC,
   proxy, registrar, and UAS, these SPIT can be protected. The VoIP
   providers, however, have not been applying the TLS mechanism at the
   UA. Hence, the SPIT worked at all the commercial UA's during our
   experiments. Although our experiments were performed at the situation
   that both commercial UA and spammer belong to the same local area
   network, it is possible for the spammer to send a SPIT to a remote UA
   using spyware or hacking tools. 

   Therefore, it is necessary for service providers to apply strictly 
   the TLS mechanism to the UA. If the TLS is used, it is difficult for 
   spammers who want to know information for establishing media session 
   to sniff the SIP messages. The authentication value can be protected 
   by the same reason. 

    

5. IANA Considerations 

   This document does not require actions by IANA. 

    

6. References 

6.1. Normative References 

   [1]  Bradner, S., "Key words for use in RFCs to Indicate Requirement 
        Levels", BCP 14, RFC 2119, March 1997. 

6.2. Informative References 

   [2]  Rosenberg, J., and Jennings, C., "The Session Initiation 
        Protocol (SIP) and Spam", draft-ietf-sipping-spam-05, July 2007.
 
 
Choi, et al.          Expires January 17, 2008                [Page 7] 

Internet-Draft           Experiments on SPIT                 July 2007 
    

   [3]  Rosenberg, J., Schulzrinne, H., Camarillo, G., Jonston, A., 
        Peterson, J., Sparks, R., Handley, M., and E. Schooler, "SIP: 
        Session Initiation Protocol", RFC 3261, June 2002. 

   [4]  Hannes, T., Geoffrey, D., Thomas, F., Dan, W., and Henning, 
        S., "Requirements for Authorization Policies to tackle Spam for 
        Internet Telephony and Unwanted Trafic", draft-froment-sipping-
        spit-requirements-00, June 2007. 

   [5]  Saverio, N. and Juergen, Q., "signaling To Prevent SPIT 
        (SPITSTOP) Reference Scenario", draft-niccolini-sipping-
        spitstop, January 2007. 

   [6]  Geoffrey, D., Thomas, F., and Hannes, T., "Authorization 
        Policies for Preventing SPIT", draft-froment-sipping-spit-
        authz-policies-02, February 2007. 

   [7]  Saverio, N., Sandra, T., Martin, S., and Samir, S. "SIP 
        Extensiions for SPIT Identification", draft-niccolini-sipping-
        feedback-spit-03, February 2007. 

   [8]  Hannes, T., Henning, S., Dan, W., Jonathan, R., and David, S. 
        "A Framewor for Reducing Spam for Internet Telephony", draft-
        tschofenig-sipping-framework-spit-reduction-00, June 2007. 

   [9]  Jung, S., Choi, J., Won, Y., and Cho, Y., "Authentication 
        between the Inbound Proxy and the UAS for Protecting SPIT in 
        the Session Initiation Protocol (SIP)", draft-jung-sipping-
        authentication-spit-00, October 2006. 

    

Author's Addresses 

   Jaeduck Choi 
   Soongsil University 
   511, Sangdo-dong, Dongjak-ku 
   Seoul 156-743 
   KOREA 
      
   Phone: +82-2-824-1807 
   Email: cjduck@cns.ssu.ac.kr 
    




 
 
Choi, et al.          Expires January 17, 2008                [Page 8] 

Internet-Draft           Experiments on SPIT                 July 2007 
    

   Souhwan Jung 
   Soongsil University 
   511, Sangdo-dong, Dongjak-ku 
   Seoul 156-743 
   KOREA 
      
   Phone: +82-2-820-0714 
   Email: souhwanj@ssu.ac.kr 
    

   Yujung Jang 
   Soongsil University 
   511, Sangdo-dong, Dongjak-ku 
   Seoul 156-743 
   KOREA 
      
   Phone: +82-2-824-1807 
   Email: lilyuwjd@cns.ssu.ac.kr 
    

   Yoojae Won 
   Korea Information Security Agency 
   78, Karak-dong, Songpa-Gu 
   Seoul 138-160 
   KOREA 
      
   Phone: +82-2-405-5548 
   Email: yjwon@kisa.or.kr 
    

   Youngduk Cho 
   Korea Information Security Agency 
   78, Karak-dong, Songpa-Gu 
   Seoul 138-160 
   KOREA 
      
   Phone: +82-2-405-5548 
   Email: ydcho@kisa.or.kr 
    
    

Intellectual Property Statement 

   The IETF takes no position regarding the validity or scope of any 
   Intellectual Property Rights or other rights that might be claimed to 
   pertain to the implementation or use of the technology described in 
   this document or the extent to which any license under such rights 
 
 
Choi, et al.          Expires January 17, 2008                [Page 9] 

Internet-Draft           Experiments on SPIT                 July 2007 
    

   might or might not be available; nor does it represent that it has 
   made any independent effort to identify any such rights.  Information 
   on the procedures with respect to rights in RFC documents can be 
   found in BCP 78 and BCP 79. 

   Copies of IPR disclosures made to the IETF Secretariat and any 
   assurances of licenses to be made available, or the result of an 
   attempt made to obtain a general license or permission for the use of 
   such proprietary rights by implementers or users of this 
   specification can be obtained from the IETF on-line IPR repository at 
   http://www.ietf.org/ipr. 

   The IETF invites any interested party to bring to its attention any 
   copyrights, patents or patent applications, or other proprietary 
   rights that may cover technology that may be required to implement 
   this standard.  Please address the information to the IETF at 
   ietf-ipr@ietf.org. 

Disclaimer of Validity 

   This document and the information contained herein are provided on an 
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS 
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST AND 
   THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS 
   OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF 
   THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED 
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. 

Copyright Statement 

   Copyright (C) The Internet Trust (2007). 

   This document is subject to the rights, licenses and restrictions 
   contained in BCP 78, and except as set forth therein, the authors 
   retain all their rights. 

Acknowledgment 

   Funding for the RFC Editor function is currently provided by the 
   Internet Society. 






 
 
Choi, et al.          Expires January 17, 2008               [Page 10] 

