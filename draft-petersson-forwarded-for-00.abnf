Forwarded-For = "Forwarded-For" ":" 1#node

nodename = IPv4address | IPv6address |
                   "unknown" | "hidden" | obfnode

node            = nodename [ ":" node-port ]

node-port       = port | obfport
port            = 1*5DIGIT
obfport         = 1*(ALPHA | DIGIT)

IPv6address = addr6 | "[" addr6 "]"
addr6 = hexpart [ ":" IPv4address ]
IPv4address = 1*3DIGIT "." 1*3DIGIT "." 1*3DIGIT "." 1*3DIGIT

hexpart = hexseq | hexseq "::" [ hexseq ] | "::" [ hexseq ]
hexseq  = hex4 *( ":" hex4)
hex4    = 1*4HEXDIG

obfnode         = "_" 1*( ALPHA | DIGIT )


Forwarded-For = "Forwarded-For" ":" LWS Forwarded-For-v
Forwarded-For-v = 1#node
node = nodename [":" node-port]
nodename = IPv4address | IPv6address |
                   "unknown" | "hidden" | obfnode
obfnode = "_" 1*( ALPHA | DIGIT )
node-port = port | obfport
port = 1*5DIGIT
obfport = 1*( ALPHA | DIGIT )

IPv6address = addr6 | "[" addr6 "]"
addr6 = hexpart [ ":" IPv4address ]
IPv4address = 1*3DIGIT "." 1*3DIGIT "." 1*3DIGIT "." 1*3DIGIT

hexpart = hexseq | hexseq "::" [ hexseq ] | "::" [ hexseq ]
hexseq  = hex4 *( ":" hex4)
hex4    = 1*4HEXDIG


