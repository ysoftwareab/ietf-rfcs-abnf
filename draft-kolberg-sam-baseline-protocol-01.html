<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Application Layer Multicast
    Extensions to RELOAD</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Application Layer Multicast
    Extensions to RELOAD">
<meta name="keywords" content="scalable adaptive multicast">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 60em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 60em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">SAM Research Group</td><td class="header">J. Buford</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Avaya Labs Research</td></tr>
<tr><td class="header">Intended status: Informational</td><td class="header">M. Kolberg, Ed.</td></tr>
<tr><td class="header">Expires: January 13, 2011</td><td class="header">University of Stirling</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">T C. Schmidt</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">HAW Hamburg</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">M. Waehlisch</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">link-lab &amp; FU Berlin</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">July 12, 2010</td></tr>
</table></td></tr></table>
<h1><br />Application Layer Multicast
    Extensions to RELOAD<br />draft-kolberg-sam-baseline-protocol-01</h1>

<h3>Abstract</h3>

<p>We describe protocol and API extensions to P2P-SIP for constructing
      Scalable Adaptive Multicast (SAM) sessions using hybrid combinations 
      of Application Layer Multicast (ALM),
      native multicast, and multicast tunnels. We use the AMT relay and
      gateway elements for interoperation between native regions and ALM
      regions. The baseline architecture allows different overlay algorithms
      and different ALM control algorithms to be used.
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted  in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF).  Note that other groups may also distribute
working documents as Internet-Drafts.  The list of current
Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
This Internet-Draft will expire on January 13, 2011.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the Simplified BSD License.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">1.1.</a>&nbsp;
Requirements Language<br />
<a href="#definitions">2.</a>&nbsp;
Definitions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">2.1.</a>&nbsp;
Overlay Network<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">2.2.</a>&nbsp;
Overlay Multicast<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">2.3.</a>&nbsp;
Peer<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">2.4.</a>&nbsp;
Multi-Destination Routing<br />
<a href="#Assumptions">3.</a>&nbsp;
Assumptions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">3.1.</a>&nbsp;
Overlay<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">3.2.</a>&nbsp;
Overlay Multicast<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">3.3.</a>&nbsp;
RELOAD<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">3.4.</a>&nbsp;
NAT<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">3.5.</a>&nbsp;
Regions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">3.6.</a>&nbsp;
AMT<br />
<a href="#anchor13">4.</a>&nbsp;
Hybrid ALM Tree Operations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">4.1.</a>&nbsp;
ALM-Only Tree - Algorithm 1<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">4.2.</a>&nbsp;
ALM tree with peer at AMT site (AMT-GW)<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor16">4.3.</a>&nbsp;
ALM tree with NM peer using AMT-R<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor17">4.4.</a>&nbsp;
ALM tree with NM peer with P-AMT-R<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">4.5.</a>&nbsp;
ALM tree with peer P-AMT-GW<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor19">4.6.</a>&nbsp;
Mixed Region Scenarios<br />
<a href="#sec-group-api">5.</a>&nbsp;
Group Management API<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor20">5.1.</a>&nbsp;
Data Types<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor21">5.2.</a>&nbsp;
Send and Receive Calls<br />
<a href="#sec-protocol">6.</a>&nbsp;
Protocol<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor22">6.1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor23">6.2.</a>&nbsp;
Tree Lifecylce Messages<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor24">6.2.1.</a>&nbsp;
Create Tree<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor25">6.2.2.</a>&nbsp;
Join<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor26">6.2.3.</a>&nbsp;
Join Accept<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor27">6.2.4.</a>&nbsp;
Join Confirm<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor28">6.2.5.</a>&nbsp;
Join Decline<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor29">6.2.6.</a>&nbsp;
Join Via AMT Gateway<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor30">6.2.7.</a>&nbsp;
Join Via Native Link<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor31">6.2.8.</a>&nbsp;
Leave<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor32">6.2.9.</a>&nbsp;
Leave via AMT Gateway<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor33">6.2.10.</a>&nbsp;
Re-Form or Optimize Tree<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor34">6.2.11.</a>&nbsp;
Heartbeat<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor35">6.3.</a>&nbsp;
AMT Gateway Advertisement and Discovery<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor36">6.4.</a>&nbsp;
Peer Region and Multicast Properties Messages<br />
<a href="#anchor37">7.</a>&nbsp;
RELOAD Usages<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor38">7.1.</a>&nbsp;
ALM Usage for RELOAD<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor39">7.2.</a>&nbsp;
Hybrid ALM Usage for RELOAD<br />
<a href="#anchor40">8.</a>&nbsp;
Examples<br />
<a href="#IANA">9.</a>&nbsp;
IANA Considerations<br />
<a href="#Security">10.</a>&nbsp;
Security Considerations<br />
<a href="#rfc.references1">11.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">11.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">11.2.</a>&nbsp;
Informative References<br />
<a href="#app-additional">Appendix&nbsp;A.</a>&nbsp;
Additional Stuff<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>The concept of scalable adaptive multicast includes both scaling
      properties and adaptability properties. Scalability is intended to
      cover: </p>
<ul class="text">
<li>large group size
</li>
<li>large numbers of small groups
</li>
<li>rate of group membership change
</li>
<li>admission control for QoS
</li>
<li>use with network layer QoS mechanisms
</li>
<li>varying degrees of reliability
</li>
<li>trees connect nodes over global internet
</li>
</ul><p> Adaptability includes </p>
<ul class="text">
<li>use of different control mechanisms for different multicast trees
          depending on initial application parameters or application class
</li>
<li>changing multicast tree structure depending on changes in
          application requirements, network conditions, and membership
</li>
<li>use of different control mechanisms and tree structure in
          different regions of network depending on native multicast support,
          network characteristics, and node behavior
</li>
</ul><p> In this document we describe a protocol and API extension to RELOAD
        <a class='info' href='#I-D.ietf-p2psip-base'>[I&#8209;D.ietf&#8209;p2psip&#8209;base]<span> (</span><span class='info'>Jennings, C., Lowekamp, B., Rescorla, E., Baset, S., and H. Schulzrinne, &ldquo;REsource LOcation And Discovery (RELOAD) Base Protocol,&rdquo; March&nbsp;2010.</span><span>)</span></a> for constructing SAM sessions using hybrid
      combinations of Application Layer Multicast, native multicast, and
      multicast tunnels.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Requirements Language</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
        "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
        document are to be interpreted as described in <a class='info' href='#RFC2119'>RFC 2119<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a> [RFC2119].
</p>
<a name="definitions"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Definitions</h3>

<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
Overlay Network</h3>
<br /><hr class="insert" />
<a name="overlay"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
                    P    P    P   P     P
                  ..+....+....+...+.....+...
                 .                          +P
               P+                            .
                 .                          +P
                  ..+....+....+...+.....+...
                    P    P    P   P     P
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>Overlay network - An application layer virtual or logical network
        in which end points are addressable and that provides connectivity,
        routing, and messaging between end points. Overlay networks are
        frequently used as a substrate for deploying new network services, or
        for providing a routing topology not available from the underlying
        physical network. Many peer-to-peer systems are overlay networks that
        run on top of the Internet. In the above figure, "P" indicates overlay
        peers, and peers are connected in a logical address space. The links
        shown in the figure represent predecessor/successor links. Depending
        on the overlay routing model, additional or different links may be
        present.
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
Overlay Multicast</h3>

<p>Overlay Multicast (OM): Hosts participating in a multicast session
        form an overlay network and utilize unicast connections among pairs of
        hosts for data dissemination. The hosts in overlay multicast
        exclusively handle group management, routing, and tree construction,
        without any support from Internet routers. This is also commonly known
        as Application Layer Multicast (ALM) or End System Multicast (ESM). We
        call systems which use proxies connected in an overlay multicast
        backbone "proxied overlay multicast" or POM.
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3"></a><h3>2.3.&nbsp;
Peer</h3>

<p>Peer: an autonomous end system that is connected to the physical
        network and participates in and contributes resources to overlay
        construction, routing and maintenance. Some peers may also perform
        additional roles such as connection relays, super nodes, NAT
        traversal, and data storage.
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.4"></a><h3>2.4.&nbsp;
Multi-Destination Routing</h3>

<p>Multi-Destination Routing (MDR): A type of multicast routing in
        which group member's addresses are explicitly listed in each packet
        transmitted from the sender <a class='info' href='#AGU1984'>[AGU1984]<span> (</span><span class='info'>Aguilar, L., &ldquo;Datagram Routing for Internet Multicasting,&rdquo; March&nbsp;1984.</span><span>)</span></a>. XCAST
        <a class='info' href='#RFC5058'>[RFC5058]<span> (</span><span class='info'>Boivie, R., Feldman, N., Imai, Y., Livens, W., and D. Ooms, &ldquo;Explicit Multicast (Xcast) Concepts and Options,&rdquo; November&nbsp;2007.</span><span>)</span></a> is an experimental MDR protocol. A
        hybrid host group and MDR design is described in <a class='info' href='#HE2005'>[HE2005]<span> (</span><span class='info'>He, Q. and M. Ammar, &ldquo;Dynamic Host-Group/Multi-Destination Routing for Multicast           Sessions,&rdquo; .</span><span>)</span></a>.
</p>
<a name="Assumptions"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Assumptions</h3>

<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Overlay</h3>

<p>Peers connect in a large-scale overlay, which may be used for a
        variety of peer-to-peer applications in addition to multicast
        sessions. Peers may assume additional roles in the overlay beyond
        participation in the overlay and in multicast trees. We assume a
        single structured overlay routing algorithm is used. Any of a variety
        of multi-hop, one-hop, or variable-hop overlay algorithms could be
        used.
</p>
<p>Castro et al. <a class='info' href='#CASTRO2003'>[CASTRO2003]<span> (</span><span class='info'>Castro, M., Jones, M., Kermarrec, A., Rowstron, A., Theimer, M., Wang, H., and A. Wolman, &ldquo;An Evaluation of Scalable Application-level Multicast Built           Using Peer-to-peer overlays,&rdquo; April&nbsp;2003.</span><span>)</span></a>compared multi-hop
        overlays and found that tree-based construction in a single overlay
        out-performed using separate overlays for each multicast session. We
        use a single overlay rather than separate overlays per multicast
        sessions. We defer federated and hierarchical multi-overlay designs to
        later versions of this document.
</p>
<p>Peers may be distributed throughout the network, in regions where
        native multicast (NM) is available as well as regions where it is not
        available.
</p>
<p>An overlay multicast algorithm may leverage the overlay's mechanism
        for maintaining overlay state in the face of churn. For example, a
        peer may hold a number of DHT (Distributed Hash Table) entries. When
        the peer gracefully leaves the overlay, it transfers those entries to
        the nearest peer. When another peers joins which is closer to some of
        the entries than the current peer which holds those entries, than
        those entries are migrated. Overlay churn affects multicast trees as
        well; remedies include automatic migration of the tree state and
        automatic re-join operations for dislocated children nodes.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Overlay Multicast</h3>

<p>The overlay supports concurrent multiple multicast trees. The limit
        on number of concurrent trees depends on peer and network resources
        and is not an intrinsic property of the overlay. Some multicast trees
        will contain peers use ALM only, i.e., the peers do not have NM
        connectivity. Some multicast trees will contain peers with a
        combination of ALM and NM. Although the overlay could be used to form
        trees of NM-only peers, if such peers are all in the same region we
        expect native mechanisms to be used for such tree construction, and if
        such peers are in different regions we expect AMT to handle most cases
        of interest.
</p>
<p>Peers are able to determine, through configuration or
        discovery:
</p>
<p></p>
<ul class="text">
<li>Can they connect to a NM router
</li>
<li>Is an AMT gateway accessible
</li>
<li>Can the peer support the AMT-GW functionality locally
</li>
<li>Is MDR supported in the region
</li>
</ul>

<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
RELOAD</h3>

<p>We use RELOAD <a class='info' href='#I-D.ietf-p2psip-base'>[I&#8209;D.ietf&#8209;p2psip&#8209;base]<span> (</span><span class='info'>Jennings, C., Lowekamp, B., Rescorla, E., Baset, S., and H. Schulzrinne, &ldquo;REsource LOcation And Discovery (RELOAD) Base Protocol,&rdquo; March&nbsp;2010.</span><span>)</span></a> as the
        distibuted hash table (DHT) for data storage and overlay by which the
        peers interconnect and route messages. RELOAD is a generic P2P
        overlay, and application support is defined by profiles called Usages.
        In this document we present an Application Layer Multicast (ALM) Usage
        and a Hybrid ALM Usage.
</p>
<p>We also follow the RELOAD terminology for overlay specific terms,
        such as the distinction between peer, node, and client.
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4"></a><h3>3.4.&nbsp;
NAT</h3>

<p>Some nodes in the overlay may be in a private address space and
        behind firewalls. We use the RELOAD mechanisms for NAT traversal. We
        permit clients to be leaf nodes in an ALM or HALM tree. The specific
        capabilities of clients in terms of tree creation and being parents of
        other nodes will be described in subsequent versions.
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.5"></a><h3>3.5.&nbsp;
Regions</h3>

<p>A region is a contiguous internetwork such that if native multicast
        is available, all routers and end systems can connect to native
        multicast groups available in that region. A region may include end
        systems.
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.6"></a><h3>3.6.&nbsp;
AMT</h3>

<p>We use AMT <a class='info' href='#I-D.ietf-mboned-auto-multicast'>[I&#8209;D.ietf&#8209;mboned&#8209;auto&#8209;multicast]<span> (</span><span class='info'>Thaler, D., Talwar, M., Aggarwal, A., Vicisano, L., and T. Pusateri, &ldquo;Automatic IP Multicast Without Explicit Tunnels (AMT),&rdquo; March&nbsp;2010.</span><span>)</span></a> to
        connect nodes in ALM region with nodes in NM region. AMT permits AMT-R
        and AMT-GW functionality to be embedded in hosts or specially
        configured routers. We assume AMT-R and AMT-GW can be implemented in
        nodes. AMT has certain restrictions: 1) isolated sites/hosts can
        receive SSM, 2) isolated non-NAT sites/hosts can send SSM, 3) isolated
        sites/hosts can receive general multicast. AMT does not permit
        isolated sites/hosts to send general multicast.
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Hybrid ALM Tree Operations</h3>

<p>Peers use the overlay to support ALM operations such as: 
        </p>
<ul class="text">
<li>Create tree
</li>
<li>Join
</li>
<li>Leave
</li>
<li>Re-Form or optimize tree
</li>
</ul><p>
        There are a variety of algorithms for peers to form multicast
      trees in the overlay. We permit multiple such algorithms to be supported
      in the overlay, since different algorithms may be more suitable for
      certain application requirements, and since we wish to support
      experimentation. Therefore, overlay messaging corresponding to the set
      of overlay multicast operations must carry algorithm identification
      information.
</p>
<p>For example, for small groups, the join point might be directly
      assigned by the rendezvous point, while for large trees the join request
      might be propagated down the tree with candidate parents forwarding
      their position directly to the new node.
</p>
<p>In addition to these overlay level tree operations, some peers may
      implement additional operations to map tree operations to native
      multicast and/or AMT <a class='info' href='#I-D.ietf-mboned-auto-multicast'>[I&#8209;D.ietf&#8209;mboned&#8209;auto&#8209;multicast]<span> (</span><span class='info'>Thaler, D., Talwar, M., Aggarwal, A., Vicisano, L., and T. Pusateri, &ldquo;Automatic IP Multicast Without Explicit Tunnels (AMT),&rdquo; March&nbsp;2010.</span><span>)</span></a> 
      connections
</p>
<p>In the response to join requests, NM peers indicate further details, such as their AMT-Relay, 
        their public IP address (if they are in a private network), and NM peers in 
        AMT regions indicate their AMT gateway etc. This information allows 
        joining peers to establish features of existing tree peers. For NM peers 
        this information enables them to establish if the tree NM peers belong 
        to the same or a different NM region in the network, and ways to connect to it.
</p>
<p>It is up to the joining peer to then decide to join the tree via ALM or AMT. Joining 
        peers will select the most suitable peer to connect to based on criteria 
        such as lowest latency, throughput or highest capacity. 
</p>
<p>As this decision might be application dependent, this draft does not 
        attempt to prescribe any of these criteria, it is up to the joining peer 
        to select the most suitable candidate. 
</p><br /><hr class="insert" />
<a name="hybrid-alm"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
+---------------+                            +---------------+
| AMT Site      |   P1   P2   P3  P4    P5   | Native MCast  |
|     ..........+...+....+....+...+.....+....+.......        |
|     .     +---++                          ++---+  +P6      |
|  P21+     |AMT |                          |AMT |  .        |
|     .     |GW  |                          |RLY |  +P7      |
|     .     +---++                          ++---+  .        |
+-----+---------+                            +------+--------+
      .                                             .
      .                                      +------+--------+
      .                                      |      . Native |
      .                                      |      .  MDR   |
   P20+....+P19                         .....+...+..+P8      |
         .                              .    |   P9          |
+--------+------+                       .    +---------------+
| Native . MCast|                       .
|        ...    |                       .    +---------------+
| P-AMT-R18+    |                    P10+    |Native Mcast   |
|          .    |                       .   ++---+           |
| P-AMT-R17+    |             P-AMT-GW11+===|AMT |           |
|          .+...+..                     .   |RLY |           |
|           P16 |  .+....+........+.....+   ++---+           |
+---------------+   P15  P14      P13   P12  +---------------+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;2&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>In the above figure we show the hybrid architecture in six regions of
      the network. All peers are connected in an overlay, and the figure shows
      the predecessor/successor links between peers. AMT gateways (AMT-GW) do not 
      have native multicast connectivity to the multicast backbone. AMT-Relays (AMT-R) 
      do have native multicast connectivity to the multicast backbone. AMT Gateways provide 
      a connection to the native mulicast backbone via AMT Relays.
      The peers may have other connections in the overlay. 
       </p>
<ul class="text">
<li>No native multicast: Peers (P19 and P20) in this region connect to the
          overlay
</li>
<li>Native multicast (NM) in an AMT region with a local AMT gateway (AMT GW). There
          are one or more peers (P21) connected to the overlay in this
          region.
</li>
<li>Native multicast with a local AMT relay (AMT RLY). There are one
          or more peers (P6 and P7) connected to the overlay in this region.
</li>
<li>Native multicast with one or more peers which emulate the AMT
          relay behavior (P-AMT-R17 and P-AMT-R18) which also connect to the overlay. There
          may be other peers (P16) which also connect to the overlay.
</li>
<li>Native MDR is a native multicast region using multi-destination
          routing, in which one or more peers (P8 and P9) reside in the region.
</li>
<li>Native multicast with no peers that connect to the overlay, but
          for which there is at least one peer in the unicast-only part of the
          network which can behave as an AMT-GW (P21 and P-AMT-GW11) to connect to
          multicast sources through an AMT-R for that region. It may be
          feasible to also allow non-peer hosts in such a region to
          participate as receivers of overlay multicast; for this version, we
          prefer to require all hosts to join the overlay as peers.
</li>
</ul>

<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
ALM-Only Tree - Algorithm 1</h3>

<p>Here is a simplistic algorithm for forming a multicast tree in the
        overlay. Its main advantage is use of the overlay routing mechanism
        for routing both control and data messages. The group creator doesn't
        have to be the root of the tree or even in the tree. It doesn't
        consider per node load, admission control, or alternative paths.
</p>
<p>As stated earlier, multiple algorithms will co-exist in the
        overlay. </p>
<ol class="text">
<li>Peer which initiates multicast group: <br />
<br />

             <br /><hr class="insert" />
<a name="create"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
groupID = create();  // allocate a unique groupId
                     // the root is the nearest peer in the overlay
                     // out of band advertisement or
                     // distribution of groupID,
                     // perhaps by publishing in DHT
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;3&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

</li>
<li>Any joining peer: <br />
<br />
 <br /><hr class="insert" />
<a name="joinTree"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
// out of band discovery of groupID, perhaps by lookup in DHT
joinTree(groupID); // sends "join groupID" message
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;4&nbsp;</b></font><br /></td></tr></table><hr class="insert" />
 <br />
<br />
 The overlay routes the join
            request using the overlay routing mechanism toward the peer with
            the nearest id to the groupID. This peer is the root. Peers on the
            path to the root join the tree as forwarding points.
</li>
<li>Leave Tree: <br />
<br />
 leaveTree(groupID) //
            removes this node from the tree <br />
<br />

            Propagates a leave message to each child node and to the parent
            node. If the parent node is a forwarding node and this is its last
            child, then it propagates a leave message to its parent. A child
            node receiving a leave message from a parent sends a join message
            to the groupID.
</li>
<li>Message forwarding: <br />
<br />

            multicastMsg(groupID, msg);
</li>
<li>For the message forwarding there are two approaches:
               
<ul class="text">
<li>SSM tree: The creator of the tree is the source. It sends
                data messages to the tree root which are forwarded down the
                tree.
</li>
<li>ASM tree: A node sending a data message sends the message to
                its parent and its children. Each node receiving a data
                message from one edge forwards it to remaining tree edges it
                is connected to.
</li>
</ul>
</li>
</ol>

<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
ALM tree with peer at AMT site (AMT-GW)</h3>

<p>In this case, the joining peer is within an AMT region (such as 
        P21 in <a class='info' href='#hybrid-alm'>Figure&nbsp;2</a>) and attempts to 
        connect to the tree using the ALM protocol. A number of peers which are 
        already member of the tree may respond to this request. 
</p>
<p>There are the following cases: </p>
<ul class="text">
<li>There is at least one NM peer in the tree which is in the same NM 
            region as the joining peer. The joining peer uses ALM routing or 
            connects directly to the NM peer.
</li>
<li>The tree includes at least one NM peer which is in another NM region which 
            supports an AMT-R (such as P6 and P7 in <a class='info' href='#hybrid-alm'>Figure&nbsp;2</a>) or 
            another peer which can function as a P-AMT-R (P-AMT-R17 in <a class='info' href='#hybrid-alm'>Figure&nbsp;2</a>), the 
            joining peer can use its AMT-GW to connect to one of the NM peers. 
</li>
<li>There is no NM peer in the tree. The NM peer
            uses ALM routing.
</li>
</ul>

<p>If the peer
        is not a joining peer and is on the overlay path of a join request:
        </p>
<ul class="text">
<li>If its next hop is a peer in an NM region with AMT-R, then it
            can select either overlay routed multicast messages or AMT
            delivered multicast messages.
</li>
<li>If its next hop is a peer outside of an NM region, then it
            could use either ALM only or use AMT delivery as an alternate
            path
</li>
</ul>

<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
ALM tree with NM peer using AMT-R</h3>

<p>In this case, the joining peer is within a NM region (such as P6 
        in <a class='info' href='#hybrid-alm'>Figure&nbsp;2</a>)and initially 
        attempts to connect to the tree using the ALM protocol. Again, a number 
        of peers which are members of the tree respond to the request. 
</p>
<p>There are the following cases: </p>
<ul class="text">
<li>There is at least one NM peer in the tree which is in the same NM 
            region as the joining peer (such as P7 in <a class='info' href='#hybrid-alm'>Figure&nbsp;2</a>). 
            The joining peer uses ALM routing or 
            connects directly to the NM peer.
</li>
<li>There is at least one NM peer in the tree which is in a different 
            NM region as the joining peer (such as P16 in <a class='info' href='#hybrid-alm'>Figure&nbsp;2</a>).
</li>
<li>There is at least one peer in the tree 
            which can function as P-AMT-GW (P-AMT-GW11 in <a class='info' href='#hybrid-alm'>Figure&nbsp;2</a>). 
            The NM peer can join the tree using 
            ALM routing and/or connecting to the P-AMT-GW via its local AMT-R.
</li>
<li>There is at least one peer in the tree which is in an AMT-GW
            region (P21 in <a class='info' href='#hybrid-alm'>Figure&nbsp;2</a>). The NM peer can join the tree using 
            ALM routing and/or connecting to the peer via the AMT-GW and its local AMT-R.
</li>
<li>There is no NM peer in the tree. The NM peer
            uses ALM routing.
</li>
</ul>

<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4"></a><h3>4.4.&nbsp;
ALM tree with NM peer with P-AMT-R</h3>

<p>Either the NM peer supports P-AMT-R (P-AMT-R18 in <a class='info' href='#hybrid-alm'>Figure&nbsp;2</a>)
        or another peer in the multicast
        tree in the same region is P-AMT-R (P16 via P-AMT-R17 in <a class='info' href='#hybrid-alm'>Figure&nbsp;2</a>)
        capable. The last three cases above
        apply here, replacing AMT-R with P-AMT-R.
</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5"></a><h3>4.5.&nbsp;
ALM tree with peer P-AMT-GW</h3>

<p>Here the joining peer supports P-AMT-GW (P-AMT-GW11 in <a class='info' href='#hybrid-alm'>Figure&nbsp;2</a>). If the tree 
        includes peers which are in a NM region which supports a AMT-R (P6 and P7 in <a class='info' href='#hybrid-alm'>Figure&nbsp;2</a>), or 
        a peer featuring P-AMT-R (P-AMT-R17 in <a class='info' href='#hybrid-alm'>Figure&nbsp;2</a>) the joining peer can connect to these using 
        its AMT-GW functionality.
</p>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.6"></a><h3>4.6.&nbsp;
Mixed Region Scenarios</h3>

<p>In version 2 of this document we elaborate on: </p>
<ul class="text">
<li>ALM tree topology vs NM topology and NM-ALM edges
</li>
<li>Single NM-ALM edge nodes vs multi NM peers from same region in
            the tree
</li>
<li>Initial tree membership is ALM vs initial tree membership is
            NM
</li>
</ul><p> For ALM tree topology vs NM topology, all peers belong to
        the overlay, but only P-ALM peers use overlay routing for multicast
        data transmission. As a default behavior, a P-NM peer should generally
        prefer to join the tree via an AMT-GW node. But there may be special
        cases (small trees, short multicast sessions, trees where most of the
        members are known to be P-ALM) in which the peer can override this to
        specify an ALM-only join. A P-NM peer may also accept P-ALM children
        which don't use the AMT tunnel path to participate in the multicast
        tree.
</p>
<p>Consider 3 types of tree links: P-ALM to P-ALM, P-NM to P-NM and
        P-ALM to/from P-NM: </p>
<ul class="text">
<li>P-ALM to P-ALM This is a normal ALM tree path with management
            strictly in the overlay
</li>
<li>P-NM to P-NM If the peers are in the same region, then the data
            path use native multicast capability in that region, and control
            occurs in ALM layer for ALM tree coordination and NM layer for
            native multicast purposes. If the peers are in different NM
            regions, then, if AMT gateways are available and configured to
            support an AMT tunnel between the regions, a tunnel is created
            using the AMT protocol (or already exists for this multicast
            group). The peers connect to their respective AMT gateways using
            the AMT procedure.
</li>
<li>P-ALM to/from P-NM The connection can be either ALM or AMT
            tunnel depending on the context.
</li>
</ul><p> We expect two new functions are needed to build hybrid
        trees: </p>
<ul class="text">
<li>joinViaAMTGateway(peer, AMT-GW, group_id) where 'Peer' is the
            peer requesting to join the ALM group identified by group_id, and
            AMT-GW is the ip address of the AMT gateway that the peer uses in
            its native multicast region. Request is transmitted to one or more
            parent peer candiates and/or rendezvous peers for the specified
            group id, according to the usual join protocol in this overlay. If
            the parent peer is a P-AMT-GW, then a tunnel is formed using the
            AMT protocol from the P-AMT-GW to the specified AMT-GW. If parent
            peer is a peer P-NM in native multicast region, then the tunnel is
            created between P-NM's AMT-GW and the specified AMT-GW, using the
            AMT protocol. If parent peer is a P-ALM, then the requested is
            propagated to other peers in the tree according to the join
            rules.
</li>
<li>leaveViaAMTGateway(peer, AMT-GW, group_id)where 'Peer' is the
            peer requesting to leave the ALM group identified by group_id, and
            AMT-GW is the ip address of the AMT gateway that the peer uses in
            its native multicast region. Request is transmitted the parent
            peer which is associated with the AMT-GW or provides that role. If
            the parent peer is a P-AMT-GW, then it removes the child from its
            AMT children list and may tear down the AMT tunnel P-AMT-GW to the
            specified AMT-GW if no other children are using it. If parent peer
            is a peer P-NM in native multicast region, then the tunnel is
            created between P-NM's AMT-GW and the specified AMT-GW, using the
            AMT protocol.
</li>
</ul><p> Regarding initial tree membership being either P-NM or P-ALM
        node(s), we expect the general case should be that hybrid tree
        formation is supported transparently regardless.
</p>
<a name="sec-group-api"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Group Management API</h3>

<p>The group management API describes interfaces for application
      programmers to initiate a group, register or deregister multicast
      listeners, and to send and receive multicast data. It is the aim to
      provide a stable programming environment that facilitates a late service
      binding and remains robust with respect to deployment aspects. Following
      this objective, an application programmer should be enabled to implement
      a group communication access that will become operational by any group
      service available, e.g., native multicast, different kinds of overlays,
      or hybrid services as described in this document. The subsequent calls
      are part of a universal group service access concept and aligned with
      the more general API specification presented in <a class='info' href='#I-D.waehlisch-sam-common-api'>[I&#8209;D.waehlisch&#8209;sam&#8209;common&#8209;api]<span> (</span><span class='info'>Waehlisch, M., Schmidt, T., and S. Venaas, &ldquo;A Common API for Transparent Hybrid Multicast,&rdquo; March&nbsp;2010.</span><span>)</span></a>.
</p>
<p>An important issue of group access lies in naming and addressing.
      While applications sharing access to the same group should use a common
      name, different underlying technologies deploy different addressing
      schemes. For example, native multicast is bound to IP addresses
      (IPv4/IPv6), whereas ALM uses arbitrary strings as multicast names,
      which will be mapped to the overlay identifier space. Name and address
      support thus needs to account for variable namespaces, but still provide
      abstract data types that keep code independent of particular selections.
      We achieve this by introducing Multicast URIs (cf., <a class='info' href='#I-D.waehlisch-sam-common-api'>[I&#8209;D.waehlisch&#8209;sam&#8209;common&#8209;api]<span> (</span><span class='info'>Waehlisch, M., Schmidt, T., and S. Venaas, &ldquo;A Common API for Transparent Hybrid Multicast,&rdquo; March&nbsp;2010.</span><span>)</span></a>).
</p>
<p>In this way, the API provides access to implementing group-oriented
      data communication independent of the underlying distribution
      technologies. In particular, applications can be designed to meet
      efficiency requirements independent of deployment aspects in the target
      domain. The API is located between applications and the group stack at
      the current host. Here we do not consider the interface between hosts,
      which is outlined in <a class='info' href='#sec-protocol'>Section&nbsp;6<span> (</span><span class='info'>Protocol</span><span>)</span></a>.
</p>
<p>
</p>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Data Types</h3>

<p></p>
<blockquote class="text"><dl>
<dt>Multicast URI</dt>
<dd>is any kind of multicast address or
            multicast name that follows the syntax:

&lt;scheme&gt;://&lt;groupID&gt;@&lt;authority&gt;:&lt;port&gt;/&lt;credentials&gt;.
            Examples are ip://224.1.2.3:5000/F06E34 or
            sip://news@cnn.com.
</dd>
<dt>Handle</dt>
<dd>gives a reference to a specific instance of a
            communication object.
</dd>
</dl></blockquote>

<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Send and Receive Calls</h3>

<p></p>
<blockquote class="text"><dl>
<dt>init(out Handle s)</dt>
<dd>This call creates a multicast
            socket that is bound to some virtual multicast interface and
            provides a corresponding handle to the application programmer,
            which will be used for subsequent communication.
</dd>
<dt>join(in Handle s, in URI g)</dt>
<dd>This operation initiates
            a group subscription for the name g, including the corresponding
            tree access.
</dd>
<dt>leave(in Handle s, in URI g)</dt>
<dd>This operation results
            in an unsubscription for the given name g, including the
            corresponding disconnect of the tree.
</dd>
<dt>send(in Handle s, in URI g,in Message m)</dt>
<dd>This call
            sends data m to the multicast group name g. It simultaneously
            initiates creation of the group state, if not already present.
</dd>
<dt>receive(in Handle s, out URI g, out Message m)</dt>
<dd>This
            call delivers data m to the application along with an indicator of
            the group membership.
</dd>
</dl></blockquote>

<a name="sec-protocol"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Protocol</h3>

<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
Introduction</h3>

<p>In this document we define messages for hybrid overlay multicast
        tree creation, using an existing proposal (RELOAD) in the P2P-SIP WG
        <a class='info' href='#I-D.ietf-p2psip-base'>[I&#8209;D.ietf&#8209;p2psip&#8209;base]<span> (</span><span class='info'>Jennings, C., Lowekamp, B., Rescorla, E., Baset, S., and H. Schulzrinne, &ldquo;REsource LOcation And Discovery (RELOAD) Base Protocol,&rdquo; March&nbsp;2010.</span><span>)</span></a> for a universal structured
        peer-to-peer overlay protocol. RELOAD provides the mechanism to
        support a number of overlay topologies. Hence the hybrid overlay
        multicast framework <a class='info' href='#I-D.irtf-sam-hybrid-overlay-framework'>[I&#8209;D.irtf&#8209;sam&#8209;hybrid&#8209;overlay&#8209;framework]<span> (</span><span class='info'>Buford, J., &ldquo;Hybrid Overlay Multicast Framework,&rdquo; February&nbsp;2008.</span><span>)</span></a> (hereafter SAM framework) can be
        used with P2P-SIP, and that the SAM framework is overlay agnostic.
</p>
<p>We are not proposing that these SAM-specific messages be
        incorporated into RELOAD since constructing the SAM framework is still
        a research activity. However, we do propose that RELOAD add an
        extension mechanism.
</p>
<p>As discussed in the SAM requirements draft, there are a variety of
        ALM tree formation and tree maintenance algorithms. The intent of this
        specification is to be algorithm agnostic, similar to how RELOAD is
        overlay algorithm agnostic. We assume that all control messages are
        propagated using overlay routed messages.
</p>
<p>The message types needed for ALM behavior are divided into the
        following categories: </p>
<ul class="text">
<li>Tree life-cycle (create, join, leave, re-form, heartbeat)
</li>
<li>AMT gateway advertisement and discovery
</li>
<li>Peer region and multicast properties
</li>
</ul>

<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
Tree Lifecylce Messages</h3>

<p>Peers use the overlay to transmit ALM (application layer multicast)
        operations and hybrid ALM operations defined in this section.
</p>
<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2.1"></a><h3>6.2.1.&nbsp;
Create Tree</h3>

<p>A new ALM tree is created in the overlay with the identity
          specified by GroupId. The usual interpretation of GroupId is that
          the peer with peer id closest to and less than the GroupId is the
          root of the tree. The tree has no children at the time it is
          created.
</p>
<p>The GroupId is generated from a well-known session key to be used
          by other Peers to address the multicast tree in the overlay. The
          generation of the GroupId from the SessionKey MUST be done using the
          overlay's id generation mechanism.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      struct {
        NodeID PeerId;
        opaque SessionKey&lt;0..2^32-1&gt;;
        NodeID GroupId;
        Dictionary Options;
      } CreateALMTree;
</pre></div>
<p>PeerId: the overlay address of the peer that creates the
          multicast tree.
</p>
<p>SessionKey: a well-known string when hashed using the overlay's
          id generation algorithm produces the GroupId.
</p>
<p>GroupId: the overlay address of the root of the tree
</p>
<p>Options: name-value list of properties to be associated with the
          tree, such as the maximum size of the tree, restrictions on peers
          joining the tree, latency constraints, preference for distributed or
          centralized tree formation and maintenance, heartbeat interval.
</p>
<a name="anchor25"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2.2"></a><h3>6.2.2.&nbsp;
Join</h3>

<p>Causes the distributed algorithm for peer join of a specific ALM
          group to be invoked. If successful, the PeerId is notified of one or
          more candidate parent peers in one or more JoinAccept messages. The
          particular ALM join algorithm is not specified in this protocol.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      struct {
        NodeID PeerId;
        NodeID GroupId;
        Dictionary Options;
      } Join;
</pre></div>
<p>PeerId: overlay address of joining/leaving peer
</p>
<p>GroupId: the overlay address of the root of the tree
</p>
<p>Options: name-value list of options proposed by joining peer
</p>
<a name="anchor26"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2.3"></a><h3>6.2.3.&nbsp;
Join Accept</h3>

<p>Tells the requesting joining peer that the indicated peer is
          available to act as its parent in the ALM tree specified by GroupId,
          with the corresponding Options specified. A peer MAY receive more
          than one JoinAccept from diffent candidate parent peers in the
          GroupId tree. The peer accepts a peer as parent using a JoinConfirm
          message. A JoinAccept which receives neither a JoinConfirm or
          JoinDecline response MUST expire.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      struct {
        NodeID ParentPeerId;
        NodeID ChildPeerId;
        NodeID GroupId;
        Dictionary Options;
      } JoinAccept;
</pre></div>
<p>ParentPeerId: overlay address of a peer which accepts the joining
          peer
</p>
<p>ChildPeerId: overlay address of joining peer
</p>
<p>GroupId: the overlay address of the root of the tree
</p>
<p>Options: name-value list of options accepted by parent peer
</p>
<a name="anchor27"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2.4"></a><h3>6.2.4.&nbsp;
Join Confirm</h3>

<p>A peer receiving a JoinAccept message which it wishes to accept
          MUST explicitly accept it before the expiration of the JoinAccept
          using a JoinConfirm message. The joining peer MUST include only
          those options from the JoinAccept which it also accepts, completing
          the negotiation of options between the two peers.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      struct {
        NodeID ChildPeerId;
        NodeID ParentPeerId;
        NodeID GroupId;
        Dictionary Options;
      } JoinConfirm;
</pre></div>
<p>ChildPeerId: overlay address of joining peer which is a child of
          the parent peer
</p>
<p>ParentPeerId: overlay address of the peer which is the parent of
          the joining peer
</p>
<p>GroupId: the overlay address of the root of the tree
</p>
<p>Options: name-value list of options accepted by both peers
</p>
<a name="anchor28"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2.5"></a><h3>6.2.5.&nbsp;
Join Decline</h3>

<p>A peer receiving a JoinAccept message which does not wish to
          accept it MAY explicitly decline it using a JoinDecline message.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      struct {
        NodeID PeerId;
        NodeID ParentPeerId;
        NodeID GroupId;
      } JoinDecline;
</pre></div>
<p>PeerId: overlay address of joining peer which declines the
          JoinAccept
</p>
<p>ParentPeerId: overlay address of the peer which issued a
          JoinAccept to this peer
</p>
<p>GroupId: the overlay address of the root of the tree
</p>
<a name="anchor29"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2.6"></a><h3>6.2.6.&nbsp;
Join Via AMT Gateway</h3>

<p>A request to create a hybrid native multicast connection for the
          specified PeerId peer to join the tree identified by the GroupId.
          The request is transmitted to one or more parent peer candidates
          and/or rendezvous peers for the specified group id, according to the
          usual join protocol in this overlay.
</p>
<p>If the parent peer is a P-AMT-GW (a peer which supports the
          AMT-GW interface), then after JoinAccept and JoinConfirm steps,
          instead of an overlay parent-child link, an AMT tunnel is formed
          using the AMT protocol from the P-AMT-GW to the specified AMT-GW to
          which the Peer is associated.
</p>
<p>If parent peer is a peer P-NM in native multicast region, then
          after JoinAccept and JoinConfirm steps, the tunnel is created
          between P- NM's AMT-GW and the specified AMT-GW, using the AMT
          protocol. If parent peer is a P-ALM, then the requested is
          propagated to other peers in the tree according to the join
          processing rules.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      struct {
        NodeID PeerId;
        IpAddressPort AMT-GW;
        NodeID GroupId;
        Dictionary Options;
      } JoinViaAMTGateway;
</pre></div>
<p>PeerID: the peer requesting to join the ALM group identified by
          group_id
</p>
<p>AMT-GW: ip address of the AMT gateway that the peer uses in its
          native multicast region.
</p>
<p>Options: name-value list of options proposed by joining peer
</p>
<a name="anchor30"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2.7"></a><h3>6.2.7.&nbsp;
Join Via Native Link</h3>

<p>This allows child to select specific parent peer, overriding
          selection based on the basic join method. Typical use is for a peer
          in NM region to join the multicast group using the local native
          multicast path for this GroupId. Joining peer determines:
</p>
<p></p>
<ul class="text">
<li>It is in an NM region, determined for example using MRD
              (Multicast Router Discovery) <a class='info' href='#RFC4286'>[RFC4286]<span> (</span><span class='info'>Haberman, B. and J. Martin, &ldquo;Multicast Router Discovery,&rdquo; December&nbsp;2005.</span><span>)</span></a> or
              configuration
</li>
<li>It knows the native multicast address (NMA) in its region, if
              it exists, which corresponds to the GroupId
</li>
<li>It can connect to the NMA using IGMP
</li>
<li>Either 1) there is at least one peer that is in the same NM
              region that is already part of the GroupId, or 2) the region has
              an AMT- GW which can connect to some P-AMT-GW or P-NM in another
              NM region which is part of the GroupId. It uses a separate
              discovery step such as LookupPeerNMInfo described later.
</li>
<li>If there is no such peer in the GroupId, then this joining
              peer is the first peer to be added which is in an NM region. It
              CANNOT join using this message type.
</li>
</ul>

<p>ParentPeer and ChildPeer are either in same NM region or in two
          different NM regions with capability for AMT. Since media is passed
          via NM path, the parent-child relationship established by this join
          is for control and membership management
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      struct {
        NodeID ChildPeerId;
        NodeID ParentPeerId;
        NodeID GroupId;
        Dictionary Options;
      } JoinWithNativeLink;
</pre></div>
<p>ChildPeerId: overlay address of joining peer which is a child of
          the parent peer
</p>
<p>ParentPeerId: overlay address of the peer which is the parent of
          the joining peer
</p>
<p>GroupId: the overlay address of the root of the tree
</p>
<p>Options: name-value list of options accepted by both peers
</p>
<a name="anchor31"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2.8"></a><h3>6.2.8.&nbsp;
Leave</h3>

<p>A peer which is part of an ALM tree idenfied by GroupId which
          intends to detach from either a child or parent peer SHOULD send a
          Leave message to the peer it wishes to detach from. A peer receiving
          a Leave message from a peer which is neither in its parent or child
          lists SHOULD ignore the message.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      struct {
        NodeID PeerId;
        NodeID GroupId;
        Dictionary Options;
      } Leave;
</pre></div>
<p>PeerId: overlay address of leaving peer
</p>
<p>GroupId: the overlay address of the root of the tree
</p>
<p>Options: name-value list of options
</p>
<a name="anchor32"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2.9"></a><h3>6.2.9.&nbsp;
Leave via AMT Gateway</h3>

<p>A peer which is part of an ALM tree identified by GroupId which
          intends to detach from either a child or parent peer and which uses
          an AMT tunnel to connect to the peer SHOULD send a
          LeaveViaAMTGateway message to the peer it wishes to detach from. A
          peer receiving a LeaveViaAMTGateway message from a peer which is
          neither in its parent or child lists SHOULD ignore the message.
</p>
<p>The request is transmitted the AdjacentPeerId. AdjacentPeerId
          MUST remove the specified PeerId from its children or parent lists
          if present.
</p>
<p>If AdjacentPeerId is a P-AMT-GW, then it MAY tear down the AMT
          tunnel from P-AMT-GW to the specified AMT-GW if no other children
          are using it. If AdjacentPeerId is a peer P-NM (peer in a native
          multicast region), then the tunnel between P-NM's AMT-GW and the
          specified AMT- GW MAY be removed according to the policy and
          configuration of the AMT-GW.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      struct {
        NodeID PeerId;
        NodeID AdjacentPeerId;
        IpAddressPort AMT-GW;
        NodeID GroupId;
        Dictionary Options;
      } LeaveViaAMTGateway;
</pre></div>
<p>PeerId: overlay address of leaving peer
</p>
<p>AdjacentPeerId: overlay address of an adjacent (parent or child)
          peer
</p>
<p>AMT-GW: ip address of the AMT gateway that the peer uses in its
          native multicast region.
</p>
<p>GroupId: the overlay address of the root of the tree
</p>
<p>Options: name-value list of options
</p>
<a name="anchor33"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2.10"></a><h3>6.2.10.&nbsp;
Re-Form or Optimize Tree</h3>

<p>This triggers a reorganization of either the entire tree or only
          a sub-tree. It MAY include hints to specific peers of recommended
          parent or child peers to reconnect to. A peer receiving this message
          MAY ignore it, MAY propagate it to other peers in its subtree, and
          MAY invoke local algorithms for selecting preferred parent and/or
          child peers.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      struct {
        NodeID GroupId;
        NodeID PeerId;
        Dictionary Options;
      } Reform;
</pre></div>
<p>GroupId: the overlay address of the root of the tree
</p>
<p>PeerId: if omitted, then the tree is reorganized starting from
          the root, otherwise it is reorganized only at the sub-tree
          identified by PeerId.
</p>
<p>Options: name-value list of options
</p>
<a name="anchor34"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2.11"></a><h3>6.2.11.&nbsp;
Heartbeat</h3>

<p>A node signals to its adjacent nodes in the tree that it is
          alive. If a peer does not receive a Heartbeat message within N
          heartbeat time intervals, it MUST treat this as an explicit Leave
          message from the unresponsive peer. N is configurable.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      struct {
        NodeID PeerId1;
        NodeID PeerId2;
        NodeID GroupId;
      } Heartbeat;
</pre></div>
<p>PeerId1: source of heartbeat
</p>
<p>PeerId2: destination of heartbeat
</p>
<p>GroupId: overlay address of the root of the tree
</p>
<a name="anchor35"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.3"></a><h3>6.3.&nbsp;
AMT Gateway Advertisement and Discovery</h3>

<p>Allows peer to disclose to other peers in the overlay their ability
        to act as a native-multicast gateway (as in AMT) for peers in a given
        region. We expect to use the P2P Publish and Lookup messages for this
        purpose. But to avoid collision with the semantics of those
        operations, we temporarily define shadow versions within the SAM
        extension. Publish stores an advertisement object for a peer with is
        an AMT gateway in the DHT for the overlay, under a given key.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      struct {
        NodeID PeerId;
        ResourceID Key;
        opaque Region&lt;0..2^32-1&gt;;
        Dictionary Options;
      } PublishAMTGateway;
</pre></div><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      struct {
        NodeID PeerId;
        ResourceID Key;
      } LookupAMTGateway;
</pre></div>
<p>PeerId: the peer which is the AMT gateway
</p>
<p>Key: the key by which other peers lookup the advertisement, details
        TBD. There can be more than one key.
</p>
<p>Region: an id for a region, using some region identification scheme
        TBD. For example, the Autonomous System Number (ASN) could be used.
        <a class='info' href='#RFC1930'>[RFC1930]<span> (</span><span class='info'>Hawkinson, J. and T. Bates, &ldquo;Guidelines for creation, selection, and registration of an Autonomous System (AS),&rdquo; March&nbsp;1996.</span><span>)</span></a>
</p>
<p>Options: Name-value list of options
</p>
<a name="anchor36"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.4"></a><h3>6.4.&nbsp;
Peer Region and Multicast Properties Messages</h3>

<p>Peers can advertise the network region that they belong to and its
        native multicast properties if any. Similar to AMT Gateway
        advertisement and discovery, uses the DHT for lookup and publish.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      struct {
        NodeID PeerId;
        ResourceID Key;
        opaque Region&lt;0..2^32-1&gt;;
        Dictionary Options;
      } PublishPeerNMInfo;
</pre></div><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      struct {
        NodeID PeerId;
        ResourceID Key;
      } LookupPeerNMInfo;
</pre></div>
<p>PeerId: the peer which is the AMT gateway
</p>
<p>Key: the key by which other peers lookup the advertisement, details
        TBD. There can be more than one key.
</p>
<p>Options: Name-value list of options.
</p>
<a name="anchor37"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
RELOAD Usages</h3>

<p>Applications of RELOAD are restricted in the data types that be can
      stored in the DHT. The profile of accepted data types for an application
      is referred to as a Usage. RELOAD is designed so that new applications
      can easily define new Usages. New RELOAD Usages are needed for hybrid
      multicast applications since the data types in base RELOAD and existing
      usages are not sufficient.
</p>
<p>We define an ALM Usage and a Hybrid ALM Usage in RELOAD. The ALM
      Usage is sufficient for applications which only require ALM
      functionality in the overlay. The Hybrid ALM (HALM) Usage extends the
      ALM Usage so that hybrid native multicast and ALM trees can be used by
      applications.
</p>
<p>The ALM Usage involves the functions: </p>
<ul class="text">
<li>ALM applications use the RELOAD data storage functionality to
          store a groupID when a new ALM tree is created in the overlay, and
          to retrieve groupIDs for existing ALM trees.
</li>
<li>ALM applications use the RELOAD data storage functionality to
          store a set of attributes for an ALM tree, such as owner, tree size,
          tree height, tree formation algorithm, and join criteria.
</li>
<li>ALM applications and management tools use the RELOAD data storage
          functionality to store diagnostic information about the operation of
          tree, including average number of tree, delay from source to leaf
          nodes, bandwidth use, lost packet rate. In addition, diagnostic
          information may include statistics specific to the tree root, or to
          any node in the tree.
</li>
</ul><p> The Hybrid ALM Usage involves the following additional
      functions: </p>
<ul class="text">
<li>HALM applications use the RELOAD data storage functionality to
          store a set of attributes for a AMT Gateway that can connect to at
          least one node in the overlay.
</li>
<li>HALM applications use the RELOAD data storage functionality to
          store a set of attributes about a native multicast region associated
          with an AMT Gateway.
</li>
<li>HALM applications and management tools use the RELOAD data
          storage functionality to store diagnostic information about the
          operation of AMT and ALM interconnections.
</li>
</ul><p> A RELOAD Usage is required <a class='info' href='#I-D.ietf-p2psip-base'>[I&#8209;D.ietf&#8209;p2psip&#8209;base]<span> (</span><span class='info'>Jennings, C., Lowekamp, B., Rescorla, E., Baset, S., and H. Schulzrinne, &ldquo;REsource LOcation And Discovery (RELOAD) Base Protocol,&rdquo; March&nbsp;2010.</span><span>)</span></a> to define the following: </p>
<ul class="text">
<li>Register Kind-Id points
</li>
<li>Define data structures for each kind
</li>
<li>Defines access control rules for each kind
</li>
<li>Defines the Resource Name used to hash to the Resource ID where
          the kind is stored
</li>
<li>Addresses restoration of values after recovery from a network
          partition
</li>
<li>Defines the types of connections that can be initiated using
          AppConnect
</li>
</ul><p> The following sections are preliminary steps towards
      formalizing the for ALM and HALM Uages.
</p>
<a name="anchor38"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.1"></a><h3>7.1.&nbsp;
ALM Usage for RELOAD</h3>

<p>A ALM GroupID is a RELOAD Node-ID. The owner of a ALM group creates
        a RELOAD Node-ID as specified in <a class='info' href='#I-D.ietf-p2psip-base'>[I&#8209;D.ietf&#8209;p2psip&#8209;base]<span> (</span><span class='info'>Jennings, C., Lowekamp, B., Rescorla, E., Baset, S., and H. Schulzrinne, &ldquo;REsource LOcation And Discovery (RELOAD) Base Protocol,&rdquo; March&nbsp;2010.</span><span>)</span></a>. This means that a GroupID is
        used as a RELOAD Destination for overlay routing purposes.
</p>
<a name="anchor39"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.2"></a><h3>7.2.&nbsp;
Hybrid ALM Usage for RELOAD</h3>

<p>
</p>
<a name="anchor40"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Examples</h3>

<p>TBD.
</p>
<a name="IANA"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
IANA Considerations</h3>

<p>This memo includes no request to IANA.
</p>
<a name="Security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
Security Considerations</h3>

<p>Overlays are vulnerable to DOS and collusion attacks. We are not
      solving overlay security issues. We assume the centralized node
      authentication model as defined in <a class='info' href='#I-D.ietf-p2psip-base'>[I&#8209;D.ietf&#8209;p2psip&#8209;base]<span> (</span><span class='info'>Jennings, C., Lowekamp, B., Rescorla, E., Baset, S., and H. Schulzrinne, &ldquo;REsource LOcation And Discovery (RELOAD) Base Protocol,&rdquo; March&nbsp;2010.</span><span>)</span></a>.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>11.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC0792">[RFC0792]</a></td>
<td class="author-text">Postel, J., &ldquo;<a href="http://tools.ietf.org/html/rfc792">Internet Control Message Protocol</a>,&rdquo; STD&nbsp;5, RFC&nbsp;792, September&nbsp;1981 (<a href="http://www.rfc-editor.org/rfc/rfc792.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3376">[RFC3376]</a></td>
<td class="author-text">Cain, B., Deering, S., Kouvelas, I., Fenner, B., and A. Thyagarajan, &ldquo;<a href="http://tools.ietf.org/html/rfc3376">Internet Group Management Protocol, Version 3</a>,&rdquo; RFC&nbsp;3376, October&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3376.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3810">[RFC3810]</a></td>
<td class="author-text">Vida, R. and L. Costa, &ldquo;<a href="http://tools.ietf.org/html/rfc3810">Multicast Listener Discovery Version 2 (MLDv2) for IPv6</a>,&rdquo; RFC&nbsp;3810, June&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3810.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4605">[RFC4605]</a></td>
<td class="author-text">Fenner, B., He, H., Haberman, B., and H. Sandick, &ldquo;<a href="http://tools.ietf.org/html/rfc4605">Internet Group Management Protocol (IGMP) / Multicast Listener Discovery (MLD)-Based Multicast Forwarding ("IGMP/MLD Proxying")</a>,&rdquo; RFC&nbsp;4605, August&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4605.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4607">[RFC4607]</a></td>
<td class="author-text">Holbrook, H. and B. Cain, &ldquo;<a href="http://tools.ietf.org/html/rfc4607">Source-Specific Multicast for IP</a>,&rdquo; RFC&nbsp;4607, August&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4607.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5058">[RFC5058]</a></td>
<td class="author-text">Boivie, R., Feldman, N., Imai, Y., Livens, W., and D. Ooms, &ldquo;<a href="http://tools.ietf.org/html/rfc5058">Explicit Multicast (Xcast) Concepts and Options</a>,&rdquo; RFC&nbsp;5058, November&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc5058.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>11.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="AGU1984">[AGU1984]</a></td>
<td class="author-text">Aguilar, L., &ldquo;Datagram Routing for Internet Multicasting,&rdquo; ACM Sigcomm 84&nbsp;1984, March&nbsp;1984.</td></tr>
<tr><td class="author-text" valign="top"><a name="CASTRO2002">[CASTRO2002]</a></td>
<td class="author-text">Castro, M., Druschel, P., Kermarrec, A., and A. Rowstron, &ldquo;<a href="http://research.microsoft.com/en-us/um/people/antr/past/jsac.pdf">Scribe: A large-scale and decentralized application-level
          multicast infrastructure</a>,&rdquo; IEEE Journal on Selected Areas in Communications&nbsp;vol.20, No.8, October&nbsp;2002.</td></tr>
<tr><td class="author-text" valign="top"><a name="CASTRO2003">[CASTRO2003]</a></td>
<td class="author-text">Castro, M., Jones, M., Kermarrec, A., Rowstron, A., Theimer, M., Wang, H., and A. Wolman, &ldquo;<a href="http://research.microsoft.com/en-us/um/people/mcastro/publications/infocom-compare.pdf">An Evaluation of Scalable Application-level Multicast Built
          Using Peer-to-peer overlays</a>,&rdquo; Proceedings of IEEE INFOCOM&nbsp;2003, April&nbsp;2003.</td></tr>
<tr><td class="author-text" valign="top"><a name="HE2005">[HE2005]</a></td>
<td class="author-text">He, Q. and M. Ammar, &ldquo;Dynamic Host-Group/Multi-Destination Routing for Multicast
          Sessions,&rdquo; J. Telecommunication Systems&nbsp;vol. 28, pp. 409-433.</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-mboned-auto-multicast">[I-D.ietf-mboned-auto-multicast]</a></td>
<td class="author-text">Thaler, D., Talwar, M., Aggarwal, A., Vicisano, L., and T. Pusateri, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-mboned-auto-multicast-10.txt">Automatic IP Multicast Without Explicit Tunnels (AMT)</a>,&rdquo; draft-ietf-mboned-auto-multicast-10 (work in progress), March&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-mboned-auto-multicast-10.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-p2psip-base">[I-D.ietf-p2psip-base]</a></td>
<td class="author-text">Jennings, C., Lowekamp, B., Rescorla, E., Baset, S., and H. Schulzrinne, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-p2psip-base-08.txt">REsource LOcation And Discovery (RELOAD) Base Protocol</a>,&rdquo; draft-ietf-p2psip-base-08 (work in progress), March&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-p2psip-base-08.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-p2psip-sip">[I-D.ietf-p2psip-sip]</a></td>
<td class="author-text">Jennings, C., Lowekamp, B., Rescorla, E., Baset, S., and H. Schulzrinne, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-p2psip-sip-04.txt">A SIP Usage for RELOAD</a>,&rdquo; draft-ietf-p2psip-sip-04 (work in progress), March&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-p2psip-sip-04.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.irtf-p2prg-rtc-security">[I-D.irtf-p2prg-rtc-security]</a></td>
<td class="author-text">Schulzrinne, H., Marocco, E., and E. Ivov, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-irtf-p2prg-rtc-security-05.txt">Security Issues and Solutions in Peer-to-peer Systems for Realtime Communications</a>,&rdquo; draft-irtf-p2prg-rtc-security-05 (work in progress), September&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-irtf-p2prg-rtc-security-05.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.irtf-sam-hybrid-overlay-framework">[I-D.irtf-sam-hybrid-overlay-framework]</a></td>
<td class="author-text">Buford, J., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-irtf-sam-hybrid-overlay-framework-02.txt">Hybrid Overlay Multicast Framework</a>,&rdquo; draft-irtf-sam-hybrid-overlay-framework-02 (work in progress), February&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-irtf-sam-hybrid-overlay-framework-02.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.matuszewski-p2psip-security-overview">[I-D.matuszewski-p2psip-security-overview]</a></td>
<td class="author-text">Yongchao, S., Matuszewski, M., and D. York, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-matuszewski-p2psip-security-overview-01.txt">P2PSIP Security Overview and Risk Analysis</a>,&rdquo; draft-matuszewski-p2psip-security-overview-01 (work in progress), October&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-matuszewski-p2psip-security-overview-01.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.waehlisch-sam-common-api">[I-D.waehlisch-sam-common-api]</a></td>
<td class="author-text">Waehlisch, M., Schmidt, T., and S. Venaas, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-waehlisch-sam-common-api-02.txt">A Common API for Transparent Hybrid Multicast</a>,&rdquo; draft-waehlisch-sam-common-api-02 (work in progress), March&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-waehlisch-sam-common-api-02.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1112">[RFC1112]</a></td>
<td class="author-text"><a href="mailto:deering@PESCADERO.STANFORD.EDU">Deering, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1112">Host extensions for IP multicasting</a>,&rdquo; STD&nbsp;5, RFC&nbsp;1112, August&nbsp;1989 (<a href="http://www.rfc-editor.org/rfc/rfc1112.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1930">[RFC1930]</a></td>
<td class="author-text"><a href="mailto:jhawk@bbnplanet.com">Hawkinson, J.</a> and <a href="mailto:Tony.Bates@mci.net">T. Bates</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1930">Guidelines for creation, selection, and registration of an Autonomous System (AS)</a>,&rdquo; BCP&nbsp;6, RFC&nbsp;1930, March&nbsp;1996 (<a href="http://www.rfc-editor.org/rfc/rfc1930.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3552">[RFC3552]</a></td>
<td class="author-text">Rescorla, E. and B. Korver, &ldquo;<a href="http://tools.ietf.org/html/rfc3552">Guidelines for Writing RFC Text on Security Considerations</a>,&rdquo; BCP&nbsp;72, RFC&nbsp;3552, July&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3552.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4286">[RFC4286]</a></td>
<td class="author-text">Haberman, B. and J. Martin, &ldquo;<a href="http://tools.ietf.org/html/rfc4286">Multicast Router Discovery</a>,&rdquo; RFC&nbsp;4286, December&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4286.txt">TXT</a>).</td></tr>
</table>

<a name="app-additional"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Additional Stuff</h3>

<p>This becomes an Appendix.
</p>
<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">John Buford</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Avaya Labs Research</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">233 Mt. Airy Rd</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Basking Ridge, New Jersey  07920</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 908 848 5675</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:buford@avaya.com">buford@avaya.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Mario Kolberg (editor)</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">University of Stirling</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Dept. Computing Science and Mathematics</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Stirling,   FK9 4LA</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">UK</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+44 1786 46 7440</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:mkolberg@ieee.org">mkolberg@ieee.org</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.cs.stir.ac.uk/~mko">http://www.cs.stir.ac.uk/~mko</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Thomas C. Schmidt</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">HAW Hamburg</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Berliner Tor 7</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Hamburg,   20099</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Germany</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:schmidt@informatik.haw-hamburg.de">schmidt@informatik.haw-hamburg.de</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://inet.cpt.haw-hamburg.de/members/schmidt">http://inet.cpt.haw-hamburg.de/members/schmidt</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Matthias Waehlisch</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">link-lab &amp; FU Berlin</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Hoenower Str. 35</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Berlin  10318</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Germany</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:mw@link-lab.net">mw@link-lab.net</a></td></tr>
</table>
</body></html>
