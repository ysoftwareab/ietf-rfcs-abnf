<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>OpenPGP Web Key Directory</title>
<meta content="Werner Koch" name="author">
<meta content="
       
       
  This specification describes a service to locate OpenPGP keys by mail
  address using a Web service and the HTTPS protocol. It also provides a
  method for secure communication between the key owner and the mail
  provider to publish and revoke the public key.
 
    " name="description">
<meta content="xml2rfc 3.10.0" name="generator">
<meta content="draft-koch-openpgp-webkey-service-13" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.10.0
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.6.3
    pycountry 20.7.3
    pyflakes 2.4.0
    PyYAML 5.4.1
    requests 2.26.0
    setuptools 58.2.0
    six 1.16.0
-->
<link href="/tmp/draft-koch-openpgp-webkey-service-13-oykdw21a.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">OpenPGP Web Key Directory</td>
<td class="right">November 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Koch</td>
<td class="center">Expires 18 May 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-koch-openpgp-webkey-service-13</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2021-11" class="published">November 2021</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-05-18">18 May 2022</time></dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">W. Koch</div>
<div class="org">GnuPG e.V.</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">OpenPGP Web Key Directory</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">
  This specification describes a service to locate OpenPGP keys by mail
  address using a Web service and the HTTPS protocol. It also provides a
  method for secure communication between the key owner and the mail
  provider to publish and revoke the public key.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 5 May 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="xref">2</a>.  <a href="#name-notational-conventions" class="xref">Notational Conventions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-web-key-directory" class="xref">Web Key Directory</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1" class="keepWithNext"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-key-discovery" class="xref">Key Discovery</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-web-key-directory-update-pr" class="xref">Web Key Directory Update Protocol</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-the-submission-address" class="xref">The Submission Address</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-the-submission-mail" class="xref">The Submission Mail</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.  <a href="#name-the-confirmation-request" class="xref">The Confirmation Request</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="xref">4.4</a>.  <a href="#name-the-confirmation-response" class="xref">The Confirmation Response</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="xref">4.5</a>.  <a href="#name-policy-flags" class="xref">Policy Flags</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-well-known-uri" class="xref">Well-Known URI</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-acknowledgments" class="xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#appendix-A" class="xref">Appendix A</a>.  <a href="#name-sample-protocol-run" class="xref">Sample Protocol Run</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#appendix-A.1" class="xref">A.1</a>.  <a href="#name-sample-keys" class="xref">Sample Keys</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#appendix-A.2" class="xref">A.2</a>.  <a href="#name-sample-messages" class="xref">Sample Messages</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-B" class="xref">Appendix B</a>.  <a href="#name-changes-since-12" class="xref">Changes Since -12</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-C" class="xref"></a><a href="#name-authors-address" class="xref">Author's Address</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">
    This memo describes a method to associate OpenPGP keys with a mail
    address and how to look them up using a web service with a
    well-known URI. In addition a mail based protocol is given to allow
    a client to setup such an association and to maintain it.<a href="#section-1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="notational-conventions">
<section id="section-2">
      <h2 id="name-notational-conventions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-notational-conventions" class="section-name selfRef">Notational Conventions</a>
      </h2>
<p id="section-2-1">
    The key words "MUST", "MUST NOT",
    "REQUIRED", "SHALL", "SHALL
    NOT", "SHOULD", "SHOULD NOT",
    "RECOMMENDED", "MAY", and
    "OPTIONAL" in this document are to be interpreted as
    described in <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span>.<a href="#section-2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="web-key-directory">
<section id="section-3">
      <h2 id="name-web-key-directory">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-web-key-directory" class="section-name selfRef">Web Key Directory</a>
      </h2>
<p id="section-3-1">
    A major use case for OpenPGP is the encryption of mail. A common
    difficulty of sending encrypted mails to a new communication partner
    is to find the appropriate public key of the recipient. Unless an
    off-channel key exchange has been done, there are no easy ways to
    discover the required key. The common practice is to search the
    network of public key servers for a key matching the recipient's
    mail address. This practise bears the problem that the keyservers
    are not able to give a positive confirmation that a key actually
    belongs to the mail addresses given in the key. Further, there are
    often several keys matching a mail address and thus one needs to
    pick a key on good luck. This is clearly not a secure way to setup
    an end-to-end encryption. Even if the need for a trusted key for an
    initial mail message is relinquished, a non-authenticated key may be
    a wrong one and the actual recipient would receive a mail which she
    can't decrypt, due to the use of a wrong key.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">
    Methods to overcome this problem are<a href="#section-3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-3.1">
      
        sending an initial unencrypted message with the public key
        attached,<a href="#section-3-3.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-3.2">
      
        using the OpenPGP DANE protocol to lookup the recipients key via
        the DNS.<a href="#section-3-3.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-3-4">
    The first method has the obvious problems of not even trying to
    encrypt the initial mail, an extra mail round-trip, and problems
    with unattended key discovery.<a href="#section-3-4" class="pilcrow">¶</a></p>
<p id="section-3-5">
    The latter method works fine but requires that mail providers need
    to set up a separate DNS resolver to provide the key. The
    administration of a DNS zone is often not in the hands of small mail
    installations. Thus an update of the DNS resource records needs to
    be delegated to the ISP running the DNS service. Further, DNS
    lookups are not encrypted and missing all confidentially. Even if
    the participating MUAs are using STARTTLS to encrypt the mail
    exchange, a DNS lookup for the key unnecessarily identifies the
    local-part of the recipients mail address to any passive
    eavesdroppers.<a href="#section-3-5" class="pilcrow">¶</a></p>
<p id="section-3-6">
    This memo specified a new method for key discovery using an
    encrypted https connection.<a href="#section-3-6" class="pilcrow">¶</a></p>
<div id="key-discovery">
<section id="section-3.1">
        <h3 id="name-key-discovery">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-key-discovery" class="section-name selfRef">Key Discovery</a>
        </h3>
<p id="section-3.1-1">
      Although URIs are able to encode all kind of characters,
      straightforward implementations of a key directory may want to
      store the local-part of a mail address directly in the file
      system. This forbids the use of certain characters in the
      local-part. To allow for such an implementation method the URI
      uses an encoded form of the local-part which can be directly
      mapped to a file name.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">
      OpenPGP defines its User IDs, and thus the mail address, as UTF-8
      strings. To help with the common pattern of using capitalized
      names (e.g. "Joe.Doe@example.org") for mail
      addresses, and under the premise that almost all MTAs treat the
      local-part case-insensitive and that the domain-part is required
      to be compared case-insensitive anyway, all upper-case ASCII
      characters in a User ID are mapped to lowercase. Non-ASCII
      characters are not changed.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<p id="section-3.1-3">
      The so mapped local-part is hashed using the SHA-1 algorithm. The
      resulting 160 bit digest is encoded using the Z-Base-32 method as
      described in <span>[<a href="#RFC6189" class="xref">RFC6189</a>]</span>, section 5.1.6. The
      resulting string has a fixed length of 32 octets.<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<p id="section-3.1-4">
      There are two variants on how to form the request URI: The
      advanced and the direct method. Implementations MUST first try the
      advanced method. Only if an address for the required sub-domain
      does not exist, they SHOULD fall back to the direct method. A
      non-responding server does not mean that the fall back should be
      carried out.<a href="#section-3.1-4" class="pilcrow">¶</a></p>
<p id="section-3.1-5">
      The advanced method requires that a sub-domain with the fixed name
      <code>openpgpkey</code> is created and queried. The URI is
      constructed by concatenating these items:<a href="#section-3.1-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-6.1">
        
          The scheme <code>https://</code>,<a href="#section-3.1-6.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-6.2">
        
          the string <code>openpgpkey</code>,<a href="#section-3.1-6.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-6.3">
        
          the domain-part,<a href="#section-3.1-6.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-6.4">
        
          the string <code>/.well-known/openpgpkey/</code>,<a href="#section-3.1-6.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-6.5">
        
          the domain-part in lowercase,<a href="#section-3.1-6.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-6.6">
        
          the string <code>/hu/</code>,<a href="#section-3.1-6.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-6.7">
        
          the above constructed 32 octet string,<a href="#section-3.1-6.7" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-6.8">
        
          the unchanged local-part as a parameter with name
          <code>l</code> using proper percent escaping.<a href="#section-3.1-6.8" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.1-7">
      An example for such an advanced method URI to lookup the key for
      Joe.Doe@Example.ORG is:<a href="#section-3.1-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.1-8">
<pre>
  https://openpgpkey.example.org/.well-known/openpgpkey/
  example.org/hu/iy9q119eutrkn8s1mk4r39qejnbu3n5q?l=Joe.Doe
</pre><a href="#section-3.1-8" class="pilcrow">¶</a>
</div>
<p id="section-3.1-9">
      (line has been wrapped for rendering purposes)<a href="#section-3.1-9" class="pilcrow">¶</a></p>
<p id="section-3.1-10">
      The direct method requires no additional DNS entries and
      constructs the URI by concatenating these items:<a href="#section-3.1-10" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-11.1">
        
          The scheme <code>https://</code>,<a href="#section-3.1-11.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-11.2">
        
          the domain-part,<a href="#section-3.1-11.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-11.3">
        
          the string <code>/.well-known/openpgpkey/hu/</code>,<a href="#section-3.1-11.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-11.4">
        
          the above constructed 32 octet string,<a href="#section-3.1-11.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-11.5">
        
          the unchanged local-part as a parameter with name
          <code>l</code> using proper percent escaping.<a href="#section-3.1-11.5" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.1-12">
      Example for a direct method URI:<a href="#section-3.1-12" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.1-13">
<pre>
  https://example.org/.well-known/openpgpkey/
  hu/iy9q119eutrkn8s1mk4r39qejnbu3n5q?l=Joe.Doe
</pre><a href="#section-3.1-13" class="pilcrow">¶</a>
</div>
<p id="section-3.1-14">
      (line has been wrapped for rendering purposes)<a href="#section-3.1-14" class="pilcrow">¶</a></p>
<p id="section-3.1-15">
      Sites which do not use the advanced method but employ wildcard DNS
      for their sub-domains MUST make sure that the
      <code>openpgpkey</code> sub-domain is not subject to the
      wildcarding. This can be done by inserting an empty TXT RR for
      this sub-domain.<a href="#section-3.1-15" class="pilcrow">¶</a></p>
<p id="section-3.1-16">
      The HTTP GET method MUST return the binary representation of the
      OpenPGP key for the given mail address. The key needs to carry a
      User ID packet (<span>[<a href="#RFC4880" class="xref">RFC4880</a>]</span>) with that mail
      address. Note that the key may be revoked or expired - it is up to
      the client to handle such conditions. To ease distribution of
      revoked keys, a server may return revoked keys in addition to a
      new key. The keys are returned by a single request as concatenated
      key blocks.<a href="#section-3.1-16" class="pilcrow">¶</a></p>
<p id="section-3.1-17">
      The server MUST accept the HTTP HEAD method to allow a client to
      check for the existence of a key.<a href="#section-3.1-17" class="pilcrow">¶</a></p>
<p id="section-3.1-18">
      The server SHOULD use "application/octet-stream" as
      the Content-Type for the data but clients SHOULD also accept any
      other Content-Type. The server MUST NOT return an ASCII armored
      version of the key.<a href="#section-3.1-18" class="pilcrow">¶</a></p>
<p id="section-3.1-19">
      The server MUST serve a Policy Flags file as specified below. That
      file is even required if the Web Key Directory Update Protocol is
      not supported.<a href="#section-3.1-19" class="pilcrow">¶</a></p>
<p id="section-3.1-20">
      The benefit of the advanced method is its greater flexibility in
      setting up the Web Key Directory in environments where more than
      one mail domain is hosted. DNS SRV resource records, as used in
      earlier specifications of this protocol, posed a problem for
      implementations which have only limited access to DNS resolvers.
      The direct method is kept for backward compatibility and to allow
      providing a Web Key Directory even with without DNS change
      requirements.<a href="#section-3.1-20" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="web-key-directory-update-protocol">
<section id="section-4">
      <h2 id="name-web-key-directory-update-pr">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-web-key-directory-update-pr" class="section-name selfRef">Web Key Directory Update Protocol</a>
      </h2>
<p id="section-4-1">
    To put keys into the key directory a protocol to automate the task
    is desirable. The protocol defined here is entirely based on mail
    and the assumption that a mail provider can securely deliver mail to
    the INBOX of a user (e.g. an IMAP folder). Note that the same
    protocol may also be used for submitting keys for use with OpenPGP
    DANE.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">
    In the following sections the term "target key" denotes
    the to be published key, the term "submission key" the
    key associated with the submission-address of the mail provider. The
    string "WELLKNOWN" denotes the first part of an URI
    specific for a domain. In the examples the domain
    "example.org" is assumed, thus:<a href="#section-4-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4-3">
<pre>
  WELLKNOWN := https://openpgpkey.example.org/.well-known/
               openpgpkey/example.org
</pre><a href="#section-4-3" class="pilcrow">¶</a>
</div>
<p id="section-4-4">
    (line has been wrapped for rendering purposes)<a href="#section-4-4" class="pilcrow">¶</a></p>
<p id="section-4-5">
    or if the sub-domain <code>openpgpkey</code> does not exist
    (direct method):<a href="#section-4-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4-6">
<pre>
  WELLKNOWN := https://example.org/.well-known/openpgpkey
</pre><a href="#section-4-6" class="pilcrow">¶</a>
</div>
<p id="section-4-7">
    We assume that the user already created a key for her mail account
    alice@example.org. To install the key at her provider's Web Key
    Directory, she performs the following steps:<a href="#section-4-7" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4-8">
<li id="section-4-8.1">
          <p id="section-4-8.1.1">
      
        She retrieves a file which contains one line with the mail
        address used to submit the key to the mail provider. See below
        for the syntax of that file. For a mail address at the domain
        "example.org" the URI of the file is<a href="#section-4-8.1.1" class="pilcrow">¶</a></p>
<p id="section-4-8.1.2">
        WELLKNOWN/submission-address<a href="#section-4-8.1.2" class="pilcrow">¶</a></p>
</li>
        <li id="section-4-8.2">
      
        She sends her key using SMTP (or any other transport mechanism)
        to the provider using the submission address and key format as
        specified by PGP/MIME.<a href="#section-4-8.2" class="pilcrow">¶</a>
</li>
        <li id="section-4-8.3">
      
        The provider checks that the received key has a User ID which
        matches an account name of the provider.<a href="#section-4-8.3" class="pilcrow">¶</a>
</li>
        <li id="section-4-8.4">
      
        The provider sends an encrypted message containing a nonce and
        the fingerprint of the key to the mail account of the user. Note
        that a similar scheme is used by the well known caff(1) tool to
        help with key signing parties.<a href="#section-4-8.4" class="pilcrow">¶</a>
</li>
        <li id="section-4-8.5">
      
        A legitimate user will be able to decrypt the message because
        she created the key and is in charge of the private key. This
        step verifies that the submitted key has actually been created
        by the owner of the account.<a href="#section-4-8.5" class="pilcrow">¶</a>
</li>
        <li id="section-4-8.6">
      
        The user sends the decrypted nonce back to the submission
        address as a confirmation that the private key is owned by her
        and that the provider may now publish the key. Although
        technically not required, it is suggested that the mail to the
        provider is encrypted. The public key for this is retrieved
        using the key lookup protocol described above.<a href="#section-4-8.6" class="pilcrow">¶</a>
</li>
        <li id="section-4-8.7">
      
        The provider receives the nonce, matches it with its database of
        pending confirmations and then publishes the key. Finally the
        provider sends a mail back to the user to notify her of the
        publication of her key.<a href="#section-4-8.7" class="pilcrow">¶</a>
</li>
      </ol>
<p id="section-4-9">
    The message data structures used for the above protocol are
    specified in detail below.<a href="#section-4-9" class="pilcrow">¶</a></p>
<div id="the-submission-address">
<section id="section-4.1">
        <h3 id="name-the-submission-address">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-the-submission-address" class="section-name selfRef">The Submission Address</a>
        </h3>
<p id="section-4.1-1">
      The address of the submission file is<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1-2">
<pre>
  WELLKNOWN/submission-address
</pre><a href="#section-4.1-2" class="pilcrow">¶</a>
</div>
<p id="section-4.1-3">
      The file consists of exactly one line, terminated by a LF, or the
      sequence of CR and LF, with the full mail address to be used for
      submission of a key to the mail provider. For example the content
      of the file may be<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1-4">
<pre>
  key-submission-example.org@directory.example.org
</pre><a href="#section-4.1-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="the-submission-mail">
<section id="section-4.2">
        <h3 id="name-the-submission-mail">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-the-submission-mail" class="section-name selfRef">The Submission Mail</a>
        </h3>
<p id="section-4.2-1">
      The mail used to submit a key to the mail provider MUST comply to
      the PGP/MIME specification (<span>[<a href="#RFC3156" class="xref">RFC3156</a>]</span>,
      section 7), which states that the Content-Type must be
      "application/pgp-keys", there are no required or
      optional parameters, and the body part contains the ASCII-armored
      transferable Public Key Packets as defined in
      <span>[<a href="#RFC4880" class="xref">RFC4880</a>]</span>, section 11.1.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">
      The mail provider MUST publish a key capable of signing and
      encryption for the submission-address in the Web Key Directory or
      via DANE. The key to be published MUST be submitted using a
      PGP/MIME encrypted message (<span>[<a href="#RFC3156" class="xref">RFC3156</a>]</span>,
      section 4). The message MUST NOT be signed (because the
      authenticity of the signing key has not yet been confirmed). After
      decryption of the message at the mail provider a single
      "application/pgp-keys" part, as specified above, is
      expected.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="the-confirmation-request">
<section id="section-4.3">
        <h3 id="name-the-confirmation-request">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-the-confirmation-request" class="section-name selfRef">The Confirmation Request</a>
        </h3>
<p id="section-4.3-1">
      The mail provider sends a confirmation mail in response to a
      received key publication request. The message MUST be sent from
      the submission-address of the mail provider to the mail address
      extracted from the target key. The message needs to be a PGP/MIME
      signed message using the submission key of the provider for the
      signature. The signed message MUST have two parts:<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">
      The first part MUST have "text" as its Content-Type
      and can be used to explain the purpose of the mail. For example it
      may point to this RFC and explain on how to manually perform the
      protocol.<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<p id="section-4.3-3">
      The second part MUST have "application/vnd.gnupg.wkd"
      if the protocol version of the server is 5 or later; without a
      known protocol version or a version less than 5,
      "application/vnd.gnupg.wks" MUST be used as its
      Content-Type and carry an OpenPGP encrypted message in ASCII Armor
      format. The message MUST be encrypted to the target key and MUST
      NOT be signed. After decryption a text file in the Web Key data
      format must be yielded.<a href="#section-4.3-3" class="pilcrow">¶</a></p>
<p id="section-4.3-4">
      That data format consists of name-value pairs with one name-value
      pair per LF or CR+LF terminated line. Empty lines are allowed and
      will be ignored by the receiver. A colon is used to terminate a
      name.<a href="#section-4.3-4" class="pilcrow">¶</a></p>
<p id="section-4.3-5">
      In a confirmation request the following names MUST be send in the
      specified order:<a href="#section-4.3-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3-6.1">
        
          "type": The value must be
          "confirmation-request".<a href="#section-4.3-6.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.3-6.2">
        
          "sender": This is the mailbox the user is
          expected to sent the confirmation response to. The value must
          match the mailbox part of the "From:" address of
          this request. Exactly one address MUST be given.<a href="#section-4.3-6.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.3-6.3">
        
          "address": The value is the addr-spec part of the
          target key's mail address. The value SHOULD match the
          addr-spec part of the recipient's address. The value MUST be
          UTF-8 encoded as required for an OpenPGP User ID.<a href="#section-4.3-6.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.3-6.4">
        
          "fingerprint": The value is the fingerprint of
          the target key. The fingerprint is given in uppercase hex
          encoding without any interleaving spaces.<a href="#section-4.3-6.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.3-6.5">
        
          "nonce": The value is a string with a minimum
          length of 16 octets and a maximum length of 64 octets. The
          string must entirely be made up of random ASCII letters or
          digits. This nonce will be sent back to the mail provider as
          proof that the recipient is the legitimate owner of the
          target-key.<a href="#section-4.3-6.5" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.3-7">
      The receiver of that message is expected to verify the outer
      signature and disregard the entire message if it can't be verified
      or has not been signed by the key associated with the submission
      address.<a href="#section-4.3-7" class="pilcrow">¶</a></p>
<p id="section-4.3-8">
      After the message as been verified the receiver decrypts the
      second part of the message, checks that the
      "fingerprint" matches the target key, checks that the
      "address" matches a User ID of the target key, and
      checks the other constrains of the request format. If any
      constraint is not asserted, or the fingerprint or User ID do not
      match the target key, or there is no pending publication requests
      (i.e. a mail recently sent o the submission address), the user MAY
      be notified about this fake confirmation attempt.<a href="#section-4.3-8" class="pilcrow">¶</a></p>
<p id="section-4.3-9">
      In other cases the confirmation request is legitimate and the MUA
      shall silently send a response as described in the next section.<a href="#section-4.3-9" class="pilcrow">¶</a></p>
<p id="section-4.3-10">
      The rationale for the outer signature used with this request is to
      allow early detection of spam mails. This can be done prior to the
      decryption step and avoids asking the user to enter a passphrase
      to perform the decryption for a non-legitimate message. The use of
      a simple encrypted attachment, instead of using PGP/MIME
      encryption, is to convey the Content-Type of that attachment in
      the clear and also to prevent automatic decryption of that
      attachment by PGP/MIME aware clients. The MUA may in fact detect
      this confirmation request and present a customized dialog for
      confirming that request.<a href="#section-4.3-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="the-confirmation-response">
<section id="section-4.4">
        <h3 id="name-the-confirmation-response">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-the-confirmation-response" class="section-name selfRef">The Confirmation Response</a>
        </h3>
<p id="section-4.4-1">
      A response to a confirmation request MUST only be send in the
      positive case; there is no negative confirmation response. A mail
      service provider is expected to cancel a pending key submission
      after a suitable time without a confirmation. The mail service
      provider SHOULD NOT retry the sending of a confirmation request
      after the first request has been send successfully.<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<p id="section-4.4-2">
      The user MUST send the confirmation response from her target mail
      address to the "from" address of the confirmation
      request. The message MUST be signed and encrypted using the
      PGP/MIME Combined format (<span>[<a href="#RFC3156" class="xref">RFC3156</a>]</span>, section
      6.2). The signing key is the target key and the encryption key is
      the key associated with the provider's submission address.<a href="#section-4.4-2" class="pilcrow">¶</a></p>
<p id="section-4.4-3">
      The Content-Type used for the plaintext message MUST match the
      Content-Type of the request. The format is the same as described
      above for the Confirmation Request. The body must contain three
      name-value pairs in this order:<a href="#section-4.4-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4-4.1">
        
          "type": The value must be
          "confirmation-response".<a href="#section-4.4-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.4-4.2">
        
          "sender": The value must match the mailbox part
          of the "From:" address of this response. Exactly
          one address MUST be given.<a href="#section-4.4-4.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.4-4.3">
        
          "nonce": The value is the value of the
          "nonce" parameter from the confirmation request.<a href="#section-4.4-4.3" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="policy-flags">
<section id="section-4.5">
        <h3 id="name-policy-flags">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-policy-flags" class="section-name selfRef">Policy Flags</a>
        </h3>
<p id="section-4.5-1">
      For key generation and submission it is useful to tell the client
      about certain properties of the mail provider in advance. This can
      be done with a file at the URL<a href="#section-4.5-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.5-2">
<pre>
  WELLKNOWN/policy
</pre><a href="#section-4.5-2" class="pilcrow">¶</a>
</div>
<p id="section-4.5-3">
      A site supporting the Web Key Directory MUST serve this file; it
      is sufficient if that file has a zero length. Clients may use this
      file to check for Web Key Directory support.<a href="#section-4.5-3" class="pilcrow">¶</a></p>
<p id="section-4.5-4">
      The file contains keywords and optionally values, one per line
      with each line terminated by a LF or the sequence of CR and LF.
      Empty lines and lines starting with a "#" character
      are considered comment lines. A keyword is made up of lowercase
      letters, digits, hyphens, or dots. An underscore is allowed as a
      name space delimiters; see below. The first character must be a
      letter. Keywords which are defined to require a value are directly
      followed by a colon and then after optional white space the value.
      Clients MUST use case-insensitive matching for the keyword.<a href="#section-4.5-4" class="pilcrow">¶</a></p>
<p id="section-4.5-5">
      Currently defined keywords are:<a href="#section-4.5-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.5-6.1">
        
          "mailbox-only": The mail server provider does
          only accept keys with only a mailbox in the User ID. In
          particular User IDs with a real name in addition to the
          mailbox will be rejected as invalid.<a href="#section-4.5-6.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.5-6.2">
        
          "dane-only": The mail server provider does not
          run a Web Key Directory but only an OpenPGP DANE service. The
          Web Key Directory Update protocol is used to update the keys
          for the DANE service.<a href="#section-4.5-6.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.5-6.3">
        
          "auth-submit": The submission of the mail to the
          server is done using an authenticated connection. Thus the
          submitted key will be published immediately without any
          confirmation request.<a href="#section-4.5-6.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.5-6.4">
        
          "protocol-version": This keyword can be used to
          explicitly claim the support of a specific version of the Web
          Key Directory update protocol. This is in general not needed
          but implementations may have workarounds for providers which
          only support an old protocol version. If these providers
          update to a newer version they should add this keyword so that
          the implementation can disable the workaround. The value is an
          integer corresponding to the respective draft revision number.<a href="#section-4.5-6.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.5-6.5">
        
          "submission-address": An alternative way to
          specify the submission address. The value is the addr-spec
          part of the address to send requests to this server. If this
          keyword is used in addition to the
          <code>submission-address</code> file, both MUST have the
          same value.<a href="#section-4.5-6.5" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.5-7">
      More keywords will be defined in updates to this I-D. There is no
      registry except for this document. For experimental use of new
      features or for provider specific settings, keywords MUST be
      prefixed with a domain name and an underscore.<a href="#section-4.5-7" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-5">
      <h2 id="name-security-considerations">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-5-1">
    The use of SHA-1 for the mapping of the local-part to a fixed string
    is not a security feature but merely used to map the local-part to a
    fixed-sized string made from a well defined set of characters. It is
    not intended to conceal information about a mail address.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">
    The domain name part of the mail address is not part of the hash to
    avoid problems with internationalized domain names. Instead a
    separate URL is required for each domain name.<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">
    To make it a bit harder to test for published keys, the server
    responsible to serve the WELLKNOWN directory SHOULD NOT create an
    index file for that directory or any sub-directory.<a href="#section-5-3" class="pilcrow">¶</a></p>
<p id="section-5-4">
    The mail provider MUST make sure to publish a key in a way that only
    the mail address belonging to the requested user is part of the User
    ID packets included in the returned key. Other User ID packets and
    their associated binding signatures MUST be removed before
    publication. Confirmation requests MUST only be send for such to be
    published User ID. It is further recommended that a client filters a
    received key or a key send for a publication requests so that only
    the specific User ID with the mail address of the provider is
    imported or send.<a href="#section-5-4" class="pilcrow">¶</a></p>
<p id="section-5-5">
    A client MUST NOT accept a HTTP authentication challenge (HTTP code
    401) because the information in the Web Key Directory is public and
    needs no authentication. Allowing an authentication challenge has
    the problem to easily confuse a user with a password prompt and
    tricking him into falsely entering the passphrase used to protect
    his private key or to login to his mail provider.<a href="#section-5-5" class="pilcrow">¶</a></p>
<p id="section-5-6">
    The use of DNS SRV records as specified in former revisions of this
    document reduces the certainty that a mail address belongs to a
    domain. For example an attacker may change the target to a host in a
    sub-domain under their control and thus gain full control over all
    keys.<a href="#section-5-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-6">
      <h2 id="name-iana-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<div id="well-known-uri">
<section id="section-6.1">
        <h3 id="name-well-known-uri">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-well-known-uri" class="section-name selfRef">Well-Known URI</a>
        </h3>
<p id="section-6.1-1">
      IANA is requested to assign a well-known URI in the
      "Well-Known URIs" registry as defined by
      <span>[<a href="#RFC5785" class="xref">RFC5785</a>]</span>:<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">
      URI suffix: openpgpkey<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<p id="section-6.1-3">
      Change controller: IETF<a href="#section-6.1-3" class="pilcrow">¶</a></p>
<p id="section-6.1-4">
      Specification document: This<a href="#section-6.1-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="acknowledgments">
<section id="section-7">
      <h2 id="name-acknowledgments">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="section-7-1">
    The author would like to acknowledge the help of the individuals who
    kindly voiced their opinions on the GnuPG mailing lists, in
    particular, the help of Bernhard Reiter and Guilhem Moulin.<a href="#section-7-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-8">
      <h2 id="name-normative-references">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
      </h2>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
      <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">http://www.rfc-editor.org/rfc/rfc2119.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3156">[RFC3156]</dt>
      <dd>
<span class="refAuthor">Elkins, M.</span>, <span class="refAuthor">Del Torto, D.</span>, <span class="refAuthor">Levien, R.</span>, and <span class="refAuthor">T. Roessler</span>, <span class="refTitle">"MIME Security with OpenPGP"</span>, <span class="seriesInfo">RFC 3156</span>, <time datetime="2001-08" class="refDate">August 2001</time>, <span>&lt;<a href="http://www.rfc-editor.org/rfc/rfc3156.txt">http://www.rfc-editor.org/rfc/rfc3156.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4880">[RFC4880]</dt>
      <dd>
<span class="refAuthor">Callas, J.</span>, <span class="refAuthor">Donnerhacke, L.</span>, <span class="refAuthor">Finney, H.</span>, <span class="refAuthor">Shaw, D.</span>, and <span class="refAuthor">R. Thayer</span>, <span class="refTitle">"OpenPGP Message Format"</span>, <span class="seriesInfo">RFC 4880</span>, <time datetime="2007-11" class="refDate">November 2007</time>, <span>&lt;<a href="http://www.rfc-editor.org/rfc/rfc4880.txt">http://www.rfc-editor.org/rfc/rfc4880.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5785">[RFC5785]</dt>
      <dd>
<span class="refAuthor">Nottingham, M.</span> and <span class="refAuthor">E. Hammer-Lahav</span>, <span class="refTitle">"Defining Well-Known Uniform Resource Identifiers (URIs)"</span>, <span class="seriesInfo">RFC 5785</span>, <span class="seriesInfo">DOI 10.17487/RFC5785</span>, <time datetime="2010-04" class="refDate">April 2010</time>, <span>&lt;<a href="http://www.rfc-editor.org/info/rfc5785">http://www.rfc-editor.org/info/rfc5785</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6189">[RFC6189]</dt>
    <dd>
<span class="refAuthor">Zimmermann, P.</span>, <span class="refAuthor">Johnston, A., Ed.</span>, and <span class="refAuthor">J. Callas</span>, <span class="refTitle">"ZRTP: Media Path Key Agreement for Unicast Secure RTP"</span>, <span class="seriesInfo">RFC 6189</span>, <span class="seriesInfo">DOI 10.17487/RFC6189</span>, <time datetime="2011-04" class="refDate">April 2011</time>, <span>&lt;<a href="http://www.rfc-editor.org/info/rfc6189">http://www.rfc-editor.org/info/rfc6189</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<div id="sample-protocol-run">
<section id="appendix-A">
      <h2 id="name-sample-protocol-run">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-sample-protocol-run" class="section-name selfRef">Sample Protocol Run</a>
      </h2>
<p id="appendix-A-1">
    The following non-normative example can be used by implementors as
    guidance.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<p id="appendix-A-2">
    Note that GnuPG version 2.1.12 supports the key discovery described
    in version -00 of this document (auto-key-locate method
    "wkd"). Version 2.1.16 can run the protocol described
    in this document but is also able to run the protocol version
    specified by -01. For backward compatibility this example uses the
    Content-Type as required for versions of this protocol prior to -04;
    if the client knows that the server support -04
    "vnd.gnupg.wkd" should be used.<a href="#appendix-A-2" class="pilcrow">¶</a></p>
<div id="sample-keys">
<section id="appendix-A.1">
        <h3 id="name-sample-keys">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-sample-keys" class="section-name selfRef">Sample Keys</a>
        </h3>
<p id="appendix-A.1-1">
      This is the provider's submission key:<a href="#appendix-A.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.1-2">
<pre>
  -----BEGIN PGP PRIVATE KEY BLOCK-----

  lFgEV/TAohYJKwYBBAHaRw8BAQdAB/k9YQfSTI8qQqqK1KimH/BsvzsowWItSQPT
  FP+fOC4AAP46uJ3Snno3Vy+kORye3rf0VvWvuz82voEQLxG6WpfHhREEtBprZXkt
  c3VibWlzc2lvbkBleGFtcGxlLm5ldIh5BBMWCAAhBQJX9MCiAhsDBQsJCAcCBhUI
  CQoLAgQWAgMBAh4BAheAAAoJEKhtNooW0cqEWMUA/0e9XaeptszWC9ZvPg8INL6a
  BvRqPBYGU7PGmuXsxBovAQDyckOykG0UAfHVyN1w4gSK/biMcnqVr857i8/HuvjW
  C5xdBFf0wKISCisGAQQBl1UBBQEBB0Apvaoe4MtSEJ1fpds/4DFl2kXXBpnVji/s
  Wg9btdthNQMBCAcAAP9FJX99T1LEJzBnvBBnc6bimnT6/1OKM9RdO4R0/uVP6BFL
  iGEEGBYIAAkFAlf0wKICGwwACgkQqG02ihbRyoTlGwD9FBr92osjL7HkhhZZ7Z2D
  My3b9zpoZeMjvPg5YPqpdKMA/jhZoHuZCRMBYf7YRFb8aXtuyetDFZYrkjnum+OG
  HFAD
  =Hnwd
  -----END PGP PRIVATE KEY BLOCK-----
</pre><a href="#appendix-A.1-2" class="pilcrow">¶</a>
</div>
<p id="appendix-A.1-3">
      This is the target key to be published:<a href="#appendix-A.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.1-4">
<pre>
  -----BEGIN PGP PRIVATE KEY BLOCK-----

  lFgEV2o9XRYJKwYBBAHaRw8BAQdAZ8zkuQDL9x7rcvvoo6s3iEF1j88Dknd9nZhL
  nTEoBRkAAP94nCZMM4WY2IORXfM6phLGSz3RsHvs/vA1Opaus4+R3BKJtBtwYXRy
  aWNlLmx1bXVtYmFAZXhhbXBsZS5uZXSIeQQTFggAIQUCV2o9XQIbAwULCQgHAgYV
  CAkKCwIEFgIDAQIeAQIXgAAKCRATlWNoKgINCpkNAQDFDcwJUzsxu7aJUiPdpYXj
  4uVarrXakxEE8mGFotWhLAD9GH4rqLDYIE3NKEU0s+Okt4tEIwJaV8H1NNPPPMiK
  3g2cXQRXaj2NEgorBgEEAZdVAQUBAQdAFnnmZc99TuKk5iCq9wmYZUVF2RcXN2Cs
  qAl8iGQQUWsDAQgHAAD/VN/VGmlcwGBPcLTya2hfU4t37nMcFCKdNSXjJ5DFA0AP
  PohhBBgWCAAJBQJXaj2NAhsMAAoJEBOVY2gqAg0Ky4UA/0GmVaXzXemLvv1Xw4yx
  Eaz/KfKKGc4RJ+38fyqUzw8NAQCohQ+ki3I5f84EXLZEiUiLsnVtOn1HNxvND/gW
  TiFZBA==
  =GHi7
  -----END PGP PRIVATE KEY BLOCK-----
</pre><a href="#appendix-A.1-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sample-messages">
<section id="appendix-A.2">
        <h3 id="name-sample-messages">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-sample-messages" class="section-name selfRef">Sample Messages</a>
        </h3>
<p id="appendix-A.2-1">
      The first message triggeres the publication requests.<a href="#appendix-A.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.2-2">
<pre>
  From: patrice.lumumba@example.net
  To: key-submission@example.net
  Subject: Key publishing request
  MIME-Version: 1.0
  Content-Type: multipart/encrypted;
          protocol="application/pgp-encrypted";
    boundary="=-=01-e8k41e11ob31eefa36wo=-="
  Date: Wed, 05 Oct 2016 10:15:51 +0000


  --=-=01-e8k41e11ob31eefa36wo=-=
  Content-Type: application/pgp-encrypted

  Version: 1

  --=-=01-e8k41e11ob31eefa36wo=-=
  Content-Type: application/octet-stream

  -----BEGIN PGP MESSAGE-----

  hF4DUgLY5tvmW2sSAQdAR1AcqvFpQe/fHRZbf0xcnl9Tb+AtwaX2yZnZXGELGHsw
  1/e3E0JptwM5tpRAVe71ooF8Zq4jl76ZgQKfj/SyjpLJxyoEDy2N5wTQaqW4JtML
  0ukB1vh7dIRDxBJX/LQIJC0wz8o1Q3vjcLJKFFvDb7YrerABpPIzwOAupcgIbQHj
  5m1+2WU5CL8ffyJy2h1jV2X4OnvWF1Sn6J6SVD6DfZpOPRt9TxSemJrN1LJ3lG0N
  ts8AuYmCOeC1H2r5TYyxqkC98JF8+Nvyxd/fwne8IOjK9uixkNMC5H9/ZOH0YWCb
  wBnNB4iXuym4OIPxiLkDymsVF0ww/XrODE9Y259EGmO45VFNrJAX3HFs9/PcMCVk
  n2qMyEkr8LHiXeEPun6Z54RHUPYv2cUkEZ0hhSJ+rtBxkc/5D/cAScCEXRKFSKEF
  jLJAvLK/u/ga5DAzVai+vh6b6Bq+YVPaD9GWMhWj4CgR90p9LULi6S/Hzwhv9Wzf
  8fJoJOaDjyvRDgr09jYLWamxkS9NWxqwy6MXJvxwbNdd5XtqiW4Y4o0Ll1hDJhxR
  ljn/XvotXKwhKN+4QGhIXDVt4Dl4XxS5ptWfVTau8W8DYqDsU2obEcfsirZv53M1
  Q9FCD8CD9+dkBt8VAJekCWVhEltcRHxlrznbk2jxm93xSD2o6gZ5X0VSaSUXyEhm
  J+8F3gyTHGgbq/TgyjFoockWh5EtGgAFuWvmPJCF5PO/UaNeoKwgwSJBu6oTXkHx
  R4nvvMRcj5UgTsKpZ79NiDQukbjG5ScNT5TCUiiZsBXBqBx3fD61EH6cAuh4P3Kr
  iM7PY4fwAHo890Dx+Qlt
  =WIhx
  -----END PGP MESSAGE-----

  --=-=01-e8k41e11ob31eefa36wo=-=--
</pre><a href="#appendix-A.2-2" class="pilcrow">¶</a>
</div>
<p id="appendix-A.2-3">
      The server decrypts this message to<a href="#appendix-A.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.2-4">
<pre>
  Content-Type: application/pgp-keys

  -----BEGIN PGP PUBLIC KEY BLOCK-----

  mDMEV2o9XRYJKwYBBAHaRw8BAQdAZ8zkuQDL9x7rcvvoo6s3iEF1j88Dknd9nZhL
  nTEoBRm0G3BhdHJpY2UubHVtdW1iYUBleGFtcGxlLm5ldIh5BBMWCAAhBQJXaj1d
  AhsDBQsJCAcCBhUICQoLAgQWAgMBAh4BAheAAAoJEBOVY2gqAg0KmQ0BAMUNzAlT
  OzG7tolSI92lhePi5VqutdqTEQTyYYWi1aEsAP0YfiuosNggTc0oRTSz46S3i0Qj
  AlpXwfU00888yIreDbg4BFdqPY0SCisGAQQBl1UBBQEBB0AWeeZlz31O4qTmIKr3
  CZhlRUXZFxc3YKyoCXyIZBBRawMBCAeIYQQYFggACQUCV2o9jQIbDAAKCRATlWNo
  KgINCsuFAP9BplWl813pi779V8OMsRGs/ynyihnOESft/H8qlM8PDQEAqIUPpIty
  OX/OBFy2RIlIi7J1bTp9RzcbzQ/4Fk4hWQQ=
  =qRfF
  -----END PGP PUBLIC KEY BLOCK-----
</pre><a href="#appendix-A.2-4" class="pilcrow">¶</a>
</div>
<p id="appendix-A.2-5">
      and returns this confirmation request<a href="#appendix-A.2-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.2-6">
<pre>
  From: key-submission@example.net
  To: patrice.lumumba@example.net
  Subject: Confirm your key publication
  MIME-Version: 1.0
  Content-Type: multipart/encrypted;
    protocol="application/pgp-encrypted";
    boundary="=-=01-wrzqued738dfx4x97u7y=-="
  Date: Wed, 05 Oct 2016 10:16:57 +0000


  --=-=01-wrzqued738dfx4x97u7y=-=
  Content-Type: application/pgp-encrypted

  Version: 1

  --=-=01-wrzqued738dfx4x97u7y=-=
  Content-Type: application/octet-stream

  -----BEGIN PGP MESSAGE-----

  hF4DkYWHjk/NdMASAQdAluQeqhECpU2T0zEyBAEbFzhLkpubN160wjkFCrtUc0Mw
  FwYgM2fp9cvTMdJ/xjkvmAcIEOT4AY/hn1yFQ4z0KG0gCkSac+8mkDylnPdxlXYw
  0sBSAXlbqpVA7eUpFuU2Zs10zbIXxlwe6osR5wUIJut/RCOsYQmfvxC55x8mUX5/
  zgTnNzlMzye5ws4pTgAeQm2x0Yv018L8IZgY5KxwJLBzlss0wLZ45ZcS80hR11Fx
  NCow1fKF8lMnOJxagTEOih807nctz8vT5bR1gx0d7N3LM+th8nAg9/6Ghf1XTpLo
  MzwGW0FtOG7Dg1Uxbw2bjaOuRBeh6IIpmNAw1pmIfnNu7PpoRydU5w1K/R8MT06z
  MKdJ7IW5mVGes9EGnG3e4mjuILvNaZhfYy+a73IhDSaPm3oqdl1Qx7tbNg6lGjn6
  KStCYAcPGPp3m7aWkfsPGThOVRhEXqaFFywfwSVEj1pdIRjDFA==
  =Cdjh
  -----END PGP MESSAGE-----

  --=-=01-wrzqued738dfx4x97u7y=-=--
</pre><a href="#appendix-A.2-6" class="pilcrow">¶</a>
</div>
<p id="appendix-A.2-7">
      The client decrypts the attachment as<a href="#appendix-A.2-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.2-8">
<pre>
  Content-Type: application/vnd.gnupg.wks
  Content-Transfer-Encoding: 8bit

  type: confirmation-request
  sender: key-submission@example.net
  address: patrice.lumumba@example.net
  fingerprint: B21DEAB4F875FB3DA42F1D1D139563682A020D0A
  nonce: f5pscz57zj6fk11wekk8gx4cmrb659a7
</pre><a href="#appendix-A.2-8" class="pilcrow">¶</a>
</div>
<p id="appendix-A.2-9">
      creates this response<a href="#appendix-A.2-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.2-10">
<pre>
  Content-Type: application/vnd.gnupg.wks
  Content-Transfer-Encoding: 8bit

  type: confirmation-response
  sender: key-submission@example.net
  address: patrice.lumumba@example.net
  nonce: f5pscz57zj6fk11wekk8gx4cmrb659a7
</pre><a href="#appendix-A.2-10" class="pilcrow">¶</a>
</div>
<p id="appendix-A.2-11">
      and sends it encrypted to the server<a href="#appendix-A.2-11" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.2-12">
<pre>
  From: patrice.lumumba@example.net
  To: key-submission@example.net
  Subject: Key publication confirmation
  MIME-Version: 1.0
  Content-Type: multipart/encrypted;
    protocol="application/pgp-encrypted";
    boundary="=-=01-iacqg4og4pqz11a5cg1o=-="
  Date: Wed, 05 Oct 2016 10:18:52 +0000


  --=-=01-iacqg4og4pqz11a5cg1o=-=
  Content-Type: application/pgp-encrypted

  Version: 1

  --=-=01-iacqg4og4pqz11a5cg1o=-=
  Content-Type: application/octet-stream

  -----BEGIN PGP MESSAGE-----

  hF4DUgLY5tvmW2sSAQdAnB1C3PMjS4AsGU0qaCqBdWQO5i6blWEyZrEsY+JZY1Qw
  ooNq7zdVWOHhL9LPGAALAgoL3Qfz+dN2u5QamSQ/LJ2c8M0XipNs3lqlNH63yQN1
  0sAmAc3W8xkwul+rf6OLK/gMi6WzM4fnUhd4D1LJGIJoNUN0l3636C7ecOt2lkMl
  5bVAYg/SyMT3ymyfQnvtiem2T5DSnPsS1g6n6QNXWvkqvX9yGxNsNDJEHTuGJB8k
  OJoRlfWQTEo6pgA89febWl1EdeM1pPLstQ2uZE8NPjXoY1nMxAlu+iPYsR41/4sg
  dqwOv5BPLh/GIat8hh9SPWCA9iKlgSQ/EIv5DpjQogEzpriT55dkgfvSVYIAcOdO
  ShZ91YKkcZffevdY72omqTk10a1SUXehPooIlRFmroDsi3VDaRKrUIo=
  =7uve
  -----END PGP MESSAGE-----

  --=-=01-iacqg4og4pqz11a5cg1o=-=--
</pre><a href="#appendix-A.2-12" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="changes-since--12">
<section id="appendix-B">
      <h2 id="name-changes-since-12">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-changes-since-12" class="section-name selfRef">Changes Since -12</a>
      </h2>
<ul class="normal">
<li class="normal" id="appendix-B-1.1">
      
        Clarification on when to use the fall back to the direct method.<a href="#appendix-B-1.1" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-address">
<a href="#name-authors-address" class="section-name selfRef">Author's Address</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Werner Koch</span></div>
<div dir="auto" class="left"><span class="org">GnuPG e.V.</span></div>
<div dir="auto" class="left"><span class="street-address">Rochusstr. 44</span></div>
<div dir="auto" class="left"><span class="locality">40479 Duesseldorf</span></div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:wk@gnupg.org" class="email">wk@gnupg.org</a>
</div>
<div class="url">
<span>URI:</span>
<a href="https://gnupg.org/verein" class="url">https://gnupg.org/verein</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
