<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Dynamic Virtual Network Engine (DVNE) Protocol</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Dynamic Virtual Network Engine (DVNE) Protocol">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 60em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 60em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">M. Wasserman</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Painless Security</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">P. Nallur</td></tr>
<tr><td class="header">Expires: April 22, 2011</td><td class="header">Futurewei Technologies</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">October 19, 2010</td></tr>
</table></td></tr></table>
<h1><br />Dynamic Virtual Network Engine (DVNE) Protocol<br />draft-mrw-dvne-prot-00.txt</h1>

<h3>Abstract</h3>

<p>
This document describes the Dynamic Virtual Network Engine (DVNE)
protocol.  The DVNE protocol is a signaling protocol between a virtual
network node (the DVNE Client) and a configuration server (the DVNE
Mediator).  The DVNE protocol is used to authenticate the nodes in a
Virtual Network and assist them to setup and release VPN connections
directly among themselves.
      
</p>
<p>
A DVNE clients can be located anywhere in a private or public network,
directly connected or behind one or more levels of NAT. The DVNE
protocol performs client authentication, peer discovery, virtual
network address management, and provides all parameters necessary to
enable the clients setup a secure VPN connection. The protocol does
not explicitly setup the VPN connection itself. It only enables the
clients to be able to directly setup the VPN connection themselves.
       
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted  in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF).  Note that other groups may also distribute
working documents as Internet-Drafts.  The list of current
Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
This Internet-Draft will expire on April 22, 2011.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the Simplified BSD License.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Requirements Terminology<br />
<a href="#anchor2">2.</a>&nbsp;
Introduction<br />
<a href="#anchor3">3.</a>&nbsp;
Definitions<br />
<a href="#anchor4">4.</a>&nbsp;
DVNE Protocol Functional Overview<br />
<a href="#anchor5">5.</a>&nbsp;
Description of DVNE Protocol Operation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">5.1.</a>&nbsp;
Overview<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">5.2.</a>&nbsp;
Client Startup or Installation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">5.3.</a>&nbsp;
Login<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">5.4.</a>&nbsp;
Identification<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">5.5.</a>&nbsp;
Authentication<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">5.5.1.</a>&nbsp;
TLS Certificate-based authentication<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">5.5.2.</a>&nbsp;
TLS Username/Password-based Authentication<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">5.5.3.</a>&nbsp;
Fallback Authentication<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">5.6.</a>&nbsp;
DVNE Authentication<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">5.7.</a>&nbsp;
Addressing in Virtual Network<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor16">5.8.</a>&nbsp;
Connection Setup<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor17">5.9.</a>&nbsp;
VPN Connection<br />
<a href="#anchor18">6.</a>&nbsp;
Message authentication<br />
<a href="#anchor19">7.</a>&nbsp;
DVNE Protocol Details<br />
<a href="#anchor20">8.</a>&nbsp;
Security Considerations<br />
<a href="#anchor21">9.</a>&nbsp;
IANA Considerations<br />
<a href="#anchor22">10.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">11.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">11.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">11.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Requirements Terminology</h3>

<p>
The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
"SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
document are to be interpreted as described in RFC 2119
<a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
      
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Introduction</h3>

<p>
This document describes the Dynamic Virtual Network Engine (DVNE)
protocol.  The DVNE protocol is a signaling protocol between a virtual
network node (the DVNE Client) and a configuration server (the DVNE
Mediator).  The DVNE protocol is used to authenticate the nodes in a
Virtual Network and assist them to setup and release VPN connections
directly among themselves.
      
</p>
<p>
A DVNE clients can be located anywhere in a private or public network,
directly connected or behind one or more levels of NAT. The DVNE
protocol performs client authentication, peer discovery, virtual
network address management, and provides all parameters necessary to
enable the clients setup a secure VPN connection. The protocol does
not explicitly setup the VPN connection itself. It only enables the
clients to be able to directly setup the VPN connection themselves.
      
</p>
<p>
The DVNE protocol is used by the DVNE framework to setup a virtual or
overlay networks among hosts which is independent of the underlying
physical network.
      
</p>
<p>
This document provides an overview of DVNE protocol functionality,
including detailed flows, message layouts, and parameters of the DVNE
protocol.  The main functional components of the DVNE Protocol are the
DVNE Client (a node on a virtual network) and the DVNE Mediator (a
server that provides authentiction and configuration information).
An architectural framework for the DVNE protocol is described in
draft-mrw-dvne-fw-00.txt (replace with reference, when available).
      
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Definitions</h3>

<p>
        </p>
<ul class="text">
<li>
DVNE Client: Client software running on a host or a network node
(e.g., router) that communicates with the DVNE Mediator.
          
</li>
<li>
DVNE Mediator: A server that implemnets DVNE and provides
configuration information and parameters to DVNE clients.
          
</li>
<li>
DVNE Session: A secure session between a DVNE Client and DVNE
Mediator.
          
</li>
</ul><p>
      
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
DVNE Protocol Functional Overview</h3>

<p>
DVNE Protocol (DVNEP) is a signaling protocol between a DVNE Client and DVNE Mediator to essentially perform the following functions:
        </p>
<ul class="text">
<li>
Authentication of clients
          
</li>
<li>
Peer discovery (locate the peer)
          
</li>
<li>
Address assignment to the DVNE client
          
</li>
<li>
Provide all parameters necessary for the two endpoints to setup a
secure VPN connection.
          
</li>
</ul><p>
      
</p>
<p>
DVNEP transparently supports all types of NAT traversals for the end points. DVNEP does not directly setup a secure VPN connection between the end points. It does provide all parameters necessary for the end points so that they can setup the VPN connection directly. The main advantage of this approach is that all existing methods of VPN connection setup can be supported without changes.
      
</p>
<p>
The DVNE Client software runs on a host machine and is responsible for communicating with the DVNE Mediator. Among other functions, the DVNE Client software performs the following generic functions:
        </p>
<ul class="text">
<li>
Client startup or installation. Upon client startup, the client should be able to reach one or more DVNE Mediator.
          
</li>
<li>
Client cache to store data provided by the Mediator
          
</li>
</ul><p>
      
</p>
<p>
The following is a list functions described in this document:
        </p>
<ul class="text">
<li>
Client identification:To uniquely identify a client in a specific domain. A domain represents a specific virtual network or overlay network.
          
</li>
<li>
Client authentication:In the first phase, the clients are authenticated using username/password mechanism.
        
</li>
<li>
Client Location:The clients can be located behind any type of multiple
NAT traversals
          
<ul class="text">
<li>
Use standards compliant protocols like STUN, TURN and ICE to identify and locate a client behind one or more NATs.
            
</li>
</ul>
        
</li>
<li>
Addressing:Each domain or virtual network in DVNE has its own independent addressing. Each client is provided with an address in the private address space in the virtual network as long as it is connected to the DVNE network. The following are supported as a part of addressing functions:
          
<ul class="text">
<li>
Private address space in the virtual network 
            
</li>
<li>
Static address or dynamic address via the DHCP server (NOT supported in phase 1)
	    
</li>
</ul>
          
</li>
<li>
Secure session between the client and the DVNE Mediator:Using secure credentials a session is established between a client and the DVNE Mediator. All the communication is encrypted and standard security algorithms are supported.
          
</li>
<li>
Peer discovery:The DVNE Mediator assists a client in locating and discovering a desired client in the same virtual network.
            
<ul class="text">
<li>
Dynamic translation of client id to end points:used for determining the destination end point location or a next-hop determination
              
</li>
<li>
Provide a list of Virtual Network members to every client
              
</li>
</ul>
          
</li>
<li>
Connection setup and release requests
            
<ul class="text">
<li>
The relay of the client transport addresses and other information
between the clients.
              
</li>
<li>
If the clients request to establish a manual IPSEC connection, for
example, then provide the security parameters (e.g., keys, SPI) to the
clients.
              
</li>
</ul>
          
</li>
</ul><p>
      
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Description of DVNE Protocol Operation</h3>

<p>
This section describes the operation of the DVNE protocol at a 
conceptual level.
      
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Overview</h3>

<p>
An example topology view of the DVNE and its components are shown in
the Figure below. This is used to illustrate various functions like
login, connection setup etc., in subsequent sections.
        
</p>
<p>
FIGURE TBD: Figure 1.  DVNE and its components
        
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Client Startup or Installation</h3>

<p>
The DVNE Client software upon installation should at a minimum be
programmed to reach one of the DVNE Mediators. The DVNE Mediator
server name or IP address/Port# must be made available in the Client
Cache. In future, after successful connection to this DVNE Mediator,
the list of all other possible DVNE Mediators that this client can
reach is downloaded to the client.
        
</p>
<p>
The DVNE Mediator is expected to be globally addressable via public
internet. In future, we can add the capability of DVNE Mediators also
being behind firewalls or NAT.
        
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3"></a><h3>5.3.&nbsp;
Login</h3>

<p>
All clients of DVNE are required to first login to one of the DVNE
Mediators. After successful login a session is open between the DVNE
client and the mediator. The session between DVNE client and mediator
is kept active as long as the client wants to have a connection to any
other client in the virtual network. The process of login involves the
following:
          </p>
<ul class="text">
<li>
Identify and authenticate the clients.The client and the mediator
perform mutual authentication
            
</li>
<li>
Determine the virtual network that the client belongs to
            
</li>
<li>
Provide the client with the latest list of VN Members that are
‘online’ in the virtual network
            
</li>
<li>
Provide the client with Virtual Network global data (e.g., TURN, STUN
server addresses)
            
</li>
</ul><p>
        
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.4"></a><h3>5.4.&nbsp;
Identification</h3>

<p>
The client identity in DVNE uniquely identifies both the client and
the virtual network that the client belongs to. The client identity is
explicitly provided by the client during login to the DVNE. The client
id for example can take the form client-id@vn-id.dvne.com where
“vn-id” identifies a specific virtual network and the “client-id”
identifies a specific client. Both the client-id and vn-id are a
combination of alphanumeric characters. 
        
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.5"></a><h3>5.5.&nbsp;
Authentication</h3>

<p>
Each client is authenticated by the DVNE mediator. In addition, the
clients initially use TLS protocol to communicate with the DVNE
Mediator and only upon successful authentication at TLS level, a
secure session is established between the client and the DVNE
Mediator. The primary goal of the TLS protocol is to provide privacy
and data integrity between two communicating applications.  The TLS
protocol is layered on top of a reliable transport protocol
TCP/IP. All DVNE Protocol messages are encrypted by the TLS layer.
        
</p>
<p>
The following types of client authentication are supported:
        
</p>
<p>
          </p>
<ul class="text">
<li>
Client certificates (e.g., X.509) using PKI infrastructure (third
party trust relationship). Self signed certificates are also
supported, but the clients are authenticated via the username/password
mechanism.
            
</li>
<li>
Username/Password mechanism using Secure Remote Password (SRP-6) via
TLS protocol
            
</li>
</ul><p>
        
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.5.1"></a><h3>5.5.1.&nbsp;
TLS Certificate-based authentication</h3>

<p>
The message flow for client certificate based authentication is shown
below. This is the same standard TLS message flow without any changes.
          
</p>
<p>
FIGURE TBD:  Figure 2.  TLS certificate authentication
          
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.5.2"></a><h3>5.5.2.&nbsp;
TLS Username/Password-based Authentication</h3>

<p>
The client can also initiate username/password based authentication
via TLS protocol using Secure Remote Password mechanism (SRP-6). The
client supplies the username parameter in the client hello
message. This indicates to the MEDIATOR that the client wishes to
perform username password authentication. The message flow for SRP
mechanism is shown below.  Both sides exchange the SRP parameters
(random numbers, generator g etc.,) using the TLS:server key
exchange and TLS:client key exchange messages. The two sides then
derive the same secret key K and encrypt the TLS:finished messages
using this secret key. If the other side can decrypt the
TLS:finished successfully, it implies that both sides are in
possession of the same secret. For details of SRP mechanism, please
refer to RFC 5054.
          
</p>
<p>
FIGURE TBD: Figure 3.  TLS username/password authentication
          
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.5.3"></a><h3>5.5.3.&nbsp;
Fallback Authentication</h3>

<p>
It is also possible that the MEDIATOR always initiate a client
certificate based authentication and use username/password as a
fallback mechanism. The MEDIATOR will reject the first TLS attempt
with an error code of unknown-psk-identity and in such cases, the
client can re-initiate a new TLS session using the username/password
mechanism. A typical message flow for this case is shown below.
          
</p>
<p>
FIGURE TBD: Figure 4.  Certificate auth failure with fallback to
username/password authentication
          
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.6"></a><h3>5.6.&nbsp;
DVNE Authentication</h3>

<p>
DVNE client authentication is performed during LOGIN. This is in
addition to the TLS authentication. The DVNE authentication is a
mutual authentication between the Client and the Mediator. This is
based on Username/password mechanism. The client password is not sent
to the Mediator. Instead, each side performs a challenge-response
method of authentication. Each side computes a response for a given
nonce and challenges the other side to the do the same by sending
the same nonce value. When the computed response and the received
response match, the authentication is deemed successful.
        
</p>
<p>
The DVNE Authentication will use the MD5 hash algorithm as follows:
          </p>
<ul class="text">
<li>
Inputs:
              
<ul class="text">
<li>
      Username/Password
                
</li>
<li>
      Nonce (16 Bytes)
                
</li>
</ul>
            
</li>
<li>
Output:
              
<ul class="text">
<li>
      Response (16 Bytes)
                
</li>
</ul>
            
</li>
<li>
Algorithms:
              
<ul class="text">
<li>
 HA1 = MD5(username:dvne authentication:password);
                
</li>
<li>
 Response = MD5(nonce:HA1);
                
</li>
</ul>
            
</li>
</ul><p>
        
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.7"></a><h3>5.7.&nbsp;
Addressing in Virtual Network</h3>

<p>
Each virtual network has an independent range of IP addresses that it
can use. This address range does not collide with addresses assigned
to other virtual networks. In future, a DVNE client can only join more
than one virtual network and hence it is suggested not to use
overlapping addresses across virtual networks.
        
</p>
<p>
The client is assigned a Virtual Network IP address by the mediator during the LOGIN phase. 
        
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.8"></a><h3>5.8.&nbsp;
Connection Setup</h3>

<p>
Once logged in, the DVNE clients can establish connections to other clients. To do this, the DVNE client has to send ‘Connection setup’ message to the Mediator. The Mediator will then perform the following functions:
          </p>
<ul class="text">
<li>
Validate the identifier of the destination client,
            
</li>
<li>
relay the transport addresses between the two clients 
            
</li>
<li>
provide manual security association parameters (e.g., session key, SPI) to both clients.  The SPI value has to be unique for a specific end node.
            
</li>
</ul><p>
        
</p>
<p>
The clients can use all these information to setup the direct VPN
connection themselves.
        
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.9"></a><h3>5.9.&nbsp;
VPN Connection</h3>

<p>
The two end clients can select the type of VPN connection they wish to setup. These connections can be typically:
          </p>
<ul class="text">
<li>
IPSEC
              
<ul class="text">
<li>
With IKE:In this case, the end hosts can use IKE protocol to
authenticate security credentials and then setup an IPSEC connection.
                
</li>
<li>
Manual IPSEC:Setup IPSEC using manual security association parameters
provided by the mediator
                
</li>
</ul>
            
</li>
<li>
DTLS 
            
</li>
</ul><p>
        
</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Message authentication</h3>

<p>
It is possible that a client can impersonate another client in the
messages that a client sends to a mediator. For example, a Client-A
can specify a different “FROM” field in the messages. In order to
prevent this, the client should include a “msg-auth-value” field in
the first message of every transaction initiated by the client to the
mediator. The “msg-auth-value” is computed using the username/password
of the client as specified in the “FROM” field of the request message.
      
</p>
<p>
The msg-auth-value is especially useful, if in future, we have to
implement “Mediator Proxy” which then forwards all the messages to a
“mediator”.
      
</p>
<p>
The “msg-auth-value” computation will use the MD5 hash algorithm as
follows:
        </p>
<ul class="text">
<li>
Inputs:
            
<ul class="text">
<li>
Username/Password for the username specified in the “FROM” field;
              
</li>
</ul>
          
</li>
<li>
Output:
            
<ul class="text">
<li>
      msg-auth-value (16 Bytes)
              
</li>
</ul>
          
</li>
<li>
Algorithm:
            
<ul class="text">
<li>
 HA1 = MD5(username:”dvne message authentication”:password);
              
</li>
<li>
 msg-auth-value = MD5(“0123456789abcdeffedcba9876543210”:HA1);
              
</li>
</ul>
          
</li>
</ul><p>
      
</p>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
DVNE Protocol Details</h3>

<p>
TBD.
      
</p>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Security Considerations</h3>

<p>
TBD.
      
</p>
<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
IANA Considerations</h3>

<p>
TBD.
      
</p>
<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
Acknowledgements</h3>

<p>
This document was written using the xml2rfc tool described in RFC 2629
<a class='info' href='#RFC2629'>[RFC2629]<span> (</span><span class='info'>Rose, M., &ldquo;Writing I-Ds and RFCs using XML,&rdquo; June&nbsp;1999.</span><span>)</span></a>.
      
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>11.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>11.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2629">[RFC2629]</a></td>
<td class="author-text"><a href="mailto:mrose@not.invisible.net">Rose, M.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2629">Writing I-Ds and RFCs using XML</a>,&rdquo; RFC&nbsp;2629, June&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2629.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2629.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2629.xml">XML</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Margaret Wasserman</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Painless Security</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">356 Abbott Street</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">North Andover, MA  01845</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 781 405 7464</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:mrw@painless-security.com">mrw@painless-security.com</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.painless-security.com">http://www.painless-security.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Padmanabha Nallur</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Futurewei Technologies</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">3255-4, Scott Blvd</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Santa Clara, California</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:pnallur@huawei.com">pnallur@huawei.com</a></td></tr>
</table>
</body></html>
