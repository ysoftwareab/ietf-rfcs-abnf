<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Common Interface to Cryptographic Modules (CICM) </title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Requirements Language">
<link href="#rfc.section.1.2" rel="Chapter" title="1.2 Definition Language">
<link href="#rfc.section.1.3" rel="Chapter" title="1.3 IDL Language Mapping Conventions">
<link href="#rfc.section.1.4" rel="Chapter" title="1.4 Endianness">
<link href="#rfc.section.1.5" rel="Chapter" title="1.5 Blocking and Non-blocking Calls">
<link href="#rfc.section.1.6" rel="Chapter" title="1.6 Assumptions">
<link href="#rfc.section.1.7" rel="Chapter" title="1.7 Specification Organization">
<link href="#rfc.section.2" rel="Chapter" title="2 Fundamental Definitions">
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 Namespace CICM">
<link href="#rfc.section.2.2" rel="Chapter" title="2.2 Fundamental Types">
<link href="#rfc.section.2.2.1" rel="Chapter" title="2.2.1 General Types">
<link href="#rfc.section.2.2.2" rel="Chapter" title="2.2.2 Identifiers">
<link href="#rfc.section.2.2.3" rel="Chapter" title="2.2.3 Status Codes">
<link href="#rfc.section.2.2.4" rel="Chapter" title="2.2.4 Classifications">
<link href="#rfc.section.2.2.5" rel="Chapter" title="2.2.5 Ports">
<link href="#rfc.section.2.3" rel="Chapter" title="2.3 Fundamental Interfaces">
<link href="#rfc.section.2.3.1" rel="Chapter" title="2.3.1 Interface CICM::CICMRoot">
<link href="#rfc.section.2.3.1.1" rel="Chapter" title="2.3.1.1 CICM::CICMRoot Methods">
<link href="#rfc.section.2.3.2" rel="Chapter" title="2.3.2 Interface CICM::CryptoModule">
<link href="#rfc.section.2.3.2.1" rel="Chapter" title="2.3.2.1 CICM::CryptoModule Attributes">
<link href="#rfc.section.2.3.2.2" rel="Chapter" title="2.3.2.2 CICM::CryptoModule Methods">
<link href="#rfc.section.2.3.3" rel="Chapter" title="2.3.3 Interface CICM::Iterator">
<link href="#rfc.section.2.3.3.1" rel="Chapter" title="2.3.3.1 CICM::Iterator Types and Constants">
<link href="#rfc.section.2.3.3.2" rel="Chapter" title="2.3.3.2 CICM::Iterator Methods">
<link href="#rfc.section.3" rel="Chapter" title="3 Module Management">
<link href="#rfc.section.4" rel="Chapter" title="4 Key Management">
<link href="#rfc.section.5" rel="Chapter" title="5 Channel Management">
<link href="#rfc.section.6" rel="Chapter" title="6 Conformance">
<link href="#rfc.section.6.1" rel="Chapter" title="6.1 Implementation Conformance Statement Contents">
<link href="#rfc.section.6.2" rel="Chapter" title="6.2 Implementation Data Specification Contents">
<link href="#rfc.section.6.3" rel="Chapter" title="6.3 Generating Unique Identifiers">
<link href="#rfc.section.6.4" rel="Chapter" title="6.4 Conformance Verification">
<link href="#rfc.section.7" rel="Chapter" title="7 Extensions">
<link href="#rfc.section.7.1" rel="Chapter" title="7.1 Extending an Interface">
<link href="#rfc.section.7.2" rel="Chapter" title="7.2 Extending Codes">
<link href="#rfc.section.7.2.1" rel="Chapter" title="7.2.1 Extending Status Codes">
<link href="#rfc.section.7.2.2" rel="Chapter" title="7.2.2 Extending Module/Channel Event Codes">
<link href="#rfc.section.7.2.3" rel="Chapter" title="7.2.3 Extending Constants">
<link href="#rfc.section.8" rel="Chapter" title="8 IANA Considerations">
<link href="#rfc.section.9" rel="Chapter" title="9 Security Considerations">
<link href="#rfc.section.9.1" rel="Chapter" title="9.1 Unauthorized Usage">
<link href="#rfc.section.9.2" rel="Chapter" title="9.2 Inappropriate Usage">
<link href="#rfc.section.10" rel="Chapter" title="10 Acknowledgments">
<link href="#rfc.references" rel="Chapter" title="11 References">
<link href="#rfc.references.1" rel="Chapter" title="11.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="11.2 Informative References">
<link href="#rfc.appendix.Appendix%20A" rel="Chapter" title="Appendix A Status Codes">
<link href="#rfc.appendix.Appendix%20B" rel="Chapter" title="Appendix B IDL Definitions">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="This memo presents a programming interface to standardize the way software programs manage cryptographic modules and use cryptographic services offered by modules. Although a number of interfaces for commercial environments have been standardized and are in use, this is the first generic cryptographic interface to be developed that supports cryptographic modules separating two security domains and is thus ideal for the high assurance environment. The interface has been designed to also allow less demanding environments to take advantage of its features." />
  <meta name="description" content="This memo presents a programming interface to standardize the way software programs manage cryptographic modules and use cryptographic services offered by modules. Although a number of interfaces for commercial environments have been standardized and are in use, this is the first generic cryptographic interface to be developed that supports cryptographic modules separating two security domains and is thus ideal for the high assurance environment. The interface has been designed to also allow less demanding environments to take advantage of its features." />
  <meta name="keywords" content="" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Internet Engineering Task Force</td>
<td class="right">D. Lanz</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">L. Novikov</td>
</tr>
<tr>
<td class="left">Intended status: Informational</td>
<td class="right">MITRE</td>
</tr>
<tr>
<td class="left">Expires: January 26, 2012</td>
<td class="right">July 25, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Common Interface to Cryptographic Modules (CICM) <br />
  <span class="filename">draft-lanz-cicm-03</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>This memo presents a programming interface to standardize the way software programs manage cryptographic modules and use cryptographic services offered by modules. Although a number of interfaces for commercial environments have been standardized and are in use, this is the first generic cryptographic interface to be developed that supports cryptographic modules separating two security domains and is thus ideal for the high assurance environment. The interface has been designed to also allow less demanding environments to take advantage of its features.</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on January 26, 2012.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>1.1.   <a href="#rfc.section.1.1">Requirements Language</a>
</li>
<li>1.2.   <a href="#rfc.section.1.2">Definition Language</a>
</li>
<li>1.3.   <a href="#rfc.section.1.3">IDL Language Mapping Conventions</a>
</li>
<li>1.4.   <a href="#rfc.section.1.4">Endianness</a>
</li>
<li>1.5.   <a href="#rfc.section.1.5">Blocking and Non-blocking Calls</a>
</li>
<li>1.6.   <a href="#rfc.section.1.6">Assumptions</a>
</li>
<li>1.7.   <a href="#rfc.section.1.7">Specification Organization</a>
</li>
<li>2.   <a href="#rfc.section.2">Fundamental Definitions</a>
</li>
<li>2.1.   <a href="#rfc.section.2.1">Namespace CICM</a>
</li>
<li>2.2.   <a href="#rfc.section.2.2">Fundamental Types</a>
</li>
<li>2.2.1.   <a href="#rfc.section.2.2.1">General Types</a>
</li>
<li>2.2.2.   <a href="#rfc.section.2.2.2">Identifiers</a>
</li>
<li>2.2.3.   <a href="#rfc.section.2.2.3">Status Codes</a>
</li>
<li>2.2.4.   <a href="#rfc.section.2.2.4">Classifications</a>
</li>
<li>2.2.5.   <a href="#rfc.section.2.2.5">Ports</a>
</li>
<li>2.3.   <a href="#rfc.section.2.3">Fundamental Interfaces</a>
</li>
<li>2.3.1.   <a href="#rfc.section.2.3.1">Interface CICM::CICMRoot</a>
</li>
<li>2.3.1.1.   <a href="#rfc.section.2.3.1.1">CICM::CICMRoot Methods</a>
</li>
<li>2.3.2.   <a href="#rfc.section.2.3.2">Interface CICM::CryptoModule</a>
</li>
<li>2.3.2.1.   <a href="#rfc.section.2.3.2.1">CICM::CryptoModule Attributes</a>
</li>
<li>2.3.2.2.   <a href="#rfc.section.2.3.2.2">CICM::CryptoModule Methods</a>
</li>
<li>2.3.3.   <a href="#rfc.section.2.3.3">Interface CICM::Iterator</a>
</li>
<li>2.3.3.1.   <a href="#rfc.section.2.3.3.1">CICM::Iterator Types and Constants</a>
</li>
<li>2.3.3.2.   <a href="#rfc.section.2.3.3.2">CICM::Iterator Methods</a>
</li>
<li>3.   <a href="#rfc.section.3">Module Management</a>
</li>
<li>4.   <a href="#rfc.section.4">Key Management</a>
</li>
<li>5.   <a href="#rfc.section.5">Channel Management</a>
</li>
<li>6.   <a href="#rfc.section.6">Conformance</a>
</li>
<li>6.1.   <a href="#rfc.section.6.1">Implementation Conformance Statement Contents</a>
</li>
<li>6.2.   <a href="#rfc.section.6.2">Implementation Data Specification Contents</a>
</li>
<li>6.3.   <a href="#rfc.section.6.3">Generating Unique Identifiers</a>
</li>
<li>6.4.   <a href="#rfc.section.6.4">Conformance Verification</a>
</li>
<li>7.   <a href="#rfc.section.7">Extensions</a>
</li>
<li>7.1.   <a href="#rfc.section.7.1">Extending an Interface</a>
</li>
<li>7.2.   <a href="#rfc.section.7.2">Extending Codes</a>
</li>
<li>7.2.1.   <a href="#rfc.section.7.2.1">Extending Status Codes</a>
</li>
<li>7.2.2.   <a href="#rfc.section.7.2.2">Extending Module/Channel Event Codes</a>
</li>
<li>7.2.3.   <a href="#rfc.section.7.2.3">Extending Constants</a>
</li>
<li>8.   <a href="#rfc.section.8">IANA Considerations</a>
</li>
<li>9.   <a href="#rfc.section.9">Security Considerations</a>
</li>
<li>9.1.   <a href="#rfc.section.9.1">Unauthorized Usage</a>
</li>
<li>9.2.   <a href="#rfc.section.9.2">Inappropriate Usage</a>
</li>
<li>10.   <a href="#rfc.section.10">Acknowledgments</a>
</li>
<li>11.   <a href="#rfc.references">References</a>
</li>
<li>11.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>11.2.   <a href="#rfc.references.2">Informative References</a>
</li>
<li>Appendix A.   <a href="#rfc.appendix.Appendix%20A">Status Codes</a>
</li>
<li>Appendix B.   <a href="#rfc.appendix.Appendix%20B">IDL Definitions</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> Introduction</h1>
<p id="rfc.section.1.p.1">This document defines the high-level entities of a programming interface for high assurance cryptographic modules called Common Interface to Cryptographic Modules (CICM) based on the logical model outlined in <a href="#CICM-LM">[CICM-LM]</a>.</p>
<h1 id="rfc.section.1.1">
<a href="#rfc.section.1.1">1.1.</a> Requirements Language</h1>
<p id="rfc.section.1.1.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">[RFC2119]</a>.</p>
<h1 id="rfc.section.1.2">
<a href="#rfc.section.1.2">1.2.</a> Definition Language</h1>
<p id="rfc.section.1.2.p.1">CICM is defined using Interface Definition Language (IDL) <a href="#IDL">[IDL]</a>, a specification language that describes a software interface in a language-neutral way.  IDL compilers can generate a functionally equivalent CICM interface binding for common programming languages. The use of IDL in CICM is not intended to either prescribe or preclude a particular communications protocol such as General Inter-ORB Protocol (GIOP) <a href="#CORBA">[CORBA]</a> between programs in different address	spaces or on different devices.</p>
<p id="rfc.section.1.2.p.2">Additionally, CICM does not use the IDL exception mechanism to report errors.  See <a href="#extend">Extensions</a> for more information.</p>
<h1 id="rfc.section.1.3">
<a href="#rfc.section.1.3">1.3.</a> IDL Language Mapping Conventions</h1>
<p id="rfc.section.1.3.p.1">Memory responsibilities and calling conventions MUST follow the appropriate IDL language mapping conventions.</p>
<h1 id="rfc.section.1.4">
<a href="#rfc.section.1.4">1.4.</a> Endianness</h1>
<p id="rfc.section.1.4.p.1">Endianness is the byte ordering used to represent data stored in a computer or transmitted between computers. A big-endian ordering of bytes is REQUIRED by CICM.</p>
<h1 id="rfc.section.1.5">
<a href="#rfc.section.1.5">1.5.</a> Blocking and Non-blocking Calls</h1>
<p id="rfc.section.1.5.p.1">All CICM methods block (wait for the operation defined by the method) to complete before returning, unless they are explicitly defined as non-blocking. For example, the CICM::Encrypt::Stream::encrypt method (defined in <a href="#CICM-CM">[CICM-CM]</a>) blocks when sending data on a stream to be encrypted, while its sibling CICM::Encrypt::Stream::encrypt_non_blocking is identified not only in its name as non-blocking, but also clearly within the documentation for the method.</p>
<h1 id="rfc.section.1.6">
<a href="#rfc.section.1.6">1.6.</a> Assumptions</h1>
<p id="rfc.section.1.6.p.1">The following assumptions were made in the development of CICM: </p>

<ul>
<li>Library implementers may implement part of the specification (refer to the sections on <a href="#conform">Conformance</a> and <a href="#extend">Extensions</a>, for the normative rules).</li>
<li>A client program initiates cryptographic transformations with a cryptographic module via the CICM API. Multiple client programs may concurrently access a single module from a single security domain, but CICM provides no support for controlling access to a module by two or more client programs.</li>
<li>A module may be implemented as hardware, firmware, or software component, or any combination thereof.</li>
<li>Although CICM is intended for use in high assurance environments, its use is not precluded in less demanding environments.</li>
<li>One or more entities between the API library and the module translates CICM commands or interfaces to module-specific commands or interfaces.</li>
<li>CICM makes no provision in the design of the API to guarantee the confidentiality, integrity, or authenticity of commands and data between a client program calling the API and a module.  However, such protections can be applied in the library or runtime system software.</li>
<li>Specialized hardware (e.g., hardware access tokens, key fill devices, trusted displays) independent of a module may require host (and thus API) interaction or may require no host interaction.</li>
</ul>
<h1 id="rfc.section.1.7">
<a href="#rfc.section.1.7">1.7.</a> Specification Organization</h1>
<p id="rfc.section.1.7.p.1">The CICM specification is composed of five documents.  </p>

<ul>
<li>
<a href="#CICM-LM">[CICM-LM]</a> provides an informative (non-normative) underlying logical model and terminology,</li>
<li>this document defines the basic types and rules for conformance (<a href="#conform">Section 6</a>) and extension (<a href="#extend">Section 7</a>),</li>
<li>
<a href="#CICM-MM">[CICM-MM]</a> defines module management capabilities,</li>
<li>
<a href="#CICM-KM">[CICM-KM]</a> defines key management capabilities, and</li>
<li>
<a href="#CICM-CM">[CICM-CM]</a> defines channel management capabilities.</li>
</ul>

<p> </p>
<p id="rfc.section.1.7.p.2">The informative material is for informational purposes; it assists the reader in the understanding and use of the specification but does not contain provisions required for conformance.</p>
<p id="rfc.section.1.7.p.3">The namespaces, interfaces, datatypes, methods, and attributes that comprise the specification are presented in a prescriptive manner.  For each category, each namespace is described followed by the interfaces contained within it. The datatype, method, and attribute definitions then follow each interface definition.</p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> Fundamental Definitions</h1>
<h1 id="rfc.section.2.1">
<a href="#rfc.section.2.1">2.1.</a> Namespace CICM</h1>
<div id="#rfc.figure.1"></div>
<p>Namespace CICM</p>
<pre>module CICM</pre>
<p>CICM is the top-level namespace for all CICM interfaces and sub-namespaces.</p>
<h1 id="rfc.section.2.2">
<a href="#rfc.section.2.2">2.2.</a> Fundamental Types</h1>
<h1 id="rfc.section.2.2.1">
<a href="#rfc.section.2.2.1">2.2.1.</a> General Types</h1>
<div id="#rfc.figure.2"></div>
<p>Type CICM::UInt32</p>
<pre>typedef unsigned long UInt32;</pre>
<p>Unsigned 32-bit integer.</p>
<div id="#rfc.figure.3"></div>
<p>Type CICM::Bool</p>
<pre>typedef boolean Bool;</pre>
<p>Boolean value.</p>
<div id="#rfc.figure.4"></div>
<p>Type CICM::CharString</p>
<pre>typedef string CharString;</pre>
<p>Sequence of characters.</p>
<div id="#rfc.figure.5"></div>
<p>Type CICM::Buffer</p>
<pre>typedef sequence&lt;octet&gt; Buffer;</pre>
<p>Byte sequence, encapsulating the sequence of bytes, the length of the sequence, and the amount of allocated space.</p>
<h1 id="rfc.section.2.2.2">
<a href="#rfc.section.2.2.2">2.2.2.</a> Identifiers</h1>
<div id="#rfc.figure.6"></div>
<p>Type CICM::ModuleId</p>
<pre>typedef CICM::CharString ModuleId;</pre>
<p>Unique cryptographic module identifier.</p>
<div id="#rfc.figure.7"></div>
<p>Type CICM::TransId</p>
<pre>typedef CICM::UInt32 TransId;</pre>
<p>Unique transaction identifier for read/write operations.</p>
<h1 id="rfc.section.2.2.3">
<a href="#rfc.section.2.2.3">2.2.3.</a> Status Codes</h1>
<div id="#rfc.figure.8"></div>
<p>Type CICM::Status</p>
<pre>typedef CICM::UInt32 Status;</pre>
<p>Status of an executed method.</p>
<p id="rfc.section.2.2.3.p.1">See also: </p>

<ul class="empty"><li>
<a href="#status-codes">Appendix Appendix A</a> for a full list of status codes.</li></ul>

<p> </p>
<h1 id="rfc.section.2.2.4">
<a href="#rfc.section.2.2.4">2.2.4.</a> Classifications</h1>
<div id="#rfc.figure.9"></div>
<p>Type CICM::Classification</p>
<pre>typedef CICM::UInt32 Classification;</pre>
<p>Classification levels.</p>
<div id="#rfc.figure.10"></div>
<p>Constant CICM::C_LEVEL_UNCLASSIFIED</p>
<pre>const CICM::Classification
C_LEVEL_UNCLASSIFIED = 0x0000602F;</pre>
<p>Value indicating unclassified classification level.</p>
<div id="#rfc.figure.11"></div>
<p>Constant CICM::C_LEVEL_CONFIDENTIAL</p>
<pre>const CICM::Classification
C_LEVEL_CONFIDENTIAL = 0x00006029;</pre>
<p>Value indicating confidential classification level.</p>
<div id="#rfc.figure.12"></div>
<p>Constant CICM::C_LEVEL_SECRET</p>
<pre>const CICM::Classification
C_LEVEL_SECRET = 0x0000602A;</pre>
<p>Value indicating secret classification level.</p>
<div id="#rfc.figure.13"></div>
<p>Constant CICM::C_LEVEL_TOP_SECRET</p>
<pre>const CICM::Classification
C_LEVEL_TOP_SECRET = 0x0000602C;</pre>
<p>Value indicating top secret classification level.</p>
<h1 id="rfc.section.2.2.5">
<a href="#rfc.section.2.2.5">2.2.5.</a> Ports</h1>
<div id="#rfc.figure.14"></div>
<p>Type CICM::RemotePort</p>
<pre>typedef CICM::UInt32 RemotePort;</pre>
<p>Remote module port.</p>
<div id="#rfc.figure.15"></div>
<p>Constant CICM::IMPLICIT_REMOTE_PORT</p>
<pre>const CICM::RemotePort
IMPLICIT_REMOTE_PORT = 0xFFFFFF99;</pre>
<p>Value that indicates that the remote port value is implicit.</p>
<div id="#rfc.figure.16"></div>
<p>Type CICM::LocalPort</p>
<pre>typedef CICM::UInt32 LocalPort;</pre>
<p>Local module port.</p>
<div id="#rfc.figure.17"></div>
<p>Constant CICM::IMPLICIT_LOCAL_PORT</p>
<pre>const CICM::LocalPort
IMPLICIT_LOCAL_PORT = 0xFFFFFFBB;</pre>
<p>Value that indicates that the local port value is implicit.</p>
<div id="#rfc.figure.18"></div>
<p>Constant CICM::FILL_INTERFACE_PORT</p>
<pre>const CICM::LocalPort
FILL_INTERFACE_PORT = 0xFFFFFFEE;</pre>
<p>Value that represents the port on which keys are filled or exported.</p>
<h1 id="rfc.section.2.3">
<a href="#rfc.section.2.3">2.3.</a> Fundamental Interfaces</h1>
<h1 id="rfc.section.2.3.1">
<a href="#rfc.section.2.3.1">2.3.1.</a> Interface CICM::CICMRoot</h1>
<div id="#rfc.figure.19"></div>
<p>Interface CICM::CICMRoot</p>
<pre>interface CICMRoot</pre>
<p>CICMRoot serves as the entry point to the CICM API and enables a specific cryptographic module of potentially many modules available to a host to be selected.</p>
<h1 id="rfc.section.2.3.1.1">
<a href="#rfc.section.2.3.1.1">2.3.1.1.</a> CICM::CICMRoot Methods</h1>
<div id="#rfc.figure.20"></div>
<p>Method CICM::CICMRoot::get_module_by_id()</p>
<pre>CICM::Status get_module_by_id(
in  CICM::ModuleId id,
out CICM::CryptoModule crypto_module_ref
);</pre>
<p>Returns a reference to the module with the given module unique identifier.</p>
<p id="rfc.section.2.3.1.1.p.1">Parameters: </p>

<ul class="empty">
<li>[in] id Unique identifier for the module.</li>
<li>[out] crypto_module_ref Module associated with the given identifier.</li>
</ul>

<p> </p>
<p id="rfc.section.2.3.1.1.p.2">Returns: </p>

<ul class="empty"><li>S_OK, S_GENERAL_ERROR, S_NON_FUNCTIONAL, S_OPERATION_FAILED, S_HOST_RESOURCES, S_INVALID_STATE, S_ALARM_STATE, S_MODULE_NOT_AVAILABLE, S_TIMEOUT, S_MODULE_DOES_NOT_EXIST</li></ul>

<p> </p>
<div id="#rfc.figure.21"></div>
<p>Example (C++):</p>
<pre>CICM::Status sCode;
CICM::CryptoModule device;

// Instantiate the root object.
CICM::CICMRoot cicm = new CICM::CICMRoot();

// Retrieve a reference to the module
// corresponding to the specified module identifier.
const string MODULE_ID = "CM10293495867";

// If found, [device] refers to the specified
crypto module. sCode = cicm.get_module_by_id(MODULE_ID, &amp;device);</pre>
<h1 id="rfc.section.2.3.2">
<a href="#rfc.section.2.3.2">2.3.2.</a> Interface CICM::CryptoModule</h1>
<div id="#rfc.figure.22"></div>
<p>Interface CICM::CryptoModule</p>
<pre>interface CryptoModule</pre>
<p>CICM::CryptoModule contains attributes that provide access to module-specific information and attributes that enable access to module managers, through which nearly all interface functionality is accessed.</p>
<div id="#rfc.figure.23"></div>
<pre>            CryptoModule
                 |
                 |-&gt; SymKeyManager
                 |-&gt; AsymKeyManager
                 |-&gt; KeyDatabase
ChannelManager &lt;-|
                 |-&gt; EventManager
  LoginManager &lt;-|
   UserManager &lt;-|
  TokenManager &lt;-|
                 |-&gt; PackageManager
                 |-&gt; TestManager
                 |-&gt; LogManager
</pre>
<p></p>

<p>Figure 1. Interface Relationship Diagram for CryptoModule</p>
<h1 id="rfc.section.2.3.2.1">
<a href="#rfc.section.2.3.2.1">2.3.2.1.</a> CICM::CryptoModule Attributes</h1>
<div id="#rfc.figure.24"></div>
<p>Attribute CICM::CryptoModule::module_id</p>
<pre>readonly attribute CICM::ModuleId module_id;</pre>
<p>Unique identifier for this module.</p>
<div id="#rfc.figure.25"></div>
<p>Attribute CICM::CryptoModule::manufacturer</p>
<pre>readonly attribute CICM::CharString manufacturer;</pre>
<p>Name of cryptographic module manufacturer.</p>
<div id="#rfc.figure.26"></div>
<p>Attribute CICM::CryptoModule::model</p>
<pre>readonly attribute CICM::CharString model;</pre>
<p>Model of cryptographic module.</p>
<div id="#rfc.figure.27"></div>
<p>Attribute CICM::CryptoModule::serial_number</p>
<pre>readonly attribute CICM::CharString serial_number;</pre>
<p>Serial number of cryptographic module.</p>
<div id="#rfc.figure.28"></div>
<p>Attribute CICM::CryptoModule::module_version</p>
<pre>readonly attribute CICM::CharString module_version;</pre>
<p>Hardware version of cryptographic module.</p>
<div id="#rfc.figure.29"></div>
<p>Attribute CICM::CryptoModule::software_version</p>
<pre>readonly attribute CICM::CharString software_version;</pre>
<p>Currently executing software/firmware version number.</p>
<div id="#rfc.figure.30"></div>
<p>Attribute CICM::CryptoModule::driver_version</p>
<pre>readonly attribute CICM::CharString driver_version;</pre>
<p>CICM module-specific abstraction layer version number.</p>
<div id="#rfc.figure.31"></div>
<p>Attribute CICM::CryptoModule::library_version</p>
<pre>readonly attribute CICM::CharString library_version;</pre>
<p>CICM library version number.</p>
<div id="#rfc.figure.32"></div>
<p>Attribute CICM::CryptoModule::role</p>
<pre>readonly attribute CICM::RoleId role;</pre>
<p>Current security role in which module is operating.</p>
<div id="#rfc.figure.33"></div>
<p>Attribute CICM::CryptoModule::date_time</p>
<pre>attribute CICM::CharString date_time;</pre>
<p>Current date/time. Intended for use only with module services that require coarse-grained time (e.g., timestamp on a log), not for time-of-day encryption.</p>
<div id="#rfc.figure.34"></div>
<p>Attribute CICM::CryptoModule::sym_key_manager</p>
<pre>readonly attribute CICM::SymKeyManager sym_key_manager;</pre>
<p>Reference to CICM::SymKeyManager.</p>
<div id="#rfc.figure.35"></div>
<p>Attribute CICM::CryptoModule::asym_key_manager</p>
<pre>readonly attribute CICM::AsymKeyManager asym_key_manager;</pre>
<p>Reference to CICM::AsymKeyManager.</p>
<div id="#rfc.figure.36"></div>
<p>Attribute CICM::CryptoModule::key_database</p>
<pre>readonly attribute CICM::KeyDatabase key_database;</pre>
<p>Reference to CICM::KeyDatabase.</p>
<div id="#rfc.figure.37"></div>
<p>Attribute CICM::CryptoModule::channel_manager</p>
<pre>readonly attribute CICM::ChannelManager channel_manager;</pre>
<p>Reference to CICM::ChannelManager.</p>
<div id="#rfc.figure.38"></div>
<p>Attribute CICM::CryptoModule::event_manager</p>
<pre>readonly attribute CICM::ModuleEventManager event_manager;</pre>
<p>Reference to CICM::ModuleEventManager.</p>
<div id="#rfc.figure.39"></div>
<p>Attribute CICM::CryptoModule::package_manager</p>
<pre>readonly attribute CICM::PackageManager package_manager;</pre>
<p>Reference to CICM::PackageManager.</p>
<div id="#rfc.figure.40"></div>
<p>Attribute CICM::CryptoModule::token_manager</p>
<pre>readonly attribute CICM::TokenManager token_manager;</pre>
<p>Reference to CICM::TokenManager.</p>
<div id="#rfc.figure.41"></div>
<p>Attribute CICM::CryptoModule::user_manager</p>
<pre>readonly attribute CICM::UserManager user_manager;</pre>
<p>Reference to CICM::UserManager.</p>
<div id="#rfc.figure.42"></div>
<p>Attribute CICM::CryptoModule::login_manager</p>
<pre>readonly attribute CICM::LoginManager login_manager;</pre>
<p>Reference to CICM::LoginManager.</p>
<div id="#rfc.figure.43"></div>
<p>Attribute CICM::CryptoModule::test_manager</p>
<pre>readonly attribute CICM::TestManager test_manager;</pre>
<p>Reference to CICM::TestManager.</p>
<div id="#rfc.figure.44"></div>
<p>Attribute CICM::CryptoModule::log_manager</p>
<pre>readonly attribute CICM::LogManager log_manager;</pre>
<p>Reference to CICM::LogManager.</p>
<h1 id="rfc.section.2.3.2.2">
<a href="#rfc.section.2.3.2.2">2.3.2.2.</a> CICM::CryptoModule Methods</h1>
<div id="#rfc.figure.45"></div>
<p>Method CICM::CryptoModule::configure_fill_interface()</p>
<pre>CICM::Status configure_fill_interface(
in  CICM::Buffer interface_parameters,
in  CICM::LocalPort fill_port
);</pre>
<p>Configure a module key fill interface.</p>
<p id="rfc.section.2.3.2.2.p.1">Remarks: </p>

<ul class="empty">
<li>This method accepts an opaque buffer containing a module-specific data structure specifying fill port configuration parameters.</li>
<li>The format of the interface parameters value is not defined by CICM. The Implementation Conformance Statement (see <a href="#conform">Section 6</a>) MUST reference a standard format or define a module developer-specific format implemented by the module for this datatype.</li>
</ul>

<p> </p>
<p id="rfc.section.2.3.2.2.p.2">Parameters: </p>

<ul class="empty">
<li>[in] interface_parameters Opaque buffer containing the fill interface configuration parameters.</li>
<li>[in] fill_port Fill port to configure.</li>
</ul>

<p> </p>
<p id="rfc.section.2.3.2.2.p.3">Returns: </p>

<ul class="empty"><li>S_OK, S_GENERAL_ERROR, S_NON_FUNCTIONAL, S_OPERATION_FAILED, S_POLICY_VIOLATION, S_MODULE_RESOURCES, S_HOST_RESOURCES, S_INVALID_STATE, S_ALARM_STATE, S_MODULE_NOT_AVAILABLE, S_TIMEOUT, S_NOT_AUTHENTICATED, S_NOT_AUTHORIZED, S_INVALID_DATA_BUFFER, S_KEY_FILL_DEVICE_NOT_CONNECTED, S_LOCAL_PORT_INVALID, S_LOCAL_PORT_INCOMPATIBLE, S_LOCAL_PORT_IN_USE, S_TOKEN_NOT_PRESENT, S_TOKEN_ADMIN_NOT_PRESENT</li></ul>

<p> </p>
<div id="#rfc.figure.46"></div>
<p>Method CICM::CryptoModule::reset()</p>
<pre>CICM::Status reset();</pre>
<p>Perform a software-initiated reset on the module.</p>
<p id="rfc.section.2.3.2.2.p.4">Remarks: </p>

<ul class="empty"><li>This method attempts to restart a module in the event of a module failure or in the event a module has entered an alarm state. A CICM::S_OK status denotes that the command was accepted by the module or runtime system, not that any specific action has been initiated as a result of the reset request.</li></ul>

<p> </p>
<p id="rfc.section.2.3.2.2.p.5">Returns: </p>

<ul class="empty"><li>S_OK, S_GENERAL_ERROR, S_NON_FUNCTIONAL, S_OPERATION_FAILED, S_POLICY_VIOLATION, S_MODULE_RESOURCES, S_HOST_RESOURCES, S_INVALID_STATE, S_ALARM_STATE, S_MODULE_NOT_AVAILABLE, S_TIMEOUT, S_NOT_AUTHENTICATED, S_NOT_AUTHORIZED, S_TOKEN_NOT_PRESENT, S_TOKEN_ADMIN_NOT_PRESENT</li></ul>

<p> </p>
<h1 id="rfc.section.2.3.3">
<a href="#rfc.section.2.3.3">2.3.3.</a> Interface CICM::Iterator</h1>
<div id="#rfc.figure.47"></div>
<p>Interface CICM::Iterator</p>
<pre>interface Iterator</pre>
<p>Interface from which other iterators are inherited.</p>
<p id="rfc.section.2.3.3.p.1">Remarks: </p>

<ul class="empty"><li>The specification does not define any specific order in which iterated elements are returned.</li></ul>

<p> </p>
<h1 id="rfc.section.2.3.3.1">
<a href="#rfc.section.2.3.3.1">2.3.3.1.</a> CICM::Iterator Types and Constants</h1>
<div id="#rfc.figure.48"></div>
<p>Type CICM::Iterator::Status</p>
<pre>typedef CICM::UInt32 Status;</pre>
<p>Indicates whether or not there are more items over which to iterate.</p>
<div id="#rfc.figure.49"></div>
<p>Constant CICM::Iterator::C_ITERATOR_HAS_NEXT</p>
<pre>const CICM::Iterator::Status
  C_ITERATOR_HAS_NEXT = 0x00006031;</pre>
<p>There are more items in the list.</p>
<div id="#rfc.figure.50"></div>
<p>Constant CICM::Iterator::C_ITERATOR_NO_MORE</p>
<pre>const CICM::Iterator::Status
  C_ITERATOR_NO_MORE = 0x00006032;</pre>
<p>There are no more items in the list.</p>
<h1 id="rfc.section.2.3.3.2">
<a href="#rfc.section.2.3.3.2">2.3.3.2.</a> CICM::Iterator Methods</h1>
<div id="#rfc.figure.51"></div>
<p>Method CICM::Iterator::has_next()</p>
<pre>CICM::Status has_next(
out CICM::Iterator::Status has_next
);</pre>
<p>Used with get_next() to determine if one or more additional elements are available to be retrieved.</p>
<p id="rfc.section.2.3.3.2.p.1">Remarks: </p>

<ul class="empty"><li>For elements that have not already been processed, changes in the state of the list/database over which the iterator is being run during the lifetime of the iterator will be reflected in the results from calls to retrieve iterator elements.</li></ul>

<p> </p>
<p id="rfc.section.2.3.3.2.p.2">Parameters: </p>

<ul class="empty"><li>[out] has_next Indicates whether more elements are available to be retrieved.</li></ul>

<p> </p>
<p id="rfc.section.2.3.3.2.p.3">Returns: </p>

<ul class="empty"><li>S_OK, S_GENERAL_ERROR, S_NON_FUNCTIONAL, S_OPERATION_FAILED, S_POLICY_VIOLATION, S_MODULE_RESOURCES, S_HOST_RESOURCES, S_INVALID_STATE, S_ALARM_STATE, S_MODULE_NOT_AVAILABLE, S_TIMEOUT, S_NOT_AUTHENTICATED, S_NOT_AUTHORIZED, S_TOKEN_NOT_PRESENT, S_TOKEN_ADMIN_NOT_PRESENT</li></ul>

<p> </p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> Module Management</h1>
<p id="rfc.section.3.p.1">Module management capabilities are defined in <a href="#CICM-MM">[CICM-MM]</a>.</p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> Key Management</h1>
<p id="rfc.section.4.p.1">Key management capabilities are defined in <a href="#CICM-KM">[CICM-KM]</a>.</p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> Channel Management</h1>
<p id="rfc.section.5.p.1">Channel management capabilities are defined in <a href="#CICM-CM">[CICM-CM]</a>.</p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#conform" id="conform">Conformance</a>
</h1>
<p id="rfc.section.6.p.1">Many modules will not require the implementation of the full specification to support a module's capabilities. Thus, the CICM conformance model was developed to be flexible. This model does not normatively prescribe the implementation of specific functional subsets of the specification.  Instead, CICM outlines a normative Implementation Conformance Statement (ICS) and associated documentation that MUST be supplied with any conformant implementation.</p>
<p id="rfc.section.6.p.2">The ICS guides the developer of a library for a specific module to record the implementation state and presence of extensions for each section of the specification. The gradations of the implementation state are relatively coarse: "implemented," "partially implemented," or "not implemented." Extensions are identified as interface extensions or status code extensions, and are recorded as "existing" or "not-existing." An analysis of the resulting matrix enables a software developer using the API or an architect designing a system integrating with a specific cryptographic module to quickly determine if a developer's library will meet user requirements. Those specification sections marked "partially implemented" or for which extensions are indicated may require additional analysis to determine what elements have been extended or are not implemented, and the resulting repercussions on the system utilizing the library.</p>
<p id="rfc.section.6.p.3">CICM interfaces are organized into three major sections: module management, channel management, and key management. Each section is partitioned differently into logical subsections in the ICS. The module management section is partitioned into subsections by individual module managers. The channel management section is partitioned into subsections by channel type. The key management section is partitioned into subsections by the type of key and class of operation performed on the key.</p>
<p id="rfc.section.6.p.4">An Implementation Data Specification (IDS) based on the ICS also is required. For each implemented interface containing an opaque data parameter (module-specific or infrastructure-specific parameter not described in detail in the specification), the IDS requires a detailed specification of the data structure for each parameter.</p>
<p id="rfc.section.6.p.5">An implementation conforms to the specification if it meets the following conditions: </p>

<ul>
<li>A CICM library implementation MUST include only the subset of interfaces corresponding to the functionality supported by the module for which it was designed. The implementation MUST implement the full subset of interfaces implemented by the module. A library MUST implement a non-zero set of interfaces corresponding to functionality implemented by the module that reasonably maps back to the CICM interface and is appropriate for the system in use.</li>
<li>A CICM library MUST minimally implement the CICMRoot and CryptoModule interfaces, both fundamental parts of the specification without which no other interfaces can be implemented. The CryptoModule interfaces MUST implement minimally one manager, which must be at least "partially" implemented (e.g., simply implementing non-functional inherited or dependent interfaces is non-conformant).</li>
<li>A CICM library MUST be made available with a corresponding ICS.</li>
<li>A CICM library MUST be made available with an IDS corresponding to its ICS. The format of any module-specific data structures defined as opaque data elements in the specification with which a client program using CICM must have knowledge MUST be documented by the module developer and MUST be made available as the IDS. If the implementation implements no interfaces with opaque data parameters and includes no extensions, the IDS MUST state that the implementation requires no IDS entries.</li>
<li>A CICM interface is only conformant if it also implements any inherited and all dependent interfaces (e.g., the interface Encrypt::WithSignConduit defined in <a href="#CICM-CM">[CICM-CM]</a> requires that symmetric keys and asymmetric keysets defined in <a href="#CICM-KM">[CICM-KM]</a> also be implemented). The exception is the CICM::ChannelManager interface, which only requires the implementation of one or more of its inherited interfaces.</li>
<li>Any interfaces that are not implemented precisely as specified in the normative portion of the specification MUST be identified as extensions to the specification.</li>
<li>Extensions to the CICM specification MUST NOT contradict nor cause the non-conformance of functionality defined in the normative specification, MUST follow the requirements and guidelines of the normative specification, and MUST be clearly described in supporting documentation.</li>
<li>Memory responsibilities and calling conventions MUST follow the appropriate IDL language mapping conventions.</li>
</ul>
<h1 id="rfc.section.6.1">
<a href="#rfc.section.6.1">6.1.</a> Implementation Conformance Statement Contents</h1>
<p id="rfc.section.6.1.p.1">A library implementation conforming to the CICM specification MUST be accompanied by an ICS. The ICS is generated by the module developer or implementer of a CICM-conformant library for a specific cryptographic module configuration (including any associated hardware/firmware/software) and MUST contain the following information: </p>

<ul>
<li>Details regarding the product and version of the specification to which it conforms, including: <ul>
<li>CICM version number</li>
<li>Product manufacturer/name, version number (hardware, firmware, and software)</li>
<li>Configuration details, including patch state</li>
<li>Date of claim</li>
</ul>
</li>
<li>Capability Support Matrix, listing the major sections of the specification and their implementation state ("I"=implemented, "P"=partially implemented, and "N"=not implemented), and the presence of any extensions</li>
<li>List of developer-defined extensions to specification.  Extensions MUST be divided into four classes: Interface extensions, status code extensions, event listener extensions, and constant extensions. Extensions MUST be documented as specified in the IDS.</li>
<li>List of unique identifiers for all supported cryptographic algorithms, organized by class of algorithm, and all supported key agreement protocols; each algorithm/protocol unique identifier MUST be in CICM-specified format (refer to the section <a href="#gen-uniq-id">Generating Unique Identifiers</a>).</li>
</ul>
<p id="rfc.section.6.1.p.2">The following represents a sample CICM ICS.</p>
<div id="#rfc.figure.52"></div>
<pre>
Date of claim: January 1, 2011                              ExampleCorp


              CICMv1 Implementation Conformance Statement


1.  Product Claiming Conformance

   ExampleCorp ABC-XYZ, Version 1.2.3

2.  Capability Support Matrix

2.1  Module Management

   Columns
   1: Implementation State
   2: Interface Extensions                  | Impl   | Iface  | Codes
   3: Status Code Extensions                | State  | Exts   | Exts
   -----------------------------------------|--------|--------|--------
   EventManager                             |   I    |   N    |   N
   -----------------------------------------|--------|--------|--------
   TokenManager                             |   P    |   N    |   N
   -----------------------------------------|--------|--------|--------
   LoginManager                             |   I    |   N    |   N
   -----------------------------------------|--------|--------|--------
   UserManager                              |   P    |   I    |   I
   -----------------------------------------|--------|--------|--------
   TestManager                              |   N    |   N    |   N
   -----------------------------------------|--------|--------|--------
   LogManager                               |   N    |   N    |   N
   -----------------------------------------|--------|--------|--------
   PackageManager                           |   P    |   N    |   N

2.2  Key Management

   Columns
   1: Implementation State
   2: Interface Extensions                  | Impl   | Iface  | Codes
   3: Status Code Extensions                | State  | Exts   | Exts
   -----------------------------------------|--------|--------|--------
   AsymKeyManager                           |   N    |   N    |   N
   -----------------------------------------|--------|--------|--------
   SymKeyManager                            |   P    |   N    |   N
   -----------------------------------------|--------|--------|--------
   KeyDatabase                              |   N    |   N    |   N
   -----------------------------------------|--------|--------|--------
   KeyProtocol                              |   N    |   N    |   N

2.3  Channel Management

   Columns
   1: Implementation State
   2: Interface Extensions                  | Impl   | Iface  | Codes
   3: Status Code Extensions                | State  | Exts   | Exts
   -----------------------------------------|--------|--------|--------
   EventManager                             |   N    |   N    |   N
   -----------------------------------------|--------|--------|--------
   Groups                                   |   N    |   N    |   N

2.3.1  Encrypt

   Columns
   1: Implementation State
   2: Interface Extensions                  | Impl   | Iface  | Codes
   3: Status Code Extensions                | State  | Exts   | Exts
   -----------------------------------------|--------|--------|--------
   Encrypt::Stream                          |   N    |   N    |   N
   -----------------------------------------|--------|--------|--------
   Encrypt::Controller                      |   N    |   N    |   N
   -----------------------------------------|--------|--------|--------
   Encrypt::NegotiatedController            |   N    |   N    |   N
   -----------------------------------------|--------|--------|--------
   Encrypt::Conduit                         |   N    |   N    |   N
   -----------------------------------------|--------|--------|--------
   Encrypt::NegotiatedConduit               |   N    |   N    |   N
   -----------------------------------------|--------|--------|--------
   Encrypt::WithMACConduit                  |   N    |   N    |   N
   -----------------------------------------|--------|--------|--------
   Encrypt::WithMACNegotiatedConduit        |   N    |   N    |   N
   -----------------------------------------|--------|--------|--------
   Encrypt::WithSignConduit                 |   N    |   N    |   N
   -----------------------------------------|--------|--------|--------
   Encrypt::WithSignNegotiatedConduit       |   N    |   N    |   N
   -----------------------------------------|--------|--------|--------
   Encrypt::KeyWrapConduit                  |   N    |   N    |   N

2.3.2  Encrypt with Selective Bypass

   Columns
   1: Implementation State
   2: Interface Extensions                  | Impl   | Iface  | Codes
   3: Status Code Extensions                | State  | Exts   | Exts
   -----------------------------------------|--------|--------|--------
   EncryptBypass::Stream                    |   N    |   N    |   N
   -----------------------------------------|--------|--------|--------
   EncryptBypass::Controller                |   N    |   N    |   N
   -----------------------------------------|--------|--------|--------
   EncryptBypass::NegotiatedController      |   N    |   N    |   N
   -----------------------------------------|--------|--------|--------
   EncryptBypass::Conduit                   |   N    |   N    |   N
   -----------------------------------------|--------|--------|--------
   EncryptBypass::NegotiatedConduit         |   N    |   N    |   N

2.3.3  Decrypt

   Columns
   1: Implementation State
   2: Interface Extensions                  | Impl   | Iface  | Codes
   3: Status Code Extensions                | State  | Exts   | Exts
   -----------------------------------------|--------|--------|--------
   Decrypt::Stream                          |   N    |   N    |   N
   -----------------------------------------|--------|--------|--------
   Decrypt::Controller                      |   N    |   N    |   N
   -----------------------------------------|--------|--------|--------
   Decrypt::NegotiatedController            |   N    |   N    |   N
   -----------------------------------------|--------|--------|--------
   Decrypt::Conduit                         |   N    |   N    |   N
   -----------------------------------------|--------|--------|--------
   Decrypt::NegotiatedConduit               |   N    |   N    |   N
   -----------------------------------------|--------|--------|--------
   Decrypt::WithMACConduit                  |   N    |   N    |   N
   -----------------------------------------|--------|--------|--------
   Decrypt::WithMACNegotiatedConduit        |   N    |   N    |   N
   -----------------------------------------|--------|--------|--------
   Decrypt::WithVerifyConduit               |   N    |   N    |   N
   -----------------------------------------|--------|--------|--------
   Decrypt::WithVerifyNegotiatedConduit     |   N    |   N    |   N
   -----------------------------------------|--------|--------|--------
   Decrypt::KeyUnwrapConduit                |   N    |   N    |   N

2.3.4  Decrypt with Selective Bypass

   Columns
   1: Implementation State
   2: Interface Extensions                  | Impl   | Iface  | Codes
   3: Status Code Extensions                | State  | Exts   | Exts
   -----------------------------------------|--------|--------|--------
   DecryptBypass::Stream                    |   N    |   N    |   N
   -----------------------------------------|--------|--------|--------
   DecryptBypass::Controller                |   N    |   N    |   N
   -----------------------------------------|--------|--------|--------
   DecryptBypass::NegotiatedController      |   N    |   N    |   N
   -----------------------------------------|--------|--------|--------
   DecryptBypass::Conduit                   |   N    |   N    |   N
   -----------------------------------------|--------|--------|--------
   DecryptBypass::NegotiatedConduit         |   N    |   N    |   N

2.3.5  Duplex

   Columns
   1: Implementation State
   2: Interface Extensions                  | Impl   | Iface  | Codes
   3: Status Code Extensions                | State  | Exts   | Exts
   -----------------------------------------|--------|--------|--------
   Duplex::Stream                           |   N    |   N    |   N
   -----------------------------------------|--------|--------|--------
   Duplex::Controller                       |   N    |   N    |   N
   -----------------------------------------|--------|--------|--------
   Duplex::NegotiatedController             |   N    |   N    |   N
   -----------------------------------------|--------|--------|--------
   Duplex::Conduit                          |   N    |   N    |   N
   -----------------------------------------|--------|--------|--------
   Duplex::NegotiatedConduit                |   N    |   N    |   N

2.3.6  Full Bypass (Write)

   Columns
   1: Implementation State
   2: Interface Extensions                  | Impl   | Iface  | Codes
   3: Status Code Extensions                | State  | Exts   | Exts
   -----------------------------------------|--------|--------|--------
   BypassWrite::Stream                      |   N    |   N    |   N
   -----------------------------------------|--------|--------|--------
   BypassWrite::Controller                  |   N    |   N    |   N
   -----------------------------------------|--------|--------|--------
   BypassWrite::Conduit                     |   N    |   N    |   N

2.3.7  Full Bypass (Read)

   Columns
   1: Implementation State
   2: Interface Extensions                  | Impl   | Iface  | Codes
   3: Status Code Extensions                | State  | Exts   | Exts
   -----------------------------------------|--------|--------|--------
   BypassRead::Stream                       |   N    |   N    |   N
   -----------------------------------------|--------|--------|--------
   BypassRead::Controller                   |   N    |   N    |   N
   -----------------------------------------|--------|--------|--------
   BypassRead::Conduit                      |   N    |   N    |   N

2.3.8  Emit

   Columns
   1: Implementation State
   2: Interface Extensions                  | Impl   | Iface  | Codes
   3: Status Code Extensions                | State  | Exts   | Exts
   -----------------------------------------|--------|--------|--------
   Emit::RandomController                   |   N    |   N    |   N
   -----------------------------------------|--------|--------|--------
   Emit::RandomConduit                      |   N    |   N    |   N
   -----------------------------------------|--------|--------|--------
   Emit::PseudorandomController             |   N    |   N    |   N
   -----------------------------------------|--------|--------|--------
   Emit::PseudorandomConduit                |   N    |   N    |   N
   -----------------------------------------|--------|--------|--------
   Emit::KeyStreamGenController             |   N    |   N    |   N
   -----------------------------------------|--------|--------|--------
   Emit::KeyStreamGenConduit                |   N    |   N    |   N

2.3.9  Integrity

   Columns
   1: Implementation State
   2: Interface Extensions                  | Impl   | Iface  | Codes
   3: Status Code Extensions                | State  | Exts   | Exts
   -----------------------------------------|--------|--------|--------
   Answer::HashConduit                      |   N    |   N    |   N
   -----------------------------------------|--------|--------|--------
   Answer::MACConduit                       |   N    |   N    |   N
   -----------------------------------------|--------|--------|--------
   Answer::MACVerifyConduit                 |   N    |   N    |   N
   -----------------------------------------|--------|--------|--------
   Answer::SignConduit                      |   N    |   N    |   N
   -----------------------------------------|--------|--------|--------
   Answer::VerifyHashConduit                |   N    |   N    |   N

2.3.10  Single-Domain

   Columns
   1: Implementation State
   2: Interface Extensions                  | Impl   | Iface  | Codes
   3: Status Code Extensions                | State  | Exts   | Exts
   -----------------------------------------|--------|--------|--------
   Coprocessor::EncryptConduit              |   N    |   N    |   N
   -----------------------------------------|--------|--------|--------
   Coprocessor::EncryptWithMACConduit       |   N    |   N    |   N
   -----------------------------------------|--------|--------|--------
   Coprocessor::EncryptWithSignConduit      |   N    |   N    |   N
   -----------------------------------------|--------|--------|--------
   Coprocessor::DecryptConduit              |   N    |   N    |   N
   -----------------------------------------|--------|--------|--------
   Coprocessor::DecryptWithMACConduit       |   N    |   N    |   N
   -----------------------------------------|--------|--------|--------
   Coprocessor::DecryptWithVerifyConduit    |   N    |   N    |   N

3.  Extensions

3.1.  Interface Extensions

   CICM::UserManager::enable()

   CICM::UserManager::disable()

3.2  Status Code Extensions

   CICM::S_USER_ALREADY_ENABLED

   CICM::S_USER_ALREADY_DISABLED

3.3  Module / Channel Event Listener Extensions

   None

3.4  Constant Extensions

   None

4.  Supported Algorithms

   AES128-CBC

   3DES-OFB
</pre>
<h1 id="rfc.section.6.2">
<a href="#rfc.section.6.2">6.2.</a> Implementation Data Specification Contents</h1>
<p id="rfc.section.6.2.p.1">The IDS serves as the detailed supporting documentation for the ICS. Conformance with the CICM specification requires that: </p>

<ul>
<li>Each implemented interface that accepts an opaque data object MUST reference an existing standard or document the data structure associated with that object in sufficient detail to allow an implementer to create new objects and manipulate existing objects. The exception to this requirement is those cases where a client program will NOT be allowed to manipulate the opaque data object (e.g., CICM::KeyProtocolReceiver::get_from_module defined in <a href="#CICM-KM">[CICM-KM]</a> or CICM::PackageImporter::import_segment defined in <a href="#CICM-MM">[CICM-MM]</a>).</li>
<li>Each interface extension listed in the ICS MUST be clearly described in the IDS and MUST be documented in a manner similar to the normative CICM documentation.</li>
<li>Each status code extension listed in the ICS MUST be referenced in the IDS with a corresponding description, numeric code, and a list of CICM interfaces to which the extension applies.</li>
<li>Each module or channel event listener extension listed in the ICS MUST be referenced in the IDS with corresponding description, numeric code, and data structure definition associated with the event_data parameter, if applicable.</li>
<li>Each extended constant value listed in the ICS MUST be referenced in the IDS with corresponding description and numeric code.</li>
</ul>
<p id="rfc.section.6.2.p.2">Examples of interfaces requiring an IDS entry to be conformant include: </p>

<ul>
<li>CICM::SymKeyManager::get_key_by_id defined in <a href="#CICM-KM">[CICM-KM]</a>, where the key identifier is specific to the key management system in use.</li>
<li>CICM::LogManager::retrieve defined in <a href="#CICM-MM">[CICM-MM]</a>, where the log returned from the method call will vary from module-to-module.</li>
<li>CICM::ModuleEventListener::event_occurred defined in <a href="#CICM-MM">[CICM-MM]</a>, where the event_data parameter passed to a client program as part of an event notification is system specific.</li>
</ul>
<p id="rfc.section.6.2.p.3">Note that the event listener callbacks (CICM::ModuleEventListener::event_occurred and CICM::ChannelEventListener::event_occurred) require that the event_data parameter be described for each event type implemented.</p>
<h1 id="rfc.section.6.3">
<a href="#rfc.section.6.3">6.3.</a> <a href="#gen-uniq-id" id="gen-uniq-id">Generating Unique Identifiers</a>
</h1>
<p id="rfc.section.6.3.p.1">CICM does not provide a list of algorithms with their corresponding normative unique identifiers. Instead, normative guidance is provided for generating the identifiers for the different classes of algorithms defined in the specification and for key agreement protocols. These identifiers are used by software developers when specifying algorithms or protocols as parameters to CICM methods. This identifier generation guidance is intended to promote interoperability, and encourage the use of the same identifier for algorithms among vendors.</p>
<p id="rfc.section.6.3.p.2">Three major components may be combined to form a unique algorithm identifier: an algorithm (ALGO), that may be precisely specified as an encryption algorithm (ENCRALGO), signature algorithm (SIGALGO), MAC algorithm (MACALGO), or hash algorithm (HASHALGO); a mode (MODE); and an encoding scheme (SCHEME), that may be precisely specified as an encryption scheme (ENCRSCHEME) or a signature scheme (SIGSCHEME). Note that some components above may not apply to certain algorithms. In addition, applicable modes and components need not always be specified. For encryption and signature algorithms, if a length is required, the length SHALL be appended to the algorithm without a dash ("-") delimiter.  Otherwise, components are concatenated with a dash ("-").</p>
<p id="rfc.section.6.3.p.3">Alternatively, an identifier can consist of a simple personality designation (PERSONALITY). The personality consists of a combination of parameters that comprise a logically complete crypto, and specifies a specific equipment type or configuration for which algorithm, mode, and any other parameters are implicit.  The designation may contain dashes.</p>
<p id="rfc.section.6.3.p.4">Certain algorithms may be appropriate for and thus listed under more than one algorithm class. Below are the classes of algorithms and format of the identifiers for each class:</p>
<p id="rfc.section.6.3.p.5">Asymmetric encryption algorithm identifiers (AsymEncrAlgorithmId) </p>

<ul class="empty">
<li>Format: ENCRALGO [ "-" ENCRSCHEME ] | PERSONALITY</li>
<li>Examples: "RSA1024-OAEP"</li>
</ul>

<p> </p>
<p id="rfc.section.6.3.p.6">Asymmetric signature algorithm identifiers (AsymSigAlgorithmId) </p>

<ul class="empty">
<li>Format: SIGALGO [ "-" HASHALGO [ "-" SIGSCHEME ]] | PERSONALITY</li>
<li>Examples: "DSA-SHA1" or "RSA1024-SHA256-PKCS1V1_5"</li>
</ul>

<p> </p>
<p id="rfc.section.6.3.p.7">Symmetric encryption algorithm identifiers (SymEncrAlgorithmId) </p>

<ul class="empty">
<li>Format: ENCRALGO | PERSONALITY</li>
<li>Examples: "AES128" or "3DES"</li>
</ul>

<p> </p>
<p id="rfc.section.6.3.p.8">Symmetric MAC algorithm identifiers (SymMacAlgorithmId) </p>

<ul class="empty">
<li>Format: MACALGO [ - HASHALGO ] | PERSONALITY</li>
<li>Examples: "HMAC-SHA1" or "UMAC"</li>
</ul>

<p> </p>
<p id="rfc.section.6.3.p.9">Hash algorithm identifiers (HashAlgorithmId) </p>

<ul class="empty">
<li>Format: HASHALGO | PERSONALITY</li>
<li>Examples: "MD5" or "SHA1"</li>
</ul>

<p> </p>
<p id="rfc.section.6.3.p.10">Key wrap algorithm identifiers (KeyWrapAlgorithmId) </p>

<ul class="empty">
<li>Format: ENCRALGO | PERSONALITY</li>
<li>Examples: AESKW</li>
</ul>

<p> </p>
<p id="rfc.section.6.3.p.11">Two major components may be combined to form a key agreement protocol identifier: the key agreement protocol including its version number (KEYAGREEPROTO) and the protocol's associated algorithm suite including its version number (ALGOSUITE). The following is the format for key agreement protocol identifiers.</p>
<p id="rfc.section.6.3.p.12">Key agreement protocol identifier (ProtocolId) </p>

<ul class="empty">
<li>Format: KEYAGREEPROTO "-" ALGOSUITE</li>
<li>Examples: "IKE2.0-FIREFLY"</li>
</ul>

<p> </p>
<p id="rfc.section.6.3.p.13">Note that the resulting identifiers may not be compatible with those identifiers defined for other module developers' implementations. A client program utilizing an identifier corresponding to one algorithm for a specific module may be required to modify the identifier for the same algorithm for a different type of module. Discrepancies may be discovered through a brief review of the ICS "Supported Algorithms" section.</p>
<h1 id="rfc.section.6.4">
<a href="#rfc.section.6.4">6.4.</a> Conformance Verification</h1>
<p id="rfc.section.6.4.p.1">In the future, test assertions may be made available to allow results from different organizations to be compared, and to provide proof of conformance to the specification.</p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> <a href="#extend" id="extend">Extensions</a>
</h1>
<p id="rfc.section.7.p.1">An extension is a mechanism to define functionality beyond what is defined in the official specification.  In the interest of promoting interoperability, extensions to the specification are discouraged except where necessary. Extensions to the specification enable module developers to add functionality unanticipated by the specification developers and to support proprietary features.</p>
<h1 id="rfc.section.7.1">
<a href="#rfc.section.7.1">7.1.</a> Extending an Interface</h1>
<p id="rfc.section.7.1.p.1">Developers may augment CICM interfaces by extending CICM IDL by adding new methods/attributes to existing interfaces or by deriving off existing CICM interfaces.  Extensions SHALL be documented in the ICS.</p>
<h1 id="rfc.section.7.2">
<a href="#rfc.section.7.2">7.2.</a> Extending Codes</h1>
<p id="rfc.section.7.2.p.1">CICM codes are constants that share a single 32-bit space. A number of datatypes for different purposes correspond to ranges in this space. The "CICM" codes are normatively defined in the specification; the "extended" codes are module developer-defined extensions. The codes, with their corresponding ranges and uses, are as follows:</p>
<p id="rfc.section.7.2.p.2">CICM status codes </p>

<ul class="empty"><li>0x00000000 - 0x00001000</li></ul>

<p> </p>
<p id="rfc.section.7.2.p.3">Extended status codes </p>

<ul class="empty"><li>0x00001001 - 0x00002000</li></ul>

<p> </p>
<p id="rfc.section.7.2.p.4">CICM module event codes </p>

<ul class="empty"><li>0x00002001 - 0x00003000</li></ul>

<p> </p>
<p id="rfc.section.7.2.p.5">Extended module event codes </p>

<ul class="empty"><li>0x00003001 - 0x00004000</li></ul>

<p> </p>
<p id="rfc.section.7.2.p.6">CICM channel event codes </p>

<ul class="empty"><li>0x00004001 - 0x00005000</li></ul>

<p> </p>
<p id="rfc.section.7.2.p.7">Extended channel event codes </p>

<ul class="empty"><li>0x00005001 - 0x00006000</li></ul>

<p> </p>
<p id="rfc.section.7.2.p.8">CICM generic constants </p>

<ul class="empty"><li>0x00006001 - 0x00007000</li></ul>

<p> </p>
<p id="rfc.section.7.2.p.9">Extended generic constants </p>

<ul class="empty"><li>0x00007001 - 0x00008000</li></ul>

<p> </p>
<p id="rfc.section.7.2.p.10">RESERVED </p>

<ul class="empty"><li>0x00008001 - 0x7FFFFFFF</li></ul>

<p> </p>
<p id="rfc.section.7.2.p.11">Normatively-defined CICM codes SHOULD be used whenever possible.  If any of the extended codes above are defined, they MUST be documented as specified below.</p>
<h1 id="rfc.section.7.2.1">
<a href="#rfc.section.7.2.1">7.2.1.</a> Extending Status Codes</h1>
<p id="rfc.section.7.2.1.p.1">The return value from CICM methods informs the caller of the status of the call. CICM does not use the IDL exception mechanism to report errors.</p>
<p id="rfc.section.7.2.1.p.2">The specification normatively defines a set of error codes in the range of 0x00000000 - 0x00001000, which may not be modified or extended. A block of codes in the range of 0x00001001 - 0x00002000 are reserved for module developer-defined status codes.  Any codes defined in this range MUST be documented in the ICS.</p>
<h1 id="rfc.section.7.2.2">
<a href="#rfc.section.7.2.2">7.2.2.</a> Extending Module/Channel Event Codes</h1>
<p id="rfc.section.7.2.2.p.1">The specification supports registering and unregistering user-defined channel event listeners for specific module and channel events. Module events in the range of 0x00003001 - 0x00004000 and channel events in the range of 0x00004001 - 0x00005000 are normatively defined and may not be modified or extended. A block of module events in the range 0x00003001 - 0x00004000 and channel events in the range of 0x00005001 - 0x00006000 are reserved for module developer-defined events. Any codes defined in this range MUST be documented in the ICS.</p>
<h1 id="rfc.section.7.2.3">
<a href="#rfc.section.7.2.3">7.2.3.</a> Extending Constants</h1>
<p id="rfc.section.7.2.3.p.1">A number of constants are normatively defined for specification use in the range of 0x00006001 - 0x00007000. Module developer-defined constants may be specified in the range of 0x00007001 - 0x00008000.  Any constants defined in this range MUST be documented in the ICS.</p>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> IANA Considerations</h1>
<p id="rfc.section.8.p.1">[RFC Editor: Please remove this section prior to publication.]</p>
<p id="rfc.section.8.p.2">This document has no IANA actions.</p>
<h1 id="rfc.section.9">
<a href="#rfc.section.9">9.</a> Security Considerations</h1>
<p id="rfc.section.9.p.1">This document defines basic aspects of the CICM specification and the normative rules for conformance and extensions. Other aspects of CICM contain important security considerations.</p>
<h1 id="rfc.section.9.1">
<a href="#rfc.section.9.1">9.1.</a> Unauthorized Usage</h1>
<p id="rfc.section.9.1.p.1">CICM provides several interfaces related to mitigating unauthorized usage in <a href="#CICM-MM">[CICM-MM]</a>. Furthermore, <a href="#CICM-KM">[CICM-KM]</a> discusses aspects of how authorization can be indirectly controlled via key white lists and black lists.</p>
<h1 id="rfc.section.9.2">
<a href="#rfc.section.9.2">9.2.</a> Inappropriate Usage</h1>
<p id="rfc.section.9.2.p.1">CICM defines several status codes related to inappropriate usage. For example, attempting to use an invalid key (S_KEY_INVALID) or specifying an inappropriate algorithm (S_ALGO_INVALID).  The wide range of status codes relate to the anticipated mechanisms in which using the interface may fail. Additionally, module developers can extend the set of status codes to accommodate their own needs and prevent inappropriate usage.</p>
<h1 id="rfc.section.10">
<a href="#rfc.section.10">10.</a> Acknowledgments</h1>
<p id="rfc.section.10.p.1">Many individuals participated in the development and review of the CICM specification. The CICM development team consists of Ronald Albuquerque, Samuel Cardman, Greg Carrier, James Cottrell, Shirley Kawamoto, Daniel Lanz, Brent Midwood, Lev Novikov, Brian O'Hanlon, Rick Page, Adam Pennington, and Nguyen Thai. The document production team consists of Mark Dwyer, Amanda Lind, and Brian Parrish.</p>
<p id="rfc.section.10.p.2">The CICM team wishes to thank the following individuals for participating in a review of the specification:</p>
<p></p>

<ul class="empty">
<li>Bill Beckwith, Objective Interface Systems</li>
<li>Dennis Bourget, Viasat</li>
<li>Thom Brooke, Linquest Corporation</li>
<li>Randy Culver, RT Logic</li>
<li>John Davis, ITT Corporation</li>
<li>Eric Dube, The MITRE Corporation</li>
<li>Jan Duffy, Rockwell Collins</li>
<li>H.J. Eckles, General Dynamics</li>
<li>Mark Flinchbaugh, Harris Corporation</li>
<li>Carolyn Francisco, The MITRE Corporation</li>
<li>James Howard, L-3 Communications</li>
<li>Kent Kofstad, The MITRE Corporation</li>
<li>Hema Krishnamurthy, ITT Corporation</li>
<li>Prithvi Kumar, The MITRE Corporation</li>
<li>Chip McGrogan, L-3 Communications</li>
<li>Hank Morris, Concurrent Technologies Corporation</li>
<li>Jeff Picciotto, The MITRE Corporation</li>
<li>Tom Plachecki, General Dynamics</li>
<li>Ray Purvis, The MITRE Corporation</li>
<li>Mike Ridge, The MITRE Corporation</li>
<li>Harry Shaffer, The MITRE Corporation</li>
<li>Patrick Smith, Linquest Corporation</li>
<li>Wayne Staats, Rockwell Collins</li>
<li>James Steinwachs, Harris Corporation</li>
<li>Porter Taylor, The MITRE Corporation</li>
<li>Otaway Thomas, Arkham Technology</li>
<li>Bob Walcott, The MITRE Corporation</li>
<li>Blane Yamamoto, SafeNet Mykotronx</li>
</ul>
<h1 id="rfc.references">
<a href="#rfc.references">11.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">11.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="CICM">[CICM]</b></td>
<td class="top">
<a>Lanz, D.</a> and <a>L. Novikov</a>, "<a>Common Interface to Cryptographic Modules (CICM) [RFC Editor: Please update the RFC reference and date prior to publication.]</a>", January 2011.</td>
</tr>
<tr>
<td class="reference"><b id="CICM-MM">[CICM-MM]</b></td>
<td class="top">
<a>Lanz, D.</a> and <a>L. Novikov</a>, "<a>Common Interface to Cryptographic Modules (CICM) Module Management [RFC Editor: Please update the RFC reference and date prior to publication.]</a>", January 2011.</td>
</tr>
<tr>
<td class="reference"><b id="CICM-KM">[CICM-KM]</b></td>
<td class="top">
<a>Lanz, D.</a> and <a>L. Novikov</a>, "<a>Common Interface to Cryptographic Modules (CICM) Key Management [RFC Editor: Please update the RFC reference and date prior to publication.]</a>", January 2011.</td>
</tr>
<tr>
<td class="reference"><b id="CICM-CM">[CICM-CM]</b></td>
<td class="top">
<a>Lanz, D.</a> and <a>L. Novikov</a>, "<a>Common Interface to Cryptographic Modules (CICM) Channel Management [RFC Editor: Please update the RFC reference and date prior to publication.]</a>", January 2011.</td>
</tr>
<tr>
<td class="reference"><b id="IDL">[IDL]</b></td>
<td class="top">
<a>International Standards Organization</a>, "<a>Information technology &#8212; Open Distributed Processing &#8212; Interface Definition Language</a>", ISO/IEC 14750:1999(E), March 1999.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">11.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC3552">[RFC3552]</b></td>
<td class="top">
<a>Rescorla, E.</a> and <a>B. Korver</a>, "<a href="http://tools.ietf.org/html/rfc3552">Guidelines for Writing RFC Text on Security Considerations</a>", BCP 72, RFC 3552, July 2003.</td>
</tr>
<tr>
<td class="reference"><b id="CICM-LM">[CICM-LM]</b></td>
<td class="top">
<a>Lanz, D.</a> and <a>L. Novikov</a>, "<a>Common Interface to Cryptographic Modules (CICM) Logical Model [RFC Editor: Please update the RFC reference and date prior to publication.]</a>", January 2011.</td>
</tr>
<tr>
<td class="reference"><b id="CORBA">[CORBA]</b></td>
<td class="top">
<a>Object Management Group</a>, "<a>Common Object Request Broker Architecture (CORBA) Specification, Version 3.1</a>", January 2008.</td>
</tr>
</tbody></table>
<h1 id="rfc.appendix.Appendix A">
<a href="#rfc.appendix.Appendix%20A">Appendix A.</a> <a href="#status-codes" id="status-codes">Status Codes</a>
</h1>
<p id="rfc.section.Appendix A.p.1">Each method defined in CICM returns a status value to inform the caller as to the outcome of the call. The documentation for each individual method lists the status codes that may be returned in the event a call to the method results in failure.</p>
<p id="rfc.section.Appendix A.p.2">The status value CICM::S_OK is returned if a method completes successfully. The output parameters of any methods that return a status other than CICM::S_OK are invalid and MUST NOT be referenced or used.</p>
<p id="rfc.section.Appendix A.p.3">CICM methods can fail for a variety of reasons, including: </p>

<ul>
<li>Invalid, illegal, out-of-range, or poorly formed parameters</li>
<li>Resources insufficient or unavailable</li>
<li>Unsupported capabilities</li>
<li>Policy violation</li>
<li>Hardware failure.</li>
</ul>
<p id="rfc.section.Appendix A.p.4">For additional information concerning extending status codes, see <a href="#extend">Extensions</a>.</p>
<p id="rfc.section.Appendix A.p.5">CICM status codes are defined below.</p>
<p id="rfc.section.Appendix A.p.6">S_OK = 0x00000000</p>

<ul class="empty"><li>No error.</li></ul>
<p id="rfc.section.Appendix A.p.7">S_GENERAL_ERROR = 0x00000003</p>

<ul class="empty"><li>Unrecoverable error occurred, potentially leaving module in an inconsistent state.</li></ul>
<p id="rfc.section.Appendix A.p.8">S_NON_FUNCTIONAL = 0x00000005</p>

<ul class="empty"><li>Tamper event or other condition has rendered module non-functional.</li></ul>
<p id="rfc.section.Appendix A.p.9">S_OPERATION_FAILED = 0x00000006</p>

<ul class="empty"><li>Method encountered a general failure, but detailed information about the failure is not available.</li></ul>
<p id="rfc.section.Appendix A.p.10">S_POLICY_VIOLATION = 0x00000009</p>

<ul class="empty"><li>Module policy does not permit the requested action.</li></ul>
<p id="rfc.section.Appendix A.p.11">S_MODULE_RESOURCES = 0x0000000A</p>

<ul class="empty"><li>Module resources necessary to perform the requested operation are not available.</li></ul>
<p id="rfc.section.Appendix A.p.12">S_HOST_RESOURCES = 0x0000000C</p>

<ul class="empty"><li>Host resources necessary to perform the requested operation are not available.</li></ul>
<p id="rfc.section.Appendix A.p.13">S_INVALID_STATE = 0x0000000F</p>

<ul class="empty"><li>Module is in a state that does not allow this operation to be performed.</li></ul>
<p id="rfc.section.Appendix A.p.14">S_ALARM_STATE = 0x00000011</p>

<ul class="empty"><li>Module has entered an alarm state.</li></ul>
<p id="rfc.section.Appendix A.p.15">S_MODULE_NOT_AVAILABLE = 0x00000012</p>

<ul class="empty"><li>Module has been powered down, disconnected, or is otherwise unavailable..</li></ul>
<p id="rfc.section.Appendix A.p.16">S_TIMEOUT = 0x00000014</p>

<ul class="empty"><li>Time to receive response from call exceeded threshold.</li></ul>
<p id="rfc.section.Appendix A.p.17">S_NOT_AUTHENTICATED = 0x00000017</p>

<ul class="empty"><li>User has not authenticated to module.</li></ul>
<p id="rfc.section.Appendix A.p.18">S_NOT_AUTHORIZED = 0x00000018</p>

<ul class="empty"><li>User is not authorized to call method.</li></ul>
<p id="rfc.section.Appendix A.p.19">S_MODULE_DOES_NOT_EXIST = 0x0000001B</p>

<ul class="empty"><li>No module with the specified unique identifier exists.</li></ul>
<p id="rfc.section.Appendix A.p.20">S_MODULE_IN_USE = 0x0000001D</p>

<ul class="empty"><li>Module test initiated when channels or other module resources are in use.</li></ul>
<p id="rfc.section.Appendix A.p.21">S_NOT_AVAILABLE = 0x0000001E</p>

<ul class="empty"><li>Information is not available or cannot be found.</li></ul>
<p id="rfc.section.Appendix A.p.22">S_INVALID_VECTOR = 0x00000021</p>

<ul class="empty"><li>Invalid vector provided; this may be because the length or format of the vector is inappropriate for the algorithm or system with which the vector is being used.</li></ul>
<p id="rfc.section.Appendix A.p.23">S_INVALID_DATA_BUFFER = 0x00000022</p>

<ul class="empty"><li>Data in user-specified buffer parameter is invalid.</li></ul>
<p id="rfc.section.Appendix A.p.24">S_KEY_USED_INVALID = 0x00000024</p>

<ul class="empty"><li>Key specified as parameter to method is invalid; this could denote that the key has been zeroized, a failed parity check, or other conditions that prevent the use of the key.</li></ul>
<p id="rfc.section.Appendix A.p.25">S_KEY_USED_EXPIRED = 0x00000027</p>

<ul class="empty"><li>Key specified as parameter to method has expired and may not be used.</li></ul>
<p id="rfc.section.Appendix A.p.26">S_KEY_USED_CLASSIFICATION = 0x00000028</p>

<ul class="empty"><li>Key specified as parameter to method at wrong classification level.</li></ul>
<p id="rfc.section.Appendix A.p.27">S_KEY_USED_WRAPPED = 0x0000002B</p>

<ul class="empty"><li>Key specified as parameter to method may not be used in the context until it has been unwrapped.</li></ul>
<p id="rfc.section.Appendix A.p.28">S_KEY_USED_CONTEXT = 0x0000002D</p>

<ul class="empty"><li>Attempt to use key in an illegal context as defined by the module; e.g., a key is specified for use on a channel but, due to module architecture, the key is unavailable to that channel.</li></ul>
<p id="rfc.section.Appendix A.p.29">S_KEY_USED_COMPONENT_NOT_AVAIL = 0x0000002E</p>

<ul class="empty"><li>Asymmetric key specified as parameter to method contains only a public key (possibly in a certificate) or only a private key, when the other component is needed by the called method.</li></ul>
<p id="rfc.section.Appendix A.p.30">S_KEY_INVALID = 0x00000030</p>

<ul class="empty"><li>Key is invalid; this could denote that the key has been zeroized, a failed parity check, or other conditions that prevent the use of the key.</li></ul>
<p id="rfc.section.Appendix A.p.31">S_KEY_EXPIRED = 0x00000033</p>

<ul class="empty"><li>Key has expired and may not be used.</li></ul>
<p id="rfc.section.Appendix A.p.32">S_KEY_INCOMPATIBLE = 0x00000035</p>

<ul class="empty"><li>Key type (e.g., TEK, KEK) incompatible with intended usage.</li></ul>
<p id="rfc.section.Appendix A.p.33">S_KEY_CLASSIFICATION = 0x00000036</p>

<ul class="empty"><li>Key at wrong classification level.</li></ul>
<p id="rfc.section.Appendix A.p.34">S_KEY_WRAPPED = 0x00000039</p>

<ul class="empty"><li>Key may not be used in this context until it has been unwrapped.</li></ul>
<p id="rfc.section.Appendix A.p.35">S_KEY_NOT_WRAPPED = 0x0000003A</p>

<ul class="empty"><li>Key is not wrapped.</li></ul>
<p id="rfc.section.Appendix A.p.36">S_KEY_NOT_WRAPPABLE = 0x0000003C</p>

<ul class="empty"><li>Module is not able to wrap key.</li></ul>
<p id="rfc.section.Appendix A.p.37">S_KEY_NOT_EXPORTABLE = 0x0000003F</p>

<ul class="empty"><li>Key is not exportable, potentially because it has not been wrapped or other policy disallows it.</li></ul>
<p id="rfc.section.Appendix A.p.38">S_KEY_WRAPPED_EXISTS = 0x00000041</p>

<ul class="empty"><li>Wrapped key already exists.</li></ul>
<p id="rfc.section.Appendix A.p.39">S_KEY_UNWRAPPED_EXISTS = 0x00000042</p>

<ul class="empty"><li>Unwrapped key already exists.</li></ul>
<p id="rfc.section.Appendix A.p.40">S_KEY_UPDATE_MAX = 0x00000044</p>

<ul class="empty"><li>Maximum number of updates for this key has been exceeded.</li></ul>
<p id="rfc.section.Appendix A.p.41">S_KEY_INVALID_ID = 0x00000047</p>

<ul class="empty"><li>Invalid key identifier specified.</li></ul>
<p id="rfc.section.Appendix A.p.42">S_KEY_PHYSICAL_LOC = 0x00000048</p>

<ul class="empty"><li>Invalid key physical location specified.</li></ul>
<p id="rfc.section.Appendix A.p.43">S_KEY_ILLEGAL_CONVERSION = 0x0000004B</p>

<ul class="empty"><li>Target algorithm is incompatible with algorithm associated with specified key.</li></ul>
<p id="rfc.section.Appendix A.p.44">S_KEY_MALFORMED = 0x0000004D</p>

<ul class="empty"><li>Key material supplied is malformed.</li></ul>
<p id="rfc.section.Appendix A.p.45">S_KEY_METADATA_MALFORMED = 0x0000004E</p>

<ul class="empty"><li>Key metadata supplied is malformed.</li></ul>
<p id="rfc.section.Appendix A.p.46">S_KEY_NO_NEXT = 0x00000050</p>

<ul class="empty"><li>No next key available for rollover.</li></ul>
<p id="rfc.section.Appendix A.p.47">S_KEY_WRONG_TYPE = 0x00000053</p>

<ul class="empty"><li>Illegal attempt to process a symmetric key with an asymmetric method or an asymmetric key with a symmetric method.</li></ul>
<p id="rfc.section.Appendix A.p.48">S_KEY_FILL_DEVICE_NOT_CONNECTED = 0x00000055</p>

<ul class="empty"><li>Key fill device not connected.</li></ul>
<p id="rfc.section.Appendix A.p.49">S_KEY_FILL_NOT_INITIATED = 0x00000056</p>

<ul class="empty"><li>Manual key fill device interaction not initiated within system-defined time limit.</li></ul>
<p id="rfc.section.Appendix A.p.50">S_KEY_TRUST_ANCHOR = 0x00000059</p>

<ul class="empty"><li>Trust anchor required but is unavailable.</li></ul>
<p id="rfc.section.Appendix A.p.51">S_LOCAL_PORT_INVALID = 0x0000005A</p>

<ul class="empty"><li>Local port specified is invalid.</li></ul>
<p id="rfc.section.Appendix A.p.52">S_LOCAL_PORT_INCOMPATIBLE = 0x0000005C</p>

<ul class="empty"><li>Local port specified cannot be used in intended manner.</li></ul>
<p id="rfc.section.Appendix A.p.53">S_LOCAL_PORT_IN_USE = 0x0000005F</p>

<ul class="empty"><li>Local port specified is currently in use.</li></ul>
<p id="rfc.section.Appendix A.p.54">S_REMOTE_PORT_INVALID = 0x00000060</p>

<ul class="empty"><li>Remote port specified is invalid.</li></ul>
<p id="rfc.section.Appendix A.p.55">S_REMOTE_PORT_IN_USE = 0x00000063</p>

<ul class="empty"><li>Remote port specified is currently in use.</li></ul>
<p id="rfc.section.Appendix A.p.56">S_ALGO_INVALID = 0x00000065</p>

<ul class="empty"><li>Malformed string or unsupported/invalid algorithm specified.</li></ul>
<p id="rfc.section.Appendix A.p.57">S_ALGO_INCOMPATIBLE = 0x00000066</p>

<ul class="empty"><li>Algorithm incompatible with intended usage (e.g., encryption, signature, hashing).</li></ul>
<p id="rfc.section.Appendix A.p.58">S_TOKEN_NOT_PRESENT = 0x00000069</p>

<ul class="empty"><li>Token must be inserted to perform the requested operation and no token is available to the module.</li></ul>
<p id="rfc.section.Appendix A.p.59">S_TOKEN_ADMIN_NOT_PRESENT = 0x0000006A</p>

<ul class="empty"><li>Administrator token must be inserted to perform the requested operation and either no token is present or the inserted token is not an administrator token.</li></ul>
<p id="rfc.section.Appendix A.p.60">S_TOKEN_ACCESS = 0x0000006C</p>

<ul class="empty"><li>Token I/O error.</li></ul>
<p id="rfc.section.Appendix A.p.61">S_TOKEN_RESOURCES = 0x0000006F</p>

<ul class="empty"><li>Token resources necessary to perform the requested operation are not available.</li></ul>
<p id="rfc.section.Appendix A.p.62">S_TOKEN_ASSOC_EXISTS = 0x00000071</p>

<ul class="empty"><li>Association between module and token already exists.</li></ul>
<p id="rfc.section.Appendix A.p.63">S_TOKEN_ASSOC_AT_MODULE = 0x00000072</p>

<ul class="empty"><li>Association failed because module will allow no new associations.</li></ul>
<p id="rfc.section.Appendix A.p.64">S_TOKEN_ASSOC_AT_TOKEN = 0x00000074</p>

<ul class="empty"><li>Association failed because token will allow no new associations.</li></ul>
<p id="rfc.section.Appendix A.p.65">S_TOKEN_ASSOC_NOT_EXIST = 0x00000077</p>

<ul class="empty"><li>Association between module and token does not exist at the module, at the token, or both.</li></ul>
<p id="rfc.section.Appendix A.p.66">S_TOKEN_ASSOC_GENERAL = 0x00000078</p>

<ul class="empty"><li>Unspecified token association error occurred.</li></ul>
<p id="rfc.section.Appendix A.p.67">S_TOKEN_DISASSOC_GENERAL = 0x0000007B</p>

<ul class="empty"><li>Unspecified token disassociation error occurred.</li></ul>
<p id="rfc.section.Appendix A.p.68">S_TOKEN_REC_NOT_FOUND = 0x0000007D</p>

<ul class="empty"><li>Specified record not found.</li></ul>
<p id="rfc.section.Appendix A.p.69">S_TOKEN_TIMEOUT = 0x0000007E</p>

<ul class="empty"><li>Timeout for insertion of token has been exceeded.</li></ul>
<p id="rfc.section.Appendix A.p.70">S_TOKEN_LAST_ASSOCIATED = 0x00000081</p>

<ul class="empty"><li>Cannot disassociate the last associated token from this module.</li></ul>
<p id="rfc.section.Appendix A.p.71">S_PACKAGE_NOT_ACTIVATABLE = 0x00000082</p>

<ul class="empty"><li>Specified package is not executable.</li></ul>
<p id="rfc.section.Appendix A.p.72">S_PACKAGE_ACTIVATED = 0x00000084</p>

<ul class="empty"><li>Specified package is currently running.</li></ul>
<p id="rfc.section.Appendix A.p.73">S_PACKAGE_NOT_ACTIVE = 0x00000087</p>

<ul class="empty"><li>Specified package is not currently running.</li></ul>
<p id="rfc.section.Appendix A.p.74">S_PACKAGE_INVALID = 0x00000088</p>

<ul class="empty"><li>Specified package is invalid.</li></ul>
<p id="rfc.section.Appendix A.p.75">S_PACKAGE_TYPE_INVALID = 0x0000008B</p>

<ul class="empty"><li>Specified package type is invalid.</li></ul>
<p id="rfc.section.Appendix A.p.76">S_PACKAGE_KEY_NOT_AVAILABLE = 0x0000008D</p>

<ul class="empty"><li>Package is encrypted and the key specified for use to decrypt package is not available on the module.</li></ul>
<p id="rfc.section.Appendix A.p.77">S_PACKAGE_KEY_NOT_SPECIFIED = 0x0000008E</p>

<ul class="empty"><li>Package is encrypted but no key is specified to decrypt it.</li></ul>
<p id="rfc.section.Appendix A.p.78">S_LOG_ENTRY_INVALID = 0x00000090</p>

<ul class="empty"><li>Log entry is invalid.</li></ul>
<p id="rfc.section.Appendix A.p.79">S_EVENT_REGISTERED = 0x00000093</p>

<ul class="empty"><li>An event has already been registered by this process for this event type.</li></ul>
<p id="rfc.section.Appendix A.p.80">S_EVENT_NOT_REGISTERED = 0x00000095</p>

<ul class="empty"><li>An event has not been registered by this process for this event type.</li></ul>
<p id="rfc.section.Appendix A.p.81">S_EVENT_NOT_SUPPORTED = 0x00000096</p>

<ul class="empty"><li>Event is not supported in this implementation.</li></ul>
<p id="rfc.section.Appendix A.p.82">S_TRUSTED_DISPLAY = 0x00000099</p>

<ul class="empty"><li>Peer information is available at trusted display.</li></ul>
<p id="rfc.section.Appendix A.p.83">S_NEGOTIATION_ABORTED = 0x0000009A</p>

<ul class="empty"><li>Negotiation was aborted.</li></ul>
<p id="rfc.section.Appendix A.p.84">S_NEGOTIATION_FAILURE = 0x0000009C</p>

<ul class="empty"><li>Negotiation failed.</li></ul>
<p id="rfc.section.Appendix A.p.85">S_NEGOTIATION_IN_PROGRESS = 0x0000009F</p>

<ul class="empty"><li>Negotiation is already in progress.</li></ul>
<p id="rfc.section.Appendix A.p.86">S_NEGOTIATION_NOT_IN_PROGRESS = 0x000000A0</p>

<ul class="empty"><li>No negotiation has been initiated.</li></ul>
<p id="rfc.section.Appendix A.p.87">S_NEGOTIATION_TIMEOUT = 0x000000A3</p>

<ul class="empty"><li>Negotiation timed out.</li></ul>
<p id="rfc.section.Appendix A.p.88">S_CERT_LOCAL_INVALID = 0x000000A5</p>

<ul class="empty"><li>Local certificate used in a key negotiation is invalid; the certificate may be corrupted or does not verify.</li></ul>
<p id="rfc.section.Appendix A.p.89">S_CERT_LOCAL_EXPIRED = 0x000000A6</p>

<ul class="empty"><li>Local certificate used in a key negotiation has expired.</li></ul>
<p id="rfc.section.Appendix A.p.90">S_CERT_REMOTE_INVALID = 0x000000A9</p>

<ul class="empty"><li>Remote certificate used in a key negotiation is invalid; the certificate may be corrupted or does not verify.</li></ul>
<p id="rfc.section.Appendix A.p.91">S_CERT_REMOTE_EXPIRED = 0x000000AA</p>

<ul class="empty"><li>Remote certificate used in a key negotiation has expired.</li></ul>
<p id="rfc.section.Appendix A.p.92">S_CERT_REMOTE_PATH = 0x000000AC</p>

<ul class="empty"><li>Certificates to enable verification of remote certificate's certification path are not available.</li></ul>
<p id="rfc.section.Appendix A.p.93">S_PROTO_INVALID = 0x000000AF</p>

<ul class="empty"><li>Malformed string or unsupported/invalid protocol specified.</li></ul>
<p id="rfc.section.Appendix A.p.94">S_PROTO_INCOMPATIBLE = 0x000000B1</p>

<ul class="empty"><li>Protocol specified is incompatible with intended usage.</li></ul>
<p id="rfc.section.Appendix A.p.95">S_PROTO_UNDETERMINED = 0x000000B2</p>

<ul class="empty"><li>An "implicit" protocol has been specified, but the protocol message does not indicate the protocol.</li></ul>
<p id="rfc.section.Appendix A.p.96">S_CHANNEL_ERROR = 0x000000B4</p>

<ul class="empty"><li>Generic conduit/controller error encountered.</li></ul>
<p id="rfc.section.Appendix A.p.97">S_CHANNEL_PEER_RESET = 0x000000B7</p>

<ul class="empty"><li>Peer crypto reset conduit/controller or conduit/controller ceased operation.</li></ul>
<p id="rfc.section.Appendix A.p.98">S_CHANNEL_MAX = 0x000000B8</p>

<ul class="empty"><li>Limit on total number of conduits/controllers has been reached.</li></ul>
<p id="rfc.section.Appendix A.p.99">S_CHANNEL_NOT_FOUND = 0x000000BB</p>

<ul class="empty"><li>Conduit/controller not found.</li></ul>
<p id="rfc.section.Appendix A.p.100">S_CHANNEL_IO_ERROR = 0x000000BD</p>

<ul class="empty"><li>Conduit/controller I/O error.</li></ul>
<p id="rfc.section.Appendix A.p.101">S_CHANNEL_DATA_INVALID = 0x000000BE</p>

<ul class="empty"><li>Input data to cryptographic operation is invalid (e.g., plaintext for encryption or ciphertext for decryption).</li></ul>
<p id="rfc.section.Appendix A.p.102">S_CHANNEL_DATA_INVALID_LEN = 0x000000C0</p>

<ul class="empty"><li>Plaintext (for encryption) or ciphertext (for decryption) input data to cryptographic operation has an inappropriate length; this could denote that the data is too short, too long, or is not a multiple of some particular block size.</li></ul>
<p id="rfc.section.Appendix A.p.103">S_CHANNEL_BUFFER_LEN = 0x000000C3</p>

<ul class="empty"><li>Output of function is too large for supplied buffer.</li></ul>
<p id="rfc.section.Appendix A.p.104">S_CHANNEL_IN_GROUP = 0x000000C5</p>

<ul class="empty"><li>Conduit/controller already exists as part of group.</li></ul>
<p id="rfc.section.Appendix A.p.105">S_CHANNEL_CLASSIFICATION = 0x000000C6</p>

<ul class="empty"><li>Conduits/controllers are not of the same classification.</li></ul>
<p id="rfc.section.Appendix A.p.106">S_BYPASS_DATARATE_EXCEEDED = 0x000000C9</p>

<ul class="empty"><li>Bypass data rate exceeded.</li></ul>
<p id="rfc.section.Appendix A.p.107">S_BYPASS_DATALIMIT_EXCEEDED = 0x000000CA</p>

<ul class="empty"><li>Bypass data limit exceeded.</li></ul>
<p id="rfc.section.Appendix A.p.108">S_INTEGRITY = 0x000000CC</p>

<ul class="empty"><li>In those cases where an encryption algorithm supplies both confidentiality and integrity (an integrity value is transmitted with the ciphertext), the final decrypt may fail with this integrity error if the integrity check fails.</li></ul>
<p id="rfc.section.Appendix A.p.109">S_AUTHENTICATION_FAILED = 0x000000CF</p>

<ul class="empty"><li>Authentication to the module failed; this could denote that a password is incorrect or that additional authentication data supplied is invalid.</li></ul>
<p id="rfc.section.Appendix A.p.110">S_USER_AUTHENTICATED = 0x000000D1</p>

<ul class="empty"><li>Specified user has already authenticated to module.</li></ul>
<p id="rfc.section.Appendix A.p.111">S_USERNAME_INVALID = 0x000000D2</p>

<ul class="empty"><li>Username is invalid.</li></ul>
<p id="rfc.section.Appendix A.p.112">S_USER_EXISTS = 0x000000D4</p>

<ul class="empty"><li>User already exists.</li></ul>
<p id="rfc.section.Appendix A.p.113">S_USER_INVALID = 0x000000D7</p>

<ul class="empty"><li>User does not exist.</li></ul>
<p id="rfc.section.Appendix A.p.114">S_ROLE_INVALID = 0x000000D8</p>

<ul class="empty"><li>Role does not exist.</li></ul>
<p id="rfc.section.Appendix A.p.115">S_ROLE_ASSOCIATED = 0x000000DB</p>

<ul class="empty"><li>User already associated with this role.</li></ul>
<p id="rfc.section.Appendix A.p.116">S_ROLE_NOT_ASSOCIATED = 0x000000DD</p>

<ul class="empty"><li>User not associated with this role.</li></ul>
<p id="rfc.section.Appendix A.p.117">S_ROLE_MAX = 0x000000DE</p>

<ul class="empty"><li>Maximum number of roles already associated with this user.</li></ul>
<p id="rfc.section.Appendix A.p.118">S_PASSWORD_INVALID = 0x000000E1</p>

<ul class="empty"><li>Specified password does not meet module policy.</li></ul>
<p id="rfc.section.Appendix A.p.119">S_PASSWORD_INVALID_CHAR = 0x000000E2</p>

<ul class="empty"><li>Specified password has invalid characters in it.</li></ul>
<p id="rfc.section.Appendix A.p.120">S_PASSWORD_INVALID_LEN = 0x000000E4</p>

<ul class="empty"><li>Length of specified password is either too long or too short.</li></ul>
<p id="rfc.section.Appendix A.p.121">S_SALT_INVALID = 0x000000E7</p>

<ul class="empty"><li>Invalid salt specified.</li></ul>
<p id="rfc.section.Appendix A.p.122">S_ITERATION_COUNT_INVALID = 0x000000E8</p>

<ul class="empty"><li>Invalid iteration count specified.</li></ul>
<p id="rfc.section.Appendix A.p.123">S_INSUFFICIENT_ENTROPY = 0x000000EB</p>

<ul class="empty"><li>Insufficient entropy available. </li></ul>
<h1 id="rfc.appendix.Appendix B">
<a href="#rfc.appendix.Appendix%20B">Appendix B.</a> <a href="#idl-code" id="idl-code">IDL Definitions</a>
</h1>
<div id="#rfc.figure.53"></div>
<pre>module CICM {
  typedef unsigned long UInt32;
  typedef string CharString;
  typedef sequence&lt;octet&gt; Buffer;

  typedef CICM::UInt32 LocalPort;
  typedef CICM::UInt32 RemotePort;

  const CICM::LocalPort FILL_INTERFACE_PORT = 0xFFFFFFEE;
  const CICM::LocalPort IMPLICIT_LOCAL_PORT = 0xFFFFFFBB;
  const CICM::RemotePort IMPLICIT_REMOTE_PORT = 0xFFFFFF99;

  typedef CICM::UInt32 Classification;
  const CICM::Classification C_LEVEL_CONFIDENTIAL = 0x00006029;
  const CICM::Classification C_LEVEL_SECRET = 0x0000602A;
  const CICM::Classification C_LEVEL_TOP_SECRET = 0x0000602C;
  const CICM::Classification C_LEVEL_UNCLASSIFIED = 0x0000602F;

  typedef CICM::UInt32 Status;
  const CICM::Status S_OK = 0x00000000;
  const CICM::Status S_GENERAL_ERROR = 0x00000003;
  const CICM::Status S_NON_FUNCTIONAL = 0x00000005;
  const CICM::Status S_OPERATION_FAILED = 0x00000006;
  const CICM::Status S_POLICY_VIOLATION = 0x00000009;
  const CICM::Status S_MODULE_RESOURCES = 0x0000000A;
  const CICM::Status S_HOST_RESOURCES = 0x0000000C;
  const CICM::Status S_INVALID_STATE = 0x0000000F;
  const CICM::Status S_ALARM_STATE = 0x00000011;
  const CICM::Status S_MODULE_NOT_AVAILABLE = 0x00000012;
  const CICM::Status S_TIMEOUT = 0x00000014;
  const CICM::Status S_NOT_AUTHENTICATED = 0x00000017;
  const CICM::Status S_NOT_AUTHORIZED = 0x00000018;
  const CICM::Status S_MODULE_DOES_NOT_EXIST = 0x0000001B;
  const CICM::Status S_MODULE_IN_USE = 0x0000001D;
  const CICM::Status S_NOT_AVAILABLE = 0x0000001E;
  const CICM::Status S_INVALID_VECTOR = 0x00000021;
  const CICM::Status S_INVALID_DATA_BUFFER = 0x00000022;
  const CICM::Status S_KEY_USED_INVALID = 0x00000024;
  const CICM::Status S_KEY_USED_EXPIRED = 0x00000027;
  const CICM::Status S_KEY_USED_CLASSIFICATION = 0x00000028;
  const CICM::Status S_KEY_USED_WRAPPED = 0x0000002B;
  const CICM::Status S_KEY_USED_CONTEXT = 0x0000002D;
  const CICM::Status S_KEY_USED_COMPONENT_NOT_AVAIL = 0x0000002E;
  const CICM::Status S_KEY_INVALID = 0x00000030;
  const CICM::Status S_KEY_EXPIRED = 0x00000033;
  const CICM::Status S_KEY_INCOMPATIBLE = 0x00000035;
  const CICM::Status S_KEY_CLASSIFICATION = 0x00000036;
  const CICM::Status S_KEY_WRAPPED = 0x00000039;
  const CICM::Status S_KEY_NOT_WRAPPED = 0x0000003A;
  const CICM::Status S_KEY_NOT_WRAPPABLE = 0x0000003C;
  const CICM::Status S_KEY_NOT_EXPORTABLE = 0x0000003F;
  const CICM::Status S_KEY_WRAPPED_EXISTS = 0x00000041;
  const CICM::Status S_KEY_UNWRAPPED_EXISTS = 0x00000042;
  const CICM::Status S_KEY_UPDATE_MAX = 0x00000044;
  const CICM::Status S_KEY_INVALID_ID = 0x00000047;
  const CICM::Status S_KEY_PHYSICAL_LOC = 0x00000048;
  const CICM::Status S_KEY_ILLEGAL_CONVERSION = 0x0000004B;
  const CICM::Status S_KEY_MALFORMED = 0x0000004D;
  const CICM::Status S_KEY_METADATA_MALFORMED = 0x0000004E;
  const CICM::Status S_KEY_NO_NEXT = 0x00000050;
  const CICM::Status S_KEY_WRONG_TYPE = 0x00000053;
  const CICM::Status S_KEY_FILL_DEVICE_NOT_CONNECTED = 0x00000055;
  const CICM::Status S_KEY_FILL_NOT_INITIATED = 0x00000056;
  const CICM::Status S_KEY_TRUST_ANCHOR = 0x00000059;
  const CICM::Status S_LOCAL_PORT_INVALID = 0x0000005A;
  const CICM::Status S_LOCAL_PORT_INCOMPATIBLE = 0x0000005C;
  const CICM::Status S_LOCAL_PORT_IN_USE = 0x0000005F;
  const CICM::Status S_REMOTE_PORT_INVALID = 0x00000060;
  const CICM::Status S_REMOTE_PORT_IN_USE = 0x00000063;
  const CICM::Status S_ALGO_INVALID = 0x00000065;
  const CICM::Status S_ALGO_INCOMPATIBLE = 0x00000066;
  const CICM::Status S_TOKEN_NOT_PRESENT = 0x00000069;
  const CICM::Status S_TOKEN_ADMIN_NOT_PRESENT = 0x0000006A;
  const CICM::Status S_TOKEN_ACCESS = 0x0000006C;
  const CICM::Status S_TOKEN_RESOURCES = 0x0000006F;
  const CICM::Status S_TOKEN_ASSOC_EXISTS = 0x00000071;
  const CICM::Status S_TOKEN_ASSOC_AT_MODULE = 0x00000072;
  const CICM::Status S_TOKEN_ASSOC_AT_TOKEN = 0x00000074;
  const CICM::Status S_TOKEN_ASSOC_NOT_EXIST = 0x00000077;
  const CICM::Status S_TOKEN_ASSOC_GENERAL = 0x00000078;
  const CICM::Status S_TOKEN_DISASSOC_GENERAL = 0x0000007B;
  const CICM::Status S_TOKEN_REC_NOT_FOUND = 0x0000007D;
  const CICM::Status S_TOKEN_TIMEOUT = 0x0000007E;
  const CICM::Status S_TOKEN_LAST_ASSOCIATED = 0x00000081;
  const CICM::Status S_PACKAGE_NOT_ACTIVATABLE = 0x00000082;
  const CICM::Status S_PACKAGE_ACTIVATED = 0x00000084;
  const CICM::Status S_PACKAGE_NOT_ACTIVE = 0x00000087;
  const CICM::Status S_PACKAGE_INVALID = 0x00000088;
  const CICM::Status S_PACKAGE_TYPE_INVALID = 0x0000008B;
  const CICM::Status S_PACKAGE_KEY_NOT_AVAILABLE = 0x0000008D;
  const CICM::Status S_PACKAGE_KEY_NOT_SPECIFIED = 0x0000008E;
  const CICM::Status S_LOG_ENTRY_INVALID = 0x00000090;
  const CICM::Status S_EVENT_REGISTERED = 0x00000093;
  const CICM::Status S_EVENT_NOT_REGISTERED = 0x00000095;
  const CICM::Status S_EVENT_NOT_SUPPORTED = 0x00000096;
  const CICM::Status S_TRUSTED_DISPLAY = 0x00000099;
  const CICM::Status S_NEGOTIATION_ABORTED = 0x0000009A;
  const CICM::Status S_NEGOTIATION_FAILURE = 0x0000009C;
  const CICM::Status S_NEGOTIATION_IN_PROGRESS = 0x0000009F;
  const CICM::Status S_NEGOTIATION_NOT_IN_PROGRESS = 0x000000A0;
  const CICM::Status S_NEGOTIATION_TIMEOUT = 0x000000A3;
  const CICM::Status S_CERT_LOCAL_INVALID = 0x000000A5;
  const CICM::Status S_CERT_LOCAL_EXPIRED = 0x000000A6;
  const CICM::Status S_CERT_REMOTE_INVALID = 0x000000A9;
  const CICM::Status S_CERT_REMOTE_EXPIRED = 0x000000AA;
  const CICM::Status S_CERT_REMOTE_PATH = 0x000000AC;
  const CICM::Status S_PROTO_INVALID = 0x000000AF;
  const CICM::Status S_PROTO_INCOMPATIBLE = 0x000000B1;
  const CICM::Status S_PROTO_UNDETERMINED = 0x000000B2;
  const CICM::Status S_CHANNEL_ERROR = 0x000000B4;
  const CICM::Status S_CHANNEL_PEER_RESET = 0x000000B7;
  const CICM::Status S_CHANNEL_MAX = 0x000000B8;
  const CICM::Status S_CHANNEL_NOT_FOUND = 0x000000BB;
  const CICM::Status S_CHANNEL_IO_ERROR = 0x000000BD;
  const CICM::Status S_CHANNEL_DATA_INVALID = 0x000000BE;
  const CICM::Status S_CHANNEL_DATA_INVALID_LEN = 0x000000C0;
  const CICM::Status S_CHANNEL_BUFFER_LEN = 0x000000C3;
  const CICM::Status S_CHANNEL_IN_GROUP = 0x000000C5;
  const CICM::Status S_CHANNEL_CLASSIFICATION = 0x000000C6;
  const CICM::Status S_BYPASS_DATARATE_EXCEEDED = 0x000000C9;
  const CICM::Status S_BYPASS_DATALIMIT_EXCEEDED = 0x000000CA;
  const CICM::Status S_INTEGRITY = 0x000000CC;
  const CICM::Status S_AUTHENTICATION_FAILED = 0x000000CF;
  const CICM::Status S_USER_AUTHENTICATED = 0x000000D1;
  const CICM::Status S_USERNAME_INVALID = 0x000000D2;
  const CICM::Status S_USER_EXISTS = 0x000000D4;
  const CICM::Status S_USER_INVALID = 0x000000D7;
  const CICM::Status S_ROLE_INVALID = 0x000000D8;
  const CICM::Status S_ROLE_ASSOCIATED = 0x000000DB;
  const CICM::Status S_ROLE_NOT_ASSOCIATED = 0x000000DD;
  const CICM::Status S_ROLE_MAX = 0x000000DE;
  const CICM::Status S_PASSWORD_INVALID = 0x000000E1;
  const CICM::Status S_PASSWORD_INVALID_CHAR = 0x000000E2;
  const CICM::Status S_PASSWORD_INVALID_LEN = 0x000000E4;
  const CICM::Status S_SALT_INVALID = 0x000000E7;
  const CICM::Status S_ITERATION_COUNT_INVALID = 0x000000E8;
  const CICM::Status S_INSUFFICIENT_ENTROPY = 0x000000EB;

  interface Iterator {
    typedef CICM::UInt32 Status;
    const CICM::Iterator::Status C_ITERATOR_HAS_NEXT = 0x00006031;
    const CICM::Iterator::Status C_ITERATOR_NO_MORE = 0x00006032;

    CICM::Status has_next(
      out CICM::Iterator::Status has_next );
  };

  typedef CICM::CharString ModuleId;

  interface CryptoModule {
    readonly attribute CICM::ModuleId module_id;
    readonly attribute CICM::CharString manufacturer;
    readonly attribute CICM::CharString model;
    readonly attribute CICM::CharString serial_number;
    readonly attribute CICM::CharString module_version;
    readonly attribute CICM::CharString software_version;
    readonly attribute CICM::CharString driver_version;
    readonly attribute CICM::CharString library_version;
    readonly attribute CICM::RoleId role;
    attribute CICM::CharString date_time;
    readonly attribute CICM::SymKeyManager sym_key_manager;
    readonly attribute CICM::AsymKeyManager asym_key_manager;
    readonly attribute CICM::KeyDatabase key_database;
    readonly attribute CICM::ChannelManager channel_manager;
    readonly attribute CICM::ModuleEventManager event_manager;
    readonly attribute CICM::PackageManager package_manager;
    readonly attribute CICM::TokenManager token_manager;
    readonly attribute CICM::UserManager user_manager;
    readonly attribute CICM::LoginManager login_manager;
    readonly attribute CICM::TestManager test_manager;
    readonly attribute CICM::LogManager log_manager;

    CICM::Status configure_fill_interface(
      in  CICM::Buffer interface_parameters,
      in  CICM::LocalPort fill_port );

    CICM::Status reset();
  };

  interface CICMRoot {
    CICM::Status get_module_by_id(
      in  CICM::ModuleId id,
      out CICM::CryptoModule crypto_module_ref );
  };
};</pre>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Daniel J. Lanz</span> 
	  <span class="n hidden">
		<span class="family-name">Lanz</span>
	  </span>
	</span>
	<span class="org vcardline">The MITRE Corporation</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:dlanz@mitre.org">dlanz@mitre.org</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Lev Novikov</span> 
	  <span class="n hidden">
		<span class="family-name">Novikov</span>
	  </span>
	</span>
	<span class="org vcardline">The MITRE Corporation</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:lnovikov@mitre.org">lnovikov@mitre.org</a></span>

  </address>
</div>

</body>
</html>