<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Password Authenticated Connection Establishment with IKEv2</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Password Authenticated Connection Establishment with IKEv2">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 60em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 60em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">D. Kuegler</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Bundesamt fuer Sicherheit in der</td></tr>
<tr><td class="header">Intended status: Experimental</td><td class="header">Informationstechnik (BSI)</td></tr>
<tr><td class="header">Expires: January 12, 2011</td><td class="header">Y. Sheffer</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Independent</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">July 11, 2010</td></tr>
</table></td></tr></table>
<h1><br />Password Authenticated Connection Establishment with IKEv2<br />draft-kuegler-ipsecme-pace-ikev2-02</h1>

<h3>Abstract</h3>

<p>
IKEv2 does not allow secure peer authentication when using short credential strings, i.e. passwords. Several proposals have been made to
integrate password-authentication protocols into IKE.
This document provides an adaptation of PACE (Password Authenticated Connection Establishment) to the setting of IKEv2
and demonstrates the advantages of this integration.

</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted  in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF).  Note that other groups may also distribute
working documents as Internet-Drafts.  The list of current
Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
This Internet-Draft will expire on January 12, 2011.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the Simplified BSD License.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">1.1.</a>&nbsp;
Terminology<br />
<a href="#anchor3">2.</a>&nbsp;
Overview<br />
<a href="#sequence">3.</a>&nbsp;
Protocol Sequence<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">3.1.</a>&nbsp;
The IKE_SA_INIT Exchange<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">3.2.</a>&nbsp;
The IKE_PACE Exchange<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">3.3.</a>&nbsp;
The IKE_PACE_AUTH Exchange<br />
<a href="#mapping">4.</a>&nbsp;
Mapping<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">4.1.</a>&nbsp;
MODP Diffie Hellman<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">4.2.</a>&nbsp;
Elliptic Curve Diffie Hellman<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">4.3.</a>&nbsp;
Validation<br />
<a href="#anchor10">5.</a>&nbsp;
Protocol Details<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">5.1.</a>&nbsp;
Password Processing<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">5.2.</a>&nbsp;
The PACE_SUPPORTED Notification<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">5.3.</a>&nbsp;
The ENONCE Payload<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">5.4.</a>&nbsp;
The PKE (PKEi/PKEr) Payloads<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">5.5.</a>&nbsp;
PACE and Session Resumption<br />
<a href="#anchor16">6.</a>&nbsp;
Security Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor17">6.1.</a>&nbsp;
Credential Security Assumptions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">6.2.</a>&nbsp;
Vulnerability to Passive and Active Attacks<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor19">6.3.</a>&nbsp;
Perfect Forward Secrecy<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#randomness">6.4.</a>&nbsp;
Randomness<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor20">6.5.</a>&nbsp;
Identity Protection<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor21">6.6.</a>&nbsp;
Denial of Service<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor22">6.7.</a>&nbsp;
Choice of Encryption Algorithms<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#security-proof">6.8.</a>&nbsp;
Security Model and Security Proof<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor23">6.9.</a>&nbsp;
Long-Term Credential Storage<br />
<a href="#anchor24">7.</a>&nbsp;
IANA Considerations<br />
<a href="#rfc.references1">8.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">8.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">8.2.</a>&nbsp;
Informative References<br />
<a href="#anchor27">Appendix&nbsp;A.</a>&nbsp;
Protocol Selection Criteria<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor28">A.1.</a>&nbsp;
Security Criteria<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor29">A.2.</a>&nbsp;
Intellectual Property Criteria<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor30">A.3.</a>&nbsp;
Miscellaneous Criteria<br />
<a href="#anchor31">Appendix&nbsp;B.</a>&nbsp;
Change Log<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>
PACE <a class='info' href='#TR03110'>[TR03110]<span> (</span><span class='info'>, &ldquo;BSI TR-03110, Advanced Security Mechanisms for Machine Readable Travel Documents - 	  Extended Access Control (EAC), Password Authenticated Connection Establishment (PACE), 	  and Restricted Identification (RI), Version 2.03,&rdquo; 2010.</span><span>)</span></a> is a security protocol that establishes a mutually authenticated (and encrypted) channel between two parties based on weak (short) passwords. PACE provides strong session keys that are independent of the strength of the password. 
This draft describes the integration of PACE into IKEv2 (<a class='info' href='#RFC4306'>[RFC4306]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a> and <a class='info' href='#I-D.ietf-ipsecme-ikev2bis'>[I&#8209;D.ietf&#8209;ipsecme&#8209;ikev2bis]<span> (</span><span class='info'>Kaufman, C., Hoffman, P., Nir, Y., and P. Eronen, &ldquo;Internet Key Exchange Protocol: IKEv2,&rdquo; May&nbsp;2010.</span><span>)</span></a>) as a new authentication mode, analogous to the existing certificate and PSK authentication modes.

</p>
<p>
Some of the advantages of our approach, compared to the existing IKEv2, include:
</p>
<ul class="text">
<li>The current best practice to implement password authentication in IKE involves certificate-based authentication of the server plus
some EAP method to authenticate the client. This involves two non-trivial infrastructure components (PKI and EAP/AAA). Moreover,
certificate authentication is hard to get right, and often depends for its security on unreliable user behavior.
</li>
<li>Alternatively, native IKEv2 shared secret authentication can be used with passwords. This usage however is insecure, specifically
it is vulnerable to active attackers.
</li>
<li>Some newer EAP methods can be used for mutual authentication,
and combined with <a class='info' href='#I-D.ietf-ipsecme-eap-mutual'>[I&#8209;D.ietf&#8209;ipsecme&#8209;eap&#8209;mutual]<span> (</span><span class='info'>Eronen, P., Tschofenig, H., and Y. Sheffer, &ldquo;An Extension for EAP-Only Authentication in IKEv2,&rdquo; June&nbsp;2010.</span><span>)</span></a> can be well integrated into IKEv2.
This is certainly an option in some cases, but the current proposal may be simpler to implement.
</li>
</ul><p>
Compared to other protocols aiming at similar goals, PACE has several advantages. PACE was designed to be free of patents, and to allow for a high level of flexibility with respect to cryptographic algorithms, e.g. it can be implemented based on standard Diffie Hellman as well as Elliptic Curve Diffie Hellman without any restrictions on the mathematical group to be used other than the requirement that the group is cryptographically secure. The protocol itself is also proven to be cryptographically secure <a class='info' href='#PACEsec'>[PACEsec]<span> (</span><span class='info'>, &ldquo;Security Analysis of the PACE Key-Agreement Protocol&quot;, Information Security Conference (ISC) 2009, 	  Lecture Notes in Computer Science, Volume 5735, pp. 33-48, Springer-Verlag.,&rdquo; 2009.</span><span>)</span></a>.

</p>
<p>
The integration aims at keeping as much as possible of IKEv2 unchanged,
e.g. the mechanisms used to establish Child SAs as provided by IKEv2 are maintained with no change. 

</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Terminology</h3>

<p>
The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in RFC 2119 <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.

</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Overview</h3>

<p>
The following notation is used in this draft:
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

E()    Symmetric encryption
D()    Symmetric decryption
KA()   Key agreement
Map()  Mapping function
Pwd    Shared Password
KPwd   Symmetric key derived from a password Pwd
G      Static group generator
GE     Ephemeral group generator
ENONCE Encrypted nonce
PKEi   Ephemeral public key of the initiator
SKEi   Ephemeral secret key of the initiator
PKEr   Ephemeral public key of the responder
SKEr   Ephemeral secret key of the responder
AUTH   Authentication token

</pre></div><p>


</p>
<p>

At a high level the following steps are performed by the initiator and the responder.
They result in exchanges IKE_PACE and IKE_PACE_AUTH as described in <a class='info' href='#sequence'>Section&nbsp;3<span> (</span><span class='info'>Protocol Sequence</span><span>)</span></a>
that are performed directly after IKE_SA_INIT and fully replace IKE_AUTH.
</p>
<ol class="text">
<li>
The initiator randomly and uniformly chooses a nonce, encrypts the nonce using the password,
and sends the ciphertext ENONCE to the responder.

</li>
<li>
The responder recovers the plaintext nonce with the help of the shared password Pwd.

</li>
<li>
The initiator and the responder perform the following steps:

<blockquote class="text"><dl>
<dt>A.</dt>
<dd>A mapping function Map() is used to derive an ephemeral generator GE = Map(G,s) from
the exchanged nonce s and the generator G of the used group. 

</dd>
<dt>B.</dt>
<dd>They perform an anonymous Diffie-Hellman key agreement based on the ephemeral generator
and compute the shared secret PACESharedSecret.

</dd>
<dt>C.</dt>
<dd>
They generate, exchange, and verify the authentication token AUTH using the shared secret PACESharedSecret.

</dd>
</dl></blockquote>

</li>
</ol><p>

</p>
<a name="sequence"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Protocol Sequence</h3>

<p>
The protocol consists of three exchanges, IKE_SA_INIT, IKE_PACE, and IKE_PACE_AUTH as follows:

</p><br /><hr class="insert" />
<a name="figure-exchange"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

  Initiator                      Responder
  ---------                      ---------

  IKE_SA_INIT:

  HDR, SAi1, KEi, Ni, N(PACE_SUPPORTED)  -&gt;

                              &lt;- HDR, SAr1, KEr, Nr, N(PACE_SUPPORTED)

  IKE_PACE:

  HDR, SK{IDi, [IDr,], SAi2,
          TSi, TSr, ENONCE, PKEi} -&gt;

                              &lt;- HDR, SK{IDr, PKEr}

  IKE_PACE_AUTH:

  HDR, SK{AUTH} -&gt;

                              &lt;- HDR, SK{AUTH, SAr2, TSi, TSr}

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: IKE SA Setup with PACE&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
The IKE_SA_INIT Exchange</h3>

<p>
The initiator sends a PACE_SUPPORTED notification to indicate its support of this extension,
and its wish to authenticate using a password. If the responder
accepts, it responds with the same notification. Otherwise, it omits the notification to indicate
a preference for a regular IKE exchange. In the case of anti-DOS
cookies (Sec. 2.6 of <a class='info' href='#RFC4306'>[RFC4306]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>), the notification MUST be resent by
each peer every time it sends its IKE_SA_INIT message.

</p>
<p>
If PACE is supported, the algorithms negotiated in SAi1 and SAr1 are also used for the execution of PACE,
i.e. the key agreement protocol (standard Diffie Hellman or Elliptic Curve Diffie Hellman),
the group to be used, and the encryption algorithm.

</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
The IKE_PACE Exchange</h3>

<p>This new exchange (number TBD by IANA) is the first part of the PACE authentication of the peers.
</p>
<p>This exchange MUST NOT be used unless both peers indicated support of this protocol.
On the other hand, to allow for future extensibility, the initiator MAY choose to proceed with IKE_AUTH instead of IKE_PACE,
in which case the peers revert to a normal IKE exchange.
</p>
<p>
The initiator selects a random nonce s and encrypts it to form ENONCE using the password Pwd, as described next.

</p>
<p>
The shared password is not used as-is. Instead, it SHOULD be converted into a "stored password" SPwd,
so that the plaintext password does not need to be stored for long periods. SPwd is defined as:
</p>
<blockquote class="text">
<p>
SPwd = prf("IKE with PACE", Pwd)

</p>
</blockquote><p>
where the literal string consists of ASCII characters with no zero terminator. If the negotiated prf requires a fixed-size key, the literal string is as needed either truncated or padded with zero octets on the right.
</p>
<blockquote class="text">
<p>
KPwd = prf+(Ni | Nr, SPwd)

</p>
</blockquote><p>
where Ni and Nr are the regular IKE nonces, stripped of any headers. 
If the negotiated prf takes a fixed-length key and the lengths of Ni and Nr do not add up to that length,
half the bits must come from Ni and half from Nr, taking the first bits of each.
"prf+" is defined in Sec. 2.13 of <a class='info' href='#RFC4306'>[RFC4306]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>.
The length of KPwd is determined by the key length of the negotiated encryption algorithm.

</p>
<p>
A nonce s is randomly selected by the initiator (see <a class='info' href='#randomness'>Section&nbsp;6.4<span> (</span><span class='info'>Randomness</span><span>)</span></a> for additional
considerations). The length of s is the block size of the
encryption algorithm that was negotiated for the IKE SA, or 32 octets if no such block size exists.
To clarify, stream ciphers constructed by applying a block cipher in counter mode, are to be treated as having no block size.

</p>
<p>
Note: in the case of block ciphers, is critical to the security of the protocol that the nonce be encrypted with no padding.

</p>
<p>
KPwd is now used with the encryption transform to encrypt the nonce:
</p>
<blockquote class="text">
<p>
ENONCE = E(KPwd, s) 

</p>
</blockquote><p>
If an Initialization Vector (IV) is required by the cipher, it MUST be random and is included in the ENONCE payload.

</p>
<p>
The initiator maps the nonce to an ephemeral generator of the group as described in <a class='info' href='#mapping'>Section&nbsp;4<span> (</span><span class='info'>Mapping</span><span>)</span></a>, chooses randomly and uniformly an ephemeral key pair (SKEi,PKEi) based on the ephemeral generator and finally generates the payloads ENONCE containing the encrypted nonce and PKEi containing the ephemeral public key.

</p>
<p>
The responder decrypts the received encrypted nonce s = D(KPwd, ENONCE), performs the mapping and randomly and uniformly chooses an ephemeral key pair (SKEr,PKEr) based on the ephemeral generator. The responder generates the PKEr payload containing the ephemeral public key.

</p>
<p>
During the Diffie-Hellman key agreement, each party MUST check that the two public keys PKEi and PKEr differ. Otherwise,
it MUST abort the protocol.

</p>
<p>The IKE_PACE request is equivalent to the IKE_AUTH request in a normal IKEv2 exchange,
i.e. any payload which is valid in an IKE_AUTH request
is valid (with the same semantics) in the IKE_PACE request. In particular,
certificate-related payloads are allowed, even though their use may not be practical
within this mode.
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
The IKE_PACE_AUTH Exchange</h3>

<p>This new exchange (number TBD by IANA) is the second part of the PACE authentication of the peers.
</p>
<p>
The initiator and the responder calculate the shared secret PACESharedSecret:
</p>
<blockquote class="text">
<p>PACESharedSecret = KA(SKEi, PKEi, GE) = KA(SKEr, PKEr, GE),
</p>
</blockquote><p>
where KA denotes the Diffie Hellman key agreement, e.g. (for MODP groups) modular exponentiation.
Then they calculate the authentication tokens AUTHi and AUTHr.

</p>
<p>
The initiator calculates:

</p>
<p>
</p>
<blockquote class="text">
<p>
AUTHi = prf(prf+(Ni | Nr, PACESharedSecret), &lt;InitiatorSignedOctets&gt; | PKEr) 

</p>
</blockquote><p>
See Sec. 2.15 of <a class='info' href='#RFC4306'>[RFC4306]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a> (further clarified in Sec. 2.15 of <a class='info' href='#I-D.ietf-ipsecme-ikev2bis'>[I&#8209;D.ietf&#8209;ipsecme&#8209;ikev2bis]<span> (</span><span class='info'>Kaufman, C., Hoffman, P., Nir, Y., and P. Eronen, &ldquo;Internet Key Exchange Protocol: IKEv2,&rdquo; May&nbsp;2010.</span><span>)</span></a>)
for the definition of signed octets.

</p>
<p>
The responder calculates:
</p>
<blockquote class="text">
<p>
AUTHr = prf(prf+(Ni | Nr, PACESharedSecret), &lt;ResponderSignedOctets&gt; | PKEi) 

</p>
</blockquote><p>
The authentication tokens are then exchanged and each of them MUST be verified by the other party. The behavior when this
verification fails is unchanged from <a class='info' href='#RFC4306'>[RFC4306]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>.

</p>
<p>The IKE_PACE_AUTH response is equivalent to the IKE_AUTH response in a normal IKEv2 exchange,
i.e. any payload which is valid in an IKE_AUTH response
is valid (with the same semantics) in the IKE_PACE_AUTH response.
</p>
<p>Following authentication, all temporary values MUST be deleted by the peers, including in particular
s, the ephemeral generator and public keys, and PACESharedSecret.
</p>
<a name="mapping"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Mapping</h3>

<p>
The mapping is based on a second anonymous Diffie-Hellman key agreement protocol to create a shared
secret which is used together with the exchanged nonce to calculate a common secret generator of the group.

</p>
<p>
While in <a class='info' href='#TR03110'>[TR03110]<span> (</span><span class='info'>, &ldquo;BSI TR-03110, Advanced Security Mechanisms for Machine Readable Travel Documents - 	  Extended Access Control (EAC), Password Authenticated Connection Establishment (PACE), 	  and Restricted Identification (RI), Version 2.03,&rdquo; 2010.</span><span>)</span></a> the generation of the shared secret is part of the mapping,
in the setting of IKEv2 a shared secret SASharedSecret has already been generated as part of the IKE_SA_INIT step.
Using the notation of <a class='info' href='#RFC4306'>[RFC4306]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>,
</p>
<blockquote class="text">
<p>SASharedSecret = g^ir
</p>
</blockquote><p>

</p>
<p>
Let G and GE be the generator of the negotiated DH group, and the calculated ephemeral generator, respectively. The following subsections describe the mapping for different Diffie Hellman variants.

</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
MODP Diffie Hellman</h3>

<p>
The function Map:G->GE is defined as GE = G^s * SASharedSecret.

</p>
<p>

Note that the protocol will fail if G^s = 1/SASharedSecret. If s is chosen randomly, this event occurs with negligible probability. In implementations that detect such a failure, the initiator SHOULD choose s again.

</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Elliptic Curve Diffie Hellman</h3>

<p>
The function Map:G->GE is defined as GE = s*G + SASharedSecret.

</p>
<p>
Note that the protocol will fail if s*G = -SharedSecret. If s is chosen randomly, this event occurs with negligible probability. In implementations that detect such a failure, the initiator SHOULD choose s again.

</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
Validation</h3>

<p>
Implementations MUST verify that the shared secrets SASharedSecret and PACESharedSecret are elements of the group generated by G to prevent small subgroup attacks.

</p>
<p>
It is RECOMMENDED to use the public key validation method (or an Elliptic Curve equivalent) described in Section 2.1.5 of <a class='info' href='#RFC2631'>[RFC2631]<span> (</span><span class='info'>Rescorla, E., &ldquo;Diffie-Hellman Key Agreement Method,&rdquo; June&nbsp;1999.</span><span>)</span></a>. 

</p>
<p>
For Elliptic Curves compatible cofactor multiplication <a class='info' href='#TR03111'>[TR03111]<span> (</span><span class='info'>, &ldquo;BSI TR-03111, &quot;Elliptic Curve Cryptography&quot;, Version 1.11,&rdquo; 2009.</span><span>)</span></a> MAY be used instead of public key validation. In this case implementations MUST check that PACESharedSecret is not the point at infinity. 

</p>
<p>
Any failure in the validation MUST be interpreted as an attack, and the protocol aborted.

</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Protocol Details</h3>

<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Password Processing</h3>

<p>
	The input password string SHOULD be processed according to the
       rules of the <a class='info' href='#RFC4013'>[RFC4013]<span> (</span><span class='info'>Zeilenga, K., &ldquo;SASLprep: Stringprep Profile for User Names and Passwords,&rdquo; February&nbsp;2005.</span><span>)</span></a> profile of <a class='info' href='#RFC3454'>[RFC3454]<span> (</span><span class='info'>Hoffman, P. and M. Blanchet, &ldquo;Preparation of Internationalized Strings (&quot;stringprep&quot;),&rdquo; December&nbsp;2002.</span><span>)</span></a>.
       A password SHOULD be
       considered a "stored string" per <a class='info' href='#RFC3454'>[RFC3454]<span> (</span><span class='info'>Hoffman, P. and M. Blanchet, &ldquo;Preparation of Internationalized Strings (&quot;stringprep&quot;),&rdquo; December&nbsp;2002.</span><span>)</span></a> and unassigned code
       points are therefore prohibited.  The output is the binary
       representation of the processed UTF-8 character string.
       Prohibited output and unassigned codepoints encountered in
       SASLprep preprocessing SHOULD cause a preprocessing failure
       and the output SHOULD NOT be used.
          
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
The PACE_SUPPORTED Notification</h3>

<p>This protocol defines a new PACE_SUPPORTED notification, with type number TBD by IANA. This is an empty notification:
The Protocol ID and SPI size fields are
  set to zero, and there is no additional data associated with
  this notification.
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3"></a><h3>5.3.&nbsp;
The ENONCE Payload</h3>

<p>This protocol defines a new ENONCE (encrypted nonce) payload, with payload type TBD by IANA. Its format is as follows:
</p>
<p>
          <br /><hr class="insert" />
<a name="enonce-payload"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Next Payload  |C|  RESERVED   |         Payload Length        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                     Initialization Vector                     |
|    (optional, length is block size for encryption algorithm)  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                        Encrypted Nonce                        ~
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
~                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;2: ENONCE Payload Structure&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

        
</p>
<p>The length of the nonce MUST be an integer multiple of the selected encryption algorithm's block size (if any). Note
that the payload format does not support any padding of the encrypted data.
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.4"></a><h3>5.4.&nbsp;
The PKE (PKEi/PKEr) Payloads</h3>

<p>These payloads have an identical format to the IKEv2 KE payload.
However, this protocol defines a new payload type named PKE (Public Key - Ephemeral), whose value is TBD by IANA.
Since only one Diffie Hellman group is negotiated, the group denoted by these payloads MUST be identical
to the one used in the KE payloads.
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.5"></a><h3>5.5.&nbsp;
PACE and Session Resumption</h3>

<p>A session resumption <a class='info' href='#RFC5723'>[RFC5723]<span> (</span><span class='info'>Sheffer, Y. and H. Tschofenig, &ldquo;Internet Key Exchange Protocol Version 2 (IKEv2) Session Resumption,&rdquo; January&nbsp;2010.</span><span>)</span></a> ticket may be requested during the IKE_PACE/IKE_PACE_AUTH exchanges.
The request MUST be sent in the IKE_PACE request, and any response MUST be sent in the IKE_PACE_AUTH response.
</p>
<p>PACE should be considered an "authentication method", in the sense of Sec. 5 of <a class='info' href='#RFC5723'>[RFC5723]<span> (</span><span class='info'>Sheffer, Y. and H. Tschofenig, &ldquo;Internet Key Exchange Protocol Version 2 (IKEv2) Session Resumption,&rdquo; January&nbsp;2010.</span><span>)</span></a>,
which means that its use MUST be noted in the protected ticket.
</p>
<p>Note that even if the initial authentication used PACE and its new exchange types, session resumption will still
include the normal IKE_AUTH exchange.
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Security Considerations</h3>

<p>A major goal of this protocol has been to maintain the level of security provided by IKEv2. What follows
is an analysis of this protocol. The reader is referred to <a class='info' href='#RFC4306'>[RFC4306]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>
and <a class='info' href='#I-D.ietf-ipsecme-ikev2bis'>[I&#8209;D.ietf&#8209;ipsecme&#8209;ikev2bis]<span> (</span><span class='info'>Kaufman, C., Hoffman, P., Nir, Y., and P. Eronen, &ldquo;Internet Key Exchange Protocol: IKEv2,&rdquo; May&nbsp;2010.</span><span>)</span></a> for the generic IKEv2 security considerations.
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
Credential Security Assumptions</h3>

<p>This protocol makes no assumption on the strength of the shared credential.
Best common practices regarding minimal password length, use of multiple character classes etc. SHOULD be followed.
</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
Vulnerability to Passive and Active Attacks</h3>

<p>The protocol is secure against both passive and active attackers. See <a class='info' href='#security-proof'>Section&nbsp;6.8<span> (</span><span class='info'>Security Model and Security Proof</span><span>)</span></a> for a security proof.

</p>
<p>
While not attacking the cryptography, an attacker can still perform a standard password guessing attack.
To mitigate such attacks, an implementation MUST include standard protections,
such as rate limiting the number of allowed password guessing attempts, possibly locking identities out
after a certain number of failed attempts etc. Note that the protocol is symmetric
and therefore this guidance applies to client-side implementations as well.

</p>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.3"></a><h3>6.3.&nbsp;
Perfect Forward Secrecy</h3>

<p>TBD.
</p>
<a name="randomness"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.4"></a><h3>6.4.&nbsp;
Randomness</h3>

<p>The security of this protocol depends on the quality generation of random quantities, and see Sec. 5
of <a class='info' href='#RFC4306'>[RFC4306]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a> for more details. Specifically, any deviation from randomness of the nonce s
might compromise the password, when the nonce is encrypted with a stream cipher. Therefore, it is strongly RECOMMENDED
that when using a stream cipher, the initiator passes the raw random material through a strong prf
to ensure the statistical qualities of the nonce.

</p>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.5"></a><h3>6.5.&nbsp;
Identity Protection</h3>

<p>This protocol is identical to IKEv2 in the quality of identity protection it provides.
Both peers' identities are secure from passive attackers, and both peers' identities are exposed to active,
man-in-the-middle attackers.
</p>
<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.6"></a><h3>6.6.&nbsp;
Denial of Service</h3>

<p>We are not aware of any new denial-of-service attack vector enabled by this protocol. 
</p>
<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.7"></a><h3>6.7.&nbsp;
Choice of Encryption Algorithms</h3>

<p>Any transforms negotiated for IKEv2 may be used by this protocol.
</p>
<a name="security-proof"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.8"></a><h3>6.8.&nbsp;
Security Model and Security Proof</h3>

<p>
TODO: PACE is cryptographically proven secure in <a class='info' href='#PACEsec'>[PACEsec]<span> (</span><span class='info'>, &ldquo;Security Analysis of the PACE Key-Agreement Protocol&quot;, Information Security Conference (ISC) 2009, 	  Lecture Notes in Computer Science, Volume 5735, pp. 33-48, Springer-Verlag.,&rdquo; 2009.</span><span>)</span></a>.
The application of PACE in IKEv2 however is however a slightly different setting that
requires a modification of the proof. A new proof will be provided once the details of the integration are fixed.

</p>
<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.9"></a><h3>6.9.&nbsp;
Long-Term Credential Storage</h3>

<p>
This protocol does not require peers to store the plaintext password. Instead, the value KPwd SHOULD be stored by both peers.

</p>
<p>
It has been suggested to generate a "long" shared secret after the initial authentication,
such that the peers can use it later for standard preshared-secret authentication, in lieu of the short password.
We have not been able to identify sufficient security benefits with this approach that would justify the added complexity.

</p>
<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
IANA Considerations</h3>

<p>
IANA is requested to allocate (has allocated) the following values:
</p>
<ul class="text">
<li>The PACE_SUPPORTED notification type (TBD) from the "IKEv2 Notify Message Types - Status Types" registry.
</li>
<li>A payload type (TBD) for the Encrypted Nonce (ENONCE) payload from the "IKEv2 Payload Types" registry.
</li>
<li>A payload type (TBD) for the Ephemeral Public Key (PKE) payload from the same registry.
</li>
<li>An authentication method (TBD) for Password Authenticated Connection Establishment (PACE)
from the "IKEv2 Authentication Method" registry.
</li>
<li>An exchange type (TBD) for the IKE_PACE exchange, from the "IKEv2 Exchange Types" registry.
</li>
<li>An exchange type (TBD) for the IKE_PACE_AUTH exchange, from the same registry.
</li>
</ul><p>
This document does not define any new registries.

</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>8.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2631">[RFC2631]</a></td>
<td class="author-text"><a href="mailto:ekr@rtfm.com">Rescorla, E.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2631">Diffie-Hellman Key Agreement Method</a>,&rdquo; RFC&nbsp;2631, June&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2631.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3454">[RFC3454]</a></td>
<td class="author-text">Hoffman, P. and M. Blanchet, &ldquo;<a href="http://tools.ietf.org/html/rfc3454">Preparation of Internationalized Strings ("stringprep")</a>,&rdquo; RFC&nbsp;3454, December&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3454.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4013">[RFC4013]</a></td>
<td class="author-text">Zeilenga, K., &ldquo;<a href="http://tools.ietf.org/html/rfc4013">SASLprep: Stringprep Profile for User Names and Passwords</a>,&rdquo; RFC&nbsp;4013, February&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4013.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4306">[RFC4306]</a></td>
<td class="author-text">Kaufman, C., &ldquo;<a href="http://tools.ietf.org/html/rfc4306">Internet Key Exchange (IKEv2) Protocol</a>,&rdquo; RFC&nbsp;4306, December&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4306.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>8.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.harkins-ipsecme-pake-criteria">[I-D.harkins-ipsecme-pake-criteria]</a></td>
<td class="author-text">Harkins, D., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-harkins-ipsecme-pake-criteria-00.txt">Password-Based Authentication in IKEv2: Selection Criteria and Considerations</a>,&rdquo; draft-harkins-ipsecme-pake-criteria-00 (work in progress), April&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-harkins-ipsecme-pake-criteria-00.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-ipsecme-eap-mutual">[I-D.ietf-ipsecme-eap-mutual]</a></td>
<td class="author-text">Eronen, P., Tschofenig, H., and Y. Sheffer, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-ipsecme-eap-mutual-05.txt">An Extension for EAP-Only Authentication in IKEv2</a>,&rdquo; draft-ietf-ipsecme-eap-mutual-05 (work in progress), June&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-ipsecme-eap-mutual-05.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-ipsecme-ikev2bis">[I-D.ietf-ipsecme-ikev2bis]</a></td>
<td class="author-text">Kaufman, C., Hoffman, P., Nir, Y., and P. Eronen, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-ipsecme-ikev2bis-11.txt">Internet Key Exchange Protocol: IKEv2</a>,&rdquo; draft-ietf-ipsecme-ikev2bis-11 (work in progress), May&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-ipsecme-ikev2bis-11.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="PACEsec">[PACEsec]</a></td>
<td class="author-text">&ldquo;<a href="http://eprint.iacr.org/2009/624">Security Analysis of the PACE Key-Agreement Protocol", Information Security Conference (ISC) 2009,
	  Lecture Notes in Computer Science, Volume 5735, pp. 33-48, Springer-Verlag.</a>,&rdquo; 2009.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5723">[RFC5723]</a></td>
<td class="author-text">Sheffer, Y. and H. Tschofenig, &ldquo;<a href="http://tools.ietf.org/html/rfc5723">Internet Key Exchange Protocol Version 2 (IKEv2) Session Resumption</a>,&rdquo; RFC&nbsp;5723, January&nbsp;2010 (<a href="http://www.rfc-editor.org/rfc/rfc5723.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="TR03110">[TR03110]</a></td>
<td class="author-text">&ldquo;BSI TR-03110, Advanced Security Mechanisms for Machine Readable Travel Documents -
	  Extended Access Control (EAC), Password Authenticated Connection Establishment (PACE),
	  and Restricted Identification (RI), Version 2.03,&rdquo; 2010.</td></tr>
<tr><td class="author-text" valign="top"><a name="TR03111">[TR03111]</a></td>
<td class="author-text">&ldquo;BSI TR-03111, "Elliptic Curve Cryptography", Version 1.11,&rdquo; 2009.</td></tr>
</table>

<a name="anchor27"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Protocol Selection Criteria</h3>

<p>
To support the selection of a password-based protocol for inclusion in IKEv2, a number of criteria
are provided in <a class='info' href='#I-D.harkins-ipsecme-pake-criteria'>[I&#8209;D.harkins&#8209;ipsecme&#8209;pake&#8209;criteria]<span> (</span><span class='info'>Harkins, D., &ldquo;Password-Based Authentication in IKEv2: Selection Criteria and Considerations,&rdquo; April&nbsp;2010.</span><span>)</span></a>. In the following sections,
those criteria are applied to the PACE protocol.

</p>
<a name="anchor28"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1"></a><h3>A.1.&nbsp;
Security Criteria</h3>

<p>
    </p>
<blockquote class="text"><dl>
<dt>SEC1:</dt>
<dd>
PACE is a zero knowledge protocol.

</dd>
<dt>SEC2:</dt>
<dd>
The protocol supports perfect forward secrecy and is resistant to replay attacks.

</dd>
<dt>SEC3:</dt>
<dd>
The identity protection provided by IKEv2 remains unchanged.

</dd>
<dt>SEC4:</dt>
<dd>
Any cryptographically secure Diffie-Hellman group can be used.

</dd>
<dt>SEC5:</dt>
<dd>
The protocol is proven secure in the Bellare-Pointcheval-Rogaway model.

</dd>
<dt>SEC6:</dt>
<dd>
Strong session keys are generated.

</dd>
<dt>SEC7:</dt>
<dd>
A transform of the password can be used instead of the password itself.

</dd>
</dl></blockquote><p>

</p>
<a name="anchor29"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.2"></a><h3>A.2.&nbsp;
Intellectual Property Criteria</h3>

<p>
    </p>
<blockquote class="text"><dl>
<dt>IPR1:</dt>
<dd>
The first draft of <a class='info' href='#TR03110'>[TR03110]<span> (</span><span class='info'>, &ldquo;BSI TR-03110, Advanced Security Mechanisms for Machine Readable Travel Documents - 	  Extended Access Control (EAC), Password Authenticated Connection Establishment (PACE), 	  and Restricted Identification (RI), Version 2.03,&rdquo; 2010.</span><span>)</span></a> was published on May 21, 2007.

</dd>
<dt>IPR2:</dt>
<dd>
BSI has developed PACE aiming to be free of patents. BSI has not applied for a patent on PACE.

</dd>
<dt>IPR3:</dt>
<dd>
The protocol itself is believed to be free of IPR.

</dd>
</dl></blockquote><p>

</p>
<a name="anchor30"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.3"></a><h3>A.3.&nbsp;
Miscellaneous Criteria</h3>

<p>
    </p>
<blockquote class="text"><dl>
<dt>MISC1:</dt>
<dd>

  One additional exchange is required.

</dd>
<dt>MISC2:</dt>
<dd>
  The protocol requires the following operations per entity: 

<ul class="text">
<li>
 one key derivation from the password,

</li>
<li>
 one symmetric encryption or decryption,

</li>
<li>
 one multi-exponentiation for the mapping,

</li>
<li>
 one exponentiation for the key pair generation,

</li>
<li>
 one exponentiation for the shared secret calculation, and 

</li>
<li>
 two symmetric authentications (generation and verification).

</li>
</ul>

</dd>
<dt>MISC3:</dt>
<dd>
  The performance is independent of the type/size of password.

</dd>
<dt>MISC4:</dt>
<dd>
  Internationalization of character-based passwords is supported.

</dd>
<dt>MISC5:</dt>
<dd>
  The protocol uses the same group as negotiated for IKEv2.

</dd>
<dt>MISC6:</dt>
<dd>
  The protocol fits into the request/response nature of IKE.

</dd>
<dt>MISC7:</dt>
<dd>
  The password-based symmetric encryption must be additionally negotiated.

</dd>
<dt>MISC8:</dt>
<dd>
  Neither trusted third parties nor clock synchronization are required.

</dd>
<dt>MISC9:</dt>
<dd>
  Only general cryptographic primitives are required.

</dd>
<dt>MISC10:</dt>
<dd>
 Any secure variant of Diffie Hellman (e.g. standard or Elliptic Curve) can be used.

</dd>
<dt>MISC11:</dt>
<dd>
 The protocol can be implemented easily based on existing cryptographic primitives.

</dd>
</dl></blockquote><p>

</p>
<a name="anchor31"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B"></a><h3>Appendix B.&nbsp;
Change Log</h3>

<p>Note to RFC Editor: please remove this appendix before publication.
</p>
<a name="anchor32"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B.1"></a><h3>B.1.&nbsp;
-02</h3>

<p>Added security considerations. Changed encryption of the nonce. Simplified the derivation of the AUTH payloads.
</p>
<a name="anchor33"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B.2"></a><h3>B.2.&nbsp;
draft-kuegler-ipsecme-pace-ikev2-01</h3>

<p>Formalized the protocol: added payload formats, error behavior etc.
</p>
<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Dennis Kuegler</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Bundesamt fuer Sicherheit in der Informationstechnik (BSI)</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Postfach 200363</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Bonn  53133</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Germany</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:dennis.kuegler@bsi.bund.de">dennis.kuegler@bsi.bund.de</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Yaron Sheffer</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Independent</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:yaronf.ietf@gmail.com">yaronf.ietf@gmail.com</a></td></tr>
</table>
</body></html>
