<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>IPv6-to-IPv6 Network Prefix Translation</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="IPv6-to-IPv6 Network Prefix Translation">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 60em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 60em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">M. Wasserman</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Painless Security</td></tr>
<tr><td class="header">Intended status: Experimental</td><td class="header">F. Baker</td></tr>
<tr><td class="header">Expires: August 1, 2011</td><td class="header">Cisco Systems</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">January 28, 2011</td></tr>
</table></td></tr></table>
<h1><br />IPv6-to-IPv6 Network Prefix Translation<br />draft-mrw-nat66-07</h1>

<h3>Abstract</h3>

<p>This document describes a stateless, transport-agnostic IPv6-to-IPv6
      Network Prefix Translation (NPTv6) function that provides the address
      independence benefit associated with IPv4-to-IPv4 NAT (NAT44), and in
      addition provides a 1:1 relationship between addresses in the "inside"
      and "outside" prefixes, preserving end to end reachability at the
      network layer.
</p>
<h3>Requirements Terminology</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
      "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
      document are to be interpreted as described in <a class='info' href='#RFC2119'>RFC 2119<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a> [RFC2119].
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted  in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF).  Note that other groups may also distribute
working documents as Internet-Drafts.  The list of current
Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
This Internet-Draft will expire on August 1, 2011.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2011 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the Simplified BSD License.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">1.1.</a>&nbsp;
What is Address Independence?<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">1.2.</a>&nbsp;
NPTv6 Applicability<br />
<a href="#anchor4">2.</a>&nbsp;
NPTv6 Overview<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">2.1.</a>&nbsp;
NPTv6: the simplest case<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">2.2.</a>&nbsp;
NPTv6 between peer networks<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">2.3.</a>&nbsp;
NPTv6 redundnacy and load-sharing<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">2.4.</a>&nbsp;
NPTv6 multihoming<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">2.5.</a>&nbsp;
Mapping with No Per-Flow State<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">2.6.</a>&nbsp;
Checksum-Neutral Mapping<br />
<a href="#anchor11">3.</a>&nbsp;
NPTv6 Algorithmic Specification<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#configuration">3.1.</a>&nbsp;
NPTv6 configuration calculations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#leaving">3.2.</a>&nbsp;
NPTv6 translation, internal network to external network<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#returning">3.3.</a>&nbsp;
NPTv6 translation, external network to internal network<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#slash48">3.4.</a>&nbsp;
NPTv6 with a /48 or shorter prefix<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#slash56">3.5.</a>&nbsp;
NPTv6 with a /49 or longer prefix<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#example48">3.6.</a>&nbsp;
/48 Prefix Mapping Example<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">3.7.</a>&nbsp;
Address Mapping for Longer Prefixes<br />
<a href="#anchor13">4.</a>&nbsp;
Implications of Network Address Translator Behavioral Requirements<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">4.1.</a>&nbsp;
Prefix configuration and generation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#FFFF">4.2.</a>&nbsp;
Subnet numbering<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">4.3.</a>&nbsp;
NAT Behavioral Requirements<br />
<a href="#anchor16">5.</a>&nbsp;
Implications for Applications<br />
<a href="#anchor17">6.</a>&nbsp;
A Note on Port Mapping<br />
<a href="#anchor18">7.</a>&nbsp;
Security Considerations<br />
<a href="#anchor19">8.</a>&nbsp;
IANA Considerations<br />
<a href="#anchor20">9.</a>&nbsp;
Acknowledgements<br />
<a href="#anchor21">10.</a>&nbsp;
Change Log<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor22">10.1.</a>&nbsp;
Changes Between draft-mrw-behave-nat66-00 and -01<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor23">10.2.</a>&nbsp;
Changes between *behave-nat66-01 and -02<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor24">10.3.</a>&nbsp;
Changes between *nat66-00 and *nat66-01<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor25">10.4.</a>&nbsp;
Changes between *nat66-01 and *nat66-02<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor26">10.5.</a>&nbsp;
Changes between *nat66-02 and *nat66-03<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor27">10.6.</a>&nbsp;
Changes between *nat66-03 and *nat66-04<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor28">10.7.</a>&nbsp;
Changes between *nat66-04 and *nat66-05<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor29">10.8.</a>&nbsp;
Changes between *nat66-05 and *nat66-06<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor30">10.9.</a>&nbsp;
Changes between *nat66-06 and *nat66-07<br />
<a href="#rfc.references1">11.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">11.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">11.2.</a>&nbsp;
Informative References<br />
<a href="#appendix1">Appendix&nbsp;A.</a>&nbsp;
Why GSE?<br />
<a href="#math">Appendix&nbsp;B.</a>&nbsp;
Verification code<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>This document describes a stateless IPv6-to-IPv6 Network Prefix
      Translation (NPTv6) function, designed to provide address independence
      to the edge network. It is transport-agnostic with respect to transports
      that don't checksum the IP header, such as SCTP or DCCP, and to
      transports that use the TCP/UDP pseudo-header and <a class='info' href='#RFC1071'>checksum<span> (</span><span class='info'>Braden, R., Borman, D., Partridge, C., and W. Plummer, &ldquo;Computing the Internet checksum,&rdquo; September&nbsp;1988.</span><span>)</span></a> [RFC1071].
</p>
<p>This has several ramifications: </p>
<ul class="text">
<li>Any security benefit that NAT44 might offer is not present in
          NPTv6, necessitating the use of a firewall to obtain those benefits
          if desired. An example of such a firewall is described in <a class='info' href='#RFC6092'>[RFC6092]<span> (</span><span class='info'>Woodyatt, J., &ldquo;Recommended Simple Security Capabilities in Customer Premises Equipment (CPE) for Providing Residential IPv6 Internet Service,&rdquo; January&nbsp;2011.</span><span>)</span></a>.
</li>
<li>End to end reachability is preserved, although the address used
          "inside" the edge network differs from the address used "outside"
          the edge network. This has implications for application referrals
          and other uses of Internet layer addresses.
</li>
<li>If there are multiple identically-configured prefix translators
          between two networks, there is no need for them to exchange dynamic
          state, as there is no dynamic state - the algorithmic translation
          will be identical across each of them. The network can therefore
          asymmetrically route, load-share, and fail-over among them without
          issue.
</li>
<li>Since translation is 1:1 at the network layer, there is no need
          to modify port numbers or other transport parameters.
</li>
</ul>

<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
What is Address Independence?</h3>

<p>For the purposes of this document, IPv6 Address Independence
        consists of the following set of properties: </p>
<blockquote class="text"><dl>
<dt>From the perspective of the edge network:</dt>
<dd>
<ul class="text">
<li>The IPv6 addresses used inside the local network (for
                interfaces, access lists, and logs) do not need to be
                renumbered if the global prefix(es) assigned for use by the
                edge network are changed.
</li>
<li>The IPv6 addresses used inside the edge network (for
                interfaces, access lists, and logs) or within other upstream
                networks (such as when multihoming) do not need to be
                renumbered when a site adds, drops, or changes upstream
                networks.
</li>
<li>It is not necessary for an administration to convince an
                upstream network to route its internal IPv6 prefixes, or for
                it to advertise prefixes derived from other upstream networks
                into it.
</li>
<li>Unless it wants to optimize routing between multiple
                upstream networks in the process of multihoming, there is
                therefore no need for a BGP exchange with the upstream
                network.
</li>
</ul>
</dd>
<dt>From the perspective of the upstream network:</dt>
<dd>
<ul class="text">
<li>IPv6 addresses used by the edge network are guaranteed to
                have a provider-allocated prefix, eliminating the need and
                concern for <a class='info' href='#RFC2827'>BCP 38<span> (</span><span class='info'>Ferguson, P. and D. Senie, &ldquo;Network Ingress Filtering: Defeating Denial of Service Attacks which employ IP Source Address Spoofing,&rdquo; May&nbsp;2000.</span><span>)</span></a> [RFC2827] ingress
                filtering and the advertisement of customer-specific
                prefixes.
</li>
</ul>
</dd>
</dl></blockquote>

<p>Thus, address independence has ramifications for the edge network,
        networks it directly connects with (especially its upstream networks),
        and for the Internet as a whole. The desire for address independence
        has been a primary driver for IPv4 NAT deployment in medium to
        large-sized enterprise networks, including NAT deployments in
        enterprises that have plenty of IPv4 provider-independent address
        space (from IPv4 "swamp space"). It has also been a driver for edge
        networks to become members of RIR communities, seeking to obtain BGP
        Autonomous System Numbers and provider-independent prefixes, and as a
        result has been one of the drivers of the explosion of the IPv4 route
        table. Service providers have stated that the lack of address
        independence from their customers has been a negative incentive to
        deployment, due to the impact of customer routing expected in their
        networks.
</p>
<p>The <a class='info' href='#RFC4864'>Local Network Protection<span> (</span><span class='info'>Van de Velde, G., Hain, T., Droms, R., Carpenter, B., and E. Klein, &ldquo;Local Network Protection for IPv6,&rdquo; May&nbsp;2007.</span><span>)</span></a> [RFC4864] document
        discusses a related concept called "Address Autonomy" as a benefit of
        NAT44. <a class='info' href='#RFC4864'>[RFC4864]<span> (</span><span class='info'>Van de Velde, G., Hain, T., Droms, R., Carpenter, B., and E. Klein, &ldquo;Local Network Protection for IPv6,&rdquo; May&nbsp;2007.</span><span>)</span></a> indicates that address autonomy
        can be achieved by the simultaneous use of global addresses on all
        nodes within a site that need external connectivity, and Unique Local
        Addresses (ULAs) <a class='info' href='#RFC4193'>[RFC4193]<span> (</span><span class='info'>Hinden, R. and B. Haberman, &ldquo;Unique Local IPv6 Unicast Addresses,&rdquo; October&nbsp;2005.</span><span>)</span></a> for all internal
        communication. However, this solution fails to meet the requirement
        for address independence, because if an ISP renumbering event occurs,
        all of the hosts, routers, DHCP servers, ACLs, firewalls and other
        internal systems that are configured with global addresses from the
        ISP will need to be renumbered before global connectivity is fully
        restored.
</p>
<p>The use of IPv6 Provider Independent (PI) addresses has also been
        suggested as a means to fulfill the address independence requirement.
        However, this solution requires that an enterprise qualify to receive
        a PI assignment and persuade their ISP to install specific routes for
        the enterprise's PI addresses. There are a number of practical issues
        with this approach, especially if there is a desire to route to a
        number of geographically and topologically diverse set of sites, which
        can sometimes involve coordinating with several ISPs to route portions
        of a single PI prefix. These problems have caused numerous enterprises
        with plenty of IPv4 swamp space to choose to use IPv4 NAT for part, or
        substantially all, of their internal network instead of using their
        provider-independent address space.
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.2"></a><h3>1.2.&nbsp;
NPTv6 Applicability</h3>

<p>NPTv6 provides a simple and compelling solution to meet the Address
        Independence requirement in IPv6. The address independence benefit
        stems directly from the translation function of the network prefix
        translator. To avoid as many of the issues associated with NAT44 as
        possible, NPTv6 is defined to include a two-way, checksum-neutral,
        algorithmic translation function, and nothing else.
</p>
<p>NPTv6 does not include a port mapping function, and the defined
        address mapping mechanism is checksum-neutral. This avoids the need
        for a NPTv6 Translator to re-write transport layer headers, making it
        feasible to deploy new or improved transport layer protocols without
        upgrading NPTv6 Translators. Because NPTv6 does not involve re-writing
        transport-layer headers, NPTv6 will not interfere with encryption of
        the full IP payload in many cases.
</p>
<p>The default NPTv6 address mapping mechanism is purely algorithmic,
        so NPTv6 translators do not need to maintain per-node or
        per-connection state, allowing deployment of more robust and adaptive
        networks than can be deployed using NAT44. Since the default NPTv6
        mapping can be performed in either direction, it does not interfere
        with inbound connection establishment, thus allowing internal nodes to
        participate in direct Peer-to-Peer applications without the
        application layer overhead one finds in many IPv4 Peer-to-Peer
        applications.
</p>
<p>Although NPTv6 compares favorably to NAT44 in several ways, it does
        not eliminate all of the architectural problems associated with IPv4
        NAT, as described in <a class='info' href='#RFC2993'>[RFC2993]<span> (</span><span class='info'>Hain, T., &ldquo;Architectural Implications of NAT,&rdquo; November&nbsp;2000.</span><span>)</span></a>. NPTv6 involves
        modifying IP headers in transit, so it is not compatible with security
        mechanisms, such as the IPsec Authentication Header, that provide
        integrity protection for the IP header. NPTv6 may interfere with the
        use of application protocols that transmit IP addresses in the
        application-specific portion of the IP packet. These applications
        currently require application layer gateways (ALGs) to work correctly
        through NAT44 devices, and similar ALGs may be required for these
        applications to work through NPTv6 Translators. The use of separate
        internal and external prefixes creates complexity for DNS deployment,
        due the desire for internal nodes to communicate with other internal
        nodes using internal addresses, while external nodes need to obtain
        external addresses to communicate with the same nodes. This frequently
        results in the deployment of "split DNS", which may add complexity to
        network configuration.
</p>
<p>The choice of address within the edge network bears consideration.
        One could use a ULA, which maximizes address independence. That could
        also be considered a misuse of the ULA; if the expectation is that a
        ULA prevents access to a system from outside the range of the ULA,
        NPTv6 overrides that. On the other hand, the administration is aware
        that it has made that choice, and could if it desired deploy a second
        ULA for the purpose of privacy; the only prefix that will be
        translated is one that has a NPTv6 Translator configured to translate
        to or from it. Also, using any other global scope address format makes
        one either obtain a PI prefix or be at the mercy of the agency from
        which it was allocated.
</p>
<p>There are significant technical impacts associated with the
        deployment of any prefix translation mechanism, including NPTv6, and
        we strongly encourage anyone who is considering the implementation or
        deployment of NPTv6 to read <a class='info' href='#RFC4864'>[RFC4864]<span> (</span><span class='info'>Van de Velde, G., Hain, T., Droms, R., Carpenter, B., and E. Klein, &ldquo;Local Network Protection for IPv6,&rdquo; May&nbsp;2007.</span><span>)</span></a>, and to
        carefully consider the alternatives described in that document, some
        of which may cause fewer problems than NPTv6.
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
NPTv6 Overview</h3>

<p>NPTv6 may be implemented in an IPv6 router to map one IPv6 address
      prefix to another IPv6 prefix as each IPv6 packet transits the router. A
      router that implements a NPTv6 prefix translation function is referred
      to as an NPTv6 Translator.
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
NPTv6: the simplest case</h3>

<p>In its simplest form, a NPTv6 Translator interconnects two network
        links, one of which is an "internal" network link attached to a leaf
        network within a single administrative domain, and the other of which
        is an "external" network with connectivity to the global Internet. All
        of the hosts on the internal network will use addresses from a single,
        locally-routed prefix, and those addresses will be translated to/from
        addresses in a globally-routable prefix as IP packets transit the
        NPTv6 Translator. The lengths of these two prefixes will be
        functionally the same; if they differ, the longer of the two will
        limit the ability to use subnets in the shorter.
</p><br /><hr class="insert" />
<a name="simpleNPTv6"></a>
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
External Network:  Prefix = 2001:0DB8:0001:/48
    --------------------------------------
                      |
                      |
               +-------------+
               |     NPTv6   |
               |  Translator |
               +-------------+
                      |
                      |
    --------------------------------------
Internal Network:  Prefix = FD01:0203:0405:/48
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: A simple translator&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p><a class='info' href='#simpleNPTv6'>Figure&nbsp;1<span> (</span><span class='info'>A simple translator</span><span>)</span></a> shows a NPTv6 Translator
        attached to two networks. In this example, the internal network uses
        <a class='info' href='#RFC4193'>IPv6 Unique Local Addresses (ULAs)<span> (</span><span class='info'>Hinden, R. and B. Haberman, &ldquo;Unique Local IPv6 Unicast Addresses,&rdquo; October&nbsp;2005.</span><span>)</span></a> [RFC4193] to
        represent the internal IPv6 nodes, and the external network uses
        globally routable IPv6 addresses to represent the same nodes.
</p>
<p>When a NPTv6 Translator forwards packets in the "outbound"
        direction, from the internal network to the external network, NPTv6
        overwrites the IPv6 source prefix (in the IPv6 header) with a
        corresponding external prefix. When packets are forwarded in the
        "inbound" direction, from the external network to the internal
        network, the IPv6 destination prefix is overwritten with a
        corresponding internal prefix. Using the prefixes shown in the diagram
        above, as an IP packet passes through the NPTv6 Translator in the
        outbound direction, the source prefix (FD01:0203:0405:/48) will be
        overwritten with the external prefix (2001:0DB8:0001:/48). In an
        inbound packet, the destination prefix (2001:0DB8:0001:/48) will be
        overwritten with the internal prefix (FD01:0203:0405:/48). In both
        cases, it is the local IPv6 prefix that is overwritten; the remote
        IPv6 prefix remains unchanged. Nodes on the internal network are said
        to be "behind" the NPTv6 Translator.
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
NPTv6 between peer networks</h3>

<p>NPTv6 can also be used between two private networks. In these
        cases, both networks may use ULA prefixes, with each subnet in one
        network mapped into a corresponding subnet in the other network, and
        vice versa. Or, each network may use ULA prefixes for internal
        addressing, and global unicast addresses on the other network.
</p><br /><hr class="insert" />
<a name="flow"></a>
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
    Internal Prefix = FD01:4444:5555:/48
    --------------------------------------
         V            |      External Prefix
         V            |      2001:0DB8:6666:/48
         V        +---------+      ^
         V        |  NPTv6  |      ^
         V        |  Device |      ^
         V        +---------+      ^
External Prefix       |            ^
2001:0DB8:0001:/48    |            ^
    --------------------------------------
    Internal Prefix = FD01:0203:0405:/48
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;2: Flow of Information in Translation&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3"></a><h3>2.3.&nbsp;
NPTv6 redundnacy and load-sharing</h3>

<p>In some cases, more than one NPTv6 Translator may be attached to a
        network, as show in <a class='info' href='#parallel'>Figure&nbsp;3<span> (</span><span class='info'>Parallel Translators</span><span>)</span></a>. In such cases,
        NPTv6 Translators are configured with the same internal and external
        prefixes. Since there is only one translation, even though there are
        multiple translators, they map only one external address (prefix and
        IID) to the internal address.
</p><br /><hr class="insert" />
<a name="parallel"></a>
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
External Network:  Prefix = 2001:0DB8:0001:/48
    --------------------------------------
           |                      |
           |                      |
    +-------------+        +-------------+
    |  NPTv6      |        |  NPTv6      |
    |  Translator |        |  Translator |
    |   #1        |        |   #2        |
    +-------------+        +-------------+
           |                      |
           |                      |
    --------------------------------------
Internal Network:  Prefix = FD01:0203:0405:/48
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;3: Parallel Translators&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.4"></a><h3>2.4.&nbsp;
NPTv6 multihoming</h3>
<br /><hr class="insert" />
<a name="distinct"></a>
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
   External Network #1:          External Network #2:
Prefix = 2001:0DB8:0001:/48    Prefix = 2001:0DB8:5555:/48
---------------------------    --------------------------
                |                      |
                |                      |
         +-------------+        +-------------+
         |  NPTv6      |        |  NPTv6      |
         |  Translator |        |  Translator |
         |   #1        |        |   #2        |
         +-------------+        +-------------+
                |                      |
                |                      |
         --------------------------------------
     Internal Network:  Prefix = FD01:0203:0405:/48
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;4: Parallel Translators with different upstream networks&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>When multihoming, NPTv6 Translators are attached to an internal
        network, as show in <a class='info' href='#distinct'>Figure&nbsp;4<span> (</span><span class='info'>Parallel Translators with different upstream networks</span><span>)</span></a>, but connected to
        different external networks. In such cases, NPTv6 Translators are
        configured with the same internal prefix, but different external
        prefixes. Since there are multiple translations, they map multiple
        external addresses (prefix and IID) to the common internal address. A
        system within the edge network is unable to determine which external
        address it is using apart from services such as STUN.
</p>
<p>Multihoming in this sense has one negative feature as compared with
        multihoming with a provider-independent address; when routes change
        between NPTv6 Translators, since the upstream network changes, the
        translated prefix can change. This would case sessions and referrals
        dependent on it to fail as well. This is not expected to be a major
        real issue, however, in networks where routing is generally
        stable.
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.5"></a><h3>2.5.&nbsp;
Mapping with No Per-Flow State</h3>

<p>When NPTv6 is used as described in this document, no per-node or
        per-flow state is maintained in the NPTv6 Translator. Both inbound and
        outbound packets are translated algorithmically, using only
        information found in the IPv6 header. Due to this property, NPTv6's
        two-way, algorithmic address mapping can support both outbound and
        inbound connection establishment without the need for state-priming or
        rendezvous mechanisms, or the maintenance of mapping state. This is a
        significant improvement over NAT44 devices, but it also has
        significant security implications which are described in the Security
        Considerations section.
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.6"></a><h3>2.6.&nbsp;
Checksum-Neutral Mapping</h3>

<p>When a change is made to one of the IP header fields in the IPv6
        pseudo-header checksum (such as one of the IP addresses), the checksum
        field in the transport layer header may become invalid. Fortunately,
        an incremental change in the area covered by the Internet standard
        checksum <a class='info' href='#RFC1071'>[RFC1071]<span> (</span><span class='info'>Braden, R., Borman, D., Partridge, C., and W. Plummer, &ldquo;Computing the Internet checksum,&rdquo; September&nbsp;1988.</span><span>)</span></a> will result in a well-defined
        change to the checksum value <a class='info' href='#RFC1624'>[RFC1624]<span> (</span><span class='info'>Rijsinghani, A., &ldquo;Computation of the Internet Checksum via Incremental Update,&rdquo; May&nbsp;1994.</span><span>)</span></a>. So, a
        checksum change caused by modifying part of the area covered by the
        checksum can be corrected by making a complementary change to a
        different 16-bit field covered by the same checksum.
</p>
<p>The NPTv6 mapping mechanisms described in this document are
        checksum-neutral, which means that they result in IP headers that will
        generate the same IPv6 pseudo-header checksum when the checksum is
        calculated using the standard Internet checksum algorithm <a class='info' href='#RFC1071'>[RFC1071]<span> (</span><span class='info'>Braden, R., Borman, D., Partridge, C., and W. Plummer, &ldquo;Computing the Internet checksum,&rdquo; September&nbsp;1988.</span><span>)</span></a>. Any changes that are made during translation
        of the IPv6 prefix are offset by changes to other parts of the IPv6
        address. This results in transport layers that use the Internet
        checksum (such as TCP and UDP) calculating the same IPv6 pseudo header
        checksum for both the internal and external forms of the same packet,
        which avoids the need for the NPTv6 Translator to modify those
        transport layer headers to correct the checksum value.
</p>
<p>As noted in <a class='info' href='#FFFF'>Section&nbsp;4.2<span> (</span><span class='info'>Subnet numbering</span><span>)</span></a>, this mapping results in an
        edge network using a /48 external prefix to be unable to use subnet
        0xFFFF.
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
NPTv6 Algorithmic Specification</h3>

<p>The <a class='info' href='#RFC4291'>[RFC4291]<span> (</span><span class='info'>Hinden, R. and S. Deering, &ldquo;IP Version 6 Addressing Architecture,&rdquo; February&nbsp;2006.</span><span>)</span></a> IPv6 Address is reproduced for
      clarity in <a class='info' href='#address'>Figure&nbsp;5<span> (</span><span class='info'>Enumeration of the IPv6 Address [RFC4291]</span><span>)</span></a>.
</p><br /><hr class="insert" />
<a name="address"></a>
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
 0    15 16   31 32   47 48   63 64   79 80   95 96  111 112  127
+-------+-------+-------+-------+-------+-------+-------+-------+
|     Routing Prefix    | Subnet|   Interface Identifier (IID)  |
+-------+-------+-------+-------+-------+-------+-------+-------+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;5: Enumeration of the IPv6 Address [RFC4291]&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="configuration"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
NPTv6 configuration calculations</h3>

<p>When an NPTv6 Translation function is configured, it is configured
        with </p>
<ul class="text">
<li>one or more "internal" interfaces with their "internal" routing
            domain prefixes, and
</li>
<li>one or more "external" interfaces with their "external" routing
            domain prefixes.
</li>
</ul>

<p>In the simple case, there is one of each. If a single router
        provides NPTv6 translation services between a multiplicity of domains
        (as might be true when multihoming), each internal/external pair must
        be thought of as a separate NPTv6 Translator from the perspective of
        this specification.
</p>
<p>When an NPTv6 Translator is configured, the translation function
        first ensures that the internal and external prefixes are the same
        length, if necessary by extending the shorter of the two with zeroes.
        These two prefixes will be used in the prefix translation function
        described in <a class='info' href='#leaving'>Section&nbsp;3.2<span> (</span><span class='info'>NPTv6 translation, internal network to external network</span><span>)</span></a> and <a class='info' href='#returning'>Section&nbsp;3.3<span> (</span><span class='info'>NPTv6 translation, external network to internal network</span><span>)</span></a>.
</p>
<p>They are then zero-extended to /64, for the purposes of a
        calculation. The translation function calculates the ones-complement
        sum of the 16 bit words of the /64 external prefix and the /64
        internal prefix. It then calculates the difference between these
        values: internal minus external. This value, called the "adjustment",
        is effectively constant for the lifetime of the NPTv6 Translator
        configuration, and used in per-packet processing.
</p>
<a name="leaving"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
NPTv6 translation, internal network to external network</h3>

<p>When a datagram passes through the NPTv6 Translator from an
        internal to an external network, its IPv6 Source Address is changed in
        two ways: </p>
<ul class="text">
<li>If the internal subnet number has no mapping, such as being
            0xFFFF or simply not mapped, discard the datagram. This SHOULD
            result in an ICMP Destination Unreachable.
</li>
<li>The internal prefix is overwritten with the external prefix, in
            effect subtracting the difference between the two checksums (the
            adjustment) from the pseudo-header's checksum, and
</li>
<li>A 16-bit word of the address has the adjustment added to it
            using one's complement arithmetic. If the result is 0xFFFF, it is
            overwritten as zero. The choice of word is as specified in <a class='info' href='#slash48'>Section&nbsp;3.4<span> (</span><span class='info'>NPTv6 with a /48 or shorter prefix</span><span>)</span></a> or <a class='info' href='#slash56'>Section&nbsp;3.5<span> (</span><span class='info'>NPTv6 with a /49 or longer prefix</span><span>)</span></a> as
            appropriate.
</li>
</ul>

<a name="returning"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
NPTv6 translation, external network to internal network</h3>

<p>When a datagram passes through the NPTv6 Translator from an
        external to an internal network, its IPv6 Destination Address is
        changed in two ways: </p>
<ul class="text">
<li>The external prefix is overwritten with the internal prefix, in
            effect adding the difference between the two checksums (the
            adjustment) to the pseudoheader's checksum, and
</li>
<li>A 16-bit word of the address has the adjustment subtracted from
            it (bitwise inverted and added to it) it using one's complement
            arithmetic. If the result is 0xFFFF, it is overwritten as zero.
            The choice of word is as specified in <a class='info' href='#slash48'>Section&nbsp;3.4<span> (</span><span class='info'>NPTv6 with a /48 or shorter prefix</span><span>)</span></a> or <a class='info' href='#slash56'>Section&nbsp;3.5<span> (</span><span class='info'>NPTv6 with a /49 or longer prefix</span><span>)</span></a> as
            appropriate.
</li>
</ul>

<a name="slash48"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4"></a><h3>3.4.&nbsp;
NPTv6 with a /48 or shorter prefix</h3>

<p>When a NPTv6 Translator is configured with internal and external
        prefixes that are 48 bits in length (a /48) or shorter, the adjustment
        MUST be added to or subtracted from bits 48..63 of the address.
</p>
<p>This mapping results in no modification of the Interface Identifier
        (IID), which is held in the lower half of the IPv6 address, so it will
        not interfere with future protocols that may use unique IIDs for node
        identification.
</p>
<p>NPTv6 Translator implementations MUST implement the /48
        mapping.
</p>
<a name="slash56"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.5"></a><h3>3.5.&nbsp;
NPTv6 with a /49 or longer prefix</h3>

<p>When a NPTv6 Translator is configured with internal and external
        prefixes that are longer than 48 bits in length (such as a /52, /56,
        or /60), the adjustment must be added to or subtracted from one of the
        words in bits 64..79, 80..95, 96..111, or 112..127 of the address.
        While the choice of word is immaterial as long as it is consistent,
        for consistency's sake, these words MUST be inspected in that
        sequence, and the first that is not initially 0xFFFF chosen.
</p>
<p>NPTv6 Translator implementations SHOULD implement the mapping for
        longer prefixes.
</p>
<a name="example48"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.6"></a><h3>3.6.&nbsp;
/48 Prefix Mapping Example</h3>

<p>For the network shown in <a class='info' href='#simpleNPTv6'>Figure&nbsp;1<span> (</span><span class='info'>A simple translator</span><span>)</span></a>, the
        Internal Prefix is FD01:0203:0405:/48, and the External Prefix is
        2001:0DB8:0001:/48
</p>
<p>If a node with internal address FD01:0203:0405:0001::1234 sends an
        outbound packet through the NPTv6 Translator, the resulting external
        address will be 2001:0DB8:0001:D550::1234. The resulting address is
        obtained by calculating the checksum of both the internal and external
        48-bit prefixes, subtracting the internal prefix from the external
        prefix using one's complement arithmetic to calculate the
        "adjustment", and adding the adjustment to the 16-bit subnet field (in
        this case 0x0001).
</p>
<p>To show the work:
</p>
<p>The one's complement checksum of FD01:0203:0405 is 0xFCF5. The
        one's complement checksum of 2001:0DB8:0001 is 0xD245. Using one's
        complement arithmetic, 0xD245 - 0xFCF5 = 0xD54F. The subnet in the
        original packet is 0x0001. Using one's complement arithmetic, 0x0001 +
        0xD54F = 0xD550. Since 0xD550 != 0xFFFF, it is not changed to
        0x0000.
</p>
<p>So, the value 0xD550 is written in the 16-bit subnet area,
        resulting in a mapped external address of
        2001:0DB8:0001:D550::1234.
</p>
<p>When a response packet is received, it will contain the destination
        address 2001:0DB8:0001:D550::0001, which will be mapped using the
        inverse mapping algorithm, back to FD01:0203:0405:0001::1234.
</p>
<p>In this case, the difference between the two prefixes will be
        calculated as follows:
</p>
<p>Using one's complement arithmetic, 0xFCF5 - 0xD245 = 0x2AB0. The
        subnet in the original packet = 0xD550. Using one's complement
        arithmetic, 0xD550 + 0x2AB0 = 0x0001. Since 0x0001 != 0xFFFF, it is
        not changed to 0x0000.
</p>
<p>So the value 0x0001 is written into the subnet field, and the
        internal value of the subnet field is properly restored.
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.7"></a><h3>3.7.&nbsp;
Address Mapping for Longer Prefixes</h3>

<p>If the prefix being mapped is longer than 48 bits, the algorithm is
        slightly more complex. A common case will be that the internal and
        external prefixes are of different length. In such a case, the shorter
        prefix is zero-extended to the length of the longer as described in
        <a class='info' href='#configuration'>Section&nbsp;3.1<span> (</span><span class='info'>NPTv6 configuration calculations</span><span>)</span></a> for the purposes of overwriting
        the prefix. Then, they are both zero-extended to 64 bits to facilitate
        one's complement arithmetic. The "adjustment" is calculated using
        those 64 bit prefixes.
</p>
<p>For example if the internal prefix is a /48 ULA and the external
        prefix is a /56 provider-allocated prefix, the ULA becomes a /56 with
        zeros in bits 48..55. For purposes of one's complement arithmetic,
        they are then both zero-extended to 64 bits. A side-effect of this is
        that a subset of the subnets possible in the shorter prefix are
        untranslatable. While the security value of this is debatable, the
        administration may choose to use them for subnets that it knows need
        no external accessibility.
</p>
<p>We then find the first word in the IID that does not have the value
        0xFFFF, trying bits 64..79, and then 80..95, 96..111, and finally
        112..127. We perform the same calculation (with the same proof of
        correctness) as in <a class='info' href='#example48'>Section&nbsp;3.6<span> (</span><span class='info'>/48 Prefix Mapping Example</span><span>)</span></a>, but applying it
        to that word.
</p>
<p>Although any 16-bit portion of an IPv6 IID could contain 0xFFFF, an
        IID of all-ones is a reserved anycast identifier that should not be
        used on the network <a class='info' href='#RFC2526'>[RFC2526]<span> (</span><span class='info'>Johnson, D. and S. Deering, &ldquo;Reserved IPv6 Subnet Anycast Addresses,&rdquo; March&nbsp;1999.</span><span>)</span></a>. If a NPTv6
        Translator discovers a packet with an IID of all-zeros while
        performing address mapping, that packet MUST be dropped, and an ICMPv6
        Parameter Problem error SHOULD be generated <a class='info' href='#RFC4443'>[RFC4443]<span> (</span><span class='info'>Conta, A., Deering, S., and M. Gupta, &ldquo;Internet Control Message Protocol (ICMPv6) for the Internet Protocol Version 6 (IPv6) Specification,&rdquo; March&nbsp;2006.</span><span>)</span></a>.
</p>
<p>Note: this mechanism does involve modification of the IID; it may
        not be compatible with future mechanisms that use unique IIDs for node
        identification.
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Implications of Network Address Translator Behavioral Requirements</h3>

<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Prefix configuration and generation</h3>

<p>NPTv6 Translators MUST support manual configuration of internal and
        external prefixes, and MUST NOT place any restrictions on those
        prefixes except that they be valid IPv6 unicast prefixes as described
        in <a class='info' href='#RFC4291'>[RFC4291]<span> (</span><span class='info'>Hinden, R. and S. Deering, &ldquo;IP Version 6 Addressing Architecture,&rdquo; February&nbsp;2006.</span><span>)</span></a>. They MAY also support random
        generation of ULA addresses on command. Since the most common place
        anticipated for the implementation of an NPTv6 Translator is a CPE
        router, the reader is urged to consider the requirements of <a class='info' href='#I-D.ietf-v6ops-ipv6-cpe-router'>[I&#8209;D.ietf&#8209;v6ops&#8209;ipv6&#8209;cpe&#8209;router]<span> (</span><span class='info'>Singh, H., Beebee, W., Donley, C., Stark, B., and O. Troan, &ldquo;Basic Requirements for IPv6 Customer Edge Routers,&rdquo; December&nbsp;2010.</span><span>)</span></a>.
</p>
<a name="FFFF"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Subnet numbering</h3>

<p>For reasons detailed in <a class='info' href='#math'>Appendix&nbsp;B<span> (</span><span class='info'>Verification code</span><span>)</span></a>, a network
        using NPTv6 Translation and a /48 external prefix MUST NOT use the
        value 0xFFFF to designate a subnet that it expects to be
        translated.
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
NAT Behavioral Requirements</h3>

<p>NPTv6 Translators MUST support hairpinning behavior, as defined in
        the NAT Behavioral Requirements for UDP document <a class='info' href='#RFC4787'>[RFC4787]<span> (</span><span class='info'>Audet, F. and C. Jennings, &ldquo;Network Address Translation (NAT) Behavioral Requirements for Unicast UDP,&rdquo; January&nbsp;2007.</span><span>)</span></a>. This means that when a NPTv6 Translator
        receives a packet on the internal interface that has a destination
        address that matches the site's external prefix, it will translate the
        packet and forward it internally. This allows internal nodes to reach
        other internal nodes using their external, global addresses when
        necessary.
</p>
<p>Conceptually, the datagram leaves the domain (is translated as
        described in <a class='info' href='#leaving'>Section&nbsp;3.2<span> (</span><span class='info'>NPTv6 translation, internal network to external network</span><span>)</span></a>), and returns (is again
        translated as described in <a class='info' href='#returning'>Section&nbsp;3.3<span> (</span><span class='info'>NPTv6 translation, external network to internal network</span><span>)</span></a>). As a
        result, the datagram exchange will be through the NPTv6 Translator in
        both directions for the lifetime of the session. The alternative would
        be to require the NPTv6 Translator to drop the datagram, forcing the
        sender to use the correct internal prefix for its peer. Performing
        only the external-to-internal translation results in the datagram
        being sent from the untranslated internal address of the source to the
        translated and therefore internal address of its peer, which would
        enable the session to bypass the NPTv6 Translator for future
        datagrams. It would also mean that the original sender would be
        unlikely to recognize the response when it arrived.
</p>
<p>Because NPTv6 does not perform port mapping and uses a one-to-one,
        reversible mapping algorithm, none of the other NAT behavioral
        requirements apply to NPTv6.
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Implications for Applications</h3>

<p>The use of NPTv6 Transition technology makes a capability available
      to Applications (and the networks that contain them) that is not readily
      possible in a NAT44 network. This is the ability to position an
      externally-accessible application within the "internal" network. In an
      IPv4 network using NAT44, an externally-accessible application must be
      positioned on systems with global addresses, forcing the edge network to
      obtain global address allocation; if the application can be in the
      translated routing domain, it automatically has an address in each of
      its upstream prefixes without the edge network obtaining such. However,
      there must be a means for the application to know what addresses are
      usable. Reasons include at least advertisement in DNS (which might be
      done statically if DNS is directly maintained by the administration, or
      from the end system if Dynamic DNS is in use). If referrals and other
      uses of network layer addressing do not use names, then the application
      needs a means to determine what addresses are relevant, whether from DNS
      or another means.
</p>
<p>The means of address discovery is not within the scope of this
      specification.
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
A Note on Port Mapping</h3>

<p>In addition to overwriting IP addresses when packets are forwarded,
      NAPT44 devices overwrite the source port number in outbound traffic, and
      the destination port number in inbound traffic. This mechanism is called
      "port mapping".
</p>
<p>The major benefit of port mapping is that it allows multiple
      computers to share a single IPv4 address. A large number of internal
      IPv4 addresses (typically from one of the <a class='info' href='#RFC1918'>[RFC1918]<span> (</span><span class='info'>Rekhter, Y., Moskowitz, R., Karrenberg, D., Groot, G., and E. Lear, &ldquo;Address Allocation for Private Internets,&rdquo; February&nbsp;1996.</span><span>)</span></a>
      private address spaces) can be mapped into a single external, globally
      routable IPv4 address, with the local port number used to identify which
      internal node should receive each inbound packet. This address
      amplification feature is not generally foreseen as a necessity at this
      time.
</p>
<p>Since port mapping requires re-writing a portion of the transport
      layer header, it requires NAPT44 devices to be aware of all of the
      transport protocols that they forward, thus stifling the development of
      new and improved transport protocols and preventing the use of IPsec
      encryption. Modifying the transport layer header is incompatible with
      security mechanisms that encrypt the full IP payload, and restricts the
      NAPT44 to forwarding transport layers that use weak checksum algorithms
      that are easily recalculated in routers.
</p>
<p>Since there is significant detriment caused by modifying transport
      layer headers and very little, if any, benefit to the use of port
      mapping in IPv6, NPTv6 Translators that comply with this specification
      MUST NOT perform port mapping.
</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Security Considerations</h3>

<p>When NPTv6 is deployed using either of the two-way, algorithmic
      mappings defined in the document, it allows direct inbound connections
      to internal nodes. While this can be viewed as a benefit of NPTv6 vs.
      NAT44, it does open internal nodes to attacks that would be more
      difficult in a NAT44 network. Although this situation is not
      substantially worse, from a security standpoint, than running IPv6 with
      no NAT, some enterprises may assume that a NPTv6 Translator will offer
      similar protection to a NAT44 device.
</p>
<p>The port mapping mechanism in NAT44 implementations require that
      state be created in both directions. This has lead to an industry-wide
      perception that NAT functionality is the same as a stateful firewall. It
      is not. The translation function of the NAT only creates dynamic state
      in one direction and has no policy. For this reason, it is RECOMMENDED
      that NPTv6 Translators also implement firewall functionality such as
      described in <a class='info' href='#RFC6092'>[RFC6092]<span> (</span><span class='info'>Woodyatt, J., &ldquo;Recommended Simple Security Capabilities in Customer Premises Equipment (CPE) for Providing Residential IPv6 Internet Service,&rdquo; January&nbsp;2011.</span><span>)</span></a>, with appropriate
      configuration options including turning it on or off.
</p>
<p>When <a class='info' href='#RFC4864'>[RFC4864]<span> (</span><span class='info'>Van de Velde, G., Hain, T., Droms, R., Carpenter, B., and E. Klein, &ldquo;Local Network Protection for IPv6,&rdquo; May&nbsp;2007.</span><span>)</span></a> talks about randomizing the
      subnet identifier, the idea is to make it harder for worms to guess a
      valid subnet identifier at an advertised network prefix. This should not
      be interpreted as endorsing concealing the subnet identifier behind the
      obfuscating function of a translator such as NPTv6. <a class='info' href='#RFC4864'>[RFC4864]<span> (</span><span class='info'>Van de Velde, G., Hain, T., Droms, R., Carpenter, B., and E. Klein, &ldquo;Local Network Protection for IPv6,&rdquo; May&nbsp;2007.</span><span>)</span></a> specifically talks about how to obtain the
      desired properties of concealment without using a translator. Topology
      hiding when using NAT is often ineffective in environments where the
      topology is visible in application layer messaging protocols such as
      DNS, SIP, SMTP, etc. If the information were not available through the
      application layer, <a class='info' href='#RFC2993'>[RFC2993]<span> (</span><span class='info'>Hain, T., &ldquo;Architectural Implications of NAT,&rdquo; November&nbsp;2000.</span><span>)</span></a> would not be
      valid.
</p>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
IANA Considerations</h3>

<p>This document has no IANA considerations.
</p>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Acknowledgements</h3>

<p>The checksum-neutral algorithmic address mapping described in this
      document is based on e-mail written by Iljtsch Van Beijnum.
</p>
<p>The following people provided advice or review comments that
      substantially improved this document: Christian Huitema, Dave Thaler, Ed
      Jankiewicz, Eric Kline, Iljtsch Van Beijnum, Jari Arkko, Mark Townsley,
      Merike Kaeo, Ralph Droms, Remi Depres, Steve Blake, and Tony Hain.
</p>
<p>This document was written using the xml2rfc tool described in RFC
      2629 <a class='info' href='#RFC2629'>[RFC2629]<span> (</span><span class='info'>Rose, M., &ldquo;Writing I-Ds and RFCs using XML,&rdquo; June&nbsp;1999.</span><span>)</span></a>.
</p>
<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
Change Log</h3>

<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.1"></a><h3>10.1.&nbsp;
Changes Between draft-mrw-behave-nat66-00 and -01</h3>

<p>There were several minor changes made between the *behave-nat66-00
        and -01 versions of this draft: </p>
<ul class="text">
<li>Added Fred Baker as a co-author.
</li>
<li>Minor arithmetic corrections.
</li>
<li>Added AH to paragraph on NAT security issues.
</li>
<li>Added additional NAT topologies to overview (diagrams TBD).
</li>
</ul>

<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.2"></a><h3>10.2.&nbsp;
Changes between *behave-nat66-01 and -02</h3>

<p>There were further changes made between *behave-nat66-01 and -02:
        </p>
<ul class="text">
<li>Removed topology hiding mechanism.
</li>
<li>Added diagrams.
</li>
<li>Made minor updates based on mailing list feedback.
</li>
<li>Added discussion of IPv6 SAF document.
</li>
<li>Added applicability section.
</li>
<li>Added discussion of Address Independence requirement.
</li>
<li>Added hairpinning requirement and discussion of applicability
            of other NAT behavioral requirements.
</li>
</ul>

<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.3"></a><h3>10.3.&nbsp;
Changes between *nat66-00 and *nat66-01</h3>

<p>There were further changes made between nat66-01 and nat66-02:
        </p>
<ul class="text">
<li>Added mapping for prefixes longer than /48.
</li>
<li>Change draft name to remove reference to the behave WG.
</li>
<li>Resolved various open issues and fixed typos.
</li>
</ul>

<a name="anchor25"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.4"></a><h3>10.4.&nbsp;
Changes between *nat66-01 and *nat66-02</h3>

<p></p>
<ul class="text">
<li>Change the acronym "NAT66" to "NPTv6", so people don't read
            "NAT" and MEGO.
</li>
<li>Change the term used to refer to the function from "NAT66
            device" to "NPTv6 Translator". It's not a "device" function, it's
            a function that is applied between two interfaces. Consider a
            router with two upstreams and two legs in the local network; it
            will not translate between the local legs, but will translate to
            and from each upstream, and be configured differently for each of
            the two ISPs.
</li>
<li>Comment specifically on the security aspects.
</li>
<li>Comment specifically on the application issues raised on this
            list.
</li>
<li>Comment specifically on multihoming, load-sharing, and
            asymmetric routing.
</li>
<li>Spell out the hairpinning requirement and its implications.
</li>
<li>Spell out the service provider side of Address
            Independence.
</li>
<li>00 focuses on the edge's view
</li>
<li>Detail the algorithm in a manner clearer to the implementor (I
            think)
</li>
<li>Spell out the case for GSE-style DMZs between the edge and the
            transit network, which is about the implications for the global
            routing table.
</li>
<li>Refer to <a class='info' href='#RFC6092'>[RFC6092]<span> (</span><span class='info'>Woodyatt, J., &ldquo;Recommended Simple Security Capabilities in Customer Premises Equipment (CPE) for Providing Residential IPv6 Internet Service,&rdquo; January&nbsp;2011.</span><span>)</span></a> as a CPE firewall
            description.
</li>
</ul>

<a name="anchor26"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.5"></a><h3>10.5.&nbsp;
Changes between *nat66-02 and *nat66-03</h3>

<p></p>
<ul class="text">
<li>Added an appendix on Verification code
</li>
<li>Various minor markups in response to Ralph Droms
</li>
</ul>

<a name="anchor27"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.6"></a><h3>10.6.&nbsp;
Changes between *nat66-03 and *nat66-04</h3>

<p></p>
<ul class="text">
<li>Markups in response to Christian Huitema, mostly surrounding
            the issue of subnet 0xFFFF.
</li>
<li>Refer to <a class='info' href='#I-D.ietf-v6ops-ipv6-cpe-router'>[I&#8209;D.ietf&#8209;v6ops&#8209;ipv6&#8209;cpe&#8209;router]<span> (</span><span class='info'>Singh, H., Beebee, W., Donley, C., Stark, B., and O. Troan, &ldquo;Basic Requirements for IPv6 Customer Edge Routers,&rdquo; December&nbsp;2010.</span><span>)</span></a>
            for CPE router requirements.
</li>
</ul>

<a name="anchor28"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.7"></a><h3>10.7.&nbsp;
Changes between *nat66-04 and *nat66-05</h3>

<p></p>
<ul class="text">
<li>Update statistics in appendix A per BGP report of 17 December
            2010
</li>
<li>Update security considerations using text supplied by Merike
            Kaeo.
</li>
</ul>

<a name="anchor29"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.8"></a><h3>10.8.&nbsp;
Changes between *nat66-05 and *nat66-06</h3>

<p></p>
<ul class="text">
<li>restore a code snippet inadvertently removed in version -05
</li>
</ul>

<a name="anchor30"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.9"></a><h3>10.9.&nbsp;
Changes between *nat66-06 and *nat66-07</h3>

<p></p>
<ul class="text">
<li>Changed requested status to experimental
</li>
<li>Incorporated comments from Eric Kline
</li>
</ul>

<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>11.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2526">[RFC2526]</a></td>
<td class="author-text"><a href="mailto:dbj@cs.cmu.edu">Johnson, D.</a> and <a href="mailto:deering@cisco.com">S. Deering</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2526">Reserved IPv6 Subnet Anycast Addresses</a>,&rdquo; RFC&nbsp;2526, March&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2526.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4193">[RFC4193]</a></td>
<td class="author-text">Hinden, R. and B. Haberman, &ldquo;<a href="http://tools.ietf.org/html/rfc4193">Unique Local IPv6 Unicast Addresses</a>,&rdquo; RFC&nbsp;4193, October&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4193.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4291">[RFC4291]</a></td>
<td class="author-text">Hinden, R. and S. Deering, &ldquo;<a href="http://tools.ietf.org/html/rfc4291">IP Version 6 Addressing Architecture</a>,&rdquo; RFC&nbsp;4291, February&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4291.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4443">[RFC4443]</a></td>
<td class="author-text">Conta, A., Deering, S., and M. Gupta, &ldquo;<a href="http://tools.ietf.org/html/rfc4443">Internet Control Message Protocol (ICMPv6) for the Internet Protocol Version 6 (IPv6) Specification</a>,&rdquo; RFC&nbsp;4443, March&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4443.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4787">[RFC4787]</a></td>
<td class="author-text">Audet, F. and C. Jennings, &ldquo;<a href="http://tools.ietf.org/html/rfc4787">Network Address Translation (NAT) Behavioral Requirements for Unicast UDP</a>,&rdquo; BCP&nbsp;127, RFC&nbsp;4787, January&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4787.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>11.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="GSE">[GSE]</a></td>
<td class="author-text">O'Dell, M., &ldquo;<a href="http://tools.ietf.org/id/draft-ietf-ipngwg-gseaddr">GSE - An Alternate Addressing Architecture for IPv6</a>,&rdquo; February&nbsp;1997 (<a href="http://tools.ietf.org/id/draft-ietf-ipngwg-gseaddr">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-v6ops-ipv6-cpe-router">[I-D.ietf-v6ops-ipv6-cpe-router]</a></td>
<td class="author-text">Singh, H., Beebee, W., Donley, C., Stark, B., and O. Troan, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-v6ops-ipv6-cpe-router-09.txt">Basic Requirements for IPv6 Customer Edge Routers</a>,&rdquo; draft-ietf-v6ops-ipv6-cpe-router-09 (work in progress), December&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-v6ops-ipv6-cpe-router-09.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1071">[RFC1071]</a></td>
<td class="author-text">Braden, R., Borman, D., Partridge, C., and W. Plummer, &ldquo;<a href="http://tools.ietf.org/html/rfc1071">Computing the Internet checksum</a>,&rdquo; RFC&nbsp;1071, September&nbsp;1988 (<a href="http://www.rfc-editor.org/rfc/rfc1071.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1624">[RFC1624]</a></td>
<td class="author-text"><a href="mailto:anil@levers.enet.dec.com">Rijsinghani, A.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1624">Computation of the Internet Checksum via Incremental Update</a>,&rdquo; RFC&nbsp;1624, May&nbsp;1994 (<a href="http://www.rfc-editor.org/rfc/rfc1624.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1918">[RFC1918]</a></td>
<td class="author-text"><a href="mailto:yakov@cisco.com">Rekhter, Y.</a>, <a href="mailto:rgm3@is.chrysler.com">Moskowitz, R.</a>, <a href="mailto:Daniel.Karrenberg@ripe.net">Karrenberg, D.</a>, <a href="mailto:GeertJan.deGroot@ripe.net">Groot, G.</a>, and <a href="mailto:lear@sgi.com">E. Lear</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1918">Address Allocation for Private Internets</a>,&rdquo; BCP&nbsp;5, RFC&nbsp;1918, February&nbsp;1996 (<a href="http://www.rfc-editor.org/rfc/rfc1918.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2629">[RFC2629]</a></td>
<td class="author-text"><a href="mailto:mrose@not.invisible.net">Rose, M.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2629">Writing I-Ds and RFCs using XML</a>,&rdquo; RFC&nbsp;2629, June&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2629.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2629.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2629.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2827">[RFC2827]</a></td>
<td class="author-text">Ferguson, P. and D. Senie, &ldquo;<a href="http://tools.ietf.org/html/rfc2827">Network Ingress Filtering: Defeating Denial of Service Attacks which employ IP Source Address Spoofing</a>,&rdquo; BCP&nbsp;38, RFC&nbsp;2827, May&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2827.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2993">[RFC2993]</a></td>
<td class="author-text">Hain, T., &ldquo;<a href="http://tools.ietf.org/html/rfc2993">Architectural Implications of NAT</a>,&rdquo; RFC&nbsp;2993, November&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2993.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4864">[RFC4864]</a></td>
<td class="author-text">Van de Velde, G., Hain, T., Droms, R., Carpenter, B., and E. Klein, &ldquo;<a href="http://tools.ietf.org/html/rfc4864">Local Network Protection for IPv6</a>,&rdquo; RFC&nbsp;4864, May&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4864.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC6092">[RFC6092]</a></td>
<td class="author-text">Woodyatt, J., &ldquo;<a href="http://tools.ietf.org/html/rfc6092">Recommended Simple Security Capabilities in Customer Premises Equipment (CPE) for Providing Residential IPv6 Internet Service</a>,&rdquo; RFC&nbsp;6092, January&nbsp;2011 (<a href="http://www.rfc-editor.org/rfc/rfc6092.txt">TXT</a>).</td></tr>
</table>

<a name="appendix1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Why GSE?</h3>

<p>For the purpose of this discussion, let us over-simplify the
      Internet's structure by distinguishing between two broad classes of
      networks: transit and edge. A "transit network", in this context, is a
      network that provides connectivity services to other networks. Its AS
      number may show up in a non-final position in BGP AS paths, or in the
      case of mobile and residential broadband networks, it may offer network
      services to smaller networks that can't justify RIR membership. An "edge
      network", in contrast, is any network that is not a transit network; it
      is the ultimate customer, and while it provides internal connectivity
      for its own use, it is in other respects is a consumer of transit
      services. In terms of routing, a network in the transit domain generally
      needs some way to make choices about how it routes to other networks; an
      edge network is generally quite satisfied with a simple default
      route.
</p>
<p>The <a class='info' href='#GSE'>[GSE]<span> (</span><span class='info'>O'Dell, M., &ldquo;GSE - An Alternate Addressing Architecture for IPv6,&rdquo; February&nbsp;1997.</span><span>)</span></a> proposal, and as a result this
      proposal (which is similar to GSE in most respects and inspired by it),
      responds directly to current concerns in the RIR communities. Edge
      networks are used to an environment in IPv4 in which their addressing is
      disjoint from that of their upstream transit networks; it is either
      provider independent, or a network prefix translator makes their
      external address distinct from their internal address, and they like the
      distinction. In IPv6, there is a mantra that edge network addresses
      should be derived from their upstream, and if they have multiple
      upstreams, edge networks are expected to design their networks to use
      all of those prefixes equivalently. They see this as unnecessary and
      unwanted operational complexity, and are as a result pushing very hard
      in the RIR communities for provider independent addressing.
</p>
<p>Widespread use of provider independent addressing has a natural and
      perhaps unavoidable side-effect that is likely to be very expensive in
      the long term. It means that the routing table will enumerate the
      networks at the edge of the transit domain, the edge networks, rather
      than enumerating the transit domain. Per the BGP Update Report of 17
      December 2010, there are currently over 36,000 Autonomous Systems being
      advertised in BGP, of which over 15,000 advertise only one prefix. There
      are in the neighborhood of 5000 AS's that show up in a non-final
      position in AS paths, and perhaps another 5000 networks whose AS numbers
      are terminal in more than one AS path. In other words, we have prefixes
      for some 36,000 transit and edge networks in the route table now, many
      of which arguably need an Autonomous System number only for multihoming.
      Current estimates suggest that we could easily see that be on the order
      of 10,000,000 within fifteen years. Tens of thousands of entries in the
      36,264 Autonomous Systems being advertised in BGP, of which 31,137
      provide no visible transit service to another AS, and 23,595 of those
      are visible in only one AS path (have only one upstream network). In
      addition, of the 36,264 AS's in the world, 15,439 advertise only a
      single prefix. In other words, we have prefixes for some 36,000 transit
      and edge networks in the route table now, many of which arguably need an
      Autonomous System number only for multihoming. However, the vast
      majority of networks (2/3) having the tools necessary to multihome are
      not visibly doing so, and would be well served by any solution that
      gives them address independence without the overhead of RIR membership
      and BGP routing.
</p>
<p>Current growth estimates suggest that we could easily see that be on
      the order of 10,000,000 within fifteen years. Tens of thousands of
      entries in the route table is very survivable; while our protocols and
      computers will likely do quite well with tens of millions of routes, the
      heat produced and power consumed by those routers, and the inevitable
      impact on the cost of those routers, is not a good outcome. To avoid
      having a massive and unscalable route table, we need to find a way that
      is politically acceptable and returns us to enumerating the transit
      domain, not the edge.
</p>
<p>There have been a number of proposals. As described, shim6 moves the
      complexity to the edge, and the edge is rebelling. Geographic addressing
      in essence forces ISPs to "own" geographic territory from a routing
      perspective, as otherwise there is no clue in the address as to what
      network a datagram should be delivered to in order to reach it.
      Metropolitan Addressing can imply regulatory authority, and even if it
      is implemented using internet exchange consortia, visits a great deal of
      complexity on the transit networks that directly serve the edge. The one
      that is likely to be most acceptable is any proposal that enables an
      edge network to be operationally independent of its upstreams, with no
      obligation to renumber when it adds, drops, or changes ISPs, and with no
      additional burden placed either on the ISP or the edge network as a
      result. From an application perspective, an additional operational
      requirement in the words of US NIST's Roadmap for the Smart Grid, is
      that </p>
<blockquote class="text">
<p>"...the Network should enable an application in a particular
          domain to communicate with an application in any other domain in the
          information network, with proper management control over who and
          where applications can be interconnected."
</p>
</blockquote>

<p>In other words, the structure of the network should allow for and
      enable appropriate access control, but the structure of the network
      should not inherently limit access.
</p>
<p>The GSE model, by statelessly translating the prefix between an edge
      network and its upstream transit network, accomplishes that with a
      minimum of fuss and bother. Stated in the simplest terms, it enables the
      edge network to behave as if it has a provider-independent prefix from a
      multihoming and renumbering perspective without the overhead of RIR
      membership or maintaining BGP connectivity, and it enables the transit
      networks to aggressively aggregate what are from their perspective
      provider-allocated customer prefixes, to maintain a rational-sized
      routing table.
</p>
<a name="math"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B"></a><h3>Appendix B.&nbsp;
Verification code</h3>

<p>This non-normative appendix is presented as a proof of concept. It is
      in no sense optimized; for example, one's complement arithmetic is
      implemented in portable subroutines, where operational implementations
      might use one's complement arithmetic instructions through a pragma;
      such implementations probably need to explicitly force 0xFFFF to 0x0000,
      as the instruction will not. The original purpose of the code was to
      verify whether or not it was necessary to suppress 0xFFFF by overwriting
      with zero, and whether predicted issues with subnet numbering were
      real.
</p>
<p>The point is to</p>
<ul class="text">
<li>demonstrate that if one or the other representation of zero is
          not used in the word the checksum is updated in, the program maps
          inner and outer addresses in a manner that is, mathematically, 1:1
          and onto (each inner address maps to a unique outer address, and
          that outer address maps back to exactly the same inner address),
          and
</li>
<li>give guidance on the suppression of 0xFFFF checksums.
</li>
</ul>

<p>In short, in one's complement arithmetic, x-x=0, but will take the
      negative representation of zero. If 0xFFFF results are forced to the
      value 0x0000, as is recommended in <a class='info' href='#RFC1071'>[RFC1071]<span> (</span><span class='info'>Braden, R., Borman, D., Partridge, C., and W. Plummer, &ldquo;Computing the Internet checksum,&rdquo; September&nbsp;1988.</span><span>)</span></a>, the
      word the checksum is adjusted in cannot be initially 0xFFFF, as on the
      return it will be forced to 0. If 0xFFFF results are not forced to the
      value 0x0000 as is recommended in <a class='info' href='#RFC1071'>[RFC1071]<span> (</span><span class='info'>Braden, R., Borman, D., Partridge, C., and W. Plummer, &ldquo;Computing the Internet checksum,&rdquo; September&nbsp;1988.</span><span>)</span></a>, the
      word the checksum is adjusted in cannot be initially 0, as on the return
      it will be calculated as 0+(~0) = 0xFFFF. We chose to follow <a class='info' href='#RFC1071'>[RFC1071]<span> (</span><span class='info'>Braden, R., Borman, D., Partridge, C., and W. Plummer, &ldquo;Computing the Internet checksum,&rdquo; September&nbsp;1988.</span><span>)</span></a>'s recommendations, which implies a requirement
      to not use 0xFFFF as a subnet number in networks with a /48 external
      prefix.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
/*
 * Copyright (c) 2010 IETF Trust and the persons identified as
 * authors of the code.  All rights reserved.  Redistribution
 * and use in source and binary forms, with or without
 * modification, are permitted provided that the following
 * conditions are met:
 *
 * o  Redistributions of source code must retain the above
 *    copyright notice, this list of conditions and the
 *    following disclaimer.
 *
 * o  Redistributions in binary form must reproduce the above
 *    copyright notice, this list of conditions and the
 *    following disclaimer in the documentation and/or other
 *    materials provided with the distribution.
 *
 * o  Neither the name of Internet Society, IETF or IETF Trust,
 *    nor the names of specific contributors, may be used to
 *    endorse or promote products derived from this software
 *    without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND
 * CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES,
 * INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR
 * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
 * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
 * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
 * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR
 * OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
 * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */
#include "stdio.h"
#include "assert.h"
/*
 * program to verify the NPTv6 algorithm
 *
 * argument:
 *     perform negative zero suppression: boolean
 *
 * method:
 *    We specify an internal and an external prefix. The prefix
 *    length is presumed to be the common length of both, and for
 *    this is a /48. We perform the three algorithms specified.
 *    the "packet" address is in effect the source address
 *    internal-&gt;external and the destination address
 *    external-&gt;internal.
 */
unsigned short  inner_init[] = {
    0xFD01, 0x0203, 0x0405, 1, 2, 3, 4, 5};
unsigned short  outer_init[] = {
    0x2001, 0x0db8, 0x0001, 1, 2, 3, 4, 5};
unsigned short  inner[8];
unsigned short  packet[8];
unsigned char   checksum[65536] = {0};
unsigned short  outer[8];
unsigned short  adjustment;
unsigned short  suppress;
/*
 * One's complement sum.
 * return number1 + number2
 */
unsigned short
add1(number1, number2)
    unsigned short  number1;
    unsigned short  number2;
{
    unsigned int    result;

    result = number1;
    result += number2;
    if (suppress) {
        while (0xFFFF &lt;= result) {
            result = result + 1 - 0x10000;
        }
    } else {
        while (0xFFFF &lt; result) {
            result = result + 1 - 0x10000;
        }
    }
    return result;
}

/*
 * One's complement difference
 * return number1 - number2
 */
unsigned short
sub1(number1, number2)
    unsigned short  number1;
    unsigned short  number2;
{
    return add1(number1, ~number2);
}

/*
 * return one's complement sum of an array of numbers
 */
unsigned short
sum1(numbers, count)
    unsigned short *numbers;
    int             count;
{
    unsigned int    result;

    result = *numbers++;
    while (--count &gt; 0) {
        result += *numbers++;
    }

    if (suppress) {
        while (0xFFFF &lt;= result) {
            result = result + 1 - 0x10000;
        }
    } else {
        while (0xFFFF &lt; result) {
            result = result + 1 - 0x10000;
        }
    }
    return result;
}

/*
 * NPTv6 initialization: section 3.1 assuming section 3.4
 *
 * create the /48, a source address in internal format, and a
 * source address in external format. calculate the adjustment
 * if one /48 is overwritten with the other.
 */
void
nptv6_initialization(subnet)
    unsigned short  subnet;
{
    int             i;
    unsigned short  inner48;
    unsigned short  outer48;

    /* initialize the internal and external prefixes. */
    for (i = 0; i &lt; 8; i++) {
        inner[i] = inner_init[i];
        outer[i] = outer_init[i];
    }
    inner[3] = subnet;
    outer[3] = subnet;
    /* calculate the checksum adjustment */
    inner48 = sum1(inner, 3);
    outer48 = sum1(outer, 3);
    adjustment = sub1(inner48, outer48);
}

/*
 * NPTv6 packet from edge to transit: section 3.2 assuming
 * section 3.4
 *
 * overwrite the prefix in the source address with the outer
 * prefix, and adjust the checksum
 */
void
nptv6_inner_to_outer()
{
    int             i;

    /* let's get the source address into the packet */
    for (i = 0; i &lt; 8; i++) {
        packet[i] = inner[i];
    }

    /* overwrite the prefix with the outer prefix */
    for (i = 0; i &lt; 3; i++) {
        packet[i] = outer[i];
    }

    /* adjust the checksum */
    packet[3] = add1(packet[3], adjustment);
}

/*
 * NPTv6 packet from transit to edge:: section 3.3 assuming
 * section 3.4
 *
 * overwrite the prefix in the destination address with the
 * inner prefix, and adjust the checksum
 */
void
nptv6_outer_to_inner()
{
    int             i;

    /* overwrite the prefix with the outer prefix */
    for (i = 0; i &lt; 3; i++) {
        packet[i] = inner[i];
    }

    /* adjust the checksum */
    packet[3] = sub1(packet[3], adjustment);
}

/*
 * main program
 */
main(argc, argv)
    int             argc;
    char          **argv;
{
    unsigned        subnet;
    int             i;

    if (argc &lt; 2) {
           fprintf(stderr, "usage: nptv6 supression\n");
           assert(0);
       }
       suppress = atoi(argv[1]);
       assert(suppress &lt;= 1);

       for (subnet = 0; subnet &lt; 0x10000; subnet++) {
           /* section 3.1: initialize the system */
           nptv6_initialization(subnet);

           /* section 3.2: take a packet from inside to outside */
           nptv6_inner_to_outer();

           /* the resulting checksum value should be unique */
           if (checksum[subnet]) {
                printf("inner-&gt;outer duplicated checksum: "
                       "inner: %x:%x:%x:%x:%x:%x:%x:%x(%x) "
                       "calculated: %x:%x:%x:%x:%x:%x:%x:%x(%x)\n",
                       inner[0], inner[1], inner[2], inner[3],
                       inner[4], inner[5], inner[6], inner[7],
                       sum1(inner, 8),
                       packet[0], packet[1], packet[2], packet[3],
                       packet[4], packet[5], packet[6], packet[7],
                       sum1(packet, 8));
        }

        checksum[subnet] = 1;

        /*
         * the resulting checksum should be the same as the inner
         * address's checksum
         */
        if (sum1(packet, 8) != sum1(inner, 8)) {
            printf("inner-&gt;outer incorrect: "
                   "inner: %x:%x:%x:%x:%x:%x:%x:%x(%x) "
                   "calculated: %x:%x:%x:%x:%x:%x:%x:%x(%x)\n",
                   inner[0], inner[1], inner[2], inner[3],
                   inner[4], inner[5], inner[6], inner[7],
                   sum1(inner, 8),
                   packet[0], packet[1], packet[2], packet[3],
                   packet[4], packet[5], packet[6], packet[7],
                   sum1(packet, 8));
        }

        /* section 3.3: take a packet from outside to inside */
        nptv6_outer_to_inner();

        /*
         * the returning packet should have the same checksum it
         * left with
         */
        if (sum1(packet, 8) != sum1(inner, 8)) {
            printf("outer-&gt;inner checksum incorrect: "
                   "calculated: %x:%x:%x:%x:%x:%x:%x:%x(%x) "
                   "inner: %x:%x:%x:%x:%x:%x:%x:%x(%x)\n",
                   packet[0], packet[1], packet[2], packet[3],
                   packet[4], packet[5], packet[6], packet[7],
                sum1(packet, 8), inner[0], inner[1], inner[2],
                   inner[3], inner[4], inner[5], inner[6],
                   inner[7], sum1(inner, 8));
        }

        /*
         * and every octet should calculate back to the same inner
         * value
         */
        for (i = 0; i &lt; 8; i++) {
            if (inner[i] != packet[i]) {
                printf("outer-&gt;inner different: "
                       "calculated: %x:%x:%x:%x:%x:%x:%x:%x "
                       "inner: %x:%x:%x:%x:%x:%x:%x:%x\n",
                   packet[0], packet[1], packet[2], packet[3],
                   packet[4], packet[5], packet[6], packet[7],
                       inner[0], inner[1], inner[2], inner[3],
                       inner[4], inner[5], inner[6], inner[7]);
                break;
            }
        }
    }
}
</pre></div>
<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Margaret Wasserman</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Painless Security</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">North Andover, MA  01845</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 781 405 7464</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:mrw@painless-security.com">mrw@painless-security.com</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.painless-secuirty.com">http://www.painless-secuirty.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Fred Baker</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Santa Barbara, California  93117</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1-408-526-4257</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:fred@cisco.com">fred@cisco.com</a></td></tr>
</table>
</body></html>
