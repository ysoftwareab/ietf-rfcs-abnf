<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>BGP Optimal Route Reflection</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.2" rel="Chapter" title="2 Terminology">
<link href="#rfc.section.3" rel="Chapter" title="3 Problem Statement: Ensuring Closest Exit Routing">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 BGP Add-Path to offer Closest Exit Routing">
<link href="#rfc.section.4" rel="Chapter" title="4 Service POPs">
<link href="#rfc.section.5" rel="Chapter" title="5 Scalability with Add-Path">
<link href="#rfc.section.5.1" rel="Chapter" title="5.1 Announcing a user defined number of BGP Paths">
<link href="#rfc.section.5.2" rel="Chapter" title="5.2 Announcing the Best path">
<link href="#rfc.section.5.3" rel="Chapter" title="5.3 Use of Route Targets and ASBRs">
<link href="#rfc.section.5.4" rel="Chapter" title="5.4 Use of Route Targets  and ASBRs with limited routes">
<link href="#rfc.section.5.5" rel="Chapter" title="5.5 Operational Scalability with the use of Route Targets">
<link href="#rfc.section.5.6" rel="Chapter" title="5.6 Use of Route Targets and POPs with no ASBR">
<link href="#rfc.section.5.7" rel="Chapter" title="5.7 Behaviour without RT configuration">
<link href="#rfc.section.5.8" rel="Chapter" title="5.8 Difference between Default RT and RT configured on RR for Best Path announcements ">
<link href="#rfc.section.6" rel="Chapter" title="6 IANA Considerations">
<link href="#rfc.section.7" rel="Chapter" title="7 Security Considerations">
<link href="#rfc.section.8" rel="Chapter" title="8 Acknowledgements">
<link href="#rfc.references" rel="Chapter" title="9 References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="This document describes procedures on providing optimal routing for IPv4 Internet traffic based on the shortest IGP metric. It builds on the ability of advertising multiple paths for a given destination prefix, using BGP Add-Path and provides a solution for selectively indicating preferences towards BGP path(s) via affinities.  " />
  <meta name="description" content="This document describes procedures on providing optimal routing for IPv4 Internet traffic based on the shortest IGP metric. It builds on the ability of advertising multiple paths for a given destination prefix, using BGP Add-Path and provides a solution for selectively indicating preferences towards BGP path(s) via affinities.  " />
  <meta name="keywords" content="IDR, BGP, GROW, ADD-PATH" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Network Working Group</td>
<td class="right">L. Lavallee, Ed.</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">A.K. Khopkar</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">Sky Network Services</td>
</tr>
<tr>
<td class="left">Expires: December 06, 2011</td>
<td class="right">V.J. Joseph</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Juniper Networks</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">C.S. Shah</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">G. Thareja</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">COLT Technology Services</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">June 04, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">BGP Optimal Route Reflection<br />
  <span class="filename">draft-vinod-lavallee-bgp-optimal-route-reflection-00</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>This document describes procedures on providing optimal routing for IPv4 Internet traffic based on the shortest IGP metric. It builds on the ability of advertising multiple paths for a given destination prefix, using BGP Add-Path and provides a solution for selectively indicating preferences towards BGP path(s) via affinities.  </p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on December 06, 2011.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>2.   <a href="#rfc.section.2">Terminology</a>
</li>
<li>3.   <a href="#rfc.section.3">Problem Statement: Ensuring Closest Exit Routing</a>
</li>
<li>3.1.   <a href="#rfc.section.3.1">BGP Add-Path to offer Closest Exit Routing</a>
</li>
<li>4.   <a href="#rfc.section.4">Service POPs</a>
</li>
<li>5.   <a href="#rfc.section.5">Scalability with Add-Path</a>
</li>
<li>5.1.   <a href="#rfc.section.5.1">Announcing a user defined number of BGP Paths</a>
</li>
<li>5.2.   <a href="#rfc.section.5.2">Announcing the Best path</a>
</li>
<li>5.3.   <a href="#rfc.section.5.3">Use of Route Targets and ASBRs</a>
</li>
<li>5.4.   <a href="#rfc.section.5.4">Use of Route Targets  and ASBRs with limited routes</a>
</li>
<li>5.5.   <a href="#rfc.section.5.5">Operational Scalability with the use of Route Targets</a>
</li>
<li>5.6.   <a href="#rfc.section.5.6">Use of Route Targets and POPs with no ASBR</a>
</li>
<li>5.7.   <a href="#rfc.section.5.7">Behaviour without RT configuration</a>
</li>
<li>5.8.   <a href="#rfc.section.5.8">Difference between Default RT and RT configured on RR for Best Path announcements </a>
</li>
<li>6.   <a href="#rfc.section.6">IANA Considerations</a>
</li>
<li>7.   <a href="#rfc.section.7">Security Considerations</a>
</li>
<li>8.   <a href="#rfc.section.8">Acknowledgements</a>
</li>
<li>9.   <a href="#rfc.references">References</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> <a href="#Introduction" id="Introduction">Introduction</a>
</h1>
<p id="rfc.section.1.p.1">This document describes applications and carrier Internet routing requirements that can be fulfilled by using <a href="#RFC4271">BGP</a> <cite title="NONE">[RFC4271]</cite> <a href="#I-D.ietf-idr-add-paths">Add-Path</a> <cite title="NONE">[I-D.ietf-idr-add-paths]</cite>, and proposes a mechanism to use affinities with the BGP protocol to influence path selection.  </p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> Terminology</h1>
<p></p>

<ul class="empty">
<li>Add-Path: <a href="#I-D.ietf-idr-add-paths">Advertisement of Multiple Paths in BGP</a> <cite title="NONE">[I-D.ietf-idr-add-paths]</cite>
</li>
<li>ASBR: Autonomous System Border Router -- an Internet Gateway router connected to a Public Autonomous System</li>
<li>CE: Host or router or switch</li>
<li>P: Provider or Core router</li>
<li>PE: Provider Edge Router connected to an end customer, offering Internet transit services</li>
<li>POP: Carrier's Point of Presence</li>
<li>Major POP: Large POP thats forms the nerve center of the carrier network</li>
<li>Minor POP: Smaller POP that is connected downstream to a Major POP(s)</li>
<li>RR: A BGP Route Reflector <a href="#RFC4456">[RFC4456]</a>
</li>
</ul>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> Problem Statement: Ensuring Closest Exit Routing</h1>
<p id="rfc.section.3.p.1">Carriers have diverse deployments of peering points, which may not reflect the network hierarchy.  For instance major POPs, which form the core of the network hierarchy may not be the only POPs to have Internet peering/transit points.  It is common for POPs further down the network hierarchy (minor POPs) to also have Internet peering/ transit arrangements.  </p>
<p id="rfc.section.3.p.2">A very common requirement is to offer closest exit routing for Internet traffic.  In other words traffic originating from POP-A should always use the local ASBR (if there is a viable path available locally).  We make the assumption that complete Internet routing information is available at every ASBR.  If the local ASBR does not have reachibility to the relevant prefixes (or the ASBR itself is not available), traffic should use the closest (in terms of IGP metric) egress.  This is typically known as "hot potato routing".  </p>
<p id="rfc.section.3.p.3">In order to ensure the required behavior, a design as follows is commonly deployed: </p>
<p id="rfc.section.3.p.4">The dotted lines denote both the physical connections between devices, as well as the BGP RR Client to RR peering sessions.  </p>
<div id="#rfc.figure.1"></div>
<pre>
                  +-----------+          +-----------+
                  | PE Layer  |          | ASBR Layer|
                __|__,-----.  |  ------- |    ----- _|_____
        ,---.  /  | ( PEA  ).....P-Core ... ASBR1 )  |     \  ,---.
       /     \/   |  `----- . |. ------- | . .-----  |      \/     \
      (  CE   |   |          .|          |  .        |      ( AS XYZ)
       \     /\___|__,----- . |. ------- | . -----   |      /\     /
        `---'     | ( PEB  ).....P-Core ... ASBR2 ) _|_____/  `---'
                  |  `-----'  |  ------- |   -----   |
                  +-----------+          +-----------+
            </pre>
<p id="rfc.section.3.p.5">In the illustration above, each ASBR advertises its available prefixes to each of the core (Provider) routers.  Each of the P routers acts as a route reflector for all of the PE routers in a given POP.  This generally ensures that for any given prefix each PE router will pick a path via the local ASBR(s).  </p>
<p id="rfc.section.3.p.6">We note two problems with this design: </p>
<p id="rfc.section.3.p.7">First, core routers carry BGP, and this hinders operators eager to deploy a purely label switched, BGP free core for all traffic types and applications.  </p>
<p id="rfc.section.3.p.8">Second, some address families (e.g.  VPNv4, MVPNv4, etc) may be deployed using dedicated route reflectors located at strategic locations (major POPs for instance).  If IPv4 Internet route reflection is distributed to each P router in each POP as described above, the challenge is to provide a transition plan to overcome the first problem (achieve a BGP free core) and also move to a consolidated scheme of route reflector deployment such as is used by other address families.  </p>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> BGP Add-Path to offer Closest Exit Routing</h1>
<p id="rfc.section.3.1.p.1">In the near term not all devices in the network will support BGP Add- Path.  This is because relatively smaller/legacy hardware may not have the scale to support multiple paths for a given prefix, or it is just not planned to be supported.  Therefore carriers may deploy alternate models - as illustrated in the following sections, to achieve the following: </p>
<p></p>

<ul class="empty">
<li>Can help a carrier remove BGP from its core routers, and make way for a purely label switched core for IPv4 Internet traffic, and </li>
<li>Can help the carrier deploy Add-Path in a phased manner, without altering traffic patterns.  </li>
</ul>
<p id="rfc.section.3.1.p.3">In order to address the issue of removing BGP from the P routers, the BGP client-RR peering sessions which were originally between the PE and P routers may be shifted from the P routers to the ASBR(s).  Therefore an ASBR may now perform the role of Route Reflector for all of its locally connected PE routers (i.e within the same POP).  The P routers are relieved of this role.  </p>
<div id="#rfc.figure.2"></div>
<pre>
                  +-----------+==========+-----------+
                  | PE Layer  |          | ASBR Layer|
                __|__,-----.  |  ------- |    ----- _|_____
        ,---.  /  | ( PEA  ).....P-Core ... ASBR1 )  |     \  ,---.
       /     \/   |  `----- . |. ------- | . .-----  |      \/     \
      (  CE   |   |          .|          |  .        |      ( AS XYZ)
       \     /\___|__,----- . |. ------- | . -----   |      /\     /
        `---'     | ( PEB  ).....P-Core ... ASBR2 ) _|_____/  `---'
                  |  `-----'  |  ------- |   -----   |
                  +-----------+==========+-----------+

            </pre>
<p id="rfc.section.3.1.p.4">The "==" lines indicate that the client to RR sessions that were originally between the PE and P routers are shifted to be between the PE and ASBR(s) layers.  </p>
<p id="rfc.section.3.1.p.5">We note that ASBRs will generally have a large RIB/FIB capacity, due to the fact that they may connect to more than one upstream provider/AS.  Therefore resource constraints will be less likely to hinder adoption of Add-Path on such systems.  </p>
<p id="rfc.section.3.1.p.6">Carriers normally utilize centralized RRs, placed at strategic locations of their choice, for consolidation of iBGP sessions from the ASBRs.  Therefore each ASBR would normally peer with one or more dedicated/central RRs for BGP route propagation between each ASBR. It is to be noted that both the RR and ASBRs need to support the adoption of BGP Add-Path.  </p>
<p id="rfc.section.3.1.p.7">It is to be noted that both the RR and ASBRs need to support the adoption of BGP Add-Path. This is illustrated below: </p>
<div id="#rfc.figure.3"></div>
<pre>

            +-----------+==========+-----------+
            | PE Layer  |          | ASBR Layer|
          __|__,-----.  |  ------- |    ----- _|_____
  ,---.  /  | ( PEF  ).....P-Core ... ASBR1 )  |     \  ,---.
 /     \/   |  `----- . |. ------- | . .-----  |      \/     \
(  CE   |   |          .|          |  .        |      ( AS ABC)
 \     /\___|__,----- . |. ------- | . -----   |      /\     /
  `---'     | ( PEG  ).....P-Core ... ASBR2 ) _|_____/  `---'
            |  `-----'  |  ------- |   -----   |
            +-----------+==========+-----------+
                                          |                !
                                          |
                                          v
                                    +-----------+
                                    |CENTRAL RRs|
                                    |           |
                                    |   ------  |
                                    |  (  RR1 ) |
                                    |   ------  |
                                    |           |
                                    |   ------  |
                                    |  (  RR2 ) |
                                    |   -----   |
                                    +-----------+
                                          ^
                                          | ------------&gt; Each ASBR
                                          |               is peered
                                          |               with
            +-----------+==========+-----------+          Centralized
            | PE Layer  |          | ASBR Layer|          RRs.
          __|__,-----.  |  ------- |    ----- _|_____
  ,---.  /  | ( PEC  ).....P-Core ... ASBR3 )  |     \  ,---.
 /     \/   |  `----- . |. ------- | . .-----  |      \/     \
(  CE   |   |          .|          |  .        |      ( AS XYZ)
 \     /\___|__,----- . |. ------- | . -----   |      /\     /
  `---'     | ( PED  ).....P-Core ... ASBR4 ) _|_____/  `---'
            |  `-----'  |  ------- |   -----   |
            +-----------+==========+-----------+
             </pre>
<p id="rfc.section.3.1.p.8">Each ASBR will now receive multiple paths for a given destination prefix, due to the adoption of Add-Path. The ASBRs would now perform the best path selection for a given prefix, which would ideally result in the local path received i.e. the path received from an external peer - to be preferred over paths received from other ASBRs within the carrier network. It is this path, which would be advertised to the PE routers within a local POP or region - that are peered with a given ASBR.  </p>
<p id="rfc.section.3.1.p.9">This scheme of deployment provides a means of extending BGP Add-Path to the entire network, in a seamless and phased manner, while at the same time providing carriers the means to achieve closest exit routing, and deploy a BGP free core (which was the only means of achieving such routing requirements without Add-Path).  </p>
<p id="rfc.section.3.1.p.10">Eventually a carrier may be able to consolidate all iBGP sessions on a centralized RR, based on the adoption of Add-Path on PEs. This could relieve the ASBR of route reflection responsibilities.  </p>
<p id="rfc.section.3.1.p.11">Extending BGP Add-Path in a phased manner to PE devices that support this feature also improves convergence and reduces churn in the event of a preferred path for a given prefix being unavailable, since multiple paths are available on the PE and the decision process can now be re-run on the PE itself.  </p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> Service POPs</h1>
<p id="rfc.section.4.p.1">Carriers need to deploy services (for example, DNS, RADIUS, etc) with N+M resiliency with a view of offering high availability, geo resiliency and load sharing to scale the solution horizontally.  Given such requirements an anycast routing approach may seem to be favorable.  A virtual address or set of addresses for each application may be advertised via BGP from every service POP.  The advantage of using BGP is that PE routers can learn BGP paths to each service POP and have a local policy based on affinity or other design to load-share and provide resilience.  </p>
<p id="rfc.section.4.p.2">However the downside of this approach is that all PE routers are required to have a mesh of BGP sessions to all service POPs in addition to the existing iBGP sessions with RRs and other eBGP sessions.  PEs at a service POP also need to support a large number of BGP sessions (linear in the number of PEs in the network under consideration).  Illustrated below: </p>
<div id="#rfc.figure.4"></div>
<pre>

               +-----------+
               |SERVICE POP|
               |   ------  |
               |  (  DNS ) |
               |   ------  |
               |           |
               |   ------  |
               |  (  AAA ) |
               |   -----   |
               +-----------+


               +-----------+
               |SERVICE POP|                         +-----------+
               |           |                         |           |
               |   ------  |                         |           |
               |  (  DNS ) |                         |   PE1     |
               |   ------  |                         |   PE2     |
               |           |                         |    .      |
               |           |                         |    .      |
               |           |                         |   PE10    |
               |           |                         |           |
               |           |                         |           |
               |           |                         |           |
               |   ------  |                         |           |
               |  (  AAA ) |                         +-----------+
               |   -----   |
               +-----------+

               +-----------+
               |SERVICE POP|
               |           |
               |   ------  |
               |  (  WWW ) |
               |   ------  |
               |           |
               |   ------  |
               |  (  DNS ) |
               |   -----   |
               +-----------+
            </pre>
<p id="rfc.section.4.p.3">Above we have three service POPs, and 10 PE routers.  This would demand that each PE router has an iBGP session to each of the Service POPs, which may be highly undesirable.  </p>
<p id="rfc.section.4.p.4">Operationally this implies that any POP commissioning or de- commissioning activity involves multiple touch points on the network and additional change control processes need to be invoked as business critical services are located behind PEs in service POPs.  This also increases the risk to other services by nature of change enforced at multiple points.  </p>
<p id="rfc.section.4.p.5">In the event of Add-Path being incrementally supported on PE devices, BGP Add-Path can be effectively used in these solutions as the RR completely decouples itself from the path selection process and PE routers are presented with all available paths to service POPs.  No additional BGP sessions are needed other than the existing iBGP sessions with RRs.  </p>
<p id="rfc.section.4.p.6">A second benefit is that the number of configuration touches required in order to take a service offline is reduced.  For example, this can be accomplished by means of signalling a community (or other attribute) by the relevant service PE.  Although this can be done today in a full mesh, all PEs receiving the signaled route must have coherent BGP policies, which can present operational challenges.  By contrast, in the proposed scheme, only the RRs directly serving the service PE need to be considered.  We also observe that current practice of taking an entire service POP off-line by manipulating IGP metrics may not always be feasible if multiple services/applications are offered from this POP.  </p>
<p id="rfc.section.4.p.7">In sum this approach allows carriers to operate services in a very low touch mode where chances of collateral damage are minimized, policy enforcement is made simpler and demands are eased on operational processes and resources.  </p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#scalability_with_add_path" id="scalability_with_add_path">Scalability with Add-Path</a>
</h1>
<p id="rfc.section.5.p.1">One of the concerns in accepting all paths for a given prefix is scalability.  For instance if there are 5 given paths for a prefix - Add-Path would ensure that all paths are accepted by the PE routers, and this is likely to pose scalability concerns with regard to whether the PE router can indeed accept that many BGP paths. Further if a given PE router is accepting full internet tables, not every hardware installed in the network may have the capacity to handle this.  </p>
<p id="rfc.section.5.p.2">Therefore the requirements here can be defined as following: </p>
<p></p>

<ul class="empty">
<li>Firstly each BGP speaker should have the ability to indicate the maximum number of paths that are acceptable for a given prefix. This can be configurable on the PE or/and the RR within the context of a BGP peer-group.  </li>
<li>Secondly each PE router should have the ability to receive the "best-path" to given destination prefix based on the closest ASBR, that is defined by the shortest IGP metric, in order to avoid "Hot Potato routing".  </li>
</ul>

<p> </p>
<h1 id="rfc.section.5.1">
<a href="#rfc.section.5.1">5.1.</a> <a href="#announcing_a_user_defined_number_of_BGP_paths" id="announcing_a_user_defined_number_of_BGP_paths">Announcing a user defined number of BGP Paths</a>
</h1>
<p id="rfc.section.5.1.p.1">Having a limited number of paths being announced via Add-Path may well result in the "best-path" not being announced to a given PE. For instance if RR1 receives 5 paths for Prefix "A", and if PE1 is configured to only accept 2 paths for any given prefix - then PE1 will receive 2 paths for prefix "A" which would be based on the best path calculation from the viewpoint of RR1.  In other words each PE will receive random paths from the RR, based on the RRs view of each path which it considers the best and not the ones which would ideally be preferred by the PE.  So even though we have solved the issue of scalability, the bigger issue of choosing the closest ASBR based on IGP metric on each PE still remains. This is addressed in the following sections.  </p>
<h1 id="rfc.section.5.2">
<a href="#rfc.section.5.2">5.2.</a> <a href="#announcing_the_best_path" id="announcing_the_best_path">Announcing the Best path</a>
</h1>
<p id="rfc.section.5.2.p.1">The objective here is to ensure that the "best path" based on the shortest IGP metric from each PE to an ASBR is announced by the RR. In other words if a PE indicates its preference to receive only 2 paths for every prefix, from the RR - the RR should ensure that one of these two paths announced includes the path announced by an ASBR that is closest to this PE (based on the IGP metric).  </p>
<p id="rfc.section.5.2.p.2">In order to achieve this, Route Targets with RT Constrain <a href="#RFC4684">[RFC4684]</a> for IPv4 prefixes are proposed.  In other words a BGP speaker will have the ability to advertise all of its prefixes using an Route Target, while announcing this to a Route Reflector or an External BGP session.  </p>
<p id="rfc.section.5.2.p.3">RT usage in an IPv4 environment would be similar to the standard model used in BGP/MPLS VPNs, where each prefix may have one or more of this extended community attached to it. The purpose is to identify prefixes and paths with certain Route Targets and have them advertised. To further illustrate this from a real life deployment standpoint, A single RT may be used on a per POP/Region - depending on the operator's preference.  The RT may be used to indicate the group to which all BGP speakers belong to, and can be used as an identifier to refer to a given POP or region. For instance all BGP speakers within a POP located at Frankfurt can use an RT of "X", whilst BGP speakers in New York can use RT "Y".  </p>
<p id="rfc.section.5.2.p.4">Route Targets in the context of IPv4 would not demarcate the network into various boundaries, and only intends to serve merely as a mechanism to indicate a preference for certain BGP paths. Let us assume that there are three ASBRs in a given network; ASBR1 is located in Frankfurt, ASBR2 is located in New York, and ASBR3 is located in Tokyo. Now when Add-Path is used, all 3 paths would be announced to each PE in all the locations. Let us assume that each PE is configured to receive only 2 paths instead of all 3. In this case RT Constrain may be used to instruct the RR to announce a set of paths that match the RT Membership NLRI.  </p>
<p id="rfc.section.5.2.p.5">For instance, if all PEs and ASBRs in Tokyo are configured to advertise all prefixes with a RT called "X:1", PEs and ASBRs in New York configured as "X:2", PEs in London are configured for "X:3"and so on - Let us say that the PE routers in Tokyo intend to only receive the local ASBR paths, and the same applies to the PE routers in New York and London. Each PE can use the RT Membership NLRI (via RT Constrain) to only signal interest in the respective Route Targets and receive only BGP paths from  their local ASBR.  </p>
<p id="rfc.section.5.2.p.6">The use of Route Targets within the context of IPv4 does not change the 32 bit IPv4 prefix structure, and also does not mandate the need of any additional information to be contained within the prefix itself.  Route Targets would be advertised as IPv4 BGP extended communities.  </p>
<p id="rfc.section.5.2.p.7">It is also proposed that the RR may have the ability to restrict the number of paths on a per RT basis towards each BGP speaker. This will ensure that a given speaker may be configured to receive a only a given number of paths per RT - wherein each RT may correspond to one or more ASBRs. This will ensure that not all paths are announced to a PE that only needs "N" paths. If a given path within the context of an RT is withdrawn - then an alternate path (if exists) with the same RT would need to be advertised to the concerned PE.  </p>
<h1 id="rfc.section.5.3">
<a href="#rfc.section.5.3">5.3.</a> <a href="#Use-of_Zone_ID_and_ASBRs" id="Use-of_Zone_ID_and_ASBRs">Use of Route Targets and ASBRs</a>
</h1>
<p id="rfc.section.5.3.p.1">Let us look at a scenario on how the use of Route Targets impacts route announcements to ASBRs.  Referring back to the example in the previous section - using the example of three POPs in New York, London, and Tokyo - we may prefer that each ASBR in the network receives prefixes and paths for each prefix from every ASBR in the network. Therefore it is fair to assume that none of the ASBR's would ever be configured to restrict the maximum number of paths that it can accept. Therefore a "Default RT" may be advertised by each ASBR. The default   RT instructs the RR to announce all paths/prefixes to ASBRs.  So each of the three ASBRs would receive all the paths announced by the others. However this does not restrict the option of configuring an ASBR to only receive a given number of paths.  </p>
<p id="rfc.section.5.3.p.2">It is to be noted that the "Default RT" indicates that all prefixes/paths even without a corresponding RT will be considered as candidates for announcements.  </p>
<h1 id="rfc.section.5.4">
<a href="#rfc.section.5.4">5.4.</a> <a href="#use_of_Zone_ID_and_ASBRs_with_limited_routes" id="use_of_Zone_ID_and_ASBRs_with_limited_routes">Use of Route Targets  and ASBRs with limited routes</a>
</h1>
<p id="rfc.section.5.4.p.1">Let us look at a case where a POPs in the network has an ASBR with only limited number of Internet routes, for instance 1000 IPv4 Internet Prefixes. So let us say, this POP located is located in Munich, and its scope is to provide transit to only a given number of prefixes that are announced by a content provider.  </p>
<p id="rfc.section.5.4.p.2">In this scenario, all PEs in the Munich POP may be configured to use the same Route Targets used by a POP that has ASBRS with full routes (Let us say Frankfurt, which has an ASBR with full Internet routes) and just indicate interest in the single common RT via an RT membership NLRI. It is also possible to for the BGP speakers in Munich to use an independent RT which is common for the POP, and signal interest in the local prefixes/paths in addition to the Frankfurt Prefixes/Paths using RT Constrain.  </p>
<p></p>
<h1 id="rfc.section.5.5">
<a href="#rfc.section.5.5">5.5.</a> <a href="#OPSCAL" id="OPSCAL">Operational Scalability with the use of Route Targets</a>
</h1>
<p id="rfc.section.5.5.p.1">Let us consider a scenario where, a BGP speaker is interested in multiple RTs. The proposal suggests that any implementation should have the ability for a given BGP speakers to use a range of RT values and Wildcards to signal affinities. For example a range as follows indicates that the RT Membership NLRI includes RT values of [1-20, 30-35, 50]. This avoids the need for configuring each RT value individually.  </p>
<p id="rfc.section.5.5.p.2">A second consideration is for a PE to receive all paths announced by a set of ASBRs - indicated by a list of RTs (let us say "X:Y, X:Z", and have the RR calculated best path for all the remaining prefixes ir-respective of whether they have any RTs attached or not. Going back to the example of the Munich POP which only had a local ASBR with 1000 prefixes, it may be important for the operator to just ensure that all local ASBR paths are available in the local PEs - whilst all other paths/prefixes may follow the best path calculated by the RR.  </p>
<p id="rfc.section.5.5.p.3">In this it is proposed that each RR in the network can be configured with a unique RT. For instance RR1 may be configured with RT A:B, while RR2 is configured with with A:C. Each BGP speaker by virtue of signalling the RT configured on each RR (A:B, A:C) via RT Constrain instructs the RR to only announce the best path for all prefixes with or without Route Targets. This way each BGP speaker can choose which RR it intends to receive the best path from, and which RR it may choose to receive paths for specific Route Targets. This provides the needed flexibility for an operator.  </p>
<h1 id="rfc.section.5.6">
<a href="#rfc.section.5.6">5.6.</a> <a href="#Use_with_no_ASBR" id="Use_with_no_ASBR">Use of Route Targets and POPs with no ASBR</a>
</h1>
<p id="rfc.section.5.6.p.1">In the scenario where a given POP does not have any local ASBRs, all PEs could just use RT Membership NLRI to indicate the preference of paths they would like to receive.  </p>
<h1 id="rfc.section.5.7">
<a href="#rfc.section.5.7">5.7.</a> <a href="#no-rt" id="no-rt">Behaviour without RT configuration</a>
</h1>
<p id="rfc.section.5.7.p.1">RT advertisement and RT membership NLRI used to signal RT constrain are two different aspects. For instance an ASBR may not attach an RT to any of its announcements, but can still indicate its preference by using a list of RTs that it is interested in (via Route Constrain). Similarly an ASBR can advertise all its prefixes with an RT of "X:Y" for example, and indicate a Default RT Membership NLRI, to receive all paths/prefixes.  </p>
<h1 id="rfc.section.5.8">
<a href="#rfc.section.5.8">5.8.</a> <a href="#behavior_without_Zone_ID_and_domain_ID" id="behavior_without_Zone_ID_and_domain_ID">Difference between Default RT and RT configured on RR for Best Path announcements </a>
</h1>
<p id="rfc.section.5.8.p.1">The Default RT ensures that all paths/prefixes in the network, ir-respective of whether an RT is attached or not - is advertised to a given BGP speaker by the RR. It is possible to configure the maximum no. of paths that will be advertised to BGP speakers via the Default RT.On the contrary, RT configured on the RR instructs the RR to send only the best path for prefixes (prefixes may have RTs attached or even may not).  </p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#iana_considerations" id="iana_considerations">IANA Considerations</a>
</h1>
<p id="rfc.section.6.p.1">This informational document introduces no IANA considerations.  </p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> <a href="#security_considerations" id="security_considerations">Security Considerations</a>
</h1>
<p id="rfc.section.7.p.1">This document discusses deployment practices and has no effect on the security of the underlying routing protocols.  </p>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> <a href="#Acknowledgements" id="Acknowledgements">Acknowledgements</a>
</h1>
<p id="rfc.section.8.p.1">We would like to thank Rahul Aggarwal, Yakov Rekhter, John Scudder and Ronald Bonica for discussions that helped.  </p>
<h1 id="rfc.references">
<a href="#rfc.references">9.</a> References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2796">[RFC2796]</b></td>
<td class="top">
<a href="mailto:tbates@cisco.com" title="Cisco Systems, Inc.">Bates, T.</a>, <a href="mailto:rchandra@redback.com" title="Redback Networks Inc.">Chandra, R.</a> and <a href="mailto:enke@redback.com" title="Redback Networks Inc.">E. Chen</a>, "<a href="http://tools.ietf.org/html/rfc2796">BGP Route Reflection - An Alternative to Full Mesh IBGP</a>", RFC 2796, April 2000.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4271">[RFC4271]</b></td>
<td class="top">
<a>Rekhter, Y.</a>, <a>Li, T.</a> and <a>S. Hares</a>, "<a href="http://tools.ietf.org/html/rfc4271">A Border Gateway Protocol 4 (BGP-4)</a>", RFC 4271, January 2006.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4456">[RFC4456]</b></td>
<td class="top">
<a>Bates, T.</a>, <a>Chen, E.</a> and <a>R. Chandra</a>, "<a href="http://tools.ietf.org/html/rfc4456">BGP Route Reflection: An Alternative to Full Mesh Internal BGP (IBGP)</a>", RFC 4456, April 2006.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4684">[RFC4684]</b></td>
<td class="top">
<a>Marques, P.</a>, <a>Bonica, R.</a>, <a>Fang, L.</a>, <a>Martini, L.</a>, <a>Raszuk, R.</a>, <a>Patel, K.</a> and <a>J. Guichard</a>, "<a href="http://tools.ietf.org/html/rfc4684">Constrained Route Distribution for Border Gateway Protocol/MultiProtocol Label Switching (BGP/MPLS) Internet Protocol (IP) Virtual Private Networks (VPNs)</a>", RFC 4684, November 2006.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4786">[RFC4786]</b></td>
<td class="top">
<a>Abley, J.</a> and <a>K. Lindqvist</a>, "<a href="http://tools.ietf.org/html/rfc4786">Operation of Anycast Services</a>", BCP 126, RFC 4786, December 2006.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-idr-add-paths">[I-D.ietf-idr-add-paths]</b></td>
<td class="top">
<a>Walton, D</a>, <a>Chen, E</a>, <a>Retana, A</a> and <a>J Scudder</a>, "<a href="http://tools.ietf.org/html/draft-ietf-idr-add-paths-06">Advertisement of Multiple Paths in BGP</a>", Internet-Draft draft-ietf-idr-add-paths-06, September 2011.</td>
</tr>
</tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">L.Lavallee</span> editor
	  <span class="n hidden">
		<span class="family-name">Lavallee</span>
	  </span>
	</span>
	<span class="org vcardline">Sky Network Services</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:laurent.lavallee@sns.bskyb.com">laurent.lavallee@sns.bskyb.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Amit Khopkar</span> 
	  <span class="n hidden">
		<span class="family-name">Khopkar</span>
	  </span>
	</span>
	<span class="org vcardline">Sky Network Services</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:amit.khopkar@sns.bskyb.com">amit.khopkar@sns.bskyb.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Vinod Joseph</span> 
	  <span class="n hidden">
		<span class="family-name">Joseph</span>
	  </span>
	</span>
	<span class="org vcardline">Juniper Networks</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:vjoseph@juniper.net">vjoseph@juniper.net</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Chintan Shah</span> 
	  <span class="n hidden">
		<span class="family-name">Shah</span>
	  </span>
	</span>
	<span class="org vcardline">COLT Technology Services</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:chintan.shah@colt.net">chintan.shah@colt.net</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">G. Thareja</span> 
	  <span class="n hidden">
		<span class="family-name">Thareja</span>
	  </span>
	</span>
	<span class="org vcardline">COLT Technology Services</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:gaurav.thareja@colt.net">gaurav.thareja@colt.net</a></span>

  </address>
</div>

</body>
</html>