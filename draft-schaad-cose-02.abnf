COSE_MSG = {msg_type=>1, COSE_Sign} /
              {msg_type=>2, COSE_encrypt} /
              {msg_type=>3, COSE_mac}

COSE_Tagged_MSG = #6.999(COSE_MSG)   ; Replace 999 with TBD1


keys = int / tstr
header_map = {+ keys => any }

Headers = (
       ? protected => bstr,
       ? unprotected => header_map
COSE_Sign = (
       Headers,
       ? payload => bstr,
signatures=> [+{COSE_signature}]
COSE_signature =  (
       ? protected => bstr,
       ? unprotected => header_map,
signature => bstr
Sig_structure = [
body_protected => bstr,
sign_protected => bstr,
payload => bstr
COSE_encrypt = (
      Headers,
      ? iv => bstr,
      ? aad => bstr,
      ? ciphertext => bstr,
      ? recipients => [+COSE_encrypt_a]
COSE_encrypt_a = {COSE_encrypt}


Enc_structure = [
protected => bstr,
aad => bstr
COSE_mac = (
      Headers,
      ? payload => bstr,
tag => bstr,
MAC_structure = [
protected => bstr,
payload => bstr
COSE_Key = {
kty => tstr / int,
COSE_KeySet = [+COSE_Key]


msg_type=1
protected=2
unprotected=3
payload=4
signatures=5
signature=6
iv=7
aad=8
ciphertext=4
recipients=9
tag=10


kty=1
key_kid=2
key_alg=3


