AUTHm           =3D %x41.55.54.48           ; AUTH in caps
Method          =3D SENDm / VISITm / REPORTm / AUTHm
                        / extension-method

                /   "401"  ;  Authentication Required
                /   "423"  ;  Interval Out-of-Bounds



Authentication-Info  =3D  "Authentication-Info" HCOLON ainfo
                           *(COMMA ainfo)
ainfo                =3D  nextnonce / message-qop
                            / response-auth / cnonce
                            / nonce-count
nextnonce            =3D  "nextnonce" EQUAL nonce-value
response-auth        =3D  "rspauth" EQUAL response-digest



response-digest      =3D  LDQUOT *LHEX RDQUOT

Authorization     =3D  "Authorization" HCOLON credentials
credentials       =3D  ("Digest" LWS digest-response)
                        / other-response
digest-response   =3D  dig-resp *(COMMA dig-resp)
dig-resp          =3D  username / realm / nonce / digest-uri
                         / dresponse / algorithm / cnonce
                         / opaque / message-qop
                         / nonce-count / auth-param
username          =3D  "username" EQUAL username-value
username-value    =3D  quoted-string
digest-uri        =3D  "uri" EQUAL LDQUOT digest-uri-value RDQUOT
digest-uri-value  =3D  rquest-uri ; Equal to request-uri as specified
                        by HTTP/1.1
message-qop       =3D  "qop" EQUAL qop-value
cnonce            =3D  "cnonce" EQUAL cnonce-value
cnonce-value      =3D  nonce-value
nonce-count       =3D  "nc" EQUAL nc-value
nc-value          =3D  8LHEX
dresponse         =3D  "response" EQUAL request-digest
request-digest    =3D  LDQUOT 32LHEX RDQUOT
auth-param        =3D  auth-param-name EQUAL
                        ( token / quoted-string )
auth-param-name   =3D  token
other-response    =3D  auth-scheme LWS auth-param
                        *(COMMA auth-param)
auth-scheme       =3D  token
LHEX              =3D  DIGIT / %x61-66 ;lowercase a-f
WWW-Authenticate  =3D  "WWW-Authenticate" HCOLON challenge
challenge           =3D  ("Digest" LWS digest-cln *(COMMA =
other-challenge     =3D  auth-scheme LWS auth-param
                          *(COMMA auth-param)
digest-cln          =3D  realm / domain / nonce
                           / opaque / stale / algorithm
                           / qop-options / auth-param
realm               =3D  "realm" EQUAL realm-value
realm-value         =3D  quoted-string
domain              =3D  "domain" EQUAL LDQUOT URI
                          *( 1*SP URI ) RDQUOT
URI                 =3D  MSRP-URI / anyURI
nonce               =3D  "nonce" EQUAL nonce-value
nonce-value         =3D  quoted-string
opaque              =3D  "opaque" EQUAL quoted-string
stale               =3D  "stale" EQUAL ( "true" / "false" )



algorithm           =3D  "algorithm" EQUAL ( "MD5" / "MD5-sess"
                          / token )
qop-options         =3D  "qop" EQUAL LDQUOT qop-value
                          *("," qop-value) RDQUOT
qop-value           =3D  "auth" / token


c=3DIN IP4 invalid.none
m=3Dmessage 1234 msrp/tcp alice@alice.example.com
a=3Daccept: message/cpim text/plain text/html
a=3Dhop:msrp:magic456@a.example.com:1234;transport=3Dtcp


c=3DIN IP4 invalid.none
m=3Dmessage 1234 msrp/tcp bob@bob.example.com
a=3Daccept: message/cpim text/plain
a=3Dhop:msrp:magic789@b1.example.com:1234;transport=3Dtcp
a=3Dhop:msrp:magic012@b2.example.com:1234;transport=3Dtcp


