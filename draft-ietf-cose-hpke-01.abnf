COSE_Encrypt_Tagged = #6.96(COSE_Encrypt)

HPKE_Encryption_Info = COSE_Encrypt_Tagged

COSE_Encrypt = [
   Headers,
   ciphertext : bstr / nil,
   recipients : + COSE_recipient
COSE_recipient = [
   protected   : bstr .cbor header_map, ; must contain alg parameter
   unprotected : header_map, ; must contain kid and ephemeral public key
   encCEK      : bstr, ; CEK encrypted with HPKE-derived shared secret
header_map = {
   Generic_Headers,
   * label =values,
PartyInfo = (
          identity : bstr / nil,
          nonce : bstr / int / nil,
          other : bstr / nil
COSE_KDF_Context = [
          AlgorithmID : int / tstr,
          PartyUInfo : [ PartyInfo ],
          PartyVInfo : [ PartyInfo ],
          SuppPubInfo : [
              keyDataLength : uint,
              protected : empty_or_serialized_map,
              ? other : bstr
          ],
          ? SuppPrivInfo : bstr
