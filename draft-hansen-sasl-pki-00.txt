





Internet Draft                                                 T. Hansen
draft-hansen-sasl-pki-00.txt                           AT&T Laboratories
Valid for six months                                   February 23, 2003



		        The PKI SASL Mechanism 

                     <draft-hansen-sasl-pki-00.txt>

                         Authors' version: 1.2

     Status of this Memo

     This document is an Internet-Draft and is in full conformance with
all provisions of Section 10 of RFC2026.

     Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.  Note that other
groups may also distribute working documents as Internet-Drafts.

     Internet-Drafts are draft documents valid for a maximum of six
months and may be updated, replaced, or obsoleted by other documents at
any time.  It is inappropriate to use Internet-Drafts as reference
material or to cite them other than as "work in progress."

     The list of current Internet-Drafts can be accessed at
http://www.ietf.org/ietf/1id-abstracts.txt.

     The list of Internet-Draft Shadow Directories can be accessed at
http://www.ietf.org/shadow.html.

     This memo and its companions will hopefully be discussed on the
SASL working group mailing list, ietf-sasl@imc.org.  To subscribe, send
a message with the word "subscribe" in the body (on a line by itself)
to the address ietf-sasl-request@imc.org.  An archive of the mailing list
may be found at http://www.ietf.org/archive/sasl.

Copyright Notice

     Copyright (C) The Internet Society (2003).  All Rights Reserved.

Abstract

     This document defines a user/password Simple Authentication and
Security Layer(SASL) mechanism called the PKI mechanism.  The PKI
mechanism is intended to be used in situations where (1) passwords must
be encrypted, (2) the password must be recoverable, and (3) using TLS in



Hansen                                                          [Page 1]

Internet Draft                                         February 23, 2003


combination with a SASL mechanism such as PLAIN is inappropriate.

     NOTE: This document is a straw proposal to see what interest there
is in having a SASL mechanism such as this.  See the first section below
for more information on why this mechanism is needed.


     The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
"SHOULD", "SHOULD NOT", "RECOMMENDED",  "MAY", and "OPTIONAL" in this
document are to be interpreted as described in RFC 2119 [RFC-KEYWORDS].


1.  Background and Intended Usage

     Clear-text passwords are simple, interoperate with almost all
existing operating system authentication databases, and are useful for a
smooth transition to a more secure password-based authentication mechan-
ism.  The drawback is that they are unacceptable for use over an unen-
crypted network connection.  Examples of clear-text password SASL
mechanisms are PLAIN and LOGIN.

     All of the existing SASL mechanisms (other than PLAIN and LOGIN)
perform their password validation by trading information derived from
the username and password, combined in various ways with other informa-
tion.  Examples of such mechanisms are DIGEST, OTP and GSSAPI.

     There exists a class of servers that do their authentication by
making use of a third party server, such as a RADIUS server.  In order
to do this, these servers must have the actual password in hand in order
to pass on the appropriate information to the third party server.  To do
this, these servers currently must either (1) use a clear-text password,
or (2) start a TLS session before authenticating using a clear-text
password mechanism.  Obviously, the first choice is not acceptable.
Unfortunately, the second choice presents a considerable amount of con-
tinuing overhead for the remainder of the session.

     The TLS session could be switched over to a null cipher, after SASL 
authentication has been performed. However, the TLS session still would 
have overheads associated with it that may not be acceptable to the outer
protocol.

     This document defines the PKI Simple Authentication and Security
Layer ([SASL]) mechanism for use in protocols where (1) passwords must
be encrypted, (2) the password must be recoverable, and (3) using TLS in
combination with a SASL mechanism such as PLAIN is inappropriate.

     The name associated with this mechanism is "PKI".

     The PKI SASL mechanism does not provide a security layer.  This
mechanism SHOULD NOT be used without adequate security protection as the



Hansen                                                          [Page 2]

Internet Draft                                         February 23, 2003


mechanism affords no integrity nor confidentiality protection itself.

2.  PKI SASL mechanism

     NOTE: NOTE: NOTE: The following is strictly a straw proposal to get
the ball rolling.  It has not been vetted by any sort of security
review.  Nor is the following description yet a formal description.  It
is probable that my description of TLS has flaws, and there is clearly
room for improvement all around.

     It is clear that invoking TLS, and then passing the password over
the subsequent encrypted channel is considered safe by today's stan-
dards.  The intent is that the PKI SASL mechanism would be equally
secure to this.

     With TLS, the first step in the protocol is to exchange Public Key
credentials.  Session keys are then established, using a Diffie-Helman
exchange encrypted using the public key.  The remainder of the session
is then encrypted, using a symmetric encryption algorithm and the ses-
sion key as the encryption key.

     With the PKI SASL mechanism, the first step in the protocol is to
transmit the server Public Key credentials.  Session keys are then esta-
blished, using a Diffie-Helman exchange encrypted using the public key.
The last step is to transmit to the server an authorization identity
(the identity to log in as), authentication identity (the identity whose
password will be used), and a password.  These are separated by NUL
characters and encrypted using a symmetric encryption algorithm and the
session key as the encryption key.

     NOTE: It is intended that the authorization identity, authenticia-
tion identity and password are to be processed in a way comparable to
what is used in draft-ietf-sasl-plain-*.txt.

     FORMAL DESCRIPTION WOULD FOLLOW

3.  Example

     An example of this mechanism would go here.

4.  Security Considerations
The PKI SASL mechanism is intended to be comparable in security to the
use of the PLAIN SASL mechanism within a TLS encryption layer.

     As with the PLAIN mechanism, the server gains the ability to imper-
sonate the user to all services with the same password regardless of any
encryption provided by TLS or other network privacy mechanisms.  While
many other authentication mechanisms have similar weaknesses, stronger



Hansen                                                          [Page 3]

Internet Draft                                         February 23, 2003


SASL mechanisms such as the Kerberos-based GSSAPI mechanism address this
issue.  Clients are encouraged to have an operational mode where all
mechanisms which are likely to reveal the user's password to the server
are disabled.  It is RECOMMENDED that this mode be the default.

     General SASL security considerations apply to this mechanism.
"stringprep" and Unicode security considerations also apply.

5.  IANA Considerations
It is requested that the SASL Mechanism registry [IANA-SASL] entry for
the PKI mechanism be created, reflecting that this document provides its
technical specification.

     To: iana@iana.org
     Subject: Updated Registration of SASL mechanism PLAIN

     SASL mechanism name: PKI
     Security considerations: See RFC XXXX.
     Published specification (optional, recommended): RFC XXXX
     Person & email address to contact for further information: Tony Hansen <tony@att.com>
     Intended usage: COMMON
     Author/Change controller: IESG <iesg@ietf.org>

6.  Acknowledgements

     TBD


7.  Normative References

     [ABNF] D. Crocker, P. Overell, "Augmented BNF for Syntax Specifica-
tions: ABNF", RFC 2234, November 1997.

     [Keywords] S. Bradner, "Key words for use in RFCs to Indicate
Requirement Levels", BCP 14 (also RFC 2119), March 1997.

     [SASL] J. Myers, "Simple Authentication and Security Layer (SASL)",
RFC 2222bis (a work in progress).

     [SASLPrep] TBD, "SASL String Preparation Profiles", (a work to
come).

     [Stringprep] P. Hoffman, M. Blanchet, "Preparation of Internation-
alized Strings ("stringprep")", RFC 3454, December 2002.

     [Unicode] The Unicode Consortium, "The Unicode Standard, Version
3.2.0", defined by: The Unicode Standard, Version 3.0 (Reading, MA,
Addison-Wesley, 2000.  ISBN 0-201-61633-5), as amended by the Unicode



Hansen                                                          [Page 4]

Internet Draft                                         February 23, 2003


Standard Annex #28: Unicode 3.2
(http://www.unicode.org/reports/tr28/tr28-3.html).

     [UTF-8] F. Yergeau, "UTF-8, a transformation format of ISO 10646",
RFC 2279, January 1998.

     [TLS] T. Dierks, C. Allen, "The TLS Protocol Version 1.0", RFC
2246, January 1999.

8.  Informative References

     [CRAM-MD5] J. Klensin, R. Catoe, and P. Krumviede, "IMAP/POP
AUTHorize Extension for Simple Challenge/Response", RFC 2195, September
1997.

     [DIGEST-MD5] P. Leach, C. Newman, "Using Digest Authentication as a
SASL Mechanism", RFC 2831, May 2000.

     [IANA-SASL] IANA, "SIMPLE AUTHENTICATION AND SECURITY LAYER (SASL)
MECHANISMS", http://www.iana.org/assignments/sasl-mechanisms.

9.  Author's Address'

     Tony Hansen
     AT&T Laboratories
     Middletown, NJ 07748
     USA

     Phone: +1.732.420.8934
     Email: tony@att.com

10.  Full Copyright Statement

     Copyright 2003, The Internet Society.  All Rights Reserved.

     This document and translations of it may be copied and furnished to
others, and derivative works that comment on or otherwise explain it or
assist in its implementation may be prepared, copied, published and dis-
tributed, in whole or in part, without restriction of any kind, provided
that the above copyright notice and this paragraph are included on all
such copies and derivative works.  However, this document itself may not
be modified in any way, such as by removing the copyright notice or
references to the Internet Society or other Internet organizations,
except as needed for the  purpose of developing Internet standards in
which case the procedures for copyrights defined in the Internet Stan-
dards process must be followed, or as required to translate it into
languages other than English.




Hansen                                                          [Page 5]

Internet Draft                                         February 23, 2003


     The limited permissions granted above are perpetual and will not be
revoked by the Internet Society or its successors or assigns.

     This document and the information contained herein is provided on
an "AS IS" basis and THE AUTHORS, THE INTERNET SOCIETY, AND THE INTERNET
ENGINEERING TASK FORCE DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED,
INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE INFORMA-
TION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED WARRANTIES OF
MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

     This document expires August 23, 2003.








































Hansen                                                          [Page 6]
