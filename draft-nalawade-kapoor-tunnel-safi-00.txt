





Network Working Group                             Gargi Nalawade
Internet Draft                                      Ruchi Kapoor
Expires: December 2003                                Dan Tappan

                                                   Cisco Systems



                            IPv4-Tunnel SAFI

             draft-nalawade-kapoor-tunnel-safi-00.txt



1. Status of this Memo

   This document is an Internet-Draft and is in full conformance with
   all provisions of Section 10 of RFC2026.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups.  Note that
   other groups may also distribute working documents as Internet-
   Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html.

2. Copyright Notice

   Copyright (C) The Internet Society (2001).  All Rights Reserved.

3. Abstract

   There is a need for Tunnel end-point discovery within and across
   Autonomous Systems. BGP is the only protocol that is widely-spoken
   across Autonomous Systems and can carry this information. This
   document defines how BGP speakers can convey Tunnel end-point
   reachability information.

4. Introduction



draft-nalawade-kapoor-tunnel-safi-00.txt                                [Page 1]

Internet Draft draft-nalawade-kapoor-tunnel-safi-00.txt                June 2003


   Two end-points of a Tunnel need to know the end-point information and
   its binding to a network address at the remote point. Normally, this
   can be statically shared and configured. But in case of a large
   network where there may be a need for a large number of tunnels, the
   number of tunnel end-points that need to be exchanged and maintained,
   grows. It then needs to be exchanged and maintained using an inter-AS
   protocol.

5. The IPv4-Tunnel SAFI

   This document defines a new SAFI called the IPv4-Tunnel SAFI.  The
   <AFI, SAFI> [IANA-AFI] [IANA-SAFI] value pair used to identify this
   SAFI is (AFI=1, SAFI=TBD).

   The tunnel end point address will be carried as an NLRI in the
   MP_REACH attribute for this SAFI. The NLRI Format will be a 2-byte
   Reserved field followed by a 4-byte IPv4 address.

6. BGP Attribute

   The BGP SSA Attribute [BGP-SSA] will be used to carry the Tunnel
   end-point information.

   The Value Field of the BGP SSA Attribute, MUST contain at least one
   of the following valid Type codes for this SAFI. It MAY contain one
   or more TLVs with these Type codes.

   Type 1: L2TPv3 Tunnel information

   Type 2: mGRE Tunnel information

   Type 3: IPSec Tunnel information

   Type 4: MPLS Tunnel information


6.1. L2TPv3 Tunnel information TLV

   The L2TPv3 Tunnel Information TLV has a type of 1.  The value part of
   the L2TPv3 Tunnel Information Type contains the following :

               - Preference (2 Octets)
               - Flags (1 Octet)
               - Cookie Length (1 Octet)
               - Session ID (4 Octets)
               - Cookie     (Variable)

   The L2TPv3 Tunnel Information TLV looks as follows :



draft-nalawade-kapoor-tunnel-safi-00.txt                                [Page 2]

Internet Draft draft-nalawade-kapoor-tunnel-safi-00.txt                June 2003


         0                   1
         0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        |      Type = 0x01              |
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        |      Length  (2 octets)       |
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        |      Preference (2 octets)    |
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        |S|    Flags    | Cookie Length |
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        |      Session ID (4 Octets)    |
        |                               |
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        |                               |
        |      Cookie (Variable)        |
        |                               |
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+




   where

   Length A 2 Octet field that specifies the length of the L2TPv3
   attribute in octets. The value contained in this Length field MUST
   not exceed the total length of the BGP SSA [SSA] Attribute minus the
   total length of any prior TLVs.

   Preference A 2 Octet field containing a Preference associated with
   the TLV. The Preference value indicates a preferred ordering of
   tunneling encapsulations according to the sender. The recipient of
   the information SHOULD take the sender's preference into account in
   selecting which encapsulation it will use. A higher value indicates a
   higher preference.

   Flags A 1 Octet field containing flag-bits. The leftmost bit
   indicates whether Sequence numbering is to be used or not. The
   remaining bits are reserved for future use.

   Cookie Length Cookie Length is a 1 Octet field that contains the
   length of the Variable length Cookie.

   Session ID A 4 Octet field containing a non-zero identifier for a
   session.

   Cookie Cookie is a variable length (maximum 64 bits), value used by
   L2TPv3 to check the association of a received data message with the



draft-nalawade-kapoor-tunnel-safi-00.txt                                [Page 3]

Internet Draft draft-nalawade-kapoor-tunnel-safi-00.txt                June 2003


   session identified by the Session ID.

   The default value of the Length Field for the L2TPv3 Tunnel
   information TLV is between 8 and 16 bytes, depending on the length of
   the Cookie field specified in Cookie length. If the length of the TLV
   is greater than that value, the subsequent portion of the Value field
   contains one or more sub-TLVs.

   A Sub-TLV when present is of the following format :


         0                   1
         0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        |  Sub-Type     | Length        |
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        |      Value (Variable)         |
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+



   where  Sub-Type & Length are of 1-Octet each & the Value field is
   variable as specified by the Length.

6.2. mGRE Tunnel Information TLV

   The mGRE Tunnel Information Type has a Type 2.  The value part of the
   mGRE Tunnel Information Type contains the following :

               - Preference (2 Octets)
               - Flags (1 Octet)
               - mGRE Key   (0 or 4 Octets)

   The mGRE Tunnel Information TLV looks as follows :



         0                   1
         0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        |      Type = 0x02              |
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        |      Length  (2 octets)       |
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        |      Preference (2 octets)    |
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        |S|K|  Flags    |               |
        +-+-+-+-+-+-+-+-+               |



draft-nalawade-kapoor-tunnel-safi-00.txt                                [Page 4]

Internet Draft draft-nalawade-kapoor-tunnel-safi-00.txt                June 2003


        |      mGRE Key (4 Octets)      |
        |                               |
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+



   Length A 2 Octet field that specifies the length of the mGRE
   information in octets. The value contained in this Length field MUST
   not exceed the total length of the BGP SSA [SSA] Attribute minus the
   total length of any prior TLVs.

   Preference A 2 Octet field containing a Preference associated with
   the TLV. The Preference value indicates a preferred ordering of
   tunneling encapsulations according to the sender. The recipient of
   the information SHOULD take the sender's preference into account in
   selecting which encapsulation it will use. A higher value indicates a
   higher preference.


   Flags A 1 Octet field containing flag-bits. The leftmost bit
   indicates whether Sequence numbering is to be used or not. The 2nd
   bit indicates whether an mGRE Key is present or not. The remaining
   bits are reserved for future use.

   mGRE Key A 4 Octet field containing an optional mGRE Key.

   If the Length field of the TLV contains a value greater than 3 Octets
   plus the value specified in the Key Length, the subsequent portion of
   the Value field contains one or more sub-TLVs.

   A Sub-TLV when present is of the following format :



         0                   1
         0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        |  Sub-Type     | Length        |
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        |      Value (Variable)         |
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+



   where  Sub-Type & Length are of 1-Octet each & the Value field is
   variable as specified by the Length.

6.3. IPSec Tunnel Information TLV



draft-nalawade-kapoor-tunnel-safi-00.txt                                [Page 5]

Internet Draft draft-nalawade-kapoor-tunnel-safi-00.txt                June 2003


   The IPSec Tunnel Information Type has a Type 3.  The format of the
   IPSec Tunnel Information TLV is TBD.

6.4. MPLS TLV

   The MPLS TLV has a Type 4.  The format of the MPLS TLV is TBD.

7. Capability Advertisement

   A BGP speaker that wishes to exchange the IPv4-Tunnel SAFI, MUST use
   the MP_EXT Capability Code as defined in [BGP-MP], to advertise the
   corresponding (AFI, SAFI) pair.

   A BGP speaker MAY participate in the distribution of IPv4-Tunnel
   information.

8. Operation

   A BGP Speaker that receives the Capability for the IPv4-Tunnel SAFI,
   MAY advertise the IPv4-Tunnel prefixes to that peer.

   In the UPDATE message for this SAFI sent to a peer, a BGP speaker
   MUST only advertise the SAFI-specific attribute [SSA] TLVs that are
   defined as valid for this SAFI.

   If a BGP Speaker receives an SSA TLV that it does not recognize, it
   will accept it and propagate it to other peers.

9. Deployment Considerations

   In order for the Tunnels to come up between two end-points, the BGP
   Speakers advertising the Tunnel end-points using the Ipv4 Tunnel
   SAFI, MUST exchange at least one common encapsulation option.

10. Security Considerations

   This extension to BGP does not change the underlying security issues.

11. Acknowledgements

   We would like to thank Jim Guichard, Arjun Sreekantiah, Shyam Suri,
   Chandrashekhar Appanna, John Scudder and Mark Townsley for their
   comments and suggestions.

12. References

   [IANA-AFI] http://www.iana.org/assignments/address-family-numbers




draft-nalawade-kapoor-tunnel-safi-00.txt                                [Page 6]

Internet Draft draft-nalawade-kapoor-tunnel-safi-00.txt                June 2003


   [IANA-SAFI] http://www.iana.org/assignments/safi-namespace

   [BGP-4]  Rekhter, Y. and T. Li (editors), "A Border Gateway Protocol
   4 (BGP-4)", Internet Draft draft-ietf-idr-bgp4-17.txt, January 2002.

   [BGP-CAP] Chandra, R., Scudder, J., "Capabilities Advertisement with
   BGP-4", draft-ietf-idr-rfc2842bis-02.txt, April 2002.

   [BGP-SSA] Kapoor R., Nalawade G., "BGPv4 SAFI-Specific Attribute",
   draft-nalawade-kapoor-bgp-ssa-00.txt, work in progress.

   [MULTI-BGP] Bates et al, Multiprotocol Extensions for BGP-4, draft-
   ietf-idr-rfc2858bis-02.txt, work in progress.

   [IPSEC-ARCH] Kent, S., and R. Atkinson, "Security Architecture for
   the Internet Protocol", RFC 2401, November 1998.

13. Author's Addresses

   Gargi Nalawade
   Cisco Systems, Inc
   170 West Tasman Drive
   San Jose, CA 95134
   mailto:gargi@cisco.com

   Ruchi Kapoor
   Cisco Systems, Inc
   170 West Tasman Drive
   San Jose, CA 95134
   mailto:ruchi@cisco.com

   Dan Tappan
   Cisco Systems, Inc
   170 West Tasman Drive
   San Jose, CA 95134
   mailto:tappan@cisco.com


14. Intellectual Property Statement

   The IETF takes no position regarding the validity or scope of any
   intellectual property or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; neither does it represent that it
   has made any effort to identify any such rights.  Information on the
   IETF's procedures with respect to rights in standards-track and
   standards- related documentation can be found in BCP-11.  Copies of



draft-nalawade-kapoor-tunnel-safi-00.txt                                [Page 7]

Internet Draft draft-nalawade-kapoor-tunnel-safi-00.txt                June 2003


   claims of rights made available for publication and any assurances of
   licenses to be made available, or the result of an attempt made to
   obtain a general license or permission for the use of such
   proprietary rights by implementers or users of this specification can
   be obtained from the IETF Secretariat.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights which may cover technology that may be required to practice
   this standard.  Please address the information to the IETF Executive
   Director.

15. Full Copyright Statement

   Copyright (C) The Internet Society (2001).  All Rights Reserved.

   This document and translations of it may be copied and furnished to
   others, and derivative works that comment on or otherwise explain it
   or assist in its implementation may be prepared, copied, published
   and distributed, in whole or in part, without restriction of any
   kind, provided that the above copyright notice and this paragraph are
   included on all such copies and derivative works.  However, this
   document itself may not be modified in any way, such as by removing
   the copyright notice or references to the Internet Society or other
   Internet organizations, except as needed for the purpose of
   developing Internet standards in which case the procedures for
   copyrights defined in the Internet Standards process must be
   followed, or as required to translate it into languages other than
   English.  The limited permissions granted above are perpetual and
   will not be revoked by the Internet Society or its successors or
   assigns.  This document and the information contained herein is
   provided on an "AS IS" basis and THE INTERNET SOCIETY AND THE
   INTERNET ENGINEERING TASK FORCE DISCLAIMS ALL WARRANTIES, EXPRESS OR
   IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF
   THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE."

16. Expiration Date

   This memo is filed as <draft-nalawade-kapoor-tunnel-safi-00.txt>, and
   expires December, 2003.










draft-nalawade-kapoor-tunnel-safi-00.txt                                [Page 8]

