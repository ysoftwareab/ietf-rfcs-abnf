SEARCH  = "BEGIN:VQUERY" CRLF
          [scope] [maxresults] [maxsize] querycomp
          "END:VQUERY" CRLF

scope           = "SCOPE:" comp-name ("," comp-name)*

comp-name       = "VEVENT" / "VTODO" / "VJOURNAL" / "VTIMEZONE"
                / "VALARM" / "VFREEBUSY" / iana-name / x-name

maxresults      = integer

maxsize         = integer

querycomp       = (query) / (queryname query) / queryname

queryname       = "QUERYNAME:" text

query           = "QUERY:" queryrule

queryrule       = select where orderby ...

select          = <any valid SQL string that goes into a SELECT clause>

where           = <any valid SQL string that goes into a WHERE clause>

orderby         = <any valid SQL string that goes into a ORDERBY
                  clause>


rights  = [princ] (policy / carref / cardef) CRLF

princ = "UPN" "=" (text / all / "OWNER" / "NONOWNER")

policy  = ";" "POLICY" "=" policyname

policyname      = "READBUSYTIMEINFO" / "ACTONBEHALFOF" /
carref  = ";" "CARREF" "=" text *("," text)

cardef  = action object

action  = ";" "ACTION" "=" act-type *("," act-type)

act-type        = ("CREATE" / "MODIFY" / "DELETE" / "READ" / all)

object  = ";" "OBJECT" "=" (csprop *("," csprop) [propvalue])
                / (calprop *("," calprop) [propvalue])
                / (component *("," component)) [compvalue]
                / (compprop *("," compprop) [propvalue])
                / (compparam *("," compparam) [paramvalue])

csprop          = csprop2 / all / iana-name

csprop2         = <any calendar store property defined in [CAP]>

propvalue       = propvalue2 / all / iana-name


propvalue2      = <any value appropriate for the named property>

calprop         = calprop2 / all / iana-name

calprop2        = <any calendar property name defined in [RFC2445] or
                     [CAP]>

component       = component2 / all / iana-name

component2      = <any calendar component defined in [RFC2445] or
                  [CAP]>

compprop        = compprop2 / all / iana-name

compprop2       = <any component property name defined in [RFC2445] or
                     [CAP]>

compparam       = compparm2 / all / iana-name

compparm2       = <any component parameter name defined in [RFC2445] or
                     [CAP]>

compvalue       = ";" "VALUE" "=" ((component2 *("," component2))
                / all / iana-name)

paramvalue      = paramvalue2 / all / iana-name

paramvalue2     = <any value appropriate for the named parameter>

all             = "ALL"

iana-name       = <A name registered with IANA>


UPN="foo@host.com";ACTION=READ;OBJECT=DTSTART,DTEND


aclc    = "BEGIN" ":" "VCAR" CRLF
                  carprop
          "END" ":" "VCAR" CRLF

carprop = carid 1*(grant / deny)


OBJECT=VCAR,CARID,GRANT,DENY
grant   = "GRANT" rightsparam ":" rights CRLF
rightparam      = *(";" xparam)

DENY    = "DENY" rightsparam ":" rights CRLF
rightsparam      = *(";" xparam)

CARID   = "CARID" textparam ":" text CRLF

rstatus    = "REQUEST-STATUS" rstatparam ":"
             statcode [";" statdesc [";" extdata]]

rstatparam = *(
                ; the following is optional,
                ; but MUST NOT occur more than once
                (";" languageparm) /

                ; the following is optional,
                ; and MAY occur more than once

                (";" xparam)

                )

statcode   = 1*DIGIT *("." 1*DIGIT)
statdesc   = text
extdata    = text
