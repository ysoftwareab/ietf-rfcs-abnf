





INTERNET DRAFT                                            Jae-Hoon Jeong
Expires: July 2002                                         Jung-Soo Park
                                                           Seung-Yun Lee
                                                            Yong-Jin Kim
                                                                    ETRI
                                                           February 2002


          One-way Delay Measurement using IPv6 Source Routing
          <draft-jeong-1way-delay-ipv6-source-routing-00.txt>


Status of this Memo

     This document is an Internet-Draft and is in full conformance with
     all provisions of Section 10 of RFC2026.

     Internet-Drafts are working documents of the Internet Engineering
     Task Force (IETF), its areas, and its working groups.  Note that
     other groups may also distribute working documents as Internet-
     Drafts.

     Internet-Drafts are draft documents valid for a maximum of six
     months and may be updated, replaced, or obsoleted by other
     documents at any time.  It is inappropriate to use Internet-Drafts
     as reference material or to cite them other than as "work in
     progress."

     The list of current Internet-Drafts can be accessed at
     http://www.ietf.org/ietf/1id-abstracts.txt

     The list of Internet-Draft shadow directories can be accessed at
     http://www.ietf.org/shadow.html



Abstract

     This document specifies a methodology for measurement of the IETF
     IPPM WG's one-way IP performance metrics such as one-way delay and
     jitter of subpaths consisting of a specific end-to-end path in IPv6
     network as well as end-to-end one-way IP performance metrics.  The
     methodology measures one-way IP performance metrics in use of IPv6
     source routing through IPv6 extension headers. Because the
     methodology can contribute to the finding of congested link or
     underutilized link, it can provide important information to
     configure and manage IPv6 network.









Jeong, Park, Lee, Kim      Expires July 2002                    [Page 1]


INTERNET-DRAFT 1way Measurement using IPv6 Source Routing  February 2002


Table of Contents

     Status of this Memo
     Abstract
     1. Introduction
     2. Terminology
     3. Subpath One-way Delay Measurement
     3.1 Overview
     3.2 Layout of Measurement Packet
     3.3 Example
     4. Considerations related to OWDP
     5. IPv6 WG Considerations
     6. Security Considerations
     7. References
     Authors' Addresses


1. Introduction

     We need to measure network performance such as delay, loss and
     jitter in order to manage and configure network. Some tools such as
     Surveyor and RIPE have been made and being used for end-to-end
     one-way IP performance measurement [SURVEYOR][RIPE]. Because these
     can only measure end-to-end IP performance metrics, we can only
     know the occurrence of congestion in a specific end-to-end path of
     measured network [RFC2330][RFC2679][RFC2680][DELAY-VARIATION].
     Therefore, we have a difficulty in finding exactly the congested or
     underutilized position of the measured network with these end-to-
     end measurement tools. In the result, we need to measure one-way
     delay of subpaths consisting of the problematic end-to-end path.

     If we try to measure subpath one-way delay between two separate
     nodes on an end-to-end path of two measurement systems with these
     tools, intermediate routers should participate in measurement in
     use of a new protocol for measurement [IPMP]. Namely, the routers
     should record timestamp in the passing measurement packet and
     forward the packet to next router or destination.

     This document describes a methodology that can measure one-way
     delay and jitter of subpaths consisting of a specific end-to-end
     path in IPv6 network as well as end-to-end one-way IP performance
     metrics such as one-way delay, one-way loss and jitter. The
     methodology doesn't need a new measurement protocol and can measure
     subpath one-way delay using IPv6 source routing through IPv6
     extension headers.

2. Terminology

     The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
     "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in
     this document are to be interpreted as described in RFC 2119
     [RFC2119].  New terms are defined below:




Jeong, Park, Lee, Kim      Expires July 2002                    [Page 2]


INTERNET-DRAFT 1way Measurement using IPv6 Source Routing  February 2002


        Measurement System  A host that runs One-way Delay Measurement
                            Protocol [OWDP].

        Subpath One-way     The one-way delay on a subpath that composes
        Delay (SOD)         an end-to-end path of two measurement
                            systems.

        Subpath One-way     The measurement of SOD.
        Delay Measurement
        (SODM)

3. Subpath One-way Delay Measurement

3.1 Overview

     SODM uses Destination Options header and Routing header to measure
     subpath one-way metrics between two separate nodes on an end-to-end
     path of two measurement systems like Figure 1. When a measurement
     packet transits along an end-to-end path between two measurement
     systems, all the routers specified in Routing header of a
     measurement packet timestamp in Destination Options header of the
     packet.  With the timestamps, SOD can be calculated as follows:

      delay<Sender,R1>, delay<R1,R2>, delay<R2,R3>, delay<R3,Receiver>

      where delay<node i,node j> means SOD from node i to node j and
            node i can be separated from node j by one or more networks.
            R means intermediate router.


      [Sender]        [R1]          [R2]          [R3]      [Receiver]
          |            ||            ||            ||            |
          |___[Net1]___||___[Net2]___||___[Net3]___||___[Net4]___|

            --------->
         measurement packet

        Figure 1. Subpath One-way Delay Measurement (SODM)

3.2 Layout of Measurement Packet

     A measurement packet consists of IPv6 header, Destination Options
     header, Routing header, and OWDP-Test Packet as follows [IPv6]
     [OWDP]:

     +-------------+------------------+--------------+----------------+
     |IPv6 header  |Destination header|Routing header|OWDP-Test Packet|
     |             |                  |              |                |
     |Next Header =|Next Header =     |Next Header = |                |
     | Destination |     Routing      |     UDP      |                |
     +-------------+------------------+--------------+----------------+





Jeong, Park, Lee, Kim      Expires July 2002                    [Page 3]


INTERNET-DRAFT 1way Measurement using IPv6 Source Routing  February 2002


        Figure 2. Layout of Measurement Packet for SODM

     The format of Destination Options header is like Figure 3 [IPv6]:

      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |  Next Header  |  Hdr Ext Len  |  Option Type  |  Opt Data Len |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                           Reserved                            |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                                                               |
     +                                                               +
     ~                          Option Data                          ~
     +                                                               +
     |                                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

        Figure 3. Format of Destination Options header

     Next Header (NH)     8-bit selector. Identifies the type of header
                          immediately following the Destination Options
                          header. Uses the same values as the IPv4
                          Protocol field.

     Hdr Ext Len (HEL)    8-bit unsigned integer. Length of the
                          Destination Options header in 8-octet units,
                          not including the first 8 octets.

     Option Type (OT)     8-bit identifier of the type of option.
                          This field has the value of X that indicates
                          SODM.

     Opt Data Len (ODL)   8-bit unsigned integer. Length of the Option
                          Data field of this option, in octets.

     Reserved             Because the minimum size of extension header
                          is 8 bytes, the remaining 4 bytes must be
                          intialized to zero; ignored on reception.

     Option Data          Variable-length field. Option-Type-specific
                          data. This field contains timestamps.

     The format of Option Data of Destination Options header is like
     Figure 4 [OWDP]:

      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                                                               |
     +                          Timestamp[1]                         +
     |                                                               |




Jeong, Park, Lee, Kim      Expires July 2002                    [Page 4]


INTERNET-DRAFT 1way Measurement using IPv6 Source Routing  February 2002


     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                                                               |
     +                                                               +
     ~                               ~                               ~
     +                                                               +
     |                                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                                                               |
     +                          Timestamp[n]                         +
     |                                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

        Figure 4. Format of Option Data of Destination Options header

     Timestamp[1..n]      64-bit timestamps written by intermediate
                          routers, numbered 1 to n.

     Routing header is Type 0 and Address[1..n] of intermediate routers
     are written in Routing header [IPv6]. The format of UDP OWDP-Test
     Packet is that of UDP packet at OWDP-Test [OWDP].

3.3 Example

     A new option type, X which indicates SODM is defined.  SODM in
     Figure 1 is performed as follows:

     Step 1. Before a measurement packet leaves Sender.
            Sender timestamps in the payload of measurement packet in
            Ethernet frame level.

     Step 2. After a measurement packet leaves Sender and before the
            packet arrives at router R1.
            The values of fields of IPv6 header and extension headers
            are set as follows:

            IPv6 header:
              NH = 60 (Destination Options header)
              Source Address = Sender, Destination Address = R1

            Destination Options header:
              NH = 43 (Routing header), HEL = 0, OT = X, ODL = 4

            Routing header:
              NH = 17 (UDP Packet), HEL = 6, Routing Type = 0,
              Segments Left = 3
              Address[1] = R2
              Address[2] = R3
              Address[3] = Receiver

     Step 3. After a measurement packet leaves router R1 and before the
            packet arrives at router R2.





Jeong, Park, Lee, Kim      Expires July 2002                    [Page 5]


INTERNET-DRAFT 1way Measurement using IPv6 Source Routing  February 2002


            IPv6 header:
              NH = 60
              Source Address = Sender, Destination Address = R2

            Destination Options header:
              NH = 43, HEL = 1, OT = X, ODL = 12
              Timestamp[1] = T1

            Routing header:
              NH = 17, HEL = 6, Routing Type = 0, Segments Left = 2
              Address[1] = R1
              Address[2] = R3
              Address[3] = Receiver

     Step 4. After a measurement packet leaves router R2 and before the
            packet arrives at router R3.

            IPv6 header:
              NH = 60
              Source Address = Sender, Destination Address = R3

            Destination Options header:
              NH = 43, HEL = 2, OT = X, ODL = 20
              Timestamp[1] = T1
              Timestamp[2] = T2

            Routing header:
              NH = 17, HEL = 6, Routing Type = 0, Segments Left = 1
              Address[1] = R1
              Address[2] = R2
              Address[3] = Receiver

     Step 5. After a measurement packet leaves router R3 and before the
            packet arrives at Receiver.

            IPv6 header:
              NH = 60
              Source Address = Sender, Destination Address = Receiver

            Destination Options header:
              NH = 43, HEL = 3, OT = X, ODL = 28
              Timestamp[1] = T1
              Timestamp[2] = T2
              Timestamp[3] = T3

            Routing header:
              NH = 17, HEL = 6, Routing Type = 0, Segments Left = 0
              Address[1] = R1
              Address[2] = R2
              Address[3] = R3

     Step 6. When Receiver receives the measurement packet.




Jeong, Park, Lee, Kim      Expires July 2002                    [Page 6]


INTERNET-DRAFT 1way Measurement using IPv6 Source Routing  February 2002


            Receiver timestamps in the payload of measurement packet in
            Ethernet Frame Level and copies the pairs of address and
            timestamp value from extension headers into the payload of
            the packet before delivering the packet to the upper layer,
            IPv6 layer.

     In the result, subpath one-way delay metrics such as one-way delay
     and jitter as well as end-to-end one-way delay metrics between two
     measurement systems can be calculated.

4. Considerations related to OWDP

     SODM of this document can be used nearly without modifying OWDP.
     The new OWDP Type-P for SODM must be defined. Type-P for SODM is
     defined as Type-P-One-way-Delay-Subpath-IPv6.

5. IPv6 WG Considerations

     IPv6 working group must define a new option type which indicates
     SODM. The option type must be encoded so that router that doesn't
     support the mechanism of this document relay measurement packet to
     next router or destination without discarding it.

6. Security Considerations

     The mechanism of this document follows the security considerations
     of One-way Delay Measurement Protocol [OWDP]. Measurement systems
     and routers that participate in measurement need security service.

7. References

     [RFC2119] S. Bradner, "Key words for use in RFCs to Indicate
               Requirement Levels", RFC 2119, March 1997.

     [RFC2330] V. Paxon, G. Almes, J. Mahdavi, M. Mathis, "Framework
               for IP Performance Metrics" RFC 2330, May 1998.

     [RFC2679] G. Almes, S. Kalidindi, and M. Zekauskas, "A One-way
               Delay Metric for IPPM", RFC 2679, September 1999.

     [RFC2680] G. Almes, S. Kalidindi, and M. Zekauskas, "A One-way
               Packet Loss Metric for IPPM", RFC 2680, September 1999.

     [IPv6]    Deering, S. and R. Hinden, "Internet Protocol, Version 6
               (IPv6) Specification", RFC 2460, December 1998.

     [RIPE]    RIPE NCC Test-Traffic Measurements home,
               http://www.ripe.net/test-traffic/

     [SURVEYOR] Surveyor Home Page,
               http://www.advanced.org/surveyor/





Jeong, Park, Lee, Kim      Expires July 2002                    [Page 7]


INTERNET-DRAFT 1way Measurement using IPv6 Source Routing  February 2002


     [DELAY-VARIATION] C. Demichelis and P. Chimento, "IP Packet Delay
               Variation Metric for IPPM", I-D draft-ietf-ippm-ipdv-07,
               Feb. 2001.
        http://www.ietf.org/internet-drafts/draft-ietf-ippm-ipdv-08.txt

     [IPMP]    IP Measurement Protocol (IPMP),
               http://watt.nlanr.net/AMP//IPMP/ipmp-0.3.html

     [OWDP]    S. Shalunov, B. Teitelbaum and M. Zekauskas, "A One-way
               Delay Measurement Protocol", I-D draft-ietf-ippm-owdp-03,
               Feb. 2001.
        http://www.ietf.org/internet-drafts/draft-ietf-ippm-owdp-03.txt


Authors' Addresses

  Jae-Hoon Jeong
  ETRI / PEC
  161 Gajong-Dong, Yusong-Gu
  Daejon 305-350
  Korea

  Phone: +82 42 860 1664
  EMail: paul@etri.re.kr

  Jung-Soo Park
  ETRI / PEC
  161 Gajong-Dong, Yusong-Gu
  Daejon 305-350
  Korea

  Phone: +82 42 860 6514
  EMail: pjs@etri.re.kr

  Seung-Yun Lee
  ETRI / PEC
  161 Gajong-Dong, Yusong-Gu
  Daejon 305-350
  Korea

  Phone: +82 42 860 5508
  EMail: syl@etri.re.kr

  Yong-Jin Kim
  ETRI / PEC
  161 Gajong-Dong, Yusong-Gu
  Daejon 305-350
  Korea

  Phone: +82 42 860 6564
  EMail: kimyj@etri.re.kr





Jeong, Park, Lee, Kim      Expires July 2002                    [Page 8]


INTERNET-DRAFT 1way Measurement using IPv6 Source Routing  February 2002


  Expiration date: July 2002























































Jeong, Park, Lee, Kim      Expires July 2002                    [Page 9]
