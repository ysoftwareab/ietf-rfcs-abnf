



dhc Working Group                                                 Y. Cui
Internet-Draft                                                    Z. Liu
Intended status: Informational                                    C. Liu
Expires: April 29, 2015                              Tsinghua University
                                                        October 26, 2014


                       DHCP4o6 Active Leasequery
               draft-cui-dhc-dhcp4o6-active-leasequery-00

Abstract

   As networks migrate towards IPv6, some entities still have the
   requirement for IPv4 configuration.  DHCPv4 over DHCPv6 [RFC7341]
   provides a mechanism for obtaining IPv4 configuration information
   dynamically in IPv6 networks.  DHCPv4/DHCPv6 Active Leasequery allows
   a client to get real-time DHCP address binding information data via
   TCP.  This document describes an extension of DHCPv6 Active
   Leasequery to provide an mechanism to getting real-time DHCPv4 over
   DHCPv6 lease information.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at http://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on April 29, 2015.

Copyright Notice

   Copyright (c) 2014 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (http://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect



Cui, et al.              Expires April 29, 2015                 [Page 1]

Internet-Draft          DHCP4o6 Active Leasequery           October 2014


   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
   2.  Terminology . . . . . . . . . . . . . . . . . . . . . . . . .   3
   3.  Solution  . . . . . . . . . . . . . . . . . . . . . . . . . .   3
   4.  Use Case  . . . . . . . . . . . . . . . . . . . . . . . . . .   4
   5.  Security Considerations . . . . . . . . . . . . . . . . . . .   5
   6.  References  . . . . . . . . . . . . . . . . . . . . . . . . .   5
     6.1.  Normative References  . . . . . . . . . . . . . . . . . .   5
     6.2.  Informative References  . . . . . . . . . . . . . . . . .   6
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .   6

1.  Introduction

   The DHCPv6 Leasequery [RFC5007] extends the basic DHCPv6 capability
   [RFC3315] to allow an external entity to query a DHCPv6 server to
   recover individual lease state information about a particular IPv6
   address or client in near real-time.  The DHCPv6 Bulk Leasequery
   [RFC5460] extends DHCPv6 Leasequery [RFC5007] that allows an external
   entity to query a DHCPv6 server for bulk transfer of lease
   information via TCP.  The Active Leasequery allows an entity not
   directly participated in DHCPv6 client-server transactions and caches
   the current DHCPv6 lease state in real-time.And for DHCPv4, there are
   also similar protocols for DHCPv4 lease.  [RFC4388] [RFC6926]

   As networks migrate towards IPv6, hosts in some IPv6 network also
   need DHCPv4 configuration using DHCPv4 over DHCPv6[RFC7341].  The
   lease information in DHCPv4 over DHCPv6 (i.e.  DHCP4o6 lease
   information) contains DHCPv4 lease information (including IPv4
   address and other DHCPv4 options) in DHCPv4 messages, and stateless
   DHCPv6 options in DHCPV4-QUERY/DHCPV4-RESPONSE messages.  The
   capability of additional DHCPv6 options makes it different from
   original DHCPv4 [RFC2131].  One example usage is in Lightweight
   4over6 dynamic provisioning: A client (lwB4) chooses its IPv6 tunnel
   source address and puts it into a DHCPv6 option
   (OPTION_DHCP4O6_SADDR) [I-D.fsc-softwire-dhcp4o6-saddr-opt] to tell
   the provisioning system.  The tuple of client (lease IPv4 address,
   port set, IPv6 tunnel source address)is then used to create a binding
   entry in lwAFTR.

   In the case that a requestor wants to get both DHCPv4 lease
   information and DHCPv6 lease information of the same client, it can
   run DHCPv4 Active Leasequery and DHCPv6 Active Leasequery separately,



Cui, et al.              Expires April 29, 2015                 [Page 2]

Internet-Draft          DHCP4o6 Active Leasequery           October 2014


   using the same client identifier to associate them together.
   However, it doesn't work for a requestor getting DHCP4o6 lease
   information because there's no DUID or any other DHCPv6 identifiers
   in DHCPV4-QUERY/DHCPV4-RESPONSE messages, thus the DHCPv6 options can
   only be associated with the DHCPv4 lease.  A requestor asking for
   DHCP4o6 lease must get the DHCPv6 options along with the DHCPv4 lease
   information.

   However, the DHCPv4 Active Leasequery mechanism doesn't support
   providing DHCPv6 options, and the DHCPv6 Active Leasequery mechanism
   doesn't support providing DHCPv4 lease information.  This document
   describes an extension of DHCPv6 Active Leasequery, naming the
   DHCP4o6 Active Leasequery, to allow an entity get the mixed DHCPv4
   over DHCPv6 lease information in real-time in IPv6 network.

2.  Terminology

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [RFC2119].

3.  Solution

   The DHCP4o6 Active Leasequery mechanism is modeled on the existing
   DHCPv4 over DHCPv6 protocol in [RFC7341], which combine DHCPv4 Active
   Leasequery and DHCPv6 Active Leasequery to providing real-time DHCPv4
   lease and related DHCPv6 lease information in IPv6 network.  The
   DHCP4o6 Active Leasequery requestors and DHCP4o6 servers communicate
   with each other using DHCPv6 Active Leasequery which contains DHCPv4
   Message Option defined in [RFC7341].

   DHCPv4 Message Option defined in [RFC7341] contains the DHCPv4
   message sent by the DHCP client or server.  In DHCP4o6 Active
   Leasequery scenario, DHCPv4 Message Option contains the DHCPv4 Active
   Leasequery message sent by requestor and DHCP4o6 server.

   DHCP4o6 Leasequery requestor SHOULD obtain necessary IPv6
   configuration and have the DHCP4o6 server IPv6 address available via
   configuration or some other means, and that it has unicast IPv6
   reachability to the DHCP4o6 server.

   DHCP4o6 Leasequery requestor creates a TCP connection to DHCP4o6
   server as defined [I-D.ietf-dhc-dhcpv6-active-leasequery].  After
   establishing a connection, requestor sends a DHCPv6 ACTIVELEASEQUERY
   message with a DHCPv4 Message Option in it to query for DHCPv4 over
   DHCPv6 lease information.  The DHCPv4 Message Option encapsulates the
   DHCPv4 DHCPACTIVELEASEQUERY message to describe the query for a
   DHCPv4 lease.  And the related DHCPv6 options will be queried in



Cui, et al.              Expires April 29, 2015                 [Page 3]

Internet-Draft          DHCP4o6 Active Leasequery           October 2014


   DHCPv6 query-options.  The requestor MUST NOT put more than one
   DHCPv4 Message Option into a single DHCPv6 ACTIVELEASEQUERY message.

   When received the DHCPv6 ACTIVELEASEQUERY message, DHCP4o6 server
   SHOULD address the DHCPv4 DHCPACTIVELEASEQUERY message in the DHCPv4
   Message Option and the related DHCPv6 query in DHCPv6 query-options.
   DHCP4o6 server will reply with DHCPv6 LEASEQUERY-REPLY message/
   LEASEQUERY-DATA message.  When the server update DHCPv4 lease or
   related DHCPv6 information, it will generate a response to
   requestors.  In response, the server sends updates of DHCPv4 over
   DHCPv6 lease information in the DHCPv6 LEASEQUERY-DATA message.  The
   DHCPv4 lease sent to the requestor using DHCPv4 DHCPLEASEACTIVE or
   DHCPLEASEUNASSIGNED message which will be encapsulated in DHCPv4
   Message Option.  The related DHCPv6 options will be carried in the
   DHCPv6 OPTION_CLIENT_DATA option.

4.  Use Case

   As the method described above, it will provide the requestor with
   related DHCPv4 lease and DHCPv6 information of a DHCP client in real-
   time.  It MAY be used in many cases.  We will describe the using for
   Lightweight 4over6 [I-D.ietf-softwire-lw4over6]as an example.

   In Lightweight 4over6, lwAFTR need the binding IPv6 address for the
   mapping table.  lwAFTR can work as a DHCP4o6 Active Leasequery
   requestor to get real-time DHCPv4 lease and related DHCPv6
   information. lwAFTR need all lwB4's IPv4 address, PSID, IPv6 address
   to make the maaping table for the tunnel.  So, lwAFTR will send the
   DHCPv6 ACTIVELEASEQUERY message with DHCPv4 Message Option to query
   for DHCPv4 lease and related DHCPv6 lease information of a DHCP
   client.  DHCPv4 ACTIVELEASEQUERY message in the DHCPv4 Message Option
   SHOULD contains the primary query as Query for All Configured IP
   addresses.  And the Parameter Request List option in DHCPv4
   ACTIVELEASEQUERY message SHOULD contains the DHCPv4 Port Parameters
   option defined in [I-D.ietf-dhc-dynamic-shared-v4allocation].  And in
   the OPTION_LQ_QUERY option in DHCPv6 ACTIVELEASEQUERY message, the
   DHCPv6 OPTION_ORO option MUST contains the DHCPv4 over DHCPv6 Source
   address option defined in [I-D.fsc-softwire-dhcp4o6-saddr-opt].

   DHCP4o6 server configure the lwB4s with DHCPv4 lease, and get the
   binding IPv6 address during the process.  As defined in [RFC7341],
   DHCP4o6 client query for DHCP4o6 server's address during DHCPv6
   interaction.  After receiving DHCP4o6 server's address, DHCP4o6
   client will query for IPv4 address from DHCP4o6 server.  At the same
   time, DHCP4o6 client MAY negotiate the binding IPv6 address with
   DHCP4o6 server, and DHCP4o6 server can record the binding IPv6
   address as defined in [I-D.fsc-softwire-dhcp4o6-saddr-opt].  When
   DHCP4o6 server received DHCPv6 ACTIVELEASEQUERY message from lwAFTR,



Cui, et al.              Expires April 29, 2015                 [Page 4]

Internet-Draft          DHCP4o6 Active Leasequery           October 2014


   it SHOULD reply with the DHCPv6 LEASEQUERY-REPLY/LEASEQUERY-DATA
   message which contains the CPEs' IPv4 address, PSID, IPv6 address and
   other information in the following time if there is update of DHCPv4
   lease or DHCPv6 lease.

   In other cases, DHCP4o6 server MAY get more DHCPv6 information or
   even the whole DHCPv6 lease by some means, it can provide more
   information to the requestors.

5.  Security Considerations

   To be continue

6.  References

6.1.  Normative References

   [I-D.ietf-dhc-dhcpv6-active-leasequery]
              Dushyant, D., Kinnear, K., and D. Kukrety, "DHCPv6 Active
              Leasequery", draft-ietf-dhc-dhcpv6-active-leasequery-01
              (work in progress), March 2014.

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119, March 1997.

   [RFC2131]  Droms, R., "Dynamic Host Configuration Protocol", RFC
              2131, March 1997.

   [RFC2132]  Alexander, S. and R. Droms, "DHCP Options and BOOTP Vendor
              Extensions", RFC 2132, March 1997.

   [RFC3315]  Droms, R., Bound, J., Volz, B., Lemon, T., Perkins, C.,
              and M. Carney, "Dynamic Host Configuration Protocol for
              IPv6 (DHCPv6)", RFC 3315, July 2003.

   [RFC4388]  Woundy, R. and K. Kinnear, "Dynamic Host Configuration
              Protocol (DHCP) Leasequery", RFC 4388, February 2006.

   [RFC5007]  Brzozowski, J., Kinnear, K., Volz, B., and S. Zeng,
              "DHCPv6 Leasequery", RFC 5007, September 2007.

   [RFC5460]  Stapp, M., "DHCPv6 Bulk Leasequery", RFC 5460, February
              2009.

   [RFC6926]  Kinnear, K., Stapp, M., Desetti, R., Joshi, B., Russell,
              N., Kurapati, P., and B. Volz, "DHCPv4 Bulk Leasequery",
              RFC 6926, April 2013.




Cui, et al.              Expires April 29, 2015                 [Page 5]

Internet-Draft          DHCP4o6 Active Leasequery           October 2014


   [RFC7341]  Sun, Q., Cui, Y., Siodelski, M., Krishnan, S., and I.
              Farrer, "DHCPv4-over-DHCPv6 (DHCP 4o6) Transport", RFC
              7341, August 2014.

6.2.  Informative References

   [I-D.fsc-softwire-dhcp4o6-saddr-opt]
              Farrer, I., Sun, Q., and Y. Cui, "DHCPv4 over DHCPv6
              Source Address Option", draft-fsc-softwire-dhcp4o6-saddr-
              opt-01 (work in progress), September 2014.

   [I-D.ietf-dhc-dhcpv4-active-leasequery]
              Kinnear, K., Stapp, M., Volz, B., and N. Russell, "Active
              DHCPv4 Lease Query", draft-ietf-dhc-dhcpv4-active-
              leasequery-01 (work in progress), June 2014.

   [I-D.ietf-dhc-dynamic-shared-v4allocation]
              Cui, Y., Qiong, Q., Farrer, I., Lee, Y., Sun, Q., and M.
              Boucadair, "Dynamic Allocation of Shared IPv4 Addresses",
              draft-ietf-dhc-dynamic-shared-v4allocation-02 (work in
              progress), September 2014.

   [I-D.ietf-softwire-lw4over6]
              Cui, Y., Qiong, Q., Boucadair, M., Tsou, T., Lee, Y., and
              I. Farrer, "Lightweight 4over6: An Extension to the DS-
              Lite Architecture", draft-ietf-softwire-lw4over6-11 (work
              in progress), October 2014.

Authors' Addresses

   Yong Cui
   Tsinghua University
   Beijing  100084
   P.R.China

   Phone: +86-10-6260-3059
   Email: yong@csnet1.cs.tsinghua.edu.cn


   ZiLong Liu
   Tsinghua University
   Beijing  100084
   P.R.China

   Phone: +86-10-6278-5822
   Email: liuzilong8266@126.com





Cui, et al.              Expires April 29, 2015                 [Page 6]

Internet-Draft          DHCP4o6 Active Leasequery           October 2014


   Cong Liu
   Tsinghua University
   Beijing  100084
   P.R.China

   Phone: +86-10-6278-5822
   Email: gnocuil@gmail.com












































Cui, et al.              Expires April 29, 2015                 [Page 7]