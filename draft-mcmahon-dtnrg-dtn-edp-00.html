<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>The Delay Tolerant Networking Endpoint Discovery Protocol</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="The Delay Tolerant Networking Endpoint Discovery Protocol">
<meta name="keywords" content="RFC, Request for Comments, I-D, Internet-Draft, DTN, Delay-Tolerant Networking, Disruption-Tolerant Networking, Discovery, Endpoint">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">DTN Research Group</td><td class="header">A. McMahon</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Trinity College Dublin</td></tr>
<tr><td class="header">Intended status: Experimental</td><td class="header">K. Fall</td></tr>
<tr><td class="header">Expires: August 31, 2010</td><td class="header">Intel Labs, Berkeley</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">February 27, 2010</td></tr>
</table></td></tr></table>
<h1><br />The Delay Tolerant Networking Endpoint Discovery Protocol<br />draft-mcmahon-dtnrg-dtn-edp-00</h1>

<h3>Abstract</h3>

<p>The Endpoint Discovery Protocol (EDP) can be 
        used by Delay Tolerant Networking (DTN) nodes to report their 
        storage, routing and security capabilities, endpoint identifiers 
	(EIDs), registrations and whether they are willing to be 
	custodians to neighbouring DTN nodes.
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on August 31, 2010.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the BSD License.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#anchor2">2.</a>&nbsp;
Requirements Language<br />
<a href="#EDPreg">3.</a>&nbsp;
The EDP Registrations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">3.1.</a>&nbsp;
The Source EID of a Bundle with an EDP payload<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">3.2.</a>&nbsp;
The CLA EID<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">3.3.</a>&nbsp;
EDP Flags for the Primary Block<br />
<a href="#anchor6">4.</a>&nbsp;
The EDP Bundle<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">4.1.</a>&nbsp;
The EDP Report Bundle Format<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">4.2.</a>&nbsp;
Active Registrations.<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">4.3.</a>&nbsp;
The EDP Application Agent.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">4.3.1.</a>&nbsp;
Bundle Generation and Transmission.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">4.3.2.</a>&nbsp;
Bundle Reception.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">4.3.2.1.</a>&nbsp;
Random Response Request.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">4.3.2.2.</a>&nbsp;
Scheduled Response Request.<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">4.4.</a>&nbsp;
Example: Three DTN Nodes.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">4.4.1.</a>&nbsp;
CLA EIDs of 'A', 'B' and 'C'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor16">4.4.2.</a>&nbsp;
The ARs, CLA EIDs and Preferences of 'C'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor17">4.4.3.</a>&nbsp;
'C' Transmits Bundle containing an EDP ADU<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">4.4.4.</a>&nbsp;
'A' Uses Service of 'C'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor19">4.4.5.</a>&nbsp;
'B' Uses Service of 'C'<br />
<a href="#anchor20">5.</a>&nbsp;
Acknowledgements<br />
<a href="#anchor21">6.</a>&nbsp;
IANA Considerations<br />
<a href="#anchor22">7.</a>&nbsp;
Security Considerations<br />
<a href="#rfc.references1">8.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">8.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">8.2.</a>&nbsp;
Informative References<br />
<a href="#appendix_A">Appendix&nbsp;A.</a>&nbsp;
DTN Routing Protocols And Algorithms<br />
<a href="#appendix_B">Appendix&nbsp;B.</a>&nbsp;
CLA Parameters<br />
<a href="#appendix_C">Appendix&nbsp;C.</a>&nbsp;
APIs for EDP<br />
<a href="#appendix_D">Appendix&nbsp;D.</a>&nbsp;
The Data Dictionary<br />
<a href="#appendix_E">Appendix&nbsp;E.</a>&nbsp;
Discovery Mechanisms<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>This document describes Version 1 of the Endpoint
        Discovery Protocol (EDP), EDPv1, designed to be used with the
        Bundle Protocol (BP) <a class='info' href='#RFC5050'>[RFC5050]<span> (</span><span class='info'>Scott, K. and S. Burleigh, &ldquo;Bundle Protocol Specification,&rdquo; November&nbsp;2007.</span><span>)</span></a>
        within the context of the Delay-Tolerant Networking (DTN) architecture
        <a class='info' href='#RFC4838'>[RFC4838]<span> (</span><span class='info'>Cerf, V., Burleigh, S., Hooke, A., Torgerson, L., Durst, R., Scott, K., Fall, K., and H. Weiss, &ldquo;Delay-Tolerant Networking Architecture,&rdquo; April&nbsp;2007.</span><span>)</span></a>.
</p>
<p>EDP can be used by a DTN node to discover the presence of DTN nodes 
	wishing to receive EDP Application Data Units 
	(ADUs) on their EDP registrations, and to discover specifically which 
	Convergence Layer Adapters (CLAs) and registrations are of interest 
        to those proximate DTN nodes. A DTN node with an EDP registration is 
	an EDP node.
</p>
<p>EDP nodes report a description of their active
	EID registrations, Convergence Layer Adapters (CLAs) EIDs, storage,
	routing, security capabilities and whether they are willing to be
	custodian to proximate EDP nodes.
</p>
<p>A DTN node MUST have a unique EDP registration. 
        EDP is envisioned to utilize a (to be agreed upon) mechanism to
	limit its distribution scope to one DTN hop. Routing protocols
	(to be agreed upon) are expected to make use of information
	learned via EDP.
</p>
<p>EDP is a DTN application protocol. EDP ADUs are encapsulated in 
        bundles <a class='info' href='#RFC5050'>[RFC5050]<span> (</span><span class='info'>Scott, K. and S. Burleigh, &ldquo;Bundle Protocol Specification,&rdquo; November&nbsp;2007.</span><span>)</span></a> that may be secured according 
        to BSP <a class='info' href='#BPsec'>[BPsec]<span> (</span><span class='info'>Symington, S., Farrell, S., Weiss, H., and P. Lovell, &ldquo;Bundle Security Protocol Specification,&rdquo; February&nbsp;2010.</span><span>)</span></a>.
</p>
<p>This document specifies the protocol,
	block formats, and abstract service description for the exchange
	of EDP ADUs. This document does not address:
</p>
<p></p>
<ul class="text">
<li>Operations in the CLAs.
</li>
<li>Discovery of EIDs more than one DTN node hop away.
</li>
</ul>

<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Requirements Language</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
        "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
        document are to be interpreted as described in <a class='info' href='#RFC2119'>RFC 2119<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a> [RFC2119].
</p>
<a name="EDPreg"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
The EDP Registrations</h3>

<p>Within a DTN node, there is a registration which is the state machine
	characterizing a given node's membership in a given endpoint. Any number
	of registrations may be concurrently associated with a given endpoint,
	and any number of registrations may be concurrently associated with a
	given node. An EID is a name, expressed using the general syntax of URIs
	 <a class='info' href='#RFC3986'>[RFC3986]<span> (</span><span class='info'>Berners-Lee, T., Fielding, R., and L. Masinter, &ldquo;Uniform Resource Identifier (URI): Generic Syntax,&rdquo; January&nbsp;2005.</span><span>)</span></a>, that identifies a DTN endpoint. 
        EDP uses the "dtn:" scheme <a class='info' href='#dtnURI'>[dtnURI]<span> (</span><span class='info'>Fall, K., Burleigh, S., Doria, A., and J. Ott, &ldquo;The DTN URI Scheme,&rdquo; September&nbsp;2009.</span><span>)</span></a>.
	The EDP EID registration, used by an application for receiving EDP ADUs, has the 
        non-expiring registration "dtn::EDPv1".
</p>
<p>An EDP registration receives EDP ADUs, which are report bundles generated
	periodically or on demand and transmitted to the endpoint 'dtn::EDPv1'.
	Registrations are strings, that might indicate a physical entity or named
	data/service, used by upper-layer protocols or DTN applications to ask the
	CLAs to enable and disable reception of ADUs sent to specific EIDs.
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
The Source EID of a Bundle with an EDP payload</h3>

<p>Each DTN node is required to have at least one EID that uniquely
	identifies it (see section 3.3 of <a class='info' href='#RFC4838'>RFC&nbsp;4838<span> (</span><span class='info'>Cerf, V., Burleigh, S., Hooke, A., Torgerson, L., Durst, R., Scott, K., Fall, K., and H. Weiss, &ldquo;Delay-Tolerant Networking Architecture,&rdquo; April&nbsp;2007.</span><span>)</span></a> [RFC4838]). 
        The source EID of an EDP report bundle is any of those registrations.
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
The CLA EID</h3>

<p>The EID of a CLA is a CLA EID as defined by <a class='info' href='#dtnURI'>[dtnURI]<span> (</span><span class='info'>Fall, K., Burleigh, S., Doria, A., and J. Ott, &ldquo;The DTN URI Scheme,&rdquo; September&nbsp;2009.</span><span>)</span></a>. CLA EIDs are primarily used for 
         the identification of CLAs and are used by EDP as potential "next hops".
</p><br /><hr class="insert" />
<a name="fig2"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="center"><col align="center">
<tr><th align="center">Scheme</th><th align="center">Scheme Specific Part (SSP)</th></tr>
<tr>
<td align="center">dtn:</td>
<td align="center">next:eui-48:00:1c:bf:93:98:5d</td>
</tr>
<tr>
<td align="center">dtn:</td>
<td align="center">next:eui-48:00:1b:38:cc:df:ef</td>
</tr>
</table>
<br clear="all" />

<p style='text-align: center'>Example of a DTN node with two Ethernet CLA EIDs.
</p><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 1: CLA EID&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
EDP Flags for the Primary Block</h3>

<p>The value encoded in the Bundle Processing Control Flags of the primary
	block is a string of bits, expressed as a SDNV and is used to invoke selected
	bundle processing control features. By default, a bundle with a payload that 
	is an EDP ADU has the individual bits of this string of bits set to zero to 
	indicate false for the following flags:
</p>
<p></p>
<blockquote class="text"><dl>
<dt></dt>
<dd>Custody transfer requested
</dd>
<dt></dt>
<dd>Status report request
</dd>
<dt></dt>
<dd>Application data unit is an administrative record
</dd>
<dt></dt>
<dd>Bundle must not be fragmented
</dd>
<dt></dt>
<dd>Destination endpoint is a singleton
</dd>
<dt></dt>
<dd>Acknowledgement by application is requested
</dd>
</dl></blockquote>

<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
The EDP Bundle</h3>

<p>The EDP payload block uses the Canonical Bundle Block Format as
        defined in section 4.5.2. of <a class='info' href='#RFC5050'>RFC&nbsp;5050<span> (</span><span class='info'>Scott, K. and S. Burleigh, &ldquo;Bundle Protocol Specification,&rdquo; November&nbsp;2007.</span><span>)</span></a> [RFC5050].  
        That is, each EDP block is comprised of the following elements:
</p>
<p></p>
<blockquote class="text"><dl>
<dt></dt>
<dd>Block type code
</dd>
<dt></dt>
<dd>Block processing control flags
</dd>
<dt></dt>
<dd>Block data length
</dd>
<dt></dt>
<dd>Block EID reference count and EID references
</dd>
<dt></dt>
<dd>Block-type-specific data fields
</dd>
</dl></blockquote>

<p>A bundle with an EDP payload is uniquely identifiable and all bundle protocol features
        that rely on bundle identity, such as the Bundle Security Protocol <a class='info' href='#BPsec'>[BPsec]<span> (</span><span class='info'>Symington, S., Farrell, S., Weiss, H., and P. Lovell, &ldquo;Bundle Security Protocol Specification,&rdquo; February&nbsp;2010.</span><span>)</span></a>, can be enabled. A bundle with an EDP payload may
        be fragmented. The 'block contains an EID-reference field' flag in the
        block processing control flags of the primary block is set to 1 as the
        EDP block references EID elements in the primary block's dictionary.
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
The EDP Report Bundle Format</h3>

<p>EDP ADUs contained in bundles are called EDP reports. In order to take 
        full advantage of the capabilities of EDPv1, an EDP node
	MUST be capable of generating a bundle payload block, a record with the
	below format and of transmitting that bundle to the EDP EID.
</p><br /><hr class="insert" />
<a name="fig3"></a>
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
+----------------+----------------+----------------+----------------+
|  Block type    | Proc. Flags (*)| Block length(*)| DCF (*)        |
+----------------+----------------+----------------+----------------+
|                   AR EID Reference Count (*)                      |
+----------------+----------------+----------------+----------------+
|       AR list Ref_scheme_1 (*)  | AR list Ref_ssp_1 (*)           |
+----------------+----------------+----------------+----------------+
|       AR expiration counters (*)                                  |
+----------------+----------------+----------------+----------------+
|                   CLA EID Reference Count  (*)                    |
+----------------+----------------+----------------+----------------+
|       CLA list Ref_scheme_1 (*) | CLA list Ref_ssp_1 (*)          |
+----------------+----------------+----------------+----------------+
|                   PREF CLA Reference Count  (*)                   |
+----------------+----------------+----------------+----------------+
|      PREF list Ref_AR_I (*)     | PREF list Ref_CLA_I (*)         |
+----------------+----------------+----------------+----------------+
|      SC (*)                     | SA (*)                          |
+----------------+----------------+----------------+----------------+
|                              Delay (*)                            |
+----------------+----------------+----------------+----------------+
</pre></div>
<p style='text-align: center'>A <a class='info' href='#RFC5050'>[RFC5050]<span> (</span><span class='info'>Scott, K. and S. Burleigh, &ldquo;Bundle Protocol Specification,&rdquo; November&nbsp;2007.</span><span>)</span></a> Canonical Bundle Block Format
</p><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: The EDP Report Bundle Format&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>Notes:
</p>
<p></p>
<ul class="text">
<li>EDP is a DTN application protocol that uses the canonical bundle 
    block format <a class='info' href='#RFC5050'>[RFC5050]<span> (</span><span class='info'>Scott, K. and S. Burleigh, &ldquo;Bundle Protocol Specification,&rdquo; November&nbsp;2007.</span><span>)</span></a>
</li>
<li>(*) Indicates field contains a Self Delimiting Numerical Value (SDNV) 
    (see Section 4.1. of <a class='info' href='#RFC5050'>RFC&nbsp;5050<span> (</span><span class='info'>Scott, K. and S. Burleigh, &ldquo;Bundle Protocol Specification,&rdquo; November&nbsp;2007.</span><span>)</span></a> [RFC5050])
</li>
<li>Routing protocols and algorithms are identified by EIDs <a class='info' href='#dtnURI'>[dtnURI]<span> (</span><span class='info'>Fall, K., Burleigh, S., Doria, A., and J. Ott, &ldquo;The DTN URI Scheme,&rdquo; September&nbsp;2009.</span><span>)</span></a> and have EID registrations (see <a class='info' href='#appendix_A'>Appendix&nbsp;A<span> (</span><span class='info'>DTN Routing Protocols And Algorithms</span><span>)</span></a>). Active registrations (ARs) have registration 
    references in the EDP payload block.
</li>
<li>"Block Type" (see section 3.1 of <a class='info' href='#RFC5050'>RFC&nbsp;5050<span> (</span><span class='info'>Scott, K. and S. Burleigh, &ldquo;Bundle Protocol Specification,&rdquo; November&nbsp;2007.</span><span>)</span></a> [RFC5050]) 
    is a 1-byte mandatory field that indicates
    the type of the block. This field contains the value 1 to indicate it
    is the bundle payload block.
</li>
<li>"Block Processing Control Flags" (see section 3.1 of 
    <a class='info' href='#RFC5050'>RFC&nbsp;5050<span> (</span><span class='info'>Scott, K. and S. Burleigh, &ldquo;Bundle Protocol Specification,&rdquo; November&nbsp;2007.</span><span>)</span></a> [RFC5050]) is a SDNV
    that contains the BP block processing control flags, an unsigned integer
    expressed as a SDNV. The individual bits of this integer are set
    to '1' for the Last block flag, Discard block if it can't be
    processed flag and the block contains an EID-reference flag. A one
    octet SDNV is shown here for convenience in representation.
</li>
<li>"Block Length" (see section 3.1 of of <a class='info' href='#RFC5050'>RFC&nbsp;5050<span> (</span><span class='info'>Scott, K. and S. Burleigh, &ldquo;Bundle Protocol Specification,&rdquo; November&nbsp;2007.</span><span>)</span></a> [RFC5050]) 
    is a mandatory SDNV that contains
    the aggregate length of all remaining fields of the block - which
    is to say, the length of the bundle's payload. A one octet SDNV is
    shown here for convenience in representation.
</li>
<li>The "DCF" (Discovery Control Flags field) in a bundle with an EDP payload is a SDNV;
     the value encoded in this SDNV is a string of bits used to invoke
     selected block processing control features.  A one octet SDNV is
    shown here for convenience in representation. The significance of the
     values in all currently defined positions of this bit string, in order
     from least significant position in the decoded bit string (labeled '0')
     to most significant (labeled '6'), are described here.
</li>
</ul>
<br /><hr class="insert" />
<a name="fig5"></a>

<p style='text-align: center'>
</p><div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>

                          0
              6 5 4 3 2 1 0
             +-+-+-+-+-+-+-+
             |   Flags     |
             +-+-+-+-+-+-+-+

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;2: Block Discovery Control Flags Bit Layout&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p></p>
<blockquote class="text"><dl>
<dt></dt>
<dd>0 - Confirm BSP. If set indicates the Bundle Security Protocol <a class='info' href='#BPsec'>[BPsec]<span> (</span><span class='info'>Symington, S., Farrell, S., Weiss, H., and P. Lovell, &ldquo;Bundle Security Protocol Specification,&rdquo; February&nbsp;2010.</span><span>)</span></a> is enabled on
          the EDP node.
</dd>
<dt></dt>
<dd>1 - Confirm custodian status. If set indicates an EDP node is prepared to
          be a custodian to any neighbouring DTN nodes.
</dd>
<dt></dt>
<dd>2 - Confirm reactive fragmentation. If set indicates reactive fragmentation
          is enabled. The reactive fragmentation capability is not required to be
          available in every DTN implementation (See section 3.9)
          <a class='info' href='#RFC5050'>RFC&nbsp;5050<span> (</span><span class='info'>Scott, K. and S. Burleigh, &ldquo;Bundle Protocol Specification,&rdquo; November&nbsp;2007.</span><span>)</span></a> [RFC5050].
</dd>
<dt></dt>
<dd>3 - Request EDP. If set indicates that a bundle with an EDP payload is requested from the EDP
          node that receives this bundle.
</dd>
<dt></dt>
<dd>4 - Random response request. Indicates that the EDP node that receives this
          bundle is requested to generate a random positive integer uniformly distributed 
	  between zero and the value in the delay field of the EDP payload. This integer represents
          seconds to delay before sending an EDP report in response.
</dd>
<dt></dt>
<dd>5 - Reserved.
</dd>
<dt></dt>
<dd>6 - Reserved.
</dd>
</dl></blockquote>

<p></p>
<ul class="text">
<li>"AR EID reference count" is an EID reference field consisting
    of a count of EID active registration references expressed as an
    SDNV and followed by the EID references themselves. Each EID
    reference is a pair of SDNVs as described below. A four octet SDNV
    is shown here for convenience in representation.
</li>
<li>"AR list Ref_scheme_1" Contains the offset of a scheme name in the
     primary block's dictionary for an active registration. If present,
     is a SDNV and is therefore variable length.  A two-octet SDNV is
     shown here for convenience in representation.
</li>
<li>"AR list Ref_ssp_1" contains the offset of a scheme-specific part in
     the primary block's dictionary for an active registration. If
     present, is a SDNV and is therefore variable length.  A two-octet
     SDNV is shown here for convenience in representation.
</li>
<li>"AR expiration counters" is a list of the registration expiration
     counters for each active registration. It is an integer that indicates
     the expiration time of an active registration in seconds expressed 
     as a SDNV and is therefore variable length.  A
     four octet SDNV is shown here for convenience in representation.
</li>
<li>"CLA EID reference count" is an EID reference field consisting
     of a count of CLA EID references expressed as an
     SDNV and followed by the EID references themselves. Each CLA EID
     reference is a pair of SDNVs as described below. A four octet SDNV
     is shown here for convenience in representation.
</li>
<li>"CLA list Ref_scheme_1" Contains the offset of a scheme name in the
     primary block's dictionary for a CLA EID. If present,
     is a SDNV and is therefore variable length.  A two-octet SDNV is
     shown here for convenience in representation.
</li>
<li>"CLA list Ref_ssp_1" contains the offset of a scheme-specific part in
     the in the primary block's dictionary for a CLA EID. If
     present, is a SDNV and is therefore variable length.  A two-octet
     SDNV is shown here for convenience in representation.
</li>
<li>"PREF CLA reference count" is an EID reference field consisting
     of a count of the preferred CLAs (interfaces between the common 
     bundle protocol and a specific inter-network protocol suite) 
     for each active registration reference expressed as an
     SDNV and followed by the EID counter references themselves. Each EID 
     counter reference is a pair of SDNVs as described below. A four octet SDNV
     is shown here for convenience in representation.
</li>
<li>"PREF list Ref_AR_I" is a reference field to the "AR EID reference count"
     field consisting of an instance of the count of EID active registration 
     references. It is an index into the "AR EID reference count" to identify 
     an AR EID reference. If present, is a SDNV and is therefore variable length.  
     A two-octet SDNV is shown here for convenience in representation.
</li>
<li>"PREF list Ref_CLA_I" is a reference field to the "CLA EID reference count"    
     field consisting an instance of the count of CLA EIDs 
     references, followed by a delimiter ',' and then an integer. 
    The instance of the count of CLA EIDs     
     references is an index into the "CLA EID reference count" to identify 
     and to identify a CLA EID reference. The integer,following the delimiter is 
    set to '1' by default and is an indicator of CLA EID preference (see <a class='info' href='#appendix_B'>Appendix&nbsp;B<span> (</span><span class='info'>CLA Parameters</span><span>)</span></a>). An integer increase 
    signifies a decrease of preference. An instance of the count of CLA EIDs 
    references and the preference integer may both be set to '0' to signify no 
    preference. If present, is a SDNV and is therefore variable length.
     A two-octet SDNV is shown here for convenience in representation.
</li>
<li>"SC" is the DTN node storage capacity in bytes expressed as a SDNV
     and is therefore variable length.  A two octet SDNV is shown here
     for convenience in representation.
</li>
<li>"SA" is the DTN node's available storage capacity in bytes expressed
     as a SDNV and is therefore variable length.  A two octet SDNV
     is shown here for convenience in representation.
</li>
<li>"Delay" is a positive integer which indicates a delay in
     seconds. When DCF field bit position 3 is set this field is used to
     delay transmission of a bundle with an EDP payload report by a random or set amount 
     of seconds. The delayed transmission time is computed by the receiving 
     EDP node by adding the delay integer to the creation time stamp of the 
     received bundle. In the event an EDP node receives a request to 
     transmit a report at some time in the past, the EDP node will not 
     generate a report. If present, is a SDNV and is therefore variable length.  
     A four-octet SDNV is shown here for convenience in representation.
</li>
</ul>

<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Active Registrations.</h3>

<p>All active registrations and CLA EIDs referred
   to in the blocks of a bundle with an EDP payload are conveyed in the "dictionary"
   byte array in the bundle's primary block.  This array is simply
   the concatenation of any number of null-terminated scheme names
   and SSPs. "Endpoint ID references" field in the payload block are
   used to cite endpoint IDs that are contained in the dictionary.
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
The EDP Application Agent.</h3>

<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.1"></a><h3>4.3.1.&nbsp;
Bundle Generation and Transmission.</h3>

<p>The EDP application agent is responsible for constructing EDP report 
   ADUs to be transmitted in bundles. By default, bundles with EDP payloads are generated 
   and transmitted periodically every 30 seconds. EDP configuration options 
   can be used to change the default transmission period or to instruct the 
   EDP agent to only transmit in response to another DTN nodes' EDP report. 
   Bundles with EDP payloads can also be generated on demand. In concept, 
   the EDP application agent
   discharges this responsibility by directing the node's application
   agent to construct the record in the payload and request its transmission.
   The BP application agent constructs the record as is necessary to add a byte
   array, expressed as a SDNV, to the primary block's dictionary (see <a class='info' href='#appendix_D'>Appendix&nbsp;D<span> (</span><span class='info'>The Data Dictionary</span><span>)</span></a>)
   
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.2"></a><h3>4.3.2.&nbsp;
Bundle Reception.</h3>

<p>The EDP agent is responsible for receiving an  EDP ADU on the EDP
   registration and processing it. 
</p>
<p>An EDP ADU with the 'Request EDP' 
   flag set in its status field is an 'EDP request'. An EDP agent 
   that receives an 'EDP request' is directed to schedule generation and 
   transmission of an EDP ADU. An EDP ADU will be 
   transmitted at a time equal to that of the creation timestamp plus the 
   delay value indicated in the delay field of the 'EDP request'. When an
   EDP request is received with the 'Request EDP' flag set, the generated 
   bundle with an EDP payload MUST have the 'Request EDP' flag set to zero.
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.2.1"></a><h3>4.3.2.1.&nbsp;
Random Response Request.</h3>

<p>When an 'EDP request' is received that has the 'Random response request' 
   flag set in its status field, the EDP application agent schedules generation 
   and transmission of an EDP ADU in a delayed fashion. On reception of the 
   'EDP request' the EDP agent generates a specific delay value, a random 
   positive integer. Generation of the integer is bound by a range indicated by the 
   value specified in the delay field in the 'EDP request' payload. 
   A positive integer, indicating a delay in seconds, is generated if the value 
   is positive. A delay value of zero indicates a response should be generated 
   immediately.
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.2.2"></a><h3>4.3.2.2.&nbsp;
Scheduled Response Request.</h3>

<p>A bundle with an EDP ADU in its payload is transmitted on reception of an 'EDP request' when the delay 
   field is zero (default), as this indicates that there is no delay desired. 
   If the 'Request EDP' flag is set and the 'Random response request' flag is not set, 
   the delay value indicates an absolute delay in seconds. This type of 'EDP request' is used 
   to request a remote EDP application agent to schedule generation and transmission 
   of a bundle with an EDP ADU in its payload at a specific later time.
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4"></a><h3>4.4.&nbsp;
Example: Three DTN Nodes.</h3>

<p>A scenario in which three proximate DTN nodes 'A', 'B' and 'C', identifiable by unique EIDs 'dtn::A', 
    'dtn::B' and 'dtn::C' is presented. 'C' has three services 'X', 'Y' and 'Z'.
    Each service has an active EID registration, in the form 'unique EID' '/' 'service'.
    'A', 'B' and 'C' publish their services by transmitting bundles with EDP ADUs in the payload to 
    the destination EID 'dtn::EDPv1', of proximate DTN nodes via all CLAs. In this scene the three registrations for 'C' 
    are as follows:
</p>
<p></p>
<blockquote class="text"><dl>
<dt></dt>
<dd>dtn::C/X
</dd>
<dt></dt>
<dd>dtn::C/Y
</dd>
<dt></dt>
<dd>dtn::C/Z
</dd>
</dl></blockquote>

<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.1"></a><h3>4.4.1.&nbsp;
CLA EIDs of 'A', 'B' and 'C'</h3>

<p>Each DTN node is equipped with two Ethernet interfaces 
    and a Bluetooth interface. The CLA EID that is used to identify each CLA includes 
    a CLA type and an CLA instance identifier. In this scene, the CLA type for the Ethernet and
    Bluetooth devices is 'eui-48'. The instance identifier for each CLA type is the 
    EUI-48 identifier. 'A'  has two Ethernet devices, with identifiers '00:1c:bf:93:98:5d' and '00:1b:38:cc:df:ef' 
    and a single Bluetooth device '00:23:6c:9c:a5:f8'. The CLA EIDs of 'A' are as follows:
</p>
<p></p>
<blockquote class="text"><dl>
<dt></dt>
<dd>dtn:next:eui-48:00:1c:bf:93:98:5d
</dd>
<dt></dt>
<dd>dtn:next:eui-48:00:1b:38:cc:df:ef
</dd>
<dt></dt>
<dd>dtn:next:eui-48:00:23:6c:9c:a5:f8
</dd>
</dl></blockquote>

<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.2"></a><h3>4.4.2.&nbsp;
The ARs, CLA EIDs and Preferences of 'C'</h3>

<p>'C' advertises services 'X' and 'Z'. Service 'X' is a type of storage service, that is 
    provides data storage to users of it. Service 'Z' allows execution of commands and is 
    provided to DTN nodes that are connected to an Ethernet segment.
</p>
<p></p>
<ul class="text">
<li>Service 'X' is accessible through all CLA EIDs of 'C'. 'C' has a Bluetooth CLA with CLA EID 
    'dtn:next:eui-48:00:23:6C:9C:A5:32', Ethernet CLA with CLA EIDs 'dtn:next:eui-48:00:1c:bf:93:98:c1' and 
   Ethernet CLA with CLA EID 'dtn:next:eui-48:00:1b:38:cc:df:b1'. 'C' has a preferred CLA EID list 
   (see <a class='info' href='#appendix_B'>Appendix&nbsp;B<span> (</span><span class='info'>CLA Parameters</span><span>)</span></a>) for service 'X' in the order as listed.
</li>
<li>Service 'Z' is to be accessed via the Ethernet CLA with CLA EID 'dtn:next:eui-48:00:1b:38:cc:df:b1' 
    of 'C' only.
</li>
</ul>

<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.3"></a><h3>4.4.3.&nbsp;
'C' Transmits Bundle containing an EDP ADU</h3>

<p>'C' periodically transmits bundles that contain EDP ADUs with an
    EID destination 'dtn::EDPv1' and EID source 'dtn::C', every 30 seconds. 
    Both 'A' and 'B' receive a bundle with 
    an EDP ADU in its payload on their EDP registrations. Both receive the same bundle on each of 
    their CLAs. The EDP ADU received by the EDP registration 'dtn::EDPv1' on  
    'A' is identical to the ADU received by the registration 'dtn::EDPv1' on 'B'. The ADU contains references to 
    offsets of the data dictionary of the primary block of the bundle which it was the payload. Although 
    the fields contain offsets the actual referenced values are depicted below:
</p><br /><hr class="insert" />
<a name="cla_eids_c"></a>

<p style='text-align: center'>AR EID Reference Count = 3
</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="center"><col align="center">
<tr><th align="center">AR list Ref_scheme_1</th><th align="center">AR list Ref_ssp_1</th></tr>
<tr>
<td align="center">dtn:</td>
<td align="center">next:eui-48:00:23:6C:9C:A5:32</td>
</tr>
<tr>
<td align="center">dtn:</td>
<td align="center">next:eui-48:00:1c:bf:93:98:c1</td>
</tr>
<tr>
<td align="center">dtn:</td>
<td align="center">next:eui-48:00:1b:38:cc:df:b1</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 2: CLA EIDs of 'C'&nbsp;</b></font><br /></td></tr></table><hr class="insert" />
<br /><hr class="insert" />
<a name="ar_eids_c"></a>

<p style='text-align: center'>CLA EID Reference Count = 3
</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="center"><col align="center">
<tr><th align="center">CLA list Ref_scheme_1</th><th align="center">CLA list Ref_ssp_1</th></tr>
<tr>
<td align="center">dtn:</td>
<td align="center">:C/X</td>
</tr>
<tr>
<td align="center">dtn:</td>
<td align="center">:C/Y</td>
</tr>
<tr>
<td align="center">dtn:</td>
<td align="center">:C/Z</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 3: AR EIDs of 'C'&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>The DCF field (below) shows that a bundle with an EDP payload was not requested. This means 
    an EDP report is not generated by 'A' or 'B' in response. As a bundle with an EDP payload was 
    not requested the EDP ADU did not contain a 'Delay' field
</p><br /><hr class="insert" />
<a name="DCF"></a>

<p style='text-align: center'>The DCF field has the following bits set
</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="center"><col align="center">
<tr><th align="center">Bit</th><th align="center">Setting</th></tr>
<tr>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">1</td>
<td align="center">1</td>
</tr>
<tr>
<td align="center">2</td>
<td align="center">1</td>
</tr>
<tr>
<td align="center">3</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">4</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">5</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">6</td>
<td align="center">0</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 4: DCF of 'C'&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>The values in the DCF field indicate the following about 'C':
</p>
<p></p>
<ul class="text">
<li>Bundle Security is enabled
</li>
<li>DTN node is prepared to be a custodian to any neighbouring DTN nodes
</li>
<li>Reactive fragmentation is enabled
</li>
<li>A bundle with an EDP payload is not requested
</li>
<li>A random response request is not requested
</li>
</ul>

<p>The 'SC' and 'SA' fields (below) indicate that the storage capacity of 'C' is 97 GB
        and its available storage is 14 GB and can calculate that the storage used is '81352328' or
        about 86%
</p><br /><hr class="insert" />
<a name="storage"></a>

<p style='text-align: center'>The storage fields 'SC' and 'SA'
</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="center"><col align="center">
<tr><th align="center">SC</th><th align="center">SA</th></tr>
<tr>
<td align="center">100790004</td>
<td align="center">14317764</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 5: Storage of 'C'&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>The preference list of 'C' (below) contains values that are an 
    index into the reference counts of CLA EID and AR EID. A CLA EID count 
    is followed by a delimiter and then an integer. The integer is an indicator
    of preference of CLA EID(s) for an active registration.
</p><br /><hr class="insert" />
<a name="pref_list_1"></a>

<p style='text-align: center'>PREF CLA Reference Count = 4
</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="center"><col align="center">
<tr><th align="center">PREF list Ref_AR_I</th><th align="center">PREF list Ref_CLA_I</th></tr>
<tr>
<td align="center">1</td>
<td align="center">1,1</td>
</tr>
<tr>
<td align="center">1</td>
<td align="center">2,2</td>
</tr>
<tr>
<td align="center">1</td>
<td align="center">3,3</td>
</tr>
<tr>
<td align="center">2</td>
<td align="center">3,1</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 6: Preference List of 'C'&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>The preference list shows that the service with AR EID indicated by '1' has three 
    CLA EIDs, indicated by '1', '2' and '3', through which it will receive 
    bundles. 'C' would prefer to use CLA EID identified by '1' with preference indicator '1'.
    The next preference of 'C' is CLA EID identified by '2' with preference indicator '2'.
    The CLA EID, that is the least preferred, is identified by '3' with preference indicator '3'. The preference 
    list shows that the service with AR EID that is indicated by '2' has one CLA EID 
    indicated by '3', through which it will receive bundles. A default preference indicator 
    of '1' is used.
</p>
<p>The table belows show the values that are indicated by the values in the preference 
    list of the EDP ADU of 'C'
</p><br /><hr class="insert" />
<a name="pref_list_2"></a>

<p style='text-align: center'>PREF CLA Reference Count = 4
</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="center"><col align="center">
<tr><th align="center">PREF list Ref_AR_I</th><th align="center">PREF list Ref_CLA_I</th></tr>
<tr>
<td align="center">dtn::C/X</td>
<td align="center">dtn:next:eui-48:00:23:6C:9C:A5:32</td>
</tr>
<tr>
<td align="center">dtn::C/X</td>
<td align="center">dtn:next:eui-48:00:1c:bf:93:98:c1</td>
</tr>
<tr>
<td align="center">dtn::C/X</td>
<td align="center">dtn:next:eui-48:00:1b:38:cc:df:b1</td>
</tr>
<tr>
<td align="center">dtn::C/Y</td>
<td align="center">dtn:next:eui-48:00:1b:38:cc:df:b1</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 7: EID values indicated in Preference List of 'C'&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>The services (EIDs on the left) of 'C' may be 
    accessed using a CLA EID (EIDs on the right). If node 'A' or 'B' 
    has a CLA (or even several CLAs) that could be used to communicate, they can avail of the
    advertised services of 'C'
</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.4"></a><h3>4.4.4.&nbsp;
'A' Uses Service of 'C'</h3>

<p>An application running on 'A' decides to move 13GB of data to 
    'C' which is offering storage service, identified by endpoint 'dtn::C/X'.
    'A' determines that 'C' has 14GB of storage available from the storage field. 'A' can determine  
    'C' is accepting custody from the DCF field.
</p>
<p>In order for 'A' to transmit the 13GB of data to 'dtn::C/X', it generates 
    a bundle with the 13GB of data as its payload, fragments it into smaller bundles and 
    attempts to transmit them via a DTN next hop of 'dtn:next:eui-48:00:23:6C:9C:A5:32'. 
    The source EID of the bundle is 'dtn::A/X', destination EID is 'dtn::C/X', and the next 
    hop is via the BD_ADDR '00:23:6C:9C:A5:32'. 
    'A' has a single Bluetooth device with BD_ADDR of '00:23:6c:9c:a5:f8', which has 
    CLA EID of 'dtn:next:eui-48:00:23:6c:9c:a5:f8' and this will be used to communicate 
    with 'C'.
</p><br /><hr class="insert" />
<a name="nh1"></a>
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>

            dtn::A/X                                dtn::C/X
               |                                     |
dtn:next:eui-48:00:23:6c:9c:a5:f8&lt;-&gt;dtn:next:eui-48:00:23:6C:9C:A5:32
dtn:next:eui-48:00:1c:bf:93:98:5d&lt;-&gt;dtn:next:eui-48:00:1c:bf:93:98:c1
dtn:next:eui-48:00:1b:38:cc:df:ef&lt;-&gt;dtn:next:eui-48:00:1c:bf:93:98:c1
dtn:next:eui-48:00:1c:bf:93:98:5d&lt;-&gt;dtn:next:eui-48:00:1b:38:cc:df:b1
dtn:next:eui-48:00:1b:38:cc:df:ef&lt;-&gt;dtn:next:eui-48:00:1b:38:cc:df:b1

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;3: DTN Next Hop for service dtn::C/X&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>Bundles with EID destination 'dtn::C/X' and source 'dtn::A/X' are received by 'C' 
    via its Bluetooth identifier (BD_ADDR) '00:23:6C:9C:A5:32', with CLA EID 
    'dtn:next:eui-48:00:23:6C:9C:A5:32'. The BP agent of 'C' reassembles the fragmented bundle 
    and the service with active registration 'dtn::C/X', receives and processes the ADU.
</p>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.5"></a><h3>4.4.5.&nbsp;
'B' Uses Service of 'C'</h3>

<p>An application running on 'B' desires to execute a command on 
    'C' which is offering a command execution service, identified by endpoint 'dtn::C/Y'.
    'B' can determine Bundle Security is disabled on 'C' from 
    the DCF field.
</p>
<p>In order for 'B' to transmit the command to 'dtn::C/Y', 'B' generates
    a bundle with the command execution as data as its payload and transmit it 
    via a DTN next hop of 'dtn:next:eui-48:00:1b:38:cc:df:b1'.
    The source EID of the bundle is 'dtn::B/Y', destination EID is 'dtn::C/Y', and the next
    hop is via the Ethernet identifier '00:1b:38:cc:df:b1'.
    'B' has two Ethernet devices. Only one ('00:1c:bf:9c:98:5f') is on the same segment as 00:1b:38:cc:df:b1, and has
    CLA EID of 'dtn:next:eui-48:00:1c:bf:93:98:5d' and this will be used to communicate
    with 'C'.
</p><br /><hr class="insert" />
<a name="nh2"></a>
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>

            dtn::B/Y                              dtn::C/Y
               |                                     |
dtn:next:eui-48:00:1c:bf:9c:98:5f&lt;-&gt;dtn:next:eui-48:00:1b:38:cc:df:b1

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;4: DTN Next Hop for service dtn::C/Y&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>Bundles with EID destination 'dtn::C/Y' and source 'dtn::B/Y' are received by 'C'
    via its Ethernet identifier '00:1b:38:cc:df:b1', with CLA EID
    'dtn:next:eui-48:00:1b:38:cc:df:b1'. The BP agent of 'C' receives the bundle and delivers 
    the ADU to the service with active registration 'dtn::C/Y'.
</p>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Acknowledgements</h3>

<p>The DTNRG
</p>
<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
IANA Considerations</h3>

<p>This memo includes no request to IANA.
</p>
<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Security Considerations</h3>

<p>A bundle with an EDP payload raises no security 
   considerations beyond those addressed in <a class='info' href='#RFC5050'>[RFC5050]<span> (</span><span class='info'>Scott, K. and S. Burleigh, &ldquo;Bundle Protocol Specification,&rdquo; November&nbsp;2007.</span><span>)</span></a>.
</p>
<p>Attacks built on the "Request EDP" operation could exploit the possible
   side effects of evaluating selection expressions.
</p>
<p>DoS-mitigation in DTNs is still a research area. However, it is recommended
   that bundles are authenticated <a class='info' href='#BPsec'>[BPsec]<span> (</span><span class='info'>Symington, S., Farrell, S., Weiss, H., and P. Lovell, &ldquo;Bundle Security Protocol Specification,&rdquo; February&nbsp;2010.</span><span>)</span></a> 
   as a way of making the bad actor accountable.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>8.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="BPsec">[BPsec]</a></td>
<td class="author-text"><a href="mailto:susan@mitre.org">Symington, S.</a>, <a href="mailto:stephen.farrell@cs.tcd.ie">Farrell, S.</a>, <a href="mailto:hsw@sparta.com">Weiss, H.</a>, and <a href="mailto:peter.lovell@sparta.com">P. Lovell</a>, &ldquo;Bundle Security Protocol Specification,&rdquo; draft-irtf-dtnrg-bundle-security-15.txt,&nbsp;work-in-progress, February&nbsp;2010.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5050">[RFC5050]</a></td>
<td class="author-text">Scott, K. and S. Burleigh, &ldquo;<a href="http://tools.ietf.org/html/rfc5050">Bundle Protocol Specification</a>,&rdquo; RFC&nbsp;5050, November&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc5050.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="dtnURI">[dtnURI]</a></td>
<td class="author-text"><a href="mailto:kfall@intel.com">Fall, K.</a>, <a href="mailto:scott.c.burleigh@jpl.nasa.gov">Burleigh, S.</a>, <a href="mailto:avri@ltu.se">Doria, A.</a>, and <a href="mailto:jo@netlab.hut.fi">J. Ott</a>, &ldquo;The DTN URI Scheme,&rdquo; draft-irtf-dtnrg-dtn-uri-scheme-00.txt,&nbsp;work-in-progress, September&nbsp;2009.</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>8.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC3986">[RFC3986]</a></td>
<td class="author-text"><a href="mailto:timbl@w3.org">Berners-Lee, T.</a>, <a href="mailto:fielding@gbiv.com">Fielding, R.</a>, and <a href="mailto:LMM@acm.org">L. Masinter</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc3986">Uniform Resource Identifier (URI): Generic Syntax</a>,&rdquo; STD&nbsp;66, RFC&nbsp;3986, January&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc3986.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc3986.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc3986.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4838">[RFC4838]</a></td>
<td class="author-text">Cerf, V., Burleigh, S., Hooke, A., Torgerson, L., Durst, R., Scott, K., Fall, K., and H. Weiss, &ldquo;<a href="http://tools.ietf.org/html/rfc4838">Delay-Tolerant Networking Architecture</a>,&rdquo; RFC&nbsp;4838, April&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4838.txt">TXT</a>).</td></tr>
</table>

<a name="appendix_A"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
DTN Routing Protocols And Algorithms</h3>

<p>DTN routing protocols and algorithms have EID registrations as they are services used by DTN 
    applications and the BPA. For examples of the the application of EIDs to DTN routing protocols and 
    algorithms please see <a class='info' href='#dtnURI'>[dtnURI]<span> (</span><span class='info'>Fall, K., Burleigh, S., Doria, A., and J. Ott, &ldquo;The DTN URI Scheme,&rdquo; September&nbsp;2009.</span><span>)</span></a>.
</p>
<p>An EDP agent must be able to report a list of the preferred routing protocol or
    algorithms for each active CLA EID registration. It is expected that DTN routing
    protocols and algorithms (to be agreed upon), make use of information learned via
    EDP and provide statistics in such a way that they are accessible to an EDP agent.
</p>
<a name="appendix_B"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B"></a><h3>Appendix B.&nbsp;
CLA Parameters</h3>

<p>An EDP agent must be able to report a list of the preferred CLAs for each
    EID registration. An EDP node is expected to be capable of obtaining statistics
    that include the contact attempts, up-time, number of contacts and
    throughput of available CLAs. The number of bundles deferred and number of bytes
    transmitted, queued, and cancelled are also expected to be available to the EDP
    agent.
</p>
<p>CLA parameters that are common to all CLAs SHOULD be available for an EDP node to query.
    Examples of such common parameters are Link name, CLA EID, CLA type, CLA state, next DTN hop,
    and MTU.
</p>
<p>It is expected that there are CLA parameters that are specific to a CLA. CLA
    specific data such as the local COMM port, MAC address, IP address, port, whether segment ack
    or negative ack is enabled and the segment length should also be accessible to EDP
</p>
<p>It is expected that an API (see <a class='info' href='#appendix_C'>Appendix&nbsp;C<span> (</span><span class='info'>APIs for EDP</span><span>)</span></a>) will be required to
    facilitate the query of an EDP nodes CLA names and parameters.
</p>
<a name="appendix_C"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C"></a><h3>Appendix C.&nbsp;
APIs for EDP</h3>

<p>It is expected that various APIs are required to enable EDP to query and set parameters.
    APIs are required to facilitate manipulation of the data dictionary, query CLA names and 
    parameters, query active EID registration URIs and registration parameters, and to set the 
    DTN hop limit to 1.
</p>
<a name="appendix_D"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.D"></a><h3>Appendix D.&nbsp;
The Data Dictionary</h3>

<p>The EDP application agent must be able to add and delete EIDs to the data
    dictionary of the primary block (see <a class='info' href='#appendix_C'>Appendix&nbsp;C<span> (</span><span class='info'>APIs for EDP</span><span>)</span></a>). EDP discharges this
    responsibility by directing the node's BP application agent to construct the record and
    manipulate the data dictionary. The data dictionary
    is populated with a byte array, expressed as a SDNV, of the concatenation of any number of
    null-terminated active EIDs and CLA EIDs.
</p>
<a name="appendix_E"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.E"></a><h3>Appendix E.&nbsp;
Discovery Mechanisms</h3>

<p>An EDP agent is expected to discover and report active CLAs.  EDP is
   expected to leverage existing discovery schemes when available. At least one CLA,
   whether discovered and activated automatically or configured and activated
   manually, is required by EDP.
</p>
<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Alex Mc Mahon</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Trinity College Dublin</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Distributed Systems Group</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Department of Computer Science</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Trinity College</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Dublin  2</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Ireland</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+353-1-896-2354</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:alex.mcmahon@cs.tcd.ie">alex.mcmahon@cs.tcd.ie</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Kevin Fall</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Intel Labs, Berkeley</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">2150 Shattuck Avenue, #1300</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Berkeley, California  94704</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1-510-495-3014</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:kfall@intel.com">kfall@intel.com</a></td></tr>
</table>
</body></html>
