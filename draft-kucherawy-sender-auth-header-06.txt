


Individual submission                                       M. Kucherawy
Internet-Draft                                            Sendmail, Inc.
Intended status: Standards Track                           July 26, 2007
Expires: January 27, 2008


    Message Header Field for Indicating Sender Authentication Status
                 draft-kucherawy-sender-auth-header-06

Status of this Memo

   By submitting this Internet-Draft, each author represents that any
   applicable patent or other IPR claims of which he or she is aware
   have been or will be disclosed, and any of which he or she becomes
   aware will be disclosed, in accordance with Section 6 of BCP 79.
   This document may not be modified, and derivative works of it may not
   be created.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups.  Note that
   other groups may also distribute working documents as Internet-
   Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt.

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html.

   This Internet-Draft will expire on January 27, 2008.

Copyright Notice

   Copyright (C) The IETF Trust (2007).












Kucherawy               Expires January 27, 2008                [Page 1]

Internet-Draft        Authentication-Results Header            July 2007


Abstract

   This memo defines a new message header field for use with electronic
   mail messages to indicate the results of sender authentication
   efforts.  Mail user agents (MUAs) may use this message header field
   to relay that information in a convenient way to users or to make
   sorting and filtering decisions.


Table of Contents

   1.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . .  4
     1.1.  Purpose  . . . . . . . . . . . . . . . . . . . . . . . . .  4
     1.2.  Requirements . . . . . . . . . . . . . . . . . . . . . . .  4
     1.3.  Definitions  . . . . . . . . . . . . . . . . . . . . . . .  4
   2.  Definition and Format of the Header  . . . . . . . . . . . . .  6
     2.1.  General Description  . . . . . . . . . . . . . . . . . . .  6
     2.2.  Formal Definition  . . . . . . . . . . . . . . . . . . . .  6
     2.3.  Authentication Identifier Fields . . . . . . . . . . . . .  8
     2.4.  Result Values  . . . . . . . . . . . . . . . . . . . . . .  9
     2.5.  Definition Of Initial Methods  . . . . . . . . . . . . . .  9
     2.6.  Extension Fields . . . . . . . . . . . . . . . . . . . . . 10
   3.  Adding The Header To A Message . . . . . . . . . . . . . . . . 11
     3.1.  Header Position and Interpretation . . . . . . . . . . . . 11
   4.  Discussion . . . . . . . . . . . . . . . . . . . . . . . . . . 13
     4.1.  Removing The Header  . . . . . . . . . . . . . . . . . . . 13
   5.  Conformance and Usage Requirements . . . . . . . . . . . . . . 14
   6.  IANA Considerations  . . . . . . . . . . . . . . . . . . . . . 15
     6.1.  The Authentication-Results: header . . . . . . . . . . . . 15
     6.2.  Method Registry  . . . . . . . . . . . . . . . . . . . . . 15
   7.  Security Considerations  . . . . . . . . . . . . . . . . . . . 16
     7.1.  Non-conformant MTAs  . . . . . . . . . . . . . . . . . . . 16
     7.2.  Header Position  . . . . . . . . . . . . . . . . . . . . . 16
   8.  References . . . . . . . . . . . . . . . . . . . . . . . . . . 17
     8.1.  Normative References . . . . . . . . . . . . . . . . . . . 17
     8.2.  Informative References . . . . . . . . . . . . . . . . . . 17
   Appendix A.  Acknowledgements  . . . . . . . . . . . . . . . . . . 19
   Appendix B.  Legacy MUAs . . . . . . . . . . . . . . . . . . . . . 20
   Appendix C.  Authentication-Results Examples . . . . . . . . . . . 21
     C.1.  Trivial case; header field not present . . . . . . . . . . 21
     C.2.  Nearly-trivial case; service provided, but no
           authentication done  . . . . . . . . . . . . . . . . . . . 22
     C.3.  Service provided, authentication done  . . . . . . . . . . 22
     C.4.  Service provided, several authentications done, single
           MTA  . . . . . . . . . . . . . . . . . . . . . . . . . . . 23
     C.5.  Service provided, several authentications done,
           different MTAs . . . . . . . . . . . . . . . . . . . . . . 24
   Appendix D.  Public Discussion . . . . . . . . . . . . . . . . . . 26



Kucherawy               Expires January 27, 2008                [Page 2]

Internet-Draft        Authentication-Results Header            July 2007


   Author's Address . . . . . . . . . . . . . . . . . . . . . . . . . 27
   Intellectual Property and Copyright Statements . . . . . . . . . . 28

















































Kucherawy               Expires January 27, 2008                [Page 3]

Internet-Draft        Authentication-Results Header            July 2007


1.  Introduction

   This memo defines a new message header field for electronic mail
   messages which presents the results of a sender authentication effort
   in a machine-readable format.  The intent is to create a place to
   collect such data when sender authentication mechanisms are in use so
   that a Mail User Agent (MUA) can provide a recommendation to the user
   as to the trustworthiness of the message's origin and content.

   This memo defines both the format of this new header field, and
   discusses the implications of its presence or absence.

   [UPDATE PRIOR TO FINAL VERSION] At the time of publication of this
   draft, [AUTH], [DKIM], [DOMAINKEYS], [SENDERID] and [SPF] are the
   published e-mail authentication methods in common use.  As various
   methods emerge, it is necessary to prepare for their appearance and
   encourage convergence in the area of interfacing these filters to
   MUAs.

1.1.  Purpose

   The header field defined in this memo is expected to serve several
   purposes:

   1.  Convey to MUAs from filters and Mail Transfer Agents (MTAs) the
       results of various sender authentication checks being applied;

   2.  Provide a common location for the presentation of this data;

   3.  Create an extensible framework for specifying new authentication
       methods as such emerge;

   4.  Convey the results of sender authentication tests to later
       filtering agents within the same "trust domain", as such agents
       might apply more or less stringent checks based on sender
       authentication results.

1.2.  Requirements

   This memo establishes no new requirements on existing protocols or
   servers, as there is currently no standard place for the described
   data to be collected or presented.

1.3.  Definitions

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in RFC2119.



Kucherawy               Expires January 27, 2008                [Page 4]

Internet-Draft        Authentication-Results Header            July 2007


   A "border MTA" is an MTA which acts as a gateway between the general
   Internet and the users within an organizational boundary.

   A "delivery MTA" (or Mail Delivery Agent or MDA) is an MTA which
   actually enacts delivery of a message to a user's inbox or other
   final delivery.

   Generally it is assumed that the work of applying sender
   authentication schemes takes place at a border MTA or a delivery MTA.
   This specification is written with that assumption in mind.  However,
   there are some sites at which the entire mail infrastructure consists
   of a single host.  In such cases, such terms as "border MTA" and
   "delivery MTA" may well apply to the same machine or even the very
   same agent.  See [I-D.DRAFT-CROCKER-EMAIL-ARCH] for further
   discussion on e-mail system architecture.




































Kucherawy               Expires January 27, 2008                [Page 5]

Internet-Draft        Authentication-Results Header            July 2007


2.  Definition and Format of the Header

   This section gives a general overview of the format of the header
   field being defined, and then provides more formal specification.

2.1.  General Description

   The new header field being defined here is called "Authentication-
   Results".  It is a Structured Header Field as defined in [MAIL] and
   thus all of the related definitions in that document apply.

   This new header field MUST be added at the top of the message as it
   transits MTAs which do authentication checks so some idea of how far
   away the checks were done can be inferred.  It therefore should be
   treated as a Trace Header Field as defined in [MAIL] and thus all of
   the related definitions in that document apply.

   The decommented value of the header field consists of an
   authentication identifier, some whitespace, a "property=value"
   statement indicating which property was selected to determine who
   sent the message and what value was extracted from that property,
   followed by zero or more authentication method names and a result
   associated with each, returned by the code that implements the
   method.

   The header field MAY appear more than once in a single message, or
   more than one result MAY be represented in a single header field, or
   a combination of these MAY be applied.

2.2.  Formal Definition

   Formally, the header field is specified as follows:

      header = "Authentication-Results:" [CFWS] authres-id
               *([CFWS] ";" methodspec propspec )


      authres-id = dot-atom-text
                 ; see below for a description of this element;
                 ; "dot-atom-text" is defined in section 3.2.4 of [MAIL]


      methodspec = [CFWS] method [CFWS] "=" [CFWS] result [CFWS]
                 ; indicates which authentication method was evaluated







Kucherawy               Expires January 27, 2008                [Page 6]

Internet-Draft        Authentication-Results Header            July 2007


      propspec = ptype [CFWS] "." [CFWS] property [CFWS] "=" value
               ; an indication of which property of the message
               ; was evaluated by the authentication scheme being
               ; applied to yield the reported result


      method = token [ "/" version ]
             ; a method indicates which method's result is
             ; is represented by "value", and is one of the methods
             ; explicitly defined as valid in this document
             ; or is an extension method as defined below


      version = 1*( ALPHA / DIGIT ) 0*( "." 1*( ALPHA / DIGIT ) )
              ; indicates which version of the method was applied


      result = "pass" / "hardfail" / "softfail" / "neutral" /
                "temperror" / "permerror"
             ; an indication of the results of the attempt to
             ; authenticate the sender


      ptype = "smtp" / "header" / "body" / "policy"
            ; indicates whether the property being evaluated was
            ; a parameter to an [SMTP] command, or was a value taken
            ; from a message header field, or was some property of
            ; the message body, or some other property evaluated by
            ; the receiving MTA


      property = token
              ; if "ptype" is "smtp", this indicates which [SMTP]
              ; command provided the value which was evaluated by the
              ; authentication scheme being applied; if "ptype" is
              ; "header", this indicates from which header field the
              ; value being evaluated was extracted; if "ptype" is
              ; "body", this indicates the offset into the body at which
              ; content of interest was detected; if "ptype" is "policy"
              ; then this indicates the name of the policy which caused
              ; this header field to be added (see below)


      value = [CFWS] token [CFWS] / mailbox
            ; the value extracted from the message property defined
            ; by the "ptype.property" construction; if the value
            ; identifies a mailbox, then it is a "mailbox"
            ; as defined in section 3.4 of [MAIL];



Kucherawy               Expires January 27, 2008                [Page 7]

Internet-Draft        Authentication-Results Header            July 2007


            ; "mailbox" allows CFWS

   The "token" is as defined in Appendix A of [MIME].

   See Section 2.3 for a description of the "authres-id" element.

   The list of commands eligible for use with the "smtp" ptype can be
   found in [SMTP] and subsequent amendments.

   "CFWS" is as defined in section 3.2.3 of [MAIL].

   The "ptype" and "property" values used by each authentication method
   should be defined in the specification for that method (or its
   amendments).

   The "ptype" and "property" are case-insensitive.

   A "ptype" value of "policy" indicates a policy decision about the
   message not specific to a property of the message that could be
   extracted.  For example, if a method would normally report a
   "ptype.property" of "header.From" and no From: header field was
   present, the method can use "policy" to indicate that no conclusion
   about the authenticity of the message could be reached.

   If the parsed "ptype.property" construction clearly identifies a
   mailbox (in particular, smtp.mail, smtp.rcpt, header.from,
   header.sender), then the "value" MUST be a "mailbox".  Other
   properties (e.g. smtp.helo) may be evaluated, but the property MUST
   still be expressed as a "token" for simplified parsing.

2.3.  Authentication Identifier Fields

   Every Authentication-Results header field MUST have an authentication
   identifier field ("authres-id" above) which is a single result
   identifier.  This is similar in syntax to a fully-qualified domain
   name.

   The authentication identifier field provides a unique identifier that
   refers to the authenticating service within a given mail
   administrative domain.  The uniqueness of the identifier is
   guaranteed by the mail administrative domain that generates it and
   must pertain to exactly that one mail administrative domain.  This
   identifier is intended to be machine-readable and not necessarily
   meaningful to users.  MUAs may use this identifier to determine
   whether or not the data contained in an Authentication-Results header
   field can be trusted.

   The mail administrative domain's unique domain name MUST be used as



Kucherawy               Expires January 27, 2008                [Page 8]

Internet-Draft        Authentication-Results Header            July 2007


   the last portion of the identifier.

   Examples of valid authentication identifiers are mail.example.org,
   engineering.example.edu and ms1.newyork.example.com.

2.4.  Result Values

   The six possible values of the "result" are:

   pass:  The message passed the authentication tests.  (This may
      require accessing an authentication policy of some kind published
      by the sending domain.)

   hardfail:  The message failed the authentication tests.  (This may
      require accessing an authentication policy of some kind published
      by the sending domain.)

   softfail:  The message failed the authentication tests, and the
      authentication method has either an explicit (published by the
      sending domain) or implicit policy, but the policy being used
      doesn't require successful authentication of all messages from
      that domain.

   neutral:  The authentication method completed without errors, but was
      unable to reach either a positive or negative result about the
      message.

   temperror:  A temporary (recoverable) error occurred attempting to
      authenticate the sender; either the process couldn't be completed
      locally, or (for methods requiring a policy to be accessed) there
      was a temporary failure retrieving the sending domain's policy.  A
      later retry may produce a more final result.

   permerror:  A permanent (unrecoverable) error occurred attempting to
      authenticate the sender; either the process couldn't be completed
      locally, or (for methods requiring a policy to be accessed) there
      was a permanent failure retrieving the sending domain's policy.  A
      later retry is unlikely to yield a final result.

   New methods not specified in this document MUST indicate which of
   these should be returned when exceptions such as syntax errors are
   detected.

2.5.  Definition Of Initial Methods

   As they are currently existing specifications for sender
   authentication, it is appropriate to define an authentication method
   identifier for each of [AUTH], [DKIM], [DOMAINKEYS], [SENDERID] and



Kucherawy               Expires January 27, 2008                [Page 9]

Internet-Draft        Authentication-Results Header            July 2007


   [SPF].  Therefore, the authentication method identifiers "auth",
   "dkim", "domainkeys", "senderid" and "spf" respectively are hereby
   defined for MTAs applying those specifications for e-mail sender
   authentication.  See Section 6 for details.

2.6.  Extension Fields

   Additional authentication method identifiers may be defined in the
   future by later revisions or extensions to this specification.
   Extension identifiers beginning with "x-" will never be defined as
   standard fields; such names are reserved for experimental use.
   Method identifiers NOT beginning with "x-" MUST be registered with
   the Internet Assigned Numbers Authority (IANA) and published in an
   RFC.  See Section 6 for further details.

   Extension identifiers may be defined for the following reasons:

   1.  To allow additional information from emergent authentication
       systems to be communicated to MUAs.  The names of such
       identifiers should reflect the name of the method being defined,
       but should not be needlessly long.

   2.  To allow the creation of "sub-identifiers" which indicate
       different levels of authentication and differentiate between
       their relative strengths, e.g. "auth1-weak" and "auth1-strong".

   Authentication method implementors are encouraged to provide adequate
   information, via [MAIL] comments if necessary, to allow an MUA
   developer to understand or relay ancilliary details of authentication
   results.  For example, if it might be of interest to relay what data
   was used to perform an evaluation, such information could be relayed
   as a comment in the header field, such as:

        Authentication-Results: mx.example.com;
                  foo=pass bar.baz=blob (2 of 3 tests OK)
















Kucherawy               Expires January 27, 2008               [Page 10]

Internet-Draft        Authentication-Results Header            July 2007


3.  Adding The Header To A Message

   This specification makes no attempt to evaluate the relative
   strengths of various sender authentication methods that may become
   available.  As such, the order of the presented authentication
   methods and results MUST NOT be used to determine the importance or
   strength of any given method over another.  Instead, the MUA must
   interpret the result of each method based on its knowledge of what
   that method evaluates.

   The "method" MUST refer to an authentication method declared in the
   IANA registry.  See Section 6 for further information.

   An MTA compliant with this specification MUST add this header field
   (after performing one or more sender authentication tests) to
   indicate at which host the test was done, which test got applied and
   what the result was.  If an MTA applies more than one such test, it
   MUST either add this header field once per test, or one header field
   indicating all of the results.  An MTA MUST NOT add a result to an
   existing header.

   For security reasons, a border MTA conforming to this specification
   MUST delete any discovered instance of this header field which claims
   to have been added within its trust boundary.  For example, a border
   MTA for example.com receiving a message from outside of its mail
   domain MUST delete any instance of this header field bearing an
   authentication identifier indicating the header field was added
   within example.com prior to adding its own header fields.  However,
   care must be taken not to remove header fields added on messages that
   remain entirely within the originator's trust boundary (e.g. local-
   to-local mail).

   A "border MTA" in this discussion is considered to be the first MTA
   which is listed as a mail exchanger (MX) for the recipient domain.

   An MTA MAY add this header field containing only the authentication
   identifier portion to indicate explicitly that no sender
   authentication schemes were applied prior to delivery of this
   message.

3.1.  Header Position and Interpretation

   In order to ensure non-ambiguous results and avoid the impact of
   false header fields, an MUA SHOULD NOT interpret this header field
   unless specifically instructed to do so by the user.  That is, this
   interpretation should not be "on by default".  Naturally then, users
   would not activate such a feature unless they are certain the header
   field will be added by the receiving MTA that accepts the mail that



Kucherawy               Expires January 27, 2008               [Page 11]

Internet-Draft        Authentication-Results Header            July 2007


   is ultimately read by the MUA, and instances of the header field
   appearing to be from within the trust domain but actually added by
   foreign MTAs will be removed before delivery.

   Furthermore, an MUA SHOULD NOT interpret this header field unless the
   hostname it bears appears to be one within its own trust domain as
   configured by the user.

   An MUA should not reveal these results to naive end users unless the
   results are accompanied by, at a minimum, some associated reputation
   data about the sender that was authenticated.

   As stated in Section 2.1, this header field SHOULD be treated as
   though it were a trace header field as defined in section 3.6 of
   [MAIL], and hence MUST not be reordered and MUST be prepended to the
   message, so that there is generally some indication upon delivery of
   where in the chain of handling MTAs the sender authentcation was
   done.

   Further discussion of this can be found in the Security
   Considerations section below.






























Kucherawy               Expires January 27, 2008               [Page 12]

Internet-Draft        Authentication-Results Header            July 2007


4.  Discussion

   This section discusses various implementation issues not specifically
   related to security.  Security issues are discussed in a later
   section.

4.1.  Removing The Header

   As specified in Section 3, instances of this header field added by
   outside MTAs that appear to come from inside an MTA's trust boundary
   must be removed.  In the case of messages signed using [DKIM] or
   other message signing methods that sign headers, this may invalidate
   one or more signature on the message if they included the header
   field to be removed at the time of signing.  This behaviour is
   desirable since there's no value in validating the signature on a
   message with forged headers.  However, signing agents MAY elect to
   omit these header fields from signing to avoid this situation.


































Kucherawy               Expires January 27, 2008               [Page 13]

Internet-Draft        Authentication-Results Header            July 2007


5.  Conformance and Usage Requirements

   An MTA or gateway conforms to this specification if it applies one or
   more sender authentication mechanisms and inserts a header field
   corresponding to this specification after doing so and prior to
   delivery.

   MTAs that are relaying mail rather than delivering it, i.e. are not
   part of an intended recipient's trust boundary, MAY perform sender
   authentication or even take actions based on the results found, but
   SHOULD NOT add an "Authentication-Results" header field if relaying
   (rather than rejecting or discarding at the gateway).  Conversely, an
   MTA doing local delivery and some form of sender authentication MUST
   add this header field prior to delivery the message in order to be
   compliant.

   A minimal implementation that does at least one sender authentication
   check will add the header field defined by this memo prior to
   invoking local delivery procedures.

   This specification places no restrictions on the processing of the
   header field's contents by user agents or distribution lists.  It is
   presented to those packages solely for their own information.




























Kucherawy               Expires January 27, 2008               [Page 14]

Internet-Draft        Authentication-Results Header            July 2007


6.  IANA Considerations

   This specification introduces some new namespaces that will be
   registered with IANA.  In all cases, new entries are assigned only
   for values that have been documented in a published RFC that has IETF
   Consensus, per [IANA-CONSIDERATIONS].

6.1.  The Authentication-Results: header

   Per [IANA-HEADERS], the "Authentication-Results:" header field is
   added to the IANA Permanent Message Header Field Registry.  The
   following is the registration template:

     Header field name: Authentication-Results
     Applicable protocol: mail ([RFC2822])
     Status: Standard
     Author/Change controller: IETF
     Specification document(s): [TBD]
     Related information:
       Requesting review of any proposed changes and additions to
       this field is recommended.

6.2.  Method Registry

   As stated above, names of sender authentication methods supported by
   this specification must be registered with IANA, with the exception
   of experimental names as described above.

   Each method must register a name, the specification that defines it,
   one or more "ptype" values appropriate for use with that method, and
   which "property" value(s) should be reported by that method.

   The initial set of entries in this registry is as follows:

   +------------+---------+--------+----------------------------------+
   |   Method   | defined | ptype  | property                         |
   +------------+---------+--------+----------------------------------+
   |    auth    | RFC2554 | smtp   | auth                             |
   +------------+---------+--------+----------------------------------+
   |    dkim    | RFC4871 | header | value of signature "i" tag       |
   +------------+---------+--------+----------------------------------+
   | domainkeys | RFC4870 | header | From or Sender                   |
   +------------+---------+--------+----------------------------------+
   |  senderid  | RFC4406 | header | name of header field used by PRA |
   |            |         | smtp   | from (envelope sender)           |
   +------------+---------+--------+----------------------------------+
   |     spf    | RFC4408 | smtp   | from                             |
   +------------+---------+--------+----------------------------------+



Kucherawy               Expires January 27, 2008               [Page 15]

Internet-Draft        Authentication-Results Header            July 2007


7.  Security Considerations

   The following security considerations apply when applying or
   processing the "Authentication-Results" header field:

7.1.  Non-conformant MTAs

   An MUA that accesses a mailbox whose mail is handled by a non-
   conformant MTA, and understands Authentication-Results header fields,
   could potentially make false conclusions based on forged header
   fields.  A malicious user or agent could forge a header field using
   the destination MX for a receiving domain as the hostname token in
   the value of the header, and with the rest of the value claim that
   the sender was properly authenticated.  The non-conformant MTA would
   fail to strip the forged header field, and the MUA could
   inappropriately trust it.

   It is for this reason an MUA SHOULD NOT have processing of the
   "Authentication-Results" header field enabled by default; instead it
   SHOULD be ignored, at least for the purposes of enacting filtering
   decisions, unless specifically enabled by the user after verifying
   that the MTA is compliant.  It is acceptable to have an MUA aware of
   this standard, but have an explicit list of hostnames whose
   "Authentication-Results" header fields are trustworthy; however, this
   list SHOULD initially be empty.

   Proposed alternate solutions to this problem are nascent.  Possibly
   the simplest is a digital signature on the header field that can be
   verified by a posted public key.  Another would be a means to
   interrogate the MTA that added the header field to see if it is
   actually providing any sender authentication services and saw the
   message in question, but this isn't especially palatable.  In either
   case, a method needs to exist to verify that the host that appears to
   have added the header field (a) actually did so, and (b) is
   legitimately adding that header field for this delivery.

7.2.  Header Position

   Despite the requirements of [MAIL], header fields can sometimes be
   reordered enroute by intermediate MTAs.  The goal of requiring header
   field addition only at the top of a message is an acknowledgement
   that some MTAs do reorder header fields, but most do not.  Thus, in
   the general case, there will be some indication of which MTAs (if
   any) handled the message after the addition of the header field
   defined here.






Kucherawy               Expires January 27, 2008               [Page 16]

Internet-Draft        Authentication-Results Header            July 2007


8.  References

8.1.  Normative References

   [MAIL]     Resnick, P., "Internet Message Format", RFC 2822,
              April 2001.

   [MIME]     Freed, N. and N. Borenstein, "Multipurpose Internet Mail
              Extensions (MIME) Part One: Format of Internet Message
              Bodies", RFC 2045, November 1996.

8.2.  Informative References

   [AUTH]     Myers, J., "SMTP Service Extension for Authentication",
              RFC 2554, March 1999.

   [DKIM]     Allman, E., Callas, J., Delany, M., Libbey, M., Fenton,
              J., and M. Thomas, "DomainKeys Identified Mail (DKIM)
              Signatures", RFC 4817, May 2007.

   [DOMAINKEYS]
              Delany, M., "Domain-based Email Authentication Using
              Public Keys Advertised in the DNS (DomainKeys)", RFC 4870,
              May 2007.

   [I-D.DRAFT-CROCKER-EMAIL-ARCH]
              Crocker, D., "Internet Mail Architecture",
              I-D draft-crocker-email-arch, May 2007.

   [IANA-CONSIDERATIONS]
              Alvestrand, H. and T. Narten, "Guidelines for Writing an
              IANA Considerations Section in RFCs", RFC 2434,
              October 1998.

   [IANA-HEADERS]
              Klyne, G., Nottingham, M., and J. Mogul, "Registration
              Procedures for Message Header Fields", RFC 2434,
              September 2004.

   [SENDERID]
              Lyon, J. and M. Wong, "Sender ID: Authenticating E-Mail",
              RFC 4406, April 2006.

   [SMTP]     Klensin, J., "Simple Mail Transfer Protocol", RFC 2821,
              April 2001.

   [SPF]      Wong, M. and W. Schlitt, "Sender Policy Framework (SPF)
              for Authorizing Use of Domains in E-Mail, Version 1",



Kucherawy               Expires January 27, 2008               [Page 17]

Internet-Draft        Authentication-Results Header            July 2007


              RFC 4408, April 2006.


















































Kucherawy               Expires January 27, 2008               [Page 18]

Internet-Draft        Authentication-Results Header            July 2007


Appendix A.  Acknowledgements

   The author wishes to acknowledge the following for their review and
   constructive criticism of this proposal: Eric Allman, Mark Delany,
   Jim Fenton, Tony Hansen, Paul Hoffman, John Levine, Miles Libbey, S.
   Moonesamy, Michael Thomas.













































Kucherawy               Expires January 27, 2008               [Page 19]

Internet-Draft        Authentication-Results Header            July 2007


Appendix B.  Legacy MUAs

   Implementors of this proposal should be aware that many MUAs are
   unlikely to be retrofit to support the new header field and its
   semantics.  In the interests of convenience and quicker adaptation, a
   delivery MTA might want to consider adding things that are processed
   by existing MUAs in addition to the Authentication-Results header
   field.  One suggestion is to include a Priority: header field, on
   messages that don't already have such a header field, containing a
   value that reflects the strength of the authentication that was
   accomplished, e.g. "low" for weak or no authentication, "normal" or
   "high" for good or strong authentication.

   Certainly some modern MUAs can filter based on the content of this
   header field, but as there is keen interest in having MUAs make some
   kind of graphical representation of this header field's meaning,
   other interim means of doing so may be necessary while this proposal
   is adopted.

































Kucherawy               Expires January 27, 2008               [Page 20]

Internet-Draft        Authentication-Results Header            July 2007


Appendix C.  Authentication-Results Examples

   This section presents some examples of the use of this header field
   to indicate authentication results.

C.1.  Trivial case; header field not present

   The trivial case:

        From: sender@example.com
        Received: from mail-router.example.com
                      (mail-router.example.com [1.2.3.4])
                  by server.sendmail.com (8.11.6/8.11.6)
                      with ESMTP id g1G0r1kA003489;
                  Fri, Feb 15 2002 17:19:07 -0800
        Date: Fri, Feb 15 2002 16:54:30 -0800
        To: receiver@sendmail.com
        Message-Id: <12345.abc@example.com>
        Subject: here's a sample

        Hello!  Goodbye!

   Example 1: Trivial case

   The "Authentication-Results" header field is completely absent.  The
   MUA may make no conclusion about the validity of the message.  This
   could be the case because the sender authentication services were not
   available at the time of delivery, or no service is provided, or the
   MTA is not in compliance with this specification.






















Kucherawy               Expires January 27, 2008               [Page 21]

Internet-Draft        Authentication-Results Header            July 2007


C.2.  Nearly-trivial case; service provided, but no authentication done

   A message that was delivered by an MTA that conforms to this standard
   but provides no actual sender authentication service:

        Authentication-Results: mail-router.example.com
        From: sender@example.com
        Received: from mail-router.example.com
                      (mail-router.example.com [1.2.3.4])
                  by server.sendmail.com (8.11.6/8.11.6)
                      with ESMTP id g1G0r1kA003489;
                  Fri, Feb 15 2002 17:19:07 -0800
        Date: Fri, Feb 15 2002 16:54:30 -0800
        To: receiver@sendmail.com
        Message-Id: <12345.abc@example.com>
        Subject: here's a sample

        Hello!  Goodbye!

   Example 2: Header present but no authentication done

   The "Authentication-Results" header field is present, indicating that
   the delivering MTA (which is named in the value of the header field)
   conforms to this specification.  The absence of any method and result
   tokens indicates that no sender authentication was done.

C.3.  Service provided, authentication done

   A message that was delivered by an MTA that conforms to this standard
   and applied some sender authentication:

        Authentication-Results: mail-router.example.com;
                  auth=pass (cram-md5) smtp.auth=sender@example.com
        From: sender@example.com
        Received: from dialup-1-2-3-4.example-isp.com
                      (dialup-1-2-3-4.example-isp.com [1.2.3.4])
                  by mail-router.example.com (8.11.6/8.11.6)
                      with ESMTP id g1G0r1kA003489;
                  Fri, Feb 15 2002 17:19:07 -0800
        Date: Fri, Feb 15 2002 16:54:30 -0800
        To: receiver@sendmail.com
        Message-Id: <12345.abc@example.com>
        Subject: here's a sample

        Hello!  Goodbye!

   Example 3: Header reporting results




Kucherawy               Expires January 27, 2008               [Page 22]

Internet-Draft        Authentication-Results Header            July 2007


   The "Authentication-Results" header field is present, indicating that
   the delivering MTA (which is identified in the value of the header
   field) conforms to this specification.  Furthermore, the sender
   authenticated herself/himself to the MTA via a method specified in
   [AUTH].  The actual method is identified in a header field comment
   after the method's result is indicated.  The MUA could extract and
   relay this extra information if desired.

C.4.  Service provided, several authentications done, single MTA

   A message that was relayed inbound via a single MTA that conforms to
   this specification and applied three different sender authentication
   checks:

        Authentication-Results: mail-router.example.com;
                  auth=pass (cram-md5) smtp.mail=sender@example.com;
                  spf=pass smtp.mail=sender@example.com
        Authentication-Results: mail-router.example.com;
                  sender-id=pass header.from=sender@example.com
        From: sender@example.com
        Received: from mail-router.example.com
                      (mail-router.example.com [1.2.3.4])
                  by dialup-1-2-3-4.example-isp.com (8.11.6/8.11.6)
                      with ESMTP id g1G0r1kA003489;
                  Fri, Feb 15 2002 17:19:07 -0800
        Date: Fri, Feb 15 2002 16:54:30 -0800
        To: receiver@sendmail.com
        Message-Id: <12345.abc@example.com>
        Subject: here's a sample

        Hello!  Goodbye!

   Example 4: Headers reporting results from one MTA

   The "Authentication-Results" header field is present, indicating the
   delivering MTA (which is identified in the value of the header field)
   conforms to this specification.  Furthermore, the sender
   authenticated herself/himself to the MTA via a method specified in
   [AUTH], and both [SPF] and [SENDERID] checks were done and passed.
   The MUA could extract and relay this extra information if desired.

   Two "Authentication-Results" header fields are not required since the
   same host did all of the checking.  The authenticating agent could
   have consolidated all the results into one header field.







Kucherawy               Expires January 27, 2008               [Page 23]

Internet-Draft        Authentication-Results Header            July 2007


C.5.  Service provided, several authentications done, different MTAs

   A message that was relayed inbound by two different MTAs that conform
   to this specification and applied multiple sender authentication
   checks:

        Authentication-Results: auth-checker.example.com;
                  sender-id=pass header.from=sender@example.com;
                  dkim=pass (good signature) header.i=sender@example.com
        Received: from mail-router.example.com
                      (mail-router.example.com [10.11.12.13])
                  by auth-checker.example.com (8.11.6/8.11.6)
                      with ESMTP id i7PK0sH7021929;
                  Fri, Feb 15 2002 17:19:22 -0800
        Authentication-Results: mail-router.example.com;
                  auth=pass (cram-md5) smtp.mail=sender@example.com;
                  spf=fail smtp.mail=sender@example.com
        Received: from dialup-1-2-3-4.example-isp.com
                      (dialup-1-2-3-4.example-isp.com [1.2.3.4])
                  by mail-router.example.com (8.11.6/8.11.6)
                      with ESMTP id g1G0r1kA003489;
                  Fri, Feb 15 2002 17:19:07 -0800
        DKIM-Signature: a=rsa-sha1; s=gatsby; d=example.com;
                  c=simple; q=dns;
                  b=EToRSuvUfQVP3Bkz ... rTB0t0gYnBVCM=
        From: sender@example.com
        Date: Fri, Feb 15 2002 16:54:30 -0800
        To: receiver@sendmail.com
        Message-Id: <12345.abc@example.com>
        Subject: here's a sample

        Hello!  Goodbye!

   Example 5: Headers reporting results from multiple MTAs

   The "Authentication-Results" header field is present, indicating
   conformance to this specification.  It is present twice because two
   different MTAs in the chain of delivery did authentication tests.
   The first, "mail-router.example.com" reports that [AUTH] and [SPF]
   were both used, and [AUTH] passed but [SPF] failed.  In the [AUTH]
   case, additional data is provided in the comment field, which the MUA
   can choose to render if desired.

   The second MTA, identifying itself as "auth-checker.example.com",
   reports that it did a [SENDERID] test and a [DKIM] test, both of
   which passed.  Again, additional data about one of the tests is
   provided as a comment, which the MUA may choose to render.




Kucherawy               Expires January 27, 2008               [Page 24]

Internet-Draft        Authentication-Results Header            July 2007


   Since different hosts did the two sets of authentication checks, the
   header fields cannot be consolidated in this example.

















































Kucherawy               Expires January 27, 2008               [Page 25]

Internet-Draft        Authentication-Results Header            July 2007


Appendix D.  Public Discussion

   [REMOVE BEFORE PUBLICATION]

   Public discussion of this proposed specification is handled via the
   mail-vet-discuss@mipassoc.org mailing list.  The list is open.
   Access to subscription forms and to list archives can be found at
   http://mipassoc.org/mailman/listinfo/mail-vet-discuss.











































Kucherawy               Expires January 27, 2008               [Page 26]

Internet-Draft        Authentication-Results Header            July 2007


Author's Address

   Murray S. Kucherawy
   Sendmail, Inc.
   6475 Christie Ave., Suite 350
   Emeryville, CA  94608
   US

   Phone: +1 510 594 5400
   Email: msk+ietf@sendmail.com









































Kucherawy               Expires January 27, 2008               [Page 27]

Internet-Draft        Authentication-Results Header            July 2007


Full Copyright Statement

   Copyright (C) The IETF Trust (2007).

   This document is subject to the rights, licenses and restrictions
   contained in BCP 78, and except as set forth therein, the authors
   retain all their rights.

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST AND
   THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS
   OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF
   THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.


Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in BCP 78 and BCP 79.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   http://www.ietf.org/ipr.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.


Acknowledgment

   Funding for the RFC Editor function is provided by the IETF
   Administrative Support Activity (IASA).





Kucherawy               Expires January 27, 2008               [Page 28]

