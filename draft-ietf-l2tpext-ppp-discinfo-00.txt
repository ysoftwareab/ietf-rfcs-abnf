



Network Working Group                                        Rohit Verma
Internet Draft                                       Deloitte Consulting
Expires November 2000                                       Madhvi Verma
                                                        3Com Corporation
                                                           James Carlson
                                                        Sun Microsystems
                                                                May 2000


                   L2TP Disconnect Cause Information
                <draft-ietf-l2tpext-ppp-discinfo-00.txt>

Status of this Memo

   This document is an Internet-Draft and is in full conformance with
   all provisions of Section 10 of RFC2026.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups.  Note that
   other groups may also distribute working documents as Internet-
   Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html.

Abstract

   The Layer 2 Tunneling Protocol (``L2TP'') defines a mechanism for
   tunneling PPP sessions.  The current RFC lacks a mechanism for the
   LNS to provide PPP related disconnect cause information to the LAC.
   This information, provided by the extension described in this
   document, can be useful for accounting and debugging purposes.


1.  Introduction

   L2TP [1] defines a general-purpose mechanism for tunneling PPP over
   various media.  By design, it insulates L2TP operation from the
   details of the PPP session that is being encapsulated by L2TP.  There
   are, however, cases where it may be desirable for PPP-specific



expires November 2000    Verma, Verma, Carlson                  [Page 1]

INTERNET DRAFT           L2TP Disconnect Cause                  May 2000


   disconnect information to be provided to an L2TP host (LAC/LNS) in a
   descriptive format. The lack of this information is especially a
   problem when the LAC and LNS are not managed by the same entities.

   The Result and Error Codes defined for L2TP specify only L2TP-
   specific disconnect information. This document provides an additional
   AVP that MAY be used by an L2TP host to provide PPP specific discon-
   nect information to its peer for accounting and debugging purposes.
   This AVP should be used in conjunction with, and not as a replacement
   for, the Result and Error Code AVPs.

   The PPP Disconnect Cause Code AVP can also be used to provide a
   human-readable disconnect reason to the user. The following AVP
   should not have any effect on either the functioning of the tunnel or
   the functioning of the PPP session.


2.  AVP


2.1.  PPP Disconnect Cause Code

   The AVP is valid in the CDN message only, and it MUST NOT be marked
   Mandatory.

   The PPP Disconnect Cause Code AVP is encoded as Vendor ID 43 (3Com
   Corporation), with an Attribute Type of PPP Disconnect Cause Code
   (46).  The attribute value is one of the values discussed in section
   2.1.1.  The length of the value field MUST be at least 11 octets.  If
   the length is more than 11 octets, the additional octets SHOULD con-
   tain a descriptive text in ASCII format that can be displayed to the
   user or in a log file.

      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |M|H| rsvd  |      Length       |           Vendor ID         |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |         Attribute Type        |       Disconnect Code       |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |  CP Number                    | Direction     | Message...  |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                Figure 1.1 PPP Disconnect Cause code AVP

   Mandatory (M) bit: MUST be 0.

   Hidden (H) bit: MAY be 1 if the attribute is hidden.



expires November 2000    Verma, Verma, Carlson                  [Page 2]

INTERNET DRAFT           L2TP Disconnect Cause                  May 2000


   Length: The length of the entire attribute in octets, expressed as a
   single octet.  MUST be at least 11.

   Vendor ID: A two octet value in network byte order; set to 43 (3Com
   Corporation).

   Attribute Type: A two octet value in network byte order; set to 46
   (PPP Disconnect Cause Code).

   Disconnect Code: A two octet value in network byte order.

   CP Number: Primary failing Control Protocol, if any.  This field may
   be 0 unless mentioned otherwise in the description of the Disconnect
   Cause Codes in section 2.1.1.

   Direction(D) Flag: A single octet value; specifies the direction in
   which the Disconnect code applies.

           The valid values of this field are:

                   0: global error
                   1: at peer
                   2: at local
                   3-255: Reserved

   This field may be 0 unless mentioned otherwise in the description of
   the Disconnect Cause Codes in section 2.1.1.


2.1.1.  Disconnect Cause Codes

   This section contains the list of well-known values of the Disconnect
   Code field in the PPP Disconnect Cause Code AVP. The IANA will main-
   tain a registry of the up-to-date values. These values should be used
   in conjunction with the Direction flag and the Control Protocol
   Number to get the specific error code.


2.1.1.1.  Global Errors

   The global error codes, given in the list below, are Disconnect Codes
   that do not relate to one particular control protocol. The CP Number
   for these errors MUST be set to 0 and the Direction (D) flag MUST
   also be set to 0 unless specified otherwise for a given code.

   0    No information available.

   1    Administrative disconnect.



expires November 2000    Verma, Verma, Carlson                  [Page 3]

INTERNET DRAFT           L2TP Disconnect Cause                  May 2000


   2    LCP renegotiation at LNS disabled; LNS expects proxy LCP
        information, LAC did not send it.

   3    Normal Disconnection, LCP Terminate-Request sent.

        Valid Direction flags:

           1: By peer
           2: By local

   4    Compulsory encryption required by a PPP peer was refused by the
        other.

        Valid Direction flags are:

           1: Required by local; refused by peer
           2: Required by peer; refused by local


2.1.1.2.  LCP Errors

   The LCP error codes, listed below, are disconnect reasons that are
   directly related to failure of PPP peers to negotiate mutually agree-
   able link parameters. The CP Number for such errors MUST be set to
   0xCO21 and the direction flag to the direction of the failure.

   5    FSM Timeout error.

   6    No recognizable LCP packets were received.

   7    LCP failure-Magic number error; link possibly looped back.

   8    LCP link failure-Echo Request timeout.

   9    Peer has unexpected Endpoint-Discriminator for existing MP
        bundle.

   10   Peer has unexpected MRRU for existing MP bundle.

   11   Peer has unexpected Short-Sequence-Number option for existing
        MP bundle.

   12   Compulsory callback required by a PPP peer was refused by the
        other.

        Valid Direction flags are:

           1: Required by local; refused by peer



expires November 2000    Verma, Verma, Carlson                  [Page 4]

INTERNET DRAFT           L2TP Disconnect Cause                  May 2000


           2: Required by peer; refused by local


2.1.1.3.  Authentication Errors

   The authentication errors codes, listed below, are disconnect reasons
   that are directly related to authentication failures between the PPP
   peers. The CP Number for such errors MUST correspond to the control
   protocol number for the authentication protocol in use and the direc-
   tion flag to the direction of the failure.

   13   FSM Timeout error.

   14   Peer has unexpected authenticated name for existing MP bundle.

   15   PPP authentication failure-Authentication protocol unacceptable.

        Valid Direction flags are:

           1: All local authentication protocols were rejected by the
              peer.

           2: All authentication protocols requested by peer were
              unacceptable or unimplemented locally.

   16   PPP authentication failure-Authentication failed (bad name,
        password, or secret).

        Valid Direction flags are:

           1: Authentication of peer identity by local system.
           2: Authentication of local identity by peer system.


2.1.1.4.  Network Control Protocol Errors

   NCP Errors are disconnect reasons that are directly related to the
   failure of PPP peers to negotiate a mutually agreeable set of parame-
   ters for the network protocols. The CP Number for such errors MUST
   correspond to the network control protocol number in use and the
   direction flag to the direction of the failure. Where multiple net-
   work protocols are in use, multiple copies of this AVP may be given
   to indicate failure reasons for each NCP.

   The Control Protocol field in the following cases will be the last or
   primary failing NCP.

   17   FSM Timeout error.



expires November 2000    Verma, Verma, Carlson                  [Page 5]

INTERNET DRAFT           L2TP Disconnect Cause                  May 2000


   18   No NCPs available (all disabled or rejected); no NCPs went to
        Opened state.

   19   NCP failure: failed to converge on acceptable addresses.

   20   NCP failure: user not permitted to use any addresses.


3.  Notes

   This AVP MAY always be sent by the LNS to the LAC. However, at the
   LAC, this AVP would be more useful diagnostically in the compulsory
   case than in the voluntary case. In a voluntary model, it can be
   presumed that local PPP traces are always present.


4.  IANA Considerations

   This AVP includes an enumerated cause code value.  Values 0 through
   20 are described in this document.  New values may be assigned by the
   IANA.


5.  References

      [1]   W. Townsley, A. Valencia, A. Rubens, G. Pall, G. Zorn,
            B. Palter, ``Layer 2 Tunnel Protocol (L2TP)'', RFC2661,
            August 1999.

6.  Acknowledgements

   The Authors would like to thank W. Mark Townsley for his useful com-
   ments to an earlier version of this document.


7.  Contacts


7.1.  L2TP Working Group Chair

   W. Mark Townsley
   Cisco Systems
   7025 Kit Creek Road
   PO Box 14987
   Research Triangle Park, NC 27709
   Email:  <townsley@cisco.com>





expires November 2000    Verma, Verma, Carlson                  [Page 6]

INTERNET DRAFT           L2TP Disconnect Cause                  May 2000


7.2.  Authors

   Rohit Verma
   180 N. Stetson Avenue
   Chicago IL 60601
   Phone: +1 312 374 2475
   Fax:   +1 312 870 2475
   Email:  <rverma@dc.com>

   Madhvi Verma
   1800 W. Central Road
   Mount Prospect IL 60056
   Phone: +1 847 797 6528
   Fax:   +1 847 222 2424
   Email:  <Madhvi_Verma@mw.3com.com>

   James Carlson
   Sun Microsystems
   1 Network Drive MS UBUR02-212
   Burlington MA  01803-2757
   Email:  <james.d.carlson@east.sun.com>
   Voice:  +1 781 442 2084
   Fax:    +1 781 442 1677



8.  Notices

   The IETF takes no position regarding the validity or scope of any
   intellectual property or other rights that might be claimed to per-
   tain to the implementation or use of the technology described in this
   document or the extent to which any license under such rights might
   or might not be available; neither does it represent that it has made
   any effort to identify any such rights.  Information on the IETF's
   procedures with respect to rights in standards-track and standards-
   related documentation can be found in BCP-11.  Copies of claims of
   rights made available for publication and any assurances of licenses
   to be made available, or the result of an attempt made to obtain a
   general license or permission for the use of such proprietary rights
   by implementers or users of this specification can be obtained from
   the IETF Secretariat.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights, which may cover technology that, may be required to practice
   this standard.  Please address the information to the IETF Executive
   Director.




expires November 2000    Verma, Verma, Carlson                  [Page 7]

INTERNET DRAFT           L2TP Disconnect Cause                  May 2000





















































expires November 2000    Verma, Verma, Carlson                  [Page 8]


