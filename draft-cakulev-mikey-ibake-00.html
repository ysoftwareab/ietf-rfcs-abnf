<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>MIKEY-IBAKE: Identity-Based Mode of Key Distribution
                 in Multimedia Internet KEYing (MIKEY)</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="MIKEY-IBAKE: Identity-Based Mode of Key Distribution
                 in Multimedia Internet KEYing (MIKEY)">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">V. Cakulev</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">G. Sundaram</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">Alcatel Lucent</td></tr>
<tr><td class="header">Expires: April 17, 2010</td><td class="header">October 14, 2009</td></tr>
</table></td></tr></table>
<h1><br />MIKEY-IBAKE: Identity-Based Mode of Key Distribution
                 in Multimedia Internet KEYing (MIKEY)<br />draft-cakulev-mikey-ibake-00.txt</h1>

<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.
This document may contain material from IETF Documents or IETF
Contributions published or made publicly available before November
10, 2008. The person(s) controlling the copyright in some of this
material may not have granted the IETF Trust the right to allow
modifications of such material outside the IETF Standards Process.
Without obtaining an adequate license from the person(s) controlling
the copyright in such materials, this document may not be modified
outside the IETF Standards Process, and derivative works of it may
not be created outside the IETF Standards Process, except to format
it for publication as an RFC or to translate it into languages other
than English.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on April 17, 2010.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2009 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents in effect on the date of
publication of this document (http://trustee.ietf.org/license-info).
Please review these documents carefully, as they describe your
rights and restrictions with respect to this document.</p>

<h3>Abstract</h3>

<p>
	    This document describes a key management protocol variant for the
   multimedia Internet keying (MIKEY) protocol which relies on
   trusted key management service. In particular, this variant utilizes
   Identity Based Authenticated Key Exchange framework which allows the
   participating clients to perform mutual authentication and derive a 
	    session key  in an 'asymmetric
   identity based encryption' framework. This framework, in addition to
   providing mutual authentication, eliminates the key escrow problem that 
	    is common in standard Identity Based Encryption while 
	    simultaneously providing  perfect forward and backwards secrecy.
	
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#anchor2">2.</a>&nbsp;
Requirements notation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">2.1.</a>&nbsp;
Definitions and Notation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">2.2.</a>&nbsp;
Abbreviations<br />
<a href="#usecases">3.</a>&nbsp;
Use Case Scenarios<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">3.1.</a>&nbsp;
Forking<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">3.2.</a>&nbsp;
Retargeting<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">3.3.</a>&nbsp;
Deferred Delivery<br />
<a href="#anchor8">4.</a>&nbsp;
MIKEY-IBAKE Protocol Description<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#overview">4.1.</a>&nbsp;
Overview<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">4.2.</a>&nbsp;
Message Exchanges and Processing<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">4.2.1.</a>&nbsp;
REQUEST_KEY_INIT/REQUEST_KEY_RESP Message Exchange<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor17">4.2.2.</a>&nbsp;
I_MESSAGE/R_MESSAGE Message Exchanges<br />
<a href="#anchor26">5.</a>&nbsp;
Key Derivation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#Ksess">5.1.</a>&nbsp;
Generating Keys from the Session Key<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#Kmikeymes">5.2.</a>&nbsp;
Generating Keys for MIKEY Messages<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor27">5.3.</a>&nbsp;
CSB Update<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor28">5.4.</a>&nbsp;
Generating MAC and Verification Message<br />
<a href="#anchor29">6.</a>&nbsp;
Payload Encoding<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor30">6.1.</a>&nbsp;
Common Header Payload (HDR)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#IBAKEpld">6.1.1.</a>&nbsp;
IBAKE Payload<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ESKpld">6.1.2.</a>&nbsp;
Encrypted Secret Key (ESK) Payload<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#KDpld">6.1.3.</a>&nbsp;
Key Data Sub-Payload<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ECDHpld">6.1.4.</a>&nbsp;
EC Diffie-Hellman Sub-Payload<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#SKpld">6.1.5.</a>&nbsp;
Secret Key Sub-Payload<br />
<a href="#anchor31">7.</a>&nbsp;
Security Considerations<br />
<a href="#anchor32">8.</a>&nbsp;
IANA Considerations<br />
<a href="#rfc.references1">9.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">9.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">9.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p> Multimedia Internet Keying (MIKEY) 
     <a class='info' href='#RFC3830'>[RFC3830]<span> (</span><span class='info'>Arkko, J., Carrara, E., Lindholm, F., Naslund, M., and K. Norrman, &ldquo;MIKEY: Multimedia Internet KEYing,&rdquo; August&nbsp;2004.</span><span>)</span></a> specification describes
     several modes of key distribution solution that address multimedia
     scenarios using pre-shared keys, public keys, and optionally a
     Diffie-Hellman key exchange. Following MIKEY specification, multiple 
     extensions of MIKEY have been specified.
</p>
<p>Recently, it has been noted that the currently defined MIKEY modes
     are insufficient to address deployment scenarios in which
     security systems serve a large number of users. In these scenarios, 
     a key management service is often preferred. With such a service in place, 
     it would be possible for a user to request credentials for any other 
     user when they are needed. Some proposed solutions rely on Key Management Services (KMS) in 
     the network that create, distribute, and manage keys in a real time. Due to this broad 
     functionality, key management services will have to be online, maintain high 
     availability, and have to be networked across operator boundaries.
     In some applications, this architecture creates a huge burden on 
     operators to install, and manage these boxes. Moreover, since the keys 
     are created and distributed by the KMS, these servers are de-facto 
     escrow points leading to increased vulnerability and operational discomfort 
     on the part of end-users. In fact, this feature is a violation 
     of the “end-to-end security” design goals in Section 2.2 of 
     <a class='info' href='#RFC3830'>[RFC3830]<span> (</span><span class='info'>Arkko, J., Carrara, E., Lindholm, F., Naslund, M., and K. Norrman, &ldquo;MIKEY: Multimedia Internet KEYing,&rdquo; August&nbsp;2004.</span><span>)</span></a>.
</p>
<p>Here, a solution is described in which KMS’s are offline servers that 
     communicate with end-user clients periodically (e.g., once a month) to 
     create a secure identity-based encryption framework, while the on-line 
     transactions between the end-user clients (for media plane security) are 
     based on an Identity Based Authenticated Key Exchange framework which 
     allows the participating clients to perform mutual authentication 
     and derive a session key in an 
     ‘asymmetric identity based encryption’ framework. This framework, in 
     addition to eliminating passive escrow, allows for end-user clients 
     to mutually authenticate each other (at the IMS media plane layer) and 
     provides perfect forwards and backwards secrecy. Observe that the KMS 
     to client exchange is used sparingly (e.g., once a month) – hence the 
     KMS is no longer required to be a high availability server, and in 
     particular different KMS’s don’t have to communicate with each other 
     (across operator boundaries). Moreover, given asymmetric identity-based 
     encryption framework is used, the need for costly Public Key 
     Infrastructure (PKI) and all the operational costs of certificate 
     management and revocation is eliminated. This is achieved by 
     concatenating public keys with a date field, thereby ensuring 
     corresponding private keys change with the date and more importantly 
     limiting the damage due to loss of a private key to just that date. 
     The granularity in the date field, is a matter of security policy 
     and deployment scenario. For instance, an operator may choose to use 
     one key per day and hence the KMS may issue private keys for a whole 
     month (more generally subscription cycle) at the beginning of a 
     subscription cycle.
</p>
<p>Additionally, various IMS 
     media plane features are securely supported – this includes secure 
     forking, retargeting, deferred delivery and pre-encoded content. 
	    
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Requirements notation</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL",
            "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY",
            and "OPTIONAL" in this document are to be interpreted as
            described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
Definitions and Notation</h3>

<p>IBE Encryption: Identity-based encryption (IBE) is a 
		public-key encryption technology
   that allows a public key to be calculated from an identity, and the
   corresponding private key to be calculated from the public key. 
	      IBE framework is defined in <a class='info' href='#RFC5091'>[RFC5091]<span> (</span><span class='info'>Boyen, X. and L. Martin, &ldquo;Identity-Based Cryptography Standard (IBCS) #1: Supersingular Curve Implementations of the BF and BB1 Cryptosystems,&rdquo; December&nbsp;2007.</span><span>)</span></a>, 
		<a class='info' href='#RFC5408'>[RFC5408]<span> (</span><span class='info'>Appenzeller, G., Martin, L., and M. Schertler, &ldquo;Identity-Based Encryption Architecture and Supporting Data Structures,&rdquo; January&nbsp;2009.</span><span>)</span></a> and <a class='info' href='#RFC5409'>[RFC5409]<span> (</span><span class='info'>Martin, L. and M. Schertler, &ldquo;Using the Boneh-Franklin and Boneh-Boyen Identity-Based Encryption Algorithms with the Cryptographic Message Syntax (CMS),&rdquo; January&nbsp;2009.</span><span>)</span></a>.
</p>
<p>(Media) session: The communication session intended to be 
		  secured by the MIKEY-IBAKE provided key(s).
</p>
<p>
            </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   E(k, x)  Encryption of x with the key k
   K_PUBx   Public Key of x
   [x]      x is optional
   {x}      Zero or more occurrences of x
   (x)      One or more occurrences of x
   ||       Concatenation
   |        OR (selection operator)
</pre></div><p>


</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
Abbreviations</h3>

<p></p>
<blockquote class="text"><dl>
<dt>EC</dt>
<dd> Elliptic Curve
</dd>
<dt>ESK:</dt>
<dd> Encrypted Secret Key
</dd>
<dt>IBE:</dt>
<dd> Identity Based Encryption
</dd>
<dt>I:</dt>
<dd> Initiator
</dd>
<dt>IBAKE:</dt>
<dd> Identity Based Authenticated Key 
		    Exchange
</dd>
<dt>IDi:</dt>
<dd> Initiator's Identity 
</dd>
<dt>IDr:</dt>
<dd> Responder's Identity 
</dd>
<dt>KMS:</dt>
<dd> Key Management Service
</dd>
<dt>K_PR:</dt>
<dd> Private Key
</dd>
<dt>K_PUB:</dt>
<dd> Public Key
</dd>
<dt>MAC:</dt>
<dd> Message Authentication Code
</dd>
<dt>MIKEY:</dt>
<dd> Multimedia Internet KEYing
</dd>
<dt>PKI:</dt>
<dd> Public Key Infrastructure
</dd>
<dt>R:</dt>
<dd> Responder
</dd>
<dt>SK:</dt>
<dd> Secret Key
</dd>
</dl></blockquote>

<a name="usecases"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Use Case Scenarios</h3>

<p>This section describes some of the use case scenarios supported by 
	    MIKEY-IBAKE.
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Forking</h3>

<p>Forking is the delivery of a request (e.g., SIP INVITE message) 
	      to multiple locations. This happens when a single user 
	      is registered more than once.  An example of forking is when a 
	      user has a desk phone, PC client, and mobile handset all 
	      registered with the same public identity.
</p>
<p>
            <br /><hr class="insert" />
<a name="forking"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      +---+             +-------+             +---+             +---+
      | A |             | PROXY |             | B |             | C |
      +---+             +-------+             +---+             +---+
            Request
        --------------------&gt;
                                   Request
			    --------------------&gt;
                                   Request
			    -------------------------------------&gt;
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: Forking&nbsp;</b></font><br /></td></tr></table><hr class="insert" />


</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Retargeting</h3>

<p>Retargeting is a scenario in which a functional element 
	      decides to redirect the call to a different 
	      destination. This decision to redirect a session may be made 
	      for different reasons by a number of different functional 
	      elements, and at different points in the establishment of 
	      the session.
</p>
<p>There are two basic scenarios of session redirection. 
	      In scenario one, a functional element (e.g., Proxy) decides 
	      to redirect the session by passing the new destination 
	      information to the originator. As a result the originator 
	      initiates a new session to the redirected destination provided 
	      by the Proxy. For the case of MIKEY-IBAKE this 
	      means that the originator will initiate a new session with the 
	      identity of the redirected destination. This scenario is 
	      depicted in <a class='info' href='#retargeting'>Figure&nbsp;2<span> (</span><span class='info'>Retargeting</span><span>)</span></a> below.
</p>
<p>
            <br /><hr class="insert" />
<a name="retargeting"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      +---+             +-------+             +---+             +---+
      | A |             | PROXY |             | B |             | C |
      +---+             +-------+             +---+             +---+
            Request
        --------------------&gt;
                                   Request
			    --------------------&gt;
                                   Redirect
			    &lt;--------------------
	    Redirect
        &lt;-------------------
                                   Request
        ----------------------------------------------------------&gt;
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;2: Retargeting&nbsp;</b></font><br /></td></tr></table><hr class="insert" />


</p>
<p>In the second scenario, a proxy decides to redirect the 
	      session without informing the originator. A common scenario in 
	      IMS applications is one in which the S-CSCF of the destination 
	      user determines that the session is to be redirected. 
	      The user profile information obtained from the HSS by 
	      the 'Cx-pull' during registration may contain complex 
	      logic and triggers causing session redirection.
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
Deferred Delivery</h3>

<p>Deferred delivery is a type of service such that the session 
	      content cannot be delivered to the destination at the time that 
	      it is being sent (e.g., the destination user is not currently 
	      online). Nevertheless, the sender expects the network to deliver 
	      the message as soon as the recipient becomes available. A 
	      typical example of deferred delivery is voicemail.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
MIKEY-IBAKE Protocol Description</h3>

<a name="overview"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Overview</h3>

<p>Most of the previously defined MIKEY modes consist of a single 
	      (or half) roundtrip between two peers.
	      MIKEY-IBAKE consists of up to three  
	      roundtrips. In the first roundtrip, users (Initiators and 
	      Responders) obtain their Private Key(s) (K_PR) from the KMS. This 
	      roundtrip can be performed at anytime, and as explained earlier 
	      takes place for example once a month (or once per subscription 
	      cycle). The second and the third 
	      roundtrip are between the Initiator and the Responder. Observe 
	      that the Key Management Service is only involved in the first 
	      roundtrip. In <a class='info' href='#example'>Figure&nbsp;3<span> (</span><span class='info'>Example Message Exchange</span><span>)</span></a>, a conceptual
	      signaling diagram for the MIKEY-IBAKE mode is depicted.
</p>
<p>
            <br /><hr class="insert" />
<a name="example"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   +---+             +------+         +------+                 +---+
   | I |             | KMS1 |         | KMS2 |                 | R |
   +---+             +------+         +------+                 +---+
       REQUEST_KEY_INIT                       REQUEST_KEY_INIT
     ------------------&gt;                  &lt;----------------------
       REQUEST_KEY_RESP                       REQUEST_KEY_RESP
     &lt;------------------                  ----------------------&gt;
                               I_MESSAGE_1
     -----------------------------------------------------------&gt;
                               R_MESSAGE_1
     &lt;-----------------------------------------------------------
                               I_MESSAGE_2
     -----------------------------------------------------------&gt;
                               R_MESSAGE_2
     &lt;-----------------------------------------------------------

</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;3: Example Message Exchange&nbsp;</b></font><br /></td></tr></table><hr class="insert" />


</p>
<p>The Initiator (I) wants to establish a secure media session with the
   Responder (R).  The Initiator and the Responder trust a third party, 
  the Key Management
   Services (KMS), with which they both have, or can establish, shared
   credentials.  Rather than a single KMS, several different KMSs may be
   involved, e.g. one for the Initiator and one for the Responder as shown 
  in <a class='info' href='#example'>Figure&nbsp;3<span> (</span><span class='info'>Example Message Exchange</span><span>)</span></a> above. The Initiator and the Responder 
  do not share any 
 credentials, however the Initiator knows Responder's public identity.
</p>
<p>The Initiator obtains Private Key(s) 
   from the KMS by sending a REQUEST_KEY_INIT message.  The REQUEST_KEY_INIT
   message includes Initiator's public identity(s) (if the Initiator has 
   more than one public identity it may request an Private Key for 
  every identity registered) and is protected via a MAC based on a 
  pre-shared key or
   via a signature (similar to the MIKEY-PSK and MIKEY-RSA modes).  If
   the Initiator is authorized to make the request, the KMS generates
   the requested keys, encodes them, and returns them 
   in a REQUEST_KEY_RESP message. The KMS can also select a set of IBE 
     public parameters to use in the
         subsequent steps in accordance with its local security
         policy and include them in the same message. 
     This exchange takes place periodically and 
     does not need to be performed every time an Initiator needs to 
     establish a secure connection with a Responder.
</p>
<p> The Initiator next chooses a random x and computes xP (i.e. adds P to 
itself x times), where P is a point on elliptic curve E known to all users. 
The Initiator uses the Responder's public identity to generate Responder's 
public key (e.g., K_PUBr=H1(IDr)||date), where Hi is hash function known to all 
     users, and the granularity in date is a matter of security policy and 
     known publicly). 
The Initiator then uses this generated public key to encrypt xP, IDi and IDr and includes 
this encrypted information in a I_MESSAGE_1 message,
   which is sent to the Responder. The encryption is Identity Based Encryption 
(IBE) as specified in <a class='info' href='#RFC5091'>[RFC5091]<span> (</span><span class='info'>Boyen, X. and L. Martin, &ldquo;Identity-Based Cryptography Standard (IBCS) #1: Supersingular Curve Implementations of the BF and BB1 Cryptosystems,&rdquo; December&nbsp;2007.</span><span>)</span></a> and <a class='info' href='#RFC5408'>[RFC5408]<span> (</span><span class='info'>Appenzeller, G., Martin, L., and M. Schertler, &ldquo;Identity-Based Encryption Architecture and Supporting Data Structures,&rdquo; January&nbsp;2009.</span><span>)</span></a>. 
The Responder in turn IBE-decrypts the received  message using its private key for that date, chooses 
random y and 
computes 
yP. Next, the Responder uses Initiator's public identity to generate 
Initiator's public key (e.g., K_PUBi=H1(IDi)||date) and IBE-encrypts (IDi, IDr, xP, yP) 
     using K_PUBi, 
and includes it in R_MESSAGE_1 message sent to the Initiator. At 
this point the Responder is able to generate the session key as 
xyP. This session key is then used to generate TGK as specified in 
 <a class='info' href='#Ksess'>Section&nbsp;5.1<span> (</span><span class='info'>Generating Keys from the Session Key</span><span>)</span></a>.
</p>
<p> The Initiator upon receiving and IBE-decrypting R_MESSAGE_1 message 
sends I_MESSAGE_2 message to the Responder, including IBE-encrypted IDi, IDr  
      and yP. At 
this point the Initiator is able to generate the same session key  
      as xyP. The Responder sends a R_MESSAGE_2 message 
      to the Initiator as verification. 
</p>
<p>  The above described is the most typical use case; in
  <a class='info' href='#usecases'>Section&nbsp;3<span> (</span><span class='info'>Use Case Scenarios</span><span>)</span></a>, some alternative use cases are discussed. 
</p>
<p>MIKEY-IBAKE is based on <a class='info' href='#RFC3830'>[RFC3830]<span> (</span><span class='info'>Arkko, J., Carrara, E., Lindholm, F., Naslund, M., and K. Norrman, &ldquo;MIKEY: Multimedia Internet KEYing,&rdquo; August&nbsp;2004.</span><span>)</span></a>, therefore the same terminology,
   processing and considerations still apply unless otherwise stated.
   Diffie-Hellman values and keys exchanged in I_MESSAGE/R_MESSAGE are IBE 
  encrypted as specified in <a class='info' href='#RFC5091'>[RFC5091]<span> (</span><span class='info'>Boyen, X. and L. Martin, &ldquo;Identity-Based Cryptography Standard (IBCS) #1: Supersingular Curve Implementations of the BF and BB1 Cryptosystems,&rdquo; December&nbsp;2007.</span><span>)</span></a> and 
  <a class='info' href='#RFC5408'>[RFC5408]<span> (</span><span class='info'>Appenzeller, G., Martin, L., and M. Schertler, &ldquo;Identity-Based Encryption Architecture and Supporting Data Structures,&rdquo; January&nbsp;2009.</span><span>)</span></a>, while the keys exchanged 
  in KEY_REQUES_INIT/KEY_REQUEST_RESPONSE are encrypted as specified in 
   <a class='info' href='#RFC3830'>[RFC3830]<span> (</span><span class='info'>Arkko, J., Carrara, E., Lindholm, F., Naslund, M., and K. Norrman, &ldquo;MIKEY: Multimedia Internet KEYing,&rdquo; August&nbsp;2004.</span><span>)</span></a>.  In all exchanges encryption is only applied to the keys and 
  key components and
   not to the entire messages.
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Message Exchanges and Processing</h3>

<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.1"></a><h3>4.2.1.&nbsp;
REQUEST_KEY_INIT/REQUEST_KEY_RESP Message Exchange</h3>

<p>This exchange is used by a user (e.g. Initiator or Responder) to 
     request private keys from a trusted Key Management Service, with which the 
     user have pre-shared credentials.  A full roundtrip is
   required for a user to receive keys.  As
   this message must ensure the identity of the Initiator to the KMS, it
   is protected via a MAC based on a pre-shared key or via a signature.
   The initiation message REQUEST_KEY_INIT comes in two variants
   corresponding to the pre-shared key (PSK) and public-key encryption
   (PKE) methods of <a class='info' href='#RFC3830'>[RFC3830]<span> (</span><span class='info'>Arkko, J., Carrara, E., Lindholm, F., Naslund, M., and K. Norrman, &ldquo;MIKEY: Multimedia Internet KEYing,&rdquo; August&nbsp;2004.</span><span>)</span></a>.  The response message 
     REQUEST_KEY_RESP is the
   same for the two variants and SHALL be protected by using the pre-
   shared/envelope key indicated in the REQUEST_KEY_INIT message.
</p>
<p>
            </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   Initiator/Responder                    KMS

   REQUEST_KEY_INIT_PSK =          ----&gt;
   HDR, T, RAND, (IDi/r),
   IDkms, [IDpsk], [KEMAC], V      &lt;----  REQUEST_KEY_RESP =
				              HDR, T, [IDi/r], [IDkms],
				              KEMAC, V


   REQUEST_KEY_INIT_PKE =          ----&gt;
   HDR, T, RAND, (IDi/r),
      {CERTi/r}, IDkms,            &lt;----  REQUEST_KEY_RESP =
      [KEMAC], [CHASH],                       HDR, T, [IDi/r], [IDkms],
      PKE, SIGNi/r, V                         KEMAC, V
</pre></div><p>


</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.1.1"></a><h3>4.2.1.1.&nbsp;
Components of the REQUEST_KEY_INIT Message</h3>

<p>The main objective of the REQUEST_KEY_INIT message is for a user to
       request one or more Private Keys (K_PR) from the KMS. The user may 
       request
       a K_PR for each public identity it possesses. 
</p>
<p>The REQUEST_KEY_INIT message MUST always include the Header (HDR),
       Timestamp (T), and RAND payloads. The user SHALL select a random CSB ID 
       (Crypto Session Bundle ID) and include it in the CSB ID field of the 
       Header. The user SHALL
       set the #CS field to '0' since CS (Crypto Session(s))
       SHALL NOT be handled. The CS ID map
       type SHALL be the "Empty map" as defined in  <a class='info' href='#RFC4563'>[RFC4563]<span> (</span><span class='info'>Carrara, E., Lehtovirta, V., and K. Norrman, &ldquo;The Key ID Information Type for the General Extension Payload in Multimedia Internet KEYing (MIKEY),&rdquo; June&nbsp;2006.</span><span>)</span></a>.
     
</p>
<p>IDi/r contains the identity of the user. Since the user may 
       have multiple 
       identities, multiple IDi/r fields may appear in the message.
</p>
<p>IDkms SHALL be included.
</p>
<p>The KEMAC payload SHOULD be used only when the user needs to use
       specific keys. Otherwise, this payload SHALL not be used.
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.1.1.1"></a><h3>4.2.1.1.1.&nbsp;
Components of the REQUEST_KEY_INIT_PSK Message</h3>

<p>The IDpsk payload MAY be used to indicate the pre-shared key used.
</p>
<p>The last payload SHALL be a Verification payload (V) where the
	 authentication key (auth_key) is derived from the pre-shared key (see
	 <a class='info' href='#RFC3830'>[RFC3830]<span> (</span><span class='info'>Arkko, J., Carrara, E., Lindholm, F., Naslund, M., and K. Norrman, &ldquo;MIKEY: Multimedia Internet KEYing,&rdquo; August&nbsp;2004.</span><span>)</span></a> Section 4.1.4 for key derivation 
	       specification).
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.1.1.2"></a><h3>4.2.1.1.2.&nbsp;
Components of the REQUEST_KEY_INIT_PKE Message</h3>

<p>CERTi SHOULD may be included.  If a certificate chain is to be
   provided, each certificate in the chain MUST be included in a
   separate CERT payload.
</p>
<p>PKE payload contains the encrypted envelope key: 
     PKE = E(PKkms, env_key).  It
   is encrypted using the KMS's public key (PKkms).  If the KMS
   possesses several public keys, the user can indicate the key
   used in the CHASH payload.
</p>
<p>SIGNi/r is a signature covering the entire MIKEY message, using the
   Initiator's signature key.
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.1.2"></a><h3>4.2.1.2.&nbsp;
Processing of the REQUEST_KEY_INIT Message</h3>

<p>If the KMS can correctly parse the received message, and the
	 user is authorized to receive the requested Private Key(s),
	 the KMS MUST send a REQUEST_KEY_RESP
   message.  In case of a REQUEST_KEY_INIT_PKE message, the KMS MUST ensure
   that the IDcert is equal to the identity specified in the
   certificate.
</p>
<p>If the KMS cannot correctly parse the received message, or the
   user is not authorized to receive the requested Private Keys, the KMS
   SHOULD send an appropriate Error message.
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.1.3"></a><h3>4.2.1.3.&nbsp;
Components of the REQUEST_KEY_RESP Message</h3>

<p>The Header payload SHOULD be identical to the Header payload in the
       REQUEST_KEY_INIT message with the exception of data type, next payload,
       and V flag.  The V flag can be set to anything as it has no meaning
       in this context.
</p>
<p>The timestamp type and value SHALL be identical to the one used in
       the REQUEST_KEY_INIT message.
</p>
<p>
            </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
                   KEMAC = E(encr_key, {ID || K_PR})
</pre></div><p>


</p>
<p>The KEMAC payload SHOULD use the NULL authentication algorithm, as a
      MAC is included in the V payload.  Depending on the type of
      REQUEST_KEY_INIT message, either the pre-shared key or the envelope key
      SHALL be used to derive the encr_key.
</p>
<p>The last payload SHALL be a Verification payload (V).  Depending on
   the type of REQUEST_KEY_INIT message, either the pre-shared key or the
   envelope key SHALL be used to derive the auth_key.
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.1.4"></a><h3>4.2.1.4.&nbsp;
Processing of the REQUEST_KEY_RESP Message</h3>

<p>If the Initiator/Responder can correctly parse the received message, 
	 the received session information SHOULD be stored.  Otherwise
	 the Initiator/Responder SHOULD silently discard the message and 
	 abort the protocol.
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.2"></a><h3>4.2.2.&nbsp;
I_MESSAGE/R_MESSAGE Message Exchanges</h3>

<p>This exchange is used for Initiator and Responder to mutually 
	  authenticate each other and to exchange ECC Diffie-Hellman values 
	  used to generate TGK. These exchanges are
	  modeled after the pre-shared key mode , with the exception 
	  that the Elliptic Curve Diffie-Hellman values and Secret Keys (SKs) 
	  are encoded 
	  in IBAKE and ESK payloads instead of a KEMAC payload.   
	  Two full roundtrips are required for 
	  this exchange to successfully complete. The messages are preferably 
	  included in the session setup signaling (e.g. SIP INVITE).
</p>
<p>
            </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
Initiator                               Responder

   I_MESSAGE_1 =                    ----&gt;
   HDR, T, RAND, IDi, IDr,
      IBAKE, [ESK], V               &lt;----  R_MESSAGE_1 =
                                             HDR, T, IDi,
                                             IDr, IBAKE, V

   I_MESSAGE_2 =                    ----&gt;
   HDR, T, RAND, IDi, IDr,
      IBAKE, [ESK], V               &lt;----  R_MESSAGE_2 =
                                           HDR, T, [IDi], [IDr],
                                           [IBAKE], V

</pre></div><p>


</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.2.1"></a><h3>4.2.2.1.&nbsp;
Components of the I_MESSAGE_1 Message</h3>

<p>The I_MESSAGE_1 message MUST always include the Header (HDR),
	  Timestamp (T), and RAND payloads.  The CSB ID (Crypto Session 
	  Bundle ID) SHALL be randomly selected by the Initiator.  As the
	  R_MESSAGE_1 message is mandatory, the Initiator indicates with 
	  the V flag that a verification message is expected.
</p>
<p>The IDi and IDr payloads SHALL be included.
</p>
<p>The IBAKE payload 
	  contains Initiator's Identity and EC Diffie-Hellman values (ECCPTi), 
	  and 
	  Responder's Identity all encrypted using Responder's 
	  public key 
	  (i.e. encr_key = K_PUBr) as follows:
</p>
<p>
            </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
                   IBAKE = E(encr_key, IDi || ECCPTi || IDr)
</pre></div><p>


</p>
<p>Optionally, Encrypted Secret Key (ESK) payload MAY be included.  
	  If included, ESK contains an identity and a Secret Key (SK) 
	  encrypted using intended Responder's Public Key (i.e. encr_key = K_PUBr).
</p>
<p>
            </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
                   ESK = E(encr_key, ID || SK)
</pre></div><p>


</p>
<p>The last payload SHALL be a Verification payload (V) where the
	  authentication key (auth_key) is derived as specified in 
	  <a class='info' href='#Kmikeymes'>Section&nbsp;5.2<span> (</span><span class='info'>Generating Keys for MIKEY Messages</span><span>)</span></a>.
</p>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.2.2"></a><h3>4.2.2.2.&nbsp;
Processing of the I_MESSAGE_1 Message</h3>

<p>The parsing of I_MESSAGE_1 message SHALL be done as in 
	  <a class='info' href='#RFC3830'>[RFC3830]<span> (</span><span class='info'>Arkko, J., Carrara, E., Lindholm, F., Naslund, M., and K. Norrman, &ldquo;MIKEY: Multimedia Internet KEYing,&rdquo; August&nbsp;2004.</span><span>)</span></a>. If the received message is correctly 
	  parsed, the Responder shall use the Private Key (K_PRr) 
	  corresponding to the 
	  received IDr to decrypt the IBAKE payload. If the message contains 
	  encrypted 
	  ESK payload, the Responder SHALL decrypt the SK and use it to decrypt 
	  the received IBAKE payload. Otherwise, if the Responder is not able 
	  to 
	  decrypt the IBAKE payload, 
	  the Responder SHALL indicate it to the Initiator 
	  by including only its own EC Diffie-Hellman value (ECCPTr) in the 
	  next message it sends to the 
	  Initiator.
</p>
<p>If the received message cannot be 
	  correctly parsed, the Responder SHOULD silently discard the 
	  message and abort the protocol.
</p>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.2.3"></a><h3>4.2.2.3.&nbsp;
Components of the R_MESSAGE_1 Message</h3>

<p>The Header payload SHOULD be identical to the Header payload in the
	  I_MESSAGE_1 message with the exception that the V flag can be set
	  to anything as it has no meaning in this context.
</p>
<p>The timestamp type and value SHALL be identical to the one used in
	  the I_MESSAGE_1 message.
</p>
<p>The IDi and IDr payloads SHALL be included.
</p>
<p>The Responder's IBAKE payload
	  contains the Initiator’s EC Diffie-Hellman value (ECCPTi) 
	  received in I_MESSAGE_1 (if successfully 
	  decrypted), and Initiator’s EC Diffie-Hellman value generated by 
	  Responder (ECCPTr), as well as corresponding Initiator and 
	  Responder's 
	  identities. If the responder is unable to decrypt the IBAKE payload received in I_MESSAGE_1, the Responder SHALL include only its own  EC Diffie-Hellman value (ECCPTr). The IBAKE payload in R_MESSAGE_1 is encrypted using Initiator's public key 
	  (i.e. encr_key = P_PUBi) as follows:
</p>
<p>
            </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
        IBAKE = E(encr_key, IDi || {ECCPTi} || IDr || ECCPTr)
</pre></div><p>


</p>
<p>The last payload SHALL be a Verification payload (V) where the
	  authentication key (auth_key) is derived as specified in 
	  <a class='info' href='#Kmikeymes'>Section&nbsp;5.2<span> (</span><span class='info'>Generating Keys for MIKEY Messages</span><span>)</span></a>.
</p>
<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.2.4"></a><h3>4.2.2.4.&nbsp;
Processing of the R_MESSAGE_1 Message</h3>

<p>The parsing of R_MESSAGE_1 message SHALL be done as in 
	  <a class='info' href='#RFC3830'>[RFC3830]<span> (</span><span class='info'>Arkko, J., Carrara, E., Lindholm, F., Naslund, M., and K. Norrman, &ldquo;MIKEY: Multimedia Internet KEYing,&rdquo; August&nbsp;2004.</span><span>)</span></a>. If the received message is correctly 
	  parsed, the Initiator shall use the Private Key corresponding to the 
	  received IDi to decrypt the IBAKE payload. If the ECCPTi sent in 
	  I_MESSAGE_1 is not 
	  present in the received IBAKE payload (e.g., the Responder is 
	  currently 
	  offline and the R_MESSAGE_1 is received from Responder's mailbox), 
	  it SHALL be included again in the next message, I_MESSAGE_2. 
	  In this case I_MESSAGE_2  
	  SHALL also contain a ESK payload encrypted using Responder's 
	  K_PUB.
</p>
<p>If the received message cannot be 
	  correctly parsed, the Initiator SHOULD silently discard the 
	  message and abort the protocol.
</p>
<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.2.5"></a><h3>4.2.2.5.&nbsp;
Components of the I_MESSAGE_2 Message</h3>

<p>The I_MESSAGE_2 message MUST always include the Header (HDR),
	  Timestamp (T), and RANDi payloads.  The CSB ID (Crypto Session 
	  Bundle ID) and RAND payloads SHALL be the same is in the corresponding I_MESSAGE_1.  
	  As the R_MESSAGE_2 message is mandatory, the Initiator indicates with 
	  the V flag that a verification message is expected.
</p>
<p>The IDi and IDr payloads SHALL be included. The IDr payload SHALL 
	  be the same as the IDr payload received in the R_MESSAGE_1.
</p>
<p>The Initiator's IBAKE payload SHALL
	  contain Initiator's EC Diffie-Hellman value (ECCPTi) is the ECCPTi was not received in R_MESSAGE_1. Otherwise ECCPTi SHALL NOT be included. The IBAKE payload in I_MESSAGE_2 SHALL contain  
	  the Initiator's and Responder's identities as well as Responder's EC Diffie-Hellman value received in message R_MESSAGE_1. IBAKE payload SHALL be 
	  encrypted using Responder's 
	  public key (i.e. encr_key = K_PUBr) as follows:
</p>
<p>
            </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
          IBAKE = E(encr_key, IDi || {ECCPTi} || IDr || ECCPTr)
</pre></div><p>


</p>
<p>Optionally, Encrypted Secret Key (ESK) payload can be included. 
  ESK SHALL be included in case of deferred delivery.
	  If included, it contains an identity and Initiator generated
  Secret Key (SK) 
	  encrypted using intended recipient Public Key (PK) 
	  (i.e. encr_key = P_PUB) as follows:
</p>
<p>
            </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
                   ESK = E(encr_key, ID || SK)
</pre></div><p>


</p>
<p>The last payload SHALL be a Verification payload (V) where the
	  authentication key (auth_key) is derived as specified in 
	   <a class='info' href='#Kmikeymes'>Section&nbsp;5.2<span> (</span><span class='info'>Generating Keys for MIKEY Messages</span><span>)</span></a>.
</p>
<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.2.6"></a><h3>4.2.2.6.&nbsp;
Processing of the I_MESSAGE_2 Message</h3>

<p>The parsing of I_MESSAGE_2 message SHALL be done as in 
	  <a class='info' href='#RFC3830'>[RFC3830]<span> (</span><span class='info'>Arkko, J., Carrara, E., Lindholm, F., Naslund, M., and K. Norrman, &ldquo;MIKEY: Multimedia Internet KEYing,&rdquo; August&nbsp;2004.</span><span>)</span></a>. If the received message is correctly 
	  parsed, the Responder shall use the K_PRr corresponding to the 
	  received IDr to decrypt the IBAKE payload. If ESK is received, 
	  the responder 
	  SHALL store it for the future use.
</p>
<p>If the received message cannot be 
	  correctly parsed, the Responder SHOULD silently discard the 
	  message and abort the protocol.
</p>
<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.2.7"></a><h3>4.2.2.7.&nbsp;
Components of the R_MESSAGE_2 Message</h3>

<p>The Header payload SHOULD be identical to the Header payload in the
	  I_MESSAGE_2 message with the exception that the V flag can be set
	  to anything as it has no meaning in this context.
</p>
<p>The timestamp type and value SHALL be identical to the one used in
	  the I_MESSAGE_2 message.
</p>
<p>The IDi and IDr payloads SHOULD be included.
</p>
<p>Optionally, the Responder's IBAKE  
	  payload MAY be included. The IBAKE payload is included in the case of 
	  deferred delivery. If included, it contains
	  Initiator's EC Diffie-Hellman value (ECCPTi), 
	  and the Initiator's identity, 
	  encrypted using Initiator's 
	  public key (i.e. encr_key = K_PUBi) as follows:
</p>
<p>
            </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
                 IBAKE = E(encr_key, IDi || ECCPTi)
</pre></div><p>


</p>
<p>The last payload SHALL be a Verification payload (V) where the
	  authentication key (auth_key) is derived as specified in
	  <a class='info' href='#Kmikeymes'>Section&nbsp;5.2<span> (</span><span class='info'>Generating Keys for MIKEY Messages</span><span>)</span></a>.
</p>
<a name="anchor25"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.2.8"></a><h3>4.2.2.8.&nbsp;
Processing of the R_MESSAGE_2 Message</h3>

<p>The parsing of R_MESSAGE_2 message SHALL be done as in 
	  <a class='info' href='#RFC3830'>[RFC3830]<span> (</span><span class='info'>Arkko, J., Carrara, E., Lindholm, F., Naslund, M., and K. Norrman, &ldquo;MIKEY: Multimedia Internet KEYing,&rdquo; August&nbsp;2004.</span><span>)</span></a>. If the received message is correctly 
	  parsed, the Responder shall use the K_PRr corresponding to the 
	  received IDr to decrypt the IBAKE payload.
</p>
<p>If the received message cannot be 
	  correctly parsed, the Initiator SHOULD silently discard the 
	  message and abort the protocol.
</p>
<a name="anchor26"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Key Derivation</h3>

<p>The keys used in REQUEST_KEY_INIT/REQUEST_KEY_RESP 
	    exchange are derived from the pre-shared key or the envelope 
	    key as specified in <a class='info' href='#RFC3830'>[RFC3830]<span> (</span><span class='info'>Arkko, J., Carrara, E., Lindholm, F., Naslund, M., and K. Norrman, &ldquo;MIKEY: Multimedia Internet KEYing,&rdquo; August&nbsp;2004.</span><span>)</span></a>.  As crypto
   sessions are not handled in this exchange, further keying material (i.e TEKs)
   for this message exchanges SHALL NOT be derived.
</p>
<a name="Ksess"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Generating Keys from the Session Key</h3>

<p>As stated above, the session key xyP is generated using 
	      exchanged key components, where x and y are randomly chosen 
	      by Initiator and Responder. The session key as a point on an 
	      elliptic curve is then 
	      converted into octet string  as specified 
	      in <a class='info' href='#SEC1'>[SEC1]<span> (</span><span class='info'>Standards for Efficient Cryptography Group, &ldquo;Elliptic Curve Cryptography,&rdquo; September&nbsp;2000.</span><span>)</span></a>. This octet string is used as TGK. 
	      Finally, 
	      the keys (e.g., TEK) are generated
   from TGK as specified in <a class='info' href='#RFC3830'>[RFC3830]<span> (</span><span class='info'>Arkko, J., Carrara, E., Lindholm, F., Naslund, M., and K. Norrman, &ldquo;MIKEY: Multimedia Internet KEYing,&rdquo; August&nbsp;2004.</span><span>)</span></a>.


</p>
<a name="Kmikeymes"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Generating Keys for MIKEY Messages</h3>

<p> The keys for MIKEY messages are used to protect the MIKEY
   messages exchanged between the Initiator and Responder (i.e., I_MESSAGE 
	      and R_MESSAGE).  In the REQUEST_KEY_INIT/REQUEST_KEY_RESP 
	      exchange, the
   key derivation SHALL be done exactly as in <a class='info' href='#RFC3830'>[RFC3830]<span> (</span><span class='info'>Arkko, J., Carrara, E., Lindholm, F., Naslund, M., and K. Norrman, &ldquo;MIKEY: Multimedia Internet KEYing,&rdquo; August&nbsp;2004.</span><span>)</span></a>.
</p>
<p>The initiator and Responder SHALL convert their respective 
	       EC Diffie-Hellman values (i.e., ECCPTi and ECCPTr) to obtain 
	      the MIKEY 
	      Protection Key (MPK) and then use this MPK to derive keys to 
	      protect I_MESSAGE and R_MESSAGE messages.
</p>
<p>
            </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   inkey      : MPK
   inkey_len  : bit length of the MPK
   label      : constant || 0xFF || csb_id || RAND
   outkey_len : desired bit length of the output key
</pre></div><p>


</p>
<p>where the constants are as defined in <a class='info' href='#RFC3830'>[RFC3830]<span> (</span><span class='info'>Arkko, J., Carrara, E., Lindholm, F., Naslund, M., and K. Norrman, &ldquo;MIKEY: Multimedia Internet KEYing,&rdquo; August&nbsp;2004.</span><span>)</span></a>.  
     
</p>
<a name="anchor27"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3"></a><h3>5.3.&nbsp;
CSB Update</h3>

<p>Similar to <a class='info' href='#RFC3830'>[RFC3830]<span> (</span><span class='info'>Arkko, J., Carrara, E., Lindholm, F., Naslund, M., and K. Norrman, &ldquo;MIKEY: Multimedia Internet KEYing,&rdquo; August&nbsp;2004.</span><span>)</span></a>, MIKEY-IBAKE provides 
	      means for updating the
   CSB (Crypto Session Bundle), e.g. transporting new EC Diffe-Hellman values
	      or adding
   new crypto sessions.  The CSB updating is done by executing the
   exchange of I_MESSAGE_1/R_MESSAGE_1. The CSB updating MAY be started by
   either the Initiator or the Responder.
</p>
<p>
            </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   Initiator                               Responder

   I_MESSAGE_1 =                 ----&gt;
   HDR, T, [IDi], [IDr],
      [IBAKE], V                 &lt;----     R_MESSAGE_1 =
                                           HDR, T, [IDi], [IDr], V


   Responder                               Initiator

   I_MESSAGE_1 =                 ----&gt;
   HDR, T, [IDr], [IDi],
      [IBAKE], V                 &lt;----  R_MESSAGE_1 =
                                           HDR, T, [IDi], V
</pre></div><p>


</p>
<p>The new message exchange MUST use the same CSB ID as the initial
   exchange, but MUST use a new timestamp. Other 
   payloads that were provided in the initial exchange SHOULD NOT be
   included.  New RANDs MUST NOT be included in the message exchange
   (the RANDs will only have effect in the initial exchange).
</p>
<p>IBAKE payload with new EC Diffie-Hellman values SHOULD be included. 
     If new EC Diffie-Hellman values  are
     being exchanged during CSB updating, both messages SHALL be protected 
     with keys
   derived from EC Diffie-Hellman values exchanged as specified in 
     <a class='info' href='#Kmikeymes'>Section&nbsp;5.2<span> (</span><span class='info'>Generating Keys for MIKEY Messages</span><span>)</span></a>.
     Otherwise, if new EC Diffie-Hellman values are not being exchanged 
     during CSB update 
     exchange, both messages
   SHALL be protected with the keys that protected the I_MESSAGE/R_MESSAGE
   messages in the initial exchange.  

</p>
<a name="anchor28"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.4"></a><h3>5.4.&nbsp;
Generating MAC and Verification Message</h3>

<p>Authentication tag in all MIKEY-IBAKE  messages is generated 
	      as described in <a class='info' href='#RFC3830'>[RFC3830]<span> (</span><span class='info'>Arkko, J., Carrara, E., Lindholm, F., Naslund, M., and K. Norrman, &ldquo;MIKEY: Multimedia Internet KEYing,&rdquo; August&nbsp;2004.</span><span>)</span></a>. The MPK as described 
	      above is used to derive the auth_key. The MAC/Signature in the 
	      V/SIGN payloads covers the entire MIKEY
   message, except the MAC/Signature field itself.  The identities (not
   whole payloads) of the involved parties MUST directly follow the
   MIKEY message in the Verification MAC/Signature calculation.  Note
   that in the I_MESSAGE/R_MESSAGE exchange, ID_r in R_MESSAGE_1
   MAY not be the same as that appearing in I_MESSAGE_1.

</p>
<a name="anchor29"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Payload Encoding</h3>

<p>This section does not describe all the payloads that are used 
	    in the new message types.  It describes in detail the new IBAKE and
	    ESK
	    payloads and in less detail the payloads for which changes has 
	    been made compared to <a class='info' href='#RFC3830'>[RFC3830]<span> (</span><span class='info'>Arkko, J., Carrara, E., Lindholm, F., Naslund, M., and K. Norrman, &ldquo;MIKEY: Multimedia Internet KEYing,&rdquo; August&nbsp;2004.</span><span>)</span></a>. For a detailed 
	    description of 
	    the MIKEY payloads, see <a class='info' href='#RFC3830'>[RFC3830]<span> (</span><span class='info'>Arkko, J., Carrara, E., Lindholm, F., Naslund, M., and K. Norrman, &ldquo;MIKEY: Multimedia Internet KEYing,&rdquo; August&nbsp;2004.</span><span>)</span></a>.
</p>
<a name="anchor30"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
Common Header Payload (HDR)</h3>

<p>For the Common Header Payload, new values are added to the 
	      data type and the next payload name spaces.
</p>
<p>
	    </p>
<ul class="text">
<li>Data type (8 bits): describes the type of message.
</li>
</ul><p>

</p><br /><hr class="insert" />
<a name="DTtable"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="center"><col align="center"><col align="center">
<tr><th align="center">Data Type</th><th align="center">Value</th><th align="center">Comment</th></tr>
<tr>
<td align="center">REQUEST_KEY_PSK</td>
<td align="center">TBD1</td>
<td align="center">Secret Keys request message (PSK)</td>
</tr>
<tr>
<td align="center">REQUEST_KEY_PKE</td>
<td align="center">TBD2</td>
<td align="center">Secret Keys request message (PKE)</td>
</tr>
<tr>
<td align="center">REQUEST_KEY_RESP</td>
<td align="center">TBD3</td>
<td align="center">Secret Keys response message</td>
</tr>
<tr>
<td align="center">I_MESSAGE_1</td>
<td align="center">TBD4</td>
<td align="center">First Initiator's message</td>
</tr>
<tr>
<td align="center">R_MESSAGE_1</td>
<td align="center">TBD5</td>
<td align="center">First Responder's message</td>
</tr>
<tr>
<td align="center">I_MESSAGE_2</td>
<td align="center">TBD6</td>
<td align="center">Second Initiator's message</td>
</tr>
<tr>
<td align="center">R_MESSAGE_2</td>
<td align="center">TBD7</td>
<td align="center">Second Responder's message</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 1: Data type (Additions)&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>
	    </p>
<ul class="text">
<li>Next payload (8 bits): identifies the payload that is 
		  added after this payload.
</li>
</ul><p>

</p><br /><hr class="insert" />
<a name="NPtable"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="center"><col align="center"><col align="center">
<tr><th align="center">Next Payload</th><th align="center">Value</th><th align="center">Section</th></tr>
<tr>
<td align="center">IBAKE</td>
<td align="center">TBD8</td>
<td align="center"><a class='info' href='#IBAKEpld'>Section&nbsp;6.1.1<span> (</span><span class='info'>IBAKE Payload</span><span>)</span></a></td>
</tr>
<tr>
<td align="center">ESK</td>
<td align="center">TBD9</td>
<td align="center"><a class='info' href='#ESKpld'>Section&nbsp;6.1.2<span> (</span><span class='info'>Encrypted Secret Key (ESK) Payload</span><span>)</span></a></td>
</tr>
<tr>
<td align="center">SK</td>
<td align="center">TBD10</td>
<td align="center"><a class='info' href='#SKpld'>Section&nbsp;6.1.5<span> (</span><span class='info'>Secret Key Sub-Payload</span><span>)</span></a></td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 2: Next Payload (Additions)&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>
	    </p>
<ul class="text">
<li>V (1 bits): flag to indicate whether a response message is
		  expected or not (this only has meaning when it is set in an
		  initiation message).  If a response is required, the V flag 
		  SHALL always be set to 1 in the
		  initiation messages and the receiver of the initiation message
		  (Responder or KMS) SHALL ignore it.
</li>
<li>#CS (8 bits): indicates the number of crypto sessions 
		  that will be handled within the CBS.  It SHALL be set to 0 
		  in the Request Key exchange, as crypto sessions SHALL NOT
		  be handled.
</li>
<li>CS ID map type (8 bits): specifies the method of uniquely 
		  mapping crypto sessions to the security protocol sessions.  
		  In the Request Key exchange, the CS ID map type SHALL be
		  the "Empty map" (defined in <a class='info' href='#RFC4563'>[RFC4563]<span> (</span><span class='info'>Carrara, E., Lehtovirta, V., and K. Norrman, &ldquo;The Key ID Information Type for the General Extension Payload in Multimedia Internet KEYing (MIKEY),&rdquo; June&nbsp;2006.</span><span>)</span></a>) as 
		  crypto sessions SHALL NOT be handled.
</li>
</ul><p>

</p>
<a name="IBAKEpld"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1.1"></a><h3>6.1.1.&nbsp;
IBAKE Payload</h3>

<p>The IBAKE payload contains IBE encrypted (see 
	  <a class='info' href='#RFC5091'>[RFC5091]<span> (</span><span class='info'>Boyen, X. and L. Martin, &ldquo;Identity-Based Cryptography Standard (IBCS) #1: Supersingular Curve Implementations of the BF and BB1 Cryptosystems,&rdquo; December&nbsp;2007.</span><span>)</span></a>) and <a class='info' href='#RFC5408'>[RFC5408]<span> (</span><span class='info'>Appenzeller, G., Martin, L., and M. Schertler, &ldquo;Identity-Based Encryption Architecture and Supporting Data Structures,&rdquo; January&nbsp;2009.</span><span>)</span></a>) for details
	  about IBE encryption) Initiator and Responder's Identities and 
	  EC Diffie-Hellman
	  sub-payloads (see <a class='info' href='#ECDHpld'>Section&nbsp;6.1.4<span> (</span><span class='info'>EC Diffie-Hellman Sub-Payload</span><span>)</span></a> for the definition of 
	  EC Diffie-Hellman
	  sub-payload). It may contain one or more EC Diffie-Hellman
	  sub-payloads and 
	  its associated identities. The last EC Diffie-Hellman or Identity
	  sub-payload has its
	  Next payload field set to Last payload.
</p>
<p>
            </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
                        1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ! Next payload  ! Encr data len                 !  Encr data    !
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   !                        Encr data                              ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div><p>


</p>
<p>
	    </p>
<ul class="text">
<li>Next payload (8 bits): identifies the payload that is added 
		after this payload.
</li>
<li>Encr data len (16 bits): length of Encr data (in bytes).
</li>
<li>Encr data (variable length): the encrypted EC Diffie-Hellman sub-payloads 
		(see <a class='info' href='#ECDHpld'>Section&nbsp;6.1.4<span> (</span><span class='info'>EC Diffie-Hellman Sub-Payload</span><span>)</span></a>).
</li>
</ul><p>

</p>
<a name="ESKpld"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1.2"></a><h3>6.1.2.&nbsp;
Encrypted Secret Key (ESK) Payload</h3>

<p>The Encrypted Secret Key payload contains IBE encrypted (see 
	  <a class='info' href='#RFC5091'>[RFC5091]<span> (</span><span class='info'>Boyen, X. and L. Martin, &ldquo;Identity-Based Cryptography Standard (IBCS) #1: Supersingular Curve Implementations of the BF and BB1 Cryptosystems,&rdquo; December&nbsp;2007.</span><span>)</span></a>) and <a class='info' href='#RFC5408'>[RFC5408]<span> (</span><span class='info'>Appenzeller, G., Martin, L., and M. Schertler, &ldquo;Identity-Based Encryption Architecture and Supporting Data Structures,&rdquo; January&nbsp;2009.</span><span>)</span></a>) for details
	  about IBE encryption) Secret Key sub-payload and its associated 
	  identity (see  <a class='info' href='#SKpld'>Section&nbsp;6.1.5<span> (</span><span class='info'>Secret Key Sub-Payload</span><span>)</span></a> for the definition of the 
	  Secret Key sub-payload).
</p>
<p>
            </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
                        1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ! Next payload  ! Encr data len                 !  Encr data    !
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   !                        Encr data                              ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div><p>


</p>
<p>
	    </p>
<ul class="text">
<li>Next payload (8 bits): identifies the payload that is added 
		after this payload.
</li>
<li>Encr data len (16 bits): length of Encr data (in bytes).
</li>
<li>Encr data (variable length): the encrypted secret key sub-payloads 
		(see <a class='info' href='#SKpld'>Section&nbsp;6.1.5<span> (</span><span class='info'>Secret Key Sub-Payload</span><span>)</span></a>).
</li>
</ul><p>

</p>
<a name="KDpld"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1.3"></a><h3>6.1.3.&nbsp;
Key Data Sub-Payload</h3>

<p>For the key data sub-payload, a new type of key is defined.  The
   Private Key (K_PR) is used to decrypt the content encrypted using the 
     corresponding Public Key (K_PUB). KEMAC in the REQUEST_KEY_RESP SHALL 
     contain one or more Private Keys.
</p>
<p>
	    </p>
<ul class="text">
<li>Type (4 bits): indicates the type of key included in the 
		  payload.
</li>
</ul><p>

</p><br /><hr class="insert" />
<a name="KDtable"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="center"><col align="center"><col align="center">
<tr><th align="center">Type</th><th align="center">Value</th><th align="center">Comments</th></tr>
<tr>
<td align="center">K_PR</td>
<td align="center">TBD11</td>
<td align="center">Private Key</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 3: Key Data Type (Additions)&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="ECDHpld"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1.4"></a><h3>6.1.4.&nbsp;
EC Diffie-Hellman Sub-Payload</h3>

<p> The EC Diffie-Hellman Sub-Payload uses the same format as ECC Point 
     Payload (ECCPT) defined in <a class='info' href='#I-D.ietf-msec-mikey-ecc'>[I&#8209;D.ietf&#8209;msec&#8209;mikey&#8209;ecc]<span> (</span><span class='info'>Milne, A., &ldquo;ECC Algorithms for MIKEY,&rdquo; June&nbsp;2007.</span><span>)</span></a>. However, ECCPT in MIKEY-IBAKE is never included in clear, but as an encrypted part of the
   IBAKE payload. The payload identifier is 22.
</p>
<p>
            </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
                        1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ! Next payload  ! ECC Curve     ! ECC Point                     ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ! Auth alg      ! TGK len                       ! Reserv! KV    !
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ! KV data (optional)                                            ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div><p>


</p>
<p>
	    </p>
<ul class="text">
<li>Next payload (8 bits): identifies the payload that is added 
		after
     this payload.  See Section 6.1 of <a class='info' href='#RFC3830'>[RFC3830]<span> (</span><span class='info'>Arkko, J., Carrara, E., Lindholm, F., Naslund, M., and K. Norrman, &ldquo;MIKEY: Multimedia Internet KEYing,&rdquo; August&nbsp;2004.</span><span>)</span></a> for values.
</li>
<li>ECC curve (8 bits): identifies the ECC curve used.
</li>
<li>ECC point (variable length): ECC point data, padded to end on a
     32-bit boundary, encoded in octet string representation.
</li>
<li>Auth alg (8 bits): specifies the MAC algorithm used for the
     verification message. For MIKEY-IBAKE this field is ignored. 
</li>
<li>TGK len (16 bits): the length of the TGK (in bytes).
		 For MIKEY-IBAKE this field is ignored. 
</li>
<li>KV (4 bits): indicates the type of key validity period 
		specified.
     This may be done by using an SPI (alternatively an MKI in SRTP) or
     by providing an interval in which the key is valid (e.g., in the
     latter case, for SRTP this will be the index range where the key
     is valid).  See Section 6.13 of <a class='info' href='#RFC3830'>[RFC3830]<span> (</span><span class='info'>Arkko, J., Carrara, E., Lindholm, F., Naslund, M., and K. Norrman, &ldquo;MIKEY: Multimedia Internet KEYing,&rdquo; August&nbsp;2004.</span><span>)</span></a> for pre-defined values.
</li>
<li>KV data (variable length): This includes either the 
		SPI/MKI or an
     interval (see Section 6.14 of <a class='info' href='#RFC3830'>[RFC3830]<span> (</span><span class='info'>Arkko, J., Carrara, E., Lindholm, F., Naslund, M., and K. Norrman, &ldquo;MIKEY: Multimedia Internet KEYing,&rdquo; August&nbsp;2004.</span><span>)</span></a>).  If KV is NULL, this
     field is not included.
</li>
</ul><p>

</p>
<a name="SKpld"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1.5"></a><h3>6.1.5.&nbsp;
Secret Key Sub-Payload</h3>

<p>Secret Key payload is included as a sub-payload in Encrypted Secret 
    Key payload. Similar to EC Diffie-Hellman sub-payload, it is never 
    included in clear, but as an encrypted part of the
   ESK payload.
</p>
<p>
            </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
                        1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   !  Next Payload ! Type  ! KV    ! Key data len                  !
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   !                         Key data                              ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   !                        KV data (optional)                     ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre></div><p>


</p>
<p>
	    </p>
<ul class="text">
<li>Next payload (8 bits): identifies the payload that is added 
		after this payload.
</li>
<li> Type (4 bits): indicates the type of the key included in the 
		payload.
</li>
</ul><p>

</p><br /><hr class="insert" />
<a name="SKtable"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="center"><col align="center">
<tr><th align="center">Type</th><th align="center">Value</th></tr>
<tr>
<td align="center">SK</td>
<td align="center">0</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 4: Secret Key Types&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>
	    </p>
<ul class="text">
<li>KV (4 bits): indicates the type of key validity period 
		specified.
      This may be done by using an SPI (or MKI in the case of 
		<a class='info' href='#RFC3711'>[RFC3711]<span> (</span><span class='info'>Baugher, M., McGrew, D., Naslund, M., Carrara, E., and K. Norrman, &ldquo;The Secure Real-time Transport Protocol (SRTP),&rdquo; March&nbsp;2004.</span><span>)</span></a>) or
      by providing an interval in which the key is valid (e.g., in the
      latter case, for SRTP this will be the index range where the key
      is valid). KV values are the same as in Section 6.13 of 
		<a class='info' href='#RFC3830'>[RFC3830]<span> (</span><span class='info'>Arkko, J., Carrara, E., Lindholm, F., Naslund, M., and K. Norrman, &ldquo;MIKEY: Multimedia Internet KEYing,&rdquo; August&nbsp;2004.</span><span>)</span></a>
</li>
<li>Key data len (16 bits): the length of the Key data field (in
      bytes). 
</li>
<li>Key data (variable length): The SK data.
</li>
<li>KV data (variable length): This includes either the SPI or an
      interval.  If KV is NULL, this field is not
      included.
</li>
</ul><p>

</p>
<a name="anchor31"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Security Considerations</h3>

<p>This draft is based on the basic Identity Based Encryption 
	    protocol, as specified in <a class='info' href='#RFC5091'>[RFC5091]<span> (</span><span class='info'>Boyen, X. and L. Martin, &ldquo;Identity-Based Cryptography Standard (IBCS) #1: Supersingular Curve Implementations of the BF and BB1 Cryptosystems,&rdquo; December&nbsp;2007.</span><span>)</span></a>), 
	    <a class='info' href='#RFC5408'>[RFC5408]<span> (</span><span class='info'>Appenzeller, G., Martin, L., and M. Schertler, &ldquo;Identity-Based Encryption Architecture and Supporting Data Structures,&rdquo; January&nbsp;2009.</span><span>)</span></a> and <a class='info' href='#RFC5409'>[RFC5409]<span> (</span><span class='info'>Martin, L. and M. Schertler, &ldquo;Using the Boneh-Franklin and Boneh-Boyen Identity-Based Encryption Algorithms with the Cryptographic Message Syntax (CMS),&rdquo; January&nbsp;2009.</span><span>)</span></a>, and as 
	    such inherits some properties of that protocol. For instance, 
	    by concatenating the “date” with the identity (to derive the 
	    public key), the need for any key 
	    revocation mechanisms is virtually eliminated. Moreover, by allowing the participants 
	    to acquire multiple private keys (e.g., for duration of contract) 
	    the availability requirements on the KMS are also reduced without 
	    any reduction in security.
</p>
<p>Some additional security considerations are outlined below:
</p>
<p>
	    </p>
<ul class="text">
<li>Attacks on the cryptographic algorithms used in Identity 
		Based Encryption are outside the scope of this document. 
		It is assumed that any administrator will pay attention to 
		the desired strengths of the relevant cryptographic algorithms 
		based on an up to date understanding of the strength of these 
		algorithms from published literature as well as known 
		attacks.
</li>
<li>It is assumed that the Key Management Services are secure, not compromised, trusted, 
		and will not engage in launching active attacks independently 
		or in a collaborative environment.
</li>
<li>However, any malicious insider could potentially launch 
		passive attacks (by decryption of one or more message 
		exchanges offline). While it is in the best interest of 
		administrators to prevent such issue, it is hard to eliminate 
		this problem. Hence, it it assumed that such problems will persist, 
		and hence the protocols are designed to protect participants 
		from passive adversaries.
</li>
<li>Communication between participants and their respective 
		Key Management Servers is expected to be secure, and as 
		such outside the scope of this document. In any implementation 
		of the protocols described in this document, administrators 
		of any KMS have to ensure that communication with participants 
		is secure and not compromised.
</li>
<li>The basic IBAKE protocol from a cryptographic perspective is 
		secure based on the following considerations.

	    
<ul class="text">
<li>In every step Identity Based Encryption (IBE) is used, with 
		the recipient’s public key. This guarantees that only the 
		intended recipient of the message can decrypt the message.
</li>
<li>Next, the use of identities within the encrypted payload is 
		intended to eliminate some basic reflection attacks. For 
		instance, suppose we did not use identities as part of the 
		encrypted payload, in the first step of the IBAKE protocol 
		(i.e., I_message 1 of <a class='info' href='#example'>Figure&nbsp;3<span> (</span><span class='info'>Example Message Exchange</span><span>)</span></a> in  
		<a class='info' href='#overview'>Section&nbsp;4.1<span> (</span><span class='info'>Overview</span><span>)</span></a>).

	    
<ul class="text">
<li>Assume an adversary who has access to the conversation 
		between initiator and responder and can actively snoop into 
		packets and drop/modify them before routing them to the 
		destination.
</li>
<li>For instance, assume that the IP source address and 
		destination address can be modified by the adversary.
</li>
<li>After the first message is sent by the initiator (to the 
		responder), the adversary can take over and trap the 
		packet.
</li>
<li>Next the adversary can modify the IP source address to 
		include adversary’s IP address, before routing it onto 
		the responder.
</li>
<li>The responder will assume the request for an IBAKE session 
		came from the adversary, and will execute step 2 of the IBAKE 
		protocol (i.e., R_message 1 of <a class='info' href='#example'>Figure&nbsp;3<span> (</span><span class='info'>Example Message Exchange</span><span>)</span></a> in 
		<a class='info' href='#overview'>Section&nbsp;4.1<span> (</span><span class='info'>Overview</span><span>)</span></a>) but 
		encrypt it using the adversary’s public key.
</li>
<li>The above message can be decrypted by the adversary (and 
		only by the adversary). In particular, since the second 
		message includes the challenge sent by the initiator to the 
		responder, the adversary will now learn the challenge sent 
		by the initiator.
</li>
<li>Following this, the adversary can carry on a conversation 
		with the initiator “pretending” to be the responder.
</li>
<li>This attack will be eliminated if identities are used as 
		part of the encrypted payload.
</li>
</ul>

</li>
<li>In summary, at the end of the exchange both initiator and responder can 
  mutually authenticate each other and agree on a session key.
</li>
<li>Recall that Identity Based Encryption guarantees that only the recipient 
  of the message can decrypt the message using the private key. The caveat 
  being, the KMS which generated the private key of recipient of message can 
  decrypt the message as well. However, the KMS cannot learn the session 
  key “xyP” given “xP” and “yP” based on the Elliptic Curve Diffie-Hellman 
  problem. This property of resistance to passive key escrow from the KMS, 
  is not applicable to the basic IBE protocols proposed in 
  <a class='info' href='#RFC5091'>[RFC5091]<span> (</span><span class='info'>Boyen, X. and L. Martin, &ldquo;Identity-Based Cryptography Standard (IBCS) #1: Supersingular Curve Implementations of the BF and BB1 Cryptosystems,&rdquo; December&nbsp;2007.</span><span>)</span></a>), 
	    <a class='info' href='#RFC5408'>[RFC5408]<span> (</span><span class='info'>Appenzeller, G., Martin, L., and M. Schertler, &ldquo;Identity-Based Encryption Architecture and Supporting Data Structures,&rdquo; January&nbsp;2009.</span><span>)</span></a> and <a class='info' href='#RFC5409'>[RFC5409]<span> (</span><span class='info'>Martin, L. and M. Schertler, &ldquo;Using the Boneh-Franklin and Boneh-Boyen Identity-Based Encryption Algorithms with the Cryptographic Message Syntax (CMS),&rdquo; January&nbsp;2009.</span><span>)</span></a>.
</li>
<li>Observe that the protocol works even if the initiator and responder 
  belong to two different Key Management Systems. In particular, the 
  parameters used for encryption to the responder and parameters used for 
  encryption to the initiator can be completely different and independent of 
  each other. Moreover, the Elliptic Curve used to generate the session key 
  “abP” can be completely different. If such flexibility is desired, then it 
  would be advantageous to add optional extra data and/or to the protocol to 
  exchange the algebraic primitives used in deriving the session key.
</li>
<li>In addition to mutual authentication, and resistance to passive escrow, 
  the Diffie-Hellman property of the session key exchange guarantees perfect 
  secrecy of keys. In others, accidental leakage of one session key does not 
  compromise of past or future session keys between the same initiator and 
  responder.
</li>
</ul>

</li>
<li>The security of all additional security features rely on the 
	      security of IBAKE. Moreover each feature has additional 
	      security features. For instance:

	    
<ul class="text">
<li>In the Forking feature, given that there are multiple 
		potential responders, it is important to observe that there 
		is one ‘common responder’ identity (and corresponding public 
		and private keys) and each responder has a unique identity 
		(and corresponding keys). Observe that, in this framework if 
		responder 2 is the who responds to the invite from the 
		initiator then the protocol guarantees that responder 1 does 
		not learn the session key.
</li>
<li>In the Retargeting feature, the forwarding server does not 
		learn the private key of the intended responder since it is 
		encrypted using the retargeted responder’s public key. 
		Additionally, the initiator will learn that the retargeted 
		responder answered the phone (and not the intended responder). 
		This will allow the initiator to decide whether or not to 
		carry on the conversation. Finally, the session key cannot 
		be discovered by intended responder since the random number 
		chosen by the retargeted responder is secret.
</li>
<li>In the Deferred Delivery feature, the initiator and the 
		responder’s mailbox will mutually authenticate each other 
		thereby preventing server side “phishing” attacks and 
		conversely guarantees to the server (and eventually to the 
		responder) the identity of the initiator. Moreover, the key 
		used by initiator to encrypt the contents of the message is 
		completely independent from the session key derived between 
		the initiator and the server. Finally, the key used to 
		encrypt the message is encrypted using the responder’s public 
		key by the initiator which allows the contents of the message 
		to remain unknown to the mailbox server.
</li>
</ul>

</li>
</ul><p>

</p>
<a name="anchor32"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
IANA Considerations</h3>

<p>This document defines several new values for the namespaces Data
	    Type, Next Payload, and Key Data Type defined in 
	    <a class='info' href='#RFC3830'>[RFC3830]<span> (</span><span class='info'>Arkko, J., Carrara, E., Lindholm, F., Naslund, M., and K. Norrman, &ldquo;MIKEY: Multimedia Internet KEYing,&rdquo; August&nbsp;2004.</span><span>)</span></a>.  The
	    following IANA assignments were added to the MIKEY Payload registry
	    (in bracket is a reference to the table containing the registered
	    values):
</p>
<p>
	    </p>
<ul class="text">
<li>Data Type (see <a class='info' href='#DTtable'>Table&nbsp;1<span> (</span><span class='info'>Data type (Additions)</span><span>)</span></a>)
</li>
<li>Next Payload (see <a class='info' href='#NPtable'>Table&nbsp;2<span> (</span><span class='info'>Next Payload (Additions)</span><span>)</span></a>)
</li>
<li>Key Data Type (see <a class='info' href='#KDtable'>Table&nbsp;3<span> (</span><span class='info'>Key Data Type (Additions)</span><span>)</span></a>)
</li>
</ul><p>

</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.ietf-msec-mikey-ecc">[I-D.ietf-msec-mikey-ecc]</a></td>
<td class="author-text">Milne, A., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-msec-mikey-ecc-03.txt">ECC Algorithms for MIKEY</a>,&rdquo; draft-ietf-msec-mikey-ecc-03 (work in progress), June&nbsp;2007 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-msec-mikey-ecc-03.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3830">[RFC3830]</a></td>
<td class="author-text">Arkko, J., Carrara, E., Lindholm, F., Naslund, M., and K. Norrman, &ldquo;<a href="http://tools.ietf.org/html/rfc3830">MIKEY: Multimedia Internet KEYing</a>,&rdquo; RFC&nbsp;3830, August&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3830.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4563">[RFC4563]</a></td>
<td class="author-text">Carrara, E., Lehtovirta, V., and K. Norrman, &ldquo;<a href="http://tools.ietf.org/html/rfc4563">The Key ID Information Type for the General Extension Payload in Multimedia Internet KEYing (MIKEY)</a>,&rdquo; RFC&nbsp;4563, June&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4563.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5091">[RFC5091]</a></td>
<td class="author-text">Boyen, X. and L. Martin, &ldquo;<a href="http://tools.ietf.org/html/rfc5091">Identity-Based Cryptography Standard (IBCS) #1: Supersingular Curve Implementations of the BF and BB1 Cryptosystems</a>,&rdquo; RFC&nbsp;5091, December&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc5091.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5408">[RFC5408]</a></td>
<td class="author-text">Appenzeller, G., Martin, L., and M. Schertler, &ldquo;<a href="http://tools.ietf.org/html/rfc5408">Identity-Based Encryption Architecture and Supporting Data Structures</a>,&rdquo; RFC&nbsp;5408, January&nbsp;2009 (<a href="http://www.rfc-editor.org/rfc/rfc5408.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5409">[RFC5409]</a></td>
<td class="author-text">Martin, L. and M. Schertler, &ldquo;<a href="http://tools.ietf.org/html/rfc5409">Using the Boneh-Franklin and Boneh-Boyen Identity-Based Encryption Algorithms with the Cryptographic Message Syntax (CMS)</a>,&rdquo; RFC&nbsp;5409, January&nbsp;2009 (<a href="http://www.rfc-editor.org/rfc/rfc5409.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="SEC1">[SEC1]</a></td>
<td class="author-text">Standards for Efficient Cryptography Group, &ldquo;Elliptic Curve Cryptography,&rdquo; September&nbsp;2000.</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC3711">[RFC3711]</a></td>
<td class="author-text">Baugher, M., McGrew, D., Naslund, M., Carrara, E., and K. Norrman, &ldquo;<a href="http://tools.ietf.org/html/rfc3711">The Secure Real-time Transport Protocol (SRTP)</a>,&rdquo; RFC&nbsp;3711, March&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3711.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4120">[RFC4120]</a></td>
<td class="author-text">Neuman, C., Yu, T., Hartman, S., and K. Raeburn, &ldquo;<a href="http://tools.ietf.org/html/rfc4120">The Kerberos Network Authentication Service (V5)</a>,&rdquo; RFC&nbsp;4120, July&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4120.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4650">[RFC4650]</a></td>
<td class="author-text">Euchner, M., &ldquo;<a href="http://tools.ietf.org/html/rfc4650">HMAC-Authenticated Diffie-Hellman for Multimedia Internet KEYing (MIKEY)</a>,&rdquo; RFC&nbsp;4650, September&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4650.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4738">[RFC4738]</a></td>
<td class="author-text">Ignjatic, D., Dondeti, L., Audet, F., and P. Lin, &ldquo;<a href="http://tools.ietf.org/html/rfc4738">MIKEY-RSA-R: An Additional Mode of Key Distribution in Multimedia Internet KEYing (MIKEY)</a>,&rdquo; RFC&nbsp;4738, November&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4738.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Violeta Cakulev</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Alcatel Lucent</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">600 Mountain Ave.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">3D-517</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Murray Hill, NJ  07974</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 908 582 3207</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:cakulev@alcatel-lucent.com">cakulev@alcatel-lucent.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Ganapathy Sundaram</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Alcatel Lucent</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">600 Mountain Ave.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">3D-517</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Murray Hill, NJ  07974</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 908 582 3209</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:ganeshs@alcatel-lucent.com">ganeshs@alcatel-lucent.com</a></td></tr>
</table>
</body></html>
