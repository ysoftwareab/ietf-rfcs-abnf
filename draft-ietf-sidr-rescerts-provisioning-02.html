<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>A Protocol for Provisioning Resource
    Certificates</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="A Protocol for Provisioning Resource
    Certificates">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Secure Inter-Domain Routing</td><td class="header">G. Huston</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">R. Loomans</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">B. Ellacott</td></tr>
<tr><td class="header">Expires: December 22, 2008</td><td class="header">APNIC</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">R. Austein</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">ISC</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">June 20, 2008</td></tr>
</table></td></tr></table>
<h1><br />A Protocol for Provisioning Resource
    Certificates<br />draft-ietf-sidr-rescerts-provisioning-02.txt</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on December 22, 2008.</p>

<h3>Abstract</h3>

<p>This document defines a framework for certificate management
      interactions between a resource issuer ("Internet Registry" or "IR") and
      a resource recipient ("Internet Service Provider" or "ISP") through the
      specification of a protocol for interaction between the two parties. The
      protocol supports the transmission of requests from the ISP, and
      corresponding responses from the IR encompassing the actions of
      certificate issuance, certificate revocation and certificate status
      information reports. This protocol is intended to be limited to the
      application of resource certificate management and is not intended to be
      used as part of a more general certificate management framework.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#intro">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor1">1.1.</a>&nbsp;
Terminology<br />
<a href="#anchor2">2.</a>&nbsp;
Scope<br />
<a href="#anchor3">3.</a>&nbsp;
Protocol Specification<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">3.1.</a>&nbsp;
CMS Profile<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">3.1.1.</a>&nbsp;
SignedData Content Type<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor25">3.1.2.</a>&nbsp;
ASN.1<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor26">3.2.</a>&nbsp;
Common Message format<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor27">3.3.</a>&nbsp;
Control - Resource Class Query<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor28">3.3.1.</a>&nbsp;
Resource Class List Query<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor29">3.3.2.</a>&nbsp;
Resource Class List Response<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor30">3.4.</a>&nbsp;
CA - Certificate Issuance<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor31">3.4.1.</a>&nbsp;
Certificate Issuance Request<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor32">3.4.2.</a>&nbsp;
Certificate Issuance Response<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor33">3.5.</a>&nbsp;
Certificate Revocation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor34">3.5.1.</a>&nbsp;
Certificate Revocation Request<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor35">3.5.2.</a>&nbsp;
Certificate Revocation Response<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor36">3.6.</a>&nbsp;
Request-Not-Performed Response<br />
<a href="#anchor37">4.</a>&nbsp;
XML Schema<br />
<a href="#anchor38">5.</a>&nbsp;
Security Considerations<br />
<a href="#anchor39">6.</a>&nbsp;
IANA Considerations<br />
<a href="#anchor40">7.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">8.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">8.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">8.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="intro"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>This document defines a framework for certificate management
      interactions between a resource issuer ("Internet Registry" or "IR") and
      a resource recipient ("Internet Service Provider" or "ISP") through the
      specification of a protocol for interaction between the two parties. The
      protocol supports the transmission of requests from the ISP, and
      corresponding responses from the IR encompassing the actions of
      certificate issuance, certificate revocation and certificate status
      information reports. This protocol is intended to be limited to the
      application of resource certificate management and is not intended to be
      used as part of a more general certificate management framework.
</p>
<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Terminology</h3>

<p>It is assumed that the reader is familiar with the terms and
        concepts described in "Internet X.509 Public Key Infrastructure
        Certificate and Certificate Revocation List (CRL) Profile" <a class='info' href='#RFC3280'>[RFC3280]<span> (</span><span class='info'>Housley, R., Polk, W., Ford, W., and D. Solo, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; April&nbsp;2002.</span><span>)</span></a>, "X.509 Extensions for IP Addresses and AS
        Identifiers" <a class='info' href='#RFC3779'>[RFC3779]<span> (</span><span class='info'>Lynn, C., Kent, S., and K. Seo, &ldquo;X.509 Extensions for IP Addresses and AS Identifiers,&rdquo; June&nbsp;2004.</span><span>)</span></a>, "Internet Protocol" <a class='info' href='#RFC0791'>[RFC0791]<span> (</span><span class='info'>Postel, J., &ldquo;Internet Protocol,&rdquo; September&nbsp;1981.</span><span>)</span></a>, "Internet Protocol Version 6 (IPv6)
        Addressing Architecture" <a class='info' href='#RFC4291'>[RFC4291]<span> (</span><span class='info'>Hinden, R. and S. Deering, &ldquo;IP Version 6 Addressing Architecture,&rdquo; February&nbsp;2006.</span><span>)</span></a>, "Internet
        Registry IP Allocation Guidelines" <a class='info' href='#RFC2050'>[RFC2050]<span> (</span><span class='info'>Hubbard, K., Kosters, M., Conrad, D., Karrenberg, D., and J. Postel, &ldquo;INTERNET REGISTRY IP ALLOCATION GUIDELINES,&rdquo; November&nbsp;1996.</span><span>)</span></a>, and
        related regional Internet registry address management policy
        documents.
</p>
<p>Additional terms used in this document are:<br />
<br />
 </p>
<blockquote class="text"><dl>
<dt>&quot;IR&quot;</dt>
<dd>an abbreviation of "Internet
            Registry", using in the context of this document as an entity
            undertaking the role of resource issuer. An IR is a Certificate
            Authority, and can issue Resource Certificates.<br />

</dd>
<dt>&quot;ISP&quot;</dt>
<dd>an abbreviation of "Internet Service
            Provider", using in the context of this document as an entity
            undertaking the role of resource recipient who is the subject of a
            Resource Certificate. An ISP may be issued with a CA-enabled
            certificate, allowing the entity to also assume the role of an
            IR.<br />

</dd>
<dt>&quot;resource class&quot;</dt>
<dd>a resource class refers
            to a collection of resources that can be certified in a single
            resource certificate by an issuer.<br />

</dd>
<dt>&quot;server&quot;</dt>
<dd>in the context of this
            client/server protocol specification, the IR assumes the role of
            the "server."<br />

</dd>
<dt>&quot;client&quot;</dt>
<dd>in the context of this
            client/server protocol specification, the ISP assumes the role of
            the "client."<br />

</dd>
</dl></blockquote>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
        "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
        document are to be interpreted as described in RFC 2119.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Scope</h3>

<p>This Resource PKI (RPKI) certificate provisioning protocol
      defines a basic set of interactions that allow an ISP to request
      certificate issuance, revocation and status information from the
      IR, and for a IR to maintain an issued certificate set that is
      aligned to the allocation records relating to each ISP. The IR's
      resource allocation database, is the authoritative source of
      what resource allocations the IR may certify for an ISP.
</p>
<p>A resource recipient (ISP) may also undertake the role of a resource
      issuer (IR), such as in the case of a Local Internet Registry (LIR).
</p>
<p>This protocol specification does not encompass:
</p>
<p></p>
<ul class="text">
<li>signing of objects with keys that are certified by resource
          certificates, nor the issuance of end-entity certificates.<br />
<br />

</li>
<li>the specification of interaction with the IR's resource
          allocation database, nor the specification of a protocol to manage
          the publication repository.<br />
<br />

</li>
<li>the interactions between client and server that establish
          identities, exchange the keys used in the protection of the
          communications channel between client and server, and the exchange
          of the certificates and validation PKI contexts used in the
          Cryptographic Message Syntax message exchange.<br />
<br />

</li>
</ul>

<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Protocol Specification</h3>

<p>This RPKI certificate provisioning protocol is expressed as a
      simple request/response interaction, where the client passes a
      request to the server, and the server generates a corresponding
      response.
</p>
<p>The protocol is implemented as an exchange of messages.
</p>
<p>Messages are passed over an HTTPS <a class='info' href='#RFC2818'>[RFC2818]<span> (</span><span class='info'>Rescorla, E., &ldquo;HTTP Over TLS,&rdquo; May&nbsp;2000.</span><span>)</span></a>
      transport connection that safeguards against interception and
      replay attacks. The HTTPS session uses mutually authenticated
      TLS. The TLS keys and associated certificate chain used to
      validate TLS transactions is assumed to have been previously
      communicated between the two entities, through mechanisms not
      defined in this protocol specification. The HTTPS connection
      will use 2 way (mutual) identification. A message exchange
      commences with the client initiating an HTTP POST with content
      type of "application/x-rpki", with the message object as the
      body. The server's response will similarly be the body of the
      response with a content type of "application/x-rpki".
</p>
<p>The content of the POST, and the server's response, will be a
      "well-formed" Cryptographic Message Syntax (CMS) <a class='info' href='#RFC3852'>[RFC3852]<span> (</span><span class='info'>Housley, R., &ldquo;Cryptographic Message Syntax (CMS),&rdquo; July&nbsp;2004.</span><span>)</span></a> object, encoded using the Distinguished
      Encoding Rules for ASN.1 (DER) <a class='info' href='#X.509-88'>[X.509&#8209;88]<span> (</span><span class='info'>CCITT, &ldquo;Recommendation X.509: The Directory - Authentication Framework,&rdquo; 1988.</span><span>)</span></a>,
      formatted in accordance with the CMS profile as specified in the
      following section. CMS is used as the signing format to sign the
      message object. The public part of the signing key and the
      associated certificate chain that is used to validate the CMS
      digial signature is assumed to have been communicated between
      the two entities, through mechanisms not defined in this
      protocol specification. The CMS keys and certificates MAY be the
      same as those used for TLS.
</p>
<p>The protocol's request / response interaction is assumed to
      be reliable, in that all requests will generate a matching
      response. The protocol requires sequential operation, where the
      server MUST NOT accept a client's request unless it has
      generated and sent a response to the client's previous
      request. Attempts by the client to initiate multiple requests in
      parallel MUST be detected by the server and rejected with an
      error response.
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
CMS Profile</h3>

<p>The format of the CMS object is:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      ContentInfo ::= SEQUENCE {
        contentType ContentType,
        content [0] EXPLICIT ANY DEFINED BY contentType }

      ContentType ::= OBJECT IDENTIFIER
</pre></div>
<p>The protocol objects are all instances of CMS signed-data objects, where
      the ContentType used is the signed-data type of id-data, namely id-signedData, 
      OID = 1.2.840.113549.1.7.2.
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.1"></a><h3>3.1.1.&nbsp;
SignedData Content Type</h3>

<p>According to <a class='info' href='#RFC3852'>[RFC3852]<span> (</span><span class='info'>Housley, R., &ldquo;Cryptographic Message Syntax (CMS),&rdquo; July&nbsp;2004.</span><span>)</span></a>, signed-data content
      types shall have the ASN.1 type SignedData:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      SignedData ::= SEQUENCE {
        version CMSVersion,
        digestAlgorithms DigestAlgorithmIdentifiers,
        encapContentInfo EncapsulatedContentInfo,
        certificates [0] IMPLICIT CertificateSet OPTIONAL,
        crls [1] IMPLICIT RevocationInfoChoices OPTIONAL,
        signerInfos SignerInfos }

      DigestAlgorithmIdentifiers ::= SET OF DigestAlgorithmIdentifier

      SignerInfos ::= SET OF SignerInfo
</pre></div>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.1.1"></a><h3>3.1.1.1.&nbsp;
version</h3>

<p>The version is the syntax version number. It MUST be 3,
      corresponding to the signerInfo structure having version number
      3.
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.1.2"></a><h3>3.1.1.2.&nbsp;
digestAlgorithms</h3>

<p>The digestAlgorithms set MUST include only SHA-256, the OID
     for which is 2.16.840.1.101.3.4.2.1 <a class='info' href='#RFC4055'>[RFC4055]<span> (</span><span class='info'>Schaad, J., Kaliski, B., and R. Housley, &ldquo;Additional Algorithms and Identifiers for RSA Cryptography for use in the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; June&nbsp;2005.</span><span>)</span></a>. It
     MUST NOT contain any other algorithms.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.1.3"></a><h3>3.1.1.3.&nbsp;
encapContentInfo</h3>

<p>encapContentInfo is the signed content, consisting of a content
    type identifier and the content itself.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
     EncapsulatedContentInfo ::= SEQUENCE {
       eContentType ContentType,
       eContent [0] EXPLICIT OCTET STRING OPTIONAL }

     ContentType ::= OBJECT IDENTIFIER
</pre></div>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.1.3.1"></a><h3>3.1.1.3.1.&nbsp;
eContentType</h3>

<p>The eContentType for the RPKI Protocol Mesage object is defined
    as id-ct-xml, and has the numerical value of
    1.2.840.113549.1.9.16.1.28.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      id-smime OBJECT IDENTIFIER ::= { iso(1) member-body(2) us(840)
                                rsadsi(113549) pkcs(1) pkcs9(9) 16 }

      id-ct OBJECT IDENTIFIER ::= { id-smime 1 }

      id-ct-xml OBJECT IDENTIFIER ::= { id-ct 28 }
</pre></div>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.1.3.2"></a><h3>3.1.1.3.2.&nbsp;
eContent</h3>

<p>The content of a RPKI XML Protocol Object consists of a
      single protocol message, structured according to a define XML
      schema, as defined in subsequent sections of this document. The
      eContent field of the CMS object is formally defined using ASN.1
      as:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
          id-ct-xml ::= OCTET STRING -- XML encoded message
</pre></div>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.1.4"></a><h3>3.1.1.4.&nbsp;
certificates</h3>

<p>The certificates field MUST be present, and MUST contain the
      EE certificate of the key pair whose private key value was used
      to sign the CMS. This MUST NOT be an RPKI certificate, and
      SHOULD be a certificate that is recognised to attest to the
      identity of the party that created the CMS object.
</p>
<p>This field MAY contain other certificates that a relying
      party may use to validate the digital signature of the CMS
      object.
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.1.5"></a><h3>3.1.1.5.&nbsp;
crls</h3>

<p>This field MUST be present. The contents of the field are
     specified in <a class='info' href='#RFC3852'>[RFC3852]<span> (</span><span class='info'>Housley, R., &ldquo;Cryptographic Message Syntax (CMS),&rdquo; July&nbsp;2004.</span><span>)</span></a>.
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.1.6"></a><h3>3.1.1.6.&nbsp;
signerInfo</h3>

<p>SignerInfo is defined under CMS as:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      SignerInfo ::= SEQUENCE {
        version CMSVersion,
        sid SignerIdentifier,
        digestAlgorithm DigestAlgorithmIdentifier,
        signedAttrs [0] IMPLICIT SignedAttributes OPTIONAL,
        signatureAlgorithm SignatureAlgorithmIdentifier,
        signature SignatureValue,
        unsignedAttrs [1] IMPLICIT UnsignedAttributes OPTIONAL }
</pre></div>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.1.6.1"></a><h3>3.1.1.6.1.&nbsp;
version</h3>

<p>The version number MUST be 3, corresponding with the choice of 
      SubjectKeyIdentifier for the sid.
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.1.6.2"></a><h3>3.1.1.6.2.&nbsp;
sid</h3>

<p>The sid is defined as:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      SignerIdentifier ::= CHOICE {
        issuerAndSerialNumber IssuerAndSerialNumber,
        subjectKeyIdentifier [0] SubjectKeyIdentifier }
</pre></div>
<p>In this profile, the sid MUST be a SubjectKeyIdentifier.
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.1.6.3"></a><h3>3.1.1.6.3.&nbsp;
digestAlgorithm</h3>

<p>The digestAlgorithm MUST be SHA-256, the OID for which is 2.16.840.1.101.3.4.2.1. 
      <a class='info' href='#RFC4055'>[RFC4055]<span> (</span><span class='info'>Schaad, J., Kaliski, B., and R. Housley, &ldquo;Additional Algorithms and Identifiers for RSA Cryptography for use in the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; June&nbsp;2005.</span><span>)</span></a>
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.1.6.4"></a><h3>3.1.1.6.4.&nbsp;
signedAttrs</h3>

<p>Signed Attributes are defined as:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      SignedAttributes ::= SET SIZE (1..MAX) OF Attribute

      UnsignedAttributes ::= SET SIZE (1..MAX) OF Attribute

      Attribute ::= SEQUENCE {
        attrType OBJECT IDENTIFIER,
        attrValues SET OF AttributeValue }

      AttributeValue ::= ANY
</pre></div>
<p>The signer MUST digitally sign a collection of attributes
      along with the content payload. Each attribute in the collection
      MUST be DER-encoded. The syntax for attributes is defined in
      <a class='info' href='#X.501'>[X.501]<span> (</span><span class='info'>CCITT, &ldquo;Recommendation X.501: The Directory - Models,&rdquo; 1988.</span><span>)</span></a>, and the X.500 Directory provides a rich attribute
      syntax. A very simple subset of this syntax is used extensively
      in <a class='info' href='#RFC3852'>[RFC3852]<span> (</span><span class='info'>Housley, R., &ldquo;Cryptographic Message Syntax (CMS),&rdquo; July&nbsp;2004.</span><span>)</span></a>, where ATTRIBUTE.Type and ATTRIBUTE.id are the
      only parts of the ATTRIBUTE class that are employed.
</p>
<p>Each of the attributes used with this CMS profile has a
      single attribute value. Even though the syntax is defined as a
      SET OF AttributeValue, there MUST be exactly one instance of
      AttributeValue present.
</p>
<p>The SignedAttributes syntax within signerInfo is defined as a
      SET OF Attribute. The SignedAttributes MUST include only one
      instance of any particular attribute.
</p>
<p>The signer MUST include the content-type, message-digest and
      signing-time signed attributes. The signer MAY also include the
      binary-signing-time signed attribute. Other signed attributes
      that are deemed appropriate MAY also be included. The intent is
      to allow additional signed attributes to be included if a future
      need is identified. This does not cause an interoperability
      concern because unrecognized signed attributes are ignored at
      verification.
</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.1.6.4.1"></a><h3>3.1.1.6.4.1.&nbsp;
Content-Type Attribute</h3>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      id-contentType OBJECT IDENTIFIER ::= { iso(1) member-body(2)
          us(840) rsadsi(113549) pkcs(1) pkcs9(9) 3 }

      ContentType ::= OBJECT IDENTIFIER
</pre></div>
<p>A content-type attribute is required to contain the same
      object identifier as the content type contained in the
      EncapsulatedContentInfo. The signer MUST include a content-type
      attribute containing the appropriate content type. Section 11.1
      of <a class='info' href='#RFC3852'>[RFC3852]<span> (</span><span class='info'>Housley, R., &ldquo;Cryptographic Message Syntax (CMS),&rdquo; July&nbsp;2004.</span><span>)</span></a> defines the content-type attribute.
</p>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.1.6.4.2"></a><h3>3.1.1.6.4.2.&nbsp;
Message-Digest Attribute</h3>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      id-messageDigest OBJECT IDENTIFIER ::= { iso(1) member-body(2)
          us(840) rsadsi(113549) pkcs(1) pkcs9(9) 4 }

      MessageDigest ::= OCTET STRING
</pre></div>
<p>The signer MUST include a message-digest attribute, having as
      its value the output of a one-way hash function computed on the
      content that is being signed. Section 11.2 of <a class='info' href='#RFC3852'>[RFC3852]<span> (</span><span class='info'>Housley, R., &ldquo;Cryptographic Message Syntax (CMS),&rdquo; July&nbsp;2004.</span><span>)</span></a> 
      defines the message-digest attribute.
</p>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.1.6.4.3"></a><h3>3.1.1.6.4.3.&nbsp;
Signing-Time Attribute</h3>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      id-signingTime OBJECT IDENTIFIER ::= { iso(1) member-body(2)
          us(840) rsadsi(113549) pkcs(1) pkcs9(9) 5 }

      SigningTime ::= Time

      Time ::= CHOICE {
        utcTime UTCTime,
        generalizedTime GeneralizedTime }
</pre></div>
<p>The signing-time attribute MUST be present.
</p>
<p>The signing-time attribute specifies the time, based on the
       local system clock, when the digital signature was applied
       to the content.  Section 11.3 of <a class='info' href='#RFC3852'>[RFC3852]<span> (</span><span class='info'>Housley, R., &ldquo;Cryptographic Message Syntax (CMS),&rdquo; July&nbsp;2004.</span><span>)</span></a>
       defines the content-type attribute.
</p>
<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.1.6.4.4"></a><h3>3.1.1.6.4.4.&nbsp;
Binary-Signing-Time Attribute</h3>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      id-aa-binarySigningTime OBJECT IDENTIFIER ::= { iso(1)
          member-body(2) us(840) rsadsi(113549) pkcs(1) pkcs9(9)
          smime(16) aa(2) 46 }

      BinarySigningTime ::= BinaryTime

      BinaryTime ::= INTEGER (0..MAX)
</pre></div>
<p>The signer MAY include a binary-signing-time attribute,
      specifying the time at which the digital signature was applied
      to the content. If the binary-signing-time is present, the time
      that is represented MUST represent the same time value as the
      signing-time attribute. The binary-signing-time attribute is
      defined in <a class='info' href='#RFC4049'>[RFC4049]<span> (</span><span class='info'>Housley, R., &ldquo;BinaryTime: An Alternate Format for Representing Date and Time in ASN.1,&rdquo; April&nbsp;2005.</span><span>)</span></a>.
</p>
<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.1.6.5"></a><h3>3.1.1.6.5.&nbsp;
signatureAlgorithm</h3>

<p>The signatureAlgorithm MUST be RSA (rsaEncryption), the OID
       for which is 1.2.840.113549.1.1.1.
</p>
<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.1.6.6"></a><h3>3.1.1.6.6.&nbsp;
signature</h3>

<p>The signature value is defined as:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
          SignatureValue ::= OCTET STRING
</pre></div>
<p>The signature characteristics are defined by the digest and signature algorithms.
</p>
<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.1.6.7"></a><h3>3.1.1.6.7.&nbsp;
unsignedAttrs</h3>

<p>unsignedAttrs MUST be omitted.
</p>
<a name="anchor25"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.2"></a><h3>3.1.2.&nbsp;
ASN.1</h3>

<p>The following is the ASN.1 specification of the CMS signed
      object used by the RPKI provisioning protocol.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      ContentInfo ::= SEQUENCE {
        contentType ContentType,
        content [0] EXPLICIT ANY DEFINED BY contentType }

      ContentType ::= OBJECT IDENTIFIER

      id-smime OBJECT IDENTIFIER ::= { iso(1) member-body(2) us(840)
                                rsadsi(113549) pkcs(1) pkcs9(9) 16 }

      id-ct OBJECT IDENTIFIER ::= { id-smime 1 }

      id-ct-xml OBJECT IDENTIFIER ::= { id-ct 28 }

      id-ct-xml ::= OCTET STRING -- XML encoded message

      id-signedData OBJECT IDENTIFIER ::= { iso(1) member-body(2)
                         us(840) rsadsi(113549) pkcs(1) pkcs7(7) 2 }

      SignedData ::= SEQUENCE {
        version CMSVersion,
        digestAlgorithms DigestAlgorithmIdentifiers,
        encapContentInfo EncapsulatedContentInfo,
        certificates [0] IMPLICIT CertificateSet OPTIONAL,
        crls [1] IMPLICIT RevocationInfoChoices OPTIONAL,
        signerInfos SignerInfos }

      DigestAlgorithmIdentifiers ::= SET OF DigestAlgorithmIdentifier

      SignerInfos ::= SET OF SignerInfo

      SignerInfo ::= SEQUENCE {
        version CMSVersion,
        sid SignerIdentifier,
        digestAlgorithm DigestAlgorithmIdentifier,
        signedAttrs [0] IMPLICIT SignedAttributes OPTIONAL,
        signatureAlgorithm SignatureAlgorithmIdentifier,
        signature SignatureValue,
        unsignedAttrs [1] IMPLICIT UnsignedAttributes OPTIONAL }

      SignerIdentifier ::= CHOICE {
        issuerAndSerialNumber IssuerAndSerialNumber,
        subjectKeyIdentifier [0] SubjectKeyIdentifier }

      SignedAttributes ::= SET SIZE (1..MAX) OF Attribute

      UnsignedAttributes ::= SET SIZE (1..MAX) OF Attribute

      Attribute ::= SEQUENCE {
        attrType OBJECT IDENTIFIER,
        attrValues SET OF AttributeValue }

      AttributeValue ::= ANY

      SignatureValue ::= OCTET STRING

      id-contentType OBJECT IDENTIFIER ::= { iso(1) member-body(2)
          us(840) rsadsi(113549) pkcs(1) pkcs9(9) 3 }

      ContentType ::= OBJECT IDENTIFIER

      id-messageDigest OBJECT IDENTIFIER ::= { iso(1) member-body(2)
          us(840) rsadsi(113549) pkcs(1) pkcs9(9) 4 }

      MessageDigest ::= OCTET STRING

      id-signingTime OBJECT IDENTIFIER ::= { iso(1) member-body(2)
          us(840) rsadsi(113549) pkcs(1) pkcs9(9) 5 }

      SigningTime ::= Time

      Time ::= CHOICE {
        utcTime UTCTime,
        generalizedTime GeneralizedTime }

      id-aa-binarySigningTime OBJECT IDENTIFIER ::= { iso(1)
          member-body(2) us(840) rsadsi(113549) pkcs(1) pkcs9(9)
          smime(16) aa(2) 46 }

      BinarySigningTime ::= BinaryTime

      BinaryTime ::= INTEGER (0..MAX)
</pre></div>
<a name="anchor26"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Common Message format</h3>

<p>The XML template for all messages is as follows: 
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
---------------------------------------------------------------

&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;message xmlns="http://www.apnic.net/specs/rescerts/up-down/"
         version="1"
         sender="sender name"
         recipient = "recipient name"
         type="message type"&gt;

[payload]

&lt;/message&gt;

---------------------------------------------------------------

</pre></div>
<p></p>
<blockquote class="text"><dl>
<dt>version:</dt>
<dd>the value of this attribute is the version
            of this protocol. This document describes version 1.<br />
<br />

</dd>
<dt>sender:</dt>
<dd>the value of this attribute is the agreed
            name of the message sender, as determined between the client and
            the server by prior arrangement.<br />
<br />

</dd>
<dt>recipient:</dt>
<dd>the value of this attribute is the agreed
            name of the message recipient, as determined between the client
            and the server by prior arrangement.<br />
<br />

</dd>
<dt>type:</dt>
<dd>the possible values of this attribute are
            "list", "list_response", "issue", "issue_response", "revoke",
            "revoke_response", and "error_response".
</dd>
</dl></blockquote>

<p>Conforming parsers MUST reject any document with a version number
        they do not understand, or with any elements or attributes they do not
        understand. Servers must generate an error response when receiving
        such a request. Clients should generate an operator alert error when
        receiving such a response.
</p>
<p>A message in this protocol is a digitally signed object that makes
        use of CMS <a class='info' href='#RFC3852'>[RFC3852]<span> (</span><span class='info'>Housley, R., &ldquo;Cryptographic Message Syntax (CMS),&rdquo; July&nbsp;2004.</span><span>)</span></a>, and is encoded as DER. It
        uses the signed-data object contentType OID: 1.2.840.113549.1.7.2. The
        attribute "id-signingTime" (contentType OID: 1.2.840.113549.1.9.5) MUST
        be present in the CMS object.
</p>
<p>The encapsulated content of the CMS wrapping is an XML document.
        The remainder of this protocol specification omits this CMS wrapper
        and only discusses the XML document.
</p>
<p>Messages are checked using the following tests:<br />
<br />
 </p>
<ol class="text">
<li>Check the integrity of the HTTPS message and validate the TLS
            certificate using the PKI that has been determined by prior
            arrangement between client and server.<br />
<br />

</li>
<li>Check that the CMS is well-formed.<br />
<br />

</li>
<li>Check that the XML is well-formed.<br />
<br />

</li>
<li>Check that the XML sender and recipient attributes reference a
            known client and this server's system respectively.<br />
<br />

</li>
<li>Verify the digital signature using the public key provided in
            the certificate carried in the CMS wrapper.<br />
<br />

</li>
<li>Validate the CMS-provided certificate using the PKI that has
            been determined by prior arrangement between client and
            server.<br />
<br />

</li>
<li>Check that the value of the version number of the message is
            1.
</li>
</ol>

<p>The checks should generally be applied in the order specified
        here.
</p>
<p>Any errors encountered while checking items 1 through 6 would cause
        the server to generate an "HTTP 400 Bad Data" response to the HTTPS
        POST operation. An error in step 7 would cause the server to generate
        a "Request-Not-Performed" error response.
</p>
<a name="anchor27"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
Control - Resource Class Query</h3>

<a name="anchor28"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.1"></a><h3>3.3.1.&nbsp;
Resource Class List Query</h3>

<p>The value of the message "type" message attribute for this query
          is:<br />
<br />
</p>
<blockquote class="text">
<p>type="list"
</p>
</blockquote>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

---------------------------------------------------------------

Payload:

[No message payload is defined for this query]

---------------------------------------------------------------

</pre></div>
<a name="anchor29"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.2"></a><h3>3.3.2.&nbsp;
Resource Class List Response</h3>

<p>The value of the message "type" element for this response is:
          <br />
<br />
</p>
<blockquote class="text">
<p>type="list_response"
</p>
</blockquote>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
---------------------------------------------------------------

Payload:

 &lt;class class_name="class name"
     cert_url="url"
     resource_set_as="as resource set"
     resource_set_ipv4="ipv4 resource set"
     resource_set_ipv6="ipv6 resource set"
     resource_set_notafter="datetime"
     suggested_sia_head="[directory uri]" &gt;
     &lt;certificate cert_url="url"
         req_resource_set_as="as resource set"
         req_resource_set_ipv4="ipv4 resource set"
         req_resource_set_ipv6="ipv6 resource set" &gt;
     [certificate]
     &lt;/certificate&gt;

     ...

     (repeated for each current certificate where the client
      is the certificate's subject)

     &lt;issuer&gt;[issuer's certificate]&lt;/issuer&gt;
     &lt;/class&gt;

 ...

 (repeated for each of the issuer's resource class where the
  client has been allocated resources)


---------------------------------------------------------------

</pre></div>
<p>Where the client has been allocated resources from multiple
          resource classes, then the response will contain multiple class
          elements, corresponding to the complete set of the issuer's resource
          classes where the client holds allocated resources. Those issuer's
          resource classes where the client holds no allocated resources will
          not be included in the response.
</p>
<p>Where the issuer has issued multiple certificates in a resource
          class signed with different keys (as may occur during a staged
          issuer-key rollover), only the most recent certificate issued with
          the currently "active" issuer's key will be listed in the
          response.
</p>
<p>Each "class" element describes a set of resources that are
          certified within the scope of a single certificate, referring to a
          single resource class with a common validation path.
</p>
<p></p>
<blockquote class="text"><dl>
<dt>class_name:</dt>
<dd>the value of this attribute is the
              issuer-assigned name of the issuer's Resource Class.<br />
<br />

</dd>
<dt>cert_url:</dt>
<dd>in the context of a class element, the
              value of this attribute is a pointer to the issuer's CA
              certificate (i.e. a reference to the immediate superior
              certificate, being the CA-enabled certificate where the issuer
              is the certificate's subject). Its value is a comma-separated
              list of URIs, of which at least one MUST be an RSYNC URI. Any
              comma values within a URI MUST be escaped ("%2C"). The ordering
              of the list may be interpreted by the client as a relative
              preference for access methods as expressed by the publisher of
              this certificate.<br />
<br />

</dd>
<dt>resource_set_as:</dt>
<dd>in the context of a class element,
              the value of this attribute is the set of AS numbers and AS
              number ranges that the issuer has allocated to the client within
              the scope of this resource class, presented in ASCII as a
              comma-separated list. The list elements are decimal integer
              values and ranges of decimal integers specified by the low and
              high value of the range with a hyphen delimiter, using the
              canonical order as described in <a class='info' href='#RFC3779'>[RFC3779]<span> (</span><span class='info'>Lynn, C., Kent, S., and K. Seo, &ldquo;X.509 Extensions for IP Addresses and AS Identifiers,&rdquo; June&nbsp;2004.</span><span>)</span></a>,
              without leading zeros, and with no white space or punctuation
              other than the comma and the hyphen range designator (e.g.:
              resource_set_as="123,456-789,123456"). If there are no AS
              numbers in this Resource Class the empty set will be represented
              by a null string value ("") for this attribute.<br />
<br />

</dd>
<dt>resource_set_ipv4:</dt>
<dd>in the context of a class
              element, the value of this attribute is the set of IPv4
              addresses that the issuer has allocated to the client within the
              scope of this resource class. The value is presented in ASCII as
              a comma-separated list of elements. Each element is either an
              address prefix using the notation of &lt;dotted quad&gt;/mask
              length, or a range specified as low and high range values in
              dotted quad notation with a hyphen delimiter. The list is
              presented in canonical order, as described in <a class='info' href='#RFC3779'>[RFC3779]<span> (</span><span class='info'>Lynn, C., Kent, S., and K. Seo, &ldquo;X.509 Extensions for IP Addresses and AS Identifiers,&rdquo; June&nbsp;2004.</span><span>)</span></a>. The dotted quad notation is without
              leading zeros, and the list contains no white space or
              punctuation other than the period, forward slash, hyphen and
              comma. (e.g.
              resource_set_ipv4="192.0.2.0/26,192.0.2.66-192.0.2.76") If there
              are no IPv4 addresses in this resource class the empty set will
              be represented by a null string value ("") for this
              attribute.<br />
<br />

</dd>
<dt>resource_set_ipv6:</dt>
<dd>in the context of a class
              element, the value of this attribute is the set of IPv6
              addresses that the issuer has allocated to the client within the
              scope of this resource class. The value is presented in ASCII as
              a comma-separated list of elements. Each element is either an
              address prefix using the notation of &lt;hex nibble
              sequence&gt;/mask length, or a range specified as low and high
              range values in hex nibble notation with a hyphen delimiter.
              Trailing zero nibbles are truncated and represented by '::'. The
              list is presented in canonical order, as described in <a class='info' href='#RFC3779'>[RFC3779]<span> (</span><span class='info'>Lynn, C., Kent, S., and K. Seo, &ldquo;X.509 Extensions for IP Addresses and AS Identifiers,&rdquo; June&nbsp;2004.</span><span>)</span></a>. The hex nibble sequence notation is
              without leading zeros, and the list contains no white space or
              punctuation other than the colon, forward slash, hyphen and
              comma (e.g.
              resource_set_ipv6="2001:0DB8::/48,2001:0DB8:002::-2001:0DB8:005::").
              The XML Schema data type is
              http://www.w3.org/TR/xmlschema-2/#hexBinary and value is case
              insensitive, with the canonical form being upper case. If there
              are no IPv6 addresses in this resource class the empty set will
              be represented by a null string value ("") for this
              attribute.<br />
<br />

</dd>
<dt>resource_set_notafter:</dt>
<dd>The value of this
              attribute specified the date/time that would be set in
              the Validity notAfter field in any new certificate
              issued for this particular client within the scope of
              this resource class, should the client request a new
              certificate.  The time format used for the value of this
              attribute is specified as ISO 8601 <a class='info' href='#ISO.8601:2004'>[ISO.8601:2004]<span> (</span><span class='info'>ISO, &ldquo;ISO 8601:2004 Representation of dates and Times,&rdquo; 2004.</span><span>)</span></a>, and MUST use UTC time
              (i.e. YYYY-MM-DDThh:mm:ssZ,
              e.g. 2007-11-29T04:40:00Z). If the client's certificate
              has a validity notAfter time that is different to this
              this time then the client SHOULD request a new
              certificate to be issued for this resource class.<br />
<br />

</dd>
<dt>suggested_sia_head:</dt>
<dd>(OPTIONAL)If this field is
              present then it indicates a publication namespace which the
              server has made available to the client to use for its own
              collection of published products. Presence of this field does
              not mean that the client has permission from the repository
              operator to lodge under this URI, only that the client has
              permission from the server to lodge under this URI.<br />
<br />

</dd>
<dt>[issuer's certificate]</dt>
<dd>value is the Base64
              encoding of the DER-encoded issuer's CA certificate (the
              CA-enabled certificate where the issuer is the certificate's
              subject).
</dd>
</dl></blockquote>

<p>Each certificate element describes the most recently issued
          current certificate where the certificate's subject refers to the
          client for each active client key pair. A "current" certificate is a
          non-expired, non-revoked certificate. If no current certificate has
          been issued, then no certificate element will be included in the
          response.
</p>
<p></p>
<blockquote class="text"><dl>
<dt>cert_url:</dt>
<dd>in the context of a certificate element,
              this is a pointer to the location where the certificate issuer
              has published this certificate. This field is the issuer's
              suggestion for the AIA field for the subject to use in
              subordinate certificates that are issued by the subject.
              According to the Resource Certificate Profile [insert ref here]
              the AIA field is a non-empty (contains a minimum of 1 element)
              list of URI's, one of which MUST be an RSYNC URI. The order of
              URI's in the AIA field may be interpreted as the publisher's
              relative preference for access methods for this certificate. The
              cert_url conforms to this AIA specification. Its value is a
              comma-separated list of URIs, one of which MUST be an RSYNC URI.
              Any comma values within a URI MUST be escaped ("%2C").<br />
<br />

</dd>
<dt>req_resource_set_as:</dt>
<dd>the set of AS numbers that
              were specified in the corresponding original certificate request
              that defined the maximal requested span of the certified AS
              number set, following the syntax described above. If this
              attribute was present in the certificate request, then the
              attribute MUST be present in this response, otherwise it MUST
              NOT be present.<br />
<br />

</dd>
<dt>req_resource_set_ipv4:</dt>
<dd>the set of IPv4 addresses
              that were specified in the corresponding original certificate
              request that defined the maximal requested span of the certified
              IPv4 address set, following the syntax described above. If this
              attribute was present in the certificate request, then the
              attribute MUST be present in this response, otherwise it MUST
              NOT be present.<br />
<br />

</dd>
<dt>req_resource_set_ipv6:</dt>
<dd>the set of IPv6 addresses
              that were specified in the corresponding original certificate
              request that defined the maximal requested span of the certified
              IPv6 address set, following the syntax described above. If this
              attribute was present in the certificate request, then the
              attribute MUST be present in this response, otherwise it MUST
              NOT be present.<br />
<br />

</dd>
<dt>[certificate]</dt>
<dd>value is the Base64 encoding of the
              DER-encoded certificate.
</dd>
</dl></blockquote>

<a name="anchor30"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4"></a><h3>3.4.&nbsp;
CA - Certificate Issuance</h3>

<a name="anchor31"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4.1"></a><h3>3.4.1.&nbsp;
Certificate Issuance Request</h3>

<p>The value of the message "type" element for this request is:
          <br />
<br />
</p>
<blockquote class="text">
<p>type="issue"
</p>
</blockquote>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

---------------------------------------------------------------

Payload:

&lt;request
           class_name="class name"
           req_resource_set_as="as resource set"
           req_resource_set_ipv4="ipv4 resource set"
           req_resource_set_ipv6="ipv6 resource set"&gt;
           [Certificate request]
           &lt;/request&gt;

---------------------------------------------------------------

</pre></div>
<p>The client must use different key pairs for each distinct
          resource class.
</p>
<p>If any of the req_resource_set attributes are specified in the
          request, then any missing req_resource_set attributes are to be
          interpreted as specifying the complete set of the corresponding
          resource type that match the client's current resource allocation.
          If the value of any req_resource_set attributes is the null value
          (""), then this indicates that no resources of that resource type
          are to be certified with this request.
</p>
<p>The requested resource set values are held as a local record by
          the issuer against the resource class and the client's public key.
          Any subsequent Certificate Issuance Requests that specify the same
          Resource Class and the same client's public key will (re)set the
          issuer's local record of the requested resource sets to the most
          recently specified values.
</p>
<p></p>
<blockquote class="text"><dl>
<dt>class_name:</dt>
<dd>value is the server's identifier of a
              Resource Class.<br />
<br />

</dd>
<dt>req_resource_set_as:</dt>
<dd>(OPTIONAL)the set of AS
              numbers that define the maximal requested span of the certified
              AS number set, formatted as per the resource_set_as attribute of
              the Resource Class List Response.<br />
<br />

</dd>
<dt>req_resource_set_ipv4:</dt>
<dd>(OPTIONAL)the set of IPv4
              addresses that define the maximal requested span of the
              certified IPv4 address set, formatted as per the
              resource_set_ipv4 attribute of the Resource Class List
              Response.<br />
<br />

</dd>
<dt>req_resource_set_ipv6:</dt>
<dd>(OPTIONAL)the set of IPv6
              addresses that define the maximal requested span of the
              certified IPv6 address set, formatted as per the
              resource_set_ipv6 attribute of the Resource Class List
              Response.<br />
<br />

</dd>
<dt>[Certificate request]</dt>
<dd>value is the certificate
              request. This is a Base-64 encoded DER version of a request
              formatted using PKCS#10.
</dd>
</dl></blockquote>

<a name="anchor32"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4.2"></a><h3>3.4.2.&nbsp;
Certificate Issuance Response</h3>

<p>The value of the message "type" element for this response is:
          <br />
<br />
</p>
<blockquote class="text">
<p>type="issue_response"
</p>
</blockquote>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

---------------------------------------------------------------

Payload:


 &lt;class class_name="class name"
        cert_url="url"
        resource_set_as="as resource set"
        resource_set_ipv4="ipv4 resource set"
        resource_set_ipv6="ipv6 resource set" &gt;
         &lt;certificate cert_url="url"
               req_resource_set_as="as resource set"
               req_resource_set_ipv4="ipv4 resource set"
               req_resource_set_ipv6="ipv6 resource set" &gt;
         [certificate]
         &lt;/certificate&gt;
         &lt;issuer&gt;[issuer's certificate]&lt;/issuer&gt;
       &lt;/class&gt;

---------------------------------------------------------------

</pre></div>
<p>If the certificate issuer determines that the issued certificate
          would be identical in all respects to the most recently issued
          certificate for this client, other than the certificate's serial
          number, were the certificate to be issued, the issuer may choose to
          respond with the most recently issued certificate and not issue a
          new certificate for this request.
</p>
<p>The definition of the attributes and syntax of the values is the
          same as the resource class list response, but the response only
          references the (single) named resource class, and the (single)
          certificate issued against the client's public key as provided in
          the corresponding certificate request.
</p>
<a name="anchor33"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.5"></a><h3>3.5.&nbsp;
Certificate Revocation</h3>

<a name="anchor34"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.5.1"></a><h3>3.5.1.&nbsp;
Certificate Revocation Request</h3>

<p>The value of the message "type" element for this request is:
          <br />
<br />
</p>
<blockquote class="text">
<p>type="revoke"
</p>
</blockquote>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

---------------------------------------------------------------

Payload:


&lt;key class_name="class name"
     ski="encoded hash of the subject public key]" /&gt;


---------------------------------------------------------------

</pre></div>
<p>This command 'retires' a client's key pair by requesting the
          issuer to revoke all certificates for this client that contain the
          matching public key, within the scope of a named Resource Class.
          Individual issued certificates cannot be revoked within the scope of
          this protocol.
</p>
<p>This command directs the issuer to immediately mark all issued
          valid certificates issued by this issuer within the named Resource
          Class with this client's SKI value to be marked as revoked, causing
          the issued certificates to be withdrawn from the publication
          repository and to be listed in the server's subsequent CRLs within
          this Resource Class.
</p>
<p></p>
<blockquote class="text"><dl>
<dt>class_name:</dt>
<dd>value is the issuer-assigned name of
              the issuer's Resource Class.<br />
<br />

</dd>
<dt>ski:</dt>
<dd>value is the encoded hash of the client's
              public key that is to be revoked. The algorithm for the encoding
              is to generate the 160-bit SHA-1 hash of the client's public
              key, as defined in method (1) of section 4.2.1.2 of <a class='info' href='#RFC3280'>[RFC3280]<span> (</span><span class='info'>Housley, R., Polk, W., Ford, W., and D. Solo, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; April&nbsp;2002.</span><span>)</span></a>, and encode this value using the Base
              64 encoding with URL and Filename Safe Alphabet, as defined in
              section 5 of <a class='info' href='#RFC4648'>[RFC4648]<span> (</span><span class='info'>Josefsson, S., &ldquo;The Base16, Base32, and Base64 Data Encodings,&rdquo; October&nbsp;2006.</span><span>)</span></a>.
</dd>
</dl></blockquote>

<a name="anchor35"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.5.2"></a><h3>3.5.2.&nbsp;
Certificate Revocation Response</h3>

<p>The value of the message "type" element for this response is:
          <br />
<br />
</p>
<blockquote class="text">
<p>type="revoke_response"
</p>
</blockquote>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

---------------------------------------------------------------

Payload:


&lt;key class_name="class name"
     ski="encoded hash of the subject public key" /&gt;

---------------------------------------------------------------

</pre></div>
<p></p>
<blockquote class="text"><dl>
<dt>class_name:</dt>
<dd>value is the issuer-assigned name of
              the server's Resource Class.<br />
<br />

</dd>
<dt>ski:</dt>
<dd>value is the encoded hash of the client's
              public key that is to be revoked. The algorithm for the encoding
              is to generate the 160-bit SHA-1 hash of the client's public
              key, as defined in method (1) of section 4.2.1.2 of <a class='info' href='#RFC3280'>[RFC3280]<span> (</span><span class='info'>Housley, R., Polk, W., Ford, W., and D. Solo, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; April&nbsp;2002.</span><span>)</span></a>, and encode this value using the Base
              64 encoding with URL and Filename Safe Alphabet, as defined in
              section 5 of <a class='info' href='#RFC4648'>[RFC4648]<span> (</span><span class='info'>Josefsson, S., &ldquo;The Base16, Base32, and Base64 Data Encodings,&rdquo; October&nbsp;2006.</span><span>)</span></a>.
</dd>
</dl></blockquote>

<a name="anchor36"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.6"></a><h3>3.6.&nbsp;
Request-Not-Performed Response</h3>

<p>The value of the message "type" element for this response is:
        <br />
<br />
</p>
<blockquote class="text">
<p>type="error_response"
</p>
</blockquote>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

---------------------------------------------------------------

Payload:


&lt;status&gt;[Code]&lt;/status&gt;
&lt;description xml:lang="en-US"&gt;[Readable text]&lt;/description&gt;

---------------------------------------------------------------

</pre></div>
<p>All states where an error response if to be generated, either due
        to detected errors or inconsistencies in the content of the request or
        server-side states that prevent the request being performed, generate
        a Request-Not-Performed response.
</p>
<p></p>
<blockquote class="text"><dl>
<dt>description:</dt>
<dd>value is a text field. This element MAY
            be present. It's value has no defined meaning within the scope of
            this protocol, and implementations may assume that some form of
            human-readable text may be used here. If the HTTP request that
            triggered this error response includes an Accept-Language header
            as defined in section 14.4 of the HTTP/1.1 specification [insert
            reference to RFC2616] then the server will make a best effort to
            include a second description element using the highest ranked
            preferred language of the client. The en-US description will
            always be included if the element is present.
</dd>
</dl></blockquote>

<p>The error code set is:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   Code Value    Description
   1101          already processing request
   1102          version number error
   1103          unrecognised request type
   1201          request - no such resource class
   1202          request - no resources allocated in resource class
   1203          request - badly formed certificate request
   1301          revoke - no such resource class
   1302          revoke - no such key 2000+ Server Error
   2001          Internal Server Error - Request not performed

</pre></div>
<a name="anchor37"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
XML Schema</h3>

<p>The following is a RelaxNG compact form schema describing the IR-ISP
      Protocol, version 1.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

default namespace = "http://www.apnic.net/specs/rescerts/up-down/"

  grammar {
    start = element message {
      attribute version { xsd:positiveInteger { maxInclusive="1" } },
      attribute sender { xsd:token { maxLength="1024" } },
      attribute recipient { xsd:token { maxLength="1024" } },
      payload
    }

    payload |= attribute type { "list" }, list_request
    payload |= attribute type { "list_response"}, list_response
    payload |= attribute type { "issue" }, issue_request
    payload |= attribute type { "issue_response"}, issue_response
    payload |= attribute type { "revoke" }, revoke_request
    payload |= attribute type { "revoke_response"}, revoke_response
    payload |= attribute type { "error_response"}, error_response

    list_request = empty
    list_response = class*

    class = element class {
      attribute class_name { xsd:token { maxLength="1024" } },
      attribute cert_url { xsd:string { maxLength="4096" } },
      attribute resource_set_as { xsd:string { maxLength="512000"
        pattern="[\-,0-9]*" } },
      attribute resource_set_ipv4 { xsd:string { maxLength="512000"
        pattern="[\-,/.0-9]*" } },
      attribute resource_set_ipv6 { xsd:string { maxLength="512000"
        pattern="[\-,/:0-9a-fA-F]*" } },
      attribute resource_set_notafter { xsd:dateTime },
      attribute suggested_sia_head { xsd:anyURI { maxLength="1024"
        pattern="rsync://.+"} }?,
      element certificate {
        attribute cert_url { xsd:string { maxLength="4096" } },
        attribute req_resource_set_as { xsd:string {
          maxLength="512000" pattern="[\-,0-9]*" } }?,
        attribute req_resource_set_ipv4 { xsd:string {
          maxLength="512000" pattern="[\-,/.0-9]*" } }?,
        attribute req_resource_set_ipv6 { xsd:string {
          maxLength="512000" pattern="[\-,/:0-9a-fA-F]*" } }?,
        xsd:base64Binary { maxLength="512000" }
      }*,
      element issuer { xsd:base64Binary { maxLength="512000" } }
    }

    issue_request = element request {
      attribute class_name { xsd:token { maxLength="1024" } },
      attribute req_resource_set_as { xsd:string {
        maxLength="512000" pattern="[\-,0-9]*" } }?,
      attribute req_resource_set_ipv4 { xsd:string {
        maxLength="512000" pattern="[\-,/.0-9]*" } }?,
      attribute req_resource_set_ipv6 { xsd:string {
        maxLength="512000" pattern="[\-,/:0-9a-fA-F]*" } }?,
      xsd:base64Binary { maxLength="512000"
      }
    }
    issue_response = class

    revoke_request = revocation

    revoke_response =
      revocation

    revocation = element key { attribute class_name { xsd:token {
      maxLength="1024" } }, attribute ski {
        xsd:token { maxLength="1024" } }
      }

    error_response =
      element status { xsd:positiveInteger {
        maxInclusive="999999999999999" }
      },
      element description { attribute xml:lang { xsd:language },
        xsd:string { maxLength="1024" }
      }?
  }

</pre></div>
<a name="anchor38"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Security Considerations</h3>

<p>[Note: this section requires further drafting.]
</p>
<p>The intent of this protocol is to define a protocol to
      support the maintenance of Resource Certificates that the server
      issues in certfying resources that have been allocated or
      assigned to the client <a class='info' href='#ID.SIDR-RES-CERTS'>[ID.SIDR&#8209;RES&#8209;CERTS]<span> (</span><span class='info'>Huston, G., Michaelson, G., and R. Loomans, &ldquo;A Profile for X.509 PKIX Resource Certificates,&rdquo; June&nbsp;2008.</span><span>)</span></a>. The
      primary objective of this provisioning protocol is to ensure
      that attempts to disrupt the interaction between client and
      server are identifiable by both parties.
</p>
<a name="anchor39"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
IANA Considerations</h3>

<p>[Note to IANA, to be removed prior to publication: there are no IANA
      considerations stated in this version of the document.]
</p>
<a name="anchor40"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Acknowledgements</h3>

<p>The authors would like to acknowledge the valued
      contributions from Russ Housley, Steve Kent, Randy Bush, George
      Michaelson, and Robert Kisteleki in the preparation of the
      protocol described in this document.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>8.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="ISO.8601:2004">[ISO.8601:2004]</a></td>
<td class="author-text">ISO, &ldquo;ISO 8601:2004 Representation of dates and Times,&rdquo; 2004.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC0791">[RFC0791]</a></td>
<td class="author-text">Postel, J., &ldquo;<a href="http://tools.ietf.org/html/rfc791">Internet Protocol</a>,&rdquo; STD&nbsp;5, RFC&nbsp;791, September&nbsp;1981 (<a href="ftp://ftp.isi.edu/in-notes/rfc791.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2050">[RFC2050]</a></td>
<td class="author-text">Hubbard, K., Kosters, M., Conrad, D., Karrenberg, D., and J. Postel, &ldquo;<a href="http://tools.ietf.org/html/rfc2050">INTERNET REGISTRY IP ALLOCATION GUIDELINES</a>,&rdquo; BCP&nbsp;12, RFC&nbsp;2050, November&nbsp;1996 (<a href="ftp://ftp.isi.edu/in-notes/rfc2050.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2050.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2050.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2818">[RFC2818]</a></td>
<td class="author-text">Rescorla, E., &ldquo;<a href="http://tools.ietf.org/html/rfc2818">HTTP Over TLS</a>,&rdquo; RFC&nbsp;2818, May&nbsp;2000 (<a href="ftp://ftp.isi.edu/in-notes/rfc2818.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3280">[RFC3280]</a></td>
<td class="author-text">Housley, R., Polk, W., Ford, W., and D. Solo, &ldquo;<a href="http://tools.ietf.org/html/rfc3280">Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>,&rdquo; RFC&nbsp;3280, April&nbsp;2002 (<a href="ftp://ftp.isi.edu/in-notes/rfc3280.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3779">[RFC3779]</a></td>
<td class="author-text">Lynn, C., Kent, S., and K. Seo, &ldquo;<a href="http://tools.ietf.org/html/rfc3779">X.509 Extensions for IP Addresses and AS Identifiers</a>,&rdquo; RFC&nbsp;3779, June&nbsp;2004 (<a href="ftp://ftp.isi.edu/in-notes/rfc3779.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3852">[RFC3852]</a></td>
<td class="author-text">Housley, R., &ldquo;<a href="http://tools.ietf.org/html/rfc3852">Cryptographic Message Syntax (CMS)</a>,&rdquo; RFC&nbsp;3852, July&nbsp;2004 (<a href="ftp://ftp.isi.edu/in-notes/rfc3852.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4049">[RFC4049]</a></td>
<td class="author-text">Housley, R., &ldquo;<a href="http://tools.ietf.org/html/rfc4049">BinaryTime: An Alternate Format for Representing Date and Time in ASN.1</a>,&rdquo; RFC&nbsp;4049, April&nbsp;2005 (<a href="ftp://ftp.isi.edu/in-notes/rfc4049.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4055">[RFC4055]</a></td>
<td class="author-text">Schaad, J., Kaliski, B., and R. Housley, &ldquo;<a href="http://tools.ietf.org/html/rfc4055">Additional Algorithms and Identifiers for RSA Cryptography for use in the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>,&rdquo; RFC&nbsp;4055, June&nbsp;2005 (<a href="ftp://ftp.isi.edu/in-notes/rfc4055.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4291">[RFC4291]</a></td>
<td class="author-text">Hinden, R. and S. Deering, &ldquo;<a href="http://tools.ietf.org/html/rfc4291">IP Version 6 Addressing Architecture</a>,&rdquo; RFC&nbsp;4291, February&nbsp;2006 (<a href="ftp://ftp.isi.edu/in-notes/rfc4291.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4648">[RFC4648]</a></td>
<td class="author-text">Josefsson, S., &ldquo;<a href="http://tools.ietf.org/html/rfc4648">The Base16, Base32, and Base64 Data Encodings</a>,&rdquo; RFC&nbsp;4648, October&nbsp;2006 (<a href="ftp://ftp.isi.edu/in-notes/rfc4648.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="X.501">[X.501]</a></td>
<td class="author-text">CCITT, &ldquo;Recommendation X.501: The Directory - Models,&rdquo; 1988.</td></tr>
<tr><td class="author-text" valign="top"><a name="X.509-88">[X.509-88]</a></td>
<td class="author-text">CCITT, &ldquo;Recommendation X.509: The Directory - Authentication Framework,&rdquo; 1988.</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>8.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="ID.SIDR-RES-CERTS">[ID.SIDR-RES-CERTS]</a></td>
<td class="author-text">Huston, G., Michaelson, G., and R. Loomans, &ldquo;A Profile for X.509 PKIX Resource Certificates,&rdquo; Work in progress: Internet Drafts&nbsp;draft-ietf-sidr-res-certs-10.txt, June&nbsp;2008.</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Geoff Huston</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Asia Pacific Network Information
      Centre</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">33 Park Rd</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Milton, QLD  4064</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Australia</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:gih@apnic.net">gih@apnic.net</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.apnic.net">http://www.apnic.net</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Robert Loomans</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Asia Pacific Network Information
      Centre</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">33 Park Rd</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Milton, QLD  4064</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Australia</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:robl@apnic.net">robl@apnic.net</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.apnic.net">http://www.apnic.net</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Byron Ellacott</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Asia Pacific Network Information
      Centre</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">33 Park Rd</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Milton, QLD  4064</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Australia</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:bje@apnic.net">bje@apnic.net</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.apnic.net">http://www.apnic.net</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Rob Austein</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Internet Systems Consortium</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">950 Charter St</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Redwood City, CA  94063</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:sra@isc.org">sra@isc.org</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2008).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
