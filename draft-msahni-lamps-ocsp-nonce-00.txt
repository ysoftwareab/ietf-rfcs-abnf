



LAMPS                                                      M. Sahni, Ed.
Internet-Draft                                        Palo Alto Networks
Intended status: Standards Track                           March 1, 2020
Expires: September 2, 2020


                          OCSP Nonce Extension
                    draft-msahni-lamps-ocsp-nonce-00

Abstract

   This document specifies the updated format of the nonce extension in
   Online Certificate Status Protocol (OCSP) request and response
   messages.  OCSP is used to check the status of a certificate and the
   Nonce extension is used in the OCSP request and response messages to
   avoid replay attacks.  This document updates the RFC 6960

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on September 2, 2020.

Copyright Notice

   Copyright (c) 2020 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (https://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.



Sahni                   Expires September 2, 2020               [Page 1]

Internet-Draft            OCSP Nonce Extension                March 2020


Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
     1.1.  Terminology . . . . . . . . . . . . . . . . . . . . . . .   2
   2.  OCSP Extensions . . . . . . . . . . . . . . . . . . . . . . .   2
     2.1.  Nonce Extension . . . . . . . . . . . . . . . . . . . . .   3
   3.  Security Considerations . . . . . . . . . . . . . . . . . . .   3
   4.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .   4
   5.  References  . . . . . . . . . . . . . . . . . . . . . . . . .   4
     5.1.  Normative References  . . . . . . . . . . . . . . . . . .   4
     5.2.  Informative References  . . . . . . . . . . . . . . . . .   4
   Author's Address  . . . . . . . . . . . . . . . . . . . . . . . .   5

1.  Introduction

   This document updates the usage and format of the nonce extension
   used in OCSP request and response messages.  This extension was
   previously defined in the section 4.1.1 of [RFC6960].  The [RFC6960]
   does not mention any minimum and maximum length of the nonce
   extension.  Due to not having an upper or lower limit of the length
   of the nonce extension, the OCSP responders that follow [RFC6960] may
   be vulnerable to various attacks like Denial of Service attacks,
   chosen prefix attacks to get desired signature of the OCSP responder
   and other possible evasions which can use nonce extension data.  This
   document specifies a lower limit of 1 and upper limit of 32 to the
   length of the Nonce extension.  This document updates the [RFC6960].

1.1.  Terminology

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in BCP
   14 [RFC2119] [RFC8174] when, and only when, they appear in all
   capitals, as shown here.

2.  OCSP Extensions

   The message format for the OCSP request and response is defined in
   the [RFC6960] [RFC5280].  It also defines the standard extensions for
   OCSP messages based on the extension model employed in X.509 version
   3 certificates (see [RFC5280]).  Following is the list of standard
   extensions that can be used in the OCSP messages by the OCSP
   responder and OCSP client.



      o  Nonce
      o  CRL References



Sahni                   Expires September 2, 2020               [Page 2]

Internet-Draft            OCSP Nonce Extension                March 2020


      o  Acceptable Response Types
      o  Archive Cutoff
      o  CRL Entry Extensions
      o  Service Locator
      o  Preferred Signature Algorithms
      o  Extended Response Definition

   This document only specifies the new format for Nonce extension and
   does not change specification of any of the other standard
   extensions.

2.1.  Nonce Extension

   The nonce cryptographically binds a request and a response to prevent
   replay attacks.  The nonce is included as one of the
   requestExtensions in requests, while in responses it would be
   included as one of the responseExtensions.  In both the request and
   the response, the nonce will be identified by the object identifier
   id-pkix-ocsp-nonce, while the extnValue is the value of the nonce.
   If nonce extension is present then the length of nonce MUST be
   atleast 1 byte and can be upto 32 bytes.

      id-pkix-ocsp           OBJECT IDENTIFIER ::= { id-ad-ocsp }

      id-pkix-ocsp-nonce     OBJECT IDENTIFIER ::= { id-pkix-ocsp 2 }

      Nonce ::= OCTET STRING(SIZE(1..32))

3.  Security Considerations

     The security considerations of OCSP in general are described in the
  [RFC6960].  The nonce extension is used to avoid replay attacks during
  the interval in which the previous OCSP response for a certificate is
  not expired but responder has a changed status for that certificate.
  Including client's Nonce value in the OCSP response makes sure that
  the response is a latest response from the server and not a old copy.

     3.1 Replay Attack

      The nonce extension is used to avoid replay attacks.  Since the
      OCSP responder may choose to not send the nonce extension in the
      OCSP response even if the client has sent the nonce extension in
      the request, a man in the middle (MITM) entity can intercept the
      OCSP request and respond with a earlier response from the server
      without the Nonce extension.  This can be mitigated by server
      using a closer nextUpdate value in the OCSP response.





Sahni                   Expires September 2, 2020               [Page 3]

Internet-Draft            OCSP Nonce Extension                March 2020


4.  IANA Considerations

      This document does not include any new media type registrations
      for OCSP.

5.  References

5.1.  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <http://www.rfc-editor.org/info/rfc2119>.

   [RFC8174]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in RFC
              2119 Key Words", DOI 10.17487/RFC8174, RFC 8174, BCP 14,
              May 2017, <https://www.rfc-editor.org/info/rfc8174>.

   [RFC3279]  Bassham, L., Polk, W., and R. Housley, "Algorithms and
              Identifiers for the Internet X.509 Public Key
              Infrastructure Certificate and Certificate Revocation List
              (CRL) Profile", RFC 3279, DOI 10.17487/RFC3279, April
              2002, <https://www.rfc-editor.org/info/rfc3279>.

   [RFC5280]  Cooper, D., Santesson, S., Farrell, S., Boeyen, S.,
              Housley, R., and W. Polk, "Internet X.509 Public Key
              Infrastructure Certificate and Certificate Revocation List
              (CRL) Profile", RFC 5280, DOI 10.17487/RFC5280, May 2008,
              <https://www.rfc-editor.org/info/rfc5280>.

   [RFC6960]  Santesson, S., Myers, M., Ankney, R., Malpani, A.,
              Galperin, S., and C. Adams, "X.509 Internet Public Key
              Infrastructure Online Certificate Status Protocol - OCSP",
              RFC 6960, DOI 10.17487/RFC6960, June 2013,
              <https://www.rfc-editor.org/info/rfc6960>.

5.2.  Informative References

   [RFC2560]  Myers, M., Ankney, R., Malpani, A., Galperin, S., and C.
              Adams, "X.509 Internet Public Key Infrastructure Online
              Certificate Status Protocol - OCSP", RFC 2560,
              DOI 10.17487/RFC2560, June 1999,
              <https://www.rfc-editor.org/info/rfc2560>.

   [RFC4732]  Handley, M., Ed., Rescorla, E., Ed., and IAB, "Internet
              Denial-of-Service Considerations", RFC 4732,
              DOI 10.17487/RFC4732, December 2006,
              <https://www.rfc-editor.org/info/rfc4732>.



Sahni                   Expires September 2, 2020               [Page 4]

Internet-Draft            OCSP Nonce Extension                March 2020


   [RFC5019]  Deacon, A. and R. Hurst, "The Lightweight Online
              Certificate Status Protocol (OCSP) Profile for High-Volume
              Environments", RFC 5019, DOI 10.17487/RFC5019, September
              2007, <https://www.rfc-editor.org/info/rfc5019>.

   [RFC5912]  Hoffman, P. and J. Schaad, "New ASN.1 Modules for the
              Public Key Infrastructure Using X.509 (PKIX)", RFC 5912,
              DOI 10.17487/RFC5912, June 2010,
              <https://www.rfc-editor.org/info/rfc5912>.

Author's Address

   Mohit Sahni (editor)
   Palo Alto Networks

   Email: msahni@paloaltonetworks.com



































Sahni                   Expires September 2, 2020               [Page 5]
