<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Context Label for MPLS EVPN</title>
<meta content="Yubao Wang" name="author">
<meta content="Bing Song" name="author">
<meta content="
       EVPN is designed to provide a better VPLS service than [RFC4761] and [RFC4762], and EVPN indeed introduced many new features which couldn't be achieved in those old VPLS implementions. But EVPN didn't inherit all features of old VPLS, and a few issues arises for EVPN only. 
       Some of these issues can be imputed to the MP2P nature of EVPN labels. The PW label in old VPLS is a label for P2P VC, so it contains more context than a identifier in dataplane for it's VSI instance.But the EVPN label just identifies it's VSI instnace and it can't stand for the ingress PE in dataplane. So the following issues arises with MPLS EVPN service: 
       
         MPLS EVPN statistics can't be done per ingress PE. 
         MPLS EVPN can't support hub/spoke use case which the spoke PE can only connect to each other by the hub PE. 
         MPLS EVPN can't support AR REPLICATOR. 
         MPLS EVPN can't support anycast SR-MPLS tunnel on the SPE nodes. 
       
       This document introduces a compound label stack to take advantage of both P2P VC and MP2P evpn labels. 
    " name="description">
<meta content="xml2rfc 2.47.0" name="generator">
<meta content="EVPN, Context, Label, VC" name="keyword">
<meta content="draft-wang-bess-evpn-context-label-04" name="ietf.draft">
<link href="/tmp/draft-wang-bess-evpn-context-label-04-9wd_kbqm.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">EVPN Context Label</td>
<td class="right">August 2020</td>
</tr></thead>
<tfoot><tr>
<td class="left">Wang &amp; Song</td>
<td class="center">Expires 21 February 2021</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">BESS WG</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2020-08-20" class="published">20 August 2020</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2021-02-21">21 February 2021</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">Y. Wang</div>
<div class="org">ZTE Corporation</div>
</div>
<div class="author">
      <div class="author-name">B. Song</div>
<div class="org">ZTE Corporation</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Context Label for MPLS EVPN</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">EVPN is designed to provide a better VPLS service than [RFC4761] and [RFC4762], and EVPN indeed introduced many new features which couldn't be achieved in those old VPLS implementions. But EVPN didn't inherit all features of old VPLS, and a few issues arises for EVPN only.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">Some of these issues can be imputed to the MP2P nature of EVPN labels. The PW label in old VPLS is a label for P2P VC, so it contains more context than a identifier in dataplane for it's VSI instance.But the EVPN label just identifies it's VSI instnace and it can't stand for the ingress PE in dataplane. So the following issues arises with MPLS EVPN service:<a href="#section-abstract-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-abstract-3.1">MPLS EVPN statistics can't be done per ingress PE.<a href="#section-abstract-3.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-abstract-3.2">MPLS EVPN can't support hub/spoke use case which the spoke PE can only connect to each other by the hub PE.<a href="#section-abstract-3.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-abstract-3.3">MPLS EVPN can't support AR REPLICATOR.<a href="#section-abstract-3.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-abstract-3.4">MPLS EVPN can't support anycast SR-MPLS tunnel on the SPE nodes.<a href="#section-abstract-3.4" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-abstract-4">This document introduces a compound label stack to take advantage of both P2P VC and MP2P evpn labels.<a href="#section-abstract-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 21 February 2021.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2020 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-terminology-and-acronyms" class="xref">Terminology and Acronyms</a><a href="#section-toc.1-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="xref">2</a>.  <a href="#name-problem-statement" class="xref">Problem Statement</a><a href="#section-toc.1-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-using-vc-label-to-add-conte" class="xref">Using VC Label to Add Context Data to EVPN Flows</a><a href="#section-toc.1-1.3.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1" class="keepWithNext"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-the-shared-context-vcs" class="xref">The Shared Context VCs</a><a href="#section-toc.1-1.3.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-the-per-evi-context-vcs" class="xref">The per-EVI Context VCs</a><a href="#section-toc.1-1.3.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-context-vc-signalling-proce" class="xref">Context VC Signalling Procedures</a><a href="#section-toc.1-1.4.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-construct-leaf-a-d-route-fo" class="xref">Construct Leaf A-D Route for IR</a><a href="#section-toc.1-1.4.2.1.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.4.2.1.2.1">
                    <p id="section-toc.1-1.4.2.1.2.1.1"><a href="#section-4.1.1" class="xref">4.1.1</a>.  <a href="#name-advertising-per-platform-vc" class="xref">Advertising Per-platform VC Label</a><a href="#section-toc.1-1.4.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.1.2.2">
                    <p id="section-toc.1-1.4.2.1.2.2.1"><a href="#section-4.1.2" class="xref">4.1.2</a>.  <a href="#name-advertising-context-specifi" class="xref">Advertising Context-Specific VC label</a><a href="#section-toc.1-1.4.2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.1.2.3">
                    <p id="section-toc.1-1.4.2.1.2.3.1"><a href="#section-4.1.3" class="xref">4.1.3</a>.  <a href="#name-csl-entry-extended-communit" class="xref">CSL-Entry Extended Community</a><a href="#section-toc.1-1.4.2.1.2.3.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-the-sharing-of-context-vcs" class="xref">The Sharing of Context VCs</a><a href="#section-toc.1-1.4.2.2.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a href="#section-4.2.1" class="xref">4.2.1</a>.  <a href="#name-using-admin-evi" class="xref">Using Admin-EVI</a><a href="#section-toc.1-1.4.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.2.2.2">
                    <p id="section-toc.1-1.4.2.2.2.2.1"><a href="#section-4.2.2" class="xref">4.2.2</a>.  <a href="#name-using-per-platform-vc-label" class="xref">Using per-platform VC labels</a><a href="#section-toc.1-1.4.2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.  <a href="#name-establish-ingress-replicati" class="xref">Establish Ingress Replication List by Leaf A-D Route</a><a href="#section-toc.1-1.4.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="xref">4.4</a>.  <a href="#name-backward-compatibility" class="xref">Backward Compatibility</a><a href="#section-toc.1-1.4.2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-solutions" class="xref">Solutions</a><a href="#section-toc.1-1.5.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-solution-for-source-squelch" class="xref">Solution for Source-Squelching in Hub-Spoke Scenarios</a><a href="#section-toc.1-1.5.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-solution-for-per-ingress-st" class="xref">Solution for per ingress statistics</a><a href="#section-toc.1-1.5.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="xref">5.3</a>.  <a href="#name-solution-for-ar-replicator-" class="xref">Solution for AR REPLICATOR in MPLS EVPN</a><a href="#section-toc.1-1.5.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="xref">5.4</a>.  <a href="#name-solution-for-anycast-tunnel" class="xref">Solution for anycast tunnel usage on SPE</a><a href="#section-toc.1-1.5.2.4.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.5.2.4.2.1">
                    <p id="section-toc.1-1.5.2.4.2.1.1"><a href="#section-5.4.1" class="xref">5.4.1</a>.  <a href="#name-control-plane" class="xref">Control-plane</a><a href="#section-toc.1-1.5.2.4.2.1.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.5.2.4.2.1.2.1">
                        <p id="section-toc.1-1.5.2.4.2.1.2.1.1"><a href="#section-5.4.1.1" class="xref">5.4.1.1</a>.  <a href="#name-downstream-cls-id-extended-" class="xref">Downstream-CLS ID Extended Community</a><a href="#section-toc.1-1.5.2.4.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                      <li class="toc ulEmpty compact" id="section-toc.1-1.5.2.4.2.1.2.2">
                        <p id="section-toc.1-1.5.2.4.2.1.2.2.1"><a href="#section-5.4.1.2" class="xref">5.4.1.2</a>.  <a href="#name-context-specific-label-swap" class="xref">Context-specific Label Swapping</a><a href="#section-toc.1-1.5.2.4.2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
                    </ul>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.5.2.4.2.2">
                    <p id="section-toc.1-1.5.2.4.2.2.1"><a href="#section-5.4.2" class="xref">5.4.2</a>.  <a href="#name-data-plane" class="xref">Data-plane</a><a href="#section-toc.1-1.5.2.4.2.2.1" class="pilcrow">¶</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.5.2.4.2.3">
                    <p id="section-toc.1-1.5.2.4.2.3.1"><a href="#section-5.4.3" class="xref">5.4.3</a>.  <a href="#name-the-generating-of-downstrea" class="xref">The Generating of Downstream-CLS ID EC on SPE</a><a href="#section-toc.1-1.5.2.4.2.3.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a><a href="#section-toc.1-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a><a href="#section-toc.1-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-acknowledgements" class="xref">Acknowledgements</a><a href="#section-toc.1-1.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-references" class="xref">References</a><a href="#section-toc.1-1.9.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="xref">9.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a><a href="#section-toc.1-1.9.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="xref">9.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a><a href="#section-toc.1-1.9.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-appendix.a" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a><a href="#section-toc.1-1.10.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<section id="section-1">
      <h2 id="name-terminology-and-acronyms">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-terminology-and-acronyms" class="section-name selfRef">Terminology and Acronyms</a>
      </h2>
<p id="section-1-1">
  This document uses the following acronyms and terms:<a href="#section-1-1" class="pilcrow">¶</a></p>
<ul class="ulEmpty normal">
<li class="ulEmpty normal" id="section-1-2.1">
   BUM - Broadcast, Unknown unicast, and Multicast.<a href="#section-1-2.1" class="pilcrow">¶</a>
</li>
        <li class="ulEmpty normal" id="section-1-2.2">
   CE - Customer Edge equipment.<a href="#section-1-2.2" class="pilcrow">¶</a>
</li>
        <li class="ulEmpty normal" id="section-1-2.3">
   PE - Provider Edge equipment.<a href="#section-1-2.3" class="pilcrow">¶</a>
</li>
        <li class="ulEmpty normal" id="section-1-2.4">
   OPE - Originating PE - the original Router of an EVPN route.<a href="#section-1-2.4" class="pilcrow">¶</a>
</li>
        <li class="ulEmpty normal" id="section-1-2.5">
   ORIP - Originating Router's IP address.<a href="#section-1-2.5" class="pilcrow">¶</a>
</li>
        <li class="ulEmpty normal" id="section-1-2.6">
   Root ORIP - The ORIP in the Route Key field of a Leaf A-D route is called as that Leaf A-D route's Root ORIP. 
               The Route Key field is the "Route Type specific" field of an PMSI route for which that Leaf A-D route is generated. 
    When that PMSI route is an IMET route, that Leaf A-D route's root ORIP is that IMET route's "Originating Router's IP Address".<a href="#section-1-2.6" class="pilcrow">¶</a>
</li>
        <li class="ulEmpty normal" id="section-1-2.7">
   Leaf ORIP - The "Originator's Addr" field of the "Route Type specific" field of a Leaf A-D route is called as that Leaf A-D route's Leaf ORIP.<a href="#section-1-2.7" class="pilcrow">¶</a>
</li>
        <li class="ulEmpty normal" id="section-1-2.8">
   Self ORIP - The Leaf ORIP of a Leaf A-D route is also called as that Leaf A-D route's "self ORIP".<a href="#section-1-2.8" class="pilcrow">¶</a>
</li>
        <li class="ulEmpty normal" id="section-1-2.9">
   PTA - PMSI Tunnel Attribute.<a href="#section-1-2.9" class="pilcrow">¶</a>
</li>
        <li class="ulEmpty normal" id="section-1-2.10">
   PTA label - The MPLS label field of PMSI Tunnel Attribute.<a href="#section-1-2.10" class="pilcrow">¶</a>
</li>
        <li class="ulEmpty normal" id="section-1-2.11">
   PTA flags - The flags field of PMSI Tunnel Attribute.<a href="#section-1-2.11" class="pilcrow">¶</a>
</li>
        <li class="ulEmpty normal" id="section-1-2.12">
   IR - Ingress Replication.<a href="#section-1-2.12" class="pilcrow">¶</a>
</li>
        <li class="ulEmpty normal" id="section-1-2.13">
   AR - Assisted Replication.<a href="#section-1-2.13" class="pilcrow">¶</a>
</li>
        <li class="ulEmpty normal" id="section-1-2.14">
   IR PTA - PMSI Tunnel Attribute with tunnel-type = IR.<a href="#section-1-2.14" class="pilcrow">¶</a>
</li>
        <li class="ulEmpty normal" id="section-1-2.15">
   AR PTA - PMSI Tunnel Attribute with tunnel-type = AR.<a href="#section-1-2.15" class="pilcrow">¶</a>
</li>
        <li class="ulEmpty normal" id="section-1-2.16">
   IRL - Ingress Replication List, the list for Ingress-Replication BUM packets forwarding.<a href="#section-1-2.16" class="pilcrow">¶</a>
</li>
        <li class="ulEmpty normal" id="section-1-2.17">
   LS - Label Space.<a href="#section-1-2.17" class="pilcrow">¶</a>
</li>
        <li class="ulEmpty normal" id="section-1-2.18">CL - Context-identifying Label, or Context Label, A "context label" is one label that 
   identifies a label table in which the label immediately below the
   context label should be looked up.  It is defined in <span>[<a href="#RFC5331" class="xref">RFC5331</a>]</span> section 3.<a href="#section-1-2.18" class="pilcrow">¶</a>
</li>
        <li class="ulEmpty normal" id="section-1-2.19">
   CLS - Context Label-Space, a Label Space that is identified by a Context Label. 
         In <span>[<a href="#RFC5331" class="xref">RFC5331</a>]</span>, it is called as "Context-specific Label Space".<a href="#section-1-2.19" class="pilcrow">¶</a>
</li>
        <li class="ulEmpty normal" id="section-1-2.20">
   CSL - Context-Specific Label, a MPLS label that is allocated in a Context Label Space (CLS) which is identified by a CL.
         Note that a CSL is totally different from a CL. A CL itself is typically allocated in the per-platform label space.<a href="#section-1-2.20" class="pilcrow">¶</a>
</li>
        <li class="ulEmpty normal" id="section-1-2.21">
   CSL-Entry - Context-Specific Label Entry, a specific MPLS label allocated in a specific Context Label Space (CLS).<a href="#section-1-2.21" class="pilcrow">¶</a>
</li>
        <li class="ulEmpty normal" id="section-1-2.22">
   EVI - EVPN Instance.<a href="#section-1-2.22" class="pilcrow">¶</a>
</li>
        <li class="ulEmpty normal" id="section-1-2.23">
   EVL - EVI label, a MPLS label identifies an EVPN Instance (EVI) or a MAC/IP/Prefix in that EVPN instance.<a href="#section-1-2.23" class="pilcrow">¶</a>
</li>
        <li class="ulEmpty normal" id="section-1-2.24">
   EVPN label - The MPLS label in an EVPN route. It includes ESI label and EVL.<a href="#section-1-2.24" class="pilcrow">¶</a>
</li>
        <li class="ulEmpty normal" id="section-1-2.25">
   Admin EVI - A EVPN Instance (EVI) that is responsible for specific signalling work for other EVIs.<a href="#section-1-2.25" class="pilcrow">¶</a>
</li>
        <li class="ulEmpty normal" id="section-1-2.26">
   EC - Extended Community<a href="#section-1-2.26" class="pilcrow">¶</a>
</li>
        <li class="ulEmpty normal" id="section-1-2.27">
   SR-TL - Segment Routing (SR) Tunnel Label (TL).<a href="#section-1-2.27" class="pilcrow">¶</a>
</li>
        <li class="ulEmpty normal" id="section-1-2.28">
   ILM - Incoming Label Map, which is defined in <span>[<a href="#RFC3031" class="xref">RFC3031</a>]</span> section 3.11.<a href="#section-1-2.28" class="pilcrow">¶</a>
</li>
        <li class="ulEmpty normal" id="section-1-2.29">
   CLS ILM - CLS-Specific ILM, an ILM that is installed in a "Context-specific Label Space".<a href="#section-1-2.29" class="pilcrow">¶</a>
</li>
        <li class="ulEmpty normal" id="section-1-2.30">
   Transit LSP - A LSP whose label operation for its ILM label is Label Swapping.<a href="#section-1-2.30" class="pilcrow">¶</a>
</li>
        <li class="ulEmpty normal" id="section-1-2.31">IMET-H Route - An IMET route that is advertised from hub-PE to spoke-PEs.<a href="#section-1-2.31" class="pilcrow">¶</a>
</li>
        <li class="ulEmpty normal" id="section-1-2.32">IMET-S Route - An IMET route that is advertised from spoke-PE to hub-PE.<a href="#section-1-2.32" class="pilcrow">¶</a>
</li>
        <li class="ulEmpty normal" id="section-1-2.33">VCL - VC Label.<a href="#section-1-2.33" class="pilcrow">¶</a>
</li>
        <li class="ulEmpty normal" id="section-1-2.34">Context VC - Context-identifying VC, a VC that identifies the ingress PE (see <a href="#sect-solution-spoke-pe" class="xref">Section 5.1</a>) or egress PE (see <a href="#sect-Anycast-SPEs" class="xref">Section 5.4</a>) of a data packet.<a href="#section-1-2.34" class="pilcrow">¶</a>
</li>
      </ul>
</section>
<section id="section-2">
      <h2 id="name-problem-statement">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-problem-statement" class="section-name selfRef">Problem Statement</a>
      </h2>
<p id="section-2-1">EVPN is designed to provide a better VPLS service than RFC4761/RFC4762, and EVPN indeed introduced many new features which couldn't be achieved in those old VPLS implemention.But EVPN didn't inherit all features of old VPLS, and a few issues arises for EVPN only.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">Some of these issues can be imputed to the MP2P nature of EVPN labels. The PW label in old VPLS is a label for P2P VC, so it contains more context than an identifier in dataplane for it's VSI instance. But the EVPN label just identifies it's VSI instnace and it can't stand for the ingress PE in dataplane. So the following issues arises with MPLS EVPN service:<a href="#section-2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-3.1">MPLS EVPN statistics can't be done per ingress PE. All flows from remote PEs share the same statistics on egress PE, because they share the same EVPN label and the egress PE can't pick them out in the dataplane.<a href="#section-2-3.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.2">MPLS EVPN can't support hub/spoke usecase, where the spoke PEs can only connect to each other through the hub PE. Especially when at least two of the spoke PEs are connected to a common route reflector.<a href="#section-2-3.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.3">MPLS EVPN can't work as an AR-REPLICATOR. Because the AR-REPLICATOR will apply replication for the ingress AR-LEAF too. But a packet shoud not be sent back to the AR-LEAF where it is received from.<a href="#section-2-3.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.4">MPLS EVPN SPE cannot make use of SR-MPLS anycast tunnel because the two SPEs of the anycast tunnel will assign different EVPN labels for the same EVPN route.<a href="#section-2-3.4" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-2-4">So this document introduces an compound label stack to take advantage of both P2P VC and MP2P EVPN labels.<a href="#section-2-4" class="pilcrow">¶</a></p>
</section>
<section id="section-3">
      <h2 id="name-using-vc-label-to-add-conte">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-using-vc-label-to-add-conte" class="section-name selfRef">Using VC Label to Add Context Data to EVPN Flows</a>
      </h2>
<p id="section-3-1">In order to add as much context as old VPLS to EVPN data packet, 
  We can construct an infrastructure by a full-mesh of context-VCs among the EVPN PEs.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">Take the context-VCs between PE-i and PE-j as an example, 
  VC-ij is the context-VC from PE-i to PE-j, and VC-ji is the context-VC from PE-j to PE-i. 
  The VC-ij identifies the PE-i node on PE-j. The VC-ji identifies PE-j node on PE-i. 
  The VC-label for VC-ij is called as L-ij, and the VC-label for VC-ji is called as L-ji.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">So the PE-i can push the L-ij onto the EVPN data packet for PE-j to distinguish the packet of PE-i from other data packets. 
  Because that the L-ij identifies the ingress PE of the data packet.<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">There are two styles of context-VC in this draft. 
  One style is named as shared context-VC, the other style is named as per-EVI context VC.<a href="#section-3-4" class="pilcrow">¶</a></p>
<section id="section-3.1">
        <h3 id="name-the-shared-context-vcs">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-the-shared-context-vcs" class="section-name selfRef">The Shared Context VCs</a>
        </h3>
<p id="section-3.1-1">The shared context-VCs are dedicated to identify the context for a data packet while the EVPN label still identifies the EVPN instance.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">Note that typically a shared context VC can be shared by all EVPN instances between it's ingress PE and egress PE. 
 In other words, we don't have to establish a dedicated mesh of context VCs for each specified EVPN service. 
 So we called the shared context VCs as a common infrastructure for those EVPN services.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
</section>
<section id="section-3.2">
        <h3 id="name-the-per-evi-context-vcs">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-the-per-evi-context-vcs" class="section-name selfRef">The per-EVI Context VCs</a>
        </h3>
<p id="section-3.2-1">The per-EVI context VCs are used to identify both the context (typically the ingress-PE) and the EVPN instance for a data packet at the same time. 
 In other words, we have to establish a dedicated set of per-EVI context VCs for each specified EVPN service.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
</section>
</section>
<div id="sect-context-vc-signal">
<section id="section-4">
      <h2 id="name-context-vc-signalling-proce">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-context-vc-signalling-proce" class="section-name selfRef">Context VC Signalling Procedures</a>
      </h2>
<p id="section-4-1">The IMET route per <span>[<a href="#RFC7432" class="xref">RFC7432</a>]</span> have a corresponding route-type in MVPN. It is, in effect, the Intra-AS I-PMSI route per <span>[<a href="#RFC6514" class="xref">RFC6514</a>]</span>. 
  The difference between them is that an IMET route won't handle a responding Leaf A-D route, but an Intra-AS I-PMSI route will.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">The Leaf A-D route per <span>[<a href="#I-D.ietf-bess-evpn-bum-procedure-updates" class="xref">I-D.ietf-bess-evpn-bum-procedure-updates</a>]</span> is required for per-EVI context VCs. 
  In this draft, we use the Leaf A-D route with IR-PTA to establish per-EVI context-VCs. 
  The Leaf A-D route is generated for an IMET route.<a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3">It is an update for <span>[<a href="#RFC7432" class="xref">RFC7432</a>]</span>. The backward compatibility will be described in <a href="#sect-compatibility" class="xref">Section 4.4</a>.<a href="#section-4-3" class="pilcrow">¶</a></p>
<div id="sect-leaf-ad">
<section id="section-4.1">
        <h3 id="name-construct-leaf-a-d-route-fo">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-construct-leaf-a-d-route-fo" class="section-name selfRef">Construct Leaf A-D Route for IR</a>
        </h3>
<p id="section-4.1-1">PE1 will construct a Leaf A-D route with IR-PTA for EVI1 in response to an IMET route R1 with IR-PTA. 
  The IMET route R1 is received from PE2 previously. 
             The key fields of the IMET route is included in the "Route Key" field of the Leaf A-D route (say R2) along with the ORIP of PE1 itself.
  We call the ORIP of PE1 itself as the Leaf A-D route's "self-ORIP" in order to distinguish it from the Leaf A-D route's Root-ORIP.
  So the "Route Type sepcific" field of the Leaf A-D route is per &lt;EVI1, PE2&gt; basis.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<div id="sect-adv-per-platform-vc">
<section id="section-4.1.1">
          <h4 id="name-advertising-per-platform-vc">
<a href="#section-4.1.1" class="section-number selfRef">4.1.1. </a><a href="#name-advertising-per-platform-vc" class="section-name selfRef">Advertising Per-platform VC Label</a>
          </h4>
<p id="section-4.1.1-1">The MPLS label field in the IR-PTA of the Leaf A-D route is allocated per &lt;EVI1, PE2&gt; basis in per-platform label space on PE1. 
      So the per-EVI context VC can identify the EVI1 too.<a href="#section-4.1.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1.1-2">Note that PE1 may already advertise an IMET route R3 to PE2 before the advertisement of above Leaf A-D route.<a href="#section-4.1.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-adv-csl-based-vc">
<section id="section-4.1.2">
          <h4 id="name-advertising-context-specifi">
<a href="#section-4.1.2" class="section-number selfRef">4.1.2. </a><a href="#name-advertising-context-specifi" class="section-name selfRef">Advertising Context-Specific VC label</a>
          </h4>
<p id="section-4.1.2-1">Note that the per &lt;EVI,Ingress PE&gt; basis label allocation (see <a href="#sect-adv-per-platform-vc" class="xref">Section 4.1.1</a>) 
  may consume too many  labels in per-platform label space. 
  Sometimes we want to use the same EVPN label in all Leaf A-D routes and IMET routes of the same EVI.
  So we allocate a context-specific label (CSL) for a context VC in this section.<a href="#section-4.1.2-1" class="pilcrow">¶</a></p>
<p id="section-4.1.2-2">The EVPN label is still allocated from per-platform label space, 
          and it identifies the EVPN instance as per [RFC7432]. 
  But it also identifies a context label space CLS1.
  The VC label of the context VC is allocated in CLS1. 
  So we say that the VC label is a context-specific VC label.<a href="#section-4.1.2-2" class="pilcrow">¶</a></p>
<p id="section-4.1.2-3">The encapsulation of the Context-Specific VC Label is illustrated as the following figure:<a href="#section-4.1.2-3" class="pilcrow">¶</a></p>
<span id="name-encapsulation-of-evi-specif"></span><div id="Payload-Context-Figure">
<figure id="figure-1">
            <div class="artwork art-text alignCenter" id="section-4.1.2-4.1">
<pre>
+---------------------------------+
|  underlay ethernet header       |
+---------------------------------+
|  PSN tunnel label               |
+---------------------------------+
|  EVPN label                     |
+---------------------------------+
|  Context VC Label               |
+---------------------------------+
|  overlay ethernet or IP header  |
+---------------------------------+

</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-encapsulation-of-evi-specif" class="selfRef">Encapsulation of EVI-Specific VC Label for EVPN Payload</a>
            </figcaption></figure>
</div>
<p id="section-4.1.2-5">Note that the Context-VC Label here is not the Context Label Space (CLS) ID of the EVPN Label. 
              But the EVPN label is the CLS-ID of the Context-VC Label. 
  That's why the Context Label Space ID EC (see section 3.1 of <span>[<a href="#I-D.ietf-bess-mvpn-evpn-aggregation-label" class="xref">I-D.ietf-bess-mvpn-evpn-aggregation-label</a>]</span>)
  is not appropriate for such encapsulation.<a href="#section-4.1.2-5" class="pilcrow">¶</a></p>
<p id="section-4.1.2-6"> We introduce a new BGP Extended Community called Context-specific Label (CSL) Entry Extended Community, 
  the CSL-Entry EC was used to carry the downstream-assigned context-specific VC labels.<a href="#section-4.1.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-CSL-EC">
<section id="section-4.1.3">
          <h4 id="name-csl-entry-extended-communit">
<a href="#section-4.1.3" class="section-number selfRef">4.1.3. </a><a href="#name-csl-entry-extended-communit" class="section-name selfRef">CSL-Entry Extended Community</a>
          </h4>
<p id="section-4.1.3-1">
   CSL-Entry Extended Community is a new Transitive Opaque
   EC with the following structure (Sub-Type value to be assigned by
   IANA):<a href="#section-4.1.3-1" class="pilcrow">¶</a></p>
<span id="name-csl-entry-extended-community"></span><div id="CSL-EC-Figure">
<figure id="figure-2">
            <div class="artwork art-text alignCenter" id="section-4.1.3-2.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| 0x03 or 0x43  |   Sub-Type    |      CSL-Type                 |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                         CSL-Value                             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-csl-entry-extended-community" class="selfRef">CSL-Entry Extended Community</a>
            </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-4.1.3-3.1">CSL-Type: A 2-octet field that specifies the type of Context-Specific Label (CSL).  
   In this document, the CSL-Type is 0, indicating that the CSL-Value field 
   is a downstream-assigned label whose label space is identified by the EVPN label of the same route.<a href="#section-4.1.3-3.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.1.3-3.2">CSL-Value: A 4-octet field that specifies the value of CSL-Entry.
      When it is a label (with CSL-Type 0), the most significant
      20-bit is set to the label value.<a href="#section-4.1.3-3.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.1.3-4">The "sub-type" field of the CSL-Entry EC has a different codepoint from the CLS-ID EC.
              The CSL-Value of the CSL-Entry EC is a MPLS label in a context-specific label space identified by the PTA label.
              And the MPLS label in the CSL-Entry EC will be pushed onto the label stack before the PTA label by the ingress PE.
              Typically, the MPLS label of the CSL-Entry EC is a downstream assigned label, which means that it will be used as an outgoing label by the PE receiving the CSL-Entry EC, not as incomming label.<a href="#section-4.1.3-4" class="pilcrow">¶</a></p>
<p id="section-4.1.3-5">When constructing the Leaf A-D route, the IR-PTA label is the EVPN Label, as per [RFC7432]. 
          But the CSL-value in the CSL-Entry EC is a label (say L1) that is allocated per TPE basis in CLS1.
                 In fact, L1 is the context-specific VC label of the context VC of that ingress TPE.   
          That's why the context VC is called as CSL-based context VC. 
          So the CLS1-specific VC label need to be pushed onto the label stack before EVPN Label (which identifies CLS1) on ingress PEs.<a href="#section-4.1.3-5" class="pilcrow">¶</a></p>
<p id="section-4.1.3-6">Note that when the PTA label is changed to a new value (caused by the BGP nexthop rewriting) by the SPE nodes, 
  the CSL-Entry in the same EVPN route won't be rewrite. This is similar to the behavior of ESI Label EC of EAD per ES route.<a href="#section-4.1.3-6" class="pilcrow">¶</a></p>
<p id="section-4.1.3-7">Note that when an ingress PE sends traffic, it imposes the CSL before it imposes the 
                 PTA label of the same EVPN route. That's the obvious difference from the Context Label Space ID EC (see section 3.1 of <span>[<a href="#I-D.ietf-bess-mvpn-evpn-aggregation-label" class="xref">I-D.ietf-bess-mvpn-evpn-aggregation-label</a>]</span>).<a href="#section-4.1.3-7" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sect-vc-sharing">
<section id="section-4.2">
        <h3 id="name-the-sharing-of-context-vcs">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-the-sharing-of-context-vcs" class="section-name selfRef">The Sharing of Context VCs</a>
        </h3>
<div id="sect-vc-sharing.1">
<section id="section-4.2.1">
          <h4 id="name-using-admin-evi">
<a href="#section-4.2.1" class="section-number selfRef">4.2.1. </a><a href="#name-using-admin-evi" class="section-name selfRef">Using Admin-EVI</a>
          </h4>
<p id="section-4.2.1-1"> Note that the CSL-Entry ECs (for different EVIs) received from the same TPE may be the same label,
          because that all EVLs on the same PE may identify the same Context-specific Label Space (CLS).
                 So we can select a single EVI to use the Leaf A-D route with CSL-Entry EC in such case.
                 This EVI is called as administrating EVI (admin-EVI). 
          The context VC label carried in the Leaf A-D routes of the admin-EVI will be used
  to take the place of the PTA label of the IMET route with the same ORIP in all other ordinary EVIs in such case.<a href="#section-4.2.1-1" class="pilcrow">¶</a></p>
<p id="section-4.2.1-2"> Note that all other ordinary EVIs don't have to use the Leaf A-D routes with IR-PTA in their signalling procedures, they can use ordinary IMET routes instead.
                 The admin-EVI need to be configured on all EVPN-PEs in such case.<a href="#section-4.2.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-vc-sharing.2">
<section id="section-4.2.2">
          <h4 id="name-using-per-platform-vc-label">
<a href="#section-4.2.2" class="section-number selfRef">4.2.2. </a><a href="#name-using-per-platform-vc-label" class="section-name selfRef">Using per-platform VC labels</a>
          </h4>
<p id="section-4.2.2-1">The admin EVIs may allocate the VC labels of its context VCs in the per-platform label space.<a href="#section-4.2.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2.2-2"> Even if these VC labels are allocated in the per-platform label space,
  The CSL-Entry EC is still necessary.<a href="#section-4.2.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2.2-3">Because that the Context VC is not expected to be used to determine the forwarding path of the data packet.
                 They just identify the context of the data packet (typically the ingress PE of the data packet).
                 So they should not be rewritten even when the nexthop of the EVPN route is rewriten.
                 When the Leaf routes use PTA label (instead of CSL-entry EC) to carry the Context VC Label,
                 The PTA label will be rewritten on SPE nodes. It is just not our expectation.<a href="#section-4.2.2-3" class="pilcrow">¶</a></p>
<p id="section-4.2.2-4">Note that the SPEs don't have to recognize the CSL-Entry EC, because that it's a transitive opaque EC.
  The EVPN label of the admin-EVIs in the PTA is unuseful. But they should also be included so as to pass though the SPE nodes.<a href="#section-4.2.2-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sect-irl">
<section id="section-4.3">
        <h3 id="name-establish-ingress-replicati">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-establish-ingress-replicati" class="section-name selfRef">Establish Ingress Replication List by Leaf A-D Route</a>
        </h3>
<span id="name-the-leaf-a-d-routes-ordinal"></span><div id="Leaf-AD-Seq-Figure">
<figure id="figure-3">
          <div class="artwork art-text alignCenter" id="section-4.3-1.1">
<pre>
     T1: ===R3(IMET)======&gt;
PE1----------------------------PE2
     T2: &lt;==R1(IMET)=======
     T3: ===R2(Leaf A-D)==&gt;
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-the-leaf-a-d-routes-ordinal" class="selfRef">The Leaf A-D Route's Ordinal Number</a>
          </figcaption></figure>
</div>
<p id="section-4.3-2">PE2 receives (at time T3) the responding Leaf A-D route (say R2) of the IMET route R1 which is previously (at time T2) advertised by itself,
  and PE2 preiously (at time T1) received an IMET route R3 whose ORIP is the same as the self-ORIP of R2 .
  Given that R1,R2 and R3 both have a IR-PTA, PE2 SHOULD use R2 to install the Ingress Replication List (IRL) item for PE1 instead,
  and R3 will not used to install the IRL-item for PE1 from then on.<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<p id="section-4.3-3">Note that when R2 included a CSL-Entry EC, the CSL-value of the CSL-Entry EC will be used as the outgoing label of the IRL-item.
  The MPLS label of the IR-PTA will be used as the context label (CL) of the CSL-Entry in NHLFE.
  No ILM entry will be installed for the CSL of R2 on PE2.<a href="#section-4.3-3" class="pilcrow">¶</a></p>
<p id="section-4.3-4">Note that when PE2 sent R1 (at time T2) to other PEs(including PE1), it will set the LIR flag of R1 to one.
  At the same time, PE2 will add an import RT (say RT1) to the EVPN instance.
  When PE1 send R2 (at time T3) to PE2 as R1's reply, PE1 will add the same RT1 to R2, 
  because PE1 assumes that RT1 should have been added to the EVPN instance by PE2 as an import RT.
  Otherwise PE2 wouldn't set the LIR flag to one during the advertisement of R1.<a href="#section-4.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-compatibility">
<section id="section-4.4">
        <h3 id="name-backward-compatibility">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-backward-compatibility" class="section-name selfRef">Backward Compatibility</a>
        </h3>
<p id="section-4.4-1">In <span>[<a href="#RFC7432" class="xref">RFC7432</a>]</span>, the LIR flag of IMET route is required to be zero when it is advertised and to be ignored on receipt.<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<p id="section-4.4-2">It means that the LIR flag is reserved by  <span>[<a href="#RFC7432" class="xref">RFC7432</a>]</span>, but it technically can be used in the future. 
  What should the LIR flag be restrained in the future use is no more severer than any other reserved PTA flags in the IMET routes.<a href="#section-4.4-2" class="pilcrow">¶</a></p>
<p id="section-4.4-3">So when PE2 set the LIR flag to one in the IMET route and send it to PE1, PE2 won't expect that the IMET route must be responded by a Leaf A-D. 
  When the corresponding Leaf A-D route can't be received from PE1, the IMET route from PE1 still be used as per <span>[<a href="#RFC7432" class="xref">RFC7432</a>]</span>.
  But when PE1 is a new PE following this draft, PE1 will indeed respond a Leaf A-D route for the IMET route.<a href="#section-4.4-3" class="pilcrow">¶</a></p>
<p id="section-4.4-4">The EVPN S-PMSI routes for (C-*,C-*) may be a succedaneum of IMET routes. 
  Such EVPN S-PMSI route is called wildcard S-PMSI route in these document.
  The LIR flag of wildcard S-PMSI route is not reserved.
  So there won't be any controversial issues on the compatibilities of Leaf A-D route responsing. 
  But we prefer the IMET routes, because the IMET routes with non-zero LIR flag won't conflict with <span>[<a href="#RFC7432" class="xref">RFC7432</a>]</span> either.<a href="#section-4.4-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<section id="section-5">
      <h2 id="name-solutions">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-solutions" class="section-name selfRef">Solutions</a>
      </h2>
<div id="sect-solution-spoke-pe">
<section id="section-5.1">
        <h3 id="name-solution-for-source-squelch">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-solution-for-source-squelch" class="section-name selfRef">Solution for Source-Squelching in Hub-Spoke Scenarios</a>
        </h3>
<span id="name-hub-pe-and-spoke-pes"></span><div id="Spoke-Figure">
<figure id="figure-4">
          <div class="artwork art-text alignCenter" id="section-5.1-1.1">
<pre>
       PEs3--------RR2--------+
                              PEh------CE3
CE1----PEs1--------RR1--------+
                   /
CE2----PEs2-------/
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-hub-pe-and-spoke-pes" class="selfRef">Hub PE and Spoke PEs</a>
          </figcaption></figure>
</div>
<p id="section-5.1-2">Now take above use case for example, there are three spoke PEs and one hub PE. The spoke PEs are PEs1, PEs2 and PEs3. The hub PE is PEh. Two of the spoke PEs (PEs1 and PEs2) are connected to the same RR group and the third one connects to another RR group.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1-3">Although we can advertise different EVPN labels for different RR groups, 
  we can't advertise different EVPN labels for PEs1 and PEs2 in the form of current IMET routes.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
<ul class="ulEmpty normal">
<li class="ulEmpty normal" id="section-5.1-4.1">In order to advertise different EVPN labels for PEs1 and PEs2, 
  PEh may use BGP ADD-PATH to advertise two NLRIs (of the same EVI) to RR1, each along with a different EVPN label.<a href="#section-5.1-4.1" class="pilcrow">¶</a>
</li>
          <li class="ulEmpty normal" id="section-5.1-4.2">But that approach will cause some issues. Because that the BGP ADD-PATH is typically used for ECMP purpose.
  But we don't expect RR1 to do ECMP for these two NLRIs. That's the first issue.
  The second issue is that we can't expect that PEs1/PEs2 will import (and install) one of (and exactly only one of) these two NLRIs, even if PEh adds some intended RTs along with these NLRIs.
  Because that such RT may be not so intended from the view point of PEs1/PEs2.
  The third issue is that when RR1 receives these two NLRIs, RR1 may just reflect one of them to its clients because that their nexthop is the same IP address.<a href="#section-5.1-4.2" class="pilcrow">¶</a>
</li>
          <li class="ulEmpty normal" id="section-5.1-4.3">Note that although one (that is for PEs1) of those two IMET-NLRIs 
  can be advertised (by PEh) along with an IP-based Route Target Extended Community  
  which is constructed by placing the IP address 
  carried in the Next Hop (that is PEs1's node address) of the received (from PEs1) IMET route
         in the Global Administrator field of that EC (with the Local
         Administrator field of that EC set to 0).<a href="#section-5.1-4.3" class="pilcrow">¶</a>
</li>
          <li class="ulEmpty normal" id="section-5.1-4.4">When PEs1 receives that IMET-H route (say R5), PEs1 either won't consider R5 as an IMET route for itself (If PEs1 didn't configure its nexthop address as an import RT previously),
  or will import R5 to all (because that R5 doesn't have any service-delimiting information in it) of its EVPN Instances,
  or will import all (not R5 only) of those two IMET-H NLRIs into the corresponding EVI-instance (if R5's EVI RT are still constructed just following [RFC7432]).<a href="#section-5.1-4.4" class="pilcrow">¶</a>
</li>
          <li class="ulEmpty normal" id="section-5.1-4.5">In order to solve these problems, the follow three methods may be used:<a href="#section-5.1-4.5" class="pilcrow">¶</a>
</li>
        </ul>
<ul class="ulEmpty normal">
<li style="margin-left: 2.5em; text-indent: -2.5em;" class="ulEmpty normal" id="section-5.1-5.1">M1) Make the IMET-H routes and the IMET-S routes of the same EVPN Instance use the same Route-distinguisher (RD).
  When an RT of an IMET-H route (which is enhanced by the "path identifer" of [RFC7911]) matches the import RT of an EVI but its RD doesn't match the EVI's RD,
  that IMET-H route won't be imported.<a href="#section-5.1-5.1" class="pilcrow">¶</a>
</li>
          <li style="margin-left: 2.5em; text-indent: -2.5em;" class="ulEmpty normal" id="section-5.1-5.2">M2) Make the IMET-H route's Route Target carry the IMET-S route's RD.
  at the same time, the spoke PEs (auto-)configure the RD of each EVI as an import RT of the same EVI.
  Different spoke PEs should use different RDs in this method, and the "path identifer" of [RFC7911] should also be used in this method.<a href="#section-5.1-5.2" class="pilcrow">¶</a>
</li>
          <li style="margin-left: 2.5em; text-indent: -2.5em;" class="ulEmpty normal" id="section-5.1-5.3">M3) Make the IMET-H route's NLRI carry the IMET-S route's NLRI.
  Such IMET-H route is actually another format of the Leaf A-D route for that IMET-S route.<a href="#section-5.1-5.3" class="pilcrow">¶</a>
</li>
        </ul>
<ul class="ulEmpty normal">
<li class="ulEmpty normal" id="section-5.1-6.1">But these three methods all have obvious defects, that's why we said that 
  we can't advertise different EVPN labels for PEs1 and PEs2 in the form of current IMET routes.<a href="#section-5.1-6.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.1-7">But PEh can request PEs1 or PEs2 to push the label of the context VC from them to PEh. 
  Benefit from the context VC label, PEh can distinguish where the packet from, 
  in other words, PEh can decide where the packet can't be sent to.<a href="#section-5.1-7" class="pilcrow">¶</a></p>
<p id="section-5.1-8">The signaling for the hub PE to request the spoke PE to push the context VC label will be the CSL-Entry EC, 
  regardless of the label-space type of the context VC label.<a href="#section-5.1-8" class="pilcrow">¶</a></p>
<p id="section-5.1-9">Note that although PEs1 and PEs2 can receive EVPN routes from each other,
  they won't import these routes because of the hub/spoke behaviors.<a href="#section-5.1-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-solution-statistics">
<section id="section-5.2">
        <h3 id="name-solution-for-per-ingress-st">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-solution-for-per-ingress-st" class="section-name selfRef">Solution for per ingress statistics</a>
        </h3>
<p id="section-5.2-1">We use CSL-based per-EVI context-VCs(see <a href="#sect-adv-csl-based-vc" class="xref">Section 4.1.2</a>) to do per-ingress statistics.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">Note that The per-platform label space can be used as CLS1 at the same time. 
  In such case, the inner context-VC label is similar to the downstream-assigned ESI-label in ILM-lookup behavior.
  Such context-VC is very similar to the shared context VC too.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2-3"> Note that when PE1 sends a Leaf A-D route with a CSL-Entry EC to PE2,
      but PE2 don't recognize the CSL-Entry EC, then PE2 will encapsulate the EVPN label without the inner context-VC label.
         If CLS1 is actually identical to the per-platform label space, this will work as well as [RFC7432], 
  although the per-ingress statistics can't be executed.<a href="#section-5.2-3" class="pilcrow">¶</a></p>
<p id="section-5.2-4">
  Note that legacy PEs will not send a Leaf A-D route in response to an IMET route even if the LIR flag in the IMET route is set to one.
  So when legacy PEs and new PEs following this section coexist in the same EVI, 
  they can interwork well, but only the new PEs can do per-ingress statistics.<a href="#section-5.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-5.3">
        <h3 id="name-solution-for-ar-replicator-">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-solution-for-ar-replicator-" class="section-name selfRef">Solution for AR REPLICATOR in MPLS EVPN</a>
        </h3>
<span id="name-ar-replicator-in-mpls-evpn"></span><div id="AR-Figure">
<figure id="figure-5">
          <div class="artwork art-text alignCenter" id="section-5.3-1.1">
<pre>
    LEAF1--------REPLICATOR1--------RNVE1
                     /
    LEAF2-----------/

</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-ar-replicator-in-mpls-evpn" class="selfRef">AR REPLICATOR in MPLS EVPN</a>
          </figcaption></figure>
</div>
<p id="section-5.3-2">When REPLICATOR1 node recieves an IMET Route with AR-role = AR-LEAF from LEAF1 node, REPLICATOR1 SHOLD respond to it with an Leaf A-D route with AR-PTA.
     The MPLS label field of the AR-PTA (say AR-PTA Label) will be allocated following the same rules as the IR-PTA Label in <a href="#sect-leaf-ad" class="xref">Section 4.1</a>. 
 
 When AR-LEAF1 receives above Leaf A-D route, 
 the Leaf A-D route is treated as a Replicator-AR route for the same ORIP, 
 then the control-plane procedures follows <span>[<a href="#I-D.ietf-bess-evpn-optimized-ir" class="xref">I-D.ietf-bess-evpn-optimized-ir</a>]</span>. 
        
 When REPLICATOR1 receives data packets from the AR-PTA Label, 
 REPLICATOR1 will do source-squelching for LEAF1, which means that 
 these data packets will not be forwarded back to LEAF1.<a href="#section-5.3-2" class="pilcrow">¶</a></p>
<p id="section-5.3-3">
     Note that the old Replicator-AR route (from AR-REPLICATOR) which is in terms of IMET route will not be installed in dataplane by MPLS EVPN AR-LEAF.
     Because that the Leaf A-D route (from AR-RPELICATOR) will take it's place on AR-LEAF node.
     But the old Regular-IR route (from AR-REPLICATOR) should still be installed by MPLS EVPN AR-LEAFs.<a href="#section-5.3-3" class="pilcrow">¶</a></p>
<p id="section-5.3-4">As what is discussed in <a href="#sect-compatibility" class="xref">Section 4.4</a>, the wildcard S-PMSI route can be used to replace the IMET route between AR-REPLICATOR and its AR-LEAFs.<a href="#section-5.3-4" class="pilcrow">¶</a></p>
</section>
<div id="sect-Anycast-SPEs">
<section id="section-5.4">
        <h3 id="name-solution-for-anycast-tunnel">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-solution-for-anycast-tunnel" class="section-name selfRef">Solution for anycast tunnel usage on SPE</a>
        </h3>
<span id="name-spe-with-anycast-tunnel"></span><div id="Anycast-Figure">
<figure id="figure-6">
          <div class="artwork art-text alignCenter" id="section-5.4-1.1">
<pre>
          /--------SPE1-------\
CE1-----TPE1                 TPE2-----CE2
          \--------SPE2-------/

</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-spe-with-anycast-tunnel" class="selfRef">SPE with Anycast Tunnel</a>
          </figcaption></figure>
</div>
<p id="section-5.4-2">Now take above use case for example, the two SPEs are the egress nodes of an anycast SR-MPLS tunnel. 
  The anycast SR-MPLS tunnel is used to transport flows from TPE1 to either SPE1 or SPE2 according to load balancing procedures. 
  So SPE1 and SPE2 have to advertise the same EVPN label independently for a given EVPN route.<a href="#section-5.4-2" class="pilcrow">¶</a></p>
<div id="sect-spe-anycast-cp">
<section id="section-5.4.1">
          <h4 id="name-control-plane">
<a href="#section-5.4.1" class="section-number selfRef">5.4.1. </a><a href="#name-control-plane" class="section-name selfRef">Control-plane</a>
          </h4>
<p id="section-5.4.1-1">When TPE2 send a MAC/IP advertisement route (say R8) to SPE1 and SPE2,
  a "Downstream Context-specific Label Space (CLS) ID Extended Community" can be included in R8 along with an EVPN label (say EVL4).<a href="#section-5.4.1-1" class="pilcrow">¶</a></p>
<div id="sect-Downstream-CLS-ID">
<section id="section-5.4.1.1">
            <h5 id="name-downstream-cls-id-extended-">
<a href="#section-5.4.1.1" class="section-number selfRef">5.4.1.1. </a><a href="#name-downstream-cls-id-extended-" class="section-name selfRef">Downstream-CLS ID Extended Community</a>
            </h5>
<p id="section-5.4.1.1-1">The downstream-CLS ID Extended Community is a new Transitive Opaque
             EC with the following structure (Sub-Type value to be assigned by IANA):<a href="#section-5.4.1.1-1" class="pilcrow">¶</a></p>
<span id="name-downstream-cls-id-extended-c"></span><div id="D-CLS-ID-EC-Figure">
<figure id="figure-7">
              <div class="artwork art-text alignCenter" id="section-5.4.1.1-2.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| 0x03 or 0x43  |   Sub-Type    |O|    ID-Type                  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                         ID-Value                              |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-downstream-cls-id-extended-c" class="selfRef">Downstream-CLS ID Extended Community</a>
              </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-5.4.1.1-3.1">ID-Type: A 2-octet field that specifies the type of Label Space
             ID.  In this section, the ID-Type is 0. 
          The ID-Type 0 indicating that the ID-Value field is a MPLS label in DCB, and it has global uniqueness across the EVPN domain.<a href="#section-5.4.1.1-3.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.4.1.1-3.2">ID-Value: A 4-octet field that specifies the value of Label Space
             ID.  When it is a label (with ID-Type 0), the most significant
             20-bit is set to the label value.<a href="#section-5.4.1.1-3.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.4.1.1-3.3">O bit: The OPE-Flag. When the Extended Community is advertised by the Originating PE of the corresponding EVPN route,
             The O bit should be set to 1, otherwise the O bit should be set (or rewritten) to 0.<a href="#section-5.4.1.1-3.3" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-5.4.1.1-4">Note that although the downstream-CLS ID EC is highly similar to the Context Label Space ID Extended Community (see section 3.1 of <span>[<a href="#I-D.ietf-bess-mvpn-evpn-aggregation-label" class="xref">I-D.ietf-bess-mvpn-evpn-aggregation-label</a>]</span>) in their encodings,
  they have absolutely different behaviors in data-plane. 
  The CLS-ID EC should be treated as an incomming label in data-plane, but the downstream-CLS ID EC should be treated as an outgoing label in data-plane.
  So they couldn't share the same code-point in the signalling procedures.<a href="#section-5.4.1.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-CLS-ILM">
<section id="section-5.4.1.2">
            <h5 id="name-context-specific-label-swap">
<a href="#section-5.4.1.2" class="section-number selfRef">5.4.1.2. </a><a href="#name-context-specific-label-swap" class="section-name selfRef">Context-specific Label Swapping</a>
            </h5>
<p id="section-5.4.1.2-1">When SPE1 and SPE2 receive R8 from TPE2, they should advertise R8 to TPE1 independently, 
  and the next-hop of R8 should be changed to the common anycast node address (say IP_12) of SPE1 and SPE2 before the advertisement.
  But SPE1 and SPE2 can simply keep R8's EVPN label (the EVL4 from TPE2) unchanged.<a href="#section-5.4.1.2-1" class="pilcrow">¶</a></p>
<p id="section-5.4.1.2-2">
      The contex-VC label (say VCL4) in the "downstream-CLS ID EC" is also kept unchanged. 
  But the O bit of the "downstream-CLS ID EC" is rewritten to 0.<a href="#section-5.4.1.2-2" class="pilcrow">¶</a></p>
<p id="section-5.4.1.2-3">Note that although the EVL4 and VCL4 is unchanged, 
      a CLS-specific ILM whose label operation is "label swapping" should also be installed,
      because that the outgoing PSN tunnel information should be resolved.<a href="#section-5.4.1.2-3" class="pilcrow">¶</a></p>
<p id="section-5.4.1.2-4">Note that the two outgoing-labels of the label-swapping have the same value (EVL4 and VCL4) as the two incomming-labels.
             The VCL4 is an optional outgoing-label because that the O bit of its "Downstream-CLS ID EC" is 1.<a href="#section-5.4.1.2-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sect-spe-anycast-dp">
<section id="section-5.4.2">
          <h4 id="name-data-plane">
<a href="#section-5.4.2" class="section-number selfRef">5.4.2. </a><a href="#name-data-plane" class="section-name selfRef">Data-plane</a>
          </h4>
<p id="section-5.4.2-1">The label stack on the anycast SR-MPLS tunnel is constructed by TPE1 as the following:<a href="#section-5.4.2-1" class="pilcrow">¶</a></p>
<span id="name-anycast-spe-dataplane"></span><div id="Anycast-SPE-Figure">
<figure id="figure-8">
            <div class="artwork art-text alignCenter" id="section-5.4.2-2.1">
<pre>
        +---------------------------------+
        |  underlay ethernet header       |
        +---------------------------------+
        |  Anycast SR-TL = SR_LSP_to_SPEs |
        +---------------------------------+
        |  Context-VC Label = VCL4        |
        +---------------------------------+
        |  EVPN label = EVL4              |
        +---------------------------------+
        |  overlay ethernet or IP header  |
        +---------------------------------+

</pre>
</div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a>:
<a href="#name-anycast-spe-dataplane" class="selfRef">Anycast SPE dataplane</a>
            </figcaption></figure>
</div>
<p id="section-5.4.2-3">Note that the SR Tunnel Label (TL) in the label stack is the anycast SR-LSP label from TPE1 to the SPE1 or SPE2.
  And the VCL4 in the label stack is mandatory (from the viewpoint of TPE1) because that the O bit of its "Downstream-CLS ID EC" is 0.<a href="#section-5.4.2-3" class="pilcrow">¶</a></p>
<p id="section-5.4.2-4">Note that the context-VC is constructed (on SPE1 and SPE2) in per-platform label space, 
          and VC labels from TPE2 to SPE1 and SPE2 will be the same value (VCL4).
      so the label stacks (from the viewpoint of TPE1) are the same for SPE1 and SPE2.
  That's why the anycast tunnel from TPE1 to SPE1 and SPE2 can be used for R8 by TPE1.<a href="#section-5.4.2-4" class="pilcrow">¶</a></p>
<p id="section-5.4.2-5">When SPE1/SPE2 receives that data packet, then SPE1/SPE2 will perform CLS-specific ILM lookup 
  for the EVPN label in the "TPE2-specific label space" which is identified by the context-VC label VCL4.
  The label operation will be "swapping", and the new outgoing EVPN label will be the same value (as EVL4).
  Note that the optional (from the viewpoint of SPE1/SPE2) VCL4 is suggested to be absent in the label stack.<a href="#section-5.4.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-spe-anycast-cp-ext">
<section id="section-5.4.3">
          <h4 id="name-the-generating-of-downstrea">
<a href="#section-5.4.3" class="section-number selfRef">5.4.3. </a><a href="#name-the-generating-of-downstrea" class="section-name selfRef">The Generating of Downstream-CLS ID EC on SPE</a>
          </h4>
<p id="section-5.4.3-1">When TPE2 don't advertise the Downstream-CLS ID EC to SPE1 and SPE2, They have to generate that EC by themselves.<a href="#section-5.4.3-1" class="pilcrow">¶</a></p>
<p id="section-5.4.3-2">In such case, TPE2 should advertise the OPE TLV for R8. 
  And a context-VC infrastructure should be established previously.
  The context-VC infrastructure should assure that the context-VCs from TPE2 to any other TPEs/SPEs have the same VCL value.<a href="#section-5.4.3-2" class="pilcrow">¶</a></p>
<p id="section-5.4.3-3">Then the SPE1 can set the ID-Value of the Downstream-CLS ID EC to the VCL of the contex VC from TPE2 to itself.
  The ID-Type of the Downstream-CLS ID EC is set to 0.
  The O bit of the Downstream-CLS ID EC is set to 0.
  So the same Downstream-CLS ID EC can be generated by the SPEs independently.<a href="#section-5.4.3-3" class="pilcrow">¶</a></p>
<p id="section-5.4.3-4">It is feasible for such context-VC infrastructure to be implemented on the basis of Kompella VPLS signalling or BGP SR signaling.
  But it will be better for the admin-EVI (as the context-VC infrastructure) and EVPN VPLS to use the same signalling framework.<a href="#section-5.4.3-4" class="pilcrow">¶</a></p>
<p id="section-5.4.3-5">So we can just transplant the SRGB or VE-Block configuration model into the admin-EVI 
  but the admin-EVI still use the signalling framework of <a href="#sect-spe-anycast-cp" class="xref">Section 5.4.1</a>.<a href="#section-5.4.3-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
<div id="Security">
<section id="section-6">
      <h2 id="name-security-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-6-1">This section will be added in future versions.<a href="#section-6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="IANA">
<section id="section-7">
      <h2 id="name-iana-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-7-1">This document introduces two new Transitive Opaque Extended Communities
   "Downstream CLS ID Extended Community" and "Context-Specific Label Entry Extended Community".  An IANA request will be
   submitted later for two code-points in the BGP Transitive Opaque Extended
   Community Sub-Types registry.<a href="#section-7-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-8">
      <h2 id="name-acknowledgements">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="section-8-1">The authors would like to thank the following for their comments and
   review of this document:<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">Benchong Xu.<a href="#section-8-2" class="pilcrow">¶</a></p>
</section>
<section id="section-9">
      <h2 id="name-references">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-9.1">
        <h3 id="name-normative-references">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC7432">[RFC7432]</dt>
        <dd>
<span class="refAuthor">Sajassi, A., Ed.</span><span class="refAuthor">, Aggarwal, R.</span><span class="refAuthor">, Bitar, N.</span><span class="refAuthor">, Isaac, A.</span><span class="refAuthor">, Uttaro, J.</span><span class="refAuthor">, Drake, J.</span><span class="refAuthor">, and W. Henderickx</span>, <span class="refTitle">"BGP MPLS-Based Ethernet VPN"</span>, <span class="seriesInfo">RFC 7432</span>, <span class="seriesInfo">DOI 10.17487/RFC7432</span>, <time datetime="2015-02" class="refDate">February 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7432">https://www.rfc-editor.org/info/rfc7432</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6514">[RFC6514]</dt>
        <dd>
<span class="refAuthor">Aggarwal, R.</span><span class="refAuthor">, Rosen, E.</span><span class="refAuthor">, Morin, T.</span><span class="refAuthor">, and Y. Rekhter</span>, <span class="refTitle">"BGP Encodings and Procedures for Multicast in MPLS/BGP IP VPNs"</span>, <span class="seriesInfo">RFC 6514</span>, <span class="seriesInfo">DOI 10.17487/RFC6514</span>, <time datetime="2012-02" class="refDate">February 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6514">https://www.rfc-editor.org/info/rfc6514</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-bess-evpn-optimized-ir">[I-D.ietf-bess-evpn-optimized-ir]</dt>
        <dd>
<span class="refAuthor">Rabadan, J.</span><span class="refAuthor">, Sathappan, S.</span><span class="refAuthor">, Lin, W.</span><span class="refAuthor">, Katiyar, M.</span><span class="refAuthor">, and A. Sajassi</span>, <span class="refTitle">"Optimized Ingress Replication solution for EVPN"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-bess-evpn-optimized-ir-07</span>, <time datetime="2020-07-13" class="refDate">13 July 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-bess-evpn-optimized-ir-07">https://tools.ietf.org/html/draft-ietf-bess-evpn-optimized-ir-07</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-bess-evpn-bum-procedure-updates">[I-D.ietf-bess-evpn-bum-procedure-updates]</dt>
      <dd>
<span class="refAuthor">Zhang, Z.</span><span class="refAuthor">, Lin, W.</span><span class="refAuthor">, Rabadan, J.</span><span class="refAuthor">, Patel, K.</span><span class="refAuthor">, and A. Sajassi</span>, <span class="refTitle">"Updates on EVPN BUM Procedures"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-bess-evpn-bum-procedure-updates-08</span>, <time datetime="2019-11-18" class="refDate">18 November 2019</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-bess-evpn-bum-procedure-updates-08">https://tools.ietf.org/html/draft-ietf-bess-evpn-bum-procedure-updates-08</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-9.2">
        <h3 id="name-informative-references">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC3031">[RFC3031]</dt>
        <dd>
<span class="refAuthor">Rosen, E.</span><span class="refAuthor">, Viswanathan, A.</span><span class="refAuthor">, and R. Callon</span>, <span class="refTitle">"Multiprotocol Label Switching Architecture"</span>, <span class="seriesInfo">RFC 3031</span>, <span class="seriesInfo">DOI 10.17487/RFC3031</span>, <time datetime="2001-01" class="refDate">January 2001</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3031">https://www.rfc-editor.org/info/rfc3031</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5331">[RFC5331]</dt>
        <dd>
<span class="refAuthor">Aggarwal, R.</span><span class="refAuthor">, Rekhter, Y.</span><span class="refAuthor">, and E. Rosen</span>, <span class="refTitle">"MPLS Upstream Label Assignment and Context-Specific Label Space"</span>, <span class="seriesInfo">RFC 5331</span>, <span class="seriesInfo">DOI 10.17487/RFC5331</span>, <time datetime="2008-08" class="refDate">August 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5331">https://www.rfc-editor.org/info/rfc5331</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-bess-mvpn-evpn-aggregation-label">[I-D.ietf-bess-mvpn-evpn-aggregation-label]</dt>
      <dd>
<span class="refAuthor">Zhang, Z.</span><span class="refAuthor">, Rosen, E.</span><span class="refAuthor">, Lin, W.</span><span class="refAuthor">, Li, Z.</span><span class="refAuthor">, and I. Wijnands</span>, <span class="refTitle">"MVPN/EVPN Tunnel Aggregation with Common Labels"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-bess-mvpn-evpn-aggregation-label-03</span>, <time datetime="2019-10-24" class="refDate">24 October 2019</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-bess-mvpn-evpn-aggregation-label-03">https://tools.ietf.org/html/draft-ietf-bess-mvpn-evpn-aggregation-label-03</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="authors-addresses">
<section id="section-appendix.a">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Yubao Wang</span></div>
<div dir="auto" class="left"><span class="org">ZTE Corporation</span></div>
<div dir="auto" class="left"><span class="street-address">No. 50 Software Ave, Yuhuatai Distinct</span></div>
<div dir="auto" class="left"><span class="locality">Nanjing</span></div>
<div dir="auto" class="left"><span class="country-name">China</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:wang.yubao2@zte.com.cn" class="email">wang.yubao2@zte.com.cn</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Bing Song</span></div>
<div dir="auto" class="left"><span class="org">ZTE Corporation</span></div>
<div dir="auto" class="left"><span class="street-address">No. 50 Software Ave, Yuhuatai Distinct</span></div>
<div dir="auto" class="left"><span class="locality">Nanjing</span></div>
<div dir="auto" class="left"><span class="country-name">China</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:song.bing@zte.com.cn" class="email">song.bing@zte.com.cn</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
