<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Applicability of Keying Methods for RSVP Security</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction and Problem Statement">
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Terminology">
<link href="#rfc.section.2" rel="Chapter" title="2 The RSVP Hop-by-Hop Trust Model">
<link href="#rfc.section.3" rel="Chapter" title="3 Applicability of Key Types for RSVP">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 Per interface and per neighbor keys">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 Group keys">
<link href="#rfc.section.4" rel="Chapter" title="4 Key Provisioning Methods for RSVP">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 Static Key Provisioning">
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 Dynamic Keying">
<link href="#rfc.section.4.2.1" rel="Chapter" title="4.2.1 Per Neighbor and Per Interface Key Negotiation">
<link href="#rfc.section.4.2.2" rel="Chapter" title="4.2.2 Dynamic Group Key Distribution">
<link href="#rfc.section.5" rel="Chapter" title="5 Specific Cases Supporting Use of Group Keying">
<link href="#rfc.section.5.1" rel="Chapter" title="5.1 RSVP Notify Messages">
<link href="#rfc.section.5.2" rel="Chapter" title="5.2 RSVP-TE and GMPLS">
<link href="#rfc.section.6" rel="Chapter" title="6 Applicability of IPsec for RSVP">
<link href="#rfc.section.6.1" rel="Chapter" title="6.1 General Considerations Using IPsec">
<link href="#rfc.section.6.2" rel="Chapter" title="6.2 Comparing AH and the INTEGRITY Object">
<link href="#rfc.section.6.3" rel="Chapter" title="6.3 Applicability of Tunnel Mode">
<link href="#rfc.section.6.4" rel="Chapter" title="6.4 Non-Applicability of Transport Mode">
<link href="#rfc.section.6.5" rel="Chapter" title="6.5 Applicability of Tunnel Mode with Address Preservation">
<link href="#rfc.section.7" rel="Chapter" title="7 End Host Considerations">
<link href="#rfc.section.8" rel="Chapter" title="8 Applicability to Other Architectures and Protocols">
<link href="#rfc.section.9" rel="Chapter" title="9 Summary">
<link href="#rfc.section.10" rel="Chapter" title="10 Security Considerations">
<link href="#rfc.section.10.1" rel="Chapter" title="10.1 Subverted Nodes">
<link href="#rfc.section.11" rel="Chapter" title="11 Acknowledgements">
<link href="#rfc.section.12" rel="Chapter" title="12 IANA Considerations">
<link href="#rfc.references" rel="Chapter" title="13 References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="The Resource reSerVation Protocol (RSVP) allows hop-by-hop integrity protection of RSVP neighbors. This requires messages to be cryptographically protected using a shared secret between participating nodes. This document compares group keying for RSVP with per neighbor or per interface keying, and discusses the associated key provisioning methods as well as applicability and limitations of these approaches.  The document also discusses applicability of encrypting RSVP messages." />
  <meta name="description" content="The Resource reSerVation Protocol (RSVP) allows hop-by-hop integrity protection of RSVP neighbors. This requires messages to be cryptographically protected using a shared secret between participating nodes. This document compares group keying for RSVP with per neighbor or per interface keying, and discusses the associated key provisioning methods as well as applicability and limitations of these approaches.  The document also discusses applicability of encrypting RSVP messages." />
  <meta name="keywords" content="RSVP authentication, RSVP integrity, Resource reservation protocol, GDOI, Group domain of interpretation" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Network Working Group</td>
<td class="right">M. Behringer</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">F. Le Faucheur</td>
</tr>
<tr>
<td class="left">Intended status: Informational</td>
<td class="right">B. Weis</td>
</tr>
<tr>
<td class="left">Expires: December 26, 2011</td>
<td class="right">Cisco Systems</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">June 24, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Applicability of Keying Methods for RSVP Security<br />
  <span class="filename">draft-ietf-tsvwg-rsvp-security-groupkeying-10.txt</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>The Resource reSerVation Protocol (RSVP) allows hop-by-hop integrity protection of RSVP neighbors. This requires messages to be cryptographically protected using a shared secret between participating nodes. This document compares group keying for RSVP with per neighbor or per interface keying, and discusses the associated key provisioning methods as well as applicability and limitations of these approaches.  The document also discusses applicability of encrypting RSVP messages.</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on December 26, 2011.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction and Problem Statement</a>
</li>
<li>1.1.   <a href="#rfc.section.1.1">Terminology</a>
</li>
<li>2.   <a href="#rfc.section.2">The RSVP Hop-by-Hop Trust Model</a>
</li>
<li>3.   <a href="#rfc.section.3">Applicability of Key Types for RSVP</a>
</li>
<li>3.1.   <a href="#rfc.section.3.1">Per interface and per neighbor keys</a>
</li>
<li>3.2.   <a href="#rfc.section.3.2">Group keys</a>
</li>
<li>4.   <a href="#rfc.section.4">Key Provisioning Methods for RSVP</a>
</li>
<li>4.1.   <a href="#rfc.section.4.1">Static Key Provisioning</a>
</li>
<li>4.2.   <a href="#rfc.section.4.2">Dynamic Keying</a>
</li>
<li>4.2.1.   <a href="#rfc.section.4.2.1">Per Neighbor and Per Interface Key Negotiation</a>
</li>
<li>4.2.2.   <a href="#rfc.section.4.2.2">Dynamic Group Key Distribution</a>
</li>
<li>5.   <a href="#rfc.section.5">Specific Cases Supporting Use of Group Keying</a>
</li>
<li>5.1.   <a href="#rfc.section.5.1">RSVP Notify Messages</a>
</li>
<li>5.2.   <a href="#rfc.section.5.2">RSVP-TE and GMPLS</a>
</li>
<li>6.   <a href="#rfc.section.6">Applicability of IPsec for RSVP</a>
</li>
<li>6.1.   <a href="#rfc.section.6.1">General Considerations Using IPsec</a>
</li>
<li>6.2.   <a href="#rfc.section.6.2">Comparing AH and the INTEGRITY Object</a>
</li>
<li>6.3.   <a href="#rfc.section.6.3">Applicability of Tunnel Mode</a>
</li>
<li>6.4.   <a href="#rfc.section.6.4">Non-Applicability of Transport Mode</a>
</li>
<li>6.5.   <a href="#rfc.section.6.5">Applicability of Tunnel Mode with Address Preservation</a>
</li>
<li>7.   <a href="#rfc.section.7">End Host Considerations</a>
</li>
<li>8.   <a href="#rfc.section.8">Applicability to Other Architectures and Protocols</a>
</li>
<li>9.   <a href="#rfc.section.9">Summary</a>
</li>
<li>10.   <a href="#rfc.section.10">Security Considerations</a>
</li>
<li>10.1.   <a href="#rfc.section.10.1">Subverted Nodes</a>
</li>
<li>11.   <a href="#rfc.section.11">Acknowledgements</a>
</li>
<li>12.   <a href="#rfc.section.12">IANA Considerations</a>
</li>
<li>13.   <a href="#rfc.references">References</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> Introduction and Problem Statement</h1>
<p id="rfc.section.1.p.1">The Resource reSerVation Protocol <a href="#RFC2205">[RFC2205]</a> allows hop-by-hop authentication of RSVP neighbors, as specified in <a href="#RFC2747">[RFC2747]</a>. In this mode, an integrity object is attached to each RSVP message to transmit a keyed message digest. This message digest allows the recipient to verify the identity of the RSVP node that sent the message, and to validate the integrity of the message. Through the inclusion of a sequence number in the scope of the digest, the digest also offers replay protection.</p>
<p><a href="#RFC2747">[RFC2747]</a> does not dictate how the key for the integrity operation is derived. Currently, most implementations of RSVP use a statically configured key, per interface or per neighbor. However, to manually configure a key per router pair across an entire network is operationally hard, especially when key changes are to be performed on a regular basis. Effectively, many users of RSVP therefore resort to using the same key throughout their RSVP network, and they change it rarely if ever, because of the operational burden. It is however often necessary to regularly change keys due to network operational requirements.</p>
<p id="rfc.section.1.p.3">This document discusses a variety of keying methods and their applicability to different RSVP deployment environments, for both message integrity and encryption. It is meant as a comparative guide to understand where each RSVP keying method is best deployed, and the limitations of each method. Furthermore, it discusses how RSVP hop by hop authentication is impacted in the presence of non-RSVP nodes, or subverted nodes, in the reservation path.</p>
<p id="rfc.section.1.p.4">The document "RSVP Security Properties" (<a href="#RFC4230">[RFC4230]</a>) provides an overview of RSVP security, including RSVP Cryptographic Authentication <a href="#RFC2747">[RFC2747]</a>, but does not discuss key management. It states that "RFC 2205 assumes that security associations are already available". The present document focuses specifically on key management with different key types, including group keys. Therefore this document complements <a href="#RFC4230">[RFC4230]</a>.</p>
<h1 id="rfc.section.1.1">
<a href="#rfc.section.1.1">1.1.</a> Terminology</h1>
<p id="rfc.section.1.1.p.1">A security domain is defined in this document as a set of nodes that shares a common RSVP security policy.</p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> The RSVP Hop-by-Hop Trust Model</h1>
<p id="rfc.section.2.p.1">Many protocol security mechanisms used in networks require and use per peer authentication. Each hop authenticates messages from its neighbor with a shared key or certificate. This is also the model used for RSVP. Trust in this model is transitive. Each RSVP node trusts explicitly only its RSVP next hop peers, through the message digest contained in the INTEGRITY object. The next hop RSVP speaker in turn trusts its own peers and so on. See also the document "RSVP security properties" <a href="#RFC4230">[RFC4230]</a> for more background.</p>
<p id="rfc.section.2.p.2">The keys used for protecting RSVP messages can, in particular, be group keys (for example distributed via GDOI <a href="#RFC3547">[RFC3547]</a>, as discussed in <a href="#I-D.weis-gdoi-mac-tek">[I-D.weis-gdoi-mac-tek]</a>). If a group key is used, the authentication granularity becomes group membership of devices, not (individual) peer authentication between devices.</p>
<p id="rfc.section.2.p.3">The trust an RSVP node has to another RSVP node has an explicit and an implicit component. Explicitly the node trusts the other node to maintain the RSVP messages intact or confidential, depending on whether authentication or encryption (or both) is used. This means only that the message has not been altered or seen by another, non-trusted node.  Implicitly each node trusts each other node with which it has a trust relationship established via the mechanisms here to adhere to the protocol specifications laid out by the various standards. In any group keying scheme like GDOI a node trusts all the other members of the group (because the authentication is now based on group membership, as noted above).</p>
<p id="rfc.section.2.p.4">The RSVP protocol can operate in the presence of a non-RSVP router in the path from the sender to the receiver. The non-RSVP hop will ignore the RSVP message and just pass it along. The next RSVP node can then process the RSVP message. For RSVP authentication or encryption to work in this case, the key used for computing the RSVP message digest needs to be shared by the two RSVP neighbors, even if they are not IP neighbors. In the presence of non-RSVP hops, while an RSVP node always knows the next IP hop before forwarding an RSVP Message, it does not always know the RSVP next hop. In fact, part of the role of a Path message is precisely to discover the RSVP next hop (and to dynamically re-discover it when it changes, for example because of a routing change). Thus, the presence of non-RSVP hops impacts operation of RSVP authentication or encryption and may influence the selection of keying approaches.</p>
<p><a href="#non-rsvp-hop">Figure 1</a> illustrates this scenario. R2 in this picture does not participate in RSVP, the other nodes do. In this case, R2 will pass on any RSVP messages unchanged, and will ignore them.</p>
<div id="#rfc.figure.1"></div>
<div id="#non-rsvp-hop"></div>
<pre>
                    ----R3---
                   /         \
  sender----R1---R2(*)       R4----receiver
                   \         /
                    ----R5---
(*) Non-RSVP hop
        </pre>
<p></p>
<p id="rfc.section.2.p.6">This creates a challenge for RSVP authentication and encryption. In the presence of a non-RSVP hop, with some RSVP messages such as a PATH message, an RSVP router does not know the RSVP next hop for that message at the time of forwarding it. For example, in <a href="#non-rsvp-hop">Figure 1</a>, R1 knows that the next IP hop for a Path message addressed to the receiver is R2, but it does necessarily not know if the RSVP next hop is R3 or R5. This means that per interface and per neighbor keys cannot easily be used in the presence of non-RSVP routers on the path between senders and receivers. </p>
<p id="rfc.section.2.p.7">Section 4.3 of <a href="#RFC2747">[RFC2747]</a> states that "... the receiver MAY initiate an integrity handshake with the sender." If this handshake is taking place, it can be used to determine the identity of the next RSVP hop. In this case, non-RSVP hops can be traversed also using per interface or per neighbor keys.</p>
<p id="rfc.section.2.p.8">Group keying will naturally work in the presence of non-RSVP routers.  Referring back to <a href="#non-rsvp-hop">Figure 1</a>, with group keying, R1 would use the group key to protect a Path message addressed to the receiver and forwards it to R2. Being a non-RSVP node, R2 will ignore and forward the Path message to R3 or R5 depending on the current shortest path as determined by routing. Whether it is R3 or R5, the RSVP router that receives the Path message will be able to authenticate the message successfully using the group key.</p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> Applicability of Key Types for RSVP</h1>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> Per interface and per neighbor keys</h1>
<p id="rfc.section.3.1.p.1">Most current RSVP authentication implementations support per interface RSVP keys. When the interface is point-to-point (and therefore an RSVP router has only a single RSVP neighbor on each interface), this is equivalent to per neighbor keys in the sense that a different key is used for each neighbor. However, when the interface is multipoint, all RSVP speakers on a given subnet have to belong to the same security domain and share the same key in this model. This makes it unsuitable for deployment scenarios where nodes from different security domains are present on a subnet, for example Internet exchange points. In such cases, per neighbor keys are required.</p>
<p id="rfc.section.3.1.p.2">With per neighbor keys, each RSVP key is bound to an interface plus a neighbor on that interface. It allows for the existence of different security domains on a single interface and subnet.</p>
<p id="rfc.section.3.1.p.3">Per interface and per neighbor keys can be used within a single security domain.</p>
<p id="rfc.section.3.1.p.4">These key types can also be used between security domains, since they are specific to a particular interface or neighbor. </p>
<p id="rfc.section.3.1.p.5">Both monotonically increasing sequence number (e.g., the INTEGRITY object simple sequence numbers <a href="#RFC2747">[RFC2747]</a>, or the ESP and AH anti-replay service <a href="#RFC4301">[RFC4301]</a> sequence numbers) and time based anti-replay methods (e.g., the INTEGRITY sequence numbers based on a clock <a href="#RFC2747">[RFC2747]</a>) can be used with per neighbor and per interface keys.</p>
<p id="rfc.section.3.1.p.6">As discussed in the previous section, per neighbor and per interface keys can not be used in the presence of non-RSVP hops.</p>
<h1 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> Group keys</h1>
<p id="rfc.section.3.2.p.1">In the case of group keys, all members of a group of RSVP nodes share the same key. This implies that a node uses the same key regardless of the next RSVP hop that will process the message (within the group of nodes sharing the particular key). It also implies that a node will use the same key on the receiving as on the sending side (when exchanging RSVP messages within the group).</p>
<p id="rfc.section.3.2.p.2">Group keys apply naturally to intra-domain RSVP authentication, where all RSVP nodes are part of the same security domain and implicitly trust each other. Using group keys, they extend this trust to the group key server. This is represented in <a href="#intra-single">Figure 2</a>.</p>
<div id="#rfc.figure.2"></div>
<div id="#intra-single"></div>
<pre>
      ......GKS1.............
      :    :   :   :        :
      :    :   :   :        :
  source--R1--R2--R3-----destination
  |                                | 
  |&lt;-----domain 1-----------------&gt;| 
        </pre>
<p></p>
<p id="rfc.section.3.2.p.3">A single group key cannot normally be used to cover multiple security domains, because by definition the different domains do not trust each other. They would therefore not be willing to trust the same group key server. For a single group key to be used in several security domains, there is a need for a single group key server, which is trusted by both sides. While this is theoretically possible, in practice it is unlikely that there is a single such entity trusted by both domains. <a href="#inter-single">Figure 3</a> illustrates this setup.</p>
<div id="#rfc.figure.3"></div>
<div id="#inter-single"></div>
<pre>
      ...............GKS1....................
      :    :   :   :        :   :   :       :
      :    :   :   :        :   :   :       :
  source--R1--R2--R3--------R4--R5--R6--destination
  |                  |    |                      |
  |&lt;-----domain 1---&gt;|    |&lt;-------domain 2-----&gt;|
        </pre>
<p></p>
<p id="rfc.section.3.2.p.4">A more practical approach for RSVP operation across security domains, is to use a separate group key server for each security domain, and to use per interface or per neighbor keys between the two domains. <a href="#inter-multiple">Figure 4</a> shows this setup.</p>
<div id="#rfc.figure.4"></div>
<div id="#inter-multiple"></div>
<pre>
      ....GKS1......        ....GKS2.........
      :    :   :   :        :   :   :       :
      :    :   :   :        :   :   :       :
  source--R1--R2--R3--------R4--R5--R6--destination
  |                  |    |                      |
  |&lt;-----domain 1---&gt;|    |&lt;-------domain 2-----&gt;|
        </pre>
<p id="rfc.section.3.2.p.5">As discussed in Section 2, group keying can be used in the presence of non-RSVP hops.</p>
<p id="rfc.section.3.2.p.6">Because a group key may be used to verify messages from different peers, monotonically increasing sequence number methods are not appropriate. Time based anti-replay methods (e.g., the INTEGITY sequence numbers based on a clock <a href="#RFC2747">[RFC2747]</a>) can be used with group keys.</p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> Key Provisioning Methods for RSVP</h1>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> Static Key Provisioning</h1>
<p id="rfc.section.4.1.p.1">Static keys are preconfigured, either manually, or through a network management system. The simplest way to implement RSVP authentication is to use static keys. Static keying can be used with per interface keys, per neighbor keys or group keys.</p>
<p id="rfc.section.4.1.p.2">The provisioning of static keys requires either manual operator intervention on each node, or a network management system performing the same task. Time synchronization of static key provisioning and changes is critical, to avoid inconsistent keys within a security domain.</p>
<p id="rfc.section.4.1.p.3">Static key provisioning is therefore not an ideal model in a large network.</p>
<p id="rfc.section.4.1.p.4">Often, the number of interconnection points across two domains where RSVP is allowed to transit is relatively small and well controlled. Also, the different domains may not be in a position to use an infrastructure trusted by both domains to update keys on both sides. Thus, statically provisioned keys may be applicable to inter-domain RSVP authentication.</p>
<p id="rfc.section.4.1.p.5">Since it is not feasible to carry out a key change at the exact same time in communicating RSVP nodes, some grace period needs to be implemented during which an RSVP node will accept both the old and the new key. Otherwise, RSVP operation would suffer interruptions. (Also with dynamic keying approaches there can be a grace period where two keys are valid at the same time; however, the grace period in manual keying tends to be significantly longer than with dynamic key rollover schemes.)</p>
<h1 id="rfc.section.4.2">
<a href="#rfc.section.4.2">4.2.</a> Dynamic Keying</h1>
<h1 id="rfc.section.4.2.1">
<a href="#rfc.section.4.2.1">4.2.1.</a> Per Neighbor and Per Interface Key Negotiation</h1>
<p id="rfc.section.4.2.1.p.1">To avoid the problem of manual key provisioning and updates in static key deployments, key negotiation between RSVP neighbors could be used to derive either per interface or per neighbor keys.</p>
<h1 id="rfc.section.4.2.2">
<a href="#rfc.section.4.2.2">4.2.2.</a> Dynamic Group Key Distribution</h1>
<p id="rfc.section.4.2.2.p.1">With this approach, group keys are dynamically distributed among a set of RSVP routers. For example, <a href="#I-D.weis-gdoi-mac-tek">[I-D.weis-gdoi-mac-tek]</a> describes a mechanism to distribute group keys to a group of RSVP speakers, using GDOI <a href="#RFC3547">[RFC3547]</a>. In this solution, a key server authenticates each of the RSVP nodes independently, and then distributes a group key to the group as part of an encrypted and integrity protected key agreement protocol. The authentication in this model can be based on public key mechanisms, thereby avoiding the need for static key provisioning.</p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> Specific Cases Supporting Use of Group Keying</h1>
<h1 id="rfc.section.5.1">
<a href="#rfc.section.5.1">5.1.</a> RSVP Notify Messages</h1>
<p><a href="#RFC3473">[RFC3473]</a> introduces the Notify message and allows such messages to be sent in a non-hop-by-hop fashion. As discussed in the Security Considerations section of <a href="#RFC3473">[RFC3473]</a>, this can interfere with RSVP's hop-by-hop integrity and authentication model. <a href="#RFC3473">[RFC3473]</a> describes how standard IPsec based integrity and authentication can be used to protect Notify messages. </p>
<p id="rfc.section.5.1.p.2">Group keying may allow use of regular RSVP authentication (<a href="#RFC2747">[RFC2747]</a>) for protection of non-hop-by-hop Notify messages. For example, RSVP Notify messages commonly used for traffic engineering in MPLS networks are non-hop-by-hop messages. Such messages may be sent from an ingress node directly to an egress node.  Group keying in such a case avoids the establishment of node-to-node keying when node-to-node keying is not otherwise used.</p>
<h1 id="rfc.section.5.2">
<a href="#rfc.section.5.2">5.2.</a> RSVP-TE and GMPLS</h1>
<p id="rfc.section.5.2.p.1">Use of RSVP authentication for RSVP-TE <a href="#RFC3209">[RFC3209]</a> and for RSVP-TE Fast Reroute <a href="#RFC4090">[RFC4090]</a> deserves additional considerations.</p>
<p id="rfc.section.5.2.p.2">With the facility backup method of Fast Reroute, a backup tunnel from the Point of Local Repair (PLR) to the Merge Point (MP) is used to protect Label Switched Paths (protected LSPs) against the failure of a facility (e.g., a router) located between the PLR and the MP.  During the failure of the facility, the PLR redirects a protected LSP inside the backup tunnel and as a result, the PLR and MP then need to exchange RSVP control messages between each other (e.g., for the maintenance of the protected LSP). Some of the RSVP messages between the PLR and MP are sent over the backup tunnel (e.g., a Path message from PLR to MP) while some are directly addressed to the RSVP node (e.g., a Resv message from MP to PLR). During the rerouted period, the PLR and the MP effectively become RSVP neighbors, while they may not be directly connected to each other and thus do not behave as RSVP neighbors in the absence of failure. This point is raised in the Security Considerations section of <a href="#RFC4090">[RFC4090]</a> that says: "Note that the facility backup method requires that a PLR and its selected merge point trust RSVP messages received from each other." Such environments may benefit from group keying. A group key can be used among a set of routers enabled for Fast Reroute thereby easily ensuring that PLR and MP authenticate messages from each other can be authenticated, without requiring prior specific configuration of keys, or activation of key update mechanism, for every possible pair of PLR and MP.</p>
<p id="rfc.section.5.2.p.3">Where RSVP-TE or RSVP-TE Fast Reroute is deployed across AS boundaries (see <a href="#RFC4216">[RFC4216]</a>), the considerations presented above in section 3.1 and 3.2 apply, such that per interface or per neighbor keys can be used between two RSVP neighbors in different ASes (independently of the keying method used by the RSVP router to talk to the RSVP routers in the same AS).</p>
<p><a href="#RFC4875">[RFC4875]</a> specifies protocol extensions for support of Point-to- Multipoint (P2MP) RSVP-TE. RSVP message integrity mechanisms for hop-by-hop RSVP signaling apply to the hop-by-hop P2MP RSVP-TE signaling (see <a href="#RFC4875">[RFC4875]</a> Security Considerations) . </p>
<p><a href="#RFC4206">[RFC4206]</a> defines LSP Hierarchy with GMPLS TE and uses non-hop-by-hop signaling. Because it reuses LSP Hierarchy procedures for some of its operations, P2MP RSVP-TE also uses non-hop-by-hop signaling. Both LSP hierarchy and P2MP RSVP-TE rely on the security mechanisms defined in <a href="#RFC3473">[RFC3473]</a> and <a href="#RFC4206">[RFC4206]</a> for non hop-by-hop RSVP-TE signaling.  Group keying can simplify protection of non-hop-by-hop signaling for LSP Hierarchy and P2MP RSVP-TE.</p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> Applicability of IPsec for RSVP</h1>
<h1 id="rfc.section.6.1">
<a href="#rfc.section.6.1">6.1.</a> General Considerations Using IPsec</h1>
<p id="rfc.section.6.1.p.1">The discussions about the various keying methods in this document are also applicable when using IPsec <a href="#RFC4301">[RFC4301]</a> to protect RSVP. <a href="#RFC2747">[RFC2747]</a> states in section 1.2 that IPsec is not an optimal choice to protect RSVP. The key argument is that an IPsec SA and an RSVP SA are not based on the same parameters. Nevertheless, IPsec can be used to protect RSVP. The SPD traffic selectors for related RSVP flows will not be constant. In some cases, the source and destination addresses are end hosts, and sometimes they are RSVP routers. Therefore, traffic selectors in the SPD are expected to specify ANY for the source address and destination addresses, and specify IP protocol 46 (RSVP).</p>
<p id="rfc.section.6.1.p.2">The document "The Multicast Group Security Architecture" <a href="#RFC3740">[RFC3740]</a> defines in detail a "Group Security Association" (GSA). This definition is also applicable in the context discussed here, and allows the use of IPsec for RSVP. The existing GDOI standard <a href="#RFC3547">[RFC3547]</a> manages group security associations, which can be used by IPsec. An example GDOI policy would be to encrypt or authenticate all packets of the RSVP protocol itself (IP protocol 46). A router implementing GDOI and the AH and/or ESP protocols is therefore able to implement this policy.</p>
<p id="rfc.section.6.1.p.3">Because the traffic selectors for an SA cannot be predicted, SA lookup is expected to use only the SPI (or SPI plus protocol).</p>
<h1 id="rfc.section.6.2">
<a href="#rfc.section.6.2">6.2.</a> Comparing AH and the INTEGRITY Object</h1>
<p id="rfc.section.6.2.p.1">The INTEGRITY object defined by <a href="#RFC2747">[RFC2747]</a> provides integrity protection for RSVP also in a group keying context, as discussed above. AH <a href="#RFC4302">[RFC4302]</a> is an alternative method to provide integrity protection for RSVP packets.</p>
<p id="rfc.section.6.2.p.2">The RSVP INTEGRITY object protects the entire RSVP message, but does not protect the IP header of the packet nor the IP options (in IPv4) or extension headers (in IPv6).</p>
<p id="rfc.section.6.2.p.3">AH tunnel mode (transport mode is not applicable, see section 6.4) protects the entire original IP packet, including the IP header of the original IP packet ("inner header"), IP options or extension headers, plus the entire RSVP packet. It also protects the immutable fields of the outer header.</p>
<p id="rfc.section.6.2.p.4">The difference between the two schemes in terms of covered fields is therefore whether the IP header and IP options or extension headers of the original IP packet are protected (as is the case with AH) or not (as is the case with the INTEGRITY object). Also, AH covers the immutable fields of the outer header.</p>
<p id="rfc.section.6.2.p.5">As described in the next section, IPsec tunnel mode can not be applied for RSVP traffic in the presence of non-RSVP nodes; therefore the security associations in both cases, AH and INTEGRITY object, are between the same RSVP neighbors. From a keying point of view both approaches are therefore comparable.</p>
<h1 id="rfc.section.6.3">
<a href="#rfc.section.6.3">6.3.</a> Applicability of Tunnel Mode</h1>
<p id="rfc.section.6.3.p.1">IPsec tunnel mode encapsulates the original packet, prepending a new IP header plus an ESP or AH sub-header. The entire original packet plus the ESP/AH sub-header is secured. In the case of ESP the new, outer IP header however is not cryptographically secured in this process.</p>
<p id="rfc.section.6.3.p.2">Protecting RSVP packets with IPsec tunnel mode works with any of the above described keying methods (interface, neighbor or group based), as long as there are no non-RSVP nodes on the path (however, see group keying considerations below). For RSVP messages to be visible and considered at each hop, such a tunnel would not cross routers, but each RSVP node would establish a tunnel with each of its peers, effectively leading to link protection.</p>
<p id="rfc.section.6.3.p.3">In the presence of a non-RSVP hop, tunnel mode cannot be applied, because a router upstream from a non-RSVP hop does not know the next RSVP hop, and can thus not apply the correct tunnel header. This is independent of the key type used.</p>
<p id="rfc.section.6.3.p.4">The use of group keying with ESP tunnel mode where a security gateway places a peer security gateway address as the destination of the ESP packet has consequences. In particular, if a man-in-the-middle attacker re-directs the ESP-protected reservation to a different security gateway, the receiving security gateway cannot detect that the destination address was changed. However, it has received and will act upon or route a RSVP reservation that will be be routed along an unintended path. Because RSVP routers encountering the RSVP packet path will not be aware that this is an unintended path, they will act upon it and the resulting RSVP state along both the intended path and unintended path will both be incorrect. Therefore group keying is recommended not be used with ESP tunnel mode except with address preservation (see Section 6.5).</p>
<h1 id="rfc.section.6.4">
<a href="#rfc.section.6.4">6.4.</a> Non-Applicability of Transport Mode</h1>
<p id="rfc.section.6.4.p.1">IPsec transport mode, as defined in <a href="#RFC4303">[RFC4303]</a> is not suitable for securing RSVP Path messages, since those messages preserve the original source and destination. <a href="#RFC4303">[RFC4303]</a> states explicitly that "the use of transport mode by an intermediate system (e.g., a security gateway) is permitted only when applied to packets whose source address (for outbound packets) or destination address (for inbound packets) is an address belonging to the intermediate system itself." This would not be the case for RSVP Path messages.</p>
<h1 id="rfc.section.6.5">
<a href="#rfc.section.6.5">6.5.</a> Applicability of Tunnel Mode with Address Preservation</h1>
<p id="rfc.section.6.5.p.1">When the identity of the next-hop RSVP peer is not known, it is not possible to use a tunnel-endpoint destination address in the Tunnel Mode outer IP header. The document "Multicast Extensions to the Security Architecture for the Internet Protocol" <a href="#RFC5374">[RFC5374]</a> defines in section 3.1 a new tunnel mode: Tunnel mode with address preservation. This mode copies the destination and optionally the source address from the inner header to the outer header. Therefore the encapsulated packet will have the same destination address as the original packet, and be normally subject to the same routing decisions. While <a href="#RFC5374">[RFC5374]</a> is focusing on multicast environments, tunnel mode with address preservation can be used also to protect unicast traffic in conjunction with group keying. In this tunnel mode the RSVP speakers act as security gateways, because they maintain the original end system addresses of the RSVP packets in the outer tunnel mode IP header. This addressing scheme is used by RSVP to ensure that the packets continue along the routed path toward the destination end host.</p>
<p id="rfc.section.6.5.p.2">Tunnel mode with address preservation, in conjunction with group keying, allows the use of AH or ESP for protection of RSVP even in cases where non-RSVP nodes have to be traversed. This is because it allows routing of the IPsec protected packet through the non-RSVP nodes in the same way as if it was not IPsec protected.</p>
<p id="rfc.section.6.5.p.3">When used with group keying, tunnel mode with address preservation can be used to mitigate re-direction attacks where a man-in-the-middle modifies the destination of the outer IP header of the tunnel mode packet. The inbound processing rules for tunnel mode with address preservation (Section 5.2 of <a href="#RFC5374">[RFC5374]</a>) require that the receiver verify that the addresses in the outer IP header and the inner IP header are consistent. Therefore, the attack can be detected and RSVP reservations will not proceed along an unintended path.</p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> End Host Considerations</h1>
<p id="rfc.section.7.p.1">Unless RSVP Proxy entities (<a href="#RFC5945">[RFC5945]</a> are used, RSVP signaling is controlled by end systems and not routers. As discussed in <a href="#RFC4230">[RFC4230]</a>, RSVP allows both user-based security and host-based security. User-based authentication aims at "providing policy based admission control mechanism based on user identities or application." To identify the user or the application, a policy element called AUTH_DATA, which is contained in the POLICY_DATA object, is created by the RSVP daemon at the user's host and transmitted inside the RSVP message. This way, a user may authenticate to the Policy Decision Point (or directly to the first hop router). Host-based security relies on the same mechanisms as between routers (i.e., the INTEGRITY object) as specified in <a href="#RFC2747">[RFC2747]</a>. For host-based security, per interface or per neighbor keys may be used, however, key management with statically provisioned keys can be difficult in a large scale deployment, as described in section 4. In principle an end host can also be part of a group key scheme, such as GDOI. If the end systems are part of the same security domain as the network itself, group keying can be extended to include the end systems.  If the end systems and the network are in different zones of trust, group keying cannot be used.</p>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> Applicability to Other Architectures and Protocols</h1>
<p id="rfc.section.8.p.1">While, so far, this document discusses only RSVP security assuming the traditional RSVP model as defined by <a href="#RFC2205">[RFC2205]</a> and <a href="#RFC2747">[RFC2747]</a>, the analysis is also applicable to other RSVP deployment models as well as to similar protocols:</p>
<p></p>

<ul>
<li>Aggregation of RSVP for IPv4 and IPv6 Reservations <a href="#RFC3175">[RFC3175]</a>: This scheme defines aggregation of individual RSVP reservations, and discusses use of RSVP authentication for the signaling messages. Group keying is applicable to this scheme, particularly when automatic Deaggregator discovery is used, since in that case, the Aggregator does not know ahead of time which Deaggregator will intercept the initial end-to-end RSVP Path message.</li>
<li>Generic Aggregate Resource ReSerVation Protocol (RSVP) Reservations <a href="#RFC4860">[RFC4860]</a>: This document also discusses aggregation of individual RSVP reservations. Here again, group keying applies and is mentioned in the Security Considerations section.</li>
<li>Aggregation of Resource ReSerVation Protocol (RSVP) Reservations over MPLS TE/DS-TE Tunnels <a href="#RFC4804">[RFC4804]</a>([RFC4804]): This scheme also defines a form of aggregation of RSVP reservation but this time over MPLS TE Tunnels. Similarly, group keying may be used in such an environment.</li>
<li>Pre-Congestion Notification (PCN): <a href="#RFC5559">[RFC5559]</a> defines an architecture for flow admission and termination based on aggregated pre-congestion information. One deployment model for this architecture is based on IntServ over DiffServ: the DiffServ region is PCN-enabled, RSVP signalling is used end-to-end but the PCN-domain is a single RSVP hop, i.e. only the PCN- boundary-nodes process RSVP messages. In this scenario, RSVP authentication may be required among PCN-boundary-nodes and the considerations about keying approaches discussed earlier in this document apply. In particular, group keying may facilitate operations since the ingress PCN-boundary-node does not necessarily know ahead of time which Egress PCN-boundary-node will intercept and process the initial end-to-end Path message. From the viewpoint of securing end-to-end RSVP, there are a lot of similarities in scenarios involving RSVP Aggregation over aggregate RSVP reservations ([RFC3175], [RFC4860]), RSVP Aggregation over MPLS-TE tunnels ([RFC4804]), and RSVP (Aggregation) over PCN ingress-egress aggregates.</li>
</ul>
<h1 id="rfc.section.9">
<a href="#rfc.section.9">9.</a> Summary</h1>
<p id="rfc.section.9.p.1">The following table summarizes the various approaches for RSVP keying, and their applicability to various RSVP scenarios. In particular, such keying can be used for RSVP authentication (e.g., using the RSVP INTEGRITY object or AH) and/ or for RSVP encryption (e.g., using ESP in tunnel mode).</p>
<p></p>
<div id="#rfc.table.1"></div>
<p></p>
<table cellpadding="3" cellspacing="0" class="tt full center">
<thead><tr>
<th class="left"></th>
<th class="center">per neighbor/per interface keys</th>
<th class="center">Group keys</th>
</tr></thead>
<tbody>
<tr>
<td class="left">Works intra-domain</td>
<td class="center">Yes</td>
<td class="center">Yes</td>
</tr>
<tr>
<td class="left">Works inter-domain</td>
<td class="center">Yes</td>
<td class="center">No</td>
</tr>
<tr>
<td class="left">Works over non-RSVP hops</td>
<td class="center">No</td>
<td class="center">Yes (1)</td>
</tr>
<tr>
<td class="left">Dynamic keying</td>
<td class="center">Yes (IKE)</td>
<td class="center">Yes (e.g., GDOI)</td>
</tr>
</tbody>
</table>
<p>Table 1: Overview of keying approaches and their applicability</p>
<p id="rfc.section.9.p.3">(1): RSVP integrity with group keys works over non-RSVP nodes; RSVP encryption with ESP and RSVP authentication with AH work over non-RSVP nodes in 'Tunnel Mode with Address Preservation'; RSVP encryption with ESP &amp; RSVP authentication with AH do not work over non-RSVP nodes in 'Tunnel Mode'.</p>
<p id="rfc.section.9.p.4">We also make the following observations:</p>
<p></p>

<ul>
<li>All key types can be used statically, or with dynamic key negotiation. This impacts the manageability of the solution, but not the applicability itself.</li>
<li>For encryption of RSVP messages, IPsec ESP in tunnel mode can be used.</li>
<li>There are some special cases in RSVP, like non-RSVP hosts, the "Notify" message (as discussed in Section 5.1), the various RSVP deployment models discussed in Section 8 and MPLS Traffic Engineering and GMPLS discussed in section 5.2 , which would benefit from a group keying approach.</li>
</ul>
<h1 id="rfc.section.10">
<a href="#rfc.section.10">10.</a> Security Considerations</h1>
<p id="rfc.section.10.p.1">This entire document discusses RSVP security; this section describes a specific security considerations relating to subverted RSVP nodes.</p>
<h1 id="rfc.section.10.1">
<a href="#rfc.section.10.1">10.1.</a> Subverted Nodes</h1>
<p id="rfc.section.10.1.p.1">A subverted node is defined here as an untrusted node, for example because an intruder has gained control over it. Since RSVP authentication is hop-by-hop and not end-to-end, a subverted node in the path breaks the chain of trust. This is to a large extent independent of the type of keying used.</p>
<p id="rfc.section.10.1.p.2">For interface or per neighbor keying, the subverted node can now introduce fake messages to its neighbors. This can be used in a variety of ways, for example by changing the receiver address in the Path message, or by generating fake Path messages. This allows path states to be created on every RSVP router along any arbitrary path through the RSVP domain. That in itself could result in a form of Denial of Service by allowing exhaustion of some router resources (e.g. memory). The subverted node could also generate fake Resv messages upstream corresponding to valid Path states. In doing so, the subverted node can reserve excessive amounts of bandwidth thereby possibly performing a denial of service attack.</p>
<p id="rfc.section.10.1.p.3">Group keying allows the additional abuse of sending fake RSVP messages to any node in the RSVP domain, not just adjacent RSVP nodes.  However, in practice this can be achieved to a large extent also with per neighbor or interface keys, as discussed above. Therefore the impact of subverted nodes on the path is comparable for all keying schemes discussed here (per interface, per neighbor, group keys).</p>
<h1 id="rfc.section.11">
<a href="#rfc.section.11">11.</a> Acknowledgements</h1>
<p id="rfc.section.11.p.1">The authors would like to thank everybody who provided feedback on this document. Specific thanks to Bob Briscoe, Hannes Tschofenig, Ran Atkinson, Stephen Kent, and Kenneth G. Carlberg.</p>
<h1 id="rfc.section.12">
<a href="#rfc.section.12">12.</a> IANA Considerations</h1>
<p id="rfc.section.12.p.1">There are no IANA considerations within this document. This section can be removed if this document is published as an RFC.</p>
<h1 id="rfc.references">
<a href="#rfc.references">13.</a> References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2205">[RFC2205]</b></td>
<td class="top">
<a href="mailto:Braden@ISI.EDU" title="USC Information Sciences Institute">Braden, B.</a>, <a href="mailto:lixia@cs.ucla.edu" title="UCLA Computer Science Department">Zhang, L.</a>, <a href="mailto:Berson@ISI.EDU" title="USC Information Sciences Institute">Berson, S.</a>, <a href="mailto:Herzog@WATSON.IBM.COM" title="IBM T. J. Watson Research Center">Herzog, S.</a> and <a href="mailto:jamin@EECS.UMICH.EDU" title="University of Michigan">S. Jamin</a>, "<a href="http://tools.ietf.org/html/rfc2205">Resource ReSerVation Protocol (RSVP) -- Version 1 Functional Specification</a>", RFC 2205, September 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2747">[RFC2747]</b></td>
<td class="top">
<a href="mailto:fred@cisco.com" title="Cisco Systems">Baker, F.</a>, <a href="mailto:lindell@ISI.EDU" title="USC Information Sciences Institute">Lindell, B.</a> and <a href="mailto:mohitt@microsoft.com" title="Microsoft Corporation">M. Talwar</a>, "<a href="http://tools.ietf.org/html/rfc2747">RSVP Cryptographic Authentication</a>", RFC 2747, January 2000.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3175">[RFC3175]</b></td>
<td class="top">
<a>Baker, F.</a>, <a>Iturralde, C.</a>, <a>Le Faucheur, F.</a> and <a>B. Davie</a>, "<a href="http://tools.ietf.org/html/rfc3175">Aggregation of RSVP for IPv4 and IPv6 Reservations</a>", RFC 3175, September 2001.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3209">[RFC3209]</b></td>
<td class="top">
<a>Awduche, D.</a>, <a>Berger, L.</a>, <a>Gan, D.</a>, <a>Li, T.</a>, <a>Srinivasan, V.</a> and <a>G. Swallow</a>, "<a href="http://tools.ietf.org/html/rfc3209">RSVP-TE: Extensions to RSVP for LSP Tunnels</a>", RFC 3209, December 2001.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3473">[RFC3473]</b></td>
<td class="top">
<a>Berger, L.</a>, "<a href="http://tools.ietf.org/html/rfc3473">Generalized Multi-Protocol Label Switching (GMPLS) Signaling Resource ReserVation Protocol-Traffic Engineering (RSVP-TE) Extensions</a>", RFC 3473, January 2003.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3547">[RFC3547]</b></td>
<td class="top">
<a>Baugher, M.</a>, <a>Weis, B.</a>, <a>Hardjono, T.</a> and <a>H. Harney</a>, "<a href="http://tools.ietf.org/html/rfc3547">The Group Domain of Interpretation</a>", RFC 3547, July 2003.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3740">[RFC3740]</b></td>
<td class="top">
<a>Hardjono, T.</a> and <a>B. Weis</a>, "<a href="http://tools.ietf.org/html/rfc3740">The Multicast Group Security Architecture</a>", RFC 3740, March 2004.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4206">[RFC4206]</b></td>
<td class="top">
<a>Kompella, K.</a> and <a>Y. Rekhter</a>, "<a href="http://tools.ietf.org/html/rfc4206">Label Switched Paths (LSP) Hierarchy with Generalized Multi-Protocol Label Switching (GMPLS) Traffic Engineering (TE)</a>", RFC 4206, October 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4216">[RFC4216]</b></td>
<td class="top">
<a>Zhang, R.</a> and <a>J.-P. Vasseur</a>, "<a href="http://tools.ietf.org/html/rfc4216">MPLS Inter-Autonomous System (AS) Traffic Engineering (TE) Requirements</a>", RFC 4216, November 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4230">[RFC4230]</b></td>
<td class="top">
<a>Tschofenig, H.</a> and <a>R. Graveman</a>, "<a href="http://tools.ietf.org/html/rfc4230">RSVP Security Properties</a>", RFC 4230, December 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4090">[RFC4090]</b></td>
<td class="top">
<a>Pan, P.</a>, <a>Swallow, G.</a> and <a>A. Atlas</a>, "<a href="http://tools.ietf.org/html/rfc4090">Fast Reroute Extensions to RSVP-TE for LSP Tunnels</a>", RFC 4090, May 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4301">[RFC4301]</b></td>
<td class="top">
<a>Kent, S.</a> and <a>K. Seo</a>, "<a href="http://tools.ietf.org/html/rfc4301">Security Architecture for the Internet Protocol</a>", RFC 4301, December 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4302">[RFC4302]</b></td>
<td class="top">
<a>Kent, S.</a>, "<a href="http://tools.ietf.org/html/rfc4302">IP Authentication Header</a>", RFC 4302, December 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4303">[RFC4303]</b></td>
<td class="top">
<a>Kent, S.</a>, "<a href="http://tools.ietf.org/html/rfc4303">IP Encapsulating Security Payload (ESP)</a>", RFC 4303, December 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4804">[RFC4804]</b></td>
<td class="top">
<a>Le Faucheur, F.</a>, "<a href="http://tools.ietf.org/html/rfc4804">Aggregation of Resource ReSerVation Protocol (RSVP) Reservations over MPLS TE/DS-TE Tunnels</a>", RFC 4804, February 2007.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4860">[RFC4860]</b></td>
<td class="top">
<a>Le Faucheur, F.</a>, <a>Davie, B.</a>, <a>Bose, P.</a>, <a>Christou, C.</a> and <a>M. Davenport</a>, "<a href="http://tools.ietf.org/html/rfc4860">Generic Aggregate Resource ReSerVation Protocol (RSVP) Reservations</a>", RFC 4860, May 2007.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4875">[RFC4875]</b></td>
<td class="top">
<a>Aggarwal, R.</a>, <a>Papadimitriou, D.</a> and <a>S. Yasukawa</a>, "<a href="http://tools.ietf.org/html/rfc4875">Extensions to Resource Reservation Protocol - Traffic Engineering (RSVP-TE) for Point-to-Multipoint TE Label Switched Paths (LSPs)</a>", RFC 4875, May 2007.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5374">[RFC5374]</b></td>
<td class="top">
<a>Weis, B.</a>, <a>Gross, G.</a> and <a>D. Ignjatic</a>, "<a href="http://tools.ietf.org/html/rfc5374">Multicast Extensions to the Security Architecture for the Internet Protocol</a>", RFC 5374, November 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5559">[RFC5559]</b></td>
<td class="top">
<a>Eardley, P.</a>, "<a href="http://tools.ietf.org/html/rfc5559">Pre-Congestion Notification (PCN) Architecture</a>", RFC 5559, June 2009.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5945">[RFC5945]</b></td>
<td class="top">
<a>Le Faucheur, F.</a>, <a>Manner, J.</a>, <a>Wing, D.</a> and <a>A. Guillou</a>, "<a href="http://tools.ietf.org/html/rfc5945">Resource Reservation Protocol (RSVP) Proxy Approaches</a>", RFC 5945, October 2010.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.weis-gdoi-mac-tek">[I-D.weis-gdoi-mac-tek]</b></td>
<td class="top">
<a>Weis, B</a> and <a>S Rowles</a>, "<a href="http://tools.ietf.org/html/draft-weis-gdoi-mac-tek-03">GDOI Generic Message Authentication Code Policy</a>", Internet-Draft draft-weis-gdoi-mac-tek-03, September 2011.</td>
</tr>
</tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Michael H. Behringer</span> 
	  <span class="n hidden">
		<span class="family-name">Behringer</span>
	  </span>
	</span>
	<span class="org vcardline">Cisco Systems</span>
	<span class="adr">
	  <span>Village d'Entreprises Green Side</span>
<span>400, Avenue Roumanille, Batiment T 3</span>

	  <span class="vcardline">
		<span class="locality">Biot - Sophia Antipolis</span>,  
		<span class="region"></span>
		<span class="code">06410</span>
	  </span>
	  <span class="country-name vcardline">France</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:mbehring@cisco.com">mbehring@cisco.com</a></span>

<span class="vcardline">URI: <a href="http://www.cisco.com">http://www.cisco.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Francois Le Faucheur</span> 
	  <span class="n hidden">
		<span class="family-name">Le Faucheur</span>
	  </span>
	</span>
	<span class="org vcardline">Cisco Systems</span>
	<span class="adr">
	  <span>Village d'Entreprises Green Side</span>
<span>400, Avenue Roumanille, Batiment T 3</span>

	  <span class="vcardline">
		<span class="locality">Biot - Sophia Antipolis</span>,  
		<span class="region"></span>
		<span class="code">06410</span>
	  </span>
	  <span class="country-name vcardline">France</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:flefauch@cisco.com">flefauch@cisco.com</a></span>

<span class="vcardline">URI: <a href="http://www.cisco.com">http://www.cisco.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Brian Weis</span> 
	  <span class="n hidden">
		<span class="family-name">Weis</span>
	  </span>
	</span>
	<span class="org vcardline">Cisco Systems</span>
	<span class="adr">
	  <span>170 W. Tasman Drive</span>

	  <span class="vcardline">
		<span class="locality">San Jose, California</span>,  
		<span class="region"></span>
		<span class="code">95134-1706</span>
	  </span>
	  <span class="country-name vcardline">USA</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:bew@cisco.com">bew@cisco.com</a></span>

<span class="vcardline">URI: <a href="http://www.cisco.com">http://www.cisco.com</a></span>

  </address>
</div>

</body>
</html>