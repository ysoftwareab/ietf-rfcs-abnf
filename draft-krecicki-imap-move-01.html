<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Internet Message Access Protocol (IMAP) - MOVE extension</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Internet Message Access Protocol (IMAP) - MOVE extension">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 60em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 60em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">W. Krecicki</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Webstorage</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">June 11, 2010</td></tr>
<tr><td class="header">Expires: December 13, 2010</td><td class="header">&nbsp;</td></tr>
</table></td></tr></table>
<h1><br />Internet Message Access Protocol (IMAP) - MOVE extension<br />draft-krecicki-imap-move-01.txt</h1>

<h3>Abstract</h3>

<p>
    The MOVE extension of the Internet Message Access Protocol <a class='info' href='#IMAP4'>[IMAP4]<span> (</span><span class='info'>Crispin, M., &ldquo;INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1,&rdquo; March&nbsp;2003.</span><span>)</span></a>
    provides a feature intended to reduce the amount of time and 
    resources used by usual complicated methods of moving messages 
    between mailboxes by providing the capability of directly moving 
    messages.
      
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted  in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF).  Note that other groups may also distribute
working documents as Internet-Drafts.  The list of current
Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
This Internet-Draft will expire on December 13, 2010.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the Simplified BSD License.</p>

<a name="anchor1"></a><br /><hr />
<a name="rfc.section.1"></a><h3>1.&nbsp;
Conventions Used in this Document</h3>

<p>
    In examples, "C:" and "S:" indicate lines sent by the client and
    server respectively.

</p>
<p>
    The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
    "SHOULD", "SHOULD NOT", "MAY", and "OPTIONAL" in this document are
    to be interpreted as described in <a class='info' href='#KEYWORDS'>[KEYWORDS]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.

</p>
<a name="anchor2"></a><br /><hr />
<a name="rfc.section.2"></a><h3>2.&nbsp;
Introduction and Overview</h3>

<p>    Most of IMAP clients are moving messages between mailboxes by use of
    sequence of COPY, STORE +FLAGS (\Deleted) and EXPUNGE commands. This,
    though functionally equivalent to moving messages, is a lot more
    complicated on the server side than simple move.  When moving 
    large amounts of messages this can create unnecessary loads and 
    delays on server side.  It also prohibits user from moving a message
    which is larger than the remnant of his quota

</p>
<p>
    The MOVE extension allows simple single-command moving of messages 
    between mailboxes without creating additional unnecessary server-side 
    loads and without requiring user consideration about his quota limits 
    when simply moving message and not changing the overall amount of 
    data stored in his account.  MOVE command can be implemented as an atomic operation which is impossible with
    three-commands sequence currently used.

</p>
<p>
    The MOVE extension is present in any IMAP server implementation which
    returns "MOVE" as one of the supported capabilities to the CAPABILITY 
    command.

</p>
<p>
    The MOVE extension defines one additional command which MUST be
    supported by server that returns supports MOVE extension.

</p>
<a name="anchor3"></a><br /><hr />
<a name="rfc.section.3"></a><h3>3.&nbsp;
Additional commands</h3>

<p>
The following command definition is an extension to <a class='info' href='#IMAP4'>[IMAP4]<span> (</span><span class='info'>Crispin, M., &ldquo;INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1,&rdquo; March&nbsp;2003.</span><span>)</span></a> section 6.4.

</p>
<a name="anchor4"></a><br /><hr />
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
MOVE command</h3>

<p>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    Arguments:  sequence set
                mailbox name

    Data:       untagged responses: EXPUNGE

    Result:     OK - move completed
                NO - move error: can't move those messages or to that
                     mailbox
                BAD - command unknown or arguments invalid
</pre></div><p>


</p>
<p>
       The MOVE command moves messages from the currently selected
       mailbox to the end of the specified mailbox.  Messages that are 
       moved are expunged from selected mailbox.  Any messages that are 
       not included in the sequence set or do not exists are unaffected.  
       All flags (including \Deleted) and message internal date are 
       persistent through move.

</p>
<p>
       If the server does not support the MOVE capability, the client
       should fall back to using the regular COPY, STORE, EXPUNGE
       sequence. 

</p>
<p>
       Additionally if MOVE command can be directly preceeded by UID
       command, the sequence set argument is then treated as unique
       identifiers sequence instead of message sequence numbers as
       defined in <a class='info' href='#IMAP4'>[IMAP4]<span> (</span><span class='info'>Crispin, M., &ldquo;INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1,&rdquo; March&nbsp;2003.</span><span>)</span></a> paragraph 6.4.8.

</p>
<p>
       Command EXPUNGE untagged responses reports that the specified
       message sequence number has been permanently removed from selected
       mailbox (and moved to specified mailbox) as defined in <a class='info' href='#IMAP4'>[IMAP4]<span> (</span><span class='info'>Crispin, M., &ldquo;INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1,&rdquo; March&nbsp;2003.</span><span>)</span></a>
       paragraph 7.4.1.

</p>
<p>
       The MOVE command SHOULD be atomic and server SHOULD keep both mailboxes in
       consistent state at all times, at no time SHOULD the moved messages
       be visible by any concurrent session in both source and destination
       mailboxes or in none of these mailboxes.  The
       server MUST assure that after succesful operation all the moved
       messages are in the destination mailbox and no moved messages are in
       the source mailbox. The server SHOULD assure that after unsuccesful
       operation no messages are moved to the destination folder and all
       messages remain in source folder. In case of unsuccesful operation
       the server MUST assure
       that no messages that were being moved are expunged from source
       mailbox without being moved to destination mailbox.

</p>
<p>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    Example:    C: A003 MOVE 3000:3002 Trash
                S: * 3002 EXPUNGE
                S: * 3001 EXPUNGE
                S: * 3000 EXPUNGE
                S: A003 OK MOVE completed
                C: A004 UID MOVE 4000:* Trash
                S: * 3010 EXPUNGE
                S: * 3009 EXPUNGE
                S: * 3008 EXPUNGE
                S: A004 OK MOVE completed
</pre></div><p>

</p>
<a name="anchor5"></a><br /><hr />
<a name="rfc.section.4"></a><h3>4.&nbsp;
Response Codes</h3>

<p>
    If the server supports both the UIDPLUS and MOVE extensions it SHOULD return
    COPYUID response code as a part of tagged OK response to a MOVE
    command, as defined in <a class='info' href='#UIDPLUS'>[UIDPLUS]<span> (</span><span class='info'>Crispin, M., &ldquo;Internet Message Access Protocol (IMAP) - UIDPLUS extension,&rdquo; December&nbsp;2005.</span><span>)</span></a> paragraph 4.3.

</p>
<a name="anchor6"></a><br /><hr />
<a name="rfc.section.5"></a><h3>5.&nbsp;
Formal Syntax</h3>

<p>
    Formal syntax is defined using ABNF <a class='info' href='#ABNF'>[ABNF]<span> (</span><span class='info'>Crocker, D., Ed. and P. Overell, &ldquo;Augmented BNF for Syntax Specifications: ABNF,&rdquo; November&nbsp;1997.</span><span>)</span></a>, extending the ABNF rules
    defined in <a class='info' href='#IMAP4'>[IMAP4]<span> (</span><span class='info'>Crispin, M., &ldquo;INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1,&rdquo; March&nbsp;2003.</span><span>)</span></a>.  The IMAP4 ABNF should be imported first before
    attempting to validate these rules.
    
</p>
<p>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    capability      =/ "MOVE"

    command-select  =/ move

    move            = "MOVE" SP sequence-set SP mailbox

    uid             =/ "UID" SP move

</pre></div><p>


</p>
<a name="anchor7"></a><br /><hr />
<a name="rfc.section.6"></a><h3>6.&nbsp;
IANA Considerations</h3>

<p>
    This document constitutes registration of the MOVE capability in
    the imap4-capabilities.

</p>
<a name="rfc.references1"></a><br /><hr />
<h3>7.&nbsp;References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="ABNF">[ABNF]</a></td>
<td class="author-text"><a href="mailto:dcrocker@imc.org">Crocker, D., Ed.</a> and <a href="mailto:paulo@turnpike.com">P. Overell</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2234">Augmented BNF for Syntax Specifications: ABNF</a>,&rdquo; RFC&nbsp;2234, November&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2234.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2234.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2234.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="IMAP4">[IMAP4]</a></td>
<td class="author-text">Crispin, M., &ldquo;<a href="http://tools.ietf.org/html/rfc3501">INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1</a>,&rdquo; RFC&nbsp;3501, March&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3501.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="UIDPLUS">[UIDPLUS]</a></td>
<td class="author-text">Crispin, M., &ldquo;<a href="http://tools.ietf.org/html/rfc4315">Internet Message Access Protocol (IMAP) - UIDPLUS extension</a>,&rdquo; RFC&nbsp;4315, December&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4315.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="KEYWORDS">[KEYWORDS]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<h3>Author's Address</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Witold Krecicki</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Webstorage sp. z o.o.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Jutrzenki 177</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Warszawa  02-231</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Poland</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:witold.krecicki@firma.o2.pl">witold.krecicki@firma.o2.pl</a></td></tr>
</table>
</body></html>
