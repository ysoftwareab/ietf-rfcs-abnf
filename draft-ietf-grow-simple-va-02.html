<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Simple Virtual Aggregation (S-VA)</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Scope of this Document">
<link href="#rfc.section.1.2" rel="Chapter" title="1.2 Requirements notation">
<link href="#rfc.section.1.3" rel="Chapter" title="1.3 Terminology">
<link href="#rfc.section.2" rel="Chapter" title="2 Operation of S-VA">
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 Tunnels">
<link href="#rfc.section.2.2" rel="Chapter" title="2.2 Legacy Routers">
<link href="#rfc.section.3" rel="Chapter" title="3 IANA Considerations">
<link href="#rfc.section.4" rel="Chapter" title="4 Security Considerations">
<link href="#rfc.section.5" rel="Chapter" title="5 Acknowledgements">
<link href="#rfc.references" rel="Chapter" title="6 References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="The continued growth in the Default Free Routing Table (DFRT) stresses the global routing system in a number of ways.  One of the most costly stresses is FIB size:  ISPs often must upgrade router hardware simply because the FIB has run out of space, and router vendors must design routers that have adequate FIB.  FIB suppression is an approach to relieving stress on the FIB by NOT loading selected RIB entries into the FIB.  Simple Virtual Aggregation (S-VA) is a simple form of Virtual Aggregation (VA) that allows any and all edge routers to shrink their FIB requirements substantially and therefore increase their useful lifetime.  S-VA does not change FIB requirements for core routers.  S-VA is extremely easy to configure---considerably more so than the various tricks done today to extend the life of edge routers.  S-VA can be deployed autonomously by an ISP (cooperation between ISPs is not required), and can co-exist with legacy routers in the ISP.  There are no changes from the 01 version to this version.  " />
  <meta name="description" content="The continued growth in the Default Free Routing Table (DFRT) stresses the global routing system in a number of ways.  One of the most costly stresses is FIB size:  ISPs often must upgrade router hardware simply because the FIB has run out of space, and router vendors must design routers that have adequate FIB.  FIB suppression is an approach to relieving stress on the FIB by NOT loading selected RIB entries into the FIB.  Simple Virtual Aggregation (S-VA) is a simple form of Virtual Aggregation (VA) that allows any and all edge routers to shrink their FIB requirements substantially and therefore increase their useful lifetime.  S-VA does not change FIB requirements for core routers.  S-VA is extremely easy to configure---considerably more so than the various tricks done today to extend the life of edge routers.  S-VA can be deployed autonomously by an ISP (cooperation between ISPs is not required), and can co-exist with legacy routers in the ISP.  There are no changes from the 01 version to this version.  " />
  <meta name="keywords" content="" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Network Working Group</td>
<td class="right">P. Francis</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">MPI-SWS</td>
</tr>
<tr>
<td class="left">Intended status: Informational</td>
<td class="right">X. Xu</td>
</tr>
<tr>
<td class="left">Expires: September 03, 2011</td>
<td class="right">Huawei</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">H. Ballani</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Cornell U.</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">R. Raszuk</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Cisco</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">L. Zhang</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">UCLA</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">March 02, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Simple Virtual Aggregation (S-VA)<br />
  <span class="filename">draft-ietf-grow-simple-va-02.txt</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>The continued growth in the Default Free Routing Table (DFRT) stresses the global routing system in a number of ways.  One of the most costly stresses is FIB size:  ISPs often must upgrade router hardware simply because the FIB has run out of space, and router vendors must design routers that have adequate FIB.  FIB suppression is an approach to relieving stress on the FIB by NOT loading selected RIB entries into the FIB.  Simple Virtual Aggregation (S-VA) is a simple form of Virtual Aggregation (VA) that allows any and all edge routers to shrink their FIB requirements substantially and therefore increase their useful lifetime.  S-VA does not change FIB requirements for core routers.  S-VA is extremely easy to configure---considerably more so than the various tricks done today to extend the life of edge routers.  S-VA can be deployed autonomously by an ISP (cooperation between ISPs is not required), and can co-exist with legacy routers in the ISP.  There are no changes from the 01 version to this version.  </p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted to IETF in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on September 03, 2011.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>1.1.   <a href="#rfc.section.1.1">Scope of this Document</a>
</li>
<li>1.2.   <a href="#rfc.section.1.2">Requirements notation</a>
</li>
<li>1.3.   <a href="#rfc.section.1.3">Terminology</a>
</li>
<li>2.   <a href="#rfc.section.2">Operation of S-VA</a>
</li>
<li>2.1.   <a href="#rfc.section.2.1">Tunnels</a>
</li>
<li>2.2.   <a href="#rfc.section.2.2">Legacy Routers</a>
</li>
<li>3.   <a href="#rfc.section.3">IANA Considerations</a>
</li>
<li>4.   <a href="#rfc.section.4">Security Considerations</a>
</li>
<li>5.   <a href="#rfc.section.5">Acknowledgements</a>
</li>
<li>6.   <a href="#rfc.references">References</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> <a href="#sec-intro" id="sec-intro">Introduction</a>
</h1>
<p id="rfc.section.1.p.1">ISPs today manage constant DFRT growth in a number of ways.  One way, of course, is for ISPs to upgrade their router hardware before DFRT growth outstrips the size of the FIB.  This is too expensive for many ISPs.  They would prefer to extend the lifetime of routers whose FIBs can no longer hold the full DFRT.  </p>
<p id="rfc.section.1.p.2">A common approach taken by lower-tier ISPs is to default route to their providers.  Routes to customers and peer ISPs are maintained, but everything else defaults to the provider.  This approach has several disadvantages.  First, packets to Internet destinations may take longer-than-necessary AS paths.  This problem can be mitigated through careful configuration of partial defaults, but this can require substantial configuration overhead.  A second problem with defaulting to providers is that the ISP is no longer able to provide the full DFRT to its customers.  Finally, provider defaults prevents the ISP from being able to detect martian packets.  As a result, the ISP transmits packets that could otherwise have been dropped over its expensive provider links.  Simple Virtual Aggregation (S-VA) solves these problems because the full DFRT is used by core routers.  </p>
<p id="rfc.section.1.p.3">An alternative is for the ISP to maintain full routes in its core routers, but to filter routes from edge routers that do not require a full DFRT.  These edge routers can then default route to the core routers.  This is often possible with edge routers that interface to customer networks.  The problem with this approach is that it cannot be used for all edge routers.  For instance, it cannot be used for routers that connect to transits.  It should also not be used for routers that connect to customers which wish to receive the full DFRT.  </p>
<p id="rfc.section.1.p.4">This draft describes a very simple technique, called Simple Virtual Aggregation (S-VA), that allows any and all edge routers to have substantially reduced FIB requirements even while still advertising and receiving the full DFRT over BGP.  The basic idea is as follows.  Core routers in the ISP maintain the full DFRT in the FIB and RIB.  Edge routers maintain the full DFRT in the RIB, but suppress certain routes from the FIB.  Edge routers install a default route to core routers.  Label Switched Paths (LSP) are used to transmit packets from a core router, through the edge router, to the Next Hop remote Autonomous System Border Router (ASBR).  ASBRs strip the tunnel header (MPLS or IP) before forwarding tunneled packets to the remote ASBR (in much the same way MPLS Penultimate Hop Popping (PHP) strips the LSP header before forwarding packets to the tunnel target).  </p>
<p id="rfc.section.1.p.5">S-VA requires no changes to BGP and no changes to MPLS forwarding mechanisms in routers.  Configuration is extremely simple: S-VA must be enabled, and routers must told whether they are FIB-suppressing routers or not.  Everything else is automatic.  ISPs can deploy FIB suppression autonomously and with no coordination with neighbor ASes.  </p>
<h1 id="rfc.section.1.1">
<a href="#rfc.section.1.1">1.1.</a> <a href="#sec-scope" id="sec-scope">Scope of this Document</a>
</h1>
<p id="rfc.section.1.1.p.1">The scope of this document is limited to Intra-domain S-VA operation.  In other words, the case where a single ISP autonomously operates S-VA internally without any coordination with neighboring ISPs.  </p>
<p id="rfc.section.1.1.p.2">Note that this document assumes that the S-VA "domain" (i.e. the unit of autonomy) is the AS (that is, different ASes run S-VA independently and without coordination).  For the remainder of this document, the terms ISP, AS, and domain are used interchangeably.  </p>
<p id="rfc.section.1.1.p.3">This document applies equally to IPv4 and IPv6.  </p>
<p id="rfc.section.1.1.p.4">S-VA may operate with a mix of upgraded routers and legacy routers.  There are no topological restrictions placed on the mix of routers.  In order to avoid loops between upgraded and legacy routers, however, legacy routers must be able to terminate tunnels.  </p>
<p id="rfc.section.1.1.p.5">Note that S-VA is a greatly simplified variant of "full VA" <a href="#I-D.ietf-grow-va">[I-D.ietf-grow-va]</a>.  With full VA, all routers (core or otherwise) can have reduced FIBs.  However, full VA requires substantial new configuration and operational complexity compared to S-VA.  Note that S-VA was formerly specified in <a href="#I-D.ietf-grow-va">[I-D.ietf-grow-va]</a>.  It has been moved to this separate draft to simplify its understanding.  </p>
<h1 id="rfc.section.1.2">
<a href="#rfc.section.1.2">1.2.</a> Requirements notation</h1>
<p id="rfc.section.1.2.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">[RFC2119]</a>.  </p>
<h1 id="rfc.section.1.3">
<a href="#rfc.section.1.3">1.3.</a> Terminology</h1>
<p></p>

<dl>
<dt>FIB-Installing Router (FIR):</dt>
<dd style="margin-left: 8">An S-VA router that does not suppress any routes, and advertises itself as a default route for 0/0.  Typically a core router or route reflector would be configured as an FIR.  </dd>
<dt>FIB-Suppressing Router (FSR):</dt>
<dd style="margin-left: 8">An S-VA router that installs a route to 0/0, and may suppress other routes.  Typically an edge router would be configured as an FSR.  </dd>
<dt>Install and Suppress:</dt>
<dd style="margin-left: 8">The terms "install" and "suppress" are used to describe whether a RIB entry has been loaded or not loaded into the FIB.  In other words, the phrase "install a route" means "install a route into the FIB", and the phrase "suppress a route" means "do not install a route into the FIB".  </dd>
<dt>Legacy Router:</dt>
<dd style="margin-left: 8">A router that does not run S-VA, and has no knowledge of S-VA.  </dd>
<dt>Routing Information Base (RIB):</dt>
<dd style="margin-left: 8">The term RIB is used rather sloppily in this document to refer either to the loc-RIB (as used in <a href="#RFC4271">[RFC4271]</a>), or to the combined Adj-RIBs-In, the Loc-RIB, and the Adj-RIBs-Out.  </dd>
</dl>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> <a href="#basic-operation" id="basic-operation">Operation of S-VA</a>
</h1>
<p id="rfc.section.2.p.1">There are three types of routers in S-VA, FIB-Installing routers (FIR), FIB-Suppressing routers (FSR), and optionally legacy routers.  While any router can be an FIR or an FSR (there are no topology constraints), the simplist form of deployment is for border routers to be configured as edge routers, and for non-border routers (for instance the routers used as route reflectors) to be configured as core routers.  S-VA, however, does not mandate this deployment per se.  </p>
<p id="rfc.section.2.p.2">FIRs must originate a BGP route to NLRI 0/0 <a href="#RFC4271">[RFC4271]</a>.  The ORIGIN is set to INCOMPLETE (value 2), the AS number of the FIR's AS is used in the AS_PATH, and the BGP NEXT_HOP is set to the router's own address.  The ATOMIC_AGGREGATE and AGGREGATOR attributes are not included.  The FIR MUST attach a NO_EXPORT Communities Attribute <a href="#RFC1997">[RFC1997]</a> to the route.  </p>
<p id="rfc.section.2.p.3">FIRs must not FIB-suppress any routes.  </p>
<p id="rfc.section.2.p.4">FSRs must FIB-install a route to 0/0.  When transmitting a packet to a FIR (i.e. based on a 0/0 FIB lookup), the packet must be tunneled.  This is to prevent loops that would otherwise occur when a packet transits multiple FSRs on the way to the core, some of which have FIB-installed the route for the destination, and others of which have not.  FSRs may FIB-install any other routes.  They should install any routes for which their eBGP neighbor is the NEXT_HOP.  There are a couple reasons for this, which can be illustrated in the figure below.  This figure shows an autonomous system with a FIR FIR1 and an FSR FSR1.  FSR1 is an ASBR and is connected to two remote ASBRs, EP1 and EP2.  </p>
<div id="#rfc.figure.1"></div>
<pre>
     +------------------------------------------+
     |      Autonomous System                   |   +----+
     |                                          |   |EP1 |
     |                                      /---+---|    |
     |   To   ----\ +----+          +----+ /    |   +----+
     | Other       \|FIR1|----------|FSR1|/     |
     |Routers      /|    |          |    |\     |
     |        ----/ +----+          +----+ \    |   +----+
     |                                      \---+---|EP2 |
     |                                          |   |    |
     |                                          |   +----+
     +------------------------------------------+
 </pre>
<p id="rfc.section.2.p.5">Suppose that FSR1 does not FIB-install routes for which EP1 and EP2 are next hops.  In this case, when EP2 sends a packet to FSR1 for which the next hop is EP1, FSR1 will first tunnel the packet to FIR1, which will tunnel it right back to FSR1.  This trombone routing is avoided if local ASBRs FIB-install routes where their neighbor remote ASBRs are the BGP NEXT_HOP.  </p>
<p id="rfc.section.2.p.6">In addition, FSR1 cannot filter source addresses using strict unicast Reverse Path Forwarding (uRPF) unless it FIB-installs the routes learned from the remote ASBR.  Note, however, that FSRs cannot do loose uRPF.  Rather, this must be done by FIRs.  </p>
<p id="rfc.section.2.p.7">The above observations lead to the following rules: FSRs that are ASBRs should FIB-install all routes for which the neighbor is the BGP NEXT_HOP.  FSRs that are ASBRs must FIB-install any routes that are used for uRPF.  </p>
<h1 id="rfc.section.2.1">
<a href="#rfc.section.2.1">2.1.</a> <a href="#sec-tunnels" id="sec-tunnels">Tunnels</a>
</h1>
<p id="rfc.section.2.1.p.1">S-VA works with both MPLS and IP-in-IP tunnels.  There are potentially up to two tunnels required for a packet to traverse an AS with S-VA.  The first tunnel is that from an FSR to a FIR (for the 0/0 default).  This is called the default tunnel.  The second tunnel targets the remote ASBR which is the BGP NEXT_HOP, although the tunnel header is stripped by the local ASBR before transmitting to the remote ASBR.  This is the exit tunnel.  The start of the exit tunnel is an ingress local ASBR in the case where the ingress local ASBR has FIB-installed the associated route.  Otherwise, the start of the exit tunnel is a FIR.  </p>
<p id="rfc.section.2.1.p.2">The target address of the default tunnel is always the FIR.  If MPLS is used, the FIRs must initiate LSPs to themselves using either the Label Distribution Protocol (LDP) <a href="#RFC5036">[RFC5036]</a>.  RSVP-TE <a href="#RFC3209">[RFC3209]</a> may also be used.  </p>
<p id="rfc.section.2.1.p.3">If IP-in-IP tunnels are used, then the BGP Encapsulation Extended Community (BGPencap-Attribute) (<a href="#RFC5512">[RFC5512]</a>) is used to convey the ability to accept tunnels at the target address (the BGP NEXT_HOP).  </p>
<p id="rfc.section.2.1.p.4">For the exit tunnels, again either MPLS or IP-in-IP can be used.  In the case of IP-in-IP, the inner label defined in <a href="#RFC4023">[RFC4023]</a> and signaled in BGP with <a href="#RFC3107">[RFC3107]</a> is used by the local ASBR to identify the remote ASBR which is the BGP NEXT_HOP for the packet.  Specifically, when a local ASBR, which can be either an FSR or a FIR, advertises an eBGP-received route into iBGP, it sets the BGP NEXT_HOP as itself.  It assigns a label to the route.  This label is used as the inner label in packets tunneled to the local ASBR, and is used to identify the remote ASBR from which the route was received.  When receiving a packet with this label, the local ASBR strips off the label, and forwards the native packet to the remote ASBR indicated by the label.  </p>
<p id="rfc.section.2.1.p.5">In the case of MPLS, the inner label may or may not be used.  If it is used, then an LSP is established to the IP address of the local ASBR as described above for FIRs.  The BGP NEXT_HOP is set to be itself (the same address that serves as the FEC in the LSP).  The inner label is established as described in the previous paragraph for IP-in-IP tunnels, but with the encapsulation defined in <a href="#RFC3032">[RFC3032]</a>.  </p>
<p id="rfc.section.2.1.p.6">If the inner label is not used, then the local ASBR must initiate a Downstream Unsolicited LSP for each remote ASBR.  The FEC for the LSP is the remote ASBR address that is used in the BGP NEXT_HOP field.  When a packet is received on one of these LSPs, the local ASBR strips the MPLS header, and forwards the packet to the remote ASBR indicated by the label.  </p>
<h1 id="rfc.section.2.2">
<a href="#rfc.section.2.2">2.2.</a> <a href="#sec-legacy" id="sec-legacy">Legacy Routers</a>
</h1>
<p id="rfc.section.2.2.p.1">S-VA may be operated with a mix of legacy and S-VA-upgraded routers.  The legacy routers, however, must be able to forward tunneled packets.  In the case of MPLS tunnels, this means that they must fully participate in MPLS signaling.  If a legacy router is an ASBR, then it must also initiate tunnels to itself and be able to detunnel packets (without the inner label).  </p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#sec-iana" id="sec-iana">IANA Considerations</a>
</h1>
<p id="rfc.section.3.p.1">There are no IANA considerations.  </p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#sec-consider" id="sec-consider">Security Considerations</a>
</h1>
<p id="rfc.section.4.p.1">The authors are not aware of any new security considerations due to S-VA.  </p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#sec-ack" id="sec-ack">Acknowledgements</a>
</h1>
<p id="rfc.section.5.p.1">The concept for S-VA comes from Robert Raszuk.  </p>
<h1 id="rfc.references">
<a href="#rfc.references">6.</a> References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3107">[RFC3107]</b></td>
<td class="top">
<a>Rekhter, Y.</a> and <a>E. Rosen</a>, "<a href="http://tools.ietf.org/html/rfc3107">Carrying Label Information in BGP-4</a>", RFC 3107, May 2001.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4271">[RFC4271]</b></td>
<td class="top">
<a>Rekhter, Y.</a>, <a>Li, T.</a> and <a>S. Hares</a>, "<a href="http://tools.ietf.org/html/rfc4271">A Border Gateway Protocol 4 (BGP-4)</a>", RFC 4271, January 2006.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5036">[RFC5036]</b></td>
<td class="top">
<a>Andersson, L.</a>, <a>Minei, I.</a> and <a>B. Thomas</a>, "<a href="http://tools.ietf.org/html/rfc5036">LDP Specification</a>", RFC 5036, October 2007.</td>
</tr>
<tr>
<td class="reference"><b id="RFC1997">[RFC1997]</b></td>
<td class="top">
<a href="mailto:rchandra@cisco.com" title="cisco Systems, Inc.">Chandrasekeran, R.</a>, <a href="mailto:pst@cisco.com" title="cisco Systems, Inc.">Traina, P.</a> and <a href="mailto:tli@skat.usc.edu">T. Li</a>, "<a href="http://tools.ietf.org/html/rfc1997">BGP Communities Attribute</a>", RFC 1997, August 1996.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3209">[RFC3209]</b></td>
<td class="top">
<a>Awduche, D.</a>, <a>Berger, L.</a>, <a>Gan, D.</a>, <a>Li, T.</a>, <a>Srinivasan, V.</a> and <a>G. Swallow</a>, "<a href="http://tools.ietf.org/html/rfc3209">RSVP-TE: Extensions to RSVP for LSP Tunnels</a>", RFC 3209, December 2001.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-grow-va">[I-D.ietf-grow-va]</b></td>
<td class="top">
<a>Francis, P</a>, <a>Xu, X</a>, <a>Ballani, H</a>, <a>Jen, D</a>, <a>Raszuk, R</a> and <a>L Zhang</a>, "<a href="http://tools.ietf.org/html/draft-ietf-grow-va-00">FIB Suppression with Virtual Aggregation</a>", Internet-Draft draft-ietf-grow-va-00, May 2009.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4023">[RFC4023]</b></td>
<td class="top">
<a>Worster, T.</a>, <a>Rekhter, Y.</a> and <a>E. Rosen</a>, "<a href="http://tools.ietf.org/html/rfc4023">Encapsulating MPLS in IP or Generic Routing Encapsulation (GRE)</a>", RFC 4023, March 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5512">[RFC5512]</b></td>
<td class="top">
<a>Mohapatra, P</a> and <a>E Rosen</a>, "<a href="http://tools.ietf.org/html/rfc5512">BGP Encapsulation SAFI and BGP Tunnel Encapsulation Attribute</a>", RFC 5512, April 2009.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3032">[RFC3032]</b></td>
<td class="top">
<a>Rosen, E.</a>, <a>Tappan, D.</a>, <a>Fedorkow, G.</a>, <a>Rekhter, Y.</a>, <a>Farinacci, D.</a>, <a>Li, T.</a> and <a>A. Conta</a>, "<a href="http://tools.ietf.org/html/rfc3032">MPLS Label Stack Encoding</a>", RFC 3032, January 2001.</td>
</tr>
</tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Paul Francis</span> 
	  <span class="n hidden">
		<span class="family-name">Francis</span>
	  </span>
	</span>
	<span class="org vcardline">Max Planck Institute for Software Systems</span>
	<span class="adr">
	  <span>Gottlieb-Daimler-Strasse</span>

	  <span class="vcardline">
		<span class="locality">Kaiserslautern</span>,  
		<span class="region"></span>
		<span class="code">67633</span>
	  </span>
	  <span class="country-name vcardline">Germany</span>
	</span>
	<span class="vcardline">Phone: +49 631 930 39600</span>

<span class="vcardline">EMail: <a href="mailto:francis@mpi-sws.org">francis@mpi-sws.org</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Xiaohu Xu</span> 
	  <span class="n hidden">
		<span class="family-name">Xu</span>
	  </span>
	</span>
	<span class="org vcardline">Huawei Technologies</span>
	<span class="adr">
	  <span>No.3 Xinxi Rd., Shang-Di Information Industry Base, Hai-Dian District </span>

	  <span class="vcardline">
		<span class="locality">Beijing</span>,  
		<span class="region">Beijing</span> 
		<span class="code">100085</span>
	  </span>
	  <span class="country-name vcardline">P.R.China</span>
	</span>
	<span class="vcardline">Phone: +86 10 82836073</span>

<span class="vcardline">EMail: <a href="mailto:xuxh@huawei.com">xuxh@huawei.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Hitesh Ballani</span> 
	  <span class="n hidden">
		<span class="family-name">Ballani</span>
	  </span>
	</span>
	<span class="org vcardline">Cornell University</span>
	<span class="adr">
	  <span>4130 Upson Hall</span>

	  <span class="vcardline">
		<span class="locality">Ithaca</span>,  
		<span class="region">NY</span> 
		<span class="code">14853</span>
	  </span>
	  <span class="country-name vcardline">US</span>
	</span>
	<span class="vcardline">Phone: +1 607 279 6780</span>

<span class="vcardline">EMail: <a href="mailto:hitesh@cs.cornell.edu">hitesh@cs.cornell.edu</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Robert Raszuk</span> 
	  <span class="n hidden">
		<span class="family-name">Raszuk</span>
	  </span>
	</span>
	<span class="org vcardline">Cisco Systems, Inc.</span>
	<span class="adr">
	  <span>170 West Tasman Drive</span>

	  <span class="vcardline">
		<span class="locality">San Jose</span>,  
		<span class="region">CA </span> 
		<span class="code">95134 </span>
	  </span>
	  <span class="country-name vcardline">USA </span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:raszuk@cisco.com">raszuk@cisco.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Lixia Zhang</span> 
	  <span class="n hidden">
		<span class="family-name">Zhang</span>
	  </span>
	</span>
	<span class="org vcardline">UCLA</span>
	<span class="adr">
	  <span>3713 Boelter Hall </span>

	  <span class="vcardline">
		<span class="locality">Los Angeles</span>,  
		<span class="region">CA</span> 
		<span class="code">90095 </span>
	  </span>
	  <span class="country-name vcardline">US</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:lixia@cs.ucla.edu">lixia@cs.ucla.edu</a></span>

  </address>
</div>

</body>
</html>