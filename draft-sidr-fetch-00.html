<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Alternative RPKI Repository Retrieval Mechanism</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Alternative RPKI Repository Retrieval Mechanism">
<meta name="keywords" content="ARRRM">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Secure Inter-Domain Routing</td><td class="header">T. Manderson</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">G. Michaelson</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">APNIC</td></tr>
<tr><td class="header">Expires: December 25, 2008</td><td class="header">June 23, 2008</td></tr>
</table></td></tr></table>
<h1><br />Alternative RPKI Repository Retrieval Mechanism<br />draft-sidr-fetch-00</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on December 25, 2008.</p>

<h3>Abstract</h3>

<p>This document proposes a mechanism for a relying party to synchronise
a local cache of the RPKI repository using a HTTP retrieval mechanism.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">1.1.</a>&nbsp;
Terminology<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">1.2.</a>&nbsp;
Requirements Language<br />
<a href="#anchor4">2.</a>&nbsp;
Overview<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">2.1.</a>&nbsp;
RPKI Repository<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">2.2.</a>&nbsp;
Publication Points<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">2.3.</a>&nbsp;
RPKI Manifests<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">2.4.</a>&nbsp;
Object URI<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">2.5.</a>&nbsp;
CA and Manifest Relationship<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">2.6.</a>&nbsp;
Traversing a RPKI Repository<br />
<a href="#anchor11">3.</a>&nbsp;
Transport Protocol<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">3.1.</a>&nbsp;
HTTP<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">3.2.</a>&nbsp;
HTTPS<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">3.3.</a>&nbsp;
Other Protocols<br />
<a href="#anchor15">4.</a>&nbsp;
Retrieval<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor16">4.1.</a>&nbsp;
Retrieval Algorithm<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor17">4.1.1.</a>&nbsp;
Post RPKI Validated (PRV)<br />
<a href="#anchor18">5.</a>&nbsp;
Client Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor19">5.1.</a>&nbsp;
Hash Comparison<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor20">5.2.</a>&nbsp;
Hash Mismatch<br />
<a href="#Acknowledgements">6.</a>&nbsp;
Acknowledgements<br />
<a href="#IANA">7.</a>&nbsp;
IANA Considerations<br />
<a href="#Security">8.</a>&nbsp;
Security Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor21">8.1.</a>&nbsp;
RC to RRS Channel Attacks<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor22">8.2.</a>&nbsp;
RRS and Manifest Integrity<br />
<a href="#rfc.references1">9.</a>&nbsp;
Normative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>
      This document details a mechanism and algorithm for a relying party to synchronise a local
cache of RPKI objects against the collection of original publication
points.
      
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Terminology</h3>

<p>It is assumed that the reader is familiar with the terms and concepts described in  
         <a class='info' href='#RFC3280'>"Internet X.509 Public Key Infrastructure
         Certificate and Certificate Revocation List (CRL) Profile"<span> (</span><span class='info'>Housley, R., Polk, W., Ford, W., and D. Solo, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; April&nbsp;2002.</span><span>)</span></a> [RFC3280],
         <a class='info' href='#I-D.ietf-sidr-res-certs'>"A Profile for X.509 PKIX Resource Certificates"<span> (</span><span class='info'>Huston, G., Michaelson, G., and R. Loomans, &ldquo;A Profile for X.509 PKIX Resource Certificates,&rdquo; September&nbsp;2009.</span><span>)</span></a> [I&#8209;D.ietf&#8209;sidr&#8209;res&#8209;certs] 
         <a class='info' href='#I-D.ietf-sidr-rpki-manifests'>"Manifests for the Resource Public Key Infrastructure"<span> (</span><span class='info'>Austein, R., Huston, G., Kent, S., and M. Lepinski, &ldquo;Manifests for the Resource Public Key Infrastructure,&rdquo; December&nbsp;2009.</span><span>)</span></a> [I&#8209;D.ietf&#8209;sidr&#8209;rpki&#8209;manifests],
        
         <a class='info' href='#RFC3779'>"X.509 Extensions for IP  Addresses and AS Identifiers"<span> (</span><span class='info'>Lynn, C., Kent, S., and K. Seo, &ldquo;X.509 Extensions for IP Addresses and AS Identifiers,&rdquo; June&nbsp;2004.</span><span>)</span></a> [RFC3779], 
         <a class='info' href='#RFC2616'>"Hypertext Transfer Protocol -- HTTP/1.1"<span> (</span><span class='info'>Fielding, R., Gettys, J., Mogul, J., Frystyk, H., Masinter, L., Leach, P., and T. Berners-Lee, &ldquo;Hypertext Transfer Protocol -- HTTP/1.1,&rdquo; June&nbsp;1999.</span><span>)</span></a> [RFC2616],  
         <a class='info' href='#RFC2818'>"HTTP Over TLS"<span> (</span><span class='info'>Rescorla, E., &ldquo;HTTP Over TLS,&rdquo; May&nbsp;2000.</span><span>)</span></a> [RFC2818],
          and related regional Internet registry address management policy documents.
        
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.2"></a><h3>1.2.&nbsp;
Requirements Language</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
        "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
        document are to be interpreted as described in RFC 2119.
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Overview</h3>

<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
RPKI Repository</h3>

<p>An RPKI Repository is a collection of RPKI Publication Points. 
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
Publication Points</h3>

<p>A Publication Point is the location where RPKI objects exist for public use. 
				The Publication Point also contains a manifest of all the RPKI objects that are published at that location. The Publication Point URI is held in the SIA of the 
			RPKI Certificate that signed the objects at that Publication Point.
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3"></a><h3>2.3.&nbsp;
RPKI Manifests</h3>

<p>A manifest is a signed object, listing of all of the RPKI objects at a publication point in the
   RPKI Repository, excluding the manifest itself. The manifest contains the file name and a hash of the contents of the RPKI object file.
</p>
<p>The URI to the manifest exists in the manifest SIA from the Certificate that signed the manifest.
</p>
<p>Manifest validation SHOULD be done according to <a class='info' href='#I-D.ietf-sidr-rpki-manifests'>"Manifests for the Resource Public Key Infrastructure"<span> (</span><span class='info'>Austein, R., Huston, G., Kent, S., and M. Lepinski, &ldquo;Manifests for the Resource Public Key Infrastructure,&rdquo; December&nbsp;2009.</span><span>)</span></a> [I&#8209;D.ietf&#8209;sidr&#8209;rpki&#8209;manifests].
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.4"></a><h3>2.4.&nbsp;
Object URI</h3>

<p>The object location URI is constructed by using the Publish Point from the Signing RPKI Certificate SIA and the File (name) in the manifest signed by the Signing RPKI Certificate.
			The exception to this is the Certificate Authority (CA) certificate and manifest relationship.
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.5"></a><h3>2.5.&nbsp;
CA and Manifest Relationship</h3>

<p>In the situation that the certificate in focus is the Certificate Authority (CA) certificate:
				</p>
<ul class="text">
<li>Like all <a class='info' href='#I-D.ietf-sidr-res-certs'>RPKI certificates<span> (</span><span class='info'>Huston, G., Michaelson, G., and R. Loomans, &ldquo;A Profile for X.509 PKIX Resource Certificates,&rdquo; September&nbsp;2009.</span><span>)</span></a> [I&#8209;D.ietf&#8209;sidr&#8209;res&#8209;certs] the CA contains a SIA that identifies a Publish Point and a Manifest.
</li>
<li>The CA signs an End Entity (EE) Certificate for the single purpose of signing the CA manifest.
</li>
<li>The EE certificate has an SIA that also identifies the manifest.
</li>
</ul><p>
			
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.6"></a><h3>2.6.&nbsp;
Traversing a RPKI Repository</h3>

<p>A generalised RPKI hierarchy structure of a resource repository, including the out of band collected Trust Anchor (CA), can be represented as:
</p>
<p>
				
				
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>


CA Certificate                  CA Publication Point
SIA --Repository-------&gt;+------------------------------+
    --Manifest-----------&gt; manifest.cms&lt;-------------------------+
                        |  CRL                         |         |
                        |  subord CA certs             |         |
                        |  subord multi-sign EE certs  |         |
                        |         SIA ------Repository-------+   |
                        |             ------Manifest-------+ |   |
                        |  subord 1:1 Manifest EE cert |   | |   |
                        |         SIA --Object-------------------+
                        |  subord 1:1 EE certs         |   | |
                        |         SIA --Object--+      |   | |
                        |                       |      |   | |
                        |           +-----------+      |   | |
                        |           V                  |   | |
                        |  signed Object               |   | |
                        |                              |   | |
                        +------------------------------+   | |
                                                           | |
                                     ----------------------+ |
                                     |                       |
                        +------------|---------------------+&lt;
                        |            V                     |
                        |         manifest.cms             |
                        |         signed objects           |
                        +----------------------------------+
                              EE Publication Point
                              (for multi-sign EEs)



</pre></div>
<p>The following broad algorithm MAY be used to traverse the hierarchy, starting with the Trust Anchor or CA RPKI Certificate.
</p>
<p></p>
<ol class="text">
<li>Collect the manifest referenced in the <a class='info' href='#I-D.ietf-sidr-res-certs'>id-ad-rpkiManifest<span> (</span><span class='info'>Huston, G., Michaelson, G., and R. Loomans, &ldquo;A Profile for X.509 PKIX Resource Certificates,&rdquo; September&nbsp;2009.</span><span>)</span></a> [I&#8209;D.ietf&#8209;sidr&#8209;res&#8209;certs] Manifest AccessMethod of the SIA of the Certificate.
</li>
<li>Collect, from the Publication Point, every valid object listed in the manifest.
</li>
<li>For each subordinate object with <a class='info' href='#I-D.ietf-sidr-res-certs'>id-ad-signedObjectRepository<span> (</span><span class='info'>Huston, G., Michaelson, G., and R. Loomans, &ldquo;A Profile for X.509 PKIX Resource Certificates,&rdquo; September&nbsp;2009.</span><span>)</span></a> [I&#8209;D.ietf&#8209;sidr&#8209;res&#8209;certs] and id-ad-rpkiManifest
				 access method SIA values repeat fom step 1.
</li>
</ol>

<p>Processing of each subordinate Publish Point MAY be done in parallel, provided sufficient RPKI material has been collected for Manifest and RPKI validation.
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Transport Protocol</h3>

<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
HTTP</h3>

<p>When transferring a RPKI objects <a class='info' href='#RFC2616'>HTTP 1.1<span> (</span><span class='info'>Fielding, R., Gettys, J., Mogul, J., Frystyk, H., Masinter, L., Leach, P., and T. Berners-Lee, &ldquo;Hypertext Transfer Protocol -- HTTP/1.1,&rdquo; June&nbsp;1999.</span><span>)</span></a> [RFC2616]SHOULD be used as the underlying transport mechanism, 
    	      as specified by the URI in the SIA field. Various HTTP methods MAY be used to minimise the number of fetches and data transfers over the transport connection.  
    	      
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
HTTPS</h3>

<p><a class='info' href='#RFC2818'>HTTPS<span> (</span><span class='info'>Rescorla, E., &ldquo;HTTP Over TLS,&rdquo; May&nbsp;2000.</span><span>)</span></a> [RFC2818] based transfers MAY be used in order to ensure the integrity of the repository site or to 
      		encrypt the retrieval of the RPKI objects. It is therefore up to the resource certificate issuer to understand any 
      		potential operational performance issues associated with using A HTTPS URI in the RPKI certificate SIA fields.
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
Other Protocols</h3>

<p>The retrieval algorithm specified in this document can also be used by other protocols as an effecient way to synchronise the RPKI repository with a local cache, provided 
      			HTTP specifics such as (but not limited to) redirects, http pragma, connection behaviours and pipe-lining are addresed.
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Retrieval</h3>

<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Retrieval Algorithm</h3>

<p>If the SIA for the Publish Point of the RPKI Certificate Authority (CA) Certificate or End Entity Certificate defines a HTTP or HTTPS access method in the URI then 
    	the following algorithm MAY be used by a Retrieval Client for any
   initial and subsequent fetch of certificates and signed outcomes (objects) from an RPKI
   Repository Server (RRS).
		
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1.1"></a><h3>4.1.1.&nbsp;
Post RPKI Validated (PRV)</h3>

<p>
    	</p>
<blockquote class="text"><dl>
<dt>a.</dt>
<dd>Fetch the appropriate <a class='info' href='#I-D.ietf-sidr-rpki-manifests'>manifest<span> (</span><span class='info'>Austein, R., Huston, G., Kent, S., and M. Lepinski, &ldquo;Manifests for the Resource Public Key Infrastructure,&rdquo; December&nbsp;2009.</span><span>)</span></a> [I&#8209;D.ietf&#8209;sidr&#8209;rpki&#8209;manifests] from the RRS. 
    		The RC MAY maintain the connection to the RRS with a persistent connection. 
</dd>
<dt>b.</dt>
<dd>Confirm the manifest's validity.
    	
    				
<ul class="text">
<li>If the manifest is invalid, or the manifest is empty, terminate processing and close any RRS connections
</li>
</ul>

    		
</dd>
<dt>c.</dt>
<dd>Construct a list of URIs to be retrieved by comparing 
    			hash values in the downloaded manifest, with the hash values of the locally cached object:
    		 
    		   
<ul class="text">
<li>If a local manifest does not exist then all objects
    		 contained in the manifest MUST be listed for retrieval.
    		   
</li>
<li>If an object entry in the downloaded manifest does not exist locally, the URI SHOULD be added to the retrieval list.
    		   
</li>
<li>If an object exists locally and does not appear in the manifest, it SHOULD be deleted from the local cache.
    		   
</li>
<li>If the hash value of the object in the downloaded manifest does not match the hash value of the local copy of the object, 
    		   	the URI of the object SHOULD be added to the retrieval list.
    		   
</li>
<li>If the retrieval list is empty, terminate processing and close any RRS connections.
    		   
</li>
</ul>
    		   
    		 
</dd>
<dt>d.</dt>
<dd>Fetch the list of objects using pipe-lined GET requests. 
    			
<ul class="text">
<li>HTTP redirects SHOULD be honoured by the client and followed using a separate RRS connection for the object.
    				
</li>
</ul>
    		
</dd>
<dt>e.</dt>
<dd>Confirm that all of the objects listed in the downloaded manifest have been retrieved.
</dd>
<dt>f.</dt>
<dd>Confirm the hash of the downloaded object file contents matches the hash stored in the downloaded manifest
    			
<ul class="text">
<li>If the hash does not match, the object MAY be newer than the manifest and the object SHOULD be RPKI validated.
    				
</li>
</ul>
    		
</dd>
<dt>g.</dt>
<dd>Close any RRS connections.
</dd>
<dt>h.</dt>
<dd>RPKI Validate the retrieved objects and store the validated objects in the local cache.
</dd>
</dl></blockquote><p>
    	
</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Client Considerations</h3>

<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Hash Comparison</h3>

<p>As described in the PRV algorithm, if the hash does not match, the object may be newer than the manifest. 
				It is RECOMMENDED that suitable warnings be generated by the retrieval client to alert to any issues of a hash mismatch.
</p>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Hash Mismatch</h3>

<p>To minimise the occurrences of hash values that do not match, the RC MAY consider postponing retrieval of a RPKI Repository for some period of time either 
				side of the "nextUpdate" time detailed in the manifest.
</p>
<a name="Acknowledgements"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Acknowledgements</h3>

<p>Due recognition needs to be given to all the individuals involved in the inter-RIR Resource Certificate working group.
</p>
<a name="IANA"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
IANA Considerations</h3>

<p>This memo includes no request to IANA.
</p>
<a name="Security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Security Considerations</h3>

<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.1"></a><h3>8.1.&nbsp;
RC to RRS Channel Attacks</h3>

<p>Using an unencrypted channel could expose the relying party to either man-in-the-middle or remote Denial of Service (DoS) HTTP/TCP attacks against the channel between the RC and the RRS.
</p>
<p>The certificate issuer should consider the potential for disruption to the relying party operations in selecting the preferred SIA access methods.
</p>
<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.2"></a><h3>8.2.&nbsp;
RRS and Manifest Integrity</h3>

<p>A scenario exists where a malicious attack could place an invalid RPKI certificate on the RRS in the Publication Point prior to the 
      		manifest creation. While this does not represent a high risk to the overall Resource Certificate system as the object will fail to validate, 
      		it may affect the Relying Party as:
      		</p>
<ul class="text">
<li>An object is extremely large and RC retrieves the object this may cause resource network or other types of congestion.
</li>
<li>Many invalid objects, which the RC must download, may affect overall performance or the RC or the overall Resource Certificate system.
</li>
</ul><p>
      	
</p>
<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.huston-sidr-repos-struct">[I-D.huston-sidr-repos-struct]</a></td>
<td class="author-text">Huston, G., Loomans, R., and G. Michaelson, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-huston-sidr-repos-struct-01.txt">A Profile for Resource Certificate Repository Structure</a>,&rdquo; draft-huston-sidr-repos-struct-01 (work in progress), February&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-huston-sidr-repos-struct-01.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-sidr-res-certs">[I-D.ietf-sidr-res-certs]</a></td>
<td class="author-text">Huston, G., Michaelson, G., and R. Loomans, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-sidr-res-certs-17.txt">A Profile for X.509 PKIX Resource Certificates</a>,&rdquo; draft-ietf-sidr-res-certs-17 (work in progress), September&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-sidr-res-certs-17.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-sidr-rpki-manifests">[I-D.ietf-sidr-rpki-manifests]</a></td>
<td class="author-text">Austein, R., Huston, G., Kent, S., and M. Lepinski, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-sidr-rpki-manifests-06.txt">Manifests for the Resource Public Key Infrastructure</a>,&rdquo; draft-ietf-sidr-rpki-manifests-06 (work in progress), December&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-sidr-rpki-manifests-06.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2616">[RFC2616]</a></td>
<td class="author-text"><a href="mailto:fielding@ics.uci.edu">Fielding, R.</a>, <a href="mailto:jg@w3.org">Gettys, J.</a>, <a href="mailto:mogul@wrl.dec.com">Mogul, J.</a>, <a href="mailto:frystyk@w3.org">Frystyk, H.</a>, <a href="mailto:masinter@parc.xerox.com">Masinter, L.</a>, <a href="mailto:paulle@microsoft.com">Leach, P.</a>, and <a href="mailto:timbl@w3.org">T. Berners-Lee</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2616">Hypertext Transfer Protocol -- HTTP/1.1</a>,&rdquo; RFC&nbsp;2616, June&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2616.txt">TXT</a>, <a href="http://www.rfc-editor.org/rfc/rfc2616.ps">PS</a>, <a href="http://www.rfc-editor.org/rfc/rfc2616.pdf">PDF</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2616.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2616.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2818">[RFC2818]</a></td>
<td class="author-text">Rescorla, E., &ldquo;<a href="http://tools.ietf.org/html/rfc2818">HTTP Over TLS</a>,&rdquo; RFC&nbsp;2818, May&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2818.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3280">[RFC3280]</a></td>
<td class="author-text">Housley, R., Polk, W., Ford, W., and D. Solo, &ldquo;<a href="http://tools.ietf.org/html/rfc3280">Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>,&rdquo; RFC&nbsp;3280, April&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3280.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3779">[RFC3779]</a></td>
<td class="author-text">Lynn, C., Kent, S., and K. Seo, &ldquo;<a href="http://tools.ietf.org/html/rfc3779">X.509 Extensions for IP Addresses and AS Identifiers</a>,&rdquo; RFC&nbsp;3779, June&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3779.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Terry Manderson</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">APNIC</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">AU</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+61 7 3858 3100</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:terry@apnic.net">terry@apnic.net</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">George Michaelson</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">APNIC</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">AU</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+61 7 3858 3100</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:ggm@apnic.net">ggm@apnic.net</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2008).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
