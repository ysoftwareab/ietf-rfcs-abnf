Network Working Group                                            C. Lin
Internet Draft                                                  M. Chen
Intended status: Standards Track                   New H3C Technologies
Expires: September 1, 2022                                     W. Cheng
                                                                L. Gong
                                                           China Mobile
                                                          March 1, 2022



      Advertisement of Dedicated Metric for Flexible Algorithm in IGP
                     draft-lin-lsr-flex-algo-metric-00


Abstract

   This document proposes a method to advertise dedicated metric for
   Flex-Algorithm in IGP.

Status of this Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups.  Note that
   other groups may also distribute working documents as Internet-
   Drafts.

   Internet-Drafts are draft documents valid for a maximum of six
   months and may be updated, replaced, or obsoleted by other documents
   at any time.  It is inappropriate to use Internet-Drafts as
   reference material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html

   This Internet-Draft will expire on September 1, 2022.

Copyright Notice

   Copyright (c) 2022 IETF Trust and the persons identified as the
   document authors. All rights reserved.





Lin, et al.            Expire September, 2022                 [Page 1]

Internet-Draft    Dedicated Metric for Flex-Algorithm       March 2022


   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (http://trustee.ietf.org/license-info) in effect on the date of
   publication of this document. Please review these documents
   carefully, as they describe your rights and restrictions with
   respect to this document. Code Components extracted from this
   document must include Simplified BSD License text as described in
   Section 4.e of the Trust Legal Provisions and are provided without
   warranty as described in the Simplified BSD License.

Table of Contents


   1. Introduction ................................................ 2
      1.1. Requirements Language .................................. 2
   2. Problem Statement ........................................... 3
   3. Dedicated Metric for Flexible Algorithm ..................... 4
   4. Security Considerations ..................................... 5
   5. IANA Considerations ......................................... 6
   6. References .................................................. 6
      6.1. Normative References ................................... 6
      6.2. Informative References ................................. 6
   Authors' Addresses ............................................. 7

1. Introduction

   Flexible Algorithm (Flex-Algorithm) allows IGP to compute
   constraint-based paths. [I-D.ietf-lsr-flex-algo] specifies the usage
   of Flex-Algorithm in Segment Routing (SR) data planes - SR MPLS and
   SRv6. [I-D.ietf-lsr-ip-flexalgo] extends the Flex-Algorithm for
   native IPv4 and IPv6 data planes.

   However, links shared among multiple algorithms cannot be configured
   by different metrics, which may limit the flexibility of Flex-
   Algorithm.

   This document proposes a method to advertise dedicated metric for
   Flex-Algorithm in IGP.

1.1. Requirements Language

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in
   BCP 14 [RFC2119] [RFC8174] when, and only when, they appear in all
   capitals, as shown here.



Lin, et al.            Expires September, 2022                [Page 2]

Internet-Draft    Dedicated Metric for Flex-Algorithm       March 2022


2. Problem Statement

   Flex-Algorithm allows IGP to compute the best paths over a network
   based on user-defined constraints and metrics.

   We use Figure 1 to illustrate the problem. In this scenario, all
   the IGP link metrics are 1.

   Flex-Algorithm 128 are enabled on Node A, B, C and D. The topology
   used by Flex-Algorithm 128 is shown in Figure 2.

   Another Flex-Algorithm 129 is also enabled on Node A, B, C and D.
   The metric-type of Flex-Algorithm 129 is the same with Flex-
   Algorithm 128. So the topology used by Flex-Algorithm 129 is the
   same as Figure 2.

   A------C------E
   |      |      |
   |      |      |
   |      |      |
   B------D------F

   Figure 1

   A------C
   |      |
   |      |
   |      |
   B------D

   Figure 2

   Assume that the traffics are from A to D. Since the metrics of A->B-
   >D and A->C->D are equal, the traffics are forwarded along both of
   the two paths by ECMP load sharing.

   The network operator expects to use link A->B->D as the primary path
   and link A->C->D as the backup path in Flex-Algorithm 128.
   Meanwhile, in Flex-Algorithm 129, the link A->C->D is expected to be
   the primary path and the link A->B->D is expected to be the backup
   path. So the traffics steered into Flex-Algorithm 128 and the
   traffics steered into Flex-Algorithm 129 can be carried by different
   paths separately. If a failure occurs on one path, the other path
   can still be used as protection.

   However, it cannot be satisfied because Flex-Algorithm 128 and 129
   use the same metrics in path computation.


Lin, et al.            Expires September, 2022                [Page 3]

Internet-Draft    Dedicated Metric for Flex-Algorithm       March 2022


   If the metric-type of an algorithm is IGP Metric, the metrics
   advertised for links are used in path computation. For example, the
   default metric field of TLV-22 in IS-IS (The extended IS
   reachability TLV [RFC5305]). So Flex-Algorithm 128 and Flex-
   Algorithm 129 share the same link metrics with the default algorithm
   of normal SPF calculation.

   If the metric-type of an algorithm is a kind of link attribute, such
   as Min Unidirectional Link Delay or Traffic Engineering Default
   Metric, the link attributes advertised in Application-Specific Link
   Attribute (ASLA) [RFC8919] [RFC8920] are used in path computation.
   So Flex-Algorithm 128 and Flex-Algorithm 129 also share the link
   attributes.

3. Dedicated Metric for Flexible Algorithm

   This document defines a new optional metric sub-TLV called the Flex-
   Algorithm-associated Generic Metric sub-TLV to advertise dedicated
   metric for Flex-Algorithm.

   The format of Flex-Algorithm-associated Generic Metric sub-TLV in
   IS-IS is as the following:

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      Type     |     Length    |  Metric-Type  |   Algorithm   |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |    Reserved   |                    Metric                     |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   o Type: TBD.

   o Length: 6.

   o Metric-Type: A value from the IGP metric-type registry.

   o Algorithm: Associated algorithm from 1 to 255.

   o Metric: Metric value from 1 to 16,777,215.

   The format of Flex-Algorithm-associated Generic Metric sub-TLV in
   OSPF is as the following:






Lin, et al.            Expires September, 2022                [Page 4]

Internet-Draft    Dedicated Metric for Flex-Algorithm       March 2022


    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |             Type              |             Length            |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |  Metric-Type  |   Algorithm   |            Reserved           |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |    Reserved   |                    Metric                     |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   o Type: TBD.

   o Length: 8.

   o Metric-Type: A value from the IGP metric-type registry.

   o Algorithm: Associated algorithm from 1 to 255.

   o Metric: Metric value from 1 to 16,777,215.

   The Flex-Algorithm-associated Generic Metric sub-TLV is carried in
   the Application-Specific Link Attribute (ASLA) defined in [RFC8919]
   (IS-IS) and [RFC8920] (OSPF) which is advertised for Flex-Algorithm
   application with 'X' Application Identifier Bit. If the Metric-Type
   and Algorithm fields is consistent with the FAD of a Flex-Algorithm,
   that Flex-Algorithm should use the metric in the new defined sub-TLV
   during path calculation.

   For example, in IS-IS, if the metric-type of a Flex-Algorithm is 0
   (IGP-Metric) and the Flex-Algorithm-associated Generic Metric sub-
   TLV of the same metric-type is advertised in ASLA carried by TLV-22
   (The extended IS reachability TLV [RFC5305]), the metric in the new
   defined sub-TLV, other than the default metric field in TLV-22,
   should be used by the associated Flex-Algorithm.

   For another example, in OSPFv3, if the metric-type of a Flex-
   Algorithm is 2 (Traffic Engineering Default Metric) and the Flex-
   Algorithm-associated Generic Metric sub-TLV of the same metric-type
   is advertised in ASLA carried by OSPFv3 Router-Link TLV [RFC8362],
   the metric in the new defined sub-TLV should be used by the
   associated Flex-Algorithm, ignoring the TE Metric sub-tlv.

4. Security Considerations

   TBD




Lin, et al.            Expires September, 2022                [Page 5]

Internet-Draft    Dedicated Metric for Flex-Algorithm       March 2022


5. IANA Considerations

   Flex-Algorithm-associated Generic Metric sub-TLV (TBD)

6. References

6.1. Normative References

   [RFC2119] Bradner, S., "Key words for use in RFCs to Indicate
             Requirement Levels", BCP 14, RFC 2119, March 1997.

   [RFC8174] Leiba, B., "Ambiguity of Uppercase vs Lowercase in RFC
             2119 Key Words", BCP 14, RFC 8174, May 2017

   [I-D.ietf-lsr-flex-algo] Psenak, P., Hegde, S., Filsfils, C.,
             Talaulikar, K., and A. Gulko, "IGP Flexible Algorithm",
             draft-ietf-lsr-flex-algo-18 (work in progress), October
             2021.

   [RFC8919] Ginsberg, L., Psenak, P., Previdi, S., Henderickx, W., and
             J. Drake, "IS-IS Application-Specific Link Attributes",
             RFC 8919, DOI 10.17487/RFC8919, October 2020,
             <https://www.rfc-editor.org/info/rfc8919>.

   [RFC8920] Psenak, P., Ed., Ginsberg, L., Henderickx, W., Tantsura,
             J., and J. Drake, "OSPF Application-Specific Link
             Attributes", RFC 8920, DOI 10.17487/RFC8920, October 2020,
             <https://www.rfc-editor.org/info/rfc8920>.

6.2. Informative References

   [I-D.ietf-lsr-ip-flexalgo] Britto, W., Hegde, S., Kaneriya, P.,
             Shetty, R., Bonica, R., and P. Psenak, "IGP Flexible
             Algorithms (Flex- Algorithm) In IP Networks", draft-ietf-
             lsr-ip-flexalgo-04 (work in progress), December 2021.

   [RFC5305] Li, T. and H. Smit, "IS-IS Extensions for Traffic
             Engineering", RFC 5305, DOI 10.17487/RFC5305, October
             2008, <https://www.rfc-editor.org/info/rfc5305>.

   [RFC8362] Lindem, A., Roy, A., Goethals, D., Reddy Vallem, V., and
             F. Baker, "OSPFv3 Link State Advertisement (LSA)
             Extensibility", RFC 8362, DOI 10.17487/RFC8362, April
             2018, <https://www.rfc-editor.org/info/rfc8362>.





Lin, et al.            Expires September, 2022                [Page 6]

Internet-Draft    Dedicated Metric for Flex-Algorithm       March 2022


Authors' Addresses

   Changwang Lin
   New H3C Technologies

   Email: linchangwang.04414@h3c.com


   Mengxiao Chen
   New H3C Technologies

   Email: chen.mengxiao@h3c.com


   Liyan Gong
   China Mobile

   Email: gongliyan@chinamobile.com


   Weiqiang Cheng
   China Mobile

   Email: chengweiqiang@chinamobile.com
























Lin, et al.            Expires September, 2022                [Page 7]

