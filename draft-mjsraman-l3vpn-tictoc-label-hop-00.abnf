packet = makepacket(FEC,K, TS, A[i], I);
S = 0     S = 0     S = 1
packet = CP-ReceivePacket(PEne); // from PEne
CurrentTimeSliceIndex = 0;

CurrentMasterClock = PTP LSP Master Clock Timestamp;

CurrentTimeInstant = CurrentMasterClock;

NextTimeInstant = CurrentMasterClock + TS[CurrentTimeSliceIndex];

packet = DP-ReceivePacket(Interface);
match = CheckFEC(packet); // Is the algorithm enabled?
hash-digest = calculateHash(A[i],packet);
CurrentTimeSliceIndex = 0;
CurrentTimeInstant = NextTimeInstant;
NextTimeInstant = CurrentTimeInstant + TS[CurrentTimeSliceIndex];
first-label = K[CurrentTimeSliceIndex];
additional-label = process(hash-digest,I)
CurrentTimeSliceIndex = 0;
CurrentMasterClock = PTP LSP Clock Timestamp;
CurrentTimeInstant = CurrentMasterClock;
NextTimeInstant = CurrentMasterClock + TS[CurrentTimeSliceIndex];
packet = DP-ReceivePacket(Interface);
match = CheckFEC(packet);
label-in-packet=extractPacket(packet, LABEL);
inner-label=extractPacket(packet, INNER-LABEL);
hash-digest=calculateHash(A[i],packet);
CurrentTimeSliceIndex = 0;
CurrentTimeInstant = NextTimeInstant;
NextTimeInstant = CurrentTimeInstant + TS[CurrentTimeSliceIndex];
first-label-range = K[CurrentTimeSliceIndex (+or- 1)];
additional-label = process(hash-digest,I)
