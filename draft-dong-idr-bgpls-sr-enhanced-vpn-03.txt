



IDR Working Group                                                J. Dong
Internet-Draft                                                     Z. Hu
Intended status: Standards Track                                   Z. Li
Expires: August 26, 2021                             Huawei Technologies
                                                                 X. Tang
                                                                 R. Pang
                                                            China Unicom
                                                       February 22, 2021


        BGP-LS Extensions for Segment Routing based Enhanced VPN
                draft-dong-idr-bgpls-sr-enhanced-vpn-03

Abstract

   Enhanced VPN (VPN+) aims to provide enhanced VPN services to support
   some applications' needs of enhanced isolation and stringent
   performance requirements.  VPN+ requires integration between the
   overlay VPN connectivity and the characteristics provided by the
   underlay network.  A Virtual Transport Network (VTN) is a virtual
   underlay network which consists of a customized network topology and
   a set of network resource allocated from the physical network.  A VTN
   could be used as the underlay to support one or a group of VPN+
   services.

   This document specifies the BGP-LS mechanisms with necessary
   extensions to advertise the information of Segment Routing (SR) based
   VTNs to a centralized network controller.  Each VTN can have a
   customized topology and a set of network resources allocated.
   Multiple VTNs may shared the same topology, and multiple VTNs may
   share the same set of network resources on some network segments.
   This allows flexible combination of network topology and network
   resource attributes to build a large number of VTNs with a relatively
   small number of logical topologies.  The proposed mechanism is
   applicable to both segment routing with MPLS data plane (SR-MPLS) and
   segment routing with IPv6 data plane (SRv6).

Requirements Language

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in RFC 2119 [RFC2119].

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.




Dong, et al.             Expires August 26, 2021                [Page 1]

Internet-Draft        BGP-LS Extensions for SR VPN+        February 2021


   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on August 26, 2021.

Copyright Notice

   Copyright (c) 2021 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (https://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   3
   2.  Advertisement of VTN Definition . . . . . . . . . . . . . . .   4
   3.  Advertisement of VTN Topology Attribute . . . . . . . . . . .   5
     3.1.  Intra-domain Topology Advertisement . . . . . . . . . . .   5
       3.1.1.  MTR based Topology Advertisement  . . . . . . . . . .   6
       3.1.2.  Flex-Algo based Topology Advertisement  . . . . . . .   7
     3.2.  Inter-Domain Topology Advertisement . . . . . . . . . . .   7
       3.2.1.  VTN ID TLV  . . . . . . . . . . . . . . . . . . . . .   9
   4.  Advertisement of VTN Resource Attribute . . . . . . . . . . .  10
     4.1.  Link Attribute Flags TLV  . . . . . . . . . . . . . . . .  10
   5.  Advertisement of VTN specific Data Plane Identifiers  . . . .  11
     5.1.  VTN-specific SR-MPLS SIDs . . . . . . . . . . . . . . . .  11
       5.1.1.  VTN-specific Prefix-SID TLV . . . . . . . . . . . . .  11
       5.1.2.  VTN-specific Adj-SID TLV  . . . . . . . . . . . . . .  12
     5.2.  VTN-specific SRv6 Locators  . . . . . . . . . . . . . . .  13
     5.3.  Dedicated VTN ID in Data Plane  . . . . . . . . . . . . .  14
   6.  Security Considerations . . . . . . . . . . . . . . . . . . .  14
   7.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .  15
   8.  Acknowledgments . . . . . . . . . . . . . . . . . . . . . . .  15



Dong, et al.             Expires August 26, 2021                [Page 2]

Internet-Draft        BGP-LS Extensions for SR VPN+        February 2021


   9.  References  . . . . . . . . . . . . . . . . . . . . . . . . .  15
     9.1.  Normative References  . . . . . . . . . . . . . . . . . .  15
     9.2.  Informative References  . . . . . . . . . . . . . . . . .  16
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  18

1.  Introduction

   Enhanced VPN (VPN+) is an enhancement to VPN services to support the
   needs of new applications, particularly the applications that are
   associated with 5G services.  These applications require enhanced
   isolation and have more stringent performance requirements than that
   can be provided with traditional overlay VPNs.  These properties
   require integration between the underlay and the overlay networks.
   [I-D.ietf-teas-enhanced-vpn] specifies the framework of enhanced VPN
   and describes the candidate component technologies in different
   network planes and layers.  An enhanced VPN can be used for 5G
   network slicing, and will also be of use in more generic scenarios.

   To meet the requirement of enhanced VPN services, a number of virtual
   underlay networks need to be created, each with a subset of the
   underlay network topology and a set of network resources allocated to
   meet the requirement of a specific VPN+ service or a group of VPN+
   services.  Such a virtual underlay network is called Virtual
   Transport Network (VTN) in [I-D.ietf-teas-enhanced-vpn].

   [I-D.ietf-spring-resource-aware-segments] introduces resource-
   awareness to Segment Routing (SR) [RFC8402] by associating existing
   type of SIDs with network resource attributes (e.g.  bandwidth,
   processing or storage resources).  These resource-aware SIDs retain
   their original functionality, with the additional semantics of
   identifying the set of network resources available for the packet
   processing action.  [I-D.ietf-spring-sr-for-enhanced-vpn] describes
   the use of resource-aware segments to build SR based VTNs.  To allow
   the network controller and network nodes to perform VTN-specific
   explicit path computation and/or shortest path computation, the group
   of resource-aware SIDs allocated by network nodes to each VTN and the
   associated topology and resource attributes need to be distributed in
   the control plane.

   When a VTN spans multiple IGP areas or multiple Autonomous Systems
   (ASes), BGP-LS is needed to advertise the VTN information in each IGP
   area or AS to the network controller, so that the controller could
   use the collected information to build the view of inter-area or
   inter-AS SR VTNs.

   This document describes BGP-LS [RFC7752] based mechanism with
   necessary extensions to advertise the topology and resource attribute
   of inter-area and inter-domain SR based VTNs.  Each VTN can have a



Dong, et al.             Expires August 26, 2021                [Page 3]

Internet-Draft        BGP-LS Extensions for SR VPN+        February 2021


   customized topology and a set of network resources allocated.
   Multiple VTNs may shared the same topology, and multiple VTNs may
   share the same set of network resources on some network segments.
   This allows flexible combination of network topology and network
   resource attributes to build a large number of VTNs with a relatively
   small number of logical topologies.  The definition of VTN is
   advertised as a node attribute using BGP-LS.  The associated network
   topology and resources attributes of a VTN are advertised as link
   attributes using BGP-LS.

2.  Advertisement of VTN Definition

   According to [I-D.ietf-teas-enhanced-vpn], a VTN has a customized
   network topology and a set of dedicated or shared network resources.
   Thus a VTN can be defined as the combination of a set of network
   attributes, which include the topology attribute and other
   attributes, such as the associated network resources.

   The Virtual Transport Network Definition (VTND) TLV is a new TLV of
   the optional BGP-LS Attribute which is associated with the node NLRI.

   The format of VTND TLV is as follows:

      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |              Type             |             Length            |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                            VTN ID                             |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |             MT-ID             |    Algorithm  |     Flags     |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                          Sub-TLVs                             |
      ~                            ...                                ~
      |                                                               |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Where:

   o  Type: TBD

   o  Length: the length of the value field of the TLV.  It is variable
      dependent on the included Sub-TLVs.

   o  VTN ID: A global significant 32-bit identifier which is used to
      identify a virtual transport network.





Dong, et al.             Expires August 26, 2021                [Page 4]

Internet-Draft        BGP-LS Extensions for SR VPN+        February 2021


   o  MT-ID: 16-bit identifier which indicates the multi-topology
      identifier of the IGP topology.

   o  Algorithm: 8-bit identifier which indicates the algorithm which
      applies to this virtual transport network.  It can be either a
      normal algorithm in [RFC8402] or a Flex-Algorithm
      [I-D.ietf-lsr-flex-algo].

   o  Flags: 8-bit flags.  Currently all the flags are reserved for
      future use.  They SHOULD be set to zero on transmission and MUST
      be ignored on receipt.

   o  Sub-TLVs: optional sub-TLVs to specify the additional attributes
      of a virtual transport network.  Currently no sub-TLV is defined
      in this document.

3.  Advertisement of VTN Topology Attribute

   [I-D.dong-lsr-sr-enhanced-vpn] describes the IGP mechanisms to
   distribute the topology attributes of SR based VTNs.  This section
   describes the BGP-LS mechanism to distribute both the intra-domain
   and inter-domain topology attributes of SR based VTNs.

3.1.  Intra-domain Topology Advertisement

   The intra-domain topology attribute of a VTN can be determined by the
   MT-ID and/or the algorithm ID included in the VTN definition.  In
   practice, it could be described using two optional approaches.

   The first approach is to use Multi-Topology Routing (MTR) [RFC4915]
   [RFC5120] with the segment routing extensions to advertise the
   topology associated with the SR based VTNs.  Different algorithms MAY
   be used to further specify the computation algorithm or the metric
   type used for path computation within the topology.  Multiple VTNs
   can be associated with the same <topology, algorithm>, and the IGP
   computation with the <topology, algorithm> tuple can be shared by
   these VTNs.

   The second approach is to use Flex-Algo [I-D.ietf-lsr-flex-algo] to
   describe the topological constraints of SR based VTNs on a shared
   network topology (e.g. the default topology).  Multiple VTNs can be
   associated with the same Flex-Algo, and the IGP computation with this
   Flex-Algo can be shared.

   This section describes the two optional approaches to advertise the
   intra-domain topology of a VTN using BGP-LS.





Dong, et al.             Expires August 26, 2021                [Page 5]

Internet-Draft        BGP-LS Extensions for SR VPN+        February 2021


3.1.1.  MTR based Topology Advertisement

   In section 4.2.2.1 of [I-D.ietf-idr-rfc7752bis], Multi-Topology
   Identifier (MT-ID) TLV is defined, which can contain one or more IS-
   IS or OSPF Multi-Topology IDs.  The MT-ID TLV MAY be present in a
   Link Descriptor, a Prefix Descriptor, or the BGP-LS Attribute of a
   Node NLRI.

   [I-D.ietf-idr-bgp-ls-segment-routing-ext] defines the BGP-LS
   extensions to carry the segment routing information using TLVs of
   BGP-LS Attribute.  When MTR is used with SR-MPLS data plane,
   topology-specific prefix-SIDs and topology-specific Adj-SIDs can be
   carried in the BGP-LS Attribute associated with the prefix NLRI and
   link NLRI respectively, the MT-ID TLV is carried in the prefix
   descriptor or link descriptor to identify the corresponding topology
   of the SIDs.

   [I-D.ietf-idr-bgpls-srv6-ext] defines the BGP-LS extensions to
   advertise SRv6 segments along with their functions and attributes.
   When MTR is used with SRv6 data plane, the SRv6 Locator TLV is
   carried in the BGP-LS Attribute associated with the prefix-NLRI, the
   MT-ID TLV can be carried in the prefix descriptor to identify the
   corresponding topology of the SRv6 Locator.  The SRv6 End.X SIDs are
   carried in the BGP-LS Attribute associated with the link NLRI, the
   MT-ID TLV can be carried in the link descriptor to identify the
   corresponding topology of the End.X SIDs.  The SRv6 SID NLRI is
   defined to advertise other types of SRv6 SIDs, in which the SRv6 SID
   Descriptors can include the MT-ID TLV so as to advertise topology-
   specific SRv6 SIDs.

   [I-D.ietf-idr-rfc7752bis] also defines the rules of the usage of MT-
   ID TLV:

   "In a Link or Prefix Descriptor, only a single MT-ID TLV containing
   the MT-ID of the topology where the link or the prefix is reachable
   is allowed.  In case one wants to advertise multiple topologies for a
   given Link Descriptor or Prefix Descriptor, multiple NLRIs MUST be
   generated where each NLRI contains a single unique MT-ID."

   Editor's note: the above rules indicates that only one MT-ID is
   allowed to be carried the Link or Prefix descriptors.  When a link or
   prefix needs to be advertised in multiple topologies, multiple NLRIs
   needs to be generated to report all the topologies the link or prefix
   participates in, together with the topology-specific segment routing
   information and link attributes.  This may increase the number of BGP
   Updates needed for advertising MT-specific topology attributes, and
   may introduce additional processing burden to both the sending BGP
   speaker and the receiving network controller.  When the number of



Dong, et al.             Expires August 26, 2021                [Page 6]

Internet-Draft        BGP-LS Extensions for SR VPN+        February 2021


   topologies in a network is not a small number, some optimization may
   be needed for the reporting of multi-topology information and the
   associated segment routing information in BGP-LS.  Based on the WG's
   opinion, this will be elaborated in a future version.

3.1.2.  Flex-Algo based Topology Advertisement

   The Flex-Algo definition [I-D.ietf-lsr-flex-algo] can be used to
   describe the calculation-type, the metric-type and the topological
   constraints for path computation on a network topology.  As specified
   in [I-D.dong-lsr-sr-enhanced-vpn], the topology of a VTN can be
   determined by applying Flex-Algo constraints on a particular
   topology.

   BGP-LS extensions for Flex-Algo [I-D.ietf-idr-bgp-ls-flex-algo]
   provide the mechanisms to advertise the Flex-Algo definition
   information.  BGP-LS extensions for SR-MPLS
   [I-D.ietf-idr-bgp-ls-segment-routing-ext] and SRv6
   [I-D.ietf-idr-bgpls-srv6-ext] provide the mechanism to advertise the
   algorithm-specific segment routing information.

   In[I-D.ietf-idr-bgp-ls-segment-routing-ext], algorithm-specific
   prefix-SIDs can be advertised in BGP-LS attribute associated with
   Prefix NLRI.  In [I-D.ietf-idr-bgpls-srv6-ext], algorithm-specific
   SRv6 Locators can be advertised in BGP-LS Attribute associated with
   the corresponding Prefix NLRI, and algorithm-specific End.X SID can
   be advertised in BGP-LS Attribute associated with the corresponding
   Link NLRI.  Other types of SRv6 SIDs can also be algorithm-specific
   and are advertised using the SRv6 SID NLRI.

3.2.  Inter-Domain Topology Advertisement

   In some network scenarios, a VTNs which span multiple areas or ASes
   needs to be created.  The multi-domain VTN could have different
   inter-domain connectivity, and may be associated with different set
   of network resources in each domain and also on the inter-domain
   links.  In order to build the multi-domain VTNs using segment
   routing, it is necessary to advertise the topology and resource
   attribute of VTN on the inter-domain links and the associated BGP
   Peering SIDs.

   [I-D.ietf-idr-bgpls-segment-routing-epe] and
   [I-D.ietf-idr-bgpls-srv6-ext] defines the BGP-LS extensions for
   advertisement of BGP topology information between ASes and the
   associated BGP Peering Segment Identifiers.  Such information could
   be used by a network controller for the computation and instantiation
   of inter-AS traffic engineering SR paths.




Dong, et al.             Expires August 26, 2021                [Page 7]

Internet-Draft        BGP-LS Extensions for SR VPN+        February 2021


   Depending on the network scenarios and the requirement of inter-
   domain VTNs, different mechanisms can be used to specify the inter-
   domain connections of VTNs.

   o  One EBGP session between two ASes can be established over multiple
      underlying links.  In this case, different underlying links can be
      used for different inter-domain VTNs which requires link isolation
      between each other.  In another similar case, the EBGP session is
      established over a single link, while the network resource (e.g.
      bandwidth) on this link can be partitioned into several pieces,
      each of which can be considered as a virtual member link.  In both
      cases, different BGP Peer-Adj-SIDs SHOULD be allocated to each
      underlying physical or virtual member link, and ASBRs SHOULD
      advertise the VTN identifier associated with each BGP Peer-Adj-
      SID.

   o  For inter-domain connection between two ASes, multiple EBGP
      sessions can be established between different set of peering
      ASBRs.  It is possible that some of these BGP sessions are used
      for one multi-domain VTN, while some other BGP sessions are used
      for another multi-domain VTN.  In this case, different BGP peer-
      node-SIDs are allocated to each BGP session, and ASBRs SHOULD
      advertise the VTN identifier associated with each BGP Peer-node-
      SIDs.

   o  At the AS-level topology, different multi-domain VTNs may have
      different inter-domain connectivity.  Different BGP Peer-Set-SIDs
      can be allocated to represent the groups of BGP peers which can be
      used for load-balancing in each multi-domain VTN.

   In network scenarios where the MT-ID or Flex-Algo is used
   consistently in multiple areas or ASes covered by a VTN. the
   approaches to advertise topology-specific BGP peering SIDs are
   described as below:

   o  Using MT-based mechanism, the topology-specific BGP peering SIDs
      can be advertised with the MT-ID associated with the VTN carried
      in the corresponding link NLRI.  This can be supported with the
      existing mechanisms defined in
      [RFC7752][I-D.ietf-idr-bgpls-segment-routing-epe] and
      [I-D.ietf-idr-bgpls-srv6-ext].

   o  Using Flex-Algo based mechanism, the topology-specific BGP peering
      SIDs can be advertised together with the Admin Group (color) of
      the corresponding Flex-Algo in the BGP-LS attribute.

   In network scenarios where consistent usage of MT-ID or Flex-Algo
   among multiple ASes can not be expected, then the global-significant



Dong, et al.             Expires August 26, 2021                [Page 8]

Internet-Draft        BGP-LS Extensions for SR VPN+        February 2021


   VTN-ID can be used to define the AS level topologies.  Within each
   domain, the MT or Flex-Algo based mechanism could still be used for
   topology advertisement.

3.2.1.  VTN ID TLV

   A new VTN ID TLV is defined to describe the identifiers of one or
   more VTNs an intra-domain or inter-domain link belongs to.  It can be
   carried in BGP-LS attribute which is associated with a Link NLRI, or
   it could be carried as a sub-TLV in the L2 Bundle Member Attribute
   TLV.

   The format of VTN ID TLV is as below:

       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |               Type            |            Length             |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |              Flags            |           Reserved            |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                            VTN ID-1                           |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      ~                              ...                              ~
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                            VTN ID-n                           |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Where:

   o  Type: TBD

   o  Length: The length of the value field of the sub-TLV.  It is
      variable dependent on the number of VTN IDs included.

   o  Flags: 16 bit flags.  All the bits are reserved, which MUST be set
      to 0 on transmission and ignored on receipt.

   o  Reserved: this field is reserved for future use.  MUST be set to 0
      on transmission and ignored on receipt.

   o  VTN IDs: One or more 32-bit identifiers to specify the VTNs this
      link or member link belongs to.








Dong, et al.             Expires August 26, 2021                [Page 9]

Internet-Draft        BGP-LS Extensions for SR VPN+        February 2021


4.  Advertisement of VTN Resource Attribute

   [I-D.dong-lsr-sr-enhanced-vpn] specifies the mechanism to advertise
   the resource information associated with each VTN.  It is based on
   the extensions to the advertisement of L2 bundle member links
   information[RFC8668].  This section defines the corresponding BGP-LS
   extensions.  Two new TLVs are defined to carry the VTN ID and the
   link attribute flags of either a Layer-3 link or the L2 bundle member
   links.  The VTN ID TLV is defined in section 3.2.1 of this document,
   and a new Link Attribute Flags TLV is defined in this section.  The
   TE attributes of each Layer 3 link or the L2 bundle member link, such
   as the bandwidth and the SR SIDs, can be advertised using the
   mechanism as defined in [I-D.ietf-idr-bgp-ls-segment-routing-ext][I-D
   .ietf-idr-bgpls-segment-routing-epe] and
   [I-D.ietf-idr-bgpls-srv6-ext].

4.1.  Link Attribute Flags TLV

   A new Link attribute Flags TLV is defined to specify the
   characteristics of a link.  It can be carried in BGP-LS attribute
   which is associated with a Link NLRI, or it could be carried as a
   sub-TLV in the L2 Bundle Member Attribute TLV.  The format of the
   sub-TLV is as below:

       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |              Type             |             Length            |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |             Flags             |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Where:

      Type: TBD

      Length: 4 octets.

      Flags: 16-bit flags.  This field is consistent with the Flag field
      in IS-IS Link Attribute sub-TLV in [RFC5029].  In addition to the
      flags defined in [RFC5029], A new Flag V is defined in this
      document.  When the V flag is set, it indicates this link is a
      virtual link.








Dong, et al.             Expires August 26, 2021               [Page 10]

Internet-Draft        BGP-LS Extensions for SR VPN+        February 2021


5.  Advertisement of VTN specific Data Plane Identifiers

   In network scenarios where each VTN is associated with an independent
   network topology or Flex-Algo, the topology or Flex-Algo specific
   SIDs or Locators could be used as the identifier of the VTN in data
   plane.  In network scenarios where multiple VTNs share the same
   topology or Flex-Algo, additional data plane identifiers would be
   needed to identify different VTNs.

   This section describes the mechanisms to advertise the VTN
   identifiers with different data plane encapsulations.

5.1.  VTN-specific SR-MPLS SIDs

   With SR-MPLS data plane, the VTN identification information is
   implicitly carried in the SR SIDs of the corresponding VTN.  Each
   node SHOULD allocate VTN-specific Prefix-SIDs for each VTN it
   participates in.  Similarly, VTN-specific Adj-SIDs MAY be allocated
   for each link which participates in the VTN.

5.1.1.  VTN-specific Prefix-SID TLV

   A new VTN-specific Prefix-SID TLV is defined to advertise the prefix-
   SID and its associated VTN.  It is derived from VTN specific Prefix-
   SID sub-TLV of IS-IS [I-D.dong-lsr-sr-enhanced-vpn].  The format of
   the sub-TLV is as below:

      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |      Type     |    Length     |           Flags               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                            VTN ID                             |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                      SID/Index/Label(Variable)                |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Where:

   o  Type: TBD

   o  Length: The length of the value field of the sub-TLV.  It is
      variable dependent on the length of the SID/Index/Label field.

   o  Flags: 16-bit flags.  The high-order 8 bits are the same as in the
      Prefix-SID sub-TLV defined in [RFC8667].  The lower-order 8 bits
      are reserved for future use, which SHOULD be set to 0 on
      transmission and MUST be ignored on receipt.



Dong, et al.             Expires August 26, 2021               [Page 11]

Internet-Draft        BGP-LS Extensions for SR VPN+        February 2021


   o  VTN ID: A 32-bit local identifier to identify the VTN this prefix-
      SID associates with.

   o  SID/Index/Label: The same as defined in [RFC8667].

   One or more of VTN-specific Prefix-SID TLVs MAY be carried in BGP-LS
   attribute of the associated Prefix NLRI.  The MT-ID in the Prefix
   descriptors SHOULD be the same as the MT-ID in the definition of
   these VTNs.

5.1.2.  VTN-specific Adj-SID TLV

   A new VTN-specific Adj-SID TLV is defined to advertise the Adj-SID
   and its associated VTN.  It is derived from VTN specific Adj-SID sub-
   TLV of IS-IS [I-D.dong-lsr-sr-enhanced-vpn].  The format of the sub-
   TLV is as below:

      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |      Type     |    Length     |           Flags               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                            VTN ID                             |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                      SID/Index/Label(Variable)                |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Where:

   o  Type: TBD

   o  Length: The length of the value field of the sub-TLV.  It is
      variable dependent on the length of the SID/Index/Label field.

   o  Flags: 16-bit flags.  The high-order 8 bits are the same as in the
      Adj-SID sub-TLV defined in [RFC8667].  The lower-order 8 bits are
      reserved for future use, which SHOULD be set to 0 on transmission
      and MUST be ignored on receipt.

   o  VTN ID: A 32-bit local identifier to identify the VTN this Adj-SID
      associates with.

   o  SID/Index/Label: The same as defined in [RFC8667].

   Multiple VTN-specific Adj-SID TLVs MAY be carried in BGP-LS attribute
   of the associated Link NLRI.  The MT-ID in the Link descriptors
   SHOULD be the same as the MT-ID in the definition of these VTNs.




Dong, et al.             Expires August 26, 2021               [Page 12]

Internet-Draft        BGP-LS Extensions for SR VPN+        February 2021


5.2.  VTN-specific SRv6 Locators

   With SRv6 data plane, the VTN identification information can be
   implicitly or explicitly carried in the SRv6 Locator of the
   corresponding VTN, this is to ensure that all network nodes
   (including both the SRv6 End nodes and Transit nodes) can identify
   the VTN to which a packet belongs to.  Network nodes SHOULD allocate
   VTN-specific Locators for each VTN it participates in.  The VTN-
   specific Locators are used as the covering prefix of VTN-specific
   SRv6 End SIDs, End.X SIDs and other types of SIDs.

   Each VTN-specific SRv6 Locator MAY be advertised in a separate Prefix
   NLRI.  If multiple VTNs share the same topology/algorithm, the
   topology/algorithm specific Locator is the covering prefix of a group
   of VTN-specific Locators.  Then the advertisement of VTN-specific
   locators can be optimized to reduce the amount of information
   advertised in the control plane.

   A new VTN locator-block sub-TLV under the SRv6 Locator TLV is defined
   to advertise a set of sub-blocks which follows the topology/algorithm
   specific Locator.  Each VTN locator-block value is assigned to one of
   the VTNs which share the same topology/algorithm.

        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |             Type              |            Length             |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       | Number of VTNs|  Block Length |           Reserved            |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                            VTN ID #1                          |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       ~                       Locator Block Value                     ~
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       ~                               ...                             ~
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                            VTN ID #n                          |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       ~                       Locator Block Value                     ~
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Where:

   o  Type: TBD

   o  Length: The length of the value field of the sub-TLV.  It is
      variable dependent on the number of VTNs and the Block Length.




Dong, et al.             Expires August 26, 2021               [Page 13]

Internet-Draft        BGP-LS Extensions for SR VPN+        February 2021


   o  Number of VTNs: The number of VTNs which share the same topology/
      algorithm specific Locator as the covering prefix.

   o  Block Length: The length of the VTN locator-block which follows
      the length of the topology/algorithm specific Locator.

   o  VTN ID: A 32-bit identifier to identify the VTN the locator-block
      is associates with.

   o  Block Value: The value of the VTN locator-block for each VTN.

   With the VTN locator-block sub-TLV, the VTN-specific Locator can be
   obtained by concatenating the topology/algorithm specific locator and
   the locator-block value advertised for the VTN.

5.3.  Dedicated VTN ID in Data Plane

   As the number of VTNs increases, with the mechanism described in
   [I-D.ietf-spring-sr-for-enhanced-vpn], the number of SR SIDs and SRv6
   Locators allocated for different VTNs would also increase.  In
   network scenarios where the number of SIDs or Locators becomes a
   concern, some data plane optimization may be needed to reduce the
   amount of SR SIDs and Locators allocated.  As described in
   [I-D.dong-teas-enhanced-vpn-vtn-scalability], one approach is to
   decouple the data plane identifiers used for topology based
   forwarding and the identifiers used for the VTN-specific processing.
   Thus a dedicated data plane VTN-ID could be introduced and
   encapsulated in the packet.  One possible encapsulation of VTN-ID in
   IPv6 data plane is proposed in [I-D.dong-6man-enhanced-vpn-vtn-id].
   One possible encapsulation of VTN-ID in MPLS data plane is proposed
   in [I-D.li-mpls-enhanced-vpn-vtn-id].

   In that case, the VTN ID encapsulated in data plane can be the same
   value as the VTN ID in the control plane, so that the overhead of
   advertising the mapping between the VTN IDs in the control plane and
   the corresponding data plane identifiers could be saved.

6.  Security Considerations

   This document introduces no additional security vulnerabilities to
   BGP-LS.

   The mechanism proposed in this document is subject to the same
   vulnerabilities as any other protocol that relies on BGP-LS.







Dong, et al.             Expires August 26, 2021               [Page 14]

Internet-Draft        BGP-LS Extensions for SR VPN+        February 2021


7.  IANA Considerations

   TBD

8.  Acknowledgments

   The authors would like to thank Shunwan Zhuang and Zhenbin Li for the
   review and discussion of this document.

9.  References

9.1.  Normative References

   [I-D.ietf-idr-bgp-ls-flex-algo]
              Talaulikar, K., Psenak, P., Zandi, S., and G. Dawra,
              "Flexible Algorithm Definition Advertisement with BGP
              Link-State", draft-ietf-idr-bgp-ls-flex-algo-05 (work in
              progress), November 2020.

   [I-D.ietf-idr-bgp-ls-segment-routing-ext]
              Previdi, S., Talaulikar, K., Filsfils, C., Gredler, H.,
              and M. Chen, "BGP Link-State extensions for Segment
              Routing", draft-ietf-idr-bgp-ls-segment-routing-ext-16
              (work in progress), June 2019.

   [I-D.ietf-idr-bgpls-segment-routing-epe]
              Previdi, S., Talaulikar, K., Filsfils, C., Patel, K., Ray,
              S., and J. Dong, "BGP-LS extensions for Segment Routing
              BGP Egress Peer Engineering", draft-ietf-idr-bgpls-
              segment-routing-epe-19 (work in progress), May 2019.

   [I-D.ietf-idr-bgpls-srv6-ext]
              Dawra, G., Filsfils, C., Talaulikar, K., Chen, M.,
              daniel.bernier@bell.ca, d., and B. Decraene, "BGP Link
              State Extensions for SRv6", draft-ietf-idr-bgpls-
              srv6-ext-05 (work in progress), November 2020.

   [I-D.ietf-idr-rfc7752bis]
              Talaulikar, K., "Distribution of Link-State and Traffic
              Engineering Information Using BGP", draft-ietf-idr-
              rfc7752bis-05 (work in progress), November 2020.

   [I-D.ietf-spring-resource-aware-segments]
              Dong, J., Bryant, S., Miyasaka, T., Zhu, Y., Qin, F., Li,
              Z., and F. Clad, "Introducing Resource Awareness to SR
              Segments", draft-ietf-spring-resource-aware-segments-01
              (work in progress), January 2021.




Dong, et al.             Expires August 26, 2021               [Page 15]

Internet-Draft        BGP-LS Extensions for SR VPN+        February 2021


   [I-D.ietf-spring-sr-for-enhanced-vpn]
              Dong, J., Bryant, S., Miyasaka, T., Zhu, Y., Qin, F., Li,
              Z., and F. Clad, "Segment Routing based Virtual Transport
              Network (VTN) for Enhanced VPN", February 2021,
              <https://tools.ietf.org/html/draft-ietf-spring-sr-for-
              enhanced-vpn>.

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <https://www.rfc-editor.org/info/rfc2119>.

   [RFC5029]  Vasseur, JP. and S. Previdi, "Definition of an IS-IS Link
              Attribute Sub-TLV", RFC 5029, DOI 10.17487/RFC5029,
              September 2007, <https://www.rfc-editor.org/info/rfc5029>.

   [RFC7752]  Gredler, H., Ed., Medved, J., Previdi, S., Farrel, A., and
              S. Ray, "North-Bound Distribution of Link-State and
              Traffic Engineering (TE) Information Using BGP", RFC 7752,
              DOI 10.17487/RFC7752, March 2016,
              <https://www.rfc-editor.org/info/rfc7752>.

   [RFC8402]  Filsfils, C., Ed., Previdi, S., Ed., Ginsberg, L.,
              Decraene, B., Litkowski, S., and R. Shakir, "Segment
              Routing Architecture", RFC 8402, DOI 10.17487/RFC8402,
              July 2018, <https://www.rfc-editor.org/info/rfc8402>.

9.2.  Informative References

   [I-D.dong-6man-enhanced-vpn-vtn-id]
              Dong, J., Li, Z., Xie, C., and C. Ma, "Carrying Virtual
              Transport Network Identifier in IPv6 Extension Header",
              draft-dong-6man-enhanced-vpn-vtn-id-02 (work in progress),
              November 2020.

   [I-D.dong-lsr-sr-enhanced-vpn]
              Dong, J., Hu, Z., Li, Z., Tang, X., Pang, R., JooHeon, L.,
              and S. Bryant, "IGP Extensions for Segment Routing based
              Enhanced VPN", draft-dong-lsr-sr-enhanced-vpn-04 (work in
              progress), June 2020.

   [I-D.dong-teas-enhanced-vpn-vtn-scalability]
              Dong, J., Li, Z., Qin, F., and G. Yang, "Scalability
              Considerations for Enhanced VPN (VPN+)", draft-dong-teas-
              enhanced-vpn-vtn-scalability-01 (work in progress),
              November 2020.





Dong, et al.             Expires August 26, 2021               [Page 16]

Internet-Draft        BGP-LS Extensions for SR VPN+        February 2021


   [I-D.ietf-lsr-flex-algo]
              Psenak, P., Hegde, S., Filsfils, C., Talaulikar, K., and
              A. Gulko, "IGP Flexible Algorithm", draft-ietf-lsr-flex-
              algo-13 (work in progress), October 2020.

   [I-D.ietf-lsr-isis-srv6-extensions]
              Psenak, P., Filsfils, C., Bashandy, A., Decraene, B., and
              Z. Hu, "IS-IS Extension to Support Segment Routing over
              IPv6 Dataplane", draft-ietf-lsr-isis-srv6-extensions-11
              (work in progress), October 2020.

   [I-D.ietf-teas-enhanced-vpn]
              Dong, J., Bryant, S., Li, Z., Miyasaka, T., and Y. Lee, "A
              Framework for Enhanced Virtual Private Networks (VPN+)
              Service", draft-ietf-teas-enhanced-vpn-06 (work in
              progress), July 2020.

   [I-D.li-mpls-enhanced-vpn-vtn-id]
              Li, Z. and J. Dong, "Carrying Virtual Transport Network
              Identifier in MPLS Packet", February 2021,
              <https://tools.ietf.org/html/draft-li-mpls-enhanced-vpn-
              vtn-id>.

   [RFC4915]  Psenak, P., Mirtorabi, S., Roy, A., Nguyen, L., and P.
              Pillay-Esnault, "Multi-Topology (MT) Routing in OSPF",
              RFC 4915, DOI 10.17487/RFC4915, June 2007,
              <https://www.rfc-editor.org/info/rfc4915>.

   [RFC5120]  Przygienda, T., Shen, N., and N. Sheth, "M-ISIS: Multi
              Topology (MT) Routing in Intermediate System to
              Intermediate Systems (IS-ISs)", RFC 5120,
              DOI 10.17487/RFC5120, February 2008,
              <https://www.rfc-editor.org/info/rfc5120>.

   [RFC8667]  Previdi, S., Ed., Ginsberg, L., Ed., Filsfils, C.,
              Bashandy, A., Gredler, H., and B. Decraene, "IS-IS
              Extensions for Segment Routing", RFC 8667,
              DOI 10.17487/RFC8667, December 2019,
              <https://www.rfc-editor.org/info/rfc8667>.

   [RFC8668]  Ginsberg, L., Ed., Bashandy, A., Filsfils, C., Nanduri,
              M., and E. Aries, "Advertising Layer 2 Bundle Member Link
              Attributes in IS-IS", RFC 8668, DOI 10.17487/RFC8668,
              December 2019, <https://www.rfc-editor.org/info/rfc8668>.







Dong, et al.             Expires August 26, 2021               [Page 17]

Internet-Draft        BGP-LS Extensions for SR VPN+        February 2021


Authors' Addresses

   Jie Dong
   Huawei Technologies

   Email: jie.dong@huawei.com


   Zhibo Hu
   Huawei Technologies

   Email: huzhibo@huawei.com


   Zhenbin Li
   Huawei Technologies

   Email: lizhenbin@huawei.com


   Xiongyan Tang
   China Unicom

   Email: tangxy@chinaunicom.cn


   Ran Pang
   China Unicom

   Email: pangran@chinaunicom.cn





















Dong, et al.             Expires August 26, 2021               [Page 18]
