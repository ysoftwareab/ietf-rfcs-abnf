<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>CNAME at the zone apex</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="CNAME at the zone apex">
<meta name="keywords" content="DNS, CNAME, SOA, NS, zone apex">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 60em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 60em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">DNSext Working Group</td><td class="header">O. Sury</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">CZ.NIC</td></tr>
<tr><td class="header">Updates: <a href='http://tools.ietf.org/html/rfc1034'>1034</a> (if&nbsp;approved)</td><td class="header">August 18, 2010</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">&nbsp;</td></tr>
<tr><td class="header">Expires: February 19, 2011</td><td class="header">&nbsp;</td></tr>
</table></td></tr></table>
<h1><br />CNAME at the zone apex<br />draft-sury-dnsext-cname-at-apex-00</h1>

<h3>Abstract</h3>

<p>This document proposes a modification to CNAME record to
      coexist with SOA and NS records at the zone apex.  This proposal
      will improve aliasing in the DNS system.  The users are often
      forced to manually add duplicate A, AAAA and MX records by
      copying data from the target zone to the aliased zone.  This
      forces zone owner to keep track of target domain name since the
      mismatch in the data could cause failures.  This administrative
      burden will be eliminated by allowing CNAME to coexist with NS
      and SOA resource records.
      
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted  in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF).  Note that other groups may also distribute
working documents as Internet-Drafts.  The list of current
Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
This Internet-Draft will expire on February 19, 2011.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the Simplified BSD License.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">1.1.</a>&nbsp;
Terminology<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">1.2.</a>&nbsp;
Requirements Language<br />
<a href="#anchor4">2.</a>&nbsp;
Motivation<br />
<a href="#anchor5">3.</a>&nbsp;
CNAME at the apex<br />
<a href="#anchor6">4.</a>&nbsp;
Query processing<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">4.1.</a>&nbsp;
Processing by Authoritative Servers<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">4.2.</a>&nbsp;
Processing by Recursive Servers<br />
<a href="#Security">5.</a>&nbsp;
Security Considerations<br />
<a href="#rfc.references1">6.</a>&nbsp;
Normative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Author's Address<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>
	<a class='info' href='#RFC1033'>RFC&nbsp;1033<span> (</span><span class='info'>Lottor, M., &ldquo;Domain administrators operations guide,&rdquo; November&nbsp;1987.</span><span>)</span></a> [RFC1033] defines CNAME
	resource record for cases when there are multiple names for
	single host.  A CNAME resource record identifies its owner
	name as an alias, and specifies the corresponding canonical
	name in the RDATA section of the resource record.  If a CNAME
	resource record is present at a node, no other data MUST be
	present; this ensures that the data for a canonical name and
	its aliases cannot be different.  This rule also insures that
	a cached CNAME can be used without checking with an
	authoritative server for other resource record types.
      
</p>
<p>
	However there are already existing exceptions to this
	rule.  <a class='info' href='#RFC4034'>RFC&nbsp;4034<span> (</span><span class='info'>Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose, &ldquo;Resource Records for the DNS Security Extensions,&rdquo; March&nbsp;2005.</span><span>)</span></a> [RFC4034] defines
	exception to RRSIG and NSEC records, which MUST exist for the
	same name as a CNAME resource record in a signed zone.
      
</p>
<p>
	<a class='info' href='#RFC1034'>RFC&nbsp;1034<span> (</span><span class='info'>Mockapetris, P., &ldquo;Domain names - concepts and facilities,&rdquo; November&nbsp;1987.</span><span>)</span></a> [RFC1034] defines the data
	that defines the top node of the zone.  They are logically
	part of the authoritative data, the RRs that describe the top
	node of the zone are especially important to the zone's
	management.  These RRs are of two types: name server RRs that
	list, one per RR, all of the servers for the zone, and a
	single SOA RR that describes zone management parameters.
      
</p>
<p>
	The Start Of Authority (SOA) record designates the start of a zone.
	It must be present in the zone apex.
      
</p>
<p>
	The NS (Name Server) record lists the name of a machine the
	provides domain service for a particular zone.  The NS record
	is placed both in the parent and the child zone and should be
	same.  The NS record(s) are also mandatory in the zone.
      
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Terminology</h3>

<p>
	  All the basic terms used in this specification are defined
	  in the documents <a class='info' href='#RFC1033'>RFC&nbsp;1033<span> (</span><span class='info'>Lottor, M., &ldquo;Domain administrators operations guide,&rdquo; November&nbsp;1987.</span><span>)</span></a> [RFC1033],
	  <a class='info' href='#RFC1034'>RFC&nbsp;1034<span> (</span><span class='info'>Mockapetris, P., &ldquo;Domain names - concepts and facilities,&rdquo; November&nbsp;1987.</span><span>)</span></a> [RFC1034].
	
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.2"></a><h3>1.2.&nbsp;
Requirements Language</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL",
          "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY",
          and "OPTIONAL" in this document are to be interpreted as
          described in <a class='info' href='#RFC2119'>RFC 2119<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a> [RFC2119].
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Motivation</h3>

<p>
	The aliasing in the DNS system is usually done by placing
	CNAME for each individual record which needs to be aliased.
	There is one notable exception - the zone apex which has to
	include the SOA and NS RRs.  Because of that the zone owner is
	unable to place CNAME record there and this can lead to
	several failure conditions.  Either the data in the apex is
	copied by hand and new administrative burden is created to
	keep the data in the sync, or there is no alias in the apex at
	all.
      
</p>
<p>
	The aliases zone is prone to several types of errors when the
	copy method is used.  The target domain can change the data
	and while subdomains (like www.example.net) still works the
	zone apex A record (example.net) doesn't work.  This could go
	overlooked for some time if the zone owner doesn't do regular
	checks.  Same condition can happen with MX records causing
	failure to deliver email or it could even lead to malicious
	use if the bad guys happen to own previous manually copied MX
	records.  Also there could be a semi-failures, f.e. if the
	target zone adds AAAA record for IPv6, it will not be copied
	to aliased zone automatically causing IPv6 resolution failures.
      
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
CNAME at the apex</h3>

<p>
	This proposal defines new rules for the CNAME record. <a class='info' href='#RFC1034'>RFC&nbsp;1033<span> (</span><span class='info'>Mockapetris, P., &ldquo;Domain names - concepts and facilities,&rdquo; November&nbsp;1987.</span><span>)</span></a> [RFC1034] defines that:
      
</p>
<p>
	There must not be any other RRs associated with a nickname of the
	same class.
      
</p>
<p>
	This rule is changed with full compliance with DNSSEC RFCs to:
      
</p>
<p>
	There must not be any other RRs with the same owner as the
	CNAME RR with the exception of NS, SOA, DNSKEY, RRSIG and
	NSEC RRs.
      
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Query processing</h3>

<p>
	Because of the change of the existing behaviour in the CNAME
	processing there is a need to add a signaling bit for the
	queries issued by resolvers understanding CNAME at the zone
	apex.
      
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Processing by Authoritative Servers</h3>

<p>
	  The authoritative server implementations MUST allow CNAME
	  resource record in the zone apex to coexist with NS, SOA,
	  DNSKEY, RRSIG and NSEC resource records.  They MUST NOT
	  allow any other resource record types in the zone apex when
	  the CNAME resource record is placed in the zone apex.
	
</p>
<p>
	  The authoritative server will return an answer containing
	  specific resource record type when asked for SOA, NS,
	  DNSKEY, RRSIG or NSEC RR type.  The authoritative server
	  will return an answer containing the CNAME if any other RR
	  type is requested in the query.  If the query contains the
	  CNAME-at-apex signaling bit then the authoritative server
	  will use correct TTL in the zone for the requests in the
	  zone apex.  If the query doesn't contain the CNAME-at-apex
	  signaling bit then the authoritative server will override
	  TTL in the zone and will return answer with 0 TTL for all
	  resource requests in the zone.  This should prevent the
	  resolvers to store the result in the cache and thus breaking
	  the internal rules for the CNAME.
	
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Processing by Recursive Servers</h3>

<p>
	  The resolver compliant with this proposal will issue a query
	  which has the CNAME-at-apex signaling bit.  Such resolver
	  MUST NOT deny CNAME if it already has other resource record
	  in the cache with the same owner with the SOA, NS, DNSKEY,
	  RRSIG or NSEC resource record type.  It MUST NOT deny SOA,
	  NS, DNSKEY, RRSIG or NSEC resource records if it already has
	  a CNAME resource record in the cache.  The compliant
	  resolver SHOULD NOT deny CNAME in the case it has any other
	  RR type in the cache and it SHOULD NOT deny any other RR
	  types if it already has CNAME records in the cache.
	
</p>
<p>
	  The rules for the authoritative server is same for the
	  compliant resolver acting as an upstream cache.
	
</p>
<a name="Security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Security Considerations</h3>

<p>
	The author is not aware of any security consideration, but he
	is aware that this proposal could create problems for the name
	servers not following the Robustness principle - Be
	conservative in what you send; be liberal in what you accept.
      
</p>
<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>6.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC1033">[RFC1033]</a></td>
<td class="author-text">Lottor, M., &ldquo;<a href="http://tools.ietf.org/html/rfc1033">Domain administrators operations guide</a>,&rdquo; RFC&nbsp;1033, November&nbsp;1987 (<a href="http://www.rfc-editor.org/rfc/rfc1033.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1034">[RFC1034]</a></td>
<td class="author-text">Mockapetris, P., &ldquo;<a href="http://tools.ietf.org/html/rfc1034">Domain names - concepts and facilities</a>,&rdquo; STD&nbsp;13, RFC&nbsp;1034, November&nbsp;1987 (<a href="http://www.rfc-editor.org/rfc/rfc1034.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4034">[RFC4034]</a></td>
<td class="author-text">Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose, &ldquo;<a href="http://tools.ietf.org/html/rfc4034">Resource Records for the DNS Security Extensions</a>,&rdquo; RFC&nbsp;4034, March&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4034.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Author's Address</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Ondrej Sury</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">CZ.NIC</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Americka 23</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">120 00 Praha 2</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">CZ</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+420 222 745 110</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:ondrej.sury@nic.cz">ondrej.sury@nic.cz</a></td></tr>
</table>
</body></html>
