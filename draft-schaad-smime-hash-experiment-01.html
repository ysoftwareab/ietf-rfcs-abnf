<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Experiment: Hash functions with parameters in CMS and S/MIME</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Experiment: Hash functions with parameters in CMS and S/MIME">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">J. Schaad</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Soaring Hawk Consulting</td></tr>
<tr><td class="header">Intended status: Experimental</td><td class="header">December 18, 2009</td></tr>
<tr><td class="header">Expires: June 21, 2010</td><td class="header">&nbsp;</td></tr>
</table></td></tr></table>
<h1><br />Experiment: Hash functions with parameters in CMS and S/MIME<br />draft-schaad-smime-hash-experiment-01</h1>

<h3>Abstract</h3>

<p>New hash algorithms are being developed and these algorithms may include parameters.  CMS has not currently defined any hash algorithms with parameters, but anecdotic evidence suggests that defining one could cause major problems.  In this document we define just such an algorithm and describe how to use it so that we can run experiments to find out how bad including hash parameters will be.
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on June 21, 2010.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2009 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the BSD License.</p>

<a name="anchor1"></a><br /><hr />
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>At the present time, all hash algorithms that are used in Cryptographic Message Syntax [CMS] implementations are defined as having no parameters.  Anecdotal evidence suggests that if a hash algorithm is defined that does require the presence of parameters there may be extensive problems.  This document describes presents the details needed to run an experiment so that we can find out just how bad the situation really is and if we need to either make drastic changes in implementations or make sure that any hash algorithms chosen do not have parameters.
</p>
<p>In CMS data structures, hash algorithms current exist in the following locations:
</p>
<p>- SignerInfo.digestAlgorithm -- holds the digest algorithm actually used to compute the hash value over the content.
</p>
<p>- DigestedData.digestAlgorithm -- holds the digest algorithm actually used to compute the hash value over the content
</p>
<p>- AuthenticatedData.digestAlgorithm -- holds the digest algorithm actually used to compute the hash value over the content
</p>
<p>- SignedData.digestAlgorithms -- an optional location to place information about the set of digest algorithms used in computing the hash value over the content.
</p>
<p>- multipart/signed micalg - Holds a textual indicator of the hash algorithm for multipart signed MIME messages.
</p>
<p>The first three locations hold the identification of a single hash, and would hold the parameters for that hash.  These fields are mandatory to be filled in.
</p>
<p>DigestedData and AthenticatedData are defined such that in the case of encapsulated data, these fields are parsed before the content is parsed and thus the data is not needed until the parameters have been seen.
</p>
<p>SignedData is defined such that even for the encapsulated data case, the value of SignerInfo.digestedAlgorithm is not seen until the content has been processed.  This is the reason for the existence of the SignedData.digestAlgorithms field, so that the set of all digest algorithms used can be seen prior to the content being processed.
</p>
<p>For the case of detached content, the ASN.1 structures need to be procssed prior to processing the detached content in order to obtain the parameters of the hash function.  In the case of MIME, this is the purpose of the micalg field on the multipart/signature content-type.
</p>
<p>When processing multipart/signed messages two paths exists:
</p>
<p>1.  Process the content before the ASN.1.  The steps involved are:
</p>
<p>- Get a set of hash functions by looking at the micalg parameter and potentially add a set of generic algorithms
</p>
<p>- Create a hasher for each of those algorithms
</p>
<p>- Hash the content (the first part of the multipart)
</p>
<p>- Process the ASN.1 and have a potential failure point if a hash algorithm is required which was not computed.
</p>
<p>2.  Process the content after the ASN.1.  The steps involved are:
</p>
<p>- Save the content for later processing
</p>
<p>- Parse the ASN.1 and build a list of hash functions based on it's content
</p>
<p>- Create a hasher for each of those algorithms
</p>
<p>- Hash the saved content
</p>
<p>- Perform the signature validation.
</p>
<p>The first path allows for single pass processing, but has the potential that a fallback path needs to be added in some cases.  The second path does not need a fallback path, but does not allow for single pass processing.
</p>
<p>The fallback path above may also be needed for the encapsulated content case.  Since it is optional to place hash algorithms in the SignedData.digestAlgorithms field, the content will be completely parsed before the set of hash algorithms in the SignerInfos are determined.  It may be that we need to require population of the SignedData.digestAlgorithms field if we adopt a parameterized hash field.
</p>
<p>In this document a new hash function is created that is based on the XOR operator and on MD5.  MD5 was deliberately used as the basis of this digest algorithm since it is known to be insecure and I do not want to make any statements that the hash algorithm designed here is in any way secure.  This hash function MUST NOT be released as shipping code, it is designed only for use in experimentation.
</p>
<a name="anchor2"></a><br /><hr />
<a name="rfc.section.2"></a><h3>2.&nbsp;
XOR-MD5 Digest Algorithm</h3>

<p>The XOR-MD5 digest algorithm has been designed to use two existing operators, XOR and the MD5 hash algorithm [MD5].  The hash algorithm works as follows:
</p>
<p>1.  A random XOR string consisting of exactly 64 bytes is created.
</p>
<p>2.  The input content is broken up into 64 byte blocks.  The last block may be less that 64 bytes.
</p>
<p>3.  Each block is XOR-ed with the random string.  The last block uses the same number of bits from the random string as it contains.
</p>
<p>4.  The resulting string is run through the MD5 hash function.
</p>
<p>The length of the XOR string was designed to match the barrel size of the MD5 hash function.
</p>
<a name="anchor3"></a><br /><hr />
<a name="rfc.section.3"></a><h3>3.&nbsp;
ASN.1 Encoding</h3>

<p>The following ASN.1 is used to define the algorithm:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
mda-xor-md5 DIGEST-ALGORITHM ::= {
    IDENTIFIER {tbd}
    PARAMS OCTET STRING (64) ARE required
}
</pre></div>
<p>The octet string holds the value of the random XOR string.
</p>
<a name="anchor4"></a><br /><hr />
<a name="rfc.section.4"></a><h3>4.&nbsp;
CMS ASN.1 Handling</h3>

<p>The algorithm is added to the DigestAlgorithmSet in [CMS].
</p>
<p>When this algorithm is used in a signed message, it is REQUIRED that the algorithm be placed in the SignedData.digestAlgorithms sequence.  The algorithm MUST appear in the sequence at least once for each unique set of parameters.  The algorithm SHOULD NOT appear multiple times with the same set of parameters.
</p>
<a name="anchor5"></a><br /><hr />
<a name="rfc.section.5"></a><h3>5.&nbsp;
MIME handling</h3>

<p>This section defines the string that appears in the micalg parameter.
</p>
<p>The algorithm is identified by the string xor-md5.  The parameters for the algorithm are the hex encoded DER ASN.1 encoding.  The parameters and the identifier string are separated by a colon.  Arbitrary amounts of white space may be inserted between any two characters in the hex encoded string.  An example content-type string would be:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>Content-Type: multipart/signed; protocol="application/pkcs7-signature";
          micalg=sha1, xor-md5:04400102030405060708090a0b0c0d0e0f00111213141
          5161718191a1b1c1d1e1f102122232425262728292a2b2c2d2e2f2031323334353
          63738393a3b3c3d3e3f30;
         boundary=boundar42
</pre></div>
<p>Arguments could be made that the string should be base64 encoded rather than hex encoding the string.  The advantage is that the resulting encoding is shorter.  This could be significant if there are a substantial number of parameters and of a substantial size.  Even with the above example we needed to break the encoding across multiple lines.  The downside would be the requirement that the micalg parameter always be quoted.
</p>
<p>It may be reasonable to require that whitespace be inserted only on encoding boundaries, but it seems to be overly restrictive.
</p>
<a name="anchor6"></a><br /><hr />
<a name="rfc.section.6"></a><h3>6.&nbsp;
Security Considerations</h3>

<p>The algorithm XOR-MD5 is not designed for general purpose use.  The hash algorithm included here is designed for running this experiment and nothing more.
</p>
<p>This document makes no representation that XOR-MD5 is a secure digest algorithm.  I believe that the algorithm is no more secure than MD5, and I consider MD5 to be a broken hash algorithm for many purposes.
</p>
<p>One known issue with the algorithm as present is the fact that the xor pattern is always 64 bytes long, even if the data is shorter.  This means that there is a section of the data than can be manipulated without changing the hash.  In a real algorithm this should either be truncated or forced to a known value.
</p>
<a name="rfc.references1"></a><br /><hr />
<h3>7.&nbsp;Informational References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="CMS">[CMS]</a></td>
<td class="author-text">Housley, R., &ldquo;<a href="http://tools.ietf.org/html/rfc3852">Cryptographic Message Syntax (CMS)</a>,&rdquo; RFC&nbsp;3852, July&nbsp;2004.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4134">[RFC4134]</a></td>
<td class="author-text">Hoffman, P., &ldquo;<a href="http://tools.ietf.org/html/rfc4134">Examples of S/MIME Messages</a>,&rdquo; RFC&nbsp;4134, July&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4134.txt">TXT</a>).</td></tr>
</table>

<a name="anchor8"></a><br /><hr />
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Examples</h3>

<p>Provided here are a set of examples that are provided for testing.   The content used is the same as that found in Section 2.1 of <a class='info' href='#RFC4134'>[RFC4134]<span> (</span><span class='info'>Hoffman, P., &ldquo;Examples of S/MIME Messages,&rdquo; July&nbsp;2005.</span><span>)</span></a>.  The The certificates and key pairs found in <a class='info' href='#RFC4134'>[RFC4134]<span> (</span><span class='info'>Hoffman, P., &ldquo;Examples of S/MIME Messages,&rdquo; July&nbsp;2005.</span><span>)</span></a> are also used here.
</p>
<p>The perl script in <a class='info' href='#RFC4134'>[RFC4134]<span> (</span><span class='info'>Hoffman, P., &ldquo;Examples of S/MIME Messages,&rdquo; July&nbsp;2005.</span><span>)</span></a> can be used to extract the binary examples from this file.  The mime examples can be extracted with a standard text editor.
</p>
<p>NOTE: THESE EXAMPLES ARE NOT CORRECT AS THE FINAL OIDS HAVE NOT BEEN ASSIGNED.  THE KEYS WERE NOT USED AT THIS POINT.
</p>
<a name="anchor9"></a><br /><hr />
<a name="rfc.section.A.1"></a><h3>Appendix A.1.&nbsp;
Encapsulated Signed Data Example</h3>

<p>
This section contains a detached signed data example.  The content was hashed with the md5-xor algorithm defined in this document.  The signature is performed using RSA with MD5.  The signature is wrapped as an embedded signed mime message.

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
MIME-Version: 1.0
To: BobRSA@examples.com
From: AliceDss@examples.com
Subject: MD5-XOR example message
Message-Id: &gt;34567809323489fd.esc@examples.com&lt;
Date: Wed, 16 Dec 2009 23:13:00 -0500
Content-Type: application/pkcs7-mime; smime-type=signed-data;
  name=smime.p7m;
  micalg=xor-md5: 0440010203405060708090a0b0c0d0e0f10
  111213415161718191a1b1c1d1e1f20212223425262728292a2b2c2d2e2f30
  313233435363738393a3b3c3d3e3f40
Content-Transfer-Encoding: base64
Content-Disposition: attachment; filename=smime.p7m

MIICeQYJKoZIhvcNAQcCoIICajCCAmYCAQAxUjBQBgwqhkiG9w0BCRADh2cEQAECAwQFBg
cICQoLDA0ODxAREhMEFRYXGBkaGxwdHh8gISIjBCUmJygpKissLS4vMDEyMwQ1Njc4OTo7
PD0+P0AwKwYJKoZIhvcNAQcBoB4EHFRoaXMgaXMgc29tZSBzYW1wbGUgY29udGVudC4xgg
HeMIIB2gIBADAmMBIxEDAOBgNVBAMMB0NhcmxSU0ECEEY0a8eAAFa8EdNuLs1dcdAwUAYM
KoZIhvcNAQkQA4dnBEABAgMEBQYHCAkKCwwNDg8QERITBBUWFxgZGhscHR4fICEiIwQlJi
coKSorLC0uLzAxMjMENTY3ODk6Ozw9Pj9AoIHKMBgGCSqGSIb3DQEJAzELBgkqhkiG9w0B
BwEwHAYJKoZIhvcNAQkFMQ8XDTA5MTIxMDIzMjUwMFowHwYJKoZIhvcNAQkEMRIEEJZprm
EbV56D6hAra0ndwPkwbwYKKoZIhvcNAQmHXTFhMF8wUAYMKoZIhvcNAQkQA4dnBEABAgME
BQYHCAkKCwwNDg8QERITBBUWFxgZGhscHR4fICEiIwQlJicoKSorLC0uLzAxMjMENTY3OD
k6Ozw9Pj9AoQsGCSqGSIb3DQEBBDALBgkqhkiG9w0BAQQEgYDMzMzMzMzMzMzMzMzMzMzM
zMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzM
zMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzM
zMzMzMzMzA==

|&gt;sd.bin
|MIICeQYJKoZIhvcNAQcCoIICajCCAmYCAQAxUjBQBgwqhkiG9w0BCRADh2cEQAECAwQFBg
|cICQoLDA0ODxAREhMEFRYXGBkaGxwdHh8gISIjBCUmJygpKissLS4vMDEyMwQ1Njc4OTo7
|PD0+P0AwKwYJKoZIhvcNAQcBoB4EHFRoaXMgaXMgc29tZSBzYW1wbGUgY29udGVudC4xgg
|HeMIIB2gIBADAmMBIxEDAOBgNVBAMMB0NhcmxSU0ECEEY0a8eAAFa8EdNuLs1dcdAwUAYM
|KoZIhvcNAQkQA4dnBEABAgMEBQYHCAkKCwwNDg8QERITBBUWFxgZGhscHR4fICEiIwQlJi
|coKSorLC0uLzAxMjMENTY3ODk6Ozw9Pj9AoIHKMBgGCSqGSIb3DQEJAzELBgkqhkiG9w0B
|BwEwHAYJKoZIhvcNAQkFMQ8XDTA5MTIxMDIzMjUwMFowHwYJKoZIhvcNAQkEMRIEEJZprm
|EbV56D6hAra0ndwPkwbwYKKoZIhvcNAQmHXTFhMF8wUAYMKoZIhvcNAQkQA4dnBEABAgME
|BQYHCAkKCwwNDg8QERITBBUWFxgZGhscHR4fICEiIwQlJicoKSorLC0uLzAxMjMENTY3OD
|k6Ozw9Pj9AoQsGCSqGSIb3DQEBBDALBgkqhkiG9w0BAQQEgYDMzMzMzMzMzMzMzMzMzMzM
|zMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzM
|zMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzM
|zMzMzMzMzA==
|&lt;sd.bin
</pre></div>
<a name="anchor10"></a><br /><hr />
<a name="rfc.section.A.2"></a><h3>Appendix A.2.&nbsp;
Multipart Signed Message</h3>

<p>
This section contains a detached signed data example.  The content was hashed with the md5-xor algorithm defined in this document.  The signature is performed using RSA with MD5.  The signature is wrapped as a detached signed mime message.

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
MIME-Version: 1.0
To: User2@examples.com
From: BobRSA@examples.com
Subject: MD5-XOR signing example
Message-Id: &gt;091218002550300.249@examples.com&lt;
Date: Fri, 18 Dec 2009 00:25:21 -0300
Content-Type: multipart/signed;
    micalg=xor-md5: 0440010203405060708090a0b0c0d0e0f10
     111213415161718191a1b1c1d1e1f20212223425262728292a2b2c2d2e2f30
     313233435363738393a3b3c3d3e3f40
    boundary="----=_NextBoundry____Fri,_18_Dec_2009_00:25:21";
    protocol="application/pkcs7-signature"

This is a multi-part message in MIME format.

------=_NextBoundry____Fri,_18_Dec_2009_00:25:21

This is some sample content.
------=_NextBoundry____Fri,_18_Dec_2009_00:25:21
Content-Type: application/pkcs7-signature; name=smime.p7s
Content-Transfer-Encoding: base64
Content-Disposition: attachment; filename=smime.p7s

MIIDdwYJKoZIhvcNAQcCoIIDaDCCA2QCAQExCTAHBgUrDgMCGjALBgkqhkiG9w0BBwGgggL
gMIIC3DCCApugAwIBAgICAMgwCQYHKoZIzjgEAzASMRAwDgYDVQQDEwdDYXJsRFNTMB4XDT
k5MDgxNzAxMTA0OVoXDTM5MTIzMTIzNTk1OVowEzERMA8GA1UEAxMIQWxpY2VEU1MwggG2M
IIBKwYHKoZIzjgEATCCAR4CgYEAgY3N7YPqCp45PsJIKKPkR5PdDteoDuxTxauECE//lOFz
SH4M1vNESNH+n6+koYkv4dkwyDbeP5u/t0zcX2mK5HXQNwyRCJWb3qde+fz0ny/dQ6iLVPE
/sAcIR01diMPDtbPjVQh11Tl2EMR4vf+dsISXN/LkURu15AmWXPN+W9sCFQDiR6YaRWa4E8
baj7g3IStii/eTzQKBgCY40BSJMqo5+z5t2UtZakx2IzkEAjVc8ssaMMMeUF3dm1nizaoFP
VjAe6I2uG4Hr32KQiWn9HXPSgheSz6Q+G3qnMkhijt2FOnOLl2jB80jhbgvMAF8bUmJEYk2
RL34yJVKU1a14vlz7BphNh8Rf8K97dFQ/5h0wtGBSmA5ujY5A4GEAAKBgFzjuVp1FJYLqXr
d4z+p7Kxe3L23ExE0phaJKBEj2TSGZ3V1ExI9Q1tv5VG/+onyohs+JH09B41bY8i7RaWgSu
OF1s4GgD/oI34a8iSrUxq4Jw0e7wi/ZhSAXGKsZfoVi/G7NNTSljf2YUeyxDKE8H5BQP1Gp
2NOM/Kl4vTyg+W4o4GBMH8wDAYDVR0TAQH/BAIwADAOBgNVHQ8BAf8EBAMCBsAwHwYDVR0j
BBgwFoAUcEQ+gi5vh95K03XjPSC8QyuT8R8wHQYDVR0OBBYEFL5sobPjwfftQ3CkzhMB4v3
jl/7NMB8GA1UdEQQYMBaBFEFsaWNlRFNTQGV4YW1wbGUuY29tMAkGByqGSM44BAMDMAAwLQ
IUVQykGR9CK4lxIjONg2q1PWdrv0UCFQCfYVNSVAtcst3a53Yd4hBSW0NevTFjMGECAQEwG
DASMRAwDgYDVQQDEwdDYXJsRFNTAgIAyDAHBgUrDgMCGjAJBgcqhkjOOAQDBC4wLAIUM/mG
f6gkgp9Z0XtRdGimJeB/BxUCFGFFJqwYRt1WYcIOQoGiaowqGzVI

------=_NextBoundry____Fri,_18_Dec_2009_00:25:21--
</pre></div>
<a name="anchor11"></a><br /><hr />
<a name="rfc.section.A.3"></a><h3>Appendix A.3.&nbsp;
Autenticated Data Example</h3>

<p>This section contains an authenticated data example.  The content was hashed with the md5-xor algorithm defined in this document.  The authentication was done with the HMAC-SHA1 algorithm.  The key is transported using RSA encryption to BobRSASignByCarl certificate.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
MIME-Version: 1.0
To: BobRSA@examples.com
From: AliceDss@examples.com
Subject: MD5-XOR example message
Message-Id: &lt;34567809323489fd.esc@examples.com&gt;
Date: Wed, 16 Dec 2009 23:13:00 -0500
Content-Type: application/pkcs7-mime; smime-type=authenticated-data;
  name=smime.p7m;
  micalg=xor-md5: 0440010203405060708090a0b0c0d0e0f10
   111213415161718191a1b1c1d1e1f20212223425262728292a2b2c2d2e2f30
   313233435363738393a3b3c3d3e3f40
Content-Transfer-Encoding: base64
Content-Disposition: attachment; filename=smime.p7m

MIAGCyqGSIb3DQEJEAECoIAwgAIBADGAMIACAQAwgDCAMYAwgAYDVQQDDAdDYXJsUlNBAA
AAAAAAAhBGNGvHgABWvBHTbi7NXXHQAAAwgAYJKoZIhvcNAQEBAAAECszMzMzMzMzMzMwA
AAAAMIAGCCsGAQUFCAECAAChgAYMKoZIhvcNAQkQA4dnBEABAgMEBQYHCAkKCwwNDg8QER
ITBBUWFxgZGhscHR4fICEiIwQlJicoKSorLC0uLzAxMjMENTY3ODk6Ozw9Pj9AAAAwgAYJ
KoZIhvcNAQcBoIAEHFRoaXMgaXMgc29tZSBzYW1wbGUgY29udGVudC4AAAAAooAwgAYJKo
ZIhvcNAQkDMYAGCSqGSIb3DQEHAQAAAAAwgAYJKoZIhvcNAQkFMYAXDTA5MTIxMDIzMjUw
MFoAAAAAMIAGCSqGSIb3DQEJBDGABBCWaa5hG1eeg+oQK2tJ3cD5AAAAADCABgoqhkiG9w
0BCYddMYAwgDCABgwqhkiG9w0BCRADh2cEQAECAwQFBgcICQoLDA0ODxAREhMEFRYXGBka
GxwdHh8gISIjBCUmJygpKissLS4vMDEyMwQ1Njc4OTo7PD0+P0AAAKKABggrBgEFBQgBAg
AAAAAAAAAAAAAECszMzMzMzMzMzMwAAAAAAAA=


|&gt;ad.bin
|MIAGCyqGSIb3DQEJEAECoIAwgAIBADGAMIACAQAwgDCAMYAwgAYDVQQDDAdDYXJsUlNBAA
|AAAAAAAhBGNGvHgABWvBHTbi7NXXHQAAAwgAYJKoZIhvcNAQEBAAAECszMzMzMzMzMzMwA
|AAAAMIAGCCsGAQUFCAECAAChgAYMKoZIhvcNAQkQA4dnBEABAgMEBQYHCAkKCwwNDg8QER
|ITBBUWFxgZGhscHR4fICEiIwQlJicoKSorLC0uLzAxMjMENTY3ODk6Ozw9Pj9AAAAwgAYJ
|KoZIhvcNAQcBoIAEHFRoaXMgaXMgc29tZSBzYW1wbGUgY29udGVudC4AAAAAooAwgAYJKo
|ZIhvcNAQkDMYAGCSqGSIb3DQEHAQAAAAAwgAYJKoZIhvcNAQkFMYAXDTA5MTIxMDIzMjUw
|MFoAAAAAMIAGCSqGSIb3DQEJBDGABBCWaa5hG1eeg+oQK2tJ3cD5AAAAADCABgoqhkiG9w
|0BCYddMYAwgDCABgwqhkiG9w0BCRADh2cEQAECAwQFBgcICQoLDA0ODxAREhMEFRYXGBka
|GxwdHh8gISIjBCUmJygpKissLS4vMDEyMwQ1Njc4OTo7PD0+P0AAAKKABggrBgEFBQgBAg
|AAAAAAAAAAAAAECszMzMzMzMzMzMwAAAAAAAA=
|&lt;ad.bin
</pre></div>
<a name="rfc.authors"></a><br /><hr />
<h3>Author's Address</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Jim Schaad</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Soaring Hawk Consulting</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">PO Box 675</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Gold Bar, WA  98251</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:jimsch@exmsft.com">jimsch@exmsft.com</a></td></tr>
</table>
</body></html>
