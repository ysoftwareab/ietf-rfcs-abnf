SKEYID = prf(Ni_b | Nr_b, g^xy)
SKEYID_d = prf(SKEYID, g^xy | CKY-I | CKY-R | 0)
SKEYID_a = prf(SKEYID, SKEYID_d | g^xy | CKY-I | CKY-R | 1)
SKEYID_e = prf(SKEYID, SKEYID_a | g^xy | CKY-I | CKY-R | 2)

digest = prf(SKEYID_a, H(HDR1 | SAi | KEi | Ni | HDR2 | SAr |
                KEr | SIG1 | Nr | HDR3 | CHRE1 | PK
                [ | HDR4 | SIG2 ]))

digest = prf(SKEYID_a, H(HDR1 | SAi | KEi | Ni | HDR2 | SAr |
                KEr | SIG1 | Nr | HDR3 | CHRE1 | PK | HDR4 |
                CHRE2 | HDR5 | CHRE3 [ | HDR6 | SIG2 ]))
digest = prf(SKEYID_a, H(HDR1 | SAi | KEi | Ni | CERTREQ | HDR2 |
                SAr | CERT | KEr | SIG1 | Nr | HDR3 | CHRE1 | PK |
                HDR4 | CHRE2 | HDR5 | CHRE3 [ | HDR6 | SIG2 ]))

digest = prf(SKEYID_a, H(HDR1 | SAi | KEi | Ni | CERTREQ | HDR2 |
                SAr | CERT | KEr | SIG1 | Nr | HDR3 | CHRE1 | PK
                [ | HDR4 | SIG2 ]))

digest = prf(SKEYID_a, H(HDR1 | SAi | KEi | Ni | HDR2 | SAr |
                KEr | SIG1 | Nr | HDR3 | CHRE1 | PK
                [ | HDR4 | SIG2 ]))

digest = prf(SKEYID_a, H(HDR1 | SAi | KEi | Ni | HDR2 | SAr |
                KEr | SIG1 | Nr | HDR3 | CHRE1 | PK | HDR4 |
                CHRE2 | HDR5 | CHRE3 [ | HDR6 | SIG2 ]))
