<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>SOAP-over-CoAP Binding</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="SOAP-over-CoAP Binding">
<meta name="keywords" content="DPWS, 6LoWPAN, 6LoWAPP, CORE, CoAP, SOAP">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 60em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 60em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">CORE</td><td class="header">G. Moritz</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">University of Rostock</td></tr>
<tr><td class="header">Intended status: Informational</td><td class="header">January 26, 2011</td></tr>
<tr><td class="header">Expires: July 30, 2011</td><td class="header">&nbsp;</td></tr>
</table></td></tr></table>
<h1><br />SOAP-over-CoAP Binding<br />draft-moritz-core-soap-over-coap-00</h1>

<h3>Abstract</h3>

<p>The scope of this document is to provide a basis for a lightweight SOAP over CoAP binding, to allow usage of SOAP Web services also in resource constrained networks.
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted  in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.
This document may not be modified, and derivative works of it may
not be created, and it may not be published except as an Internet-Draft.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF).  Note that other groups may also distribute
working documents as Internet-Drafts.  The list of current
Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
This Internet-Draft will expire on July 30, 2011.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2011 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the Simplified BSD License.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">1.1.</a>&nbsp;
Motivation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">1.2.</a>&nbsp;
Requirements Language<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">1.3.</a>&nbsp;
Terminology and Definitions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">1.4.</a>&nbsp;
Requirements<br />
<a href="#anchor6">2.</a>&nbsp;
Use of CoAP<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">2.1.</a>&nbsp;
CoAP Content-Type<br />
<a href="#anchor8">3.</a>&nbsp;
Binding Name<br />
<a href="#anchor9">4.</a>&nbsp;
Transport Layer Binding<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">4.1.</a>&nbsp;
Source Address and Port<br />
<a href="#anchor11">5.</a>&nbsp;
Addressing<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">5.1.</a>&nbsp;
URI Scheme<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">5.2.</a>&nbsp;
Destination Addressing<br />
<a href="#anchor14">6.</a>&nbsp;
Message Patterns<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">6.1.</a>&nbsp;
Request response<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor16">6.2.</a>&nbsp;
Retransmission<br />
<a href="#anchor17">7.</a>&nbsp;
CoAP Header Options<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">7.1.</a>&nbsp;
Unicast one-way<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor19">7.2.</a>&nbsp;
Unicast request-response<br />
<a href="#IANA">8.</a>&nbsp;
IANA Considerations<br />
<a href="#Security">9.</a>&nbsp;
Security Considerations<br />
<a href="#rfc.references1">10.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">10.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">10.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Author's Address<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>
	The intention of this document is to provide a basic approach for a SOAP-over-CoAP binding. Readers of this document should be basically familiar with the CoAP draft <a class='info' href='#I-D.ietf-core-coap'>[I&#8209;D.ietf&#8209;core&#8209;coap]<span> (</span><span class='info'>Shelby, Z., Hartke, K., Bormann, C., and B. Frank, &ldquo;Constrained Application Protocol (CoAP),&rdquo; January&nbsp;2011.</span><span>)</span></a>, SOAP <a class='info' href='#W3C.REC-soap12-part0-20070427'>[W3C.REC&#8209;soap12&#8209;part0&#8209;20070427]<span> (</span><span class='info'>Mitra, N. and Y. Lafon, &ldquo;SOAP Version 1.2 Part 0: Primer (Second Edition),&rdquo; April&nbsp;2007.</span><span>)</span></a>, SOAP HTTP Binding <a class='info' href='#W3C.REC-soap12-part1-20070427'>[W3C.REC&#8209;soap12&#8209;part1&#8209;20070427]<span> (</span><span class='info'>Gudgin, M., Karmarkar, A., Nielsen, H., Hadley, M., Mendelsohn, N., Lafon, Y., and J. Moreau, &ldquo;SOAP Version 1.2 Part 1: Messaging Framework (Second Edition),&rdquo; April&nbsp;2007.</span><span>)</span></a> and SOAP UDP binding specifications <a class='info' href='#SOAP-over-UDP'>[SOAP&#8209;over&#8209;UDP]<span> (</span><span class='info'>Jeyaraman, &ldquo;OASIS SOAP-over-UDP Version 1.1,&rdquo; 2009.</span><span>)</span></a>. Parts of this document are derived from these existing specifications. This document will not provide a comprehensive specification, but may be a basis for further discussions and to identify required changes in the current CoAP <a class='info' href='#I-D.ietf-core-coap'>[I&#8209;D.ietf&#8209;core&#8209;coap]<span> (</span><span class='info'>Shelby, Z., Hartke, K., Bormann, C., and B. Frank, &ldquo;Constrained Application Protocol (CoAP),&rdquo; January&nbsp;2011.</span><span>)</span></a> protocol design which is on the way to become an IETF standard. These changes might not be identified directly as the binding described herein will not exploit from all features of CoAP but use CoAP as an 'application layer transport protocol' as SOAP already does with HTTP <a class='info' href='#W3C.REC-soap12-part1-20070427'>[W3C.REC&#8209;soap12&#8209;part1&#8209;20070427]<span> (</span><span class='info'>Gudgin, M., Karmarkar, A., Nielsen, H., Hadley, M., Mendelsohn, N., Lafon, Y., and J. Moreau, &ldquo;SOAP Version 1.2 Part 1: Messaging Framework (Second Edition),&rdquo; April&nbsp;2007.</span><span>)</span></a>.
	
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Motivation</h3>

<p>
		The motivation behind this document is based on the initial I-D <a class='info' href='#I-D.moritz-6lowapp-dpws-enhancements'>[I&#8209;D.moritz&#8209;6lowapp&#8209;dpws&#8209;enhancements]<span> (</span><span class='info'>Moritz, G., &ldquo;DPWS for 6LoWPAN,&rdquo; June&nbsp;2010.</span><span>)</span></a> and the resulting discussions. The described binding herein is a major enabler for the efforts towards usage of SOAP Web services for highly resource constrained devices like wireless sensor nodes. As core protocol the OASIS Devices Profile for Web Services (DPWS) <a class='info' href='#DPWS'>[DPWS]<span> (</span><span class='info'>Driscoll and Mensch, &ldquo;OASIS Devices Profile for Web Services (DPWS) Version 1.1,&rdquo; 2009.</span><span>)</span></a> is applied. By combining DPWS with EXI, message size can be reduced significantly as presented in <a class='info' href='#I-D.moritz-6lowapp-dpws-enhancements'>[I&#8209;D.moritz&#8209;6lowapp&#8209;dpws&#8209;enhancements]<span> (</span><span class='info'>Moritz, G., &ldquo;DPWS for 6LoWPAN,&rdquo; June&nbsp;2010.</span><span>)</span></a>. By providing a binding of SOAP to CoAP, the message overhead can be reduced significantly. Furthermore, SOAP is not required to use inappropriate mechanisms like TCP congestion control. Reliably messaging is guaranteed by CoAP internal mechanisms and thus expensive retransmissions independent of successful or unsuccessful delivery as required by the SOAP-over-UDP binding are avoided. In summary, the major advantages are:
		</p>
<ul class="text">
<li>more compact message format
</li>
<li>probably lower message parsing efforts compared to standard HTTP headers
</li>
<li>avoid inappropriate TCP usage implied by SOAP-over-HTTP binding
</li>
<li>avoid unreliable nature of unicast SOAP-over-UDP binding
</li>
</ul><p>


		
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.2"></a><h3>1.2.&nbsp;
Requirements Language</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
        "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
        document are to be interpreted as described in <a class='info' href='#RFC2119'>RFC 2119<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a> [RFC2119].
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.3"></a><h3>1.3.&nbsp;
Terminology and Definitions</h3>

<p>
			Defined below are the basic definitions for the terms used in this specification.
			
</p>
<p>
			</p>
<blockquote class="text"><dl>
<dt>Receiver</dt>
<dd>The endpoint terminating a SOAP/CoAP message
</dd>
<dt>Sender</dt>
<dd>The endpoint originating a SOAP/CoAP message
</dd>
<dt>SOAP/CoAP message</dt>
<dd>A CoAP message containing a SOAP envelope in the CoAP message body
</dd>
</dl></blockquote><p>
			
</p>
<p>
This specification uses the constructs [action], [destination], [message id], [reply endpoint], [address] as defined by in WS-Addressing <a class='info' href='#W3C.PR-ws-addr-core-20060321'>[W3C.PR&#8209;ws&#8209;addr&#8209;core&#8209;20060321]<span> (</span><span class='info'>Gudgin, M., Hadley, M., and T. Rogers, &ldquo;Web Services Addressing 1.0 - Core,&rdquo; March&nbsp;2006.</span><span>)</span></a>. 

</p>
<p>
The SOAP CoAP Binding is optional and SOAP nodes are not required to implement it. A SOAP node that correctly and completely implements the SOAP CoAP Binding may to be said to 'conform to the CoAP Binding.'


			
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.4"></a><h3>1.4.&nbsp;
Requirements</h3>

<p>
			This specification intends to meet the following requirements:
			</p>
<ul class="text">
<li>Support a one-way message-exchange pattern (MEP) where a SOAP envelope is carried in a CoAP message from Sender to Receiver only.
</li>
<li>Support a request-response message-exchange pattern (MEP) where SOAP envelopes are carried in CoAP messages from Sender to Receiver and back from the origin Receiver to the origin Sender.
</li>
</ul><p>
Even if reasonable, supporting multicast transmissions of SOAP envelopes carried in CoAP messages are out of scope of this version of this document and require further research. 
This binding supports SOAP 1.2 <a class='info' href='#W3C.REC-soap12-part0-20070427'>[W3C.REC&#8209;soap12&#8209;part0&#8209;20070427]<span> (</span><span class='info'>Mitra, N. and Y. Lafon, &ldquo;SOAP Version 1.2 Part 0: Primer (Second Edition),&rdquo; April&nbsp;2007.</span><span>)</span></a> Envelopes. Supporting SOAP 1.1 envelopes is out of scope but might be added in future versions of this document.

</p>
<p>
Messages conforming to either SOAP specification can use this binding. This specification relies on WS-Addressing. The SOAP envelope MUST use the mechanisms defined in WS-Addressing <a class='info' href='#W3C.PR-ws-addr-core-20060321'>[W3C.PR&#8209;ws&#8209;addr&#8209;core&#8209;20060321]<span> (</span><span class='info'>Gudgin, M., Hadley, M., and T. Rogers, &ldquo;Web Services Addressing 1.0 - Core,&rdquo; March&nbsp;2006.</span><span>)</span></a>.

</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Use of CoAP</h3>

<p>
		This binding of SOAP to CoAP is intended to make appropriate use of CoAP as an application protocol. For example, successful and failure responses are indicated by the appropriated CoAP response codes (e.g. 2xx, 4xx, 5xx). This binding is not intended to fully exploit the features of CoAP, but rather to use CoAP specifically for the purpose of communicating with other SOAP nodes implementing the same binding.
		
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
CoAP Content-Type</h3>

<p>
		Conforming implementations of this binding:
		</p>
<ul class="text">
<li>MAY be capable of sending and receiving SOAP/CoAP messages serialized using media type 'application/soap+xml'.
</li>
<li>MAY be capable of sending and receiving SOAP/CoAP messages serialized using media type 'application/exi'.
</li>
<li>MUST send requests and responses using such media types provide for at least the transfer of SOAP XML Infoset, including 'application/soap+xml' and 'application/exi'.
</li>
</ul><p>
		A SOAP/CoAP message MUST contain the CoAP Content-type Identifies Option and MUST contain a value which satisfies the three points above.
		
</p>
<p>
		Note: CoAP has no header option which corresponds to HTTP Accept. Thus the web methods known from the HTTP binding is not possible. In the current CoAP draft only view information are available how to define own header fields.

			
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Binding Name</h3>

<p>
		This binding is identified by the URI (see SOAP 1.2 Part 1 <a class='info' href='#W3C.REC-soap12-part1-20070427'>[W3C.REC&#8209;soap12&#8209;part1&#8209;20070427]<span> (</span><span class='info'>Gudgin, M., Karmarkar, A., Nielsen, H., Hadley, M., Mendelsohn, N., Lafon, Y., and J. Moreau, &ldquo;SOAP Version 1.2 Part 1: Messaging Framework (Second Edition),&rdquo; April&nbsp;2007.</span><span>)</span></a> SOAP Protocol Binding Framework): http://www.ws4d.org/2011/01/soap/bindings/CoAP/
		
</p>
<p>
		Note: The binding name is tentative but required to indicate the corresponding binding e.g. in the WSDL of a service.
		
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Transport Layer Binding</h3>

<p>
		The CoAP binding MUST operate over UDP transport layer. 
		
</p>
<p>
		Note: CoAP defines a maximum message size which refers to the IP layer. The existing UDP binding instead refers only to UDP and defines a general maximum packet size independent of IP.
		
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Source Address and Port</h3>

<p>
				The source address MUST be supplied at the IP packet level and MUST be the IPv4 address (limited to unicast addresses) or IPv6 address (limited to unicast addresses) of the sender; the receiver SHOULD reject IP packets containing a SOAP/CoAP message that have inappropriate values for the source address. 
				
</p>
<p>
				Even though CoAP is intended to be used on the well-known ports defined in CoAP-04, the use of CoAP is not limited to these ports. As a result, it is possible to have a dedicated CoAP server for handling SOAP processing on a distinct port.
				
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Addressing</h3>

<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
URI Scheme</h3>

<p>
				The SOAP CoAP binding defines a base URI according to the rules in CoAP-04. I.e., the base URI is the CoAP Request-URI or the value of the CoAP Location option field.
				
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Destination Addressing</h3>

<p>
				WS-Addressing defines a URI, 'http://www.w3.org/2005/08/addressing/anonymous', that can appear in the [address] property of an endpoint reference. If the [reply endpoint] property of a SOAP message transmitted over CoAP has an [address] property with this value, the UDP source address (and source port) is considered to be the address to which reply messages should be sent.
</p>
<p>				
The implied value of the [reply endpoint] property for SOAP messages transmitted over CoAP is an endpoint reference with an [address] property whose value is 'http://www.w3.org/2005/08/addressing/anonymous'.
				
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Message Patterns</h3>

<p>
		This specification supports the following message patterns:
		</p>
<ul class="text">
<li>Unicast one-way
</li>
<li>Unicast request, unicast response
</li>
</ul><p>
		as described in the remainder of this section. All SOAP/CoAP messages MUST use the POST method of CoAP, whereby POST is interpreted in accordance to RFC2616. 
		
</p>
<p>
		Note: In the current draft of CoAP-04, response Code 2.00 OK is only possible for GET methods. But GET is not the appropriate method for this binding. 
		
</p>
<p>
		Note: There is no Action field similar to SOAPAction in HTTP, so extensions are required to the basic CoAP Options. Hence the web method feature of the HTTP binding cannot be made possible.
		
</p>
<p>
		CoAP defines Proxy mechanism for caching of responses. Because the CoAP binding defined herein is intended for service communication and not RESTful resource manipulation, caching should be avoided. CoAP defines the Max-Age option to be default a non-zero value. Hence each SOAP/CoAP message MUST contain the Max-Age option and the value MUST be zero.
		
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
Request response</h3>

<p>
			To match a request with a response the CoAP Token Option can be used. The CoAP Token Option SHOULD be carried in all request-response SOAP/CoAP messages. WS-Addressing defines the [message id] property to identify messages in time and space and to match requests with response. In case of using the CoAP/SOAP binding the [message id] property is SHOULD be empty and MUST contain a value in case if the CoAP Token Option is not present. 

</p>
<p>Note: The intention of this paragraph is to reduce message size. The [message id] property has a typical size of 45 Bytes and cannot by compressed by knowledge based encodings like EXI because the value of this property is unique in each message. The CoAP Token Option may be much more compact by providing the same functionality.

</p>
<p>CoAP defines the feature of deferred responses where a transaction ACK is sent as response to a CON message to indicate a deferred response. If the value of the [reply endpoint] of the request is 'http://www.w3.org/2005/08/addressing/anonymous', the ACK message SHOULD NOT carry any payload (e.g. a SOAP Envelope) in the CoAP message body if not required by the application logic. If the value of the [reply endpoint] is not 'http://www.w3.org/2005/08/addressing/anonymous', the origin Receiver cannot guarantee that the response is intended to be sent to the same entity like the client and SHOULD include a SOAP Envelope providing details of the request for the entity behind the [reply endpoint].
				
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
Retransmission</h3>

<p>To avoid repeated packet collisions, any retransmission implementation SHOULD observe good practices such as using exponential back-off algorithms and spreading. An implementation SHOULD use the Confirmable (CON) transaction message mechanism described in the CoAP specification to avoid unnecessary retransmissions. For each transmission of such a message, the value of the [message id] property and the CoAP Token Option MUST be the same.

</p>
<p>Note: WS-Event Delivery should not use CON due to ACK flood at Event Source. Multicast messages also should use NON messages. Not sure if such requirements are in scope of this document.
				
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
CoAP Header Options</h3>

<p>In this section, the CoAP header and CoAP header options usage is described in detail. 
	
</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.1"></a><h3>7.1.&nbsp;
Unicast one-way</h3>

<p>The unicast one-way message pattern consists of only one request without a response. Due to the CoAP binding the request consists of one CoAP transaction. If CoAP Confirmable messaging is used, an empty CoAP ACK message must be send back to the origin sender to indicate success or failure.
</p>
<p>
The request is formulated according to the table below, but can be extended for application specific needs.	
</p><br /><hr class="insert" />
<a name="Table1"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left">
<tr><th align="left">CoAP field/header option</th><th align="left">Value</th></tr>
<tr>
<td align="left">CoAP Method</td>
<td align="left">POST is the only supported method of this binding.</td>
</tr>
<tr>
<td align="left">Request URI</td>
<td align="left">The request URI confirming a CoAP URI [xxx] and identifying the WS-Addressing [address] endpoint property (network address). If the value of the WS-Addressing [address] endpoint property is 'http://www.w3.org/2005/08/addressing/anonymous' (directly set or implied by an empty [address] property), the CoAP Uri-Path Option and the CoAP Uri-Query Option are empty.</td>
</tr>
<tr>
<td align="left">Message ID</td>
<td align="left">If messaging model is CON, carrying value in accordance to messaging model of CoAP . Otherwise not included.</td>
</tr>
<tr>
<td align="left">Content-type Option</td>
<td align="left">Media type of CoAP message body.</td>
</tr>
<tr>
<td align="left">Token Option</td>
<td align="left">Token in accordance to CoAP specification identifying the transaction in time and space. Only required if message is a CoAP Confirmable message.</td>
</tr>
<tr>
<td align="left">CoAP message body</td>
<td align="left">SOAP message serialized according to the rules for carrying SOAP messages in the media type given by the Content-type Option.</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 1: Unicast one-way Request&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>
		If the request is send as Non-Confirmable CoAP message, no response is send back to the origin requester. If the request is a Confirmable CoAP message, the response consists only of a CoAP ACK without any data in the CoAP message body. In case of a Conformable CoAP request the response is formulated according to the table below, but can be extended for application specific needs.
</p><br /><hr class="insert" />
<a name="Table2"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left">
<tr><th align="left">CoAP field/header option</th><th align="left">Value</th></tr>
<tr>
<td align="left">CoAP Status Code</td>
<td align="left">Status Code in accordance to codes defined in CoAP and interpreted as described in the SOAP-over-HTTP binding.
Note: CoAP describes only a subset of HTTP status codes and adds own codes. This must require further alignment.
</td>
</tr>
<tr>
<td align="left">Message ID</td>
<td align="left">If messaging model is CON, carrying value in accordance to messaging model of CoAP . Otherwise not included.</td>
</tr>
<tr>
<td align="left">Token Option</td>
<td align="left">Token in accordance to CoAP specification identifying the transaction in time and space. Only required if message is a CoAP Confirmable message.</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 2: Unicast one-way ACK Response&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>
		Application developers must be aware that the one-way message exchange patterns returns neither failure nor success messages if Non-Confirmable messages are used.
		
</p>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.2"></a><h3>7.2.&nbsp;
Unicast request-response</h3>

<p>The unicast request-response message pattern consists of one request and one response. Due to the CoAP binding the request consists of one or more CoAP transactions. 
</p>
<p>
The request is formulated according to the table below, but can be extended for application specific needs.

</p><br /><hr class="insert" />
<a name="Table3"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left">
<tr><th align="left">CoAP field/header option</th><th align="left">Value</th></tr>
<tr>
<td align="left">CoAP Method</td>
<td align="left">POST is the only supported method of this binding.</td>
</tr>
<tr>
<td align="left">Request URI</td>
<td align="left">The request URI confirming a CoAP URI [xxx] and identifying the WS-Addressing [address] endpoint property (network address). If the value of the WS-Addressing [address] endpoint property is 'http://www.w3.org/2005/08/addressing/anonymous' (directly set or implied by an empty [address] property), the CoAP Uri-Path Option and the CoAP Uri-Query Option are empty.</td>
</tr>
<tr>
<td align="left">Message ID</td>
<td align="left">If messaging model is CON, carrying value in accordance to messaging model of CoAP . Otherwise not included.</td>
</tr>
<tr>
<td align="left">Content-type Option</td>
<td align="left">Media type of CoAP message body.</td>
</tr>
<tr>
<td align="left">Token Option</td>
<td align="left">Token in accordance to CoAP specification identifying the transaction in time and space. Only required if message is a CoAP Confirmable message.</td>
</tr>
<tr>
<td align="left">CoAP message body</td>
<td align="left">SOAP message serialized according to the rules for carrying SOAP messages in the media type given by the Content-type Option.</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 3: Unicast request-response Request&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>
		If the request is send as Non-Confirmable CoAP message, no CoAP ACK is send back to the origin requester. In this case, for the response, the origin Receiver has to initiate a new CoAP transaction which can be either Non-Confirmable or Confirmable.
</p>
<p>
If the request is a Confirmable CoAP message, the response consists of a CoAP ACK which may carry the response SOAP envelope as data in the CoAP message body. For the response, the origin receiver may also initiate a new CoAP transaction after sending the CoAP ACK to the origin Sender, which can be either also Non-Confirmable or Confirmable. (see deferred responses in CoAP)

</p><br /><hr class="insert" />
<a name="Table4"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left">
<tr><th align="left">CoAP field/header option</th><th align="left">Value</th></tr>
<tr>
<td align="left">CoAP Status Code</td>
<td align="left">Status Code in accordance to codes defined in CoAP and interpreted as described in the SOAP-over-HTTP binding.
Note: CoAP describes only a subset of HTTP status codes and adds own codes. This must require further alignment.
</td>
</tr>
<tr>
<td align="left">Message ID</td>
<td align="left">If messaging model is CON, carrying value in accordance to messaging model of CoAP . Otherwise not included.</td>
</tr>
<tr>
<td align="left">Token Option</td>
<td align="left">Token in accordance to CoAP specification identifying the transaction in time and space. Only required if message is a CoAP Confirmable message.</td>
</tr>
<tr>
<td align="left">Content-type Option</td>
<td align="left">Media type of CoAP message body.</td>
</tr>
<tr>
<td align="left">CoAP message body</td>
<td align="left">SOAP message serialized according to the rules for carrying SOAP messages in the media type given by the Content-type Option.</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 4: Unicast request-response ACK with Response&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="IANA"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
IANA Considerations</h3>

<p>No IANA issues have been identified in this draft.
</p>
<a name="Security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Security Considerations</h3>

<p>Will be added in future versions.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>10.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.ietf-core-coap">[I-D.ietf-core-coap]</a></td>
<td class="author-text">Shelby, Z., Hartke, K., Bormann, C., and B. Frank, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-core-coap-04.txt">Constrained Application Protocol (CoAP)</a>,&rdquo; draft-ietf-core-coap-04 (work in progress), January&nbsp;2011 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-core-coap-04.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="W3C.PR-ws-addr-core-20060321">[W3C.PR-ws-addr-core-20060321]</a></td>
<td class="author-text">Gudgin, M., Hadley, M., and T. Rogers, &ldquo;<a href="http://www.w3.org/TR/2006/PR-ws-addr-core-20060321">Web Services Addressing 1.0 - Core</a>,&rdquo; W3C PR&nbsp;PR-ws-addr-core-20060321, March&nbsp;2006.</td></tr>
<tr><td class="author-text" valign="top"><a name="W3C.REC-soap12-part0-20070427">[W3C.REC-soap12-part0-20070427]</a></td>
<td class="author-text">Mitra, N. and Y. Lafon, &ldquo;<a href="http://www.w3.org/TR/2007/REC-soap12-part0-20070427">SOAP Version 1.2 Part 0: Primer (Second Edition)</a>,&rdquo; World Wide Web Consortium Recommendation&nbsp;REC-soap12-part0-20070427, April&nbsp;2007 (<a href="http://www.w3.org/TR/2007/REC-soap12-part0-20070427">HTML</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>10.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="DPWS">[DPWS]</a></td>
<td class="author-text">Driscoll and Mensch, &ldquo;<a href="http://docs.oasis-open.org/ws-dd/ns/dpws/2009/01">OASIS Devices Profile for Web Services (DPWS) Version 1.1</a>,&rdquo; 2009.</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.moritz-6lowapp-dpws-enhancements">[I-D.moritz-6lowapp-dpws-enhancements]</a></td>
<td class="author-text">Moritz, G., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-moritz-6lowapp-dpws-enhancements-01.txt">DPWS for 6LoWPAN</a>,&rdquo; draft-moritz-6lowapp-dpws-enhancements-01 (work in progress), June&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-moritz-6lowapp-dpws-enhancements-01.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="SOAP-over-UDP">[SOAP-over-UDP]</a></td>
<td class="author-text">Jeyaraman, &ldquo;<a href="http://docs.oasis-open.org/ws-dd/soapoverudp/1.1/os/wsdd-soapoverudp-1.1-spec-os.html">OASIS SOAP-over-UDP Version 1.1</a>,&rdquo; 2009.</td></tr>
<tr><td class="author-text" valign="top"><a name="W3C.REC-soap12-part1-20070427">[W3C.REC-soap12-part1-20070427]</a></td>
<td class="author-text">Gudgin, M., Karmarkar, A., Nielsen, H., Hadley, M., Mendelsohn, N., Lafon, Y., and J. Moreau, &ldquo;<a href="http://www.w3.org/TR/2007/REC-soap12-part1-20070427">SOAP Version 1.2 Part 1: Messaging Framework (Second Edition)</a>,&rdquo; World Wide Web Consortium Recommendation&nbsp;REC-soap12-part1-20070427, April&nbsp;2007 (<a href="http://www.w3.org/TR/2007/REC-soap12-part1-20070427">HTML</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Author's Address</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Guido Moritz</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">University of Rostock</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">18051 Rostock,   </td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Germany</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+49 381 498 7269</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:guido.moritz@uni-rostock.de">guido.moritz@uni-rostock.de</a></td></tr>
</table>
</body></html>
